import{R as i,jt as h,ju as C,D as E,a as l,f3 as c,aE as d,j7 as n}from"./cim4usely8ixso70.js";import{g as k}from"./lgwn8lf5xrondcxt.js";import{a as m}from"./n97h6so7iblif4c5.js";class g{static async getCheckoutLink(e,a){return i.safePost("/payments/checkout",{requestBody:e,additionalHeaders:h(null,null,null,a?.skipSentinelCheckout?void 0:await C("chatgpt_checkout").catch(s=>{E.addError(s)}))})}static async fetchExistingCheckoutSession(e,a){return await i.safeGet("/payments/checkout/{processor_entity}/{checkout_session_id}",{parameters:{path:{processor_entity:e,checkout_session_id:a}}})}}const S="3950229590",T="enabled_custom_checkout_for_plus",f="enabled_custom_checkout_for_pro",p="enabled_custom_checkout_for_team",r="chatgpt_web_checkout_navigate_to_checkout",O="chatgpt_web_checkout_prepare_checkout_session";function A(o){switch(o){case n.PLUS:return T;case n.PRO:return f;case n.TEAM:return p;default:return null}}function H(o,e){const a=A(e);return a==null?"redirect":d(o,S).get(a,!1)?"custom":"redirect"}function v(){const o=m(),e=l();async function a(t){return t.checkout_ui_mode=H(e,t.plan_name),c(e,{eventName:O,metadata:{ui_mode:t.checkout_ui_mode}}),await g.getCheckoutLink(t)}async function s(t){if("tag"in t)switch(c(e,{eventName:r,metadata:{tag:t.tag}}),t.tag){case"hosted_checkout_session":case"redirect_to_portal":{window.location.href=t.url;break}case"custom_checkout_session":{const u=t.processor_entity,_=t.checkout_session_id;await o({pathname:k(u,_),search:"",hash:""});break}}else if(t.url)c(e,{eventName:r,metadata:{tag:"missing_tag"}}),window.location.href=t.url;else throw new Error("Received invalid response from /checkout")}return{prepareCheckoutSession:a,navigateToCheckout:s}}export{g as C,v as u};
//# sourceMappingURL=kfttpd1cc0u1rrbk.js.map

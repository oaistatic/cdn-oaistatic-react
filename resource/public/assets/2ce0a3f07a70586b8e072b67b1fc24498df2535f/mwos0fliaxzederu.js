import{h as A,r as n,j as g,d as k,b as R}from"./n97h6so7iblif4c5.js";import{nA as h,nB as C,nC as x,nD as M,kI as V,a as m,aY as I,c7 as B,aK as T,c as E,P as S,ap as _}from"./cim4usely8ixso70.js";import{S as L}from"./jb83q90w1lvgzhi5.js";import{S as j}from"./lnrdu7695dtoyi0c.js";import{aQ as O,b9 as G,dy as U,dz as D}from"./ivbsxyeeopn30y8l.js";import{u as Q}from"./dv0x3wwg6vtgq24d.js";import"./gy64pge8qevmvg7e.js";function W({audioAssetPointer:l,conversationId:e}){const a=A(),[i,s]=n.useState(!1),t=n.useRef(!0),[o,p]=n.useState(void 0),r=n.useRef(null),u=h(),d=C(c=>c.isPlaying&&c.sourceUrl===o),v=null,y=n.useCallback(()=>{const c=x();if(c)r.current?r.current.then(()=>{c.stop(),r.current=null}):c.stop();else return},[]);n.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),n.useEffect(()=>()=>{M().isPlaying&&y()},[y]);const P=n.useCallback(async()=>{if(!u||!t.current)return;s(!0);const{url:c}=await O.fetch(a,{asset:l,conversationId:e});s(!1),p(c),u.changeSource(c),r.current=u.play()},[l,e,u,a,v]);return{togglePlayback:n.useCallback(()=>{if(u)d?y():(V.messagePlayback.click(),P());else return},[d,P,u,y]),isPlaying:d,isLoading:i}}const Z=n.memo(function(e){const a=m(),i=I(a),s=B(e.conversationId),t=G(e.message);if(!i||!s||t)return null;const o=T.getAudioAssetPointers(e.message)[0];return o?g.jsx(q,{audioAssetPointer:o,conversationId:s}):g.jsx(w,{...e,conversationId:s})});function q({audioAssetPointer:l,conversationId:e}){const{isLoading:a,isPlaying:i,togglePlayback:s}=W({audioAssetPointer:l,conversationId:e}),t=()=>{S.logEventWithStatsig("ChatGPT Turn Action Voice Replay Clicked","chatgpt_turn_action_voice_replay"),s()};return g.jsx(b,{onClick:t,isPlaying:i,isLoading:a,playText:f.replay,playIcon:U})}function w({conversationId:l,message:e}){const{isLoading:a,isPlaying:i,togglePlayback:s}=Q({conversationId:l,messageId:e.id}),t=()=>{S.logEventWithStatsig("ChatGPT Turn Action Voice Read Aloud Clicked","chatgpt_turn_action_voice_read_aloud"),s()};return g.jsx(b,{onClick:t,isPlaying:i,isLoading:a,playText:f.play,playIcon:L})}function b({onClick:l,isPlaying:e,isLoading:a,playText:i,playIcon:s}){let t,o;const p=R(),r=m(),u=E(r,"1894790777");return a?(t=_,o=f.loading):e?(t=j,o=f.stop):(t=s,o=i),g.jsx(D,{icon:t,label:o?p.formatMessage(o):void 0,disabled:a,onClick:l,style:e||a?{visibility:"visible"}:void 0,testId:"voice-play-turn-action-button",asMenuItem:u,onSelect:d=>{d.preventDefault()}})}const f=k({replay:{id:"VoiceReadOutLoudButton.replay",defaultMessage:"Replay"},play:{id:"VoiceReadOutLoudButton.play",defaultMessage:"Read aloud"},stop:{id:"VoiceReadOutLoudButton.stop",defaultMessage:"Stop"},loading:{id:"VoiceReadOutLoudButton.loading",defaultMessage:"Loading"}});export{b as PlayButton,q as VoiceMessagePlaybackButton,Z as VoicePlayButton,w as VoiceReadAloudButton};
//# sourceMappingURL=mwos0fliaxzederu.js.map

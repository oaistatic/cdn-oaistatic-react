import{rz as se,kW as j,rA as ie,rB as ae,rC as le,eK as ue,eL as de,oW as q,q6 as I,D as R,rD as P,rE as f,rF as E,rG as D,rH as pe,rI as F,rJ as O,oY as ce,rK as me,oZ as Ne,e5 as B,go as U,ea as fe,ee as Me,rL as he,ih as ke}from"./cim4usely8ixso70.js";import{w as L,c as h,I as J,T as Y,t as xe,a as ge,b as ye,P as we,H as be,R as Ie}from"./nrw3240lakumkaii.js";import{M as T,N as M,D as _,F as Ee,G as Te}from"./bfek75jeyiiysrf0.js";import{bF as Z,v as Ae,oy as Ce}from"./ivbsxyeeopn30y8l.js";import{j as Q,H as w,k as De,l as _e}from"./mrd3z2p5ccxe8mcf.js";import{r as ve,a as Se,b as Pe,c as Oe,d as Re}from"./etbhwfh1r1wqhhd5.js";import{t as Le}from"./gqfz6erng10c6vcd.js";class $e extends T{unistNodeName(){return"link"}static proseMirrorMarkName(){return"link"}proseMirrorMarkSpec(){return{attrs:{href:{},title:{default:null},disabled:{default:!0}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM(e){return["a",{...e.attrs,...e.attrs.disabled?{href:void 0}:{}}]}}}unistNodeToProseMirrorNodes({node:e,convertedChildren:r,schema:n}){const{url:t,title:s}=e;return r.map(i=>i.mark(i.marks.concat([n.marks[this.proseMirrorMarkName()].create({href:t,title:s})])))}processConvertedUnistNode(e,r){return{type:this.unistNodeName(),url:r.attrs.href,...r.attrs.title!=null&&{title:r.attrs.title},children:[e]}}}class Be extends M{unistNodeName(){return"blockquote"}static proseMirrorNodeName(){return"blockquote"}proseMirrorNodeSpec(){return{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}>\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Mod->":se(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r}]}}function Ue(o,e,r,n){for(let t=0;t<e.length;t++){const{$from:s,$to:i}=e[t];let a=s.depth===0?o.inlineContent&&o.type.allowsMarkType(r):!1;if(o.nodesBetween(s.pos,i.pos,(l,d)=>{if(a)return!1;a=l.inlineContent&&l.type.allowsMarkType(r)}),a)return!0}return!1}function H(o){return/^\s*/.exec(o)?.[0]?.length??0}function K(o){return/\s*$/.exec(o)?.[0]?.length??0}function He(o,e,r){for(;e>0;){const n=e-1;if(!o.rangeHasMark(n,e,r))break;e=n}return e}function Ke(o,e,r){for(;e<o.content.size&&o.rangeHasMark(e,e+1,r);)e+=1;return e}function ze(o,e,r,n=null){const{selection:t}=o;if(!(t instanceof j))return!1;const{empty:s,$cursor:i,ranges:a}=t;if(s&&!i||!Ue(o.doc,a,r))return!1;if(i)r.isInSet(o.storedMarks||i.marks())?e(o.tr.removeStoredMark(r)):e(o.tr.addStoredMark(r.create(n)));else{const l=o.tr,d=!a.some(u=>o.doc.rangeHasMark(u.$from.pos,u.$to.pos,r));for(let u=0;u<a.length;u++){const{$from:p,$to:m}=a[u];let c=p.pos,N=m.pos;const k=o.doc.textBetween(c,N,`
`);if(/^\s*$/.test(k))continue;const y=p.nodeBefore?.text??"",g=p.nodeAfter?.text??"",v=m.nodeBefore?.text??"",oe=m.nodeAfter?.text??"";if(d){const A=H(g),S=K(v);c+A<N&&(c+=A,N-=S),c=He(o.doc,c,r),N=Ke(o.doc,N,r),l.removeMark(c,N,o.schema.marks[_.proseMirrorMarkName()]),l.addMark(c,N,r.create(n))}else{const A=K(y),S=H(oe);c-=A,N+=S,l.removeMark(c,N,r)}}e(l.scrollIntoView())}return!0}function z(o,e=null){return(r,n)=>n?ze(r,n,o,e):!0}class x extends J{markType;constructor(e,r){super(e,(n,t,s,i)=>this.markHandler(n,t,s,i)),this.markType=r}static markApplies(e,r,n){for(const t of r){const{$from:s,$to:i}=t;let a=s.depth===0?e.type.allowsMarkType(n):!1;if(e.nodesBetween(s.pos,i.pos,l=>a?!1:(a=l.inlineContent&&l.type.allowsMarkType(n),!0)),a)return!0}return!1}markHandler(e,r,n,t){if(!(e.selection instanceof j))return null;const s=e.doc.resolve(n),i=e.doc.resolve(t),a=[new ie(s,i)];if(!x.markApplies(e.doc,a,this.markType))return null;const l=e.doc.nodeAt(n)?.marks.map(u=>u.type)??[];l.push(this.markType);const d=e.tr.replaceWith(n,t,this.markType.schema.text(r[1]));for(const u of l)d.addMark(d.mapping.map(n),d.mapping.map(t),u.create(null));for(const u of l)d.removeStoredMark(u);return d.insertText(r[2])}}class Ve extends T{unistNodeName(){return"strong"}static proseMirrorMarkName(){return"strong"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM(){return["strong"]}}}proseMirrorInputRules(e){return[new x(/\*\*([^\s](?:.*[^\s])?)\*\*([\s\S])$/,e.marks[this.proseMirrorMarkName()]),new x(/__([^\s](?:.*[^\s])?)__([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Mod-b":z(r),"Mod-B":z(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return r.map(t=>t.mark(t.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const X=92,We=10,C="backslashEscape";function Ge(o,e,r){function n(t){return t==null||t===We?(o.exit(C),e(t)):r(t)}return t=>t!==X?r(t):(o.enter(C),o.consume(t),n)}function je(){return{text:{[X]:{name:C,tokenize:Ge}}}}function qe(){const o=this.data();o.micromarkExtensions??=[],o.micromarkExtensions.push(je()),o.fromMarkdownExtensions??=[],o.fromMarkdownExtensions.push({enter:{[C](e){this.enter({type:"break"},e),this.exit(e)}}})}class Fe extends M{unistNodeName(){return"break"}static proseMirrorNodeName(){return"hard_break"}proseMirrorNodeSpec(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],marks:_.proseMirrorMarkName(),toDOM(){return["br"]}}}proseMirrorKeymap(e){const r=ae(le,(t,s)=>(s&&s(t.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)),n=ue()||de();return{"Mod-Enter":r,"Shift-Enter":r,...n&&{"Ctrl-Enter":r}}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}unifiedInitializationHook(e){return e.use(qe)}}const Je="code_block",V="```\n";function Ye(o,e){const{start:r,end:n}=o;return r==null||n==null?null:{start:r+V.length+(e.lang??"").length,end:n-V.length}}class Ze extends M{dependencies(){return[new Y]}unistNodeName(){return"code"}static proseMirrorNodeName(){return Je}proseMirrorNodeSpec(){return{content:"text*",group:"block",code:!0,defining:!0,marks:[_.proseMirrorMarkName()].join(" "),attrs:{lang:{default:null},isDarkMode:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}}}proseMirrorInputRules(e){return[xe(/^\s{0,3}```$/,e.nodes[this.proseMirrorNodeName()])]}unistNodeToProseMirrorNodes({node:e,attrs:r,schema:n}){const{lang:t}=e;return h(this.proseMirrorNodeName(),n,q(e,n,{...r,...Ye(r,e)??{}}),{lang:t,...r})}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),value:r.map(n=>n.type==="startend"?n.children.map(t=>t.value).join(""):n.value).join(""),lang:e.attrs.lang}]}}class Qe extends M{unistNodeName(){return"textDirective"}customDirectiveName(){return I}static proseMirrorNodeName(){return I}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"inline*",atom:!0,attrs:{index:{default:null},displayLayout:{default:"inline"}},toDOM:e=>["span",{"data-type":"content-reference","data-content-reference-index":e.attrs.index,"data-display-layout":e.attrs.displayLayout},`:contentReference[oaicite:${e.attrs.index}]{index="${e.attrs.index}" displayLayout="${e.attrs.displayLayout}"}`],parseDOM:[{tag:'span[data-type="content-reference"]',getAttrs(e){return{index:e.getAttribute("data-index"),displayLayout:e.getAttribute("data-display-layout")||"inline"}}}]}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n}){if(!Z(e)||e.name!==I||e.type!==this.unistNodeName())return R.addError("ContentReferenceExtension: unistNodeToProseMirrorNodes: node is not a directive node or name is not contentReference",e),null;const t={index:e.attributes?.index,displayLayout:e.attributes?.displayLayout??"inline"};return r.nodes.contentReference.create(t,n)}proseMirrorNodeToUnistNodes(e,r){if(r.length!==1)return console.warn("ContentReferenceExtension: proseMirrorNodeToUnistNodes: convertedChildren.length != 1",r),[];const s=[{type:"text",value:r[0].children[0].value}];return[{type:"textDirective",name:I,attributes:{index:e.attrs.index,displayLayout:e.attrs.displayLayout},children:s,data:{hName:I,hProperties:{displayLayout:e.attrs.displayLayout,index:e.attrs.index}}}]}}class Xe extends M{unistNodeName(){return"thematicBreak"}static proseMirrorNodeName(){return"horizontal_rule"}proseMirrorNodeSpec(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}}}proseMirrorInputRules(e){return[new J(/^\s{0,3}(?:\*\*\*|---|___)\n$/,(r,n,t,s)=>r.tr.replaceWith(t,s,h(this.proseMirrorNodeName(),e,[])??[]))]}proseMirrorKeymap(e){return{"Mod-_":(r,n)=>(n&&n(r.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}}class er extends T{unistNodeName(){return"inlineCode"}static proseMirrorMarkName(){return"code"}proseMirrorMarkSpec(){return{inclusive:!1,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}proseMirrorInputRules(e){return[new x(/`([^\s](?:.*[^\s])?)`([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Ctrl-`":P(r)}}unistNodeToProseMirrorNodes({node:e,schema:r,attrs:n}){const t=q(e,r,n,[r.marks[this.proseMirrorMarkName()].create(n)]);return t?[t]:[]}processConvertedUnistNode(e){return{type:this.unistNodeName(),value:e.value}}}class rr extends M{unistNodeName(){return"inlineMath"}static proseMirrorNodeName(){return"inline_math"}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"text*",atom:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"span.inline-math",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["span",{class:"inline-math"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n,attrs:t}){const{value:s}=e;return h(this.proseMirrorNodeName(),r,n,{...t,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class tr extends T{unistNodeName(){return"emphasis"}static proseMirrorMarkName(){return"em"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"&&null}],toDOM(){return["em"]}}}proseMirrorInputRules(e){try{return[new x(new RegExp("(?<!\\*)\\*([^\\s*](?:.*[^\\s])?)\\*([^*])$"),e.marks[this.proseMirrorMarkName()]),new x(new RegExp("(?<!_)_([^\\s_](?:.*[^\\s])?)_([^_])$"),e.marks[this.proseMirrorMarkName()])]}catch(r){return R.addError(r),[]}}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Mod-i":P(r),"Mod-I":P(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return r.map(t=>t.mark(t.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const b="lineEndingBlank";function W(o){return o.type===b}const nr=({startIndex:o,endIndex:e,depth:r,isLastChild:n,parent:t=null})=>{const s=e-o;return r>0&&t?.type!=="list"?s:n||o===0?s-Math.floor((s+1)/2):s-Math.floor((s-1)/2)};function or(){const o=this.data();o.fromMarkdownExtensions??=[],o.fromMarkdownExtensions.push({enter:{lineEndingBlank(r){this.enter({type:b},r)}},exit:{lineEndingBlank(r){this.exit(r)}}});const e=(r,n=0)=>{if(!Q(r))return;const{children:t}=r;let s=0,i=null,a=null;const l=t.length;for(let d=0;d<l;d++){const u=t[d-s];e(u,n+1);const{type:p}=u,c=d===l-1&&p===b;if(p===b&&i==null?i=d:p!==b&&i!=null?a=d:c&&i!=null&&(a=d+1),i!=null&&a!=null){const N=nr({startIndex:i,endIndex:a,depth:n,isLastChild:c,parent:r});t.splice(i-s,N),i=null,a=null,s+=N}}};return r=>{e(r)}}class sr extends M{unistNodeName(){return b}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return ge}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(e,r){return[{type:ye,children:r}]}unifiedInitializationHook(e){return e.use(or)}}function ee(o,e=null){return function(r,n){let{$from:t,$to:s}=r.selection,i=t.blockRange(s),a=!1,l=i;if(!i)return!1;if(i.depth>=2&&t.node(i.depth-1).type.compatibleContent(o)&&i.startIndex==0){if(t.index(i.depth-1)==0)return!1;let u=r.doc.resolve(i.start-2);l=new O(u,u,i.depth),i.endIndex<i.parent.childCount&&(i=new O(t,r.doc.resolve(s.end(i.depth)),i.depth)),a=!0}let d=ce(l,o,e,i);return d?(n&&n(ir(r.tr,i,d,a,o).scrollIntoView()),!0):!1}}function ir(o,e,r,n,t){let s=f.empty;for(let u=r.length-1;u>=0;u--)s=f.from(r[u].type.create(r[u].attrs,s));o.step(new D(e.start-(n?2:0),e.end,e.start,e.end,new E(s,0,0),r.length,!0));let i=0;for(let u=0;u<r.length;u++)r[u].type==t&&(i=u+1);let a=r.length-i,l=e.start+r.length-(n?2:0),d=e.parent;for(let u=e.startIndex,p=e.endIndex,m=!0;u<p;u++,m=!1)!m&&F(o.doc,l,a)&&(o.split(l,a),l+=2*a),l+=d.child(u).nodeSize;return o}function ar(o,e){return function(r,n){let{$from:t,$to:s,node:i}=r.selection;if(i&&i.isBlock||t.depth<2||!t.sameParent(s))return!1;let a=t.node(-1);if(a.type!=o)return!1;if(t.parent.content.size==0&&t.node(-1).childCount==t.indexAfter(-1)){if(t.depth==3||t.node(-3).type!=o||t.index(-2)!=t.node(-2).childCount-1)return!1;if(n){let p=f.empty,m=t.index(-1)?1:t.index(-2)?2:3;for(let g=t.depth-m;g>=t.depth-3;g--)p=f.from(t.node(g).copy(p));let c=t.indexAfter(-1)<t.node(-2).childCount?1:t.indexAfter(-2)<t.node(-3).childCount?2:3;p=p.append(f.from(o.createAndFill()));let N=t.before(t.depth-(m-1)),k=r.tr.replace(N,t.after(-c),new E(p,4-m,0)),y=-1;k.doc.nodesBetween(N,k.doc.content.size,(g,v)=>{if(y>-1)return!1;g.isTextblock&&g.content.size==0&&(y=v+1)}),y>-1&&k.setSelection(pe.near(k.doc.resolve(y))),n(k.scrollIntoView())}return!0}let l=s.pos==t.end()?a.contentMatchAt(0).defaultType:null,d=r.tr.delete(t.pos,s.pos),u=l?[null,{type:l}]:void 0;return F(d.doc,t.pos,2,u)?(n&&n(d.split(t.pos,2,u).scrollIntoView()),!0):!1}}function lr(o){return function(e,r){let{$from:n,$to:t}=e.selection,s=n.blockRange(t,i=>i.childCount>0&&i.firstChild.type==o);return s?r?n.node(s.depth-1).type==o?ur(e,r,o,s):dr(e,r,s):!0:!1}}function ur(o,e,r,n){let t=o.tr,s=n.end,i=n.$to.end(n.depth);s<i&&(t.step(new D(s-1,i,s,i,new E(f.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new O(t.doc.resolve(n.$from.pos),t.doc.resolve(i),n.depth));const a=me(n);if(a==null)return!1;t.lift(n,a);let l=t.mapping.map(s,-1)-1;return Ne(t.doc,l)&&t.join(l),e(t.scrollIntoView()),!0}function dr(o,e,r){let n=o.tr,t=r.parent;for(let c=r.end,N=r.endIndex-1,k=r.startIndex;N>k;N--)c-=t.child(N).nodeSize,n.delete(c-1,c+1);let s=n.doc.resolve(r.start),i=s.nodeAfter;if(n.mapping.map(r.end)!=r.start+s.nodeAfter.nodeSize)return!1;let a=r.startIndex==0,l=r.endIndex==t.childCount,d=s.node(-1),u=s.index(-1);if(!d.canReplace(u+(a?0:1),u+1,i.content.append(l?f.empty:f.from(t))))return!1;let p=s.pos,m=p+i.nodeSize;return n.step(new D(p-(a?1:0),m+(l?1:0),p+1,m-1,new E((a?f.empty:f.from(t.copy(f.empty))).append(l?f.empty:f.from(t.copy(f.empty))),a?0:1,l?0:1),a?0:1)),e(n.scrollIntoView()),!0}function pr(o){return function(e,r){let{$from:n,$to:t}=e.selection,s=n.blockRange(t,d=>d.childCount>0&&d.firstChild.type==o);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=o)return!1;if(r){let d=l.lastChild&&l.lastChild.type==a.type,u=f.from(d?o.create():null),p=new E(f.from(o.create(null,f.from(a.type.create(null,u)))),d?3:1,0),m=s.start,c=s.end;r(e.tr.step(new D(m-(d?3:1),c,m,c,p,1,!0)).scrollIntoView())}return!0}}class $ extends M{unistNodeName(){return"listItem"}static proseMirrorNodeName(){return"regular_list_item"}proseMirrorNodeSpec(){return{content:"paragraph block*",defining:!0,group:"list_item",parseDOM:[{tag:"li"}],toDOM(){return["li",0]}}}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&(!("checked"in e)||typeof e.checked!="boolean")}proseMirrorKeymap(e){const r=e.nodes[this.proseMirrorNodeName()];return{Enter:ar(r),"Shift-Tab":lr(r),Tab:pr(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r}]}}class cr extends M{unistNodeName(){return"math"}static proseMirrorNodeName(){return"math_block"}proseMirrorNodeSpec(){return{group:"block",content:"text*",atom:!0,code:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"div.math-block",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["div",{class:"math-block"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n,attrs:t}){const{value:s}=e;return h(this.proseMirrorNodeName(),r,n,{...t,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class mr extends M{dependencies(){return[new $]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered===!0}static proseMirrorNodeName(){return"ordered_list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1},startingNumber:{default:1}},parseDOM:[{getAttrs(e){const r=e.getAttribute("start");return{spread:e.getAttribute("data-spread")==="true",startingNumber:r!=null?parseInt(r):1}},tag:"ol"}],toDOM(e){return["ol",{"data-spread":e.attrs.spread,start:e.attrs.startingNumber},0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}(\d+)\.\s$/,e.nodes[this.proseMirrorNodeName()],r=>({startingNumber:+r[1]}),(r,n)=>n.childCount+n.attrs.startingNumber===+r[1])]}proseMirrorKeymap(e){return{"Shift-Mod-9":ee(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n,attrs:t}){const{spread:s,start:i}=e;return h(this.proseMirrorNodeName(),r,n,{...t,spread:s,startingNumber:i??1})}proseMirrorNodeToUnistNodes(e,r){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!0,spread:n,start:e.attrs.startingNumber,children:r.map(t=>(t.spread=n,t))}]}}class Nr extends T{unistNodeName(){return"delete"}static proseMirrorMarkName(){return"strikethrough"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"s"},{tag:"del"},{style:"text-decoration",getAttrs:e=>/(^|[\s])line-through([\s]|$)/.test(e)&&null}],toDOM(){return["s"]}}}proseMirrorInputRules(e){return[new x(/~([^\s](?:.*[^\s~])?)~([^~])$/,e.marks[this.proseMirrorMarkName()]),new x(/~~([^\s](?:.*[^\s])?)~~([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r}){return r.map(n=>n.mark(n.marks.concat([e.marks[this.proseMirrorMarkName()].create()])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function fr(){return o=>{let e=-1;function r(t,s){if(t.type==="tableRow"&&e++,t.type==="tableCell"){const i=t;i.data={...i.data??{},rowIndex:e,columnIndex:s}}}function n(t){if(Q(t))for(let s=0;s<t.children.length;s++){const i=t.children[s];r(i,s),n(i)}}n(o)}}class re extends M{unistNodeName(){return"tableCell"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()}static proseMirrorNodeName(){return"table_cell"}proseMirrorNodeSpec(){return{content:"inline*",attrs:{rowIndex:{default:null},columnIndex:{default:null},colspan:{default:1},rowspan:{default:1}},tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs(e){const r=e;return{colspan:U(r.getAttribute("colspan"),1),rowspan:U(r.getAttribute("rowspan"),1)}}}],toDOM(e){const{colspan:r,rowspan:n}=e.attrs,t={colspan:r!==1?B(r,void 0):void 0,rowspan:n!==1?B(n,void 0):void 0};return[e.attrs.rowIndex==null||e.attrs.rowIndex>0?"td":"th",t,0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n,attrs:t}){return h(this.proseMirrorNodeName(),r,n,{...t,colspan:1,rowspan:1,rowIndex:e.data?.rowIndex,columnIndex:e.data?.columnIndex})}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r,data:{rowIndex:e.attrs.rowIndex,columnIndex:e.attrs.columnIndex}}]}}class te extends M{dependencies(){return[new re]}unistNodeName(){return"tableRow"}static proseMirrorNodeName(){return"table_row"}proseMirrorNodeSpec(){return{content:"(table_cell+)",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r}]}}class Mr extends M{dependencies(){return[new te]}unistNodeName(){return"table"}static proseMirrorNodeName(){return"table"}proseMirrorNodeSpec(){return{content:"(table_row+)",tableRole:"table",isolating:!0,group:"block",parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:n}){return h(this.proseMirrorNodeName(),e,r,n)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),align:[],children:r}]}unifiedInitializationHook(e){return e.use(fr)}}class hr extends M{dependencies(){return[new $]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered!==!0}static proseMirrorNodeName(){return"list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{getAttrs(e){return{spread:e.getAttribute("data-spread")==="true"}},tag:"ul"}],toDOM(e){return["ul",{"data-spread":e.attrs.spread},0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}([-+*])\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Shift-Mod-8":ee(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n,attrs:t}){const{spread:s}=e;return h(this.proseMirrorNodeName(),r,n,{...t,spread:s})}proseMirrorNodeToUnistNodes(e,r){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!1,spread:n,children:r.map(t=>(t.spread=n,t))}]}}function G(o,e){if(!(o==null||e==null))return{start:{...o},end:{...e}}}const kr=()=>o=>{Ae(o,"list",(e,r,n)=>{if(n==null||r==null)return;const t=[];let s=[],i=0;for(;i<e.children.length;){const a=e.children[i];if(W(a)){const l=[];for(;i<e.children.length&&W(e.children[i]);)l.push(e.children[i]),i++;if(s.length===0)throw new Error("Unexpected state: currentListItems is empty after encountering blank lines.");const d=s[0],u=fe(Me(s)),p=G(d.position?.start??e.position?.start,u.position?.end??e.position?.end),m={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:p};t.push(m),s=[],t.push(...l.map(c=>({type:"lineEndingBlank",position:c.position})))}else s.push(a),i++}if(s.length>0){const a=s[0],l=s[s.length-1],d=G(a.position?.start??e.position?.start,l.position?.end??e.position?.end),u={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:d};t.push(u)}n.children.splice(r,1,...t)})};class xr extends M{unistNodeName(){return"textDirective"}customDirectiveName(){return w}static proseMirrorNodeName(){return w}proseMirrorNodeSpec(){return{group:"inline",inline:!0,atom:!0,selectable:!1,attrs:{timestamp:{default:null}},toDOM:e=>["span",{"data-type":"hive-log","data-timestamp":e.attrs.timestamp}],parseDOM:[{tag:'span[data-type="hive-log"]',getAttrs(e){return{timestamp:e.getAttribute("data-timestamp")}}}]}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:n}){if(!Z(e)||e.name!==w||e.type!==this.unistNodeName())return R.addError("HiveLogExtension: unistNodeToProseMirrorNodes: node is not a directive node or name is not HIVE_LOG_DIRECTIVE_NAME",e),null;const t={timestamp:e.attributes?.timestamp??null};return r.nodes[w].create(t,n)}proseMirrorNodeToUnistNodes(e){return[{type:"textDirective",name:w,attributes:{timestamp:e.attrs.timestamp},children:[],data:{hName:w,hProperties:{timestamp:e.attrs.timestamp}}}]}}const gr=(o,e,r,n)=>o.children.map(t=>r.handle(t,void 0,r,n)).join(""),yr=(o,e,r,n)=>r.safe(o.value,n).replaceAll("\\[","[").replaceAll("\\&","&"),wr=o=>`\\(${o.value}\\)`;function br(){const o=this;o.compiler=e;function e(r){return Le(r,{...o.data("settings"),fences:!0,bullet:"-",bulletOther:"*",listItemIndent:"one",resourceLink:!0,tightDefinitions:!0,rule:"-",handlers:{text:yr,startend:gr,inlineMath:wr},extensions:o.data("toMarkdownExtensions")||[]})}}const ne=[Ce,ve,[Se,{singleDollarTextMath:!1}],Pe,Oe,Re,De,kr,br,_e];class Ir extends Ee{dependencies(){const e=he(ke());return[new sr,new we,new Be,new Ve,new Fe,new Ze,new be,new Xe,new er,new rr,new cr,new tr,new $e,new $,new mr,new Ie,new Y,new hr,new Nr,new _,new Mr,new te,new re,...e?[new Qe]:[],...Te()?[new xr]:[]]}unifiedInitializationHook(e){return e.use(ne)}}const Sr=Object.freeze(Object.defineProperty({__proto__:null,CANVAS_REMARK_PLUGINS:ne,MarkdownExtension:Ir},Symbol.toStringTag,{value:"Module"}));export{Ve as B,Qe as C,tr as I,$e as L,Ir as M,Je as a,Ze as b,Sr as p,ze as t};
//# sourceMappingURL=bobuk6c13l8l3581.js.map

import{j as e,b as w,M as T,g as I,r as C,m as F}from"./n97h6so7iblif4c5.js";import{i as P,d as O,b as ee,T as te}from"./mrd3z2p5ccxe8mcf.js";import{dL as ae,bx as W,cE as se,cu as q,gf as oe,b as ne,bH as K,bM as z,bL as de,lk as le,ll as re,lm as ce,bp as ie}from"./ivbsxyeeopn30y8l.js";import{u as me,c as xe,D as fe}from"./ltncr5s1j4b4kz0c.js";import{aN as ue,d as j,ao as y,cO as k,B as G,oL as he,ee as be,kl as V}from"./cim4usely8ixso70.js";import{S as pe}from"./o17rnazzbayshz54.js";import{r as ge}from"./kinvcw3l5cx6b6nu.js";import{C as _,T as je}from"./fshn6t6aiqhkifzj.js";import{g as ye}from"./btagl6w1gub4aw61.js";import"./i8vgytiaizzymmdx.js";import"./jy1u8exw8iz2slve.js";import"./hl263mv5vjd6fe09.js";import"./bcnsse8l7ak9ome8.js";import"./grt0jtahkb4l594u.js";function ve({textdocVersion:l,clientThreadId:n}){const{handleCopy:d,copyLabel:x}=me({textdocVersion:l,clientThreadId:n}),c=!ue();return e.jsx(ae,{onCopy:d,className:"py-1",iconClassName:j("icon-md",!c&&"hidden"),iconOnly:c,buttonText:c?void 0:x})}function ke({textdocVersion:l,disabled:n}){const d=w(),{handleFileDownload:x,handleBlobDownload:c,isLoading:f,downloadCopyLabel:u,isDocument:a}=xe(l);return a?e.jsxs(y.Root,{open:!f&&!n?void 0:!1,children:[e.jsx(y.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:u,children:e.jsx(W,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{align:"end",children:[e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("pdf")},children:d.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("docx")},children:d.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("md")},children:d.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:u,children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||n,onClick:c,children:e.jsx(W,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||n,onClick:c,children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function Ne({onClick:l}){const n=w();return e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none",onClick:l,children:[e.jsx(k,{label:e.jsx(T,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(se,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Me({onClick:l,disabled:n}){const d=w();return n?e.jsx(G,{className:"-me-2 -mb-1 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(k,{label:e.jsx(T,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(q,{className:"icon-md block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"Al1dzr",defaultMessage:"Run code"})})]})}):e.jsxs(G,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:l,disabled:!1,children:[e.jsx(k,{label:e.jsx(T,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(q,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"Al1dzr",defaultMessage:"Run code"})})]})}var B,J;function Ce(){if(J)return B;J=1;var l=ge(),n=oe(),d=he(),x=parseFloat,c=Math.min,f=Math.random;function u(a,t,r){if(r&&typeof r!="boolean"&&n(a,t,r)&&(t=r=void 0),r===void 0&&(typeof t=="boolean"?(r=t,t=void 0):typeof a=="boolean"&&(r=a,a=void 0)),a===void 0&&t===void 0?(a=0,t=1):(a=d(a),t===void 0?(t=a,a=0):t=d(t)),a>t){var s=a;a=t,t=s}if(r||a%1||t%1){var h=f();return c(a+h*(t-a+x("1e-"+((h+"").length-1))),t)}return l(a,t)}return B=u,B}var we=Ce();const De=I(we),Ee=({isCanvasHovered:l=!1,onClick:n})=>{const d=w();return e.jsx(k,{label:d.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(ie,{color:l?"primary":"secondary",icon:pe,onClick:n})})},Le=({textdocId:l,clientThreadId:n,name:d,tag:x,icon:c,iconSelected:f,marginBottom:u,size:a="large",height:t=a==="large"?"22rem":"10rem",minHeight:r,isCanvasOpen:s=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:D=!1,isInlinePreview:o=!1,isStreaming:p=!1,isUserMessage:g=!1,onClick:N,onPreview:E,children:L})=>{const S=C.useRef(null),[v,A]=C.useState(!1),[Z]=C.useState(()=>De(100,180,!1)),i=be(ne(l)?.versions),m=K(),M=!m,Q=i==null||p,X=i&&i.type!==z.LOADING&&(P(i.type,i.content)||O(i.type)),R=b&&s?f??c:c,Y=R?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!v}),children:R}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(V,{lines:1,size:"base",width:100,widthVariance:0})}),H=i?.type&&de(i.type)?ee(i.type):void 0,$=!d||D?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:Z},children:e.jsx(V,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":m}),children:d}),m&&H&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",H]})]}),U=()=>{!S.current||h||(le.logButtonClick(re.MESSAGE_ATTACHMENT,{type:x}),ce(S.current),N?.())};return e.jsxs(F.div,{role:M?"button":void 0,id:ye(l),initial:{opacity:p?0:1,scale:p?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:m?0:.72},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border",m?"overflow-visible":"overflow-hidden",h?"cursor-default":M?"cursor-pointer":"cursor-text",{"select-none":M,"border-token-text-tertiary font-medium dark:border-gray-600":b&&s,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!o,"rounded-[20px]":!s&&o,"max-w-full":!g&&(s||!o),"max-w-[var(--user-chat-width,70%)]":g&&(s||!o),"w-full":!g&&!s&&o,"w-[var(--user-chat-width,70%)]":g&&!s&&o,"w-full py-3 sm:-mx-6 sm:w-[calc(100%+3rem)] sm:max-w-none":o&&m}),onMouseEnter:()=>!h&&A(!0),onMouseLeave:()=>A(!1),onClick:()=>M?U():void 0,ref:S,style:{marginBottom:u,height:o&&!s?t:void 0,minHeight:o&&!s?r:void 0,width:a==="small"?"300px":void 0},children:[e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!v&&!b,"border-token-border-heavy":v&&!b,"text-token-text-primary text-sm font-medium":!s&&v&&o,"py-2":s||!o,"py-3":!m&&!s&&o,"text-token-text-secondary text-sm font-medium":!s&&!v&&o,"pt-0 pb-2 sm:px-6":m}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":s||!o,"gap-3.5":!s&&o}),children:[!m&&Y,$]}),s?e.jsx(F.span,{animate:p?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:p&&e.jsx(te,{gap:1,padding:0})}):e.jsx(Ee,{isCanvasHovered:v,onClick:N})]}),m&&o&&!h?e.jsx("div",{className:"sticky top-13 z-20 @[84rem]/thread:top-2",children:e.jsx("div",{className:j("text-token-text-secondary bg-token-bg-primary dark:bg-token-bg-elevated-secondary absolute end-0 bottom-0 z-20 me-5 flex flex-row items-center justify-end gap-4 rounded-se-lg rounded-es-lg ps-3 pe-1 pt-2 pb-3 font-sans text-sm font-normal"),children:m&&!s?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ve,{textdocVersion:i??null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ne,{onClick:N})}),i&&i.type!==z.LOADING&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ke,{disabled:Q,textdocVersion:i})}),X&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Me,{disabled:p,onClick:E})})]}):null})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&L,o&&!s&&!m&&e.jsx(_,{size:a,position:"bottom"}),o&&a==="small"&&!s&&!m&&e.jsx(_,{size:a,position:"right"})]})]})},Ke=({textdocId:l,clientThreadId:n,name:d,tag:x,icon:c,iconSelected:f,isCanvasOpen:u=!1,isFetching:a=!1,isFocused:t=!1,isInlinePreview:r=!1,isStreaming:s=!1,isUserMessage:h=!1,onClick:b,onPreview:D})=>{const[o,p]=C.useState(!1),g=K(),N=L=>{p(L>0)},E=r&&!u?16:12;return e.jsx(Le,{textdocId:l,name:d,tag:x,icon:c,height:g?"auto":void 0,iconSelected:f,marginBottom:E,isCanvasOpen:u,isFocused:t,isInlinePreview:r,isStreaming:s,isUserMessage:h,onClick:b,onPreview:D,clientThreadId:n,children:r&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":o,"border-transparent":!o}),children:a&&!(g&&s)?e.jsx(fe,{numLines:20}):!!l&&e.jsx(je,{disableScroll:g,onScroll:N,textdocId:l,clientThreadId:n})})})};export{Ke as CanvasMessageAttachment,Le as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=j24szce2jnztdttb.js.map

import{nc as j,at as w,ap as y,l9 as b}from"./cim4usely8ixso70.js";import{O as M,j as n,ah as C,b as N,a as k,h as A,l as F,M as p}from"./n97h6so7iblif4c5.js";import{bB as W}from"./ivbsxyeeopn30y8l.js";import{R as P,I as r,S as l}from"./ehnmsce61vjj8rn5.js";import{E as R,R as T,g as U}from"./ov9u1x68nknca99d.js";import{u as O}from"./iip0aexkuex6pzm2.js";import{d as B,W as D,a as I,e as L}from"./div7mikai9oktr1k.js";import{W as $}from"./bmpzqkm3kd9i8aru.js";import"./hx105puy0d3w8mfb.js";import"./fwr52dd08mur3244.js";import"./k45qpq5qounxd734.js";import"./g2in2vnq3t76stbi.js";import"./lptwpbjabrvjmhsj.js";import"./hsw7srghcuy9year.js";import"./k4l1dpzf5fkrs339.js";import"./lnrdu7695dtoyi0c.js";import"./ond0ck4gkjbbzc2w.js";import"./dkmxfpfv7adi2gnr.js";import"./bcnsse8l7ak9ome8.js";import"./n9mme9cj317etxuq.js";import"./gdos2bpc3gh55vkr.js";import"./gqfz6erng10c6vcd.js";import"./mtefsnq6d12ypkte.js";import"./k5qf6pgck1wqkdil.js";import"./jdpqs7fyetm56n9m.js";import"./eiqndj5deifk5sx6.js";import"./d4sun4qb1kdekaz8.js";import"./dc0g1vvwfzc619ae.js";import"./lln26ytjpbr3ilrw.js";import"./iwqs8qhqagaobv5t.js";function q(){const{environmentId:s}=M(),{eligible:i}=W();return i?n.jsx(C,{to:"/codex/onboarding"}):s?n.jsx(z,{environmentId:s}):n.jsx(j,{})}function z({environmentId:s}){const i=N(),o=w(),g=k(),m=A(),{data:e,isLoading:h,isError:v}=B(s),d=e?.secrets??{},x=O()?"workspace":"private",{mutate:E,isPending:_}=F({mutationFn:t=>D.updateEnvironment(s,t),onSuccess:async t=>{await I(m,s),L(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function f(t){const a=U(t.secrets,d),S=t.envVars.reduce((c,u)=>(c[u.key]=u.value,c),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:S,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return n.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(y,{})}):v?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?n.jsxs(n.Fragment,{children:[n.jsxs(P,{className:"sticky top-0 px-4",children:[n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),n.jsx(l,{}),n.jsx(r,{label:e.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),n.jsx(l,{}),n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),n.jsx(R,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e?.label,description:e?.description??"",share_settings:e?.share_settings??x,machine:e?.machine_id,repositoryId:e?.repos[0],workspaceDirectory:e?.workspace_dir??"",agentNetworkAccess:e?.agent_network_access,setupCommands:e?.setup?Array.isArray(e?.setup)?e.setup.join(`
`):e.setup:"",maintenanceSetupCommands:e?.maintenance_setup?Array.isArray(e?.maintenance_setup)?e.maintenance_setup.join(`
`):e.maintenance_setup:"",envVars:Object.entries(e?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(d).map(t=>({key:t,value:T,isEditing:!1})),autoSetupSettings:e?.auto_setup_settings,cacheSettings:e?.cache_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:f,isPending:_})]}):n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const je=()=>[{title:"Codex"}],we=b(function(){return n.jsx(q,{})});export{we as default,je as meta};
//# sourceMappingURL=f28286d8m1uqqf0z.js.map

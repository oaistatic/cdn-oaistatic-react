import{bZ as He,p3 as Ie,pe as qe,pf as I,pg as We,ph as L,pi as Ge,pj as fe,d5 as pe,cF as $e,v as x,pk as Ke,pl as de,pm as q,pn as ze,bG as T,oy as me,bF as Ye,iM as Ve}from"./ivbsxyeeopn30y8l.js";import{h9 as M,P as b,C as Qe,bx as Xe,B as Je,D as Ze,a as et,c7 as tt,bM as nt,d as st,aF as rt,s as S,N as E,fJ as ge,aG as ot,at,cO as it,ap as ct,nk as lt,nl as he,R as ut,x as ft,h8 as pt,a4 as ye,a_ as dt,d5 as mt,d1 as gt,ei as ht,rY as yt,q as bt,q6 as be,rZ as _t}from"./cim4usely8ixso70.js";import{r as _,b as _e,j as f,M as W,R as P,h as wt,d as xt,u as Nt}from"./n97h6so7iblif4c5.js";import{u as kt}from"./nswfjkfs26me74ly.js";import{r as Ct,c as St}from"./gdos2bpc3gh55vkr.js";import{f as Et,r as Lt,a as vt,b as At,c as Mt,d as Dt,s as C,e as G}from"./etbhwfh1r1wqhhd5.js";import{f as we,p as $,n as K,h as xe,s as B,w as U,a as Rt,r as Tt}from"./pbiqteblhqytzrov.js";import{k as z}from"./pc2givv05uuq8g6l.js";function Ot({onClose:e,url:s,onAction:n,onActionAborted:t}){const r=_.useRef(!1),i=_e(),{clientThreadId:o}=He(),c={...M({clientThreadId:o}),url:s,link_type:"text",section:"safe-link-modal"};_.useEffect(()=>{b.logEventWithStatsig("Safe Link Warning Modal Shown","chatgpt_safe_link_warning_modal_shown")},[]);const l=async()=>{r.current=!0;try{await navigator.clipboard.writeText(s),b.logEventWithStatsig("Safe Link Warning Modal Copy Clicked","chatgpt_safe_link_warning_modal_copy_clicked"),b.logEventWithStatsig("link_action","link_action",{...c,action:"copy"})}catch(g){Ze.addError(g)}n?.("copy"),e()},u=()=>{r.current=!0,b.logEventWithStatsig("Safe Link Warning Modal Open Clicked","chatgpt_safe_link_warning_modal_open_clicked"),b.logEventWithStatsig("link_action","link_action",{...c,action:"click"}),n?.("open"),e()},m=()=>{r.current||(b.logEventWithStatsig("Safe Link Warning Modal Canceled","chatgpt_safe_link_warning_modal_canceled"),t?.()),r.current=!1,e()};let w="",p=s,h="";try{p=new URL(s).hostname;const y=s.indexOf(p);y!==-1&&(w=s.substring(0,y),h=s.substring(y+p.length))}catch{}return f.jsxs(Qe,{testId:"modal-safe-link-warning",isOpen:!0,hideSeparator:!0,onClose:m,showCloseButton:!0,type:"warning",title:f.jsx("div",{className:"flex items-center gap-2",children:i.formatMessage({id:"dTWOFM",defaultMessage:"This link may be unsafe"})}),primaryButton:f.jsx(Je,{as:"link",openNewTab:!0,rel:"noopener noreferer",color:"primary",onClick:u,to:s,children:i.formatMessage({id:"gMzmDW",defaultMessage:"Open link"})}),secondaryButton:f.jsx(Xe.Button,{title:i.formatMessage({id:"YGLt71",defaultMessage:"Copy link"}),color:"secondary",onClick:l}),children:[f.jsxs("p",{className:"text-token-text-secondary mb-6 text-sm text-pretty",children:[f.jsx(W,{defaultMessage:"This website may access your conversation data. Make sure you trust this link before proceeding.",id:"safe-link-warning-modal-description"}),f.jsx("a",{className:"hover:text-token-link-hover ps-1 underline underline-offset-1",href:"https://help.openai.com/en/articles/10984597-chatgpt-generated-links",target:"_blank",rel:"noopener noreferrer",children:f.jsx(W,{id:"xNvPsR",defaultMessage:"Learn more"})})]}),f.jsxs("div",{className:"mb-2 text-sm break-all",children:[f.jsx("span",{className:"text-token-text-secondary",children:w}),f.jsx("span",{className:"text-token-text-primary font-medium",children:p}),f.jsx("span",{className:"text-token-text-secondary",children:h})]})]})}const Y={},V={},Q={};function X(e,s){return`${e}::${s}`}function jt({node:e,onClick:s,children:n,clientThreadId:t,messageId:r,href:i,disableSafeURLs:o,...a}){let c=s;const l=e?.properties?.href,u=_.useContext(Ie),m=et(),w=tt(t),p=kt(w,i,u?.useSafeUrls&&!o),h=nt(m,"387775177"),g=!o&&p===void 0&&h.get("enable-copy-and-open",!1);return r!=null&&typeof l=="string"&&l.includes("/bing/redirect")&&(Y[r]||(b.logEvent("Browsing Show Bing Link",{id:r,content:l}),Y[r]=!0),c=y=>{V[r]||(b.logEvent("Browsing Click Bing Link",{id:r,content:l}),V[r]=!0),s?.(y)}),c=y=>{const N=""+l;if(r&&!Q[X(r,N)]){const v=p||g?"URL Clicked Allowed":"URL Clicked Blocked";b.logEvent(v,{id:r,content:N}),Q[X(r,N)]=!0}s?.(y),g&&i&&rt(m,Ot,{url:i})},f.jsx(f.Fragment,{children:f.jsx("a",{onClick:c,...a,className:st(a.className,g&&"cursor-pointer"),href:p,rel:"noopener",children:n})})}const As="w";function Ft({messageId:e,clientThreadId:s,text:n,children:t,...r}){const o=`${window.location.origin}?q=${encodeURIComponent(n)}`,a=qe(),c=_.useCallback(async l=>{l.preventDefault(),S.count(E.DEFAULT,"instant_follow_up_anchor_clicked"),b.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:s,messageId:e}),a(l,{text:n,type:ge.Reply},[],0)},[s,e,n,a]);return f.jsx(jt,{...r,href:o,disableSafeURLs:!0,clientThreadId:s,messageId:e,className:"cursor-pointer",onClick:c,children:t})}const Ms=P.memo(Ft),J=/[#.]/g;function Pt(e,s){const n=e||"",t={};let r=0,i,o;for(;r<n.length;){J.lastIndex=r;const a=J.exec(n),c=n.slice(r,a?a.index:n.length);c&&(i?i==="#"?t.id=c:Array.isArray(t.className)?t.className.push(c):t.className=[c]:o=c,r+=c.length),a&&(i=a[0],r++)}return{type:"element",tagName:o||s||"div",properties:t,children:[]}}const Bt=new Set(["button","menu","reset","submit"]),O={}.hasOwnProperty;function Ne(e,s,n){const t=n&&qt(n);function r(i,o,...a){let c=-1,l;if(i==null){l={type:"root",children:[]};const u=o;a.unshift(u)}else if(l=Pt(i,s),l.tagName=l.tagName.toLowerCase(),t&&O.call(t,l.tagName)&&(l.tagName=t[l.tagName]),Ut(o,l.tagName)){let u;for(u in o)O.call(o,u)&&Ht(e,l.properties,u,o[u])}else a.unshift(o);for(;++c<a.length;)j(l.children,a[c]);return l.type==="element"&&l.tagName==="template"&&(l.content={type:"root",children:l.children},l.children=[]),l}return r}function Ut(e,s){return e==null||typeof e!="object"||Array.isArray(e)?!1:s==="input"||!e.type||typeof e.type!="string"?!0:"children"in e&&Array.isArray(e.children)?!1:s==="button"?Bt.has(e.type.toLowerCase()):!("value"in e)}function Ht(e,s,n,t){const r=we(e,n);let i=-1,o;if(t!=null){if(typeof t=="number"){if(Number.isNaN(t))return;o=t}else typeof t=="boolean"?o=t:typeof t=="string"?r.spaceSeparated?o=I(t):r.commaSeparated?o=$(t):r.commaOrSpaceSeparated?o=I($(t).join(" ")):o=Z(r,r.property,t):Array.isArray(t)?o=t.concat():o=r.property==="style"?It(t):String(t);if(Array.isArray(o)){const a=[];for(;++i<o.length;){const c=Z(r,r.property,o[i]);a[i]=c}o=a}if(r.property==="className"&&Array.isArray(s.className)){const a=o;o=s.className.concat(a)}s[r.property]=o}}function j(e,s){let n=-1;if(s!=null)if(typeof s=="string"||typeof s=="number")e.push({type:"text",value:String(s)});else if(Array.isArray(s))for(;++n<s.length;)j(e,s[n]);else if(typeof s=="object"&&"type"in s)s.type==="root"?j(e,s.children):e.push(s);else throw new Error("Expected node, nodes, or string, got `"+s+"`")}function Z(e,s,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||K(n)===K(s)))return!0}return n}function It(e){const s=[];let n;for(n in e)O.call(e,n)&&s.push([n,e[n]].join(": "));return s.join("; ")}function qt(e){const s={};let n=-1;for(;++n<e.length;)s[e[n].toLowerCase()]=e[n];return s}const Wt=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Gt=Ne(xe,"div"),$t=Ne(B,"g",Wt),D={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"};function Kt(e,s){return ke(e,{})||{type:"root",children:[]}}function ke(e,s){const n=zt(e,s);return n&&s.afterTransform&&s.afterTransform(e,n),n}function zt(e,s){switch(e.nodeType){case 1:return Xt(e,s);case 3:return Vt(e);case 8:return Qt(e);case 9:return ee(e,s);case 10:return Yt();case 11:return ee(e,s);default:return}}function ee(e,s){return{type:"root",children:Ce(e,s)}}function Yt(){return{type:"doctype"}}function Vt(e){return{type:"text",value:e.nodeValue||""}}function Qt(e){return{type:"comment",value:e.nodeValue||""}}function Xt(e,s){const n=e.namespaceURI,t=n===D.svg?$t:Gt,r=n===D.html?e.tagName.toLowerCase():e.tagName,i=n===D.html&&r==="template"?e.content:e,o=e.getAttributeNames(),a={};let c=-1;for(;++c<o.length;)a[o[c]]=e.getAttribute(o[c])||"";return t(r,a,Ce(i,s))}function Ce(e,s){const n=e.childNodes,t=[];let r=-1;for(;++r<n.length;){const i=ke(n[r],s);i!==void 0&&t.push(i)}return t}new DOMParser;function Jt(e,s){const n=Zt(e);return Kt(n)}function Zt(e){const s=document.createElement("template");return s.innerHTML=e,s.content}const te=function(e,s,n){const t=We(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof s=="number"){if(s<0||s===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(s=e.children.indexOf(s),s<0)throw new Error("Expected child node or index");for(;++s<e.children.length;)if(t(e.children[s],s,e))return e.children[s]},ne=/\n/g,se=/[\t ]+/g,F=L("br"),re=L(cn),en=L("p"),oe=L("tr"),tn=L(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",an,ln]),Se=L(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function nn(e,s){const n=s||{},t="children"in e?e.children:[],r=Se(e),i=ve(e,{whitespace:n.whitespace||"normal"}),o=[];(e.type==="text"||e.type==="comment")&&o.push(...Le(e,{breakBefore:!0,breakAfter:!0}));let a=-1;for(;++a<t.length;)o.push(...Ee(t[a],e,{whitespace:i,breakBefore:a?void 0:r,breakAfter:a<t.length-1?F(t[a+1]):r}));const c=[];let l;for(a=-1;++a<o.length;){const u=o[a];typeof u=="number"?l!==void 0&&u>l&&(l=u):u&&(l!==void 0&&l>-1&&c.push(`
`.repeat(l)||" "),l=-1,c.push(u))}return c.join("")}function Ee(e,s,n){return e.type==="element"?sn(e,s,n):e.type==="text"?n.whitespace==="normal"?Le(e,n):rn(e):[]}function sn(e,s,n){const t=ve(e,n),r=e.children||[];let i=-1,o=[];if(tn(e))return o;let a,c;for(F(e)||oe(e)&&te(s,e,oe)?c=`
`:en(e)?(a=2,c=2):Se(e)&&(a=1,c=1);++i<r.length;)o=o.concat(Ee(r[i],e,{whitespace:t,breakBefore:i?void 0:a,breakAfter:i<r.length-1?F(r[i+1]):c}));return re(e)&&te(s,e,re)&&o.push("	"),a&&o.unshift(a),c&&o.push(c),o}function Le(e,s){const n=String(e.value),t=[],r=[];let i=0;for(;i<=n.length;){ne.lastIndex=i;const c=ne.exec(n),l=c&&"index"in c?c.index:n.length;t.push(on(n.slice(i,l).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),i===0?s.breakBefore:!0,l===n.length?s.breakAfter:!0)),i=l+1}let o=-1,a;for(;++o<t.length;)t[o].charCodeAt(t[o].length-1)===8203||o<t.length-1&&t[o+1].charCodeAt(0)===8203?(r.push(t[o]),a=void 0):t[o]?(typeof a=="number"&&r.push(a),r.push(t[o]),a=0):(o===0||o===t.length-1)&&r.push(0);return r}function rn(e){return[String(e.value)]}function on(e,s,n){const t=[];let r=0,i;for(;r<e.length;){se.lastIndex=r;const o=se.exec(e);i=o?o.index:e.length,!r&&!i&&o&&!s&&t.push(""),r!==i&&t.push(e.slice(r,i)),r=o?i+o[0].length:i}return r!==i&&!n&&t.push(""),t.join(" ")}function ve(e,s){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":s.whitespace;case"textarea":return"pre-wrap"}}return s.whitespace}function an(e){return!!(e.properties||{}).hidden}function cn(e){return e.tagName==="td"||e.tagName==="th"}function ln(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const un={},fn=[];function Ae(e){const s=e||un;return function(n,t){Ge(n,"element",function(r,i){const o=Array.isArray(r.properties.className)?r.properties.className:fn,a=o.includes("language-math"),c=o.includes("math-display"),l=o.includes("math-inline");let u=c;if(!a&&!c&&!l)return;let m=i[i.length-1],w=r;if(r.tagName==="code"&&a&&m&&m.type==="element"&&m.tagName==="pre"&&(w=m,m=i[i.length-2],u=!0),!m)return;const p=nn(w,{whitespace:"pre"});let h;try{h=z.renderToString(p,{...s,displayMode:u,throwOnError:!0})}catch(y){const N=y,v=N.name.toLowerCase();t.message("Could not render math with KaTeX",{ancestors:[...i,r],cause:N,place:r.position,ruleId:v,source:"rehype-katex"}),v==="parseerror"?h=z.renderToString(p,{...s,displayMode:u,strict:"ignore",throwOnError:!1}):h=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(s.errorColor||"#cc0000"),title:String(y)},children:[{type:"text",value:p}]}]}typeof h=="string"&&(h=Jt(h).children);const g=m.children.indexOf(w);return m.children.splice(g,1,...h),fe})}}function pn(e){Et(e,[/\r?\n|\r/g,dn])}function dn(){return{type:"break"}}function mn(){return function(e){pn(e)}}const Me="sandbox:";function Ds({messageId:e,clientThreadId:s,href:n,...t}){const r=wt(),[i,o]=_.useState(!1),a=n.substring(Me.length),c=ot(s),l=_e(),u=at(),m=_.useCallback(g=>{const y=document.createElement("a");y.href=g,y.click(),o(!1)},[]),w=_.useCallback(g=>{o(!1),u.danger(g,{toastId:"file_download_failed"})},[u]),p=hn(i,e,c,a,w,m).data,h=_.useCallback(async g=>{s!==void 0&&(g.preventDefault(),(p===void 0||p?.status!=="success")&&r.invalidateQueries({queryKey:De(e,a)}),p?.status==="success"&&p?.download_url?m(p.download_url):o(!0))},[s,p,r,e,a,m]);return f.jsx(it,{closeOnOutsideClick:!1,label:f.jsxs("span",{className:"flex items-center gap-1",children:[i?l.formatMessage(ae.startingDownload):l.formatMessage(ae.downloadFile),i&&f.jsx(ct,{})]}),side:"top",children:f.jsx("a",{...t,className:"cursor-pointer",onClick:g=>!i&&h(g)})})}async function gn(e,s,n){const t=await ut.safeGet("/conversation/{conversation_id}/interpreter/download",{parameters:{path:{conversation_id:s},query:{message_id:e,sandbox_path:n}}});if(t.status===ft.Success)return t;throw new he("Could not download file from advanced data analysis","error_code"in t?t.error_code:"unknown_error")}function hn(e,s,n,t,r,i){const o=lt();return Nt({queryKey:De(s,t),queryFn:()=>gn(s,n,t).then(a=>(a?.status==="success"&&i(a.download_url),a)).catch(a=>{let c=o("default_download_link_error",{fileName:t});throw a instanceof he&&a.code!=null&&(c=o(a.code)),r?.(c),a}),enabled:!!(e&&s&&n&&t)})}function De(e,s){return["downloadSandboxLink",e,s]}const ae=xt({downloadFile:{id:"SandboxDownload.downloadFile",defaultMessage:"Download file"},startingDownload:{id:"SandboxDownload.startingDownload",defaultMessage:"Starting download"}}),Rs="f",Ts="dr",Re=(e,s,n=!1)=>{const t=_.useRef(!1);_.useEffect(()=>{t.current||(t.current=!0,S.count(E.DEFAULT,"clickable_follow_up_text_shown"),n&&S.count(E.DEFAULT,"clickable_follow_up_deep_research_text_shown"),b.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...M({clientThreadId:e,messageId:s})}))},[e,s,n])},Te=({messageId:e,clientThreadId:s,text:n})=>{const t=pe(s),r=pt.useStore(),i=ye(s);Re(s,e,!1);const o=_.useCallback(a=>{a.preventDefault(),S.count(E.DEFAULT,"clickable_follow_up_text_clicked"),b.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",M({clientThreadId:s,messageId:e}));const c=r.getActiveSystemHintType();t({sourceEvent:a,promptMessage:mt(n.toLowerCase(),{suggestion_type:ge.Reply}),completionMetadata:{systemHints:c?[c]:[],conversationMode:i??{kind:dt.PrimaryAssistant}}})},[s,i,e,r,t,n]);return f.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:n})},yn=({messageId:e,clientThreadId:s,text:n})=>f.jsx(Te,{messageId:e,clientThreadId:s,text:n}),Os=P.memo(yn),bn=({messageId:e,clientThreadId:s,text:n})=>{const t=gt(),{setThreadSystemHintMode:r}=ht(),i=!!yt(),o=pe(s),a=ye(s);Re(s,e,!0);const c=_.useCallback(l=>{l.preventDefault(),S.count(E.DEFAULT,"clickable_follow_up_text_clicked"),S.count(E.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),b.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",M({clientThreadId:s,messageId:e}));const u={clientThreadId:s};r(bt.Research,!0,u),t.focus(),t.setText(n)},[s,e,n,t,r,a,o]);return i?f.jsx(Te,{messageId:e,clientThreadId:s,text:n}):f.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[f.jsx($e,{className:"icon me-1 inline-block"}),n]})},_n=({messageId:e,clientThreadId:s,text:n})=>f.jsx(bn,{messageId:e,clientThreadId:s,text:n}),js=P.memo(_n);function wn(){return e=>{x(e,{tagName:"table"},s=>{const n=s.children.find(r=>k(r,"thead"))?.children.find(r=>k(r,"tr"))?.children.filter(r=>k(r,"th"))??[],t=s.children.find(r=>k(r,"tbody"))?.children.filter(r=>k(r,"tr"))?.map(r=>r.children.filter(i=>k(i,"td")))??[];for(let r=0;r<n.length;r++){const i=n[r];let o=ie(i);for(let c=0;c<t.length;c++)o=Math.max(o,ie(t[c]?.[r]));const a=o>160?"xl":o>100?"lg":o>40?"md":"sm";i.properties["data-col-size"]=a;for(let c=0;c<t.length;c++)t[c]?.[r]&&(t[c][r].properties["data-col-size"]=a)}})}}function k(e,s){return e.type==="element"&&e.tagName===s}function ie(e){let s=0;return e&&x(e,"text",n=>{s+=n.value.length}),s}const Fs=e=>(e.startsWith(Me),e);function xn(){return e=>{x(e,"list",s=>{for(const n of s.children)n.spread=!0})}}function Ps(e){return s=>{x(s,n=>{Object.defineProperties(n,{markdownSource:{get(){try{return e.slice(this.position.start.offset,this.position.end.offset)}catch{return""}}}})})}}const Oe=[Lt,mn,xn,[vt,{singleDollarTextMath:!1}],At,Mt,Dt,...q?[q]:[],Ct,Nn,Cn];function Nn(){return e=>{x(e,"textDirective",s=>{s.name!==be&&(s.type="text",s.value=`:${s.name}`)})}}const kn=/\u200b/g;function Cn(){return e=>{x(e,"text",s=>{s.value=s.value.replace(kn,"")})}}function Sn(){return e=>{const s=e.position?.end.offset;x(e,"element",(n,t)=>{const{position:r}=n;if(!r)return;const{start:i,end:o}=r,a=i.offset,c=o.offset;n.properties??={},a!=null&&(n.properties["data-start"]=a),c!=null&&(n.properties["data-end"]=c,s===c&&(n.properties["data-is-last-node"]=""),t===e.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const Bs=[Ae,Sn,wn,[Ke,{target:"_new",rel:"noopener noreferrer"}],de],En=[[Ae,{output:"mathml"}],de],Ln=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],ce={}.hasOwnProperty;function vn(e,s){const n=s||{};function t(r,...i){let o=t.invalid;const a=t.handlers;if(r&&ce.call(r,e)){const c=String(r[e]);o=ce.call(a,c)?a[c]:t.unknown}if(o)return o.call(this,r,...i)}return t.handlers=n.handlers||{},t.invalid=n.invalid,t.unknown=n.unknown,t}const An=/^>|^->|<!--|-->|--!>|<!-$/g,Mn=[">"],Dn=["<",">"];function Rn(e,s,n,t){return t.settings.bogusComments?"<?"+C(e.value,Object.assign({},t.settings.characterReferences,{subset:Mn}))+">":"<!--"+e.value.replace(An,r)+"-->";function r(i){return C(i,Object.assign({},t.settings.characterReferences,{subset:Dn}))}}function Tn(e,s,n,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}const d=Fe(1),je=Fe(-1),On=[];function Fe(e){return s;function s(n,t,r){const i=n?n.children:On;let o=(t||0)+e,a=i[o];if(!r)for(;a&&U(a);)o+=e,a=i[o];return a}}const jn={}.hasOwnProperty;function Pe(e){return s;function s(n,t,r){return jn.call(e,n.tagName)&&e[n.tagName](n,t,r)}}const H=Pe({body:Pn,caption:R,colgroup:R,dd:In,dt:Hn,head:R,html:Fn,li:Un,optgroup:qn,option:Wn,p:Bn,rp:le,rt:le,tbody:$n,td:ue,tfoot:Kn,th:ue,thead:Gn,tr:zn});function R(e,s,n){const t=d(n,s,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&U(t.value.charAt(0)))}function Fn(e,s,n){const t=d(n,s);return!t||t.type!=="comment"}function Pn(e,s,n){const t=d(n,s);return!t||t.type!=="comment"}function Bn(e,s,n){const t=d(n,s);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function Un(e,s,n){const t=d(n,s);return!t||t.type==="element"&&t.tagName==="li"}function Hn(e,s,n){const t=d(n,s);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function In(e,s,n){const t=d(n,s);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function le(e,s,n){const t=d(n,s);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function qn(e,s,n){const t=d(n,s);return!t||t.type==="element"&&t.tagName==="optgroup"}function Wn(e,s,n){const t=d(n,s);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function Gn(e,s,n){const t=d(n,s);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function $n(e,s,n){const t=d(n,s);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function Kn(e,s,n){return!d(n,s)}function zn(e,s,n){const t=d(n,s);return!t||t.type==="element"&&t.tagName==="tr"}function ue(e,s,n){const t=d(n,s);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const Yn=Pe({body:Xn,colgroup:Jn,head:Qn,html:Vn,tbody:Zn});function Vn(e){const s=d(e,-1);return!s||s.type!=="comment"}function Qn(e){const s=new Set;for(const t of e.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(s.has(t.tagName))return!1;s.add(t.tagName)}const n=e.children[0];return!n||n.type==="element"}function Xn(e){const s=d(e,-1,!0);return!s||s.type!=="comment"&&!(s.type==="text"&&U(s.value.charAt(0)))&&!(s.type==="element"&&(s.tagName==="meta"||s.tagName==="link"||s.tagName==="script"||s.tagName==="style"||s.tagName==="template"))}function Jn(e,s,n){const t=je(n,s),r=d(e,-1,!0);return n&&t&&t.type==="element"&&t.tagName==="colgroup"&&H(t,n.children.indexOf(t),n)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function Zn(e,s,n){const t=je(n,s),r=d(e,-1);return n&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&H(t,n.children.indexOf(t),n)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}const A={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function es(e,s,n,t){const r=t.schema,i=r.space==="svg"?!1:t.settings.omitOptionalTags;let o=r.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(e.tagName.toLowerCase());const a=[];let c;r.space==="html"&&e.tagName==="svg"&&(t.schema=B);const l=ts(t,e.properties),u=t.all(r.space==="html"&&e.tagName==="template"?e.content:e);return t.schema=r,u&&(o=!1),(l||!i||!Yn(e,s,n))&&(a.push("<",e.tagName,l?" "+l:""),o&&(r.space==="svg"||t.settings.closeSelfClosing)&&(c=l.charAt(l.length-1),(!t.settings.tightSelfClosing||c==="/"||c&&c!=='"'&&c!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!H(e,s,n))&&a.push("</"+e.tagName+">"),a.join("")}function ts(e,s){const n=[];let t=-1,r;if(s){for(r in s)if(s[r]!==null&&s[r]!==void 0){const i=ns(e,r,s[r]);i&&n.push(i)}}for(;++t<n.length;){const i=e.settings.tightAttributes?n[t].charAt(n[t].length-1):void 0;t!==n.length-1&&i!=='"'&&i!=="'"&&(n[t]+=" ")}return n.join("")}function ns(e,s,n){const t=we(e.schema,s),r=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,i=e.settings.allowDangerousCharacters?0:1;let o=e.quote,a;if(t.overloadedBoolean&&(n===t.attribute||n==="")?n=!0:(t.boolean||t.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const c=C(t.attribute,Object.assign({},e.settings.characterReferences,{subset:A.name[r][i]}));return n===!0||(n=Array.isArray(n)?(t.commaSeparated?Rt:ze)(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?c:(e.settings.preferUnquoted&&(a=C(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:A.unquoted[r][i]}))),a!==n&&(e.settings.quoteSmart&&G(n,o)>G(n,e.alternative)&&(o=e.alternative),a=o+C(n,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?A.single:A.double)[r][i],attribute:!0}))+o),c+(a&&"="+a))}const ss=["<","&"];function Be(e,s,n,t){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?e.value:C(e.value,Object.assign({},t.settings.characterReferences,{subset:ss}))}function rs(e,s,n,t){return t.settings.allowDangerousHtml?e.value:Be(e,s,n,t)}function os(e,s,n,t){return t.all(e)}const as=vn("type",{invalid:is,unknown:cs,handlers:{comment:Rn,doctype:Tn,element:es,raw:rs,root:os,text:Be}});function is(e){throw new Error("Expected node, not `"+e+"`")}function cs(e){const s=e;throw new Error("Cannot compile unknown node `"+s.type+"`")}const ls={},us={},fs=[];function ps(e,s){const n=s||ls,t=n.quote||'"',r=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:ds,all:ms,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||Ln,characterReferences:n.characterReferences||us,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?B:xe,quote:t,alternative:r}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function ds(e,s,n){return as(e,s,n,this)}function ms(e){const s=[],n=e&&e.children||fs;let t=-1;for(;++t<n.length;)s[t]=this.one(n[t],t,e);return s.join("")}function gs(e){const s=this,n={...s.data("settings"),...e};s.compiler=t;function t(r){return ps(r,n)}}function hs(e,s){const n=_t(e,s);return Ue(n,s)}function Ue(e,s){const n=T().use(me).use(Oe).use([[_s,s??[]]]).use(St,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:ys}}),t=T().use(Tt).use(En).use(gs),r=n.runSync(n.parse(e)),i=n.stringify(r),o=t.stringify(t.runSync(r));return{"text/plain":i,"text/html":o}}const ys=(e,s,n,t)=>{const r=n.createTracker(t),i=n.enter("link"),o=n.enter("label");let a=r.move("[");return a+=r.move(n.containerPhrasing(e,{before:a,after:"](",...r.current()})),a+=r.move("]("),o(),a+=r.move(e.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,bs)),e.title&&(a+=r.move(" "+JSON.stringify(e.title))),a+=r.move(")"),i(),a};function bs(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function _s(e){return s=>{const n={},t=(r,i)=>{switch(i.type){case"grouped_webpages":{const o=[];for(const a of i.items)if(a.url&&a.title){let c=n[a.url];c||(c=n[a.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:a.url,title:a.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:a.attribution??Ve(a.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((a,c,l)=>c<l.length-1?[a,{type:"text",value:", "}]:[a]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"tldr":case"navigation":case"stock":case"calculator":case"python":case"container":case"code_execution":case"forecast":case"businesses_map":case"video":case"entity":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"checkout_confirmation":case"image_inline":case"image_group":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(i.alt){const o=T().use(me).use(Oe).parse(i.alt);if(r.type!=="textDirective")return o.children;const a=o.children[0];if(a.type==="paragraph")return a.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};x(s,Ye,(r,i,o)=>{if(o==null||i==null)return;const a=ws(r,e),c=a?t(r,a)??[r]:[];return o.children.splice(i,1,...c),[fe,i+c.length]}),s.children.push(...Object.values(n))}}function ws(e,s){if(e.name===be){const n=e.attributes?.index;if(n)return s[parseInt(n,10)]}}const Us=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:Ue,messageTextToClipboardContent:hs},Symbol.toStringTag,{value:"Module"}));export{Rs as C,As as I,jt as M,Oe as R,Me as S,Bs as a,Ds as b,Ms as c,Os as d,Ts as e,js as f,Us as g,Ue as m,Ps as r,Fs as u};
//# sourceMappingURL=ngm3zowhfao2x7b9.js.map

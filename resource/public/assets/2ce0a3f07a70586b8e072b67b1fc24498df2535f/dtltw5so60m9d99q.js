import{d as N,b as R,j as e,M as T,r as X}from"./n97h6so7iblif4c5.js";import{P as v,ka as S,a as y,p as Z,iP as K,ao as b,cO as Q,nE as q,b8 as z,at as O,fC as J,aM as W,hF as G,iS as V,aa as ee,nF as H,nG as Y,nH as te,fx as k,al as se,aY as ae,a4 as oe,eT as le,fv as ne,kR as ie,fN as re,jY as ce,fw as L,nI as de,nJ as ue,nK as ge}from"./cim4usely8ixso70.js";import{u as pe}from"./kgkkjgk15rr7n5rs.js";import{bO as I,bP as fe,bQ as me,bR as Fe,bS as C,bT as he,bU as xe}from"./ivbsxyeeopn30y8l.js";function ve({clientThreadId:t,openFileDialog:s,icon:i,isDisabled:o=!1,isSmall:l=!1,showLabel:r=!1,showUpsell:a=!1,hideBorder:F=!1,highlightTooltip:c=!1,disabledReason:p,currentModelName:h,visualTreatment:f,showMenuForNoAuth:n,modelSupportsImages:m}){const d=R(),u=S(),g=y(),A=Z(g),j=K(g);o=(o||!!u)&&!a;const _=e.jsxs(fe,{disabled:o,$showLabel:r,$hideBorder:F,$isSmall:l,$visualTreatment:f,onClick:x=>{if(x.preventDefault(),n||a){v.logNoAuthAttachButtonClicked({location:n?"No auth file upload":"No auth upsell"});return}s()},"aria-label":me(d,o,p,h,A,j),children:[i,r&&e.jsx(Fe,{})]}),P=e.jsx("div",{className:"flex",children:_});if(n||a){const x=n?e.jsx(he,{openFileDialog:s,showMenuForNoAuth:!0,modelSupportsImages:m}):e.jsx(q,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"}),M=e.jsx(b.BasicTrigger,{asChild:!0,children:P});return e.jsxs(b.Root,{children:[n?e.jsx(C,{clientThreadId:t,rateLimitPopup:u,highlightTooltip:c,disabled:o,children:M}):e.jsx(Q,{label:e.jsx(T,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:c||void 0,children:M}),e.jsx(b.Portal,{children:e.jsx(b.Content,{alignOffset:-8,side:"bottom",size:"small",className:"radix-side-bottom:flex-col-reverse flex flex-col",children:x})})]})}return e.jsx(C,{disabled:o,clientThreadId:t,rateLimitPopup:u,highlightTooltip:c,children:P})}function Me({code:t,message:s}){switch(t){case I.FileTooLarge:return D.errorFileTooLarge;case I.TooManyFiles:return v.logEvent("Uploaded Max Files Error"),D.errorTooManyFiles;default:return s}}const D=N({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."}}),B=N({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function Ae(t){if(!t.accept||Object.keys(t.accept).length===0)return[];const s=[];return Object.values(t.accept).forEach(i=>s.push(...i)),s.sort()}function ye(t){const{className:s,children:i,clientThreadId:o,currentModelConfig:l,noKeyboard:r}=t,a=R(),F=O(),c=y(),p=ae(c),f=z(c).flags?.includes(G.NoAuthEnableFileUploads),n=oe(o),m=le(),d=ne(l,n,m),u=d!==k.None,g=ie(U=>U.files),A=(d===k.Multimodal?H:Y)-g.length,j=A<=0,{getGizmoId:_}=re(),{handleFileAccepted:P}=be(a,d,L(l,n),"drag",_,ce(l,n)?.attachments),x=S(),M=de(!p&&f?L(l,n):ue(l,n)),{getRootProps:$,isDragActive:w}=pe({maxFiles:A,disabled:!u||j||x!=null,noClick:!0,noKeyboard:r,onDropAccepted:P,onDropRejected:U=>Pe(U,a,F,d),multiple:!0,maxSize:ge,...M}),E=Ae(M);return e.jsxs("div",{...$({className:s}),children:[i,w&&e.jsxs(je,{children:[e.jsx(xe,{}),e.jsx("h3",{children:e.jsx(T,{...B.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:E.length>0?E.join(", "):e.jsx(T,{...B.dragAllAccepted})})]})]})}function Pe(t,s,i,o){const{errors:l}=t[0];l.forEach(r=>{const a=Me(r);typeof a=="string"?i.danger(a,{hasCloseButton:!0,loggingTitle:"File upload error",loggingDescription:a,toastId:"file_upload_error"}):i.danger(s.formatMessage(a,{size:te,maxNum:o===k.Multimodal?H:Y}),{hasCloseButton:!0,loggingTitle:a.defaultMessage||"File upload error",loggingDescription:a.defaultMessage||"File upload error",toastId:"file_upload_error"})})}function be(t,s,i,o,l,r){const a=y(),F=z(a).flags,c=O(),p=J(),{isUnauthenticated:h}=W(),f=F?.includes(G.NoAuthEnableFileUploads);return{handleFileAccepted:X.useCallback(async(m,d)=>{v.logEvent("Upload File",{client:"web",eventSource:o,intent:s.toString()});const u=l!=null?await l():void 0;m.length>0&&m.forEach(g=>{V.uploadFile(p,ee(g),g,s,i,t,c,{gizmoId:u,...f&&{isUnauthenticated:h}},r)})},[o,s,l,p,i,t,c,r,f,h])}}const je=se.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`;export{je as D,ye as F,ve as P,Ae as g,Pe as h,be as u};
//# sourceMappingURL=dtltw5so60m9d99q.js.map

import{r as N,f as ue,a as Ee,b as O,j as e,M as m}from"./n97h6so7iblif4c5.js";import{bD as X,c9 as Q,ca as _,cb as W,cc as V,cd as $,ce as ve,cf as ge,cg as Y,ch as he,ci as xe,cj as Ae,O as Le,ck as ke,ab as ae,B as ne,cl as oe,cm as B,cn as le,co as y,cp as H,cq as ce,cr as q,cs as Be}from"./ivbsxyeeopn30y8l.js";import{b7 as z,bW as Oe,bb as fe,at as pe,bR as Re,P as v,C as ie,b6 as De,d as G,dV as F,D as K,al as Ie}from"./cim4usely8ixso70.js";import{c as ye}from"./iej0cupg2dqkmejt.js";import{u as Z,P as Ue}from"./nw77hv3bmgb5l1rn.js";import{u as Se}from"./kfttpd1cc0u1rrbk.js";import{u as Te}from"./ib76cquqlyjrlt71.js";const Fe=ye($),We=({promoData:n,initialPromoCoupon:d,initialSeats:f}={})=>{const S=X(),x=Q()??d,{data:c}=Z(x??"");let t=n;!n&&c&&(t=c);const p=t?.coupon===_&&t.state==="eligible",s=typeof window<"u"?new URLSearchParams(window?.location.search):new URLSearchParams,i=s.get(W),a=s.get(V),h=p?$.FLEXIBLE:a&&Fe(a)?a:$.FLEXIBLE,[j,r]=N.useState(h),[u,o]=N.useState(f??(i&&!isNaN(parseInt(i,10))?parseInt(i,10):Math.max(ve,S)));return{promoData:t,selectedPlan:j,setSelectedPlan:r,numSeats:u,setNumSeats:o,minTeamSeats:S,TEAM1DOLLAR_COUPON_IsEligible:p}},T=Ae;var je=(n=>(n.FLEXIBLE="month",n.ANNUAL="year",n))(je||{});const re=ye(je),Ke=n=>{const d=N.useRef(!1),f=ue(),S=f.hash.split("#")[1]===ge||f.hash.split("#")[1]===Y,x=z(),c=!d.current&&S&&x&&!n,{initialBillingDetails:t}=Te(x,!0),p=Q(),{data:s,isLoading:i}=Z(p??""),a=X();N.useEffect(()=>{c&&(Oe.setPurchaseWorkspaceData({minimumSeats:a,billingDetails:t,promoData:s}),d.current=!0)},[x,t,a,S,n,p,s,i,c])},me=Ie.p`text-base font-medium mb-3`,be=({isOpen:n,onClose:d,onSubmit:f,minimumSeats:S,billingDetails:x,isDirectFlow:c=!1,promoData:t=void 0})=>{const p=z(),{selectedPlan:s,setSelectedPlan:i,numSeats:a,setNumSeats:h,minTeamSeats:j,TEAM1DOLLAR_COUPON_IsEligible:r}=We({promoData:t}),[u,o]=N.useState(!1),l=O(),w=x.currency,R=Math.max(S,j),{flexibleBillingPlan:Pe,annualBillingPlan:J}=xe(w);let b=Pe,A=null;r&&(A=q(w),b={...b,cost:{...w===Re?T.team1dollarMonthlyCostINR:T.team1dollarMonthlyCost},costStructure:{...T.team1dollarMonthlyStructure,defaultMessage:`then ${l.formatMessage(b.currencySign)}${b.monthlyCost} monthly per seat`,id:"promo.team1dollar.monthlyPlanStructure",description:"Subsequent pricing description for team1dollar promo. Describing the monthly then the annual price after."}});const L=t?.coupon===_&&t.state==="not_eligible",k=t?.coupon===_&&t.state==="temporary_disabled",ee=t?.coupon===_&&t.state==="offline",P=Le(isNaN(a)?0:a,R,ke),C=N.useMemo(()=>p?.subscriptionAnalyticsParams,[p]);N.useEffect(()=>{v.logEvent("Account Pay: Select Team Plan Modal Show",C)},[C]);const te=g=>{switch(g){case"month":v.logEvent("Account Pay: Team Plan Selection Clicked",{...C,buttonType:"Continue",numberOfSeats:a,planLength:ce.MONTHLY});break;case"year":v.logEvent("Account Pay: Select Team Plan Modal Clicked",{...C,buttonType:"Continue",numberOfSeats:a,planLength:ce.ANNUAL});break}},se=(g,E)=>{v.logEventWithStatsig("Account Pay: Select Team Plan Modal Clicked","chatgpt_select_team_plan_modal_continue_to_billing_clicked",{...C,buttonType:"Continue",numberOfSeats:E,planLength:g}),K.addAction("chatgpt_funnel.team_plan_modal_checkout_initiated",{planLength:g,numberOfSeats:E.toString(),accountId:p?.id}),t?.coupon===_&&t.state==="eligible"&&Ue.logCouponApplied(t.coupon)},D=()=>{v.logEvent("Account Pay: Select Team Plan Modal Dismiss",C)},M=ue(),I=N.useMemo(()=>M.hash.split("#")[1]===Y,[M.hash]);return N.useEffect(()=>{const g=new URLSearchParams;g.set(W,P.toString()),g.set(V,s),t?.coupon&&g.set(ae,t.coupon);const E=c||I?`#${Y}`:`#${ge}`,Ne=`${M.pathname}?${g.toString()}${E}`,U=new URL(window.location.href).searchParams,we=U.get(W)===P.toString(),Me=U.get(V)===s,_e=t?.coupon==null||U.get(ae)===t.coupon,Ce=window.location.hash===E;(!we||!Me||!_e||!Ce)&&window.history.pushState({from:M.pathname+M.search},"",Ne)},[P,c,I,M.pathname,M.search,M.hash,s,t?.coupon]),c||I?e.jsx(ie,{testId:"modal-workspace-purchase",type:"success",isOpen:n,onClose:()=>{d(),D()},size:"fullscreen",noPadding:!0,removePopoverStyling:!0,showCloseButton:!0,children:e.jsxs("div",{className:"grid grid-flow-row grid-cols-1 md:h-full md:grid-cols-2",children:[e.jsx("div",{className:"flex-column col-span-1 flex justify-center p-5 md:grid-cols-2",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col items-center",children:[e.jsx(De,{className:"mt-8 mb-6 h-8 w-8 md:fixed md:start-4 md:top-4 md:mt-0 md:h-6 md:w-6"}),(L||k||ee)&&e.jsx("div",{className:"mb-4 w-full",children:e.jsx(ne,{content:l.formatMessage(L?T.team1dollarNotEligible:k?T.team1dollarTemporarilyDisabled:T.team1dollarOffline),type:"info"})}),e.jsx("div",{className:"mb-8 text-3xl font-medium md:mt-[120px]",children:e.jsx(m,{id:"selectTeamPlanModal.title",defaultMessage:"Pick your plan"})}),e.jsxs(oe,{className:G("col-span-3 mb-6 grid w-full gap-4 md:col-span-2","md:grid-cols-2"),defaultValue:s,onValueChange:g=>{re(g)&&(i(g),te(g))},children:[e.jsx(B,{billingType:"year",...J,selectedValue:s,hideSavingsMessage:r,hideDetails:!0}),e.jsx(B,{billingType:"month",...b,selectedValue:s,hideDetails:!0,showWelcomeOfferLabel:t?.state==="eligible",promoDisclaimer:t?.state==="eligible"&&e.jsx(m,{...T.team1dollarPromoDisclaimer,values:{currencySign:l.formatMessage(b.currencySign),cost:b.monthlyCost}})})]}),e.jsx(le,{numSeats:a,minSeats:R,setNumSeats:h}),e.jsx("div",{className:"text-token-text-secondary self-start text-xs",children:l.formatMessage({id:"selectTeamPlanModal.seatsDescription",defaultMessage:"Add more seats at any time. Minimum of {minSeats} seats."},{minSeats:j})})]})}),e.jsx("div",{className:"col-span-3 flex h-full flex-col items-center overflow-hidden p-6 md:col-span-1 md:shadow-lg",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col md:mt-[120px]",children:[e.jsx(me,{className:"mb-8 text-xl font-medium",children:e.jsx(m,{...y.summaryTitle})}),e.jsx(de,{numSeats:P,selectedPlan:s,billingDetails:x,totalLabel:y.allPlansTodayTotal,billDate:e.jsx(m,{...y.today}),promoData:t}),e.jsx(F,{title:l.formatMessage(y.continueToBillingButton),onClick:async()=>{o(!0),se(s,P),await f(s,P),o(!1)},disabled:!1,loading:u,color:"green",className:"w-full rounded-xl"}),e.jsx(F,{title:l.formatMessage(y.cancel),onClick:()=>{d(),D()},color:"ghost",className:"mt-4 w-full rounded-xl"})]})})]})}):e.jsxs(ie,{testId:"modal-select-team-plan",type:"success",isOpen:n,onClose:()=>{d(),D()},size:"custom",noPadding:!0,removePopoverStyling:!0,className:"max-w-4xl",showCloseButton:!0,hasSeparator:!0,title:l.formatMessage(y.selectTeamPlanModalTitle),children:[(L||k||ee)&&e.jsx("div",{className:"px-5 pt-4",children:e.jsx(ne,{content:l.formatMessage(L?T.team1dollarNotEligible:k?T.team1dollarTemporarilyDisabled:T.team1dollarOffline),type:"info"})}),e.jsxs("div",{className:"grid grid-flow-row grid-cols-3",children:[e.jsxs("div",{className:"flex-column col-span-3 p-5 md:col-span-2 md:grid-cols-2",children:[e.jsx(le,{numSeats:a,minSeats:R,setNumSeats:h}),t?.coupon===_&&t.state==="eligible"&&s==="month"&&a>H&&e.jsx("div",{className:"text-token-text-secondary mt-1 self-start text-xs",children:e.jsx(m,{...T.team1dollarOverSeatsDisclaimer})}),e.jsxs(oe,{className:G("col-span-3 mt-5 grid gap-4 md:col-span-2","md:grid-cols-2"),defaultValue:s,onValueChange:g=>{re(g)&&(i(g),te(g))},children:[e.jsx(B,{billingType:"year",...J,selectedValue:s,hideSavingsMessage:r}),e.jsx(B,{billingType:"month",...b,selectedValue:s,showWelcomeOfferLabel:r,promoDisclaimer:r&&e.jsx(m,{...A===1?T.team1dollarPromoDisclaimer:T.team1dollarPromoDisclaimerWithAmount,values:{currencySign:l.formatMessage(b.currencySign),amount:A&&l.formatNumber(A,{style:"currency",currency:w,trailingZeroDisplay:"stripIfInteger"})}})})]})]}),e.jsxs("div",{className:"border-token-main-surface-tertiary bg-token-bg-elevated-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(me,{children:e.jsx(m,{...y.summaryTitle})}),e.jsx(de,{numSeats:P,selectedPlan:s,billingDetails:x,totalLabel:y.allPlansTodayTotal,billDate:e.jsx(m,{...y.today}),promoData:t}),e.jsx(F,{title:l.formatMessage(y.continueToBillingButton),onClick:async()=>{o(!0),se(s,P),await f(s,P),o(!1)},disabled:!1,loading:u,color:"primary",className:"w-full rounded-xl"})]})]})]})},de=({numSeats:n,selectedPlan:d,billingDetails:f,totalLabel:S,billDate:x,promoData:c})=>{const t=O(),{flexibleBillingPlan:p,annualBillingPlan:s}=xe(f.currency),i=p,a=d==="month"?i:s,h=Be[d],j=(n||0)*(d==="year"?s.monthlyCost*12:i.monthlyCost);let r=(n||0)*a.unitCost,u=j-r,o=0,l=j,w=!1;return c?.coupon===_&&c.state==="eligible"&&d==="month"&&(w=!0,n<=H?(o=q(f.currency),l=n*i.monthlyCost,u=l-o,r=o):(o=q(f.currency)+(n-H)*i.monthlyCost,l=n*i.monthlyCost,u=l-o,r=o)),e.jsxs("div",{className:"flex grow flex-col text-sm",children:[e.jsxs("div",{className:"text-token-text-secondary flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{...h.name})}),e.jsx("div",{className:"flex",children:e.jsx(m,{...y.allPlansPreDiscountTotal,values:{currencySign:t.formatMessage(a.currencySign),preDiscountTotalAmount:j.toLocaleString()}})})]}),e.jsxs("div",{className:"text-token-text-tertiary flex w-full justify-between text-xs",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{...h.breakdown,values:{numSeats:n}})}),e.jsx("div",{className:"flex",children:e.jsx(m,{...y.breakdownAmount,values:{currencySign:t.formatMessage(a.currencySign),amount:a.monthlyCost}})})]}),e.jsxs("div",{className:"text-token-text-secondary mt-3 flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{...y.planDiscountLabel})}),e.jsx("div",{className:G("flex",u>0&&"font-medium text-[#10A37F]"),children:e.jsx(m,{...h.discountAmount,values:{currencySign:t.formatMessage(i.currencySign),discountAmount:u.toLocaleString()}})})]}),c?.coupon===_&&c.state==="eligible"&&d==="month"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(m,{...T.team1dollarBelowDiscount})}),h.discountDescription&&s.discountedMonthlyCost<s.monthlyCost&&d==="year"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(m,{...h.discountDescription,values:{discountPercentage:Math.floor((1-s.discountedMonthlyCost/s.monthlyCost)*100)}})}),e.jsx("hr",{className:"border-token-border-default my-3"}),e.jsxs("div",{className:"flex w-full justify-between text-base font-medium",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{...S})}),e.jsx("div",{className:"flex",children:w?e.jsxs(e.Fragment,{children:[t.formatMessage(a.currencyCode)," ",t.formatMessage(a.currencySign),r.toLocaleString()]}):e.jsx(m,{...h.total,values:{currencyCode:t.formatMessage(a.currencyCode),currencySign:t.formatMessage(a.currencySign),totalAmount:r.toLocaleString()}})})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:w?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-token-text-tertiary mt-2 text-xs",children:e.jsx(m,{id:"vgDSPO",defaultMessage:"After promotional period {currencySign}{amount} per month",values:{currencySign:t.formatMessage(i.currencySign),amount:l.toLocaleString()}})})}):e.jsx(m,{...h.billed,values:{billDate:x}})})]})};function Ze(){const n=z(),d=Ee(),{prepareCheckoutSession:f,navigateToCheckout:S}=Se(),x=X(),{initialBillingDetails:c}=Te(n,!0),t=O(),p=fe(),s=he(t,void 0,p),i=pe(),a=Q(),{data:h}=Z(a??""),j=async(u,o)=>{try{const l=await f({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:s,price_interval:u,seat_quantity:o},billing_details:c,promo_campaign:u==="month"?h?.coupon:null});await S(l)}catch(l){K.addError(l),i.warning(t.formatMessage(y.paymentErrorWarning),{hasCloseButton:!0})}},r=()=>{d("/")};return e.jsx(be,{isOpen:!0,onClose:r,onSubmit:(u,o)=>j(u,o),isDirectFlow:!0,minimumSeats:x,billingDetails:c,promoData:h})}const Je=({isOpen:n,onClose:d,minimumSeats:f,billingDetails:S,existingAccount:x=void 0,promoData:c=void 0})=>{const t=O(),p=pe(),s=fe(),{prepareCheckoutSession:i,navigateToCheckout:a}=Se(),h=he(t,x,s),j=async(r,u)=>{try{const o=await i({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:h,price_interval:r,seat_quantity:u,existing_workspace_id:x?.id},billing_details:S,cancel_url:window.location.href,promo_campaign:r==="month"?c?.coupon:null});await a(o)}catch(o){K.addError(o),p.warning(t.formatMessage(y.paymentErrorWarning),{hasCloseButton:!0})}};return e.jsx(be,{isOpen:n,onClose:d,onSubmit:(r,u)=>j(r,u),minimumSeats:f,billingDetails:S,promoData:c})};export{de as B,Ze as T,Ke as a,Je as b,We as u};
//# sourceMappingURL=flvrd2fw13ytfkn1.js.map

import{l9 as m,at as R,gm as h,gn as g,R as S}from"./cim4usely8ixso70.js";import{N as E,a as O,r as n,j as T}from"./n97h6so7iblif4c5.js";import{a as b}from"./itdwpc2q0aiung3v.js";const d="chatgpt://oauth_complete";async function k(u,e,s,r){const t=await S.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:u},query:{code:e,redirect_uri:s,...r!=null?{state:r}:{}}}});return{...t,redirect_path:b(t.redirect_path).toString()}}const C=m(function(){const{pluginId:e,code:s,state:r,error:t,errorDesc:c}=E(),i=O(),l=n.useRef(!1);n.useEffect(()=>{if(l.current===!0)return;l.current=!0;async function f(){const _=`https://chat.openai.com/aip/${e}/oauth/callback`;try{const a=await k(e,s,_,r);if(a.success)if(a.redirect_path===d)window.location.href=d;else{const o=new URL(h(g.OAUTH_SUCCESS,a.redirect_path),location.origin);o.searchParams.set("oauth_success","true"),i(o.pathname+o.search+o.hash)}else i(h(g.CUSTOM_ERROR,a.redirect_path,a.error??a.message))}catch{i({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:e,loginSuccess:"false"}).toString()})}}f()},[e,s,r,i]);const p=R();return n.useEffect(()=>{t&&p.danger(`${t}${c?`: ${c}`:""}`,{duration:5,toastId:"oauth_callback: AIPOauth",loggingTitle:t,loggingDescription:c??""})},[t,c,p]),T.jsx("div",{})});export{C as default};
//# sourceMappingURL=duayg9ev5p5soc5d.js.map

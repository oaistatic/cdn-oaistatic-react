const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mnepe2jamq5am3pw.js","assets/n1tvutderx19k1zs.js","assets/c87uv1mutc86tiqk.js","assets/efuue3ezs0mj4ucx.js","assets/root-gmm606mb.css","assets/conversation-small-nranh1cg.css","assets/gpfnin52ickzsm2c.js","assets/jy24clh9s5sbm6a3.js","assets/d995zjnlydagrugw.js","assets/bh0nczk7jf5nipy7.js","assets/ishe91rr928a0b40.js","assets/nvkogakwzn6oww8b.js","assets/ibswgel9g2v9wlet.js","assets/bzaypvhehxbw5ucz.js","assets/oq09nie6yqvskddc.js","assets/npeqg3baimzobwf1.js","assets/l8ccescf6p1hqg9v.js","assets/buq87gfosbdjwr5p.js","assets/hxtdf4wzyaqocms2.js"])))=>i.map(i=>d[i]);
import{bo as w,gt as _,d$ as F,aL as U,d as H,br as $,dm as E,bY as W,j as Q,bs as J,bt as V,b9 as A,dZ as X,a1 as q,bJ as K,e3 as Y,er as Z,a7 as ee,bg as se,ah as te}from"./efuue3ezs0mj4ucx.js";import{R as ae,a as re,r as t,j as e,M as z,c as ne}from"./n1tvutderx19k1zs.js";import{eI as oe,eJ as ie,cB as ce,eK as le,eL as de,eM as ue,eN as me,eO as l,dT as fe,ag as Se,c$ as O,ao as be,a9 as xe,N as ge,cz as he,U as T,eP as ye,eQ as pe,eR as k,eS as ve}from"./c87uv1mutc86tiqk.js";import{D as je,G as Ce,S as Ie}from"./gpfnin52ickzsm2c.js";import{u as Ne,H as De}from"./e3w17liq9hvaddfe.js";import{N as Ee}from"./jy24clh9s5sbm6a3.js";const R=Q({unableToLoadHistory:{id:"history.unableToLoad",defaultMessage:"Unable to load history"},retryButton:{id:"history.retryButton",defaultMessage:"Retry"}});function ze({activeId:s,hideOverflowMenu:r}){const n=re(),[o,i]=t.useState(!1),[d,h]=t.useState(0),S=_(),y=F(),p={},[v,u]=t.useState(!1),c=oe(),L=ie(),{conversations:j,hasNextPage:C,fetchNextPage:N,isLoading:m,isFetchingNextPage:M,isError:D}=ce(p),b=t.useRef(null),P=t.useCallback(a=>{m||a==null||(b.current?.disconnect(),b.current=new IntersectionObserver(G=>{G[0].isIntersecting&&C&&N()}),b.current.observe(a))},[m,C,N]);t.useEffect(()=>()=>{b.current?.disconnect()},[]),t.useMemo(()=>{U.publish({kind:"refreshHistory",conversations:j})},[j]);const I=j;t.useEffect(()=>{const a=le(de(),Date.now());S(()=>{h(d+1)},a+1e3)},[d,S]);const f=I.length===0;t.useEffect(()=>{f||ue({namespace:me.ChatPageLoad})?.logTiming("render_history_items")},[f]),l.markStart("History",l.NS_SIDEBAR),m||l.markRendered("History",l.NS_SIDEBAR);const B=Ne(I,d),x=c!=null&&c.kind==="conversation"&&c.gizmoId!=null&&fe(c.gizmoId),g=t.useRef(0);return e.jsxs(ke,{$centered:m||D||f,$screenArch:y,onDragOver:a=>{a.preventDefault(),x&&u(!0)},onDrop:a=>{a.preventDefault(),x&&(g.current=0,u(!1),L({newGizmoId:null,conversation:c.conversation,previousGizmoId:c.gizmoId??null}))},onDragEnter:a=>{a.preventDefault(),x&&(g.current+=1)},onDragLeave:a=>{a.preventDefault(),x&&(g.current-=1,g.current===0&&u(!1))},className:H(v&&"opacity-50"),children:[f&&m&&e.jsx($,{children:e.jsx(E,{className:"m-auto"})}),f&&D&&e.jsxs("div",{className:"p-3 text-center italic text-token-text-tertiary",children:[e.jsx(z,{...R.unableToLoadHistory}),!o&&e.jsx("div",{className:"mt-1",children:e.jsx(W,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{i(!0),Se(n)},children:e.jsx(z,{...R.retryButton})})})]}),!m&&!f&&e.jsx("div",{children:e.jsx(De,{activeId:s,bucketedItems:B,hasNextPage:C,items:I,infiniteScrollTriggerElementRef:P,hideOverflowMenu:r})}),M&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(E,{})})]})}const Te=ae.memo(ze),ke=w.div`flex flex-col gap-2 text-token-text-primary text-sm
${({$centered:s,$screenArch:r})=>[s&&"h-full justify-center items-center empty:hidden",!r&&"mt-5 pb-2"]}`;function Re({currentGizmoId:s}){const r=O(),{data:{gizmos:n}={}}=be();let o=n;return r&&(o=n?.filter(i=>!xe(i.resource))),l.markStart("GizmoSidebarList",l.NS_SIDEBAR),o!==void 0&&l.markRendered("GizmoSidebarList",l.NS_SIDEBAR),e.jsxs(e.Fragment,{children:[e.jsx(je,{isNewConversation:!0}),e.jsx(Ce,{gizmo:o??[],currentGizmoId:s,maxToShowOnLoad:7})]})}const He=J(()=>V(()=>import("./mnepe2jamq5am3pw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18])).then(s=>s.FannyPackAction));function Ae({clientThreadId:s}){const r=Z(s),n=ee(),{isUnauthenticated:o}=A(),i=se(s),d=te(),h=O(),[S,y]=t.useState(!1),p=t.useCallback(u=>u===k.Snorlax?S:!1,[S]),v=t.useCallback((u,c)=>{u===k.Snorlax&&y(c)},[]);return e.jsx(ve,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:v},children:e.jsxs("div",{className:"group/sidebar",children:[n&&e.jsx(Re,{currentGizmoId:i}),null,h&&e.jsx("div",{className:"pl-2 text-sm screen-arch:pl-1",children:e.jsx(Ie,{currentGizmoId:i})}),null,!o&&e.jsx(Te,{activeId:d?void 0:r})]})})}function we({clientThreadId:s}){const{isUnauthenticated:r}=A();return r?null:e.jsx(Ae,{clientThreadId:s})}function _e({className:s,onNewThread:r}){const n=ne(),o=X(),i=q(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:d}=ge();return e.jsxs("div",{className:H("flex",i?.visible&&i.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[e.jsx(K,{sideOffset:4,label:n.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),className:"flex",side:"right",children:e.jsx(he,{className:"no-draggable","aria-label":n.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),onClick:()=>{Y(o)?T.toggleNavSidebar():T.togglePopoverNavSidebar()},icon:ye,mobileIcon:pe,"data-testid":"close-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[d&&e.jsx(He,{}),e.jsx(Ee,{onClick:r,testId:"create-new-chat-button"})]})]})}export{we as C,Re as G,Te as H,_e as S};
//# sourceMappingURL=ld597293rbpr29wj.js.map

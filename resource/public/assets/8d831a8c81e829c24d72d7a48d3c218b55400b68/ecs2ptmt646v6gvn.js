const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/f8cs9hgiu8i8fq5l.js","assets/n1tvutderx19k1zs.js","assets/no551upyadws5ckb.js","assets/efuue3ezs0mj4ucx.js","assets/root-gmm606mb.css","assets/oszw1knsi7z008c4.js","assets/c87uv1mutc86tiqk.js","assets/conversation-small-nranh1cg.css","assets/d995zjnlydagrugw.js","assets/bh0nczk7jf5nipy7.js","assets/gb5z15gr4uo6e2ww.js","assets/jy24clh9s5sbm6a3.js","assets/ishe91rr928a0b40.js","assets/i4fhtrkiiy41fft9.js","assets/etz0vru3wekxgbsx.js","assets/bgbofdn5q7ucpong.js","assets/i3hkkuliosdo4kaj.js","assets/gq67rp1jg2edayk6.js","assets/bei4zk14rknuqpj2.js","assets/jqzilhinf9ixym20.js","assets/mjw5oil5iiagr2v4.js","assets/kol7s771m8hjwjag.js","assets/lu887k056q3j4k31.js","assets/mxux1o5cr1octc71.js","assets/j7sv058t94hrw1fg.js","assets/knb6y7em4qlrpkuc.js","assets/gioq1d8xhsi51m2p.js","assets/drca3a4828l8onhl.js","assets/c1vsiyure2yziq8u.js","assets/np3x8otcg6488fny.js","assets/jtuse4p9muknklsg.js","assets/b4a5otpy41fdr5l3.js","assets/gffup1245353c03l.js","assets/bdh1ots4hr6db7w1.js","assets/krj910mzqcd0aq73.js","assets/nj0cdl0bjojh2xn6.js","assets/o97za21c5v9glw28.js","assets/euijvuwb3rp9htgu.js","assets/gr8do7n6orkpzwtb.js","assets/n24ph5vohl8fszcu.js","assets/jnjq4wt6v0sb6ord.js","assets/ou38yrswq97w1ctq.js","assets/cot-message-iyohq5dt.css","assets/ldbt41bh1m0qw62w.js","assets/eevtyek0i3lh43t8.js","assets/kvk7nkh1556owat2.js","assets/kbwlsq1s2fesccmj.js","assets/miss4pu1cz5qgbd7.js"])))=>i.map(i=>d[i]);
import{bI as B,t as xe,fz as Q,gT as pe,af as _e,d as N,n as he,K as W,al as ye,bY as H,Y as je,Z as Ee,$ as Se,a0 as be,s as ae,r as ve,ae as z,P as ne,c3 as Ne,bo as re,gU as K,ex as Ce,ey as Te,bU as Ae,ec as ke,eu as Ie,eb as we,av as oe,D as De,a as $,c7 as Me,gV as Re,bs as b,bt as C,au as Oe,bg as Le,eQ as Pe}from"./efuue3ezs0mj4ucx.js";import{r as p,c as Y,j as s,M as v,aw as V,au as D,a as Fe}from"./n1tvutderx19k1zs.js";import{ju as ie,hX as ce,jv as Ue,jw as U,jx as Ve,dr as Be,ds as ze,jy as He,jz as Je,c4 as Ke,jA as Qe,jB as We,cq as Ye,jC as X,jD as $e,jE as Xe,jF as qe,jG as q,jH as le,hu as Ze,jI as Ge,jJ as es,jK as ss,jL as ts,aG as as,aF as ns,ag as rs,F as os,e7 as is,jM as cs,jN as ls,jO as ds,jP as ms,cC as i,iP as us,jQ as gs,jR as fs,jS as xs,jT as ps,dT as _s,gA as hs,jU as ys,fD as js}from"./c87uv1mutc86tiqk.js";import{b as Es,a as Ss}from"./d995zjnlydagrugw.js";import{u as bs}from"./bh0nczk7jf5nipy7.js";import{N as vs}from"./gb5z15gr4uo6e2ww.js";import{h as Ns}from"./jy24clh9s5sbm6a3.js";function Cs(e,a,t){const n=ie(r=>!!(e&&r.tasks[e])),{openThreadSidebar:o}=B(),{clearAllSystemHintModeTriggers:c}=Es(),m=ce("caterpillar"),d=Ue(t,e);p.useEffect(()=>{if(n||!e||!a)return;const{async_task_created_at:r,async_task_prompt:x,async_task_title:f}=a.metadata??{};if(!r||!x||!f)return;const g={originalConversationId:xe(t)??t,taskId:e,title:f,prompt:x,createdAt:r,updatedAt:r,status:U.UNDETERMINED};Ve.setTask(e,g),c()},[n,e,a,t,o,m,d,c])}const Ts={div:e=>{const{node:a,children:t,...n}=e;return s.jsx("div",{...n,className:"text-red-500",children:t})},p:e=>{const{node:a,children:t,...n}=e;return s.jsx("p",{...n,className:"text-start leading-6 text-token-text-primary",children:t})},a:e=>{const{node:a,children:t,...n}=e;return s.jsx("a",{...n,className:"font-sm leading-6 !text-token-text-primary",children:t})}},As=1e3*60*2,ks=15;function de({onClick:e,statusMessage:a,showSources:t,includeMargin:n,sources:o,progressBar:c}){const m=Q();return s.jsx("button",{onClick:()=>m&&e(),className:N("flex w-4/5 max-w-[416px] items-start justify-start gap-[18px] rounded-2xl border border-black/10 bg-token-main-surface-primary px-5 py-4 shadow dark:border-white/10",m?"cursor-pointer hover:bg-token-main-surface-secondary":"cursor-auto"),children:s.jsxs("div",{className:"flex w-full flex-col gap-3",children:[s.jsxs("div",{className:N("flex flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between",t?"h-12":"h-6"),children:[s.jsx("div",{className:N("font-sm w-full flex-1 truncate text-start leading-7 text-token-text-primary md:w-0",n&&"mr-[30px]"),children:a}),t&&o]}),s.jsx("div",{className:"flex w-full items-center justify-start gap-4 self-stretch pb-2",children:c})]})})}function Is({toggleSidebar:e,openSidebar:a,startTime:t}){const n=Y(),[o,c]=p.useState(!1),m=He();return p.useEffect(()=>{if(!t)return;const d=Date.now()-t,r=As-d;if(r>0){const x=setTimeout(()=>{c(!0),a()},r);return()=>clearTimeout(x)}else c(!0),a()},[t,a]),s.jsx(de,{onClick:e,statusMessage:o?n.formatMessage({id:"T2SbxC",defaultMessage:"Waiting…"}):s.jsx("div",{className:"text-pretty text-sm font-medium text-token-text-primary",children:m.startingMessage}),progressBar:s.jsx(Je,{className:"h-2 w-full"}),showSources:!1})}function ws(e,a,t){const n=e.formatMessage({id:"Bs+OcV",defaultMessage:"Thinking…"});if(a.length<2)return t?.initial??n;const o=a[a.length-2];if(o.type==="summary")return o.title;if(o.type==="search")return o.query;if(o?.type==="websiteOpen")return s.jsx(Ke,{componentOverrides:Ts,children:o.active_row_text})}function Ds({task:e,clientThreadId:a,caterpillarRows:t,messageWithTaskMetadata:n,totalSources:o,handleToggleCaterpillarSidebar:c}){const m=Y(),d=Q(),r=ws(m,t,n.metadata?.async_task_status_messages),x=(e?.expectedDurationMinutes??ks)*60*1e3,f=Be(t[1]?.created_at?t[1].created_at*1e3:Date.now(),x),u=t[1]&&t[1].created_at?f:0;p.useEffect(()=>{pe(a,_e.STREAMING)},[a]);const{openThreadSidebar:g}=B();p.useEffect(()=>{t.length===2&&d&&g({type:"caterpillar",caterpillarId:e.taskId,initialTab:"activity",clientThreadId:a})},[t.length,g,e.taskId,a,d]);const _=p.useCallback(()=>{g({type:"caterpillar",caterpillarId:e.taskId,initialTab:"activity",clientThreadId:a})},[g,e.taskId,a]);return t.length<=1?s.jsx(Is,{toggleSidebar:()=>c("activity"),openSidebar:_,startTime:new Date(e.createdAt).getTime()}):s.jsx(de,{onClick:()=>c("activity"),statusMessage:r,showSources:!0,includeMargin:o>0,sources:o===0?s.jsx("div",{className:"text-pretty text-sm text-token-text-tertiary",children:s.jsx(v,{id:"zfwUjs",defaultMessage:"Looking for sources…"})}):s.jsxs("button",{onClick:y=>{y.stopPropagation(),c("sources")},className:N("flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff]",d?"cursor-pointer hover:text-[#0285ff]/80":"cursor-auto"),children:[s.jsx("div",{className:"relative",children:s.jsx(V,{initial:!1,children:s.jsx(D.span,{initial:{opacity:0,rotateX:-90,translateY:20},animate:{opacity:1,rotateX:0,translateY:0},exit:{opacity:0,rotateX:90,translateY:-20},transition:{duration:.35},className:"absolute left-0 md:right-0",children:o},o)})}),s.jsx("div",{className:N("md:pr-0",o>0&&"pl-2",o>9&&"pl-[14px]",o>99&&"pl-[22px]"),children:o>1?s.jsx(v,{id:"zN+MuO",defaultMessage:" sources"}):s.jsx(v,{id:"dMowmJ",defaultMessage:" source"})})]}),progressBar:s.jsx("div",{className:"flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px] bg-token-main-surface-tertiary",children:s.jsx(ze,{percentage:u,barClassName:"bg-token-text-primary",backgroundClassName:"bg-token-main-surface-tertiary"})})})}function J({message:e,handleToggleCaterpillarSidebar:a}){const t=Q();return s.jsx("div",{className:"border-token-border-primary mb-4 flex w-full flex-col gap-6 border-b-2 pb-6 pt-3",children:s.jsx("button",{onClick:()=>t&&a(),className:N("flex w-full text-start text-token-text-tertiary",t?"cursor-pointer hover:text-token-text-secondary":"cursor-auto"),children:e})})}function Ms({messages:e,clientThreadId:a}){const t=e.find(o=>o.message.metadata?.b1de6e2_s&&o.message.metadata?.async_task_id)?.message,n=t?.metadata?.async_task_id;return!t||!n?null:s.jsx(Rs,{clientThreadId:a,payloadTaskId:n,messageWithTaskMetadata:t})}function Rs({payloadTaskId:e,messageWithTaskMetadata:a,clientThreadId:t}){Cs(e,a,t);const n=ie(u=>e?u.tasks[e]:null),o=Y(),c=n?.status,m=p.useMemo(()=>n?.rows?n.rows:[],[n?.rows]),{toggleThreadSidebar:d}=B(),{totalSources:r}=p.useMemo(()=>{if(!m)return{uniqueSources:[],totalSources:0};const u=Qe(m),g=u.reduce((_,y)=>_+y.count,0);return{uniqueSources:u,totalSources:g}},[m]),x=ce("caterpillar"),f=p.useCallback(u=>{e&&d({type:"caterpillar",caterpillarId:e,initialTab:u,clientThreadId:t},x)},[d,e,x,t]);return We(e),!n||!c||n.status===U.UNDETERMINED?null:n.status===U.COMPLETED?s.jsx(J,{message:s.jsxs(s.Fragment,{children:[a.metadata?.async_task_status_messages?.completed_with_time??a.metadata?.async_task_status_messages?.completed_no_time??s.jsx(v,{id:"4d0xZc",defaultMessage:"Completed"}),r===0?s.jsx(v,{id:"VggF2B",defaultMessage:" · 0 sources"}):r===1?s.jsx(v,{id:"zkkdKV",defaultMessage:" · 1 source"}):s.jsx(v,{id:"qcKt3q",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:r}})]}),handleToggleCaterpillarSidebar:()=>f("activity")}):n.status===U.FAILED?s.jsx(J,{message:a.metadata?.async_task_status_messages?.error??o.formatMessage({id:"at6zk8",defaultMessage:"Failed to think"}),handleToggleCaterpillarSidebar:()=>f("activity")}):n.status===U.CANCELLED?s.jsx(J,{message:a.metadata?.async_task_status_messages?.cancelled??o.formatMessage({id:"u1rIr5",defaultMessage:"Task Cancelled"}),handleToggleCaterpillarSidebar:()=>f("activity")}):s.jsx(Ds,{task:n,clientThreadId:t,caterpillarRows:m,messageWithTaskMetadata:a,totalSources:r,handleToggleCaterpillarSidebar:f})}function Os(e,a,t){const n=a.elements.length;if(n===0)return;const o=Object.entries(e).reduce((c,[m,d])=>Array.isArray(d)?d.length>0?c+1:c:d!==""?c+1:c,0);ne.logEventWithStatsig("dynamic-form-submission","chatgpt_dyanmic_form_submission",{...Ne({clientThreadId:t}),totalItems:n.toString(),completedItems:o.toString(),ratio:(o/n).toString()})}function Ls(e,a){let t="";return a.elements.forEach(n=>{const o=n.scope.split("/").pop(),c=o&&e[o],m=c?Array.isArray(c)?c.join(", "):c:"Any",d=n.label??o;t+=`${d}: ${m}
`}),t}function Ps({messages:e,clientThreadId:a,isLastMessage:t}){const n=e.find(E=>E.message.author.role===he.Assistant),o=e.find(E=>E.message.metadata?.json_form),c=o?.message.metadata?.json_form,[m,d]=p.useState({}),[r,x]=p.useState(),[f,u]=p.useState(),g=W(a,E=>E?.modelId??Ye),_=Ss(),y=bs({clientThreadId:a});p.useEffect(()=>{c&&(x(c.json_form_ui),u(c.json_form_data))},[c]);const j=p.useCallback(()=>{if(d({}),r){const E={...r,elements:r.elements.filter(P=>P.scope!=="#/properties/AdditionalInfo")};x(E)}f&&(delete f.properties.AdditionalInfo,u(f))},[d,x,u,r,f]),T=p.useCallback(()=>{if(r){const E={...r,elements:[...r.elements,{type:"Control",scope:"#/properties/AdditionalInfo",label:"Additional Info",placeholder:"Any other details..."}]};x(E)}if(f){const E={...f.properties,AdditionalInfo:{type:"string"}};u({...f,properties:E})}},[x,u,r,f]),I=r?.elements.some(E=>E.scope.endsWith("#/properties/AdditionalInfo")),w=ye.getThreadCurrentLeafId(a),A=o?.nodeId!==w;if(!o||!f||!r)return n?.message.status==="in_progress"&&t?s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(X,{className:"h-[26px] w-full"}),s.jsx(X,{className:"h-[26px] w-3/4"}),s.jsx($e,{})]}):null;if(A)return null;const M=async()=>{const E=Ls(m,r);Os(m,r,a),je(a,P=>{Ee.appendMessage(P,Se(E))}),y({model:g,completionType:be.Next,parentNodeId:ae.getCurrentLeafId(ve(a)),metadata:{},completionMetadata:{systemHints:[..._],conversationMode:{kind:z.PrimaryAssistant}}})};return s.jsxs(Xe,{children:[s.jsx(Fs,{formData:m,dataSchema:f,uiSchema:r,setData:d,readOnly:A}),s.jsxs("div",{className:"flex w-full justify-between",children:[I?s.jsx("div",{}):s.jsx(H,{disabled:A,onClick:T,color:"secondary",className:"text-token-text-secondary",children:s.jsx(v,{id:"Sen69P",defaultMessage:"Add a detail"})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(H,{disabled:A,onClick:j,color:"secondary",className:"text-token-text-secondary",children:s.jsx(v,{id:"Uqo7UD",defaultMessage:"Reset"})}),s.jsx(H,{disabled:A,onClick:M,children:s.jsx(v,{id:"FVou++",defaultMessage:"Start"})})]})]})]})}function Fs({dataSchema:e,uiSchema:a,setData:t,readOnly:n,formData:o}){return s.jsx("div",{children:s.jsx(qe,{formData:o,readOnly:n,schema:e,uiSchema:a,onChange:c=>t(c)})})}const Us=2e3,me=.4,Vs=.45,Bs=.2,zs=.1,Hs=.25;var O=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(O||{});function bt({conversationMessages:e,icon:a,status:t,text:n,estimatedToolDurationMs:o,animationLoopDurationMs:c=Us,shouldPersistAfterFinished:m=!1}){const[d,r]=p.useState(t===0?0:t===1&&!m?7:1),[x,f]=p.useState(0);p.useEffect(()=>{t===2?r(8):t===3?r(9):t===4?r(10):t===1?r(d===2?3:7):t===0&&d===10&&(r(2),f(g=>g+1))},[t]);const u=Qs(d);return p.useEffect(()=>{const g=e[0].message.id;if(u)return q.addDelayedRenderingMessage(g),()=>{q.removeDelayedRenderingMessage(g)}},[u]),le(()=>{L(d)&&f(g=>g+1)},c),d===7&&!m?null:s.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[s.jsx(Js,{icon:a,status:t,uiState:d,estimatedToolDurationMs:o,animationLoopCounter:x,shouldPersistAfterFinished:m,onFillProgressBarAnimationComplete:()=>r(4),onFinishAnimationComplete:()=>{r(5),setTimeout(()=>{r(m?7:6)},zs*1e3)},onHideAnimationComplete:()=>r(7)}),s.jsx(Ks,{text:n,uiState:d,animationLoopCounter:x,onEnterAnimationComplete:()=>r(2)})]})}const Z=50;function Js({icon:e,status:a,uiState:t,estimatedToolDurationMs:n,animationLoopCounter:o,shouldPersistAfterFinished:c,onFillProgressBarAnimationComplete:m,onFinishAnimationComplete:d,onHideAnimationComplete:r}){const[x,f]=p.useState(0);le(()=>{L(t)?f(w=>w+Z):t===10&&f(0)},Z);let u,g,_;L(t)||t===10?(u="running",g=s.jsx(e,{animationLoopCounter:o}),_="bg-transparent"):t===4||t===5||t===7&&c?(u="finished",g=s.jsx(Ge,{}),_="bg-brand-purple"):a===2?(u="error",g=s.jsx(es,{}),_="bg-orange-500"):a===3&&(u="stopped",g=s.jsx(ss,{}),_="bg-gray-300");let y={opacity:0,scale:0,rotate:-180,x:0},j={type:"spring",bounce:.3,duration:Vs},T={opacity:0,scale:.6,rotate:0,x:0};t===0?(y={opacity:0,scale:.5,rotate:-180,x:-8},j={type:"spring",bounce:.3,duration:me}):t===1?y=!1:t===5&&(T={opacity:0,scale:0,rotate:0,x:0},j={type:"spring",bounce:.3,duration:Hs});const I=ts(x,n);return s.jsx("div",{className:"relative h-5 w-5 shrink-0",children:s.jsx(V,{onExitComplete:()=>{t===6&&r()},children:u!=null&&s.jsxs(D.div,{className:N("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",_),initial:y,animate:{opacity:1,scale:1,rotate:0,x:0},exit:T,transition:j,onAnimationComplete:()=>{t===4&&d()},children:[g,(L(t)||t===10)&&s.jsx(Ze,{percentage:t===3?100:I,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:t===3?`${(100-I)/100*Bs}s`:void 0,transitionTimingFunction:t===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{t===3&&m()}})]},u)})})}function Ks({text:e,uiState:a,animationLoopCounter:t,onEnterAnimationComplete:n}){const[o,c]=p.useState(e);p.useEffect(()=>{a===2&&c(e)},[t]),p.useEffect(()=>{L(a)||c(e)},[a,e]);let m={opacity:0,x:0,y:15},d={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};a===0?(m={opacity:0,x:-8,y:0},d={type:"spring",bounce:.3,duration:me,delay:.15}):a===1&&(m=!1);const r=o??void 0;return s.jsx("div",{className:N("relative h-5 w-full leading-5",a===8||a===9?"text-token-text-tertiary":"text-token-text-secondary"),children:s.jsx(V,{children:r!=null&&s.jsx(D.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:m,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:d,onAnimationComplete:()=>{a===0&&n()},children:r},r.toString())})})}function L(e){return e===0||e===2||e===3}function Qs(e){return L(e)||e===4||e===5||e===6||e===10}const G=re.div`group left-0 top-0 mr-1.5 overflow-hidden mt-1 text-start`,Ws=({highlightedCommand:e,status:a,children:t,showWorkUserSetting:n=!1,hideOnlyIfNotInteractedWith:o=!1,defaultExpanded:c=!1,onOpenAnalytics:m,onClick:d,...r},x)=>{const f=t!=null||d!=null,[u]=p.useState(n),[g,_]=p.useState(n||c),[y,j]=p.useState(!1),T=a===O.Finished||a===O.Error,I=o?u?!1:!y:!1,w=a===O.Running&&"loading-shimmer";return T&&I?null:f?s.jsxs(s.Fragment,{children:[s.jsx(ee,{ref:x,$canShowWork:!0,...r,children:s.jsx(V,{children:s.jsx(G,{children:s.jsx(D.button,{onClick:A=>{g||m?.(),_(M=>!M),j(!0),d?.(A)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:N(w),children:s.jsxs("div",{className:"flex items-center justify-start gap-1",children:[s.jsx("span",{className:"text-start",children:e}),!d&&(g?s.jsx(as,{className:"icon-md"}):s.jsx(ns,{className:"icon-md"}))]})},e?.toString())})})}),s.jsx(V,{children:g&&t&&s.jsx(D.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t})})]}):s.jsx(ee,{ref:x,$canShowWork:!1,...r,children:s.jsx(G,{className:N(w),children:e})})},ee=re.span`block first:mt-0 relative
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,Ys=p.forwardRef(Ws),$s=3,Xs=.1,se=[0,.26,.4];function qs({nextMessage:e,isLastMessage:a,isRequestActive:t,isLastTurnInConversation:n,clientThreadId:o,turnIndex:c}){let m=a||!e||e&&!K(e.message);const d=p.useRef(!1),r=Fe(),x=W(o,ae.getGizmoId);p.useEffect(()=>{e&&K(e.message)&&!d.current&&(d.current=!0,rs(r,x))},[e,r,x]);const f=Ce(e?.message),u=Te(e?.message);e?.message.id&&Ns(e?.message.id);const g=[];if(u?.[0]?.type==="navigation"&&e&&g.push(s.jsx(Zs,{clientThreadId:o,turnIndex:c,nextMessage:e,isRequestActive:t,isLastTurnInConversation:n,navigationCitation:u[0]},"fast-nav")),m){const _=Ae(f.slice(0,$s).map(j=>j.entries[0].url)),y=t?s.jsxs("div",{className:"flex items-center gap-1",children:[_.map((j,T)=>s.jsx(D.div,{className:N("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:T===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:Xs,delay:se[Math.min(T,se.length-1)]},children:s.jsx("div",{className:N("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:s.jsx(os,{url:j,size:32,minSize:16,className:"icon-md rounded-full"})})},j)),s.jsx(v,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):s.jsx(v,{id:"fssXGM",defaultMessage:"Error while searching"});g.push(s.jsx(Ys,{highlightedCommand:y,status:t?O.Running:O.Error},"search-gpt-query"))}return g.length?s.jsx(s.Fragment,{children:g}):null}const Zs=({clientThreadId:e,turnIndex:a,nextMessage:t,isRequestActive:n,isLastTurnInConversation:o,navigationCitation:c})=>{const{scrollToHeader:m}=ke("searchSources")??{},d=Ie(),r=we()&&d?.type==="searchSources",{openThreadSidebar:x}=B(),{value:f}=oe("756982148");return p.useEffect(()=>{De.addFirstTiming("render.fastNavigation")},[]),p.useEffect(()=>{r&&x({type:"searchSources",scrollToHeader:m,clientThreadId:e,turnIndex:a,messageId:t?.message.id??""})},[]),p.useEffect(()=>{const u=t.message,g=u.metadata?.search_source,_=c.domains.map(y=>y.url);is.logEvent($.searchToolRequestTimeToFastNav,e,u.id,{search_source:g,urls:_},()=>{g===Me.InstantQuery&&cs.logEvent($.searchToolPageLoadTimeToFastNav,{message_id:u.id,urls:_,search_source:g})})},[e,t,c]),n&&o&&f?s.jsx(D.div,{initial:{opacity:n?0:1,height:n?0:"auto"},animate:{opacity:1,height:"auto"},children:s.jsx(te,{clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:c})}):s.jsx(te,{clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:c})},te=({clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:n})=>{const{toggleThreadSidebar:o}=B(),{value:c}=oe("756982148"),m=p.useMemo(()=>({clientThreadId:e,turnIndex:a,messageId:t?.message.id}),[e,a,t?.message.id]),d=p.useCallback((f,u)=>{o({type:"searchSources",scrollToHeader:u,clientThreadId:e,turnIndex:a,messageId:t?.message.id??""})},[o,e,a,t?.message.id]),r=p.useRef(new Set),x=p.useCallback((f,u,g,_)=>{if(m&&m.messageId&&Re(m.messageId)){const y=ls(g,m,_),j=`${f}-${JSON.stringify(y)}`;(!r.current.has(j)||!ds(f,_))&&(r.current.add(j),ne.logEventWithStatsig(f,u,y))}},[m]);return c?s.jsx(vs,{navigation:n,onShowSearchResults:d,trackContentReferenceEvent:x}):s.jsx(ms,{tldr:{type:"tldr",display_title:n.domains[0].title,url:n.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[n.domains[0].domain],refs:[]},trackContentReferenceEvent:x})},Gs=b(()=>C(()=>import("./f8cs9hgiu8i8fq5l.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),et=b(()=>C(()=>import("./i4fhtrkiiy41fft9.js"),__vite__mapDeps([13,1,3,4,14]))),st=b(()=>C(()=>import("./bgbofdn5q7ucpong.js"),__vite__mapDeps([15,1,3,4,6,7]))),tt=b(()=>C(()=>import("./i3hkkuliosdo4kaj.js"),__vite__mapDeps([16,1,3,4,6,7,8])).then(e=>e.TextMessageEditor)),at=b(()=>C(()=>import("./gq67rp1jg2edayk6.js"),__vite__mapDeps([17,1,3,4,18,6,7,19,2,5,8,9,10,11,12]))),nt=b(async()=>()=>null),rt=b(()=>C(()=>import("./mjw5oil5iiagr2v4.js"),__vite__mapDeps([20,1,3,4,6,7,8,9,10,11,12]))),ot=b(()=>C(()=>import("./kol7s771m8hjwjag.js"),__vite__mapDeps([21,1,3,4,6,7,8,9,10,11,12])).then(e=>e.BrowsingMessage)),it=b(()=>C(()=>import("./lu887k056q3j4k31.js"),__vite__mapDeps([22,1,3,4,6,7])).then(e=>e.SearchResultMessage)),ct=b(()=>C(()=>import("./mxux1o5cr1octc71.js"),__vite__mapDeps([23,1,3,4,6,7,8,9,10,11,12])).then(e=>e.JITPluginMessage)),lt=b(()=>C(()=>import("./j7sv058t94hrw1fg.js"),__vite__mapDeps([24,3,1,4,6,7,8,9,10,11,12])).then(e=>e.DataAnalysisMessage)),dt=b(()=>C(()=>import("./knb6y7em4qlrpkuc.js"),__vite__mapDeps([25,1,3,4,6,7,26,27,28,8,9,10,11,12]))),mt=b(()=>C(()=>import("./np3x8otcg6488fny.js"),__vite__mapDeps([29,1,3,4,30,31,6,7,32,8,9,33,34,35,36,18,37,38,39,10,40,41,26,42])).then(e=>e.CoTMessage)),ut=b(()=>C(()=>import("./ldbt41bh1m0qw62w.js"),__vite__mapDeps([43,1,6,3,4,7,44,45,46,47])).then(e=>e.JawboneMessage));function vt(e){switch(e.type){case i.Text:case i.Debug:return[e.message];case i.MultiText:case i.Browsing:case i.CodeInterpreter:case i.JITPlugin:case i.RetrievalBrowsing:case i.ParallelBrowsing:case i.Dalle:case i.t2uay3k:case i.GizmoEditor:case i.SearchResult:case i.a8km123:case i.f959b8c:case i.b1de6e2_c:case i.b1de6e2_s:case i.b1de6e2_d:case i.is_loading_message:case i.Canmore:case i.SonicCanvas:case i.de1d73e:case i.SearchGPTQuery:case i.l1p9k3u:case i.oiw209h:case i.c12k321:return e.messages;default:throw new Error("Bad")}}function Nt({groupedMessagesToRender:e,allGroupedMessages:a,clientThreadId:t,isEditing:n,isUserTurn:o,isCompletionRequestInProgress:c,isFeedbackEnabled:m,isFinalTurn:d,turnIndex:r,hasActiveRequest:x,showEditButton:f=!1,handleEnterEdit:u,handleExitEdit:g,onChangeItemInView:_,onRequestMoreCompletions:y,onRequestCompletion:j,shouldGrowContainer:T=!0}){const{value:I}=Oe("2121807298"),{showDebugConversationTurns:w}=us(),[A]=W(t,l=>[l?.mode]),M=Le(t),E=gs(),P=a.some(l=>fs.includes(l.type)),ue=e.map((l,h)=>{const k=h===a.length-1;switch(l.type){case i.Text:case i.MultiText:{const S=e[h-1],R=S?.type,F=S&&"messages"in S?S.messages:void 0;if(l.type===i.Text){const ge=l?.message&&!K(l.message.message),fe=n?s.jsx(tt,{message:l.message,clientThreadId:t,onChangeItemInView:_,onRequestCompletion:j,onRequestMoreCompletions:y,onExitEdit:g,disabled:x}):P&&ge?null:s.jsx(hs,{className:"min-h-8",message:l.message,isFeedbackEnabled:m,isCompletionInProgress:k&&c,turnIndex:r,clientThreadId:t,showEditButton:f,onEnterEdit:u,isUserTurn:o,onRequestMoreCompletions:y,prevGroupedMessageType:R,prevGroupedMessages:F});return s.jsxs(p.Fragment,{children:[fe,s.jsx(ys,{isUserTurn:o,message:l.message.message})]},"group-"+l.message.nodeId)}else return l.type===i.MultiText?s.jsx(st,{clientThreadId:t,messages:l.messages,isCompletionInProgress:k&&c,isFeedbackEnabled:m,onRequestMoreCompletions:y,prevGroupedMessageType:R,prevGroupedMessages:F},"multitext-"+(l.messages[0]?.nodeId??h)):l.type}case i.Browsing:case i.RetrievalBrowsing:{const S=A!=null&&[z.GizmoInteraction,z.GizmoMagicCreate,z.GizmoTest].includes(A.kind),R=M?_s(M):!1;return s.jsx(ot,{messages:l.messages,isRequestActive:x,isLastMessageInTurn:k,isUsingGizmo:S,isUsingSnorlax:R,isRetrieval:l.type===i.RetrievalBrowsing},"browsing-"+(l.messages[0]?.nodeId??h))}case i.SearchGPTQuery:{const S=a.slice(h+1).find(({type:F})=>F===i.Text||F===i.SonicCanvas),R=S?.type===i.Text?S.message:S?.type===i.SonicCanvas?S.messages[0]:void 0;return s.jsx(qs,{clientThreadId:t,turnIndex:r,isRequestActive:x,isLastMessage:k,isLastTurnInConversation:d,nextMessage:R},"searchquery-"+(l.messages[0]?.nodeId??h))}case i.a8km123:return I&&l.messages.find(({message:S})=>S.metadata?.model_slug?.includes("o3-mini"))?s.jsx(mt,{isStreaming:k&&c,messages:l.messages},"sum-"+(l.messages[0]?.nodeId??h)):s.jsx(dt,{messages:l.messages,isStreaming:k&&c,isLastMessage:k,clientThreadId:t,currentGroupedMessageIndex:h,turnIndex:r},"sum-"+(l.messages[0]?.nodeId??h));case i.f959b8c:return null;case i.is_loading_message:return k&&c?s.jsx(ps,{},"loading-message-"+h):null;case i.c12k321:return null;case i.l1p9k3u:return null;case i.b1de6e2_c:return s.jsx(Ps,{messages:l.messages,clientThreadId:t,isLastMessage:k},"b1de6e2-"+(l.messages[0]?.nodeId??h));case i.b1de6e2_s:return s.jsx(Ms,{messages:l.messages,clientThreadId:t},"b1de6e2_s-"+(l.messages[0]?.nodeId??h));case i.b1de6e2_d:return null;case i.de1d73e:if(E){const S=h+1<a.length?a[h+1]:void 0;return s.jsx(ut,{clientThreadId:t,currentGroupedMessage:l,nextMessage:S&&S.type===i.Text?S.message:void 0,isLastMessage:k,isRequestActive:x},"jawbone-"+(l.messages[0]?.nodeId??h))}else return null;case i.ParallelBrowsing:return s.jsx(rt,{messages:l.messages},"parallel-"+(l.messages[0]?.nodeId??h));case i.CodeInterpreter:return s.jsx(lt,{messages:l.messages,isRequestActive:x,clientThreadId:t},"ada-"+(l.messages[0]?.nodeId??h));case i.JITPlugin:return s.jsx(ct,{messages:l.messages,clientThreadId:t,isLastTurnInConversation:d,onRequestCompletion:j},"jit-"+(l.messages[0]?.nodeId??h));case i.Dalle:case i.t2uay3k:return s.jsx(at,{messages:l.messages,clientThreadId:t},"dalle-"+(l.messages[0]?.nodeId??h));case i.GizmoEditor:return s.jsx(Gs,{messages:l.messages},"gizmo-editor-"+(l.messages[0]?.nodeId??h));case i.oiw209h:return s.jsx(nt,{messages:l.messages,clientThreadId:t},"oiw209h-"+(l.messages[0]?.nodeId??h));case i.Canmore:return s.jsx(xs,{messages:l.messages,allGroupedMessages:e,isFinalTurn:d,isRequestActive:x,clientThreadId:t},"canmore-"+(l.messages[0]?.nodeId??h));case i.SonicCanvas:return!1;case i.Debug:return w?s.jsx(et,{message:l.message},"debug-"+l.message.nodeId):null;case i.SearchResult:return s.jsx(it,{messages:l.messages},"search-result-"+(l.messages[0]?.nodeId??h))}});return s.jsx(ft,{shouldGrowContainer:T,children:ue})}function gt(){return s.jsx(js,{type:"danger",children:s.jsx(v,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."})})}function ft({children:e,shouldGrowContainer:a}){return s.jsx("div",{className:N({"flex max-w-full flex-col":!0,"flex-grow":a}),children:s.jsx(Pe,{name:"GroupedMessages",fallback:gt,children:e})})}export{Nt as C,O as T,Ys as a,bt as b,vt as g};
//# sourceMappingURL=ecs2ptmt646v6gvn.js.map

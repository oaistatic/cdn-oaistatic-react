var X=Object.defineProperty,Y=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var T=(a,t,s)=>t in a?X(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,c=(a,t)=>{for(var s in t||(t={}))K.call(t,s)&&T(a,s,t[s]);if(L)for(var s of L(t))V.call(t,s)&&T(a,s,t[s]);return a},w=(a,t)=>Y(a,F(t));import{b as P,d as G,j as e,r as h,M as W,u as ee,a as ae}from"./jj85rqzpbnvv3emr.js";import{o$ as te,p0 as se,e as re,gh as oe,ej as I,f as Q,bw as z,dF as S,lT as j,C as le,I as ce,pb as ne,pc as ie,jH as de,pd as pe,ld as ue,h3 as me,R as fe,aI as xe,im as ke,io as he}from"./lef5ym39glv4981l.js";import{bd as ve,fH as Me,aU as be}from"./mclphevd122040jw.js";import{u as je}from"./dta5t6ifyam55mk9.js";function ge({onFileChange:a,className:t,message:s,mimeTypes:f}){const v=P(),n=s!=null?s:v.formatMessage(O.helpText),i=N=>{if(N.length>0){const A=N[0];f&&f.includes(A.type)&&a(A)}},{open:g,getRootProps:M,getInputProps:y,isDragActive:m}=je(c({disabled:!1,noClick:!0,onDropAccepted:i,onDropRejected:()=>null,multiple:!1,maxSize:se},te(f)));return e.jsxs("div",w(c({className:re("flex flex-col content-center justify-center gap-3 rounded-xl border border-dashed px-6 py-16 text-center",m?"border-green-600 bg-green-600/10":"border-token-border-medium",t)},M()),{children:[e.jsx("input",c({},y())),e.jsx("div",{className:"text-center dark:text-white",children:e.jsx("div",{className:"inline-block",children:e.jsx(ve,{})})}),e.jsx("div",{className:"text-center text-sm",children:n}),e.jsx("div",{className:"cursor-pointer text-center text-sm font-bold text-green-600",onClick:()=>{g()},children:v.formatMessage(O.openFilePicker)})]}))}const O=G({helpText:{id:"FileUploadBox.helpText",defaultMessage:"Drop file here to upload"},openFilePicker:{id:"FileUploadBox.openFilePicker",defaultMessage:"Browse files"}}),q=192;function we(a){const t=ee(),s=P(),f=Q();return ae({mutationFn:({name:v,profilePictureId:n,profilePictureUrl:i})=>fe.safePatch("/accounts/{account_id}",{parameters:{path:{account_id:a}},requestBody:{name:v,profile_picture_id:n!=null?n:"",profile_picture_url:i!=null?i:""}}).catch(g=>{f.danger(s.formatMessage(p.saveError,{error:g.message}),{toastId:"workspace_appearance_modal",loggingTitle:p.saveError.defaultMessage,loggingDescription:"Failed to save workspace appearance"})}),onSuccess:()=>{t.invalidateQueries(me())}})}function We({workspace:a}){var D,E;const[t,s]=h.useState((D=a==null?void 0:a.name)!=null?D:""),[f,v]=h.useState(!1);!f&&a&&(v(!0),t==""&&s((E=a==null?void 0:a.name)!=null?E:""));const[n,i]=h.useState(a.profilePictureUrl),[g,M]=h.useState(a.profilePictureId),y=oe(I.WorkspaceAppearance),m=P(),N=Q(),A=()=>S.closeModal(I.WorkspaceAppearance),[o,x]=h.useState(void 0);async function H(u){const b=await ie(u,q),_=de(b);x({tempId:_,file:b,status:j.Uploading,progress:1,fileId:null,cdnUrl:null}),pe(_,b,m,N,ue.ProfilePicture,{onFileCreated(k,d,l){x(r=>r!=="initial"&&(r==null?void 0:r.tempId)===k&&r.status===j.Uploading?w(c({},r),{progress:10,fileId:d,cdnUrl:l}):r)},onFileUploadProgress(k,d){x(l=>l!=="initial"&&(l==null?void 0:l.tempId)===k&&l.status===j.Uploading?w(c({},l),{progress:d}):l)},onFileUploaded(k,d,l){x(r=>r!=="initial"&&r&&r.cdnUrl&&r.tempId===k?(ke(r.fileId).then(B=>{B.status===he.Success&&(M(r.fileId),i(B.download_url))}),w(c({},r),{status:j.Ready,progress:100,fileSpec:c({name:r.file.name,id:r.fileId,size:r.file.size},l!=null?l:{})})):r)},onError(k){x(d=>{if(d!=="initial"&&(d==null?void 0:d.tempId)===k){M(void 0),i(void 0),C(null);return}return d})}})}const R=we(a.id),Z=e.jsx(z.Button,{color:"primary",disabled:o!=="initial"&&o!==void 0&&o.status!==j.Ready||o!=="initial"&&o!==void 0&&o.status===j.Ready&&!n||R.isPending||t.trim().length===0,onClick:async()=>{R.mutate({name:t,profilePictureId:g,profilePictureUrl:n}),S.closeModal(I.WorkspaceAppearance)},title:m.formatMessage(p.modalSubmit)}),$=e.jsx(z.Button,{onClick:()=>{x(void 0),M(a.profilePictureId),i(a.profilePictureUrl),S.closeModal(I.WorkspaceAppearance)},title:m.formatMessage(p.modalCancel)}),[U,C]=h.useState(null);h.useEffect(()=>{if(o!=="initial"&&o!=null&&U==null){const u=new FileReader;u.addEventListener("load",()=>{const b=u.result;typeof b=="string"&&C(b)}),u.readAsDataURL(o.file)}},[o,U]);const J=()=>{M(null),i(null),x(void 0),C(null)};return e.jsxs(le,{testId:"modal-workspace-appearance",isOpen:y,onClose:A,showCloseButton:!0,primaryButton:Z,secondaryButton:$,type:"danger",title:m.formatMessage(p.modalTitle),children:[e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-name",className:"text-token-text-primary block pb-1 font-semibold",children:e.jsx(W,c({},p.workspaceName))}),e.jsx("p",{className:"font-base text-token-text-secondary text-sm",children:e.jsx(W,c({},p.workspaceNameDescription))})]}),e.jsx("div",{className:"mb-4",children:e.jsx(ce,{ariaLabel:!1,type:"text",name:"workspace-name",value:t,onChange:u=>s(u.target.value),maxLength:64})}),e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-avatar",className:"text-token-text-primary block pb-1 font-semibold",children:e.jsx(W,c({},p.workspaceAvatar))}),e.jsx("p",{className:"font-base text-token-text-secondary text-sm",children:m.formatMessage(p.workspaceAvatarDescription,{size:q})})]}),e.jsxs("div",{className:"mb-4 flex-wrap text-center",children:[n?e.jsxs("div",{className:"relative mb-3 inline-flex",children:[e.jsx("img",{src:n,alt:"",referrerPolicy:"no-referrer",className:"block h-24 w-24 rounded-full object-cover object-center"}),e.jsx("div",{className:"absolute -end-1 -top-1",children:e.jsx(Ne,{onClick:J})})]}):o!=null&&o!=="initial"&&U?e.jsx("div",{className:"flex flex-col justify-center text-center",children:e.jsxs("div",{className:"relative mb-3 text-center",children:[e.jsx("img",{src:URL.createObjectURL(o.file),alt:"",referrerPolicy:"no-referrer",className:"block h-24 w-24 rounded-full object-cover object-center"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsx(Me,{percentage:o.progress,className:"h-6 w-6"})})]})}):e.jsx(ge,{onFileChange:u=>{H(u)},mimeTypes:ne}),e.jsx(be,{className:"mt-3",children:m.formatMessage(p.propagationWarning)})]})]})}function Ne({onClick:a}){return e.jsx("div",{className:"flex h-6 w-6 cursor-pointer flex-row flex-wrap content-center justify-center rounded-full border-2 border-white bg-black text-white",onClick:a,children:e.jsx(xe,{className:"h-3 w-3"})})}const p=G({modalTitle:{id:"workspaceAppearanceModal.title",defaultMessage:"Workspace appearance"},modalSubmit:{id:"workspaceAppearanceModal.submit",defaultMessage:"Save"},modalCancel:{id:"workspaceAppearanceModal.cancel",defaultMessage:"Cancel"},modalReset:{id:"workspaceAppearanceModal.reset",defaultMessage:"Reset"},workspaceName:{id:"workspaceAppearanceModal.workspaceName",defaultMessage:"Workspace name"},workspaceNameDescription:{id:"workspaceAppearanceModal.workspaceNameDescription",defaultMessage:"Update the name of the workspace."},workspaceAvatar:{id:"workspaceAppearanceModal.workspaceAvatar",defaultMessage:"Workspace image"},workspaceAvatarDescription:{id:"workspaceAppearanceModal.workspaceAvatarDescription",defaultMessage:"Upload a JPEG or PNG workspace image for your team. (Minimum {size}Ã—{size}px recommended.)"},propagationWarning:{id:"workspaceAppearanceModal.propagationWarning",defaultMessage:"Changes to the workspace name and image may take some time to take effect."},saveError:{id:"workspaceAppearanceModal.saveError",defaultMessage:"Failed to save workspace appearance"}});export{ge as F,We as W,p as m,we as u};
//# sourceMappingURL=mej2ctt6swvc1m1z.js.map

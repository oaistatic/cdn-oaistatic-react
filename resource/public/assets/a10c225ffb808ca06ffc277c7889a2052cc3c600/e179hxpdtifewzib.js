var R=Object.freeze,O=Object.defineProperty,Q=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var _=(e,a,r)=>a in e?O(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,M=(e,a)=>{for(var r in a||(a={}))Y.call(a,r)&&_(e,r,a[r]);if(T)for(var r of T(a))z.call(a,r)&&_(e,r,a[r]);return e},D=(e,a)=>Q(e,q(a));var U=(e,a)=>R(O(e,"raw",{value:R(a||e.slice())}));import{r as v,j as s,M as g,b as X,G as H}from"./jj85rqzpbnvv3emr.js";import{S as N,R as $,B as J,T as K,a as E,C as Z,X as ee,b as ae,p as te,Y as se,c as re,d as A,M as ie,e as oe,f as de,r as ne}from"./ck1161dhvnx32o2f.js";import{F as le,E as G,e as ce,lb as ue,w as he}from"./lef5ym39glv4981l.js";import{W as ye}from"./i5w9a1ap4yrxpqjj.js";import{y as xe,z as me,A as ve}from"./ef92qx749w9klz4o.js";import"./mclphevd122040jw.js";import"./fnnulb9pmlo3cgid.js";import"./k6u2cn52t3dhqz8s.js";import"./c631j8z7keqfibnl.js";import"./galyil7vygq0i5a6.js";import"./f8qcx5r3ombc6w5p.js";import"./l5n8sav08y32nia1.js";import"./efsl2tpd3w39q64v.js";import"./hqbuxjfjvu1puiaw.js";import"./jxokrjy8ycftw0wv.js";import"./jk4cx3iywxazx01l.js";import"./hc8beflnn681x6ow.js";import"./mw2u7timj0qnsnvj.js";import"./dvqe6kc43fkjsavv.js";import"./nk7ydxm8ptxusvbt.js";import"./k059n59kmbyb9lsl.js";import"./ojb4d4bxj44fs0l8.js";import"./oz589d7sqtxcbljf.js";import"./kxedrjbxv2qblujd.js";function fe({response:e,isLoading:a,isError:r,seriesId:d,displayName:o,aggregation:l="sum"}){if(a)return"loading";if(e==null||e.data==null)return r?we(d,o):"loading";const c=e.data,u=c.reduce((i,n)=>i+n.value,0),y=c.length,t=l==="average"&&y>0?Math.max(0,Math.round(u/y)):u;return{data:c.map(({date:i,value:n})=>({date:i,total:n,values:{[d]:n}})),metrics:{[d]:{total:t,displayName:o}}}}function ge({response:e,isLoading:a,isError:r,seriesLabels:d}){if(a)return{chartData:I(d),isLoading:!0};if(e==null||e.data==null)return{chartData:I(d),isLoading:!r};const o=Object.keys(d),l=e.data.map(({date:t,values:i})=>{const n={};let h=0;return o.forEach(x=>{var f;const m=(f=i[x])!=null?f:0;n[x]=m,h+=m}),{date:t,total:h,values:n}}),c=o.reduce((t,i)=>(t[i]=l.reduce((n,h)=>{var x;return n+((x=h.values[i])!=null?x:0)},0),t),{}),u=l.length,y=o.reduce((t,i)=>{const n=c[i],h=u>0?Math.max(0,Math.round(n/u)):0;return t[i]={total:h,displayName:d[i]},t},{});return{chartData:{data:l,metrics:y},isLoading:!1}}function we(e,a){return{data:[],metrics:{[e]:{total:0,displayName:a}}}}function I(e){const a=Object.entries(e).reduce((r,[d,o])=>(r[d]={total:0,displayName:o},r),{});return{data:[],metrics:a}}const W="default",F=e=>e.toLocaleString();var P;const V=le.div(P||(P=U(["flex h-full grow items-center justify-center text-lg text-token-text-tertiary"]))),be=e=>"values"in e,Ce=e=>"blank"in e,pe=(e,a)=>{var d,o,l;if(Ce(e))return(d=e.blank)!=null?d:0;if(a)return(o=e.total)!=null?o:0;let r=0;for(const c of Object.values((l=e.values)!=null?l:{}))typeof c=="number"&&c>r&&(r=c);return r};function Me({title:e,data:a,headlineValue:r,hideLegend:d=!1,seriesColorMap:o}){const l=v.useMemo(()=>a==="loading"?"loading":a.data,[a]),c=v.useMemo(()=>o?Object.values(o).filter(t=>typeof t=="string").length<=1:!0,[o]),u=v.useMemo(()=>l==="loading"?0:l.reduce((t,i)=>{var n;return Math.max(t,(n=pe(i,c))!=null?n:0)},0),[l,c]),y=v.useMemo(()=>{if(a==="loading"||l==="loading")return{};const t=Object.keys(a.metrics).map(i=>{var h,x;const n=l.reduce((m,f)=>{var p;return be(f)?m+((p=f.values[i])!=null?p:0):m},0);return{displayName:(x=(h=a.metrics[i])==null?void 0:h.displayName)!=null?x:i,total:n,groupKey:i}}).sort(({total:i},{total:n})=>n-i);return Object.fromEntries(t.map(({total:i,groupKey:n,displayName:h},x)=>{var m;return[n,{displayName:h,total:i,color:(m=o==null?void 0:o[n])!=null?m:N[x%N.length]}]}))},[l,o,a]);return s.jsxs("div",{className:"border-token-border-default mb-4 flex min-h-[350px] flex-col rounded-lg border pt-4 pb-4",children:[s.jsxs("div",{className:"px-6",children:[s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(g,M({},e))}),s.jsx("div",{className:"mt-1 mb-4 min-h-[1.75rem]",children:r==="loading"?s.jsx(G,{className:"text-token-text-tertiary h-5 w-5"}):s.jsx("span",{className:"text-token-text-primary text-2xl font-semibold",children:je.format(r)})})]}),s.jsx(Se,{processedData:l,maxTotal:u,seriesMetadata:y,hideLegend:d,stackSeries:c})]})}function Se({processedData:e,maxTotal:a,seriesMetadata:r,hideLegend:d,stackSeries:o}){const[l,c]=v.useState();if(e==="loading")return s.jsx(V,{children:s.jsx(G,{})});if(a===0)return s.jsx(V,{children:s.jsx(g,{id:"codex.analytics.multiBarOverview.noData",defaultMessage:"No data for this period"})});const u=Object.entries(r).sort(([t],[i])=>t==="other"&&i==="other"?0:t==="other"?1:i==="other"?-1:0),y=u.map(([t])=>t);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:ce(ne,"flex grow items-center"),children:s.jsx($,{width:"100%",height:220,children:s.jsxs(J,{data:e,margin:{left:-20,top:14,right:20},barGap:o?4:1,children:[s.jsx(K,{isAnimationActive:!1,content:s.jsx(Z,{valueFormatter:F,metricToLabel:r}),cursor:{opacity:.2,fill:E}}),s.jsx(ee,{dataKey:"date",axisLine:!1,tickLine:!1,tick:ae,tickFormatter:t=>ue(te(t),"MMM d"),interval:e.length-2}),s.jsx(se,{axisLine:!1,tickLine:!1,domain:[0,a],ticks:[0,a],fontSize:11,fill:E,tick:t=>s.jsx(re,D(M({},t),{textAnchor:"start",y:t.payload.value===0?t.y:t.y-10,x:t.x-10,fontWeight:400,children:F(t.payload.value)}))}),y.map(t=>{const i="values.".concat(t),n=l&&l!==t,h=o?[4,4,0,0]:[1,1,0,0];return s.jsx(A,{opacity:n?.15:1,dataKey:i,stackId:o?W:void 0,isAnimationActive:!1,fill:n?ie:r[t].color,radius:h},i)}),o?s.jsx(A,{dataKey:"blank",minPointSize:1,stackId:W,isAnimationActive:!1,children:e.map((t,i)=>s.jsx(oe,{opacity:.5,fill:"blank"in t&&t.blank===0?E:"transparent"},"cell-".concat(i)))}):null,s.jsx(de,{y:a,stroke:E,strokeDasharray:"3 3",shape:t=>s.jsx("line",D(M({},t),{x1:22}))})]})})}),!d&&s.jsx("div",{className:"text-token-text-primary flex w-full flex-wrap items-center justify-center text-sm",children:u.map(([t,{displayName:i,color:n}])=>s.jsxs("div",{className:"mx-4 mb-1 flex cursor-pointer items-center justify-center",title:i,onMouseOut:()=>c(void 0),onMouseOver:()=>c(t),children:[s.jsx("div",{className:"me-1 h-2 w-2 rounded-[1px]",style:{backgroundColor:n}}),s.jsx("span",{className:"me-1 max-w-32 overflow-hidden text-ellipsis whitespace-nowrap",children:i})]},t))})]})}const je=new Intl.NumberFormat(void 0,{notation:"compact",maximumSignificantDigits:3});function b({query:e,config:a}){"use forget";const r=X(),{data:d,isLoading:o,isError:l,error:c}=e;l&&he.error(a.loggerMessage,{error:c});const u=v.useMemo(()=>a.buildChartData({response:d,isError:l,isLoading:o,intl:r}),[a,d,r,l,o]),y=v.useMemo(()=>{if(u==="loading")return"loading";const t=Object.values(u.metrics);return t.length===0?0:t.reduce((n,h)=>n+h.total,0)/t.length},[u]);return s.jsxs(s.Fragment,{children:[l?s.jsx("p",{className:"mt-6 text-sm text-red-600 dark:text-red-400",children:s.jsx(g,M({},a.errorMessage))}):null,s.jsx("div",{className:"mt-8",children:s.jsx(Me,{title:a.title,data:u,headlineValue:y,clientEventSource:a.clientEventSource,hideLegend:a.hideLegend,otherGroupLabel:a.otherGroupLabel,seriesColorMap:a.seriesColorMap})})]})}function Le({seriesId:e,aggregation:a,seriesLabelMessage:r}){return({response:d,isError:o,isLoading:l,intl:c})=>fe({response:d,isLoading:l,isError:o,seriesId:e,displayName:c.formatMessage(r),aggregation:a})}function Ee({seriesLabelMessages:e}){return({response:a,isError:r,isLoading:d,intl:o})=>{const l=Object.fromEntries(Object.entries(e).map(([y,t])=>[y,o.formatMessage(t)])),{chartData:c,isLoading:u}=ge({response:a,isError:r,isLoading:d,seriesLabels:l});return u?"loading":c}}const w={codeReview:"#ffab00",web:"#ff3621",vscode:"#00a972",cli:"#077a9d"},C={codeReviewTasks:w.codeReview,codeReviewUsers:w.codeReview,webTasks:w.web,webUsers:w.web,vscodeUsers:w.vscode,cliUsers:w.cli};function S({seriesId:e,seriesLabel:a,title:r,errorMessage:d,loggerMessage:o,clientEventSource:l,seriesColor:c,aggregation:u="average",hideLegend:y=!0}){return{title:r,errorMessage:d,loggerMessage:o,clientEventSource:l,hideLegend:y,seriesColorMap:{[e]:c},buildChartData:Le({seriesId:e,aggregation:u,seriesLabelMessage:a})}}const j={codeReviewUsers:S({seriesId:"codeReviewUsers",loggerMessage:"Failed to load Codex analytics code review users",clientEventSource:"codexDailyCodeReviewUsers",seriesColor:C.codeReviewUsers,title:{id:"codex.analytics.dailycodereviewusers.chartTitle",defaultMessage:"Average Code Review users for the past 30 days",description:"Title for the Codex analytics chart that shows the average number of Code Review users per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailycodereviewusers.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics code review users chart fails to load"},seriesLabel:{id:"codex.analytics.dailycodereviewusers.chartSeriesLabel",defaultMessage:"Code review users",description:"Label for the code review users series shown on the Codex analytics chart"}}),webTasks:S({seriesId:"webTasks",loggerMessage:"Failed to load Codex analytics web tasks",clientEventSource:"codexDailyWebTasks",seriesColor:C.webTasks,title:{id:"codex.analytics.dailywebtasks.chartTitle",defaultMessage:"Average Web tasks for the past 30 days",description:"Title for the Codex analytics chart that shows the average number of Web tasks completed per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailywebtasks.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics web tasks chart fails to load"},seriesLabel:{id:"codex.analytics.dailywebtasks.chartSeriesLabel",defaultMessage:"Web tasks",description:"Label for the web tasks series displayed on the Codex analytics chart"}}),webUsers:S({seriesId:"webUsers",loggerMessage:"Failed to load Codex analytics web users",clientEventSource:"codexDailyWebUsers",seriesColor:C.webUsers,title:{id:"codex.analytics.dailywebusers.chartTitle",defaultMessage:"Average Web users for the past 30 days",description:"Title for the Codex analytics chart that shows the average number of Web users per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailywebusers.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics web users chart fails to load"},seriesLabel:{id:"codex.analytics.dailywebusers.chartSeriesLabel",defaultMessage:"Web users",description:"Label for the web users series displayed on the Codex analytics chart"}}),vscodeUsers:S({seriesId:"vscodeUsers",loggerMessage:"Failed to load Codex analytics VS Code users",clientEventSource:"codexDailyVSCodeUsers",seriesColor:C.vscodeUsers,title:{id:"codex.analytics.dailyvscodeusers.chartTitle",defaultMessage:"Average VS Code users for the past 30 days",description:"Title for the Codex analytics chart that shows the average number of VS Code users per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailyvscodeusers.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics VS Code users chart fails to load"},seriesLabel:{id:"codex.analytics.dailyvscodeusers.chartSeriesLabel",defaultMessage:"VS Code users",description:"Label for the VS Code users series displayed on the Codex analytics chart"}}),cliUsers:S({seriesId:"cliUsers",loggerMessage:"Failed to load Codex analytics CLI users",clientEventSource:"codexDailyCliUsers",seriesColor:C.cliUsers,title:{id:"codex.analytics.dailycliusers.chartTitle",defaultMessage:"Average CLI users for the past 30 days",description:"Title for the Codex analytics chart that shows the average number of CLI users per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailycliusers.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics CLI users chart fails to load"},seriesLabel:{id:"codex.analytics.dailycliusers.chartSeriesLabel",defaultMessage:"CLI users",description:"Label for the CLI users series displayed on the Codex analytics chart"}})},De={id:"codex.analytics.dailycodereviews.chartSeriesLabel",defaultMessage:"Code reviews",description:"Label for the single series displayed on the Codex analytics chart"},ke={title:{id:"codex.analytics.dailycodereviews.chartTitle",defaultMessage:"Average Code Review reviews for the past 30 days",description:"Title for the Codex analytics chart which shows the average number of Code Review reviews performed per day over the past 30 days"},errorMessage:{id:"codex.analytics.dailycodereviews.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when Codex analytics overview fails to load"},loggerMessage:"Failed to load Codex analytics overview",clientEventSource:"codexDailyCodeReviewTasks",hideLegend:!0,seriesColorMap:{codeReviewTasks:C.codeReviewTasks},buildChartData:_e()},Re={codeReview:{id:"codex.analytics.dailyproductusageoverview.codeReviewSeriesLabel",defaultMessage:"Code review",description:"Label for the code review bar series displayed on the product usage overview chart"},web:{id:"codex.analytics.dailyproductusageoverview.webSeriesLabel",defaultMessage:"Web",description:"Label for the web bar series displayed on the product usage overview chart"},vscode:{id:"codex.analytics.dailyproductusageoverview.vscodeSeriesLabel",defaultMessage:"VS Code",description:"Label for the VS Code bar series displayed on the product usage overview chart"},cli:{id:"codex.analytics.dailyproductusageoverview.cliSeriesLabel",defaultMessage:"CLI",description:"Label for the CLI bar series displayed on the product usage overview chart"}},Te={title:{id:"codex.analytics.dailyproductusageoverview.chartTitle",defaultMessage:"Average daily users by product",description:"Title for the Codex analytics chart that shows daily users broken down by product"},errorMessage:{id:"codex.analytics.dailyproductusageoverview.error",defaultMessage:"We ran into an issue loading analytics. Data shown may be out of date.",description:"Error message shown when the Codex analytics product usage overview chart fails to load"},loggerMessage:"Failed to load Codex analytics product usage overview",clientEventSource:"codexDailyProductUsageOverview",seriesColorMap:{codeReview:w.codeReview,web:w.web,vscode:w.vscode,cli:w.cli},buildChartData:Ee({seriesLabelMessages:Re})};function _e(){return({response:e,isError:a,isLoading:r,intl:d})=>{if(r)return"loading";const o=e,l=d.formatMessage(De);if(o==null||o.data==null)return a?Oe(l):"loading";const c=o.data,u=c.reduce((t,i)=>t+i.n_tasks,0),y=c.length>0?Math.max(0,Math.round(u/c.length)):0;return{data:c.map(t=>({date:t.date,total:t.n_tasks,values:{codeReviewTasks:t.n_tasks}})),metrics:{codeReviewTasks:{total:y,displayName:l}}}}}function Oe(e){return{data:[],metrics:{codeReviewTasks:{total:0,displayName:e}}}}function k(e,a){if(!(e==null||e.data==null))return{data:e.data.map(r=>({date:r.date,value:r[a]}))}}function L(e,a){return{data:a,isLoading:e.isLoading,isError:e.isError,error:e.error}}function Ue(){var f,p;const e=xe(),a=me(),r=ve(),o={data:v.useMemo(()=>Ne(e.data,a.data,r.data),[r.data,e.data,a.data]),isLoading:e.isLoading||a.isLoading||r.isLoading,isError:e.isError||a.isError||r.isError,error:(p=(f=e.error)!=null?f:a.error)!=null?p:r.error},l=v.useMemo(()=>k(e.data,"n_users"),[e.data]),c=L(e,l),u=v.useMemo(()=>k(a.data,"n_tasks"),[a.data]),y=v.useMemo(()=>k(a.data,"n_users"),[a.data]),t=L(a,u),i=L(a,y),n=v.useMemo(()=>B(r.data,"n_vscode_users"),[r.data]),h=L(r,n),x=v.useMemo(()=>B(r.data,"n_cli_users"),[r.data]),m=L(r,x);return s.jsx(ye,{topPadding:!0,showSidebar:!1,children:s.jsxs("div",{className:"mx-auto max-w-5xl px-6 pb-12",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.title",defaultMessage:"Codex Analytics"})}),s.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:s.jsx(g,{id:"codex.analytics.subtitle",defaultMessage:"Past 30 days"})}),s.jsxs("section",{className:"mt-8",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.sections.overall",defaultMessage:"Overall"})}),s.jsx(b,{query:o,config:Te})]}),s.jsxs("section",{className:"mt-10",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.sections.codeReview",defaultMessage:"Code review"})}),s.jsx(b,{query:e,config:ke}),s.jsx(b,{query:c,config:j.codeReviewUsers})]}),s.jsxs("section",{className:"mt-10",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.sections.web",defaultMessage:"Web"})}),s.jsx(b,{query:t,config:j.webTasks}),s.jsx(b,{query:i,config:j.webUsers})]}),s.jsxs("section",{className:"mt-10",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.sections.vscode",defaultMessage:"VS Code"})}),s.jsx(b,{query:h,config:j.vscodeUsers})]}),s.jsxs("section",{className:"mt-10",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:s.jsx(g,{id:"codex.analytics.sections.cli",defaultMessage:"CLI"})}),s.jsx(b,{query:m,config:j.cliUsers})]})]})})}function Ne(e,a,r){var c,u,y;const d=new Map,o=(t,i,n)=>{var m;if(t==null||n==null)return;const h=Ae(t),x=(m=d.get(h))!=null?m:{};x[i]=n,d.set(h,x)};return(c=e==null?void 0:e.data)==null||c.forEach(({date:t,n_users:i})=>o(t,"codeReview",i)),(u=a==null?void 0:a.data)==null||u.forEach(({date:t,n_users:i})=>o(t,"web",i)),(y=r==null?void 0:r.data)==null||y.forEach(({date:t,n_cli_users:i,n_vscode_users:n})=>{o(t,"cli",i),o(t,"vscode",n)}),d.size===0?void 0:{data:Array.from(d.keys()).sort().map(t=>{var n,h,x,m,f;const i=(n=d.get(t))!=null?n:{};return{date:t,values:{codeReview:(h=i.codeReview)!=null?h:0,web:(x=i.web)!=null?x:0,vscode:(m=i.vscode)!=null?m:0,cli:(f=i.cli)!=null?f:0}}})}}function Ae(e){return typeof e=="string"?e:e.toISOString().slice(0,10)}function B(e,a){if(!(e==null||e.data==null))return{data:e.data.map(r=>{var d,o;return{date:r.date,value:a==="n_cli_users"?(d=r.n_cli_users)!=null?d:0:(o=r.n_vscode_users)!=null?o:0}})}}const na=()=>[{title:"Codex"}],la=H(function(){return s.jsx(Ue,{})});export{la as default,na as meta};
//# sourceMappingURL=e179hxpdtifewzib.js.map

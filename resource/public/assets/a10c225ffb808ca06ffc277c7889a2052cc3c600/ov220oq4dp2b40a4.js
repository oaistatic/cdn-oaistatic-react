var U=Object.defineProperty,D=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var _=(r,t,e)=>t in r?U(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,y=(r,t)=>{for(var e in t||(t={}))Q.call(t,e)&&_(r,e,t[e]);if(M)for(var e of M(t))V.call(t,e)&&_(r,e,t[e]);return r},N=(r,t)=>D(r,H(t));import{b as A,j as o,M as J,g as X,r as p,G as Y,a6 as Z}from"./jj85rqzpbnvv3emr.js";import{B as tt,aD as E,e as et,q9 as rt,i as G,j as ot,ij as W,gm as nt,bi as st,P as at,dO as it,gk as F,cm as z,ci as ct,e$ as mt}from"./lef5ym39glv4981l.js";import{m as k}from"./nc6572sivljsjb83.js";import{R as pt}from"./hqfi3w6n0au8rjqf.js";import{S as dt}from"./p3pgrg5rixv5zcdw.js";import{lN as lt,lO as ut,lP as ht,kt as b,ku as R,lQ as gt}from"./mclphevd122040jw.js";import{C as L}from"./ka8yvzszndzglfav.js";import{a as ft}from"./e0efgancp8wep37e.js";import{a as xt}from"./grn8a526pt96jzlg.js";import{a as kt,g as Pt,T as Tt,W as yt,b as bt}from"./kf5isiqcpnpe4fhv.js";import{m as O,n as Ct,o as jt}from"./ef92qx749w9klz4o.js";import{u as vt}from"./nk7ydxm8ptxusvbt.js";import"./ng0sx063g0r0whhb.js";import"./fvmxudg74tbhlabl.js";import"./hnotrmacgvnfyexv.js";import"./hqbuxjfjvu1puiaw.js";import"./jxokrjy8ycftw0wv.js";import"./jk4cx3iywxazx01l.js";import"./du2fkn1o0qxwuukg.js";import"./n82i9qkvs5r9bggc.js";import"./9z485wf4plyfoo73.js";import"./cncd8uuk5eicbkeu.js";import"./dta5t6ifyam55mk9.js";import"./cdk0cmbgnafohb1q.js";import"./gyvvad7btmtz1x9o.js";import"./n6vmm5pyahusdy8e.js";import"./l041el2tch1t3nkf.js";import"./easgat082167v0i8.js";import"./dvqe6kc43fkjsavv.js";import"./mw2u7timj0qnsnvj.js";import"./fr4ckts5oz9jhhs0.js";import"./xx3svpq6qe4q5uu1.js";import"./mtg83aqpqaxteb09.js";import"./f3wj76d1ulqyss85.js";import"./k6xevgslgqxumalm.js";import"./h0u5robawxnqftug.js";import"./hcsjwjl2ji65i21r.js";import"./ogcl7v93rii15rrg.js";import"./beyyb659nwss2eea.js";import"./d9xs85pwcfjntwwg.js";import"./oz589d7sqtxcbljf.js";import"./lptwpbjabrvjmhsj.js";import"./d488vdccsjfd5637.js";import"./lj9gcg948eq0zvwr.js";import"./fzrn137102spawew.js";import"./c631j8z7keqfibnl.js";import"./jt0fc5oel309hgy2.js";import"./l45tzjfw41ny1oxj.js";import"./2dhqllc5pireni9q.js";import"./jza9spsuu2f7ynxb.js";import"./ht7of10t76s6p5h9.js";import"./efsl2tpd3w39q64v.js";import"./hzcock7l6ec8fnr2.js";import"./fue7kd61xxcv74sk.js";import"./nel1ztt16rssielp.js";import"./lbaueofbjv8jfqwm.js";import"./kir2grr1yju5p5db.js";import"./kkl7694f44ns8yp6.js";import"./i40tl4cuke87hmzs.js";import"./bx2wdn43543b9ysc.js";import"./n5wrqpcxv1sjah44.js";import"./kxedrjbxv2qblujd.js";import"./k059n59kmbyb9lsl.js";import"./ojb4d4bxj44fs0l8.js";const wt=({title:r})=>{const e=A().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return o.jsxs("div",{className:"flex justify-between print:hidden",children:[o.jsxs("div",{className:"flex flex-col justify-start",children:[o.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:r}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:o.jsx(J,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:n=>o.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:n})}})})]}),o.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[o.jsx(dt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),o.jsx(tt,{className:et("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:E,label:e,children:e})]})]})};function St({postWithProfile:r,title:t,children:e}){return o.jsx(lt.Provider,{value:{postId:r.post.id},children:o.jsx(rt,{children:o.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:o.jsxs("div",{className:"mx-auto max-w-3xl",children:[o.jsx("div",{className:"px-2 py-6",children:!!t&&o.jsx(wt,{title:t})}),o.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:o.jsxs("div",{className:"p-14 pt-8",children:[o.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:o.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[o.jsx(E,{className:"text-token-text-primary h-8 w-8"}),o.jsx(ut,{})]})}),e]})})]})})})})}function It(r){if(r.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const t=r.post.attachments[0];return{task:t.task,fetchedTurns:t.turns,current_user_turn:t.current_user_turn,current_assistant_turn:t.current_assistant_turn,current_diff_task_turn:t.current_diff_task_turn,exampleTaskInfo:t.example_task_info}}function Mt({postWithProfile:r}){var S;vt();const t=O(u=>u.addTurnToTaskMap),{task:e,fetchedTurns:n,current_user_turn:s,current_assistant_turn:a,current_diff_task_turn:c,exampleTaskInfo:l}=It(r),m=G(),i=A(),d=X(),g=ht.useCurrentImage()!=null,P=ot(m,"2818336692"),[x,T]=p.useState([]),C=p.useCallback(()=>{T([])},[]),{focusedAssistantTurn:h,setFocusedAssistantTurnId:j}=kt({taskId:e.id,task:e,currentUserTurn:s!=null?s:null,currentAssistantTurn:a!=null?a:null}),v=p.useMemo(()=>Ct(h),[h]),K=p.useMemo(()=>({comments:x,setComments:T,clearComments:C,readonlyComments:v}),[x,T,C,v]),f=O(({getTurnsForTask:u})=>e?u(e.id):[]),w=p.useMemo(()=>{var u;return Pt({focusedAssistantTurn:h,pastTurns:f,currentDiffTaskTurnId:(u=c==null?void 0:c.id)!=null?u:null})},[h,c==null?void 0:c.id,f]),$=p.useMemo(()=>({setFocusedAssistantTurnId:j,focusedAssistantTurn:h,currentDiffTaskTurn:w,taskId:e==null?void 0:e.id,task:e,pastTurns:f,canFollowUp:!1}),[h,w,e,f,j]);return p.useEffect(()=>{var u;Object.values((u=n==null?void 0:n.turn_mapping)!=null?u:{}).forEach(q=>{var I;t((I=e==null?void 0:e.id)!=null?I:"",q.turn)})},[n,t,e]),jt([{key:"newTask",action:()=>{d("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:R.Chat,keyboardBinding:[b.Mod,b.Shift,"o"]},{key:"closeTask",action:()=>{d("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:R.Chat,keyboardBinding:[b.Escape],enabled:!g}]),!e||!f?null:o.jsx(W.Provider,{value:{postWithProfile:r,setIsReportModalOpen:()=>{}},children:o.jsx(nt,{children:o.jsx(Tt,{value:K,children:o.jsx(yt,{value:$,children:o.jsx(bt,{permissions:"read",turnId:(S=a==null?void 0:a.id)!=null?S:"",showForkButton:P,loadingTurnMapping:!1,isSharedExampleTask:!!l})})})})})}const De=Y(function(){const t=Z();return t.kind==="forbidden"?o.jsx(Ot,{chatPageProps:t.chatPageProps,reason:"workspace"}):o.jsx(_t,{loaderData:t})});function _t({loaderData:r}){var s,a,c,l;p.useEffect(()=>{var m,i;at.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:r.postWithProfile.post.id,primary_attachment_type:(i=(m=r.postWithProfile.post.attachments)==null?void 0:m[0])==null?void 0:i.kind,referrer:r.referrer})},[r]);const{session:t}=it(),e=p.useMemo(()=>{var i,d;const m=F();return z.initThread({clientThreadId:m,conversationMode:{kind:ct.PrimaryAssistant},userId:(i=t==null?void 0:t.user)==null?void 0:i.id,accountId:(d=t==null?void 0:t.account)==null?void 0:d.id}),m},[(s=t==null?void 0:t.account)==null?void 0:s.id,(a=t==null?void 0:t.user)==null?void 0:a.id]),n=(c=r.postWithProfile.post.attachments)==null?void 0:c[0];if(n.kind==="deep_research"){const m=n.messages,i=mt(m),d=(l=i==null?void 0:i.metadata)==null?void 0:l.async_task_title;return i?o.jsx(St,{postWithProfile:r.postWithProfile,title:d,children:o.jsx(pt,{messages:m,threadId:e})}):null}return n.kind==="codex"?o.jsx(Mt,{postWithProfile:r.postWithProfile}):o.jsx(At,{postWithProfile:r.postWithProfile,chatPageProps:r.chatPageProps})}function B(r){return{url:"https://ogimg.chatgpt.com/?postId=".concat(r),size:[1200,630]}}function Nt(r,t){var n,s,a,c,l,m,i;if(!r.attachments||r.attachments.length===0)return{url:k.src};const e=r.attachments[0];switch(e.kind){case"media_generation":{const d=(s=(n=e.encodings)==null?void 0:n.md)!=null&&s.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,g=(c=(a=e.encodings)==null?void 0:a.unfurl)!=null&&c.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,P=(m=(l=e.encodings)==null?void 0:l.thumbnail)!=null&&m.path?{url:e.encodings.thumbnail.path}:void 0,x={url:e.url,size:[e.width,e.height]};return t&&d!=null?d:(i=g!=null?g:P)!=null?i:x}case"message_slice":return B(r.id);default:return{url:k.src}}}function Rt(r){var n,s,a;const t=(n=r.text)==null?void 0:n.trim();if(t)return t;const e=(s=r.attachments)==null?void 0:s[0];return(e==null?void 0:e.kind)==="media_generation"&&((a=e.title)!=null&&a.trim())?e.title.trim():"Shared Content"}const He=({data:r})=>{const t=r,e={name:"robots",content:"noindex,nofollow"};if(!t||t.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:k.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:k.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:n}=t.postWithProfile,s=t.enforceRenderedOgImg?B(n.id):Nt(n,t.preferIntrinsicAspectRatioForOgImage),a=Rt(n),c=n.permalink,l=new Date(n.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:s.url},{property:"og:image:secure_url",content:s.url},...s.size?[{property:"og:image:width",content:s.size[0]},{property:"og:image:height",content:s.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:l},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:s.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function Ot({chatPageProps:r,reason:t}){const e=G();return p.useEffect(()=>{st(e,gt,{reason:t})},[]),o.jsx(L,y({},r))}function At({postWithProfile:r,chatPageProps:t}){const[e,n]=p.useState(!1),[s]=p.useState(()=>F()),a=xt(r.post.attachments);if(a){const{threadResponse:c}=a;z.updateThreadFromServer(s,c,{skipIfExisting:!0,continuingFromSharedPostId:r.post.id,forkFromSharedPost:!0})}return o.jsxs(W.Provider,{value:{postWithProfile:r,setIsReportModalOpen:n},children:[e&&o.jsx(ft,{post:r.post,onClose:()=>n(!1)}),o.jsx(L,N(y({},t),{clientThreadId:s}))]})}export{De as default,He as meta};
//# sourceMappingURL=ov220oq4dp2b40a4.js.map

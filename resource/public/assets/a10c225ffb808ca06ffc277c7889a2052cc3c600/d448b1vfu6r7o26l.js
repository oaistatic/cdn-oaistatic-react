import{c as te,b as we,r as re,j as s,a as ue,M as me}from"./jj85rqzpbnvv3emr.js";import{bo as be,e as ve,nR as ke,aI as je,C as Me,R as pe,B as he}from"./lef5ym39glv4981l.js";import{dn as Ce}from"./mclphevd122040jw.js";import{T as _e,a as Te,b as ye}from"./nel1ztt16rssielp.js";import{p as Le,W as Se,I as Ne,a as Pe,M as Ae,C as De}from"./k6xevgslgqxumalm.js";import{g as Fe,W as Ie,u as Re,c as ge}from"./ef92qx749w9klz4o.js";import"./jt0fc5oel309hgy2.js";import"./l45tzjfw41ny1oxj.js";import"./2dhqllc5pireni9q.js";import"./jza9spsuu2f7ynxb.js";import"./ht7of10t76s6p5h9.js";import"./efsl2tpd3w39q64v.js";import"./h0u5robawxnqftug.js";import"./hcsjwjl2ji65i21r.js";import"./ogcl7v93rii15rrg.js";import"./beyyb659nwss2eea.js";import"./d9xs85pwcfjntwwg.js";import"./oz589d7sqtxcbljf.js";import"./lptwpbjabrvjmhsj.js";import"./d488vdccsjfd5637.js";import"./lj9gcg948eq0zvwr.js";import"./fzrn137102spawew.js";import"./c631j8z7keqfibnl.js";import"./f3wj76d1ulqyss85.js";import"./hzcock7l6ec8fnr2.js";import"./fue7kd61xxcv74sk.js";import"./kxedrjbxv2qblujd.js";const xe=new Set;function xt(b){"use forget";var fe,ce;const e=te.c(102),{taskId:a,suggestion:r,index:o,assistantTurn:t,isOpen:c,onClose:i}=b;let m;m=Fe(t,!0).length>0;const d=m;let n,f;e[0]!==t||e[1]!==d?(f=Le({assistantTurn:t,followUp:d}),e[0]=t,e[1]=d,e[2]=f):f=e[2],n=f;const p=n,h=!d,l=we(),u=be(),[k,j]=re.useState("diff");let x,w;e[3]!==t.id||e[4]!==c||e[5]!==a?(x=()=>{const C=t.id;c&&C&&!xe.has(C)&&(xe.add(C),Ie.viewSpeculativeTurn(a,C))},w=[c,t.id,a],e[3]=t.id,e[4]=c,e[5]=a,e[6]=x,e[7]=w):(x=e[6],w=e[7]),re.useEffect(x,w);let v;e[8]!==t||e[9]!==o||e[10]!==h||e[11]!==r||e[12]!==a?(v=s.jsx(Be,{taskId:a,suggestion:r,index:o,assistantTurn:t,showFullDiff:h}),e[8]=t,e[9]=o,e[10]=h,e[11]=r,e[12]=a,e[13]=v):v=e[13];const g=v,M=(fe=t==null?void 0:t.id)!=null?fe:a;let _;e[14]!==l?(_=l.formatMessage({id:"wham.whamTaskPageContentLoaded.conversation",defaultMessage:"Conversation"}),e[14]=l,e[15]=_):_=e[15];let T;e[16]!==l?(T=l.formatMessage({id:"wham.whamTaskPageContentLoaded.conversationAriaLabel",defaultMessage:"Tab to view the conversation with the assistant"}),e[16]=l,e[17]=T):T=e[17];let y;e[18]!==u||e[19]!==g||e[20]!==_||e[21]!==T?(y={key:"chat",isHidden:u,label:_,ariaLabel:T,children:g},e[18]=u,e[19]=g,e[20]=_,e[21]=T,e[22]=y):y=e[22];let L;e[23]!==l?(L=l.formatMessage({id:"wham.whamTaskPageContentLoaded.diff",defaultMessage:"Diff"}),e[23]=l,e[24]=L):L=e[24];let S;e[25]!==l?(S=l.formatMessage({id:"wham.whamTaskPageContentLoaded.diffAriaLabel",defaultMessage:"Tab to view the code diff"}),e[25]=l,e[26]=S):S=e[26];let N;e[27]!==t||e[28]!==p||e[29]!==o||e[30]!==a?(N=s.jsx($e,{taskId:a,assistantTurn:t,index:o,diffFiles:p}),e[27]=t,e[28]=p,e[29]=o,e[30]=a,e[31]=N):N=e[31];let P;e[32]!==L||e[33]!==S||e[34]!==N?(P={key:"diff",isHidden:!1,label:L,ariaLabel:S,children:N},e[32]=L,e[33]=S,e[34]=N,e[35]=P):P=e[35];let A;e[36]!==l?(A=l.formatMessage({id:"wham.whamTaskPageContentLoaded.logs",defaultMessage:"Logs"}),e[36]=l,e[37]=A):A=e[37];let D;e[38]!==l?(D=l.formatMessage({id:"wham.whamTaskPageContentLoaded.logsAriaLabel",defaultMessage:"Tab to view the work logs"}),e[38]=l,e[39]=D):D=e[39];let J;e[40]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsx("div",{className:"flex h-full w-full items-center justify-center py-8",children:s.jsx(ke,{})}),e[40]=J):J=e[40];const se=(ce=t==null?void 0:t.environment)==null?void 0:ce.agent_network_access;let F;e[41]!==t||e[42]!==o||e[43]!==a?(F=s.jsx("div",{className:"block md:hidden",children:s.jsx(de,{taskId:a,assistantTurn:t,index:o})}),e[41]=t,e[42]=o,e[43]=a,e[44]=F):F=e[44];let I;e[45]!==t||e[46]!==se||e[47]!==F||e[48]!==a?(I=s.jsx(re.Suspense,{fallback:J,children:s.jsx(Se,{taskId:a,focusedAssistantTurn:t,agentNetworkAccess:se,footer:F})}),e[45]=t,e[46]=se,e[47]=F,e[48]=a,e[49]=I):I=e[49];let R;e[50]!==A||e[51]!==D||e[52]!==I?(R={key:"logs",label:A,ariaLabel:D,children:I},e[50]=A,e[51]=D,e[52]=I,e[53]=R):R=e[53];let U;e[54]!==l?(U=l.formatMessage({id:"wham.whamTaskPageContentLoaded.internalDataModels",defaultMessage:"Internal Data Models"}),e[54]=l,e[55]=U):U=e[55];let B;e[56]!==l?(B=l.formatMessage({id:"wham.whamTaskPageContentLoaded.internalDataModelsAriaLabel",defaultMessage:"Tab to view internal data models"}),e[56]=l,e[57]=B):B=e[57];const ae=t==null?void 0:t.internal_only_rollouts;let W;e[58]!==t||e[59]!==ae?(W=s.jsx(Ne,{task:void 0,userTurn:null,assistantTurn:t,rollout:ae}),e[58]=t,e[59]=ae,e[60]=W):W=e[60];let H;e[61]!==U||e[62]!==B||e[63]!==W?(H={key:"internal_data_models",isHidden:!0,label:U,ariaLabel:B,children:W},e[61]=U,e[62]=B,e[63]=W,e[64]=H):H=e[64];let E;e[65]!==y||e[66]!==P||e[67]!==R||e[68]!==H?(E=[y,P,R,H],e[65]=y,e[66]=P,e[67]=R,e[68]=H,e[69]=E):E=e[69];const le=!u,ie=!u&&"border-b";let $;e[70]!==ie?($=ve("p-3 max-md:py-0",ie),e[70]=ie,e[71]=$):$=e[71];let O;e[72]!==le||e[73]!==$?(O=s.jsx(_e,{withUnderline:le,className:$,skipTabUnderlineAnimation:!0}),e[72]=le,e[73]=$,e[74]=O):O=e[74];let Q;e[75]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(Te,{children:Ue}),e[75]=Q):Q=e[75];let V;e[76]!==k||e[77]!==E||e[78]!==O||e[79]!==M?(V=s.jsx("div",{className:"relative flex h-full w-full flex-col",children:s.jsxs(ye,{onChange:j,currentTab:k,defaultTab:"diff",tabs:E,children:[O,Q]},M)}),e[76]=k,e[77]=E,e[78]=O,e[79]=M,e[80]=V):V=e[80];const oe=V;let X;e[81]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx(je,{}),e[81]=X):X=e[81];let q;e[82]!==l?(q=l.formatMessage({id:"wham.whamTaskPageContentLoaded.close",defaultMessage:"Close"}),e[82]=l,e[83]=q):q=e[83];let z;e[84]!==i||e[85]!==q?(z=s.jsx(Ce,{className:"absolute end-3 top-0 md:top-3",icon:X,label:q,onClick:i}),e[84]=i,e[85]=q,e[86]=z):z=e[86];let Y;e[87]!==z||e[88]!==oe?(Y=s.jsxs("div",{className:"relative flex h-full w-full flex-col",children:[oe,z]}),e[87]=z,e[88]=oe,e[89]=Y):Y=e[89];const Z=Y,ne="modal-speculative-task-content-".concat(t.id);let G;e[90]!==i?(G=C=>{C.preventDefault(),C.stopPropagation(),i()},e[90]=i,e[91]=G):G=e[91];let K;e[92]!==u||e[93]!==g||e[94]!==Z?(K=s.jsx("div",{className:"bg-token-bg-tertiary flex h-full w-full",children:u?s.jsx(Pe,{leftContent:g,rightContent:Z}):Z}),e[92]=u,e[93]=g,e[94]=Z,e[95]=K):K=e[95];let ee;return e[96]!==c||e[97]!==i||e[98]!==ne||e[99]!==G||e[100]!==K?(ee=s.jsx(Me,{testId:ne,isOpen:c,visuallyHiddenHeader:!0,size:"custom",className:"h-full w-full",contentClassName:"h-screen",noPadding:!0,onClose:i,onEscapeKeyDown:G,showCloseButton:!0,children:K}),e[96]=c,e[97]=i,e[98]=ne,e[99]=G,e[100]=K,e[101]=ee):ee=e[101],ee}function Ue(b){const{content:e}=b;return s.jsx("div",{className:"flex h-full w-full",children:e})}function Be(b){"use forget";const e=te.c(16),{taskId:a,suggestion:r,index:o,assistantTurn:t,showFullDiff:c}=b;let i;e[0]!==r.title?(i=s.jsx("span",{className:"p-6 text-sm font-medium",children:r.title}),e[0]=r.title,e[1]=i):i=e[1];let m;e[2]!==t?(m=[t],e[2]=t,e[3]=m):m=e[3];let d;e[4]!==t||e[5]!==c||e[6]!==m?(d=s.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:s.jsx(Ae,{isLatest:!0,assistantTurns:m,selectedAssistantId:t.id,focusedAssistantTurn:t,setFocusedAssistantTurnId:Ee,onClickFile:He,startOpen:!0,currentTab:void 0,onTabChange:We,permissions:"read",flushHeaderSeparator:!0,showFullDiff:c},t.id)}),e[4]=t,e[5]=c,e[6]=m,e[7]=d):d=e[7];let n;e[8]!==t||e[9]!==o||e[10]!==a?(n=s.jsx(de,{taskId:a,assistantTurn:t,index:o}),e[8]=t,e[9]=o,e[10]=a,e[11]=n):n=e[11];let f;return e[12]!==i||e[13]!==d||e[14]!==n?(f=s.jsxs("div",{className:"flex h-full w-full flex-col",children:[i,d,n]}),e[12]=i,e[13]=d,e[14]=n,e[15]=f):f=e[15],f}function We(){}function He(){}function Ee(){}function $e(b){"use forget";const e=te.c(11),{taskId:a,assistantTurn:r,index:o,diffFiles:t}=b,c=t.length>0,{data:i}=Re(),d=!be()||(i==null?void 0:i.git_diff_mode)==="unified";let n;e[0]!==t||e[1]!==c||e[2]!==d?(n=c&&s.jsx("div",{className:"flex w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6",children:t.map(h=>s.jsx(De,{diff:h,stickyHeader:!0,viewType:d?"unified":"split",enableComments:!1,buttonClassName:"bg-token-bg-tertiary"},h.diffFile._newFileName))}),e[0]=t,e[1]=c,e[2]=d,e[3]=n):n=e[3];let f;e[4]!==r||e[5]!==o||e[6]!==a?(f=s.jsx("div",{className:"block md:hidden",children:s.jsx(de,{taskId:a,assistantTurn:r,index:o})}),e[4]=r,e[5]=o,e[6]=a,e[7]=f):f=e[7];let p;return e[8]!==n||e[9]!==f?(p=s.jsxs("div",{className:"flex h-full w-full flex-col",children:[n,f]}),e[8]=n,e[9]=f,e[10]=p):p=e[10],p}function de(b){"use forget";const e=te.c(31),{taskId:a,assistantTurn:r,index:o}=b,t=we(),c=Oe;let i;e[0]!==r||e[1]!==o||e[2]!==a?(i={mutationFn:()=>(ge.recordSpeculativeSuggestionRejected(a,r.id,o),pe.safePost("/wham/tasks/{task_id}/speculative_turns/{task_turn_id}/reject",{parameters:{path:{task_id:a,task_turn_id:r.id}}})),onSuccess:c},e[0]=r,e[1]=o,e[2]=a,e[3]=i):i=e[3];const{mutate:m,isPending:d}=ue(i);let n;e[4]!==r||e[5]!==o||e[6]!==a?(n={mutationFn:()=>(ge.recordSpeculativeSuggestionAccepted(a,r.id,o),pe.safePost("/wham/tasks/{task_id}/speculative_turns/{task_turn_id}/accept",{parameters:{path:{task_id:a,task_turn_id:r.id}}})),onSuccess:c},e[4]=r,e[5]=o,e[6]=a,e[7]=n):n=e[7];const{mutate:f,isPending:p}=ue(n),h=d||p;let l;e[8]!==f?(l=()=>f(),e[8]=f,e[9]=l):l=e[9];let u;e[10]!==t?(u=t.formatMessage({id:"wham.speculative.followUp.applyAriaLabel",defaultMessage:"Button to apply the speculative follow up suggestion"}),e[10]=t,e[11]=u):u=e[11];let k;e[12]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx(me,{id:"wham.speculative.followUp.apply",defaultMessage:"Apply"}),e[12]=k):k=e[12];let j;e[13]!==p||e[14]!==h||e[15]!==l||e[16]!==u?(j=s.jsx(he,{color:"primary",onClick:l,disabled:h,loading:p,"aria-label":u,children:k}),e[13]=p,e[14]=h,e[15]=l,e[16]=u,e[17]=j):j=e[17];let x;e[18]!==m?(x=()=>m(),e[18]=m,e[19]=x):x=e[19];let w;e[20]!==t?(w=t.formatMessage({id:"wham.speculative.followUp.rejectAriaLabel",defaultMessage:"Button to reject the speculative follow up suggestion"}),e[20]=t,e[21]=w):w=e[21];let v;e[22]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsx(me,{id:"wham.speculative.followUp.reject",defaultMessage:"Reject"}),e[22]=v):v=e[22];let g;e[23]!==h||e[24]!==d||e[25]!==x||e[26]!==w?(g=s.jsx(he,{color:"secondary",onClick:x,disabled:h,loading:d,"aria-label":w,children:v}),e[23]=h,e[24]=d,e[25]=x,e[26]=w,e[27]=g):g=e[27];let M;return e[28]!==g||e[29]!==j?(M=s.jsxs("div",{className:"flex w-full justify-center gap-3 py-10",children:[j,g]}),e[28]=g,e[29]=j,e[30]=M):M=e[30],M}function Oe(){window.location.reload()}export{xt as SpeculativeTaskContentModal};
//# sourceMappingURL=d448b1vfu6r7o26l.js.map

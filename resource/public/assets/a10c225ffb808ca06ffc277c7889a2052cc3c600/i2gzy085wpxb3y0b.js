import{r as u,b as G,j as w,M as Q}from"./jj85rqzpbnvv3emr.js";import{C as V,E as W,aY as X,fy as Y}from"./lef5ym39glv4981l.js";function Z(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function R(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),e.push.apply(e,r)}return e}function _(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?R(Object(e),!0).forEach(function(r){Z(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):R(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function A(t,n){if(t==null)return{};var e,r,o=function(f,p){if(f==null)return{};var c,s,m={},g=Object.keys(f);for(s=0;s<g.length;s++)c=g[s],p.indexOf(c)>=0||(m[c]=f[c]);return m}(t,n);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)e=d[r],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(o[e]=t[e])}return o}function k(t,n){return function(e){if(Array.isArray(e))return e}(t)||function(e,r){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var o=[],d=!0,f=!1,p=void 0;try{for(var c,s=e[Symbol.iterator]();!(d=(c=s.next()).done)&&(o.push(c.value),!r||o.length!==r);d=!0);}catch(m){f=!0,p=m}finally{try{d||s.return==null||s.return()}finally{if(f)throw p}}return o}}(t,n)||function(e,r){if(e){if(typeof e=="string")return C(e,r);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return C(e,r)}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var O={},I=function(t){var n=document.querySelector('script[src="'.concat(t,'"]'));if(n)return O[t]={loading:!1,error:null,scriptEl:n}},z=typeof window<"u"&&window.document!==void 0,F="https://cdn.merge.dev/initialize.js",$={"https://api.merge.dev":F,"https://api-oai-usw2.openaimerge.com":"https://cdn.openaimerge.com/initialize.js","https://api-develop.merge.dev":"https://develop-cdn.merge.dev/initialize.js"},B=function(t){return(t==null?void 0:t.linkToken)!==void 0},J=function(t){var n,e=t.shouldSendTokenOnSuccessfulLink,r=e===void 0||e,o=A(t,["shouldSendTokenOnSuccessfulLink"]),d=function(b){var a=b.src,h=b.checkForExisting,E=h!==void 0&&h,y=A(b,["src","checkForExisting"]),i=a?O[a]:void 0;!i&&E&&a&&z&&(i=I(a));var S=k(u.useState(i?i.loading:!!a),2),U=S[0],D=S[1],L=k(u.useState(i?i.error:null),2),x=L[0],q=L[1],M=k(u.useState(!1),2),H=M[0],N=M[1];return u.useEffect(function(){if(z&&a&&!H&&!x){var l;!(i=O[a])&&E&&(i=I(a)),i?l=i.scriptEl:((l=document.createElement("script")).src=a,Object.keys(y).forEach(function(v){l[v]===void 0?l.setAttribute(v,y[v]):l[v]=y[v]}),i=O[a]={loading:!0,error:null,scriptEl:l});var T=function(){i&&(i.loading=!1),D(!1),N(!0)},P=function(v){i&&(i.error=v),q(v)};return l.addEventListener("load",T),l.addEventListener("error",P),document.body.appendChild(l),function(){l.removeEventListener("load",T),l.removeEventListener("error",P),i&&i.loading&&(l.remove(),delete O[a])}}},[a]),[U,x]}({src:(o==null||(n=o.tenantConfig)===null||n===void 0?void 0:n.apiBaseURL)!=null&&$[o.tenantConfig.apiBaseURL]||F,checkForExisting:!0}),f=k(d,2),p=f[0],c=f[1],s=k(u.useState(!1),2),m=s[0],g=s[1],j=!(typeof window>"u")&&!!window.MergeLink&&!p&&!c&&B(o);return u.useEffect(function(){j&&window.MergeLink&&B(o)&&window.MergeLink.initialize(_(_({},o),{},{shouldSendTokenOnSuccessfulLink:r,onReady:function(){return g(!0)}}))},[j,o]),{open:u.useCallback(function(){window.MergeLink&&window.MergeLink.openLink(o)},[o]),isReady:m,error:c}};const K="https://api-oai-usw2.openaimerge.com";function ne({connectionId:t,isOpen:n,onClose:e}){"use forget";const r=G(),o=u.useCallback((E,y)=>{e(!0)},[e]),[d,f]=u.useState(),[p,c]=u.useState(!1),[s,m]=u.useState(!1),[g,j]=u.useState();u.useEffect(()=>{(async()=>{c(!0);try{const y=await Y.user_get_file_picker_token(t);f(y.token),j(y.base_url)}catch(y){m(!0)}finally{c(!1)}})()},[t]);const{open:b,isReady:a}=J({linkToken:d,onSuccess:o,onExit:()=>e(!1),tenantConfig:{apiBaseURL:g!=null?g:K}}),h=a&&!p&&!s;return u.useEffect(()=>{h&&b()},[h,b]),w.jsx(V,{testId:"modal-connection-limit-items-file-picker",isOpen:n&&!h,onClose:()=>e(!1),type:"success",size:"normal",showCloseButton:!0,title:r.formatMessage({id:"qkRTw3",defaultMessage:"Limit items"}),description:w.jsx(X,{children:r.formatMessage({id:"fQm2Wm",defaultMessage:"Loading"})}),children:w.jsx("div",{className:"flex w-full items-center justify-center p-12",children:s?w.jsx("div",{className:"interactive-label-warning-secondary",children:w.jsx(Q,{id:"3BZzpX",defaultMessage:"Something went wrong"})}):w.jsx(W,{})})})}export{ne as LimitItemsFilePickerModal};
//# sourceMappingURL=i2gzy085wpxb3y0b.js.map

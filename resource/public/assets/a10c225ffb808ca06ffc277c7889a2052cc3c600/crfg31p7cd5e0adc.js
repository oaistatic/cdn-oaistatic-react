var ke=Object.defineProperty,Se=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var fe=(s,t,a)=>t in s?ke(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))pe.call(t,a)&&fe(s,a,t[a]);if(Q)for(var a of Q(t))Me.call(t,a)&&fe(s,a,t[a]);return s},C=(s,t)=>Se(s,Ae(t));var F=(s,t)=>{var a={};for(var n in s)pe.call(s,n)&&t.indexOf(n)<0&&(a[n]=s[n]);if(s!=null&&Q)for(var n of Q(s))t.indexOf(n)<0&&Me.call(s,n)&&(a[n]=s[n]);return a};import{f as X,b as j,u as L,a as P,d as _,j as e,g as ye,r as f,M as p,i as qe,G as De}from"./jj85rqzpbnvv3emr.js";import{f as w,R,sh as G,e as re,aE as ie,si as Ne,J as Te,E as ne,dY as je,g_ as Ee,W as S,aj as Be,b as Fe,i as oe,bi as Ce,sj as We,C as Ve,bw as ve,qQ as He,eE as M,fx as V,dP as Le,T as Re,B as Y,be as le,j as Ge,qa as ce,an as Oe,fw as $e,dF as ze}from"./lef5ym39glv4981l.js";import{c9 as Ue,bG as Qe,a6 as Ke,ty as ee,bL as Je,mo as se,tz as te,gH as Ye,lS as be,lR as de,be as Ze,bU as Xe,a3 as es,tA as ss,fI as ts,tB as as,jU as ns}from"./mclphevd122040jw.js";import{T as d}from"./i5991cad8s41d2db.js";import{m as _e}from"./foqejf60cwuh3mvo.js";import{G as rs}from"./j8iq8tz9iwf8tfnb.js";import{i as is,R as os}from"./gvj8b99px3hzuu19.js";import{T as ls,a as cs}from"./ghs0b9qiouvv0rxl.js";import{a as ds,c as ms,u as us}from"./fya3qb1e1s8z4llj.js";import"./d9serb02oz4r1lgw.js";import"./n82i9qkvs5r9bggc.js";import"./9z485wf4plyfoo73.js";import"./cncd8uuk5eicbkeu.js";import"./dta5t6ifyam55mk9.js";import"./cdk0cmbgnafohb1q.js";import"./gyvvad7btmtz1x9o.js";import"./n6vmm5pyahusdy8e.js";import"./l041el2tch1t3nkf.js";import"./easgat082167v0i8.js";import"./dvqe6kc43fkjsavv.js";import"./mw2u7timj0qnsnvj.js";import"./hnotrmacgvnfyexv.js";import"./mej2ctt6swvc1m1z.js";import"./go9515ghq3pauvs4.js";import"./n5wrqpcxv1sjah44.js";const T=25;function gs(s,t,a){return X({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await R.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:t,limit:T,query:a}}})})}function Ie(s,t,a){return X({queryKey:["workspace",s,"invites","requests",t,a],queryFn:()=>R.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:t,limit:T,query:a}}})})}function Pe(s){const t=j(),a=w(),n=L();return P({mutationFn:({inviteId:r,role:i,acceptRequest:o})=>R.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:r}},requestBody:{role:i,accept_request:o}}).catch(l=>{throw a.danger(t.formatMessage(U.updateInviteError,{error:l.message}),{loggingTitle:U.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),l}),onSuccess:(r,i)=>{if(i.acceptRequest)n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var c;if(!o)return o;const l=o.items.filter(u=>u.id!==i.inviteId),m=Math.max(0,((c=o.total)!=null?c:0)-1);return C(x({},o),{items:l,total:m})});else if(i.role){const o=i.role;n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{if(!l)return l;const m=l.items.map(c=>c.id===i.inviteId?C(x({},c),{role:o}):c);return C(x({},l),{items:m})})}}})}function we(s){const t=j(),a=w(),n=L();return P({mutationFn:({email:r})=>R.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:r}}).catch(i=>{throw a.danger(t.formatMessage(U.deleteInviteError,{email:r,error:i.message}),{loggingTitle:U.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),i}),onSuccess:(r,{email:i})=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var c;if(!o)return o;const l=o.items.filter(u=>u.email_address!==i),m=Math.max(0,((c=o.total)!=null?c:0)-1);return C(x({},o),{items:l,total:m})})}})}function xs(s){const t=j(),a=w(),n=L();return P({mutationFn:()=>R.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(r=>{throw a.danger(t.formatMessage(U.acceptAllInviteRequestsError,{error:r.message}),{loggingTitle:U.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),r}),onSuccess:()=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},r=>r&&C(x({},r),{items:[],total:0}))}})}function hs(s){const t=j(),a=w(),n=L();return P({mutationFn:({role:r,email:i})=>R.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[i],role:r,resend_emails:!0}}).then(({account_invites:o,errored_emails:l})=>{if(l.length>0)throw new Error(l[0].error);o.length>0&&a.success(t.formatMessage(U.resendInviteSuccess,{email:i}))}).catch(o=>{a.danger(t.formatMessage(U.resendInviteError,{email:i,error:o.message}),{loggingTitle:U.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["workspace",s,"invites"]}),n.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const U=_({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),me=({userName:s,isScimManaged:t,dotted:a=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(Ue,{user:{name:s,picture:null},size:"default",dotted:a}),t&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(Qe,{width:10,height:10})})]}),fs=n=>{var r=n,{children:s,ref:t}=r,a=F(r,["children","ref"]);return e.jsx(G.Root,C(x({license:"commercial",sheetRole:"dialog"},a),{ref:t,children:s}))},ps=i=>{var o=i,{children:s,ref:t,className:a,contentPlacement:n="left"}=o,r=F(o,["children","ref","className","contentPlacement"]);return e.jsx(G.View,C(x({className:re("z-1",a),contentPlacement:n,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0},r),{ref:t,children:s}))},Ms=n=>{var r=n,{className:s,ref:t}=r,a=F(r,["className","ref"]);return e.jsx(G.Backdrop,C(x({className:s},a),{ref:t}))},js=r=>{var i=r,{children:s,ref:t,className:a}=i,n=F(i,["children","ref","className"]);return e.jsx(G.Content,C(x({className:re("bg-token-bg-primary box-border shadow-lg",a)},n),{ref:t,children:s}))},vs=G.Portal,W={Root:fs,Portal:vs,View:ps,Backdrop:Ms,Content:js},bs=({workspaceId:s,userId:t})=>X({queryKey:[s,t,"user-roles"],queryFn:async()=>(await R.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s},path:{workspace_id:s,principal_id:t}}})).roles}),ys=({workspaceId:s,userId:t,enabled:a})=>X({enabled:a,queryKey:[s,t,"user-groups"],queryFn:async()=>(await R.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:t}}})).items}),Ns=({workspaceId:s,user:t,onClose:a})=>{var h;const n=j(),r=ie(),i=ye(),o=Ne(),l=r==null?void 0:r.isEnterprisey(),{data:m}=bs({workspaceId:s,userId:t.id}),c=f.useMemo(()=>m==null?void 0:m.filter(g=>!g.predefined_role),[m]),{data:u}=ys({workspaceId:s,userId:t.account_user_id,enabled:l});return e.jsx(W.Root,{presented:!0,defaultPresented:!0,onPresentedChange:a,children:e.jsx(W.Portal,{children:e.jsxs(W.View,{contentPlacement:"right",children:[e.jsx(W.Backdrop,{}),e.jsxs(W.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsx(Te,{onClick:a,iconSize:"lg",autoFocus:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(Ue,{user:{name:(h=t.name)!=null?h:"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:t.name}),e.jsx("div",{children:t.email})]})]}),e.jsx("hr",{className:"my-2.5"}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(K.groups)}),u==null&&e.jsx(ne,{}),(u==null?void 0:u.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(K.noGroups)}),u==null?void 0:u.map(g=>e.jsx(je,{className:"mx-0",as:"button",onClick:()=>i("/admin/groups/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(rs,{group:g})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:g.name}),is(g)&&e.jsx(os,{})]})]})})},g.id))]}),e.jsx("hr",{className:"my-2.5"})]}),o&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(K.customRoles)}),c==null&&e.jsx(ne,{}),(c==null?void 0:c.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(K.noCustomRoles)}),c==null?void 0:c.map(g=>e.jsx(je,{className:"mx-0",as:"button",onClick:()=>i("/admin/permissions/roles/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:g.predefined_role?e.jsx(Ke,{className:"icon"}):e.jsx(Ee,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:g.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:g.description})]})]})})},g.id))]})]})]})]})})})},K=_({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"}});function ue({currentRole:s,onUpdateUserRole:t,disabled:a=!1}){const n=ee();return e.jsx(Je,{disabled:a,defaultValue:s,onValueChange:r=>{t(r)},triggerClassName:"text-base",options:[{label:n[S.STANDARD],value:S.STANDARD},{label:n[S.ADMIN],value:S.ADMIN},{label:n[S.OWNER],value:S.OWNER}]})}const H=Be(()=>({confirmModalUserData:null})),Z={openModalForUser:s=>{H.setState({confirmModalUserData:s})},closeModal:()=>{H.setState({confirmModalUserData:null})}};function Cs({workspaceId:s,filterInputValue:t}){var xe;const[a,n]=f.useState(0),r=Fe(),[i,o]=f.useState(),l=Ne(),m=r==null?void 0:r.id,c=se(s),u=te(s),h=c||u,g=Ps(),y=ks(s),k=ws(s),{data:E}=Ye(s,a*be,t);f.useEffect(()=>{n(0)},[t]);const O=f.useCallback(v=>{Z.openModalForUser(v)},[]),$=f.useCallback(()=>{var N;const v=(N=H.getState().confirmModalUserData)==null?void 0:N.id;v!==void 0&&y.mutate({userId:v}),Z.closeModal(),o(void 0)},[y]),z=f.useCallback((v,N)=>{g.mutate({userId:v,value:N,workspaceId:s})},[g,s]);if(E===void 0)return e.jsx(ge,{});const I=E.items,B=Math.ceil(((xe=E.total)!=null?xe:0)/be);return a>=B&&B!==0&&n(Math.max(B-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),h&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:e.jsx(p,x({},b.name))}),e.jsx(d.HeaderCell,{children:e.jsx("span",{className:c?"ps-3":"",children:e.jsx(p,x({},b.accountType))})}),e.jsx(d.HeaderCell,{children:e.jsx(p,x({},b.dateAdded))}),h&&e.jsx(d.HeaderCell,{className:"w-16"})]}),e.jsxs(d.Body,{children:[I.map(v=>e.jsx(_s,{isCurrentUser:m!==void 0&&v.id===m,user:v,currentUserHasAdminRights:h,isCurrentUserOwner:c,onRemoveUserClick:()=>{var N,he;return O({id:v.id,name:(N=v.name)!=null?N:"",email:(he=v.email)!=null?he:"",created_time:v.created_time})},onUpdateUserRole:z,onLogoutUser:async N=>{await k.mutateAsync({userId:N})},onClick:l?N=>o(N):void 0},v.id)),I.length===0&&e.jsx(d.Row,{className:"[&>td]:py-2",children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},b.noResults))})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:B>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(de,{currentPage:a,onChangeIndex:n,length:B})})}),i&&e.jsx(Ns,{workspaceId:s,user:i,onClose:()=>o(void 0)}),e.jsx(Us,{onDeleteConfirm:$})]})}function Rs({onConfirm:s,onClose:t}){const a=j(),[n,r]=f.useState(!1);return e.jsx(Xe,{title:a.formatMessage(b.logoutMemberModalTitle),isOpen:!0,onClose:t,onConfirm:async()=>{try{r(!0),await s()}finally{r(!1)}t()},loading:n,confirmText:a.formatMessage(b.logoutMemberModalConfirm),primaryButtonColor:"danger"})}function Us({onDeleteConfirm:s}){var r;const t=j(),a=H(i=>i.confirmModalUserData!==null),n=H(i=>i.confirmModalUserData===null?{}:{userId:i.confirmModalUserData.id,email:i.confirmModalUserData.email,name:i.confirmModalUserData.name,dateAdded:We(i.confirmModalUserData.created_time)});return e.jsx(Ve,{testId:"modal-remove-member",isOpen:a,title:t.formatMessage(b.removeMemberModalTitle),onClose:()=>Z.closeModal(),type:"success",primaryButton:e.jsx(ve.Button,{title:t.formatMessage(b.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(ve.Button,{title:t.formatMessage(b.removeMemberModalCancel),color:"secondary",onClick:()=>Z.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(r=n.name)!=null?r:n.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,C(x({},b.dateJoined),{values:{dateAdded:t.formatDate(n.dateAdded,{year:"numeric",month:"long",day:"numeric"})}}))})]})})}function _s({user:s,currentUserHasAdminRights:t,isCurrentUserOwner:a,isCurrentUser:n,onRemoveUserClick:r,onUpdateUserRole:i,onLogoutUser:o,onClick:l}){var y;const c=ee()[s.role],u=j(),h=(y=s.name)!=null?y:u.formatMessage(b.missingName),g=oe();return e.jsxs(d.Row,{className:re("[&>td]:py-2"),onClick:l?()=>l==null?void 0:l(s):void 0,children:[e.jsxs(d.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(me,{userName:h,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[h,n&&e.jsx("span",{className:"ms-1",children:e.jsx(p,x({},b.youSpecifier))})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(d.Cell,{children:a?e.jsx(ue,{currentRole:s.role,onUpdateUserRole:k=>{i(s.id,k)},disabled:n}):c}),e.jsx(d.Cell,{children:u.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),t&&e.jsx(d.Cell,{children:e.jsx(Is,{userId:s.id,onRemoveUserClick:r,onLogoutUserClick:()=>{Ce(g,Rs,{onConfirm:()=>o(s.id)})},isCurrentUser:n,isScimManaged:s.is_scim_managed})})]})}function Is({isCurrentUser:s,onRemoveUserClick:t,onLogoutUserClick:a,userId:n,isScimManaged:r}){const i=j(),o=He(),l=e.jsx(M.Item,{onClick:r?void 0:m=>{m.stopPropagation(),t(n)},color:"danger",icon:e.jsx(Ze,{}),disabled:r,children:e.jsx(p,x({},b.removeMemberModalTitle))});return s?null:e.jsxs(M.Root,{children:[e.jsx(M.Trigger,{className:"-my-2",children:e.jsx(V,{className:"icon-sm"})}),e.jsx(M.Portal,{children:e.jsxs(M.Content,{size:"small",children:[o&&e.jsx(M.Item,{onClick:m=>{m.stopPropagation(),a(n)},icon:e.jsx(Le,{}),children:e.jsx(p,x({},b.logoutMember))}),r?e.jsx(Re,{label:i.formatMessage(_e.managedViaSCIMTooltip),className:"flex",side:"right",children:l}):l]})})]})}function Ps(){const s=w();return P({mutationFn:({userId:t,workspaceId:a,value:n})=>R.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:a,user_id:t}},requestBody:{role:n}}).catch(r=>{s.danger("Unable to update user (".concat(t,") role: ").concat(r.message),{toastId:"user_manager_table"})})})}function ws(s){const t=w();return P({mutationFn:({userId:a})=>R.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:a}}}),onError:(a,n)=>{t.danger("Unable to logout user (".concat(n.userId,") from workspace"),{toastId:"user_manager_table"})},onSuccess:()=>{t.success("User logged out of all sessions",{id:"user_logout_success"})}})}function ks(s){const t=L(),a=w();return P({mutationFn:({userId:n})=>R.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:n}}}).catch(r=>{a.danger("Unable to remove user (".concat(n,") from workspace: ").concat(r.message),{toastId:"user_manager_table"})}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s]})}})}function ge(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(ne,{})})}const b=_({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}});function Ss({workspaceId:s,filterInputValue:t}){var h;const[a,n]=f.useState(0),{data:r}=Ie(s,a*T,t),i=se(s),o=te(s),l=j(),m=i||o;if(r===void 0)return e.jsx(ge,{});const c=r.items,u=Math.ceil(((h=r.total)!=null?h:0)/T);return a>=u&&u!==0&&n(Math.max(u-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(p,x({},q.email))}),e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:m?"ps-3":"",children:e.jsx(p,x({},q.role))})}),m&&e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:l.formatMessage(q.actions)})]}),e.jsxs(d.Body,{children:[c.map(g=>e.jsx(As,{workspaceId:s,invite:g,isCurrentUserOwner:i,currentUserHasAdminRights:m},g.id)),c.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},q.noResults))})})})]})]}),u>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(de,{currentPage:a,onChangeIndex:n,length:u})})]})}function As({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){var m;const r=ee(),i=Pe(s),o=we(s),l=j();return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:i.isPending||o.isPending||o.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(me,{userName:(m=t.email_address)!=null?m:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(d.Cell,{children:a?e.jsx(ue,{currentRole:t.role,onUpdateUserRole:c=>{i.mutate({inviteId:t.id,role:c})}}):r[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{color:"secondary",onClick:()=>i.mutate({inviteId:t.id,acceptRequest:!0}),children:l.formatMessage(q.accept)}),e.jsxs(M.Root,{children:[e.jsx(M.Trigger,{disabled:t.is_scim_managed,children:e.jsx(V,{className:"icon-sm"})}),e.jsx(M.Portal,{children:e.jsx(M.Content,{children:e.jsx(M.Item,{color:"danger",onClick:()=>{var c;return o.mutate({email:(c=t.email_address)!=null?c:""})},children:l.formatMessage(q.reject)})})})]})]})})})]})}const q=_({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),qs=({workspaceId:s})=>{var O,$,z;const t=j(),a=oe(),n=se(s),r=te(s),i=n||r,o=xs(s),[l,m]=f.useState(""),[c,u]=f.useState(""),h=f.useMemo(()=>le(I=>u(I),300,{leading:!1,trailing:!0}),[]),{data:g}=Ie(s,0,c),y=(O=Ge(a,"3677330697"))!=null?O:!1,k=($=g==null?void 0:g.total)!=null?$:0,E=k?t.formatMessage(ae.acceptAllWithCount,{count:k}):t.formatMessage(ae.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ce,{value:l,onChange:I=>{m(I.target.value),h(I.target.value)},placeholder:t.formatMessage(ae.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),i&&y&&e.jsx(Y,{loading:o.isPending,disabled:((z=g==null?void 0:g.total)!=null?z:0)===0,onClick:()=>o.mutate(),children:E})]}),e.jsx(Ss,{workspaceId:s,filterInputValue:c})]})},ae=_({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}});function Ds({workspaceId:s,filterInputValue:t}){var u;const[a,n]=f.useState(0),r=se(s),i=te(s),o=r||i,{data:l}=gs(s,a*T,t);if(l===void 0)return e.jsx(ge,{});const m=l.items,c=Math.ceil(((u=l.total)!=null?u:0)/T);return a>=c&&c!==0&&n(Math.max(c-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),o&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(p,x({},D.email))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(p,x({},D.invitedDate))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:o?"ps-3":"",children:e.jsx(p,x({},D.role))})}),o&&e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(d.Body,{children:[m.map(h=>e.jsx(Ts,{workspaceId:s,invite:h,isCurrentUserOwner:r,currentUserHasAdminRights:o},h.id)),m.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},D.noResults))})})})]})]}),c>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(de,{currentPage:a,onChangeIndex:n,length:c})})]})}function Ts({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){var c;const r=j(),i=ee(),o=Pe(s),l=we(s),m=hs(s);return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:o.isPending||l.isPending||l.isSuccess||m.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(me,{userName:(c=t.email_address)!=null?c:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(d.Cell,{children:r.formatDate(t.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(d.Cell,{children:a?e.jsx(ue,{currentRole:t.role,onUpdateUserRole:u=>{o.mutate({inviteId:t.id,role:u})}}):i[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsx(Es,{onDeleteUser:()=>{var u;l.mutate({email:(u=t.email_address)!=null?u:""})},onResendInvite:()=>{var u,h;m.mutate({email:(u=t.email_address)!=null?u:"",role:(h=t.role)!=null?h:""})},disabled:t.is_scim_managed})})})]})}function Es({onDeleteUser:s,onResendInvite:t,disabled:a}){const n=j();return e.jsx(e.Fragment,{children:a?e.jsx(M.Root,{children:e.jsx(M.Trigger,{disabled:!0,children:e.jsx(Re,{label:n.formatMessage(_e.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(V,{className:"icon-sm"})})})}):e.jsxs(M.Root,{children:[e.jsx(M.Trigger,{children:e.jsx(V,{className:"icon-sm"})}),e.jsx(M.Portal,{children:e.jsxs(M.Content,{children:[e.jsx(M.Item,{onClick:t,children:e.jsx(p,x({},D.resendInvite))}),e.jsx(M.Item,{onClick:s,children:e.jsx(p,x({},D.revokeInvite))})]})})]})})}const D=_({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),Bs=({workspaceId:s})=>{const t=j(),[a,n]=f.useState(""),[r,i]=f.useState(""),o=f.useMemo(()=>le(l=>i(l),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(ce,{value:a,onChange:l=>{n(l.target.value),o(l.target.value)},placeholder:t.formatMessage(Fs.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Ds,{workspaceId:s,filterInputValue:r})]})},Fs=_({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}});function Ws({workspaceId:s}){const t=j(),a=ie(),[n,r]=f.useState(""),[i,o]=f.useState(""),l=f.useMemo(()=>le(g=>o(g),300,{leading:!1,trailing:!0}),[]),m=oe();if(!a)return null;const c=a==null?void 0:a.isTeam(),u=a.isAdminOfAccount(),h=a.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(ce,{value:n,onChange:g=>{r(g.target.value),l(g.target.value)},placeholder:t.formatMessage(J.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(u||h||c)&&e.jsx(Y,{onClick:()=>{Oe.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),Ce(m,({onClose:g})=>e.jsx(ss,{workspace:a,onClose:g}))},icon:es,children:e.jsx(p,x({},J.inviteMemberButton))}),c?e.jsx($e,{triggerButton:e.jsx(Y,{color:"secondary",icon:V}),children:e.jsx(M.Item,{onClick:()=>{a&&ze.setLeaveWorkspaceData(a)},children:e.jsx(p,x({},J.leaveWorkspace))})}):null]})]}),e.jsx(Cs,{workspaceId:s,filterInputValue:i}),e.jsx("p",{className:"text-token-text-secondary mt-4 text-sm",children:e.jsx(p,x({},J.memberListUpdateDelayNote))})]})}const J=_({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"},memberListUpdateDelayNote:{id:"adminPage.memberListUpdateDelayNote",defaultMessage:"Note: Although new workspace members can access ChatGPT immediately, it may take up to 24 hours to show them in this list."}}),Vs=s=>s==="members"||s==="invites"||s==="requests";function Hs({currentWorkspaceId:s}){var g;const t=j(),a=ie(),n=(g=ts(s))!=null?g:"?",r=as(a),i=f.useMemo(()=>[{key:"members",label:t.formatMessage(A.allMembers),children:e.jsx(Ws,{workspaceId:s})},{key:"invites",label:t.formatMessage(A.pendingInvites),children:e.jsx(Bs,{workspaceId:s})},{key:"requests",label:t.formatMessage(A.pendingRequests),children:e.jsx(qs,{workspaceId:s})}],[s,t]),o=ye(),[l]=qe(),m=l.get("tab"),[c,u]=f.useState(m&&Vs(m)?m:i[0].key),h=y=>{u(y),o({pathname:window.location.pathname,search:new URLSearchParams({tab:y}).toString()})};return a?e.jsxs(e.Fragment,{children:[e.jsx(ns,{children:e.jsx("title",{children:t.formatMessage(A.adminBrowserPageTitle)})}),e.jsx(ds,{title:t.formatMessage(A.adminPageTitle),subtitle:e.jsx(p,x({values:{totalMembers:n,planName:r}},A.totalMembers)),tabsHeader:e.jsx(ls,{items:i,activeTab:c,onTabChange:h})}),e.jsx(ms,{children:e.jsx(cs,{items:i,activeTab:c})})]}):null}const A=_({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} · {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"}}),ht=De(function(){const t=us();return e.jsx(Hs,x({},t))});export{ht as default};
//# sourceMappingURL=crfg31p7cd5e0adc.js.map

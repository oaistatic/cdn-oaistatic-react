const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lo9fpwg3xv1qi9uh.js","assets/jj85rqzpbnvv3emr.js","assets/lef5ym39glv4981l.js","assets/root-ogjlcpyy.css","assets/mclphevd122040jw.js","assets/conversation-small-g7l5datj.css","assets/gfh3fgyqv0cpuikj.js","assets/dtb8mu8k0cgd7l2m.js","assets/oxo0r33hqmhdtptf.js","assets/ob2j26h01aw8qfch.js"])))=>i.map(i=>d[i]);
var ci=Object.defineProperty,ui=Object.defineProperties;var di=Object.getOwnPropertyDescriptors;var uo=Object.getOwnPropertySymbols;var mi=Object.prototype.hasOwnProperty,pi=Object.prototype.propertyIsEnumerable;var mo=(s,e,n)=>e in s?ci(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,fe=(s,e)=>{for(var n in e||(e={}))mi.call(e,n)&&mo(s,n,e[n]);if(uo)for(var n of uo(e))pi.call(e,n)&&mo(s,n,e[n]);return s},os=(s,e)=>ui(s,di(e));import{aE as gt,i as Te,iK as Go,jz as fi,kM as Wo,y as mt,cY as on,cj as Ge,b as an,a as hi,a9 as Ue,L as xs,p as bs,j as We,e as ye,P as Se,bI as Ne,bi as _s,z as He,gK as gi,H as Ds,l7 as xi,jx as bi,jv as _i,gL as xt,gG as Ho,O as Be,B as Si,a6 as rn,ex as ln,ey as cn,Y as Fs,Z as Os,rv as yi,ab as Ai,fv as Ci,x as Xt,fD as bt,bG as wi,aa as zo,ci as pt,rw as ki,q as ji,d2 as Qt,ch as qo,dg as Pi,gu as Vo,f as un,eE as ce,gr as Rs,fF as Ti,ov as Ei,hx as $o,V as ft,a3 as W,bM as Ve,bu as Mi,bv as Yo,ls as Jo,q3 as Bi,eF as Ri,rx as vi,ry as Ni,f$ as Ko,gz as _e,kE as Di,m1 as Fi,rz as Zt,fO as gs,jm as Oi,jn as Li,jo as Ii,jq as Ui,ju as Gi,rA as Wi,fW as Xo,rB as Hi,rC as zi,rD as ot,lr as Lt,b9 as qi,gI as $e,rE as Vi,dY as Qo,T as dn,ct as Zo,rF as $i,c2 as Yi,rG as Ji,jC as mn,fz as ea,bJ as en,es as Ee,_ as sa,hZ as sn,lG as ta,fB as pn,fE as na,ek as Ki,fN as Xi,fG as fn,eq as It,fJ as oa,rH as Qi,rI as Zi,n9 as el,rJ as sl,rK as tl,rL as nl,l0 as aa,er as ra,rM as ol,lC as al,E as rl,rN as il,rO as ll,rP as cl,oc as ul,en as dl,bx as ia,rQ as la,pB as ca,cW as ua,rR as ml,lS as tn,lV as da,rS as pl,lR as Ut,gH as fl,c1 as hl,g5 as gl,gl as xl,rT as bl,bs as _l,jS as Sl,rU as yl,ib as Al,li as Cl,dz as wl,aG as kl,cM as po,mY as jl,py as Pl,rV as Tl,fM as El,rW as Ml,gc as Bl,fX as Rl,gp as fo,lp as vl,aF as Nl,iE as Dl,br as Fl,jT as Ol,g0 as Ll,g3 as Il,dv as ho,gw as go,gq as Ul,o_ as Gl,go as Wl,oX as Hl,oY as zl,bK as at,bF as xo,fL as bo,gC as rt,nr as ql,kF as Vl,p1 as $l,o$ as Yl,p0 as Jl,bz as Kl,rX as Xl,jG as Ms,g7 as _o,lH as Ql,rY as So,$ as Gt,a0 as Wt,bD as Zl,rZ as ec,dF as yo,lT as sc,r_ as tc,gD as nc,r$ as oc,jZ as ac,s0 as rc,jj as Ao,s1 as ic,fn as lc,be as cc,s2 as uc,s3 as dc,s4 as mc,ax as Co,dp as pc,jW as fc,gd as hc,s5 as gc,dA as xc,jX as wo}from"./lef5ym39glv4981l.js";import{b as Ie,r as h,j as t,M as ue,c as ts,d as _t,g as rs,A as bc,m as Ls,i as _c}from"./jj85rqzpbnvv3emr.js";import{bq as ss,pl as Sc,pm as yc,oq as Ht,fo as ma,ao as pa,p1 as Ac,br as as,pn as Cc,dX as wc,a7 as kc,po as Is,pp as fa,pq as jc,ab as Pc,am as Tc,oC as Ec,d1 as Mc,pr as Bc,mE as Rc,ps as ha,pt as ko,pu as vc,pv as Nc,pw as Dc,m4 as ga,px as xa,mF as jo,py as Fc,pz as Oc,kr as ba,ks as Lc,pA as Ic,pB as Uc,pC as De,pD as Ss,pE as C,pF as Gc,pG as Wc,aw as Hc,pH as zc,pI as _a,pJ as qc,pK as Vc,pL as $c,pM as Po,pN as Yc,pO as Jc,pP as Kc,pQ as Xc,pR as Qc,pS as Zc,pT as eu,pU as su,pV as tu,pW as nu,pX as To,pY as ou,pZ as au,p_ as ru,p$ as iu,q0 as lu,q1 as cu,q2 as uu,q3 as du,q4 as mu,q5 as pu,q6 as fu,q7 as hu,q8 as gu,q9 as xu,kx as bu,ee as _u,qa as Su,qb as yu,qc as Au,qd as Cu,qe as wu,qf as ku,qg as ju,qh as Pu,qi as Tu,qj as Eu,qk as Mu,ql as Bu,qm as Ru,qn as vu,qo as Nu,qp as Du,qq as Fu,qr as Ou,qs as Lu,qt as Iu,fk as Sa,qu as ya,qv as Uu,qw as Gu,qx as Wu,qy as Hu,qz as zu,qA as qu,cW as Vu,ff as Aa,p4 as Ca,bs as $u,qB as Yu,qC as Eo,qD as Ju,mM as wa,bW as ka,qE as ja,qF as Ku,qG as Xu,qH as Qu,qI as Mo,hO as dt,qJ as Zu,qK as Pa,qL as Ta,qM as ed,a3 as sd,qN as td,qO as nd,qP as od,qQ as ad,gE as Ea,mS as rd,qR as Ma,gu as Ns,ka as id,qS as ld,oM as cd,qT as ud,qU as dd,qV as md,qW as Bo,qX as pd,fB as fd,bV as hd,bK as gd,qY as xd,cq as Ba,qZ as Ra,q_ as va,q$ as Na,r0 as bd,r1 as Da,r2 as _d,r3 as Sd,r4 as yd,r5 as Ad,r6 as zt,r7 as Cd,r8 as wd,r9 as kd,ra as jd,rb as qt,rc as Vt,rd as Pd,re as Td,rf as Ed,rg as Md,rh as Bd,ri as Rd,rj as vd,rk as Nd,P as Ro,rl as Dd,rm as Fd,ha as Od,rn as Ld,ro as Id,rp as Ud,rq as Gd,rr as Wd,rs as Hd,rt as zd,ru as qd,cr as Vd,rv as $d,rw as Yd,ho as Jd,m9 as Kd,rx as Xd,ry as vo,hf as Bs,rz as it,rA as No,n_ as Qd,rB as Zd,rC as em,rD as sm,rE as tm,mT as $t,rF as nm,rG as Do,rH as om,h1 as am,rI as rm,rJ as im,ly as lm,lz as cm,lA as um,rK as dm,rL as mm,rM as pm,rN as fm,gB as Pe,dP as hm,rO as gm,rP as xm,rQ as bm,fj as _m,rR as Yt,rS as Sm,ku as ym,fi as Am,rT as Cm,rU as Fo,rV as wm,rW as km,rX as Jt,rY as jm,rZ as Pm,fh as Oo,r_ as Tm,r$ as Em,s0 as Mm,s1 as Bm,s2 as Rm,s3 as vm,s4 as Nm,s5 as Dm,s6 as Fm,s7 as Om,s8 as Lm,s9 as Im,sa as Um,sb as Gm,sc as Wm,sd as Hm,se as zm,sf as qm,sg as Vm,sh as $m,si as Ym,sj as Jm,sk as Km}from"./mclphevd122040jw.js";import{P as Xm,u as Qm,C as Zm}from"./n6vmm5pyahusdy8e.js";import{u as ep}from"./l041el2tch1t3nkf.js";import{getTabScreenshot as sp}from"./easgat082167v0i8.js";import{u as tp}from"./dta5t6ifyam55mk9.js";import{P as np,u as op,h as ap}from"./cncd8uuk5eicbkeu.js";const ht="month",Fa="year";function rp(){const s=gt(),e=Te(),n=Ie(),{markAsViewed:i}=ss(Sc),{initialBillingDetails:r}=ep(s,!0),a=h.useMemo(()=>os(fe({},s==null?void 0:s.subscriptionAnalyticsParams),{referrer:document.referrer}),[s]);async function c(){try{await Ac(r,a)}catch(x){}}const{shouldShowBanner:o,discountValue:d,discountDuration:u}=yc();if(h.useEffect(()=>{o&&d&&u&&Ht.logShowReferrerRedemptionBanner()},[o,d,u]),!o||!d||!u)return null;const m=ip(n,r,d,u),_=lp(n,r,d,u),y=t.jsxs("div",{className:"grow",children:[t.jsx("div",{className:"mb-0.5 font-semibold",children:m}),t.jsx("span",{className:"text-token-text-secondary",children:_})]});return t.jsx(Go,{onPrimaryCtaClick:()=>{i(),Ht.logClickReferrerRedeemButton(),c()},primaryCtaText:t.jsx(ue,fe({},fi(e))),onDismiss:()=>{i(),Ht.logCloseReferrerRedemptionBanner()},content:y})}function ip(s,e,n,i){var m,_;const{currencySymbol:r}=ma(pa(),e.currency),a=i?i.period:ht,c=i?i.num_periods:1,o=(_=(m=r.code.defaultMessage)==null?void 0:m.toString())!=null?_:Wo,d=s.formatNumber(n.value,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2});let u;return a===ht?u=c===1?t.jsx(ue,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:d}}):t.jsx(ue,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):a===Fa&&(u=c===1?t.jsx(ue,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):t.jsx(ue,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}})),u}function lp(s,e,n,i){var m,_;const{currencySymbol:r}=ma(pa(),e.currency),a=i?i.period:ht,c=i?i.num_periods:1,o=(_=(m=r.code.defaultMessage)==null?void 0:m.toString())!=null?_:Wo,d=s.formatNumber(n.value,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2});let u;return a===ht?u=c===1?t.jsx(ue,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used â€” claim your free month of Plus."}):t.jsx(ue,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:d,num_months:c}}):a===Fa&&(u=c===1?t.jsx(ue,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:d}}):t.jsx(ue,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:d,num_years:c}})),u}const Lo=_t({bannerBody:{id:"gqtTeH",defaultMessage:"Work smarter and better with coworkers in your organization"},dismissBanner:{id:"hbc/Bs",defaultMessage:"Dismiss banner"}});function cp(s){"use forget";const e=ts.c(13),{clientThreadId:n,canShowBanner:i}=s,r=i===void 0?!1:i,a=Te();let c;e[0]!==a?(c=mt(a),e[0]=a,e[1]=c):c=e[1];const o=c;let d;e[2]!==n?(d=on(n),e[2]=n,e[3]=d):d=e[3];const u=d,m=Ge(n,mp),{eligible:_}=ss(as.hasSeenJoinWorkspaceBanner),y=u&&!m,x=an(),g=(x==null?void 0:x.email_domain_type)==="professional",j=o&&g&&r&&y&&u&&!m&&_,{data:b,isLoading:R}=hi(),N=!!(b!=null&&b.accountItems.some(dp));let D;e[4]!==a?(D=Ue(a,"3217430380",{disableExposureLog:!0}).get("enable_workspace_discovery",!1),e[4]=a,e[5]=D):D=e[5];const E=!R&&!N&&D&&j,M=xs.getItem(bs.WorkspaceDiscoveryInfo),p=Cc(M);let A;e[6]!==a?(A=We(a,"69563813"),e[6]=a,e[7]=A):A=e[7];const V=!p&&A&&E,{data:L,isFetching:z}=wc(V),F=L==null?void 0:L.workspaces.some(up);if(!(!z&&(p||F)&&E)){let re;return e[8]===Symbol.for("react.memo_cache_sentinel")?(re={shouldShow:!1},e[8]=re):re=e[8],re}let I;e[9]!==a?(I=Ue(a,"1200251816").get("enable-join-workspaces-banner",!1),e[9]=a,e[10]=I):I=e[10];const ee=I;let J;return e[11]!==ee?(J={shouldShow:ee},e[11]=ee,e[12]=J):J=e[12],J}function up(s){return!s.requested}function dp(s){return s.isEnterprisey()}function mp(s){return Ne.hasUserMessage(s)}function Vf(){"use forget";const s=ts.c(22),e=Te(),{markAsViewed:n}=ss(as.hasSeenJoinWorkspaceBanner);let i;s[0]!==n?(i=()=>{Se.logEventWithStatsig("Thread Join Workspace Banner Button Dismissed","chatgpt_thread_join_workspace_banner_button_dismissed"),n()},s[0]=n,s[1]=i):i=s[1];const r=i;let a;s[2]===Symbol.for("react.memo_cache_sentinel")?(a=[],s[2]=a):a=s[2],h.useEffect(pp,a);let c;s[3]!==e||s[4]!==n?(c=()=>{Se.logEventWithStatsig("Thread Join Workspace Banner Button Clicked","chatgpt_thread_join_workspace_banner_button_clicked"),n(),_s(e,kc,{mode:"dismissible",section:"both",source:"join_workspace_banner"})},s[3]=e,s[4]=n,s[5]=c):c=s[5];const o=c;let d;s[6]===Symbol.for("react.memo_cache_sentinel")?(d=ye("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden","pe-7"),s[6]=d):d=s[6];let u;s[7]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Is,{className:"icon-sm","aria-hidden":"true"})}),s[7]=u):u=s[7];let m,_;s[8]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsxs("span",{className:"flex items-center gap-1.5",children:[u,t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(ue,fe({},Lo.bannerBody))})]}),_=t.jsx("span",{className:ye("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:t.jsx("span",{children:t.jsx(ue,{id:"V/M/bo",defaultMessage:"Find Workspaces"})})}),s[8]=m,s[9]=_):(m=s[8],_=s[9]);let y;s[10]!==o?(y=t.jsxs("button",{type:"button",onClick:o,className:d,children:[m,_]}),s[10]=o,s[11]=y):y=s[11];let x;s[12]!==r?(x=D=>{D.stopPropagation(),r()},s[12]=r,s[13]=x):x=s[13];let g,j;s[14]===Symbol.for("react.memo_cache_sentinel")?(j=ye("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),g=t.jsx(fa,{className:"icon-xs","aria-hidden":"true"}),s[14]=g,s[15]=j):(g=s[14],j=s[15]);let b;s[16]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx("span",{className:"sr-only",children:t.jsx(ue,fe({},Lo.dismissBanner))}),s[16]=b):b=s[16];let R;s[17]!==x?(R=t.jsxs("button",{type:"button",onClick:x,className:j,children:[g,b]}),s[17]=x,s[18]=R):R=s[18];let N;return s[19]!==R||s[20]!==y?(N=t.jsxs("div",{className:"relative",children:[y,R]}),s[19]=R,s[20]=y,s[21]=N):N=s[21],N}function pp(){Se.logEventWithStatsig("Thread Join Workspace Banner Button Shown","chatgpt_thread_join_workspace_banner_button_shown")}const Io=_t({bannerBody:{id:"WAgvN5",defaultMessage:"Unlock extra messages, images & more"},dismissBanner:{id:"+X3EGU",defaultMessage:"Dismiss banner"}}),fp=7*24*60*60*1e3;function hp(s,e){const n=Date.parse(s.dismissedAt);return Number.isNaN(n)?!0:Date.now()-n>e}function gp(s){const e=xs.getItem(bs.ThreadUpgradeBannerDismissedAt);return e?hp(e,s):!0}function Oa({isDismissible:s,dismissTtlMs:e=fp}){const[n,i]=h.useState(!1);return h.useEffect(()=>{if(!s){i(!0);return}i(gp(e))},[e,s]),{isVisible:n,dismiss:()=>{if(!s)return;Se.logEventWithStatsig("Thread Upgrade Banner Button Dismissed","chatgpt_thread_upgrade_banner_button_dismissed",{type:"banner"});const a={dismissedAt:new Date().toISOString()};xs.setItem(bs.ThreadUpgradeBannerDismissedAt,a),i(!1)}}}function $f({isDismissible:s=!0}){const e=rs(),{isVisible:n,dismiss:i}=Oa({isDismissible:s});if(h.useEffect(()=>{n&&Se.logEventWithStatsig("Thread Upgrade Banner Button Shown","chatgpt_thread_upgrade_banner_button_shown",{type:"banner"})},[n]),!n)return null;const r=()=>{Se.logEventWithStatsig("Thread Upgrade Banner Button Clicked","chatgpt_thread_upgrade_banner_button_clicked",{type:"banner"}),Ds(e,"thread_splash_upgrade_banner_cta")};return t.jsxs("div",{className:"relative",children:[t.jsxs("button",{type:"button",onClick:r,className:ye("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden",s&&"pe-7",!s&&"pe-4"),children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Is,{className:"icon-sm","aria-hidden":"true"})}),t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(ue,fe({},Io.bannerBody))})]}),t.jsxs("span",{className:ye("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:[t.jsx("span",{className:"hidden sm:inline",children:t.jsx(ue,fe({},He.upgradePlan))}),t.jsx("span",{className:"sm:hidden",children:t.jsx(ue,fe({},He.upgrade))}),!s&&t.jsx(gi,{className:"icon-xs"})]})]}),s&&t.jsxs("button",{type:"button",onClick:a=>{a.stopPropagation(),i()},className:ye("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),children:[t.jsx(fa,{className:"icon-xs","aria-hidden":"true"}),t.jsx("span",{className:"sr-only",children:t.jsx(ue,fe({},Io.dismissBanner))})]})]})}var La=(s=>(s.GENERIC="generic",s.GENERIC_FREE_TRIAL="generic_free_trial",s.GO="go",s.PLUS="plus",s.BANNER="banner",s))(La||{});function xp({clientThreadId:s,variant:e}){var j;const n=Te(),i=jc(),{enableThreadHeaderUpgradePill:r}=Pc(),{enableNewSplashUpgradeBanner:a,newUpsellsDismissible:c}=Tc(),{isVisible:o}=Oa({isDismissible:c()}),d=on(s),u=Ge(s,b=>Ne.hasUserMessage(b)),m=xi(),_=Ue(n,"4048646334"),y=(j=m==null?void 0:m.call_to_action)==null?void 0:j.includes(bi.GET_PLUS),g=i&&(d&&!u)&&r&&!(y&&!_.get("should_show_thread_header_upgrade_pill",!0));return e==="banner"?{shouldShow:g&&o&&a(),newUpsellsDismissible:c}:{shouldShow:g&&!a(),newUpsellsDismissible:()=>!1}}function Yf(){const s=Te(),e=gt(),{eligible:n}=Ec(),{eligible:i}=Mc(),r=n||i;if(!e)return null;let a="generic";if(r)a="generic_free_trial";else if(_i(s))a="go";else{const o=Ue(s,"497415788").get("upgrade_pill_type","plus");if(Ap(o))a=o;else return null}switch(a){case"generic":return t.jsx(Sp,{});case"generic_free_trial":return t.jsx(yp,{});case"plus":return t.jsx(bp,{});case"go":return t.jsx(_p,{});case"banner":return null}}function bp(){const s=rs(),e=Te(),n=()=>{Ds(s,"thread_header_get_plus_pill")};return t.jsxs(St,{onClick:n,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"plus",children:[t.jsx(Is,{className:"icon-sm"}),t.jsx(ue,fe({},Cp(e)))]})}function _p(){const s=rs(),e=()=>{Ds(s,"thread_header_get_plus_pill")};return t.jsxs(St,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"go",children:[t.jsx(Bc,{className:"icon-sm"}),t.jsx(ue,fe({},He.upgradeToGo))]})}function Sp(){const s=rs(),e=()=>{Ds(s,"thread_header_generic_upgrade_pill_button")};return t.jsxs(St,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic",children:[t.jsx(Is,{className:"icon-sm"}),t.jsx(ue,fe({},He.upgrade))]})}function yp(){const s=rs(),e=()=>{Ds(s,"thread_header_generic_free_trial_upgrade_pill_button")};return t.jsxs(St,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic_free_trial",children:[t.jsx(Is,{className:"icon-sm"}),t.jsx(ue,fe({},He.upgradeForFree))]})}function St({children:s,className:e,onClick:n,type:i}){h.useEffect(()=>{Se.logEventWithStatsig("Thread Header Upgrade Pill Button Shown","chatgpt_thread_header_upgrade_pill_button_shown",{type:i})},[i]);const r=()=>{Se.logEventWithStatsig("Thread Header Upgrade Pill Button Clicked","chatgpt_thread_header_upgrade_pill_button_clicked",{type:i}),n()};return t.jsx("button",{onClick:r,className:ye("flex items-center gap-1 rounded-full py-2 ps-2.5 pe-3 text-sm font-medium",e),children:s})}function Ap(s){return Object.values(La).includes(s)}function Cp(s){switch(Ue(s,"497415788").get("plus_upgrade_pill_cta","get_plus")){case"try_plus":return He.tryPlus;case"upgrade_to_plus":return He.upgradeToPlus;case"upgrade_your_plan":return He.upgradeYourPlan;case"upgrade_plan":return He.upgradePlan;case"get_plus":default:return He.getPlus}}function Uo({clientThreadId:s,onClick:e}){h.useEffect(()=>{Ic(s)},[s]);const n=Ie();return t.jsx(Ls.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:t.jsx(ba,{onClick:()=>{Uc(s),e()},label:n.formatMessage(nn.moreStarterPrompts)})})}function wp({starterPrompt:s,starterPrompts:e,index:n,disabled:i,onSelectStarterPrompt:r}){var u;const a=(u=s.theme)!=null?u:s.title,c=Fc(),{mutate:o}=Oc(),d=s.category==="onboarding"?m=>{o({key:as.hasUsedConversationalOnboardingStarterPrompt}),c(m,s,e,n)}:m=>r==null?void 0:r(m,s,e,n);return t.jsx(ba,{disabled:i,onClick:d,icon:t.jsx(Lc,{category:s.category,useV2Colors:!0}),label:a})}const kp=5,jp=3;function Ia({starterPrompts:s,onSelectStarterPrompt:e,disabled:n,clientThreadId:i,onExpand:r,mobileLayout:a=!1}){const c=a?jp:kp,[o,d]=h.useState(c),[u,m]=h.useState(!1),_=h.useRef(null),y=s.length<=o;h.useEffect(()=>{jo(s.slice(0,c),i)},[i]),h.useEffect(()=>{if(!u&&!y&&_.current){const g=_.current,j=g.getBoundingClientRect(),b=j.width,R=Array.from(g.children);let N=0;for(let D=0;D<R.length&&R[D].getBoundingClientRect().right-j.left<=b;D++)N++;d(N),m(!0)}},[s,y,u]);const x=()=>{const g=s.slice(o,s.length).map(j=>os(fe({},j),{isAdditional:!0}));g.length>0&&jo(g,i),d(s.length),r()};return t.jsxs("div",{"data-testid":"starter-prompt-chips",className:ye("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",u&&s.length>0?"opacity-100":"opacity-[0.01]",a?"flex-wrap":"flex-nowrap"),children:[t.jsxs("ul",{className:ye("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",y||a?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:_,children:[s.slice(0,o).map((g,j)=>{var b;return t.jsx(Ls.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:t.jsx(wp,{starterPrompt:g,starterPrompts:s,index:j,disabled:n,onSelectStarterPrompt:e})},(b=g.id)!=null?b:j)}),a&&s.length>o&&t.jsx(Uo,{clientThreadId:i,onClick:x})]}),!a&&s.length>o&&t.jsx(Uo,{clientThreadId:i,onClick:x})]})}const Jf=({clientThreadId:s,currentModelId:e,isModelLoaded:n})=>{const[i,r]=h.useState(!1),a=xt(),{prospectiveModelId:c}=ga(s),o=n?e:c!=null?c:"auto",{promptStarters:d,shouldShowStarterPrompts:u,onSelectStarterPrompt:m}=xa({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:o});return t.jsx(Ls.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:ye(u&&!i&&"h-[116px]"),children:u&&d&&t.jsx(Ia,{starterPrompts:d,onSelectStarterPrompt:m,disabled:a,clientThreadId:s,onExpand:()=>r(!0),mobileLayout:!0})})},Kf=({currentModelId:s,clientThreadId:e,isModelLoaded:n})=>{const{isUnauthenticated:i}=rn(),r=Dc(),[a,c]=h.useState(!1),o=xt(),{prospectiveModelId:d}=ga(e),u=n?s:d!=null?d:"auto",{promptStarters:m,shouldShowStarterPrompts:_,onSelectStarterPrompt:y}=xa({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:e,limit:8,modelSlug:u}),{shouldShow:x}=xp({clientThreadId:e,variant:"banner"}),{shouldShow:g}=cp({clientThreadId:e,canShowBanner:!x}),j=_&&m;return(g||x)&&!j?null:t.jsx(Ls.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:ye("max-w-full max-sm:hidden",!r&&"min-h-[108px]",i&&a||r?"":"h-[70px]"),children:j&&t.jsx(Ia,{starterPrompts:m,onSelectStarterPrompt:y,disabled:o,clientThreadId:e,onExpand:()=>c(!0)})})};function Pp({className:s,layout:e="grid",hideShuffleButton:n}){const i=Ie(),r=xt(),a=Rc(),c=Ho(),o=Be(ha(c).shouldShowAutocomplete$),[d,u]=h.useState(ko(a,[],4,e==="carousel"?1:2)),m=()=>{u(ko(a,d,4,2))};return!a||a.length===0?null:t.jsxs("div",{className:ye("flex w-full flex-col gap-y-4 transition-opacity",s,o?"pointer-events-none opacity-0":"opacity-100"),children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("div",{className:"text-token-text-secondary text-base leading-7 sm:text-sm",children:i.formatMessage(nn.trySomethingNew)}),!n&&t.jsx(Si,{type:"button",onClick:m,label:i.formatMessage(nn.shuffleTiles),color:"ghost",size:"medium",icon:vc})]}),t.jsx("div",{"data-testid":"starter-prompt-tiles",className:ye(e==="grid"?"grid grid-cols-2 gap-4 sm:flex sm:flex-row":"-mx-(--thread-content-margin) flex flex-row gap-3 overflow-x-auto px-(--thread-content-margin) pb-4 sm:gap-4"),children:Array.from({length:4}).map((_,y)=>{const x=d[y];return x?t.jsx("div",{className:ye("max-sm:short:h-[116px] relative h-[132px] sm:h-[144px]",e==="carousel"?"flex-1 max-sm:w-[164px] max-sm:flex-none":"w-full flex-1 sm:basis-0"),children:t.jsx(bc,{initial:!1,children:t.jsx(Ls.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeOut"},className:"absolute inset-0 h-full w-full",children:t.jsx(Nc,{starterPrompt:x,allPrompts:a,index:y,disabled:r,className:"h-full w-full"})},x.id)})},y):t.jsx("div",{},y)})})]})}const nn=_t({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"},trySomethingNew:{id:"StarterPromptTiles.trySomethingNew",defaultMessage:"Try something new"},shuffleTiles:{id:"StarterPromptTiles.shuffle",defaultMessage:"Shuffle"}}),Tp=ln(()=>cn(()=>import("./lo9fpwg3xv1qi9uh.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(s=>s.JawboneNotificationsBanner)),Ep=h.memo(function({className:e}){const{store:n}=De(),i=n.useIsHeaderContentAreaPopulated(),a=n.useContentAreaId(Ss.HeaderTop)===C.AgentModeAnnouncementBanner?"z-0":Gc.PromptTextareaHeader;return t.jsx("div",{className:ye(e!=null?e:"absolute start-0 end-0 bottom-full",a),children:t.jsx(Wc,{shouldRender:i,contentArea:Ss.Header,children:t.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[t.jsx(Mp,{}),t.jsx(Bp,{})]})})})});function Mp(){const s=Te(),{store:e}=De(),n=e.useSharedProps(d=>d==null?void 0:d.clientThreadId),i=e.useContentAreaId(Ss.HeaderTop),r=Hc(),a=Ge(n,d=>d==null?void 0:d.modelId),c=Fs(Os);let o;switch(i){case C.ProjectConversationTaskNoFileAccess:o=t.jsx(Dp,{});break;case C.AdvancedVoiceOnMobileAnnouncement:o=t.jsx(lu,{clientThreadId:n});break;case C.S09KM1:o=null;break;case C.BannerSignup:o=t.jsx(Np,{});break;case C.BannerTermsDisclaimer:o=t.jsx(Fp,{});break;case C.NewUserBannerTermsDisclaimer:o=t.jsx(Op,{});break;case C.PromptTextareaAction:o=t.jsx(Lp,{});break;case C.BannersRateLimit:o=t.jsx(Ip,{});break;case C.BannersBeaconUI:o=t.jsx(Up,{});break;case C.BannerSidekickAnnouncement:o=t.jsx(iu,{});break;case C.SearchBrowserExtensionAnnouncement:o=t.jsx(ru,{});break;case C.MoonshineAnnouncement:o=t.jsx(au,{});break;case C.GoldenHourAnnouncementBanner:o=!1;break;case C.SearchBrowserExtensionReactiveAnnouncement:o=t.jsx(ou,{});break;case C.BannerMemoryAlmostFull:o=t.jsx(To,{memoryAlmostFullVariant:!0});break;case C.BannerMemoryFull:o=t.jsx(To,{});break;case C.Box:o=t.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",t.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case C.JawboneAnnouncement:r?o=t.jsx(Tp,{}):o=null;break;case C.JawboneMaxActiveAnnouncement:r?o=t.jsx(nu,{}):o=null;break;case C.PromoRedemptionAnnouncement:o=t.jsx(Xm,{});break;case C.OperatorAnnouncement:o=t.jsx(tu,{});break;case C.BannerPlusUpsell:o=t.jsx(su,{});break;case C.BannerNoAuthTrials:o=t.jsx(eu,{});break;case C.ReferrerRedemptionAvailableAnnouncement:o=t.jsx(rp,{});break;case C.RefereeRedemptionAvailableAnnouncement:o=t.jsx(Zc,{});break;case C.ReferralProgramUpsellAnnouncement:o=t.jsx(Qc,{});break;case C.TatertotIntakeFormAnnouncement:o=!1;break;case C.StudentsUpsellAnnouncement:o=t.jsx(Xc,{});break;case C.ModelDeprecationBanner:o=Kc(a);break;case C.TeamSeatsPromoAnnouncement:o=t.jsx(Jc,{});break;case C.TeamsContextualAnswersUpsell:o=t.jsx(Yc,{});break;case C.AgentModeAnnouncementBanner:o=yi(s)&&!c&&t.jsx(zc,{});break;case C.LanguageUpsellBanner:o=t.jsx($c,{onDismissSideEffect:()=>{Se.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),Po.set(s,!0)},onPrimaryCtaClickSideEffect:()=>{Se.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),Po.set(s,!0)}});break;case C.StarterPrompts:o=t.jsx(Pp,{hideShuffleButton:!0,layout:"carousel"});break;case C.ImageGenBanner:o=t.jsx(Vc,{className:"mb-3"});break;case C.SystemHintSuggestion:o=t.jsx(qc,{});break;default:o=null;break}return o}function Bp(){const{store:s}=De(),e=s.useContentAreaId(Ss.HeaderBottom);let n;switch(e){case _a.DallePromptControls:n=t.jsx(vp,{});break;default:n=null;break}return n}const Rp=ln(()=>cn(()=>import("./dtb8mu8k0cgd7l2m.js"),__vite__mapDeps([7,1,2,3,4,5])).then(s=>s.default));function vp(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.composerController);return e?t.jsx(Rp,{composerController:e}):null}function Np(){const{store:s}=De(),e=s.useSharedProps(r=>r==null?void 0:r.clientThreadId),n=Ai(),i=fu();return e?n?t.jsx(hu,{threadId:e,showSignUp:i}):t.jsx(gu,{threadId:e,showLogin:i}):null}function Dp(){return h.useEffect(()=>()=>{xs.getItem(bs.TasksHasSeenProjectDisclaimerBanner)||xs.setItem(bs.TasksHasSeenProjectDisclaimerBanner,!0)},[]),t.jsx(Go,{icon:t.jsx(Ci,{}),title:t.jsx(ue,{id:"ibX3g7",defaultMessage:"Tasks canâ€™t access project files"}),content:t.jsx(ue,{id:"fm94Tm",defaultMessage:"Thereâ€™s a task in this conversation â€” just FYI, it wonâ€™t be able to access project files."}),onDismiss:()=>{xs.setItem(bs.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Fp(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?t.jsx(pu,{threadId:e}):null}function Op(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?t.jsx(mu,{threadId:e}):null}function Lp(){const{store:s}=De(),e=s.useSharedProps();return e?t.jsx(du,fe({},e)):null}function Ip(){const{store:s}=De(),e=s.useSharedProps(i=>i==null?void 0:i.clientThreadId),n=s.useSharedProps(i=>i==null?void 0:i.composerController);return!e||!n?null:t.jsx(uu,{clientThreadId:e,composerController:n})}function Up(){const{store:s}=De(),e=s.useSharedProps(r=>r==null?void 0:r.openFileDialog),n=s.useSharedProps(r=>r==null?void 0:r.clientThreadId),i=s.useSharedProps(r=>r==null?void 0:r.composerController);return!n||!i||!e?null:t.jsx(cu,{clientThreadId:n,openFileDialog:e})}const Gp=5,Wp=h.memo(function(e){return Hp(e),zp(e),xu({clientThreadId:e.clientThreadId,composerController:e.composerController,openFileDialog:e.openFileDialog}),qp(),null});function Hp(s){const{store:e}=De(),n=e.useSetSharedProps();Xt(()=>{n(s)},[s,n])}function zp(s){const{clientThreadId:e,canContinue:n}=s,{store:i}=De(),r=Te(),a=h.useRef({top:i.useContentAreaApi(Ss.HeaderTop),bottom:i.useContentAreaApi(Ss.HeaderBottom)}).current,c=bu(e),{shouldShowBannerSignup:o,shouldShowBannerTermsDisclaimer:d}=Vp(e),{isOpen:u}=_u(),m=Su(e),_=yu(e),y=Au(s);Cu(s);const x=wu(),g=ku(s),{shouldShowMemoryFull:j,shouldShowMemoryAlmostFull:b}=ju(e),R=Pu(s),N=Tu(e),D=Eu(e),f=Qm(),{eligible:E}=ss(Mu),M=Bu(),p=Ru(),A=vu(),H=Nu(),{eligible:V}=ss(as.hasSeenTeamSeatsPromoAnnouncement),L=Du(e),z=Fu(e),F=Ou(),v=Lu(),Y=Iu(e),I=Ge(e,P=>P==null?void 0:P.modelId),ee=Sa(e),J=bt(),re=ya(),{eligible:xe}=ss(as.hasSeenAgentModeAnnouncementBanner),he=Be(()=>Uu(wi(r,e)).activeSystemHintSuggestionChips$().length>0),de=xe&&re&&J!==Qt,se=zo(),B=on(e),w=Gu({shouldBeEnabledForDefaultAssistant:B&&!se,clientThreadId:e}),O=Wu(),K=w==="hscroll",U=w==="image_gen_banner"&&O;Xt(()=>{d?a.top.set(C.BannerTermsDisclaimer):u?a.top.set(C.NewUserBannerTermsDisclaimer):I&&(ee==null?void 0:ee.kind)===pt.GizmoInteraction&&ee.gizmo&&ki(I,ee.gizmo)?a.top.set(C.ProjectConversationTaskNoFileAccess):R.eligible?a.top.set(C.AdvancedVoiceOnMobileAnnouncement):m?a.top.set(C.BannersRateLimit):_?a.top.set(C.BannersBeaconUI):F?a.top.set(C.BannerPlusUpsell):v?a.top.set(C.BannerNoAuthTrials):N?a.top.set(C.JawboneAnnouncement):D?a.top.set(C.JawboneMaxActiveAnnouncement):y.eligible?a.top.set(C.BannerSidekickAnnouncement):x?a.top.set(C.MoonshineAnnouncement):g?a.top.set(C.SearchBrowserExtensionReactiveAnnouncement):f?a.top.set(C.PromoRedemptionAnnouncement):E?a.top.set(C.OperatorAnnouncement):A?a.top.set(C.ReferralProgramUpsellAnnouncement):n?a.top.set(C.PromptTextareaAction):o?a.top.set(C.BannerSignup):b&&ji(r,"1206459705").get("upsell_variant","control")!=="control"?a.top.set(C.BannerMemoryAlmostFull):j?a.top.set(C.BannerMemoryFull):M?a.top.set(C.ReferrerRedemptionAvailableAnnouncement):p?a.top.set(C.RefereeRedemptionAvailableAnnouncement):H?a.top.set(C.StudentsUpsellAnnouncement):V?a.top.set(C.TeamSeatsPromoAnnouncement):L?a.top.set(C.ModelDeprecationBanner):z?a.top.set(C.TeamsContextualAnswersUpsell):Y?a.top.set(C.LanguageUpsellBanner):de?a.top.set(C.AgentModeAnnouncementBanner):K?a.top.set(C.StarterPrompts):U?a.top.set(C.ImageGenBanner):he?a.top.set(C.SystemHintSuggestion):a.top.set(null)},[a,J,n,d,u,o,m,y,j,R,de,V,K,U,he]),Xt(()=>{c&&a.bottom.set(_a.DallePromptControls)},[a,c])}function qp(){const{store:s}=De();h.useEffect(()=>()=>{s.reset()},[s])}function Vp(s){const e=Te(),{isUnauthenticated:n}=rn(),i=Ue(e,"3637408529",{disableExposureLog:!0}),a=Ue(e,"3637408529").get("no_auth_banner_signup_rate_limit",Gp),c=i.get("should_show_no_auth_signup_banner",!0),o=Hu(y=>y.bannerDisclaimerClientThreadId),d=zu(),u={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[m,_]=Ge(s,y=>{var x;return[Ne.getConversationTurns(y).filter(g=>g.role===qo.User).length,$p((x=Ne.getCurrentNode(y))==null?void 0:x.message)]});return s&&(u.shouldShowBannerTermsDisclaimer=_&&n&&m===1&&!d&&(o==null||o===s),u.shouldShowBannerSignup=c&&_&&n&&m>0&&m%a===0),u}function $p(s){return(s==null?void 0:s.author.role)===qo.Assistant&&Pi(s)}function Yp({modelSupportedImageMimeTypes:s}){const e=Fs(Os),n=Vo(),i=un(),r=Ie();return e?t.jsx(ce.Item,{icon:qu,onClick:async()=>{const a=await sp();if(a)try{const c=atob(a.base64image),o=c.length,d=new Uint8Array(o);for(let m=0;m<o;m++)d[m]=c.charCodeAt(m);const u=new File([d],a.filename,{type:a.mimetype});Vu.uploadFile(n,u,s,r,i,void 0,void 0,Rs.Multimodal)}catch(c){}},children:t.jsx(ue,{id:"HiFPUD",defaultMessage:"Attach screenshot"})},"attach_screenshot"):null}const Jp="manage-prompts",Kp=()=>({data:null,isLoading:!1});function vs(s){return typeof s=="object"&&s!=null&&"command"in s}function Xp(s){"use forget";const e=ts.c(11),{command:n,isHighlighted:i,onHighlight:r,onClick:a}=s;let c;e[0]!==n.title?(c=t.jsx("span",{className:"break-all",children:n.title}),e[0]=n.title,e[1]=c):c=e[1];let o;return e[2]!==n.disabled||e[3]!==n.icon||e[4]!==n.secondary||e[5]!==n.trailing||e[6]!==i||e[7]!==a||e[8]!==r||e[9]!==c?(o=t.jsx(Qo,{as:"div",hasManagedFocus:!0,disabled:n.disabled,highlighted:i,icon:n.icon,secondary:n.secondary,trailing:n.trailing,onPointerMove:r,onClick:a,children:c}),e[2]=n.disabled,e[3]=n.icon,e[4]=n.secondary,e[5]=n.trailing,e[6]=i,e[7]=a,e[8]=r,e[9]=c,e[10]=o):o=e[10],o}function Qp({hint:s,isHighlighted:e,onHighlight:n,onClick:i}){"use no forget";const r=Ta(s.systemHint),a=t.jsx(Qo,{as:"div",hasManagedFocus:!0,disabled:r.isBlocked,highlighted:e,icon:t.jsx(ed,{hint:s,isNextToLabel:!0}),secondary:r.blockedLabel,onPointerMove:n,onClick:i,children:t.jsx("span",{className:"break-all",children:s.name})});return r.remainingLabel?t.jsx(dn,{side:"right",labelTextAlign:r.isBlocked?"left":"center",label:r.remainingLabel,secondaryLabel:r.remainingLabelSecondary,contentClassName:"cant-hover:hidden",triggerAs:null,children:a}):a}const Zp=Vi(s=>{var e,n,i,r;return vs(s)?{targets:[s.command,...(e=s.aliases)!=null?e:[],...(n=s.regexMatches)!=null?n:[],s.secondary?"".concat(s.title," ").concat(s.secondary):s.title],weight:s.matchWeight}:{targets:[s.systemHint,...(i=s.aliases)!=null?i:[],...(r=s.regexMatches)!=null?r:[],s.name]}});function ef({gptsSlashCommands$:s,modelSlashCommands$:e,libraryPromptSlashCommands:n,slashCommands:i,systemHints:r,composerController:a,clientThreadId:c,layoutMode:o}){"use forget";const d=Te(),u=ja(),m=rs(),_=Ie(),{refs:y,floatingStyles:x}=Oi({placement:o==="center"?"bottom-start":"top-start",middleware:[Li({mainAxis:10,alignmentAxis:-18}),Ii({padding:6}),Ui({apply:({elements:w,availableWidth:O,availableHeight:K})=>{w.floating.style.setProperty("--radix-popper-available-width","".concat(O,"px")),w.floating.style.setProperty("--radix-popper-available-height","".concat(K,"px"))}})],whileElementsMounted:Gi}),[g,j]=h.useState(void 0);h.useEffect(()=>{const w=_e(a);w.dispatch(Wi(w.state.tr,{setReferencePosition:y.setReference,onHintMatch(O){j(K=>Zo(K,O)?K:O)}}))},[a,y]);const b=Ku(),R=Xo(c),{setThreadSystemHintMode:N,clearAllSystemHintModeTriggers:D}=Xu(),f=Fs(Os),E=Be(()=>g&&(s==null?void 0:s())),M=Be(()=>{var w;return(w=e==null?void 0:e())!=null?w:[]}),p=(g==null?void 0:g.triggerSymbol)==="@",A=!1,H=h.useCallback(()=>{},[d]),V=h.useMemo(()=>p?f?[]:[E!=null?E:[]]:[i,r,M],[p,n,E,i,r,M,A,_,m,H,f]),{displayGroups:L,suggestions:z}=h.useMemo(()=>{if(!g)return{displayGroups:[],suggestions:[]};const w=g.text?[Qu(Mo(V),g.text,Zp,{locale:_.locale})]:V.map(K=>K.filter(U=>!vs(U)||!U.noMatchEmpty)),O=o==="bottom"?w.reverse().map(K=>K.reverse()):w;return{displayGroups:O,suggestions:Mo(O)}},[V,g,o,_]),[F,v]=h.useState(o==="bottom"?-1:0),Y=F==null?null:(F+z.length)%z.length,I=h.useCallback(w=>{v(O=>{if(O==null)return null;const K=z.length;for(let U=0;U<K;U++){const P=(O+K+(U+1)*w)%K,X=z[P];if(!("systemHint"in X?b.includes(X.systemHint):X.disabled))return P}return null})},[z,b]),ee=dt(I),J=z.length,re=J===0;h.useEffect(()=>{o==="bottom"?(v(0),ee.current(-1)):(v(-1),ee.current(1))},[J,o,ee]);const xe=Y==null?null:z[Y],he=h.useCallback(()=>{if(g!=null&&g.range){const w=_e(a);Hi(w,g.range.from,g.range.to)}},[g,a]),de=({hintToSave:w=xe,expectPerfectMatch:O})=>{var te;if(!g||!w)return!1;const K=g.text.toLocaleLowerCase(),P=(vs(w)?w.command:w.name).toLocaleLowerCase()===K||((te=w.aliases)==null?void 0:te.some(ne=>ne.toLocaleLowerCase()===K));if(O&&!P)return!1;if(he(),ot(_e(a)),vs(w))return w.onSelect(),!0;Se.logEvent("System Hint Selected",{system_hint:w.systemHint,conversation_id:R!=null?R:Lt});const X={clientThreadId:c};D();const k=w.systemHint===W.Search;return N(w.systemHint,!0,X,k?Zu.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),w.systemHint===W.Agent&&u==="show"&&_s(d,({onClose:ne})=>t.jsx(Pa,{clientThreadId:c!=null?c:Lt,onClose:ne,source:"slash_agent"})),!0},se=dt(de);h.useEffect(()=>{const w=_e(a);return re||zi(w,O=>{if(O==="up")ee.current(-1);else if(O==="down")ee.current(1);else if(O==="cancel")ot(w),$i(w);else{if(O==="submit")return ot(w),se.current({expectPerfectMatch:!1});if(O==="checkMatch")return se.current({expectPerfectMatch:!0})}}),()=>ot(w)},[a,re,xe,he,ee,se]);const B=dt(R);return h.useEffect(()=>{var w;re||Se.logEvent("System Hint List Opened",{conversation_id:(w=B.current)!=null?w:Lt})},[B,re]),re?null:t.jsx(qi,{ref:y.setFloating,style:x,className:ye("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",z.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]"),onPointerDown:w=>{w.preventDefault()},children:L.map((w,O)=>{let K=0;for(let U=0;U<O;U++)K+=L[U].length;return t.jsx(ce.Group,{children:w.map((U,P)=>{const X=K+P;return vs(U)?t.jsx(Xp,{command:U,isHighlighted:X===Y,onHighlight:()=>v(X),onClick:()=>{de({hintToSave:U,expectPerfectMatch:!1}),$e(_e(a))}},U.command):t.jsx(Qp,{hint:U,isHighlighted:X===Y,onHighlight:()=>v(X),onClick:()=>{de({hintToSave:U,expectPerfectMatch:!1}),$e(_e(a))}},U.systemHint)})},O)})})}function sf(s){"use forget";var ne;const e=ts.c(82),{systemHints:n,availableSystemHints:i,composerController:r,clientThreadId:a,layoutMode:c,composerLayer:o,canUseInlineTagging:d,isFileUploadEnabled:u,fileUploadDisabledReason:m,currentModelConfig:_,openFileDialog:y,connectionInstanceData:x,setActiveSystemHintType:g,defaultModelId:j,selectModelId:b,gizmoId:R,hasGizmoFeatureRateLimit:N,setSelectedGizmoTag:D}=s,f=Te(),E=Ie(),M=rs(),{connectedTypes:p}=Ti(),A=an();let H;e[0]!==A?(H=A!=null&&Ei(A),e[0]=A,e[1]=H):H=e[1];const V=H,L=$o(),{isSingleLine:z,showModelSlashCommands:F}=o;x==null||x.connection_statuses;let v,Y;if(e[2]!==a||e[3]!==p||e[4]!==(x==null?void 0:x.connection_statuses)||e[5]!==f||e[6]!==(_==null?void 0:_.title)||e[7]!==m||e[8]!==E||e[9]!==L||e[10]!==u||e[11]!==V||e[12]!==z||e[13]!==M||e[14]!==y||e[15]!==g||e[16]!==n){if(Y=[],z){let T;e[18]===Symbol.for("react.memo_cache_sentinel")?(T=["file","attach","photo"],e[18]=T):T=e[18];const $=!u,oe=_==null?void 0:_.title;let me;e[19]!==f||e[20]!==m||e[21]!==E||e[22]!==$||e[23]!==oe?(me=Aa(f,E,$,m,oe),e[19]=f,e[20]=m,e[21]=E,e[22]=$,e[23]=oe,e[24]=me):me=e[24];let Ae;e[25]===Symbol.for("react.memo_cache_sentinel")?(Ae=t.jsx(Ca,{"aria-label":"",className:"icon"}),e[25]=Ae):Ae=e[25];const Me=!u;let je;e[26]!==y||e[27]!==me||e[28]!==Me?(je={command:"upload",aliases:T,title:me,icon:Ae,onSelect:y,disabled:Me},e[26]=y,e[27]=me,e[28]=Me,e[29]=je):je=e[29],Y.push(je)}let G;e[30]!==(x==null?void 0:x.connection_statuses)?(G=(ne=x==null?void 0:x.connection_statuses.filter(df).map(uf))!=null?ne:[],e[30]=x==null?void 0:x.connection_statuses,e[31]=G):G=e[31];const Q=G,ie=n==null?void 0:n.some(cf);if(V&&(p.size>0||Q.length>0)&&ie){let T;e[32]!==E?(T=E.formatMessage({id:"6YT2cp",defaultMessage:"Use all connectors"}),e[32]=E,e[33]=T):T=e[33];let $;e[34]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx($u,{}),e[34]=$):$=e[34];let oe;e[35]!==a||e[36]!==Q||e[37]!==p||e[38]!==g?(oe=()=>{g(W.Slurm,{analyticsMetadata:{clientThreadId:a}}),Ve(a,Ae=>{var je,Re;const Me=(Re=(je=Ae.selectedSources)==null?void 0:je.get(W.Slurm))!=null?Re:new Set;Ae.selectedSources==null&&(Ae.selectedSources=new Map),Ae.selectedSources.set(W.Slurm,new Set([...Me,...p,...Q]))})},e[35]=a,e[36]=Q,e[37]=p,e[38]=g,e[39]=oe):oe=e[39];let me;e[40]!==T||e[41]!==oe?(me={command:"all-connectors",title:T,icon:$,noMatchEmpty:!0,onSelect:oe},e[40]=T,e[41]=oe,e[42]=me):me=e[42],Y.push(me)}if(L){let T;e[43]===Symbol.for("react.memo_cache_sentinel")?(T=["mcp"],e[43]=T):T=e[43];let $;e[44]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(Yu,{}),e[44]=$):$=e[44];let oe;e[45]!==M?(oe={command:"add-mcp",aliases:T,title:"Add MCP",icon:$,noMatchEmpty:!0,onSelect:()=>{M(Mi(Yo.Connectors))}},e[45]=M,e[46]=oe):oe=e[46],Y.push(oe)}e[2]=a,e[3]=p,e[4]=x==null?void 0:x.connection_statuses,e[5]=f,e[6]=_==null?void 0:_.title,e[7]=m,e[8]=E,e[9]=L,e[10]=u,e[11]=V,e[12]=z,e[13]=M,e[14]=y,e[15]=g,e[16]=n,e[17]=Y}else Y=e[17];v=Y;const I=v;let ee,J;e[47]!==f||e[48]!==j||e[49]!==b||e[50]!==F?(J=ft(()=>{if(!F)return[];const{data:G}=Jo(f);if(!G)return[];const Q=[];for(const ie of G.categories)ie.defaultModel!==j&&Q.push({command:ie.defaultModel,title:ie.label,disabled:!1,icon:t.jsx(Eo,{className:"icon"}),onSelect:()=>{b(ie.defaultModel,"slash menu")}});for(const ie of G.groups)for(const T of ie.modelIds){const $=G.models.get(T);if($&&!$.tags.includes(Bi.HIDDEN)){let oe=$.title;Q.push({command:$.id,title:oe,secondary:void 0,trailing:t.jsx(Ri,{children:ie.label}),noMatchEmpty:!0,matchWeight:.1,disabled:!1,icon:t.jsx(Eo,{className:"icon"}),onSelect:()=>{b($.id,"slash menu")}})}}return Q}),e[47]=f,e[48]=j,e[49]=b,e[50]=F,e[51]=J):J=e[51],ee=J;const re=ee;let xe,he;e[52]!==d||e[53]!==f||e[54]!==R||e[55]!==N||e[56]!==D?(he=ft(()=>{var oe,me,Ae,Me,je;if(!d)return[];const{data:G}=vi(f),{data:Q}=Ni(f),{data:ie}=Ju(f),T=wa([...(oe=G==null?void 0:G.items)!=null?oe:[],...(Ae=(me=Q==null?void 0:Q.list.items)==null?void 0:me.map(lf))!=null?Ae:[],...We(f,"773249106")?(je=(Me=ie==null?void 0:ie.items)==null?void 0:Me.map(rf))!=null?je:[]:[]],af);return(R?T.filter(Re=>Re.gizmo.id!==R):T).map(Re=>{var is;return{command:Re.gizmo.display.name,title:Re.gizmo.display.name,disabled:N,icon:t.jsx(ka,{simple:!0,isFirstParty:((is=Re.gizmo.tags)==null?void 0:is.includes(Ko.FirstParty))===!0,src:Re.gizmo.display.profile_picture_url,className:"icon",alt:""}),onSelect:()=>{Se.logEventWithStatsig("Composer GPT Selected","chatgpt_web_composer_gpt_selected",{gizmo:Re.gizmo.id}),D(Re)}}})}),e[52]=d,e[53]=f,e[54]=R,e[55]=N,e[56]=D,e[57]=he):he=e[57],xe=he;const de=xe;let se;e[58]!==f?(se=!1,e[58]=f,e[59]=se):se=e[59];const B=se;let w;e[60]!==B?(w={enabled:B},e[60]=B,e[61]=w):w=e[61];const{data:O}=Kp();let K;e[62]!==a||e[63]!==r||e[64]!==M||e[65]!==g?(K=G=>{var ie,T,$;const Q=_e(r);if(Di(Q,"@"),G===Jp){M("/library?tab=prompts");return}if(Ve(a,of),Se.logEventWithStatsig("chatgpt_web_prompt_used","chatgpt_web_prompt_used",{referer:"at_cmd",hint:(ie=G.system_hint)!=null?ie:"none",sources:((T=G.sources)!=null?T:[]).join(",")}),Fi(Q,G.prompt),G.system_hint&&(g(G.system_hint),($=G.sources)!=null&&$.length)){const oe=G.sources.map(nf).filter(Zt),me=G.system_hint,Ae=new Set(oe.filter(tf)),Me=new Set(oe.filter(gs));Ve(a,je=>{je.selectedSources=new Map([[me,Ae]]),je.selectedMCPSources=new Map([[me,Me]]),je.hasModifiedSources=!0})}},e[62]=a,e[63]=r,e[64]=M,e[65]=g,e[66]=K):K=e[66];const U=K;let P;e:{if(!B){let Q;e[67]===Symbol.for("react.memo_cache_sentinel")?(Q=[],e[67]=Q):Q=e[67],P=Q;break e}let G;e[68]!==U||e[69]!==(O==null?void 0:O.prompts)?(G=O==null?void 0:O.prompts.map(Q=>({command:Q.name,title:Q.name,icon:void 0,onSelect:()=>{U(Q)}})),e[68]=U,e[69]=O==null?void 0:O.prompts,e[70]=G):G=e[70],P=G}const X=P;let k;e[71]!==i?(k=i!=null?i:[],e[71]=i,e[72]=k):k=e[72];let te;return e[73]!==a||e[74]!==r||e[75]!==de||e[76]!==c||e[77]!==X||e[78]!==re||e[79]!==I||e[80]!==k?(te=t.jsx(ef,{gptsSlashCommands$:de,modelSlashCommands$:re,libraryPromptSlashCommands:X,slashCommands:I,systemHints:k,composerController:r,clientThreadId:a,layoutMode:c}),e[73]=a,e[74]=r,e[75]=de,e[76]=c,e[77]=X,e[78]=re,e[79]=I,e[80]=k,e[81]=te):te=e[81],te}function tf(s){return!gs(s)}function nf(s){return s.trim()}function of(s){s.isUsingPromptTemplate=!0}function af(s){return s.gizmo.id}function rf(s){return s.gizmo}function lf(s){return s.resource}function cf(s){return s.systemHint===W.Slurm}function uf(s){return s.user_connection_details.connection_type}function df(s){return s.user_connection_details.activation_status==="activated"&&["google_drive_oauth","google_drive_dwd"].includes(s.user_connection_details.knowledge_connector_type)}function mf(s){"use forget";const e=ts.c(29),{clientThreadId:n,modelSupportedImageMimeTypes:i,openFileDialog:r,historyDisabled:a,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u,isLoadingConnectors:m,connectorConfig:_,onSelectConnector:y,showLabel:x,showUpsell:g,hideBorder:j,isSmall:b,showMenuForNoAuth:R,visualTreatment:N}=s,D=Yi(),{gdriveStatus:f,o365Status:E}=Ji(),{isUnauthenticated:M}=rn(),p=a?"text-white":o?"text-brand-blue-800":"",A=!g&&(f!=="false"||E!=="false"||D),{loggedOutAttachPlusIcon:H}=mn(),V=M&&!H?Ca:sd;let L;e[0]!==p?(L=ye("icon",p),e[0]=p,e[1]=L):L=e[1];let z;e[2]!==V||e[3]!==L?(z=t.jsx(V,{"aria-label":"",className:L}),e[2]=V,e[3]=L,e[4]=z):z=e[4];const F=z,v=i.length>0;let Y;e[5]!==n||e[6]!==_||e[7]!==u||e[8]!==d||e[9]!==j||e[10]!==o||e[11]!==F||e[12]!==c||e[13]!==m||e[14]!==b||e[15]!==M||e[16]!==i||e[17]!==v||e[18]!==y||e[19]!==r||e[20]!==A||e[21]!==x||e[22]!==R||e[23]!==g||e[24]!==N?(Y=A?t.jsx(td,{clientThreadId:n,icon:F,showLabel:M&&x,modelSupportedImageMimeTypes:i,isLoadingConnectors:m,connectorConfig:_,onSelectConnector:y,openFileDialog:r,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u}):t.jsx(np,{isSmall:b,hideBorder:j,clientThreadId:n,openFileDialog:r,showLabel:x,showUpsell:g,icon:F,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u,visualTreatment:N,showMenuForNoAuth:R,modelSupportsImages:v}),e[5]=n,e[6]=_,e[7]=u,e[8]=d,e[9]=j,e[10]=o,e[11]=F,e[12]=c,e[13]=m,e[14]=b,e[15]=M,e[16]=i,e[17]=v,e[18]=y,e[19]=r,e[20]=A,e[21]=x,e[22]=R,e[23]=g,e[24]=N,e[25]=Y):Y=e[25];const I=Y;let ee;return e[26]!==I||e[27]!==o?(ee=t.jsx(nd,{showBackground:o,className:"bg-brand-blue-800/20",children:I}),e[26]=I,e[27]=o,e[28]=ee):ee=e[28],ee}const Kt=6,pf=(s,e=!1)=>{const n=s.some(r=>!r.disabled),i=e?[...s]:n?s.filter(r=>!r.disabled):[...s];return i.sort((r,a)=>r.connected&&!a.connected?-1:!r.connected&&a.connected?1:r!=null&&r.isAutoConnected&&!(a!=null&&a.isAutoConnected)||r.type==="web"&&a.type!=="web"?-1:r.type!=="web"&&a.type==="web"?1:r.name.localeCompare(a.name)),i};function es(s){switch(s.user_connection_details.activation_status){case"activated":case"partially_activated":return!0;case"activating":case"inactive":return!1}}const yt=s=>{var e;return(e=gf[s.user_connection_details.connection_type])!=null?e:s.connection_display_info.display_name},ff=new Set(["gdrive_sync_connector","slack_sync_connector","github_sync_connector","notion_sync_connector","sharepoint_admin_sync_connector","confluence_sync_connector"]),hf=({isLoading:s=!1,clientThreadId:e,enabledConnectors:n,includeWebSearch:i=!0,includeCloudBrowser:r=!1,includeSyncConnectors:a=!1,syncConnectorFilterFn:c,connectorConfigMap:o,fetchValidLinksOnly:d,systemHintType:u,selectedSources:m,selectedMCPSources:_,showConnectMore:y=!0,toggleSource:x,contentRef:g})=>{"use forget";const j=Ie(),b=na(),R=gt(),N=!!(R!=null&&R.isPersonalAccount()&&b),{openSettings:D}=Ki(),f=Te(),E=Ge(e,B=>B==null?void 0:B.startedWithByoMcp),M=E===!1,p=E===!0,{connectorLinks:A,isLoading:H}=Xi({fetchValidLinksOnly:d}),{allAutoConnectors:V}=fn({getDisabledAutoConnectors:!1}),{connectionInstanceData:L,refetch:z,isLoading:F}=pn({skip:!a}),v=h.useMemo(()=>{var B,w,O;return c?(w=(B=L==null?void 0:L.connection_statuses)==null?void 0:B.filter(K=>c(K.user_connection_details.connection_type)))!=null?w:[]:(O=L==null?void 0:L.connection_statuses)!=null?O:[]},[L,c]),Y=h.useMemo(()=>new Set(v.map(B=>B.user_connection_details.connection_type).filter((B,w,O)=>O.indexOf(B)!==w)),[v]),I=h.useMemo(()=>v.some(B=>es(B)&&B.user_connection_details.connection_type==="sharepoint_admin_sync_connector"),[v]),{enabledConnectors:ee,connectorConfigMap:J,connectorLinks:re}=h.useMemo(()=>{if(!a)return{enabledConnectors:n,connectorConfigMap:o,connectorLinks:A};const B=It[Ee.GDRIVE_ACTION_CONNECTOR],w=A.has(B),O=v.some(k=>k.user_connection_details.connection_type==="gdrive_sync_connector"),K=v.some(k=>k.user_connection_details.connection_type==="gdrive_sync_connector"&&es(k));let U=[...n];const P=new Map(o),X=new Map(A);return w&&!U.some(k=>k.type===Ee.GDRIVE_ACTION_CONNECTOR)&&!O?(U.push({id:It[Ee.GDRIVE_ACTION_CONNECTOR],type:Ee.GDRIVE_ACTION_CONNECTOR,name:"Google Drive",description:"",logo_url:ld,connector_type:"SERVICE",service:"",base_url:null,actions:[],supported_auth:[],owners:[],access_list:[],conformance:{implements_retrievable:!0}}),P.set(Ee.GDRIVE_ACTION_CONNECTOR,{disabled:!0,disabledText:j.formatMessage(ze.contactAdmin),hasBetaTag:!1}),X.delete(B)):N&&K&&(U=U.filter(k=>{var te;if(k.type===Ee.GDRIVE_ACTION_CONNECTOR){const ne=(te=X.get(k.id))==null?void 0:te[0];if(v.some(G=>G.user_connection_details.backing_link_id===(ne==null?void 0:ne.id)))return!1}return!0})),v.forEach(k=>{es(k)&&k.user_connection_details.backing_link_id?X.forEach((te,ne)=>{te.some(G=>G.id===k.user_connection_details.backing_link_id)&&(U=U.filter(G=>G.id!==ne))}):I&&(U=U.filter(te=>te.id!==It[Ee.SHAREPOINT_CONNECTOR]))}),{enabledConnectors:U,connectorConfigMap:P,connectorLinks:X}},[a,A,v,n,o,N,j,I]),{connectedRows:xe,disconnectedRows:he}=h.useMemo(()=>{var U;const B=[];i&&B.push({connected:!0,type:"web",name:"web",element:t.jsx(ce.CheckboxItem,{icon:Ea,disabled:p,checked:m==null?void 0:m.has("web"),onCheckedChange:()=>{x("web")},children:j.formatMessage(ze.webSearch)})}),r&&B.push({connected:!0,type:"cloud",name:"cloud",element:t.jsx(ce.CheckboxItem,{icon:Ma,disabled:p,checked:m==null?void 0:m.has("cloud"),onCheckedChange:()=>{x("cloud")},children:j.formatMessage(ze.cloudBrowser)})}),a&&v.forEach(P=>{var X,k,te;if(!(N&&P.user_connection_details.connection_type==="gdrive_sync_connector"&&!es(P))){{if(!es(P)&&P.user_connection_details.backing_link_id)return;if(P.user_connection_details.connection_type==="github_sync_connector")return;if(!es(P)&&!ff.has(P.user_connection_details.connection_type))return;if(I&&P.user_connection_details.connection_type==="sharepoint_sync_connector")return}B.push({connected:P.user_connection_details.auth_status!=="not_connected"&&P.user_connection_details.activation_status!=="inactive",isAutoConnected:!1,type:"sync",name:yt(P),element:t.jsx(Ga,{connection:P,disabled:(X=J==null?void 0:J.get("sync_connector"))==null?void 0:X.disabled,disabledText:(k=J==null?void 0:J.get("sync_connector"))==null?void 0:k.disabledText,isSelectedInSource:(te=m==null?void 0:m.has(P.user_connection_details.connection_type))!=null?te:!1,location:"user_dropdown",refetch:z,showDetails:Y.has(P.user_connection_details.connection_type),toggleSource:x},P.user_connection_details.connection_instance_id)})}}),m&&ee.forEach(P=>{var te,ne,G,Q,ie,T,$;const k=!!((te=re.get(P.id))==null?void 0:te[0]);if(P.type===oa.MCP_CONNECTOR)B.push({connected:k,type:"access",name:P.name,element:t.jsx(xf,{connector:P,connectorLinks:re,selectedMCPSources:_,toggleSource:x,systemHintType:u,disabled:P.status==="ONLY_ME"&&M||P.status!=="ONLY_ME"&&p})});else{let oe=p||((G=(ne=J==null?void 0:J.get(P.type))==null?void 0:ne.disabled)!=null?G:!1),me=(Q=J==null?void 0:J.get(P.type))==null?void 0:Q.disabledText;if(P.status==="DISABLED_BY_ADMIN"&&(oe=!0,me=j.formatMessage(Qi.disabledByAdmin)),P.type===Ee.GITHUB_CONNECTOR)return;const Ae=V.includes(P.type)&&u===W.Slurm;B.push({connected:k,disabled:oe,type:"access",name:P.name,isAutoConnected:Ae,element:t.jsx(Ua,{connector:P,connectorLink:(ie=re.get(P.id))==null?void 0:ie[0],disabled:oe,disabledText:me,hasBetaTag:(T=J==null?void 0:J.get(P.type))==null?void 0:T.hasBetaTag,isSelectedInSource:($=m.has(P.type))!=null?$:!1,systemHintType:u,toggleSource:x})})}});{const P=m&&n.find(k=>k.type===Ee.GITHUB_CONNECTOR),X=a?v.find(k=>k.user_connection_details.connection_type==="github_sync_connector"):void 0;if(P||X){const k=X&&X.user_connection_details.auth_status!=="not_connected"&&X.user_connection_details.activation_status!=="inactive",te=(U=A.get(Zi))==null?void 0:U[0],ne=P&&!!te;B.push({connected:!!k||!!ne,type:k?"sync":"access",name:"GitHub",element:t.jsx(bf,{clientThreadId:e,githubSyncConnection:X,githubAccessConnector:P,connectorLink:te,selectedSources:m,toggleSource:x,systemHintType:u,refetch:z,contentRef:g})})}}const w=pf(B,p||M),[O,K]=w.reduce(([P,X],k)=>k.connected?[[...P,k],X]:[P,[...X,k]],[[],[]]);return{connectedRows:O,disconnectedRows:K}},[i,r,a,m,p,M,j,x,v,N,I,u,J,z,Y,ee,re,_,V,n,A,e,g]);if(!e||!m)return null;if(F||H||s)return t.jsx("div",{className:"w-50 px-4",children:t.jsx(el,{lines:5,size:"lg",widthVariance:0,width:100})});const de=Kt-xe.length,se=xe.length>Kt;return t.jsxs("div",{className:"w-70",children:[t.jsx("div",{className:ye(se&&"border-token-border-secondary mb-1.5 border-b","overflow-y-auto"),style:se?{maxHeight:"calc(2.25rem * ".concat(Kt+.5,")")}:void 0,children:xe.map(({element:B,name:w})=>t.jsx(h.Fragment,{children:B},w))}),he.length>0&&de>0&&t.jsx(t.Fragment,{children:he.slice(0,de).map(({element:B})=>t.jsx(t.Fragment,{children:B}))}),y&&t.jsx(ce.Item,{icon:cd,onSelect:()=>{Se.logEventWithStatsig("chatgpt_connectors_dropdown_connect_more_clicked","chatgpt_connectors_dropdown_connect_more_clicked"),u===W.ApiTool?_s(f,Zm):D(Yo.Connectors)},children:j.formatMessage(ze.connectApps)})]})},lt=({isLoading:s=!1,clientThreadId:e,enabledConnectors:n,trigger:i,includeWebSearch:r,includeCloudBrowser:a,selectedSources:c,selectedMCPSources:o,addSource:d,deleteSource:u,toggleSource:m,includeSyncConnectors:_=!1,syncConnectorFilterFn:y,connectorConfigMap:x,fetchValidLinksOnly:g,systemHintType:j,showConnectMore:b=!0})=>{const R=ea(),D=Ge(e,M=>M==null?void 0:M.startedWithByoMcp)===!0,f=h.useRef(null),E=h.useRef(!1);return h.useEffect(()=>{var p,A;const M=((p=c==null?void 0:c.size)!=null?p:0)+((A=o==null?void 0:o.size)!=null?A:0);!E.current&&M===0&&!D&&(d("web"),E.current=!0)},[c,o,d,D]),t.jsxs(ce.Root,{"data-testid":"sources-pill",onOpenChange:M=>{var p,A;M||(od(ad(en(e),j))||(u(Ee.GITHUB_CONNECTOR),R&&u("github_sync_connector")),((p=c==null?void 0:c.size)!=null?p:0)+((A=o==null?void 0:o.size)!=null?A:0)===0&&!D&&d("web"))},children:[i,t.jsx(ce.Portal,{children:t.jsx(ce.Content,{alignOffset:-7,size:"auto",ref:f,children:t.jsx(hf,{isLoading:s,clientThreadId:e,enabledConnectors:n,includeWebSearch:r,includeCloudBrowser:a,includeSyncConnectors:_,syncConnectorFilterFn:y,connectorConfigMap:x,fetchValidLinksOnly:g,systemHintType:j,selectedSources:c,selectedMCPSources:o,showConnectMore:b,toggleSource:m,contentRef:f})})})]})},ct=3,ut=s=>{"use forget";var I;const e=ts.c(42),{includeSyncConnectors:n,includeWebSearch:i,syncConnectorFilterFn:r,selectedSources:a,selectedMCPSources:c,isDeveloperMode:o}=s,d=sa();let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={productSku:sn.PROMPT_TEXT_AREA},e[0]=u):u=e[0];const{availableConnectors:m,isLoading:_}=ta(u),y=!n;let x;e[1]!==y?(x={skip:y},e[1]=y,e[2]=x):x=e[2];const{connectionInstanceData:g,isLoading:j}=pn(x),b=_||j;let R;e[3]!==i||e[4]!==a?(R=i?a!=null&&a.has("web")?t.jsx(Ea,{className:"icon"}):t.jsx(rd,{className:"icon"}):void 0,e[3]=i,e[4]=a,e[5]=R):R=e[5];const N=R;let D;e[6]!==a?(D=a!=null&&a.has("cloud")?t.jsx(Ma,{className:"icon"}):void 0,e[6]=a,e[7]=D):D=e[7];const f=D;let E;e[8]!==a?(E=a!=null?a:[],e[8]=a,e[9]=E):E=e[9];let M;if(e[10]!==m||e[11]!==f||e[12]!==(g==null?void 0:g.connection_statuses)||e[13]!==n||e[14]!==d||e[15]!==c||e[16]!==a||e[17]!==r||e[18]!==E||e[19]!==N){const ee=[...E].filter(_f).map(se=>{const B=m.find(w=>w.type===se);return B?{name:B.name,icon:t.jsx(Ns,{connector:B,size:"xsmall"})}:null}).filter(Sf),J=n?Array.from(new Map(((I=g==null?void 0:g.connection_statuses)!=null?I:[]).filter(se=>es(se)&&(a==null?void 0:a.has(se.user_connection_details.connection_type))&&(r?r(se.user_connection_details.connection_type):!0)).map(se=>{var B;return[se.user_connection_details.connection_type,{name:yt(se),icon:t.jsx("img",{src:d&&se.connection_display_info.icon_dark_url?se.connection_display_info.icon_dark_url:(B=se.connection_display_info.icon_url)!=null?B:"",alt:se.connection_display_info.display_name,className:"icon"})}]})).values()):[],re=Array.from(c!=null?c:[]).map(se=>{const B=m.find(w=>w.id===se);return B?{name:B.name,icon:t.jsx(Ns,{connector:B,size:"xsmall"})}:null}).filter(yf),xe=wa([...re,...ee,...J].reverse(),Af).reverse();xe.sort(Cf);let he;e[21]!==N?(he=N?[{name:"web",icon:N}]:[],e[21]=N,e[22]=he):he=e[22];let de;e[23]!==f?(de=f?[{name:"cloud",icon:f}]:[],e[23]=f,e[24]=de):de=e[24],M=[...he,...de,...xe],e[10]=m,e[11]=f,e[12]=g==null?void 0:g.connection_statuses,e[13]=n,e[14]=d,e[15]=c,e[16]=a,e[17]=r,e[18]=E,e[19]=N,e[20]=M}else M=e[20];const p=M;let A;e[25]!==p?(A=p.length>ct?[...p.slice(0,ct-1),{name:"__plus_overflow",icon:t.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:p.length-ct+1},"more")}]:p,e[25]=p,e[26]=A):A=e[26];const H=A,V=o&&H.length>0&&"rounded-full bg-orange-400/10 hover:bg-orange-400/20";let L;e[27]!==V?(L=ye("composer-btn px-2",V),e[27]=V,e[28]=L):L=e[28];let z;e[29]!==b||e[30]!==H?(z=H.length>0&&!b?t.jsx("div",{className:"flex items-center gap-1",children:H.map(wf)}):t.jsx(id,{className:"icon"}),e[29]=b,e[30]=H,e[31]=z):z=e[31];let F;e[32]!==o||e[33]!==b||e[34]!==H[0]||e[35]!==H.length?(F=o&&H.length>0?t.jsx("span",{className:"ms-1.5 text-orange-400 [[data-collapse-labels]_&]:sr-only",children:H.length===1?H[0].name:t.jsx(ue,{id:"+Fsfxz",defaultMessage:"Multiple Connectors"})}):(H.length<ct||b)&&t.jsx("span",{className:"ms-1.5 [[data-collapse-labels]_&]:sr-only",children:H.length===0&&!b?t.jsx(ue,{id:"UjEzZf",defaultMessage:"Add sources"}):t.jsx(ue,{id:"DhW8Wx",defaultMessage:"Sources"})}),e[32]=o,e[33]=b,e[34]=H[0],e[35]=H.length,e[36]=F):F=e[36];let v;e[37]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx(hd,{className:"icon-sm xs:ms-1.5 ms-1"}),e[37]=v):v=e[37];let Y;return e[38]!==L||e[39]!==z||e[40]!==F?(Y=t.jsx(ce.BasicTrigger,{asChild:!0,children:t.jsxs("button",{type:"button",className:L,children:[z,F,v]})}),e[38]=L,e[39]=z,e[40]=F,e[41]=Y):Y=e[41],Y},Ua=({connector:s,connectorLink:e,disabled:n=!1,disabledText:i="",hasBetaTag:r=!1,isSelectedInSource:a,systemHintType:c,toggleSource:o})=>{var D;const d=Ie(),u=aa(),{allAutoConnectors:m}=fn({getDisabledAutoConnectors:!1}),_=!!e,y=a&&_,x=m.includes(s.type)&&c===W.Slurm||!1;if(s.type===oa.MCP_CONNECTOR)return null;const g=(D=ol[s.type])==null?void 0:D.title,j=g?d.formatMessage(g):s.name,b=t.jsx(Ns,{connector:s,size:"xsmall"}),R=t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"truncate",children:j}),r&&t.jsx(fd,{})]}),N=x&&_?t.jsx(ce.Item,{disabled:n,label:R,onSelect:()=>{window.location.href=dd(s.type)},icon:b,trailing:t.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:d.formatMessage(ze.auto)})}):_?t.jsx(ce.CheckboxItem,{disabled:n,label:R,icon:b,checked:y,onCheckedChange:()=>{o(s.type)}}):t.jsx(ce.Item,{disabled:n,onSelect:()=>{u({connectorId:s.id,redirectAfter:c?"/?system_hints=".concat(c):void 0,systemHintType:c,referrer:ra.SourcesDropdown})},label:R,icon:b,trailing:n?void 0:t.jsx("div",{className:"text-token-text-tertiary",children:d.formatMessage(ze.connect)})});return i=x?n?d.formatMessage(ze.autoConnectorDisabled):d.formatMessage(ze.autoConnected):i,t.jsx(t.Fragment,{children:(n||x&&_)&&i?t.jsx(dn,{label:i,side:"right",align:"center",contentClassName:"w-50",children:N}):N})},gf={box_sync_connector:"Box",dropbox_sync_connector:"Dropbox",github_sync_connector:"GitHub",gdrive_sync_connector:"Google Drive",notion_sync_connector:"Notion",slack_sync_connector:"Slack",sharepoint_sync_connector:"SharePoint",sharepoint_admin_sync_connector:"SharePoint",linear_sync_connector:"Linear",confluence_sync_connector:"Confluence"},xf=({connector:s,connectorLinks:e,selectedMCPSources:n,toggleSource:i,systemHintType:r,disabled:a=!1})=>{var g;const c=Ie(),o=aa();if(!s.conformance.implements_retrievable&&r===W.Research)return null;const u=!!((g=e.get(s.id))==null?void 0:g[0]),m=n.has(s.id)&&u,_=s.name,y=t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"truncate",children:_}),t.jsx(pd,{connector:s})]}),x=t.jsx(Ns,{connector:s,size:"xsmall"});return t.jsx(t.Fragment,{children:u?t.jsx(ce.CheckboxItem,{icon:x,checked:m,label:y,disabled:a,onCheckedChange:()=>{i(s.id)}}):t.jsx(ce.Item,{onSelect:()=>{a||o({connectorId:s.id,redirectAfter:r?"/?system_hints=".concat(r):void 0,systemHintType:r,referrer:ra.SourcesDropdown})},icon:x,label:y,trailing:t.jsx("div",{className:"text-token-text-tertiary",children:c.formatMessage(ze.connect)}),disabled:a})})},Ga=({connection:s,refetch:e,location:n,isSelectedInSource:i,toggleSource:r,showDetails:a,disabled:c=!1,disabledText:o=""})=>{var Y;const d=Ie(),u=sa();bt();const[m,_]=h.useState(!1),[y,x]=h.useState(),g=()=>{r(s.user_connection_details.connection_type)},j=s.user_connection_details.connection_instance_id,b=un(),R=sl(),N=s.user_connection_details.knowledge_connector_type,D=N==="google_drive_oauth",f=h.useCallback(async()=>{try{_(!0),await tl({connectorType:N,connectionId:j,location:n,intl:d})}catch(I){I instanceof Error?b.danger(I.message,{toastId:"sources_dropdown_oauth_error"}):b.danger({defaultMessage:"Encountered an error connecting your account. Please try again later.",description:"Error message shown when a user tries to link their account but it fails."},{toastId:"sources_dropdown_oauth_error"})}finally{_(!1),e==null||e()}},[j,N,d,n,e,b]),[E,M]=h.useState(!1),p=()=>D?M(!0):f(),A=s.user_connection_details.activation_status==="inactive"&&s.user_connection_details.auth_status==="not_connected",H=["activating","partially_activated"].includes(s.user_connection_details.activation_status),V=A&&!R||H,L=t.jsx("img",{src:u&&s.connection_display_info.icon_dark_url?s.connection_display_info.icon_dark_url:(Y=s.connection_display_info.icon_url)!=null?Y:"",alt:s.connection_display_info.display_name,className:"icon"}),z=I=>{if(I.stopPropagation(),I.preventDefault(),A){p();return}if(H){x(s);return}},F={key:s.connection_display_info.display_name,disabled:c,icon:L,label:yt(s),secondary:a?t.jsx("div",{className:"truncate",children:s.connection_display_info.display_name}):void 0};let v=null;switch(s.user_connection_details.activation_status){case"activated":v=t.jsx(ce.CheckboxItem,os(fe({},F),{checked:i,onCheckedChange:g}));break;case"partially_activated":v=t.jsx(ce.CheckboxItem,os(fe({},F),{checked:i,onCheckedChange:g,secondary:t.jsx("div",{className:"group-radix-disabled:opacity-50 flex items-center gap-1.5",children:t.jsx(cl,{className:"flex-row-reverse",connection:s})})}));break;case"activating":v=t.jsx(ce.Item,os(fe({},F),{style:{cursor:V?void 0:"default"},onSelect:z,trailing:t.jsx("div",{className:"group-radix-disabled:opacity-50",children:t.jsx(ll,{connection:s})})}));break;case"inactive":v=t.jsx(ce.Item,os(fe({},F),{style:{cursor:V?void 0:"default"},onSelect:z,trailing:t.jsx("div",{className:"group-radix-disabled:opacity-50",children:m?t.jsx(rl,{className:"icon"}):t.jsx(il,{connection:s,refetch:e,location:"user_dropdown"})})}));break}return t.jsxs(t.Fragment,{children:[y&&t.jsx(ud,{connection:y,onClose:()=>x(void 0)}),E&&t.jsx(nl,{isAdminFlow:!1,onClose:()=>M(!1),connectionId:j,location:n,onSuccess:e}),c&&o?t.jsx(dn,{label:o,side:"right",align:"center",contentClassName:"w-50",children:v}):v]})},bf=({clientThreadId:s,githubSyncConnection:e,githubAccessConnector:n,connectorLink:i,selectedSources:r,toggleSource:a,systemHintType:c,refetch:o,contentRef:d})=>{var M,p;const u=Ie(),m=al("installations/select_target"),_=ea(),x=Ge(s,A=>A==null?void 0:A.startedWithByoMcp)===!0,{data:g,isLoading:j}=md({linkId:(M=i==null?void 0:i.id)!=null?M:""}),b=!!g,R=i==null?void 0:i.id,N=!!R&&!b;if(!n&&!e)return null;const D=A=>{const H=A==="github_sync_connector",V=A===Ee.GITHUB_CONNECTOR;if((H||V)&&n&&e){const L=r==null?void 0:r.has("github_sync_connector"),z=r==null?void 0:r.has(Ee.GITHUB_CONNECTOR);L===z&&a(H?Ee.GITHUB_CONNECTOR:"github_sync_connector")}a(A)},f=n?t.jsx(Ns,{connector:n,size:"xsmall"}):e?t.jsx("img",{src:(p=e.connection_display_info.icon_url)!=null?p:"",alt:e.connection_display_info.display_name,className:"icon"}):null,E=n?n.name:e?yt(e):"";if(N&&!j)return t.jsx(ce.Item,{label:E,icon:f,onSelect:()=>{window.open(m,"_blank")},trailing:t.jsx("div",{className:"text-token-text-tertiary",children:u.formatMessage(ze.finishSetup)})});if(e&&(es(e)||!n)){const A=r.has("github_sync_connector");return t.jsxs(t.Fragment,{children:[t.jsx(Ga,{connection:e,refetch:o,location:"user_dropdown",isSelectedInSource:A,toggleSource:D,showDetails:!1,disabled:j,disabledText:""},e.user_connection_details.connection_instance_id),A&&_&&t.jsx(Bo,{clientThreadId:s,allowSelectAllRepos:!1,githubSyncEnabled:!0,linkId:R,syncConnectionId:e.user_connection_details.connection_instance_id,contentRef:d})]})}else if(n){const A=r.has(Ee.GITHUB_CONNECTOR);return t.jsxs(t.Fragment,{children:[t.jsx(Ua,{connector:n,connectorLink:i,disabled:x,disabledText:"",hasBetaTag:!1,isSelectedInSource:A,systemHintType:c,toggleSource:D}),A&&!0&&t.jsx(Bo,{clientThreadId:s,linkId:i==null?void 0:i.id,allowSelectAllRepos:!1,githubSyncEnabled:!1,contentRef:d})]})}return null},ze=_t({contactAdmin:{id:"JGCH/x",defaultMessage:"Contact your admin to enable Google Drive for chat"},allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},finishSetup:{id:"j12ad3",defaultMessage:"Finish Setup"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},cloudBrowser:{id:"RA2J7e",defaultMessage:"Use cloud browser"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"},autoConnected:{id:"7IJBNd",defaultMessage:"This connector is searched automatically"},autoConnectorDisabled:{id:"KJQcAS",defaultMessage:"To enable this connector, toggle off all custom connectors"},auto:{id:"uW03xX",defaultMessage:"Auto"}});function _f(s){return s!=="web"&&s!=="cloud"}function Sf(s){return!!s}function yf(s){return!!s}function Af(s){return s.name}function Cf(s,e){return s.name.localeCompare(e.name)}function wf(s){return t.jsx("div",{className:"icon flex items-center justify-center",children:s.icon},s.name)}function kf({activeSystemHint:s,clientThreadId:e,connectionStatuses:n,currentModelConfig:i}){Te();const r=na(),a=gt(),{availableConnectors:c,isLoading:o,enabled:d}=ul(),{availableConnectors:u,enabled:m,isLoading:_}=dl({includeDisabledByAdmin:!0,includeAutoConnectors:(s==null?void 0:s.systemHint)===W.Slurm,filterDisabledAutoConnectors:(s==null?void 0:s.systemHint)===W.Slurm}),{availableConnectors:y,enabled:x,isLoading:g}=gd({includeDisabledByAdmin:!0}),{connectorConfigMap:j}=xd({clientThreadId:e}),b=ta(),R=(s==null?void 0:s.systemHint)===W.ApiTool,N=(s==null?void 0:s.systemHint)===W.Slurm&&(n&&n.length>0||m&&u.length>0),{selectedSources:D=new Set,selectedMCPSources:f=new Set,addSource:E,deleteSource:M,toggleSource:p}=Ba(e,N&&(s==null?void 0:s.systemHint)===W.Slurm),A=(s==null?void 0:s.systemHint)===W.Research,H=Ra(i==null?void 0:i.id,s==null?void 0:s.systemHint);if(d&&A)return t.jsx(lt,{clientThreadId:e,selectedSources:D,selectedMCPSources:f,addSource:E,deleteSource:M,toggleSource:p,isLoading:o,enabledConnectors:c,fetchValidLinksOnly:!0,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ut,{selectedSources:D,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!0})});if(N){const V=a!=null&&a.isPersonalAccount()?r:!0;return t.jsx(lt,{clientThreadId:e,selectedSources:D,selectedMCPSources:f,addSource:E,deleteSource:M,toggleSource:p,isLoading:_,enabledConnectors:y,includeWebSearch:!1,includeSyncConnectors:V,connectorConfigMap:j,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ut,{selectedSources:D,selectedMCPSources:f,includeSyncConnectors:V,includeWebSearch:!1})})}if(R){const V=b.availableConnectors.filter(L=>L.connector_type==="MCP");return t.jsx(lt,{clientThreadId:e,selectedSources:D,selectedMCPSources:f,addSource:E,deleteSource:M,toggleSource:p,isLoading:b.isLoading,enabledConnectors:V,includeWebSearch:!1,includeSyncConnectors:!1,connectorConfigMap:j,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ut,{selectedSources:D,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!1,isDeveloperMode:!0})})}if(x&&H){const V=ia();return t.jsx(lt,{clientThreadId:e,selectedSources:D,selectedMCPSources:f,addSource:E,deleteSource:M,toggleSource:p,isLoading:g,enabledConnectors:y,fetchValidLinksOnly:!0,systemHintType:s==null?void 0:s.systemHint,includeCloudBrowser:V,trigger:t.jsx(ut,{selectedSources:D,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!0})})}return null}const jf=({clientThreadId:s,composerController:e,pendingFiles:n,hasFiles:i,placeholder:r,isTemporaryChat:a,state:c,inputState:o,disableReason:d,currentModelConfig:u,gizmoId:m,replyRegions:_,includeSidebarContextTray:y,onSubmit:x,leadingAction:g,legacyFooterActions:j,activeSystemHint:b,activeConnectorSystemHints:R,hideSystemHint:N=!1,isSystemHintLocked:D,onRemoveSystemHint:f,onRemoveModel:E,contextualAnswerUserConnectionData:M,fileInput:p,expanded:A,expandOnMultilineInput:H,layoutMode:V})=>{"use forget";const L=Te(),z=Fs(Os),F=$o(),v=Ge(s,Ne.getIsNewConversation),Y=bt(),{showSelectedModelInComposer:I,showThinkingEffortPicker:ee,fontSize:J}=mn(),re=la(),{composerThinkingEffort$:xe,setThinkingEffort:he}=ca(e),de=Be(xe),se=(u==null?void 0:u.id)===ua&&de&&ee&&(b==null?void 0:b.systemHint)!==W.Agent&&(b==null?void 0:b.systemHint)!==W.Research,[B,w]=Be(()=>{var G;if(!u||!I&&!se)return[null];const{data:k}=Jo(L);if((k==null?void 0:k.defaultModelSlug)===u.id)return[null];const te=k==null?void 0:k.categories.find(Q=>{var ie;return Q.defaultModel===u.id||((ie=Q.supportedModels)==null?void 0:ie.includes(u.id))});if(te)return[(G=te.actionPillShortName)!=null?G:te.label];const ne=k==null?void 0:k.groups.find(Q=>Q.modelIds.includes(u.id));return ne?[ne.label,u.title]:[u.title]}),O=Be(va(e).isWhisperActive$),K=Na(k=>k.selectedApps),U=Da(),P=i||U,X=Be(()=>(ml()||z)&&!tn(e));return t.jsxs(bd,{isTemporaryChat:a,isDeveloperMode:F,isNewConversation:v,composerController:e,expanded:A,expandOnMultilineInput:H,onSubmit:x,backgroundClassName:ye(z&&"text-sm shadow-none! dark:border-token-border-heavy border-t border-gray-100 rounded-none"),children:[t.jsx(_d,{children:O?t.jsx("div",{className:"max-w-full min-w-0 flex-1",children:t.jsx(Sd,{composerController:e,className:"h-14"})}):t.jsx(yd,{composerController:e,placeholder:r,fontSize:J})}),p&&t.jsx(Ad,{children:p}),_&&_.length>0&&t.jsx(zt,{children:t.jsx(Cd,{replyRegions:_})}),P&&t.jsx(zt,{children:t.jsx(wd,{files:n,selectedApps:K,activeSystemHintType:b==null?void 0:b.systemHint,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),y&&t.jsx(zt,{children:t.jsx(kd,{})}),g&&t.jsx(jd,{children:g}),j==null?void 0:j.map((k,te)=>t.jsx(qt,{children:k},"legacy-footer-action-".concat(te))),se&&B?t.jsx(Vt,{children:t.jsx(Pd,{thinkingEffort:de,onChangeThinkingEffort:k=>{he(k),re.mutate({model_slug:u.id,thinking_effort:k})},modelLabel:B,modelSlug:u.id,onRemoveModel:E,onCloseAutoFocus:k=>{da(L).composer.autofocusDisabled$()||(k.preventDefault(),$e(_e(e)))}})},"effort-selector"):I&&B?t.jsx(Vt,{children:t.jsx(Td,{label:B,tooltipLabel:w,onRemoveModel:E})},"active-model-pill"):null,(b!=null?b:Y)&&!N&&t.jsx(Vt,{children:t.jsx(Ed,{clientThreadId:s,activeSystemHint:b,activeSystemHintType:Y,activeConnectorSystemHints:R!=null?R:[],locked:D,onRemoveSystemHint:f})},"active-hint-tag"),b&&u&&t.jsxs(qt,{children:[t.jsx(kf,{activeSystemHint:b!=null?b:void 0,clientThreadId:s,connectionStatuses:M==null?void 0:M.connection_statuses,currentModelConfig:u}),(b==null?void 0:b.systemHint)===W.Agent&&pl(L)&&t.jsx(Md,{clientThreadId:s,activeSystemHintType:b.systemHint,layoutMode:V})]},"sources-tag"),(b==null?void 0:b.systemHint)===W.PictureV2&&t.jsx(qt,{children:t.jsx(Bd,{composerController:e})},"image-style-picker"),t.jsxs(Rd,{children:[!X&&!0&&t.jsx(vd,{composerController:e,composerType:"composer-btn"}),!O&&t.jsx(Nd,{inputState:o,state:c,onSubmit:x,composerController:e,clientThreadId:s,gizmoId:m,disableReason:d})]})]})},Pf=ln(()=>cn(()=>import("./oxo0r33hqmhdtptf.js"),__vite__mapDeps([8,1,2,3,4,5,9])).then(s=>s.GithubOnboardingModal)),Tf=()=>null,Ef=3e3,Mf=()=>{};function Xf({onCreateNewCompletion:s,onContinueGenerating:e,account:n,currentModelId:i,currentModelConfig:r,disableDraftPersistence:a=!1,areModelsLoading:c,clientThreadId:o,isNewThread:d,isCompletionInProgress:u,disabled:m=!1,disabledReason:_,canPause:y=!1,canContinue:x=!1,isInteractableSharedThread:g,headerClassName:j,hideHeader:b,onlyAllowImageUploads:R,layoutMode:N,modelsData:D}){"use forget";var so,to,no,oo,ao,ro,io,lo,co;Ro.markStart("PromptTextarea"),Ro.markRendered("PromptTextarea");const f=Te(),[E,M]=_c(),p=Ho();Dd(p),Fd();const A=an(),H=n==null?void 0:n.isTeam(),V=n==null?void 0:n.isEnterprisey(),L=n==null?void 0:n.isBusiness(),z=n==null?void 0:n.isEdu(),F=mt(f),v=Ie(),Y=un(),I=Vo(),ee=Od.useStore(),J=Ut(l=>l.files.map(S=>S.fileId).filter(S=>S!=null)),re=!!(H||V||L||z),[xe,he,de,se,B,w,O]=Ge(o,l=>{var S,q,ae,we,Ce;return[Ne.getCurrentLeafId(l),Ne.getRequestId(l),Ne.findAsyncTaskMetadataNode(l),Ne.getIsNewConversation(l),(ae=(q=(S=Ne.lastUserMessage(l))==null?void 0:S.metadata)==null?void 0:q.system_hints)==null?void 0:ae.includes(W.Agent),!!(l!=null&&l.interruptionInProgress)&&!!((Ce=(we=Ne.getCurrentNode(l))==null?void 0:we.message.metadata)!=null&&Ce.n7jupd_message),l==null?void 0:l.startedWithByoMcp]}),{gizmoEditorData:K,mode:U,getGizmoId:P}=fl(),X=hl(),k=gl(),te=xl(),ne=Xo(o),G=!!bl(),Q=Ld.useIsEnabled(o),ie=!!xt(),T=bt(),$=_l(),oe=Sl(),me=ja(),Ae=h.useCallback(()=>{me==="show"&&_s(f,({onClose:l})=>t.jsx(Pa,{clientThreadId:o,onClose:l,source:"composer_system_hint"}))},[me,f,o]),Me=h.useCallback(l=>{l!==null&&(yl(l)?oe(l,{analyticsMetadata:{clientThreadId:o}}):$(l,{analyticsMetadata:{clientThreadId:o}}),l===W.Agent&&Ae())},[$,o,Ae,oe]),je=ya(),Re=ss(as.hasSeenAgentModeAnnouncementBanner),[is,ys]=Fs(l=>[Al(l),Os(l)]),Wa=Cl(f),Ha=wl(f),za=zo(),Ye=!Ha&&!is&&!za&&kl(f).getLayer("3081064739").get("composer-plus-menu",!1),qa=po.useStore(),At=po.useState(({locked:l})=>l),Va=jl(),hn=Pl(),{connectionInstanceData:gn,isLoading:$a}=pn({skip:!Va}),{selectedSources:ls,selectedMCPSources:Fe,addSource:Ct}=Ba(o);h.useEffect(()=>{const l=E.get("add_source");l&&T&&(Ct(l),E.delete("add_source"),M(E))},[T,Ct,E,M]);const{eligible:xn,isLoading:bn}=ss(as.hasSeenTatertotNux);h.useEffect(()=>{T===W.Tatertot&&We(f,"1586944302")&&xn&&!bn&&_s(f,Id)},[T,xn,bn,f]);const _n=Ud(f);Tl({skip:!_n,productSku:sn.PROMPT_TEXT_AREA});const{platformConnectors:wt}=El(_n&&((so=Fe==null?void 0:Fe.size)!=null?so:0)>0,sn.PROMPT_TEXT_AREA),{allAutoConnectors:Ya}=fn({getDisabledAutoConnectors:!1});Ml({platformConnectors:wt,enabled:Ya.length>0&&re});const Sn=h.useMemo(()=>Array.from(Fe!=null?Fe:[]).map(l=>wt.get(l)).filter(l=>l!==void 0),[Fe,wt]),kt=h.useRef(0),jt=Ue(f,"3396794266").get("restore_prompt_on_stop",!1),Us=h.useRef(null),[pe,qe,Je,As]=Rf(o),Ja=Bl(),cs=(to=qe==null?void 0:qe.gizmo.id)!=null?to:Ja,yn=Rl(cs),Ka=Gd(),Pt=Wd(o),us=fo(r,pe,T),Cs=vl(),Xa=Cs!=null,Gs=Nl(f).flags,Ws=Gs==null?void 0:Gs.includes(Dl.NoAuthEnableFileUploads),{systemHints:Qa}=Fl(),Za=!We(f,"3084799213"),er=se||(B!=null?B:!1)||Za,sr=!At&&(pe==null||(pe==null?void 0:pe.kind)===pt.PrimaryAssistant||(pe==null?void 0:pe.kind)===pt.GizmoInteraction&&yn),Z=vf(sr,Qa,r,pe,k,er),ws=Z==null||Z.length>0,be=h.useMemo(()=>{var l;return(l=T&&(Z==null?void 0:Z.find(S=>S.systemHint===T)))!=null?l:null},[Z,T]),ks=Ol(),tr=h.useMemo(()=>{var l;return(l=Z==null?void 0:Z.filter(S=>ks.has(S.systemHint)))!=null?l:[]},[Z,ks]),Tt=h.useCallback(()=>{$(null,{analyticsMetadata:{clientThreadId:o}})},[$,o]),An=Ll(),ds=Nf(D),Cn=la(),Hs=h.useCallback((l,S)=>{Se.logEventWithStatsig("Model Switcher Model Changed","chatgpt_model_switcher_model_changed",{from:i,to:l}),We(f,"1333611684")?Cn.mutate({model_slug:l}):Il(f,l),An({modelId:l,location:S}),ho(o)},[i,An,f,Cn,o]),wn=h.useCallback(l=>{go()&&(l==null||l.preventDefault()),Hs(ds!=null?ds:"","remove non-default model")},[Hs,ds]),zs=Ra(i,(no=be==null?void 0:be.systemHint)!=null?no:null),nr=!m&&(us!==Rs.None||c)&&(F||Ws),Oe=Ul(r,pe),qs=Gl(r,pe),Ke=Ut(l=>U==="magic"?l.files.filter(S=>S.gizmoId!=null):l.files.filter(S=>S.gizmoId==null),Zo),[Et]=h.useState(()=>Hd()),or=zd(),kn=Ke.length>0||or,jn=Ut(Wl.hasUploadInProgress),ar=Na(l=>l.selectedApps),rr=Da(),ir=qd(o),lr=h.useMemo(()=>ft(()=>Ym(r,gc(p))),[r,p]),Mt=Be(lr),Vs=Be(()=>tn(p)),Pn=!Vs,$s=!Mt&&!jn&&(Pn||kn),{composerThinkingEffort$:cr}=ca(p),Tn=(us===Rs.Multimodal?Hl:zl)-Ke.length,En=Tn<=0,ur=(be==null?void 0:be.systemHint)===W.Research,dr=We(f,"3544641259"),{selectedRepos:Bt}=Vd(o),Mn=(ur||zs)&&dr&&(ls==null?void 0:ls.size)===0&&(Fe==null?void 0:Fe.size)===0,Bn=(oo=de==null?void 0:de.message.metadata)==null?void 0:oo.async_task_id,Xe=$d(l=>Bn?l.tasks[Bn]:null),Ys=(Xe==null?void 0:Xe.status)===Yd.RUNNING&&!Pt,Rn=(ro=Jd((ao=at(o))!=null?ao:o))==null?void 0:ro.value,mr=Rn===xo.STREAMING,vn=Rn===xo.REALTIME,Js=u&&y||mr||vn||Ys,Ks=$s&&!m&&!ie&&(!Js||Pt)&&!Mn,{targetedContent:Xs,setTargetedContent:Qs}=Kd(),le=Xs!=null&&Xs.isFocusedViewContent&&!te?void 0:Xs,js=da(f);h.useEffect(()=>{!le||js.composer.autofocusDisabled$()||requestAnimationFrame(()=>requestAnimationFrame(()=>{$e(_e(p))}))},[le,js,p]);const{getUpsellLabelType:pr,getUpsellShowsAttach:fr}=Xd(),Nn=mn(),{isSingleLine:Qe,plusButtonAddsFiles:hr,loggedOutAttachLabel:gr,loggedOutHideToolButtons:Dn,fullyCollapsedToolMenu:xr,showSlashHint:br,showSelectedModelInComposer:_r,showModelsInPlusMenu:Sr}=Nn,Rt=xr&&!Ye,yr=Sr&&!Ye,Ar=ws&&F&&(!H||!$a)&&!bo(T)&&!Qe,Ps=Be(va(p).isWhisperActive$);h.useCallback(()=>{M(l=>(l.delete("share_prompt"),l))},[M]),h.useCallback(l=>{if(Ve(o,S=>{S.isUsingPromptTemplate=!0}),rt(_e(p),l.prompt),l.system_hint){const S=l.system_hint;if($(S),l.sources){const q=l.sources.map(Ce=>Ce.trim()).filter(Zt),ae=new Set(q.filter(Ce=>!gs(Ce))),we=new Set(q.filter(gs));Ve(o,Ce=>{Ce.selectedSources=new Map([[S,ae]]),Ce.selectedMCPSources=new Map([[S,we]]),Ce.hasModifiedSources=!0})}}},[o,p,$]),Mf(f,E.get("share_prompt")),h.useEffect(()=>{if(!(A!=null&&A.id))return;const l=vo.getAndReset(A.id,ne);l&&rt(_e(p),l.inputText)},[A==null?void 0:A.id,ne,p]),h.useEffect(()=>{var S;const l=(S=E.get("prompt"))!=null?S:"";tn(p)&&l.length>0&&rt(_e(p),l)},[p,E]);const vt=h.useCallback(()=>{T!==W.Slurm&&T!=null&&!(Z!=null&&Z.some(l=>l.systemHint===W.Slurm))||(be==null&&$(W.Slurm),Ve(o,l=>{var q,ae;const S=(ae=(q=l.selectedSources)==null?void 0:q.get(W.Slurm))!=null?ae:new Set;l.selectedSources==null&&(l.selectedSources=new Map),l.selectedSources.set(W.Slurm,new Set([...S,Ee.GITHUB_CONNECTOR]))}))},[T,be,o,$,Z]);h.useEffect(()=>{if(E.has("github_onboarding")){const l=E.get("github_onboarding");let S=Bs.ConfigureRepos;l&&[Bs.ConfigureRepos,Bs.SyncRepos,Bs.IndexRepos].includes(l)&&(S=l),hn&&S!==Bs.ConfigureRepos?vt():_s(f,Pf,{initialState:S,onFinishFlow:vt}),M(q=>(q.delete("github_onboarding"),q))}},[E,M,f,T,be,o,$,Z,vt,hn]),h.useEffect(()=>{const l=ql(E),S=T!=null?T:l[0],q=S===W.Slurm,ae=S===W.Research;if(!q&&!ae)return;const we=E.getAll("sources");if(!we.length)return;const Ce=E.get("redirect_source"),hs=we.map(ge=>ge.trim()).filter(Zt),ke=new Set(hs.filter(ge=>!gs(ge))),ns=new Set(hs.filter(gs));Ve(o,ge=>{ge.selectedSources=new Map([[S,ke]]),ge.selectedMCPSources=new Map([[S,ns]]),ge.hasModifiedSources=!0}),M(ge=>(ge.delete("sources"),ge)),Ce==="suggested_ca_prompts"&&Se.logEventWithStatsig("chatgpt_contextual_answers_connector_activated","chatgpt_contextual_answers_connector_activated",{source:"suggested_ca_prompts"})},[o,Ct,E,$,M,T]);const Le=Vl(r,pe),Nt=Be($l(f,o)),{handleFileAccepted:Fn}=op(v,fo(r,pe,T),Oe,"mouse",P,Le==null?void 0:Le.attachments,Nt),Cr=h.useCallback((l,S)=>{const q=it(f);return q.keepSheetOpen$.set(!1),q.isSheetOpen$.set(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{$e(_e(p))})}),Fn(l,S)},[p,Fn,f]),ve=!m&&!En&&nr&&Cs==null,{getInputProps:wr,open:On}=tp(fe({disabled:!ve,noClick:!0,onFileDialogCancel:()=>{it(f).keepSheetOpen$.set(!1)},onDropAccepted:Cr,onDropRejected:l=>{ap(l,v,Y,us),it(f).keepSheetOpen$.set(!1)},multiple:!0,maxSize:Jl,maxFiles:Tn},Yl(!F||R?Oe:qs))),Ze=h.useCallback(()=>{ve&&(Se.logEventWithStatsig("Open File Viewer","chatgpt_web_file_viewer_opened",{intent:us.toString()}),On())},[ve,On,us]),Ln=Kl(Et),In=h.useCallback(()=>{Xl(_e(p)),Ln.clearMessages(),No(p).resetData();for(const l of Ke)Ms.remove(I,l.tempId,"none");Qd.markAllAsSent()},[p,Ln,Ke,I]),kr=h.useMemo(()=>{if(ys)return Zd;if(is)return em;if(ia())return sm},[ys,is]),Un=Be(()=>ys&&Wa&&_o.sidebarUrlTrayOpen$());tm();const jr=Ql(),Gn=$t((l,S)=>{var ns;if(l.preventDefault(),m||!$s&&!S||!pe||w)return;const q=So(_e(p).state.doc),ae=q.content;Ts==="streaming"&&(Se.logEventWithStatsig("chatgpt_web_conversation_stream_interrupted","chatgpt_web_conversation_stream_interrupted",{interrupted_message_length:ae.length}),Gt.count(Wt.DEFAULT,"chatgpt_web_conversation_stream_interrupted",[])),Gt.count(Wt.DEFAULT,"chatgpt_web_conversation_completion_sent",[]);const{content:we,attachments:Ce}=nm(I,ae,r,pe,T);Ve(o,ge=>{ge.hasModifiedSources=!1,ge.hasModifiedGithubRepos=!1,ge.startedWithByoMcp===void 0&&(ge.startedWithByoMcp=Sn.some(Ot=>Ot.status==="ONLY_ME"))}),Ka();const hs=Do.getState().attachedTempTextdocs;jt?Us.current={content:q.content,files:Ke.map(ge=>fe({},ge)),attachedTempTextdocs:Object.fromEntries(Object.entries(hs).map(([ge,Ot])=>[ge,fe({},Ot)])),systemHintType:T!=null?T:null,selectedSources:ls?[...ls]:void 0,selectedMCPSources:Fe?[...Fe]:void 0}:Us.current=null;const ke=i===ua?Zl(cr):void 0;s(fe({clientThreadId:o,ctx:f,sourceEvent:l,attachments:Ce,content:we,contentToSend:q,conversationMode:pe,hasSelectedApps:rr,isMessageFollowupsEnabled:Q,selectedApps:ar,desktopOrigin:kr,shouldCollectSidebarContext:Un,desktopSidebarContext:_o.context$(),selectedGizmoTag:Je,selectedRepos:{selectedAllRepos:Bt.selectedAllRepos,selectedRepos:Bt.selectedRepos?[...Bt.selectedRepos]:null},selectedSources:ls,selectedMCPConnectors:Sn,startedWithByoMcp:O===!0,systemHints:ec(qa),isN7jupdActive:zs,isForceAllowCustomMcpModeEnabled:jr,thinkingEffort:ke},No(p).getData(q.content))),(ns=le==null?void 0:le.onCreateCompletion)==null||ns.call(le,{serverThreadId:ne,currentLeafId:xe}),(le==null?void 0:le.shouldPersistAcrossMessages)!==!0&&Qs(void 0),yo.hideThreadHeader();for(const ge of Ke)ge.status===sc.Ready&&ee.addFile(ge);In(),je&&T===Qt&&Re.markAsViewed()}),Pr=l=>{Qs(l.targetedReply),l.targetedReply&&Se.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:ne,sourceMessageId:l.messageId})},{maybeSetWaitingForRealtimeOnAbort:Wn,isWatingForRealtimeStatusChange:Tr}=om(o),Dt=h.useCallback((l,S="other")=>{Wn(),am(l,void 0,{clientInitiated:!0,reason:S,isLastTurnAgent:B,hasAgentSystemHint:T===Qt})},[Wn,B,T]),Hn=h.useCallback(()=>{var l;(l=le==null?void 0:le.onCleared)==null||l.call(le,{serverThreadId:ne,currentLeafId:xe}),Qs(void 0),$e(_e(p))},[xe,ne,le,Qs,p]),Zs=tc(r==null?void 0:r.tags,pe==null?void 0:pe.kind),{autocompletions$:Er,shouldShowAutocomplete$:et}=ha(p),Mr=h.useCallback(()=>et()&&d,[et,d]),zn=$t(l=>rm(l,{toaster:Y,canSubmit:Ks,isTextContentTooLong:Mt,requestCompletion:Gn})),Br=Ys||vn,qn=$t(l=>im(l,{canAbortCompletion:y&&u&&!Br,clientThreadId:o,isAutocompletionActive:Mr,clearAutocompletions:()=>Er.set([]),abortCompletion:()=>Dt(o,"escape_key"),isEmpty:Vs,hasTargetedContent:le!=null,clearTargetedContent:Hn,hasSystemHint:be!=null,removeSystemHint:Tt,hasSelectedTarget:Je!=null,removeSelectedTarget:()=>As(null),hasNonDefaultModel:_r&&i!==ds,removeNonDefaultModel:wn}));h.useEffect(()=>{if(!Ks)return;We(f,"4178431533")||lm(!0).then(S=>{cm.startEnforcement(S),um.startEnforcement(S)})},[Ks,f]),h.useEffect(()=>nc(_e(p),{Enter:zn,Escape:qn}),[p,zn,qn]);const Rr=l=>{Um({filePickerStore:I,event:l.nativeEvent,intl:v,toaster:Y,clientThreadId:o,conversationMode:pe,currentModelConfig:r,getEditorGizmoId:P,modelSupportedImageMimeTypes:Oe,activeSystemHintType:T,ctx:f,contextScopes:Nt})},vr=oc(o,Et,Oe,Le==null?void 0:Le.attachments),Nr=h.useCallback((l,S)=>{l.preventDefault(),Dt(o,S),Se.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:at(o),currentLeafId:Ne.getCurrentNode(en(o)).message.id,eventSource:"mouse"});const q=Us.current;jt&&q&&(rt(_e(p),q.content),Ms.restoreFiles(I,q.files),Do.setState({attachedTempTextdocs:q.attachedTempTextdocs}),q.systemHintType&&($(q.systemHintType),Ve(o,ae=>{var we,Ce;q.selectedSources&&(ae.selectedSources=(we=ae.selectedSources)!=null?we:new Map,ae.selectedSources.set(q.systemHintType,new Set(q.selectedSources))),q.selectedMCPSources&&(ae.selectedMCPSources=(Ce=ae.selectedMCPSources)!=null?Ce:new Map,ae.selectedMCPSources.set(q.systemHintType,new Set(q.selectedMCPSources)))})),Us.current=null),dm()},[o,Dt,p,I,$,jt]),Vn=h.useCallback(()=>{vo.set(A==null?void 0:A.id,ne,mm(p))},[ne,A==null?void 0:A.id,p]),$n=K!=null;h.useEffect(()=>{$n||js.composer.autofocusDisabled$()||$e(_e(p))},[p,$n,js]);const Yn=dt(Ke);h.useEffect(()=>{var S;if(Oe.length>0)for(const q of Yn.current)pm((S=q.fileSpec)==null?void 0:S.mimeType,qs)||Ms.remove(I,q.tempId,"none");else Ms.reset(I)},[i,I,qs,Oe.length,Yn]),h.useEffect(()=>{(!Zs&&Je||G)&&As(null)},[Zs,Je,G,As]);const Dr=Ue(f,"4031588851"),Jn=Ue(f,"3637408529"),Fr=Jn.get("is_in_composer_text_exp",!1),Or=Jn.get("composer_text","MESSAGE_CHATGPT"),Lr=Dr.get("composer_text","MESSAGE_CHATGPT"),Ir=Fr?Or:Lr,[st,Ur]=(()=>{const l=_?fm(_):void 0;if(l)return[l.placeholder,l.isLastingDisabledStyle];if(g)return[Pe.placeholderWithName,!1];if((le==null?void 0:le.placeholderTextOverride)!=null)return[le.placeholderTextOverride,!1];if((r==null?void 0:r.id)===ac)return[Pe.n7jupdSystemHintPlaceholder,!1];if(be){if(bo(be.systemHint))return Js?[Pe.n7jupdActivePlaceholder,!1]:[Pe.n7jupdSystemHintPlaceholder,!1];switch(be.systemHint){case W.Search:return[Pe.searchPlaceholder,!1];case W.Think:return[Pe.thinkPlaceholder,!1];case W.Slurm:return[Pe.connectorPlaceholder,!1];case W.ApiTool:return[Pe.apiToolPlaceholder,!1];case W.Research:return[Pe.researchPlaceholder,!1];case W.Canvas:return[Pe.canvasPlaceholder,!1];case W.Picture:return[Pe.picturePlaceholder,!1];case W.PictureV2:return[Pe.pictureV2Placeholder,!1];case W.Tatertot:return[Pe.tatertotPlaceholder,!1]}}switch(Ir){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Pe.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Pe.placeholderAskNameAnythingVariant,!1];default:return[Pe.placeholderWithName,!1]}})(),Gr=(()=>{var l,S;return yn?d?v.formatMessage(hm.newChatInProject,{projectName:(l=qe==null?void 0:qe.gizmo.display.name)!=null?l:"this project"}):st?v.formatMessage(st,{name:"ChatGPT"}):"â€‹":st?v.formatMessage(st,{name:K!=null?U==="magic"?rc:K.name||"GPT":(S=qe==null?void 0:qe.gizmo.display.name)!=null?S:"ChatGPT"}):"â€‹"})();h.useEffect(()=>Ao(()=>wo(p),()=>{kt.current=performance.now(),xc.getState().isThreadHeaderVisible&&yo.hideThreadHeader(),Jm(o)&&Km(o)}));const{shouldHighlight$:Wr}=gm(p),tt=Be(()=>Wr()),{connectorConfig:ms,isLoading:Hr}=ic(),{onSelectConnector:nt}=xm({connectorConfig:ms,modelSupportedImageMimeTypes:Oe,modelAcceptedMimeTypes:qs,attachmentsProductFeature:Le==null?void 0:Le.attachments,onOauthRedirect:Vn});bm(ms,nt);let Kn=null;const Xn=fr(),zr=F||Xn||Ws,{showRecentFilesDropdown:qr}=_m(f,!0),ps=us===Rs.None&&!c?Yt.ModelNotSupported:En?Yt.HasReachedMaxFiles:Cs!=null?Yt.RateLimitReached:void 0,Vr=t.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:t.jsx(mf,{clientThreadId:o,modelSupportedImageMimeTypes:Oe,openFileDialog:Ze,historyDisabled:k,highlightTooltip:tt,isLoadingConnectors:Hr,connectorConfig:ms,onSelectConnector:nt,showLabel:pr()==="all"&&(mt(f)||gr),showUpsell:Xn&&!Ws,showMenuForNoAuth:Ws,isDisabled:!ve||Ps,disabledReason:ps,currentModelName:(io=r==null?void 0:r.title)!=null?io:"",visualTreatment:F?"composer-btn":"legacy"})},"file-upload-button");h.useEffect(()=>lc(f).addAction({key:"uploadFile",action:Ze,actionMessageDescriptor:Aa(f,v,!ve,ps,r==null?void 0:r.title),group:ym.Chat,keyboardBinding:Sm}),[f,r,ps,v,ve,Ze]);const $r=Ue(f,"853191128"),Yr=!F&&We(f,"3259514411")&&$r.get("is_tatertot_enabled",!1),Qn=Oe.length>0,Ft=Ge(o,Ne.getSteeringAsyncTaskId);if(Qe&&!Ft){const S=!Ye&&ws&&((lo=Z==null?void 0:Z.length)!=null?lo:0)>5,q=Array.from(ms.values()).some(ke=>ke.access_token!=null),ae=F&&ve&&Ye&&q?t.jsx(ce.Group,{children:t.jsx(Fo,{includeAction:!0,shortName:!0,connectorConfig:ms,onConnectorClick:nt})},"connect-apps"):null,we=[Rt&&F&&(ws||ae)?t.jsxs(Gm,{layoutMode:N,children:[t.jsx(ce.Group,{children:t.jsx(Jt,{systemHints:Z,activeConnectorSystemHintTypes:ks,selectedHintType:T,onSelectHintType:Me})}),ae]},"tools-menu"):null,yr?t.jsx(Wm,{layoutMode:N,selectedModelId:i!=null?i:"",onSelectModelId:ke=>{Hs(ke,"plus menu")}},"models-menu"):null].filter(ke=>ke!=null),Ce=Z&&(S?Z.slice(0,4):Z),hs=[t.jsxs(ce.Group,{className:"content-sheet:content-sheet-inset-section",children:[t.jsx(Am,{openFileDialog:Ze,modelSupportsImages:Qn,mode:Ye?"sheet":void 0,showMenuForNoAuth:!1,isDisabled:!ve,disabledReason:ps,currentModelName:r==null?void 0:r.title,rateLimitInfo:Cs}),F&&t.jsxs(t.Fragment,{children:[ve&&Qn&&t.jsx(Cm,{modelSupportedImageMimeTypes:Oe}),!Ye&&ve&&t.jsx(Fo,{includeAction:!0,shortName:!0,connectorConfig:ms,onConnectorClick:nt}),qr&&t.jsx(wm,{attachedFileIds:J,onAttachLibraryFile:ke=>Ms.attachLibraryFile(I,ke)}),t.jsx(km,{}),t.jsx(Yp,{modelSupportedImageMimeTypes:Oe})]})]},"add-files"),(!Rt||!F)&&ws?t.jsxs(ce.Group,{children:[t.jsx(Jt,{systemHints:Ce,activeConnectorSystemHintTypes:ks,selectedHintType:T,onSelectHintType:Me}),S&&t.jsxs(jm,{layoutMode:N,children:[t.jsx(ce.Group,{children:t.jsx(Jt,{systemHints:Z==null?void 0:Z.slice(4),activeConnectorSystemHintTypes:ks,selectedHintType:T,onSelectHintType:Me})}),ae]})]},"system-hints"):null,(!Rt||!F)&&ae&&(!S||!ws||Ye)?ae:null,we.length>0?t.jsx(ce.Group,{children:we},"submenus"):null,F?null:t.jsx(Pm,{},"upsell"),br?t.jsx(ce.Group,{children:t.jsx("div",{className:"text-token-text-tertiary p-2 text-center text-sm",children:v.formatMessage({id:"composer.plusMenu.typeSlashForQuickAccess",defaultMessage:"Type '/' for quick access"})})},"slash-hint"):null].filter(ke=>ke!=null);Kn=hr?t.jsx(Oo,{disabled:m,clientThreadId:o,rateLimitPopup:Cs,highlightTooltip:tt,label:F?v.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):v.formatMessage({id:"composer.plusMenu.label.loggedOut.photosOnly",defaultMessage:"Add photos"}),children:t.jsx(Tm,{onClick:Ze,disabled:Ps})}):t.jsx(Em,{mode:Ye?"sheet":"dropdown",onCloseAutoFocus:ke=>{js.composer.autofocusDisabled$()||(ke.preventDefault(),$e(_e(p)))},items:hs,fileUploadRateLimited:Xa,children:t.jsx(Oo,{disabled:m,clientThreadId:o,rateLimitPopup:null,highlightTooltip:tt,label:F?v.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):v.formatMessage({id:"composer.plusMenu.label.loggedOut",defaultMessage:"Add photos and more"}),secondaryLabel:t.jsx("kbd",{className:"bg-token-bg-tertiary -me-1 inline-grid aspect-square w-4 items-center justify-center rounded-sm text-[11px]",children:t.jsx("span",{children:"/"})}),children:t.jsx(Mm,{onDoubleClick:ve?Ze:void 0,onPointerDown:ke=>{if(!go())return;const ns=Bm(f);ns.isKeyboardOpen()&&(ke.preventDefault(),ns.closeKeyboard(()=>{it(f).isSheetOpen$.set(!0)}))},disabled:Ps})})})}const[Jr,Zn]=h.useState(!1),Kr=Ur||Tr?"disabled":"default",Xr=!Ks,Qr=Lm({promptDisabledReason:_,hasPendingFiles:jn,hasTextContent:Pn,isTextContentTooLong:Mt,hasAsyncTaskPending:ir,noSourceSelectedDr:!Mn,isDeepResearchTaskStreaming:Ys,isThreadHardBlocked:ie}),Ts=Js?"streaming":Xr?"disabled":"idle",Es=h.useRef(null),fs=h.useRef(null),Zr=We(f,"222560275")||i&&!i.startsWith("o1")&&!i.startsWith("o3");h.useEffect(()=>{const l=()=>{Es.current!=null&&Co.addAction("composer_state_disabled",{threadId:at(o),disabledReason:Es.current})};if($s&&Ts==="disabled"){let S="unknown";m?S=_!=null?_:"component_disabled_unknown":u?S="completion_in_progress":ie&&(S="thread_hard_blocked"),Es.current!==S&&(fs.current&&clearTimeout(fs.current),fs.current=setTimeout(l,Ef)),Es.current=S}else Es.current=null;return()=>{fs.current&&(clearTimeout(fs.current),fs.current=null)}},[o,$s,Ts,m,_,u,ie]);const eo=[le!=null&&le.label?{type:le.type,value:le.label,onRemoveRegion:Hn}:null,Je!=null?{type:"mention",value:Je.gizmo.display.name,icon:t.jsx(ka,{isFirstParty:!!((co=Je.gizmo.tags)!=null&&co.includes(Ko.FirstParty)),src:Je.gizmo.display.profile_picture_url,className:"icon"}),onRemoveRegion:()=>{As(null),$e(_e(p))}}:null].filter(l=>l!=null);Ft&&Xe&&Xe.taskId===Ft&&eo.push({type:"text",value:Xe.title,onRemoveRegion:()=>ho(o)});const ei=h.useMemo(()=>ft(()=>d&&(be==null?void 0:be.systemHint)!==W.Research&&(be==null?void 0:be.systemHint)!==W.ApiTool&&!zs&&et()),[d,be,zs,et]),si=l=>{if(l.preventDefault(),l.stopPropagation(),kt.current>0){const S=performance.now()-kt.current;Gt.hist(Wt.DEFAULT,"final_user_input_to_submit_ms",[],S)}Ts==="streaming"&&(!Pt||Vs)?Ys?Zn(!0):Nr(l,Vs?"stop_button":"stop_button_with_prompt"):Gn(l)};h.useEffect(()=>{const l=at(o),S=n==null?void 0:n.normalizedAccountUserId;if(!S||a||ys||k)return;const q=cc(ae=>{if(uc(ae.doc))dc(l);else{const we=So(ae.doc).content;mc(l,we,S)}},1e3);return Ao(()=>wo(p),q)},[n,o,p,a,ys,k,ne]),h.useEffect(()=>{setTimeout(()=>{Co.addFirstTiming("composer.ttfi")},0)},[]);const ti=t.jsx(Wp,{canUseInlineTagging:Zs,isDisabled:m,clientThreadId:o,currentLeafId:xe,currentRequestId:he,canContinue:x,composerController:p,isNewThread:d,onContinueGenerating:l=>{var S;return e({event:l,conversationMode:(S=en(o))==null?void 0:S.mode,systemHints:T?[T]:[]})},onResetState:In,openFileDialog:Ze,conversationMode:pe}),ni=!Js&&pe!=null&&Zr&&Rm.includes(pe.kind)&&t.jsx(vm,{clientThreadId:o,onTargetedReply:Pr}),oi=t.jsx(Hm,{composerController:p,parsedDocumentHandler:vr}),ai=!b&&t.jsx(Ep,{className:j}),ri=t.jsx(Nm,{modelSupportedImageMimeTypes:Oe,uploadType:Rs.Multimodal,attachmentsProductFeature:Le==null?void 0:Le.attachments,contextScopes:Nt}),ii=We(f,"3127600850"),li=[!Qe&&zr?Vr:null,!F&&!Qe&&!Dn?t.jsx(zm,{account:n,clientBootstrapFlags:Gs,features:X,currentModelConfig:r,isDisabled:Ps,clientThreadId:o,composerController:p,gizmoId:cs}):Ar?t.jsx(qm,{activeSystemHintType:T,systemHints:Z,composerController:p,clientThreadId:o,disabled:Ps}):null,!F&&!Qe&&!Dn&&Yr?t.jsx(Vm,{composerController:p,clientThreadId:o}):null].filter(l=>l!=null);return t.jsxs(Dm.Provider,{value:Et,children:[t.jsxs("div",{className:ye("pointer-events-auto relative z-1 flex h-[var(--composer-container-height,100%)] max-w-full flex-[var(--composer-container-flex,1)] flex-col"),onPaste:Rr,children:[t.jsx(Fm,{onOauthRedirect:Vn}),ii&&t.jsx(Tf,{}),ai,Xe&&Jr&&t.jsx(Om,{taskId:Xe.taskId,clientThreadId:o,onClose:()=>Zn(!1)}),t.jsx(jf,{hasFiles:kn,pendingFiles:Ke,isUploadDisabled:!ve,clientThreadId:o,highlightUploadTooltip:tt,disableReason:Qr,uploadButtonDisabledReason:ps,currentModelConfig:r,conversationMode:pe,state:Ts,inputState:Kr,gizmoId:cs,includeSidebarContextTray:Un,isTemporaryChat:k,placeholder:Gr,composerController:p,onSubmit:si,replyRegions:eo,leadingAction:Kn,legacyFooterActions:li,activeSystemHint:be,activeConnectorSystemHints:tr,hideSystemHint:At||!F&&!Qe,isSystemHintLocked:At,onRemoveSystemHint:Tt,onRemoveModel:wn,contextualAnswerUserConnectionData:gn,fileInput:t.jsx("input",fe({},wr())),expanded:Qe?void 0:!0,expandOnMultilineInput:Qe,layoutMode:N}),t.jsx(sf,{systemHints:Z!=null?Z:[],availableSystemHints:Z!=null?Z:[],composerController:p,clientThreadId:o,layoutMode:N,composerLayer:Nn,canUseInlineTagging:Zs,isFileUploadEnabled:ve,fileUploadDisabledReason:ps,currentModelConfig:r!=null?r:null,openFileDialog:Ze,connectionInstanceData:gn,setActiveSystemHintType:$,defaultModelId:ds,selectModelId:Hs,gizmoId:cs!=null?cs:null,hasGizmoFeatureRateLimit:G,setSelectedGizmoTag:As}),!1,t.jsx(Im,{canShowAutocomplete$:ei,layoutMode:N,composerController:p,clientThreadId:o})]}),oi,ti,ni,ri,T&&Z&&t.jsx(Bf,{availableSystemHints:Z,systemHintType:T,onRemoveSystemHint:Tt})]})}const Bf=({availableSystemHints:s,systemHintType:e,onRemoveSystemHint:n})=>{const i=s!=null&&!fc(e)&&s.every(u=>u.systemHint!==e),{externalModelsLoading:r,fullModelsLoading:a}=hc(),{isBlocked:c}=Ta(e),o=Te(),d=!mt(o);return h.useEffect(()=>{r||a||(i||c)&&!d&&n()},[i,c,d,n,e,r,a]),null};function Rf(s){"use forget";const e=ts.c(7),[n,i]=h.useState(null),r=Sa(s);let a,c;e[0]!==r||e[1]!==n?(c=n!=null?{gizmo:n,gizmo_id:n.gizmo.id,kind:pt.GizmoInteraction}:r,e[0]=r,e[1]=n,e[2]=c):c=e[2],a=c;const o=a,d=o&&"gizmo"in o&&o.gizmo!=null?o==null?void 0:o.gizmo:void 0;let u;return e[3]!==o||e[4]!==d||e[5]!==n?(u=[o,d,n,i],e[3]=o,e[4]=d,e[5]=n,e[6]=u):u=e[6],u}function vf(s,e,n,i,r,a){"use forget";var d;const c=ts.c(7);let o;e:{if(!s){let m;c[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],c[0]=m):m=c[0],o=m;break e}let u;c[1]!==a||c[2]!==i||c[3]!==n||c[4]!==r||c[5]!==e?(u=(d=e==null?void 0:e.filter(m=>$m({systemHint:m,modelConfig:n,conversationMode:i,isTemporaryChat:r})))==null?void 0:d.filter(m=>m.systemHint!==W.Agent?!0:a),c[1]=a,c[2]=i,c[3]=n,c[4]=r,c[5]=e,c[6]=u):u=c[6],o=u}return o}function Nf(s){"use forget";var e,n;return(n=(e=pc(s))==null?void 0:e.id)!=null?n:null}export{Kf as D,Jf as M,Xf as P,Pp as S,Yf as T,Ep as a,cp as b,$f as c,Vf as d,xp as u};
//# sourceMappingURL=gyvvad7btmtz1x9o.js.map

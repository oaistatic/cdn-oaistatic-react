import{i as h,a9 as C,t as i,aG as m,kN as n}from"./lef5ym39glv4981l.js";import{g as l,C as g}from"./eyi9jrf1bwm7dn6f.js";import{g as f}from"./jj85rqzpbnvv3emr.js";const E="3950229590",k="enabled_custom_checkout_for_plus",T="enabled_custom_checkout_for_go",O="enabled_custom_checkout_for_pro",U="enabled_custom_checkout_for_team",d="enabled_custom_checkout_for_quorum",N="enable_flush_statsig_on_checkout",r="chatgpt_web_checkout_navigate_to_checkout",w="chatgpt_web_checkout_prepare_checkout_session";function b(_){switch(_){case n.PLUS:return k;case n.GO:return T;case n.PRO:return O;case n.SELF_SERVE_BUSINESS:return U;case n.QUORUM:return d;default:return null}}function A(_,a){const c=b(a);return c==null?"redirect":C(_,E).get(c,!1)?"custom":"redirect"}function v(){const _=f(),a=h();async function c(e=1e3){const t=m(a);await Promise.race([t.flush(),new Promise(o=>setTimeout(o,e))])}async function s(e,t){return e.checkout_ui_mode=(t==null?void 0:t.fromiOSWebview)===!0?"redirect":A(a,e.plan_name),i(a,{eventName:w,metadata:{ui_mode:e.checkout_ui_mode}}),await g.getCheckoutLink(e,{skipSentinelCheckout:t==null?void 0:t.skipSentinelCheckout,fromiOSWebview:t==null?void 0:t.fromiOSWebview})}async function u(e){const t=C(a,E).get(N,!1);if("tag"in e)switch(i(a,{eventName:r,metadata:{tag:e.tag}}),t&&await c(),e.tag){case"hosted_checkout_session":case"redirect_to_portal":{window.location.href=e.url;break}case"custom_checkout_session":{const o=e.processor_entity,S=e.checkout_session_id;await _({pathname:l(o,S),search:"",hash:""});break}}else if(e.url)i(a,{eventName:r,metadata:{tag:"missing_tag"}}),t&&await c(),window.location.href=e.url;else throw new Error("Received invalid response from /checkout")}return{prepareCheckoutSession:s,navigateToCheckout:u}}export{v as u};
//# sourceMappingURL=mueia064md5nlhd6.js.map

var At=Object.defineProperty,xt=Object.defineProperties;var Rt=Object.getOwnPropertyDescriptors;var Xe=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var je=(e,t,o)=>t in e?At(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ke=(e,t)=>{for(var o in t||(t={}))Mt.call(t,o)&&je(e,o,t[o]);if(Xe)for(var o of Xe(t))_t.call(t,o)&&je(e,o,t[o]);return e},He=(e,t)=>xt(e,Rt(t));import{h as It,r as oe,j as qe}from"./jj85rqzpbnvv3emr.js";import{V as Ct,A as Fe,a as xe,C as Ze,b as F,B as Lt,E as Ve,c as kt,S as Oe,u as Ht}from"./ih9wj2grf6eudhng.js";import{ax as De}from"./lef5ym39glv4981l.js";import{v2 as Ot,v3 as Dt}from"./mclphevd122040jw.js";import{w as Bt,p as Ke,c as ae,s as ne,a as q,h as Je,e as V,t as Re,b as ge,m as Be,d as Qe,f as X,g as et,i as Nt,j as Yt,k as Wt,l as ht,n as Me,o as $t,r as gt,q as Ft,u as Ut,v as zt}from"./f8qcx5r3ombc6w5p.js";function Gt(e){return e.innerRadius}function Xt(e){return e.outerRadius}function jt(e){return e.startAngle}function qt(e){return e.endAngle}function Zt(e){return e&&e.padAngle}function Vt(e,t,o,n,r,c,f,i){var s=o-e,a=n-t,l=f-r,g=i-c,d=g*s-l*a;if(!(d*d<V))return d=(l*(t-c)-g*(e-r))/d,[e+d*s,t+d*a]}function Pe(e,t,o,n,r,c,f){var i=e-o,s=t-n,a=(f?c:-c)/ge(i*i+s*s),l=a*s,g=-a*i,d=e+l,u=t+g,y=o+l,m=n+g,p=(d+y)/2,h=(u+m)/2,T=y-d,b=m-u,w=T*T+b*b,I=r-c,L=d*m-y*u,Y=(b<0?-1:1)*ge(Nt(0,I*I*w-L*L)),W=(L*b-T*Y)/w,$=(-L*T-b*Y)/w,U=(L*b+T*Y)/w,B=(-L*T+b*Y)/w,S=W-p,E=$-h,v=U-p,R=B-h;return S*S+E*E>v*v+R*R&&(W=U,$=B),{cx:W,cy:$,x01:-l,y01:-g,x11:W*(r/I-1),y11:$*(r/I-1)}}function Kt(){var e=Gt,t=Xt,o=q(0),n=null,r=jt,c=qt,f=Zt,i=null,s=Bt(a);function a(){var l,g,d=+e.apply(this,arguments),u=+t.apply(this,arguments),y=r.apply(this,arguments)-Je,m=c.apply(this,arguments)-Je,p=Qe(m-y),h=m>y;if(i||(i=l=s()),u<d&&(g=u,u=d,d=g),!(u>V))i.moveTo(0,0);else if(p>Re-V)i.moveTo(u*ae(y),u*ne(y)),i.arc(0,0,u,y,m,!h),d>V&&(i.moveTo(d*ae(m),d*ne(m)),i.arc(0,0,d,m,y,h));else{var T=y,b=m,w=y,I=m,L=p,Y=p,W=f.apply(this,arguments)/2,$=W>V&&(n?+n.apply(this,arguments):ge(d*d+u*u)),U=Be(Qe(u-d)/2,+o.apply(this,arguments)),B=U,S=U,E,v;if($>V){var R=et($/d*ne(W)),M=et($/u*ne(W));(L-=R*2)>V?(R*=h?1:-1,w+=R,I-=R):(L=0,w=I=(y+m)/2),(Y-=M*2)>V?(M*=h?1:-1,T+=M,b-=M):(Y=0,T=b=(y+m)/2)}var k=u*ae(T),C=u*ne(T),ee=d*ae(I),P=d*ne(I);if(U>V){var A=u*ae(b),_=u*ne(b),H=d*ae(w),z=d*ne(w),O;if(p<Ke)if(O=Vt(k,C,H,z,A,_,ee,P)){var G=k-O[0],D=C-O[1],Z=A-O[0],N=_-O[1],te=1/ne(Yt((G*Z+D*N)/(ge(G*G+D*D)*ge(Z*Z+N*N)))/2),K=ge(O[0]*O[0]+O[1]*O[1]);B=Be(U,(d-K)/(te-1)),S=Be(U,(u-K)/(te+1))}else B=S=0}Y>V?S>V?(E=Pe(H,z,k,C,u,S,h),v=Pe(A,_,ee,P,u,S,h),i.moveTo(E.cx+E.x01,E.cy+E.y01),S<U?i.arc(E.cx,E.cy,S,X(E.y01,E.x01),X(v.y01,v.x01),!h):(i.arc(E.cx,E.cy,S,X(E.y01,E.x01),X(E.y11,E.x11),!h),i.arc(0,0,u,X(E.cy+E.y11,E.cx+E.x11),X(v.cy+v.y11,v.cx+v.x11),!h),i.arc(v.cx,v.cy,S,X(v.y11,v.x11),X(v.y01,v.x01),!h))):(i.moveTo(k,C),i.arc(0,0,u,T,b,!h)):i.moveTo(k,C),!(d>V)||!(L>V)?i.lineTo(ee,P):B>V?(E=Pe(ee,P,A,_,d,-B,h),v=Pe(k,C,H,z,d,-B,h),i.lineTo(E.cx+E.x01,E.cy+E.y01),B<U?i.arc(E.cx,E.cy,B,X(E.y01,E.x01),X(v.y01,v.x01),!h):(i.arc(E.cx,E.cy,B,X(E.y01,E.x01),X(E.y11,E.x11),!h),i.arc(0,0,d,X(E.cy+E.y11,E.cx+E.x11),X(v.cy+v.y11,v.cx+v.x11),h),i.arc(v.cx,v.cy,B,X(v.y11,v.x11),X(v.y01,v.x01),!h))):i.arc(0,0,d,I,w,h)}if(i.closePath(),l)return i=null,l+""||null}return a.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,g=(+r.apply(this,arguments)+ +c.apply(this,arguments))/2-Ke/2;return[ae(g)*l,ne(g)*l]},a.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:q(+l),a):e},a.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:q(+l),a):t},a.cornerRadius=function(l){return arguments.length?(o=typeof l=="function"?l:q(+l),a):o},a.padRadius=function(l){return arguments.length?(n=l==null?null:typeof l=="function"?l:q(+l),a):n},a.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:q(+l),a):r},a.endAngle=function(l){return arguments.length?(c=typeof l=="function"?l:q(+l),a):c},a.padAngle=function(l){return arguments.length?(f=typeof l=="function"?l:q(+l),a):f},a.context=function(l){return arguments.length?(i=l==null?null:l,a):i},a}function Jt(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function Qt(e){return e}function en(){var e=Qt,t=Jt,o=null,n=q(0),r=q(Re),c=q(0);function f(i){var s,a=(i=Wt(i)).length,l,g,d=0,u=new Array(a),y=new Array(a),m=+n.apply(this,arguments),p=Math.min(Re,Math.max(-Re,r.apply(this,arguments)-m)),h,T=Math.min(Math.abs(p)/a,c.apply(this,arguments)),b=T*(p<0?-1:1),w;for(s=0;s<a;++s)(w=y[u[s]=s]=+e(i[s],s,i))>0&&(d+=w);for(t!=null?u.sort(function(I,L){return t(y[I],y[L])}):o!=null&&u.sort(function(I,L){return o(i[I],i[L])}),s=0,g=d?(p-a*b)/d:0;s<a;++s,m=h)l=u[s],w=y[l],h=m+(w>0?w*g:0)+b,y[l]={data:i[l],index:s,value:w,startAngle:m,endAngle:h,padAngle:T};return y}return f.value=function(i){return arguments.length?(e=typeof i=="function"?i:q(+i),f):e},f.sortValues=function(i){return arguments.length?(t=i,o=null,f):t},f.sort=function(i){return arguments.length?(o=i,t=null,f):o},f.startAngle=function(i){return arguments.length?(n=typeof i=="function"?i:q(+i),f):n},f.endAngle=function(i){return arguments.length?(r=typeof i=="function"?i:q(+i),f):r},f.padAngle=function(i){return arguments.length?(c=typeof i=="function"?i:q(+i),f):c},f}function dt(e,t){let o,n;for(const r of e)r!=null&&(o===void 0?r>=r&&(o=n=r):(o>r&&(o=r),n<r&&(n=r)));return[o,n]}function tn(e,t){let o=0;for(let n of e)(n=+n)&&(o+=n);return o}var Ne,tt;function nn(){if(tt)return Ne;tt=1;var e=Ot(),t=Dt(),o=t(function(n,r,c,f){e(n,r,c,f)});return Ne=o,Ne}var on=nn();const rn=It(on);function sn(e){switch(e){case"title":case"ctrTitle":return"titleStyle";case"body":case void 0:case"obj":case"content":case"subTitle":case"":return"bodyStyle";default:return"otherStyle"}}const x=1/9525;function an(e){return e.xEmu!==0||e.yEmu!==0||e.widthEmu!==0||e.heightEmu!==0}const yt=(e,...t)=>rn({},e,...t,(o,n)=>o||n);function ln(e,t,o){var y,m,p;const r=sn(e.placeholderType),c=o.useLayoutId,f=t.layouts.find(h=>h.id===c),i=(y=e.placeholderIndex)!=null?y:0,s=(m=e.textStyle)!=null?m:{anchor:xe.ANCHOR_TYPE_UNSPECIFIED,vertical:Ct.VERTICAL_TYPE_UNSPECIFIED,bold:!1,italic:!1,color:void 0,fontSize:1350,fill:void 0,alignment:Fe.ALIGNMENT_TYPE_UNSPECIFIED,underline:"none",bottomInset:0,leftInset:0,rightInset:0,topInset:0},a=(p=e.levelsStyles[0])==null?void 0:p.textStyle;let l,g,d;const u=f==null?void 0:f.elements.find(h=>{var T;return h.placeholderType===e.placeholderType&&((T=h.placeholderIndex)!=null?T:0)===i});if(u!=null&&u.textStyle&&(l=u.textStyle),u!=null&&u.levelsStyles){const T=u.levelsStyles[0];T&&(g=T.textStyle)}if((f==null?void 0:f.parentLayoutId)!==c){const h=t.layouts.find(T=>T.type==="master");if(r==="titleStyle"&&(h!=null&&h.titleLevelStyles)){const b=h.titleLevelStyles[0];b&&(d=b.textStyle)}else if(r==="bodyStyle"&&(h!=null&&h.bodyLevelStyles)){const b=h.bodyLevelStyles[0];b&&(d=b.textStyle)}else if(r==="otherStyle"&&(h!=null&&h.otherLevelStyles)){const b=h.otherLevelStyles[0];b&&(d=b.textStyle)}}return yt(s,a,l,g,d)}function he(e,t,o){return Math.min(Math.max(e,t),o)}function Ye(e){const t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function We(e){return e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055}function cn(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),r=parseInt(t.slice(4,6),16);return{r:o,g:n,b:r}}function nt(e,t,o){e/=255,t/=255,o/=255;const n=Math.max(e,t,o),r=Math.min(e,t,o);let c=0,f=0;const i=(n+r)/2;if(n!==r){const s=n-r;switch(f=i>.5?s/(2-n-r):s/(n+r),n){case e:c=(t-o)/s+(t<o?6:0);break;case t:c=(o-e)/s+2;break;case o:c=(e-t)/s+4;break}c/=6}return{h:c,s:f,l:i}}function ot(e,t,o){let n,r,c;if(t===0)n=r=c=o;else{const f=(a,l,g)=>(g<0&&(g+=1),g>1&&(g-=1),g<.16666666666666666?a+(l-a)*6*g:g<.5?l:g<.6666666666666666?a+(l-a)*(.6666666666666666-g)*6:a),i=o<.5?o*(1+t):o+t-o*t,s=2*o-i;n=f(s,i,e+1/3),r=f(s,i,e),c=f(s,i,e-1/3)}return[Math.round(n*255),Math.round(r*255),Math.round(c*255)]}function fn(e,t){if(!e)return"rgba(0,0,0,1)";const o=e.type===Ze.COLOR_TYPE_RGB?"#".concat(e.value):e.type===Ze.COLOR_TYPE_SCHEME&&t.colorMap[e.value]||"#000000";let{r:n,g:r,b:c}=cn(o),f=1;const i=e.transform;if(i){if(i.alpha&&(f=he(i.alpha/1e5,0,1)),i.satMod){const s=nt(n,r,c);s.s=he(s.s*(i.satMod/1e5),0,1),[n,r,c]=ot(s.h,s.s,s.l)}if(i.lumMod||i.lumOff){const s=nt(n,r,c);i.lumMod&&(s.l*=i.lumMod/1e5),i.lumOff&&(s.l+=i.lumOff/1e5),s.l=he(s.l,0,1),[n,r,c]=ot(s.h,s.s,s.l)}if(i.tint){const s=i.tint/1e5;n=Ye(n),r=Ye(r),c=Ye(c),n=n*s+1*(1-s),r=r*s+1*(1-s),c=c*s+1*(1-s),n=Math.round(We(n)*255),r=Math.round(We(r)*255),c=Math.round(We(c)*255)}i.shade&&(n*=1-i.shade/1e5,r*=1-i.shade/1e5,c*=1-i.shade/1e5)}return n=he(Math.round(n),0,255),r=he(Math.round(r),0,255),c=he(Math.round(c),0,255),"rgba(".concat(n,",").concat(r,",").concat(c,",").concat(f,")")}function Te(e,t,o){var n,r;return e?(r=(n=fn(e,t))!=null?n:o)!=null?r:"transparent":o!=null?o:"transparent"}function un(e){for(var t=e.length/6|0,o=new Array(t),n=0;n<t;)o[n]="#"+e.slice(n*6,++n*6);return o}const hn=un("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function be(e,t,o){var r;const n=o.useLayoutId;if(e.bbox&&an(e.bbox)&&t){const{xEmu:c,yEmu:f,widthEmu:i,heightEmu:s}=e.bbox;return{x:(c!=null?c:0)*x,y:(f!=null?f:0)*x,width:(i!=null?i:0)*x,height:(s!=null?s:0)*x}}if(e.placeholderIndex!==void 0){const c=(r=e.placeholderIndex)!=null?r:0,f=t.layouts.find(s=>s.id===n),i=f==null?void 0:f.elements.find(s=>{var a;return((a=s.placeholderIndex)!=null?a:0)===c});if(i!=null&&i.bbox){const{xEmu:s,yEmu:a,widthEmu:l,heightEmu:g}=i.bbox;return{x:(s!=null?s:0)*x,y:(a!=null?a:0)*x,width:(l!=null?l:0)*x,height:(g!=null?g:0)*x}}if((f==null?void 0:f.parentLayoutId)!==n){const s=t.layouts.find(l=>l.type==="master"),a=s==null?void 0:s.elements.find(l=>{var g;return((g=l.placeholderIndex)!=null?g:0)===c});if(a!=null&&a.bbox){const{xEmu:l,yEmu:g,widthEmu:d,heightEmu:u}=a.bbox;return{x:(l!=null?l:0)*x,y:(g!=null?g:0)*x,width:(d!=null?d:0)*x,height:(u!=null?u:0)*x}}}}return{x:0,y:0,width:0,height:0}}const le=14,Ee=1.05,it=.1*96,rt=.05*96;function mt(e){return e/100*(96/72)}function Ue(e,t,o,n,r,c,f){var L,Y,W,$,U,B;if(!e.paragraphs)return;let{x:i,y:s,width:a,height:l}=be(e,o,r);i+=it,s+=rt,a-=it*2,l-=rt*2;const g=ln(e,o,r),d=(Y=(L=n.colorMap)==null?void 0:L.tx1)!=null?Y:"#000000";function u(S,E,v,R,M,k){E.length!==0&&(S.push({segments:E.slice(),widthPx:v,heightPx:R,align:M,maxPx:k}),E.length=0)}function y(S,E){t.font=S;const v=new Float32Array(E.length+1);let R=0;v[0]=0;for(let M=0;M<E.length;M++){const k=E[M];k&&(R+=t.measureText(k).width,v[M+1]=R)}return v}const m=[];for(let S=0;S<e.paragraphs.length;S++){const E=e.paragraphs[S];if(!E)continue;const v=E.textStyle,R=[];let M=0,k="left",C=0;for(let P=0;P<E.runs.length;P++){const A=E.runs[P];if(!A)continue;const _=yt({},A.textStyle,v,g),H=_!=null&&_.fontSize?mt(_.fontSize):le*(96/72),z="Calibri, Carlito, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif",O=_!=null&&_.bold?"500":"normal",G=_!=null&&_.italic?"italic ":"",D="".concat(G).concat(O," ").concat(H,"px ").concat(z);t.font=D;const Z=Te((W=_==null?void 0:_.fill)==null?void 0:W.color,n,d);if(k=(_==null?void 0:_.alignment)===Fe.ALIGNMENT_TYPE_CENTER?"center":(_==null?void 0:_.alignment)===Fe.ALIGNMENT_TYPE_RIGHT?"right":"left",C=Math.max(C,H),!A.text||A.text.length===0){const K={text:"",widthPx:0,font:D,fill:Z,px:H,run:A,paraIndex:S,runIndex:P,charStart:0,charEnd:0,advance:new Float32Array(1)};R.push(K),C=Math.max(C,H);continue}let N=0;const te=A.text.split("\n");for(let K=0;K<te.length;K++){const fe=te[K];if(!fe)continue;const ue=Array.from(fe.matchAll(/(\s+|\S+)/g)).map(Q=>Q[0]);for(let Q=0;Q<ue.length;Q++){const ie=ue[Q];if(!ie)continue;let J=ie;const bt=/^\s+$/.test(ie);for(;J.length>0;){const _e=a-M;if(_e<=0&&R.length){const j=C||le*1.3333333333333333;u(m,R,M,j*Ee,k,j),M=0,C=0;continue}t.font=D;const Ie=t.measureText(J).width;if(Ie<=_e){const j=y(D,J),Pt={text:J,widthPx:Ie,font:D,fill:Z,px:H,run:A,paraIndex:S,runIndex:P,charStart:N,charEnd:N+J.length,advance:j};R.push(Pt),M+=Ie,C=Math.max(C,H),N+=J.length,J="";break}if(!bt&&M>0){const j=C||le*1.3333333333333333;u(m,R,M,j*Ee,k,j),M=0,C=0;continue}const Ce=y(D,J);let Se=0,Le=J.length;for(;Se<Le;){const j=Math.ceil((Se+Le)/2);Ce[j]&&Ce[j]<=_e?Se=j:Le=j-1}let me=Se;me===0&&(me=1);const pe=J.slice(0,me),Ge=Ce[me]||t.measureText(pe).width,St={text:pe,widthPx:Ge,font:D,fill:Z,px:H,run:A,paraIndex:S,runIndex:P,charStart:N,charEnd:N+pe.length,advance:y(D,pe)};if(R.push(St),M+=Ge,C=Math.max(C,H),N+=pe.length,J=J.slice(me),J.length>0){const j=C||le*1.3333333333333333;u(m,R,M,j*Ee,k,j),M=0,C=0}}}if(K<te.length-1){if(R.length===0){const ie={text:"",widthPx:0,font:D,fill:Z,px:H,run:A,paraIndex:S,runIndex:P,charStart:N,charEnd:N,advance:new Float32Array(1)};R.push(ie)}const Q=C||le*(96/72);u(m,R,M,Q*Ee,k,Q),M=0,C=0}}}const ee=C||le*(96/72);if(R.length===0){const P="Calibri, Carlito, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif",A=le*1.3333333333333333,z={text:"",widthPx:0,font:"".concat(A,"px ").concat(P),fill:d,px:A,run:{text:""},paraIndex:S,runIndex:0,charStart:0,charEnd:0,advance:new Float32Array(1)};R.push(z)}u(m,R,M,ee*Ee,k,ee)}if(!m.length)return;const p=($=g==null?void 0:g.anchor)!=null?$:xe.ANCHOR_TYPE_TOP,h=m.reduce((S,E)=>S+E.heightPx,0);let T=p===xe.ANCHOR_TYPE_BOTTOM?s+(l-h):p===xe.ANCHOR_TYPE_MIDDLE?s+(l-h)/2:s;T=Math.max(T,s);const b=(f==null?void 0:f.mode)==="layout";b||(t.textBaseline="top");const w=[];for(const S of m){let E=S.align==="center"?i+(a-S.widthPx)/2:S.align==="right"?i+a-S.widthPx:i;for(const v of S.segments){if(!b){t.font=v.font,t.fillStyle=v.fill;const R=S.maxPx-v.px;if((B=(U=v.run)==null?void 0:U.hyperlink)!=null&&B.uri){const M={x:E,y:T+(S.maxPx-v.px),width:v.widthPx,height:v.px,url:v.run.hyperlink.uri};w.push(M),c==null||c.push(M)}t.fillText(v.text,E,T+R)}E+=v.widthPx}T+=S.heightPx}const I=m.reduce((S,E)=>S+E.heightPx,0);return{x:i,y:T-I,width:a,height:I,lines:m.map(S=>({segments:S.segments,widthPx:S.widthPx,heightPx:S.heightPx,align:S.align,maxPx:S.maxPx,offsetPx:0})),linkRects:w}}function pt(e,t,o){if(e.measureText(t).width<=o)return t;const n="…";let r=0,c=t.length;for(;r<c;){const f=Math.ceil((r+c)/2);e.measureText(t.slice(0,f)+n).width<=o?r=f:c=f-1}return t.slice(0,r)+n}const se="Segoe UI, Helvetica, Arial, sans-serif",Et=10,gn=11,re=10,we="#666",st=hn,Tt=.6,ce={top:32,right:16,bottom:40,left:48},at=16,dn=$t({decimal:".",thousands:",",grouping:[3],currency:["","$"],percent:" %"});function yn(e,t,o,n){const r=be(e,o,n),c=Pn(e.chartReference,o);c&&wt(t,c,r)}function Gn(e,t,o,n={}){wt(e,t,o,n)}function mn(e){return{x:e.x+ce.left,y:e.y+ce.top,width:e.width-ce.left-ce.right,height:e.height-ce.top-ce.bottom}}function wt(e,t,o,n={}){var i,s;e.save(),t.title&&t.title.trim()&&(e.font="bold ".concat(at,"px ").concat(se),e.fillStyle=we,e.textAlign="center",e.textBaseline="top",e.fillText(t.title.trim(),o.x+o.width/2,o.y+(ce.top-at)/2));let r=mn(o);if((t.type===F.CHART_TYPE_BAR||t.type===F.CHART_TYPE_BAR_3D)&&t.barDirection===Lt.BAR_DIRECTION_BAR){const a=t.categories.length>0?t.categories:(s=(i=t.series[0])==null?void 0:i.categories)!=null?s:[];r=Mn(e,r,a,t.yAxis);const l=An(t,r);Rn(e,t,l,r),n.skipLegend||lt(e,t,o),xn(e,t,l),e.restore();return}const f=pn(t,r);switch(En(t.type)||Tn(e,t,f,r),n.skipLegend||lt(e,t,o),t.type){case F.CHART_TYPE_BAR:case F.CHART_TYPE_BAR_3D:wn(e,t,f);break;case F.CHART_TYPE_LINE:case F.CHART_TYPE_LINE_3D:vn(e,t,f);break;case F.CHART_TYPE_AREA:case F.CHART_TYPE_AREA_3D:bn(e,t,f);break;case F.CHART_TYPE_PIE:case F.CHART_TYPE_PIE_3D:case F.CHART_TYPE_DOUGHNUT:Sn(e,t,r);break}e.restore()}function ze(e){return typeof e.bandwidth=="function"}function pn(e,t){var a,l;const o=e.categories.length>0?e.categories:(l=(a=e.series[0])==null?void 0:a.categories)!=null?l:[],n=e.series.flatMap(g=>g.values),r=dt(n),[c,f]=r[0]===void 0?[0,0]:r,i=e.type===F.CHART_TYPE_LINE||e.type===F.CHART_TYPE_LINE_3D?Ft().domain(o).range([t.x,t.x+t.width]).padding(.5):Me().domain(o).range([t.x,t.x+t.width]).paddingInner(Tt),s=ht().domain([Math.min(0,c),f]).nice().range([t.y+t.height,t.y]);return{x:i,y:s}}function de(e,t){if(t!==void 0){if(ze(e)){const o=e(t);return o!==void 0?o+e.bandwidth()/2:void 0}return e(t)}}function En(e){return e===F.CHART_TYPE_PIE||e===F.CHART_TYPE_PIE_3D||e===F.CHART_TYPE_DOUGHNUT}function Tn(e,t,o,n){var d,u;const{x:r,y:c}=o,f=t.categories.length>0?t.categories:(u=(d=t.series[0])==null?void 0:d.categories)!=null?u:[];e.save(),e.font="".concat(Et,"px ").concat(se),e.fillStyle=we,e.strokeStyle=we,e.lineWidth=1;const{color:i,fontSize:s}=ve(t.xAxis),a=c(0);e.beginPath(),e.moveTo(n.x,a),e.lineTo(n.x+n.width,a),e.stroke(),e.strokeStyle=i,e.lineWidth=1,e.font="".concat(s,"px ").concat(se),e.textAlign="center",e.textBaseline="top",e.fillStyle=i,f.forEach(y=>{const m=de(r,y);if(m===void 0)return;e.beginPath(),e.moveTo(m,a),e.lineTo(m,a+4),e.stroke();const p=ze(r)?r.step():n.width/Math.max(1,f.length);e.fillText(pt(e,y,p),m,a+6)});const{color:l,fontSize:g}=ve(t.yAxis);e.textAlign="right",e.textBaseline="middle",e.fillStyle=l,c.ticks(5).forEach(y=>{const m=c(y);e.strokeStyle=l,e.beginPath(),e.moveTo(n.x,m),e.lineTo(n.x+n.width,m),e.stroke(),e.strokeStyle=l,e.beginPath(),e.moveTo(n.x-4,m),e.lineTo(n.x,m),e.stroke(),e.font="".concat(g,"px ").concat(se),e.fillText(Ut("~s")(y),n.x-6,m)}),e.restore()}function lt(e,t,o){if(t.series.length===0)return;e.save(),e.font="".concat(gn,"px ").concat(se);const n=t.series.map(l=>l.name||"Series"),r=n.map(l=>e.measureText(l).width),c=Math.max(...r,0),f=re+6+c+16,i=n.length*(re+4)+16-4,s=o.x+o.width-f,a=o.y+8;e.fillStyle="transparent",e.strokeStyle="transparent",e.lineWidth=1,e.beginPath(),e.rect(s,a,f,i),e.fill(),e.stroke(),t.series.forEach((l,g)=>{const d=l.name||"Series",u=a+8+g*(re+4)+re/2,y=ye(l,g);y&&(e.fillStyle=y),e.beginPath(),e.rect(s+8,u-re/2,re,re),e.fill(),e.strokeStyle="#000",e.stroke(),e.fillStyle=we,e.textAlign="left",e.textBaseline="middle",e.fillText(d,s+8+re+6,u)}),e.restore()}function ye(e,t){var o,n;return(n=(o=e.fill)==null?void 0:o.color)!=null&&n.value?"#".concat(e.fill.color.value):st[t%st.length]}function ve(e){var n,r,c,f;const t=(c=(r=(n=e==null?void 0:e.line)==null?void 0:n.fill)==null?void 0:r.color)!=null&&c.value?"#".concat(e.line.fill.color.value):we,o=(f=e==null?void 0:e.textStyle)!=null&&f.fontSize?mt(e.textStyle.fontSize):Et;return{color:t,fontSize:o}}function wn(e,t,o){var s,a;if(!ze(o.x))return;const n=o.x,r=o.y,c=t.categories.length>0?t.categories:(a=(s=t.series[0])==null?void 0:s.categories)!=null?a:[],f=t.series.length,i=Me().domain(gt(f)).range([0,n.bandwidth()]).padding(.05);c.forEach((l,g)=>{const d=n(l);d!==void 0&&t.series.forEach((u,y)=>{var w,I;const m=(w=u.values[g])!=null?w:0,p=d+((I=i(y))!=null?I:0),h=r(Math.max(0,m)),T=Math.abs(r(m)-r(0)),b=ye(u,y);b&&(e.fillStyle=b),e.beginPath(),e.rect(p,h,i.bandwidth(),T),e.fill()})})}function vn(e,t,o){var f,i;const n=o.x,r=o.y,c=t.categories.length>0?t.categories:(i=(f=t.series[0])==null?void 0:f.categories)!=null?i:[];t.series.forEach((s,a)=>{const l=ye(s,a);l&&(e.strokeStyle=l),e.lineWidth=2,e.beginPath(),s.values.forEach((g,d)=>{const u=de(n,c[d]),y=r(g);u!==void 0&&(d===0?e.moveTo(u,y):e.lineTo(u,y))}),e.stroke(),e.fillStyle=e.strokeStyle,s.values.forEach((g,d)=>{const u=de(n,c[d]),y=r(g);u!==void 0&&(e.beginPath(),e.arc(u,y,3,0,Math.PI*2),e.fill())})})}function bn(e,t,o){var f,i;const n=o.x,r=o.y,c=t.categories.length>0?t.categories:(i=(f=t.series[0])==null?void 0:f.categories)!=null?i:[];t.series.forEach((s,a)=>{const l=ye(s,a),g=(()=>{if(!l)return;const y=zt(l);return y?(y.opacity=.35,y.formatRgb()):l})();g&&(e.fillStyle=g),l&&(e.strokeStyle=l),e.lineWidth=1,e.beginPath(),s.values.forEach((y,m)=>{const p=de(n,c[m]),h=r(y);p!==void 0&&(m===0?e.moveTo(p,h):e.lineTo(p,h))});const d=de(n,c[c.length-1]),u=de(n,c[0]);d===void 0||u===void 0||(e.lineTo(d,r(0)),e.lineTo(u,r(0)),e.closePath(),e.fill(),e.stroke())})}function Sn(e,t,o){const n=t.series[0];if(!n)return;const r=n.values;if(tn(r)===0)return;const f=o.x+o.width/2,i=o.y+o.height/2,s=Math.min(o.width,o.height)/2,a=Kt().innerRadius(t.type===F.CHART_TYPE_DOUGHNUT?s*.55:0).outerRadius(s).context(e),l=en().sort(null);e.save(),e.translate(f,i),l(r).forEach((g,d)=>{const u=ye(n,d);u&&(e.fillStyle=u),e.beginPath(),a(g),e.fill(),e.strokeStyle="#fff",e.lineWidth=1,e.stroke()}),e.restore()}function Pn(e,t){var n;const o=e==null?void 0:e.id;return o&&(n=t.charts.find(r=>r.id===o))!=null?n:null}function An(e,t){var g,d,u,y;const o=e.categories.length>0?e.categories:(d=(g=e.series[0])==null?void 0:g.categories)!=null?d:[],[n,r]=dt(e.series.flatMap(m=>m.values)),c=(u=e.yAxis)==null?void 0:u.min,f=(y=e.yAxis)==null?void 0:y.max,i=c!==void 0?c:Math.min(0,n),s=f!==void 0?f:r,a=ht().domain([i,s]).range([t.x,t.x+t.width]);(c===void 0||f===void 0)&&a.nice();const l=Me().domain([...o].reverse()).range([t.y,t.y+t.height]).paddingInner(Tt);return{x:a,y:l}}function xn(e,t,o){var g,d;const{x:n,y:r}=o,[c,f]=n.domain(),i=c&&c>0?c:f&&f<0?f:0,s=t.categories.length?t.categories:(d=(g=t.series[0])==null?void 0:g.categories)!=null?d:[],a=t.series.length,l=Me().domain(gt(a)).range([0,r.bandwidth()]).padding(.05);s.forEach((u,y)=>{const m=r(u);m!==void 0&&t.series.forEach((p,h)=>{var W,$;const T=(W=p.values[y])!=null?W:0,b=m+(($=l(h))!=null?$:0),w=n(Math.min(i,T)),I=n(Math.max(i,T)),L=Math.abs(I-w),Y=ye(p,h);Y&&(e.fillStyle=Y),e.fillRect(w,b,L,l.bandwidth())})})}function Rn(e,t,o,n,r=!0){var m,p;const{x:c,y:f}=o,i=t.categories.length>0?t.categories:(p=(m=t.series[0])==null?void 0:m.categories)!=null?p:[];e.save(),e.lineWidth=1;const{color:s,fontSize:a}=ve(t.yAxis);e.font="".concat(a,"px ").concat(se),e.fillStyle=s,e.strokeStyle=s,e.textAlign="right",e.textBaseline="middle";const l=Math.min(140,Math.max(0,n.x-10));i.forEach(h=>{var w;const T=((w=f(h))!=null?w:0)+f.bandwidth()/2;e.beginPath(),e.moveTo(n.x-4,T),e.lineTo(n.x,T),e.stroke();const b=pt(e,h,l);e.fillText(b,n.x-6,T)});const{color:g,fontSize:d}=ve(t.xAxis);e.font="".concat(d,"px ").concat(se),e.fillStyle=g,e.strokeStyle=g,e.textAlign="center",e.textBaseline="top";const u=n.y+n.height;e.beginPath(),e.moveTo(n.x,u),e.lineTo(n.x+n.width,u),e.stroke();const y=dn.format(".2~f");c.ticks(5).forEach(h=>{const T=c(h);e.beginPath(),e.moveTo(T,u),e.lineTo(T,u+4),e.stroke(),r&&(e.save(),e.beginPath(),e.moveTo(T,n.y),e.lineTo(T,u),e.stroke(),e.restore()),e.fillText(y(h),T,u+6)}),e.restore()}function Mn(e,t,o,n,r=180,c=100){const{fontSize:f}=ve(n);e.save(),e.font="".concat(f,"px ").concat(se);const i=Math.max(...o.map(l=>e.measureText(l).width));e.restore();const s=Math.min(r,i+c);if(s<=t.x)return t;const a=s-t.x;return{x:t.x+a,y:t.y,width:Math.max(0,t.width-a),height:t.height}}const ct=1/x,_n=.05*96,ft=24,In=24,Cn=4,ut="rgba(13, 13, 13, 0.05)";function Ln(e,t,o,n,r){var W,$,U,B,S,E,v,R,M,k,C,ee;if(!e.table)return;const c=e.table.rows.length,f=e.table.rows.reduce((P,A)=>Math.max(P,A.cells.length),0),i=He(ke({},e.bbox),{heightEmu:($=(W=e.bbox)==null?void 0:W.heightEmu)!=null?$:In*c,widthEmu:(B=(U=e.bbox)==null?void 0:U.widthEmu)!=null?B:600,xEmu:(E=(S=e.bbox)==null?void 0:S.xEmu)!=null?E:0,yEmu:(R=(v=e.bbox)==null?void 0:v.yEmu)!=null?R:0});let s=e.table.columnWidths&&e.table.columnWidths.length>0?e.table.columnWidths:new Array(Math.max(0,f)).fill(1),a=s.reduce((P,A)=>P+A,0);if(a===0&&f>0&&(s=new Array(f).fill(1),a=f),a===0)return;const l=i.widthEmu/a,g=new Array(e.table.rows.length).fill(0);for(let P=0;P<e.table.rows.length;P++){const A=e.table.rows[P];if(!A)continue;if(A.heightEmu&&A.heightEmu>0){g[P]=A.heightEmu;continue}let _=0,H=0;for(let z=0;z<A.cells.length;z++){const O=s[z]*l,G=A.cells[z];if(!G)continue;const D={bbox:{xEmu:H,yEmu:0,widthEmu:O,heightEmu:1},paragraphs:G.paragraphs,textStyle:G.textStyle,levelsStyles:G.levelsStyles},Z=Ue(D,t,o,n,r,void 0,{mode:"layout"}),te=((M=Z==null?void 0:Z.height)!=null?M:ft)+_n*2;_=Math.max(_,te),H+=O}g[P]=Math.max(1,_*ct)}for(let P=0;P<e.table.rows.length;P++){const A=g[P];(!A||A<=0)&&(g[P]=Math.max(1,ft*ct))}const d=g.reduce((P,A)=>P+A,0);if(d===0)return;const u=e.table.rows.some(P=>!P.heightEmu||P.heightEmu<=0),y=!!((k=e.bbox)!=null&&k.heightEmu&&e.bbox.heightEmu>0),m=u?1:y?((C=e.bbox)==null?void 0:C.heightEmu)/d:1,p=i.xEmu*x,h=i.yEmu*x,T=i.widthEmu*x,b=d*m*x,w=Math.min(Cn,T/2,b/2);t.save(),t.beginPath(),t.moveTo(p+w,h),t.arcTo(p+T,h,p+T,h+w,w),t.arcTo(p+T,h+b,p+T-w,h+b,w),t.arcTo(p,h+b,p,h+b-w,w),t.arcTo(p,h,p+w,h,w),t.closePath(),t.clip();let I=i.yEmu;const L=[],Y=[];for(let P=0;P<e.table.rows.length;P++){const A=e.table.rows[P];if(!A)continue;const H=(g[P]||0)*m;let z=i.xEmu;for(let O=0;O<A.cells.length;O++){const G=A.cells[O];if(!G)continue;const D=s[O]*l,Z={bbox:{xEmu:z,yEmu:I,widthEmu:D,heightEmu:H},paragraphs:G.paragraphs,textStyle:G.textStyle,levelsStyles:G.levelsStyles},N=G.fill,te=(ee=N==null?void 0:N.color)!=null&&ee.value?"#".concat(N.color.value):"transparent",K=z*x,fe=I*x,ue=D*x,Q=H*x;t.fillStyle=te,t.fillRect(K,fe,ue,Q);const ie=Ue(Z,t,o,n,r);ie&&Y.push({row:P,col:O,block:ie}),t.strokeStyle=ut,t.strokeRect(K,fe,ue,Q),L.push({row:P,col:O,xPx:K,yPx:fe,widthPx:ue,heightPx:Q}),z+=D}I+=H}return t.restore(),t.beginPath(),t.moveTo(p+w,h),t.arcTo(p+T,h,p+T,h+w,w),t.arcTo(p+T,h+b,p+T-w,h+b,w),t.arcTo(p,h+b,p,h+b-w,w),t.arcTo(p,h,p+w,h,w),t.closePath(),t.strokeStyle=ut,t.lineWidth=1,t.stroke(),{cellRects:L,cellLayouts:Y}}const $e=new Map;let Ae=null;function kn(e,t,o){if(/\bwidth\s*=|\bheight\s*=/.test(e))return new Blob([e],{type:"image/svg+xml"});const n=e.replace(/<svg\b([^>]*)>/,'<svg$1 width="'.concat(t,'" height="').concat(o,'">'));return new Blob([n],{type:"image/svg+xml"})}async function vt(e){var n,r,c,f;if(!e.image)throw new Error("no image on element");const t="".concat(e.image.data.byteLength,"_").concat(e.image.contentType),o=$e.get(t);if(!o)if(e.image.contentType==="image/svg+xml"){const i=Math.round(((r=(n=e.bbox)==null?void 0:n.widthEmu)!=null?r:1)*x),s=Math.round(((f=(c=e.bbox)==null?void 0:c.heightEmu)!=null?f:1)*x),a=window.devicePixelRatio||1,l=kn(new TextDecoder().decode(e.image.data),i,s),g=URL.createObjectURL(l),d=new Image;d.src=g,await d.decode();const u=createImageBitmap(d,{resizeWidth:i*a,resizeHeight:s*a});return URL.revokeObjectURL(g),$e.set(t,u),u}else{const i=new Blob([e.image.data],{type:e.image.contentType}),s=createImageBitmap(i);return $e.set(t,s),s}return o}async function Hn(e,t,o,n){if(!e.image)return;const{x:r,y:c,width:f,height:i}=be(e,o,n),s=await vt(e);if(!s)return;let a=0,l=0,g=s.width,d=s.height;const u=e.image.mask;if(u){const y=h=>h/1e5,m=s.width,p=s.height;a+=y(u.cropLeft)*m,l+=y(u.cropTop)*p,g-=(y(u.cropLeft)+y(u.cropRight))*m,d-=(y(u.cropTop)+y(u.cropBottom))*p}t.drawImage(s,a,l,g,d,r,c,f,i)}function On(e){if(Ae)return Ae;if(!e)return{colorMap:{},lineStyleMap:{},effectMap:{}};const t={};if(e.colorScheme){for(const r of e.colorScheme.colors)r.color&&(t[r.name]=r.color.lastColor?"#".concat(r.color.lastColor):"#".concat(r.color.value));t.lt1&&(t.bg1=t.lt1),t.lt2&&(t.bg2=t.lt2)}const o={};for(const[r,c]of e.lineStyleList.entries())o[r+1]=c;const n={};for(const[r,c]of e.effectStyleList.entries())n[r+1]=c;return Ae={colorMap:t,lineStyleMap:o,effectMap:n},Ae}function Dn(e,t,o){var r,c,f,i;let n=e.background;if((r=n==null?void 0:n.fill)!=null&&r.color)return Te(n.fill.color,o);if(n||(n=(c=t.layouts.find(s=>s.id===e.useLayoutId))==null?void 0:c.background),(f=n==null?void 0:n.ref)!=null&&f.index){const s=n.ref.index-1001,a=(i=t.theme)==null?void 0:i.backgroundFillStyleList[s],l=a==null?void 0:a.color;if(l){const g=He(ke({},l),{value:n.ref.schemeColor});return Te(g,o)}}return o.colorMap.bg1}async function Bn(e,t,o,n){const r=On(t.theme),c=e.widthEmu*x,f=e.heightEmu*x;o.save();const i=Dn(e,t,r);o.fillStyle=i!=null?i:"transparent",o.fillRect(0,0,c,f);const s=[...e.elements].sort((a,l)=>{var g,d;return((g=a.zIndex)!=null?g:0)-((d=l.zIndex)!=null?d:0)});await Promise.all(s.filter(a=>a.image).map(a=>vt(a)));for(const a of s)if(a.image&&await Hn(a,o,t,e),a.type===Ve.ELEMENT_TYPE_CHART_REFERENCE&&yn(a,o,t,e),a.type===Ve.ELEMENT_TYPE_TABLE&&Ln(a,o,t,r,e),a.shape&&Nn(a,o,t,e,r),a.paragraphs&&a.paragraphs.length>0&&Ue(a,o,t,r,e,n),n&&a.hyperlink){const{x:l,y:g,width:d,height:u}=be(a,t,e);n.push({x:l,y:g,width:d,height:u,url:a.hyperlink.uri,action:a.hyperlink.action})}o.restore()}function Nn(e,t,o,n,r){var u,y,m;if(!e.shape)return;const{fill:c,line:f,geometry:i}=e.shape,{x:s,y:a,width:l,height:g}=be(e,o,n);let d=f!=null&&f.widthEmu?f.widthEmu*x:0;if(t.save(),t.fillStyle=(u=Te(c==null?void 0:c.color,r))!=null?u:"transparent",e.lineReference){const p=r.lineStyleMap[e.lineReference.index];t.strokeStyle="solid",d||(d=p!=null&&p.widthEmu?p.widthEmu*x:d)}if(e.effectReference){const p=r.effectMap[e.effectReference.index];p==null||p.effects.forEach(h=>{var T,b,w,I;if(h.type===kt.EFFECT_TYPE_OUTER_SHADOW){const L=(T=h.shadow)!=null&&T.color?Te(h.shadow.color,r):"transparent";t.shadowColor=L!=null?L:"transparent",t.shadowBlur=(b=h.shadow)!=null&&b.blurRadius?h.shadow.blurRadius*x:0,t.shadowOffsetX=(w=h.shadow)!=null&&w.distance?h.shadow.distance*x:0,t.shadowOffsetY=(I=h.shadow)!=null&&I.distance?h.shadow.distance*x:0}})}switch(t.beginPath(),i){case Oe.SHAPE_GEOMETRY_RECT:case Oe.SHAPE_GEOMETRY_ROUND_RECT:{g===0?(t.moveTo(s,a),t.lineTo(s+l,a)):l===0?(t.moveTo(s,a),t.lineTo(s,a+g)):t.rect(s,a,l,g);break}case Oe.SHAPE_GEOMETRY_ELLIPSE:{const p=l/2,h=g/2;t.ellipse(s+p,a+h,p,h,0,0,Math.PI*2);break}default:t.restore();return}t.fill(),t.restore(),t.strokeStyle=d&&((m=(y=f==null?void 0:f.fill)==null?void 0:y.color)!=null&&m.value)?"#".concat(f.fill.color.value):"transparent",t.lineWidth=d,d&&t.stroke(),t.restore()}function Xn({startIndex:e,walnutId:t,onExit:o}){const{presentationMap:n}=Ht(),r=n[t],{presentation:c}=r,[f,i]=oe.useState(e),s=oe.useRef(null),a=oe.useRef(null);oe.useEffect(()=>{var p;const y=a.current;if(!y)return;(p=y.requestFullscreen)==null||p.call(y).catch(h=>{De.addError(h)});const m=()=>{document.fullscreenElement||o()};return document.addEventListener("fullscreenchange",m),()=>{document.removeEventListener("fullscreenchange",m),document.fullscreenElement&&document.exitFullscreen().catch(h=>{De.addError(h)})}},[o]);const l=c?c.slides[f]:void 0;oe.useEffect(()=>{if(!c||!l||!s.current)return;const y=s.current.getContext("2d");if(!y)return;const m=l.widthEmu*x,p=l.heightEmu*x,h=window.devicePixelRatio||1;s.current.width=m*h,s.current.height=p*h,y.resetTransform(),y.scale(h,h),Bn(l,c,y)},[l,c]);const g=oe.useCallback(()=>{c&&i(y=>Math.min(y+1,c.slides.length-1))},[c]),d=oe.useCallback(()=>i(y=>Math.max(y-1,0)),[]),u=oe.useCallback(y=>{switch(y.key){case"ArrowRight":case"ArrowDown":case" ":case"Enter":g();break;case"ArrowLeft":case"ArrowUp":d();break;case"Escape":document.fullscreenElement?document.exitFullscreen().catch(m=>{De.addError(m)}):o();break}},[g,d,o]);return oe.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[u]),qe.jsx("div",{ref:a,className:"fixed inset-0 flex items-center justify-center p-6",onClick:g,children:qe.jsx("canvas",{ref:s,className:"max-h-full max-w-full bg-white"})})}export{x as E,Xn as S,Gn as a,un as c,Bn as d,be as g};
//# sourceMappingURL=jo2rzlevh0fbjyvo.js.map

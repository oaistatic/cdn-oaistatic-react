const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lixhsjk8741nqzx6.js","assets/jj85rqzpbnvv3emr.js","assets/lef5ym39glv4981l.js","assets/root-ogjlcpyy.css","assets/mclphevd122040jw.js","assets/conversation-small-g7l5datj.css","assets/kq1ir6pxp9hst9p9.js","assets/nfygy4vif6crzpny.js","assets/f3wj76d1ulqyss85.js","assets/g9xi6m5yzu4rtfn2.js","assets/ns51nblw8ziscsgd.js","assets/lbaueofbjv8jfqwm.js","assets/b2bzebhpy3vjflr5.js","assets/moqemqor8gto0ynb.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/hhs3uwxj7uii5eg7.js","assets/m1gt25yur8ncekq0.js","assets/erm6n5lmbxodgs50.js","assets/zta1pq4ds1hak11y.js","assets/iqw8c7pica2coyb9.js","assets/dl9z2ehd50icy9od.js","assets/g2yrrlnprx92uhjb.js","assets/gwaaxp36jr4o1a8o.js","assets/l66h8h301eaq59ck.js","assets/hzcock7l6ec8fnr2.js","assets/fue7kd61xxcv74sk.js","assets/ng0sx063g0r0whhb.js","assets/fvmxudg74tbhlabl.js","assets/hnotrmacgvnfyexv.js","assets/irqko7c1s7qpl41n.js","assets/bx2wdn43543b9ysc.js","assets/n5wrqpcxv1sjah44.js","assets/kkl7694f44ns8yp6.js","assets/mw2u7timj0qnsnvj.js","assets/dvqe6kc43fkjsavv.js","assets/nq5i976pifkrt40a.js","assets/fnnulb9pmlo3cgid.js","assets/bj1ejin6tzi0v3v8.js","assets/evdizkj2x48kibvr.js","assets/e176wmak1h15k06n.js","assets/d3gl9smdb5iqto0t.js","assets/c5d5as11kwvue83v.js","assets/m07wx0qobxpm3v8p.js","assets/daioev77nl79ehf6.js","assets/e0efgancp8wep37e.js","assets/xx3svpq6qe4q5uu1.js","assets/gyvvad7btmtz1x9o.js","assets/n6vmm5pyahusdy8e.js","assets/l041el2tch1t3nkf.js","assets/dta5t6ifyam55mk9.js","assets/easgat082167v0i8.js","assets/cncd8uuk5eicbkeu.js","assets/cdk0cmbgnafohb1q.js","assets/mtg83aqpqaxteb09.js","assets/fr4ckts5oz9jhhs0.js","assets/cpi3lin3ecpcdm5q.js","assets/d2q2nhqj7harnnku.js","assets/ek7qgesc03yusf3u.js","assets/cjx9kl6wq86sx3q6.js","assets/n82i9qkvs5r9bggc.js","assets/9z485wf4plyfoo73.js"])))=>i.map(i=>d[i]);
var us=Object.freeze,ps=Object.defineProperty,pt=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var ms=Object.getOwnPropertySymbols;var ht=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable;var fs=(s,t,a)=>t in s?ps(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))ht.call(t,a)&&fs(s,a,t[a]);if(ms)for(var a of ms(t))xt.call(t,a)&&fs(s,a,t[a]);return s},I=(s,t)=>pt(s,gt(t));var we=(s,t)=>us(ps(s,"raw",{value:us(t||s.slice())}));import{R as Ns,r as p,j as e,b as ee,u as As,d as xe,M as f,g as Me,x as vt,A as jt,m as Gs,G as yt,ad as Mt,i as bt}from"./jj85rqzpbnvv3emr.js";import{gv as pe,ct as Ye,bI as ge,bJ as be,im as Ke,io as Ze,ax as ze,bV as wt,dO as Pt,cm as Tt,ci as de,cf as kt,ik as _t,lR as St,lT as J,cp as Xe,kG as Rs,cl as Ls,cR as It,rn as Us,mH as Fs,g2 as Je,q0 as Os,q3 as Ee,bM as De,cP as Ct,l2 as Nt,ch as At,cg as Gt,bQ as Rt,cT as Lt,i as ie,d as Ce,h as Bs,f as ue,qx as es,pU as Ut,pS as Ft,cu as Ot,f1 as We,G as O,o as Z,c1 as Hs,j as ye,C as ss,B as Te,pV as ke,fa as _e,T as ts,id as Bt,F as ns,e as he,ro as Ht,qw as zt,gU as Et,fw as as,eE as le,fx as Wt,aE as qt,pT as $t,dP as Vt,bi as Qt,o$ as zs,pb as Yt,p0 as Es,gr as Kt,pc as Zt,jH as qe,pd as Xt,ld as Ws,E as is,o_ as Jt,q1 as Re,q2 as Le,P as qs,lc as Dt,r as rs,g1 as en,aI as sn,an as tn,k as nn,fv as an,ff as $s,ex as Vs,ey as Qs,fm as rn,gk as Se,bK as on,jk as Ys,dl as ln,rp as cn,gP as dn,dF as gs,p_ as un,rq as mn,b as fn,gT as pn,ck as gn,rr as hn,rs as xn,be as vn,ca as jn,L as hs,p as xs,jL as yn,f8 as vs,fd as Mn,fg as bn,fh as wn,pg as Pn,bZ as js,nZ as Tn}from"./lef5ym39glv4981l.js";import{gz as Ks,kM as Zs,a as Xs,jV as Ne,jW as D,gb as Js,gL as os,gJ as kn,bv as Ds,mf as et,p5 as _n,d7 as Sn,bW as st,au as tt,bG as In,be as Cn,k4 as ce,p6 as $e,jY as Nn,a6 as An,p7 as Gn,fH as Rn,a3 as Ln,p8 as ys,hx as Ms,p9 as nt,pa as Un,fQ as at,cA as Ie,pb as it,k5 as te,k6 as ne,k7 as Ue,mw as Fn,pc as On,k8 as Bn,kO as Hn,pd as zn,fR as En,k9 as Wn,pe as bs,pf as qn,nu as $n,T as Vn,eQ as Qn,pg as Yn,mZ as Kn,bV as Zn,kj as Xn,kL as ws,ph as Jn,eD as Dn,pi as Ps,r as ea,ly as sa,lz as ta,lA as na}from"./mclphevd122040jw.js";import{i as aa,G as ia,A as je,M as rt,a as ra,b as Ts,s as oa,c as la,S as ca,g as da,d as ua}from"./c5d5as11kwvue83v.js";import{M as ot}from"./e0efgancp8wep37e.js";import{i as Ve}from"./cpi3lin3ecpcdm5q.js";import{S as ma}from"./kkl7694f44ns8yp6.js";import{G as fa}from"./m07wx0qobxpm3v8p.js";import{C as pa}from"./d2q2nhqj7harnnku.js";import{S as ga}from"./ek7qgesc03yusf3u.js";import{u as lt}from"./dta5t6ifyam55mk9.js";import{h as ha}from"./cncd8uuk5eicbkeu.js";import{a as xa,G as va}from"./cjx9kl6wq86sx3q6.js";import{b as ja}from"./n82i9qkvs5r9bggc.js";function ya(s,t){const a=be(s),n=ge.getTree(a),i=[];let r=ge.getCurrentNode(a);for(;r!=null&&(t==null||r.id!==t);)i.unshift(r.message),r=r.parentId!==""?n.getNodeByIdOrMessageId(r.parentId):void 0;return i}function Ma(s){return s.filter(n=>n.recipient==="gizmo_editor.update_behavior").flatMap(n=>n.content.content_type==="text"?n.content.parts:n.content.content_type==="code"?[n.content.text]:[]).map(n=>JSON.parse(n)).reduce((n,i)=>x(x({},n),i),{})}async function ba(s){let t;for(const a of s)if(a.author.name==="gizmo_editor.generate_profile_pic"){const n=kt.getImageAssetPointers(a);n.length>0&&(t=n.at(-1))}if(t!=null){const a=_t(t.asset_pointer),n=await Ke(a);if(n.status===Ze.Success)return{id:a,permalink:n.download_url}}}async function wa(s,t,a,n){const i=ya(t,n),r=Ma(i);let o=await ba(i);if(Ve(r)&&o==null)return;const{name:l,context:d,description:u,profile_pic_file_id:P,prompt_starters:c}=r;if(P!=null)try{const j=await Ke(P,s.id);j.status===Ze.Success&&(o={id:P,permalink:j.download_url})}catch(j){ze.addError(new Error("Error while retrieving profile pic in update",{cause:j})),a.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const _={name:typeof l=="string"?l:void 0,description:typeof u=="string"?u:void 0,instructions:typeof d=="string"?d:void 0,promptStarters:Array.isArray(c)?c:void 0,profilePictureId:o==null?void 0:o.id,profilePictureUrl:o==null?void 0:o.permalink};return wt(_,j=>j!=null)}function Pa(s){var d,u,P;const t=new Set;for(const c of s.tools)t.add(c.type);const a=(d=s.name)!=null?d:"",n=(u=s.description)!=null?u:"",i=(P=s.instructions)!=null?P:"",r=Array.from(t).join(","),o=a===""&&n===""&&i==="",l=s.profilePictureUrl!=null;return o?"The GPT you are about to has the following abilities: ".concat(r,"."):"This is the GPT's current set of fields:\n\nname: ".concat(a,"\n\ndescription: ").concat(n,"\n\ncontext: ").concat(i,"\n\nabilities: ").concat(r,"\n\n").concat(l?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}const Ta=10;function ct(s,t){var P,c,_,j,v,S,y,k,T,m,U;const a=s.current,n=t.current;if(Ye(a,n))return;const i={};a.name!==(n==null?void 0:n.name)&&(i.name=a.name),((P=a.description)!=null?P:"")!==((c=n==null?void 0:n.description)!=null?c:"")&&(i.description=(_=a.description)!=null?_:""),a.instructions!==((j=n==null?void 0:n.instructions)!=null?j:"")&&(i.context=(v=a.instructions)!=null?v:"");const r=new Set((y=(S=n==null?void 0:n.files)==null?void 0:S.map(h=>h.file_id))!=null?y:[]),o=new Set((T=(k=a.files)==null?void 0:k.map(h=>h.file_id))!=null?T:[]),l=((m=a.files)!=null?m:[]).filter(h=>!r.has(h.file_id)),d=((U=n==null?void 0:n.files)!=null?U:[]).filter(h=>!o.has(h.file_id));if(Ve(i)&&l.length===0&&d.length===0)return;const u=[];if(!Ve(i)){const h="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(i,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');u.push(pe(h))}if(d.length>0&&u.push(pe("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(d.map(h=>h.file_id).join(", ")))),l.length>0){const h=l.slice(0,Ta);u.push(pe("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(h.map(L=>L.file_id).join(", ")),{attachments:h.map(L=>({id:L.file_id,name:L.name,size:L.size}))}))}return u}function ka(s){if(s.length===0)return;const t="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(s.map(a=>'"'.concat(a.fileId,'"')).join(", "));return[pe(t)]}function _a(s){const t="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.";if(!ge.findNode(be(s),n=>n.message.content.content_type==="text"&&n.message.content.parts[0]===t))return[pe(t)]}function Sa(s,t){var r,o;const{session:a}=Pt();Tt.initThread({clientThreadId:s,conversationMode:{kind:de.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:t},userId:(r=a==null?void 0:a.user)==null?void 0:r.id,accountId:(o=a==null?void 0:a.account)==null?void 0:o.id});const n=Ks(s);return async(l,d,u,P)=>{n({sourceEvent:l,promptMessage:pe(P),prependMessages:ct(d,u),completionMetadata:{conversationMode:{kind:de.GizmoMagicCreate,gizmo_id:d.current.id,behavior_overrides:t}}})}}const Ia="Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response.";function Ca(s,t){p.useEffect(()=>{ge.findNode(be(s),n=>Nt(n.message)||n.message.author.role===At.System&&n.message.content.content_type===Gt.Text)||De(s,n=>{Rt.updateTree(n,(i,r)=>{const o=i.findNode(l=>{var d;return((d=l.message.clientMetadata)==null?void 0:d.isPlaceholderTemplateAssistantWelcomeMessage)===!0},r);return o&&(o.id===r&&(r=i.rootId),i.deleteNode(o.id)),t?i.addMessageNode(r,Lt(t,void 0,{isPlaceholderTemplateAssistantWelcomeMessage:!0})):r})})},[s,t])}function Na(s,t,a){var o;const{data:n}=Je(),i=(o=n==null?void 0:n.models.get(Os))!=null?o:n&&Zs(n.models.values(),l=>l.tags.includes(Ee.GPT_4o));Xs(s,{kind:de.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:a},{forcedModelId:i==null?void 0:i.id}),p.useEffect(()=>{De(s,l=>{var d;l.mode={kind:de.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:Ct(a)},l.modelId=(d=i==null?void 0:i.id)!=null?d:l.modelId})},[s,t.id,a,i,n]);const[r]=p.useState(()=>{const l=t.id==null,d=t.id!=null&&t.name!==""&&t.description!=null&&t.instructions!==""&&t.profilePictureUrl!=null;return l?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':d?"Welcome back! Is there anything ".concat(t.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});Ca(s,r)}function Aa({gizmoEditorData:s,updateGizmo:t,clientThreadId:a,gizmoEditorDataRef:n,magicMakerBehaviorOverrides:i,magicMakerConversationGizmoEditorDataRef:r,requireGizmoId:o}){const l=p.useRef(o);l.current=o;const d=p.useMemo(()=>({gizmoEditorData:s,gizmoId:s.id,mode:"magic",behaviorOverrides:i,getGizmoId:l.current}),[s,i]),u=St(c=>c.files.filter(_=>_.status===J.Ready&&_.gizmoId!=null)),P=p.useCallback(c=>{var _,j,v,S,y;if(t(k=>{var T;return I(x({},k),{files:[...(T=k.files)!=null?T:[],...Xe(u.map(m=>{var U;return m.fileId!=null&&{file_id:m.fileId,name:m.file.name,size:m.file.size,type:Rs(m.file),last_modified:m.file.lastModified,file_size_tokens:(U=m.fileSpec)==null?void 0:U.fileTokenSize}}))]})}),r.current=Ls(n.current),!c.completionType||c.completionType===It.Next){const k=ge.getCurrentNode(be(a)),T=(_=k.message.clientMetadata)!=null&&_.isPlaceholderTemplateAssistantWelcomeMessage?k.message:void 0;T&&(c.existingMessages=[T]),c.prependMessages=[...(j=ka(u))!=null?j:[],...(v=ct(n,r))!=null?v:[],...(S=_a(a))!=null?S:[],...(y=c.prependMessages)!=null?y:[]]}return c},[a,u,n,r,t]);return e.jsx(Us.Provider,{value:d,children:e.jsx("div",{className:"relative flex h-full grow overflow-auto",children:e.jsx("div",{className:"grow",children:e.jsx(Fs,{clientThreadId:a,children:e.jsx(ot,{clientThreadId:a,getGizmosCompletionParams:P,hideHeader:!0})})})})})}const Ga=Ns.memo(Aa);function Ra({gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,showActionsModal:o,shareOnly:l,onClose:d}){const[u,P]=p.useState({type:"privacy"});return u.type==="privacy"?e.jsx(Ua,{gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,setStep:P,showActionsModal:o,shareOnly:l,onClose:d}):e.jsx(Fa,{publishedGizmo:u.publishedGizmo,onClose:d})}function La(s){return s?O.Workspace:O.Link}function Ua({gizmo:s,publishedGizmo:t,updateGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,setStep:o,showActionsModal:l,shareOnly:d,onClose:u}){var se,Q,re,me,fe;const P=ie(),[c,_]=p.useState(!1),j=Ce(Bs.isBusinessWorkspace),v=ee(),S=ue(),[y,k]=p.useState(es(s)?La(!!j):s.sharingRecipient),T=As(),m=aa(y,s.sharingTargets),{data:U,isLoading:h}=Ut(),L=Ft(),[M,C]=p.useState(t!=null&&t.gizmo.display.categories.length>0?(Q=(se=L.data)==null?void 0:se.categories.find(w=>w.id===t.gizmo.display.categories[0]))==null?void 0:Q.id:void 0);p.useEffect(()=>{C(t==null?void 0:t.gizmo.display.categories[0])},[t==null?void 0:t.gizmo.display.categories]);const[N,q]=p.useState(void 0),F=p.useRef(Ot((w,W)=>We.generateCategory(w,W),1e3)),H=U!=null&&U.is_verified?void 0:v.formatMessage({id:"qUMu4e",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile in the user settings page."});y===O.Marketplace&&H!=null&&!h&&k(O.Link);const V=j&&!((re=s.sharingTargets)!=null&&re.some(w=>w.recipient===O.Link)),B=Ne(s,y,M),z=B.includes(D.MissingPublicActionPrivacyPolicyURL),Y=s.tools.find(w=>w.type===Z.JIT_PLUGIN&&!w.metadata.privacy_policy_url),g=Ce(w=>w.currentWorkspace),A=Hs();p.useEffect(()=>{let w=!0;return(async()=>{try{if(M!=null)return;const W=await F.current(s.name,s.instructions);w&&M==null&&(W?C(W.id):q(!0))}catch(W){w&&M==null&&q(!0)}})(),()=>{w=!1}},[s.instructions,s.name,A,M]);const $=ye(P,"4226692983");return e.jsx(ss,{testId:"modal-simple-share-gizmo",type:"success",isOpen:!0,onClose:u,title:e.jsx(f,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:m?e.jsx(Te,{color:"primary",disabled:B.length>0,loading:c,onClick:async()=>{try{if(_(!0),d){if(!(t!=null&&t.gizmo.id)){S.danger(v.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}),{toastId:"simple_share_gizmo_modal",loggingTitle:"Error sharing GPT",loggingDescription:"Error message when GPT ID is missing (shouldn't happen)"});return}const w=await We.shareGizmo(t.gizmo.id,M?{sharing:ke(y,[],_e),categories:[M]}:{sharing:ke(y,[],_e)});w.error?(S.warning(v.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),a({sharingTargets:w.sharing_targets}),r({gizmoId:t.gizmo.id,sharingRecipient:y,categories:t.gizmo.display.categories,moderationType:rt.PublishBlocked,sharingTargets:w.sharing_targets,showModal:je.AppealAvailable})):(T.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],W=>w.resource),a(W=>I(x({},W),{sharingRecipient:y})),S.success(v.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),u())}else{const w=await n({recipient:y,subjects:ke(y,[],_e)},M);w?(o({type:"published",publishedGizmo:w}),a(W=>I(x({},W),{id:w.gizmo.id,sharingRecipient:y})),w.gizmo.live_version!=null&&a({liveVersion:w.gizmo.live_version}),S.success(v.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(S.warning(v.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),u())}}finally{_(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(f,{id:"SW4DG4",defaultMessage:"Save"})}):$?e.jsx(e.Fragment,{children:e.jsx(Te,{color:"primary",onClick:async()=>{await i(y,M)},children:e.jsx(f,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:t?e.jsx(Te,{color:"secondary",onClick:w=>os(P,t,S,w,v.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(f,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(Js,{value:y,onValueChange:w=>k(w),children:[s.sharingTargets&&s.sharingTargets.map((w,W)=>e.jsx(Fe,{value:w.recipient,disabled:w.recipient===O.Marketplace&&H!=null,tooltipText:w.recipient===O.Marketplace?H!=null?H:v.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:w.recipient},W)),V&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{value:O.Link,disabled:!0,tooltipText:v.formatMessage(ks.workspaceDisabledHint),shareLevel:O.Link,workspaceName:g==null?void 0:g.name}),e.jsx(Fe,{value:O.Link,disabled:!0,tooltipText:v.formatMessage(ks.workspaceDisabledHint),shareLevel:O.Marketplace,workspaceName:g==null?void 0:g.name})]})]})}),z&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(f,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:w=>e.jsx("button",{onClick:()=>{l(Y==null?void 0:Y.metadata.action_id)},className:"underline",children:w})}})}),y!==O.Private&&e.jsx(ia,{gizmo:s,category:M,categories:y===O.Marketplace?(fe=(me=L.data)==null?void 0:me.categories)!=null?fe:[]:void 0,onCategoryChange:y===O.Marketplace?w=>C(w.id):void 0}),y===O.Marketplace&&(N?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(f,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!m&&$&&e.jsx("div",{className:"text-token-text-secondary flex items-center justify-between text-sm",children:e.jsx(f,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function Fa({publishedGizmo:s,onClose:t}){const a=ie(),n=kn(a,s),i=ee(),r=ue();return e.jsx(ss,{testId:"modal-simple-share-published",type:"success",isOpen:!0,onClose:t,title:e.jsx(f,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(Te,{color:"primary",as:"link",to:n,children:e.jsx(f,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex gap-1 rounded-sm px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 break-all text-ellipsis",children:n}),e.jsx("button",{onClick:o=>{os(a,s,r,o,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary hover:text-token-text-primary transition","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Ds,{className:"icon-sm"})})]})})})}const ks=xe({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function Fe({shareLevel:s,workspaceName:t,value:a,disabled:n=!1,tooltipText:i}){const r=p.useId();return e.jsx(ts,{disabled:i==null,label:i,side:"top",triggerAs:null,children:e.jsxs(et,{id:r,value:a,disabled:n,className:"hover:bg-token-main-surface-secondary flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold",children:[e.jsx("label",{htmlFor:r,className:"flex cursor-pointer items-center gap-1",children:e.jsx(ra,{shareLevel:s,workspaceName:t!=null?t:"",hasInviteSharing:!1})}),e.jsx(_n,{children:e.jsx(Bt,{className:"icon-lg me-1"})})]})})}function Qe(s){return!!(s&&typeof s=="object"&&"gizmo"in s)}function dt(s){window.history.length>1?s(-1):s(Ht())}function Oa({gizmo:s,publishedGizmo:t,isUpsertLoading:a,isPromoteLoading:n,isUploadingProfilePic:i,isGeneratingProfilePic:r,updateGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:u,showActionsModal:P}){var U;const c=ie(),_=qt(),j=p.useMemo(()=>{const h=[];return(s==null||n||a)&&h.push(D.Loading),s!=null&&h.push(...Ne(s)),i&&h.push(D.UploadingProfilePic),r&&h.push(D.GeneratingProfilePic),h},[s,n,a,i,r]),v=es(s),S=h=>{requestAnimationFrame(()=>Qt(c,_!=null&&_.isWorkspaceAccount()?ca:Ra,{gizmo:s,publishedGizmo:t,promoteGizmo:l,appealGizmo:d,setAppealState:u,showActionsModal:P,updateGizmo:o,shareOnly:h==="share"}))},[y,k]=p.useState(!1),T=s.sharingRecipient?Ts[s.sharingRecipient]:Ts.private,m=n||a;return e.jsxs(e.Fragment,{children:[v?e.jsx(ce,{color:"primary",onClick:()=>S("promote"),loading:j.length>0&&j.every(h=>[D.Loading,D.UploadingProfilePic,D.GeneratingProfilePic].includes(h)),disabled:m||s.id===void 0||j.length>0,tooltip:j.length>0?j.map($e).join("\n"):void 0,"data-testid":"gizmo-editor-create-gpt-button",children:e.jsx(f,{id:"svUGIb",defaultMessage:"Create"})}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{color:"secondary",loading:n||!t,disabled:m,icon:T,onClick:()=>S("share"),children:e.jsx(f,{id:"aXKW4G",defaultMessage:"Share"})}),e.jsx(ce,{color:"primary",onClick:async()=>{var N;let h=s.sharing.subjects.map(oa);const L=$t(s.sharing.subjects);h=ke(s.sharing.recipient,h,(N=L==null?void 0:L.capabilities)!=null?N:_e);const M=t&&Qe(t)?t.gizmo.display.categories[0]:void 0;await l({recipient:s.sharing.recipient,subjects:h},M)&&k(!0)},loading:a||!t,disabled:m||j.length>0,tooltip:j.length>0?j.map($e).join("\n"):void 0,children:e.jsx(f,{id:"84QVoj",defaultMessage:"Update"})})]}),y&&t&&e.jsx(la,{publishedGizmo:t,sharing:Qe(t)?t.gizmo.sharing:void 0,onClose:()=>k(!1),workspaceName:(U=_==null?void 0:_.data.name)!=null?U:""})]})}function Ba({gizmoEditorData:s,publishedGizmo:t,revertDraft:a}){var _;const n=ie(),i=ee(),r=ue(),o=Me(),[l,d]=p.useState(!1),{canDelete:u}=zt(t),{canCreate:P}=Et();return!(t||a||s!=null&&s.id&&s.liveVersion>0||u)?null:e.jsxs(e.Fragment,{children:[e.jsxs(as,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:e.jsx(ce,{color:"ghost",icon:Wt}),children:[t!=null&&e.jsxs(le.Item,{onClick:j=>{os(n,t,r,j)},children:[e.jsx(tt,{className:"icon-sm"}),e.jsx(f,x({},ae.copyLink))]}),a!=null&&e.jsxs(le.Item,{onClick:()=>{window.confirm(i.formatMessage(ae.revertConfirm))&&a()},children:[e.jsx(In,{className:"icon-sm"}),e.jsx(f,{id:"W2blnV",defaultMessage:"Revert..."})]}),(s==null?void 0:s.id)!=null&&s.liveVersion>0&&e.jsxs(e.Fragment,{children:[e.jsxs(le.Item,{onClick:()=>{o("/g/".concat(s.id,"/view"))},children:[e.jsx(ma,{className:"icon-sm"}),e.jsx(f,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),P&&e.jsxs(le.Item,{onClick:async()=>{const j=await We.copyGizmo({gizmoId:s.id});j.gizmo.id&&o("/gpts/editor/".concat(j.gizmo.id))},children:[e.jsx(Ds,{className:"icon-sm"}),e.jsx(f,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),t&&Qe(t)&&((_=t.gizmo.current_user_permission)==null?void 0:_.can_delete)&&e.jsxs(le.Item,{color:"danger",onClick:()=>{d(!0)},children:[e.jsx(Cn,{className:"icon-sm"}),e.jsx(f,{id:"tNrOLG",defaultMessage:"Delete GPT"})]})]}),l&&e.jsx(fa,{gizmoId:(s==null?void 0:s.id)||"",onSuccess:()=>dt(o),onClose:()=>{d(!1)}})]})}var Ss;const Pe=ns.div(Ss||(Ss=we(["flex items-center gap-1"])));function Ha({gizmoEditorData:s}){const t=Ce(a=>{var n;return(n=a.currentWorkspace)==null?void 0:n.name});switch(s.sharingRecipient){case O.Private:return e.jsxs(Pe,{children:[e.jsx(Vt,{className:"icon-xs"}),e.jsx(f,x({},ae.onlyMe))]});case O.Link:return e.jsxs(Pe,{children:[e.jsx(tt,{className:"icon-xs"}),e.jsx(f,x({},ae.anyoneWithLink))]});case O.Workspace:return e.jsxs(Pe,{children:[e.jsx(An,{className:"icon-xs"}),t]});case O.Marketplace:return e.jsxs(Pe,{children:[e.jsx(Nn,{className:"icon-xs"}),e.jsx(f,x({},ae.public))]});default:return e.jsx("div",{})}}function za({gizmoEditorData:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[s.profilePictureUrl!=null?e.jsx(st,{isFirstParty:!1,src:s.profilePictureUrl,className:"h-8 w-8"}):e.jsx("div",{className:"border-token-border-medium h-8 w-8 rounded-full border-2 border-dashed"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:s.name||e.jsx(f,x({},ae.newGPT))}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:es(s)?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-token-text-tertiary h-1.5 w-1.5 rounded-full"}),e.jsx(f,x({},ae.draft))]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-brand-green h-1.5 w-1.5 rounded-full"}),s.sharingRecipient===O.Marketplace?e.jsx(f,x({},ae.published)):e.jsx(f,{id:"gizmoEditorHeader.live",defaultMessage:"Live"}),e.jsx(f,I(x({},ae.dotSeparator),{tagName:"span"})),e.jsx(Ha,{gizmoEditorData:s})]})})]})]})}var Is;const Ea=ns.div(Is||(Is=we(["\n  cursor-pointer\n  border-b\n  pb-[1px]\n  pt-[2px]\n  text-sm\n  text-token-text-secondary\n  hover:border-token-border-xheavy\n  hover:text-token-text-primary\n  mx-2\n"])));function Wa({gizmoEditorData:s,isUpsertLoading:t,isPromoteLoading:a,isUploadingProfilePic:n,isGeneratingProfilePic:i,publishedGizmo:r,updateGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:u,revertDraft:P,draftMessage:c,className:_,hasUnpublishedChanges:j,showActionsModal:v}){var y,k;const S=Me();return e.jsxs("div",{className:he("border-token-border-medium relative flex h-14 w-full items-center justify-between gap-2 border-b px-3",_),children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("a",{className:"text-token-text-primary cursor-pointer",onClick:()=>dt(S),children:e.jsx(Sn,{className:"icon"})}),e.jsx(za,{gizmoEditorData:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&((k=(y=r==null?void 0:r.gizmo)==null?void 0:y.live_version)!=null?k:0)>1&&e.jsx(Ea,{onClick:()=>S("/g/".concat(s.id,"/view")),children:e.jsx(f,{id:"P0Ri/k",defaultMessage:"Last edited {date}",values:{date:e.jsx(vt,{value:r.gizmo.updated_at,day:"numeric",month:"short",year:new Date(r.gizmo.updated_at).getFullYear()===new Date().getFullYear()?void 0:"numeric"})}})}),c,e.jsx(Ba,{gizmoEditorData:s,publishedGizmo:r,revertDraft:P}),e.jsx(Oa,{gizmo:s,publishedGizmo:r,isUpsertLoading:t,isPromoteLoading:a,isUploadingProfilePic:n,isGeneratingProfilePic:i,updateGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:u,hasUnpublishedChanges:j,showActionsModal:v})]})]})}const ae=xe({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},dotSeparator:{id:"gizmo.dotSeparator",defaultMessage:"·"}}),qa=512;function $a(){return e.jsx("div",{className:"border-token-border-medium relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:e.jsx(is,{className:"h-1/4 w-1/4"})})}function Va({gizmoEditorData:s,onFileChange:t,generateProfilePic:a,isGeneratingProfilePic:n,setIsGeneratingProfilePic:i}){const r=ee(),o=ue(),[l,d]=p.useState(void 0),u=p.useRef(t);p.useEffect(()=>{u.current=t});async function P(j){if(j.length>0){i(!1);const v=await Zt(j[0],qa),S=qe(v);d({tempId:S,file:v,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),u.current("uploading"),Xt(S,v,r,o,Ws.ProfilePicture,{onFileCreated(y,k,T){d(m=>m!=="initial"&&(m==null?void 0:m.tempId)===y&&m.status===J.Uploading?I(x({},m),{progress:10,fileId:k,cdnUrl:T}):m)},onFileUploadProgress(y,k){d(T=>T!=="initial"&&(T==null?void 0:T.tempId)===y&&T.status===J.Uploading?I(x({},T),{progress:k}):T)},onFileUploaded(y,k,T){d(m=>m!=="initial"&&(m==null?void 0:m.tempId)===y?(u.current(m),I(x({},m),{status:J.Ready,progress:100,fileSpec:x({name:m.file.name,id:m.fileId,size:m.file.size},T!=null?T:{})})):m)},onError(y){d(k=>{if(k!=="initial"&&(k==null?void 0:k.tempId)===y){u.current(void 0);return}return k})}})}}const{open:c,getInputProps:_}=lt(x({disabled:!1,noClick:!0,onDropAccepted:P,onDropRejected:j=>ha(j,r,o,Kt.ProfilePicture),multiple:!0,maxSize:Es},zs(Yt)));return e.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[e.jsxs(as,{sideOffset:8,triggerButton:e.jsx("button",{className:"h-20 w-20",children:n?e.jsx($a,{}):l!=null&&l!="initial"&&l.status!=J.Ready?e.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[e.jsx(Gn,{file:l.file}),l.status===J.Uploading&&l.progress<90?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:e.jsx(Rn,{percentage:l.progress,className:"h-6 w-6"})}):null]}):(s==null?void 0:s.profilePictureUrl)!=null&&(s==null?void 0:s.profilePictureUrl)!==""?e.jsx(st,{isFirstParty:!1,src:s.profilePictureUrl}):e.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:e.jsx(Ln,{className:"text-4xl"})})}),children:[e.jsx(le.Item,{onClick:c,children:e.jsx(f,{id:"ERQwXg",defaultMessage:"Upload Photo"})}),e.jsx(le.Item,{onClick:a,children:e.jsx(f,{id:"NXAog/",defaultMessage:"Use DALL·E"})})]}),e.jsx("input",x({},_()))]})}function Qa({gizmoEditorData:s,requireGizmoId:t,currentModelConfig:a,updateGizmo:n}){var L;const i=ee(),r=ue(),[o,l]=p.useState(0),d=p.useRef(new Map),u=Jt(a,void 0),P=async M=>{qs.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const C=await t();M.length>0&&await Promise.all(M.map(N=>{const q=qe(N);d.current.set(q,{tempId:q,gizmoId:C,file:N,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),Dt(qe(N),N,i,r,{kind:Ws.Gizmo,gizmoId:C},{onFileUploaded:(F,H,V,B)=>{const z=d.current.get(F);z==null||z.fileId==null||(n(Y=>{var g,A;return I(x({},Y),{files:[...(g=Y.files)!=null?g:[],{file_id:z.fileId,name:z.file.name,size:z.file.size,type:(A=B==null?void 0:B.mimeType)!=null?A:Rs(N),last_modified:z.file.lastModified,file_size_tokens:B==null?void 0:B.fileTokenSize}]})}),d.current.delete(F),l(Y=>Y+1))},onFileCreated:(F,H,V)=>{d.current.set(F,I(x({tempId:F,gizmoId:C,file:N,status:J.Uploading,progress:1},d.current.get(F)),{fileId:H,cdnUrl:V})),l(B=>B+1)},onFileUploadProgress:(F,H)=>{const V=d.current.get(F);(V==null?void 0:V.status)===J.Uploading&&d.current.set(F,I(x({},V),{progress:H})),l(B=>B+1)},onError:F=>{d.current.delete(F)}},{usesRetrievalIndex:a!=null&&Re(a,N.type,N.name)===Le.Retrieval})}))},{getInputProps:c,open:_}=lt(x({disabled:!1,noClick:!0,onDropAccepted:P,multiple:!0,maxSize:Es,maxFiles:10},zs(u))),j=(L=s==null?void 0:s.files)!=null?L:[];function v(M){return e.jsx(Ms,{onRemoveFileClick:()=>{d.current.delete(M.tempId),l(C=>C+1)},file:M.file,loadingPercentage:M.status===J.Uploading?M.progress:void 0},M.tempId)}function S(M){return e.jsx(Ms,{file:M.name,fileId:M.file_id,onRemoveFileClick:()=>n(C=>{var N;return I(x({},C),{files:(N=C==null?void 0:C.files)==null?void 0:N.filter(q=>q.file_id!==M.file_id)})}),gizmoId:s==null?void 0:s.id},M.file_id)}const y=Array.from(d.current.values()).filter(M=>j.every(C=>C.file_id!==M.fileId)),[k,T]=ys(y,M=>a!=null&&Re(a,M.file.type,M.file.name)===Le.CodeInterpreter),[m,U]=ys(j,M=>a!=null&&M.type!=null&&Re(a,M.type,M.name)===Le.CodeInterpreter),h=p.useRef(m.length);return p.useEffect(()=>{m.length>h.current&&n(M=>{var C,N;return(C=M.tools)!=null&&C.some(q=>q.type===Z.PYTHON)?M:I(x({},M),{tools:[...(N=M.tools)!=null?N:[],{type:Z.PYTHON}]})}),h.current=m.length},[m.length]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"text-token-text-tertiary rounded-lg text-xs",children:e.jsx(f,x({},Ya.knowledgeWarning))}),T.length>0||U.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(v),U.map(S)]}):null,k.length>0||m.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:e.jsx(f,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[k.map(v),m.map(S)]})]}):null,e.jsx("div",{children:e.jsxs(ce,{onClick:_,children:[e.jsx("input",x({},c())),e.jsx(f,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const Ya=xe({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT can potentially reveal part or all of the files uploaded."}});function Ka({placeholder:s,text:t,onChange:a,onClose:n}){return e.jsxs(ss,{testId:"modal-gizmo-editor-form",className:"max-h-[100vh]! max-w-[80vw]!",type:"success",isOpen:!0,onClose:n,primaryButton:e.jsx(ce,{onClick:n,children:e.jsx(f,{id:"FeFVdS",defaultMessage:"Close"})}),children:[e.jsx("textarea",{className:"bg-token-main-surface-primary h-[70vh] w-full resize-none rounded-lg dark:border-gray-700",value:t,onChange:i=>{a(i.target.value)},placeholder:s}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,x({},nt.instructionsWarning))})]})}var Cs;const Oe=ns.div(Cs||(Cs=we(["text-sm text-red-500"])));function Za({children:s,collapsed:t,initial:a}){return e.jsx(jt,{initial:a,children:!t&&e.jsx(Gs.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:s})})}function Xa({gizmo:s,onShowActionsEditor:t,isDisabled:a}){var o,l,d;const n=ee(),i=ue(),r=e.jsxs("div",{className:"space-y-1",children:[(o=s==null?void 0:s.tools)==null?void 0:o.map((u,P)=>{var c;return u.type!==Z.JIT_PLUGIN?null:e.jsxs("div",{children:[e.jsx(Wn,{isDisabled:a,actionTool:u,onShowActionsEditor:()=>t(u.metadata.domain)}),((c=u.metadata.auth)==null?void 0:c.type)==="oauth"&&e.jsx(pa,{label:n.formatMessage(E.callbackUrlLabel),value:"https://chat.openai.com/aip/".concat(u.metadata.action_id,"/oauth/callback"),onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},P)}),((d=(l=s==null?void 0:s.tools)==null?void 0:l.filter(u=>u.type===Z.JIT_PLUGIN))!=null?d:[]).length>=bs?e.jsx("div",{children:n.formatMessage(E.maxActionsReached,{number:bs})}):e.jsx(ce,{disabled:a,onClick:()=>{t("Unknown domain")},className:"mt-2",children:e.jsx(f,x({},E.createActionLabel))})]});return a?e.jsx(ts,{side:"top",label:n.formatMessage(E.disabledCustomActionsTooltip),children:r}):r}function Ja(s){var t,a,n;return((a=(t=s.files)==null?void 0:t.length)!=null?a:0)>0||((n=s==null?void 0:s.tools)==null?void 0:n.some(i=>i.type===Z.JIT_PLUGIN))}function Da({gizmoEditorData:s,updateGizmo:t,currentModelConfig:a,generateProfilePic:n,setIsUploadingProfilePic:i,isGeneratingProfilePic:r,setIsGeneratingProfilePic:o,requireGizmoId:l,onShowActionsEditor:d}){var q,F,H,V,B,z,Y;const u=(q=s==null?void 0:s.tools)!=null?q:[],[P,c]=p.useState(!1),[_,j]=p.useState(!0),v=(F=s==null?void 0:s.promptStarters)!=null?F:[],S=[...v,...v.length<Un?[""]:[]],y=Ne(s),k=ie(),T=rs(k),m=T==null?void 0:T.isWorkspaceAccount(),U=at(Ie.WorkspaceGPTCustomActions),h=ee(),{data:L}=Je({isGizmo:!0}),M=ye(k,"1854238036"),{gizmoModelsData:C}=en(),N=C!=null&&C.editor?it((H=s==null?void 0:s.tools)!=null?H:[])?C.editor.models_list_with_custom_actions:C.editor.models_list:[];return e.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[e.jsxs("div",{className:"grow",children:[e.jsxs(te,{children:[e.jsx(Va,{gizmoEditorData:s,generateProfilePic:n,isGeneratingProfilePic:r,setIsGeneratingProfilePic:o,onFileChange:async g=>{if(g!=null&&g!=="uploading"&&g.fileId!=null){const A=await Ke(g.fileId);A.status===Ze.Success&&t({profilePictureId:g.fileId!=null?g.fileId:void 0,profilePictureUrl:A.download_url})}else t({profilePictureId:void 0,profilePictureUrl:void 0});i(g==="uploading")}}),e.jsx(ne,{label:e.jsx(f,{id:"M4dZms",defaultMessage:"Name"}),description:e.jsx(f,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),e.jsx(Ue,{type:"text",placeholder:h.formatMessage(E.gptNamePlaceholder),value:(V=s==null?void 0:s.name)!=null?V:"",onChange:g=>{t({name:g.target.value})},onBlurCapture:()=>t(g=>I(x({},g),{name:g.name.trim()})),"data-testid":"gizmo-name-input"}),y.includes(D.GizmoNameTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,I(x({},E.nameTooLong),{values:{length:Fn}}))}):null]}),e.jsxs(te,{className:"mt-4",children:[e.jsx(ne,{label:e.jsx(f,{id:"YDzNvf",defaultMessage:"Description"}),description:e.jsx(f,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),e.jsx(Ue,{type:"text",placeholder:h.formatMessage(E.descriptionPlaceholder),value:(B=s==null?void 0:s.description)!=null?B:"",onChange:g=>t({description:g.target.value}),onBlurCapture:()=>t(g=>{var A,$;return I(x({},g),{description:($=(A=g.description)==null?void 0:A.trim())!=null?$:""})}),"data-testid":"gizmo-description-input"}),y.includes(D.GizmoDescriptionTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,I(x({},E.descriptionTooLong),{values:{length:On}}))}):null]}),e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:h.formatMessage(E.instructionsSubtitle)}),e.jsxs("div",{className:"relative",children:[e.jsx(Bn,{className:"resize-none",rows:8,value:s==null?void 0:s.instructions,onChange:g=>t({instructions:g.target.value}),onBlurCapture:()=>t(g=>I(x({},g),{instructions:g.instructions.trim()})),placeholder:h.formatMessage(E.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),e.jsx("button",{className:"text-token-text-tertiary absolute end-2 bottom-3",onClick:()=>c(!0),children:e.jsx(ga,{className:"icon-sm"})})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,x({},nt.instructionsWarning))}),y.includes(D.GizmoInstructionsTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,I(x({},E.instructionsTooLong),{values:{length:Hn}}))}):null]}),e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:e.jsx(f,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),e.jsx("div",{className:"flex flex-col gap-1",children:S.map((g,A)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ue,{className:"rounded-e-none",value:g,type:"text",maxLength:zn,onChange:$=>{const se=$.target.value;t(Q=>{var re;return I(x({},Q),{promptStarters:Xe(A>=((re=v.length)!=null?re:0)?[...v!=null?v:[],se]:v.map((me,fe)=>fe===A?se===""?void 0:se:me))})})}}),e.jsx("button",{className:"border-token-border-medium flex h-9 w-9 items-center justify-center rounded-lg rounded-s-none border border-s-0",onClick:()=>t($=>I(x({},$),{promptStarters:v.filter((se,Q)=>Q!==A)})),children:e.jsx(sn,{className:"icon-sm"})})]},A))})]}),e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:h.formatMessage(E.knowledgeExplanation)}),e.jsx(Qa,{gizmoEditorData:s,requireGizmoId:l,currentModelConfig:a,updateGizmo:t})]}),M&&L&&e.jsxs(te,{children:[e.jsx(ne,{label:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx(f,{id:"wnVs4X",defaultMessage:"Recommended Model"}),e.jsx(xa,{description:e.jsx(f,x({},E.recommendedModelExplainer))})]})}),e.jsx("div",{style:{fontSize:"12px",color:"var(--gray-600)",marginTop:"4px",marginBottom:"8px"},children:e.jsx(f,x({},E.recommendedModelDescriberUnderTitle))}),e.jsxs("select",{className:"border-token-border-medium bg-token-main-surface-primary w-full rounded-lg border px-3 py-2 text-sm",value:(z=s.defaultModel)!=null?z:"",onChange:g=>{tn.logEvent("gizmo_recommended_model_selected",g.target.value),t({defaultModel:g.target.value===""?null:g.target.value})},children:[e.jsx("option",{value:"",children:h.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"})}),[...L.models.values()].filter(g=>N.includes(g.id)).sort((g,A)=>g.title.localeCompare(A.title)).map(g=>e.jsx("option",{value:g.id,children:g.title},g.id))]})]}),e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:e.jsx(f,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),e.jsx(va,{enabledTools:u,onEnabledToolsChange:g=>t({tools:g})})]}),e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"7r7v+u",defaultMessage:"Actions"}),description:e.jsx(f,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),e.jsx(Xa,{isDisabled:!!(m&&!U),gizmo:s,onShowActionsEditor:d})]}),!m&&Ja(s)&&e.jsxs(te,{children:[e.jsx(ne,{label:e.jsx(f,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!_,onClick:()=>{j(g=>!g)}}),e.jsx(Za,{collapsed:_,initial:!1,children:e.jsx(En,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:e.jsx(f,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!s.trainingDisabled,onChange:()=>{t({trainingDisabled:!s.trainingDisabled})}})})]})]}),P&&e.jsx(Ka,{text:(Y=s.instructions)!=null?Y:"",onChange:g=>{t({instructions:g})},onClose:()=>c(!1),placeholder:h.formatMessage(E.instructionsSubtitle)})]})}const E=xe({recommendedModelDescriberUnderTitle:{id:"gizmo.recommendedModelDescriberUnderTitle",defaultMessage:"Recommend a model to the user, which should be used by default for best results."},recommendedModelExplainer:{id:"gizmo.recommendedModelExplainer",defaultMessage:"When the user loads a new conversation with the GPT the recommended model will be used. If the model is not available to the user, a similar model may be automatically selected."},nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters. If you need to provide more context, you may want to attach a file or knowledge document."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function ei(s,t){const a=$s(s);if(!Array.isArray(s.detail))return a;const n=Xe(s.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return t.formatMessage(E.nameTooLong,{length:i.ctx.limit_value});case"description":return t.formatMessage(E.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return t.formatMessage(E.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return n.length>0?n.join("\n"):a}function si({upsertDraftError:s}){const t=ee(),a=ei(s,t);return e.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[e.jsx("div",{children:e.jsx(f,x({},ut.errorSavingDraft))}),a!=null&&e.jsx(ts,{label:a,children:e.jsx(an,{className:"icon-sm"})})]})}function ti({isPublished:s,isSavingDraft:t,hasUnpublishedChanges:a,upsertDraftError:n,className:i}){return n instanceof nn?e.jsx(si,{upsertDraftError:n}):a?e.jsxs("div",{className:he("flex items-center gap-2",i),children:[e.jsx("span",{className:"text-token-text-secondary",children:s?e.jsx(f,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):e.jsx(f,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),e.jsx("div",{className:"text-token-text-tertiary w-4",children:t&&e.jsx(is,{})})]}):null}const ut=xe({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}}),ni=Vs(()=>Qs(()=>import("./lixhsjk8741nqzx6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38])).then(s=>s.CanvasFocusedViewManager));var ai=(s=>(s.TestGizmoAction="test_gizmo_action",s))(ai||{});const ii=new rn;function ri({clientThreadId:s,gizmoHasCustomActions:t,preferredModelId:a}){const{modelLabel:n,dropdownSections:i}=Yn(s,t,a),r=e.jsxs(Kn,{children:[e.jsx(f,{id:"IhcP1l",defaultMessage:"Model"}),e.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:n}),e.jsx(Zn,{className:"icon-sm text-token-text-tertiary"})]});return e.jsx(as,{size:"small",alignOffset:-4,triggerButton:r,children:e.jsx(dn,{sections:i})})}function oi({gizmoEditorData:s,isSavingDraft:t,showTitle:a=!0}){var k,T;const[n,i]=p.useState(()=>Se());Xs(n,{kind:de.GizmoTest,gizmo_id:s.id}),p.useEffect(()=>{De(n,m=>{m.mode={kind:de.GizmoTest,gizmo_id:s.id}})},[n,s.id]);const r=(k=s.files)==null?void 0:k.map(m=>m.file_id).join();p.useEffect(()=>{on(n)!=null&&i(Se())},[s.id,s.instructions,s.tools,r,n]);const o=p.useMemo(()=>({gizmoEditorData:s,mode:"test"}),[s]),l=ie(),d=ye(l,"1213809372"),u=ye(l,"1854238036");qn(n,s.defaultModel,void 0,s.id);const P=d||u,[c,_]=p.useState(0),j=()=>{_(m=>m-360)},v=s.id,S=li(n);p.useEffect(()=>Ys(ii,{test_gizmo_action:({rootDomain:m,operationName:U})=>{v&&S(v,m,U)}}),[S,v]);const y=p.useCallback(()=>e.jsx("div",{className:"h-full w-full",children:e.jsx($n,{gizmo:s,hideOwner:!0,showStarterPrompts:!0})}),[s]);return e.jsx(Us.Provider,{value:o,children:e.jsx(Vn,{clientThreadId:n,children:e.jsx("div",{className:he("flex h-full w-full",t&&"cursor-wait opacity-80 transition"),children:e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("div",{className:"relative mb-2 shrink-0",children:e.jsx("div",{className:"flex justify-center py-1",children:a&&e.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[e.jsx("div",{className:"icon"}),e.jsxs("button",{onClick:()=>{j(),i(Se())},className:"flex items-center gap-2",children:[e.jsx(f,{id:"2u/6Ja",defaultMessage:"Preview"}),e.jsx(Gs.div,{className:"text-token-text-primary",animate:{rotate:c},transition:{duration:.3},children:e.jsx(Qn,{className:"icon invisible group-hover:visible"})})]}),P&&e.jsx(ri,{clientThreadId:n,gizmoHasCustomActions:!!it(s.tools),preferredModelId:(T=s.defaultModel)!=null?T:void 0})]})})}),e.jsxs("div",{className:he("relative grow overflow-auto px-2",t&&"pointer-events-none"),children:[e.jsx(Fs,{clientThreadId:n,children:e.jsx(ot,{clientThreadId:n,hideHeader:!0,renderEmptyState:y()})}),e.jsx(ja.Sidebars,{children:e.jsx(ni,{clientThreadId:n,overrideWidth:0,isAutoFocusDisabled:!0})})]})]})})})})}const _s=Ns.memo(oi);function li(s){const t=Ks(s);return p.useCallback((n,i,r)=>{t({eventSource:"url",promptMessage:ln("Call the ".concat(i," API with the ").concat(r," operation"),{jit_plugin_data:{from_client:{type:"test",operation:r,tool_name:cn(i)}}}),completionMetadata:{conversationMode:{kind:de.GizmoTest,gizmo_id:n}}})},[t])}const ci=Vs(()=>Qs(()=>import("./evdizkj2x48kibvr.js"),__vite__mapDeps([39,1,2,3,40,4,5,41,42,43,44,45,46,27,28,29,47,48,49,50,51,52,53,54,55,34,35,8,56,33,57,58,59,60,61])).then(s=>s.GizmoActionsEditor));var mt=(s=>(s.MAGIC_MAKER="magic",s.ADVANCED="advanced",s.PREVIEW="preview",s))(mt||{});function Be({value:s,label:t,testId:a}){return e.jsx(et,{value:s,className:"text-md border-token-border-default text-token-text-tertiary hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] w-1/3 grow rounded-lg p-1.5 font-semibold transition md:w-1/2","data-testid":a,children:t})}function di({className:s,editorTab:t,setEditorTab:a}){const n=ee();return e.jsxs(Js,{className:he("bg-token-main-surface-secondary flex w-full overflow-hidden rounded-xl p-1.5 md:w-1/2",s),value:t,onValueChange:i=>{a(i)},children:[e.jsx(Be,{value:"magic",label:n.formatMessage(He.magicMakerLabel)}),e.jsx(Be,{value:"advanced",label:n.formatMessage(He.configureLabel),testId:"gizmo-editor-configure-button"}),e.jsx("div",{className:"flex w-1/3 md:hidden",children:e.jsx(Be,{value:"preview",label:n.formatMessage(He.previewLabel)})})]})}function ui(s,t){return s.length!==t.length?!1:s.every(a=>t.some(n=>n.type===a.type))}function mi(s,t){var a,n,i,r;return s.name===t.gizmo.display.name&&s.description===t.gizmo.display.description&&s.instructions===t.gizmo.instructions&&ui(s.tools,t.tools)&&Ye((n=(a=s.files)==null?void 0:a.map(o=>o.file_id))!=null?n:[],(r=(i=t.files)==null?void 0:i.map(o=>o.file_id))!=null?r:[])&&s.profilePictureUrl==t.gizmo.display.profile_picture_url&&s.profilePictureId==t.gizmo.display.profile_pic_id}const ft=({gizmo:s,onNewGizmoId:t})=>{var cs;const a=As(),n=Hs(),i=at(Ie.BrowsingAvailable),r=(n==null?void 0:n.includes(Ie.GizmoCanvasToggle))&&(n==null?void 0:n.includes(Ie.Canvas)),o=ie(),l=ye(o,"4148168517"),d=ee(),u=ue(),P=()=>{const b=[];i&&b.push({type:Z.BROWSER}),r&&b.push({type:Z.CANVAS});const G=I(x({},Ps),{tools:[...Ps.tools,...b]});return l?I(x({},G),{tools:[...G.tools.filter(R=>R.type!==Z.DALLE),{type:Z.IMAGE_GEN}]}):G},c=p.useRef(s!=null?ws(s):P()),_=p.useRef(s),j=p.useRef(c.current),[v,S]=p.useState(()=>c.current),[y,k]=p.useState(()=>Se()),[T]=p.useState(()=>({context_message:Pa(c.current),model_slug:Ee.GPT_4o,enabled_tools:[{tool_id:s!=null?"gizmo_editor":"gizmo_creator"}]}));Na(y,j.current,T);const{data:m}=Je({isGizmo:!0}),U=(cs=m==null?void 0:m.models.get(Os))!=null?cs:m&&Zs(m.models.values(),b=>b.tags.includes(Ee.GPT_4o)),{data:h}=gn(c.current.id),L=hn(),{isPending:M,error:C}=L,N=xn(),q=p.useMemo(()=>h!=null&&!mi(v,h),[v,h]),F=async()=>{var G;const b=c.current;try{const R=await L.mutateAsync({editorData:b,gizmoId:b.id});if(_.current=R,c.current.id==null){const K=R.gizmo.id;c.current=I(x({},c.current),{id:K,sharingTargets:R.gizmo.sharing_targets}),S(c.current),t==null||t(K)}for(const K of R.tools.filter(X=>X.type===Z.JIT_PLUGIN)){const X=c.current.tools.find(ve=>ve.type===Z.JIT_PLUGIN&&ve.metadata.domain===K.metadata.domain);X&&X.metadata.action_id!==K.metadata.action_id&&(X.metadata=I(x({},X.metadata),{action_id:K.metadata.action_id}),S(c.current))}return R}catch(R){const K=(G=$s(R))!=null?G:d.formatMessage(ut.errorSavingDraft);throw u.warning(K,{duration:2}),R}},H=p.useRef(void 0),V=async()=>c.current.id!=null?c.current.id:(H.current==null&&(H.current=F().then(b=>b.gizmo.id).catch(b=>{throw H.current=void 0,b})),H.current),[B]=p.useState(()=>vn(()=>F(),2e3,{trailing:!0})),z=p.useCallback((b,G=!0)=>{const R=typeof b=="function"?b(c.current):Jn(c.current,b);Ye(R,c.current)||(c.current=R,S(c.current),G&&B())},[B]),Y=p.useRef(void 0);p.useEffect(()=>Ys(jn,{completionFinished:async b=>{const G=b.serverThreadId;if(G==null){W(!1);return}try{const R=await wa(c.current,G,u,Y.current);R!=null&&(z(R),j.current=Ls(c.current))}catch(R){ze.addError(R),u.warning("Something went wrong generating your GPT",{duration:3})}finally{Y.current=ge.getCurrentNode(be(G)).message.id,W(!1)}}}),[u,z]);const g=Sa(y,T),[A,$]=p.useState(void 0);p.useEffect(()=>{$(da(s))},[s==null?void 0:s.gizmo.id]);const se=async(b,G)=>{var ve,ds;const R=Ne(c.current,b.recipient,G);if(R.length>0){u.warning("Could not save GPT:\n\n".concat(R.map(oe=>"- ".concat($e(oe))).join("\n")),{duration:3});return}const K=await F(),X=K.gizmo.id;try{return qs.logEvent("Promote Gizmo",{gizmo_id:K.gizmo.id,sharing_recipient:b.recipient,editor_tab:Q}),await N.mutateAsync({gizmoId:K.gizmo.id,data:{sharingSubjects:b.subjects,sharingRecipient:b.recipient,categories:G==null?void 0:[G]}},{onSuccess(Ge){a.setQueryData(vs(a,X).queryKey,Ge),a.invalidateQueries({queryKey:["gizmos"]}),a.invalidateQueries({queryKey:["gizmo",{gizmoId:X}]}),a.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:X}]})}})}catch(oe){if(oe instanceof Mn)$({gizmoId:X,sharingRecipient:b.recipient,moderationType:rt.PublishBlocked,sharingTargets:(ve=oe.response)==null?void 0:ve.sharing_targets,showModal:je.AppealAvailable});else{ze.addError(oe);const Ge=(ds=oe.detail)!=null?ds:"An unknown error occurred";u.warning("Error saving GPT - "+Ge,{duration:6})}}},[Q,re]=p.useState(()=>{const b=hs.getItem(xs.GizmoEditorTab);return Object.values(mt).includes(b)?b:"magic"});p.useEffect(()=>yn(()=>{const b=Dn(o).width;b!=null&&b>=768&&Q==="preview"&&re("magic")}),[o,Q]);const[me,fe]=p.useState(!1),[w,W]=p.useState(!1),[ls,Ae]=p.useState(void 0);return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[e.jsx(Wa,{gizmoEditorData:v,isUpsertLoading:L.isPending,isPromoteLoading:N.isPending,hasUnpublishedChanges:q,isUploadingProfilePic:me,isGeneratingProfilePic:w,publishedGizmo:h,updateGizmo:z,promoteGizmo:async(b,G)=>{const R=await se(b,G);return c.current=I(x({},c.current),{sharingRecipient:b.recipient}),S(c.current),hs.setItem(xs.GizmoEditorTab,Q),R},appealGizmo:async(b,G)=>{A!=null&&$(I(x({},A),{sharingRecipient:b,categories:G==null?void 0:[G],showModal:je.AppealAvailable}))},setAppealState:$,revertDraft:h!=null&&q?()=>{const b=a.getQueryData(vs(a,c.current.id).queryKey);if(b!=null){const G=ws(b);c.current=G,S(G),F()}}:void 0,draftMessage:e.jsx(ti,{isPublished:h!=null&&(h.gizmo.share_recipient==="marketplace"||h.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:q,isSavingDraft:M,upsertDraftError:C,className:"text-sm"}),showActionsModal:b=>{Ae(b)},className:"shrink-0"}),A&&e.jsx(ua,{appealState:A,onAppealClose:()=>$(I(x({},A),{showModal:je.None})),onAppealSubmitted:()=>$(I(x({},A),{showModal:je.AppealSent}))}),e.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[e.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:e.jsx("div",{className:"h-full grow overflow-hidden",children:ls!==void 0?e.jsx(ci,{currentlyEditingActionDomain:ls,gizmoEditorData:v,updateGizmo:z,onClose:()=>{Ae(void 0)}}):e.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[e.jsx("div",{className:"flex w-full flex-row justify-center",children:e.jsx(di,{editorTab:Q,setEditorTab:re,className:"mb-2 shrink-0 self-center"})}),e.jsx("div",{className:"grow overflow-hidden",children:Q==="magic"?e.jsx("div",{className:"h-full w-full",children:e.jsx(Ga,{gizmoEditorData:v,updateGizmo:z,clientThreadId:y,gizmoEditorDataRef:c,magicMakerBehaviorOverrides:T,magicMakerConversationGizmoEditorDataRef:j,requireGizmoId:V},y)}):Q==="advanced"?e.jsx(Da,{gizmoEditorData:v,updateGizmo:z,currentModelConfig:U,generateProfilePic:b=>{W(!0),g(b,c,j,Ia)},setIsUploadingProfilePic:fe,isGeneratingProfilePic:w,setIsGeneratingProfilePic:W,requireGizmoId:V,onShowActionsEditor:b=>{Ae(b)}}):e.jsx(_s,{gizmoEditorData:v,isSavingDraft:M,showTitle:!1})})]})})}),e.jsx("div",{className:he("border-token-border-medium bg-token-main-surface-secondary hidden w-1/2 justify-center border-s pt-4",Q!=="preview"&&"md:flex"),children:e.jsx("div",{className:"grow",children:e.jsx(_s,{gizmoEditorData:v,isSavingDraft:M})})})]})]})};function fi({gizmoId:s,version:t}){const{data:a}=mn({gizmoId:s,draft:!0,version:t}),n=Ce(Bs.accountUserId),i=fn(),r=i==null?void 0:i.id,o=pn(a)&&a!=null&&n!=null&&r!=null;return a==null||!o?null:e.jsx(ft,{gizmo:a})}function pi({onNewGizmoId:s}){return e.jsx(ft,{onNewGizmoId:s})}const gi=({gizmoId:s,remixSourceId:t,version:a})=>{const n=Me(),i=ie(),r=rs(i),o=p.useRef(void 0);p.useEffect(()=>(gs.enterGizmoEditor(),()=>{gs.exitGizmoEditor()}),[]);let l=s;return s!=null&&o.current===s&&(l=void 0),Xn({resetThreadAction:()=>{n("/")}}),r?l!==void 0?e.jsx(fi,{gizmoId:l,version:a},l):e.jsx(pi,{remixSourceId:t,onNewGizmoId:d=>{o.current=d,window.history.replaceState(window.history.state,"",un(d))}}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(is,{})})},He=xe({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});function hi(s){const t=Me();p.useEffect(()=>{s||t(bn(wn.NO_ACCESS))},[s,t])}const Ai=()=>(ea(),null),Gi=yt(function(){const t=ie(),a=rs(t),n=!!(a!=null&&a.hasPlusFeatures());hi(a==null||n);const i=Mt(),[r]=bt(),o=Me(),l=i.slug,d=r.get("version"),u=l?Pn(l):void 0,P=r.get("remixFrom");return p.useEffect(()=>{sa(!0).then(c=>{ta.initializeAndGatherData(c),na.initializeAndGatherData(c)})},[]),p.useEffect(()=>{a!=null&&!n&&o("/")},[a,o,n]),p.useEffect(()=>{u&&js(u)&&o("/g/".concat(l,"/project"))},[u,o,l]),!n||u&&js(u)?null:e.jsx(Tn,{children:e.jsx(gi,{gizmoId:u,remixSourceId:P!=null?P:void 0,version:d!=null?Number(d):void 0})})});export{ii as G,ai as a,Ai as c,Gi as g};
//# sourceMappingURL=hbsuqivsk96s60p6.js.map

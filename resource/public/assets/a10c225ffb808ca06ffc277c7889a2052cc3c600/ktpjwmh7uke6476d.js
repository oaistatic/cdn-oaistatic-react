const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fck11x3djvav0rp9.js","assets/jj85rqzpbnvv3emr.js"])))=>i.map(i=>d[i]);
var Xe=Object.defineProperty,Ze=Object.defineProperties;var Ye=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var he=(s,e,a)=>e in s?Xe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,E=(s,e)=>{for(var a in e||(e={}))et.call(e,a)&&he(s,a,e[a]);if(fe)for(var a of fe(e))tt.call(e,a)&&he(s,a,e[a]);return s},O=(s,e)=>Ze(s,Ye(e));import{ex as Me,e as Ne,aI as st,ey as Ie,i as Ee,f as Re,r as at,aE as Le,b as nt,hv as it,f8 as ot,f9 as h,T as ae,pv as T,$ as ye,a0 as je,C as Pe,dP as Ae,fb as rt,B as Z,lx as lt,eE as y,ff as ct,pw as $,ct as Oe,bi as dt,fv as ut,P as Y,bw as ve,R as mt}from"./lef5ym39glv4981l.js";import{b as U,j as t,r as I,u as xt,M as p,c as Q,f as gt,e as ee}from"./jj85rqzpbnvv3emr.js";import{gB as pt,fN as ft,gC as Te,gD as ht,a6 as Ue,gE as We,gF as ke,gG as we,dP as yt,gH as jt,bV as ne,gI as vt,gJ as kt,gK as wt,gL as bt,gM as St,gN as te,gO as _t,gP as be,bj as Ct}from"./mclphevd122040jw.js";import{S as Mt}from"./e6l4il48atvxq01x.js";import{L as Nt,R as It,X as Et}from"./ln8ki2e0zoiayj0p.js";import{a as Rt}from"./mcz3fk8dwdc0wesf.js";import{c as Lt,E as Pt}from"./h0k73bnwu158btqf.js";import{S as At,c as Se}from"./nuvef33udhwgu2hu.js";import"./fue7kd61xxcv74sk.js";const Ot=Me(()=>Ie(()=>import("./fck11x3djvav0rp9.js"),__vite__mapDeps([0,1])).then(s=>s.DirectorySyncResourceManagedIndication));function Tt({value:s,onChange:e,options:a,onSearch:d,placeholder:l,trailingComponent:r,isLoading:o,menuIsOpen:n,classNames:m}){const u=U(),f=u.formatMessage({id:"F+GhgL",defaultMessage:"People outside of your workspace cannot be added"}),x=i=>t.jsx(Se.IndicatorsContainer,O(E({},i),{children:r})),g=(i,k)=>k.context==="value"?i.label:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm",children:i.label}),i.sublabel&&t.jsx("span",{className:"text-token-text-secondary text-xs",children:i.sublabel})]}),i.kind==="group"&&i.isScimManaged&&t.jsx(Ot,{})]}),v=i=>{const{isFocused:k,isSelected:S,innerProps:L,innerRef:W,data:b}=i;return t.jsx("div",O(E({},L),{ref:W,className:Ne("cursor-pointer rounded-md p-2",S?"bg-token-interactive-bg-secondary-press":k?"bg-token-interactive-bg-secondary-hover":"bg-transparent"),children:g(b,{context:"menu"})}))},j=i=>t.jsx(Se.MultiValue,O(E({},i),{children:t.jsx("div",O(E({className:"text-token-text-primary bg-token-bg-secondary hover:border-token-border-light hover:bg-token-interactive-bg-secondary-hover m-1 cursor-pointer rounded-md border border-transparent px-1.5 py-1 text-sm",role:"button",tabIndex:0},i.removeProps),{children:t.jsxs("span",{className:"flex min-w-0 items-center gap-1",children:[t.jsx("span",{className:"min-w-0",children:i.children}),t.jsx(st,{className:"icon-sm"})]})}))}));return t.jsx(At,{className:"react-select-container min-w-0",classNamePrefix:"react-select",isMulti:!0,isClearable:!1,isLoading:o,menuIsOpen:n,options:a,value:s,classNames:m,getOptionValue:i=>"".concat(i.kind,":").concat(i.id),getOptionLabel:i=>i.label,onChange:i=>e(i),onInputChange:(i,k)=>{k.action!=="menu-close"&&k.action!=="input-blur"&&d(i)},placeholder:l,openMenuOnFocus:!0,openMenuOnClick:!0,hideSelectedOptions:!1,closeMenuOnSelect:!1,backspaceRemovesValue:!0,controlShouldRenderValue:!0,components:{DropdownIndicator:()=>null,ClearIndicator:()=>null,IndicatorsContainer:x,MultiValue:j,Option:v,MultiValueRemove:()=>null},formatOptionLabel:g,noOptionsMessage:()=>f,loadingMessage:()=>u.formatMessage(pt.loading),filterOption:(i,k)=>{var S;return i.data.label.toLowerCase().includes(k.toLowerCase())||((S=i.data.sublabel)!=null?S:"").toLowerCase().includes(k.toLowerCase())}})}const Ut=Me(()=>Ie(()=>import("./fck11x3djvav0rp9.js"),__vite__mapDeps([0,1])).then(s=>s.DirectorySyncResourceManagedIndication));function Be(s,e){return s===void 0||e===void 0?!1:s.split("__")[0]===e.split("__")[0]}function _e(s){return s.toLowerCase().trim()}function Wt(s,e){return s===void 0||e===void 0?!1:_e(s)===_e(e)}function Ce(s,e){return Be(s==null?void 0:s.user_id,e==null?void 0:e.id)||Wt(s==null?void 0:s.user_email,e==null?void 0:e.email)}function Bt(s,e){const a=new Set,d=new Set,l=new Set,r=new Set,o=[...s];for(const n of s)n.type===h.USER?a.add(n.user_id):n.type===h.EMAIL?l.add(n.user_email):n.type===h.GROUP?d.add(n.group_id):r.add(n.type);for(const n of e)if(n.type===h.EMAIL){if(l.has(n.user_email))continue;l.add(n.user_email),o.push(n)}else if(n.type===h.USER){if(a.has(n.user_id))continue;a.add(n.user_id),o.push(n)}else if(n.type===h.GROUP){if(d.has(n.group_id))continue;d.add(n.group_id),o.push(n)}else{if(r.has(n.type))continue;r.add(n.type),o.push(n)}return o}function Dt(s,e){const a=s.filter(d=>St(d));return e!=null&&a.push(e),a}function qt(s){return s.some(e=>e.type===h.ALL)?te.Link:s.some(e=>e.type===h.WORKSPACE)?te.WorkspaceLink:te.Private}function De(s){return s.can_write?"edit":"view"}function Kt(s){switch(s){case h.ALL:return"link";case h.WORKSPACE:return"workspaceLink";default:return"invite"}}function qe(s){"use forget";const e=Q.c(4),{subjectType:a,workspaceName:d}=s;if(a===h.ALL){let r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(p,{id:"Mr1Pk0",defaultMessage:"Anyone with a link"}),e[0]=r):r=e[0],r}if(a===h.WORKSPACE){let r;return e[1]!==d?(r=t.jsx(p,{id:"okIeDq",defaultMessage:"Anyone at {workspaceName} with the link",values:{workspaceName:d}}),e[1]=d,e[2]=r):r=e[2],r}let l;return e[3]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(p,{id:"fAE/rP",defaultMessage:"Only those invited"}),e[3]=l):l=e[3],l}const Vt=s=>e=>{var a,d;return e.kind==="user"?{type:h.USER,user_id:e.id,user_name:e.label,user_email:(a=e.sublabel)!=null?a:"",avatar_url:(d=e.avatarUrl)!=null?d:null,capabilities:s}:{type:h.GROUP,group_id:e.id,group_name:e.label,is_scim_managed:!!e.isScimManaged,capabilities:s}},$t=s=>e=>({type:h.EMAIL,user_email:e,capabilities:s}),Ft=({label:s,projectName:e,onConfirm:a,onClose:d})=>{"use forget";const l=U(),r=l.formatMessage({id:"tnQ4zL",defaultMessage:"{label, select, undefined {Remove from {projectName}?} other {Remove {label} from {projectName}}}?"},{label:s!=null?s:"undefined",projectName:e}),[o,n]=I.useState(!1);return t.jsx(Pe,{testId:"modal-snorlax-remove-user-confirmation-modal",isOpen:!0,onClose:()=>d(),type:"success",title:r,primaryButton:t.jsx(ve.Button,{title:l.formatMessage({id:"qvV5dW",defaultMessage:"Remove"}),color:"danger",onClick:async()=>{n(!0);try{await a(),d()}finally{n(!1)}},loading:o,disabled:o,"data-testid":"button-confirm-remove-user"}),secondaryButton:t.jsx(ve.Button,{title:l.formatMessage({id:"8Z8QAH",defaultMessage:"Cancel"}),disabled:o,color:"secondary",onClick:()=>d()}),children:t.jsx("div",{className:"text-token-text-secondary",children:t.jsx(p,{id:"QkibL8",defaultMessage:"{label, select, undefined {They} other {<b>{label}</b>}} will lose access to all contents in this project.",values:{label:s!=null?s:"undefined",b:m=>t.jsx("span",{className:"text-token-text-primary font-medium",children:m})}})})})};function gs({gizmo:s,publishedGizmo:e,onClose:a}){"use forget";var le,ce,de,ue,me,xe,ge,pe;const d=Ee(),l=U(),r=Re(),o=at(d),n=Le(),m=(le=o==null?void 0:o.isWorkspaceAccount())!=null?le:!1,u=nt(),f=l.formatMessage({id:"nJUofg",defaultMessage:"your workspace"}),x=(ce=n==null?void 0:n.name)!=null?ce:f,g=ft(),[v,j]=I.useState((ue=(de=s.sharing)==null?void 0:de.subjects)!=null?ue:[]),[i,k]=I.useState(!1),S=xt(),{canEdit:L}=it(e);I.useEffect(()=>{S.invalidateQueries({queryKey:ot(S,e.gizmo.id).queryKey})},[e.gizmo.id,S]);function W(c,w,C){return c.type===h.USER&&c.user_id.indexOf("__")===-1?O(E({},c),{user_id:c.user_id+"__"+(o==null?void 0:o.getWorkspaceId())}):c}async function b(c,w,C){var D,q;if(i)return;k(!0);const M=w?C.map(W):C,A=qt(M);try{const R=await g.mutateAsync({id:c,update:{sharing:{recipient:A,subjects:M}}});R!=null&&R.resource&&j(vt(R.resource).sharing.subjects)}catch(R){const X=ct(R);r.warning(X!=null?X:"Error",{duration:2}),j((q=(D=s.sharing)==null?void 0:D.subjects)!=null?q:[])}k(!1),S.invalidateQueries({queryKey:["gizmos"]}),S.refetchQueries({queryKey:["gizmos","discovery"]}),S.refetchQueries({queryKey:["gizmo",{gizmoId:c}]}),S.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:c}]}),S.invalidateQueries({queryKey:["workspace"]}),ye.count(je.PROJECTS,"snorlax_share_project_modal_invited_users",{is_workspace_sharing:w?"true":"false",num_users_invited:C.length.toString(),recipient:A})}const N=Be(e.gizmo.author.user_id.split("__")[0],u==null?void 0:u.id),_=Te(v),P=(_==null?void 0:_.type)!==h.WORKSPACE&&(_==null?void 0:_.type)!==h.ALL,K=P?Ae:m?Ue:We,B=t.jsx(p,{id:"wDjvNM",defaultMessage:"Only the owner can change permissions. Contact them if you'd like to update someone's access."}),$e=t.jsx(ae,{label:B,side:"top",children:t.jsx(qe,{subjectType:_==null?void 0:_.type,workspaceName:x})}),Fe=c=>t.jsx(ae,{label:B,side:"top",children:t.jsx("span",{className:"text-token-text-primary pe-4 text-sm",children:t.jsx(p,E({},F(c.capabilities)))})}),Qe=c=>t.jsxs(y.Root,{children:[t.jsxs(y.Trigger,{color:"secondary",className:"text-token-text-primary text-normal hover:bg-token-interactive-bg-secondary-hover radix-state-open:bg-token-interactive-bg-secondary-press whitespace-nowrap",disabled:i,children:[t.jsx(p,E({},F(c.capabilities))),t.jsx(ne,{className:"icon-sm"})]}),t.jsx(y.Portal,{children:t.jsxs(y.Content,{className:"max-w-[320px]",children:[t.jsx(y.RadioGroup,{value:De(c.capabilities),onValueChange:w=>{const C=v.map(M=>M===c?O(E({},M),{capabilities:w==="edit"?$:T}):M);j(C),b(e.gizmo.id,m,C)},children:[T,$].map((w,C)=>t.jsx(Ve,{capabilities:w,selected:Oe(w,c.capabilities)},C))}),t.jsx(y.Item,{onClick:()=>{var C;const w=we(c);dt(d,Ft,{label:(C=w==null?void 0:w.label)!=null?C:w==null?void 0:w.sublabel,projectName:e.gizmo.display.name,onConfirm:async()=>{const M=v.filter(A=>A!==c);j(M),await b(e.gizmo.id,m,M)}})},color:"danger",icon:Mt,children:t.jsx(p,{id:"HEaMqG",defaultMessage:"Remove from project"})})]})})]}),[V,ie]=I.useState(T),[z,G]=I.useState([]),[H,J]=I.useState([]),ze=z.length>0||H.length>0,oe=async()=>{const c=m?z.map(Vt(V)):H.map($t(V)),w=Bt(v,c);j(w),await b(e.gizmo.id,m,w),J([]),G([])},Ge=()=>{G([]),J([])},re=t.jsx(Z,{color:"secondary",disabled:i,onClick:Ge,children:t.jsx(p,{id:"Pxo4Mv",defaultMessage:"Cancel"})}),He=m?t.jsx("div",{className:"text-token-text-secondary flex text-xs",children:t.jsx(p,{id:"uAtWCq",defaultMessage:"Project files, chats, and instructions are shared."})}):null,Je=ze&&L?m?t.jsxs("div",{className:"flex items-center gap-2",children:[re,t.jsx(Z,{color:"blue",disabled:i,loading:i,onClick:oe,children:t.jsx(p,{id:"BdwAiM",defaultMessage:"Invite"})})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[re,t.jsx(Z,{color:"blue",disabled:i,loading:i,onClick:oe,children:t.jsx(p,{id:"n1mfg+",defaultMessage:"Invite"})})]}):t.jsx(zt,{gizmo:e,isBusinessWorkspace:m});return I.useEffect(()=>{ye.count(je.PROJECTS,"snorlax_share_project_modal_opened")},[]),t.jsx(Pe,{testId:"modal-share-project",type:"success",className:"max-w-[512px]",size:"custom",isOpen:!0,onClose:a,footerContent:He,footerClassName:"mt-5 sm:mt-4",modalActionsClassName:"mt-0!",footerIsSpacedBetween:!0,primaryButton:Je,title:l.formatMessage(yt.projectShareTitle),showCloseButton:!0,children:t.jsxs("div",{className:"flex flex-col space-y-4",children:[L&&(m?t.jsx(Ht,{publishedGizmo:e,capabilities:V,setCapabilities:ie,subjects:z,setSubjects:G}):t.jsx(Jt,{capabilities:V,setCapabilities:ie,emails:H,setEmails:J})),t.jsx("div",{className:"text-token-text-secondary mb-2 text-sm font-normal",children:t.jsx(p,{id:"eMoeS0",defaultMessage:"Who has access"})}),t.jsxs(ht,{className:"max-h-[220px] overflow-y-auto",children:[t.jsx(se,{icon:t.jsx("div",{className:"flex h-6 w-6 items-center justify-center",children:t.jsx(K,{className:P?"h-5 w-5":"h-6 w-6"})}),children:N?t.jsx(ss,{newSharingSubjects:v,setNewSharingSubjects:j,saveProject:b,publishedGizmo:e,isBusinessWorkspace:m,isSaving:i,workspaceName:x}):$e}),t.jsx(se,{icon:t.jsx(ke,{monogram:{id:(me=e.gizmo.author.user_id)!=null?me:"Owner",label:(xe=e.gizmo.author.display_name)!=null?xe:"User",sublabel:e.gizmo.author.user_email},showTooltip:!m}),trailing:t.jsx("span",{className:"text-token-text-primary pe-4 text-sm",children:t.jsx(p,{id:"qb439J",defaultMessage:"Owner"})}),children:N?t.jsx(p,{id:"I6hNog",defaultMessage:"{userName} {you}",values:{userName:(ge=u==null?void 0:u.name)!=null?ge:u==null?void 0:u.email,you:t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(p,{id:"VZNoWp",defaultMessage:"(you)"})})}}):(pe=e.gizmo.author.display_name)!=null?pe:e.gizmo.author.user_email}),v.map((c,w)=>{var M,A,D,q,R;const C=c.type===h.EMAIL;return rt(c)&&t.jsx(se,{icon:t.jsx(ke,{monogram:we(c),showTooltip:(c==null?void 0:c.user_name)&&(c==null?void 0:c.user_email)}),trailing:N?Qe(c):Fe(c),disabled:C,children:t.jsxs("div",{className:"flex flex-col justify-center",children:[m&&t.jsxs("span",{className:"flex flex-row items-center",children:[t.jsx("span",{className:"text-token-text-primary truncate text-sm leading-tight",children:c.type===h.GROUP?c.group_name:t.jsx(p,{id:"B3bf3E",defaultMessage:"{userName} {you}",values:{userName:c.user_name,you:Ce(c,u)?t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(p,{id:"VZNoWp",defaultMessage:"(you)"})}):null}})}),c.type===h.GROUP&&c.is_scim_managed&&t.jsx(Ut,{})]}),!m&&t.jsx("span",{className:"text-token-text-primary group-data-[disabled]/sharing-row:text-token-text-tertiary truncate text-sm leading-tight",children:Ce(c,u)?t.jsx(p,{id:"hxmjY2",defaultMessage:"{user} {you}",values:{user:(A=(M=c.user_name)!=null?M:c.user_email)!=null?A:"",you:t.jsx("span",{className:"text-token-text-secondary group-data-[disabled]/sharing-row:text-token-text-tertiary",children:t.jsx(p,{id:"VZNoWp",defaultMessage:"(you)"})})}}):C?t.jsx(p,{id:"L+nbVd",defaultMessage:"{email} {maybe_invite_sent}",values:{email:(D=c.user_email)!=null?D:"",maybe_invite_sent:t.jsx("span",{className:"text-token-text-secondary group-data-[disabled]/sharing-row:text-token-text-tertiary",children:t.jsx(p,{id:"FkuKTS",defaultMessage:"(invite sent)"})})}}):(R=(q=c.user_name)!=null?q:c.user_email)!=null?R:""})]})},w)}),t.jsx("hr",{className:"border-token-border-light sticky bottom-0 hidden group-data-scrolled-from-end/scrollport:block"})]}),!m&&t.jsx(Qt,{})]})})}function Qt(){return t.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-3 rounded-xl p-3",children:[t.jsx(ut,{className:"icon text-token-text-secondary"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-token-text-primary text-xs font-medium",children:t.jsx(p,{id:"pD1bmW",defaultMessage:"This project may include personal information"})}),t.jsx("span",{className:"text-token-text-secondary text-xs",children:t.jsx(p,{id:"EonGo6",defaultMessage:"All project contents are visible to collaborators. Personal memories are disabled for shared projects."})})]})]})}function zt({gizmo:s,isBusinessWorkspace:e}){const a=Ee(),d=Re(),l=kt(a,s),r=s.gizmo.display.name;return t.jsxs("div",{className:"flex flex-row items-center gap-2",children:[!e&&t.jsxs(t.Fragment,{children:[t.jsx("a",{href:"https://www.linkedin.com/shareArticle?url=".concat(encodeURIComponent(l),"&text=").concat(encodeURIComponent(r)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{Y.logEventWithStatsig("Share Project: LinkedIn Social Clicked","chatgpt_share_project_linkedin_social_clicked",{projectTitle:r})},children:t.jsx(Nt,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})}),t.jsx("a",{href:"https://www.reddit.com/submit?url=".concat(encodeURIComponent(l),"&title=").concat(encodeURIComponent(r)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{Y.logEventWithStatsig("Share Project: Reddit Social Clicked","chatgpt_share_project_reddit_social_clicked",{projectTitle:r})},children:t.jsx(It,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})}),t.jsx("a",{href:"https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(l),"&text=").concat(encodeURIComponent(r)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{Y.logEventWithStatsig("Share Project: X Social Clicked","chatgpt_share_project_x_social_clicked",{projectTitle:r})},children:t.jsx(Et,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})})]}),t.jsx(wt,{onClickCopy:o=>bt(a,s,d,o)})]})}function Ke(s){"use forget";const e=Q.c(23),{capabilities:a,onChange:d,triggerClassNames:l}=s;let r;e[0]!==l?(r=Ne("text-token-text-secondary hover:bg-token-interactive-bg-secondary-hover radix-state-open:bg-token-interactive-bg-secondary-press whitespace-nowrap",l),e[0]=l,e[1]=r):r=e[1];let o;e[2]!==a?(o=F(a),e[2]=a,e[3]=o):o=e[3];let n;e[4]!==o?(n=t.jsx(p,E({},o)),e[4]=o,e[5]=n):n=e[5];let m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(ne,{className:"icon-sm"}),e[6]=m):m=e[6];let u;e[7]!==r||e[8]!==n?(u=t.jsxs(y.Trigger,{color:"secondary",className:r,children:[n,m]}),e[7]=r,e[8]=n,e[9]=u):u=e[9];let f;e[10]!==a?(f=De(a),e[10]=a,e[11]=f):f=e[11];let x;e[12]!==d?(x=i=>{d(i==="edit"?$:T)},e[12]=d,e[13]=x):x=e[13];let g;e[14]!==a?(g=[T,$].map((i,k)=>t.jsx(Ve,{capabilities:i,selected:Oe(i,a)},k)),e[14]=a,e[15]=g):g=e[15];let v;e[16]!==f||e[17]!==x||e[18]!==g?(v=t.jsx(y.Portal,{children:t.jsx(y.Content,{className:"max-w-[320px]",children:t.jsx(y.RadioGroup,{value:f,onValueChange:x,children:g})})}),e[16]=f,e[17]=x,e[18]=g,e[19]=v):v=e[19];let j;return e[20]!==u||e[21]!==v?(j=t.jsxs(y.Root,{children:[u,v]}),e[20]=u,e[21]=v,e[22]=j):j=e[22],j}function F(s){return s.can_write?ee({id:"vsUknl",defaultMessage:"Can edit"}):s.can_view_config?ee({id:"4ceJzB",defaultMessage:"Can chat"}):ee({id:"x2E8ET",defaultMessage:"Unknown"})}function Gt(s){return s.can_write?_t:s.can_view_config?be:be}function Ve(s){"use forget";const e=Q.c(14),{capabilities:a,selected:d}=s,l=U();let r;e[0]!==a.can_write?(r=a.can_write?t.jsx(p,{id:"IShl7Y",defaultMessage:"Chat and edit project content"}):t.jsx(p,{id:"Ux4GYU",defaultMessage:"Chat and view project content"}),e[0]=a.can_write,e[1]=r):r=e[1];const o=r,n=a.can_write?"edit":"view",m=d?"selected":"default";let u;e[2]!==a?(u=Gt(a),e[2]=a,e[3]=u):u=e[3];let f;e[4]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx(y.RadioItemCheck,{}),e[4]=f):f=e[4];let x;e[5]!==a||e[6]!==l?(x=l.formatMessage(F(a)),e[5]=a,e[6]=l,e[7]=x):x=e[7];let g;return e[8]!==o||e[9]!==n||e[10]!==m||e[11]!==u||e[12]!==x?(g=t.jsx(y.RadioItem,{value:n,color:m,icon:u,trailing:f,label:x,secondary:o}),e[8]=o,e[9]=n,e[10]=m,e[11]=u,e[12]=x,e[13]=g):g=e[13],g}function Ht({publishedGizmo:s,capabilities:e,setCapabilities:a,subjects:d,setSubjects:l}){"use forget";var W;const r=U(),o=Le(),[n,m]=I.useState(""),[u]=Rt(n,100),f=jt(o==null?void 0:o.id,0,u,10),x=I.useMemo(()=>{var b,N,_;return(_=(N=(b=f.data)==null?void 0:b.items)==null?void 0:N.filter(P=>P.account_user_id!==(s==null?void 0:s.gizmo.author.user_id)).map(P=>{var K,B;return{kind:"user",id:P.account_user_id,label:(K=P.name)!=null?K:"Unknown User",sublabel:(B=P.email)!=null?B:""}}))!=null?_:[]},[(W=f.data)==null?void 0:W.items,s]),{data:g,isLoading:v}=gt({queryKey:[o==null?void 0:o.id,"groups","filtered",u],queryFn:o?()=>mt.safeGet("/accounts/{account_id}/groups",{parameters:{path:{account_id:o.id},query:{query:u,offset:0,orderby:"@score",limit:20}}}):void 0,enabled:u.trim()!==""&&o!=null&&!!o.getWorkspaceId()}),j=I.useMemo(()=>{var b;return(b=g==null?void 0:g.items.slice(0,10).map(N=>{var _;return{kind:"group",id:N.id,label:N.name,sublabel:r.formatMessage({id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}"},{numMembers:(_=N.num_members)!=null?_:0}),isScimManaged:!!N.is_scim_managed}}))!=null?b:[]},[g,r]),i=b=>"".concat(b.kind,":").concat(b.id),k=new Set(d.map(i)),S=[...x,...j].filter(b=>!k.has(i(b))),L=r.formatMessage({id:"hbjC0K",defaultMessage:"Search people or groups"});return t.jsx("div",{className:"w-full min-w-0",children:t.jsx(Tt,{value:d,classNames:{menuList:()=>"bg-token-bg-primary",control:()=>"h-auto! min-h-[40px]! max-h-[192px] items-start overflow-y-auto p-1! cursor-text!"},onChange:b=>l([...b]),onSearch:m,menuIsOpen:n.trim()!=="",options:S,placeholder:L,trailingComponent:d.length>0&&t.jsx(Ke,{capabilities:e,onChange:a,triggerClassNames:"text-token-text-secondary"}),isLoading:f.isLoading||v})})}function Jt(s){"use forget";const e=Q.c(15),{capabilities:a,setCapabilities:d,emails:l,setEmails:r}=s,o=U();let n;e[0]!==l?(n=l.map(ts),e[0]=l,e[1]=n):n=e[1];const m=n;let u;e[2]!==r?(u=S=>{const L=S.map(es);r(as(L))},e[2]=r,e[3]=u):u=e[3];const f=u;let x;e[4]!==o?(x=o.formatMessage({id:"Mabh3o",defaultMessage:"Email, separated by commas"}),e[4]=o,e[5]=x):x=e[5];const g=x,v=Yt;let j;e[6]===Symbol.for("react.memo_cache_sentinel")?(j={menuList:Zt,control:Xt},e[6]=j):j=e[6];let i;e[7]!==a||e[8]!==d?(i=t.jsx(Ke,{capabilities:a,onChange:d,triggerClassNames:"text-token-text-secondary"}),e[7]=a,e[8]=d,e[9]=i):i=e[9];let k;return e[10]!==m||e[11]!==f||e[12]!==g||e[13]!==i?(k=t.jsx("div",{className:"w-full min-w-0",children:t.jsx(Pt,{value:m,onChange:f,placeholder:g,classNames:j,trailingComponent:i,shouldShowTrailingComponent:v})}),e[10]=m,e[11]=f,e[12]=g,e[13]=i,e[14]=k):k=e[14],k}function Xt(){return"h-auto! min-h-[40px]! max-h-[192px] items-start overflow-y-auto p-0! cursor-text!"}function Zt(){return"bg-token-bg-primary"}function Yt(s,e){return s&&s.length>0?!0:!!(e&&Ct.test(e))}function es(s){return s.value}function ts(s){return Lt(s!=null?s:"")}function ss({newSharingSubjects:s,setNewSharingSubjects:e,saveProject:a,publishedGizmo:d,isBusinessWorkspace:l,isSaving:r,workspaceName:o}){var g;const n=U(),m=(g=Te(s))==null?void 0:g.type,u=m===h.WORKSPACE,f=m===h.ALL,x=u||f;return t.jsxs(y.Root,{children:[t.jsx(ae,{label:t.jsx(p,{id:"gWJtAX",defaultMessage:"Shared links give chat-only access. Users can be upgraded to edit access after joining."}),triggerAs:null,disabled:!x,side:"top",children:t.jsxs(y.Trigger,{className:"px-0","data-no-hover-bg":!0,disabled:r,children:[t.jsx(qe,{subjectType:m,workspaceName:o}),t.jsx(ne,{className:"icon-sm"})]})}),t.jsx(y.Portal,{children:t.jsx(y.Content,{children:t.jsxs(y.RadioGroup,{value:Kt(m),onValueChange:v=>{const j=Dt(s,v==="link"?{type:h.ALL,capabilities:T}:v==="workspaceLink"?{type:h.WORKSPACE,capabilities:T}:null);e(j),a(d.gizmo.id,l,j)},children:[t.jsx(y.RadioItem,{icon:Ae,value:"invite",label:n.formatMessage({id:"fAE/rP",defaultMessage:"Only those invited"}),trailing:t.jsx(y.RadioItemCheck,{}),color:x?"default":"selected"}),l&&t.jsx(y.RadioItem,{icon:Ue,value:"workspaceLink",label:n.formatMessage({id:"a6GwHG",defaultMessage:"Anyone at {workspaceName} with the link"},{workspaceName:o}),trailing:t.jsx(y.RadioItemCheck,{}),color:u?"selected":"default"}),!l&&t.jsx(y.RadioItem,{icon:We,value:"link",label:n.formatMessage({id:"Mr1Pk0",defaultMessage:"Anyone with a link"}),trailing:t.jsx(y.RadioItemCheck,{}),color:f?"selected":"default"})]})})})]})}function se({icon:s,children:e,trailing:a,className:d="",disabled:l=!1}){return t.jsxs("div",{className:"mb-1 flex min-h-9 flex-row items-center justify-between space-x-2 ".concat(d," group/sharing-row"),"data-disabled":lt(l),children:[t.jsx("div",{className:"shrink-0 grow-0",children:s}),t.jsx("div",{className:"text-token-text-primary grow truncate text-sm",children:e}),a&&t.jsx("div",{children:a})]})}function as(s){const e=new Set,a=[];for(const d of s){const l=d.toLowerCase();e.has(l)||(e.add(l),a.push(l))}return a}export{gs as ShareProjectModal};
//# sourceMappingURL=ktpjwmh7uke6476d.js.map

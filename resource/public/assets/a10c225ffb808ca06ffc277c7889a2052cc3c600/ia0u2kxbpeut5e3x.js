import{r as C,c as M,j as S}from"./jj85rqzpbnvv3emr.js";import{kB as L,kC as k,kD as x,cl as E,iW as R,ck as F}from"./mclphevd122040jw.js";import{ch as T,bJ as I,bI as v,dg as N,i as b}from"./lef5ym39glv4981l.js";function j(A,s){return w[s]}const w={inProgress:"Running tool",finished:"Finished running tool",error:"Error running tool"};function B({messages:A,isRequestActive:s,isLastMessageInTurn:m,clientThreadId:u}){"use forget";const c=A.filter(t=>t.author.role===T.Assistant&&t.recipient&&L(t.recipient)),g=I(u),d=g?v.getConversationTurns(g).flatMap(t=>t.messages):[],i=d.findLastIndex(t=>t.author.role===T.Assistant&&t.recipient&&L(t.recipient)),r=i>=0?d[i]:void 0,e=r&&r.recipient,f=i>=0?d.slice(i+1).filter(t=>t.author.role===T.Tool&&t.author.name===e):[],l=i>=0?d.slice(i+1).find(t=>t.author.role===T.Assistant&&(!t.recipient||!L(t.recipient))):void 0,h=l!=null&&N(l),y=f.length>0,o=r==null?void 0:r.id,n=k(t=>o?t.getToolState(u,o):void 0);let a=null;y||(n==null?void 0:n.status)===x.Finished?a={key:"finished",status:E.Finished}:(n==null?void 0:n.status)===x.Error?a={key:"error",status:E.Error}:((n==null?void 0:n.status)===x.Running||s&&m&&!n)&&(a={key:"inProgress",status:E.Running});const p=C.useMemo(()=>!e||!a?null:j(e,a.key),[e,a]);return c.length===0||!e||!c.some(t=>t.id===(r==null?void 0:r.id))||h||!a?null:{type:"message",message:p,display:a}}function O(A){"use forget";const s=M.c(20),{messages:m,isRequestActive:u,isLastMessageInTurn:c,clientThreadId:g,isWithinFirstAssistantTurns:d}=A,i=b();let r;s[0]!==g||s[1]!==c||s[2]!==u||s[3]!==m?(r={messages:m,isRequestActive:u,isLastMessageInTurn:c,clientThreadId:g},s[0]=g,s[1]=c,s[2]=u,s[3]=m,s[4]=r):r=s[4];const e=B(r);let f;s[5]!==i?(f=R(i),s[5]=i,s[6]=f):f=s[6];const{clearLoadingState:l,onUseLoadingText:h,areLoadingStatesEnabled:y}=f,o=d&&(e==null?void 0:e.type)==="message"&&e.message&&y;let n,a;if(s[7]!==o||s[8]!==l||s[9]!==e||s[10]!==h?(n=()=>{if((e==null?void 0:e.type)==="suggestion"){l();return}o&&e.message&&h(e.message)},a=[o,l,e,h],s[7]=o,s[8]=l,s[9]=e,s[10]=h,s[11]=n,s[12]=a):(n=s[11],a=s[12]),C.useEffect(n,a),!e||o||e.type==="suggestion")return null;let p;return s[17]!==e.display.status||s[18]!==e.message?(p=S.jsx(F,{highlightedCommand:e.message,showWorkUserSetting:!1,status:e.display.status,children:null}),s[17]=e.display.status,s[18]=e.message,s[19]=p):p=s[19],p}export{O as BrowserToolMessage};
//# sourceMappingURL=ia0u2kxbpeut5e3x.js.map

var se=Object.defineProperty,re=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var Y=(e,n,a)=>n in e?se(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,d=(e,n)=>{for(var a in n||(n={}))le.call(n,a)&&Y(e,a,n[a]);if(X)for(var a of X(n))ne.call(n,a)&&Y(e,a,n[a]);return e},P=(e,n)=>re(e,oe(n));import{b as v,r as y,j as m,g as G,M as K,s as H,ao as ce}from"./jj85rqzpbnvv3emr.js";import{R as me,i as ie,B as ue,f as fe,aE as J,P as W,v as de,ax as B,eL as pe}from"./lef5ym39glv4981l.js";import{c as i,S as z,F as V,a as ee,C as Q,L as ye}from"./cfjmhsr8xf6xwmmf.js";import{u as Se}from"./mueia064md5nlhd6.js";import{mi as he,mj as be,g2 as ge,mk as ae,d1 as _e,bg as we,fK as Te,g7 as Pe,gd as Ee,d5 as q,ml as xe,ga as Me,fV as Ne}from"./mclphevd122040jw.js";import{a as Ce,b as ve}from"./l041el2tch1t3nkf.js";import{u as Le,B as Ae}from"./bm60ocel3j0ixm99.js";import{S as je}from"./gd5k9khi2ma4fx2d.js";const $="country_code",F="step",D=e=>me.safePost("/accounts/pending_team_workspace",{requestBody:e}),Re=({formData:e,onNext:n})=>{var p,g;const a=v(),[s,u]=y.useState({role:(p=e.role)!=null?p:"",department:(g=e.department)!=null?g:""}),[r,S]=y.useState({}),h=(t,o)=>{u(b=>P(d({},b),{[t]:o})),S(b=>P(d({},b),{[t]:""}))},_=y.useMemo(()=>{const t=he.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return t.sort((o,b)=>o.label.localeCompare(b.label)),t},[a]),c=y.useMemo(()=>{const t=be.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return t.sort((o,b)=>o.label.localeCompare(b.label)),t},[a]),l=y.useMemo(()=>[{formType:"select",label:a.formatMessage(i.roleLabel),name:"role",placeholder:a.formatMessage(i.rolePlaceholder),value:s.role,onChange:t=>h("role",t),error:r.role,required:!0,options:c},{formType:"select",label:a.formatMessage(i.workspaceDepartmentLabel),name:"department",placeholder:a.formatMessage(i.workspaceDepartmentPlaceholder),value:s.department,onChange:t=>h("department",t),error:r.department,required:!0,options:_}],[_,r.department,r.role,s.department,s.role,a,c]),f=()=>{const t={};return l.forEach(o=>{o.required&&!s[o.name]&&(t[o.name]=a.formatMessage(i.fieldRequired,{fieldName:o.label}))}),S(t),Object.values(t).every(o=>!o)};return m.jsx(z,{content:m.jsxs(V,{title:a.formatMessage(i.tellUsAboutWorkStepTitle),subTitle:a.formatMessage(i.tellUsAboutWorkStepSubtitle),children:[m.jsx("div",{className:"flex flex-col gap-6",children:l.map(t=>y.createElement(ee,P(d({},t),{key:t.name})))}),m.jsx(Q,{onClick:async()=>{f()&&await n(s)}})]})})},Oe={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"},Ue=({onNext:e,onPrevious:n,pendingWorkspace:a,initialBillingDetails:s,formData:u})=>{var w,U;const r=v();ie();const S=Te(),{annualBillingPlan:h}=ge(s.currency),_=Math.floor(100-h.discountedMonthlyCost/h.monthlyCost*100),c=G(),l=(U=new URLSearchParams((w=a==null?void 0:a.query_params)!=null?w:"").get(ae))!=null?U:void 0,{selectedPlan:f,setSelectedPlan:p,numSeats:g,setNumSeats:t,promoData:o,TEAM1DOLLAR_COUPON_IsEligible:b,TEAM_FREE_TRIAL_COUPON_IsEligible:x}=Le({initialSeats:u==null?void 0:u.numSeats,initialPromoCoupon:l}),{eligible:L,campaignId:A}=_e(),j=!l&&L,M=o!=null?o:j?{coupon:A,state:"eligible",redemption:null}:void 0,N={priceInterval:f,billingDetails:s,numSeats:g,promoData:M},R=b||x,O=b?i.oneDollarPromoTitle:x?i.freeTrialPromoTitle:i.purchaseStepTitle,C=b?i.oneDollarPromoSubtitle:x?i.freeTrialPromoSubtitle:void 0,T=we(isNaN(g)?0:g,S,Pe);return m.jsx(z,{onPrevious:n?()=>n(d({},N)):void 0,content:m.jsxs(V,{title:r.formatMessage(O),subTitle:C&&r.formatMessage(C),children:[m.jsxs("div",{className:"flex flex-col gap-6",children:[m.jsx(Ee,{numSeats:g,minSeats:S,setNumSeats:t,classNames:Oe,label:m.jsx(K,d({},i.seatsCountLabel))}),m.jsxs("div",{className:"flex flex-col gap-1.5",children:[m.jsx(ye,{required:!0,children:r.formatMessage(i.planSummaryTitle)}),m.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(R&&f===q.FLEXIBLE)&&m.jsx(je,{ariaLabel:r.formatMessage(i.planTypeLabel),leftItem:{label:m.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:r.formatMessage(i.annualPlanLabel,{percent:_,span:I=>m.jsx("span",{className:"text-[#10A37F]",children:I})})}),value:q.ANNUAL},rightItem:{label:r.formatMessage(i.monthlyPlanLabel),value:q.FLEXIBLE},value:f,onChange:p}),m.jsx(Ae,{numSeats:T,selectedPlan:f,billingDetails:s,totalLabel:i.allPlansTodayTotal,billDate:r.formatMessage(i.today),promoData:M})]})]})]}),m.jsx(Q,{onClick:()=>e(d({},N))}),m.jsx(ue,{color:"ghost",onClick:()=>c("/"),children:m.jsx(K,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},Ie=({formData:e,onNext:n,onPrevious:a})=>{var p,g;const s=v(),[u,r]=y.useState({workspaceName:(p=e.workspaceName)!=null?p:"",companySize:(g=e.companySize)!=null?g:""}),[S,h]=y.useState({}),_=(t,o)=>{r(b=>P(d({},b),{[t]:o})),h(b=>P(d({},b),{[t]:""}))},c=xe.map(t=>({label:typeof t.displayValue=="string"?t.displayValue:s.formatMessage(t.displayValue),value:t.id})),l=y.useMemo(()=>[{formType:"input",label:s.formatMessage(i.workspaceNameLabel),name:"workspaceName",placeholder:s.formatMessage(i.workspaceNamePlaceholder),value:u.workspaceName,onChange:t=>_("workspaceName",t),error:S.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:s.formatMessage(i.workspaceCompanySizeLabel),name:"companySize",placeholder:s.formatMessage(i.workspaceCompanySizePlaceholder),value:u.companySize,onChange:t=>_("companySize",t),error:S.companySize,required:!1,options:c}],[S.companySize,S.workspaceName,u.companySize,u.workspaceName,s,c]),f=()=>{const t={};return l.forEach(o=>{o.required&&!u[o.name]&&(t[o.name]=s.formatMessage(i.fieldRequired,{fieldName:o.label}))}),h(t),Object.values(t).every(o=>!o)};return m.jsx(z,{onPrevious:a?()=>a(d({},u)):void 0,content:m.jsxs(V,{title:s.formatMessage(i.workspaceNameStepTitle),subTitle:s.formatMessage(i.workspaceNameStepSubtitle),children:[m.jsx("div",{className:"flex flex-col gap-6",children:l.map(t=>y.createElement(ee,P(d({},t),{key:t.name})))}),m.jsx(Q,{disabled:!u.workspaceName,onClick:async()=>{f()&&await n(d({},u))}})]})})};var te=(e=>(e.AboutWork="about-work",e.WorkspaceInfo="workspace-info",e.ConfigurePlan="configure-plan",e))(te||{});const qe=pe(Object.values(te),void 0),Ze=({pendingWorkspace:e})=>{var b,x,L,A,j,M,N,R,O,C;const n=v(),[a,s]=y.useState({workspaceName:(b=e==null?void 0:e.workspace_name)!=null?b:void 0,role:(x=e==null?void 0:e.role)!=null?x:void 0,department:(L=e==null?void 0:e.department)!=null?L:void 0,companySize:(A=e==null?void 0:e.company_size)!=null?A:void 0,numSeats:(j=e==null?void 0:e.seat_quantity)!=null?j:void 0});Ne((N=new URLSearchParams((M=e==null?void 0:e.query_params)!=null?M:"").get(ae))!=null?N:"");const u=Fe({data:a}),r=J(),S=H(),h=(C=(O=new URLSearchParams(S.search).get($))!=null?O:new URLSearchParams((R=e==null?void 0:e.query_params)!=null?R:"").get($))!=null?C:void 0,_=ce(),{country:c,userCountry:l}=Ce({initialCountryCode:h}),f=ve({country:c,currentAccount:r,location:"TeamDirectSignUpFlow"}),p=qe(e==null?void 0:e.step_name),{step:g,nextStep:t}=Be({initialStep:p&&E.includes(p)?p:void 0});y.useEffect(()=>{e||(()=>{var w;D({step_name:(w=e==null?void 0:e.step_name)!=null?w:E[0],query_params:S.search,user_segment:"v1"})})()},[]),y.useEffect(()=>{var I,k;const T=S.key,U=new URLSearchParams(window.location.search).get("referrer")||document.referrer;W.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",P(d({},r==null?void 0:r.subscriptionAnalyticsParams),{referrer:U,initialTab:e==null?void 0:e.step_name,currentTab:g,locationKey:T,navigationType:_,initialCountrySelectorCountry:h!=null?h:c,selectedCountry:(I=f.country)!=null?I:"",selectedCurrency:(k=f.currency)!=null?k:"",userCountry:l!=null?l:""}))},[g]);const o=()=>{switch(g){case"about-work":return m.jsx(Re,{formData:a,onNext:async T=>{const w=d(d({},a),T);s(w),await t(w)}});case"workspace-info":return m.jsx(Ie,{formData:a,onNext:async T=>{const w=d(d({},a),T);s(w),await t(w)}});case"configure-plan":return m.jsx(Ue,{formData:a,initialBillingDetails:f,onNext:async T=>{await u(d(d({},a),T))},pendingWorkspace:e});default:return null}};return m.jsxs(m.Fragment,{children:[m.jsx("title",{children:n.formatMessage(i.teamSignUpPageTitle)}),o()]})},Fe=({data:e})=>{const{prepareCheckoutSession:n,navigateToCheckout:a}=Se(),s=fe(),u=v(),r=J();return y.useCallback(async({priceInterval:h,billingDetails:_,numSeats:c,promoData:l})=>{var f;try{W.logEvent("Account Pay: Payment Checkout Clicked",P(d({planType:de.SELF_SERVE_BUSINESS},r==null?void 0:r.subscriptionAnalyticsParams),{referrer:document.referrer}));const p=await n({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:(f=e.workspaceName)!=null?f:"",price_interval:h,seat_quantity:c},billing_details:_,promo_campaign:h===q.FLEXIBLE?l==null?void 0:l.coupon:null,cancel_url:window.location.href});await a(p)}catch(p){B.addError(p),s.warning(u.formatMessage(Me.paymentErrorWarning),{hasCloseButton:!0})}},[r==null?void 0:r.subscriptionAnalyticsParams,e.workspaceName,u,a,n,s])},Z=(e,n)=>{const a=new URLSearchParams(window.location.search);Object.entries(e).forEach(([u,r])=>{a.set(u,r)});const s="".concat(window.location.pathname,"?").concat(a.toString());n?n(s,{replace:!1}):window.history.replaceState(null,"",s)},E=["configure-plan"],Be=({initialStep:e})=>{const n=G(),a=H(),[s,u]=y.useState(()=>{const c=e!=null?e:E[0];return Z({[F]:c}),c}),r=y.useCallback(c=>{u(c),Z({[F]:c},n)},[n]),S=y.useRef(null);y.useEffect(()=>{const l=new URLSearchParams(a.search).get(F);l!==S.current&&l&&E.includes(l)&&l!==s&&r(l),S.current=l},[a.search,r,s]);const h=async c=>{let l=s;const f=E.indexOf(s);f>=0&&f<E.length-1&&(l=E[f+1],r(l));try{await D({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:l,query_params:a.search,user_segment:"v1"})}catch(p){B.addError(p)}},_=y.useCallback(async c=>{let l=s;const f=E.indexOf(s);f>0&&(l=E[f-1],r(l));try{await D({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:l,query_params:a.search,user_segment:"v1"})}catch(p){B.addError(p)}},[a.search,r,s]);return{step:s,nextStep:h,previousStep:_}};export{Ze as C,F as S,Fe as u};
//# sourceMappingURL=d64g4smj0v6wfguu.js.map

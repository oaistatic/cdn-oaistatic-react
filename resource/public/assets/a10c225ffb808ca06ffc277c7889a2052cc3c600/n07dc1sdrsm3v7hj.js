var M=Object.defineProperty,T=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var S=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))k.call(t,n)&&S(e,n,t[n]);if(m)for(var n of m(t))A.call(t,n)&&S(e,n,t[n]);return e},h=(e,t)=>T(e,_(t));import{b as w,d as B,j as x}from"./jj85rqzpbnvv3emr.js";import{os as o}from"./lef5ym39glv4981l.js";import{ck as D,cl as g,cm as C}from"./mclphevd122040jw.js";const I=.75;function F({messages:e}){const t=w(),[n,s]=e,a=P(n,s);let l=g.Running,i=d.creatingPlan,r;switch(a.status){case"running":a.numTotalSubAgents>0&&a.numCompletedSubAgents/a.numTotalSubAgents>=I?i=d.almostDone:(i=d.running,r={numTasks:a.numTotalSubAgents});break;case"done":l=g.Finished,i=void 0;break;case"stopped":l=g.Stopped,i=d.cancelled;break}const u=i?t.formatMessage(i,r):null;return x.jsx(D,{highlightedCommand:u,status:l,showWorkUserSetting:!1})}function P(e,t){var r,u,c,p,f;const n=(f=(u=(r=t==null?void 0:t.metadata)==null?void 0:r.parallel_browse)==null?void 0:u.frontend_info.sub_agent_infos)!=null?f:(p=(c=e.metadata)==null?void 0:c.parallel_browse)==null?void 0:p.frontend_info.sub_agent_infos;let s,a=0,l=0;n!=null&&(s=j(n),a=s.length,l=s.filter(O).length);let i="planning";return C(e)?i="stopped":t!=null&&(i=l===a?"done":"running"),{status:i,subAgentInfos:s,numTotalSubAgents:a,numCompletedSubAgents:l}}function j(e){const t=Object.values(e).reduce((s,a)=>{const l=a.task_index;return s[l]==null&&(s[l]=[]),s[l].push(a),s},{});return Object.values(t).map(s=>h(b({},s[0]),{status:E(s)})).sort((s,a)=>s.task_index-a.task_index)}function E(e){const t=e.map(s=>s.status),n=[o.Starting,o.Running,o.Done,o.Error,o.Timeout,o.Cancelled];for(const s of n)if(t.some(a=>a===s))return s;return o.Starting}function O(e){return e.status===o.Done||e.status===o.Timeout||e.status===o.Error||e.status===o.Cancelled}const d=B({creatingPlan:{id:"parallelBrowsingMessage.creatingPlanV2",defaultMessage:"Making a research plan"},running:{id:"parallelBrowsingMessage.running_2",defaultMessage:"Visiting {numTasks, plural, one {# site} other {# sites}}"},almostDone:{id:"parallelBrowsingMessage.almostDone",defaultMessage:"Almost done"},cancelled:{id:"parallelBrowsingMessage.cancelledV2",defaultMessage:"Stopped doing research"},done:{id:"parallelBrowsingMessage.done",defaultMessage:"Finished research"}});export{F as default};
//# sourceMappingURL=n07dc1sdrsm3v7hj.js.map

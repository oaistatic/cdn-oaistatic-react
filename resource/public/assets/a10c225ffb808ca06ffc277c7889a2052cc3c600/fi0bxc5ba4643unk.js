const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/oxo0r33hqmhdtptf.js","assets/jj85rqzpbnvv3emr.js","assets/lef5ym39glv4981l.js","assets/root-ogjlcpyy.css","assets/mclphevd122040jw.js","assets/conversation-small-g7l5datj.css","assets/ob2j26h01aw8qfch.js","assets/eu5xc064k5tcc0d1.js","assets/fe3i8jtn19o2fvb7.js","assets/ht7of10t76s6p5h9.js","assets/l5ox8g3ngfir6cri.js","assets/gwboocxkq4dvejju.js","assets/hhmq1bzp7fcba7ax.js","assets/op3gurrbylc7rzc2.js","assets/jucwzbakxra299c6.js","assets/g2ai8r9l01vd7cnd.js","assets/i85f14wg6grpyd4s.js","assets/fiopi92hbqnf6y38.js","assets/fvtv66gbcyo8d83l.js","assets/chlp5hqnerwav69n.js","assets/ln8ki2e0zoiayj0p.js"])))=>i.map(i=>d[i]);
var qn=Object.freeze,Qn=Object.defineProperty,ml=Object.defineProperties;var gl=Object.getOwnPropertyDescriptors;var ra=Object.getOwnPropertySymbols;var Yn=Object.prototype.hasOwnProperty,Zn=Object.prototype.propertyIsEnumerable;var $n=(t,s,a)=>s in t?Qn(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,p=(t,s)=>{for(var a in s||(s={}))Yn.call(s,a)&&$n(t,a,s[a]);if(ra)for(var a of ra(s))Zn.call(s,a)&&$n(t,a,s[a]);return t},J=(t,s)=>ml(t,gl(s));var Fs=(t,s)=>{var a={};for(var n in t)Yn.call(t,n)&&s.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&ra)for(var n of ra(t))s.indexOf(n)<0&&Zn.call(t,n)&&(a[n]=t[n]);return a};var De=(t,s)=>qn(Qn(t,"raw",{value:qn(s||t.slice())}));import{f as ce,b as bt,a as Ds,bw as Le,dF as pt,C as xe,I as ks,R as ie,i as ee,d as Ft,E as Oe,dV as fl,dX as Xn,h3 as un,ar as Ts,as as Es,aE as Te,i9 as pl,bK as hl,t2 as xl,T as tt,B as W,fW as bl,e$ as Ml,j as oe,dJ as yl,J as Ea,eE as he,q9 as Cl,P as se,bP as vl,ax as Je,dA as Ps,ai as jl,ej as Wt,F as Fe,dM as Vs,dB as gi,y as Ys,dC as Sl,aD as fi,iK as pi,t_ as Jn,ae as Gt,t$ as hi,aJ as _l,u0 as eo,mY as Ls,rJ as wl,ek as ms,u1 as Nl,rL as xi,bv as fe,ez as Ss,a9 as Ht,L as bi,p as Mi,kN as yi,an as Zs,H as mn,kQ as kl,dK as Tl,dL as El,q as Va,t as Pl,e as ht,v as ke,fv as gn,a2 as Al,a6 as fn,r as gs,u2 as Dl,u3 as Ll,mm as Me,aC as Ci,u4 as pn,iI as Os,j4 as Be,j3 as K,u5 as Ol,u6 as Xe,u7 as to,dZ as so,bi as Ye,u8 as ao,kn as Ee,u9 as zt,ku as hn,t4 as xn,kq as Il,ua as vi,nL as bn,ub as ji,es as U,uc as Rl,eq as st,ud as Si,i5 as _i,i1 as wi,i0 as Bl,ue as Fl,i2 as Gl,h$ as Ul,m_ as Wl,uf as Hl,n1 as Ni,K as ki,M as Ti,m$ as Ks,i4 as zl,n0 as Vl,i3 as Kl,i6 as ql,eo as Pa,kw as $l,kx as Ql,ug as Yl,uh as _s,ui as Zl,f_ as Xl,uj as Mn,fN as xt,oc as Aa,sk as Jl,uk as ec,ex as jt,ul as Ei,ey as St,hx as Kt,a1 as ot,um as tc,s as ts,U as ge,id as sc,hj as Pi,u as ac,un as nc,uo as oc,n as Ai,fz as yn,py as ic,fB as as,fy as va,aA as rc,sA as lc,up as Xs,z as ja,mD as Cn,pz as cc,qc as fs,s6 as Di,oG as Li,fx as Da,lC as Oi,aI as Ii,kz as nt,fE as mt,fM as La,hZ as ve,uq as ns,ur as Ri,mZ as Js,us as Bi,p3 as Fi,ut as dc,uu as uc,uv as mc,uw as gc,ux as no,b$ as oo,uy as fc,fI as Oa,uz as pc,nM as ps,rH as hc,uA as xc,uB as bc,lH as Mc,t3 as yc,pi as Cc,uC as Gi,uD as Ui,uE as es,uF as Wi,uG as Hi,uH as zi,uI as Vi,uJ as Ki,uK as qi,rI as Ka,qI as qa,qS as vc,uL as jc,qE as Sc,pk as _c,uM as Ia,lA as wc,t9 as Is,uN as vn,uO as Nc,pq as os,uP as $i,uQ as kc,l3 as jn,uR as Tc,kU as Ec,pr as Pc,uS as Ac,er as an,hk as Sn,uT as At,uU as Dc,r7 as io,r1 as Lc,jv as Oc,k_ as Ic,l9 as ws,ba as Rc,fZ as Bc,r0 as Fc,q$ as Gc,tm as Uc,uV as Wc,jN as Ns,oh as ro,fp as Hc,fo as zc,fq as Vc,hn as Kc,pU as _n,uW as qc,A as $c,iv as lo,c1 as Qc,ce as Nt,N as vt,ct as Yc,s7 as Zc,h as ds,m as Xc,fw as Jc,cc as ed,uX as td,uY as sd,dW as ad,bo as nd,uZ as od,u_ as id,u$ as rd,l0 as ld,v0 as cd,d_ as dd,gh as Qi,v1 as Yi,f3 as ud,f4 as md,g_ as gd,v2 as kt,fg as co,fh as uo,c2 as fd,v3 as pd,bx as Zi,O as hd,d8 as xd,c as Ra,bu as wn,dO as Xi,v4 as bd,dP as Md,v5 as yd,aF as Cd,iL as mo,v6 as vd,oU as jd,v7 as Sd,sG as go,v8 as fo,nN as _d,rb as wd}from"./lef5ym39glv4981l.js";import{b as k,r as h,j as e,M as d,f as Ze,u as Ne,A as Nn,a as je,m as Ji,c as Mt,d as ae,s as Lt,g as $e,L as Vt,R as Dt,i as Ba,q as er,aA as tr,p as Nd,x as Fa}from"./jj85rqzpbnvv3emr.js";import{c6 as kd,cA as js,N as Td,au as qs,k1 as Ed,uY as Pd,j$ as Ad,k0 as Dd,a4 as kn,av as $a,pj as Ld,z4 as Od,dK as Id,z5 as Rd,wv as Bd,gt as As,g2 as Fd,fU as Gd,fV as Ud,g5 as Tt,g6 as ys,kf as Tn,g3 as Wd,g4 as Hd,fW as zd,kh as Vd,ao as Sa,fo as sr,oz as Gs,gw as Kd,gv as ar,tM as nr,om as Ga,fs as qd,fw as $d,fy as Qd,fq as Yd,fu as Zd,bq as Xd,z6 as or,k5 as ir,k6 as rr,k7 as lr,z7 as ss,oq as Re,z8 as Jd,z9 as eu,za as cr,p1 as dr,zb as tu,zc as ur,zd as En,ze as nn,zf as su,hz as ea,nU as Jt,bj as au,c9 as mr,bL as gr,gA as nu,kT as ou,mT as iu,a3 as Pn,zg as ru,tR as lu,aU as ta,hf as Bt,fB as cu,d7 as An,hg as du,zh as uu,qX as Ua,gu as Ot,Z as mu,bG as hs,be as Dn,bf as fr,qV as pr,bx as gu,by as fu,bz as pu,dq as $s,zi as _a,gb as hu,mf as on,p5 as xu,bu as Rs,c4 as yt,bs as xs,bK as hr,p8 as Ln,vR as sa,zj as ba,h8 as bu,cG as Mu,bO as yu,cU as Cu,ai as vu,oA as ju,bD as Qs,fn as rn,zk as Su,bV as xr,V as _u,eQ as wu,lW as Nu,lX as ku,bv as Tu,zl as Eu,bU as Pu,kt as z,ul as Au,bl as Du,bW as Lu,jZ as Ou,gO as br,gE as Iu,zm as Ru,zn as po,zo as Bu,zp as Fu,t2 as ln,gP as Mr,uW as Gu,zq as Uu,zr as be,bQ as Wu,zs as yr,zt as Cr,bS as Hu,zu as vr,zv as jr,hk as zu,zw as Vu,zx as Ku,bR as qu,zy as $u,zz as Sr,zA as _r,zB as wr,zC as Nr,zD as Qu,zE as Yu,zF as Qa,zG as Zu,zH as Zt,zI as Xu,zJ as Ju,zK as la,zL as ca,zM as em,zN as tm,m$ as sm,dw as kr,zO as am,g$ as nm,ad as om,ae as im,m2 as Tr,zP as rm,zQ as lm,a2 as cm,zR as dm,fQ as um,kv as mm,ap as gm,at as Et,zS as fm,bE as pm,rv as hm,fm as xm,zT as bm,zU as Mm,et as ym}from"./mclphevd122040jw.js";import{R as Cm}from"./hqfi3w6n0au8rjqf.js";import{s as ho,B as vm}from"./bx2wdn43543b9ysc.js";import{d as jm}from"./kl7c6054usfnqmd4.js";import{g as Sm}from"./k97n0y6ba9c9h39c.js";import{a as _m}from"./opuu93ocia4v1ksh.js";import{c as wm}from"./fvtv66gbcyo8d83l.js";import{G as Nm,A as km}from"./g4mp939381bmy3dx.js";import{T as Er}from"./kime2kclye4c7vau.js";import{u as Tm,a as Pr,b as Ar}from"./l041el2tch1t3nkf.js";import{a as Em,T as Pm,b as Am}from"./bm60ocel3j0ixm99.js";import{a as Dm,C as Lm}from"./n6vmm5pyahusdy8e.js";import{e as Dr,i as Om,h as Im,j as Rm,A as Bm,k as Fm,l as Gm,P as Um}from"./pb6aizka92emjg8u.js";import{u as Lr,a as Wm}from"./gpy5zl118575lsgg.js";import{P as Hm,i as zm}from"./jk4cx3iywxazx01l.js";import{b as Vm,a as Or}from"./fe3i8jtn19o2fvb7.js";import{l as aa,u as na}from"./iggidwj20lqhrnfm.js";import{S as Km,a as qm,b as $m}from"./c2on6xxmlbie222a.js";import{a as Qm}from"./mcz3fk8dwdc0wesf.js";import{G as Ym}from"./ob2j26h01aw8qfch.js";import{C as Zm}from"./iat1dicirypi0umq.js";import{S as bs}from"./se37gmxi13ugbmvr.js";import{s as oa}from"./lgin6mixrzyx9uwc.js";import{S as Xm}from"./hhmq1bzp7fcba7ax.js";import{S as Jm}from"./daioev77nl79ehf6.js";import{C as eg}from"./gg15fs79akbqrtq8.js";import{a as tg}from"./ewikj0vzclfii1lc.js";import{S as sg}from"./nuz80uov2gm1dlm5.js";import{i as ag,r as ng,c as og}from"./fr1sbwjfet6zl9mw.js";import{M as ig}from"./g4tl5lt9yqf20m4s.js";import{u as rg}from"./ht7of10t76s6p5h9.js";import{T as pe}from"./i5991cad8s41d2db.js";import{a as lg,E as cg}from"./blsgly9vru5i7r8m.js";import dg from"./mjxxdprrdnx86rg9.js";import{g as ug}from"./irqko7c1s7qpl41n.js";import"./ng0sx063g0r0whhb.js";import"./fvmxudg74tbhlabl.js";import"./hnotrmacgvnfyexv.js";import"./n5wrqpcxv1sjah44.js";import"./fiopi92hbqnf6y38.js";import"./gd5k9khi2ma4fx2d.js";import"./mueia064md5nlhd6.js";import"./eyi9jrf1bwm7dn6f.js";import"./eksfatdee5z30mgz.js";import"./bsf7l1uf8r87aw3y.js";import"./hc8beflnn681x6ow.js";import"./cfjmhsr8xf6xwmmf.js";import"./m46a0bw94g3hbrbv.js";import"./dta5t6ifyam55mk9.js";import"./lz6nvf1wtn80mpd2.js";import"./392jyrzapv8u4xa7.js";import"./be11s8wd1k6ws4r8.js";import"./w705jdvl4grquz0l.js";import"./oewf3dcf71lssqyb.js";function mg(t){return Ze({queryKey:["workspace",t,"owner_count"],queryFn:async()=>await ie.safeGet("/accounts/{account_id}/users/owner_count",{parameters:{path:{account_id:t}}})})}function gg({workspace:t}){var N;const s=k(),a=ce(),n=bt(),[o,i]=h.useState(""),r=t.isOwnerOfAccount(),l=mg(t.id),{data:c}=Ds(),[u,m]=h.useState(!1),[g,f]=h.useState(!1);if(!c)return null;const b=c.accountItems.find(w=>w.id!==t.id),M=()=>{pt.setLeaveWorkspaceData(null)},y=async()=>{if(n!==void 0){f(!0);try{await ie.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:t.id,user_id:n.id}}}),m(!0)}catch(w){a.danger(s.formatMessage({id:"leaveWorkspaceModal.leaveFailed",defaultMessage:"Failed to leave workspace"}),{toastId:"leave_workspace_modal",loggingTitle:"Failed to leave workspace",loggingDescription:"Error message when user fails to leave workspace"})}f(!1)}};if(u)return e.jsx(hg,{workspace:t,fallbackWorkspace:b,onClose:M});if(!l.data)return e.jsx(fg,{onClose:M});const C=l.data.total_count,_=l.data.owner_count;if(r&&_<2)return e.jsx(pg,{workspace:t,onClose:M});const v=e.jsx(Le.Button,{onClick:()=>{pt.setLeaveWorkspaceData(null)},title:s.formatMessage({id:"leaveWorkspaceModal.cancel",defaultMessage:"Cancel"})}),j=e.jsx(Le.Button,{color:"danger",disabled:n===void 0||g||o===""||o.toLowerCase()!==((N=n==null?void 0:n.email)==null?void 0:N.toLowerCase()),title:s.formatMessage({id:"leaveWorkspaceModal.leaveButton",defaultMessage:"Leave workspace"}),onClick:()=>y()}),S=s.formatMessage({id:"leaveWorkspaceModal.enterEmailToConfirm",defaultMessage:"Leave Workspace - Enter your email to confirm"});return e.jsx(xe,{testId:"modal-leave-workspace",isOpen:!0,onClose:M,showCloseButton:!0,type:"danger",title:s.formatMessage({id:"leaveWorkspaceModal.leaveWorkspace",defaultMessage:"Leave the {workspaceName} workspace"},{workspaceName:t.data.name}),primaryButton:j,secondaryButton:v,children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsx(kd,{size:"large",src:t.data.profilePictureUrl}),e.jsxs("div",{className:"flex flex-col justify-around",children:[e.jsx("div",{className:"text-base font-semibold",children:t.data.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.jsx(d,{id:"leaveWorkspaceModal.memberCount",defaultMessage:"{memberCount, plural,\n                  one {1 member}\n                  other {{memberCount} members}\n                }",values:{memberCount:C}})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 text-base font-semibold",children:e.jsx(d,{id:"leaveWorkspaceModal.leaveAreYouSure",defaultMessage:"Are you sure?"})}),e.jsxs("ul",{className:"text-token-text-secondary ms-3 list-disc text-sm",children:[e.jsx("li",{className:"mb-2",children:e.jsx(d,{id:"leaveWorkspaceModal.leaveWorkspaceWarning1",defaultMessage:"This will remove you from your workspace and you won't be able to access all data, including profile, settings, and chat history."})}),e.jsx("li",{children:e.jsx(d,{id:"leaveWorkspaceModal.leaveWorkspaceWarning2",defaultMessage:"You will lose access to all channels and messages in this workspace."})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 text-base font-semibold",children:S}),e.jsx(ks,{ariaLabel:S,name:"typeEmailConfirm",placeholder:"abcd@acme.com",value:o,onChange:w=>{i(w.target.value)}})]})]})})}function fg({onClose:t}){return e.jsx(xe,{testId:"modal-empty-loading",isOpen:!0,onClose:t,showCloseButton:!0,type:"warning",children:e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx(Oe,{})})})}function pg({workspace:t,onClose:s}){const a=k(),n=e.jsx(Le.Button,{onClick:()=>{pt.setLeaveWorkspaceData(null)},title:a.formatMessage({id:"leaveWorkspaceModal.ok",defaultMessage:"OK"})});return e.jsx(xe,{testId:"modal-cant-leave-workspace",isOpen:!0,onClose:s,showCloseButton:!0,type:"danger",title:a.formatMessage({id:"leaveWorkspaceModal.cantLeaveWorkspace",defaultMessage:"Couldn't leave the {workspaceName} workspace"},{workspaceName:t.data.name}),secondaryButton:n,children:e.jsx(d,{id:"leaveWorkspaceModal.lastOwnerWarning",defaultMessage:"Because you're the only owner in the {workspaceName} workspace, assign the owner role to another member before leaving.",values:{workspaceName:t.data.name}})})}function hg({workspace:t,fallbackWorkspace:s,onClose:a}){const n=Ne(),o=k(),i=ce(),r=ee(),l=Ft(m=>m.currentWorkspace),c=()=>{if(s!==void 0&&l)if(pt.setLeaveWorkspaceData(null),l.id===t.id){const{willRedirect:m}=fl(n,s.id,r,o,i);m||Xn()}else n.invalidateQueries(un());else pt.setLeaveWorkspaceData(null),Ts.deleteCookie(Es.Workspace),Ts.deleteCookie(Es.WorkspaceResidencyRegion),Xn();a()},u=s!==void 0?e.jsx(Le.Button,{color:"primary",onClick:c,title:o.formatMessage({id:"leaveWorkspaceModal.done",defaultMessage:"Done"})}):e.jsx(Le.Button,{color:"primary",onClick:c,title:o.formatMessage({id:"leaveWorkspaceModal.startPersonalAccount",defaultMessage:"Start using ChatGPT for free"})});return e.jsx(xe,{testId:"modal-left-workspace",isOpen:!0,onClose:c,primaryButton:u,type:"success",title:o.formatMessage({id:"leaveWorkspaceModal.leftWorkspaceTitle",defaultMessage:"Successfully left the {workspaceName} workspace"},{workspaceName:t.data.name}),children:e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx("p",{children:s!==void 0?e.jsx(d,{id:"leaveWorkspaceModal.leftWorkspaceDescription",defaultMessage:"You have successfully left the {workspaceName} workspace.",values:{workspaceName:t.data.name}}):e.jsx(d,{id:"leaveWorkspaceModal.leftWorkspaceDescriptionNoOtherWorkspaces",defaultMessage:"You have successfully left the {workspaceName} workspace. This will create your personal workspace automatically.",values:{workspaceName:t.data.name}})})})})}function Ir(t){var s;return!t||!t.attachments||t.attachments.length===0||t.attachments[0].kind!=="deep_research"?null:{permissions:(s=t.permissions.share_setting)!=null?s:"public",postId:t.id,messages:t.attachments[0].messages}}const xg=window.location.origin+"/s/";function Ya(t){return"".concat(xg).concat(t)}function zs(t){return["research","result","share",t]}const bg=window.location.origin+"/post/...";function Mg({taskId:t,isLoading:s,sharedResearchResult:a,title:n,serverThreadId:o}){var _;const[i,r]=h.useState(!1),l=(v,j)=>{v&&kn(v,void 0,j).then(()=>{r(!0),setTimeout(()=>{r(!1)},1500)}).catch(()=>{})},c=Ne(),u=ce(),{mutate:m,isPending:g}=je({scope:{id:t},mutationFn:async v=>{const j=await ie.safePost("/share/post",{requestBody:{attachments_to_create:[{kind:"deep_research",conversation_id:o,task_id:v}]}});return Ir(j.post)},onSuccess:v=>{if(!v){u.danger("Failed to create share link");return}c.setQueryData(zs(t),v),l(Ya(v.postId))}}),{mutate:f}=je({scope:{id:(_=a==null?void 0:a.postId)!=null?_:""},mutationFn:async({sharedResearchResultId:v,access:j})=>(await ie.safePost("/share/post/update_access",{requestBody:{post_id:v,share_settings:j}})).share_setting,onMutate:({access:v})=>{const j=zs(t),S=c.getQueryData(j);return c.setQueryData(j,S&&J(p({},S),{permissions:v})),{previousAccess:S==null?void 0:S.permissions}},onSuccess:v=>{const j=zs(t),S=c.getQueryData(j);S&&c.setQueryData(j,J(p({},S),{permissions:v}))},onError:(v,j,S)=>{var A;const N=zs(t),w=c.getQueryData(N);c.setQueryData(N,w&&J(p({},w),{permissions:(A=S==null?void 0:S.previousAccess)!=null?A:"public"}))}}),x=h.useRef(null),b=v=>{var j;(j=x.current)==null||j.focus(),a?l(Ya(a.postId),v):m(t)},M=v=>{a&&f({sharedResearchResultId:a.postId,access:v})},y=a?Ya(a.postId):void 0,C=v=>{switch(v){case"public":return $a.PUBLIC;case"private":return $a.PRIVATE;case"workspace":return $a.WORKSPACE}};return e.jsx(vm,{inputRef:x,isLoading:s,isPublishedVersionLatest:!0,sharedObject:a&&{id:a.postId,title:n,access:C(a.permissions)},title:n,shareTextPlaceholder:bg,shareUrl:y,isCopySuccessful:i,isCreateLinkRequestInProgress:g,handlePrivacyChange:M,handlePrimaryButtonClick:b})}function yg({taskId:t,isDisabled:s,title:a,threadId:n}){const o=Te(),i=pl(),r=k(),l=hl(n),{data:c,isLoading:u}=Ze({enabled:!!t&&!s,queryKey:zs(t),queryFn:async()=>{if(!l)return null;const y=await ie.safeGet("/share/post/by_research_task/{task_id}",{parameters:{path:{task_id:t}}});return y.post?Ir(y.post):null}}),[m,g]=h.useState(!1),{triggerRef:f,container:x}=xl({isOpen:m,onClose:()=>g(!1)}),b=(o==null?void 0:o.isWorkspaceAccount())&&!(o!=null&&o.features.includes(js.WorkspaceShareLinks));if(s||b||!l||i)return e.jsx(tt,{label:b?r.formatMessage(ho.workspaceSharingDisabled):r.formatMessage(ho.share),children:e.jsx(Td,{disabled:!0,icon:qs})});const M=({className:y})=>e.jsxs("div",{className:"relative h-fit w-fit",children:[e.jsx(qs,{className:y}),c&&e.jsx("div",{className:"absolute end-0 top-[1px] flex items-center gap-1.5",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full"})})]});return e.jsxs(Ed,{open:m,onOpenChange:g,children:[e.jsx(Pd,{ref:f,asChild:!0,children:e.jsxs(W,{children:[e.jsx(M,{className:"me-1 h-4 w-4"}),e.jsx(d,{id:"vaZOk/",defaultMessage:"Share Link"})]})}),e.jsx(Nn,{children:m&&e.jsx(Ad,{forceMount:!0,container:x,children:e.jsx(Dd,{align:"end",className:"z-50",sideOffset:8,collisionPadding:8,children:e.jsx(Mg,{title:a,taskId:t,sharedResearchResult:c,isLoading:u,serverThreadId:l})})})})]})}const Cg=({messages:t,threadId:s,taskId:a})=>{var j;const n=k(),[o,i]=h.useState(!0),r=h.useRef(null),l=bl(s),c=Ml(t),[u,m]=h.useState(!1),g=ce(),f=ee(),x=oe(f,"3930843960"),b=oe(f,"1596731578"),M=n.formatMessage({id:"deepresearch.downloadFileError",defaultMessage:"Failed to download file. Please try again later."}),y=async S=>{var N;if(c){if(!l){g.warning("Failed to download file. Please try refreshing the page."),se.logEventWithStatsig("Deep Research Export Missing serverThreadId","deep_research_export_missing_serverthreadid");return}m(!0);try{const w=vl(c),A=await ie.safePost("/export_doc/deep_research",{requestBody:{conversation_id:l,message_id:c.id,export_type:S},skipJsonTransform:!0});if(!A.ok)throw A.status>=400&&A.status<600&&g.danger(M,{toastId:"deep_research_share_modal",loggingTitle:M,loggingDescription:"Error message when a file download fails"}),new Error("Failed to download file");const T=await A.blob(),P=A.headers.get("Content-Disposition"),E=(N=Sm(P))!=null?N:"ChatGPT Deep Research.".concat(S);jm(T,E),Bd(f,{source:"mouse",type:"download",selectedText:w,location:"research-report",contentType:"text",messageId:c.id,serverThreadId:l,productLogOnly:!0})}catch(w){Je.addError(w)}finally{m(!1)}}},C=()=>{i(!1),r.current=setTimeout(()=>{Rd.setResearchShareIntent(null)},400)},_=(j=c==null?void 0:c.metadata)==null?void 0:j.async_task_title,v=yl();return _?e.jsx(Nn,{children:e.jsx(Le.Root,{isOpen:o,onClose:C,className:"container",testId:"modal-deep-research-share",children:e.jsx(Le.Overlay,{showBackground:!0,children:e.jsx(Le.Content,{size:"normal",className:"flex max-w-4xl flex-col bg-transparent focus:outline-hidden",children:e.jsxs(Ji.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:v?Ld:Od,className:"bg-token-bg-primary flex max-w-4xl flex-col overflow-x-scroll rounded-2xl focus:outline-hidden",children:[e.jsx(Le.Header,{type:"success",title:e.jsx("p",{className:"text-token-text-primary ps-2",children:e.jsx(d,{id:"pV8JSS",defaultMessage:"Preview"})}),closeButtonSide:"left",accessory:e.jsxs(e.Fragment,{children:[x&&l!==void 0&&e.jsxs(he.Root,{open:u?!1:void 0,children:[e.jsx(he.BasicTrigger,{asChild:!0,children:e.jsx(W,{disabled:u,loading:u,color:"secondary",icon:Id,children:n.formatMessage({id:"deepresearch.download-button",defaultMessage:"Download"})})}),e.jsx(he.Portal,{children:e.jsxs(he.Content,{align:"end",children:[e.jsx(he.Item,{onClick:S=>{S.preventDefault(),y("pdf")},children:n.formatMessage({id:"deepresearch.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),b&&e.jsx(he.Item,{onClick:S=>{S.preventDefault(),y("docx")},children:n.formatMessage({id:"deepresearch.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})})]})})]}),e.jsx(yg,{taskId:a,isDisabled:!1,title:_,threadId:s})]}),closeButton:e.jsx(Ea,{onClick:C,iconSize:"lg"})}),e.jsx("div",{className:"@container/thread flex min-w-0 flex-col gap-4 px-12 py-8",children:e.jsx(Cl,{children:e.jsx(Cm,{messages:t,threadId:s})})})]})})})})}):null};function vg(){"use forget";const t=Mt.c(13),s=k(),a=Ps(_g),n="https://platform.openai.com/verify-age";let o;t[0]!==s?(o=s.formatMessage(Pt.title),t[0]=s,t[1]=o):o=t[1];let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx("p",{className:"mb-4",children:e.jsx(d,p({},Pt.description0))}),t[2]=i):i=t[2];let r;t[3]===Symbol.for("react.memo_cache_sentinel")?(r=e.jsx(xo,{children:e.jsx(d,p({},Pt.subtitle1))}),t[3]=r):r=t[3];let l;t[4]===Symbol.for("react.memo_cache_sentinel")?(l=e.jsxs("ol",{className:"ms-4 mb-4 list-decimal",children:[e.jsx("li",{className:"",children:e.jsx(d,p({},Pt.description1Bullet1))}),e.jsx("li",{children:e.jsx(d,p({},Pt.description1Bullet2))})]}),t[4]=l):l=t[4];let c;t[5]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("p",{className:"mb-4 font-semibold",children:e.jsx(d,p({},Pt.description1a))}),t[5]=c):c=t[5];let u;t[6]===Symbol.for("react.memo_cache_sentinel")?(u=e.jsx("p",{className:"mb-4",children:e.jsx(d,p({},Pt.description1b))}),t[6]=u):u=t[6];let m;t[7]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx(xo,{children:e.jsx(d,p({},Pt.subtitle2))}),t[7]=m):m=t[7];let g;t[8]===Symbol.for("react.memo_cache_sentinel")?(g=e.jsxs("div",{className:"text-token-text-secondary",children:[i,r,l,c,u,m,e.jsx("p",{className:"mb-4",children:e.jsx(d,J(p({},Pt.description2),{values:{learnMoreLink:Sg}}))})]}),t[8]=g):g=t[8];let f;t[9]===Symbol.for("react.memo_cache_sentinel")?(f=e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(W,{color:"primary",as:"link",to:n,openNewTab:!0,onClick:jg,icon:As,children:e.jsx(d,p({},Pt.redirect))})}),t[9]=f):f=t[9];let x;return t[10]!==a||t[11]!==o?(x=e.jsxs(xe,{testId:"modal-age-verification-interstitial",type:"success",isOpen:a,onClose:jl,title:o,children:[g,f]}),t[10]=a,t[11]=o,t[12]=x):x=t[12],x}function jg(){return pt.closeModal(Wt.AgeVerificationInterstitial)}function Sg(t){return e.jsx("a",{href:"https://help.openai.com/en/articles/8411987-why-am-i-being-asked-to-verify-my-age",target:"_blank",rel:"noreferrer",className:"cursor-pointer font-normal underline",children:t})}function _g(t){return t.activeModals.has(Wt.AgeVerificationInterstitial)}var qo;const xo=Fe.h3(qo||(qo=De(["text-token-text-primary text-base mb-1"]))),Pt=ae({title:{id:"AgeVerificationInterstitial.title",defaultMessage:"Please verify your age"},redirect:{id:"AgeVerificationInterstitial.redirect",defaultMessage:"Sign in on platform.openai.com"},description0:{id:"AgeVerificationInterstitial.description0",defaultMessage:"To continue using ChatGPT, you need to complete a brief age verification check"},subtitle1:{id:"AgeVerificationInterstitial.title1",defaultMessage:"What will happen next?"},description1Bullet1:{id:"AgeVerificationInterstitial.description1",defaultMessage:"You will be redirected to platform.openai.com where you will need to sign in."},description1Bullet2:{id:"AgeVerificationInterstitial.description2",defaultMessage:"You will then be redirected to Yoti, our age verification provider, to verify your age."},description1a:{id:"AgeVerificationInterstitial.description1a",defaultMessage:"If you are between the ages of 13 and 17, your parent or guardian must complete the age verification check on your behalf."},description1b:{id:"AgeVerificationInterstitial.description1b",defaultMessage:"The process is quick and secure."},subtitle2:{id:"AgeVerificationInterstitial.title2",defaultMessage:"Why do I need to do this?"},description2:{id:"AgeVerificationInterstitial.description2-v3",defaultMessage:"We are required to verify that our users in Italy are old enough to use ChatGPT. <learnMoreLink>Learn more</learnMoreLink>."}}),wg=()=>{var o;const t=bt(),s=(o=t==null?void 0:t.email)!=null?o:t==null?void 0:t.phone_number,a=Ps(i=>i.activeModals.has(Wt.LogoutConfirm)),n=()=>{pt.closeModal(Wt.LogoutConfirm)};return e.jsx(xe,{testId:"modal-logout-confirm",isOpen:a,onClose:n,showCloseButton:!1,type:"warning",noPadding:!0,size:"custom",className:"max-w-[373px] sm:max-w-[400px]",position:"center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-8 sm:p-10",children:[e.jsx("p",{className:"text-center text-2xl font-semibold text-balance",children:e.jsx(d,p({},da.logoutTitle))}),e.jsx("p",{className:"text-token-text-secondary mt-4 mb-6 text-center text-lg",children:s&&e.jsx(d,J(p({},da.logoutConfirm),{values:{emailOrPhone:s}}))}),e.jsx(W,{as:"button",size:"large",color:"primary",fullWidth:!0,className:"mb-2 sm:mb-3","data-testid":"logout-confirm-button",onClick:Vs,children:e.jsx(d,p({},da.logoutConfirmButton))}),e.jsx(W,{as:"button",size:"large",color:"secondary",fullWidth:!0,onClick:n,children:e.jsx(d,p({},da.cancel))})]})})},da=ae({logoutTitle:{id:"biVnvR",defaultMessage:"Are you sure you want to log out?"},logoutConfirm:{id:"2aSIBu",defaultMessage:"Log out of ChatGPT as {emailOrPhone}?"},logoutConfirmButton:{id:"NeO/CC",defaultMessage:"Log out"},cancel:{id:"EORcAJ",defaultMessage:"Cancel"}}),Ng=t=>h.createElement("svg",p({width:24,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M20.5909 7.2368C19.8969 7.66168 19.3221 8.25568 18.9202 8.96321C18.5183 9.67075 18.3025 10.4687 18.2929 11.2823C18.2957 12.1981 18.567 13.0929 19.0733 13.856C19.5796 14.6191 20.2986 15.2169 21.1413 15.5754C20.809 16.6474 20.3173 17.6632 19.6827 18.5888C18.7746 19.8961 17.825 21.2032 16.3803 21.2032C14.9355 21.2032 14.564 20.3638 12.899 20.3638C11.2753 20.3638 10.6974 21.2308 9.37637 21.2308C8.0554 21.2308 7.13358 20.0198 6.074 18.5338C4.67437 16.452 3.90515 14.0106 3.85864 11.5024C3.85864 7.37443 6.5419 5.18665 9.18372 5.18665C10.5873 5.18665 11.7569 6.10847 12.6376 6.10847C13.4769 6.10847 14.7842 5.1315 16.3803 5.1315C17.2009 5.11032 18.0142 5.29127 18.7485 5.6584C19.4827 6.02553 20.1154 6.56757 20.5909 7.2368ZM15.6235 3.38405C16.3271 2.55637 16.7254 1.51233 16.7519 0.426336C16.7531 0.28317 16.7392 0.140275 16.7106 0C15.502 0.11806 14.3844 0.694096 13.587 1.60995C12.8766 2.40465 12.4633 3.42081 12.4174 4.48573C12.4179 4.61524 12.4317 4.74435 12.4587 4.87103C12.5539 4.88904 12.6507 4.89827 12.7476 4.89861C13.3046 4.85429 13.8468 4.69717 14.3412 4.4368C14.8356 4.17644 15.2719 3.81826 15.6235 3.38405Z",fill:"currentColor"})),kg=t=>h.createElement("svg",p({width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M21.5461 12.2099C21.5461 11.5553 21.4874 10.926 21.3783 10.3218H12.6846V13.8966H17.6524C17.4342 15.0463 16.7797 16.0197 15.7979 16.6742V18.9987H18.7937C20.5391 17.3875 21.5461 15.0211 21.5461 12.2099Z",fill:"#4285F4"}),h.createElement("path",{d:"M12.6847 21.2307C15.177 21.2307 17.2665 20.4084 18.7938 18.9986L15.798 16.6741C14.9756 17.2279 13.9266 17.5636 12.6847 17.5636C10.2847 17.5636 8.24549 15.944 7.51542 13.7622H4.44409V16.1454C5.96297 19.158 9.07626 21.2307 12.6847 21.2307Z",fill:"#34A853"}),h.createElement("path",{d:"M7.5154 13.754C7.33078 13.2001 7.22169 12.6127 7.22169 12.0001C7.22169 11.3875 7.33078 10.8001 7.5154 10.2463V7.86304H4.44407C3.8147 9.105 3.45386 10.5064 3.45386 12.0001C3.45386 13.4938 3.8147 14.8952 4.44407 16.1372L6.83568 14.2742L7.5154 13.754Z",fill:"#FBBC05"}),h.createElement("path",{d:"M12.6847 6.44482C14.0441 6.44482 15.2525 6.91475 16.2175 7.82104L18.8609 5.17768C17.2581 3.68397 15.177 2.76929 12.6847 2.76929C9.07626 2.76929 5.96297 4.84202 4.44409 7.863L7.51542 10.2462C8.24549 8.0644 10.2847 6.44482 12.6847 6.44482Z",fill:"#EA4335"})),Tg=t=>h.createElement("svg",p({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M3.25 3.25H11.25V11.25H3.25V3.25Z",fill:"#F35325"}),h.createElement("path",{d:"M12.75 3.25H20.75V11.25H12.75V3.25Z",fill:"#81BC06"}),h.createElement("path",{d:"M3.25 12.75H11.25V20.75H3.25V12.75Z",fill:"#05A6F0"}),h.createElement("path",{d:"M12.75 12.75H20.75V20.75H12.75V12.75Z",fill:"#FFBA08"})),Eg=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M12.0394 5.92117C12.451 6.12699 12.6179 6.62755 12.412 7.0392L9.07871 13.7059C8.87289 14.1175 8.37232 14.2844 7.96068 14.0785C7.54903 13.8727 7.38217 13.3722 7.588 12.9605L10.9213 6.29385C11.1272 5.8822 11.6277 5.71534 12.0394 5.92117ZM5.50002 5.99986C5.86821 6.276 5.94283 6.79833 5.66669 7.16652L3.54169 9.99986L5.66669 12.8332C5.94283 13.2014 5.86821 13.7237 5.50002 13.9999C5.13183 14.276 4.6095 14.2014 4.33335 13.8332L1.83335 10.4999C1.61113 10.2036 1.61113 9.79615 1.83335 9.49986L4.33335 6.16652C4.6095 5.79833 5.13183 5.72371 5.50002 5.99986ZM14.5 5.99986C14.8682 5.72371 15.3905 5.79833 15.6667 6.16652L18.1667 9.49986C18.3889 9.79615 18.3889 10.2036 18.1667 10.4999L15.6667 13.8332C15.3905 14.2014 14.8682 14.276 14.5 13.9999C14.1318 13.7237 14.0572 13.2014 14.3334 12.8332L16.4584 9.99986L14.3334 7.16652C14.0572 6.79833 14.1318 6.276 14.5 5.99986Z",fill:"currentColor"})),Pg=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M10 5.83366C9.30964 5.83366 8.75 6.3933 8.75 7.08366C8.75 7.77401 9.30964 8.33366 10 8.33366C10.6904 8.33366 11.25 7.77401 11.25 7.08366C11.25 6.3933 10.6904 5.83366 10 5.83366ZM7.08333 7.08366C7.08333 5.47283 8.38917 4.16699 10 4.16699C11.6108 4.16699 12.9167 5.47283 12.9167 7.08366C12.9167 8.69449 11.6108 10.0003 10 10.0003C8.38917 10.0003 7.08333 8.69449 7.08333 7.08366ZM3.33333 7.08366C2.8731 7.08366 2.5 7.45675 2.5 7.91699C2.5 8.37723 2.8731 8.75033 3.33333 8.75033C3.79357 8.75033 4.16667 8.37723 4.16667 7.91699C4.16667 7.45675 3.79357 7.08366 3.33333 7.08366ZM0.833333 7.91699C0.833333 6.53628 1.95262 5.41699 3.33333 5.41699C4.71405 5.41699 5.83333 6.53628 5.83333 7.91699C5.83333 9.2977 4.71405 10.417 3.33333 10.417C1.95262 10.417 0.833333 9.2977 0.833333 7.91699ZM16.6667 7.08366C16.2064 7.08366 15.8333 7.45675 15.8333 7.91699C15.8333 8.37723 16.2064 8.75033 16.6667 8.75033C17.1269 8.75033 17.5 8.37723 17.5 7.91699C17.5 7.45675 17.1269 7.08366 16.6667 7.08366ZM14.1667 7.91699C14.1667 6.53628 15.286 5.41699 16.6667 5.41699C18.0474 5.41699 19.1667 6.53628 19.1667 7.91699C19.1667 9.2977 18.0474 10.417 16.6667 10.417C15.286 10.417 14.1667 9.2977 14.1667 7.91699ZM7.61835 13.1795C7.03179 13.5966 6.66667 14.1884 6.66667 15.0003C6.66667 15.4606 6.29357 15.8337 5.83333 15.8337C5.3731 15.8337 5 15.4606 5 15.0003C5 13.59 5.67655 12.5152 6.65248 11.8212C7.60363 11.1448 8.82436 10.8337 10 10.8337C11.1756 10.8337 12.3964 11.1448 13.3475 11.8212C14.3235 12.5152 15 13.59 15 15.0003C15 15.4606 14.6269 15.8337 14.1667 15.8337C13.7064 15.8337 13.3333 15.4606 13.3333 15.0003C13.3333 14.1884 12.9682 13.5966 12.3816 13.1795C11.7703 12.7447 10.9077 12.5003 10 12.5003C9.0923 12.5003 8.2297 12.7447 7.61835 13.1795ZM4.15374 11.9375C4.23449 12.3906 3.93263 12.8233 3.47953 12.9041C2.32437 13.1099 1.66667 13.7389 1.66667 14.5837C1.66667 15.0439 1.29357 15.417 0.833333 15.417C0.373096 15.417 0 15.0439 0 14.5837C0 12.5752 1.6483 11.5375 3.18713 11.2633C3.64023 11.1825 4.073 11.4844 4.15374 11.9375ZM15.8463 11.9375C15.927 11.4844 16.3598 11.1825 16.8129 11.2633C18.3517 11.5375 20 12.5752 20 14.5837C20 15.0439 19.6269 15.417 19.1667 15.417C18.7064 15.417 18.3333 15.0439 18.3333 14.5837C18.3333 13.7389 17.6756 13.1099 16.5205 12.9041C16.0674 12.8233 15.7655 12.3906 15.8463 11.9375Z",fill:"currentColor"})),Ag=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 3.33341C6.31812 3.33341 3.33335 6.31818 3.33335 10.0001C3.33335 13.682 6.31812 16.6667 10 16.6667C13.6819 16.6667 16.6667 13.682 16.6667 10.0001C16.6667 6.31818 13.6819 3.33341 10 3.33341ZM1.66669 10.0001C1.66669 5.39771 5.39765 1.66675 10 1.66675C14.6024 1.66675 18.3334 5.39771 18.3334 10.0001C18.3334 14.6025 14.6024 18.3334 10 18.3334C5.39765 18.3334 1.66669 14.6025 1.66669 10.0001ZM11.1785 6.66675L13.3334 8.82157C13.9842 9.47244 13.9842 10.5277 13.3334 11.1786L11.1785 13.3334C10.5277 13.9843 9.47238 13.9843 8.82151 13.3334L6.66669 11.1786C6.01581 10.5277 6.01581 9.47245 6.66669 8.82157L8.82151 6.66675C9.47238 6.01587 10.5277 6.01587 11.1785 6.66675ZM12.1548 10.0001L10 7.84526L7.8452 10.0001L10 12.1549L12.1548 10.0001Z",fill:"currentColor"})),Dg=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M5.00526 4.58366C5.01932 4.61132 5.05866 4.67004 5.16269 4.75787C5.3538 4.91925 5.67975 5.10211 6.15547 5.27201C7.09965 5.60922 8.45881 5.83366 9.99998 5.83366C11.5411 5.83366 12.9003 5.60922 13.8445 5.27201C14.3202 5.10211 14.6462 4.91925 14.8373 4.75787C14.9413 4.67004 14.9806 4.61132 14.9947 4.58366C14.9806 4.556 14.9413 4.49728 14.8373 4.40944C14.6462 4.24807 14.3202 4.0652 13.8445 3.8953C12.9003 3.5581 11.5411 3.33366 9.99998 3.33366C8.45881 3.33366 7.09965 3.5581 6.15547 3.8953C5.67975 4.0652 5.3538 4.24807 5.16269 4.40944C5.05866 4.49728 5.01932 4.556 5.00526 4.58366ZM15 6.59804C14.8105 6.68702 14.611 6.76802 14.405 6.84158C13.238 7.25839 11.6805 7.50033 9.99998 7.50033C8.31949 7.50033 6.76198 7.25839 5.59491 6.84158C5.38893 6.76802 5.18947 6.68702 4.99998 6.59804V9.98919C5.00675 10.0064 5.03274 10.0554 5.1188 10.1357C5.26645 10.2734 5.52649 10.438 5.92172 10.5994C6.70695 10.9202 7.85854 11.1613 9.20916 11.2303C9.6688 11.2538 10.0224 11.6454 9.99889 12.1051C9.97541 12.5647 9.58377 12.9183 9.12413 12.8948C7.64784 12.8194 6.29943 12.5541 5.29139 12.1423C5.19246 12.1019 5.09514 12.0594 4.99998 12.0147V15.4059C5.00675 15.4231 5.03274 15.472 5.1188 15.5523C5.26645 15.6901 5.52649 15.8546 5.92172 16.0161C6.70695 16.3369 7.85854 16.578 9.20916 16.647C9.6688 16.6705 10.0224 17.0621 9.99889 17.5217C9.97541 17.9814 9.58377 18.335 9.12413 18.3115C7.64784 18.2361 6.29943 17.9708 5.29139 17.559C4.78999 17.3541 4.33007 17.0958 3.98192 16.771C3.63288 16.4454 3.33331 15.9892 3.33331 15.417V4.58366C3.33331 3.95559 3.69204 3.46988 4.08743 3.13602C4.48669 2.7989 5.015 2.53285 5.59491 2.32573C6.76198 1.90892 8.31949 1.66699 9.99998 1.66699C11.6805 1.66699 13.238 1.90892 14.405 2.32573C14.985 2.53285 15.5133 2.7989 15.9125 3.13602C16.3079 3.46988 16.6666 3.95559 16.6666 4.58366V8.33366C16.6666 8.7939 16.2936 9.16699 15.8333 9.16699C15.3731 9.16699 15 8.7939 15 8.33366V6.59804Z",fill:"currentColor"}),h.createElement("path",{d:"M14.5529 10.8337H15.447C15.6837 10.8337 15.9001 10.9674 16.006 11.1792L16.4513 12.0698L17.4453 12.0101C17.6816 11.9959 17.9056 12.1165 18.024 12.3215L18.4711 13.0958C18.5894 13.3008 18.5818 13.5551 18.4514 13.7527L17.9027 14.5836L18.4514 15.4146C18.5818 15.6122 18.5895 15.8665 18.4711 16.0715L18.024 16.8458C17.9057 17.0508 17.6816 17.1714 17.4453 17.1572L16.4513 17.0975L16.006 17.9882C15.9001 18.1999 15.6837 18.3337 15.447 18.3337H14.5529C14.3161 18.3337 14.0997 18.1999 13.9939 17.9882L13.5485 17.0975L12.5546 17.1572C12.3183 17.1714 12.0943 17.0508 11.9759 16.8458L11.5288 16.0715C11.4105 15.8665 11.4181 15.6122 11.5485 15.4146L12.0972 14.5836L11.5485 13.7527C11.4181 13.5551 11.4105 13.3008 11.5288 13.0958L11.9759 12.3215C12.0943 12.1165 12.3183 11.9959 12.5546 12.0101L13.5485 12.0698L13.9939 11.1792C14.0997 10.9674 14.3161 10.8337 14.5529 10.8337ZM14.9999 15.8337C15.6903 15.8337 16.2499 15.274 16.2499 14.5837C16.2499 13.8933 15.6903 13.3337 14.9999 13.3337C14.3096 13.3337 13.7499 13.8933 13.7499 14.5837C13.7499 15.274 14.3096 15.8337 14.9999 15.8337Z",fill:"currentColor"})),Lg=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M15 12.5C15 13.8807 13.8807 15 12.5 15H11.6666V17.5H5.83331C5.83331 15.3965 5.94556 13.6788 4.57425 11.9307C3.79685 10.9396 3.33331 9.69058 3.33331 8.33333C3.33331 5.11168 5.94499 2.5 9.16665 2.5C11.5416 2.5 13.7281 3.63987 14.6296 5.94399C15.2611 7.55853 15.6985 8.96442 16.6666 10.4167L15 11.25V12.5Z",stroke:"currentColor",strokeWidth:1.66667,strokeLinecap:"square",strokeLinejoin:"round"}),h.createElement("path",{d:"M9.5129 6.14222C9.49297 5.96623 9.34417 5.83319 9.16704 5.83301C8.98992 5.83283 8.84084 5.96556 8.82055 6.14152C8.4524 7.26158 8.09526 7.61872 6.9752 7.98687C6.79924 8.00717 6.66651 8.15624 6.66669 8.33336C6.66687 8.51049 6.7999 8.65929 6.9759 8.67923C8.09526 9.04729 8.4524 9.40444 8.81962 10.5154C8.8356 10.6953 8.98644 10.8332 9.16708 10.833C9.34772 10.8328 9.49824 10.6946 9.51382 10.5146C9.88097 9.40444 10.2381 9.04729 11.3483 8.68014C11.5283 8.66456 11.6665 8.51404 11.6667 8.3334C11.6669 8.15276 11.529 8.00193 11.3491 7.98594C10.2381 7.61872 9.88097 7.26158 9.5129 6.14222Z",fill:"currentColor"})),Og=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.853 4.03815C14.7819 3.81929 14.5469 3.69952 14.328 3.77063L13.5355 4.02814C13.0978 4.17037 12.8582 4.64049 13.0004 5.0782L14.288 9.04094C14.4302 9.47865 14.9003 9.71819 15.3381 9.57597L16.1306 9.31846C16.3495 9.24735 16.4692 9.01228 16.3981 8.79343L14.853 4.03815ZM13.813 2.18554C14.9073 1.82998 16.0826 2.42884 16.4381 3.52312L17.9832 8.2784C18.3388 9.37268 17.7399 10.548 16.6456 10.9036L15.8531 11.1611C15.1467 11.3906 14.4122 11.2887 13.8177 10.9411L12.7901 11.2301C12.8725 11.5 12.9168 11.7864 12.9168 12.0832C12.9168 12.9692 12.5218 13.7629 11.8982 14.2978L13.6235 17.0582C13.8674 17.4485 13.7488 17.9626 13.3585 18.2066C12.9682 18.4505 12.4541 18.3318 12.2101 17.9416L10.358 14.9782C10.2407 14.9925 10.1213 14.9999 10.0001 14.9999C9.87899 14.9999 9.75955 14.9925 9.64227 14.9782L7.79014 17.9416C7.54622 18.3318 7.03209 18.4505 6.64181 18.2066C6.25153 17.9626 6.13289 17.4485 6.37681 17.0582L8.10206 14.2978C7.65499 13.9143 7.32539 13.3978 7.17463 12.8095L5.48031 13.2861C4.18859 13.6494 2.84042 12.9282 2.42577 11.652L2.10851 10.6756C1.70574 9.43599 2.32292 8.09494 3.52647 7.59459L11.3377 4.34724C11.5051 3.48343 12.1244 2.7342 13.0204 2.44305L13.813 2.18554ZM11.5661 6.05726L4.16626 9.13357C3.76508 9.30035 3.55935 9.74737 3.69361 10.1606L4.01087 11.137C4.14908 11.5624 4.59847 11.8028 5.02905 11.6817L7.2714 11.051C7.68825 9.94963 8.75275 9.16657 10.0001 9.16657C10.6747 9.16657 11.2958 9.39558 11.7899 9.7801L12.6932 9.52604L11.5661 6.05726ZM10.0001 10.8332C9.30979 10.8332 8.75015 11.3929 8.75015 12.0832C8.75015 12.7736 9.30979 13.3332 10.0001 13.3332C10.6905 13.3332 11.2501 12.7736 11.2501 12.0832C11.2501 11.3929 10.6905 10.8332 10.0001 10.8332Z",fill:"currentColor"})),Ig=t=>h.createElement("svg",p({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.createElement("path",{d:"M15.3652 2.09459C16.1095 1.70899 16.9898 1.88279 17.5535 2.44656C18.1173 3.01033 18.2911 3.89064 17.9055 4.63487C17.1905 6.01499 16.3425 7.22391 15.3222 8.31078C16.348 9.58643 17.1189 10.9079 17.4446 12.1514C17.8241 13.6007 17.6113 15.0618 16.3542 16.0675C15.3445 16.8753 14.2098 16.7663 13.3037 16.3919C12.4217 16.0276 11.6394 15.376 11.1024 14.8573C10.7714 14.5376 10.7622 14.01 11.082 13.679C11.4017 13.3479 11.9293 13.3388 12.2603 13.6585C12.744 14.1257 13.3466 14.6064 13.94 14.8515C14.5092 15.0867 14.9404 15.0642 15.313 14.7661C15.9011 14.2955 16.1018 13.603 15.8323 12.5737C15.5948 11.6669 15.0042 10.5975 14.1154 9.4708C13.6316 9.89166 13.1147 10.2942 12.5621 10.6822C12.5376 10.6994 12.5125 10.7151 12.4868 10.7293C12.4352 11.3354 12.2313 11.854 11.8723 12.2673C11.4637 12.7379 10.9248 12.9901 10.4098 13.1305C9.58889 13.3542 8.60627 13.3399 7.88928 13.3294C7.7513 13.3274 7.62315 13.3255 7.50789 13.3255C7.04765 13.3255 6.67456 12.9524 6.67456 12.4922C6.67456 12.3769 6.67269 12.2488 6.67068 12.1108C6.66023 11.3938 6.64591 10.4112 6.86964 9.59029C7.00998 9.07531 7.26222 8.53644 7.73277 8.12778C8.14611 7.76881 8.66473 7.56492 9.27079 7.51327C9.28501 7.48764 9.30072 7.46251 9.31793 7.43799C9.6492 6.96607 9.99115 6.52028 10.346 6.0988C7.9373 4.77674 5.62102 4.88484 4.41967 6.08619C3.61321 6.89265 3.2947 8.16577 3.58074 9.69129C3.86588 11.212 4.74485 12.8932 6.18744 14.3358C7.03913 15.1875 7.95938 15.7822 8.71211 16.1622C9.08805 16.352 9.41535 16.4848 9.66275 16.5681C9.84796 16.6305 9.95411 16.6535 9.99306 16.6619C10.0137 16.6664 10.0155 16.6668 10.0002 16.6668C10.4605 16.6668 10.8336 17.0399 10.8336 17.5001C10.8335 17.9604 10.4604 18.3335 10.0002 18.3334C9.74781 18.3334 9.42292 18.246 9.13072 18.1476C8.80267 18.0371 8.40229 17.8729 7.961 17.6501C7.07926 17.2049 6.00681 16.5122 5.00893 15.5143C3.35986 13.8652 2.29728 11.89 1.94262 9.99844C1.58884 8.11165 1.93228 6.21655 3.24116 4.90768C5.28565 2.86318 8.67703 3.16039 11.5117 4.84723C12.6442 3.75094 13.9095 2.84885 15.3652 2.09459ZM11.0479 7.89226C11.4868 8.14712 11.853 8.51332 12.1078 8.95219C13.9945 7.53119 15.3672 5.91112 16.4257 3.86814C16.4586 3.80467 16.4545 3.70454 16.375 3.62507C16.2956 3.54561 16.1954 3.54153 16.132 3.57442C14.089 4.63293 12.4689 6.00557 11.0479 7.89226ZM8.33454 11.6656C8.92965 11.6687 9.49137 11.6533 9.97157 11.5224C10.2951 11.4343 10.4943 11.3123 10.614 11.1745C10.7223 11.0497 10.8333 10.8348 10.8333 10.4128C10.8333 9.72465 10.2755 9.16677 9.58728 9.16677C9.16526 9.16677 8.95039 9.27778 8.82561 9.38615C8.68779 9.50584 8.56584 9.70495 8.47765 10.0285C8.34678 10.5087 8.3314 11.0705 8.33454 11.6656Z",fill:"currentColor"})),Ue=ae({title:{id:"teamPurchaseInterstitialModal.title",defaultMessage:"Supercharge your business with a secure, collaborative workspace"},email:{id:"teamPurchaseInterstitialModal.email",defaultMessage:"Continue with Email"},google:{id:"teamPurchaseInterstitialModal.google",defaultMessage:"Continue with Google"},microsoft:{id:"teamPurchaseInterstitialModal.microsoft",defaultMessage:"Continue with Microsoft"},apple:{id:"teamPurchaseInterstitialModal.apple",defaultMessage:"Continue with Apple"},alreadyHaveAccount:{id:"teamPurchaseInterstitialModal.alreadyHaveAccount",defaultMessage:"Already have an account? <login>Login</login>"},termsOfUse:{id:"teamPurchaseInterstitialModal.termsOfUse",defaultMessage:"Terms of Use"},privacyPolicy:{id:"teamPurchaseInterstitialModal.privacyPolicy",defaultMessage:"Privacy Policy"},valueTitle:{id:"teamPurchaseInterstitialModal.valueTitle",defaultMessage:"Team"},perMonth:{id:"teamPurchaseInterstitialModal.perMonth",defaultMessage:"per user/month"},billedMonthly:{id:"teamPurchaseInterstitialModal.billedMonthly",defaultMessage:"billed monthly"},billedAnnually:{id:"teamPurchaseInterstitialModal.billedAnnually",defaultMessage:"billed annually"},free:{id:"teamPurchaseInterstitialModal.free",defaultMessage:"Free"},value1:{id:"teamPurchaseInterstitialModal.value1",defaultMessage:"More GPT-4o power—higher limits, faster output"},value2:{id:"teamPurchaseInterstitialModal.value2",defaultMessage:"Tailor ChatGPT to your work with file uploads, shared projects, GPTs and persistent memory"},value3:{id:"teamPurchaseInterstitialModal.value3",defaultMessage:"Offload busywork with tasks, tackle tough problems with deep research"},value4:{id:"teamPurchaseInterstitialModal.value4",defaultMessage:"Create with cutting-edge AI—video, images, code, canvas, and more"},value5:{id:"teamPurchaseInterstitialModal.value5",defaultMessage:"Keep your data safe with MFA, encryption, and no training on your content by default. <link>Learn More</link>"},value6:{id:"teamPurchaseInterstitialModal.value6",defaultMessage:"Collaborate seamlessly with shared GPTs and bulk admin controls"},value7:{id:"teamPurchaseInterstitialModal.value7",defaultMessage:"Stay ahead of rate limits with flexible credit top-ups"}}),Rg=t=>e.jsx("a",{href:"https://openai.com/enterprise-privacy/",target:"_blank",className:"whitespace-nowrap underline",rel:"noreferrer",children:t}),bo=[{icon:Lg,message:Ue.value1},{icon:Ig,message:Ue.value2},{icon:Og,message:Ue.value3},{icon:Eg,message:Ue.value4},{icon:Dg,message:Ue.value5,link:Rg},{icon:Ag,message:Ue.value7},{icon:Pg,message:Ue.value6}];var $o;const ua=Fe.button($o||($o=De(["text-base rounded-xl justify-center gap-1 flex items-center bg-token-main-surface-primary border w-full p-3"])));var Qo;const Bg=Fe.div(Qo||(Qo=De(["flex h-[1px] w-full border-b border-token-surface-tertiary"])));var Yo;const Fg=Fe.div(Yo||(Yo=De(["relative z-10 max-w-[402px] w-full flex flex-col items-start p-6 pb-3 border-box bg-token-main-surface-primary border border-token-surface-tertiary shadow-elevation-01 rounded-xl"])));var Zo;const Gg=Fe.div(Zo||(Zo=De(["flex w-full border-dotted border-b border-token-surface-tertiary"])));var Xo;const Ug=Fe.div(Xo||(Xo=De(["text-base text-sm tracking-[-0.18px]"])));var Jo;const Wg=Fe.div(Jo||(Jo=De(["flex gap-3 py-3 items-center"])));var ei;const Hg=Fe.div(ei||(ei=De(["w-5 h-5"])));var ti;const Mo=Fe.div(ti||(ti=De(["text-token-text-secondary flex flex-col self-end text-xs"])));var si;const Za=Fe.div(si||(si=De(["text-token-text-secondary me-0.5 flex self-start text-xl"])));var ai;const ma=Fe.div(ai||(ai=De(["me-2 leading-none"]))),zg=()=>{const t=Lt(),s=gi(t),a=ee(),n=Ys(a),o=Sl(t);return{shouldShowTeamSignupLanding:!n&&s,shouldShowTeamSignupDirectPurchase:o&&n}},Vg=()=>{const t=k(),s=Tm(null,!0),a=$e(),n=s.initialBillingDetails.currency,{annualBillingPlan:o,flexibleBillingPlan:i}=Fd(n),r=Gd(),{data:l}=Ud(r!=null?r:""),c=r===zd,u=r===Vd,m=c||u,g=m&&(l==null?void 0:l.state)==="eligible",f=m&&(l==null?void 0:l.state)==="not_eligible",x=m&&(l==null?void 0:l.state)==="temporary_disabled",b=m&&(l==null?void 0:l.state)==="offline",M=m&&(l==null?void 0:l.state)==="eligible",y=ee();h.useEffect(()=>{const N=new URLSearchParams(window.location.search).get("referrer")||document.referrer;se.logEvent("Account Pay: Interstitial Page Impression",{referrer:N})},[]);const C=window.location.href+"-direct",_=S=>{if(!C.includes(Jn)){Je.addError("TeamPurchaseInterstitialModal: Missing team pricing hash.");return}if(S==="email"){Gt(y,{fallbackScreenHint:"signup",callbackUrl:C});return}Gt(y,{fallbackScreenHint:"login",callbackUrl:C})},v=()=>{if(!C.includes(Jn)){Je.addError("TeamPurchaseInterstitialModal: Missing team pricing hash.");return}Gt(y,{fallbackScreenHint:"login",callbackUrl:C})},j=c?Wd(n):Hd(n);return e.jsx(xe,{testId:"modal-team-purchase-interstitial",size:"fullscreen",isOpen:!0,onClose:()=>{},type:"success",className:"flex flex-col",removePopoverStyling:!0,children:e.jsxs("div",{className:"flex h-full w-full gap-8",children:[e.jsxs("div",{className:"flex min-w-[320px] flex-1 flex-col items-center p-9 px-4",children:[e.jsxs("div",{className:"flex w-full max-w-[360px] grow flex-col items-center justify-center gap-3",children:[e.jsx("button",{onClick:()=>a("/"),className:"mb-6 cursor-pointer p-0 md:fixed md:start-4 md:top-4 md:h-6 md:w-6","aria-label":t.formatMessage({id:"createAccount.businessHomeButtonAriaLabel",defaultMessage:"Click here to go to the home page"}),children:e.jsx(fi,{className:"h-8 w-8"})}),M&&e.jsx("div",{className:"mb-2 flex w-full justify-center","data-testid":"welcome-offer",children:e.jsx("span",{className:"rounded-full border border-green-600 px-2 py-1 text-xs font-medium text-green-600",children:t.formatMessage(c?Tt.team1dollarWelcomeOffer:ys.teamFreeTrialWelcomeOffer)})}),e.jsx("div",{className:"mb-5 text-center text-3xl",children:t.formatMessage(Ue.title)}),e.jsxs(ua,{onClick:()=>_("email"),children:[e.jsx(Tn,{className:"h-6 w-6"}),t.formatMessage(Ue.email)]}),e.jsxs("div",{className:"relative my-12 w-full",children:[e.jsx(Bg,{}),e.jsx("span",{className:"bg-token-bg-primary text-token-text-secondary absolute start-1/2 -top-2 -translate-x-1/2 transform px-2 text-xs font-medium",children:t.formatMessage({id:"teamPurchaseInterstitialModal.or",defaultMessage:"OR"})})]}),e.jsxs(ua,{onClick:()=>_("google-oauth2"),children:[e.jsx(kg,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(Ue.google)})]}),e.jsxs(ua,{onClick:()=>_("windowslive"),children:[e.jsx(Tg,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(Ue.microsoft)})]}),e.jsxs(ua,{onClick:()=>_("apple"),children:[e.jsx(Ng,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(Ue.apple)})]}),e.jsx("div",{className:"flex items-center gap-1 py-1.5 text-sm font-medium",children:e.jsx("div",{className:"text-token-text-secondary",children:t.formatMessage(Ue.alreadyHaveAccount,{login:S=>e.jsx("span",{className:"cursor-pointer text-green-600",onClick:v,children:S})})})}),(f||x||b||g)&&(()=>{let S;switch(!0){case g:S=c?Tt.team1dollarLoginToVerify:ys.teamFreeTrialLoginToVerify;break;case f:S=c?Tt.team1dollarNotEligible:ys.teamFreeTrialNotEligible;break;case x:S=c?Tt.team1dollarTemporarilyDisabled:ys.teamFreeTrialTemporarilyDisabled;break;default:S=c?Tt.team1dollarOffline:ys.teamFreeTrialOffline}return e.jsx("div",{className:"mb-4 w-full","data-testid":"promo-banner",children:e.jsx(pi,{content:t.formatMessage(S),type:"normal"})})})()]}),e.jsxs("div",{className:"flex h-8 items-center gap-2 text-sm font-medium text-green-600",children:[e.jsx(Vt,{target:"_blank",to:"https://openai.com/policies/terms-of-use",children:t.formatMessage(Ue.termsOfUse)}),e.jsx("div",{className:"border-token-text-primary mx-2 h-[18px] border-s"}),e.jsx(Vt,{target:"_blank",to:"https://openai.com/policies/privacy-policy",children:t.formatMessage(Ue.privacyPolicy)})]})]}),e.jsxs("div",{className:"hidden min-h-[560px] overflow-y-auto md:relative md:flex md:h-full md:flex-1 md:items-center md:justify-center md:p-4",children:[e.jsxs(Fg,{children:[e.jsxs("div",{className:"mb-2 flex flex-col",children:[e.jsx("div",{className:"mb-2 flex items-center gap-2 text-xl font-medium",children:t.formatMessage(Ue.valueTitle)}),e.jsx("div",{className:"flex h-10 flex-col items-center",children:e.jsx("div",{className:"mb-2 flex items-center text-[34px]",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Za,{className:"text-token-text-tertiary",children:e.jsx(d,p({},o.currencySign))}),e.jsx(ma,{className:"text-token-text-tertiary","data-testid":"base-monthly-cost",children:e.jsx("s",{children:t.formatNumber(o.monthlyCost)})}),u?e.jsx(e.Fragment,{children:e.jsx(ma,{"data-testid":"promo-monthly-cost",children:t.formatMessage(Ue.free)})}):e.jsxs(e.Fragment,{children:[e.jsx(Za,{children:e.jsx(d,p({},o.currencySign))}),e.jsx(ma,{"data-testid":"promo-monthly-cost",children:t.formatNumber(j)}),e.jsxs(Mo,{"data-testid":"price-context",children:[e.jsx("div",{children:t.formatMessage(Tt.team1dollarPerSeat)}),e.jsxs("div",{children:[t.formatMessage(Tt.team1dollarCost),t.formatMessage(Tt.asterisk)]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Za,{children:e.jsx(d,p({},o.currencySign))}),e.jsx(ma,{"data-testid":"discounted-monthly-cost",children:t.formatNumber(o.discountedMonthlyCost)}),e.jsxs(Mo,{children:[e.jsx("div",{children:t.formatMessage(Ue.perMonth)}),e.jsx("div",{children:t.formatMessage(Ue.billedAnnually)})]})]})})})]}),bo.map(({icon:S,message:N,link:w},A)=>e.jsxs(Dt.Fragment,{children:[e.jsxs(Wg,{children:[S&&e.jsx(Hg,{children:e.jsx(S,{})}),e.jsx(Ug,{children:t.formatMessage(N,{link:w||void 0})})]}),A<bo.length-1&&e.jsx(Gg,{})]},N.id)),M&&e.jsx("div",{className:"text-token-text-secondary mt-2 self-start text-xs","data-testid":"promo-disclaimer",children:e.jsx(d,J(p({},c?j!==1?Tt.team1dollarPromoDisclaimerWithAmount:Tt.team1dollarPromoDisclaimer:ys.teamFreeTrialPromoDisclaimerWithPerSeatMonthlyPrice),{values:{currencySign:t.formatMessage(o.currencySign),amount:t.formatNumber(j,{style:"currency",currency:n,trailingZeroDisplay:"stripIfInteger"}),postTrialSeatPrice:t.formatNumber(i.monthlyCost,{style:"currency",currency:n,trailingZeroDisplay:"stripIfInteger"})}}))})]}),e.jsx("img",{alt:"",src:Er.src,className:"absolute inset-0 z-0 h-full w-full object-cover"})]})]})})};var ni;const ga=Fe.button(ni||(ni=De(["text-base rounded-xl justify-center gap-1 flex items-center bg-token-main-surface-primary border w-full p-3"])));var oi;const Kg=Fe.div(oi||(oi=De(["flex h-[1px] w-full border-b border-token-surface-tertiary"])));var ii;const qg=Fe.div(ii||(ii=De(["relative z-10 max-w-[465px] w-full flex flex-col items-start px-10 py-8 border-box bg-token-main-surface-primary border border-token-surface-tertiary shadow-elevation-01 rounded-[40px]"])));var ri;const $g=Fe.div(ri||(ri=De(["text-token-text-secondary flex flex-col self-end text-xs"])));var li;const yo=Fe.div(li||(li=De(["text-token-text-secondary me-0.5 flex self-start text-xl"])));var ci;const Co=Fe.div(ci||(ci=De(["me-2 leading-none"]))),Qg=()=>{const t=Lt(),s=hi(t),a=sessionStorage.getItem("poijcwa")==="jwoid",n=ee();return!Ys(n)&&s&&a},Yg=()=>{const t=k(),s=$e(),{country:a}=Pr(),n=Ar({country:a,currentAccount:null,location:"PlusPurchaseInterstitialModal",shouldUsePaidSubscriptionBillingCurrency:!1}),o=n.currency,i=Sa(),{costTitle:r,currencySymbol:l}=sr(i,o);let c=r;switch(n.currency){case"INR":c={id:"defaultCostInINR",defaultMessage:Gs(Zd).toString()};break;case"USD":{c={id:"defaultCostInDollars",defaultMessage:Gs(Yd).toString()};break}case"EUR":{c={id:"defaultCostInEuros",defaultMessage:Gs(Qd).toString()};break}case"GBP":{c={id:"defaultCostInPounds",defaultMessage:Gs($d).toString()};break}case"IDR":{c={id:"defaultCostInIDR",defaultMessage:Gs(qd).toString()};break}}const u=ee();h.useEffect(()=>{const b=new URLSearchParams(window.location.search).get("referrer")||document.referrer;se.logEvent("Account Pay: Interstitial Page Impression",{referrer:b})},[]);const m=window.location.href,g=x=>{if(!m.includes(eo)){Je.addError("PlusPurchaseInterstitialModal: Missing pricing hash.");return}if(x==="email"){Gt(u,{fallbackScreenHint:"signup",callbackUrl:m});return}Gt(u,{fallbackScreenHint:"login",callbackUrl:m})},f=()=>{if(!m.includes(eo)){Je.addError("PlusPurchaseInterstitialModal: Missing pricing hash.");return}Gt(u,{fallbackScreenHint:"login",callbackUrl:m})};return e.jsx(xe,{testId:"modal-team-purchase-interstitial",size:"fullscreen",isOpen:!0,onClose:()=>{},type:"success",className:"flex flex-col",removePopoverStyling:!0,children:e.jsxs("div",{className:"flex h-full w-full gap-8",children:[e.jsx("div",{className:"flex min-w-[320px] flex-1 flex-col items-center p-9 px-4",children:e.jsxs("div",{className:"flex w-full max-w-[360px] grow flex-col items-center justify-center gap-3",children:[e.jsx("button",{onClick:()=>s("/"),className:"mb-6 cursor-pointer p-0 md:fixed md:start-4 md:top-4 md:h-6 md:w-6","aria-label":t.formatMessage({id:"createAccount.plusHomeButtonAriaLabel",defaultMessage:"Click here to go to the home page"}),children:e.jsx(fi,{className:"h-8 w-8"})}),e.jsxs("span",{className:"text-[28px] font-normal",children:[e.jsx(d,{id:"createAccount.plusFormattedTitle",defaultMessage:"ChatGPT"}),e.jsx("span",{className:"ms-1.5 text-[28px] font-normal text-[#615EEB]",children:t.formatMessage(qt.plus)})]}),e.jsx("span",{className:"text-[22px] font-normal",children:e.jsx(d,{id:"createAccount.plusSubTitle",defaultMessage:"Start your trial for free"})}),e.jsxs(ga,{onClick:()=>g("email"),children:[e.jsx(Tn,{className:"h-6 w-6"}),t.formatMessage(qt.email)]}),e.jsxs("div",{className:"relative my-12 w-full",children:[e.jsx(Kg,{}),e.jsx("span",{className:"bg-token-bg-primary text-token-text-secondary absolute start-1/2 -top-2 -translate-x-1/2 transform px-2 text-xs font-medium",children:t.formatMessage({id:"plusPurchaseInterstitialModal.or",defaultMessage:"OR"})})]}),e.jsxs(ga,{onClick:()=>g("google-oauth2"),children:[e.jsx(_l,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(qt.google)})]}),e.jsxs(ga,{onClick:()=>g("windowslive"),children:[e.jsx(Kd,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(qt.microsoft)})]}),e.jsxs(ga,{onClick:()=>g("apple"),children:[e.jsx(ar,{className:"h-6 w-6"}),e.jsx("div",{children:t.formatMessage(qt.apple)})]}),e.jsx("div",{className:"flex items-center gap-1 py-1.5 text-sm font-medium",children:e.jsx("div",{className:"text-token-text-secondary",children:t.formatMessage(qt.alreadyHaveAccount,{login:x=>e.jsx("span",{className:"cursor-pointer text-green-600",onClick:f,children:x})})})})]})}),e.jsxs("div",{className:"hidden min-h-[560px] overflow-y-auto md:relative md:flex md:h-full md:flex-1 md:items-center md:justify-center md:p-4",children:[e.jsxs(qg,{children:[e.jsxs("div",{className:"mb-5 flex flex-col",children:[e.jsx("div",{className:"mb-2 flex items-center gap-2 text-[28px] font-normal",children:t.formatMessage(qt.valueTitle)}),e.jsx("div",{className:"flex h-10 flex-col items-center",children:e.jsxs("div",{className:"mb-2 flex items-center text-[34px]",children:[e.jsx(yo,{className:"text-token-text-tertiary",children:t.formatMessage(l.sign)}),e.jsx(Co,{className:"text-token-text-tertiary","data-testid":"base-monthly-cost",children:e.jsx("s",{children:t.formatMessage(c)})}),e.jsx(yo,{children:t.formatMessage(l.sign)}),e.jsx(Co,{"data-testid":"promo-monthly-cost",children:t.formatNumber(0)}),e.jsxs($g,{children:[e.jsx("p",{className:"m-0",children:e.jsx(d,{id:"PlusPricingModalColumn.currencyCodeWithSlash",defaultMessage:"{currencyCode} / ",values:{currencyCode:t.formatMessage(l.code)}})}),e.jsx(d,p({},qt.billedFirst30))]})]})})]}),e.jsx(nr,{isWebRedesign:!0,isTeamColumn:!1,pricingModalColumnType:Ga.standard,advertisedFeatures:Sa({isWebRedesign:!0}).advertisedFeatures})]}),e.jsx("img",{alt:"",src:Er.src,className:"absolute inset-0 z-0 h-full w-full object-cover"})]})]})})},qt=ae({email:{id:"PlusPurchaseInterstitialModal.email",defaultMessage:"Continue with Email"},google:{id:"PlusPurchaseInterstitialModal.google",defaultMessage:"Continue with Google"},microsoft:{id:"PlusPurchaseInterstitialModal.microsoft",defaultMessage:"Continue with Microsoft"},apple:{id:"PlusPurchaseInterstitialModal.apple",defaultMessage:"Continue with Apple"},alreadyHaveAccount:{id:"PlusPurchaseInterstitialModal.alreadyHaveAccount",defaultMessage:"Already have an account? <login>Login</login>"},valueTitle:{id:"PlusPurchaseInterstitialModal.valueTitle",defaultMessage:"Plus"},billedFirst30:{id:"PlusPurchaseInterstitialModal.billedFirst30",defaultMessage:"month for first 30 days"},plus:{id:"PlusPurchaseInterstitialModal.plus",defaultMessage:"Plus"}}),Zg=()=>{const t=Ls(),s=Te(),{hash:a}=Lt();return wl()||!(a==="#ca-google-drive-oauth")||!s||(s==null?void 0:s.isPersonalAccount())||!t?null:e.jsx(Xg,{})},Xg=()=>{const{openSettings:t}=ms(),{gDriveOAuthConnectionId:s,isLoading:a,refetch:n}=Nl();return h.useEffect(()=>{!s&&!a&&window.history.replaceState(null,"",window.location.pathname+window.location.search)},[s,a]),s?e.jsx(xi,{connectionId:s,isAdminFlow:!1,location:"url_hash",onClose:()=>{t(fe.Connectors)},onSuccess:n}):null};function On({testId:t="modal-generic-ineligible",title:s,message:a,buttonTitle:n,isOpen:o,onClose:i}){return e.jsx(xe,{testId:t,type:"success",isOpen:o,onClose:i,showCloseButton:!0,title:s,children:e.jsxs("div",{className:"",children:[e.jsx("p",{children:a}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(Ss,{title:n,color:"secondary",onClick:i,size:"large"})})]})})}const Jg=({currentAccount:t,promotionData:s})=>{const{eligible:a,isLoading:n}=Xd(Dm),o=$e(),i=Lt(),r=ee(),l=Ht(r,"2675205028"),{isEligible:c,isPromoLoading:u,promoCode:m,promoError:g,promoMetadata:f}=s,x=h.useCallback(()=>{const b=new URLSearchParams(i.search);b.delete(or);const M=b.toString();o({pathname:i.pathname,search:M?"?".concat(M):"",hash:i.hash})},[o,i]);if(h.useEffect(()=>{a&&f&&!f.schedule&&(bi.setItem(Mi.PromoCode,m),x())},[n,f,a,m,x]),h.useEffect(()=>{u||c&&f==null&&Je.addError("User is eligible for promo but metadata is missing",{promoCode:m})},[m,c,f,u]),a&&!(f!=null&&f.schedule)||n)return null;if(c&&f!=null){const b=l.get("show_web_redesign",!1);return e.jsx(ef,{currentAccount:t,onClose:x,promoCode:m,promoMetadata:f,isWebRedesign:b})}return!c&&g?e.jsx(tf,{onClose:x,promoCode:m,promoError:g}):null},ef=({currentAccount:t,onClose:s,promoCode:a,promoMetadata:n,isWebRedesign:o})=>{const[i,r]=h.useState(null),{country:l}=Pr(),c=Ar({country:l,currentAccount:t,location:"PromoEligibleModal"}),u=n.plan_name===yi.GO?Nm:Dr,m=h.useMemo(()=>J(p({},t.subscriptionAnalyticsParams),{referrer:document.referrer,parentComponent:"PromoRedemptionModal"}),[t]);return h.useEffect(()=>{se.logEvent("Promo Eligible Modal Shown",{promoCode:a,promoMetadata:n}),Zs.logEvent("chatgpt_promo_eligible_modal_shown")},[a,n]),e.jsx(xe,{testId:"modal-promo-eligible",size:"fullscreen",isOpen:!0,onClose:s,type:"success",className:"flex h-full flex-col items-center justify-center bg-white/70 dark:bg-gray-800/70",removePopoverStyling:!0,showOverlayBackground:!1,children:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"flex flex-col justify-center gap-4 px-3 py-6 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0",children:e.jsx(u,{analyticsParams:m,className:"bg-token-bg-primary",billingDetails:c,currentAccount:t,onClose:s,isPromoLoading:!1,planLoading:i,promoCode:a,promoMetadata:n,setPlanLoading:r,type:Ga.promo,isWebRedesign:o})})})})},tf=({onClose:t,promoError:s,promoCode:a})=>{const n=k();return h.useEffect(()=>{se.logEvent("Promo Ineligible Modal Shown",{promoCode:a,ineligibleReason:s.code}),Zs.logEvent("chatgpt_promo_ineligible_modal_shown")},[a,s.code]),e.jsx(On,{testId:"modal-promo-ineligible",title:s.title,message:s.message,buttonTitle:n.formatMessage({id:"promoIneligibleModal.close",defaultMessage:"Close"}),isOpen:!0,onClose:t})};function sf(){const t=ee(),s=Ys(t),a=Lt(),n=$e(),o=hi(a),i=gi(a),l=!!((o||i)&&s),{data:c,status:u}=Ze({queryKey:["user_segments"],queryFn:async()=>{try{const f=new Promise(x=>setTimeout(()=>x({segments:{}}),2e3));return await Promise.race([ie.safeGet("/user_segments"),f])}catch(f){return{segments:{}}}},enabled:l}),m=af({isModalOpen:l,isTeamPricingRoute:i,segmentsData:c});return h.useEffect(()=>{s&&Ts.getBooleanCookie(Es.ShowPaymentModal)&&(Ts.deleteCookie(Es.ShowPaymentModal),mn(n,"Show payment modal cookie"))},[s,n]),h.useEffect(()=>{l?(pt.closeAllActiveModals(),pt.openModal(Wt.AccountPayment)):pt.closeModal(Wt.AccountPayment)},[l]),{isOpen:l,defaultTab:m,defaultTabLoading:l&&u==="pending"}}function af({isModalOpen:t,isTeamPricingRoute:s,segmentsData:a}){var x;const n=Te(),o=bt(),i=ee(),[r]=Ba(),l=r.get("default_tab"),c=((x=a==null?void 0:a.segments)==null?void 0:x.professional_user)===!0;return!n||!o||!t?"personal":l&&["personal","business"].includes(l)?l:s||n.isWorkspaceAccount()||o!=null&&kl(o)||Tl&&El()&&Va(i,"647109062").get("enabled",!1)||n.isPlus()&&Va(i,"3480162268").get("enabled",!1)||(Pl(i,"chatgpt_teams_check_for_professional_user",void 0,{isProfessionalUser:c?"true":"false"}),c&&Va(i,"422096659").get("enabled",!1))?"business":"personal"}function In({className:t}){return e.jsx("div",{className:ht("flex h-full w-full items-center justify-center",t),children:e.jsx(Oe,{})})}var di;const Rr=Fe.div(di||(di=De(["p-6"])));function nf({emailAddress:t,setEmailAddress:s,emailTemplate:a,validateEmailPending:n,errorMessage:o,onClickValidateEmail:i,onClickCancel:r,title:l,description:c}){return e.jsx(Rr,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-center text-2xl font-medium",children:l!=null?l:e.jsx(d,{id:"XSITb5",defaultMessage:"Verify you are a student"})}),e.jsx("div",{className:"text-token-text-tertiary mt-2 text-center text-base",children:c!=null?c:e.jsx(d,{id:"x1DjYV",defaultMessage:"To claim the student discount, verify your university email address. This email will not be linked to your ChatGPT account."})}),e.jsxs("form",{className:"mt-8 flex flex-col",onSubmit:u=>{u.preventDefault(),i()},children:[e.jsxs(ir,{className:"mb-8",children:[e.jsx(rr,{label:e.jsx(d,{id:"jqIBGr",defaultMessage:"University email address"})}),e.jsx(lr,{className:ht(o&&"border-red-500"),placeholder:a,onChange:u=>{s(u.target.value)}}),o?e.jsx("div",{className:"text-danger mt-2 text-sm",children:o}):null]}),e.jsx(W,{type:"submit",disabled:t.length===0,loading:n,children:e.jsx(d,{id:"aDh6He",defaultMessage:"Send verification code"})}),e.jsx(W,{type:"button",color:"secondary",className:"mt-3",onClick:r,children:e.jsx(d,{id:"/7nqLd",defaultMessage:"Cancel"})})]})]})})}function Br({programName:t,onContinue:s,onCancel:a,validDomain:n,description:o}){const i=k(),[r,l]=h.useState(""),[c,u]=h.useState(null),{mutate:m,isPending:g}=je({mutationFn:()=>ss.validateEmail(r,t),onSuccess:f=>{u(null),Re.logValidateEmailSuccess(),s(f.transaction_id)},onError:f=>{var b,M;const x=(M=(b=f.detail)==null?void 0:b.user_error_message)!=null?M:i.formatMessage({id:"9wITlN",defaultMessage:"Something went wrong"});Re.logValidateEmailFailure(),u(x)}});return e.jsx(nf,{emailAddress:r,setEmailAddress:l,emailTemplate:n?"name@university.".concat(n):"",validateEmailPending:g,errorMessage:c,onClickValidateEmail:()=>{m(),Re.logClickValidateEmail()},onClickCancel:()=>{Re.logClose("add-email"),a()},title:n?e.jsx(d,{id:"referral.addEmail.title",defaultMessage:"Verify {domain} email address",values:{domain:n}}):void 0,description:o})}function of({currentAccount:t,hasPaidSubscription:s=!1,referralMetadata:a,checkoutDetails:n,onContinue:o,onClose:i}){const[r,l]=h.useState(null);h.useEffect(()=>{Re.logShowReferralDiscount(a.program_name,!1)},[a]);const c=rf(a);if(!t)return null;const u=Jd();return e.jsxs("div",{className:ht("relative flex h-full items-center justify-center",c?"overflow-auto":"overflow-hidden"),children:[e.jsx(Dr,{className:"bg-token-bg-primary",analyticsParams:n.plusAnalyticsParams,plusPricingPlan:u,currentAccount:t,setPlanLoading:l,planLoading:r,onUpgradeButtonClick:()=>{Re.logClickUpgradeButton(s),l(ke.PLUS),o()},billingDetails:n.billingDetails,promoMetadata:c,onClose:i,disableForMobile:!0,type:Ga.promo,isWebRedesign:!1}),e.jsx("div",{className:ht("absolute inset-0 flex items-center justify-center",c?"invisible":"visible"),children:e.jsx(In,{})})]})}function rf(t){var l,c;const s=k();if(!t)return;const a=((l=t==null?void 0:t.duration)==null?void 0:l.period)==="month"?(c=t==null?void 0:t.duration)==null?void 0:c.num_periods:void 0,n=s.formatMessage({id:"ofib91",defaultMessage:"Sign up for ChatGPT, and get your {months, plural, one {first month} other {first # months}} of Plus for free. Offer valid for new users after verifying you are a student."},{months:a}),o={value:t.discount.value,currency_code:t.discount.currency_code},i={num_periods:t.duration.num_periods,period:t.duration.period},r=s.formatMessage({id:"referral.promotionTypeLabel",defaultMessage:"STUDENT DISCOUNT"});return{plan_name:t.plan_names[0],summary:n,discount:o,duration:i,promotion_type:"student_discount",promotion_type_label:r,referrer_name:t.referrer_name}}function lf({emailAddress:t,verificationCode:s,errorMessage:a,sendErrorMessage:n,validateVerificationCodeIsPending:o,isSendingVerificationCode:i,setVerificationCode:r,onValidateVerificationCode:l,onResendVerificationCode:c,onChangeEmailAddress:u,onCancel:m}){return e.jsx(Rr,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-center text-2xl font-medium",children:e.jsx(d,{id:"PjHZX7",defaultMessage:"Check your email"})}),e.jsx("div",{className:"text-token-text-tertiary mt-2 text-center text-base",children:e.jsx(d,{id:"AoOIN/",defaultMessage:"Enter the verification code we just sent to {emailAddress}",values:{emailAddress:e.jsx("span",{className:"font-medium",children:t})}})}),n?e.jsx("div",{className:"mt-8",children:e.jsx(pi,{type:"error",icon:e.jsx(gn,{}),content:n})}):null,e.jsxs("form",{className:"mt-8 flex flex-col",onSubmit:g=>{g.preventDefault(),l()},children:[e.jsxs(ir,{className:"mb-8",children:[e.jsx(rr,{label:e.jsx(d,{id:"kLJAa+",defaultMessage:"Verification code"})}),e.jsx(lr,{placeholder:"XXXXXX",value:s,onChange:g=>{r(g.target.value)}}),a?e.jsx("div",{className:"text-danger mt-2 text-sm",children:a}):null]}),e.jsx(W,{type:"submit",disabled:s.length===0,loading:o,children:e.jsx(d,{id:"NRkiYA",defaultMessage:"Continue"})}),e.jsx(W,{type:"button",className:"mt-3",color:"secondary",onClick:m,children:e.jsx(d,{id:"vyz3Kz",defaultMessage:"Cancel"})})]}),e.jsx("div",{className:"mt-8 text-center text-sm",children:e.jsx(d,{id:"2NzblW",defaultMessage:"Didn't receive the code?"})}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsx(W,{loading:i,className:"flex-1",color:"secondary",onClick:c,children:e.jsx(d,{id:"L6pEyt",defaultMessage:"Resend code"})}),e.jsx(W,{className:"flex-1",color:"secondary",onClick:u,children:e.jsx(d,{id:"V8M7cm",defaultMessage:"Change email"})})]})]})})}function Fr({transactionId:t,onChangeEmailAddress:s,onContinue:a,onCancel:n}){const o=k(),[i,r]=h.useState(""),[l,c]=h.useState(null),[u,m]=h.useState(null),[g,f]=h.useState(!1),x=o.formatMessage({id:"9wITlN",defaultMessage:"Something went wrong"}),{mutate:b,isPending:M}=je({mutationFn:()=>ss.sendVerificationCode(t),onError:v=>{var S,N;const j=(N=(S=v.detail)==null?void 0:S.user_error_message)!=null?N:x;m(j)}}),{mutate:y,isPending:C}=je({mutationFn:()=>ss.validateVerificationCode(t,i),onSuccess:()=>{c(null),m(null),Re.logValidateVerificationCodeSuccess();try{f(!0),a()}catch(v){f(!1),c(x)}},onError:v=>{var S,N;const j=(N=(S=v.detail)==null?void 0:S.user_error_message)!=null?N:o.formatMessage({id:"9wITlN",defaultMessage:"Something went wrong"});Re.logValidateVerificationCodeFailure(),c(j)}}),_=h.useRef(!1);return h.useEffect(()=>{_.current||(b(),Re.logSendVerificationCode(),_.current=!0)},[b]),e.jsx(lf,{emailAddress:"",verificationCode:i,errorMessage:l,sendErrorMessage:u,validateVerificationCodeIsPending:C||g,isSendingVerificationCode:M,setVerificationCode:r,onChangeEmailAddress:()=>{Re.logClickChangeEmailButton(),s()},onValidateVerificationCode:()=>{Re.logClickValidateVerificationCode(),y()},onResendVerificationCode:()=>{Re.logClickResendVerificationCodeButton(),b()},onCancel:()=>{Re.logClose("verify-email"),n()}})}function Gr(t){const s=ee(),a=Al(s,"1682643554").value;if(!t||typeof a!="object"||!a)return;const n=a.school_configurations;if(!n)return;const o=n[t];if(!o)return;const r=o.domains[0];return{programConfiguration:o,validDomain:r}}function cf({referralCode:t,onClose:s}){var C;const a=$e(),{isUnauthenticated:n}=fn(),[o,i]=h.useState({name:"loading"}),r=ee(),l=oe(r,"550432558"),c=oe(r,"3406933735"),{shouldForwardToCheckout:u,isReferrer:m,referralMetadata:g,programName:f,isReferralLoading:x}=eu(t),{programConfiguration:b,validDomain:M}=(C=Gr(f))!=null?C:{},y=uf(b,g,x);return h.useEffect(()=>{l||s(),y&&s()},[y,s,l]),h.useEffect(()=>{m&&f&&a(cr(f)),n&&c&&ss.trackReferralSignup(t)},[m,f,a,n,t,c]),l?e.jsx(xe,{testId:"modal-referee",type:"success",isOpen:!0,onClose:s,className:"w-full max-w-[360px] ".concat(o.name==="discount-intro"?"bg-transparent shadow-none!":""),shouldIgnoreClickOutside:!0,removePopoverStyling:!0,noPadding:!0,children:e.jsx(df,{rootState:o,setRootState:i,referralCode:t,validDomain:M,shouldForwardToCheckout:u,referralMetadata:g,isReferralLoading:x,onClose:s})}):null}function df({rootState:t,setRootState:s,referralCode:a,validDomain:n,shouldForwardToCheckout:o,referralMetadata:i,isReferralLoading:r,onClose:l}){var C;const c=Lr(),u=Te(),m=k(),g=ee(),f=!Ys(g),x=(C=u==null?void 0:u.hasPaidSubscription())!=null?C:!1,b=je({mutationFn:()=>{if(t.name==="verify-email")return ss.redeemReferral(a,t.transactionId);throw new Error("Invalid state for redeeming referral")}}),M=h.useCallback(async _=>{try{await dr(_.billingDetails,_.plusAnalyticsParams)}catch(v){}},[]);h.useEffect(()=>{if(!(r||t.name!=="loading")){if(i){s({name:"discount-intro",referralMetadata:i});return}s({name:"error"})}},[r,o,i,c,M,t.name,s]);const y=tu(a);switch(t.name){case"loading":return e.jsx(In,{className:"min-h-96"});case"discount-intro":return e.jsx(of,{currentAccount:u,hasPaidSubscription:x,referralMetadata:t.referralMetadata,checkoutDetails:c,onContinue:()=>{Re.logReferralDiscountContinue(),f?Gt(g,{fallbackScreenHint:"signup",callback:_=>{se.logSignUpButtonClicked({provider:_,location:"Referral Discount Modal"})},callbackUrl:y}):o?M(c):s(vo(t.referralMetadata))},onClose:()=>{Re.logClose("discount"),t.referralMetadata.discount&&t.referralMetadata.duration&&bi.setItem(Mi.ReferralCode,a),l()}});case"add-email":return e.jsx(Br,{programName:t.referralMetadata.program_name,onContinue:_=>{s(mf(t.referralMetadata,_))},onCancel:l,validDomain:n,description:n?e.jsx(d,{id:"referee.addEmail.description",defaultMessage:"To claim the student discount, you must have a valid {domain} email address. This email will not be linked to your ChatGPT account.",values:{domain:n}}):void 0});case"verify-email":return e.jsx(Fr,{transactionId:t.transactionId,onChangeEmailAddress:()=>{s(vo(t.referralMetadata))},onContinue:async()=>{await b.mutateAsync(),M(c)},onCancel:l});case"error":return e.jsx(On,{title:m.formatMessage({id:"referee.genericIneligibleModal.title",defaultMessage:"Promo Unavailable"}),message:e.jsx(d,{id:"referee.genericIneligibleModal.message",defaultMessage:"Looks like you don’t meet the eligibility criteria for this promotion. Learn more about <link>ChatGPT plans.</link>",values:{link:_=>e.jsx("a",{href:"https://openai.com/chatgpt/pricing/",className:"underline",children:_})}}),buttonTitle:m.formatMessage({id:"referee.genericIneligibleModal.buttonTitle",defaultMessage:"Close"}),isOpen:!0,onClose:l})}}function uf(t,s,a){return a?!1:s&&!t?!0:s?!(s==null?void 0:s.program_name):!1}function vo(t){return{name:"add-email",referralMetadata:t}}function mf(t,s){return{name:"verify-email",referralMetadata:t,transactionId:s}}const us=ae({referralLinkModalTitle:{id:"referralLinkModal.title",defaultMessage:"Refer classmates, earn rewards"},referralLinkModalMessage:{id:"referralLinkModal.message",defaultMessage:"Get a friend to sign up for ChatGPT, and you’ll both get a free month of Plus."},referralLinkModalDisclaimer:{id:"referralLinkModal.disclaimer",defaultMessage:"For every ChatGPT user with a valid university email address you refer, you get {discount} your next billing cycle. You can refer up to 12 people, and discounts are automatically applied."}});function Ur({referralMetadata:t,referralCode:s,onClose:a}){const n=k(),o=ce(),{discount:i}=t,r=ur(i),l=En(n,i.value||0,i.currency_code);return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-token-sidebar-surface mx-auto flex h-[64px] w-[104px] items-center justify-center rounded-md bg-[#AF52DE] px-4 py-2 text-[40px]",children:[e.jsx("span",{className:"text-[20px]",children:e.jsx(d,p({},r.sign))}),i.value]}),e.jsx("p",{className:"text-token-text-primary mt-6 text-2xl font-semibold",children:e.jsx(d,p({},us.referralLinkModalTitle))}),e.jsx("p",{className:"text-token-text-primary mt-2 text-base",children:e.jsx(d,p({},us.referralLinkModalMessage))}),e.jsx("div",{className:"mt-6 flex w-full items-center justify-center rounded-md border-[1px] border-[#AF52DE] bg-[#8C43A00D] py-4 text-center",children:e.jsx("span",{className:"text-[15px] text-[#AF52DE]",children:s?nn(s):e.jsx(Oe,{})})}),e.jsxs("div",{className:"mt-6 flex w-full flex-col items-center space-y-3",children:[e.jsx(W,{color:"primary",onClick:()=>{s&&kn(nn(s),o).then(()=>{Re.logCopyReferralLink(),o.success(n.formatMessage({id:"1TiBkD",defaultMessage:"Copied referral link to clipboard"}))})},size:"large",className:"w-full",children:e.jsx(d,{id:"1HBlf+",defaultMessage:"Copy referral link"})}),e.jsx(W,{color:"secondary",onClick:a,size:"large",className:"w-full",children:e.jsx(d,{id:"6NQvfv",defaultMessage:"Close"})})]}),e.jsx("p",{className:"text-token-text-tertiary mt-6 text-start text-xs",children:e.jsx(d,J(p({},us.referralLinkModalDisclaimer),{values:{discount:l}}))})]})}function gf({referralMetadata:t,referralCode:s,onClose:a}){return e.jsx(Ur,{referralMetadata:t,referralCode:s,onClose:a})}function ff({referralMetadata:t,transactionId:s,onClose:a}){const n=ee(),o=gs(n),[i,r]=h.useState(null),{mutate:l}=je({mutationFn:()=>ss.createReferralCode(s),onSuccess:m=>{r(m.referral_code)},onError:m=>{}}),c=h.useRef(!1);h.useEffect(()=>{c.current||(c.current=!0,l(),Re.logShowReferrerConclusion())},[l]);const{program_name:u}=t;return!o||!u?null:e.jsx(Ur,{referralMetadata:t,referralCode:i,onClose:()=>{Re.logClose("referrer-conclusion"),a()}})}function pf({referralMetadata:t,onContinue:s,onClose:a}){const n=k(),o=ee(),i=gs(o);h.useEffect(()=>{Re.logShowReferralLinkGenerationModal(t.program_name)},[t]);const{discount:r,program_name:l}=t;if(!i||!l)return null;const c=ur(r),u=En(n,r.value||0,r.currency_code);return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-token-sidebar-surface mx-auto flex h-[64px] w-[104px] items-center justify-center rounded-md bg-[#AF52DE] px-4 py-2 text-[40px]",children:[e.jsx("span",{className:"text-[20px]",children:e.jsx(d,p({},c.sign))}),r.value]}),e.jsx("p",{className:"text-token-text-primary mt-6 text-2xl font-semibold",children:e.jsx(d,p({},us.referralLinkModalTitle))}),e.jsx("p",{className:"text-token-text-primary mt-2 text-base",children:e.jsx(d,p({},us.referralLinkModalMessage))}),e.jsxs("div",{className:"mt-6 flex w-full flex-col items-center space-y-3",children:[e.jsx(W,{color:"primary",onClick:s,size:"large",className:"w-full",children:e.jsx(d,{id:"aESB6r",defaultMessage:"Get my referral link"})}),e.jsx(W,{color:"secondary",onClick:()=>{Re.logClickReferrerIntroNotNowButton(),a()},size:"large",className:"w-full",children:e.jsx(d,{id:"i1qUk7",defaultMessage:"Not Now"})})]}),e.jsx("p",{className:"text-token-text-tertiary mt-6 text-start text-xs",children:e.jsx(d,J(p({},us.referralLinkModalDisclaimer),{values:{discount:u}}))})]})}function hf({program:t,onClose:s}){var x;const{referralMetadata:a,referralCode:n,transactionId:o,programName:i,isReferralLoading:r,referralError:l}=su(t),{programConfiguration:c,validDomain:u}=(x=Gr(i))!=null?x:{},m=bf(c,a,r),g=ee(),f=oe(g,"550432558");return h.useEffect(()=>{f||s(),m&&s()},[m,s,f]),f?e.jsx(xe,{testId:"modal-referrer",type:"success",isOpen:!0,onClose:s,showCloseButton:!0,className:"w-full max-w-[390px] pt-2",removePopoverStyling:!0,children:e.jsx(xf,{referralMetadata:a,referralCode:n,transactionId:o,referralError:l,validDomain:u,isReferralLoading:r,shouldRedirect:m,onClose:s})}):null}function xf({referralMetadata:t,referralCode:s,transactionId:a,referralError:n,validDomain:o,shouldRedirect:i,isReferralLoading:r,onClose:l}){const c=k(),u=ee(),{isUnauthenticated:m}=fn(),[g,f]=h.useState({name:"loading"});switch(h.useEffect(()=>{if(!r){if(i){l();return}if(n){f({name:"error",title:n.title,message:n.message});return}if(t){f(s?Mf(t,s):a?So(t,a):{name:"intro",referralMetadata:t});return}f({name:"error"})}},[r,n,t,s,a,i,l]),g.name){case"loading":return e.jsx(In,{className:"min-h-96"});case"already-enrolled":return e.jsx(gf,{referralMetadata:g.referralMetadata,referralCode:g.referralCode,onClose:l});case"intro":return e.jsx(pf,{referralMetadata:g.referralMetadata,onClose:l,onContinue:()=>{m?Gt(u,{fallbackScreenHint:"signup",callbackUrl:cr(g.referralMetadata.program_name)}):f(jo(g.referralMetadata))}});case"add-email":return e.jsx(Br,{programName:g.referralMetadata.program_name,onContinue:x=>{f(yf(g.referralMetadata,x))},onCancel:l,validDomain:o,description:o?e.jsx(d,{id:"referrer.addEmail.description",defaultMessage:"To generate a referral code, you must have a valid {domain} email address. This email will not be linked to your ChatGPT account.",values:{domain:o}}):void 0});case"verify-email":return e.jsx(Fr,{transactionId:g.transactionId,onChangeEmailAddress:()=>{f(jo(g.referralMetadata))},onContinue:()=>{f(So(g.referralMetadata,g.transactionId))},onCancel:l});case"conclusion":return e.jsx(ff,{referralMetadata:g.referralMetadata,transactionId:g.transactionId,onClose:l});case"error":return e.jsx(On,{title:c.formatMessage({id:"referrer.genericIneligibleModal.title",defaultMessage:"Promo Unavailable"}),message:e.jsx(d,{id:"referrer.genericIneligibleModal.message",defaultMessage:"Looks like you don't meet the eligibility criteria for this promotion. Learn more about <link>ChatGPT plans.</link>",values:{link:x=>e.jsx("a",{href:"https://openai.com/chatgpt/pricing/",className:"underline",children:x})}}),buttonTitle:c.formatMessage({id:"referrer.genericIneligibleModal.buttonTitle",defaultMessage:"Close"}),isOpen:!0,onClose:l})}}function bf(t,s,a){return a?!1:t?s?!(s==null?void 0:s.program_name):!1:!0}function Mf(t,s){return{name:"already-enrolled",referralMetadata:t,referralCode:s}}function jo(t){return{name:"add-email",referralMetadata:t}}function yf(t,s){return{name:"verify-email",referralMetadata:t,transactionId:s}}function So(t,s){return{name:"conclusion",referralMetadata:t,transactionId:s}}function Cf(){"use forget";const t=Mt.c(6),s=$e(),{isOpen:a,program:n}=Dl(),{isOpen:o,referralCode:i}=Ll();let r;return t[0]!==o||t[1]!==a||t[2]!==s||t[3]!==n||t[4]!==i?(r=a&&n?e.jsx(hf,{program:n,onClose:()=>s({hash:""})}):o&&i?e.jsx(cf,{referralCode:i,onClose:()=>s({hash:""})}):null,t[0]=o,t[1]=a,t[2]=s,t[3]=n,t[4]=i,t[5]=r):r=t[5],r}function wa(){"use forget";const t=Mt.c(1);let s;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s=e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-full px-2.5 py-1.5 text-xs text-blue-400",children:e.jsx(d,{id:"GRxNeD",defaultMessage:"Parent"})}),t[0]=s):s=t[0],s}function vf({amphoraId:t,invite:s,onBack:a}){var b,M;const n=k(),o=ce(),i=Ne(),[r,l]=h.useState(!1),[c,u]=h.useState(!1),m=je({mutationFn:async()=>{const y=s.account_identifier,C=s.email?{email:s.email}:y?{account_identifier:y}:null;if(!C)throw new Error("Missing invite identifier");await ie.safePost("/amphora/{amphora_id}/remove",{parameters:{path:{amphora_id:t}},requestBody:C})},onSuccess:async()=>{await Promise.all([i.invalidateQueries({queryKey:["amphora"]}),i.invalidateQueries({queryKey:["amphora",t]})]),a()},onError:y=>{const C=y instanceof Error?y.message:String(y);o.danger(n.formatMessage(Ve.cancelInviteError,{error:C}),{toastId:"amphora_invite_cancel"})}}),g=je({mutationFn:async()=>{var C;const y=(C=s.email)!=null?C:s.account_identifier;if(!y)throw new Error("Missing invite identifier");await ie.safePost("/amphora/{amphora_id}/members/resend",{parameters:{path:{amphora_id:t}},requestBody:{account_identifier:y}})},onSuccess:async()=>{l(!1),u(!0),o.success(n.formatMessage(Ve.resendInviteSuccess)),await i.invalidateQueries({queryKey:["amphora",t]})},onError:y=>{const C=y instanceof Error?y.message:String(y);o.danger(n.formatMessage(Ve.resendInviteError,{error:C}),{toastId:"amphora_invite_resend"})}}),f=(M=(b=s.email)!=null?b:s.account_identifier)!=null?M:"",x=f||n.formatMessage(Ve.missingIdentifier);return e.jsxs(Me,{title:e.jsxs("button",{"aria-label":n.formatMessage(Ve.back),onClick:a,className:"hover:bg-token-bg-tertiary -ms-3 flex items-center gap-2 rounded-full px-3 py-1",children:[e.jsx(ea,{className:"icon-sm"}),e.jsx("span",{children:e.jsx(d,p({},Ve.back))})]}),noBorder:!0,headerInteractable:!0,children:[e.jsx("div",{className:"border-token-border-light my-3 rounded-xl border p-4",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-token-bg-tertiary text-token-text-tertiary flex h-12 w-12 shrink-0 items-center justify-center rounded-full",children:e.jsx(Ci,{className:"icon-lg"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm",children:x}),e.jsxs("div",{className:"text-token-text-secondary mt-0.5 flex items-center gap-1 text-sm",children:[e.jsx(pn,{className:"icon-sm"}),e.jsx("span",{children:e.jsx(d,p({},Ve.invitationSent))})]})]})]}),s.role==="owner"&&e.jsx(wa,{})]})}),e.jsxs("div",{className:"flex flex-col items-start py-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{color:"secondary",onClick:()=>l(!0),disabled:g.isPending||m.isPending,children:e.jsx(d,p({},Ve.resendInvite))}),e.jsx(W,{color:"danger-outline",onClick:()=>m.mutate(),disabled:m.isPending,children:e.jsx(d,p({},Ve.cancelInvite))})]}),e.jsx("p",{className:"text-token-text-tertiary mt-6 text-sm",children:s.role==="owner"?e.jsx(d,p({},Ve.childLinkParentInviteDescription)):e.jsx(d,J(p({},Ve.learnMoreVesselControls),{values:{LearnMoreLink:e.jsx(Os,{href:"https://help.openai.com/en/articles/12315553-parental-controls-faq",className:"underline",children:e.jsx(d,{id:"LGjcbz",defaultMessage:"Learn more"})})}}))})]}),e.jsx(xe,{testId:"modal-amphora-resend-invite",isOpen:r,onClose:()=>l(!1),size:"custom",showCloseButton:!0,className:"max-w-md text-sm",title:n.formatMessage(Ve.resendConfirmTitle),description:e.jsx("p",{children:n.formatMessage(Ve.resendConfirmDesc)}),primaryButton:e.jsx(W,{onClick:()=>g.mutate(),disabled:g.isPending,children:n.formatMessage(Ve.resendSendButton)}),secondaryButton:e.jsx(W,{color:"secondary",onClick:()=>l(!1),children:n.formatMessage(Ve.resendCancelButton)}),children:e.jsx("div",{className:"mt-4",children:e.jsx(ks,{name:"identifier",ariaLabel:!1,className:"",type:"text",value:f,disabled:!0,placeholder:""})})}),e.jsx(xe,{testId:"modal-amphora-resend-invite-success",isOpen:c,onClose:()=>u(!1),size:"custom",showCloseButton:!0,className:"max-w-md text-sm",title:n.formatMessage(Ve.resendSentTitle),description:e.jsx("p",{children:n.formatMessage(Ve.resendSentDesc,{identifier:f})}),primaryButton:e.jsx(W,{onClick:()=>u(!1),children:n.formatMessage(Ve.doneButton)})})]})}const Ve=ae({back:{id:"amphora.invited.back",defaultMessage:"Back"},invitationSent:{id:"amphora.invited.status.sent",defaultMessage:"Invitation sent"},cancelInvite:{id:"amphora.invited.cancel",defaultMessage:"Cancel invitation"},cancelInviteError:{id:"amphora.invited.cancel.error",defaultMessage:"Unable to cancel invite: {error}"},resendInvite:{id:"amphora.invited.resend",defaultMessage:"Resend invitation"},resendInviteError:{id:"amphora.invited.resend.error",defaultMessage:"Unable to resend invite: {error}"},resendInviteSuccess:{id:"amphora.invited.resend.success",defaultMessage:"Invitation sent"},resendConfirmTitle:{id:"amphora.invited.resend.confirmTitle",defaultMessage:"Resend invitation"},resendConfirmDesc:{id:"amphora.invited.resend.confirmDesc",defaultMessage:"We’ll send another invite to your family member. If they’re new to ChatGPT, they’ll be asked to create an account."},resendCancelButton:{id:"amphora.invited.resend.cancel",defaultMessage:"Cancel"},resendSendButton:{id:"amphora.invited.resend.send",defaultMessage:"Send"},resendSentTitle:{id:"amphora.invited.resend.sentTitle",defaultMessage:"Sent!"},resendSentDesc:{id:"amphora.invited.resend.sentDesc",defaultMessage:"We sent {identifier} a new invite. If they’re new to ChatGPT, they’ll be asked to create a new account."},doneButton:{id:"amphora.invited.done",defaultMessage:"Done"},missingIdentifier:{id:"amphora.invited.missingIdentifier",defaultMessage:"[missing]"},learnMoreVesselControls:{id:"amphora.invited.learnMoreVesselControls2",defaultMessage:"{LearnMoreLink} about parental controls"},childLinkParentInviteDescription:{id:"amphora.invited.childLinkParentInviteDescription",defaultMessage:"You can link to one parent at a time."}});function jf({forceInviteeRole:t=null,initialInviteMethod:s="email",initialEmail:a="",initialPhone:n="",initialRole:o="",isOpen:i=!0,isSubmitting:r=!1,onClose:l,onSubmit:c,showCloseButton:u=!0}){const m=k(),[g,f]=h.useState(s),[x,b]=h.useState(a),[M,y]=h.useState(n),[C,_]=h.useState(null),[v,j]=h.useState(null),[S,N]=h.useState(()=>{var O;return(O=t!=null?t:o)!=null?O:""}),w=x.trim(),A=M.trim(),T=g==="email"?w:A,P=!S||r||T.length===0||(g==="email"?C!=null:v!=null),E=e.jsx(Os,{href:"https://help.openai.com/en/articles/12315553-parental-controls-faq",className:"underline",children:e.jsx(d,{id:"0M5wS5",defaultMessage:"Learn more"})});return e.jsxs(xe,{testId:"modal-invite-members-to-amphora",isOpen:i,onClose:l,size:"custom",showCloseButton:u,className:"max-w-md text-sm",title:t==null?m.formatMessage(Ke.inviteMemberModalTitle):m.formatMessage(Ke.inviteChildModalTitle),children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("label",{htmlFor:g==="email"?"email":"amphora-invite-phone",className:"text-sm font-medium",children:m.formatMessage(g==="email"?Ke.invitesInputLabel:Ke.invitesPhoneInputLabel)}),e.jsx("button",{type:"button",className:"text-token-text-secondary text-sm underline underline-offset-[2px] [text-decoration-skip-ink:none]",onClick:()=>f(O=>{const D=O==="email"?"phone":"email";return _(null),j(null),D}),children:m.formatMessage(g==="email"?Ke.switchToPhoneLink:Ke.switchToEmailLink)})]}),g==="email"?e.jsxs(e.Fragment,{children:[e.jsx(ks,{name:"email",ariaLabel:!1,type:"email",value:x,onChange:O=>{b(O.target.value),C&&_(null)},autoFocus:!0,placeholder:m.formatMessage(Ke.invitesInputPlaceholder),className:ht(C&&"border-red-500 focus-within:border-red-500 focus-within:ring-red-500")}),C?e.jsx("p",{className:"mt-1 text-xs text-red-500",children:C}):null]}):e.jsx(Hm,{id:"amphora-invite-phone",name:"account_identifier",value:M,setValue:O=>{y(O),v&&j(null)},label:m.formatMessage(Ke.invitesPhoneInputLabel),error:v!=null?v:void 0,appearance:{layout:"inline",showDialCodePrefix:!1,rounded:"lg",densePadding:!0,triggerShowOnlyDialCode:!0,fullWidthJustifyDialCode:!1,placeholderTextSize:"sm",dropdownPanelWidthPx:320}}),e.jsx("p",{className:"text-token-text-tertiary mt-2 text-xs",children:m.formatMessage(Ke.invitesInputHelperText)})]}),t==null&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("p",{className:"text-sm font-medium",children:m.formatMessage(Ke.relationshipQuestion)}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs(Jt.Root,{className:"text-token-text-primary flex flex-col gap-2 text-sm",value:S,onValueChange:O=>N(O),children:[e.jsx(Jt.Item,{value:"owner",label:m.formatMessage(Ke.roleOwner),children:e.jsx(Jt.Indicator,{})}),e.jsx(Jt.Item,{value:"member_role",label:m.formatMessage(Ke.roleMember),children:e.jsx(Jt.Indicator,{})})]})})]}),e.jsx("div",{className:ht("overflow-clip duration-300 [interpolate-size:allow-keywords] motion-safe:transition-[height]",S?"h-max":"h-0"),children:S==="owner"?e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(d,J(p({},Ke.relationshipInfoForMember),{values:{LearnMoreLink:E}}))}):S==="member_role"?e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(d,J(p({},Ke.relationshipInfoForOwner),{values:{LearnMoreLink:E}}))}):null})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(W,{color:"secondary",onClick:l,children:m.formatMessage(Ke.cancelButton)}),e.jsx(W,{onClick:()=>{const O=S==="owner"?"owner":"member_role";if(T){if(_(null),j(null),g==="email"){if(!au.test(w)){_(m.formatMessage(Ke.invalidEmailError));return}}else if(!zm(A)){j(m.formatMessage(Ke.invalidPhoneError));return}c({accountIdentifier:T,inviteMethod:g,role:O})}},disabled:P,children:e.jsx(d,p({},Ke.modalInviteButton))})]})]})}const Ke=ae({inviteMemberModalTitle:{id:"amphora.inviteMemberModalTitle",defaultMessage:"Invite family member"},inviteChildModalTitle:{id:"amphora.inviteChildModalTitle",defaultMessage:"Add a child"},invitesInputPlaceholder:{id:"amphora.members.invitesInputPlaceholder2",defaultMessage:"name@email.com"},invitesInputLabel:{id:"amphora.members.invitesInputLabel",defaultMessage:"Email address"},invitesPhoneInputLabel:{id:"amphora.members.invitesPhoneInputLabel",defaultMessage:"Phone number"},invitesInputHelperText:{id:"amphora.members.invitesInputHelperText2",defaultMessage:"If your family member is new to ChatGPT, they'll be asked to create an account."},switchToPhoneLink:{id:"amphora.members.usePhoneLink",defaultMessage:"Use phone"},switchToEmailLink:{id:"amphora.members.useEmailLink",defaultMessage:"Use email"},invalidEmailError:{id:"amphora.members.invalidEmailError",defaultMessage:"Enter a valid email address."},invalidPhoneError:{id:"amphora.members.invalidPhoneError",defaultMessage:"Enter a valid phone number."},cancelButton:{id:"amphora.members.cancelButton",defaultMessage:"Cancel"},modalInviteButton:{id:"amphora.members.modalInviteButton",defaultMessage:"Send"},relationshipQuestion:{id:"amphora.members.relationshipQuestion",defaultMessage:"This person is:"},relationshipInfoForOwner:{id:"amphora.members.relationshipInfoForOwner2",defaultMessage:"If your child accepts, you'll be able to manage some of their settings, set time limits, and add safeguards that work for your family. You won't have access to details about your teen's conversations with ChatGPT, except in certain rare safety circumstances. You can unlink accounts anytime. {LearnMoreLink}"},relationshipInfoForMember:{id:"amphora.members.relationshipInfoForMember2",defaultMessage:"Your parent or guardian will be able to adjust certain features, set time limits, and add safeguards to help guide your experience. We won't share details of your conversations with ChatGPT, except in certain rare safety circumstances. You can unlink accounts anytime. {LearnMoreLink}"},roleMember:{id:"amphora.members.inviteModalRoleMember",defaultMessage:"My child"},roleOwner:{id:"amphora.members.inviteModalRoleOwner",defaultMessage:"My parent or guardian"}});function Sf(t){"use forget";const s=Mt.c(20),{amphora_id:a,onClose:n,forceInviteeRole:o}=t,i=k(),r=Ne(),l=ce(),[c,u]=h.useState(a!=null?a:null);let m;s[0]!==c||s[1]!==r?(m=async _=>{var N;const{accountIdentifier:v,role:j}=_;let S=c;if(!S){const w=j==="owner"?"member_role":"owner",A=await ie.safePost("/amphora",{requestBody:{role:w}});if(S=(N=A==null?void 0:A.id)!=null?N:null,!S)throw window.location.reload(),new Error("Failed to create amphora group");u(S),r.setQueryData(["amphora"],T=>{const P=T!=null?T:{};return J(p({},P),{id:S,role:w})})}if(!S)throw new Error("Failed to determine amphora id");return await ie.safePost("/amphora/{amphora_id}/members",{parameters:{path:{amphora_id:S}},requestBody:{members:[{account_identifier:v,role:j}]}}),S},s[0]=c,s[1]=r,s[2]=m):m=s[2];let g;s[3]!==n||s[4]!==r?(g=_=>{r.invalidateQueries({queryKey:["amphora"]}),_&&r.invalidateQueries({queryKey:["amphora",_]}),n()},s[3]=n,s[4]=r,s[5]=g):g=s[5];let f;s[6]!==i||s[7]!==l?(f=_=>{const v=_ instanceof Error?_.message:String(_);l.danger(i.formatMessage(_f.inviteError,{error:v}),{toastId:"amphora_invite_error"})},s[6]=i,s[7]=l,s[8]=f):f=s[8];let x;s[9]!==m||s[10]!==g||s[11]!==f?(x={mutationFn:m,onSuccess:g,onError:f},s[9]=m,s[10]=g,s[11]=f,s[12]=x):x=s[12];const b=je(x),M=o!=null?o:null;let y;s[13]!==b?(y=_=>{const{accountIdentifier:v,role:j}=_;return b.mutate({accountIdentifier:v,role:j})},s[13]=b,s[14]=y):y=s[14];let C;return s[15]!==b.isPending||s[16]!==n||s[17]!==M||s[18]!==y?(C=e.jsx(jf,{forceInviteeRole:M,onClose:n,onSubmit:y,isSubmitting:b.isPending}),s[15]=b.isPending,s[16]=n,s[17]=M,s[18]=y,s[19]=C):C=s[19],C}const _f=ae({inviteError:{id:"amphora.members.inviteError",defaultMessage:"Unable to send invite: {error}"}});function Rn(t){"use forget";var b;const s=Mt.c(22),{user:a}=t,n=k();let o;s[0]!==n||s[1]!==a.email||s[2]!==a.name?(o=a.name||a.email||n.formatMessage({id:"VB4+Q+",defaultMessage:"Member"}),s[0]=n,s[1]=a.email,s[2]=a.name,s[3]=o):o=s[3];const i=o,r=(b=a.profile_picture_url)!=null?b:void 0;let l;s[4]!==i||s[5]!==r?(l=e.jsx(mr,{user:{picture:r,name:i},size:"large"}),s[4]=i,s[5]=r,s[6]=l):l=s[6];let c;s[7]!==i?(c=e.jsx("div",{className:"text-token-text-primary",children:i}),s[7]=i,s[8]=c):c=s[8];let u;s[9]!==a.email?(u=a.email?e.jsx("div",{className:"text-token-text-secondary",children:a.email}):null,s[9]=a.email,s[10]=u):u=s[10];let m;s[11]!==c||s[12]!==u?(m=e.jsxs("div",{className:"flex flex-col truncate text-sm",children:[c,u]}),s[11]=c,s[12]=u,s[13]=m):m=s[13];let g;s[14]!==l||s[15]!==m?(g=e.jsxs("div",{className:"flex items-center gap-3",children:[l,m]}),s[14]=l,s[15]=m,s[16]=g):g=s[16];let f;s[17]!==a.role?(f=a.role==="owner"&&e.jsx(wa,{}),s[17]=a.role,s[18]=f):f=s[18];let x;return s[19]!==g||s[20]!==f?(x=e.jsx("div",{className:"border-token-border-light my-3 rounded-xl border p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[g,f]})}),s[19]=g,s[20]=f,s[21]=x):x=s[21],x}function wf(t,s=void 0,a=void 0){return Ze({queryKey:["amphora",t,a?a.join(","):void 0],queryFn:async()=>await ie.safeGet("/amphora/{amphora_id}/members",{parameters:{path:{amphora_id:t}}}),placeholderData:s,enabled:!!t})}const _o={IMAGE_GENERATION:"chatgpt.workspace.feature.image-gen.access",VOICE:"chatgpt.workspace.feature.voice.access"},Ct={U18_MODEL_INSTRUCTIONS_ENABLED:["3VyEPC5dTP_model_instructions_enabled"],SORA_INFINITE_SCROLL_ENABLED:["bH2sVuQ5TJ_enabled"],SORA_PERSONALIZED_FEED_ENABLED:["wF9qLt3XpB_enabled"],SORA_DIRECT_MESSAGES_DISABLED:["calpico_is_enabled"],TRAINING_ALLOWED:["training_allowed"],MEMORY:["sunshine","moonshine"],BLACKOUT_HOURS:["rKAMeJfyrM_settings"]},Bn=t=>Array.isArray(t);function Nf(t,s,a){var n;if(Bn(s)){for(const o of s)if((a==null?void 0:a[o])===!0)return!0;return!1}return(n=t==null?void 0:t.includes(s))!=null?n:!1}function kf(t,s){var n;const a=(n=t==null?void 0:t.amphora_locks)!=null?n:void 0;if(!a)return!1;if(Bn(s)){for(const o of s)if(a[o]===!0)return!0;return!1}return a[s]===!0}var cn=(t=>(t.Blackout="blackout",t))(cn||{});const et=ae({modelPolicyLabel:{id:"amphora.permissions.modelPolicyLabel",defaultMessage:"Model policy"},personalizationLabel:{id:"amphora.permissions.personalizationLabel",defaultMessage:"Memory"},dataControlsLabel:{id:"amphora.permissions.dataControlsLabel",defaultMessage:"Training"},VyEPC5dTPModelPolicyLabel:{id:"amphora.permissions.VyEPC5dTPModelPolicyLabel3",defaultMessage:"Reduce sensitive content"},u18Explainer:{id:"amphora.permissions.u18Explainer3",defaultMessage:"Add extra safeguards to help protect teens. {LearnMoreLink}"},VyEPC5dTPModelPolicyAria:{id:"amphora.permissions.VyEPC5dTPModelPolicyAria2",defaultMessage:"Enable teen-safe model policy for {email}"},referenceMemoriesLabel:{id:"amphora.permissions.referenceMemoriesLabel",defaultMessage:"Reference saved memories"},referenceMemoriesAria:{id:"amphora.permissions.referenceMemoriesAria",defaultMessage:"Allow referencing saved memories for {email}"},improveModelLabel:{id:"amphora.permissions.improveModelLabel",defaultMessage:"Improve the model for everyone"},improveModelAria:{id:"amphora.permissions.improveModelAria",defaultMessage:"Allow improving the model for everyone for {email}"},parentalControlsTab:{id:"settingsModal.parentalControlsTab",defaultMessage:"Parental controls"},removeMemberError:{id:"amphora.members.removeMemberError",defaultMessage:"Unable to remove member: {error}"}});et.modelPolicyLabel,Ct.U18_MODEL_INSTRUCTIONS_ENABLED,et.VyEPC5dTPModelPolicyLabel,et.VyEPC5dTPModelPolicyAria,et.u18Explainer,et.personalizationLabel,Ct.MEMORY,et.referenceMemoriesLabel,et.referenceMemoriesAria,et.dataControlsLabel,Ct.TRAINING_ALLOWED,et.improveModelLabel,et.improveModelAria;function Tf(t){const s=k(),a=ce(),n=Ne();return je({mutationFn:({userId:o,permissions:i})=>ie.safePost("/amphora/{amphora_id}/members/{user_id}/permissions",{parameters:{path:{amphora_id:t,user_id:o}},requestBody:{permissions:i}}),onMutate:async({userId:o,permissions:i})=>{const r=["amphora",t,o,"permissions"];await n.cancelQueries({queryKey:r});const l=n.getQueryData(r);return n.setQueryData(r,c=>J(p({},c),{permissions:i})),{queryKey:r,previous:l}},onError:o=>{a.danger(s.formatMessage({id:"amphora.permissions.updatePermissionError",defaultMessage:"Unable to update permissions: {error}"},{error:o.message}))},onSettled:(o,i,r,l)=>{const c=r==null?void 0:r.userId,u=l==null?void 0:l.queryKey,m=Array.isArray(u)?u:c?["amphora",t,c,"permissions"]:void 0;i&&l&&l.previous&&Array.isArray(m)&&n.setQueryData(m,l.previous),c&&n.invalidateQueries({queryKey:["amphora",t,c,"permissions"]})}})}function Wr(t){const s=k(),a=ce(),n=Ne();return je({mutationFn:({userId:o,feature:i,value:r})=>ie.safePatch("/amphora/{amphora_id}/members/{user_id}/settings",{parameters:{path:{amphora_id:t,user_id:o}},requestBody:{feature:i,value:r}}),onMutate:async({userId:o,feature:i,value:r})=>{const l=["amphora",t,o,"permissions"];await n.cancelQueries({queryKey:l});const c=n.getQueryData(l);return n.setQueryData(l,u=>{var g;const m=(g=u==null?void 0:u.settings)!=null?g:{};return J(p({},u),{settings:J(p({},m),{[i]:r})})}),{queryKey:l,previous:c}},onError:o=>{a.danger(s.formatMessage({id:"amphora.permissions.updatePermissionError",defaultMessage:"Unable to update permissions: {error}"},{error:o.message}))},onSettled:(o,i,r)=>{const l=r==null?void 0:r.userId;l&&n.invalidateQueries({queryKey:["amphora",t,l,"permissions"]})}})}function Ef(t,s,a){const n=Array.isArray(t)?t:[];return a?Array.from(new Set([...n,s])):n.filter(o=>o!==s)}function Pf(t,s,a){const n=[];for(const o of s)(t==null?void 0:t[o])===!0!==a&&n.push({feature:o,value:a});return n}function Af(t){const{memberId:s,currentPerms:a,currentSettings:n,toggleKey:o,enabled:i,updatePermission:r,patchSetting:l}=t;if(Bn(o)){const u=Pf(n,o,i);for(const m of u)l({userId:s,feature:m.feature,value:m.value});return}const c=Ef(a,o,i);r({userId:s,permissions:c})}function Df(t){const s=Tf(t),a=Wr(t);return{triggerToggle:n=>Af(J(p({},n),{updatePermission:s.mutate,patchSetting:a.mutate}))}}function Fn(t){const s=k(),a=ce(),n=Ne();return je({mutationFn:({userId:o})=>ie.safePost("/amphora/{amphora_id}/remove",{parameters:{path:{amphora_id:t}},requestBody:{user_id:o}}).catch(i=>{a.danger(s.formatMessage(et.removeMemberError,{error:i.message}),{toastId:"amphora_member_remove"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["amphora",t]})}})}function Lf(t){const{data:s,isLoading:a,error:n}=wf(t);return{members:h.useMemo(()=>{var r;const i=(r=s==null?void 0:s.items)!=null?r:[];return Array.isArray(i)?i.filter(l=>typeof l=="object"&&l!=null&&"status"in l).filter(l=>l.status==="accepted").filter(l=>typeof l.user_id=="string"):[]},[s]),isLoading:a,error:n,raw:s}}function Of(t,s){return Ze({queryKey:["amphora",t,s,"permissions"],queryFn:()=>ie.safeGet("/amphora/{amphora_id}/members/{user_id}/settings",{parameters:{path:{amphora_id:t,user_id:s}}}),enabled:!!(t&&s)})}async function If(){return await ie.safeGet("/amphora")}const Rf=er({queryKey:["amphora"],queryFn:If,staleTime:1/0});function Gn(){return Ze(Rf).data}function Bf({amphoraId:t,member:s,onBack:a}){const n=k(),o=bt(),i=Gn(),r=Fn(t),l=Ne(),c=(i==null?void 0:i.role)==="member_role",u=s.role==="member_role",m=!(c&&u),g=m?"text-token-text-secondary pt-6 text-sm":"text-token-text-secondary text-sm",f=async()=>{if(!(!(o!=null&&o.id)||!window.confirm(n.formatMessage(Us.unlinkConfirm))))try{await r.mutateAsync({userId:o.id}),l.invalidateQueries({queryKey:["amphora"]}),l.removeQueries({queryKey:["amphora",t],exact:!1}),a()}catch(b){}};return e.jsxs(Me,{title:e.jsxs("button",{"aria-label":n.formatMessage(Us.back),onClick:a,className:"hover:bg-token-bg-tertiary -ms-3 flex items-center gap-2 rounded-full px-3 py-1",children:[e.jsx(ea,{className:"icon-sm"}),e.jsx("span",{children:e.jsx(d,p({},Us.back))})]}),noBorder:!0,headerInteractable:!0,children:[e.jsx(Rn,{user:s}),e.jsxs("div",{className:"flex flex-col items-start py-3",children:[m?e.jsx(W,{color:"danger-outline",disabled:r.isPending||!(o!=null&&o.id),onClick:f,children:e.jsx(d,p({},Us.unlinkButton))}):null,e.jsx("p",{className:g,children:n.formatMessage(Us.helpCenterParagraph)})]})]})}const Us=ae({back:{id:"amphora.relationship.back",defaultMessage:"Back"},relationshipDescription:{id:"amphora.relationship.description",defaultMessage:"When your account is linked to a guardian, they can manage certain privacy and content settings for you. They won't have access to your chats, but they'll be notified if we detect conversations with ChatGPT that may put your safety at risk."},unlinkButton:{id:"amphora.relationship.unlinkButton",defaultMessage:"Unlink accounts"},unlinkConfirm:{id:"amphora.relationship.unlinkConfirm",defaultMessage:"Are you sure you want to unlink your accounts?"},unknownMember:{id:"amphora.relationship.unknownMember",defaultMessage:"Member"},helpCenterParagraph:{id:"amphora.relationship.helpCenterParagraph2",defaultMessage:"You can link one parent at a time."}});function wo(t){"use forget";const s=Mt.c(12),{valueMinutes:a,disabled:n,onChange:o}=t,i=k();let r;s[0]!==i?(r=b=>{const M=Math.max(0,Math.min(1439,b|0)),y=new Date;return y.setHours(Math.floor(M/60),M%60,0,0),i.formatDate(y,{hour:"numeric",minute:"2-digit"})},s[0]=i,s[1]=r):r=s[1];const l=r;let c;s[2]===Symbol.for("react.memo_cache_sentinel")?(c=Array.from({length:48}),s[2]=c):c=s[2];let u;s[3]!==l?(u=c.map((b,M)=>{const y=M*30;return{label:l(y),value:String(y)}}),s[3]=l,s[4]=u):u=s[4];const m=u,g=String(Math.max(0,Math.min(1439,a|0)));let f;s[5]!==o?(f=b=>o(Number(b)),s[5]=o,s[6]=f):f=s[6];let x;return s[7]!==n||s[8]!==m||s[9]!==g||s[10]!==f?(x=e.jsx(gr,{options:m,value:g,disabled:n,onValueChange:f,triggerClassName:"text-token-text-primary",contentClassName:"min-w-[var(--radix-select-trigger-width)]!",triggerId:"time-picker"}),s[7]=n,s[8]=m,s[9]=g,s[10]=f,s[11]=x):x=s[11],x}function Ff({enabled:t,disabled:s,startMinutes:a,endMinutes:n,onToggle:o,onStartChange:i,onEndChange:r}){const l=k();return e.jsxs(e.Fragment,{children:[e.jsx(Be,{label:l.formatMessage(cs.blackoutHoursLabel),description:l.formatMessage(cs.blackoutHoursDescription),enabled:t,disabled:s,onChange:o,ariaLabel:l.formatMessage(cs.blackoutHoursLabelAria)}),t?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("span",{className:"text-token-text-primary inline-flex items-center gap-1.5 text-sm",children:[e.jsx(nu,{className:"icon-sm"}),l.formatMessage(cs.startLabel)]}),e.jsx(wo,{label:e.jsx("span",{className:"sr-only",children:l.formatMessage(cs.startLabel)}),valueMinutes:a,disabled:s,onChange:i})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("span",{className:"text-token-text-primary inline-flex items-center gap-1.5 text-sm",children:[e.jsx(ou,{className:"icon-sm"}),l.formatMessage(cs.endLabel)]}),e.jsx(wo,{label:e.jsx("span",{className:"sr-only",children:l.formatMessage(cs.endLabel)}),valueMinutes:n,disabled:s,onChange:r})]})]}):null]})}const cs=ae({blackoutHoursLabel:{id:"amphora.permissions.blackoutHoursLabel",defaultMessage:"Quiet hours"},blackoutHoursDescription:{id:"amphora.permissions.blackoutHoursDescription",defaultMessage:"Schedule hours when ChatGPT can't be used."},blackoutHoursLabelAria:{id:"amphora.permissions.blackoutHoursLabelAria",defaultMessage:"Quiet hours"},startLabel:{id:"amphora.permissions.blackout.start",defaultMessage:"Start time"},endLabel:{id:"amphora.permissions.blackout.end",defaultMessage:"End time"}}),No=22*60,ko=6*60,Na=(t,s,a)=>Math.min(a,Math.max(s,t|0)),fa=(t,s=0)=>{if(!t)return s;const[a,n]=t.split(":").map(o=>parseInt(o,10)||0);return Na(a,0,23)*60+Na(n,0,59)},To=t=>{const s=Na(Math.floor(t/60),0,23),a=Na(t%60,0,59);return"".concat(String(s).padStart(2,"0"),":").concat(String(a).padStart(2,"0"))};function Gf(t){"use forget";var O,D;const s=Mt.c(28),{disabled:a,userId:n,currentBlackout:o,featureKey:i,onPatch:r}=t,[l,c]=Dt.useState(typeof(o==null?void 0:o.enabled)=="boolean"?o.enabled:!1),u=o==null?void 0:o.start_time;let m;s[0]!==u?(m=fa(u,No),s[0]=u,s[1]=m):m=s[1];const[g,f]=Dt.useState(m),x=o==null?void 0:o.end_time;let b;s[2]!==x?(b=fa(x,ko),s[2]=x,s[3]=b):b=s[3];const[M,y]=Dt.useState(b),C=o==null?void 0:o.enabled,_=(O=o==null?void 0:o.start_time)!=null?O:null,v=(D=o==null?void 0:o.end_time)!=null?D:null;let j,S;s[4]!==C||s[5]!==v||s[6]!==_?(j=()=>{c(!!C),f(fa(_,No)),y(fa(v,ko))},S=[C,_,v],s[4]=C,s[5]=v,s[6]=_,s[7]=j,s[8]=S):(j=s[7],S=s[8]),Dt.useEffect(j,S);let N;s[9]!==M||s[10]!==i||s[11]!==r||s[12]!==g||s[13]!==n?(N=I=>{const{nextEnabled:H,nextStartMinutes:$,nextEndMinutes:X}=I,q=$===void 0?g:$,G=X===void 0?M:X,F=To(q),R=To(G);r({userId:n,feature:i,value:{enabled:H,start_time:H?F:null,end_time:H?R:null}})},s[9]=M,s[10]=i,s[11]=r,s[12]=g,s[13]=n,s[14]=N):N=s[14];const w=iu(N);let A,T,P;s[15]!==a||s[16]!==w?(T=I=>{c(I),a||w({nextEnabled:I})},P=I=>{f(I),a||w({nextEnabled:!0,nextStartMinutes:I})},A=I=>{y(I),a||w({nextEnabled:!0,nextEndMinutes:I})},s[15]=a,s[16]=w,s[17]=A,s[18]=T,s[19]=P):(A=s[17],T=s[18],P=s[19]);let E;return s[20]!==a||s[21]!==l||s[22]!==M||s[23]!==g||s[24]!==A||s[25]!==T||s[26]!==P?(E=e.jsx(Ff,{enabled:l,disabled:a,startMinutes:g,endMinutes:M,onToggle:T,onStartChange:P,onEndChange:A}),s[20]=a,s[21]=l,s[22]=M,s[23]=g,s[24]=A,s[25]=T,s[26]=P,s[27]=E):E=s[27],E}function Uf(t,s,a){if(s)return a?t.formatMessage(s,{LearnMoreLink:e.jsx(Os,{href:a,className:"underline",children:e.jsx(d,{id:"7E51F1",defaultMessage:"Learn more"})})}):t.formatMessage(s)}function Wf({amphoraId:t,member:s,onBack:a}){var N;const n=k(),o=s.name||s.email||"",i=(N=s.user_id)!=null?N:void 0,r=bt(),{data:l,isLoading:c}=Of(t,i),u=l==null?void 0:l.permissions,m=l==null?void 0:l.settings,{triggerToggle:g}=Df(t),f=Wr(t),x=Fn(t),b=Ne(),M=ee(),y=oe(M,"1681462365"),_=[...[{sectionLabel:null,toggles:[{perm:Ct.U18_MODEL_INSTRUCTIONS_ENABLED,label:et.VyEPC5dTPModelPolicyLabel,description:et.u18Explainer,learnMoreHref:"https://help.openai.com/en/articles/12315645"},{perm:Ct.TRAINING_ALLOWED,label:Qe.featuresModelTrainingLabel,description:Qe.featuresModelTrainingDesc,learnMoreHref:"https://help.openai.com/en/articles/5722486-how-your-data-is-used-to-improve-model-performance"},{perm:Ct.MEMORY,label:Qe.featuresMemoryLabel,description:Qe.featuresMemoryDesc,learnMoreHref:"https://help.openai.com/en/articles/8590148-memory-faq"},{perm:_o.VOICE,label:Qe.featuresVoiceLabel,description:Qe.featuresVoiceDesc,learnMoreHref:"https://help.openai.com/en/articles/8400625-voice-mode-faq"},{perm:_o.IMAGE_GENERATION,label:Qe.featuresImageLabel,description:Qe.featuresImageDesc},{perm:Ct.BLACKOUT_HOURS,label:Qe.sleepModeLabel,description:Qe.sleepModeDesc,type:cn.Blackout}]}]];y&&$t&&_.push({sectionLabel:$t.soraSectionLabel,toggles:[{perm:Ct.SORA_PERSONALIZED_FEED_ENABLED,label:$t.soraPersonalizedFeedLabel,description:$t.soraPersonalizedFeedDescription},{perm:Ct.SORA_INFINITE_SCROLL_ENABLED,label:$t.soraInfiniteScrollLabel,description:$t.soraInfiniteScrollDescription},{perm:Ct.SORA_DIRECT_MESSAGES_DISABLED,label:$t.soraDirectMessagesDisabledLabel,description:$t.soraDirectMessagesDisabledDescription}]});const v=!!(i&&(r!=null&&r.id)&&i===r.id),j=x.isPending,S=async()=>{if(!i)return;const w=o||n.formatMessage(Qe.unlinkFallbackName);if(window.confirm(n.formatMessage(Qe.unlinkConfirm,{name:w})))try{await x.mutateAsync({userId:i}),await b.invalidateQueries({queryKey:["amphora"]}),a()}catch(T){}};return e.jsxs(Me,{title:e.jsxs("button",{"aria-label":n.formatMessage(Qe.back),onClick:a,className:"hover:bg-token-bg-tertiary -ms-3 flex items-center gap-2 rounded-full px-3 py-1",children:[e.jsx(ea,{className:"icon-sm"}),e.jsx("span",{children:e.jsx(d,p({},Qe.back))})]}),noBorder:!0,headerInteractable:!0,children:[e.jsx(Rn,{user:s}),s.role==="member_role"&&e.jsx(Hf,{}),_.map((w,A)=>{var T,P;return e.jsxs("div",{className:ht({"pt-3":A===0}),children:[w.sectionLabel&&e.jsx(K,{children:e.jsx("div",{className:"mb-1 text-base",children:e.jsx(d,p({},w.sectionLabel))})}),w.toggles.map(E=>{var D;const O=kf(m,E.perm);if(E.type===cn.Blackout){const I=Ct.BLACKOUT_HOURS[0],H=(D=m==null?void 0:m[I])!=null?D:{};return e.jsx(K,{children:e.jsx(Gf,{disabled:c||!i||v&&O,userId:i,currentBlackout:H,featureKey:I,onPatch:f.mutate})},"".concat(i,"-").concat(E.label.id))}return e.jsx(K,{children:e.jsx(Be,{label:n.formatMessage(E.label),description:Uf(n,E.description,E.learnMoreHref),enabled:Nf(u,E.perm,m),disabled:c||!i||v&&O,onChange:I=>i&&!(v&&O)&&g({memberId:i,currentPerms:u,currentSettings:m,toggleKey:E.perm,enabled:I})})},"".concat(i,"-").concat(E.label.id))}),e.jsx("hr",{className:"border-token-border-light"})]},(P=(T=w.sectionLabel)==null?void 0:T.id)!=null?P:A)}),e.jsx(W,{color:"danger-outline",disabled:j,onClick:S,className:"mt-6",children:e.jsx(d,p({},Qe.unlinkButton))})]})}function Hf(){"use forget";const t=Mt.c(1);let s;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s=e.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-6 mb-3 flex items-center rounded-xl border-none p-3 text-xs",children:e.jsx(d,p({},Qe.childInformationalBanner))}),t[0]=s):s=t[0],s}const Qe=ae({back:{id:"settingsModal.back",defaultMessage:"Back"},accountSettings:{id:"amphora.memberSettings.accountSettings",defaultMessage:"Account settings"},nameLabel:{id:"amphora.memberSettings.name",defaultMessage:"Name"},emailLabel:{id:"amphora.memberSettings.email",defaultMessage:"Email"},avatarLabel:{id:"amphora.memberSettings.avatar",defaultMessage:"Avatar"},missingValue:{id:"amphora.memberSettings.missingValue",defaultMessage:"-"},contentRestrictions:{id:"amphora.memberSettings.contentRestrictions",defaultMessage:"Content restrictions"},timeLimits:{id:"amphora.memberSettings.timeLimits",defaultMessage:"Time limits"},sleepModeLabel:{id:"amphora.memberSettings.sleepMode.label2",defaultMessage:"Quiet hours"},sleepModeDesc:{id:"amphora.memberSettings.sleepMode.description2",defaultMessage:"Schedule hours when ChatGPT can't be used."},featuresAndData:{id:"amphora.memberSettings.featuresAndData",defaultMessage:"Features & data"},featuresModelTrainingLabel:{id:"amphora.memberSettings.features.modelTraining.label2",defaultMessage:"Improve the model for everyone"},featuresModelTrainingDesc:{id:"amphora.memberSettings.features.modelTraining.description2",defaultMessage:"Allow your child's transcripts and other files to be used to train our models for ChatGPT and Sora. {LearnMoreLink}"},featuresMemoryLabel:{id:"amphora.memberSettings.features.memory.label2",defaultMessage:"Reference saved memories"},featuresMemoryDesc:{id:"amphora.memberSettings.features.memory.description2",defaultMessage:"Allow ChatGPT to save and use memories when responding. {LearnMoreLink}"},featuresVoiceLabel:{id:"amphora.memberSettings.features.voice.label",defaultMessage:"Voice mode"},featuresVoiceDesc:{id:"amphora.memberSettings.features.voice.description2",defaultMessage:"Allow your child to use Voice Mode in ChatGPT. {LearnMoreLink}"},featuresImageLabel:{id:"amphora.memberSettings.features.image.label",defaultMessage:"Image generation"},featuresImageDesc:{id:"amphora.memberSettings.features.image.description2",defaultMessage:"Allow ChatGPT to create or edit images."},featuresAgentLabel:{id:"amphora.memberSettings.features.agent.label",defaultMessage:"Agent mode"},featuresDeepResearchLabel:{id:"amphora.memberSettings.features.deepResearch.label",defaultMessage:"Deep research"},featuresWebSearchLabel:{id:"amphora.memberSettings.features.webSearch.label",defaultMessage:"Web search"},unlinkButton:{id:"amphora.memberSettings.unlinkButton",defaultMessage:"Unlink accounts"},unlinkConfirm:{id:"amphora.memberSettings.unlinkConfirm",defaultMessage:"Remove {name} from this family group?"},unlinkFallbackName:{id:"amphora.memberSettings.unlinkFallbackName",defaultMessage:"this member"},childInformationalBanner:{id:"amphora.memberSettings.childInformationalBanner",defaultMessage:"Your parent or guardian can adjust these settings to help guide how you use ChatGPT and Sora."}}),$t=ae({soraSectionLabel:{id:"amphora.memberSettings.sora.sectionLabel",defaultMessage:"Sora"},soraAccountCreationLabel:{id:"amphora.memberSettings.sora.accountCreation.label",defaultMessage:"Can create Sora account"},soraAccountCreationDescription:{id:"amphora.memberSettings.sora.accountCreation.description",defaultMessage:"Allow the user to create a Sora account."},soraInfiniteScrollLabel:{id:"amphora.memberSettings.sora.infiniteScroll.label2",defaultMessage:"Continuous feed"},soraInfiniteScrollDescription:{id:"amphora.memberSettings.sora.infiniteScroll.description2",defaultMessage:"Allow an uninterrupted feed of content while scrolling."},soraPersonalizedFeedLabel:{id:"amphora.memberSettings.sora.personalizedFeed.label",defaultMessage:"Personalized feed"},soraPersonalizedFeedDescription:{id:"amphora.memberSettings.sora.personalizedFeed.description2",defaultMessage:"Allow videos to be recommended based on your child's history and activity."},soraDirectMessagesDisabledLabel:{id:"amphora.memberSettings.sora.directMessagesDisabled.label2",defaultMessage:"Messaging"},soraDirectMessagesDisabledDescription:{id:"amphora.memberSettings.sora.directMessagesDisabled.description2",defaultMessage:"Allow your child to send and receive direct messages."}});function zf({amphoraId:t,selectedParent:s,onBack:a}){const n=k(),o=bt(),i=Fn(t),r=Ne(),l=i.isPending,c=async()=>{const u=o==null?void 0:o.id;if(!(!u||!window.confirm(n.formatMessage(pa.leaveConfirm))))try{await i.mutateAsync({userId:u}),await r.invalidateQueries({queryKey:["amphora"]}),a()}catch(g){}};return e.jsxs(Me,{title:e.jsxs("button",{"aria-label":n.formatMessage(pa.back),onClick:a,className:"hover:bg-token-bg-tertiary -ms-3 flex items-center gap-2 rounded-full px-3 py-1",children:[e.jsx(ea,{className:"icon-sm"}),e.jsx("span",{children:e.jsx(d,p({},pa.back))})]}),noBorder:!0,headerInteractable:!0,children:[e.jsx(Rn,{user:s}),e.jsxs("div",{className:"flex w-full flex-col items-start gap-3 py-3",children:[e.jsx(W,{color:"danger-outline",disabled:l,onClick:c,children:e.jsx(d,p({},pa.removeFromFamilyButton))}),e.jsx("p",{className:"text-token-text-secondary py-3 text-xs",children:e.jsx(d,{id:"jNO9yz",defaultMessage:"{LearnMoreLink} about parental controls",values:{LearnMoreLink:e.jsx(Os,{href:"https://help.openai.com/en/articles/12315553-parental-controls-faq",className:"underline",children:e.jsx(d,{id:"0M5wS5",defaultMessage:"Learn more"})})}})})]})]})}const pa=ae({back:{id:"amphora.parent.back",defaultMessage:"Back"},parentBadge:{id:"amphora.parent.badge",defaultMessage:"Parent"},removeFromFamilyButton:{id:"amphora.parent.removeFromFamily",defaultMessage:"Remove from family"},leaveConfirm:{id:"amphora.parent.leaveConfirm",defaultMessage:"Are you sure you want to leave this family group?"},unknownMember:{id:"amphora.parent.unknownMember",defaultMessage:"Member"}});function Vf(){"use forget";var de,Z;const t=Mt.c(85),s=k(),a=ee(),n=Gn(),o=Ol(),{openSettings:i}=ms();let r,l;t[0]!==o?(l=o.find(qf),t[0]=o,t[1]=l):l=t[1],r=l;const c=r;let u;e:{const ue=c==null?void 0:c.payload;if(!(ue!=null&&ue.family_group_id)){u=null;break e}u=ue}const m=u,g=(de=c==null?void 0:c.id)!=null?de:null,[f,x]=h.useState(!1),b=bt(),[M,y]=h.useState(null);let C,_;t[2]!==n||t[3]!==a||t[4]!==f||t[5]!==g||t[6]!==m?(C=()=>{n!==void 0&&!(n!=null&&n.id)&&m&&!f&&(x(!0),to(a,m,g!=null?g:void 0))},_=[a,n,m,g,f],t[2]=n,t[3]=a,t[4]=f,t[5]=g,t[6]=m,t[7]=C,t[8]=_):(C=t[7],_=t[8]),h.useEffect(C,_);const{members:v,raw:j}=Lf(n==null?void 0:n.id);let S;t[9]!==v?(S=v!=null?v:[],t[9]=v,t[10]=S):S=t[10];const N=S;let w;t[11]!==(j==null?void 0:j.items)?(w=(Z=j==null?void 0:j.items)!=null?Z:[],t[11]=j==null?void 0:j.items,t[12]=w):w=t[12];const A=w;let T,P,E,O,D,I,H,$,X,q,G;if(t[13]!==n||t[14]!==a||t[15]!==(b==null?void 0:b.id)||t[16]!==s||t[17]!==N||t[18]!==g||t[19]!==m||t[20]!==A||t[21]!==M){$=Symbol.for("react.early_return_sentinel");e:{const ue=A.filter(Kf);D=(n==null?void 0:n.role)==="owner",O=(n==null?void 0:n.role)==="member_role";let ye;t:{if(D){let Y;t[33]!==s?(Y=s.formatMessage(at.addChildCTA),t[33]=s,t[34]=Y):Y=t[34],ye=Y;break t}let B;t[35]!==s?(B=s.formatMessage(at.addFamilyMemberCTA),t[35]=s,t[36]=B):B=t[36],ye=B}E=ye;const re=D&&(n!=null&&n.id)?"member_role":void 0;let ne;if(t[37]!==(n==null?void 0:n.id)||t[38]!==a||t[39]!==re?(ne=()=>{var B;Ye(a,Sf,{amphora_id:(B=n==null?void 0:n.id)!=null?B:null,forceInviteeRole:re})},t[37]=n==null?void 0:n.id,t[38]=a,t[39]=re,t[40]=ne):ne=t[40],n==null||n.id,P=ne,n!=null&&n.id&&M){if(M.type==="parent"){let B;t[41]===Symbol.for("react.memo_cache_sentinel")?(B=()=>y(null),t[41]=B):B=t[41];let Y;t[42]!==n.id||t[43]!==M.member?(Y=e.jsx(zf,{amphoraId:n.id,selectedParent:M.member,onBack:B}),t[42]=n.id,t[43]=M.member,t[44]=Y):Y=t[44],$=Y;break e}if(M.type==="member"){let B;t[45]===Symbol.for("react.memo_cache_sentinel")?(B=()=>y(null),t[45]=B):B=t[45];let Y;t[46]!==n.id||t[47]!==M.member?(Y=e.jsx(Wf,{amphoraId:n.id,member:M.member,onBack:B}),t[46]=n.id,t[47]=M.member,t[48]=Y):Y=t[48],$=Y;break e}if(M.type==="relationship"){let B;t[49]===Symbol.for("react.memo_cache_sentinel")?(B=()=>y(null),t[49]=B):B=t[49];let Y;t[50]!==n.id||t[51]!==M.member?(Y=e.jsx(Bf,{amphoraId:n.id,member:M.member,onBack:B}),t[50]=n.id,t[51]=M.member,t[52]=Y):Y=t[52],$=Y;break e}if(M.type==="invite"){let B;t[53]===Symbol.for("react.memo_cache_sentinel")?(B=()=>y(null),t[53]=B):B=t[53];let Y;t[54]!==n.id||t[55]!==M.invite?(Y=e.jsx(vf,{amphoraId:n.id,invite:M.invite,onBack:B}),t[54]=n.id,t[55]=M.invite,t[56]=Y):Y=t[56],$=Y;break e}}T=Me,t[57]!==s?(X=s.formatMessage(at.amphoraControlsTab),t[57]=s,t[58]=X):X=t[58],q="https://help.openai.com/en/articles/12315553-parental-controls-faq",t[59]!==n||t[60]!==a||t[61]!==s||t[62]!==g||t[63]!==m?(G=n!==void 0&&!(n!=null&&n.id)&&m&&e.jsx(K,{children:e.jsx(Xe,{label:s.formatMessage(at.pendingAmphoraInvite),buttonLabel:s.formatMessage(at.inviteButton),onClick:()=>to(a,m,g!=null?g:void 0)})}),t[59]=n,t[60]=a,t[61]=s,t[62]=g,t[63]=m,t[64]=G):G=t[64],t[65]===Symbol.for("react.memo_cache_sentinel")?(I=e.jsx("div",{className:"flex min-h-15 items-center pt-4",children:e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex flex-col items-start gap-8 pt-1 pb-3",children:e.jsx("p",{className:"text-sm",children:e.jsx(d,p({},at.inviteAmphoraMembersParagraph))})})})}),t[65]=I):I=t[65],H=(n==null?void 0:n.id)&&(N.length>0||ue.length>0)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"mb-2 text-base font-medium",children:e.jsx(d,p({},at.amphoraMembersTitle))}),e.jsxs("div",{children:[N.map(B=>{var Se,We,He,Ae,ze;const Y=B.user_id,te=B.user_id===(b==null?void 0:b.id),me=B.role==="owner";return e.jsx("div",{className:"border-token-border-default hover:bg-token-interactive-bg-secondary-hover active:bg-token-interactive-bg-secondary-press border-t last:border-b",children:e.jsxs("button",{className:"flex w-full items-center justify-between py-4 pe-4",onClick:()=>{if(Y){if(me){y(D?{type:"parent",member:B}:{type:"relationship",member:B});return}(n==null?void 0:n.role)==="member_role"&&!te?y({type:"relationship",member:B}):y({type:"member",member:B})}},children:[e.jsxs("div",{className:"flex items-center gap-3 text-start",children:[e.jsx(mr,{user:{picture:(Se=B.profile_picture_url)!=null?Se:void 0,name:(He=(We=B.name)!=null?We:B.email)!=null?He:""},size:"large"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"text-[15px] leading-5",children:(ze=(Ae=B.name)!=null?Ae:B.email)!=null?ze:e.jsx(d,p({},at.amphoraMemberFallback))})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[me&&e.jsx(wa,{}),e.jsx(so,{className:"icon-sm opacity-60"})]})]})},Y)}),ue.map(B=>{var te,me;const Y=(te=B.user_id)!=null?te:B.email;return e.jsx("div",{className:"border-token-border-default hover:bg-token-interactive-bg-secondary-hover active:bg-token-interactive-bg-secondary-press border-t last:border-b",children:e.jsxs("button",{className:"flex w-full items-center justify-between py-4 pe-4",onClick:()=>y({type:"invite",invite:B}),children:[e.jsxs("div",{className:"flex items-center gap-3 text-start",children:[e.jsx("div",{className:"bg-token-bg-tertiary text-token-text-tertiary flex h-12 w-12 shrink-0 items-center justify-center rounded-full",children:e.jsx(Ci,{className:"icon-lg"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm",children:(me=B.email)!=null?me:e.jsx(d,p({},at.missingMember))}),e.jsxs("div",{className:"text-token-text-secondary mt-0.5 flex items-center gap-1 text-sm",children:[e.jsx(pn,{className:"icon-sm"}),e.jsx("span",{children:s.formatMessage(at.invitationSent)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[B.role==="owner"&&e.jsx(wa,{}),e.jsx(so,{className:"icon-sm opacity-60"})]})]})},"pending-".concat(Y))})]})]})}t[13]=n,t[14]=a,t[15]=b==null?void 0:b.id,t[16]=s,t[17]=N,t[18]=g,t[19]=m,t[20]=A,t[21]=M,t[22]=T,t[23]=P,t[24]=E,t[25]=O,t[26]=D,t[27]=I,t[28]=H,t[29]=$,t[30]=X,t[31]=q,t[32]=G}else T=t[22],P=t[23],E=t[24],O=t[25],D=t[26],I=t[27],H=t[28],$=t[29],X=t[30],q=t[31],G=t[32];if($!==Symbol.for("react.early_return_sentinel"))return $;let F;t[66]!==P||t[67]!==E||t[68]!==O?(F=!O&&e.jsx(K,{children:e.jsx("div",{className:"flex flex-col items-start gap-8 py-1",children:e.jsx(W,{color:"secondary",icon:Pn,onClick:P,children:E})})}),t[66]=P,t[67]=E,t[68]=O,t[69]=F):F=t[69];let R;t[70]!==T||t[71]!==I||t[72]!==H||t[73]!==F||t[74]!==X||t[75]!==q||t[76]!==G?(R=e.jsxs(T,{title:X,learnMoreHref:q,children:[G,I,H,F]}),t[70]=T,t[71]=I,t[72]=H,t[73]=F,t[74]=X,t[75]=q,t[76]=G,t[77]=R):R=t[77];let V;t[78]!==s||t[79]!==D||t[80]!==i?(V=D&&e.jsx(Me,{title:s.formatMessage(at.safetyNotifications),noBorder:!0,learnMoreHref:"https://help.openai.com/en/articles/12315553-parental-controls-faq",children:e.jsxs("div",{className:"flex flex-col items-start gap-3",children:[e.jsx("p",{className:"text-sm",children:e.jsx(d,p({},at.safetyNotificationsDescription))}),e.jsx(W,{color:"secondary",onClick:()=>i(fe.Notifications),children:e.jsx(d,p({},at.safetyNotificationsButton))})]})}),t[78]=s,t[79]=D,t[80]=i,t[81]=V):V=t[81];let Q;return t[82]!==R||t[83]!==V?(Q=e.jsxs(e.Fragment,{children:[R,V]}),t[82]=R,t[83]=V,t[84]=Q):Q=t[84],Q}function Kf(t){return t.status==="invited"}function qf(t){return t.notification_type==="family-invite"&&!t.reacted_to_at}const at=ae({amphoraControlsTab:{id:"settingsModal.amphoraControlsTab",defaultMessage:"Parental controls"},pendingAmphoraInvite:{id:"settingsModal.pendingAmphoraInvite",defaultMessage:"You have a pending family invite"},inviteAmphoraMembers:{id:"settingsModal.inviteAmphoraMembers",defaultMessage:"Invite family members"},inviteButton:{id:"settingsModal.inviteButton",defaultMessage:"Invite"},inviteAmphoraMembersParagraph:{id:"settingsModal.inviteAmphoraMembersParagraph3",defaultMessage:"Parents and teens can link accounts, giving parents tools to adjust certain features, set limits, and add safeguards that work for their family."},addFamilyMemberCTA:{id:"settingsModal.addFamilyMemberCTA",defaultMessage:"Add family member"},addChildCTA:{id:"settingsModal.addChildCTA",defaultMessage:"Add child"},amphoraMembersTitle:{id:"settingsModal.amphoraMembersTitle",defaultMessage:"Family members"},amphoraMembersRoleLabel:{id:"settingsModal.amphoraMembersRoleLabel",defaultMessage:"Role"},amphoraMembersStatusLabel:{id:"settingsModal.amphoraMembersStatusLabel",defaultMessage:"Status"},amphoraMemberFallback:{id:"settingsModal.amphoraMemberFallback",defaultMessage:"Family member"},removeMember:{id:"amphora.members.removeMember",defaultMessage:"Remove"},leaveAmphora:{id:"amphora.members.leaveAmphora",defaultMessage:"Leave family group"},invitedStatus:{id:"amphora.members.status.invited",defaultMessage:"Invited"},invitationSent:{id:"amphora.members.status.invitationSent",defaultMessage:"Invitation sent"},cancelInvite:{id:"amphora.invites.cancelInvite",defaultMessage:"Cancel"},cancelInviteError:{id:"amphora.invites.cancelInviteError",defaultMessage:"Unable to cancel invite: {error}"},missingMember:{id:"amphora.members.missingMember",defaultMessage:"[missing]"},selfLabel:{id:"amphora.members.self",defaultMessage:"You"},safetyNotifications:{id:"amphora.settings.safetyNotifications",defaultMessage:"Safety notifications"},safetyNotificationsDescription:{id:"amphora.settings.safetyNotificationsDescription",defaultMessage:"We care about your teen's safety. If we detect certain serious safety concerns, we will notify you—though no system is perfect. You can choose how you'd like to be contacted."},safetyNotificationsButton:{id:"amphora.settings.safetyNotificationsButton",defaultMessage:"Manage notifications"}});function $f(t){return t.type===ao.GDRIVE_SYNC_CONNECTOR||t.type===ao.SLACK_SYNC_CONNECTOR?"".concat(window.location.origin,"/ca/").concat(t.id,"/oauth/callback"):"".concat(window.location.origin,"/ccc/").concat(t.id,"/oauth/callback")}const Qf=({isConnected:t,onDisconnect:s,onConnect:a,isDisabledByAdmin:n})=>e.jsx(Un,{isConnected:t,onConnect:a,onDisconnect:s,isDisabledByAdmin:n}),Yf=({entry:t,isConnected:s,onDisconnect:a,onConnect:n,redirectUri:o})=>e.jsx(Un,{isConnected:s,onConnect:()=>n({id:t.id},"settings_connected_apps",$f(t),o),onDisconnect:()=>a(t==null?void 0:t.type)}),Un=({isConnected:t,isDisabledByAdmin:s,onDisconnect:a,onConnect:n})=>{const o=k();return s?e.jsx(tt,{label:o.formatMessage(ha.disabledByAdmin),children:e.jsx(W,{onClick:a,color:"secondary",size:"small",disabled:s,children:e.jsx(d,p({},ha.connect))})}):t?e.jsx(W,{onClick:a,color:"danger-outline",size:"small",children:e.jsx(d,p({},ha.disconnect))}):e.jsx(W,{onClick:n,color:"secondary",size:"small",children:e.jsx(d,p({},ha.connect))})},ha=ae({connect:{id:"connectorSettings.connect",defaultMessage:"Connect"},disconnect:{id:"connectorSettings.disconnect",defaultMessage:"Disconnect"},disabledByAdmin:{id:"connectorSettings.disabledByAdmin",defaultMessage:"Disabled by workspace admin"}});function Zf({connectorType:t,description:s,linkId:a,customRedirectUrl:n,isDisabledByAdmin:o}){const i=Vm();let r,l;switch(t){case U.GDRIVE_ACTION_CONNECTOR:r=Pa,l="Google Drive (Deep Research)";break;case U.GITHUB_CONNECTOR:r=ql,l="GitHub";break;case U.DROPBOX_CONNECTOR:r=Kl,l="Dropbox";break;case U.HUBSPOT_CONNECTOR:r=Vl,l="HubSpot";break;case U.LINEAR_CONNECTOR:r=zl,l="Linear";break;case U.SHAREPOINT_CONNECTOR:r=Ks,l="Microsoft OneDrive (work/school)";break;case U.GCAL_CONNECTOR:r=Ti,l="Google Calendar";break;case U.GMAIL_CONNECTOR:r=ki,l="Gmail";break;case U.GOOGLE_CONTACTS_CONNECTOR:r=Ni,l="Google Contacts";break;case U.OUTLOOK_EMAIL_CONNECTOR:r=Hl,l="Outlook Email";break;case U.OUTLOOK_CALENDAR_CONNECTOR:r=Wl,l="Outlook Calendar";break;case U.TEAMS_CONNECTOR:r=Ul,l="Teams";break;case U.BOX_CONNECTOR:r=Gl,l="Box";break;case U.INTERCOM_CONNECTOR:r=Fl,l="Intercom";break;case U.CANVA_CONNECTOR:r=Bl,l="Canva";break;case U.NOTION_CONNECTOR:r=wi,l="Notion";break;case U.SLACK_CONNECTOR:case U.SLACK_CODEX_CONNECTOR:r=_i,l="Slack";break}const c=!!a,u=bn(),m=k(),g=ce(),f=ji();return e.jsx(K,{children:e.jsx(zt,{icon:e.jsx(r,{className:"icon-lg"}),title:l,description:e.jsx(d,J(p({},s),{values:{help_center_article:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903",className:"underline",target:"_blank",rel:"noopener noreferrer",children:e.jsx(d,{id:"AM6qbf",defaultMessage:"help center article"})})}})),statusIndicator:e.jsx(Qf,{isConnected:c,onDisconnect:()=>{t===U.GITHUB_CONNECTOR&&ru(),f(st[t])},onConnect:()=>{Rl({connectorType:t,intl:m,toaster:g,openPopup:u,customRedirectUrl:n,onError:i})},isDisabledByAdmin:o}),showGitHubConfigure:t===U.GITHUB_CONNECTOR&&c&&!o})})}function Xa({entry:t,description:s}){let a;switch(t.type){case Ee.CONFLUENCE:a=Ql;break;case Ee.GDRIVE:a=Pa;break;case Ee.JIRA:a=$l;break;case Ee.NOTION_OPEN_CONNECTOR:a=wi;break;case Ee.O365:case Ee.O365_PERSONAL:case Ee.O365_BUSINESS:a=Ks;break;case Ee.SLACK_OPEN_CONNECTOR:a=_i;break}const n=k();return e.jsx(K,{children:e.jsx(zt,{icon:e.jsx(a,{className:"icon-lg"}),title:hn(t.type,n),description:e.jsx(d,p({},s)),statusIndicator:e.jsx(Yf,{entry:t,isConnected:!!t.access_token,onDisconnect:vi,onConnect:Il,redirectUri:xn})})})}function Xf({clientApplications:t}){const{mutate:s,isPending:a}=Si();return e.jsx(e.Fragment,{children:t.map(n=>e.jsx(Jf,{clientApplication:n,disabled:a,onDisconnect:()=>{se.logEventWithStatsig("Connector Settings: Client Application Disconnect Button Clicked","chatgpt_connector_settings_client_application_disconnect_button_clicked",{id:n.id,name:n.name,type:n.type}),s(n.id)}},n.id))})}function Jf({clientApplication:t,disabled:s,onDisconnect:a}){return e.jsx(K,{children:e.jsx(zt,{icon:e.jsx(ar,{className:"icon-lg"}),title:t.name,description:e.jsx(d,p({},ka.appleDesc)),statusIndicator:e.jsx(W,{onClick:a,color:"danger-outline",size:"small",disabled:s,children:e.jsx(d,p({},ka.disconnect))})})})}function ep({clientApplications:t}){const{mutate:s,isPending:a}=Si();return e.jsx(e.Fragment,{children:t.map(n=>e.jsx(tp,{clientApplication:n,disabled:a,onDisconnect:()=>{se.logEventWithStatsig("Connector Settings: Codex CLI Client Application Disconnect Button Clicked","chatgpt_connector_settings_client_application_disconnect_button_clicked",{id:n.id,name:n.name,type:n.type}),s(n.id)}},n.id))})}function tp({clientApplication:t,disabled:s,onDisconnect:a}){return e.jsx(K,{children:e.jsx(zt,{icon:e.jsx(lu,{className:"icon-lg"}),title:t.name,description:e.jsx(d,p({},ka.codexCLIDesc)),statusIndicator:e.jsx(W,{onClick:a,color:"danger-outline",size:"small",disabled:s,children:e.jsx(d,p({},ka.disconnect))})})})}const ka=ae({appleDesc:{id:"P5OVxG",defaultMessage:"Get personalized ChatGPT responses and Plus benefits when using Siri and Writing Tools."},disconnect:{id:"connectorSettings.disconnectButton",defaultMessage:"Disconnect"},codexCLIDesc:{id:"DWVivD",defaultMessage:"Allow Codex CLI to use models from the API."}});function sp(){const{data:t}=Ze(Yl),s=t==null?void 0:t.items,a=s==null?void 0:s.filter(({type:r})=>r==="apple"),n=!!(a!=null&&a.length),o=s==null?void 0:s.filter(({type:r})=>r==="codex_cli"),i=!!(o!=null&&o.length);return e.jsxs(Me,{title:e.jsx(d,p({},Eo.secureSigninTitle)),description:e.jsx(d,J(p({},Eo.secureSigninDescription),{values:{learn_more_link:e.jsx("a",{href:"https://help.openai.com/en/collections/13193904-secure-sign-in",className:"underline",target:"_blank",rel:"noopener noreferrer",children:e.jsx(d,{id:"G/jd2T",defaultMessage:"Learn more"})})}})),children:[!n&&!i&&e.jsx("div",{className:"text-token-text-secondary bg-token-bg-tertiary my-4 rounded-xl p-4",children:e.jsx(d,{id:"5VTvRh",defaultMessage:"You haven’t used ChatGPT to sign into any websites or apps yet. Once you do, they’ll show up here."})}),n&&e.jsx(Xf,{clientApplications:a}),i&&e.jsx(ep,{clientApplications:o})]})}const Eo=ae({secureSigninTitle:{id:"wGZ2DC",defaultMessage:"Secure sign in with ChatGPT"},secureSigninDescription:{id:"mq87/x",defaultMessage:"Sign in to websites and apps across the internet with the trusted security of ChatGPT. {learn_more_link}"}});function Ja({type:t}){let s,a=Cs.googleCalendarName,n=Cs.googleCalendarDesc;switch(t){case _s.GCAL_CONNECTOR:s=Ti;break;case _s.GMAIL_CONNECTOR:s=ki,a=Cs.gmailName,n=Cs.gmailDesc;break;case _s.GOOGLE_CONTACTS_CONNECTOR:s=Ni,a=Cs.googleContactsName,n=Cs.googleContactsDesc;break}const o=k(),{connectors:i}=Zl([t]),r=i.get(t);if(!r)return null;const l="#settings/".concat(fe.Connectors);return e.jsx(K,{children:e.jsxs("div",{className:"flex flex-col gap-2 pt-3 pb-1",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(s,{className:"icon-lg"}),e.jsx("p",{className:"text-md text-token-text-primary flex-1 font-semibold",children:o==null?void 0:o.formatMessage(a)}),e.jsx(Un,{isConnected:!!r.access_token,onDisconnect:()=>{vi(r.type)},onConnect:()=>{Xl({id:r.id},l)}})]}),e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(d,p({},n))})]})})}const Cs=ae({googleCalendarDesc:{id:"connectorSettings.googleCalendarDesc.1",defaultMessage:"View your Google Calendar and schedule events."},googleCalendarName:{id:"connectorSettings.googleCalendarName.1",defaultMessage:"Google Calendar"},gmailDesc:{id:"connectorSettings.gmailDesc.1",defaultMessage:"View and send emails from your Gmail account."},gmailName:{id:"connectorSettings.gmailName.1",defaultMessage:"Gmail"},googleContactsDesc:{id:"connectorSettings.googleContactsDesc.1",defaultMessage:"View and manage your Google Contacts."},googleContactsName:{id:"connectorSettings.googleContactsName.1",defaultMessage:"Google Contacts"}}),ap=()=>{const t=ee(),s=oe(t,"2509278897"),{isGdriveEnabled:a,isO365Enabled:n,connectorConfig:o,isLoading:i}=Mn(),r=ee(),l=oe(r,"4206189746"),c=o.get(Ee.GDRIVE),u=o.get(Ee.O365_PERSONAL),m=o.get(Ee.O365_BUSINESS),g=a&&!!c&&!s,f=n&&!!u,x=n&&!!m,b=g||f||x||l;return s&&(i||!b)?null:e.jsx(Me,{title:e.jsx(d,p({},Xt.fileUploadsTitle)),description:e.jsx(d,p({},Xt.fileUploadsDescription)),children:i?e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})}):b?e.jsxs(e.Fragment,{children:[l&&e.jsxs(e.Fragment,{children:[e.jsx(Ja,{type:_s.GCAL_CONNECTOR}),e.jsx(Ja,{type:_s.GMAIL_CONNECTOR}),e.jsx(Ja,{type:_s.GOOGLE_CONTACTS_CONNECTOR})]}),c&&g&&e.jsx(Xa,{entry:c,description:Xt.googleDriveDesc}),u&&f&&e.jsx(Xa,{entry:u,description:Xt.o365Desc}),m&&x&&e.jsx(Xa,{entry:m,description:Xt.o365BusinessDesc})]}):e.jsx(ta,{type:"info",children:e.jsx(d,p({},Xt.noConnectorSettings))})})},np=new Set([U.GCAL_CONNECTOR,U.GMAIL_CONNECTOR,U.GOOGLE_CONTACTS_CONNECTOR]),op=()=>{const t=ee(),s=oe(t,"2509278897"),{isConfluenceEnabled:a,isJiraEnabled:n,isNotionOpenConnectorEnabled:o,isSlackOpenConnectorEnabled:i,connectorConfig:r,isLoading:l}=Mn(),c=r.get(Ee.CONFLUENCE),u=r.get(Ee.NOTION_OPEN_CONNECTOR),m=r.get(Ee.JIRA),g=r.get(Ee.SLACK_OPEN_CONNECTOR),f=a&&!!c,x=n&&!!m,b=o&&!!u,M=i&&!!g,y=ee(),C=oe(y,"4206189746"),{connectorLinks:_,isLoading:v}=xt(),{availableConnectors:j,isLoading:S}=Aa(),{enabled:N}=Jl(),w=f||x||b||M||!s&&(j.length>0||C),A=h.useMemo(()=>s?[]:[...new Set([...j.map(({type:E})=>E).filter(E=>Object.values(U).includes(E)),...C?np:[]])],[j,C,s]),T=l||v||S;return s&&(T||!w)||!T&&!w?null:e.jsx(Me,{title:e.jsx(d,p({},Xt.connectorsTitle)),description:e.jsx(d,J(p({},Xt.connectorsDescription),{values:{learn_more_link:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903",className:"underline",target:"_blank",rel:"noopener noreferrer",children:e.jsx(d,{id:"JX5fMM",defaultMessage:"Learn more"})})}})),children:T?e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})}):e.jsxs(e.Fragment,{children:[!1,!1,!1,!1,A.map(P=>{var E,O;return Po[P]&&e.jsx("div",{id:ec[P],children:e.jsx(Zf,{connectorType:P,description:Po[P],linkId:(O=(E=_.get(st[P]))==null?void 0:E[0])==null?void 0:O.id,isDisabledByAdmin:P===U.GITHUB_CONNECTOR&&!N})},P)})]})})},Xt=ae({fileUploadsTitle:{id:"connectorSettings.fileUploadsTitle",defaultMessage:"File uploads"},fileUploadsDescription:{id:"connectorSettings.fileUploadsDescription",defaultMessage:"These apps will allow you to add files to ChatGPT messages."},connectorsTitle:{id:"connectorSettings.connectorsTitle",defaultMessage:"Connectors (Beta)"},connectorsDescription:{id:"connectorSettings.connectorsDescription",defaultMessage:"Connect these data sources so ChatGPT can access their information — based on what you’re authorized to view. {learn_more_link}"},googleDriveDesc:{id:"connectorSettings.googleDriveDesc.1",defaultMessage:"Upload Google Docs, Sheets, Slides and other files."},o365Desc:{id:"connectorSettings.o365Desc.1",defaultMessage:"Upload Microsoft Word, Excel, PowerPoint and other files."},o365BusinessDesc:{id:"connectorSettings.o365BusinessDesc.1",defaultMessage:"Upload Microsoft Word, Excel, PowerPoint, and other files, including those from SharePoint sites."},noConnectorSettings:{id:"connectorSettings.noConnectorSettings",defaultMessage:"Unable to get connected apps"}}),Po={[U.GITHUB_CONNECTOR]:{id:"connectorSettings.githubDesc.1",defaultMessage:"Allow ChatGPT deep research to read your GitHub repositories.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their GitHub repositories."},[U.GDRIVE_ACTION_CONNECTOR]:{id:"connectorSettings.gdriveActionDesc.1",defaultMessage:"Allow ChatGPT deep research to read Google Drive files.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Google Drive content."},[U.DROPBOX_CONNECTOR]:{id:"connectorSettings.dropboxDesc.1",defaultMessage:"Allow ChatGPT deep research to read Dropbox files.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Dropbox files."},[U.HUBSPOT_CONNECTOR]:{id:"connectorSettings.hubspotDesc.1",defaultMessage:"Allow ChatGPT deep research to read HubSpot.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Hubspot."},[U.LINEAR_CONNECTOR]:{id:"connectorSettings.linearDesc.1",defaultMessage:"Allow ChatGPT deep research to read Linear projects.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Linear projects."},[U.SHAREPOINT_CONNECTOR]:{id:"connectorSettings.sharepointDesc.1",defaultMessage:"Allow ChatGPT deep research to read files, including those from Sharepoint.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their SharePoint/OneDrive files."},[U.GCAL_CONNECTOR]:{id:"connectorSettings.gcalDesc.1",defaultMessage:"Allow ChatGPT to read and create Google Calendar events.",description:"Shown in user settings. Lets users grant ChatGPT read-only access to their Google Calendar events."},[U.GMAIL_CONNECTOR]:{id:"connectorSettings.gmailDesc.1",defaultMessage:"Allow ChatGPT to read and send Gmail emails.",description:"Shown in user settings. Lets users grant ChatGPT access to their Gmail emails."},[U.GOOGLE_CONTACTS_CONNECTOR]:{id:"connectorSettings.googleContactsDesc.1",defaultMessage:"Allow ChatGPT to read Google Contacts.",description:"Shown in user settings. Lets users grant ChatGPT read-only access to their Google Contacts."},[U.BOX_CONNECTOR]:{id:"connectorSettings.boxDesc.1",defaultMessage:"Allow ChatGPT deep research to read Box files.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Box files."},[U.TEAMS_CONNECTOR]:{id:"connectorSettings.teamsDesc.1",defaultMessage:"Allow ChatGPT deep research to read Microsoft Teams chats.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Microsoft Teams chats."},[U.OUTLOOK_EMAIL_CONNECTOR]:{id:"connectorSettings.outlookEmailDesc.1",defaultMessage:"Allow ChatGPT deep research to read Outlook emails.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Outlook emails."},[U.OUTLOOK_CALENDAR_CONNECTOR]:{id:"connectorSettings.outlookCalendarDesc.1",defaultMessage:"Allow ChatGPT deep research to read Outlook Calendar events.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Outlook Calendar events."},[U.INTERCOM_CONNECTOR]:{id:"connectorSettings.intercomDesc.1",defaultMessage:"Allow ChatGPT deep research to read Intercom conversations.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Intercom conversations."},[U.CANVA_CONNECTOR]:{id:"connectorSettings.canvaDesc.1",defaultMessage:"Allow ChatGPT deep research to read Canva designs.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Canva designs."},[U.SLACK_CONNECTOR]:{id:"connectorSettings.slackDesc.1",defaultMessage:"Allow ChatGPT deep research to read Slack messages.",description:"Shown in user settings. Lets users grant ChatGPT deep research read-only access to their Slack messages."},[U.SLACK_CODEX_CONNECTOR]:{id:"connectorSettings.slackCodexDesc.1",defaultMessage:"Allow Codex to access Slack conversations and start codex tasks.",description:"Shown in user settings. Lets users grant Codex access to their Slack conversations from Codex integrations."}},ip=jt(()=>St(()=>import("./oxo0r33hqmhdtptf.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.GithubOnboardingModal));function rp(){const t=ee(),s=Ls(),a=$e();return h.useEffect(()=>{if(window.location.hash){const n=window.location.hash,o=n.indexOf("?");if(o!==-1){const i=n.substring(o+1),l=new URLSearchParams(i).get("scroll");if(l){let c=0;const u=3,m=()=>{const g=document.getElementById(l);g?g.scrollIntoView({behavior:"smooth"}):c<u&&(c+=1,setTimeout(m,100))};m()}}}},[]),h.useEffect(()=>{const n=window.location.hash,o=n.indexOf("?");if(o===-1)return;const i=new URLSearchParams(n.substring(o+1));if(i.has("github_onboarding")){const r=i.get("github_onboarding");let l=Bt.ConfigureRepos;r&&[Bt.ConfigureRepos,Bt.SyncRepos,Bt.IndexRepos].includes(r)&&(l=r),Ye(t,ip,{initialState:l}),i.delete("github_onboarding");const c=n.substring(0,o),u=i.toString()?"".concat(c,"?").concat(i.toString()):c;a({hash:u},{replace:!0})}},[t,a]),h.useEffect(()=>{se.logEventWithStatsig("Connectors Settings Modal Shown","chatgpt_connectors_settings_modal_shown")},[]),e.jsxs(e.Fragment,{children:[s&&e.jsx(Ei,{}),e.jsx(ap,{}),e.jsx(op,{})]})}const lp="https://platform.openai.com/docs/mcp#risks-and-safety",Ws=ae({title:{id:"QvgpB4",defaultMessage:"Advanced settings"},developerModeTitle:{id:"4DDtEK",defaultMessage:"Developer mode"},developerModeDescription:{id:"Uo45Zz",defaultMessage:"Allows you to add unverified connectors that could modify or erase data permanently. Memory is disabled. Use at your own risk. <link>Learn more</link>"},developerModeDisabledByAdmin:{id:"1dOaHH",defaultMessage:"Your admin has not enabled developer mode."},backButton:{id:"2XH9oW",defaultMessage:"Back"}});function cp({onBack:t}){const s=k(),a=ee(),n=Kt(),o=ot(!0),i=oe(a,"735368229"),r=tc();return!i&&!n?null:e.jsx(Me,{title:e.jsxs(W,{color:"ghost",size:"small",onClick:t,contentWrapperClassName:"gap-[6px]",className:"rounded-lg ps-0.5 pe-1.5",children:[e.jsx(An,{className:"icon icon-sm"}),e.jsx(d,p({},Ws.backButton))]}),children:e.jsx(K,{children:e.jsx(Be,{label:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,p({},Ws.developerModeTitle)),e.jsx(cu,{})]}),ariaLabel:s.formatMessage(Ws.developerModeTitle),disabled:!r||o.isPending,toggleTooltip:r?void 0:s.formatMessage(Ws.developerModeDisabledByAdmin),enabled:n,onChange:l=>{o.mutate({setting:ge.DeveloperMode,value:l})},description:e.jsx(d,J(p({},Ws.developerModeDescription),{values:{link:l=>e.jsx(ts,{href:lp,openNewTab:!0,children:l})}}))})})})}const _e=ae({widgetDomain:{id:"2OSUeW",defaultMessage:"Widget domain"},connectDomains:{id:"heImfx",defaultMessage:"Widget connect domains"},resourceDomains:{id:"9pywc9",defaultMessage:"Widget resource domains"},worksWith:{id:"g1eGWJ",defaultMessage:"Works with"},category:{id:"XG1+sz",defaultMessage:"Category"},developer:{id:"6JoJBm",defaultMessage:"Developer"},website:{id:"8Qxsof",defaultMessage:"Website"},privacyPolicy:{id:"diKoqe",defaultMessage:"Privacy Policy"},categoryBusinessAndAnalytics:{id:"QhPypU",defaultMessage:"Business and Analytics"},categoryCreativityAndDesign:{id:"/bcuXB",defaultMessage:"Creativity and Design"},categoryDeveloperTools:{id:"15wsiU",defaultMessage:"Developer Tools"},categoryMessagingAndSocial:{id:"rBRiVM",defaultMessage:"Messaging and Social"},categoryProductivity:{id:"UH2JU4",defaultMessage:"Productivity"},categoryResearchAndKnowledge:{id:"WKfdK1",defaultMessage:"Research and Knowledge"},baseUrl:{id:"XOcfO/",defaultMessage:"URL"},safetyScanTitle:{id:"1IzOM7",defaultMessage:"Safety Scan"},safetyScanScanningStatus:{id:"YfgX5F",defaultMessage:"Scanning"},safetyScanPassed:{id:"UrwyRa",defaultMessage:"Passed"},safetyScanFailed:{id:"FeaZe+",defaultMessage:"Failed"},authorizationSupported:{id:"oA2ynd",defaultMessage:"Authorization supported"},linkAuthorizationType:{id:"39RCjo",defaultMessage:"Authorization used"},authorizationTypeOAuth:{id:"VsekFo",defaultMessage:"OAuth"},authorizationTypeApiKey:{id:"1WrvLC",defaultMessage:"API key"},authorizationTypeNone:{id:"ETv4pb",defaultMessage:"None"}}),dp=(t,s)=>{switch(t){case"BUSINESS_AND_ANALYTICS":return s.formatMessage(_e.categoryBusinessAndAnalytics);case"CREATIVITY_AND_DESIGN":return s.formatMessage(_e.categoryCreativityAndDesign);case"DEVELOPER_TOOLS":return s.formatMessage(_e.categoryDeveloperTools);case"MESSAGING_AND_SOCIAL":return s.formatMessage(_e.categoryMessagingAndSocial);case"PRODUCTIVITY":return s.formatMessage(_e.categoryProductivity);case"RESEARCH_AND_KNOWLEDGE":return s.formatMessage(_e.categoryResearchAndKnowledge);default:return null}},up=t=>!t||typeof t!="object"?null:"type"in t&&t.type?t.type:"header_scheme"in t?"API_KEY":"authorization_url"in t?"OAUTH":"NONE",Ao=(t,s)=>{switch(t){case"OAUTH":return s.formatMessage(_e.authorizationTypeOAuth);case"API_KEY":return s.formatMessage(_e.authorizationTypeApiKey);case"NONE":return s.formatMessage(_e.authorizationTypeNone)}return t},ia=(t,s,a,n)=>{var x,b,M,y,C,_,v,j;const o=(x=n==null?void 0:n.isDeveloperMode)!=null?x:!1,i=n==null?void 0:n.linkAuthType,r=[];s&&s.length>0&&r.push({title:a.formatMessage(_e.worksWith),value:aa(s,a)});const l=dp((b=t.branding)==null?void 0:b.category,a);if(l&&r.push({title:a.formatMessage(_e.category),value:l}),(M=t.branding)!=null&&M.developer&&r.push({title:a.formatMessage(_e.developer),value:t.branding.developer}),(y=t.branding)!=null&&y.website&&r.push({title:a.formatMessage(_e.website),value:e.jsx(ts,{href:t.branding.website,openNewTab:!0,underline:!1,"aria-label":a.formatMessage(_e.website),className:"text-blue-400",children:e.jsx(As,{className:"icon"})})}),(C=t.branding)!=null&&C.privacy_policy&&r.push({title:a.formatMessage(_e.privacyPolicy),value:e.jsx(ts,{href:t.branding.privacy_policy,openNewTab:!0,underline:!1,"aria-label":a.formatMessage(_e.privacyPolicy),className:"text-blue-400",children:e.jsx(As,{className:"icon"})})}),["MCP","OPEN_API"].includes(t.connector_type)&&t.base_url&&r.push({title:a.formatMessage(_e.baseUrl),value:t.base_url}),t.policy_info){const S=t.policy_info.safety_status==="SCANNED_OK"?e.jsx(sc,{className:"icon-sm text-token-text-primary"}):t.policy_info.safety_status==="SCANNED_BLOCKED"?e.jsx(Pi,{className:"icon-sm interactive-label-warning-secondary"}):e.jsx(Oe,{className:"icon-sm"}),N=t.policy_info.safety_status==="SCANNED_OK"?e.jsx(d,p({},_e.safetyScanPassed)):t.policy_info.safety_status==="SCANNED_BLOCKED"?e.jsx(d,p({},_e.safetyScanFailed)):e.jsx(d,p({},_e.safetyScanScanningStatus));t.policy_info.safety_status!=="SCANNED_OK"&&r.push({title:a.formatMessage(_e.safetyScanTitle),value:e.jsxs("span",{className:"flex items-center gap-1",children:[S,N]})})}if(!o)return r;const c=((_=t.supported_auth)!=null?_:[]).map(S=>up(S)).filter(S=>!!S),u=Array.from(new Set(c)),g=(u.length>0?u:["NONE"]).map(S=>Ao(S,a)),f=g.length>1?a.formatList(g):g[0];return r.push({title:a.formatMessage(_e.authorizationSupported),value:f}),i&&r.push({title:a.formatMessage(_e.linkAuthorizationType),value:Ao(i,a)}),t.widget_domain&&r.push({title:a.formatMessage(_e.widgetDomain),value:t.widget_domain}),t.widget_csp_config&&(r.push({title:a.formatMessage(_e.connectDomains),value:(v=t.widget_csp_config.connect_domains)==null?void 0:v.map(S=>'"'.concat(S,'"')).join(", ")}),r.push({title:a.formatMessage(_e.resourceDomains),value:(j=t.widget_csp_config.resource_domains)==null?void 0:j.map(S=>'"'.concat(S,'"')).join(", ")})),r},Ma=ae({allowH17180rActivity:{id:"G79Ih9",defaultMessage:"Allow proactive activity"},allowH17180rGmailDesc:{id:"HzRL3y",defaultMessage:"Let ChatGPT proactively read Gmail and give you helpful insights. <link>Learn more</link>"},allowH17180rGoogleCalendarDesc:{id:"ziIyKz",defaultMessage:"Let ChatGPT proactively read Google Calendar and give you helpful insights. <link>Learn more</link>"},allowH17180rGoogleContactsDesc:{id:"1hp0Yi",defaultMessage:"Let ChatGPT proactively read Google Contacts and give you helpful insights. <link>Learn more</link>"}}),Hr={[st[U.GMAIL_CONNECTOR]]:ge.H17180rGmail,[st[U.GCAL_CONNECTOR]]:ge.H17180rGoogleCalendar,[st[U.GOOGLE_CONTACTS_CONNECTOR]]:ge.H17180rGoogleContacts},mp=new Set(Object.keys(Hr));function zr(t){const s=ee();return!!(oe(s,"3304830717")&&t&&mp.has(t))}function gp(t){switch(t){case st[U.GMAIL_CONNECTOR]:return Ma.allowH17180rGmailDesc;case st[U.GCAL_CONNECTOR]:return Ma.allowH17180rGoogleCalendarDesc;case st[U.GOOGLE_CONTACTS_CONNECTOR]:return Ma.allowH17180rGoogleContactsDesc;default:return}}function fp({connectorId:t,connectorName:s}){const a=k(),n=zr(t),o=t!=null?Hr[t]:void 0,{data:i,isLoading:r}=ac(f=>{var x;if(o)return(x=f.settings)==null?void 0:x[o]}),{mutate:l,isPending:c}=ot(!0),u=i!=null?i:!0,m=h.useCallback(()=>{o&&l({setting:o,value:!u})},[l,o,u]);if(!n||!o)return null;const g=gp(t);return g?e.jsx(K,{children:e.jsx(Be,{label:a.formatMessage(Ma.allowH17180rActivity,{connectorName:s}),description:e.jsx(d,J(p({},g),{values:{connectorName:s,link:f=>e.jsx(Os,{href:"https://help.openai.com/en/articles/11487775-connectors-in-chatgpt",className:"underline",children:f})}})),enabled:!!u,isLoading:r||c,onChange:m})}):null}const le=ae({connectorDisabled:{id:"v6nWaS",defaultMessage:"This connector is not enabled for your account. Please contact your administrator to enable it."},backButton:{id:"2XH9oW",defaultMessage:"Back"},information:{id:"m6oyFG",defaultMessage:"Information"},blockItems:{id:"guxwme",defaultMessage:"Exclude items from sync"},connectButton:{id:"bQDuj2",defaultMessage:"Connect"},refreshActionsButton:{id:"lyYLo0",defaultMessage:"Refresh"},enableSync:{id:"FQFQxe",defaultMessage:"Enable sync"},disableSync:{id:"BNY6qe",defaultMessage:"Disable sync"},disableSyncModalTitle:{id:"DGZB7x",defaultMessage:"Disable sync for {connector}?"},disableSyncModalDescription:{id:"qJQyMJ",defaultMessage:"All synced data will be deleted. If you re-enable sync, it can take 8 hours or more to sync all content."},disableSyncModalCheckboxLabel:{id:"Dl8YNg",defaultMessage:"I understand all synced data will be deleted"},disconnectButton:{id:"eeZbkM",defaultMessage:"Disconnect"},settingsButton:{id:"Z24j9e",defaultMessage:"Settings"},manageDropdown:{id:"q/O9f7",defaultMessage:"Manage"},reportButton:{id:"R5Pd7v",defaultMessage:"Report"},reportModalTitle:{id:"6oNeBk",defaultMessage:"Report"},connectedOn:{id:"b1ykGv",defaultMessage:"Connected on"},createdAt:{id:"TACRvJ",defaultMessage:"Created at"},deleteButton:{id:"Gn89FJ",defaultMessage:"Delete"},actions:{id:"K1PvPz",defaultMessage:"Actions"},readAction:{id:"OUdavU",defaultMessage:"Read"},writeAction:{id:"hfCHYo",defaultMessage:"Write"},openWorldAction:{id:"cwPgDK",defaultMessage:"Open world"},metadataHeading:{id:"qLsGc8",defaultMessage:"Metadata"},metadataOutputTemplate:{id:"KzJNSi",defaultMessage:"Output template"},metadataToolInvokingMessage:{id:"vNFHen",defaultMessage:"Invoking message"},metadataToolInvokedMessage:{id:"BQ6rYZ",defaultMessage:"Invoked message"},metadataWidgetAccessible:{id:"hdiMx2",defaultMessage:"Widget accessible"},securitySchemes:{id:"xkLoDf",defaultMessage:"Security schemes"},githubInstallationAlert:{id:"V4NUT5",defaultMessage:"ChatGPT needs access to your repositories to search them."},chooseRepos:{id:"VW7eJj",defaultMessage:"Choose repositories"},preferences:{id:"7kCnYS",defaultMessage:"Preferences"},recommendConnection:{id:"XpEYQL",defaultMessage:"Connection recommendations"},recommendConnectionDescription:{id:"CH3i+a",defaultMessage:"Let ChatGPT recommend connecting to {connectorName} when responding."},allowUsingAutomatically:{id:"VaMXaj",defaultMessage:"Use automatically in chat"},allowUsingAutomaticallyDescription:{id:"IHuWia",defaultMessage:"Let ChatGPT reference {connectorName} automatically when responding."},settingError:{id:"zcPmpl",defaultMessage:"Error updating setting."},editDescription:{id:"8KkNYS",defaultMessage:"Edit connector descriptions"},saveDescription:{id:"b728ms",defaultMessage:"Save"},descriptionFieldLabel:{id:"G4TQb4",defaultMessage:"Connector description"},descriptionPlaceholder:{id:"UDk3bR",defaultMessage:"Describe what this connector does for your team"},modelDescriptionFieldLabel:{id:"5YP4M7",defaultMessage:"Model description"},updateDescriptionSuccess:{id:"s/uJtK",defaultMessage:"Connector details updated"},updateDescriptionError:{id:"/zjnPq",defaultMessage:"Couldn't update connector details"}}),Vr="openai/outputTemplate",Kr="openai/toolInvocation/invoking",qr="openai/toolInvocation/invoked",$r="openai/widgetAccessible",pp=[Vr,Kr,qr,$r],Qr=t=>{if(t){if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")return String(t);try{return JSON.stringify(t,null,2)}catch(s){return String(t)}}},hp=t=>pp.reduce((s,a)=>{const n=Qr(t==null?void 0:t[a]);return n===void 0||s.push({key:a,value:n}),s},[]),xp=({entries:t,headingMessage:s,labels:a})=>{"use no forget";return t.length===0?null:e.jsxs("div",{className:"mt-1 flex flex-col gap-2 text-xs",children:[e.jsx("div",{className:"text-token-text-tertiary text-[11px] font-semibold uppercase",children:e.jsx(d,p({},s))}),t.map(({key:n,value:o})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:"text-token-text-secondary",children:e.jsx(d,p({},a[n]))}),e.jsx("pre",{className:"bg-token-bg-tertiary text-token-text-tertiary rounded-md px-2 py-1 font-mono text-[11px] leading-[14px] whitespace-pre-wrap",children:o})]},n))]})},bp=t=>!t||t.length===0?[]:t.reduce((s,a)=>{const n=Qr(a);return n===void 0||s.push({key:a.type,value:n}),s},[]),Mp=({entries:t,headingMessage:s})=>{"use no forget";if(t.length===0)return e.jsx(e.Fragment,{});const a=t.map(n=>n.value).join(",\n");return e.jsxs("div",{className:"mt-1 flex flex-col gap-2 text-xs",children:[e.jsx("div",{className:"text-token-text-tertiary text-[11px] font-semibold uppercase",children:e.jsx(d,p({},s))}),e.jsx("pre",{className:"bg-token-bg-tertiary text-token-text-tertiary rounded-md px-2 py-1 font-mono text-[11px] leading-[14px] whitespace-pre-wrap",children:a})]})},yp=t=>{const s=[];return!!t.is_consequential&&s.push("write"),s},Cp=({badgeKeys:t,labels:s})=>t.length===0?null:e.jsx("div",{className:"flex items-center gap-1",children:t.map(a=>e.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:e.jsx(d,p({},s[a]))},a))}),vp={read:le.readAction,write:le.writeAction,open_world:le.openWorldAction},jp={[Vr]:le.metadataOutputTemplate,[Kr]:le.metadataToolInvokingMessage,[qr]:le.metadataToolInvokedMessage,[$r]:le.metadataWidgetAccessible},Yr=({connector:t,link:s,conformError:a,isRefreshingActions:n,onRefreshActions:o,onToggleAction:i,isTogglingAction:r,refreshActionsError:l})=>{const c=Kt(),u=ee(),m=oe(u,"3475796410"),g=t.connector_type!=="SERVICE"||m,f=c?"text-token-text-secondary":"text-token-text-status-error";return(t.actions.length===0||!c)&&!a&&!l?null:e.jsxs("div",{className:"px-2 pt-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between pb-3 text-base font-medium",children:[e.jsx(d,p({},le.actions)),t.connector_type==="MCP"&&o&&e.jsx(W,{onClick:o,size:"small",color:"secondary",loading:n,children:e.jsx(d,p({},le.refreshActionsButton))})]}),l&&e.jsx(nc,{intent:oc.danger,fullWidth:!0,className:"mb-3 w-full text-sm font-semibold",children:e.jsx(d,{id:"DPDW8A",defaultMessage:"Refresh error: {error}",values:{error:e.jsx("span",{className:"font-normal",children:l})}})}),a&&e.jsx("div",{className:ht(f,"mb-3"),children:a}),e.jsx("ul",{className:"mb-4 flex flex-col gap-2",children:c&&t.actions.map(x=>{var C,_,v;const b=yp(x),M=(C=x.meta)!=null?C:{},y=hp(M);return e.jsxs("li",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 font-mono font-medium",children:x.name}),Cp({badgeKeys:b,labels:vp}),i&&e.jsx(Ai,{"aria-hidden":!0,checked:(_=s==null?void 0:s.actions)==null?void 0:_.includes(x.name),size:"small",onCheckedChange:j=>i==null?void 0:i(x.name,j),disabled:!!r||!g})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:x.description}),e.jsx(Mp,{entries:bp((v=x.meta)==null?void 0:v.securitySchemes),headingMessage:le.securitySchemes}),e.jsx(xp,{entries:y,headingMessage:le.metadataHeading,labels:jp})]},x.name)})})]})},Sp=jt(()=>St(()=>import("./oxo0r33hqmhdtptf.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.GithubOnboardingModal)),_p=({link:t,onDisableSync:s})=>{var $,X,q;const a=ee(),n=k(),o=yn(),i=ic(),[r,l]=h.useState(""),[c,u]=h.useState(new Map),[m]=Qm(r,500),{connectionInstanceData:g,isLoading:f,refetch:x}=as({skip:!o}),b=h.useMemo(()=>g==null?void 0:g.connection_statuses.find(G=>{var F,R;return((F=G==null?void 0:G.user_connection_details)==null?void 0:F.knowledge_connector_type)==="github"&&((R=G==null?void 0:G.user_connection_details)==null?void 0:R.backing_link_id)===t.id}),[g,t.id]),{data:M,isLoading:y,isFetchingNextPage:C,hasNextPage:_,fetchNextPage:v}=du({enabled:!!(t&&b),debouncedSearchTerm:m,linkId:t.id}),{data:j,isLoading:S,refetch:N}=uu({enabled:!!(($=b==null?void 0:b.user_connection_details)!=null&&$.connection_instance_id),connectionInstanceId:(q=(X=b==null?void 0:b.user_connection_details)==null?void 0:X.connection_instance_id)!=null?q:""});h.useEffect(()=>{var G,F,R;if((G=j==null?void 0:j.sync_enabled_objects)!=null&&G.length){const V=(F=j==null?void 0:j.sync_enabled_objects)==null?void 0:F.filter(Q=>Q.object_type==="repository");V!=null&&V.length&&u(new Map((R=V==null?void 0:V.map(Q=>{var de,Z;return[Number(Q.object_id),{id:Number(Q.object_id),repository_full_name:(de=Q.object_name)!=null?de:"",description:(Z=Q.object_description)!=null?Z:"",is_code_search_indexed:!0}]}))!=null?R:[]))}},[j]);const{mutate:w,isPending:A}=je({mutationFn:async()=>{var F;const G=(F=b==null?void 0:b.user_connection_details)==null?void 0:F.connection_instance_id;G&&await va.user_connection_update_sync_configuration(G,{type:"GithubUserApiExtension",opted_in_repository_ids:Array.from(c.keys())})},onSuccess:()=>{N(),x()}}),T=h.useCallback(()=>{var G;u(new Map(((G=j==null?void 0:j.sync_enabled_objects)!=null?G:[]).filter(F=>F.object_type==="repository").map(F=>{var R,V;return[Number(F.object_id),{id:Number(F.object_id),repository_full_name:(R=F.object_name)!=null?R:"",description:(V=F.object_description)!=null?V:"",is_code_search_indexed:!0}]})))},[j]),P=h.useMemo(()=>{var R,V;const G=(R=M==null?void 0:M.pages.flatMap(Q=>Q.repos))!=null?R:[],F=(V=j==null?void 0:j.sync_enabled_objects)==null?void 0:V.filter(Q=>Q.object_type==="repository");if(!m&&(F!=null&&F.length)){const Q=new Map(G.map(re=>[Number(re.id),re])),de=new Set(G.map(re=>Number(re.id))),Z=F.filter(re=>de.has(Number(re.object_id))).map(re=>Q.get(Number(re.object_id))),ue=F.filter(re=>!de.has(Number(re.object_id))).map(re=>{var ne;return{id:Number(re.object_id),repository_full_name:(ne=re.object_name)!=null?ne:"",description:"",is_code_search_indexed:!0}}),ye=G.filter(re=>!F.some(ne=>Number(ne.object_id)===Number(re.id)));return[...Z,...ue,...ye]}return G},[M,m,j]),E=!!b&&(P.length>5||!!m),O=h.useCallback(G=>{u(G)},[]),D=h.useMemo(()=>{if(!b)return!1;if(!(j!=null&&j.sync_enabled_objects))return c.size>0;const G=new Set(j.sync_enabled_objects.filter(F=>F.object_type==="repository").map(F=>Number(F.object_id)));if(G.size!==c.size)return!0;for(const F of c.keys())if(!G.has(F))return!0;for(const F of G)if(!c.has(F))return!0;return!1},[c,j,b]),I=f||y||S;if(!o)return null;const H=e.jsx(W,{color:"secondary",disabled:i,onClick:()=>{Ye(a,Sp,{initialState:Bt.SyncRepos,onClose:()=>{x()}})},children:e.jsx(d,{id:"Dnyhgs",defaultMessage:"Choose repositories"})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 pt-5",children:e.jsx(Me,{description:e.jsx(d,{id:"+8dStU",defaultMessage:"Syncing improves speed and quality, so select the repositories you use most. ChatGPT can still access repositories that aren’t synced."}),noBorder:!0,title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"JQCZHf",defaultMessage:"Synced repositories"}),b&&e.jsx(Xs,{connection:b,location:"user_settings"})]}),children:e.jsxs("div",{className:"mt-2 flex flex-col",children:[E&&e.jsx(ks,{ariaLabel:n.formatMessage({id:"D2Xhv1",defaultMessage:"Search repositories"}),autoComplete:"off",className:"mb-2",icon:rc,iconPosition:"left",name:"search-repos",onChange:G=>{l(G.target.value)},placeholder:n.formatMessage({id:"jYgjAb",defaultMessage:"Search repositories"})}),I||b?e.jsx(Ym,{allRepos:P,enableScroll:!1,fetchNextPage:v,hasNextPage:_,isFetchingNextPage:C,isLoading:I,searchTerm:r,onChange:O,selectedRepos:c}):e.jsxs("div",{className:"border-token-border-default flex items-center justify-between rounded-xl border-1 p-4",children:[e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(d,{id:"fwutvn",defaultMessage:"No repositories synced"})}),i?e.jsx(lc,{children:H}):H]})]})})}),D&&e.jsx("div",{className:"bg-token-bg-primary border-token-border-default sticky end-0 bottom-0 z-10 -mx-4 border-t-1 px-4 py-6",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(W,{color:"secondary",onClick:T,children:e.jsx(d,p({},ja.cancelButtonText))}),e.jsx(W,{color:"primary",loading:A,onClick:()=>{c.size===0?s():w()},children:e.jsx(d,{id:"4e7T8Q",defaultMessage:"Save"})})]})})]})},ya=st[U.GITHUB_CONNECTOR],Zr=({badge:t,connectorId:s,connectorDisabled:a=!1,link:n,icon:o,name:i,description:r,onBackClick:l,details:c=[],onConnectClick:u,onDisconnectClick:m,isConnecting:g,isDisconnecting:f=!1,isDeleting:x=!1,conformError:b,onBlockItems:M,onDelete:y,onDeleteSyncClick:C,onEnableSyncClick:_,reportEntity:v,onEditDescription:j})=>{const S=k(),N=ce(),w=ee(),[A,T]=h.useState(!1),P=oe(w,"4202324921"),E=!!b,O=!!(n!=null?n:m),D=!!(u&&!O&&!E),I=!!(m&&O&&!E),H=!!m&&!I||!!y||!!M||!!C||!!_||!!u&&!D||!!v&&P||!!j||s===ya,$=oe(w,"2571214709"),{isLoading:X,data:q}=Di(!0),ne=q!=null?q:{},{disabledTools:G=[]}=ne,F=Fs(ne,["disabledTools"]),R=Ne(),{isPending:V,mutate:Q}=je({mutationFn:async({data:B})=>await Li(B),onMutate:async({data:B})=>{await R.cancelQueries({queryKey:["userContext"]});const Y=R.getQueryData(["userContext"]);return R.setQueryData(["userContext"],te=>p(p({},te!=null?te:{}),B)),{prevData:Y}},onError:(B,Y,te)=>{te!=null&&te.prevData&&R.setQueryData(["userContext"],te.prevData),N.danger(S.formatMessage(le.settingError),{toastId:"connector_details_listing_setting_error"})},onSettled:()=>{R.invalidateQueries({queryKey:["userContext"]})}}),de=Np(s),Z=Oi("installations/select_target"),ue=()=>{if(!de)return;const B=G.includes(de)?G.filter(Y=>Y!==de):Array.from(new Set([...G,de]));Q({data:p({disabledTools:B},F)})},ye=!!($&&de),re=zr(s);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-header-height flex flex-shrink-0 items-center",children:e.jsxs(W,{color:"ghost",size:"small",onClick:l,contentWrapperClassName:"gap-[6px]",className:"rounded-lg ps-0.5 pe-1.5",children:[e.jsx(An,{className:"icon icon-sm"}),e.jsx(d,p({},le.backButton))]})}),e.jsxs("div",{className:"flex items-center gap-3 px-2 pt-2",children:[o,e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-lg font-semibold",children:i}),t]}),e.jsx("span",{className:"text-token-text-tertiary",children:r})]}),e.jsx(tt,{label:S.formatMessage(le.connectorDisabled),disabled:!a,children:e.jsxs("div",{className:"flex items-center gap-3 px-2 pt-2",children:[D&&e.jsx("div",{children:e.jsx(W,{onClick:u,loading:g,disabled:a,children:e.jsx(d,p({},le.connectButton))})}),I&&e.jsx("div",{children:e.jsx(W,{onClick:m,loading:f,color:"danger",disabled:a||x||f,children:e.jsx(d,p({},le.disconnectButton))})}),H&&e.jsx("div",{children:e.jsxs(he.Root,{children:[e.jsx(he.BasicTrigger,{disabled:a,children:D||I?e.jsx(Da,{className:"icon"}):e.jsx(W,{color:"secondary",disabled:a,children:e.jsx(d,p({},le.manageDropdown))})}),e.jsx(he.Portal,{children:e.jsxs(he.Content,{size:"small",align:"end",children:[v&&P&&e.jsxs(he.Item,{onClick:()=>T(!0),children:[e.jsx(mu,{className:"icon"}),e.jsx(d,p({},le.reportButton))]}),s===ya&&e.jsx(ts,{href:Z,openNewTab:!0,underline:!1,children:e.jsxs(he.Item,{children:[e.jsx(As,{className:"icon"}),e.jsx(d,p({},le.settingsButton))]})}),!1,!D&&u&&e.jsxs(he.Item,{onClick:u,children:[e.jsx(Pn,{className:"icon"}),e.jsx(d,p({},le.connectButton))]}),_&&e.jsxs(he.Item,{onClick:_,children:[e.jsx(hs,{className:"icon"}),e.jsx(d,p({},le.enableSync))]}),M&&e.jsxs(he.Item,{onClick:M,children:[e.jsx(Ii,{className:"icon"}),e.jsx(d,p({},le.blockItems))]}),C&&e.jsxs(he.Item,{onClick:C,children:[e.jsx(Km,{className:"icon"}),e.jsx(d,p({},le.disableSync))]}),!I&&m&&e.jsxs(he.Item,{onClick:m,color:"danger",children:[e.jsx(pn,{className:"icon"}),e.jsx(d,p({},le.disconnectButton))]}),y&&e.jsxs(he.Item,{onClick:y,color:"danger",disabled:x,children:[e.jsx(Dn,{className:"icon"}),e.jsx(d,p({},le.deleteButton))]})]})})]})})]})})]}),s===ya&&n&&e.jsx(kp,{link:n}),c.length>0&&e.jsx("div",{className:"px-2 pt-6",children:e.jsx(Me,{title:e.jsx(d,p({},le.information)),noBorder:!0,children:e.jsx("div",{className:"border-token-border-default flex flex-col gap-2 rounded-2xl border p-3",children:c.filter(B=>B.value!=null).map(B=>e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("span",{className:"text-token-text-tertiary text-nowrap",children:B.title}),typeof B.value=="string"?e.jsx("input",{type:"text",readOnly:!0,className:"w-full border-none bg-transparent p-0 text-end text-sm",value:B.value}):e.jsx("span",{className:"truncate",children:B.value})]},B.title))})})}),(ye||re)&&e.jsx("div",{className:"px-2 pt-6",children:e.jsxs(Me,{title:e.jsx(d,p({},le.preferences)),children:[ye&&de&&e.jsx(K,{children:e.jsx(Be,{label:n!=null?S.formatMessage(le.allowUsingAutomatically):S.formatMessage(le.recommendConnection),description:n!=null?S.formatMessage(le.allowUsingAutomaticallyDescription,{connectorName:i}):S.formatMessage(le.recommendConnectionDescription,{connectorName:i}),enabled:!G.includes(de),isLoading:X||V,onChange:ue})}),re&&e.jsx(fp,{connectorId:s,connectorName:i})]})}),A&&v&&P&&e.jsx(wp,{reportEntity:v,onClose:()=>T(!1)})]})};function wp({reportEntity:t,onClose:s}){var l;const a=ee(),n=k(),{data:o}=gu(a,t.entityType),i=fu(a,n,t.id,t.entityType);if(o==null)return null;const r=(l=t.title)!=null?l:n.formatMessage(le.reportModalTitle);return e.jsx(pu,{reasons:o.reasons,submitReport:i,title:r,onClose:s,header:o.header,subHeader:o.header_explanation})}function Np(t){switch(t){case st[U.GMAIL_CONNECTOR]:return"gmail";case st[U.GCAL_CONNECTOR]:return"gcal";case st[U.GOOGLE_CONTACTS_CONNECTOR]:return"gcontacts";default:return null}}const kp=({link:t})=>{var i;const s=Oi("installations/select_target"),{data:a,isLoading:n}=pr({linkId:(i=t==null?void 0:t.id)!=null?i:""}),o=!a;return n||!o?null:e.jsx("div",{className:"px-2 pt-6",children:e.jsx("div",{className:"border-token-border-default flex flex-col gap-2 rounded-2xl border p-3",children:e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx(d,p({},le.githubInstallationAlert)),e.jsxs(W,{color:"primary",contentWrapperClassName:"gap-1.5",onClick:()=>{window.open(s,"_blank")},children:[e.jsx(d,p({},le.chooseRepos)),e.jsx(As,{className:"icon"})]})]})})})},Wa=n=>{var o=n,{connector:t,onEditDescription:s}=o,a=Fs(o,["connector","onEditDescription"]);const i=k();return e.jsx(Zr,p({connectorId:t.id,icon:e.jsx(Ot,{connector:t,size:"large",className:"border-token-border-default bg-token-bg-primary shadow-xxs max-h-fit rounded-2xl border-[.5px] bg-clip-padding p-2"}),name:fs(t.name,i),description:t.description,connectorDisabled:t.status==="DISABLED_BY_ADMIN",onEditDescription:s},a))},Xr=({connector:t,link:s,onBackClick:a,onDisconnectClick:n,onConnectClick:o,isConnecting:i,isDisconnecting:r,isDeleting:l,isRefreshingActions:c,isTogglingAction:u,conformError:m,onDelete:g,onRefreshActions:f,onToggleAction:x,refreshActionsError:b,onEditDescription:M})=>{const y=Te(),C=k(),_=yn(),v=na(t),j=Kt(),S=h.useMemo(()=>[{title:C.formatMessage(le.connectedOn),value:new Date(s.created_at).toLocaleString([],{year:"numeric",month:"short",day:"numeric"})},...ia(t,v,C,{isDeveloperMode:j,linkAuthType:s.auth_type})],[t,v,s.created_at,s.auth_type,C,j]),[N,w]=h.useState(!1),{isLoading:A,isEnabled:T}=cc(),E=!(y!=null&&y.isPersonalAccount())&&(y==null?void 0:y.planType)!==ke.SELF_SERVE_BUSINESS&&(!T||A),O=t.id===ya&&_,{connectionInstanceData:D,refetch:I}=as({skip:!O}),H=h.useMemo(()=>{var X;return!((X=D==null?void 0:D.connection_statuses)!=null&&X.length)||!(s!=null&&s.id)?null:D.connection_statuses.find(q=>(s==null?void 0:s.id)===q.user_connection_details.backing_link_id)},[D,s==null?void 0:s.id]),$=h.useCallback(async()=>{var X;(X=H==null?void 0:H.user_connection_details)!=null&&X.connection_instance_id&&(y!=null&&y.isPersonalAccount()?await va.user_delete_sync(s.id):await va.user_disconnect(H.user_connection_details.connection_instance_id),setTimeout(()=>{I()},500))},[y,H==null?void 0:H.user_connection_details.connection_instance_id,s.id,I]);return e.jsxs(e.Fragment,{children:[e.jsx(Wa,{connector:t,badge:e.jsx(Ua,{connector:t}),link:s,onBackClick:a,details:S,onEditDescription:M,reportEntity:{id:t.id,entityType:Cn.Connector},onDeleteSyncClick:H?()=>w(!0):void 0,onDisconnectClick:n,onConnectClick:o,isConnecting:i,isDisconnecting:r,isDeleting:l,conformError:m,onDelete:g}),O&&!E&&e.jsx(_p,{link:s,onDisableSync:()=>w(!0)}),e.jsx(Yr,{connector:t,link:s,conformError:m,isRefreshingActions:c,onRefreshActions:f,onToggleAction:x,isTogglingAction:u,refreshActionsError:b}),e.jsx(Jr,{connector:t,onDisableSync:$,isOpen:N,onClose:()=>w(!1)})]})},Jr=({connector:t,onDisableSync:s,isOpen:a,onClose:n})=>{const o=k(),i=ce(),[r,l]=h.useState(!1),[c,u]=h.useState(!1),m=h.useCallback(async()=>{try{l(!0),await s(),n(),l(!1),i.success(o.formatMessage({id:"OgQmj5",defaultMessage:"Sync disabled"}))}catch(g){i.danger(o.formatMessage({id:"pg29j7",defaultMessage:"Failed to disable sync"}))}finally{l(!1)}},[s,n,o,i]);return e.jsxs(xe,{className:"w-[400px] p-2",isOpen:a,onClose:n,testId:"modal-disable-sync",children:[e.jsx("div",{className:"flex justify-end pb-6",children:e.jsx(Ea,{onClick:n})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"})}),e.jsx("div",{className:"pt-4 text-center text-2xl font-semibold",children:e.jsx(d,J(p({},le.disableSyncModalTitle),{values:{connector:t.name}}))}),e.jsx("div",{className:"text-token-text-secondary text-md pt-2 text-center text-sm",children:e.jsx(d,p({},le.disableSyncModalDescription))}),e.jsx(fr,{id:"disable-segment-replacement",className:"rounded-xl",label:o.formatMessage(le.disableSyncModalCheckboxLabel),labelClassName:"font-medium",checked:c,onChange:()=>u(!c),containerClassName:"col-span-3 w-full p-4 border border-gray-300 rounded-xl mt-5 gap-4 text-sm"}),e.jsxs("div",{className:"flex w-full flex-row justify-evenly gap-2 pt-6",children:[e.jsx(W,{onClick:n,color:"secondary",size:"large",className:"flex-1",children:e.jsx(d,p({},ja.cancelButtonText))}),e.jsx(W,{disabled:!c||r,loading:r,onClick:m,color:"danger",size:"large",className:"flex-1",children:e.jsx(d,p({},le.disableSync))})]})]})]})},Tp=({connector:t,onBackClick:s,onDisconnectClick:a,internalKnowledgeConfig:n,onConnectClick:o})=>{const i=k(),r=Kt(),l=h.useMemo(()=>ia(t,["chat"],i,{isDeveloperMode:r}),[t,i,r]),c=n.user_connection_details.knowledge_connector_type!=="google_drive_dwd";return e.jsx(Wa,{connector:t,badge:e.jsx(Ua,{connector:t}),onBackClick:s,details:l,onDisconnectClick:c?a:void 0,onConnectClick:o})},el=({connector:t,onBackClick:s,onConnectClick:a,isConnecting:n,isDisconnecting:o,isDeleting:i,conformError:r,onDelete:l,onEditDescription:c})=>{const u=k(),m=na(t),g=Kt(),f=h.useMemo(()=>[...t.created_at?[{title:u.formatMessage(le.createdAt),value:new Date(t.created_at).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}]:[],...ia(t,m,u,{isDeveloperMode:g})],[t,m,u,g]);return e.jsxs(e.Fragment,{children:[e.jsx(Wa,{connector:t,badge:e.jsx(Ua,{connector:t}),onBackClick:s,details:f,onConnectClick:a,isConnecting:n,isDisconnecting:o,isDeleting:i,conformError:r,onDelete:l,reportEntity:{id:t.id,entityType:Cn.Connector},onEditDescription:c}),e.jsx(Yr,{connector:t})]})},tl=({onBackClick:t,onDisconnectClick:s,fileUploadConfig:a,onConnectClick:n,connector:o})=>{const i=k(),r=hn(a.type,i),{description:l,Icon:c}=Ep[a.type],u=Kt(),m=o?ia(o,["fileUploads"],i,{isDeveloperMode:u}):[{title:i.formatMessage(Ca.worksWith),value:aa("fileUploads",i)}];return e.jsx(Zr,{icon:e.jsx("span",{className:"border-token-border-default bg-token-bg-primary shadow-xxs max-h-fit rounded-2xl border-[0.5px] bg-clip-padding p-2",children:e.jsx(c,{className:"h-10 w-10"})}),name:r,description:i.formatMessage(l),onBackClick:t,details:m,onDisconnectClick:s,onConnectClick:n})},Ca=ae({worksWith:{id:"g1eGWJ",defaultMessage:"Works with"},o365Desc:{id:"connectorSettings.o365Desc.1",defaultMessage:"Upload Microsoft Word, Excel, PowerPoint and other files."},o365BusinessDesc:{id:"connectorSettings.o365BusinessDesc.1",defaultMessage:"Upload Microsoft Word, Excel, PowerPoint, and other files, including those from SharePoint sites."},gdriveDesc:{id:"HIdrop",defaultMessage:"Search and reference files from your Drive."}}),Ep={[Ee.O365_PERSONAL]:{description:Ca.o365Desc,Icon:Ks},[Ee.O365_BUSINESS]:{description:Ca.o365BusinessDesc,Icon:Ks},[Ee.GDRIVE]:{description:Ca.gdriveDesc,Icon:Pa}},Wn=({children:t})=>e.jsx("span",{className:"bg-token-bg-tertiary text-token-text-secondary my-0.5 inline-block rounded-md px-1.5 py-0.5 text-xs",children:t}),Pp=({internalKnowledgeConfig:t})=>{const s=k();return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Wn,{children:s.formatMessage(Ie.sync)}),e.jsx(Xs,{connection:t,location:"user_settings"})]})},sl=(t,s)=>{const a=k(),n=ce(),{refetch:o}=Mn();return async()=>{try{await ie.safeDelete("/connectors/user_setting/{connector_name}",{parameters:{path:{connector_name:t}}}),s==null||s()}catch(i){n.danger(a.formatMessage(Ie.disconnectError))}finally{o()}}},Ap=()=>{const t=k(),s=ce(),{refetch:a}=Oa();return async n=>{try{await va.user_disconnect(n)}catch(o){s.danger(t.formatMessage(Ie.disconnectError))}finally{a()}}},Dp=({connector:t,links:s,removeConnectorId:a,onLinkClick:n,onAddClick:o,additionalLinks:i})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-header-height flex items-center justify-between",children:[e.jsx(W,{color:"ghost",onClick:a,icon:An,children:e.jsx(d,p({},Ie.backButton))}),o&&e.jsx(W,{color:"secondary",onClick:o,children:e.jsx(d,p({},Ie.addButton))})]}),e.jsxs("div",{className:"pt-2",children:[s.map(r=>e.jsx(Lp,{link:r,onLinkClick:n,connector:t},r.id)),i]})]}),Lp=({link:t,onLinkClick:s,connector:a})=>{var u,m,g,f;const n=k(),o=Te(),i=o==null?void 0:o.isPersonalAccount(),l=!!(mt()&&i),c=h.useMemo(()=>{if(a.id!==nt)return;const x=[];return l&&x.push("chat"),x.push("deepResearch"),e.jsx(Wn,{children:aa(x,n)})},[a.id,n,l]);return e.jsx(K,{children:e.jsx("button",{className:"w-full",onClick:()=>s(t.id),children:e.jsx("div",{className:"px-3 pt-3 pb-1",children:e.jsx(zt,{icon:e.jsx(_a,{connector:a}),title:(f=(g=(u=t.owner_profile)==null?void 0:u.email)!=null?g:(m=t.owner_profile)==null?void 0:m.name)!=null?f:t.name,description:c,statusIndicator:e.jsx($s,{className:"icon"})})})})},t.id)},Op=({connector:t,platformLink:s})=>{var w,A,T;const a=k(),n=Te(),o=mt(),i=ns(),r=Ri(),l=na(t),c=Kt(),u=pc(),{refetch:m}=as({skip:!0}),{mutateAsync:g}=ps(),f=ce(),[x,b]=h.useState(!1),[M,y]=h.useState(!1),{internalKnowledgeConfigs:C}=Js(),_=()=>{r(s.id,()=>{f.success(a.formatMessage(Ie.disconnectSuccess,{connector:fs(t.name,a)})),i(),m()},ve.CONNECTOR_SETTING)},v=h.useMemo(()=>!(C!=null&&C.length)||!(s!=null&&s.id)?null:C.find(P=>(s==null?void 0:s.id)===P.user_connection_details.backing_link_id),[C,s==null?void 0:s.id]),j=async()=>{await u(s.id)},S=h.useMemo(()=>s?[{title:a.formatMessage(Ie.connectedOn),value:new Date(s.created_at).toLocaleString([],{year:"numeric",month:"short",day:"numeric"})},...ia(t,l,a,{isDeveloperMode:c,linkAuthType:s.auth_type})]:[],[s,a,t,l,c]),N=h.useMemo(()=>{if(!v)return;const P=v.user_connection_details.knowledge_connector_type;if(P)return P==="slack"?"synced_channel":"synced_object"},[v]);return e.jsxs(e.Fragment,{children:[e.jsx(Wa,{badge:v?e.jsx(Xs,{connection:v,location:"user_settings"}):void 0,connector:t,onBackClick:()=>i(),details:S,reportEntity:{id:t.id,entityType:Cn.Connector},onBlockItems:v&&o?()=>b(!0):void 0,onDisconnectClick:_,onDeleteSyncClick:v?()=>y(!0):void 0,onEnableSyncClick:v||!o?void 0:()=>{se.logEventWithStatsig("Connectors - Upgrade Personal Google Drive","chatgpt_connectors_upgrade_personal_google_drive_clicked"),g({link:s})}}),e.jsx(Jr,{connector:t,onDisableSync:j,isOpen:M,onClose:()=>y(!1)}),N&&e.jsx(Zm,{accountId:(w=n==null?void 0:n.id)!=null?w:"",connectionId:(T=(A=v==null?void 0:v.user_connection_details)==null?void 0:A.connection_instance_id)!=null?T:"",isOpen:x,objectType:N,onClose:()=>b(!1)})]})},Ip=({onAddClick:t})=>{const s=k(),a=Te(),n=mt(),o=!!(a!=null&&a.isPersonalAccount()&&n),i=ce(),r=La(!0,ve.CONNECTOR_SETTING),l=xt({fetchValidLinksOnly:!0,productSku:ve.CONNECTOR_SETTING}),c=r.platformConnectors.get(nt),u=h.useMemo(()=>{var T;return(T=l.connectorLinks.get(nt))!=null?T:[]},[l.connectorLinks]),m=ns(),g=Ri(),f=Ap(),x=sl(Ee.GDRIVE),{internalKnowledgeConfigs:b,fileUploadConfig:M,isLoading:y}=Js(),C=h.useMemo(()=>{var T;return(T=b==null?void 0:b.filter(P=>P.user_connection_details.auth_status!=="not_connected"))!=null?T:[]},[b]),[_,v]=h.useState(null),j=(M!=null&&M.access_token?1:0)+(a!=null&&a.isPersonalAccount()?0:C.length)+u.length,[S]=h.useState(j),N=h.useMemo(()=>!!b&&!o&&b.length-C.length>0||u.length===0,[b,o,C.length,u.length]),w=h.useMemo(()=>S>1?_:M!=null&&M.access_token?{type:"file_uploads"}:a!=null&&a.isPersonalAccount()&&u.length>0?{type:"upgradable_platform_connector",link:u[0]}:C.length>0?{type:"internal_knowledge",config:C[0]}:u.length>0?{type:"platform_connector",link:u[0]}:null,[S,M==null?void 0:M.access_token,a,u,C,_]);if(r.isFetching||l.isLoading||y)return e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})});if(r.error||l.error||!c)return m(),null;if(j===0)return e.jsx(el,{connector:c,onBackClick:()=>m(),onConnectClick:t});if(!w){const T=P=>{const E=u.find(O=>O.id===P);E&&(a!=null&&a.isPersonalAccount()?v({type:"upgradable_platform_connector",link:E}):v({type:"platform_connector",link:E}))};return e.jsx(Dp,{connector:c,links:u,removeConnectorId:()=>m(),onLinkClick:T,onAddClick:N?t:void 0,additionalLinks:e.jsxs(e.Fragment,{children:[!(a!=null&&a.isPersonalAccount())&&C.map(P=>e.jsx(K,{children:e.jsx("button",{className:"w-full",onClick:()=>v({type:"internal_knowledge",config:P}),children:e.jsx("div",{className:"px-3 pt-3 pb-1",children:e.jsx(zt,{icon:e.jsx(_a,{connector:c}),title:P.connection_display_info.display_name,description:e.jsx(Pp,{internalKnowledgeConfig:P}),statusIndicator:e.jsx($s,{className:"icon"})})})})},P.user_connection_details.connection_instance_id)),!!(M!=null&&M.access_token)&&e.jsx(K,{children:e.jsx("button",{className:"w-full",onClick:()=>v({type:"file_uploads"}),children:e.jsx("div",{className:"px-3 pt-3 pb-1",children:e.jsx(zt,{icon:e.jsx(_a,{connector:c}),title:M.name,description:e.jsx(Wn,{children:s.formatMessage(Ie.fileUploads)}),statusIndicator:e.jsx($s,{className:"icon"})})})})})]})})}const A=()=>{_?v(null):m()};switch(w.type){case"platform_connector":{const T=()=>{g(w.link.id,()=>{i.success(s.formatMessage(Ie.disconnectSuccess,{connector:fs(c.name,s)})),v(null)},ve.CONNECTOR_SETTING)};return e.jsx(Xr,{connector:c,onBackClick:A,link:w.link,onDisconnectClick:T,onConnectClick:N?t:void 0})}case"upgradable_platform_connector":return e.jsx(Op,{connector:c,platformLink:w.link});case"internal_knowledge":{const T=async()=>{await f(w.config.user_connection_details.connection_instance_id),v(null)};return e.jsx(Tp,{connector:c,onBackClick:A,onDisconnectClick:T,internalKnowledgeConfig:w.config,onConnectClick:N?t:void 0})}case"file_uploads":{if(!M)return null;const T=async()=>{await x(),v(null)};return e.jsx(tl,{onBackClick:A,onDisconnectClick:T,fileUploadConfig:M,connector:c,onConnectClick:N?t:void 0})}}},Do=({type:t})=>{const{personalConfig:s,businessConfig:a,isLoading:n}=Bi(),o=t===Ee.O365_PERSONAL?s:a,i=ns(),r=sl(t,()=>{i()});return n?e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})}):o?e.jsx(tl,{onBackClick:()=>i(),onDisconnectClick:r,fileUploadConfig:o}):(i(),null)},Rp=({connectorId:t,onAddLinkClick:s})=>{var G,F;const a=k(),n=ce(),o=La(!0,ve.CONNECTOR_SETTING),i=xt({fetchValidLinksOnly:!0,productSku:ve.CONNECTOR_SETTING}),r=o.platformConnectors.get(t),l=i.connectorLinks.get(t),c=l&&l.length>0,u=!!r&&r.connector_type==="MCP",m=ns(),g=ji(),f=Te(),x=Fi(),b=h.useMemo(()=>!!(r!=null&&r.owners.some(R=>R.type==="USER"&&R.id===(f==null?void 0:f.normalizedAccountUserId))||(f!=null&&f.isAdminOfAccount()||f!=null&&f.isOwnerOfAccount())&&(r!=null&&r.owners.some(R=>R.type==="WORKSPACE"&&R.id===f.getWorkspaceId()))),[r,f]),M=u&&b,[y,C]=h.useState(!1),[_,v]=h.useState(""),[j,S]=h.useState("");h.useEffect(()=>{var R,V;if(!r){v(""),S("");return}if(!y){const Q=r;v((R=r.description)!=null?R:""),S((V=Q.model_description)!=null?V:"")}},[r,y]);const N=o.isLoading||i.isLoading,[w,A]=h.useState(null),T=je({mutationFn:async()=>{if(!r)throw new Error("Connector not found");s()},onError:()=>{n.danger(a.formatMessage(Ie.connectError))}}),P=je({mutationFn:async()=>{await g(t,()=>{n.success(r?a.formatMessage(Ie.disconnectSuccess,{connector:fs(r.name,a)}):a.formatMessage(Ie.disconnectGenericSuccess))},ve.CONNECTOR_SETTING)}}),E=je({mutationFn:async R=>{await dc(R),await i.refetch(),await o.refetch()},onMutate:()=>{A(null)},onError:R=>{n.danger(a.formatMessage(Ie.refreshActionsError));const V=R instanceof Error&&R.message?R.message:a.formatMessage(Ie.refreshActionsError);A(V)},onSuccess:()=>{A(null)}}),O=je({mutationFn:async()=>{await uc(t),await Promise.all([o.refetch(),i.refetch()])},onError:()=>{n.danger(a.formatMessage(Ie.deleteError))},onSuccess:()=>{m()}}),D=Ne(),I=je({mutationFn:async({connectorId:R,description:V,modelDescription:Q,updateDescription:de,updateModelDescription:Z})=>{const ue=[];de&&ue.push(mc(R,V)),Z&&ue.push(gc(R,Q)),ue.length!==0&&await Promise.all(ue)},onSuccess:async()=>{await o.refetch(),n.success(a.formatMessage(Ie.updateDescriptionSuccess)),C(!1)},onError:()=>{n.danger(a.formatMessage(Ie.updateDescriptionError))}}),H=je({mutationFn:async({linkId:R,action:V,enabled:Q})=>{D.setQueryData(no(f==null?void 0:f.normalizedAccountUserId,!0),ye=>oo(ye,re=>{var B;const ne=(B=re[t])==null?void 0:B.find(Y=>Y.id===R);if(Q)ne!=null&&ne.actions.includes(V)||ne==null||ne.actions.push(V);else{const Y=ne==null?void 0:ne.actions.indexOf(V);Y!==void 0&&Y!==-1&&(ne==null||ne.actions.splice(Y,1))}}));const de=l==null?void 0:l.find(ye=>ye.id===R);if(!de)return;const Z=Q?[...de.actions,V]:de.actions.filter(ye=>ye!==V),ue=await fc(R,Z);D.setQueryData(no(f==null?void 0:f.normalizedAccountUserId,!0),ye=>oo(ye,re=>{const ne=re[t],B=ne==null?void 0:ne.findIndex(Y=>Y.id===R);B!==void 0&&B!==-1&&(ne[B]=ue.link)}))},onError:()=>{n.danger(a.formatMessage(Ie.toggleActionError))}});_.trim(),j.trim(),((G=r==null?void 0:r.description)!=null?G:"").trim(),((F=r==null?void 0:r.model_description)!=null?F:"").trim(),I.isPending;const $=()=>{var R,V;if(r){const Q=r;v((R=r.description)!=null?R:""),S((V=Q.model_description)!=null?V:"")}C(!0)};if(N)return e.jsx("div",{className:"flex justify-center p-10",children:e.jsx(Oe,{})});if(o.error||i.error||!r)return m(),null;const X=["MCP","OPEN_API"].includes(r.connector_type)&&r.conformance.implements_retrievable===!1&&!x?r.conformance.reason_if_not_retrievable?e.jsx(d,J(p({},Ie.mcpServerConformErrorWithReason),{values:{reason:r.conformance.reason_if_not_retrievable,link:R=>e.jsx(ts,{href:"https://platform.openai.com/docs/mcp#create-an-mcp-server",openNewTab:!0,children:R})}})):e.jsx(d,J(p({},Ie.mcpServerConformError),{values:{link:R=>e.jsx(ts,{href:"https://platform.openai.com/docs/mcp#create-an-mcp-server",openNewTab:!0,children:R})}})):void 0,q=e.jsx(e.Fragment,{});return c?e.jsxs(e.Fragment,{children:[e.jsx(Xr,{connector:r,onBackClick:()=>m(),link:l[0],onDisconnectClick:()=>P.mutate(),isDisconnecting:P.isPending,isDeleting:O.isPending,conformError:X,onDelete:M?()=>O.mutate():void 0,onRefreshActions:b&&l.length>0?()=>E.mutate(l[0].id):void 0,isRefreshingActions:E.isPending,onToggleAction:(R,V)=>H.mutate({linkId:l[0].id,action:R,enabled:V}),isTogglingAction:H.isPending,refreshActionsError:w,onEditDescription:b?$:void 0}),q]}):e.jsxs(e.Fragment,{children:[e.jsx(el,{connector:r,onBackClick:()=>m(),onConnectClick:()=>T.mutate(),isConnecting:T.isPending,isDisconnecting:P.isPending,isDeleting:O.isPending,conformError:X,onDelete:M?()=>O.mutate():void 0,onEditDescription:b?$:void 0}),q]})},Bp=({connectorId:t,onAddClick:s})=>t===nt?e.jsx(Ip,{onAddClick:s}):t==="onedrive-personal"?e.jsx(Do,{type:Ee.O365_PERSONAL}):t==="onedrive-business"?e.jsx(Do,{type:Ee.O365_BUSINESS}):e.jsx(Rp,{connectorId:t,onAddLinkClick:s}),Ie=ae({backButton:{id:"2XH9oW",defaultMessage:"Back"},addButton:{id:"lkrz+6",defaultMessage:"Add"},connectedOn:{id:"b1ykGv",defaultMessage:"Connected on"},sync:{id:"W4yI4C",defaultMessage:"Chat"},disableSync:{id:"LM6oW1",defaultMessage:"Disable sync"},fileUploads:{id:"gFheug",defaultMessage:"File uploads"},deepResearch:{id:"EnDZig",defaultMessage:"Deep Research"},connectError:{id:"9/ATb1",defaultMessage:"Error connecting your account."},refreshActionsError:{id:"j+WGY0",defaultMessage:"Error refreshing actions."},disconnectError:{id:"DqZbNO",defaultMessage:"Error disconnecting your account."},disconnectSuccess:{id:"CoyFU4",defaultMessage:"{connector} disconnected"},disconnectGenericSuccess:{id:"Yh+piF",defaultMessage:"Connector disconnected"},deleteError:{id:"ZeAn4n",defaultMessage:"Error deleting your connector."},toggleActionError:{id:"DofG17",defaultMessage:"Error toggling action."},mcpServerConformError:{id:"igeVCu",defaultMessage:"This MCP server can't be used by ChatGPT to search information because it doesn't implement <link>our specification</link>."},mcpServerConformErrorWithReason:{id:"g1U6+s",defaultMessage:"This MCP server can't be used by ChatGPT to search information because it doesn't implement <link>our specification</link>: {reason}"},editDescription:{id:"8KkNYS",defaultMessage:"Edit connector descriptions"},saveDescription:{id:"b728ms",defaultMessage:"Save"},descriptionFieldLabel:{id:"G4TQb4",defaultMessage:"Connector description"},descriptionPlaceholder:{id:"UDk3bR",defaultMessage:"Describe what this connector does for your team"},modelDescriptionFieldLabel:{id:"5YP4M7",defaultMessage:"Model description"},updateDescriptionSuccess:{id:"s/uJtK",defaultMessage:"Connector details updated"},updateDescriptionError:{id:"/zjnPq",defaultMessage:"Couldn't update connector details"}}),Fp=({connector:t})=>{const s=k(),a=ns(),n=t.status==="DISABLED_BY_ADMIN";return e.jsx(tt,{label:n?s.formatMessage(hc.disabledByAdmin):void 0,triggerAs:"div",children:e.jsxs(W,{color:"secondary",className:"disabled:hover:bg-token-bg-primary border-token-border-default hover:bg-token-interactive-bg-secondary-hover w-full rounded-[10px] border p-3 pb-[10px] disabled:opacity-25",contentWrapperClassName:"flex-col gap-2 truncate items-start flex-1",onClick:()=>a(t.id),disabled:n,children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(_a,{connector:t}),e.jsx(Ua,{connector:t})]}),e.jsx("span",{className:"max-w-full truncate text-sm font-normal",children:fs(t.name,s)})]})})},Gp=({connectors:t})=>{const s=h.useMemo(()=>[...t].sort((a,n)=>{const o=(n.status!=="DISABLED_BY_ADMIN"?1:0)-(a.status!=="DISABLED_BY_ADMIN"?1:0),i=n.owners.length-a.owners.length,r=a.name.localeCompare(n.name);return 100*o+10*i+r}),[t]);return e.jsx("div",{className:"my-2 grid grid-cols-2 gap-2 sm:grid-cols-3",children:s.map(a=>e.jsx(Fp,{connector:a},a.id))})},al=({onClick:t,children:s,disabled:a})=>e.jsx("button",{className:"border-token-border-light items-center border-b px-0.5 py-3 last-of-type:border-none",onClick:t,disabled:a,children:s}),Ha=({connector:t,trailingButton:s,description:a,disabled:n})=>{const o=k(),i=na(t),r=ns(),l=Mc(),c=Fi(),u=["MCP","OPEN_API"].includes(t.connector_type)&&t.conformance.implements_retrievable===!1&&!l&&!c?e.jsx(d,p({},Wp.mcpServerConformError)):a!=null?a:aa(i,o);return e.jsx(al,{onClick:()=>r(t.id),disabled:n,children:e.jsx(zt,{icon:e.jsx(Ot,{connector:t,size:"small",className:"border-token-border-default bg-token-bg-primary shadow-xxs h-fit rounded-[10px] border-[0.5px] p-2"}),title:fs(t.name,o),description:u,statusIndicator:e.jsxs("div",{className:"flex flex-shrink-0 items-center gap-4",children:[s,e.jsx($s,{className:"icon"})]})})})},Up=({connectorLinks:t,platformConnectors:s,gdriveRow:a,onedrivePersonalRow:n,onedriveBusinessRow:o,githubRow:i,genericSyncableRows:r})=>{const l=k(),c=h.useMemo(()=>[...Array.from(t.keys()).map(g=>s.find(f=>f.id===g)).filter(g=>!!g).map(g=>({type:"platform_connector",name:g.name,connector:g})),...n?[{type:"onedrive_personal",name:l.formatMessage(xc)}]:[],...o?[{type:"onedrive_business",name:l.formatMessage(bc)}]:[],...a?[{type:"gdrive",name:"Google Drive"}]:[],...i?[{type:"github",name:"GitHub"}]:[],...(r!=null?r:[]).map(g=>p({type:"syncable_platform_connector",name:g.connector.name},g))].sort((g,f)=>g.name.localeCompare(f.name)),[t,n,l,o,a,i,r,s]);return e.jsx("div",{className:"flex flex-col",children:c.map(u=>u.type==="platform_connector"?e.jsx(Ha,{connector:u.connector},u.connector.id):u.type==="onedrive_personal"?e.jsx(Dt.Fragment,{children:n},u.type):u.type==="onedrive_business"?e.jsx(Dt.Fragment,{children:o},u.type):u.type==="gdrive"?e.jsx(Dt.Fragment,{children:a},u.type):u.type==="github"?e.jsx(Dt.Fragment,{children:i},u.type):u.type==="syncable_platform_connector"?e.jsx(Dt.Fragment,{children:u.row},u.connector.id):void 0)})},Wp=ae({mcpServerConformError:{id:"4ifdVv",defaultMessage:"Can't be used for search"}}),Hp=()=>{const t=vc(),{hasWorkspacePermission:s,isLoading:a}=jc(_c.CreateMcpConnector,Sc());return t?{canCreate:s,isLoading:a}:{canCreate:!0,isLoading:!1}},Lo="https://help.openai.com/en/collections/12923329-connected-apps",dn=({disabled:t,message:s,onAddClick:a,tooltip:n,side:o="right"})=>{const i=e.jsx(W,{color:"secondary",disabled:t,onClick:r=>{r.preventDefault(),a()},size:"small",children:e.jsx(d,p({},s))});return n?e.jsx(tt,{label:e.jsx("div",{className:"max-w-50",children:n}),side:o,children:i}):i},vs=({disabled:t,loading:s,onClick:a,tooltip:n})=>{if(s)return e.jsx(wc,{sizeOverride:18,percentage:0});const o=e.jsx(W,{color:"secondary",disabled:t,onClick:i=>{i.preventDefault(),i.stopPropagation(),a==null||a(i)},size:"small",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx(bs,{className:"icon-xs text-[#007AFF]"}),e.jsx(d,p({},we.syncForBetterAnswers))]})});return n?e.jsx(tt,{label:e.jsx("div",{className:"max-w-50",children:n}),side:"right",children:o}):o},zp=({gdrivePlatformConnector:t,isFileUploadsEnabled:s,numPlatformLinks:a,platformLinks:n,numInternalKnowledgeLinks:o,numInternalKnowledgeConfigs:i,onAddClick:r})=>{const l=k(),c=Te(),u=c==null?void 0:c.isPersonalAccount(),m=c==null?void 0:c.isWorkspaceAccount(),g=mt(),f=!!m||g&&!!u,x=tr({filters:{mutationKey:["upgradeConnectorToSync"]},select:E=>E.state}),{mutateAsync:b}=ps(),{internalKnowledgeEnabled:M,internalKnowledgeConfigs:y,isLoading:C}=Js(),{refetch:_}=as({skip:!0}),v=i-o,j=h.useMemo(()=>{var E;return f?(E=n.get(nt))==null?void 0:E.find(O=>O.connector_id===t.id):null},[n,t.id,f]),S=h.useMemo(()=>!(y!=null&&y.length)||!(j!=null&&j.id)||!f?null:y.find(E=>(j==null?void 0:j.id)===E.user_connection_details.backing_link_id),[y,j==null?void 0:j.id,f]),N=x.some(E=>{var O,D;return E.status==="success"&&((D=(O=E.variables)==null?void 0:O.link)==null?void 0:D.id)===(j==null?void 0:j.id)&&!S}),w=x.some(E=>{var O,D;return E.status==="pending"&&((D=(O=E.variables)==null?void 0:O.link)==null?void 0:D.id)===(j==null?void 0:j.id)});h.useEffect(()=>{N&&setTimeout(()=>{_()},1e3)},[N,_]);const A=h.useMemo(()=>{const E=t.status!=="DISABLED_BY_ADMIN",O=a>0;if(c!=null&&c.isPersonalAccount()){if(j&&!S&&f){const D=()=>{se.logEventWithStatsig("Connectors - Upgrade Personal Google Drive","chatgpt_connectors_upgrade_personal_google_drive_clicked"),b({link:j})};return e.jsx(vs,{onClick:D,loading:w||C||N,tooltip:l.formatMessage(we.syncForBetterAnswersTooltip)})}return j&&S?e.jsx(Xs,{connection:S,location:"user_settings"}):s&&!j?e.jsx(W,{size:"small",color:"secondary",onClick:r,children:e.jsx(d,p({},we.addChatAndOrDeepResearch))}):null}if(O){if(v>0&&o===0){if(j&&f){const D=()=>{se.logEventWithStatsig("Connectors - Upgrade Workspace Google Drive","chatgpt_contextual_answers_user_upgrade_to_sync_initiated"),b({link:j})};return e.jsx(vs,{onClick:D,loading:w||C||N,tooltip:l.formatMessage(we.syncForBetterAnswersTooltip)})}return e.jsx(vs,{onClick:r,tooltip:l.formatMessage(we.syncForBetterAnswersTooltip)})}if(M&&i===0)return e.jsx(vs,{disabled:!0,onClick:r,tooltip:l.formatMessage(we.contactAdminTooltip)})}else{if(s&&(o>0||v===0))return e.jsx(dn,{disabled:!E,message:we.addDeepResearch,onAddClick:r,tooltip:E?void 0:l.formatMessage(we.deepResearchDisabledByAdmin)});if(E&&s&&o===0)return e.jsx(dn,{message:we.addChatAndOrDeepResearch,onAddClick:r});if(s&&!E&&o===0&&v>0)return e.jsx(vs,{onClick:r,tooltip:l.formatMessage(we.syncForBetterAnswersTooltip)})}return null},[t.status,a,f,j,S,r,w,C,N,l,b,v,o,M,i,c,s]),T=na(t),P=h.useMemo(()=>{const E=[...T];return s&&E.push("fileUploads"),aa(E,l)},[T,s,l]);return e.jsx(Ha,{connector:t,description:P,trailingButton:A})},Oo=({config:t,onClick:s})=>{const a=k();return e.jsx(al,{onClick:s,children:e.jsx(zt,{icon:e.jsx("span",{className:"border-token-border-default bg-token-bg-primary shadow-xxs h-fit rounded-[10px] border-[0.5px] p-2",children:e.jsx(Ks,{className:"icon-lg"})}),title:hn(t.type,a),statusIndicator:e.jsx($s,{className:"icon"})})})},Vp=({githubLink:t,githubPlatformConnector:s})=>{var r;const a=k(),{data:n,isLoading:o}=pr({linkId:(r=t==null?void 0:t.id)!=null?r:""}),i=!n;return e.jsx(Ha,{connector:s,disabled:o,description:i?a.formatMessage(we.setupIncompleteGithub):void 0})},Kp=({link:t,connector:s,syncConnectorId:a,refetchLinks:n})=>{var j,S;const o=k(),i=ce(),r=bn(),l=Ls(),{data:c,refetch:u}=Oa(),{refetch:m}=as({skip:!0}),g=l?c==null?void 0:c.connection_statuses.find(N=>N.user_connection_details.backing_link_id===t.id):void 0,f=tr({filters:{mutationKey:["upgradeConnectorToSync"]},select:N=>N.state});let x="no-sync";if(g)x="upgraded-to-sync";else for(const N of f)if(((S=(j=N.variables)==null?void 0:j.link)==null?void 0:S.id)===(t==null?void 0:t.id))if(N.status==="success"&&!g){x="upgrade-succeeded-updating-status";break}else N.status==="pending"&&(x="upgrade-pending");h.useEffect(()=>{x==="upgrade-succeeded-updating-status"&&setTimeout(()=>{u()},1e3)},[x,u]);const{mutateAsync:b}=ps(),[M,y]=h.useState(!1),C=!!a,_=async()=>{var N,w;if(a)try{y(!0),oa("popup");const A=await Is({connector:s,redirectAfter:xn,openPopup:r,intl:o,toaster:i,productSku:ve.CONNECTOR_SETTING,connectorIdOverride:a}),T=a!=null?a:s.id,P=await n(),E=new Map(Object.entries((N=P.data)!=null?N:{})),O=A&&typeof A=="object"?A.linkId:void 0,D=(w=E.get(T))==null?void 0:w[0];let I=null;typeof O=="string"?I={id:O,name:s.name,connector_id:T}:D&&typeof D.id=="string"&&(I={id:D.id,name:s.name,connector_id:T}),I&&(await b({link:I,isConnectingAndUpgrading:!0}),await m()),i.success(o.formatMessage(we.syncConnectorSuccess,{connector:s.name}))}catch(A){const T=A instanceof Error?A.message:void 0;i.danger(T!=null?T:o.formatMessage(we.syncConnectorError,{connector:s.name}),{toastId:"connector_oauth_connect"})}finally{y(!1)}},v=g?e.jsx(Xs,{connection:g,location:"user_settings"}):e.jsx(vs,{onClick:()=>{if(C){_();return}b({link:t})},loading:M||x==="upgrade-succeeded-updating-status"||x==="upgrade-pending",tooltip:o.formatMessage(we.syncFilesForBetterAnswersTooltip,{connector:s.name})});return e.jsx(Ha,{connector:s,trailingButton:v})},qp=({onCreateCustomConnectorClick:t,onAddClick:s})=>{"use forget";var ue,ye,re,ne,B,Y;const a=k(),n=Ls(),o=yc(),i=La(!0,ve.CONNECTOR_SETTING),r=xt({fetchValidLinksOnly:!0,productSku:ve.CONNECTOR_SETTING}),l=ns(),c=Te(),u=!(c!=null&&c.isPersonalAccount())&&(c==null?void 0:c.planType)!==ke.SELF_SERVE_BUSINESS,m=ee(),{canCreate:g,isLoading:f}=Hp(),x=Kt(),{shouldRenderButton:b,isDisabledByAdmin:M}=h.useMemo(()=>c?oe(m,"3927245414")?x?{shouldRenderButton:!0,isDisabledByAdmin:c.isWorkspaceAccount()?!g:!1}:{shouldRenderButton:!1,isDisabledByAdmin:!1}:!oe(m,"3828441000")&&!x?{shouldRenderButton:!1,isDisabledByAdmin:!1}:c.isWorkspaceAccount()?f?{shouldRenderButton:!1,isDisabledByAdmin:!1}:{shouldRenderButton:!0,isDisabledByAdmin:!g}:{shouldRenderButton:!0,isDisabledByAdmin:!1}:{shouldRenderButton:!1,isDisabledByAdmin:!1},[c,g,f,x,m]),y=h.useMemo(()=>Array.from(i.platformConnectors.values()).filter(te=>te.id===Cc?!1:te.connector_type==="MCP"||o.availableConnectors.some(me=>me.id===te.id)||te.id===nt&&n),[i.platformConnectors,o.availableConnectors,n]),C=Gi(),{isLoading:_,isEnabled:v}=Ui(),j=u?v&&!_:!0,S=es("linear"),N=es("dropbox"),w=es("box"),A=es("notion"),T=h.useMemo(()=>[{connectorId:Wi,shouldRenderRow:C&&j},{connectorId:Hi,shouldRenderRow:S},{connectorId:zi,shouldRenderRow:N},{connectorId:Vi,shouldRenderRow:w},{connectorId:qi,shouldRenderRow:A,syncConnectorId:Ki}],[j,S,C,N,w,A]),P=h.useMemo(()=>{var me;const te=[];for(const{connectorId:Se,shouldRenderRow:We,syncConnectorId:He}of T){if(!We)continue;const Ae=i.platformConnectors.get(Se),ze=(me=r.connectorLinks.get(Se))==null?void 0:me[0];!Ae||!ze||te.push({connector:Ae,row:e.jsx(Kp,{link:ze,connector:Ae,syncConnectorId:He,refetchLinks:r.refetch})})}return te},[i.platformConnectors,r.connectorLinks,r.refetch,T]),E=h.useMemo(()=>P.map(te=>te.connector.id),[P]),O=h.useMemo(()=>{const te=new Map(r.connectorLinks);return te.delete(nt),te.delete(Ka),E.forEach(me=>{te.delete(me)}),te},[r.connectorLinks,E]),{fileUploadConfig:D,internalKnowledgeConfigs:I}=Js(),H=Bi(),$=h.useMemo(()=>{var te;return(te=I==null?void 0:I.filter(me=>me.user_connection_details.auth_status!=="not_connected").length)!=null?te:0},[I]),X=(ye=(ue=r.connectorLinks.get(nt))==null?void 0:ue.length)!=null?ye:0,q=!!(D!=null&&D.access_token)||X>0||$>0,G=!!((re=H.personalConfig)!=null&&re.access_token),F=!!((ne=H.businessConfig)!=null&&ne.access_token),R=i.platformConnectors.get(nt),V=(B=r.connectorLinks.get(Ka))==null?void 0:B[0],Q=i.platformConnectors.get(Ka),de=h.useMemo(()=>y.filter(te=>{if(Object.values(qa).some(me=>me.access===te.id)){const me=Object.values(qa).filter(Se=>Se.access===te.id);return!r.connectorLinks.has(me[0].access)&&!r.connectorLinks.has(me[0].sync)}else return Object.values(qa).some(me=>me.sync===te.id)?!1:te.id===nt?!q:!r.connectorLinks.has(te.id)}),[y,r.connectorLinks,q]);if(i.isLoading||o.isLoading||r.isLoading)return e.jsx(Me,{title:e.jsx(d,p({},we.connectorsTitle)),children:e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})})});if(i.error||r.error||!o.enabled||!y.length)return e.jsx(Me,{title:e.jsx(d,p({},we.connectorsTitle)),children:e.jsx(ta,{type:"danger",children:e.jsx(d,p({},we.error))})});const Z=O.size>0||q||G||F||!!V||P.length>0;return e.jsxs(e.Fragment,{children:[Z&&e.jsx(Me,{title:e.jsx(d,p({},we.enabledConnectorsTitle)),description:e.jsx(d,J(p({},we.enabledConnectorsDescription),{values:{link:te=>e.jsx(ts,{href:Lo,openNewTab:!0,children:te})}})),children:e.jsx(Up,{connectorLinks:O,platformConnectors:y,gdriveRow:q&&R?e.jsx(zp,{gdrivePlatformConnector:R,isFileUploadsEnabled:!!(D!=null&&D.access_token),numPlatformLinks:X,platformLinks:r.connectorLinks,numInternalKnowledgeLinks:$,numInternalKnowledgeConfigs:(Y=I==null?void 0:I.length)!=null?Y:0,onAddClick:()=>{l(nt),s()}}):null,onedrivePersonalRow:G&&H.personalConfig?e.jsx(Oo,{config:H.personalConfig,onClick:()=>l("onedrive-personal")}):null,onedriveBusinessRow:F&&H.businessConfig?e.jsx(Oo,{config:H.businessConfig,onClick:()=>l("onedrive-business")}):null,githubRow:V&&Q?e.jsx(Vp,{githubLink:V,githubPlatformConnector:Q}):null,genericSyncableRows:P})}),e.jsxs(Me,{noBorder:!0,headerInteractable:!0,title:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[Z?e.jsx(d,p({},we.allConnectorsTitle)):e.jsx(d,p({},we.connectorsTitle)),b&&e.jsx(dn,{disabled:M,message:we.createCustomConnectorButton,onAddClick:t,tooltip:M?a.formatMessage(we.createCustomConnectorDisabledByAdmin):void 0,side:"bottom"})]}),description:!Z&&e.jsx(d,J(p({},we.connectorsDescription),{values:{link:te=>e.jsx(ts,{href:Lo,openNewTab:!0,children:te})}})),children:[e.jsx("span",{id:"developer-mode-settings"}),e.jsx(Gp,{connectors:de}),e.jsx($p,{})]})]})};function $p(){const t=$e(),s=ee(),a=Kt();return!oe(s,"735368229")&&!a?null:e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"border-token-border-default mt-8"}),e.jsx(K,{children:e.jsx(Ia,{label:e.jsx(d,p({},we.advancedSettings)),onClick:()=>t("#settings/Connectors/Advanced")})})]})}const we=ae({deepResearchDisabledByAdmin:{id:"uYQCnH",defaultMessage:"Your admin has not enabled deep research for Google Drive."},connectorsTitle:{id:"CRwNSN",defaultMessage:"Connectors"},connectorsDescription:{id:"SVe7lH",defaultMessage:"Connect your favorite apps so ChatGPT can access their information, based on what you’re authorized to view. <link>Learn more</link>"},secureSigninTitle:{id:"wGZ2DC",defaultMessage:"Secure sign in with ChatGPT"},secureSigninDescription:{id:"5XRQKi",defaultMessage:"Sign in to websites and apps across the internet with the trusted security of ChatGPT. <link>Learn more</link>"},enabledConnectorsTitle:{id:"Ew4Xpl",defaultMessage:"Enabled connectors"},enabledConnectorsDescription:{id:"Bb7Lur",defaultMessage:"ChatGPT can access information from connected apps. Your permissions are always respected. <link>Learn more</link>"},allConnectorsTitle:{id:"cL3AUC",defaultMessage:"Browse connectors"},contactAdminTooltip:{id:"q5N+up",defaultMessage:"Contact your admin to enable Google Drive for chat."},error:{id:"F+mY2E",defaultMessage:"Error fetching connectors"},createCustomConnectorButton:{id:"jeLjEI",defaultMessage:"Create"},createCustomConnectorDisabledByAdmin:{id:"createCustomConnectorDisabledByAdmin",defaultMessage:"Your admin has not enabled creating custom connectors."},syncForBetterAnswers:{id:"6wQ3rX",defaultMessage:"Enable sync"},syncForBetterAnswersTooltip:{id:"zhVkue",defaultMessage:"Sync Google Drive files to ChatGPT for faster, more relevant answers."},syncFilesForBetterAnswersTooltip:{id:"+u4cD2",defaultMessage:"Sync {connector} files to ChatGPT for faster, more relevant answers."},syncConnectorSuccess:{id:"oyKGlh",defaultMessage:"{connector} is now connected and syncing."},syncConnectorError:{id:"P7CgsH",defaultMessage:"Failed to connect and start syncing {connector}."},addChatAndOrDeepResearch:{id:"4/yhnQ",defaultMessage:"Add chat, deep research"},addDeepResearch:{id:"PT3yzw",defaultMessage:"Add deep research"},deepResearchDescription:{id:"1POyn5",defaultMessage:"Deep research"},fileUploadsDescription:{id:"mYsWe4",defaultMessage:"File uploads"},advancedSettings:{id:"6qpafZ",defaultMessage:"Advanced settings"},setupIncompleteGithub:{id:"WPhFYm",defaultMessage:"Setup incomplete"}}),Qp=jt(()=>St(()=>import("./oxo0r33hqmhdtptf.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.GithubOnboardingModal)),Yp=t=>{"use forget";const s=Mt.c(20),{onAddLinkClick:a,onCreateCustomConnectorClick:n}=t,o=ee(),i=$e(),r=Lt(),l=vn(),c=Nc(),u=r.hash.startsWith("#settings/Connectors/Advanced");let m,g;s[0]!==o||s[1]!==i?(m=()=>{const C=window.location.hash,_=C.indexOf("?");if(_===-1)return;const v=new URLSearchParams(C.substring(_+1));if(v.has("github_onboarding")){const j=v.get("github_onboarding");let S=Bt.ConfigureRepos;j&&[Bt.ConfigureRepos,Bt.SyncRepos,Bt.IndexRepos].includes(j)&&(S=j),Ye(o,Qp,{initialState:S}),v.delete("github_onboarding");const N=C.substring(0,_),w=v.toString()?"".concat(N,"?").concat(v.toString()):N;i({hash:w},{replace:!0})}},g=[o,i],s[0]=o,s[1]=i,s[2]=m,s[3]=g):(m=s[2],g=s[3]),h.useEffect(m,g);let f,x;if(s[4]!==l?(f=()=>{l?se.logEventWithStatsig("Connectors Details Settings Modal Shown","chatgpt_connectors_details_settings_modal_shown",{type:l}):se.logEventWithStatsig("Connectors Settings Modal Shown","chatgpt_connectors_settings_modal_shown")},x=[l],s[4]=l,s[5]=f,s[6]=x):(f=s[5],x=s[6]),h.useEffect(f,x),l){let C;return s[7]!==l||s[8]!==a?(C=e.jsx(Bp,{connectorId:l,onAddClick:a}),s[7]=l,s[8]=a,s[9]=C):C=s[9],C}if(u){let C;return s[10]!==i?(C=e.jsx(cp,{onBack:()=>i("#settings/Connectors",{replace:!0})}),s[10]=i,s[11]=C):C=s[11],C}let b;s[12]!==a||s[13]!==n?(b=e.jsx(qp,{onCreateCustomConnectorClick:n,onAddClick:a}),s[12]=a,s[13]=n,s[14]=b):b=s[14];let M;s[15]!==c?(M=c&&e.jsx(Ei,{}),s[15]=c,s[16]=M):M=s[16];let y;return s[17]!==b||s[18]!==M?(y=e.jsxs(e.Fragment,{children:[b,M]}),s[17]=b,s[18]=M,s[19]=y):y=s[19],y},Ms=({defaultValue:t,onContinue:s,options:a})=>{const[n,o]=h.useState(t);return e.jsxs(e.Fragment,{children:[e.jsx(hu,{value:n,onValueChange:i=>o(i),className:"flex flex-col gap-2 pt-8 pb-6",children:a.map(({value:i,label:r,description:l,Icon:c,Badge:u,disabled:m,tooltip:g})=>{const f=e.jsxs(on,{value:i,className:ht("border-token-border-default flex items-center gap-4 rounded-2xl border p-4 text-sm",m&&"cursor-not-allowed opacity-60"),disabled:m,children:[c&&e.jsx("span",{children:e.jsx(c,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1 text-start",children:[e.jsxs("div",{className:"flex items-center gap-1.5 pb-0.5",children:[typeof r=="string"?r:e.jsx(d,p({},r)),u&&e.jsx(u,{})]}),e.jsx("div",{className:"text-token-text-secondary",children:typeof l=="string"?l:e.jsx(d,p({},l))})]}),n===i?e.jsx(xu,{className:"flex h-5 w-5 items-center justify-center rounded-full bg-gray-950 p-0.5 dark:bg-white",children:e.jsx("div",{className:"h-2 w-2 rounded-full bg-white dark:bg-gray-950"})}):e.jsx("div",{className:"border-token-border-default h-5 w-5 rounded-full border"})]},i);return g?e.jsx(tt,{label:e.jsx("div",{className:"max-w-50",children:typeof g=="string"?g:e.jsx(d,p({},g))}),side:"right",children:f},i):f})}),e.jsx(W,{className:"w-full",size:"large",disabled:!n,onClick:()=>{n&&s(n)},children:e.jsx(d,p({},Zp.nextStepButton))})]})},Zp=ae({nextStepButton:{id:"addConnectorLinkModal.nextStepButton",defaultMessage:"Continue"}}),Xp=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},it.syncBadge))]}),Jp=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},it.recommendedBadge))}),eh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?nh:ah),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"AEBXx0",defaultMessage:"Contact your admin to enable Google Drive for chat"})}),...n?[i?sh:c?oh:th]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},it.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},it=ae({selectProductTitle:{id:"r2npOY",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"gzPmCe",defaultMessage:"Find, analyze, and synthesize your Drive files to create comprehensive reports"},deepResearchDescription:{id:"L+S/jI",defaultMessage:"Find, analyze, and synthesize your Drive files to create comprehensive reports"},dontSyncTitle:{id:"YcPoIP",defaultMessage:"Don't sync"},dontSyncDescription:{id:"uO+gdP",defaultMessage:"ChatGPT will read your Google Drive files as needed, so replies may be slower."},internalKnowledgeTitle:{id:"CQFxR7",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"0xFkEA",defaultMessage:"Sync Drive files to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"yMY2Ng",defaultMessage:"Sync"},syncDescription:{id:"fcoBBw",defaultMessage:"Sync Google Drive files to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),th={value:"deepResearch",label:it.deepResearchTitle,description:it.deepResearchDescription,Icon:yt},sh={value:"deepResearchAndOdyssey",label:it.deepResearchAndOdysseyTitle,description:it.deepResearchAndOdysseyDescription,Icon:yt},ah={value:"internalKnowledge",label:it.internalKnowledgeTitle,description:it.internalKnowledgeDescription,Icon:Rs,Badge:Xp},nh={value:"internalKnowledge",label:it.syncTitle,description:it.syncDescription,Icon:hs,Badge:Jp},oh={value:"deepResearch",label:it.dontSyncTitle,description:it.dontSyncDescription,Icon:xs},ih=({connector:t,internalKnowledgeConfigs:s,onClose:a,onContinue:n})=>{var i,r;const o=h.useMemo(()=>s.filter(l=>l.user_connection_details.auth_status==="not_connected").map(l=>({value:l.user_connection_details.connection_instance_id,label:l.connection_display_info.display_name,description:l.connection_display_info.description})),[s]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},rh.selectConnectionTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(r=(i=t.branding)==null?void 0:i.developer)!=null?r:void 0,onClose:a}),e.jsx(Ms,{onContinue:n,options:o})]})},rh=ae({selectConnectionTitle:{id:"2rQetR",defaultMessage:"Select a connection"}}),lh=jt(()=>St(()=>import("./eu5xc064k5tcc0d1.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10,11,12])).then(t=>t.RedirectContent)),ch=({onClose:t,connector:s})=>{const a=k(),n=$e(),o=ce(),i=mt(),r=Te(),l=!!(r!=null&&r.isPersonalAccount()&&i),{isLoading:c,internalKnowledgeConfigs:u,internalKnowledgeEnabled:m}=Js(),{mutateAsync:g}=ps(),{availableConnectors:f}=Aa(),{availableConnectors:x}=hr(),[b,M]=h.useMemo(()=>Ln(u!=null?u:[],Z=>Z.user_connection_details.auth_status==="not_connected"),[u]),y=sa(),C=b.length,_=M.length,[v,j]=h.useState(!1),[S,N]=h.useState(null),[w,A]=h.useState(null),T=h.useMemo(()=>C===1?u==null?void 0:u[0]:w?u==null?void 0:u.find(Z=>Z.user_connection_details.connection_instance_id===w):void 0,[C,u,w]),[P,E]=h.useState(!1),{connectorLinks:O,refetch:D}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!0}),{refetch:I}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!1,skip:!0}),H=h.useMemo(()=>{var Z;return!!((Z=O.get(nt))!=null&&Z.length)},[O]),{refetch:$}=as({skip:!0}),X=!H&&f.some(Z=>Z.type===U.GDRIVE_ACTION_CONNECTOR),q=!H&&x.some(Z=>Z.type===U.GDRIVE_ACTION_CONNECTOR),G=C>0||l,F=(X||q)&&(G||!(r!=null&&r.isPersonalAccount())&&m&&_<1&&!l),R=S==="deepResearch"||S==="deepResearchAndOdyssey"||!F&&(X||q),V=S==="internalKnowledge"||!F&&G,Q=l&&S==="internalKnowledge",de=h.useCallback(async()=>{try{E(!0),oa("popup"),se.logEventWithStatsig("Connectors - Connect Personal Google Drive","chatgpt_connectors_connect_personal_google_drive_clicked",{sync:Q?"true":"false"});const Z=await Is({connector:s,openPopup:!0,toaster:Q?void 0:o,intl:a,productSku:ve.CONNECTOR_SETTING});if(D(),I(),(Z==null?void 0:Z.errorType)==="oauth_failed_scope_mismatch"){E(!1),j(!0);return}Z!=null&&Z.linkId&&Q&&g({link:{id:Z.linkId,name:s.name,connector_id:st[U.GDRIVE_ACTION_CONNECTOR]},isConnectingAndUpgrading:!0}).then(()=>{$()});const ue=y(s);ue?window.location.href=ue:(t(),setTimeout(()=>{n(xn,{replace:!0})},500)),j(!1)}catch(Z){E(!1)}},[Q,s,o,a,D,I,y,g,$,t,n]);return c?e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})}):v?e.jsxs(e.Fragment,{children:[e.jsx(os,{onClose:t,connectorIcon:e.jsx("div",{className:"rounded-xl border-[0.5px] bg-white p-2 shadow-sm",children:e.jsx(Pa,{height:32,width:32})}),title:a.formatMessage({id:"LrBpzI",defaultMessage:"Permissions required"})}),e.jsxs("div",{className:"border-token-border-default text-token-text-secondary mt-8 mb-6 flex items-center gap-4 rounded-xl border p-4 text-sm",children:[e.jsx(gn,{className:"icon-lg"}),e.jsx(d,{id:"googleDriveLinkingModalDescription",defaultMessage:"In the next step, make sure to check all boxes. ChatGPT requires the full list of Google permissions."})]}),e.jsx(W,{className:"w-full",onClick:de,loading:P,size:"large",children:e.jsx(d,{id:"reconnect",defaultMessage:"Reconnect"})})]}):e.jsxs(e.Fragment,{children:[F&&!S&&e.jsx(eh,{onClose:t,connector:s,onContinue:N,canAddDeepResearch:X,canAddOdyssey:q,canAddInternalKnowledge:G}),(R||Q)&&e.jsx(lh,{connector:s,onClose:t,isConnecting:P,onContinue:de,productSku:ve.CONNECTOR_SETTING}),V&&C>1&&!w&&e.jsx(ih,{internalKnowledgeConfigs:u!=null?u:[],onClose:t,connector:s,onContinue:A}),V&&T&&!Q&&e.jsx(xi,{isAdminFlow:!1,onClose:()=>{N(null),A(null),F||t()},connectionId:T.user_connection_details.connection_instance_id,location:"user_settings",onSuccess:()=>{$(),t()},excludeModalWrapper:!0})]})},dh=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},rt.syncBadge))]}),uh=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},rt.recommendedBadge))}),mh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?hh:ph),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"g8mQKA",defaultMessage:"Contact your admin to enable SharePoint for chat"})}),...n?[i?fh:c?xh:gh]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},rt.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},rt=ae({selectProductTitle:{id:"uecmFA",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"plFxz/",defaultMessage:"Find, analyze, and synthesize your SharePoint files to create comprehensive reports"},deepResearchDescription:{id:"D9wqqk",defaultMessage:"Find, analyze, and synthesize your SharePoint files to create comprehensive reports"},dontSyncTitle:{id:"FNGsn2",defaultMessage:"Don't sync"},dontSyncDescription:{id:"ol0mde",defaultMessage:"ChatGPT will read your SharePoint files as needed, so replies may be slower."},internalKnowledgeTitle:{id:"Je+I3p",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"Mkivbe",defaultMessage:"Sync SharePoint files to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"w0EP7L",defaultMessage:"Sync"},syncDescription:{id:"WmlsRw",defaultMessage:"Sync SharePoint files to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),gh={value:"deepResearch",label:rt.deepResearchTitle,description:rt.deepResearchDescription,Icon:yt},fh={value:"deepResearchAndOdyssey",label:rt.deepResearchAndOdysseyTitle,description:rt.deepResearchAndOdysseyDescription,Icon:yt},ph={value:"internalKnowledge",label:rt.internalKnowledgeTitle,description:rt.internalKnowledgeDescription,Icon:Rs,Badge:dh},hh={value:"internalKnowledge",label:rt.syncTitle,description:rt.syncDescription,Icon:hs,Badge:uh},xh={value:"deepResearch",label:rt.dontSyncTitle,description:rt.dontSyncDescription,Icon:xs},Io=jt(()=>St(()=>import("./eu5xc064k5tcc0d1.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10,11,12])).then(t=>t.RedirectContent)),bh=({onClose:t,connector:s})=>{const a=k(),n=ce(),[o,i]=h.useState(!1),r=Te(),l=mt(),c=(r==null?void 0:r.planType)===ke.SELF_SERVE_BUSINESS?!0:!!(r!=null&&r.isPersonalAccount()&&l),{connectorLinks:u,refetch:m}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!0}),{refetch:g}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!1,skip:!0}),f=sa(),{availableConnectors:x}=Aa(),{mutateAsync:b}=ps(),{refetch:M}=as({skip:!0}),{isLoading:y,internalKnowledgeConfigs:C,internalKnowledgeEnabled:_}=Mh(),[v,j]=h.useMemo(()=>Ln(C!=null?C:[],q=>q.user_connection_details.auth_status==="not_connected"),[C]),S=v.length,N=j.length,[w,A]=h.useState(null),T=h.useMemo(()=>{var q;return!!((q=u.get(Wi))!=null&&q.length)},[u]),P=!T&&x.some(q=>q.type===U.SHAREPOINT_CONNECTOR),E=!T&&x.some(q=>q.type===U.SHAREPOINT_CONNECTOR),O=S>0||c,D=(P||E)&&(O||!(r!=null&&r.isPersonalAccount())&&_&&N<1&&!c),I=w==="deepResearch"||w==="deepResearchAndOdyssey"||!D&&(P||E),H=w==="internalKnowledge"||!D&&O,$=H,X=h.useCallback(async()=>{var q,G;try{i(!0),oa("popup");const F=f(s),R=await Is({connector:s,openPopup:!0,toaster:n,intl:a,productSku:ve.CONNECTOR_SETTING,redirectAfter:F||void 0});if(await m(),$)try{const V=await g(),Q=new Map(Object.entries((q=V.data)!=null?q:{})),de=R&&typeof R=="object"?R.linkId:void 0,Z=(G=Q.get(s.id))==null?void 0:G[0];let ue=null;typeof de=="string"?ue={id:de,name:s.name,connector_id:s.id}:Z&&typeof Z.id=="string"&&(ue={id:Z.id,name:s.name,connector_id:s.id}),ue&&(await b({link:ue,isConnectingAndUpgrading:!0}),await M())}catch(V){}t()}catch(F){i(!1)}},[s,n,a,m,g,f,t,$,b,M]);return y?e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})}):e.jsxs(e.Fragment,{children:[D&&!w&&e.jsx(mh,{onClose:t,connector:s,onContinue:A,canAddDeepResearch:P,canAddOdyssey:E,canAddInternalKnowledge:O}),(I||$)&&e.jsx(Io,{connector:s,onClose:t,isConnecting:o,onContinue:X,productSku:ve.CONNECTOR_SETTING}),H&&!$&&e.jsx(Io,{connector:s,onClose:()=>{A(null),D||t()},isConnecting:o,onContinue:X,productSku:ve.CONNECTOR_SETTING})]})};function Mh(){const t=Ls(),s=Oa(),a=h.useMemo(()=>{var n;return(n=s.data)==null?void 0:n.connection_statuses.filter(o=>o.user_connection_details.knowledge_connector_type==="sharepoint")},[s.data]);return{isLoading:s.isLoading,internalKnowledgeEnabled:t,internalKnowledgeConfigs:t&&(a!=null&&a.length)?a:null}}const yh=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},lt.syncBadge))]}),Ch=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},lt.recommendedBadge))}),vh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?wh:_h),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"GbkN+V",defaultMessage:"Contact your admin to enable Notion for chat"})}),...n?[i?Sh:c?Nh:jh]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},lt.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},lt=ae({selectProductTitle:{id:"DAwG09",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"KXsRFb",defaultMessage:"Find, analyze, and synthesize your team's Notion pages and databases to create comprehensive reports"},deepResearchDescription:{id:"gZpO3N",defaultMessage:"Find, analyze, and synthesize Notion pages and databases for richer reports"},dontSyncTitle:{id:"GMrSDT",defaultMessage:"Don't sync"},dontSyncDescription:{id:"y/IdPs",defaultMessage:"ChatGPT will read your Notion content as needed, so replies may be slower."},internalKnowledgeTitle:{id:"QJf1Sc",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"lJilfk",defaultMessage:"Sync Notion pages and databases to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"7Ar/Ej",defaultMessage:"Sync"},syncDescription:{id:"6WCZbJ",defaultMessage:"Sync Notion content to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),jh={value:"deepResearch",label:lt.deepResearchTitle,description:lt.deepResearchDescription,Icon:yt},Sh={value:"deepResearchAndOdyssey",label:lt.deepResearchAndOdysseyTitle,description:lt.deepResearchAndOdysseyDescription,Icon:yt},_h={value:"internalKnowledge",label:lt.internalKnowledgeTitle,description:lt.internalKnowledgeDescription,Icon:Rs,Badge:yh},wh={value:"internalKnowledge",label:lt.syncTitle,description:lt.syncDescription,Icon:hs,Badge:Ch},Nh={value:"deepResearch",label:lt.dontSyncTitle,description:lt.dontSyncDescription,Icon:xs},kh=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},ct.syncBadge))]}),Th=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},ct.recommendedBadge))}),Eh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?Lh:Dh),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"4Gp6+x",defaultMessage:"Contact your admin to enable Box for chat"})}),...n?[i?Ah:c?Oh:Ph]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},ct.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},ct=ae({selectProductTitle:{id:"tiiSob",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"E2YSMq",defaultMessage:"Find, analyze, and synthesize your Box files to create comprehensive reports"},deepResearchDescription:{id:"sQ+00J",defaultMessage:"Find, analyze, and synthesize your Box files to create comprehensive reports"},dontSyncTitle:{id:"M9p5Sr",defaultMessage:"Don't sync"},dontSyncDescription:{id:"uJTHjO",defaultMessage:"ChatGPT will read your Box files as needed, so replies may be slower."},internalKnowledgeTitle:{id:"8z2iu4",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"xK+380",defaultMessage:"Sync Box files to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"nbQOhy",defaultMessage:"Sync"},syncDescription:{id:"QVxBJI",defaultMessage:"Sync Box files to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),Ph={value:"deepResearch",label:ct.deepResearchTitle,description:ct.deepResearchDescription,Icon:yt},Ah={value:"deepResearchAndOdyssey",label:ct.deepResearchAndOdysseyTitle,description:ct.deepResearchAndOdysseyDescription,Icon:yt},Dh={value:"internalKnowledge",label:ct.internalKnowledgeTitle,description:ct.internalKnowledgeDescription,Icon:Rs,Badge:kh},Lh={value:"internalKnowledge",label:ct.syncTitle,description:ct.syncDescription,Icon:hs,Badge:Th},Oh={value:"deepResearch",label:ct.dontSyncTitle,description:ct.dontSyncDescription,Icon:xs},Ih=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},dt.syncBadge))]}),Rh=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},dt.recommendedBadge))}),Bh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?Wh:Uh),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"/uVHMl",defaultMessage:"Contact your admin to enable Dropbox for chat"})}),...n?[i?Gh:c?Hh:Fh]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},dt.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},dt=ae({selectProductTitle:{id:"5spMkf",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"U0acJQ",defaultMessage:"Find, analyze, and synthesize your Dropbox files to create comprehensive reports"},deepResearchDescription:{id:"jIJEzP",defaultMessage:"Find, analyze, and synthesize your Dropbox files to create comprehensive reports"},dontSyncTitle:{id:"8B2iTh",defaultMessage:"Don't sync"},dontSyncDescription:{id:"MWu53i",defaultMessage:"ChatGPT will read your Dropbox files as needed, so replies may be slower."},internalKnowledgeTitle:{id:"iUMNhW",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"73blMa",defaultMessage:"Sync Dropbox files to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"aRVh2X",defaultMessage:"Sync"},syncDescription:{id:"uTHxb2",defaultMessage:"Sync Dropbox files to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),Fh={value:"deepResearch",label:dt.deepResearchTitle,description:dt.deepResearchDescription,Icon:yt},Gh={value:"deepResearchAndOdyssey",label:dt.deepResearchAndOdysseyTitle,description:dt.deepResearchAndOdysseyDescription,Icon:yt},Uh={value:"internalKnowledge",label:dt.internalKnowledgeTitle,description:dt.internalKnowledgeDescription,Icon:Rs,Badge:Ih},Wh={value:"internalKnowledge",label:dt.syncTitle,description:dt.syncDescription,Icon:hs,Badge:Rh},Hh={value:"deepResearch",label:dt.dontSyncTitle,description:dt.dontSyncDescription,Icon:xs},zh=()=>e.jsxs("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:[e.jsx(bs,{}),e.jsx(d,p({},ut.syncBadge))]}),Vh=()=>e.jsx("span",{className:"bg-token-interactive-bg-accent-default flex items-center gap-1 rounded-sm px-1.5 py-0.5 text-xs text-[#007AFF]",children:e.jsx(d,p({},ut.recommendedBadge))}),Kh=({connector:t,onClose:s,onContinue:a,canAddDeepResearch:n,canAddInternalKnowledge:o,canAddOdyssey:i})=>{var g,f;const r=Te(),l=mt(),c=!!(r!=null&&r.isPersonalAccount()&&l),u=k(),m=h.useMemo(()=>[p(p({},c?Yh:Qh),o?{}:{disabled:!0,tooltip:u.formatMessage({id:"lxy6iQ",defaultMessage:"Contact your admin to enable Linear for chat"})}),...n?[i?$h:c?Zh:qh]:[]],[c,o,u,n,i]);return e.jsxs(e.Fragment,{children:[e.jsx(os,{title:e.jsx(d,p({},ut.selectProductTitle)),connectorIcon:e.jsx(Ot,{connector:t,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(f=(g=t.branding)==null?void 0:g.developer)!=null?f:void 0,onClose:s}),e.jsx(Ms,{defaultValue:c?"internalKnowledge":void 0,onContinue:a,options:m})]})},ut=ae({selectProductTitle:{id:"kU51Yz",defaultMessage:"Select a connection type"},deepResearchTitle:{id:"BufFDR",defaultMessage:"Deep research"},deepResearchAndOdysseyTitle:{id:"y9kp7g",defaultMessage:"Deep research and agent mode"},deepResearchAndOdysseyDescription:{id:"5P9nHy",defaultMessage:"Find, analyze, and synthesize your Linear issues to create comprehensive reports"},deepResearchDescription:{id:"7qO5UY",defaultMessage:"Find, analyze, and synthesize your Linear issues to create comprehensive reports"},dontSyncTitle:{id:"s+7AVU",defaultMessage:"Don't sync"},dontSyncDescription:{id:"qQEaBe",defaultMessage:"ChatGPT will read your Linear issues as needed, so replies may be slower."},internalKnowledgeTitle:{id:"CZbTgH",defaultMessage:"Chat"},internalKnowledgeDescription:{id:"S+Hglq",defaultMessage:"Sync Linear issues to ChatGPT for more relevant, up-to-date answers"},recommendedBadge:{id:"Wtyyql",defaultMessage:"Recommended"},syncTitle:{id:"XI3bjb",defaultMessage:"Sync"},syncDescription:{id:"3e8sdS",defaultMessage:"Sync Linear issues to ChatGPT for faster, more relevant answers."},syncBadge:{id:"0OM3Oh",defaultMessage:"Sync"}}),qh={value:"deepResearch",label:ut.deepResearchTitle,description:ut.deepResearchDescription,Icon:yt},$h={value:"deepResearchAndOdyssey",label:ut.deepResearchAndOdysseyTitle,description:ut.deepResearchAndOdysseyDescription,Icon:yt},Qh={value:"internalKnowledge",label:ut.internalKnowledgeTitle,description:ut.internalKnowledgeDescription,Icon:Rs,Badge:zh},Yh={value:"internalKnowledge",label:ut.syncTitle,description:ut.syncDescription,Icon:hs,Badge:Vh},Zh={value:"deepResearch",label:ut.dontSyncTitle,description:ut.dontSyncDescription,Icon:xs},Ro=jt(()=>St(()=>import("./eu5xc064k5tcc0d1.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10,11,12])).then(t=>t.RedirectContent));function za({platformConnectorType:t,knowledgeConnectorType:s,connectorId:a,ProductSelectComponent:n,syncConnectorId:o}){return function({onClose:r,connector:l}){const c=k(),u=ce(),m=$i(),[g,f]=h.useState(!1),[x,b]=h.useState(m===ve.DEEP_RESEARCH?"deepResearch":null),M=Te(),y=mt(),C=(M==null?void 0:M.planType)===ke.SELF_SERVE_BUSINESS?!0:!!(M!=null&&M.isPersonalAccount()&&y),{availableConnectors:_,isLoading:v}=Aa(),{availableConnectors:j,isLoading:S}=hr(),{isLoading:N,internalKnowledgeConfigs:w,internalKnowledgeEnabled:A}=sx(s),[T,P]=h.useMemo(()=>Ln(w!=null?w:[],Se=>Se.user_connection_details.auth_status==="not_connected"),[w]),E=T.length,O=P.length,D=E>0||C,{connectorLinks:I,refetch:H,isLoading:$}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!0}),{refetch:X}=xt({productSku:ve.CONNECTOR_SETTING,fetchValidLinksOnly:!1,skip:!0}),{refetch:q}=as({skip:!0}),G=sa(),{mutateAsync:F}=ps(),R=h.useMemo(()=>{var Se;return!!((Se=I.get(a))!=null&&Se.length)},[I]),V=!R&&_.some(Se=>Se.type===t),Q=!R&&j.some(Se=>Se.type===t),de=V||Q,Z=!!n&&m!==ve.DEEP_RESEARCH&&de&&(D||!(M!=null&&M.isPersonalAccount())&&A&&O<1&&!C),ue=m===ve.DEEP_RESEARCH||x==="deepResearch"||x==="deepResearchAndOdyssey"||!Z&&de,ye=x==="internalKnowledge"||!Z&&m!==ve.DEEP_RESEARCH&&D,re=ue?ve.DEEP_RESEARCH:ve.CONNECTOR_SETTING,ne=ye&&D,B=ne&&o!=null,Y=m!==ve.DEEP_RESEARCH&&(N||Z&&(v||S))||Z&&$,te=ne,me=h.useCallback(async()=>{var Se,We;try{f(!0),oa("popup");const He=G(l),Ae=B&&o!=null?o:l.id,ze=await Is({connector:l,redirectAfter:He||void 0,toaster:u,openPopup:!0,intl:c,productSku:re,connectorIdOverride:B?o:void 0});if(await H(),ne)try{const _t=await X(),is=new Map(Object.entries((Se=_t.data)!=null?Se:{})),It=ze&&typeof ze=="object"?ze.linkId:void 0,rs=(We=is.get(Ae))==null?void 0:We[0];let ls=null;typeof It=="string"?ls={id:It,name:l.name,connector_id:Ae}:rs&&typeof rs.id=="string"&&(ls={id:rs.id,name:l.name,connector_id:Ae}),ls&&(await F({link:ls,isConnectingAndUpgrading:!0}),await q())}catch(_t){}r()}catch(He){f(!1)}},[l,c,G,r,re,H,X,q,B,ne,u,F]);return Y?e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})}):e.jsxs(e.Fragment,{children:[n&&Z&&!x&&e.jsx(n,{onClose:r,connector:l,onContinue:b,canAddDeepResearch:V,canAddOdyssey:Q,canAddInternalKnowledge:D}),(ue||te)&&e.jsx(Ro,{connector:l,onClose:r,isConnecting:g,onContinue:me,productSku:re}),ye&&!te&&e.jsx(Ro,{connector:l,onClose:()=>{b(null),Z||r()},isConnecting:g,onContinue:me,productSku:re})]})}}const Xh=za({platformConnectorType:U.DROPBOX_CONNECTOR,knowledgeConnectorType:"dropbox",connectorId:zi,ProductSelectComponent:Bh}),Jh=za({platformConnectorType:U.BOX_CONNECTOR,knowledgeConnectorType:"box",connectorId:Vi,ProductSelectComponent:Eh}),ex=za({platformConnectorType:U.LINEAR_CONNECTOR,knowledgeConnectorType:"linear",connectorId:Hi,ProductSelectComponent:Kh}),tx=za({platformConnectorType:U.NOTION_CONNECTOR,knowledgeConnectorType:"notion",connectorId:qi,syncConnectorId:Ki,ProductSelectComponent:vh});function sx(t){const s=Ls(),a=Oa(),n=h.useMemo(()=>{var o;return(o=a.data)==null?void 0:o.connection_statuses.filter(i=>i.user_connection_details.knowledge_connector_type===t)},[a.data,t]);return{isLoading:a.isLoading,internalKnowledgeEnabled:s,internalKnowledgeConfigs:s&&(n!=null&&n.length)?n:null}}const ax=jt(()=>St(()=>import("./eu5xc064k5tcc0d1.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10,11,12])).then(t=>t.RedirectContent)),nx=({connector:t,onClose:s,productSku:a,redirectAfter:n})=>{const o=k(),i=ce(),[r,l]=h.useState(!1),{refetch:c}=xt({productSku:a}),u=!0,m=sa(),[g,f]=h.useState(!1),[x,b]=h.useState(!0),[M,y]=h.useState(null),{mutateAsync:C}=ps(),_=h.useRef(null),[v,j]=h.useState(void 0),S=h.useRef(0);h.useEffect(()=>{const w=_.current;if(!w)return;let A;return g?!v&&S.current>0&&j(S.current):(A=new ResizeObserver(T=>{for(const P of T){const E=P.contentRect.height;E>S.current&&(S.current=E)}}),A.observe(w)),()=>{A==null||A.disconnect()}},[g,v]);const N=async()=>{var w,A;try{l(!0),oa("popup");const T=m(t),P=await Is({connector:t,redirectAfter:T||n,toaster:i,openPopup:u,intl:o,productSku:a});if(x)try{const E=await c(),O=new Map(Object.entries((w=E.data)!=null?w:{})),D=P&&typeof P=="object"?P.linkId:void 0,I=(A=O.get(t.id))==null?void 0:A[0];let H=null;typeof D=="string"?H={id:D,name:t.name,connector_id:t.id}:I&&typeof I.id=="string"&&(H={id:I.id,name:t.name,connector_id:t.id}),H&&await C({link:H,isConnectingAndUpgrading:!0})}catch(E){}s()}catch(T){l(!1),T instanceof Error&&i.danger(o.formatMessage({id:"wham.connectorSettings.addConnectorLinkModal.error",defaultMessage:"Failed to add connector link"}))}};return e.jsx("div",{ref:_,style:v?{minHeight:v}:void 0,className:"flex flex-col",children:g?e.jsx(ox,{value:M!=null?M:x,onChange:w=>y(w),onCancel:()=>{f(!1),y(null)},onSave:()=>{M!=null&&b(M),f(!1),y(null)},isSaveDisabled:!(M!=null&&M!==x)}):e.jsxs(e.Fragment,{children:[e.jsx(ax,{connector:t,onClose:s,isConnecting:r,onContinue:N,showExternalIcon:!0,productSku:a}),e.jsx("div",{className:"px-4 py-1",children:e.jsx("button",{type:"button",className:"text-token-text-secondary mx-auto mt-2 block text-sm outline-hidden focus:outline-none focus-visible:outline-none",onClick:()=>{y(x),f(!0)},children:e.jsx(d,p({},Rt.advancedSettingsLink))})})]})})},ox=({value:t,onChange:s,onCancel:a,onSave:n,isSaveDisabled:o})=>{const i=k();return e.jsxs("div",{className:"flex flex-1 flex-col p-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"text-2xl font-semibold",children:e.jsx(d,p({},Rt.advancedSettingsTitle))}),e.jsx(Ea,{onClick:a})]}),e.jsx("div",{className:"mt-6 mb-2 text-base font-medium",children:e.jsx(d,p({},Rt.connectionType))}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"border-token-border-default overflow-hidden rounded-xl border",children:e.jsxs(Jt.Root,{value:t?"sync":"ondemand",onValueChange:r=>s(r==="sync"),className:"flex w-full flex-col",children:[e.jsxs("label",{className:"flex items-start justify-between gap-3 p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium",children:e.jsx(d,p({},Rt.syncTitle))}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(d,p({},Rt.syncDescription))})]}),e.jsx(on,{value:"sync",className:"border-token-border-default mt-1 inline-flex h-5 w-5 shrink-0 items-center justify-center rounded-full border p-0 leading-none data-[state=checked]:border-black data-[state=checked]:bg-black dark:data-[state=checked]:border-white dark:data-[state=checked]:bg-white",children:t?e.jsx(Jt.Indicator,{className:"after:bg-white dark:after:bg-black"}):null})]}),e.jsxs("label",{className:"border-token-border-default flex items-start justify-between gap-3 border-t p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium",children:e.jsx(d,p({},Rt.onDemandTitle))}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(d,p({},Rt.onDemandDescription))})]}),e.jsx(on,{value:"ondemand",className:"border-token-border-default mt-1 inline-flex h-5 w-5 shrink-0 items-center justify-center rounded-full border p-0 leading-none data-[state=checked]:border-black data-[state=checked]:bg-black dark:data-[state=checked]:border-white dark:data-[state=checked]:bg-white",children:t?null:e.jsx(Jt.Indicator,{className:"after:bg-white dark:after:bg-black"})})]})]})})}),e.jsxs("div",{className:"mt-auto flex items-center justify-between pt-4",children:[e.jsx(W,{color:"secondary",onClick:a,children:i.formatMessage(Rt.cancel)}),e.jsx(W,{onClick:n,disabled:o,children:i.formatMessage(Rt.save)})]})]})},Rt=ae({advancedSettingsLink:{id:"qAio8L",defaultMessage:"Advanced settings"},advancedSettingsTitle:{id:"W24xFG",defaultMessage:"Advanced settings"},connectionType:{id:"GpZZmq",defaultMessage:"Connection type"},syncTitle:{id:"3kK9K9",defaultMessage:"Sync"},syncDescription:{id:"N3cJ8/",defaultMessage:"Sync content to ChatGPT for improved response speed and quality"},onDemandTitle:{id:"JSo4N3",defaultMessage:"On demand"},onDemandDescription:{id:"5PZSBI",defaultMessage:"Access content on demand. Responses will take longer and may be lower quality"},cancel:{id:"qz9XeG",defaultMessage:"Cancel"},save:{id:"LXZUd1",defaultMessage:"Save changes"}}),ix=jt(()=>St(()=>import("./eu5xc064k5tcc0d1.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10,11,12])).then(t=>t.RedirectContent)),rx=({connector:t,onClose:s,productSku:a,redirectAfter:n})=>{const o=k(),i=ce(),[r,l]=h.useState(!1),{refetch:c}=xt({productSku:a,fetchValidLinksOnly:!0}),u=yn(),m=bn(),g=sa(),f=Tc(),[x,b]=Ba(),{refetch:M}=Ec(),y=jn[t.id]===U.GITHUB_CONNECTOR;let C=n;if(y){const v=new URL(n!=null?n:"/",window.location.origin);u&&(v.searchParams.append("github_onboarding","sync-repos"),C=v.pathname+v.search)}const _=async()=>{try{switch(l(!0),Pc(t)){case"OAUTH":{const v=g(t);await Is({connector:t,redirectAfter:v||C,toaster:i,openPopup:m,intl:o,productSku:a}),await c(),s();break}case"NONE":{await Ac(t),await c(),await M(),s(),i.success(o.formatMessage({id:"cb/7hh",defaultMessage:"{connector} is now connected"},{connector:fs(t.name,o)})),f===an.JitPluginMessage&&b(v=>(v.set("link_success","true"),v),{replace:!0});break}}}catch(v){l(!1),v instanceof Error&&i.danger(o.formatMessage({id:"wham.connectorSettings.addConnectorLinkModal.error",defaultMessage:"Failed to add connector link"}))}};return e.jsx(ix,{connector:t,onClose:s,isConnecting:r,onContinue:_,productSku:a})},lx=t=>{const s=Te(),a=!(s!=null&&s.isPersonalAccount())&&(s==null?void 0:s.planType)!==ke.SELF_SERVE_BUSINESS,n=Gi(),{isEnabled:o,isLoading:i}=Ui(),r=a?o&&!i:!0,l=es("linear"),c=es("dropbox"),u=es("box"),m=es("notion");if(!t)return!1;switch(jn[t.id]){case U.SHAREPOINT_CONNECTOR:return!!(n&&r);case U.LINEAR_CONNECTOR:return l;case U.DROPBOX_CONNECTOR:return c;case U.BOX_CONNECTOR:return u;case U.NOTION_CONNECTOR:return m;default:return!1}},cx=({onClose:t})=>{const s=vn(),a=$i(),{platformConnectors:n,isLoading:o}=La(!0,a),i=s?n.get(s):void 0,r=kc(),l=lx(i),c=ee(),u=oe(c,"2837136623");if(o)return e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})});const m=(i==null?void 0:i.id)===nt;if(!i)return e.jsx(Le.Root,{isOpen:!0,onClose:t,testId:"modal-add-connector-link",children:e.jsx(Le.Overlay,{})});const g=jn[i.id],f=e.jsx(rx,{connector:i,onClose:t,productSku:a,redirectAfter:r}),x=(()=>{switch(g){case U.SHAREPOINT_CONNECTOR:return e.jsx(bh,{onClose:t,connector:i});case U.DROPBOX_CONNECTOR:return e.jsx(Xh,{onClose:t,connector:i});case U.BOX_CONNECTOR:return e.jsx(Jh,{onClose:t,connector:i});case U.LINEAR_CONNECTOR:return e.jsx(ex,{onClose:t,connector:i});case U.NOTION_CONNECTOR:return e.jsx(tx,{onClose:t,connector:i});default:return null}})(),b=u?e.jsx(nx,{connector:i,onClose:t,productSku:a,redirectAfter:r}):x!=null?x:f;return e.jsx(xe,{testId:"modal-add-connector-link",type:"success",isOpen:!0,onClose:t,size:"custom",className:"max-w-[400px]",children:m?e.jsx(ch,{onClose:t,connector:i}):l?b:f})},Bo=ae({title:{id:"fODdu4",defaultMessage:"Connect your tools with a ChatGPT paid plan"},description:{id:"8BtfyR",defaultMessage:"Upgrade to ChatGPT Plus, Pro, or Business to add connectors to your favorite apps like Google Drive, GitHub, Slack, and more for smarter, more relevant responses."}});function dx({onClose:t}){h.useEffect(()=>{se.logEvent("Connector Settings: Free Upsell Modal Viewed")},[]);const s=()=>{se.logEvent("Connector Settings: Free Upsell Upgrade Clicked"),window.location.assign("/#pricing")};return e.jsx(xe,{isOpen:!0,onClose:t,position:"center",showCloseButton:!0,size:"custom",className:"max-h-[85vh] w-full md:max-w-[640px]",testId:"modal-connectors-upgrade",children:e.jsxs("div",{className:"flex flex-col gap-6 p-6 text-center md:p-8",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold md:text-xl",children:e.jsx(d,p({},Bo.title))}),e.jsx("p",{className:"text-token-text-secondary text-sm md:text-base",children:e.jsx(d,p({},Bo.description))})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-3 md:flex-row md:justify-center",children:[e.jsx(W,{color:"secondary",onClick:t,size:"large",className:"w-full md:w-auto",children:e.jsx(d,p({},ja.maybeLater))}),e.jsx(W,{color:"primary",onClick:s,size:"large",className:"w-full min-w-[150px] md:w-auto",children:e.jsx(d,p({},ja.upgradeYourPlan))})]})]})})}let en=0;var ui;const ux=Fe(he.CheckboxItem)(ui||(ui=De(["flex flex-row justify-between h-10 mx-2 items-center"])));function mx(t,s,a,n){const o={category:t.category,[a]:s};n(o)}function gx(){const t=k(),a=Ne().getQueryData([ba]),[n,o]=h.useState(a),i=xx(o);return bu({onSuccess:r=>{o(r)},alwaysRefetchOnMount:!0}),e.jsx(Me,{title:t.formatMessage({id:"settingsModal.notifications",defaultMessage:"Notifications"}),children:n?n.map(r=>e.jsx(K,{children:e.jsx(fx,{settings:r,updateSettings:i.mutate})},r.category)):e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})})})}function fx({settings:t,updateSettings:s}){const a=k(),n=bt(),i=t.category==="teen_safety"?hx(t.options,!!(n!=null&&n.email),!!(n!=null&&n.phone_number)):t.options;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.name}),e.jsxs(he.Root,{children:[e.jsxs(he.Trigger,{children:[e.jsx("div",{children:px(i,a)}),e.jsx(yu,{className:"icon-sm"})]}),e.jsx(he.Portal,{children:e.jsx(he.Content,{size:"small",align:"end",children:i.map((r,l)=>e.jsx(ux,{checked:r.enabled,onCheckedChange:c=>mx(t,c,r.channel,s),children:r.name},l))})})]})]}),e.jsxs(Sn,{children:[t.description,t.category==="tasks"&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx(Vt,{className:"underline",to:"/tasks",children:e.jsx(d,{id:"notificationSettings.manageTasks",defaultMessage:"Manage tasks"})})]})]})]})}function px(t,s){const a=t.some(i=>i.channel==="email"&&i.enabled),n=t.some(i=>i.channel==="sms"&&i.enabled),o=t.some(i=>i.channel==="push"&&i.enabled);return o&&a&&n||o&&a?s.formatMessage(Qt.pushAndEmailEnabled):o&&n?s.formatMessage(Qt.pushAndSmsEnabled):a&&n?s.formatMessage(Qt.emailAndSmsEnabled):n?s.formatMessage(Qt.smsEnabled):o?s.formatMessage(Qt.pushEnabled):a?s.formatMessage(Qt.emailEnabled):s.formatMessage(Qt.notificationsOff)}function hx(t,s,a){return t.filter(n=>n.channel==="email"?s:n.channel==="sms"?a:!0)}function xx(t){const s=Ne();return je({mutationFn:async a=>(await Mu.updateSettings(a)).settings,onMutate:async a=>{en+=1;const n=en;await s.cancelQueries({queryKey:ba});const o=s.getQueryData(ba);return t(i=>{if(!i)return i;const c=a,{category:r}=c,l=Fs(c,["category"]);return i.map(u=>{if(u.category!==r)return u;const m=u.options.map(g=>{const f=l[g.channel];return typeof f=="boolean"?J(p({},g),{enabled:f}):g});return J(p({},u),{options:m})})}),{previousSettingsList:o,mutationId:n}},onError:(a,n,o)=>{o!=null&&o.previousSettingsList&&t(o.previousSettingsList)},onSuccess:(a,n,o)=>{(o==null?void 0:o.mutationId)===en&&(s.setQueryData(ba,a),t(a))}})}const Qt=ae({pushEnabled:{id:"notificationSettings.pushEnabled",defaultMessage:"Push"},emailEnabled:{id:"notificationSettings.emailEnabled",defaultMessage:"Email"},smsEnabled:{id:"notificationSettings.smsEnabled",defaultMessage:"SMS"},pushAndEmailEnabled:{id:"notificationSettings.pushAndEmailEnabled",defaultMessage:"Push, Email"},pushAndSmsEnabled:{id:"notificationSettings.pushAndSmsEnabled",defaultMessage:"Push, SMS"},emailAndSmsEnabled:{id:"notificationSettings.emailAndSmsEnabled",defaultMessage:"Email, SMS"},pushAndEmailAndSmsEnabled:{id:"notificationSettings.pushAndEmailAndSmsEnabled",defaultMessage:"Push, Email, SMS"},notificationsOff:{id:"notificationSettings.notificationsOff",defaultMessage:"Off"}});function bx(){const t=k();return e.jsx(At,{value:fe.Notifications,icon:Cu,label:t.formatMessage({id:"settingsModal.notifications",defaultMessage:"Notifications"})})}const nl=(t,s)=>{const{data:a,isLoading:n,error:o}=Ze({queryKey:["cancellationPromotion"],queryFn:async()=>ie.safeGet("/promotions/cp",{parameters:{query:{account_id:t}}}),enabled:s});return{cancellationPromoMetadata:h.useMemo(()=>{var r;return!(a!=null&&a.metadata)||a.metadata.plan_name!==yi.PLUS||((r=a.metadata.duration)==null?void 0:r.period)!=="month"?null:a.metadata},[a]),isCancelPromoLoading:n,promoError:o}};function Mx({isOpen:t,onClose:s,onClaimOfferButtonClicked:a,currentAccount:n}){const o=k(),i=ce(),r=ee(),{data:l}=vu(),c=ju(n.id),u=n.data.subscriptionStatus.planType,m=n.getLastActiveSubscription().subscription_id,g=n.data.subscriptionStatus.discount,f=Qs(u.toLowerCase()),x=Ne(),b=Ht(r,"468168202"),M=Ht(r,"3170465812"),y=n.isEligibleForCancellationPromotion(),{cancellationPromoMetadata:C,isCancelPromoLoading:_}=nl(n.id,y),v=C?M.get("promo_redemption_cta_color","secondary"):"secondary",{numPeriods:j,formattedDiscountedCost:S}=h.useMemo(()=>{var E,O;const T=n.mustGetSubscriptionBillingCurrency("GlobalSettingsModal");if(!C)return{numPeriods:0,formattedDiscountedCost:""};const P=(O=(E=C.duration)==null?void 0:E.num_periods)!=null?O:1;return p({numPeriods:P},Om(o,P,C.discount,T))},[n,C,o]),N=(g==null?void 0:g.cancellation_policy)===Dc.IMMEDIATE,w=async()=>{if(!n||!m)throw new Error("Missing current account or subscription id");await c.mutateAsync(n.id,{onError:()=>{i.danger(Fo.cancelFailure,{duration:5,toastId:"cancel_subscription_modal"}),se.logEventWithStatsig("Cancel Subscription Modal Cancel Failed","chatgpt_cancel_subscription_modal_cancel_failed")},onSuccess:async()=>{if(x.invalidateQueries(un()),i.info(o.formatMessage(Fo.cancelSuccess),{duration:5}),se.logEventWithStatsig("Cancel Subscription Modal Cancel Success","chatgpt_cancel_subscription_modal_cancel_success"),oe(r,"3376055906")){const P=new URL("https://openai.qualtrics.com/jfe/form/SV_eW3mdeRdMrpnPLw");P.searchParams.append("subscription_id",m),P.searchParams.append("plan_type",n.planType),n.authUserId?P.searchParams.append("oai_user",n.authUserId):Je.addError("authUserId missing from currentAccount"),window.open(P.toString(),"_blank")}setTimeout(()=>{s()},5e3)}})};h.useEffect(()=>{c.isSuccess&&s()},[c.isSuccess,s]),h.useEffect(()=>{se.logEventWithStatsig("Cancel Subscription Modal Shown","chatgpt_cancel_subscription_modal_shown")}),h.useEffect(()=>{C&&!_&&se.logEventWithStatsig("Cancel Subscription Modal with Cancellation Promo Shown","chatgpt_cancel_subscription_modal_with_cancellation_promo_shown",{promo_id:C.campaign_id})},[C,_]);const A=l!=null&&l.active_until?new Date(l.active_until).toLocaleDateString(o.locale,{year:"numeric",month:"short",day:"numeric"}):"";return e.jsx(xe,{testId:"modal-cancel-subscription",type:"success",isOpen:t,onClose:s,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:C?o.formatMessage({id:"cancelSubscriptionModal.promo.title",defaultMessage:"Are you sure you want to cancel?"}):g?N?o.formatMessage({id:"cancelSubscriptionModal.hasDiscount.titleImmediate",defaultMessage:"End {planName} access immediately?"},{planName:f}):o.formatMessage({id:"cancelSubscriptionModal.hasDiscount.title",defaultMessage:"End {planName} access on {expirationDate}?"},{planName:f,expirationDate:A}):o.formatMessage({id:"cancelSubscriptionModal.title",defaultMessage:"Subscription Cancellation"}),removePopoverStyling:!0,children:_?e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Oe,{})}):e.jsxs("div",{className:"p-5",children:[C?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-secondary",children:C.summary}),e.jsxs("div",{className:"mt-4 flex items-center justify-between rounded-xl border border-solid p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-token-text-primary text-base font-semibold",children:C.title})}),e.jsx("p",{className:"text-token-text-secondary mt-1 text-base",children:e.jsx(d,{id:"cancelPromoModal.regularPrice",defaultMessage:"For {discountedFormattedCost}, you'll get {planName} for {numPeriods} months.",values:{discountedFormattedCost:S,planName:f,numPeriods:j}})})]}),e.jsx("div",{children:e.jsx(Ss,{title:o.formatMessage({id:"cancelPromoModal.promo.getOffer",defaultMessage:"Get offer"}),color:v,onClick:a})})]}),e.jsx("p",{className:"text-token-text-secondary mt-8",children:N?e.jsx(d,{id:"cancelSubscriptionModal.promo.canceledSubscriptionBottomImmediate",defaultMessage:"To cancel your subscription, just confirm your choice below. Your access to {planName} features will end immediately.",values:{planName:f}}):e.jsx(d,{id:"cancelSubscriptionModal.promo.canceledSubscriptionBottom",defaultMessage:"To cancel your subscription, just confirm your choice below. Your access to {planName} features will end on {expirationDate}.",values:{planName:f,expirationDate:A}})})]}):e.jsx("p",{className:"text-token-text-secondary",children:g?N?e.jsx(d,{id:"cancelSubscriptionModal.hasDiscount.canceledSubscriptionImmediate",defaultMessage:"If you cancel your subscription now, your {planName} access will end immediately. Any discounts applied will be removed, and can't be used again.",values:{planName:f}}):e.jsx(d,{id:"cancelSubscriptionModal.hasDiscount.canceledSubscription",defaultMessage:"If you cancel your subscription now, your {planName} access will end on {expirationDate}. Any discounts applied will be removed, and can't be used again.",values:{planName:f,expirationDate:A}}):e.jsx(d,{id:"cancelSubscriptionModal.canceledSubscription",defaultMessage:"Your {planName} subscription will be canceled but will remain active until the end of your billing period on {expirationDate}.",values:{planName:f,expirationDate:A}})}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(Ss,{title:o.formatMessage({id:"cancelSubscriptionModal.goBack",defaultMessage:"Go back"}),color:b.get("cancellation_modal_go_back_button_color","secondary"),onClick:s}),e.jsx(Ss,{title:o.formatMessage({id:"cancelSubscriptionModal.cancel",defaultMessage:"Cancel subscription"}),color:b.get("cancellation_modal_cancel_button_color","danger"),onClick:()=>{se.logEventWithStatsig("Cancel Subscription Modal Confirmation Button Clicked","chatgpt_cancel_subscription_modal_confirmation_button_clicked"),w()},loading:c.isPending})]})]})})}const Fo=ae({cancelSuccess:{id:"cancelSubscriptionModal.cancelSuccess",defaultMessage:"Your subscription has been canceled."},cancelFailure:{id:"cancelSubscriptionModal.cancelFailure",defaultMessage:"Something went wrong while canceling your subscription."}});function yx({currentAccount:t}){const s=$e(),a=t.data.subscriptionStatus.planType,n=t.willRenewSubscription(),o=a===ke.PLUS?e.jsx(d,{id:"hLd2Ar",defaultMessage:"Upgrade plan"}):a===ke.PRO&&n?e.jsx(d,{id:"/4GuNx",defaultMessage:"Change plan"}):e.jsx(d,{id:"4Bc5M+",defaultMessage:"View plans"}),i=()=>{se.logEventWithStatsig("Subscription Settings Change Plan Button Clicked","chatgpt_subscription_settings_change_plan_button_clicked"),mn(s,"Subscription settings manage button")};return e.jsx(he.Item,{icon:_u,onClick:i,children:o})}function Cx({currentAccount:t,onCancelSubscriptionClick:s}){const a=ee(),n=t.willRenewSubscription(),o=t.getDaysUntilSubscriptionCancelAt(),i=t.willPlanChange(),r=Ht(a,"468168202"),l=k(),c=ce();if(!n||o!=null||i)return null;const u=r.get("should_cancel_button_take_user_to_stripe",!1);return e.jsxs(e.Fragment,{children:[e.jsx(he.Separator,{}),e.jsx(he.Item,{color:"danger",icon:Ii,onClick:async()=>{if(se.logEventWithStatsig("Subscription Settings Cancel Subscription Button Clicked","chatgpt_subscription_settings_cancel_subscription_button_clicked"),u)try{const m=await ie.safeGet("/payments/customer_portal",{intercomEventOnError:"fetch-error:customer_portal:get"});location.href=m.url}catch(m){c.warning(l.formatMessage(Ge.accountErrorWarning),{hasCloseButton:!0})}else s()},children:e.jsx(d,{id:"icBiUI",defaultMessage:"Cancel Subscription"})})]})}function vx(t,s){return t===ke.FREE||t===ke.PLUS&&s===ke.PRO||t===ke.GO&&[ke.PRO,ke.PLUS].includes(s)}function jx({currentAccount:t,onRenewSubscriptionClick:s}){const a=t.data.subscriptionStatus.planType,n=Qs(a.toLowerCase()),o=t.willRenewSubscription(),i=t.getDaysUntilSubscriptionCancelAt(),r=t.getNextPlanType();if(!(!o||i!=null||r&&vx(r,a)))return null;const c=()=>{se.logEventWithStatsig("Subscription Settings Renew Plan Button Clicked","chatgpt_subscription_settings_renew_plan_button_clicked"),s()};return e.jsx(he.Item,{icon:wu,onClick:c,children:e.jsx(d,{id:"L6UCRY",defaultMessage:"Renew {planName} Plan",values:{planName:n}})})}function Sx({currentAccount:t,onCancelSubscriptionClick:s,onRenewSubscriptionClick:a}){return e.jsxs(he.Root,{children:[e.jsx(Bc,{children:e.jsxs(W,{color:"secondary",children:[e.jsx(d,{id:"g3k4Zt",defaultMessage:"Manage"}),e.jsx(xr,{className:"ms-1 -me-1 h-4 w-4"})]})}),e.jsx(he.Portal,{children:e.jsxs(he.Content,{align:"end",size:"auto",sideOffset:2,children:[e.jsx(yx,{currentAccount:t}),e.jsx(jx,{currentAccount:t,onRenewSubscriptionClick:a}),e.jsx(Cx,{currentAccount:t,onCancelSubscriptionClick:s})]})})]})}function _x({currentAccount:t}){const s=t.subscriptionAnalyticsParams,n=t.getLastActiveSubscription().purchase_origin_platform,o=ce(),i=k(),r=async()=>{se.logEvent("Account Portal: Click Manage My Subscription",s);try{const c=await ie.safeGet("/payments/customer_portal",{intercomEventOnError:"fetch-error:customer_portal:get"});se.logEvent("Account Portal: Navigating to Account Portal",s),location.href=c.url}catch(c){o.warning(i.formatMessage(Ge.accountErrorWarning),{hasCloseButton:!0})}},l=(c,u)=>e.jsx(Vt,{to:c,target:"_blank",className:"inline-block",children:e.jsx(W,{onClick:()=>se.logEvent(u,s),color:"secondary",children:e.jsx(d,{id:"eQL80k",defaultMessage:"Manage"})})});switch(n){case ws.CHATGPT_IOS:case ws.SORA_IOS:return l(Gc,"Account Portal: Click iOS Manage Subscription");case ws.MOBILE_ANDROID:return l(Fc,"Account Portal: Click Android Manage Subscription");default:if(t.hasCustomerObject())return e.jsx(W,{onClick:r,color:"secondary",children:e.jsx(d,{id:"eQL80k",defaultMessage:"Manage"})});break}}function Go(t,s){return t==null||s==null?!1:Math.abs(t-s)<=1}function ol({title:t,subtitle:s,features:a,ctaButton:n,planChangeMessage:o,planCanceledMessage:i,scheduledCancelMessage:r,discountMessage:l,renewMessage:c,manageButton:u,paymentSection:m,showSyncedFeatures:g}){return e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"",children:t}),e.jsxs("div",{className:"text-token-text-secondary",children:[o,l,c,i]})]}),n||u]}),r&&e.jsx("div",{className:"mt-3 rounded-md border border-yellow-200 bg-yellow-50 px-3 py-2 text-sm text-yellow-800 dark:border-yellow-800 dark:bg-yellow-950 dark:text-yellow-200",children:r}),e.jsxs("div",{className:ht("mt-2 rounded-lg bg-gray-50 p-4 dark:bg-gray-900",g&&"bg-transparent px-0 dark:bg-transparent"),children:[e.jsx("span",{className:ht("text-sm font-semibold",g&&"inline-block pb-4"),children:s}),g?e.jsx(nr,{advertisedFeatures:a,pricingModalColumnType:Ga.standard,isWebRedesign:!0,isTeamColumn:!1}):a==null?void 0:a.map((f,x)=>e.jsxs("div",{className:"mt-2 flex justify-start gap-1 text-xs",children:[e.jsx(Rc,{className:"icon-xs mt-0.5"}),e.jsx("span",{children:e.jsx(d,J(p({},f.label),{values:{link:b=>{var M;return e.jsx(Vt,{className:"underline",target:"_blank",rel:"noreferrer",to:(M=f.label.link)!=null?M:"",children:b})},article:b=>{var M;return e.jsx(Vt,{className:"underline",target:"_blank",rel:"noreferrer",to:(M=f.label.article)!=null?M:"",children:b})},modelName:"GPT‑4o"}}))})]},x))]})]}),m]})}function wx(){h.useEffect(()=>{se.logEventWithStatsig("Subscription Settings Shown: Free","chatgpt_subscription_settings_shown_free")},[]);const t=ee(),s=rn(),a=rn({isWebRedesign:!0}),n=Sa({isWebRedesign:!0}),o=$e(),i=Oc(t),r=Ht(t,"313799188").get("sync_advertised_features",!1),l=i?s.advertisedFeatures:Su(),c=i?a.advertisedFeatures:n.advertisedFeatures;return e.jsx(ol,{title:e.jsx(d,J(p({},Ge.upgradeFromFreeTitle),{values:{planName:i?"Go":"Plus"}})),subtitle:e.jsx(d,p({},Ge.upgradeFromFreeDescription)),features:r?c:l,showSyncedFeatures:r,ctaButton:e.jsx(W,{onClick:()=>{se.logEventWithStatsig("Subscription Settings Free to Plus Upgrade Button Clicked","chatgpt_subscription_settings_free_to_plus_upgrade_button_clicked"),mn(o,"Subscription settings manage button Free to Plus")},color:"primary",children:e.jsx(d,p({},Ge.upgradeButton))})})}function tn({currentAccount:t,onCancelSubscriptionClick:s,onRenewSubscriptionClick:a,pricingPlan:n,showSyncedFeatures:o}){var E,O,D,I,H,$,X,q,G,F,R;h.useEffect(()=>{se.logEventWithStatsig("Subscription Settings Shown","chatgpt_subscription_settings_shown")},[]);const i=k(),r=t.planType,l=t.willRenewSubscription(),c=t.willPlanChange(),u=t.getDaysUntilSubscriptionCancelAt(),m=t.getDaysUntilPlanChanges(),g=t.getDaysUntilPlanRenews(),f=t.getDaysUntilPlanDiscountExpires(),x=t.getNextPlanType(),b=t.data.subscriptionStatus.discount,M=(O=(E=t.data.subscriptionStatus.discount)==null?void 0:E.discount_start_in_num_periods)!=null?O:0,y=Qs(r.toLowerCase()),C=x?Qs(x.toLowerCase()):null,{advertisedFeatures:_}=n,{costTitle:v,currencySymbol:j}=sr(n,(D=t.data.subscriptionStatus.billingCurrency)!=null?D:"USD"),S=c&&m&&C?e.jsx("span",{children:e.jsx(d,J(p({},Ge.planChangeMessage),{values:{planName:C,date:Yt(m,i)}}))}):null,N=l&&!c&&b&&M>0?((I=t.data.subscriptionStatus.discount)==null?void 0:I.discount_type)===io.PERCENTAGE?e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountPercentFutureMessage),{values:{discountPercent:t.data.subscriptionStatus.discount.amount,planName:y,numPeriods:M}}))}):j.sign.defaultMessage&&e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountFixedFutureMessage),{values:{discountFixed:(H=t.data.subscriptionStatus.discount)==null?void 0:H.amount,planName:y,numPeriods:M,currencySymbol:j.sign.defaultMessage.toString()}}))}):l&&!c&&g&&b&&((($=t.data.subscriptionStatus.discount)==null?void 0:$.discount_type)===io.PERCENTAGE?Go(f,g)&&(v!=null&&v.defaultMessage)&&((X=j==null?void 0:j.sign)!=null&&X.defaultMessage)?e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountPercentMessageWithNewPrice),{values:{discountPercent:t.data.subscriptionStatus.discount.amount,planName:y,date:Yt(g,i),newPrice:v.defaultMessage.toString(),currencySymbol:j.sign.defaultMessage.toString()}}))}):e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountPercentMessage),{values:{discountPercent:t.data.subscriptionStatus.discount.amount,planName:y,date:Yt(g,i)}}))}):Go(f,g)&&(v!=null&&v.defaultMessage)&&((q=j==null?void 0:j.sign)!=null&&q.defaultMessage)?e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountFixedMessageWithNewPrice),{values:{discountFixed:(G=t.data.subscriptionStatus.discount)==null?void 0:G.amount,planName:y,date:Yt(g,i),newPrice:v.defaultMessage.toString(),currencySymbol:j.sign.defaultMessage.toString()}}))}):((F=j==null?void 0:j.sign)==null?void 0:F.defaultMessage)&&e.jsx("span",{children:e.jsx(d,J(p({},Ge.discountFixedMessage),{values:{discountFixed:(R=t.data.subscriptionStatus.discount)==null?void 0:R.amount,planName:y,date:Yt(g,i),currencySymbol:j.sign.defaultMessage.toString()}}))})),w=l&&!c&&g&&!b?e.jsx("span",{children:e.jsx(d,J(p({},Ge.renewMessage),{values:{date:Yt(g,i)}}))}):null,A=!l&&!c&&g?e.jsx("span",{children:e.jsx(d,J(p({},Ge.planCanceledMessage),{values:{date:Yt(g,i)}}))}):null,T=u&&u!==g?e.jsx("span",{children:e.jsx(d,J(p({},Ge.scheduledCancelMessage),{values:{date:Yt(u,i)}}))}):null,P=e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(d,J(p({},Ge.managePaymentTitle),{values:{planName:y}})),e.jsx(Vt,{target:"_blank",to:Lc,onClick:Im,className:"text-token-link text-xs",children:e.jsx(d,p({},Ge.billingHelp))},"row-plus-plan-help-link")]}),e.jsx(_x,{currentAccount:t})]})});return e.jsx(ol,{title:e.jsx(d,J(p({},Ge.subscriptionTitle),{values:{planName:y}})),subtitle:e.jsx(d,J(p({},Ge.thanksMessage),{values:{planName:y}})),features:_!=null?_:[],manageButton:e.jsx(Sx,{currentAccount:t,onCancelSubscriptionClick:s,onRenewSubscriptionClick:a}),planChangeMessage:S,discountMessage:N,renewMessage:w,planCanceledMessage:A,scheduledCancelMessage:T,paymentSection:P,showSyncedFeatures:o})}function Yt(t,s){const a=Ic(new Date,t);return new Intl.DateTimeFormat(s.locale,{year:"numeric",month:"short",day:"numeric"}).format(a)}const Ge=ae({subscriptionTitle:{id:"settingsModal.subscriptionTitle",defaultMessage:"ChatGPT {planName}"},managePaymentTitle:{id:"settingsModal.managePaymentTitle",defaultMessage:"Payment"},billingHelp:{id:"settingsModal.billingHelp",defaultMessage:"Need help with billing?"},accountErrorWarning:{id:"settingsModal.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},planChangeMessage:{id:"settingsModal.planChangeMessage",defaultMessage:"Your plan changes to {planName} on {date}"},planCanceledMessage:{id:"settingsModal.planCanceledMessage",defaultMessage:"Your plan will be canceled on {date}"},scheduledCancelMessage:{id:"settingsModal.scheduledCancelMessage",defaultMessage:"Your paid plan will downgrade to ChatGPT free on {date}"},renewMessage:{id:"settingsModal.renewMessage",defaultMessage:"Your plan auto-renews on {date}"},discountPercentMessage:{id:"settingsModal.discountPercentMessage",defaultMessage:"You've got {discountPercent}% off {planName}. Your discounted plan renews on {date}."},discountPercentMessageWithNewPrice:{id:"settingsModal.discountPercentMessageWithNewPrice",defaultMessage:"You've got {discountPercent}% off {planName}. Your plan renews (at {currencySymbol}{newPrice}/month) on {date}."},discountFixedMessage:{id:"settingsModal.discountFixedMessage",defaultMessage:"You've got {currencySymbol}{discountFixed} off {planName}. Your discounted plan renews on {date}."},discountFixedMessageWithNewPrice:{id:"settingsModal.discountFixedMessageWithNewPrice",defaultMessage:"You've got {currencySymbol}{discountFixed} off {planName}. Your plan renews (at {currencySymbol}{newPrice}/month) on {date}."},discountPercentFutureMessage:{id:"settingsModal.discountPercentFutureMessage",defaultMessage:"Your {discountPercent}% off {planName} discount will apply in {numPeriods, plural, one {the next billing period} other {# billing periods}}."},discountFixedFutureMessage:{id:"settingsModal.discountFixedFutureMessage",defaultMessage:"Your {currencySymbol}{discountFixed} off {planName} discount will apply in {numPeriods, plural, one {the next billing period} other {# billing periods}}."},thanksMessage:{id:"settingsModal.thanksMessage",defaultMessage:"Thanks for subscribing to ChatGPT {planName}! Your {planName} plan includes:"},paymentMethodMessage:{id:"settingsModal.paymentMethodMessage",defaultMessage:"Payment method"},upgradeFromFreeTitle:{id:"settingsModal.upgradeFromFreeTitle",defaultMessage:"Get ChatGPT {planName}"},upgradeFromFreeDescription:{id:"settingsModal.upgradeFromFreeDescription",defaultMessage:"Get everything in Free, and more."},upgradeButton:{id:"settingsModal.upgradeButton",defaultMessage:"Upgrade"}});function Nx({onClose:t,onBackButtonClicked:s,account:a}){const n=k(),o=ce(),[i,r]=h.useState(!1);h.useEffect(()=>{se.logEventWithStatsig("Claim Subscription Cancellation Promotion Modal Shown","chatgpt_claim_subscription_cancellation_promotion_modal_shown")},[]);const l=()=>{se.logEventWithStatsig("Claim Subscription Cancellation Promotion Modal Close","chatgpt_claim_subscription_cancellation_promotion_modal_close"),t()},c=()=>{se.logEventWithStatsig("Claim Subscription Cancellation Promotion Modal Back Button Clicked","chatgpt_claim_subscription_cancellation_promotion_modal_back_button_clicked"),s()},u=Nu(a.id),{cancellationPromoMetadata:m,isCancelPromoLoading:g}=nl(a.id,a.isEligibleForCancellationPromotion()),{data:f,isError:x,isLoading:b}=ku(a.id,void 0,void 0,m==null?void 0:m.campaign_id);x&&(o.warning(n.formatMessage({id:"cancelPromoClaimModal.errorFetchingPreview",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),t());const M=Ne(),y=async S=>{var N;se.logEventWithStatsig("Claim Subscription Cancellation Promotion Pay Now Button Clicked","chatgpt_claim_subscription_cancellation_promotion_modal_pay_now_button_clicked"),r(!0);try{await u.mutateAsync({accountId:a.id,updatedPromoId:S.campaign_id}),o.success(n.formatMessage({id:"cancelPromoClaimModal.successfullyClaimedPromotion",defaultMessage:"You've successfully claimed your promotion"}),{hasCloseButton:!0}),se.logEventWithStatsig("Claim Subscription Cancellation Promotion Success","chatgpt_claim_subscription_cancellation_promotion_success",{promo_id:S.campaign_id}),M.invalidateQueries(un()),M.invalidateQueries({queryKey:["cancellationPromotion"]}),t()}catch(w){se.logEventWithStatsig("Claim Subscription Cancellation Promotion Error","chatgpt_claim_subscription_cancellation_promotion_error",{promo_id:S.campaign_id}),((N=w==null?void 0:w.detail)==null?void 0:N.error_type)==="card_declined"?o.warning(n.formatMessage({id:"cancelPromoClaimModal.cardDeclinedError",defaultMessage:"Payment error. Your card may be invalid or authentication may be needed."}),{hasCloseButton:!0}):o.warning(n.formatMessage({id:"cancelPromoClaimModal.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),Je.addError(w),t()}finally{r(!1)}},{goCost:C,plusCost:_,proCost:v,currencySymbol:j}=Rm(a.mustGetSubscriptionBillingCurrency("GlobalSettingsModal"));return e.jsx(xe,{testId:"modal-subscription-claim-cancel-promo",type:"success",isOpen:!0,onClose:l,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:n.formatMessage({id:"cancelPromoClaimModal.title",defaultMessage:"Confirm changes"}),removePopoverStyling:!0,children:b||g?e.jsx(kx,{}):m!=null&&m.campaign_id&&f?e.jsx(Px,{account:a,promoData:m,previewData:f,plusCost:_,goCost:C,proCost:v,currencySymbol:j,onBack:c,handleUpdate:()=>y(m),isUpdating:i}):null})}function kx(){return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Oe,{})})}function Tx({subscriptionPreviewdata:t,promoData:s,intl:a,planName:n,currencySymbol:o}){var r,l;const i=(l=(r=s.duration)==null?void 0:r.num_periods)!=null?l:1;return[{adjustmentMessage:e.jsx(d,{id:"cancelPromoClaimModal.adjustment",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(d,{id:"cancelPromoClaimModal.proratedCredit",defaultMessage:"-{currencySign}{adjustment}",values:{currencySign:a.formatMessage(o.sign),adjustment:(-t.negative_line_item_total/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(d,{id:"cancelPromoClaimModal.proratedCreditInfo",defaultMessage:"Prorated credit for the remainder of your {planName} subscription",values:{planName:n}}),value:t.negative_line_item_total},{adjustmentMessage:e.jsx(d,{id:"cancelPromoClaimModal.discount",defaultMessage:"Discount"}),proratedCreditMessage:e.jsx(d,{id:"cancelPromoClaimModal.discountAmount",defaultMessage:"-{currencySign}{discount}",values:{currencySign:a.formatMessage(o.sign),discount:(-t.discount_amount/100).toFixed(2)}}),proratedCreditInfoMessage:"percentage"in s.discount?e.jsx(d,{id:"cancelPromoClaimModal.percentageDiscountInfo",defaultMessage:"{discountPercentage}% off for {numPeriods, plural, one {1 month} other {{numPeriods} months}}",values:{discountPercentage:s.discount.percentage,numPeriods:i}}):e.jsx(d,{id:"cancelPromoClaimModal.valueDiscountInfo",defaultMessage:"{valueOff} off for {numPeriods, plural, one {1 month} other {{numPeriods} months}}",values:{valueOff:a.formatNumber(s.discount.value,{style:"currency",currency:s.discount.currency_code,minimumFractionDigits:0,maximumFractionDigits:2}),numPeriods:i}}),value:t.discount_amount}]}function Ex({subscriptionPreviewData:t,promoData:s,planName:a,planCost:n,currencySymbol:o}){var l,c;const i=k(),r=(c=(l=s.duration)==null?void 0:l.num_periods)!=null?c:1;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(d,{id:"cancelPromoClaimModal.subscription",defaultMessage:"ChatGPT {planName} for {numPeriods, plural, one {1 month} other {{numPeriods} months}}",values:{planName:a,numPeriods:r}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(d,{id:"cancelPromoClaimModal.subscriptionCost",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:i.formatMessage(o.sign),totalCost:(t.positive_line_item_total_excluding_tax/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(d,{id:"cancelPromoClaimModal.billingCycle",defaultMessage:"One-time payment, then {currencySign}{planCost}/month after {numPeriods, plural, one {1 month} other {{numPeriods} months}}",values:{currencySign:i.formatMessage(o.sign),planCost:i.formatMessage(n),numPeriods:r}})})]})}function Px({account:t,promoData:s,previewData:a,plusCost:n,goCost:o,proCost:i,currencySymbol:r,onBack:l,handleUpdate:c,isUpdating:u}){const m=k(),g=t.data.subscriptionStatus.planType,f=Qs(g.toLowerCase()),x=g===ke.PRO?i:g===ke.GO?o:n,b=Tx({subscriptionPreviewdata:a,promoData:s,intl:m,planName:f,currencySymbol:r});return e.jsxs("div",{className:"p-6",children:[e.jsx(Ex,{subscriptionPreviewData:a,promoData:s,planName:f,planCost:x,currencySymbol:r}),b.filter(M=>M.value!==0).map((M,y)=>e.jsx(Bm,{adjustmentMessage:M.adjustmentMessage,proratedCreditMessage:M.proratedCreditMessage,proratedCreditInfoMessage:M.proratedCreditInfoMessage},y)),e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(Fm,{data:a,currencySymbol:r}),a.default_payment_method&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(Gm,{defaultPaymentMethod:a.default_payment_method})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(Ss,{title:m.formatMessage({id:"cancelPromoClaimModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:l}),e.jsx(Ss,{title:m.formatMessage({id:"cancelPromoClaimModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:c,loading:u})]})]})}function Ax(){const t=Lr();return h.useCallback(async()=>{try{await dr(t.billingDetails,t.plusAnalyticsParams)}catch(s){}},[t])}function Dx({eligibleProgramName:t}){const{data:s}=Ze({queryKey:["referrals-enrollment-details"],queryFn:()=>ss.getEnrollmentDetails()}),a=s==null?void 0:s.enrollment_details;return a?e.jsx(Lx,{enrollmentDetails:a}):e.jsx(Ox,{eligibleProgramName:t})}function Lx({enrollmentDetails:t}){const s=ee(),a=gs(s),n=k(),o=ce(),i=Ax(),r=a==null?void 0:a.hasPaidSubscription(),l=nn(t.referral_code),{discount:c}=t.referral_metadata,u=En(n,c.value||0,c.currency_code),m=t.earned_amount.split(".")[0],g=t.remaining_amount.split(".")[0];return e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(d,{id:"OR4iav",defaultMessage:"Referrals"}),e.jsxs("div",{className:"flex h-8 items-center gap-2",children:[e.jsx("button",{onClick:()=>{kn(l,o).then(()=>{o.success(n.formatMessage({id:"1TiBkD",defaultMessage:"Copied referral link to clipboard"}))})},children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"text-sm",children:l}),e.jsx(Tu,{className:"icon-sm"})]})}),!r&&t.is_eligible_to_redeem?e.jsx("div",{className:"ms-1 flex flex-1 justify-end",children:e.jsx(W,{color:"secondary",onClick:i,children:e.jsx(d,{id:"u1eO00",defaultMessage:"Get free Plus"})})}):null]})]}),e.jsxs("div",{className:"border-token-border-default my-4 flex rounded-md border bg-gray-50 px-3 py-4 dark:bg-gray-900",children:[e.jsx(sn,{className:"border-token-border-default flex-1 border-e",info:t.num_referred,label:e.jsx(d,{id:"i/bF9u",defaultMessage:"Friends referred"})}),e.jsx(sn,{className:"flex-1",info:m,label:e.jsx(d,{id:"iA319g",defaultMessage:"Earned"})}),e.jsx(sn,{className:"border-token-border-default flex-1 border-s",info:g,label:e.jsx(d,{id:"wY0EA3",defaultMessage:"Remaining"})})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(d,J(p({},us.referralLinkModalDisclaimer),{values:{discount:u}}))})]})}function sn({className:t,info:s,label:a}){return e.jsxs("div",{className:ht("flex flex-col items-center gap-0.5",t),children:[e.jsx("div",{className:"text-base font-normal",children:s}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:a})]})}function Ox({eligibleProgramName:t}){const s=k(),a=$e();return t?e.jsx(K,{children:e.jsx(Xe,{label:s.formatMessage({id:"OR4iav",defaultMessage:"Referrals"}),buttonLabel:s.formatMessage({id:"LZKJO9",defaultMessage:"Get my referral link"}),onClick:()=>{a(Eu(t))}})}):null}function Ix(){const t=ee(),s=oe(t,"550432558"),{data:a}=Ze({queryKey:["is-eligible-for-referrals"],queryFn:()=>ss.getIsEligibleForReferrals(),enabled:s}),n=s?a==null?void 0:a.eligible_program_name:null;return n?e.jsx(Dx,{eligibleProgramName:n}):null}function Rx(){return new URL(window.location.href).searchParams.get("disable_mfa")!=null}function Bx({onClose:t,onConfirm:s}){const a=k();return e.jsx(Pu,{isOpen:!0,title:a.formatMessage(Uo.disableConfimationTitle),confirmText:a.formatMessage(Uo.disable),onConfirm:s,onClose:t,primaryButtonColor:"danger",children:e.jsx("div",{children:e.jsx(d,{id:"postSigninDisableConfimationModal.description.1",defaultMessage:"Are you sure you want to disable multi-factor authentication? You will no longer need to provide a verification code when you log into your account."})})})}const Uo=ae({disableConfimationTitle:{id:"mfaDisableConfirmationModal.title.0",defaultMessage:"Disable multi-factor authentication (MFA)"},disable:{id:"mfaDisableConfirmationModal.button",defaultMessage:"Disable MFA"}});function Fx(){const[t,s]=Uc(),a=k();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx(d,p({},xa.theme))}),e.jsx(gr,{value:t,onValueChange:s,options:[{label:a.formatMessage(xa.system),value:"system"},{label:a.formatMessage(xa.dark),value:"dark"},{label:a.formatMessage(xa.light),value:"light"}]})]})}const xa=ae({theme:{id:"settingsModal.theme",defaultMessage:"Theme"},system:{id:"settingsModal.system",defaultMessage:"System"},dark:{id:"settingsModal.dark",defaultMessage:"Dark"},light:{id:"settingsModal.light",defaultMessage:"Light"}});async function Gx(){var a;let t;"keyboard"in navigator&&(t=navigator.keyboard);const s=(a=await(t==null?void 0:t.getLayoutMap()))!=null?a:new Map;return t!=null&&t.lock&&await(t==null?void 0:t.lock()),new Promise(n=>{const o=new Set,i=new Set;let r=!0;const l=x=>{const b=Wo(x,s);b&&!o.has(b)&&(o.add(b),i.add(b))},c=x=>{const b=Wo(x,s);b&&o.delete(b),o.size===0&&r&&g()},u=x=>{r&&(m(),n(void 0))},m=()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",u),window.removeEventListener("click",u),window.removeEventListener("blur",u),clearTimeout(f),t!=null&&t.unlock&&(t==null||t.unlock()),r=!1},g=()=>{m();const x=Ux(Array.from(i));n(il({webKeys:x}))};window.addEventListener("keydown",l),window.addEventListener("keyup",c),window.addEventListener("mousedown",u),window.addEventListener("click",u),window.addEventListener("blur",u);const f=setTimeout(()=>{r&&(m(),n(void 0))},1e4)})}function Ux(t){return t.toSorted((s,a)=>{const n=Object.values(Ta).indexOf(s),o=n===-1?Number.MAX_SAFE_INTEGER:n,i=Object.values(Ta).indexOf(a),r=i===-1?Number.MAX_SAFE_INTEGER:i;return o===r?s.charCodeAt(0)-a.charCodeAt(0):o-r})}const Wx=t=>/^[a-zA-Z]$/.test(t);function Wo(t,s){var o;const a=(o=s.get(t.code))!=null?o:t.key;let n;return z[t.key]?n=z[t.key]:Wx(a)?n=a.toUpperCase():n=a,n}function il(t){return t.webKeys?(t.electronAcceleratorKeys=t.webKeys.map(zx),t.electronAcceleratorString=Ho(t.electronAcceleratorKeys)):t.electronAcceleratorKeys?(t.webKeys=t.electronAcceleratorKeys.map(Hx),t.electronAcceleratorString=Ho(t.electronAcceleratorKeys)):t={webKeys:[],electronAcceleratorKeys:[],electronAcceleratorString:void 0},t}function Hx(t){var s;return(s=Ta[t])!=null?s:t}function zx(t){var s;return(s=Kx[t])!=null?s:t}function rl(t){const s=new Set(Object.keys(ll)),a=t.filter(o=>!s.has(o)).length,n=t.length-a;return a===1&&n>0}const Vx=t=>{const s=t.split("+");return rl(s)?s:void 0},Ho=t=>rl(t)?t.join("+"):void 0,ll={Meta:z.Meta,CmdOrCtrl:z.Mod,CommandOrControl:z.Mod,Ctrl:z.Control,Control:z.Control,Cmd:z.Mod,Command:z.Mod,Alt:z.Alt,Option:z.Alt,AltGr:z.AltGraph,Shift:z.Shift,Super:z.Super},Ta=J(p({},ll),{Capslock:z.CapsLock,Space:z.Space,Tab:z.Tab,Numlock:z.NumLock,Scrolllock:z.ScrollLock,Backspace:z.Backspace,Delete:z.Delete,Insert:z.Insert,Return:z.Enter,Enter:z.Enter,Home:z.Home,End:z.End,PageUp:z.PageUp,PageDown:z.PageDown,Up:z.ArrowUp,Down:z.ArrowDown,Left:z.ArrowLeft,Right:z.ArrowRight,Esc:z.Escape,Escape:z.Escape,VolumeUp:z.AudioVolumeUp,VolumeDown:z.AudioVolumeDown,VolumeMute:z.AudioVolumeMute,MediaNextTrack:z.MediaTrackNext,MediaPreviousTrack:z.MediaTrackPrevious,MediaStop:z.MediaStop,MediaPlayPause:z.MediaPlayPause,PrintScreen:z.PrintScreen,numadd:z.Add,numsub:z.Subtract,nummult:z.Multiply,numdiv:z.Divide,numdec:z.Decimal,F1:z.F1,F2:z.F2,F3:z.F3,F4:z.F4,F5:z.F5,F6:z.F6,F7:z.F7,F8:z.F8,F9:z.F9,F10:z.F10,F11:z.F11,F12:z.F12,F13:z.F13,F14:z.F14,F15:z.F15,F16:z.F16,F17:z.F17,F18:z.F18,F19:z.F19,F20:z.F20}),Kx=Object.fromEntries(Object.entries(Ta).map(([t,s])=>[s,t]));async function qx(){var t;await((t=Ns)==null?void 0:t.checkForUpdates())}function $x(){var a;const[t,s]=h.useState(!1);return e.jsx(e.Fragment,{children:e.jsx(K,{children:e.jsx(Xe,{label:e.jsx(d,p({},ft.updatesSettingLabel)),disabled:t,buttonLabel:t?e.jsx(d,p({},ft.updateInProgressButtonLabel)):e.jsx(d,p({},ft.updateButtonLabel)),onClick:async()=>{try{s(!0),await qx()}catch(n){Je.addError(new Error("Sidetron Settings: Error checking for updates"),{cause:n})}finally{s(!1)}},description:e.jsx(d,J(p({},ft.updateSettingDescription),{values:{version:(a=Wc(Kc()))!=null?a:"Unknown"}}))})})})}const Qx=async()=>{var n;let t="";const s=await((n=Ns)==null?void 0:n.getSettingValue("companionWindowShortcut"));typeof s=="string"?t=s:Je.addError(new Error("Sidetron Settings: No companion chat hotkey found over IPC"));const a=Vx(t);return Promise.resolve(il({electronAcceleratorKeys:a}))};function Yx(){const[t,s]=h.useState(!1),[a,n]=h.useState(void 0);return h.useEffect(()=>{(async()=>{const i=await Qx();n(i)})()},[]),h.useEffect(()=>{var o;(o=Ns)==null||o.publish(ro.HOTKEY_RECORDING_STATE,{inProgress:t})},[t]),e.jsx(e.Fragment,{children:e.jsx(K,{children:e.jsx(Xe,{label:e.jsx(d,p({},ft.companionChatHotkeyLabel)),disabled:a===void 0||t,buttonLabel:t?e.jsx(d,p({},ft.companionChatHotkeyRecordingLabel)):a?e.jsx(Au,{binding:a.webKeys,className:"text-xs"}):e.jsx(d,p({},ft.companionChatHotkeyLoadingLabel)),onClick:async()=>{s(!0);const o=await Gx();o?o.electronAcceleratorString?(n(o),Ns&&(Ns.publish(ro.DESKTOP_SETTING_CHANGED,{setting:"companionWindowShortcut",value:o.electronAcceleratorString}),Je.addAction("Sidetron Settings: User recorded a new hotkey: ".concat(o.electronAcceleratorString)))):Je.addError(new Error("Sidetron Settings: Invalid companion chat hotkey registered: ".concat(o))):Je.addAction("Sidetron Settings: User did not record a hotkey"),s(!1)}})})})}function Zx(){return e.jsx(e.Fragment,{children:e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx(d,p({},ft.textSizeLabel))}),e.jsxs("div",{className:"flex shrink-0 gap-2",children:[e.jsx(W,{color:"secondary",onClick:Hc,"data-testid":"text-size-decrease",icon:Du,className:"aspect-square p-0"}),e.jsx(W,{color:"secondary",onClick:zc,"data-testid":"text-size-increase",icon:Pn,className:"aspect-square p-0"}),e.jsx(W,{color:"secondary",onClick:Vc,"data-testid":"text-size-reset",children:e.jsx(d,p({},ft.textSizeResetButtonLabel))})]})]})})})}function Xx({href:t,label:s,stateLabel:a,testId:n}){return e.jsx("a",{className:"w-full","data-testid":n,href:t,target:"_blank",rel:"noreferrer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:s}),e.jsxs("div",{className:"me-3 -mb-1 flex items-center",children:[a&&e.jsx("div",{className:"me-2 -mt-0.5",children:a}),e.jsx(As,{className:"icon-sm"})]})]})})}function Jx(){const[t,s]=h.useState(!1),a=k(),n=async()=>{var i;const o=await((i=Ns)==null?void 0:i.getSettingValue("autoLaunch"));s(!!o)};return h.useEffect(()=>{n();const o=()=>{n()};return window.addEventListener("focus",o),()=>{window.removeEventListener("focus",o)}},[]),e.jsx(e.Fragment,{children:e.jsx(K,{children:e.jsx(Xx,{href:"ms-settings:startupapps",label:e.jsx(d,p({},ft.autoLaunchLabel)),stateLabel:t?a.formatMessage(ft.autoLaunchOnLabel):a.formatMessage(ft.autoLaunchOffLabel)})})})}const ft=ae({autoLaunchLabel:{id:"desktopAppSettingsModal.autoLaunchLabel",defaultMessage:"Launch at Login"},autoLaunchOnLabel:{id:"desktopAppSettingsModal.autoLaunchOnLabel",defaultMessage:"On"},autoLaunchOffLabel:{id:"desktopAppSettingsModal.autoLaunchOffLabel",defaultMessage:"Off"},updatesSettingLabel:{id:"desktopAppSettingsModal.updatesSettingLabel",defaultMessage:"App updates"},updateButtonLabel:{id:"desktopAppSettingsModal.updateButtonLabel",defaultMessage:"Check for updates"},updateInProgressButtonLabel:{id:"desktopAppSettingsModal.updateInProgressButtonLabel",defaultMessage:"Checking for updates..."},updateSettingDescription:{id:"desktopAppSettingsModal.updateSettingDescription",defaultMessage:"Current version: {version}"},companionChatHotkeyLabel:{id:"desktopAppSettingsModal.companionChatHotkeyLabel",defaultMessage:"Companion window hotkey"},companionChatHotkeyLoadingLabel:{id:"desktopAppSettingsModal.companionChatHotkeyLoadingLabel",defaultMessage:"Loading..."},companionChatHotkeyRecordingLabel:{id:"desktopAppSettingsModal.companionChatHotkeyRecordingLabel",defaultMessage:"Recording..."},textSizeLabel:{id:"desktopAppSettingsModal.textSizeLabel",defaultMessage:"Text size"},textSizeResetButtonLabel:{id:"desktopAppSettingsModal.textSizeResetButtonLabel",defaultMessage:"Reset"}});function eb({enabled:t=!1}={}){return Ze({queryKey:["mfaPushAuthDevices"],queryFn:()=>ie.safeGet("/accounts/mfa_push_auth_devices"),enabled:t})}const tb=()=>{const{openSettings:t}=ms();return e.jsx("button",{onClick:()=>t(fe.Account),children:e.jsx(br,{className:"icon-sm"})})};function sb({gizmoId:t,gizmoName:s,gizmoAvatar:a,canEdit:n,socials:o}){const{data:i,isLoading:r}=_n();return r?null:i?e.jsxs(e.Fragment,{children:[n&&t&&e.jsx("span",{className:"absolute end-2 top-2",children:e.jsx(tb,{})}),e.jsx(Lu,{src:a,isFirstParty:!1,className:"h-8 w-8"}),e.jsx("div",{className:"text-token-text-primary mt-1 text-center text-sm font-semibold",children:s}),e.jsx(Ou,{builderName:i.display_name,builderUrl:i.website_url,socials:o,className:"text-xs"})]}):e.jsx(ta,{type:"info",children:e.jsx(d,{id:"gizmo.builderProfile.unableToLoadProfile",defaultMessage:"Unable to load your builder profile"})})}function ab(){const t=k(),{data:s,isLoading:a}=_n(),n=ee(),o=gs(n);return e.jsx(Me,{title:t.formatMessage(qe.gizmoTab),children:a?e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})}):s===void 0||o==null?e.jsx(ta,{type:"info",children:e.jsx(d,p({},qe.noCreatorProfile))}):e.jsx(ib,{data:s})})}function nb({gizmoName:t,canEdit:s,gizmoAvatar:a}){const n=k(),{openSettings:o}=ms(),{data:i}=_n();return i?e.jsxs("div",{className:"bg-token-main-surface-primary relative flex w-full flex-col items-center justify-stretch rounded-lg p-4",children:[e.jsx(sb,{gizmoAvatar:a,gizmoName:t!=null?t:n.formatMessage(qe.placeholderGPT),canEdit:s,socials:[i.socials.linkedin,i.socials.github]}),e.jsx("div",{className:"text-token-text-tertiary absolute end-4 top-3 text-xs",children:s?e.jsx("button",{onClick:()=>{o(fe.Account)},children:e.jsx(br,{className:"icon-sm"})}):e.jsx(d,p({},qe.preview))})]}):null}function ob(t,s){if(t.website_url&&s.length>0){const a=s.find(n=>n.url===t.website_url);return a?a.hostname:s[0].hostname}else{if(s.length>0)return s[0].hostname;if(t.website_url)return}}function ib({data:t}){const s=k(),a=qc(),n=ee(),o=gs(n),i=o==null?void 0:o.isEnterprisey(),r=o==null?void 0:o.isWorkspaceAccount(),l=bt(),c=t.domains.reduce((x,b)=>b.status==="verified"?[...x,{id:b.id,hostname:b.hostname,url:b.hostname}]:x,[]),u=ob(t,c),m=oe(n,"2256850471"),g=t.name==null||a.isPending,f=e.jsx(Ai,{size:"small",onCheckedChange:x=>{a.mutateAsync({hideName:!x})},disabled:g,checked:!t.hide_name,"aria-label":t.hide_name?s.formatMessage(qe.showNameToggle):s.formatMessage(qe.hideNameToggle)});return e.jsxs("div",{className:"flex flex-col items-stretch pt-3",children:[e.jsx("div",{className:"mb-2",children:e.jsx(d,p({},qe.creatorProfileDescription))}),e.jsx(nb,{canEdit:!1}),e.jsx(K,{children:e.jsxs("div",{className:"flex flex-col",children:[!t.is_verified&&e.jsxs(ta,{type:"info",children:[e.jsx("div",{children:e.jsx(d,p({},qe.creatorProfileUnverifiedDisclaimer))}),e.jsx("div",{children:r?e.jsx(d,p({},qe.creatorProfileBusinessUnverifiedDisclaimer)):e.jsx(d,p({},qe.creatorProfilePersonalUnverifiedDisclaimer))})]}),t.name&&e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("b",{children:e.jsx(d,p({},qe.creatorProfileNameLabel))}),g?e.jsx(tt,{side:"left",label:s.formatMessage(qe.linkDisabledTooltip),children:f}):f]}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx("span",{children:t.name}),e.jsx(tt,{side:"top",className:"ms-auto",label:s.formatMessage(qe.nameSourceReason),children:e.jsx(gn,{className:"icon-sm text-token-text-tertiary"})})]})]}),!i&&e.jsxs("div",{className:"flex flex-col justify-center gap-2",children:[e.jsx("hr",{className:"border-token-border-default my-3"}),e.jsx("div",{className:"flex flex-row justify-between",children:e.jsx("b",{children:e.jsx(d,p({},qe.creatorProfileLinkHeader))})}),e.jsxs("div",{className:"flex flex-row items-center justify-between space-x-2",children:[e.jsx(Iu,{className:"icon-sm"}),e.jsx("div",{children:e.jsx(Ru,{selectedDomain:u,domains:t.domains,verifiedDomains:c,onChangeDomain:x=>{a.mutateAsync({websiteUrl:x})}})})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx(po,{socialData:t.socials.linkedin,icon:Bu}),e.jsx(po,{socialData:t.socials.github,icon:Fu})]})]}),!i&&l&&l.email&&e.jsxs("div",{className:"flex flex-col justify-center gap-2",children:[e.jsx("hr",{className:"border-token-border-default my-3"}),e.jsx("div",{className:"flex flex-row justify-between",children:e.jsx("b",{children:e.jsx(d,p({},qe.creatorProfileEmailHeader))})}),e.jsxs("div",{className:"my-1 flex flex-row items-center space-x-2",children:[e.jsx(Tn,{className:"icon-sm"}),e.jsx("span",{children:l.email})]}),e.jsx(tt,{label:s.formatMessage(qe.feedbackEmailTooltip),children:e.jsx(fr,{className:"rounded-xl",id:"receive-support-emails",onChange:x=>{a.mutateAsync({willReceiveSupportEmails:x.currentTarget.checked})},checked:t.will_receive_support_emails,label:s.formatMessage(qe.receiveFeedbackEmails)})})]})]})})]})}const qe=ae({gizmoTab:{id:"settingsModal.gizmoTab",defaultMessage:"GPT builder profile"},creatorProfileDescription:{id:"settingsModal.creatorProfileDescription",defaultMessage:"Personalize your builder profile to connect with users of your GPTs. These settings apply to publicly shared GPTs."},creatorProfileUnverifiedDisclaimer:{id:"settingsModal.createrProfileUnverifiedDisclaimer",defaultMessage:"Complete verification to publish GPTs to everyone."},creatorProfilePersonalUnverifiedDisclaimer:{id:"settingsModal.creatorProfilePersonalUnverifiedDisclaimer",defaultMessage:"Verify your identity by adding billing details or verifying ownership of a public domain name."},creatorProfileBusinessUnverifiedDisclaimer:{id:"settingsModal.creatorProfileBusinessUnverifiedDisclaimer",defaultMessage:"Contact your workspace administrator to set up a builder profile"},creatorProfileNameLabel:{id:"settingsModal.creatorProfileNameLabel",defaultMessage:"Name"},placeholderGPT:{id:"settingsModal.placeholderGPT",defaultMessage:"PlaceholderGPT"},byName:{id:"settingsModal.byName",defaultMessage:"by {name}"},preview:{id:"settingsModal.preview",defaultMessage:"Preview"},noCreatorProfile:{id:"settingsModal.noCreatorProfile",defaultMessage:"Unable to retrieve builder profile"},creatorProfileLinkHeader:{id:"settingsModal.creatorProfileLinkHeader.1",defaultMessage:"Links"},creatorProfileEmailHeader:{id:"settingsModal.creatorProfileEmailHeader.0",defaultMessage:"Email"},nameDisabledTooltip:{id:"settingsModal.nameDisabledTooltip",defaultMessage:"You must have a verified name to enable displaying a name"},linkDisabledTooltip:{id:"settingsModal.linkDisabledTooltip",defaultMessage:"You must have a verified domain to enable displaying a link"},addDomain:{id:"settingsModal.addDomain",defaultMessage:"Verify new domain"},nameSourceReason:{id:"settingsModal.nameSourceReason",defaultMessage:"Name is populated from your billing details"},hideNameToggle:{id:"settingsModal.hideNameToggle",defaultMessage:"Hide your name in your builder profile"},showNameToggle:{id:"settingsModal.showNameToggle",defaultMessage:"Show your name in your builder profile"},hideWebsiteToggle:{id:"settingsModal.hideWebsiteToggle",defaultMessage:"Hide your website in your builder profile"},showWebsiteToggle:{id:"settingsModal.showWebsiteToggle",defaultMessage:"Show your website in your builder profile"},feedbackEmailTooltip:{id:"settingsModal.feedbackEmailTooltip",defaultMessage:"Allow users of your GPTs to send feedback to your ChatGPT login email. Your email will never be shared publicly."},receiveFeedbackEmails:{id:"settingsModal.receiveFeedbackEmails.1",defaultMessage:"Receive feedback emails"}}),cl=["archivedConversations"],rb=30,lb=3;function cb({conversation:t,elementRef:s,closeParentModal:a}){var g;const n=k(),o=ce(),i=Ne(),{mutate:r,isPending:l}=je({mutationFn:async b=>{var M=b,{conversationId:f}=M,x=Fs(M,["conversationId"]);return ie.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:f}},requestBody:x,intercomEventOnError:"fetch-error:conversation:edit"})},onSettled:()=>{i.invalidateQueries({queryKey:[cl]}),ln(i,t.gizmo_id)},onError:()=>{o.danger(gt.deleteFailed,{toastId:"archived_conversations_modal_delete_failed"})}}),[c,u]=h.useState(!1),m="/c/".concat(t.id);return e.jsxs(e.Fragment,{children:[e.jsxs(pe.Row,{disabled:l,children:[e.jsx(pe.Cell,{children:e.jsxs("a",{href:m,rel:"noreferrer",className:"inline-flex items-center gap-2 align-top text-blue-500 dark:text-blue-400",ref:s,children:[e.jsx(Mr,{className:"icon"}),t.title]})}),e.jsx(pe.Cell,{children:t.create_time!=null?e.jsx(Fa,{value:t.create_time,month:"long",year:"numeric",day:"numeric"}):null}),e.jsx(pe.Cell,{textAlign:"right",children:e.jsxs(pe.Actions,{children:[e.jsx(tt,{label:n.formatMessage(gt.unarchiveConversation),side:"top",children:e.jsx("button",{"aria-label":n.formatMessage(gt.unarchiveConversation),className:"text-token-text-tertiary hover:text-token-text-secondary cursor-pointer text-[18px]",onClick:()=>{r({conversationId:t.id,is_archived:!1})},children:e.jsx(Gu,{className:"icon-sm"})})}),e.jsx(tt,{label:n.formatMessage(gt.deleteConversation),side:"top",children:e.jsx("button",{onClick:()=>u(!0),"aria-label":n.formatMessage(gt.deleteConversation),className:"text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(Dn,{className:"icon-sm"})})})]})})]}),c&&e.jsx(Uu,{title:(g=t.title)!=null?g:"",handleDelete:()=>{r({conversationId:t.id,is_visible:!1})},onClose:f=>{u(!1),f!=null&&f.closeParentModal&&a()}})]})}function db({onClose:t}){const{data:s,isLoading:a,isError:n,refetch:o,fetchNextPage:i,hasNextPage:r}=Nd({queryKey:[cl],queryFn:({pageParam:f})=>ie.safeGet("/conversations",{parameters:{query:{offset:f,limit:rb,order:"updated",is_archived:!0}},intercomEventOnError:"fetch-error:conversations:get",authOption:$c.SendIfAvailable}),initialPageParam:0,getNextPageParam:f=>{var b,M,y;const x=((b=f.offset)!=null?b:0)+((M=f.limit)!=null?M:0);return x<((y=f.total)!=null?y:0)?x:void 0},refetchOnMount:"always"}),l=h.useRef(null),c=h.useCallback(f=>{var x;a||f==null||((x=l.current)==null||x.disconnect(),l.current=new IntersectionObserver(b=>{b[0].isIntersecting&&r&&i()}),l.current.observe(f))},[a,r,i]);h.useEffect(()=>()=>{var f;(f=l.current)==null||f.disconnect()},[]);const u=h.useMemo(()=>{var f;return(f=s==null?void 0:s.pages.flatMap(x=>x.items))!=null?f:[]},[s]),m=k();let g;return a?g=e.jsx("div",{className:"text-token-text-secondary pb-8",children:e.jsx(d,p({},gt.loading))}):n?g=e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 text-red-500",children:e.jsx(d,p({},gt.somethingWentWrong))}),e.jsx("div",{children:e.jsx(W,{color:"secondary",onClick:()=>{o()},children:e.jsx(d,p({},gt.retry))})})]}):u.length===0?g=e.jsx("div",{className:"text-token-text-tertiary pb-8",children:e.jsx(d,p({},gt.noArchivedConversations))}):g=e.jsxs(pe.Root,{className:"max-h-[28rem]",size:"compact",children:[e.jsxs(pe.Header,{children:[e.jsx(pe.HeaderCell,{children:e.jsx(d,p({},gt.name))}),e.jsx(pe.HeaderCell,{children:e.jsx(d,p({},gt.dateCreated))}),e.jsx(pe.HeaderCell,{})]}),e.jsx(pe.Body,{children:u.map((f,x)=>e.jsx(cb,{conversation:f,elementRef:x===u.length-lb?c:void 0,closeParentModal:t},f.id))})]}),e.jsx(xe,{testId:"modal-archived-conversations",isOpen:!0,onClose:t,size:"custom",className:"max-w-5xl",type:"success",title:m.formatMessage(gt.title),showCloseButton:!0,children:g})}const gt=ae({name:{id:"archivedConversationsModal.name",defaultMessage:"Name"},dateCreated:{id:"archivedConversationsModal.dateCreated",defaultMessage:"Date created"},loading:{id:"archivedConversationsModal.loading",defaultMessage:"Loading..."},somethingWentWrong:{id:"archivedConversationsModal.somethingWentWrong",defaultMessage:"Something went wrong..."},retry:{id:"archivedConversationsModal.retry",defaultMessage:"Retry"},noArchivedConversations:{id:"archivedConversationsModal.noArchivedConversations",defaultMessage:"You have no archived conversations."},title:{id:"archivedConversationsModal.title",defaultMessage:"Archived Chats"},unarchiveConversation:{id:"archivedConversationsModal.unarchiveConversation",defaultMessage:"Unarchive conversation"},deleteConversation:{id:"archivedConversationsModal.deleteConversation",defaultMessage:"Delete conversation"},deleteFailed:{id:"archivedConversationsModal.deleteFailed",defaultMessage:"Deleting failed"}});function ub({disabledTools:t,onDisabledToolsChanged:s}){var M;h.useEffect(()=>{se.logEvent("User Context GPT-4 Capabilities Shown")},[]);const a=ee(),n=gs(a),o=(M=n==null?void 0:n.isEnterprisey())!=null?M:!1,i=!lo(js.BrowsingAvailable)&&o,r=!oe(a,"934056609"),l=k(),c=y=>{const C=t.includes(y)?t.filter(_=>_!==y):[...t,y];s(C)},u=Qc(),m=!lo(js.Canvas)&&o;var g;u!=null&&u.includes(js.SearchTool)&&!u.includes(js.SearchToolHoldout)?g=Hs({tool:Nt.BROWSER,label:l.formatMessage({id:"userContextModal.tools.web",defaultMessage:"Web search"}),disabledTooltipLabel:l.formatMessage({id:"4WldgK",defaultMessage:"Web search is disabled by your organization"}),description:l.formatMessage({id:"userContexModal.tools.webSearchTooltip",defaultMessage:"Let ChatGPT automatically search the web for answers."}),enabled:!t.includes(Nt.BROWSER)&&!i,handleToolClick:c,disabled:i}):g=Hs({tool:Nt.BROWSER,label:l.formatMessage({id:"userContextModal.tools.browse",defaultMessage:"Browsing"}),disabledTooltipLabel:l.formatMessage({id:"5SuA2c",defaultMessage:"Browsing is disabled by your organization"}),description:l.formatMessage({id:"userContexModal.tools.browserTooltip",defaultMessage:"Let ChatGPT browse the internet to find answers."}),enabled:!t.includes(Nt.BROWSER)&&!i,handleToolClick:c,disabled:i});const f=Hs({tool:Nt.PYTHON,label:l.formatMessage({id:"userContextModal.tools.codeInterpreter.1",defaultMessage:"Code"}),description:l.formatMessage({id:"userContextModal.tools.codeInterpreterTooltip",defaultMessage:"Let ChatGPT execute code using Code Interpreter."}),enabled:!t.includes(Nt.PYTHON),handleToolClick:c}),x=Hs({tool:Nt.CANMORE,label:l.formatMessage({id:"FW2C7Y",defaultMessage:"Canvas"}),description:l.formatMessage({id:"zPYZ4h",defaultMessage:"Collaborate with ChatGPT on text and code."}),enabled:!t.includes(Nt.CANMORE),handleToolClick:c}),b=Hs({tool:Nt.ADVANCED_VOICE,label:l.formatMessage({id:"eHCnkb",defaultMessage:"Advanced voice"}),description:l.formatMessage({id:"OrvjWP",defaultMessage:"Have more natural conversations in voice mode."}),enabled:!t.includes(Nt.ADVANCED_VOICE),handleToolClick:c});return e.jsxs(e.Fragment,{children:[g,f,!m&&x,r&&b]})}function Hs({tool:t,label:s,disabledTooltipLabel:a,description:n,enabled:o,handleToolClick:i,disabled:r}){return e.jsx(K,{children:e.jsx(Be,{label:s,enabled:o,onChange:()=>i(t),toggleTooltip:r&&a,description:n,disabled:r})})}const mb=()=>er({queryKey:["traitPills"],queryFn:async()=>{try{const t=await ie.safeGet("/user_system_message_trait_pills");return t?Array.isArray(t)?t:[]:[]}catch(t){return[...gb.map(s=>({key:s,label:s,description:zo[s].defaultMessage||""})),...fb.map(s=>({key:s,label:s,description:zo[s].defaultMessage||""}))]}}}),gb=["Chatty","Witty","Opinionated","StraightShooting","GenZ","Encouraging","Skeptical","ForwardThinking"],fb=["Poetic","Respectful","Humble","Professional","Corporate","Direct","Silly","Pragmatic","Chill","OutsideTheBox"],zo=ae({Chatty:{id:"userContextModal.chattySentence",defaultMessage:"Be talkative and conversational."},Witty:{id:"userContextModal.wittySentence",defaultMessage:"Use quick and clever humor when appropriate."},StraightShooting:{id:"userContextModal.straightShootingSentence",defaultMessage:"Tell it like it is; don't sugar-coat responses."},Encouraging:{id:"userContextModal.encouragingSentence",defaultMessage:"Use an encouraging tone."},GenZ:{id:"userContextModal.genZSentence",defaultMessage:"Talk like a member of Gen Z."},Skeptical:{id:"userContextModal.skepticalSentence",defaultMessage:"Adopt a skeptical, questioning approach."},ForwardThinking:{id:"userContextModal.forwardThinkingSentence",defaultMessage:"Take a forward-thinking view."},Poetic:{id:"userContextModal.poeticSentence",defaultMessage:"Use a poetic, lyrical tone."},Opinionated:{id:"userContextModal.opinionatedSentence",defaultMessage:"Readily share strong opinions."},Respectful:{id:"userContextModal.respectfulSentence",defaultMessage:"Always be respectful."},Humble:{id:"userContextModal.humbleSentence",defaultMessage:"Be humble when appropriate."},Professional:{id:"userContextModal.professionalSentence",defaultMessage:"Use a formal, professional tone."},Silly:{id:"userContextModal.sillySentence",defaultMessage:"Be playful and goofy."},Direct:{id:"userContextModal.directSentence",defaultMessage:"Get right to the point."},Pragmatic:{id:"userContextModal.pragmaticSentence",defaultMessage:"Be practical above all."},Corporate:{id:"userContextModal.corporateSentence",defaultMessage:"Respond with corporate jargon."},Chill:{id:"userContextModal.chillSentence",defaultMessage:"Keep it relaxed and easygoing."},OutsideTheBox:{id:"userContextModal.outsideTheBoxSentence",defaultMessage:"Be innovative and think outside the box."}});function pb(){return Ze(J(p({},mb()),{select:t=>{const s=Math.ceil(t.length/2-1);return{firstSet:t.slice(0,s),secondSet:t.slice(s)}}}))}function Vo(t,s,a){const n=t.length-2,o=t.filter(c=>!a.includes(c.key)),i=s.filter(c=>!a.includes(c.key)),r=Math.min(o.length,n),l=Math.max(0,n-o.length);return{visibleTraits:[...o.slice(0,r),...i.slice(0,l)],hiddenTraits:[...o.slice(r),...i.slice(l)]}}function hb({onSelect:t,selectedTraits:s,setSelectedTraits:a,disablePills:n=!1}){const o=k(),{data:i,isLoading:r}=pb(),[l,c]=h.useState(!1),[u,m]=h.useState([]),[g,f]=h.useState([]);if(h.useEffect(()=>{if(i){const{visibleTraits:y,hiddenTraits:C}=Vo(i.firstSet,i.secondSet,[]);m(y),f(C)}},[i]),r)return e.jsx(Oe,{});if(!i)return null;let x=[];x=u;const b=y=>{if(!s.includes(y.key)&&(a(C=>[...C,y.key]),t(y.description),!l&&(m(C=>C.filter(_=>_.key!==y.key)),g.length>0))){const[C,..._]=g;m(v=>[...v,C]),f(_)}},M=()=>{if(l){const{visibleTraits:y,hiddenTraits:C}=Vo(i.firstSet,i.secondSet,s);m(y),f(C)}else m([...i.firstSet,...i.secondSet]),f([]);c(y=>!y)};return e.jsxs("ul",{className:"flex flex-wrap gap-x-1 gap-y-2",children:[x.map(y=>s.includes(y.key)?null:e.jsx("li",{children:e.jsx(W,{size:"small",color:"secondary",className:"text-token-text-secondary px-2.5 py-1 text-xs font-normal",onClick:()=>b(y),disabled:n,children:y.label})},y.label)),x.length>0&&!l&&g.length>0&&e.jsx("li",{children:e.jsx(W,{size:"small",color:"secondary","aria-label":o.formatMessage(be.traitsReset),className:"text-token-text-secondary h-7 w-7 rounded-full",onClick:M,disabled:n,children:e.jsx(Da,{className:"icon-sm"})})})]})}function xb({onSuccess:t,onError:s}){const a=Ne();return je({mutationFn:({userContext:n})=>Li(n),onSettled:(n,o)=>{const i=["userContext"];n!==null&&!o?a.setQueryData(i,n):a.invalidateQueries({queryKey:i})},onSuccess:t,onError:s})}function bb(){var c,u,m;const t=k(),s=Ft(ds.isBusinessWorkspace),a=(c=Ft(ds.workspaceId))!=null?c:void 0,{data:n,isLoading:o}=Xc(a),{data:i}=vt(ge.HiveReferencedInInternalKnowledge),r=ot();return o?e.jsx("div",{className:"flex justify-center",children:e.jsx(Oe,{})}):(s?((u=n==null?void 0:n.beta_settings.hive)!=null?u:!1)&&((m=n==null?void 0:n.beta_settings.hive_knowledge_retrieval)!=null?m:!1):!0)?e.jsx(Me,{title:t.formatMessage(be.RecordModeTitle),learnMoreHref:"https://help.openai.com/en/articles/11487532-chatgpt-record",children:e.jsx(K,{children:e.jsx(Be,{label:t.formatMessage(be.recordModeToggleLabel),enabled:!!i,onChange:g=>r.mutate({setting:ge.HiveReferencedInInternalKnowledge,value:g}),description:e.jsx(d,p({},be.recordModeDescription))})})}):null}function Mb({disabledTools:t,localUserContext:s,setLocalUserContext:a,userContextData:n}){var c,u;const o=k(),[i,r]=h.useState(!1),l=h.useRef(null);return e.jsx(Me,{title:e.jsxs("button",{onClick:()=>{r(m=>!m),i||requestAnimationFrame(()=>{l.current&&l.current.scrollIntoView({behavior:"smooth",block:"end"})})},"aria-label":o.formatMessage(i?be.advancedClose:be.advancedOpen),"data-testid":"advanced-toggle","aria-expanded":i,className:"flex items-center justify-between gap-1",children:[e.jsx(d,p({},be.advanced)),i?e.jsx(sm,{className:"icon-sm"}):e.jsx(xr,{className:"icon-sm"})]}),noBorder:!i,children:i&&e.jsxs("div",{className:"mt-2",children:[e.jsx(ub,{disabledTools:(u=(c=s.disabledTools)!=null?c:t)!=null?u:[],onDisabledToolsChanged:m=>Zt({userContextData:n,updates:{disabledTools:m},localUserContext:s,setLocalUserContext:a})}),e.jsx("span",{ref:l})]})})}function yb({userContextData:t,localUserContext:s,setLocalUserContext:a,onSubmit:n,selectedTraits:o,setSelectedTraits:i,hasModError:r}){var N,w,A,T,P,E,O;const l=ee(),c=k(),u=Ht(l,"1922342873").get("can-select-personality",!1),m=Ps(D=>D.autoHighlightNicknameInput),g=(N=s.enabled)!=null?N:!!(t!=null&&t.enabled),{personalityTypeMessage:f,nameUserMessage:x,roleUserMessage:b,traitsModelMessage:M,otherUserMessage:y}=Nr(t),[C,_]=h.useState(0),[v,j]=h.useState(!0);h.useEffect(()=>{const D=setTimeout(()=>{j(!1)},1e3),I=setInterval(()=>{_(H=>(H+1)%Qa.length)},5500);return()=>{clearInterval(I),clearTimeout(D)}},[]);const{data:S}=Zu();return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{title:c.formatMessage(be.customizeTitle),children:[e.jsx(K,{children:e.jsx(Be,{label:e.jsx(d,p({},be.enablePersonalizationRowLabel)),description:e.jsx(d,p({},be.enablePersonalizationRowDescription)),enabled:g,onChange:D=>{Zt({userContextData:t,updates:{enabled:D},localUserContext:s,setLocalUserContext:a}),se.logEventWithStatsig("Enable Customization Toggled","chatgpt_enable_customization_toggled",{enabled:D})},"aria-label":g?c.formatMessage(be.disableToggleLabel):c.formatMessage(be.enableToggleLabel)})}),u&&e.jsx(K,{children:e.jsx(Xu,{label:c.formatMessage(be.settingsPersonalitySelectionRowTitle),description:c.formatMessage(be.settingsPersonalitySelectionRowDescription),selector:e.jsx(Ju,{enabled:g,selectedModel:(w=s.personalityTypeMessage)!=null?w:f,models:S,onSelect:D=>Zt({userContextData:t,updates:{personalityTypeMessage:D},localUserContext:s,setLocalUserContext:a})})})}),e.jsxs(la,{title:c.formatMessage(be.customInstructions),className:"pt-7",children:[e.jsx(ca,{onSubmit:n,name:"traits_model_message",disabled:!g,hasModError:r==="traits_model_message",value:(A=s.traitsModelMessage)!=null?A:M,placeholder:c.formatMessage(be.customInstructionsPlaceholder),onChange:D=>Zt({userContextData:t,updates:{traitsModelMessage:D.target.value},localUserContext:s,setLocalUserContext:a}),size:"sm",showCharacterCount:!1,isNewCustomInstructionsUIEnabled:!0,dynamicHeight:!0}),e.jsx(hb,{onSelect:D=>{var I;Zt({userContextData:t,updates:{traitsModelMessage:"".concat((I=s.traitsModelMessage)!=null?I:M," ").concat(D).trim()},localUserContext:s,setLocalUserContext:a})},selectedTraits:o,setSelectedTraits:i,disablePills:!g})]})]}),e.jsxs(Me,{title:c.formatMessage(be.aboutYouSectionTitle),children:[e.jsx(la,{title:c.formatMessage(be.customizeNamePlaceholder),className:"pt-5",children:e.jsx(ca,{onSubmit:n,disabled:!g,name:"name_user_message",hasModError:r==="name_user_message",value:(T=s.nameUserMessage)!=null?T:x,placeholder:c.formatMessage(be.customizeName),onChange:D=>Zt({userContextData:t,updates:{nameUserMessage:D.target.value},localUserContext:s,setLocalUserContext:a}),size:"sm",showCharacterCount:!1,autoHighlight:m})}),e.jsx(la,{title:c.formatMessage(be.occupationInputTitle),className:"pt-7",children:e.jsxs("div",{className:"relative overflow-clip",children:[!((P=s.roleUserMessage)!=null?P:b)&&e.jsx(Nn,{mode:"wait",children:e.jsx(Ji.span,{variants:em,initial:v?!1:"initial",animate:"animate",exit:"exit",className:"pointer-events-none absolute start-[0.81rem] top-[0.55rem] text-sm text-gray-400",children:c.formatMessage(tm[Qa[C]])},Qa[C])}),e.jsx(ca,{onSubmit:n,name:"role_user_message",disabled:!g,hasModError:r==="role_user_message",value:(E=s.roleUserMessage)!=null?E:b,placeholder:"",onChange:D=>Zt({userContextData:t,updates:{roleUserMessage:D.target.value},localUserContext:s,setLocalUserContext:a}),size:"sm",showCharacterCount:!1})]})}),e.jsx(la,{title:c.formatMessage(be.moreDetailsInputTitle),className:"pt-7",children:e.jsx(ca,{onSubmit:n,disabled:!g,name:"other_user_message",hasModError:r==="other_user_message",value:(O=s.otherUserMessage)!=null?O:y,placeholder:c.formatMessage(be.customizeOtherPlaceholder),onChange:D=>Zt({userContextData:t,updates:{otherUserMessage:D.target.value},localUserContext:s,setLocalUserContext:a}),size:"sm",showCharacterCount:!1,isNewCustomInstructionsUIEnabled:!0,dynamicHeight:!0})})]})]})}function Cb(){"use forget";const[t,s]=h.useState(!1),[a,n]=h.useState(!1),o=k(),i=Wu(),r=yr(),{isLoading:l,data:c}=Di(!0),u=ot(),m=Cr(),{data:g}=Hu(void 0,!1,i),f=ee(),x=vr(),b=jr(),M=zu();Vu(),Ku();const y=qu(),C=$u(),_=Sr(),v=_r(f),{isLoading:j}=vt(ge.Sunshine),{isLoading:S}=vt(ge.Moonshine),{mutate:N,isPending:w}=ot(!0),{mutate:A,isPending:T}=ot(!0);ot(!0);const P=gs(f),E=P==null?void 0:P.hasPlusFeatures(),O=oe(f,"1900515849"),I=Ht(f,"1704793646").get("full_name_llm",!1),H=bt(),$=ce(),X=oe(f,"1804926979")&&oe(f,"3365913332"),[q,G]=h.useState(null),[F,R]=h.useState([]),[V,Q]=h.useState(p({},wr));h.useEffect(()=>{const Ce=()=>{const wt=document.getElementById("memory-modal");wt&&wt.scrollIntoView({block:"start"}),t||s(!0)};return window.addEventListener("personalization:show-memories-modal",Ce),()=>window.removeEventListener("personalization:show-memories-modal",Ce)},[t]);const{isPending:de,mutate:Z}=xb({onSuccess:Ce=>{Ts.setCookie(Es.GreetingName,Zc(Ce,H,I)),window.dispatchEvent(new Event("refreshGreeting")),$.success(o.formatMessage({id:"diZzkj",defaultMessage:"Personalization settings updated for future conversations"}))},onError:Ce=>{var wt,Bs,Kn;return((wt=Ce.response)==null?void 0:wt.reason)==="content_policy"&&((Bs=Ce.response)!=null&&Bs.field)?G((Kn=Ce.response)==null?void 0:Kn.field):$.danger(o.formatMessage({id:"userContextModal.saveError",defaultMessage:"Failed to update settings"}),{loggingTitle:"Failed to update settings",toastId:"user_context_modal"}),Ce}}),{personalityTypeMessage:ue,nameUserMessage:ye,roleUserMessage:re,traitsModelMessage:ne,otherUserMessage:B,disabledTools:Y,enabled:te}=Nr(c),{aboutUserMessage:me,aboutModelMessage:Se,nameUserMessage:We,roleUserMessage:He,traitsModelMessage:Ae,otherUserMessage:ze,disabledTools:_t,enabled:is,personalityTypeMessage:It}=V,rs=h.useMemo(()=>[We,He,Ae,ze].some(Ce=>Qu(Ce!=null?Ce:"")),[We,He,Ae,ze]),ls=h.useMemo(()=>[{local:We,server:ye},{local:He,server:re},{local:Ae,server:ne},{local:ze,server:B},{local:It,server:ue}].some(({local:Ce,server:wt})=>Ce!==void 0&&Ce!==wt)||_t!==void 0&&!Yc(_t,Y)||is!==void 0&&is!==te,[ye,re,ne,B,ue,We,He,Ae,ze,It,_t,Y,is,te]),zn=h.useCallback(()=>{if(!de){G(null);const Ce={aboutUserMessage:me!=null?me:"",aboutModelMessage:Se!=null?Se:"",nameUserMessage:We!=null?We:"",roleUserMessage:He!=null?He:"",traitsModelMessage:Ae!=null?Ae:"",otherUserMessage:ze!=null?ze:"",disabledTools:_t!=null?_t:[],enabled:!!is,personalityTypeMessage:It!=null?It:""},wt={name:ye,role:re,traits:ne,other:B,traitPillsSelected:F},Bs={name:Ce.nameUserMessage,role:Ce.roleUserMessage,traits:Ce.traitsModelMessage,other:Ce.otherUserMessage,personality:Ce.personalityTypeMessage,traitPillsSelected:F};se.logEvent("User Context Save Customize ChatGPT",{previousState:wt,newState:Bs}),Zs.logEvent("chatgpt_user_context_save_custom_instructions",void 0,{previousState:JSON.stringify(wt),newState:JSON.stringify(Bs)}),Z({userContext:Ce})}},[de,me,Se,We,He,Ae,ze,_t,is,It,ye,re,ne,B,F,Z]),Vn=h.useCallback(()=>{if(rs){$.danger(o.formatMessage(be.messageLimitError,{limit:Yu}),{duration:4,hasCloseButton:!0,loggingTitle:"Message limit error",toastId:"user_context_modal",loggingDescription:be.messageLimitError.defaultMessage});return}zn()},[o,rs,zn,$]);return h.useEffect(()=>{se.logEventWithStatsig("User Context Custom Instructions Modal Opened","chatgpt_user_context_custom_instructions_modal_opened",{location:"personalization_settings"})},[]),l?e.jsx("div",{className:"flex justify-center p-6",children:e.jsx(Oe,{})}):e.jsxs(e.Fragment,{children:[e.jsx(yb,{userContextData:c,localUserContext:V,setLocalUserContext:Q,onSubmit:Vn,selectedTraits:F,setSelectedTraits:R,hasModError:q}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"memory-modal"}),e.jsxs(Me,{title:o.formatMessage(be.memoryTitle),learnMoreHref:"https://help.openai.com/en/articles/8590148-memory-faq",headerTrailingContent:e.jsx(W,{color:"secondary",onClick:()=>{se.logEventWithStatsig("Manage Memories Button Clicked","chatgpt_manage_memories_button_clicked_settings"),s(!0)},size:"small",children:e.jsx(d,p({},be.manageButton))}),children:[e.jsxs(K,{children:[e.jsx(Be,{label:o.formatMessage(be.toggleLabel),enabled:i,disabled:(m==null?void 0:m[ge.Sunshine])===!0,isLoading:j||w,onChange:Ce=>{N({setting:ge.Sunshine,value:Ce},{onSuccess:()=>{!Ce&&i?(y&&C&&A({setting:ge.Moonshine,value:!1}),b&&x&&u.mutate({setting:ge.MemoryInSearch,value:!1})):Ce&&y&&A({setting:ge.Moonshine,value:!0})}})}}),e.jsx(Sn,{children:e.jsx(d,p({},be.exampleDescription))})]}),i&&y&&e.jsx(K,{children:e.jsx(Be,{label:o.formatMessage({id:"2qTSAN",defaultMessage:"Reference chat history"}),enabled:C,isLoading:S||T,onChange:Ce=>{A({setting:ge.Moonshine,value:Ce})},disabled:!y||(m==null?void 0:m[ge.Moonshine])===!0,description:E?e.jsx(d,{id:"poYymi",defaultMessage:"Let ChatGPT reference all previous conversations when responding."}):e.jsx(d,{id:"kZ8Ljp",defaultMessage:"Let ChatGPT reference recent conversations when responding."})})}),!1,!M&&e.jsx(lg,{className:"mt-3 mb-1",memoryFullPct:g==null?void 0:g.memoryFullPct,showInfoLabel:!0,onManageMemories:()=>{s(!0)}}),_&&!v&&e.jsx(K,{children:e.jsx("div",{className:"text-token-text-tertiary pe-12 text-xs",children:e.jsx(d,{id:"iCZODP",defaultMessage:"ChatGPT may use Memory to personalize queries to search providers, such as Bing. {learnMoreLink}",values:{learnMoreLink:e.jsx(Os,{href:"https://help.openai.com/en/articles/9237897-chatgpt-search",className:"underline",children:e.jsx(d,{id:"0M5wS5",defaultMessage:"Learn more"})})}})})}),t&&O?e.jsx(cg,{onClose:()=>s(!1)}):t&&e.jsx(dg,{onClose:()=>s(!1)})]}),!1]}),X&&e.jsx(bb,{}),e.jsx(Mb,{disabledTools:Y,userContextData:c,localUserContext:V,setLocalUserContext:Q}),ls&&e.jsx(vb,{setLocalUserContext:Q,isMutationLoading:de,onSubmit:Vn,isAnyMessagePastLimit:rs,hasUnsavedChanges:ls})]})}function vb({setLocalUserContext:t,isMutationLoading:s,onSubmit:a,isAnyMessagePastLimit:n,hasUnsavedChanges:o}){return e.jsx("div",{className:"bg-token-main-surface-primary sticky bottom-0 flex min-h-21 items-center justify-end border-t px-4",children:e.jsxs("footer",{className:"flex gap-2",children:[e.jsx(Le.Button,{onClick:()=>t(wr),children:e.jsx(d,p({},be.cancel))}),e.jsx(Le.Button,{loading:s,onClick:a,color:"primary",visuallyDisabled:n,disabled:!o,children:e.jsx(d,p({},be.save))})]})})}function jb(t){return ie.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:t}}})}function Sb(){return ie.safeDelete("/share/posts/mine")}function _b({limit:t}){return ie.safeGet("/share/posts/mine",{parameters:{query:{limit:t}}})}const Ut={sharedConversations:["sharedConversations"],sharedTextdocs:["sharedTextdocs"],sharedPosts:["sharedPosts"]},Pe=ae({name:{id:"sharedConversationModal.name",defaultMessage:"Name"},dateShared:{id:"sharedConversationModal.dateShared",defaultMessage:"Date shared"},type:{id:"YiHQp6",defaultMessage:"Type"},chatType:{id:"0BR1NF",defaultMessage:"Chat"},canvasType:{id:"AalPA+",defaultMessage:"Canvas"},postType:{id:"UXpwgD",defaultMessage:"Post"},imageType:{id:"i6Dtp1",defaultMessage:"Image"},loading:{id:"sharedConversationModal.loading",defaultMessage:"Loading..."},somethingWentWrong:{id:"sharedConversationModal.somethingWentWrong",defaultMessage:"Something went wrong..."},retry:{id:"sharedConversationModal.retry",defaultMessage:"Retry"},noSharedConversations:{id:"sharedConversationModal.noSharedConversations",defaultMessage:"You have no shared links."},title:{id:"sharedConversationModal.title",defaultMessage:"Shared Links"},goToOriginConversation:{id:"sharedConversationModal.goToOriginConversation",defaultMessage:"View source chat"},deleteSharedLink:{id:"sharedConversationModal.deleteSharedLink",defaultMessage:"Delete shared link"},deleteSharedLinkFailed:{id:"sharedConversationModal.deleteSharedLinkFailed",defaultMessage:"Deleting shared link failed"},deleteAllSharedLinks:{id:"sharedConversationModal.deleteSharedAllConversations",defaultMessage:"Delete all shared links"},deleteAllSharedLinksConfirm:{id:"sharedConversationModal.deleteSharedAllConversationsConfirm",defaultMessage:"Are you sure you want to delete all your shared links?"},deleteAllSharedLinksFailed:{id:"sharedConversationModal.deleteSharedAllConversationsFailed",defaultMessage:"Deleting shared links failed"}});function wb(){const t=Ne(),s=k(),a=ce(),n=kr(!0),{mutate:o}=je({mutationFn:()=>Promise.allSettled([ie.safeDelete("/share/all",{requestBody:{confirm:!0}}),ie.safeDelete("/shared_textdocs",{}),n()?Sb():Promise.resolve()]),onSettled:()=>{t.invalidateQueries({queryKey:Ut.sharedConversations}),t.invalidateQueries({queryKey:Ut.sharedTextdocs}),t.invalidateQueries({queryKey:Ut.sharedPosts})},onError:()=>{a.danger(Pe.deleteAllSharedLinksFailed,{toastId:"delete_all_shared_links_failed"})}});return e.jsx(Jc,{side:"bottom",sideOffset:4,triggerButton:e.jsx("button",{className:"text-token-text-tertiary hover:text-token-text-secondary radix-state-open:text-token-text-tertiary dark:radix-state-open:text-gray-400",children:e.jsx(Da,{className:"icon-sm"})}),children:e.jsx(he.Item,{onClick:()=>{window.confirm(s.formatMessage(Pe.deleteAllSharedLinksConfirm))&&o()},color:"danger",children:e.jsx(d,p({},Pe.deleteAllSharedLinks))})})}function Nb(){return ie.safeGet("/shared_conversations",{parameters:{query:{order:"created"}}})}function kb(){return Ze({queryKey:Ut.sharedConversations,queryFn:Nb,refetchOnMount:"always"})}function Tb(){return Ze({queryKey:Ut.sharedTextdocs,queryFn:()=>ie.safeGet("/shared_textdocs",{}),refetchOnMount:"always"})}function Eb(){const s=kr(!0)();return Ze({queryKey:Ut.sharedPosts,queryFn:()=>_b({limit:1e4}),refetchOnMount:"always",enabled:s,initialData:s?{items:[],cursor:null}:void 0})}const Hn=({conversationId:t,onClickDelete:s})=>{const a=k();return e.jsx(pe.Cell,{textAlign:"right",children:e.jsxs(pe.Actions,{children:[t&&e.jsx(tt,{label:a.formatMessage(Pe.goToOriginConversation),side:"top",children:e.jsx("a",{href:ed(t),target:"_blank",rel:"noreferrer","aria-label":a.formatMessage(Pe.goToOriginConversation),className:"text-token-text-tertiary hover:text-token-text-secondary cursor-pointer",children:e.jsx(Mr,{className:"icon-sm"})})}),e.jsx(tt,{label:a.formatMessage(Pe.deleteSharedLink),side:"top",className:"flex h-fit",children:e.jsx("button",{onClick:s,"aria-label":a.formatMessage(Pe.deleteSharedLink),className:"text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(Dn,{className:"icon-sm"})})})]})})};function Pb({sharedConversation:t}){const s=ce(),a=Ne(),{mutate:n,isPending:o}=je({mutationFn:({sharedConversationId:r})=>ie.safeDelete("/share/{shared_conversation_id}",{parameters:{path:{shared_conversation_id:r}}}),onSettled:()=>{a.invalidateQueries({queryKey:Ut.sharedConversations})},onError:()=>{s.danger(Pe.deleteSharedLinkFailed,{toastId:"delete_shared_link_failed"})}}),i=t.workspace_id!=null?"/share/e/".concat(t.id):"/share/".concat(t.id);return e.jsxs(pe.Row,{disabled:o,children:[e.jsx(pe.Cell,{children:e.jsxs("a",{href:i,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 align-top text-blue-500 dark:text-blue-400",children:[e.jsx(qs,{className:"icon-sm shrink-0"}),t.title]})}),e.jsx(pe.Cell,{children:e.jsx(d,p({},Pe.chatType))}),e.jsx(pe.Cell,{children:t.create_time!=null?e.jsx(Fa,{value:t.create_time,month:"long",year:"numeric",day:"numeric"}):null}),e.jsx(Hn,{conversationId:t.conversation_id,onClickDelete:()=>n({sharedConversationId:t.id})})]})}function Ab({sharedTextdoc:t}){const{conversation_id:s,shared_textdoc_id:a}=t,n=ce(),o=Ne(),{mutate:i,isPending:r}=je({mutationFn:async({sharedTextdocId:l})=>ie.safeDelete("/textdoc/shared/{shared_textdoc_id}",{parameters:{path:{shared_textdoc_id:l}}}),onSettled:()=>{o.invalidateQueries({queryKey:Ut.sharedTextdocs})},onError:()=>{n.danger(Pe.deleteSharedLinkFailed,{toastId:"delete_shared_link_failed"})}});return e.jsxs(pe.Row,{disabled:r,children:[e.jsx(pe.Cell,{children:e.jsxs("a",{href:ug(a),target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 align-top text-blue-500 dark:text-blue-400",children:[e.jsx(qs,{className:"icon-sm shrink-0"}),t.name]})}),e.jsx(pe.Cell,{children:e.jsx(d,p({},Pe.canvasType))}),e.jsx(pe.Cell,{children:t.created_at!=null?e.jsx(Fa,{value:t.created_at,month:"long",year:"numeric",day:"numeric"}):null}),e.jsx(Hn,{conversationId:s,onClickDelete:()=>i({sharedTextdocId:a})})]})}function Db({sharedPost:t}){var r,l;const s=ce(),a=Ne(),{mutate:n,isPending:o}=je({mutationFn:async({postId:c})=>jb(c),onSettled:()=>{a.invalidateQueries({queryKey:Ut.sharedPosts})},onError:()=>{s.danger(Pe.deleteSharedLinkFailed,{toastId:"delete_shared_post_failed"})}}),i=((l=(r=t.attachments)==null?void 0:r[0])==null?void 0:l.kind)==="media_generation"?Pe.imageType:Pe.postType;return e.jsxs(pe.Row,{disabled:o,children:[e.jsx(pe.Cell,{children:e.jsxs("a",{href:am(t.id),target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 align-top text-blue-500 dark:text-blue-400",children:[e.jsx(qs,{className:"icon-sm shrink-0"}),t.text]})}),e.jsx(pe.Cell,{children:e.jsx(d,p({},i))}),e.jsx(pe.Cell,{children:t.posted_at!=null?e.jsx(Fa,{value:t.posted_at*1e3,month:"long",year:"numeric",day:"numeric"}):null}),e.jsx(Hn,{conversationId:void 0,onClickDelete:()=>n({postId:t.id})})]})}function Lb({onClose:t}){const{data:s,isLoading:a,isError:n,refetch:o}=kb(),{data:i,isLoading:r,isError:l,refetch:c}=Tb(),{data:u,isLoading:m,isError:g,refetch:f}=Eb(),x=k();let b;return a||r||m?b=e.jsx("div",{className:"text-token-text-secondary pb-8",children:e.jsx(d,p({},Pe.loading))}):l||n||g?b=e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 text-red-500",children:e.jsx(d,p({},Pe.somethingWentWrong))}),e.jsx("div",{children:e.jsx(W,{color:"secondary",onClick:()=>{o(),c(),f()},children:e.jsx(d,p({},Pe.retry))})})]}):(s==null?void 0:s.total)===0&&(i==null?void 0:i.shared_textdocs.length)===0&&(u==null?void 0:u.items.length)===0?b=e.jsx("div",{className:"text-token-text-tertiary pb-8",children:e.jsx(d,p({},Pe.noSharedConversations))}):b=e.jsxs(pe.Root,{className:"max-h-[28rem]",size:"compact",children:[e.jsxs(pe.Header,{children:[e.jsx(pe.HeaderCell,{children:e.jsx(d,p({},Pe.name))}),e.jsx(pe.HeaderCell,{children:e.jsx(d,p({},Pe.type))}),e.jsx(pe.HeaderCell,{children:e.jsx(d,p({},Pe.dateShared))}),e.jsx(pe.HeaderCell,{textAlign:"right",children:e.jsx(wb,{})})]}),e.jsxs(pe.Body,{children:[s==null?void 0:s.items.map(M=>e.jsx(Pb,{sharedConversation:M},M.id)),i==null?void 0:i.shared_textdocs.map(M=>e.jsx(Ab,{sharedTextdoc:M},M.shared_textdoc_id)),u==null?void 0:u.items.map(M=>e.jsx(Db,{sharedPost:M},M.id))]})]}),e.jsx(xe,{isOpen:!0,onClose:t,size:"custom",className:"max-w-5xl",type:"success",title:x.formatMessage(Pe.title),testId:"modal-shared-conversations",showCloseButton:!0,children:b})}function Ob({type:t,className:s}){return t==="computer"?e.jsx(nm,{className:s}):t==="phone"?e.jsx(qm,{className:s}):e.jsx($m,{className:s})}function Ib({onClose:t,devices:s}){const a=k();return e.jsxs(xe,{isOpen:!0,onClose:t,title:e.jsx("span",{className:"text-heading-3 [font-weight:500]",children:a.formatMessage({id:"trustedDevicesModal.title",defaultMessage:"Trusted Devices"})}),testId:"modal-trusted-devices",className:"max-w-[524px]!",headerClassName:"!p-6",contentClassName:"!px-6 !pt-6 !pb-0",showCloseButton:!0,hasSeparator:!0,modalActionsClassName:"!mt-0",children:[e.jsx("p",{className:"text-xs",children:e.jsx(d,{id:"trustedDevicesModal.description",defaultMessage:"After you sign in, a device becomes trusted. When you log in somewhere new, we'll send a prompt to your trusted devices for approval. To remove a trusted device from this list, just log out. Don't recognize a device? Log out and reach out to support."})}),e.jsx("div",{className:"border-token-border mt-6 border-t"}),e.jsx("ul",{className:"divide-token-border border-token-border divide-y border-b",children:s.map(n=>{var o;return e.jsxs("li",{className:"flex items-center gap-3 py-2",children:[e.jsx("div",{className:"text-token-icon-primary",children:e.jsx(Ob,{type:n.device_type})}),e.jsxs("div",{children:[e.jsx("p",{className:"py-0.5 text-xs",children:(o=n.device_name)!=null?o:a.formatMessage({id:"trustedDevicesModal.unknownDeviceName",defaultMessage:"Unknown"})}),(n.last_seen_time!=null||n.device_location)&&e.jsx("p",{className:"text-token-text-secondary py-0.5 text-xs",children:n.device_location?e.jsx(d,{id:"trustedDevicesModal.lastSeen.withLocation",defaultMessage:"Last logged in on {ts, date, short} at {ts, time, short} from {location}",values:{ts:n.last_seen_time?n.last_seen_time*1e3:Date.now(),location:n.device_location}}):e.jsx(d,{id:"trustedDevicesModal.lastSeen.noLocation",defaultMessage:"Last logged in on {ts, date, short} at {ts, time, short}",values:{ts:n.last_seen_time?n.last_seen_time*1e3:Date.now()}})})]})]},n.device_id)})}),e.jsx("div",{className:"border-token-border mt-6 border-t"})]})}const Rb=jt(()=>St(()=>import("./op3gurrbylc7rzc2.js"),__vite__mapDeps([13,1,4,2,3,5,14,15]))),dl="https://help.openai.com/en/articles/5722486",Bb="https://help.openai.com/en/articles/8400625-voice-mode-faq#h_3839e62d6a";function Fb(t){const s=Ra(t),{data:a}=Ze({queryKey:["data-usage-for-training",s==null?void 0:s.accountUserId],queryFn:()=>ie.safeGet("/accounts/data_usage_for_training"),enabled:s!=null});return a==null?void 0:a.data_usage_for_training}function Gb({account:t,context:s}){if(!t)return null;const a=Ht(s,"3431098147");return t.isFree()&&a.get("should_show_subscription_settings_to_free",!1)?ke.FREE:t.isGo()?ke.GO:t.isPlus()?ke.PLUS:t.isPro()?ke.PRO:null}function Ub(){const{data:t}=Ds(),s=k(),a=Ft(ds.isBusinessWorkspace),[n,o]=h.useState(!1),i=Ft(ds.isTeamPlan),r=Ft(ds.isEduPlan),{data:l}=vt(ge.TrainingAllowed),{data:c}=vt(ge.VoiceTrainingAllowed),{data:u}=vt(ge.VideoTrainingAllowed),m=ot(),g=Cr(),f=Fb(t),x=f==="disallowed"?!1:!!l;return e.jsxs(K,{children:[e.jsx(Ia,{onClick:()=>o(!0),label:s.formatMessage(L.chatTrainingAllowedToggleLabel),stateLabel:x?s.formatMessage({id:"settingsModal.trainingEnabled",defaultMessage:"On"}):s.formatMessage({id:"settingsModal.trainingDisabled",defaultMessage:"Off"}),testId:"improve-model-open-modal-button"}),n&&e.jsxs(xe,{testId:"modal-training-toggle",isOpen:!0,onClose:()=>o(!1),title:s.formatMessage({id:"settingsModal.trainingToggleModalTitle",defaultMessage:"Model improvement"}),type:"success",secondaryButton:e.jsx(W,{color:"secondary",onClick:()=>o(!1),"data-testid":"improve-model-done-button",children:e.jsx(d,{id:"settingsModal.trainingToggleModalDoneButton",defaultMessage:"Done"})}),children:[e.jsx("div",{className:"pb-8",children:e.jsx(Be,{label:s.formatMessage(L.chatTrainingAllowedToggleLabel),disabled:f==="disallowed"||(g==null?void 0:g[ge.TrainingAllowed])===!0,enabled:x,onChange:b=>{m.mutate({setting:ge.TrainingAllowed,value:b})},toggleTooltip:a?e.jsx(d,p({},i?L.chatTrainingTeamsTooltip:r?L.chatTrainingEduTooltip:L.chatTrainingEnterpriseTooltip)):null,description:e.jsx(d,J(p({},L.trainingAllowedDescription),{values:{link:b=>e.jsx("a",{href:dl,target:"_blank",className:"underline",rel:"noreferrer",children:b})}})),testId:"improve-model-toggle"})}),!a&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-token-text-secondary mb-2 text-lg leading-7 font-semibold",children:e.jsx(d,{id:"settingsModal.trainingToggleModalVoiceAndVideoTitle",defaultMessage:"Voice mode"})}),e.jsx("div",{className:"pb-2",children:e.jsx(Be,{label:s.formatMessage(L.voiceTrainingAllowedLabel),enabled:x?!!c:!1,disabled:!x||(g==null?void 0:g[ge.VoiceTrainingAllowed])===!0,onChange:b=>{x&&m.mutate({setting:ge.VoiceTrainingAllowed,value:b})}})}),e.jsx(Be,{label:s.formatMessage(L.videoTrainingAllowedLabel),enabled:x?!!u:!1,disabled:!x||(g==null?void 0:g[ge.VideoTrainingAllowed])===!0,onChange:b=>{x&&m.mutate({setting:ge.VideoTrainingAllowed,value:b})},description:e.jsx(d,J(p({},L.voiceAndVideoTrainingDescription),{values:{link:b=>e.jsx("a",{href:Bb,target:"_blank",className:"underline",rel:"noreferrer",children:b})}}))})]})]})]})}const Wb=()=>{var te;const t=ee(),s=k(),a=nd(),n=Lt(),{pathname:o}=n,i=$e(),{closeSettings:r,currentTab:l,openSettings:c}=ms(),u=od(),m=id(),g=rd(),f=!1,x=!1,b=ns(),M=ld(),y=cd(),C=vn(),[_,v]=h.useState(u);h.useEffect(()=>{v(u)},[u]);const[j,S]=h.useState(f),[N,w]=h.useState(x),{data:A}=Ds(),T=A!=null?dd(A):!1,P=Rx(),E=Or(),O=Gn(),D=oe(t,"733205176"),I=oe(t,"3375735072"),H=oe(t,"3989934672")||!!(O!=null&&O.id),$=oe(t,"2509278897"),X=oe(t,"2050949565"),q=st[U.SLACK_CONNECTOR],G=C===q&&!T&&!$&&X,F=Qi(Wt.CookieManagement),R=Ne(),[V,Q]=h.useState(null);h.useEffect(()=>{const[me]=n.hash.split("?"),[Se,We,He]=me.split("/");Se==="#settings"&&We===fe.DataControls&&He===Yi.ArchivedChats&&Ye(t,({onClose:Ae})=>e.jsx(db,{onClose:()=>{Ae(),i(wn(fe.DataControls),{replace:!0})}}))},[t,n.hash,i]);const de=E.status!=="loading",{native_default_factor_id:Z}=E,ue=()=>{if(E.status!=="enabled")throw new Error("MFA is not enabled");if(!Z)throw new Error("No factor ID found");return ie.safePost("/accounts/mfa/user/disable_in_house",{requestBody:{factor_id:Z}})},ye=()=>{ue().then(()=>{R.invalidateQueries({queryKey:["mfaInfo"]}),i(co(uo.DISABLE_MFA_SUCCESS,"/#settings/".concat(fe.Security)))}).catch(()=>{i(co(uo.DISABLE_MFA_TIMEOUT,"/#settings/".concat(fe.Security)))})},re=oe(t,"3325813340");oe(t,"3384364566");const ne=Te(),B=H&&((te=ne==null?void 0:ne.isPersonalAccount())!=null?te:!1);let Y=null;if(P)return de?e.jsx(Bx,{onClose:()=>i("/",{replace:!0}),onConfirm:ye}):null;if(F)return null;if(G)return e.jsx(dx,{onClose:()=>{b(void 0)}});if(_){if(Y=e.jsx(cx,{onClose:()=>{m?(v(!1),y()):i(o,{replace:!0})}}),!m)return Y}else{if(g)return e.jsx(eg,{onClose:()=>i("/",{replace:!0}),referrer:an.ConnectorToggle,toggleAllAfterRedirect:!0});if(j)return e.jsx(Lm,{onClose:me=>{me&&b(me),S(!1)}})}return e.jsxs(e.Fragment,{children:[e.jsx(xe,{testId:"modal-settings",isOpen:!0,onClose:r,size:"custom",className:"max-h-[85vh] max-md:min-h-[60vh] md:h-[600px] md:max-w-[680px]",type:"success",title:s.formatMessage(L.settings),showCloseButton:!0,visuallyHiddenHeader:a,hasSeparator:!0,noPadding:!0,children:e.jsxs(ud,{className:"flex h-[100%] flex-col md:flex-row",value:l!=null?l:fe.General,orientation:a?"vertical":void 0,onValueChange:me=>{c(me)},children:[e.jsxs(md,{className:"bg-token-bg-elevated-secondary border-token-border-light flex shrink-0 flex-row flex-wrap select-none max-md:overflow-x-auto max-md:border-b max-md:p-1.5 md:max-w-[210px] md:min-w-[180px] md:flex-col md:border-e dark:bg-black/10",children:[e.jsx("div",{className:"py-3 ps-2.5 max-md:hidden",children:e.jsx(Ea,{onClick:r})}),e.jsx(At,{value:fe.General,icon:gd,label:e.jsx(d,p({},L.generalTab))}),re&&e.jsx(bx,{}),e.jsx(At,{value:fe.Personalization,icon:om,label:e.jsx(d,p({},L.personalizationTab)),"data-testid":"personalization-tab",onMouseOver:()=>{R.prefetchQuery(im())}}),e.jsx(At,{value:fe.Connectors,icon:xs,label:$?e.jsx(d,p({},L.connectorsTabRevamp)):e.jsx(d,p({},L.connectorsTab))}),D&&e.jsx(At,{value:fe.Schedules,icon:Tr,label:e.jsx(d,p({},L.schedulesTab)),"data-testid":"schedules-tab"}),I&&e.jsx(At,{value:fe.Orders,icon:rm,label:e.jsx(d,{id:"xdSD9Q",defaultMessage:"Orders"}),"data-testid":"orders-tab"}),e.jsx(At,{value:fe.DataControls,icon:lm,label:e.jsx(d,p({},L.dataControlsTab)),"data-testid":"data-controls-tab"}),e.jsx(At,{value:fe.Security,icon:Xm,label:e.jsx(d,p({},L.securityTab)),"data-testid":"security-tab"}),B&&e.jsx(At,{value:fe.ParentalControls,icon:Jm,label:s.formatMessage(et.parentalControlsTab),"data-testid":"amphora-controls-tab"}),!1,e.jsx(At,{value:fe.Account,icon:cm,label:e.jsx(d,p({},L.accountTab)),"data-testid":"account-tab"}),!1]}),e.jsx(kt,{value:fe.General,children:e.jsx(Hb,{})}),re&&e.jsx(kt,{value:fe.Notifications,children:e.jsx(gx,{})}),e.jsx(kt,{value:fe.Personalization,children:e.jsx(Cb,{})}),e.jsx(kt,{value:fe.Connectors,children:$?e.jsx(Yp,{onAddLinkClick:()=>{M({referrer:an.SettingsConnectorsTab,showSettingsBehindConnectorLink:!0}),v(!0)},onCreateCustomConnectorClick:()=>S(!0)}):e.jsx(rp,{})}),e.jsx(kt,{value:fe.DataControls,children:V==="remoteBrowserData"?e.jsx(Xb,{onBack:()=>Q(null)}):e.jsx(Vb,{onOpenRemoteBrowserDataPage:()=>Q("remoteBrowserData")})}),D&&e.jsx(kt,{value:fe.Schedules,children:e.jsx(Kb,{})}),I&&e.jsx(kt,{value:fe.Orders,children:e.jsx(dm,{})}),e.jsx(kt,{value:fe.Security,children:e.jsx(qb,{})}),B&&e.jsx(kt,{value:fe.ParentalControls,children:e.jsx(Vf,{})}),!1,e.jsx(kt,{value:fe.Account,children:e.jsx($b,{})}),!1]})}),Y]})};function Hb(){"use forget";const t=Mt.c(59),s=k(),a=ot(),n=Ne(),o=fd(),i=ee();let r;t[0]!==i?(r=pd(i)&&!Zi(),t[0]=i,t[1]=r):r=t[1];const l=r,{data:c}=vt(ge.ShowLegacyModels),u=bt(),m=Te();let g;t[2]!==i?(g=oe(i,"2991909965"),t[2]=i,t[3]=g):g=t[3];const f=g;let x;t[4]!==i?(x=oe(i,"2036808540"),t[4]=i,t[5]=x):x=t[5];const b=x;let M;t[6]!==i?(M=oe(i,"4230914712"),t[6]=i,t[7]=M):M=t[7];const y=M,C=oe(i,"3315017149");let _;t[8]!==i?(_=()=>yd(i),t[8]=i,t[9]=_):_=t[9];const v=hd(_);let j;t[10]!==m||t[11]!==b||t[12]!==y?(j=(m==null?void 0:m.isEnterprisey())&&b||(m==null?void 0:m.isTeam())&&y,t[10]=m,t[11]=b,t[12]=y,t[13]=j):j=t[13];const S=j;let N;t[14]!==s?(N=s.formatMessage(L.showLegacyModels),t[14]=s,t[15]=N):N=t[15];let w=N,A;t[16]===Symbol.for("react.memo_cache_sentinel")?(A=e.jsx(d,{id:"dw9iMe",defaultMessage:"Please contact your administrator to enable or disable legacy models."}),t[16]=A):A=t[16];let T=A;if(C){let V;t[17]!==s?(V=s.formatMessage(L.showAdditionalModels),t[17]=s,t[18]=V):V=t[18],w=V;let Q;t[19]===Symbol.for("react.memo_cache_sentinel")?(Q=e.jsx(d,{id:"TJwldi",defaultMessage:"Please contact your administrator to enable or disable additional models."}),t[19]=Q):Q=t[19],T=Q}let P;t[20]!==s?(P=s.formatMessage(L.settings),t[20]=s,t[21]=P):P=t[21];let E;t[22]!==o?(E=o&&e.jsx($x,{}),t[22]=o,t[23]=E):E=t[23];let O;t[24]!==o?(O=o&&e.jsx(Jx,{}),t[24]=o,t[25]=O):O=t[25];let D;t[26]!==o?(D=o&&e.jsx(Yx,{}),t[26]=o,t[27]=D):D=t[27];let I;t[28]!==(m==null?void 0:m.id)||t[29]!==i||t[30]!==a||t[31]!==(u==null?void 0:u.email)||t[32]!==v?(I=!1,t[28]=m==null?void 0:m.id,t[29]=i,t[30]=a,t[31]=u==null?void 0:u.email,t[32]=v,t[33]=I):I=t[33];let H;t[34]===Symbol.for("react.memo_cache_sentinel")?(H=e.jsx(K,{children:e.jsx(Fx,{})}),t[34]=H):H=t[34];let $;t[35]!==m||t[36]!==l?($=l&&m&&e.jsx(K,{children:e.jsx(tg,{account:m})}),t[35]=m,t[36]=l,t[37]=$):$=t[37];let X;t[38]!==o?(X=o&&e.jsx(Zx,{}),t[38]=o,t[39]=X):X=t[39];let q,G;t[40]===Symbol.for("react.memo_cache_sentinel")?(q=e.jsx(K,{children:e.jsx(Qb,{})}),G=e.jsx(sg,{}),t[40]=q,t[41]=G):(q=t[40],G=t[41]);let F;t[42]!==f||t[43]!==T||t[44]!==w||t[45]!==n||t[46]!==S||t[47]!==c||t[48]!==a?(F=f&&e.jsx(K,{children:e.jsx(Be,{label:w,enabled:S?!1:!!c,disabled:S,description:S?T:void 0,isLoading:a.isPending,onChange:async V=>{await a.mutateAsync({setting:ge.ShowLegacyModels,value:V}),n.invalidateQueries({queryKey:xd()})}})}),t[42]=f,t[43]=T,t[44]=w,t[45]=n,t[46]=S,t[47]=c,t[48]=a,t[49]=F):F=t[49];let R;return t[50]!==O||t[51]!==D||t[52]!==I||t[53]!==$||t[54]!==X||t[55]!==F||t[56]!==P||t[57]!==E?(R=e.jsxs(Me,{title:P,children:[E,O,D,I,H,$,X,q,G,F]}),t[50]=O,t[51]=D,t[52]=I,t[53]=$,t[54]=X,t[55]=F,t[56]=P,t[57]=E,t[58]=R):R=t[58],R}function zb(){const t=k(),s=ot(),a=Ts.getCookie(Es.DeviceId),{data:n}=vt(ge.PreciseLocationDeviceSettings),o=ag(n,a);return h.useEffect(()=>{o!=null&&(o?ng():og())},[o]),e.jsx(K,{children:e.jsx(Be,{label:t.formatMessage(L.preciseLocationToggleLabel),description:e.jsx(d,p({},L.preciseLocationToggleDescription)),enabled:!!o,onChange:i=>{s.mutate({setting:ge.PreciseLocationDeviceSettings,value:i})}})})}function Vb({onOpenRemoteBrowserDataPage:t}){const s=ee(),a=k(),n=ce(),{pathname:o}=Lt(),i=$e(),r=oe(s,"733205176"),l=oe(s,"1030527215"),c=oe(s,"1363490439"),u=um(js.WorkspaceShareLinks),m=ot(),{data:g}=Ds(),f=Ra(g),x=Ft(ds.isBusinessWorkspace),b=f==null?void 0:f.isTeam(),M=g==null?void 0:g.accountItems.some(T=>T.isPersonalAccount()),y=vr(),C=jr(),_=Sr(),v=_r(s),j=Ne(),{data:S}=vt(ge.EnableRemoteBrowserData),N=()=>{ie.safePatch("/conversations",{requestBody:{is_archived:!0}}).then(()=>{n.info(a.formatMessage(L.archiveHistorySuccess)),ln(j)}),o!=="/"&&i("/",{replace:!0})},w=()=>{ie.safePatch("/conversations",{requestBody:{is_visible:!1},intercomEventOnError:"fetch-error:conversations:delete"}).then(()=>{ln(j)}),o!=="/"&&i("/",{replace:!0})},A=()=>{ie.safeDelete("/agent/browser_context",{}).then(T=>{T.success?n.success(a.formatMessage(L.deleteBrowserContextSuccess)):n.danger(L.deleteBrowserContextError,{toastId:"delete-browser-context-failed"})}).catch(()=>{n.danger(L.deleteBrowserContextError,{toastId:"delete-browser-context-error"})})};return e.jsxs(Me,{title:a.formatMessage(L.dataControlsTab),children:[e.jsx(Ub,{}),r&&e.jsx(K,{children:l?e.jsx(Ia,{label:a.formatMessage(L.remoteBrowserData),stateLabel:S?a.formatMessage({id:"personalizationSettings.on",defaultMessage:"On"}):a.formatMessage({id:"personalizationSettings.off",defaultMessage:"Off"}),onClick:t}):e.jsx(Xe,{color:"danger-outline",label:a.formatMessage(L.deleteBrowserContext),buttonLabel:a.formatMessage(L.deleteBrowserContextButton),onClick:()=>{Ye(s,ul,{onDeleteBrowserContext:A})},"data-testid":"delete-browser-context-button"})}),c&&e.jsx(zb,{}),_&&v&&e.jsx(K,{children:e.jsx(Be,{label:a.formatMessage({id:"APWP2z",defaultMessage:"Enable memory in search"}),enabled:y,onChange:T=>{m.mutate({setting:ge.MemoryInSearch,value:T})},disabled:!C,description:e.jsx(d,{id:"nQ+QoN",defaultMessage:"To be more helpful in getting you more relevant responses, ChatGPT may share disassociated search queries based on past memories with third-party search providers. <link>Learn more</link>",values:{link:T=>e.jsx("a",{href:"https://help.openai.com/en/articles/9237897-chatgpt-search",target:"_blank",className:"underline",rel:"noreferrer",children:T})}})})}),u&&e.jsx(K,{children:e.jsx(Xe,{label:a.formatMessage(L.sharedConversations),buttonLabel:a.formatMessage(L.manageButton),onClick:()=>{Ye(s,Lb)},"data-testid":"manage-shared-conversations-button"})}),e.jsx(K,{children:e.jsx(Xe,{label:a.formatMessage(L.archivedConversations),buttonLabel:a.formatMessage(L.manageButton),onClick:()=>{i(wn(fe.DataControls,{dataControlsRoute:Yi.ArchivedChats}))},"data-testid":"manage-archived-conversations-button"})}),e.jsx(K,{children:e.jsx(Xe,{label:a.formatMessage(L.archiveChatsLabel),buttonLabel:a.formatMessage(L.archiveChatsButton),onClick:()=>{Ye(s,Jb,{onArchiveHistory:N})},"data-testid":"archive-all-chats-button"})}),e.jsx(K,{children:e.jsx(Xe,{color:"danger-outline",label:a.formatMessage(L.deleteChatLabel),buttonLabel:a.formatMessage(L.deleteChatButton),onClick:()=>{Ye(s,Zb,{onDeleteHistory:w})},"data-testid":"delete-all-chats-button"})}),b&&M&&e.jsx(K,{children:e.jsx(Xe,{label:a.formatMessage(L.mergePersonalData),buttonLabel:a.formatMessage(L.mergeButton),onClick:()=>{Ye(s,Rb,{fromSettings:!0})}})}),!x&&e.jsx(K,{children:e.jsx(Xe,{label:a.formatMessage(L.exportData),buttonLabel:a.formatMessage(L.exportButton),onClick:()=>{Ye(s,eM)},"data-testid":"export-data-button"})})]})}function Kb(){"use forget";const t=Mt.c(6),s=k();let a;t[0]!==s?(a=s.formatMessage(L.schedulesTab),t[0]=s,t[1]=a):a=t[1];let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=e.jsx("div",{children:e.jsx(d,{id:"eTC7El",defaultMessage:"ChatGPT can be scheduled to run again after it completes a task. Choose {scheduleIcon} Schedule from the {menuIcon} menu in a conversation to set up future runs.",values:{scheduleIcon:e.jsx(Tr,{className:"-mt-1 inline-block size-4"}),menuIcon:e.jsx(Da,{className:"-mt-1 inline-block size-4"})}})}),t[2]=n):n=t[2];let o;t[3]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsxs("div",{className:"flex flex-col gap-5 py-4",children:[n,e.jsx("div",{children:e.jsx(Vt,{to:"/schedules",className:"hover:bg-token-bg-tertiary rounded-full border px-4 py-2",children:e.jsx(d,{id:"+0oCTk",defaultMessage:"Manage"})})})]}),t[3]=o):o=t[3];let i;return t[4]!==a?(i=e.jsx(Me,{title:a,children:o}),t[4]=a,t[5]=i):i=t[5],i}function qb(){var P,E,O,D;const t=k(),s=ce(),a=ot(),[n,o]=h.useState(null),[i,r]=h.useState(!1),[l,c]=h.useState(!1),u=Or(),{setupMfa:m,removeMfa:g}=rg({}),f=u.status,{session:x}=Xi(),b=x==null?void 0:x.user,{data:M}=vt(ge.EnableDeviceCodeAuth),{data:y}=Ds(),C=Ra(y),_=C==null?void 0:C.features,v=Ft(I=>{var H;return((H=I.currentWorkspace)==null?void 0:H.structure)==="workspace"});Je.addAction("security_settings_has_workspace",{hasWorkspace:v});const j=ee(),S=oe(j,"671926036"),N=!v&&oe(j,"2508433885"),w=eb({enabled:S}),A=f==="enabled"||(b==null?void 0:b.email)!=null&&(_==null?void 0:_.includes(mm))===!0&&(f==="loading"||f==="disabled"),T=h.useCallback(()=>{r(!0),ie.safePost("/accounts/logout_all").then(()=>{s.success(t.formatMessage(L.logoutAllSuccess),{testId:"logout-all-success-toaster"}),Vs()}).catch(I=>{Je.addError(new Error("Failed logging out all accounts: ",{cause:I})),s.danger(L.logoutAllFailed,{hasCloseButton:!0,toastId:"settings_modal_failed_to_log_out_all"}),r(!1)})},[t,s]);return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{title:t.formatMessage(L.securityTab),children:[A&&e.jsx(K,{children:e.jsx(Be,{label:t.formatMessage({id:"settingsModal.toggleMfa",defaultMessage:"Multi-factor authentication"}),enabled:n!=null?n:f==="enabled",disabled:f==="loading",isLoading:f==="loading",onChange:I=>{o(I),I?m():g()},description:e.jsxs(e.Fragment,{children:[f==="disabled"&&e.jsx(d,{id:"settingsModal.toggleMfaDescriptionDisabled",defaultMessage:"Require an extra security challenge when logging in. If you are unable to pass this challenge, you will have the option to recover your account via email."}),f==="enabled"&&e.jsx("a",{className:"underline",target:"_blank",rel:"noreferrer",href:ig,children:e.jsx(d,{id:"settingsModal.toggleMfaDescriptionLearnMore",defaultMessage:"Learn more"})})]})})}),N&&e.jsx(K,{children:e.jsx(Be,{label:t.formatMessage(L.deviceCodeAuthToggleLabel),description:e.jsx(d,p({},L.deviceCodeAuthToggleDescription)),enabled:!!M,disabled:a.isPending,isLoading:a.isPending,onChange:I=>{a.mutate({setting:ge.EnableDeviceCodeAuth,value:I})}})}),S&&!w.isError&&w.data&&e.jsx(K,{children:w.data&&w.data.devices.length>0?e.jsx(Ia,{onClick:()=>c(!0),label:e.jsx(d,p({},L.trustedDevices)),stateLabel:w.data?String(w.data.devices.length):"0"}):e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(d,p({},L.trustedDevices))}),e.jsx(Sn,{children:e.jsx(d,{id:"settingsModal.trustedDevicesEmptyDescription",defaultMessage:"When you sign in on another device, it will be added here and can automatically receive device prompts for signing in."})})]})}),!Zi()&&e.jsx(K,{children:e.jsx(Xe,{label:t.formatMessage(L.logOutLabel),buttonLabel:t.formatMessage(L.logOutButton),onClick:()=>Vs(),"data-testid":"logout-button"})}),e.jsx(K,{children:e.jsx(Xe,{label:e.jsx(d,{id:"settingsModal.logoutAllLabel",defaultMessage:"Log out of all devices"}),color:"danger-outline",buttonLabel:e.jsx("div",{style:{whiteSpace:"nowrap"},children:e.jsx(d,{id:"settingsModal.logoutAllButton",defaultMessage:"Log out all"})}),description:e.jsx(d,{id:"settingsModal.logoutAllDescription",defaultMessage:"Log out of all active sessions across all devices, including your current session. It may take up to 30 minutes for other devices to be logged out."}),onClick:()=>{se.logLogOutButtonClicked({location:"settings_modal_log_out_all"}),T()},disabled:i,testId:"logout-all-button"})})]}),l&&!w.isError&&((P=w==null?void 0:w.data)==null?void 0:P.devices)&&((E=w==null?void 0:w.data)==null?void 0:E.devices.length)>0&&e.jsx(Ib,{devices:(D=(O=w==null?void 0:w.data)==null?void 0:O.devices)!=null?D:[],onClose:()=>c(!1)}),e.jsx(sp,{})]})}function $b(){const t=ee(),s=k(),{data:a}=Ds(),n=Ra(a),o=Ft(ds.isBusinessWorkspace),i=()=>{if(!n)return;const m=n.mustGetSubscriptionBillingCurrency("GlobalSettingsModal");Ye(t,({onClose:g})=>e.jsx(Um,{isOpen:!0,onClose:g,accountId:n.id,initialPlanType:n.data.subscriptionStatus.planType,updatedPlanType:n.data.subscriptionStatus.planType,billingDetails:{currency:m}}))},r=()=>{n&&Ye(t,({onClose:m})=>e.jsx(Mx,{isOpen:!0,onClose:()=>{se.logEventWithStatsig("Cancel Subscription Modal Dismissed","chatgpt_cancel_subscription_modal_dismissed"),m()},onClaimOfferButtonClicked:()=>{se.logEventWithStatsig("Cancel Subscription Modal Claim Offer Button Clicked","chatgpt_cancel_subscription_modal_claim_offer_offer_button_clicked"),m(),l()},currentAccount:n}))},l=()=>{n&&Ye(t,({onClose:m})=>e.jsx(Nx,{onClose:m,onBackButtonClicked:()=>{m(),r()},account:n}))},c=Gb({account:n,context:t});let u=null;if(n&&c){const m=Ht(t,"313799188").get("sync_advertised_features",!1),g=gm({isWebRedesign:m}),f=Sa({isWebRedesign:m}),x=rn({isWebRedesign:m});switch(c){case ke.FREE:u=e.jsx(wx,{});break;case ke.GO:u=e.jsx(tn,{currentAccount:n,onCancelSubscriptionClick:r,onRenewSubscriptionClick:i,pricingPlan:x,showSyncedFeatures:m});break;case ke.PLUS:u=e.jsx(tn,{currentAccount:n,onCancelSubscriptionClick:r,onRenewSubscriptionClick:i,pricingPlan:f,showSyncedFeatures:m});break;case ke.PRO:u=e.jsx(tn,{currentAccount:n,onCancelSubscriptionClick:r,onRenewSubscriptionClick:i,pricingPlan:g,showSyncedFeatures:m});break}}return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{title:s.formatMessage(L.accountTab),children:[u,e.jsx(Ix,{}),!o&&e.jsx(K,{children:e.jsx(Xe,{label:s.formatMessage(L.deleteAccount),buttonLabel:s.formatMessage(L.deleteAccountButton),color:"danger-outline",onClick:()=>{Ye(t,tM)},"data-testid":"delete-account-button"})})]}),n&&e.jsx(ab,{})]})}function Qb(){var c;const t=ee(),s=Cd(t).locale,a=Sd,n=(c=mo(()=>vd()))!=null?c:null,o=mo(()=>navigator.language),i=o==null?null:jd(o),r=[...new Set([n,i])].filter(u=>u!=null),l=a.filter(u=>!r.includes(u));return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx(d,p({},L.locale))}),e.jsxs(Et.Root,{value:n!=null?n:"auto",onValueChange:u=>{se.logEvent("Locale Updated by User",{from_locale:s,to_locale:u,raw_browser_locale:o!=null?o:"",suggested_locale:i!=null?i:""}),Zs.logEvent("chatgpt_locale_updated_by_user",u,{from_locale:s,to_locale:u,raw_browser_locale:o!=null?o:"",suggested_locale:i!=null?i:""}),u==="auto"?fo(null):fo(u)},children:[e.jsxs(Et.Trigger,{children:[e.jsx(Et.Value,{}),e.jsx(Et.Icon,{})]}),e.jsx(Et.Portal,{children:e.jsxs(Et.Content,{side:void 0,sideOffset:void 0,position:"item-aligned",children:[e.jsx(Et.Item,{value:"auto",children:e.jsx(d,p({},L.localeAuto))}),r.map(u=>{var m;return e.jsx(Et.Item,{value:u,children:(m=go[u])!=null?m:u},u)}),e.jsx(Et.Separator,{}),l.map(u=>{var m;return e.jsx(Et.Item,{value:u,children:(m=go[u])!=null?m:u},u)})]})})]})]})}function Yb(){const t=k(),s=ee(),a=Lt(),{pathname:n,hash:o,search:i}=a,r=td(),{closeSettings:l}=ms(),c=h.useRef(!1);return h.useEffect(()=>{Ys(s)||!sd(o)||c.current||(c.current=!0,Gt(s,{callbackUrl:"".concat(n).concat(i).concat(o),fallbackScreenHint:"login",useFallbackScreenHint:!0}))},[s,o,n,i]),h.useEffect(()=>{Zs.logEvent("chatgpt_unauthenticated_settings_modal_shown"),se.logEvent("Unauthenticated Settings Modal Shown")},[]),e.jsx(xe,{testId:"modal-settings-unauth",isOpen:!0,onClose:l,type:"success",showCloseButton:!0,title:t.formatMessage(L.settings),children:e.jsx(K,{children:e.jsx(Be,{label:t.formatMessage({id:"settingsModal.unauthChatTrainingToggleLabel",defaultMessage:"Improve the model for everyone"}),enabled:r,onChange:u=>{ad.setIsNoAuthChatTrainingEnabled(u),se.logEvent("No Auth Chat Training Toggled",{isEnabled:u})},description:e.jsx(d,{id:"rtxsI1",defaultMessage:"Allow your content to be used to train our models, which makes ChatGPT better for you and everyone who uses it. We take steps to protect your privacy. <link>Learn more</link>.",values:{link:u=>e.jsx("a",{href:dl,target:"_blank",className:"underline",rel:"noreferrer",children:u})}})})})})}function Zb({onClose:t,onDeleteHistory:s}){const a=k(),n=yr();return e.jsx(xe,{testId:"modal-confirm-delete-history",isOpen:!0,onClose:t,type:"success",title:a.formatMessage(L.deleteHistoryModalTitle),description:n&&e.jsx(d,{id:"settingsModal.deleteHistoryModalMemoryDisclaimer",defaultMessage:"To clear any memories from your chats, visit your <link>settings</link>.",values:{link:o=>e.jsx(Vt,{onClick:()=>t(),to:wn(fe.Personalization),className:"underline",children:o})}}),primaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.deleteHistoryModalConfirm),color:"danger",onClick:()=>{s(),t()},"data-testid":"confirm-delete-all-chats-button"}),secondaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.deleteHistoryModalCancel),color:"secondary",onClick:t})})}function ul({onClose:t,onDeleteBrowserContext:s}){const a=k();return e.jsx(xe,{testId:"modal-confirm-delete-browser-context",isOpen:!0,onClose:t,type:"success",showCloseButton:!0,title:a.formatMessage(L.deleteBrowserContextModalTitle),description:e.jsx("p",{className:"text-token-text-secondary text-base leading-6",children:e.jsx(d,{id:"settingsModal.deleteBrowserContextModalDescription",defaultMessage:"All cookies and other data from the remote browser will be permanently deleted."})}),primaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.deleteBrowserContextModalConfirm),color:"danger",onClick:()=>{s(),t()},"data-testid":"confirm-delete-browser-context-button"}),secondaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.deleteBrowserContextModalCancel),color:"secondary",onClick:t})})}function Xb({onBack:t}){const s=k(),a=ee(),n=ot(!0),{data:o}=vt(ge.EnableRemoteBrowserData),i=()=>{Ye(a,ul,{onDeleteBrowserContext:()=>ie.safeDelete("/agent/browser_context",{})})};return e.jsxs(Me,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{"aria-label":s.formatMessage({id:"settingsModal.back",defaultMessage:"Back"}),onClick:t,className:"hover:bg-token-bg-tertiary -ms-1 rounded p-1",children:e.jsx(ea,{className:"icon-sm"})}),e.jsx("span",{children:s.formatMessage(L.remoteBrowserData)})]}),children:[e.jsx(K,{children:e.jsx(Be,{label:s.formatMessage(L.remoteBrowserDataKeepLabel),enabled:!!o,onChange:r=>{n.mutate({setting:ge.EnableRemoteBrowserData,value:r})},description:e.jsx(d,p({},L.remoteBrowserDataKeepDescription)),"data-testid":"remote-browser-data-toggle"})}),e.jsx(K,{children:e.jsx(Xe,{color:"danger-outline",label:s.formatMessage(L.deleteBrowserContext),buttonLabel:s.formatMessage(L.deleteBrowserContextButton),onClick:i,"data-testid":"delete-browser-context-button"})})]})}function Jb({onClose:t,onArchiveHistory:s}){const a=k();return e.jsx(xe,{isOpen:!0,testId:"modal-confirm-archive-history",onClose:t,type:"success",title:a.formatMessage(L.archiveHistoryModalTitle),primaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.archiveHistoryModalConfirm),color:"primary",onClick:()=>{s(),t()}}),secondaryButton:e.jsx(Le.Button,{title:a.formatMessage(L.archiveHistoryModalCancel),color:"secondary",onClick:t})})}function eM({onClose:t}){const s=k(),a=ce(),n=h.useCallback(()=>{try{ie.safePost("/accounts/data_export").then(()=>{a.success(s.formatMessage(L.dataExportRequested),{testId:"data-export-success-toaster"}),t()})}catch(o){a.warning(s.formatMessage(L.dataExportFailed),{hasCloseButton:!0})}},[s,a,t]);return e.jsx(xe,{testId:"modal-confirm-export-data",isOpen:!0,onClose:t,type:"success",title:s.formatMessage(L.dataExportModalTitle),primaryButton:e.jsx(Le.Button,{title:s.formatMessage(L.dataExportModalConfirm),color:"primary",onClick:n,"data-testid":"confirm-data-export-button"}),secondaryButton:e.jsx(Le.Button,{title:s.formatMessage(L.dataExportModalCancel),color:"secondary",onClick:t}),children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("ul",{className:"my-3 flex list-disc flex-col gap-1 ps-3",children:[e.jsx("li",{children:e.jsx(d,p({},L.dataExportModalDescription1))}),e.jsx("li",{children:e.jsx(d,p({},L.dataExportModalDescription2))}),e.jsx("li",{children:e.jsx(d,p({},L.dataExportModalDescription3))}),e.jsx("li",{children:e.jsx(d,p({},L.dataExportModalDescription4))})]}),e.jsx("div",{children:e.jsx(d,p({},L.dataExportModalDescription5))})]})})}function tM({onClose:t}){const s=k(),a=ce(),{session:n}=Xi(),o=bt(),i=o==null?void 0:o.email,r=o==null?void 0:o.phone_number,l=i||r||void 0,c=i?L.typeEmailLabel:L.typePhoneNumberLabel,[u,m]=h.useState(""),[g,f]=h.useState(""),x=h.useCallback(()=>{var S;const j=(S=n==null?void 0:n.user)==null?void 0:S.iat;return j===void 0||Date.now()/1e3-j<600},[n]),b=h.useCallback(()=>{try{x()?(se.logEventWithStatsig("Account Deactivated","chatgpt_account_deactivated"),ie.safePost("/accounts/deactivate").then(()=>{Vs()})):a.warning(s.formatMessage(L.deleteAccountSessionTooOld),{hasCloseButton:!0})}catch(v){a.warning(s.formatMessage(L.deleteAccountFailed),{hasCloseButton:!0})}},[s,a,x]),M=h.useCallback(()=>{Vs()},[]),y=g==="DELETE"&&(l===void 0||u.toLowerCase()===l.toLowerCase()),[C]=h.useState(()=>x()),_=bd();return e.jsx(xe,{testId:"modal-confirm-delete-account",isOpen:!0,onClose:t,type:"success",title:s.formatMessage(L.deleteAccountTitle),showCloseButton:!0,children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("ul",{className:"mt-4 mb-6 flex list-disc flex-col gap-1 ps-3",children:[e.jsx("li",{children:e.jsx(d,p({},L.deleteAccountWarning))}),e.jsx("li",{children:e.jsx(d,p({},L.apiAccessDeletionWarning))}),e.jsx("li",{children:e.jsx(d,p({},L.reuseEmailPhoneWarning))}),e.jsx("li",{children:e.jsx(d,p({},L.dataRemovalWarning))}),_&&[ws.CHATGPT_IOS,ws.SORA_IOS].includes(_.purchase_origin_platform)&&e.jsx("li",{children:e.jsx(d,p({},L.iapSubscriptionWarning))}),(_==null?void 0:_.purchase_origin_platform)===ws.MOBILE_ANDROID&&e.jsx("li",{children:e.jsx(d,p({},L.playStoreSubscriptionWarning))}),e.jsx("li",{children:e.jsx(d,J(p({},L.deleteHelpCenter),{values:{article:v=>e.jsx("a",{href:"https://help.openai.com/en/articles/6378407-how-to-delete-your-account",target:"_blank",className:"underline",rel:"noopener noreferrer",children:v})}}))})]}),C?e.jsxs(e.Fragment,{children:[l!=="undefined"?e.jsxs("div",{className:"mb-4",children:[e.jsx(Ko,{htmlFor:"email",children:e.jsx(d,p({},c))}),e.jsx(ks,{ariaLabel:!1,value:u,placeholder:l,name:"email",onChange:v=>{m(v.target.value)}})]}):null,e.jsxs("div",{className:"mb-4",children:[e.jsx(Ko,{htmlFor:"delete",children:e.jsx(d,p({},L.typeDeleteInputLabel))}),e.jsx(ks,{ariaLabel:!1,value:g,onChange:v=>{f(v.target.value)},name:"delete",className:"mb-4"})]}),e.jsx(W,{color:y?"danger":void 0,onClick:b,disabled:!y,fullWidth:!0,icon:y?Pi:Md,children:y?e.jsx(d,p({},L.deleteAccountButtonLabel)):e.jsx(d,p({},L.lockedButtonLabel))})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-tertiary pb-4 text-xs",children:e.jsx(d,p({},L.recentLoginMessage))}),e.jsx(W,{color:"primary",onClick:M,fullWidth:!0,children:e.jsx(d,p({},L.refreshLoginButtonLabel))})]})]})})}var mi;const Ko=Fe.label(mi||(mi=De(["block text-sm font-semibold mb-1"]))),L=ae({showLegacyModels:{id:"settingsModal.showLegacyModels",defaultMessage:"Show legacy models"},showAdditionalModels:{id:"settingsModal.showAdditionalModels",defaultMessage:"Show additional models"},settings:{id:"settingsModal.settings",defaultMessage:"General"},locale:{id:"settingsModal.locale_alpha",defaultMessage:"Language"},localeAuto:{id:"settingsModal.localeAuto",defaultMessage:"Auto-detect"},archivedConversations:{id:"settingsModal.archivedConversations",defaultMessage:"Archived chats"},sharedConversations:{id:"settingsModal.sharedConversations",defaultMessage:"Shared links"},manageButton:{id:"settingsModal.manageButton",defaultMessage:"Manage"},mergePersonalData:{id:"settingsModal.mergePersonalData",defaultMessage:"Merge data from your personal workspace"},mergeButton:{id:"settingsModal.mergeButton",defaultMessage:"Merge"},cookieManagement:{id:"settingsModal.cookieManagement",defaultMessage:"Cookie preferences"},cookieManagementButton:{id:"settingsModal.cookieManagementButton",defaultMessage:"Manage"},exportData:{id:"settingsModal.exportData",defaultMessage:"Export data"},exportButton:{id:"settingsModal.exportButton",defaultMessage:"Export"},deleteAccount:{id:"settingsModal.deleteAccount",defaultMessage:"Delete account"},deleteAccountButton:{id:"settingsModal.deleteButton",defaultMessage:"Delete"},modelStickyForNewChats:{id:"settingsModal.modelStickyForNewChats",defaultMessage:"Start new chats with most recently used model"},trainingAllowedDescription:{id:"Qalmv5",defaultMessage:"Allow your content to be used to train our models, which makes ChatGPT better for you and everyone who uses it. We take steps to protect your privacy. <link>Learn more</link>"},deleteHistoryModalTitle:{id:"settingsModal.deleteHistoryModalTitle",defaultMessage:"Clear your chat history - are you sure?"},deleteHistoryModalConfirm:{id:"settingsModal.deleteHistoryModalConfirm",defaultMessage:"Confirm deletion"},deleteHistoryModalCancel:{id:"settingsModal.deleteHistoryModalCancel",defaultMessage:"Cancel"},archiveHistoryModalTitle:{id:"settingsModal.archiveHistoryModalTitle",defaultMessage:"Archive your chat history - are you sure?"},archiveHistoryModalConfirm:{id:"settingsModal.archiveHistoryModalConfirm",defaultMessage:"Confirm archive"},archiveHistoryModalCancel:{id:"settingsModal.archiveHistoryModalCancel",defaultMessage:"Cancel"},archiveHistorySuccess:{id:"settingsModal.archiveHistorySuccess",defaultMessage:"Successfully archived chats. You can view your archived chats in Settings."},dataExportRequested:{id:"settingsModal.dataExportRequested",defaultMessage:"Successfully exported data. You should receive an email shortly with your data."},dataExportFailed:{id:"settingsModal.dataExportFailed",defaultMessage:"We were unable to process your export at this time. Please try again later."},dataExportModalTitle:{id:"settingsModal.dataExportModalTitle",defaultMessage:"Request data export - are you sure?"},dataExportModalConfirm:{id:"settingsModal.dataExportModalConfirm",defaultMessage:"Confirm export"},dataExportModalCancel:{id:"settingsModal.dataExportModalCancel",defaultMessage:"Cancel"},dataExportModalDescription1:{id:"settingsModal.dataExportModalDescription1",defaultMessage:"Your account details and chats will be included in the export."},dataExportModalDescription2:{id:"settingsModal.dataExportModalDescription2",defaultMessage:"The data will be sent to your registered email in a downloadable file."},dataExportModalDescription3:{id:"settingsModal.dataExportModalDescription3",defaultMessage:"The download link will expire 24 hours after you receive it."},dataExportModalDescription4:{id:"settingsModal.dataExportModalDescription4",defaultMessage:"Processing may take some time. You'll be notified when it's ready."},dataExportModalDescription5:{id:"settingsModal.dataExportModalDescription5",defaultMessage:'To proceed, click "Confirm export" below.'},deleteAccountSessionTooOld:{id:"settingsModal.deleteAccountSessionTooOld",defaultMessage:"Your login session is too old. Please log in again before deleting your account."},deleteAccountFailed:{id:"settingsModal.deleteAccountFailed",defaultMessage:"Failed to delete account. Please try again later."},deleteAccountTitle:{id:"settingsModal.deleteAccountTitle",defaultMessage:"Delete account - are you sure?"},deleteAccountWarning:{id:"settingsModal.deleteAccountWarning",defaultMessage:"Deleting your account is permanent and cannot be undone."},reuseEmailPhoneWarning:{id:"settingsModal.reuseEmailPhoneWarning-2",defaultMessage:"You cannot create a new account using the same email address."},dataRemovalWarning:{id:"settingsModal.dataRemovalWarning-2",defaultMessage:"Your data will be deleted within 30 days, except we may retain a limited set of data for longer where required or permitted by law."},apiAccessDeletionWarning:{id:"settingsModal.apiAccessDeletionWarning-2",defaultMessage:"Deletion will prevent you from accessing OpenAI services, including ChatGPT, API, and DALL·E."},deleteHelpCenter:{id:"settingsModal.deleteHelpCenter",defaultMessage:"Read our <article>help center article</article> for more information."},iapSubscriptionWarning:{id:"settingsModal.iapSubscriptionWarning",defaultMessage:"You will need to cancel your in-app purchase subscription in the Apple App Store. We cannot cancel your subscription for you."},playStoreSubscriptionWarning:{id:"settingsModal.playStoreSubscriptionWarning",defaultMessage:"You will need to cancel your in-app purchase subscription in the Google Play Store. We cannot cancel your subscription for you."},typeEmailLabel:{id:"settingsModal.typeEmailLabel",defaultMessage:"Please type your account email."},typePhoneNumberLabel:{id:"settingsModal.typePhoneNumberLabel",defaultMessage:"Please type your account phone number."},typeDeleteInputLabel:{id:"settingsModal.typeDeleteInputLabel",defaultMessage:'To proceed, type "DELETE" in the input field below.'},lockedButtonLabel:{id:"settingsModal.lockedButtonLabel",defaultMessage:"Locked"},deleteAccountButtonLabel:{id:"settingsModal.deleteAccountButtonLabel",defaultMessage:"Permanently delete my account"},recentLoginMessage:{id:"settingsModal.recentLoginMessage",defaultMessage:"You may only delete your account if you have logged in within the last 10 minutes. Please log in again, then return here to continue."},refreshLoginButtonLabel:{id:"settingsModal.refreshLoginButtonLabel",defaultMessage:"Refresh login"},chatTrainingAllowedToggleLabel:{id:"settingsModal.trainingAllowedToggleLabel",defaultMessage:"Improve the model for everyone"},chatTrainingEnterpriseTooltip:{id:"settingsModal.chatTrainingEnterpriseTooltip",defaultMessage:"ChatGPT Enterprise automatically disables training."},chatTrainingEduTooltip:{id:"settingsModal.chatTrainingEduTooltip",defaultMessage:"ChatGPT Edu automatically disables training."},chatTrainingTeamsTooltip:{id:"settingsModal.chatTrainingTeamsTooltip",defaultMessage:"ChatGPT Business automatically disables training."},preciseLocationToggleLabel:{id:"dataControlsSettings.preciseLocationToggleLabel",defaultMessage:"Share precise location"},preciseLocationToggleDescription:{id:"dataControlsSettings.preciseLocationToggleDescription",defaultMessage:"Allow ChatGPT to use your device's precise location when answering questions."},dataControlsTab:{id:"settingsModal.dataControls",defaultMessage:"Data controls"},schedulesTab:{id:"settingsModal.schedulesTab",defaultMessage:"Schedules"},cookiesTab:{id:"settingsModal.cookies",defaultMessage:"Cookie Preferences"},personalizationTab:{id:"settingsModal.personalization",defaultMessage:"Personalization"},generalTab:{id:"settingsModal.generalTab",defaultMessage:"General"},desktopAppTab:{id:"settingsModal.desktopAppTab",defaultMessage:"App"},connectorsTab:{id:"settingsModal.connectorsTab",defaultMessage:"Connected apps"},connectorsTabRevamp:{id:"settingsModal.connectorsTabRevamp",defaultMessage:"Connectors"},securityTab:{id:"settingsModal.securityTab",defaultMessage:"Security"},accountTab:{id:"settingsModal.accountTab",defaultMessage:"Account"},internalTab:{id:"settingsModal.internalTab",defaultMessage:"Employee Only"},subscriptionTab:{id:"settingsModal.subscriptionTab",defaultMessage:"Subscription"},logoutAllSuccess:{id:"settingsModal.logoutAllSuccess",defaultMessage:"Successfully logged out of all devices."},logoutAllFailed:{id:"settingsModal.logoutAllFailed",defaultMessage:"We were unable to process your request at this time. Please try again later."},deleteChatLabel:{id:"settingsModal.deleteChatLabel",defaultMessage:"Delete all chats"},deleteChatButton:{id:"settingsModal.deleteChatButton",defaultMessage:"Delete all"},logOutLabel:{id:"settingsModal.logOutLabel",defaultMessage:"Log out of this device"},logOutButton:{id:"settingsModal.logoutButton",defaultMessage:"Log out"},trustedDevices:{id:"settingsModal.trustedDevices",defaultMessage:"Trusted Devices"},deviceCodeAuthToggleLabel:{id:"settingsModal.deviceCodeAuthToggleLabel",defaultMessage:"Enable device code authentication"},deviceCodeAuthToggleDescription:{id:"settingsModal.deviceCodeAuthToggleDescription",defaultMessage:"Allow signing in with device codes. Device code authentication can be convenient, but it is prone to phishing attacks, so leave it off unless you trust the request."},archiveChatsLabel:{id:"settingsModal.archiveChatsLabel",defaultMessage:"Archive all chats"},archiveChatsButton:{id:"settingsModal.archiveChatsButton",defaultMessage:"Archive all"},remoteBrowserData:{id:"settingsModal.remoteBrowserData",defaultMessage:"Remote browser data"},remoteBrowserDataKeepLabel:{id:"settingsModal.remoteBrowserDataKeepLabel",defaultMessage:"Remember site data between sessions"},remoteBrowserDataKeepDescription:{id:"settingsModal.remoteBrowserDataKeepDescription",defaultMessage:"Let agent mode's remote browser reuse cookies between sessions."},remoteBrowserDataSitesLabel:{id:"settingsModal.remoteBrowserDataSitesLabel",defaultMessage:"{count} {count, plural, one {site} other {sites}}"},chatHistoryDescription:{id:"settingsModal.chatHistoryDescription",defaultMessage:"Save new chats on this browser to your history and allow them to be used to improve our models. Unsaved chats will be deleted from our systems within 30 days. This setting does not sync across browsers or devices. <link>Learn more</link>"},voiceTrainingAllowedLabel:{id:"settingsModal.voiceTrainingAllowedLabel",defaultMessage:"Include your audio recordings"},videoTrainingAllowedLabel:{id:"settingsModal.videoTrainingAllowedLabel",defaultMessage:"Include your video recordings"},voiceAndVideoTrainingDescription:{id:"settingsModal.voiceAndVideoTrainingDescription",defaultMessage:'Include your audio and video recordings from Voice Mode to train our models. Transcripts and other files are covered by "Improve the model for everyone." <link>Learn more</link>'},accountErrorWarning:{id:"SettingsModalImpl.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},deleteBrowserContext:{id:"settingsModal.deleteBrowserContext",defaultMessage:"Remote browser data"},deleteBrowserContextButton:{id:"settingsModal.deleteBrowserContextButton",defaultMessage:"Delete all"},deleteBrowserContextSuccess:{id:"settingsModal.deleteBrowserContextSuccess",defaultMessage:"Remote browser data deleted successfully."},deleteBrowserContextError:{id:"settingsModal.deleteBrowserContextError",defaultMessage:"Error deleting browser context!"},deleteBrowserContextModalTitle:{id:"settingsModal.deleteBrowserContextModalTitle",defaultMessage:"Delete all browser data?"},deleteBrowserContextModalConfirm:{id:"settingsModal.deleteBrowserContextModalConfirm",defaultMessage:"Delete"},deleteBrowserContextModalCancel:{id:"settingsModal.deleteBrowserContextModalCancel",defaultMessage:"Cancel"},disableRemoteBrowserDataTitle:{id:"settingsModal.disableRemoteBrowserDataTitle",defaultMessage:"Turning off remote browser data?"},disableRemoteBrowserDataDescription:{id:"settingsModal.disableRemoteBrowserDataDescription",defaultMessage:"This will disable cookies and connectors for any active and scheduled tasks."},disableRemoteBrowserDataConfirm:{id:"settingsModal.disableRemoteBrowserDataConfirm",defaultMessage:"OK"},disableRemoteBrowserDataCancel:{id:"settingsModal.disableRemoteBrowserDataCancel",defaultMessage:"Keep on"}});function sM(){const{hash:t}=Lt(),{isOpen:s}=ms(),{isUnauthenticated:a}=fn(),n=$e(),o=_d(t);return h.useEffect(()=>{if(s&&a&&o===fe.Connectors){const i="".concat(window.location.pathname).concat(window.location.hash);n("/auth/login?next=".concat(encodeURIComponent(i)))}},[s,a,o,n]),s?a?e.jsx(Yb,{}):e.jsx(Wb,{}):null}function aM(){const t=k(),[s]=Ba(),a=ce(),n=s.get(fm),o=h.useMemo(()=>n==="true"?t.formatMessage({id:"ogcSBw",defaultMessage:"ChatGPT student offer activated"}):null,[n,t]);return h.useEffect(()=>{o&&a.success(o,{hasCloseButton:!0})},[o,a]),null}const nM=jt(()=>St(()=>import("./i85f14wg6grpyd4s.js"),__vite__mapDeps([16,1,2,3,17,18,4,5])).then(t=>t.FannyPackModalContainer)),oM=jt(()=>St(()=>import("./chlp5hqnerwav69n.js"),__vite__mapDeps([19,1,4,2,3,5,20])));function iM(){const t=Ps(s=>s.sharingModalThreadId);return t?e.jsx(oM,{serverThreadId:t}):null}function d1(){var j,S;const t=Ps(N=>N.purchaseWorkspaceData),s=Ps(N=>N.leaveWorkspaceData),a=t!=null,n=Qi(Wt.GlobalMemoryOnboarding),o=Te(),i=ee();oe(i,"676035580");const{shouldShowTeamSignupLanding:r,shouldShowTeamSignupDirectPurchase:l}=zg(),c=Qg();Em(a);const u=$e(),{isOpen:m,defaultTab:g,defaultTabLoading:f}=sf(),{isFannyPackEnabled:x}=pm();wm();const b=hm(N=>N.researchShareIntent),{isEnabled:M}=Wm(),[y]=Ba(),C=y.get(or),_=xm(C!=null?C:""),v=C&&((S=(j=_.promoMetadata)!=null?j:_.promoError)!=null?S:_.isPromoLoading);return e.jsxs(e.Fragment,{children:[e.jsx(bm,{}),e.jsx(sM,{}),e.jsx(Zg,{}),e.jsx(Cf,{}),e.jsx(vg,{}),r&&e.jsx(Vg,{}),c&&e.jsx(Yg,{}),l&&e.jsx(Pm,{}),m&&o&&!v&&e.jsx(km,{currentAccount:o,defaultTab:g,isDefaultTabLoading:f,onClose:()=>wd(u)},"account-payment-".concat(g)),v&&o&&e.jsx(Jg,{currentAccount:o,promotionData:_}),e.jsx(Mm,{}),e.jsx(_m,{}),a&&e.jsx(Am,p({isOpen:a,onClose:()=>{pt.setPurchaseWorkspaceData(null),u({pathname:location.pathname,search:"",hash:""})}},t)),s&&e.jsx(gg,{workspace:s}),n&&e.jsx(ym,{onClose:()=>pt.closeModal(Wt.GlobalMemoryOnboarding)}),x&&e.jsx(nM,{}),e.jsx(iM,{}),b&&e.jsx(Cg,{taskId:b.taskId,messages:b.messages,threadId:b.threadId}),e.jsx(wg,{}),null,M?e.jsx(aM,{}):null]})}export{d1 as GlobalModalsComponent};
//# sourceMappingURL=fi0bxc5ba4643unk.js.map

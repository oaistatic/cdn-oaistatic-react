const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l58upji5k37aack9.js","assets/fs6h2trisr1juto6.js","assets/cyi7nanrg0vdotzd.js","assets/root-drzjahv8.css","assets/df9u9imhvwerk6zv.js","assets/conversation-small-kx6wglz1.css"])))=>i.map(i=>d[i]);
import{V as K,bw as Q,c4 as W,bH as J,dv as k,cp as me,d as ue,R,bP as ge,bQ as he,dC as X,aA as xe,aM as Y,al as O,bG as _,fD as fe,I as pe,j as Z,c2 as i,P as ee,ej as ve,c6 as je,b$ as Se,l as ye,cD as we,S as be,a as Ge}from"./cyi7nanrg0vdotzd.js";import{e as E,r as G,j as e,M as o,d as N,c as D,b as L,f as ae}from"./fs6h2trisr1juto6.js";import{bn as Ce,cB as U,$ as v,cd as Ie,db as P,U as p,hf as Me,eq as ze,er as ke,es as Pe,bL as Te,hg as te,hh as Ae,dC as Fe,hi as _e,hj as Ee,hk as Ne,ah as B,cQ as se,b4 as ie,gM as De,bl as Le,dM as Ue,al as Oe,dL as Be,dy as He,hl as ne,dB as Ve,a8 as qe,k as $e,hm as Ke,hn as Qe,E as We,G as Je,fR as Re,ho as H,bH as F,hp as V,dw as Xe,a7 as Ye,dm as Ze,hq as ea,g0 as aa}from"./df9u9imhvwerk6zv.js";import{G as ta}from"./k154o6a9h89usuus.js";import{R as sa}from"./mlsnda7myeyy0pj9.js";import{S as ia}from"./m3w8pho33i6vjltk.js";import{S as na}from"./hiayljqmnpspmyun.js";import{F as oa}from"./miqolxcdfcownhv5.js";import{c as ra,d as ca}from"./v5hiekyjowt3msdw.js";import"./kg9pnjn9ianmg7dc.js";import"./e2l59f6c7bsm78ye.js";import"./m7lukv8dnept58g2.js";import"./juans7zh9ytz81kz.js";import"./exwx6mc6hw49alht.js";import"./f3zzw463zuggq6da.js";import"./069jlavvvdusqrfm.js";import"./ms40jzicf31mvoix.js";function da(a){return D({mutationFn:async({message:t,includeFrom:s})=>{await P.sendFeedbackEmail(a,t,s)}})}const la=({gizmo:a})=>{const t=Ce(),s=U(v.GPTFeedbackEmail),c=()=>p.closeModal(v.GPTFeedbackEmail),d=E(),l=K(),[r,x]=G.useState(""),[u,n]=G.useState(!0),h=da(a.gizmo.id),f=r.length===0;return e.jsx(Q,{type:"success",title:d.formatMessage(z.title,{name:a.gizmo.display.name}),isOpen:s,onClose:c,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(Ie,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${a.gizmo.display.name}...`,value:r,rows:4,onChange:m=>x(m.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:m=>n(m.target.checked)}),t&&e.jsx("span",{className:"text-sm",children:e.jsx(o,{...z.includeFrom,values:{email:e.jsx("strong",{children:t.email})}})})]}),e.jsx(W,{color:"primary",disabled:f,onClick:async()=>{await h.mutateAsync({message:r,includeFrom:u}),l.success(d.formatMessage(z.successToast),{duration:3}),c()},children:e.jsx(o,{...z.send,values:{name:a.gizmo.author.display_name}})})]})})})},z=N({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function ma(a){const t=L();return D({mutationFn:async({actionId:s,domain:c,settings:d})=>P.upsertUserActionSettings(s,c,d),onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function ua(a){const t=L();return D({mutationFn:async({pluginId:s})=>{await R.safeDelete("/aip/p/{id}/user-settings",{parameters:{path:{id:s}}})},onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const ga=({gizmo:a})=>{const{data:t,isLoading:s}=Me(a.gizmo.id,!0),c=U(v.GPTPrivacySettings),d=()=>p.closeModal(v.GPTPrivacySettings),l=E(),[r,x]=G.useState("actions"),u=t!=null&&t.settings.some(n=>n.oauth_status!=null&&a.tools.some(h=>h.type===k.JIT_PLUGIN&&h.metadata?.action_id===n.action_id));return r==="connected_accounts"&&!u&&x("actions"),e.jsx(Q,{title:l.formatMessage(j.title),isOpen:c,onClose:d,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(me,{}):e.jsxs(ze,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:r,onValueChange:n=>{x(n)},children:[u&&e.jsxs(ke,{className:ue("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(q,{value:"actions",message:j.actions}),u&&e.jsx(q,{value:"connected_accounts",message:j.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[r==="actions"&&e.jsxs($,{children:[e.jsx(o,{...j.allowedActionsDesc,values:{gizmoName:a.gizmo.display.name}}),t?.settings.map((n,h)=>{const f=a.tools?.find(m=>m.type===k.JIT_PLUGIN&&m.metadata?.action_id===n.action_id);return f&&e.jsx(ha,{gizmoId:a.gizmo.id,actionSettings:n,actionTool:f},h)})]}),r==="connected_accounts"&&e.jsxs($,{children:[e.jsx(o,{...j.connectedAccountsDesc,values:{gizmoName:a.gizmo.display.name}}),e.jsx("div",{children:t?.settings.map((n,h)=>{const f=a.tools?.find(m=>m.type===k.JIT_PLUGIN&&m.metadata?.action_id===n.action_id);return f&&n.oauth_status&&e.jsx(xa,{gizmoId:a.gizmo.id,actionSettings:n,actionTool:f},h)})})]})]})]})})};function q({value:a,message:t}){return e.jsx(Pe,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:a,children:e.jsx("div",{className:"truncate",children:e.jsx(o,{...t})})})}function ha({gizmoId:a,actionSettings:t,actionTool:s}){const c=ma(a),d=t.action_settings?.all,l=r=>{s.metadata?.action_id&&s.metadata?.domain&&c.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:r}})};return e.jsx("div",{children:e.jsxs(oe,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:s.metadata?.domain}),e.jsxs("a",{href:s.metadata?.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(o,{...j.privacyPolicyLink}),e.jsx(Te,{className:"icon-md"})]})]}),e.jsxs("select",{value:d?"always_allow":"unset",onChange:r=>l(r.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(o,{...j.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(o,{...j.askDropdown})})]})]})})}function xa({gizmoId:a,actionSettings:t,actionTool:s}){const c=ua(a),d=t.oauth_status==="valid";return e.jsxs(oe,{children:[e.jsx("div",{className:"font-semibold",children:s?.metadata?.domain}),e.jsx(W,{color:"secondary",size:"small",onClick:()=>{s.metadata?.action_id&&s.metadata?.domain&&(d?c.mutateAsync({pluginId:s.metadata?.action_id}):P.doOAuthRedirect(a,s.metadata?.action_id,s.metadata?.domain,window.location.href))},children:e.jsx(o,{...d?j.logout:j.login})})]})}const $=J.div`flex flex-col gap-6`,oe=J.div`flex flex-row justify-between py-3 items-center`,j=N({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),fa=a=>G.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},G.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.2929 2.29289C16.6834 1.90237 17.3166 1.90237 17.7071 2.29289L20.7071 5.29289C21.0976 5.68342 21.0976 6.31658 20.7071 6.70711L17.7071 9.70711C17.3166 10.0976 16.6834 10.0976 16.2929 9.70711C15.9024 9.31658 15.9024 8.68342 16.2929 8.29289L17.5858 7H10.5C7.46243 7 5 9.46243 5 12.5C5 15.5376 7.46243 18 10.5 18H15C15.5523 18 16 18.4477 16 19C16 19.5523 15.5523 20 15 20H10.5C6.35786 20 3 16.6421 3 12.5C3 8.35786 6.35786 5 10.5 5H17.5858L16.2929 3.70711C15.9024 3.31658 15.9024 2.68342 16.2929 2.29289Z",fill:"currentColor"})),pa=ge(()=>he(()=>import("./l58upji5k37aack9.js"),__vite__mapDeps([0,1,2,3,4,5])).then(a=>a.GizmoKeepInSidebarMenuItem));function La({children:a,clientThreadId:t,gizmoResource:s,showReportModal:c,inMobileHeader:d}){return e.jsxs(e.Fragment,{children:[e.jsx(X,{contentAlign:d?"center":"start",size:"small",triggerButton:a,children:e.jsx(ja,{clientThreadId:t,gizmoResource:s,showReportModal:c})}),e.jsx(va,{gizmoResource:s})]})}function va({gizmoResource:a}){const t=U(v.GPTRemoveThirdParty),s=xe(),c=te(a);return e.jsxs(e.Fragment,{children:[e.jsx(ra,{gizmoId:a.gizmo.id,creatorId:a.gizmo.author.user_id}),e.jsx(ga,{gizmo:a}),c&&e.jsx(la,{gizmo:a}),c&&e.jsx(Ae,{gizmo:a}),e.jsx(sa,{gpt:a,isOpen:t,onClose:()=>p.closeModal(v.GPTRemoveThirdParty),account:s})]})}function ja({clientThreadId:a,gizmoResource:t,showReportModal:s}){const c=Fe(t),d=_e(t),l=Ee(t.gizmo.id),r=Y(),x=Ne(t),u=t.gizmo.share_recipient===B.Marketplace||t.gizmo.share_recipient===B.Link,n=!x&&u,h=O("1825130190").value,f=O("3645668434").value,m=h&&!x&&te(t),T=r?.includes(_.GizmoSupportEmails)&&!x&&t.gizmo.author.will_receive_support_emails&&m,I=fe(),S=pe(a),A=se(_.WorkspaceShareLinks),{isUnauthenticated:M}=Z(),C=A&&S&&!M,y=ae();return e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:()=>{ee.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:t.gizmo.id}),ie(y,`/g/${t.gizmo.short_url}`)},icon:De,children:e.jsx(o,{...g.newChat})}),e.jsx(i.Item,{onClick:()=>p.openModal(v.GPTDetails),icon:Le,children:e.jsx(o,{...g.about})}),t.tools?.find(b=>b.type===k.JIT_PLUGIN)&&e.jsx(i.Item,{onClick:()=>p.openModal(v.GPTPrivacySettings),icon:Ue,children:e.jsx(o,{...g.privacySettings})}),c&&e.jsx(i.Item,{onClick:()=>{y(l)},icon:Oe,children:e.jsx(o,{...g.customize})}),!c&&d&&f&&e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:async()=>{y(`/g/${t.gizmo.id}/view`)},icon:Be,children:e.jsx(o,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(i.Item,{onClick:async()=>{const b=await P.copyGizmo({gizmoId:t.gizmo.id});b.gizmo.id&&y(`/gpts/editor/${b.gizmo.id}`)},icon:ve,children:e.jsx(o,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(pa,{gizmoResource:t,location:"conversation_page"}),e.jsx(ca,{gizmoResource:t}),T&&e.jsx(i.Item,{onClick:()=>p.openModal(v.GPTFeedbackEmail),icon:He,children:e.jsx(o,{...g.feedbackEmail})}),m&&e.jsx(i.Item,{onClick:()=>p.openModal(v.GPTReview),icon:na,children:e.jsx(o,{...g.reviewGPT})}),n&&e.jsx(i.Item,{onClick:s,icon:oa,children:e.jsx(o,{...g.report})}),C&&e.jsx(i.Item,{onClick:()=>p.openSharingModal(S),icon:ne,children:e.jsx(o,{...g.shareChat})}),I&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{color:"danger",onClick:()=>p.openModal(v.GPTRemoveThirdParty),icon:je,children:e.jsx(o,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),r?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>{y(Ve(t))},children:"(Internal) See share page"})]})]})}const Sa=({conversation:a,inMainScreen:t=!1,isActiveConversation:s})=>{const c=Se(),d=a.id,l=a.gizmo_id,r=qe(l),u=Y()?.includes("debug"),n=ye(d),h=se(_.WorkspaceShareLinks),{isUnauthenticated:f}=Z(),m=h&&n&&!f&&!r,T=$e(),I=E();let S=null;const{snorlaxes:A}=Ke();S=A;let M=null;r&&S&&(M=S.find(({gizmo:w})=>w.gizmo.id===l)?.gizmo);const C=Qe(),y=L(),{eligible:b,markAsViewed:re}=We(Je.ArchiveConversationOnboarding),ce=K(),de=ae(),le=async()=>{await R.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:a.id}},requestBody:{is_archived:!0}}),aa(y,a.gizmo_id),be.logEvent("chatgpt_conversation_archived"),ee.logEvent(Ge.conversationArchived),b&&(ce.info(I.formatMessage({defaultMessage:"You can view archived chats in Settings",id:"HistoryGizmoItem.archiveChatOnboarding"}),{duration:10,hasCloseButton:!0}),re()),s&&ie(de)};return e.jsxs(e.Fragment,{children:[m&&e.jsx(i.Item,{onClick:()=>p.openSharingModal(n,"History Item Menu"),icon:ne,"data-testid":"share-chat-menu-item",children:e.jsx(o,{...g.shareChat})}),null,T&&S&&S?.length>0&&Re(l)&&n&&e.jsxs(e.Fragment,{children:[m&&e.jsx(i.Separator,{}),r&&e.jsxs(e.Fragment,{children:[S.length>1&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:H,children:e.jsx(o,{...F.moveConversationToSnorlax})}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(V,{inSidebarFlyout:!1,onUpdateConversationGizmo:w=>{C({newGizmoId:w,conversation:a,previousGizmoId:l})},currentGizmoId:l})})})]}),e.jsx(i.Item,{onClick:()=>{C({newGizmoId:null,conversation:a,previousGizmoId:l})},icon:fa,children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx(o,{...F.removeConversationFromSnorlax,values:{projectName:M?.gizmo.display.name??"project"}})})})]}),!r&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:H,children:I.formatMessage(F.addConversationToSnorlax)}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(V,{inSidebarFlyout:!1,onUpdateConversationGizmo:w=>C({newGizmoId:w,conversation:a,previousGizmoId:l})})})})]}),e.jsx(i.Separator,{})]}),e.jsx(i.Item,{disabled:!n,onClick:()=>{setTimeout(()=>{n&&ta.publish({kind:t?"editTitleInMainScreen":"editTitle",serverThreadId:n})},100)},icon:Xe,children:e.jsx(o,{...g.renameChat})}),e.jsx(i.Item,{disabled:!n,onClick:()=>{n&&le()},icon:ia,children:e.jsx(o,{...g.archiveChat})}),e.jsx(i.Item,{color:"danger",disabled:!n,onClick:()=>{n&&we(c,({closeModal:w})=>e.jsx(Ye,{serverThreadId:n,closeModal:w,isActiveConversation:s}))},icon:Ze,"data-testid":"delete-chat-menu-item",children:e.jsx(o,{...g.deleteChat})}),u&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>p.toggleActiveSidebar("debug"),icon:ea,children:e.jsx(o,{...g.debugChat})})]})]})},Ua=({conversation:a,children:t,onOpenChange:s,inMainScreen:c=!1,isActiveConversation:d,...l})=>{const[r,x]=G.useState(!1);return e.jsx(X,{...l,open:r,onOpenChange:u=>{x(u),s?.(u)},side:"bottom",contentAlign:"start",triggerButton:t,size:"auto",children:r&&e.jsx(Sa,{conversation:a,inMainScreen:c,isActiveConversation:d})})},g=N({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{Ua as GizmoConversationOptionsDropdown,La as GizmoInformationDropdown,ja as GizmoInformationDropdownItems};
//# sourceMappingURL=jg273ro0g3ahinsi.js.map

import{a0 as v,bT as F,E as p,F as c,bU as N,aU as w,eT as l}from"./cyi7nanrg0vdotzd.js";import{w as I,M as U,x,y as O,z as D}from"./df9u9imhvwerk6zv.js";import{u as P,g as V}from"./kg9pnjn9ianmg7dc.js";import{r as G,b as Q}from"./fs6h2trisr1juto6.js";function k({clientThreadId:s,conversationMode:u}){const d=v(),g=G.useContext(I),a=Q(),y=F(),E=P(),H=U.useIsEnabled(s);return({nodeId:r,sourceEvent:C,requestedModelId:t,appendMessages:S,extraStreamParams:e})=>{const i=p(s),f=c.getVariantIds(i,r),o=c.getParentPromptNode(i,r);if(!o)throw new Error("Regeneration must have parent prompt");const T=x(a)??[],h=f?.length===1&&e?.forceUseSearch===void 0,R=N(a,y);let m=[];if(t){const M=O(R?.models,t),_=V({modelConfig:M,systemHints:T,isTemporaryChatEnabled:d}).map(n=>n.systemHint);m=Array.from(E).filter(n=>_.includes(n))}H&&(e={...e??{},enableMessageFollowups:!0});const{systemHints:b,extraStreamParams:A}=D(m,e);g({completionType:w.Variant,requestedModelId:t,sourceEvent:C,completionMetadata:{variantPurpose:h?"comparison_implicit":"none",conversationMode:u??p(s)?.mode,systemHints:b??o.message.metadata?.system_hints,searchSource:e?.forceUseSearch===!0?l.CONVERSATION_REGENERATE_WITH_SEARCH:e?.forceUseSearch===!1?l.CONVERSATION_REGENERATE_WITHOUT_SEARCH:void 0},parentMessageId:o.id,appendMessages:S,extraStreamParams:A})}}export{k as u};
//# sourceMappingURL=b22a1k4ozfgjkxq7.js.map

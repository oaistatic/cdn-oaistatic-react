const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cr0ztnzlclwgbmkh.js","assets/hktzi08skpnyvqmx.js","assets/cyi7nanrg0vdotzd.js","assets/fs6h2trisr1juto6.js","assets/root-drzjahv8.css","assets/df9u9imhvwerk6zv.js","assets/conversation-small-kx6wglz1.css","assets/k154o6a9h89usuus.js","assets/kg9pnjn9ianmg7dc.js","assets/c5d6739obfuxjdsv.js","assets/l2gth51p9bvubvgo.js"])))=>i.map(i=>d[i]);
import{j as e,M as p,h as fs,r as l,a5 as E,R as $,d as Q,b as xs,f as be,e as L,L as Fe,a7 as se,u as hs}from"./fs6h2trisr1juto6.js";import{op as Ae,oi as Oe,ok as gs,l as ve,cP as Be,oq as Re,U as P,I as X,R as ps,gb as h,oh as Se,mh as fe,os as bs,kt as De,hn as ze,me as vs,ot as Ss,ou as js,hx as ys,g0 as Ns,m7 as xe,bM as He,ov as Cs,ow as ws,ox as ks,oy as ne,oz as Ue,oA as Ge,mH as We,go as Is,oB as Ms,dA as Ts,oC as te,r as Ve,bH as ee,ho as _s,oD as de,aa as Ps,kA as Es,a8 as Ls,kp as Fs,cS as As,dG as Os,oE as J,dz as Bs,oF as Rs,oG as Ds,kK as zs,gM as Hs,oH as Us,dI as $e,ak as Gs,aj as Ws,o9 as Vs,oI as ae,k as qe,eb as $s,oJ as qs,oK as Qs,oL as re,hp as Xs,hm as Ks,oM as ue,oN as Ys,oO as Zs,oP as Js,oQ as et,a2 as st,oR as tt,oS as at,on as nt,oo as it,oT as ie,oU as rt,oV as ot,oW as ke,og as lt,bd as ct,g$ as dt,l_ as ut,oX as mt,oY as K,oZ as ft,gY as xt,mU as ht,o_ as gt,o$ as je,p0 as pt,p1 as bt,p2 as vt,p3 as St,p4 as jt,p5 as yt,p6 as Ie,p7 as Nt,p8 as Ct,p9 as wt,B as Qe,af as kt,l4 as It,nE as Mt,l7 as Tt,ld as _t,pa as Pt,pb as Et,pc as Lt,pd as Xe,pe as Ft,pf as At,pg as Ot,gp as Bt,ph as Rt,pi as Dt,dP as zt,pj as Ht}from"./df9u9imhvwerk6zv.js";import{j as H,P as A,er as Ke,a3 as Ye,F as Ze,f as Ut,c4 as q,dw as Gt,d as I,cj as Wt,cl as Vt,cm as $t,co as qt,cQ as Qt,cZ as Xt,c_ as Kt,bH as ye,g5 as Yt,aZ as Je,aq as le,e9 as D,cp as he,bS as z,D as Zt,bQ as ge,al as Jt,b$ as ea,aS as sa,bP as ta,I as es,aA as aa,c$ as Me,dC as na,de as ia,S as oe,a0 as ss,Z as ts,a as pe,gX as ra,c6 as oa,V as la,aM as ca,da,av as ua,eB as ma,aG as Ne,gY as fa,C as xa,h as ha,fF as ga,bJ as as,ci as pa,c3 as ba,bR as va,eW as ns,fk as W,ee as Sa}from"./cyi7nanrg0vdotzd.js";import{n as Ce,o as ja,p as is,l as ya,q as Na,r as Ca,U as wa,s as ka}from"./exwx6mc6hw49alht.js";import{u as Ia,H as Ma,a as Ta}from"./uopuzq7k880bjpaa.js";import{i as _a}from"./k154o6a9h89usuus.js";import{G as rs}from"./e2l59f6c7bsm78ye.js";function Fn({onClick:s,className:t,...a}){return e.jsx(ja,{onClick:s,className:I(t,"flex-grow overflow-hidden"),...a})}function An({onNewChatButtonClick:s}){const{isUnauthenticated:t,isLoading:a}=H();return a||!t?null:e.jsx(Ce,{className:"mr-3",onClick:()=>{A.logNewChatButtonClicked({location:"Mobile header"}),s()}})}function On({onNewChatButtonClick:s,clientThreadId:t}){const{isUnauthenticated:a,isLoading:n}=H(),r=Ae(),i=Ke(t),u=Oe(i),d=Ye(t,Ze.getIsNewConversation),m=Ut(),o=d&&m&&u;if(n)return null;if(a)return r?e.jsx(Ea,{}):e.jsx(Pa,{});const c=e.jsx(Ce,{onClick:()=>{A.logNewChatButtonClicked({location:"Mobile header"}),s()}});return o?e.jsx(gs,{layout:"compact",clientThreadId:t}):c}function Pa(){const s=ve(),t=Be(we.signUpButtonText);return e.jsx(q,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"signup",callback:a=>{A.logSignUpButtonClicked({location:"Mobile Chat Stage Header",provider:a})}})},children:e.jsx(p,{...t})})}function Ea(){const s=ve();return e.jsx(q,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"login",callback:t=>{A.logLogInButtonClicked({location:"Mobile Chat Stage Header",provider:t})}})},"data-testid":"mobile-login-button",children:e.jsx(p,{...Gt.logInButtonText})})}function La({onClick:s}){const t=is(bs,fe,!0,!0);return e.jsxs("button",{type:"button",className:"inline-flex rounded-md hover:text-token-text-primary focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white active:opacity-50",onClick:s,"data-testid":"open-sidebar-button",children:[e.jsx("span",{className:"sr-only",children:e.jsx(p,{...we.openSidebar})}),e.jsx(t,{className:"icon-lg mx-2 text-token-text-secondary"})]})}const Fa=({onOpenSidebar:s,children:t,showNavSidebar:a,leftContent:n,rightContent:r,bottomContent:i})=>{const u=fs(),d=u.pathname+u.search+u.hash;l.useEffect(()=>{Re(window)||P.toggleNavCollapsed(!0)},[d]);const m=X(o=>o.isConversationScrolledFromTop);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:I("draggable sticky top-0 z-10 flex h-header-height items-center justify-center border-transparent bg-token-main-surface-primary pl-0 md:hidden",m?"[box-shadow:var(--sharp-edge-top-shadow)]":"[box-shadow:var(--sharp-edge-top-shadow-placeholder)]"),children:[(a||n)&&e.jsxs("div",{className:"no-draggable absolute bottom-0 left-0 top-0 ml-3 inline-flex items-center justify-center",children:[a&&e.jsx(La,{onClick:s}),n]}),e.jsx("div",{className:"no-draggable",children:t}),r&&e.jsx("div",{className:"no-draggable absolute bottom-0 right-0 top-0 mr-3 inline-flex items-center justify-center",children:r})]}),i&&e.jsx("div",{className:"no-draggable flex w-full items-center justify-center bg-token-main-surface-primary md:hidden",children:i})]})};function Aa({isPopoverOnDesktop:s=!1,children:t}){const a=ps();h.markStart("StageNavigationSidebar"),h.markRendered("StageNavigationSidebar");const n=!a||s;return e.jsxs(e.Fragment,{children:[n?e.jsx(Ba,{children:t}):null,a&&!n&&e.jsx(Oa,{children:t})]})}const os={type:"spring",bounce:.12,duration:.64},Te={...os,duration:.4};function Oa({children:s}){const t=l.useRef(null),a=l.useRef(void 0);return a.current===void 0&&(a.current=Re(window)),a.current&&h.trackNamespace(h.NS_SIDEBAR),e.jsx(E.div,{className:I("z-[21] flex-shrink-0 overflow-x-hidden bg-token-sidebar-surface-primary [view-transition-name:--sidebar-slideover] max-md:!w-0"),ref:t,initial:{width:0},transition:os,animate:{width:260},exit:{width:0},children:e.jsx("div",{className:"h-full w-[260px]",children:e.jsx("div",{className:"flex h-full min-h-0 flex-col",children:s})})})}function Ba({children:s}){const t=Se(),a=X(r=>r.temporaryDisableHoverSidebar),n=$.useRef(null);return e.jsx(Wt,{open:!0,onOpenChange:r=>{r||P.toggleNavCollapsed(!0)},children:e.jsxs(Vt,{forceMount:!0,children:[!t&&e.jsx($t,{asChild:!0,className:"fixed inset-0 z-10 bg-gray-50/50 dark:bg-black/50",children:e.jsx(E.div,{transition:Te,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})}),e.jsx(qt,{asChild:!0,className:"fixed left-0 top-0 z-50 h-full max-w-xs border-r border-gray-200 bg-token-sidebar-surface-primary shadow-[0_0_64px_0_rgba(0,0,0,0.07)] [view-transition-name:--sidebar-popover] focus:outline-none top-banner-visible:bottom-0 top-banner-visible:top-[--top-banner-height,0px] top-banner-visible:h-auto dark:border-gray-800",onMouseLeave:t&&!a?()=>{n.current=window.setTimeout(()=>{P.toggleNavCollapsed(!0,"hover")},200)}:void 0,onMouseEnter:t&&!a?()=>{n.current&&window.clearTimeout(n.current)}:void 0,onOpenAutoFocus:t&&!a?r=>{r.preventDefault()}:void 0,children:e.jsxs(E.div,{transition:Te,initial:{translateX:"-100%"},animate:{translateX:"0"},exit:{translateX:"-100%"},children:[e.jsx(Qt,{asChild:!0,children:e.jsxs(Xt,{children:[e.jsx(p,{...we.sidebarTitle}),e.jsx(Kt,{})]})}),s]})})]})})}const we=Q({sidebarTitle:{id:"navigation.sidebarTitle",defaultMessage:"Sidebar"},closeSidebar:{id:"navigation.closeSidebar",defaultMessage:"Close sidebar"},openSidebar:{id:"navigation.openSidebar",defaultMessage:"Open sidebar"},signUpButtonText:{id:"navigation.signUpButtonText",defaultMessage:"Sign up"}}),_e=Q({unableToLoadHistory:{id:"history.unableToLoad",defaultMessage:"Unable to load history"},retryButton:{id:"history.retryButton",defaultMessage:"Retry"}});function Ra({activeId:s,hideOverflowMenu:t}){const a=xs(),[n,r]=l.useState(!1),[i,u]=l.useState(0),d=Yt(),[m,o]=l.useState(!1),c=De(),f=ze(),{conversations:x,hasNextPage:g,fetchNextPage:v,isLoading:b,isFetchingNextPage:j,isError:S}=vs({}),C=l.useRef(null),w=l.useCallback(y=>{b||y==null||(C.current?.disconnect(),C.current=new IntersectionObserver(U=>{U[0].isIntersecting&&g&&v()}),C.current.observe(y))},[b,g,v]);l.useEffect(()=>()=>{C.current?.disconnect()},[]),l.useMemo(()=>{Je.publish({kind:"refreshHistory",conversations:x})},[x]);const k=x;l.useEffect(()=>{const y=Ss(js(),Date.now());d(()=>{u(i+1)},y+1e3)},[i,d]);const M=k.length===0;h.markStart("History",h.NS_SIDEBAR),le()!=null&&!b&&h.markRendered("History",h.NS_SIDEBAR);const T=Ia(k,i),B=c!=null&&c.kind==="conversation"&&c.gizmoId!=null&&ys(c.gizmoId),F=l.useRef(0);return e.jsxs(za,{$centered:b||S||M,onDragOver:y=>{y.preventDefault(),B&&o(!0)},onDrop:y=>{y.preventDefault(),B&&(F.current=0,o(!1),f({newGizmoId:null,conversation:c.conversation,previousGizmoId:c.gizmoId??null}))},onDragEnter:y=>{y.preventDefault(),B&&(F.current+=1)},onDragLeave:y=>{y.preventDefault(),B&&(F.current-=1,F.current===0&&o(!1))},className:I(m&&"opacity-50"),children:[M&&b&&e.jsx(D,{children:e.jsx(he,{className:"m-auto"})}),M&&S&&e.jsxs("div",{className:"p-3 text-center italic text-token-text-tertiary",children:[e.jsx(p,{..._e.unableToLoadHistory}),!n&&e.jsx("div",{className:"mt-1",children:e.jsx(q,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{r(!0),Ns(a)},children:e.jsx(p,{..._e.retryButton})})})]}),!b&&!M&&e.jsx("div",{children:e.jsx(Ma,{activeId:s,bucketedItems:T,hasNextPage:g,items:k,infiniteScrollTriggerElementRef:w,hideOverflowMenu:t})}),j&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(he,{})})]})}const Da=$.memo(Ra),za=ye.div`flex flex-col gap-2 text-token-text-primary text-sm mt-5 first:mt-0
${({$centered:s})=>[s&&"h-full justify-center items-center empty:hidden"]}`;function ls(){return(_a()?"⌘":"Ctrl")+" K"}function Ha({children:s,sideOffset:t,className:a}){return h.markStart("FannyPackSearchTooltip",h.NS_SIDEBAR),h.markRendered("FannyPackSearchTooltip",h.NS_SIDEBAR),e.jsx(z,{sideOffset:t,className:a,label:e.jsxs("div",{children:[e.jsx(p,{id:"jmd8WH",defaultMessage:"Search chats"}),e.jsx("div",{className:"text-sm font-normal text-token-text-secondary",children:ls()})]}),children:s})}function Ua({className:s}){return l.useEffect(()=>{Zt.addAction("fannypack.web.action_seen"),ge(()=>import("./cr0ztnzlclwgbmkh.js").then(t=>t.d),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))},[]),e.jsx(Ha,{sideOffset:4,className:I("flex",s),children:e.jsx(xe,{"aria-label":ls(),onClick:()=>{ge(()=>import("./cr0ztnzlclwgbmkh.js").then(t=>t.d),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(t=>t.openFannyPackSearch())},icon:He})})}function Pe({isNewConversation:s}){const t=Cs(),{value:a,isLoading:n}=Jt("2113934735");return h.markStart("OperatorSidebarListItem",h.NS_SIDEBAR),!n&&!a?h.cancelRender("OperatorSidebarListItem",h.NS_SIDEBAR):a&&h.markRendered("OperatorSidebarListItem",h.NS_SIDEBAR),e.jsxs(e.Fragment,{children:[e.jsx(Ga,{isNewConversation:s}),null,a?e.jsx(ws,{}):null,t?e.jsx(ks,{}):null]})}const Ga=({isNewConversation:s})=>{const[t,a]=l.useState(!1),n=ea(),r=be(),i=L(),u=le();let d;return u==null?null:(d=We,e.jsx("div",{className:"bg-token-sidebar-surface-primary pt-0",children:e.jsx(z,{side:"right",label:i.formatMessage(ne.newChat),className:"flex w-full items-center",children:e.jsx(E.div,{className:"flex-1",whileTap:{scale:.98},onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)},children:e.jsx(Ue,{loggingGizmoId:"primary",href:"/",isHovered:t,onClick:m=>{!sa(n)&&!s?(m.preventDefault(),Ge(r)):Je.publish({kind:"newChatRequested"})},icon:e.jsx(rs,{isFirstParty:!0,className:"h-6 w-6"}),isMenuOpen:!1,label:d,hoverRightIcon:null})})})}))};function Wa(){const s=L(),t=X(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(E.div,{whileTap:{scale:.98},children:e.jsx(Fe,{to:Is(),onClick:()=>{t.activeSidebar==="popover-nav"&&P.setActiveSidebar(!1)},children:e.jsx(Ms,{icon:Ts,"data-testid":"explore-gpts-button",children:a})},"explore")})}function Va({gizmoResource:s,serverThreadId:t,isOnProjectPage:a,conversations:n,hasNextPage:r=!1}){const i=n??[],u=i.findIndex(o=>o.id===t),d=i.slice(0,te);u!=null&&u>=te&&(d[te-1]=i[u]);const m=r||i.length>te;return e.jsxs("div",{className:"flex flex-col screen-arch:gap-0.5",children:[d.map(o=>e.jsx(Ta,{className:"ml-7 pl-1",item:o,isActive:o.id===t},o.id)),m&&!a&&e.jsx(Fe,{to:Ve(s),className:"group ml-7 flex h-9 items-center gap-2.5 rounded-lg pl-3 pr-2 text-sm tracking-condensed text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:e.jsx("span",{className:"text-left",children:e.jsx(p,{...ee.seeAllChats})})})]})}const $a=ta(()=>ge(()=>import("./c5d6739obfuxjdsv.js"),__vite__mapDeps([9,3,2,4,10])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>e.jsx(cs,{color:s})}),qa={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function Qa({color:s,folderState:t,gizmoId:a,sidebarSnorlaxFolderStore:n}){const r=L(),[i,u]=l.useState(!1);return e.jsx(z,{side:"top",sideOffset:4,delayDuration:600,label:t==="open"?r.formatMessage(ee.hideChatsForProjectTooltip):r.formatMessage(ee.showChatsForProjectTooltip),children:e.jsx("button",{onClick:d=>{d.preventDefault(),t==="open"?n.collapseProject(a):n.expandProject(a)},className:"-m-0.5 flex rounded-xl p-0.5 text-token-text-secondary hover:bg-token-sidebar-surface-tertiary",onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx($a,{isOpen:t==="open",isHovered:i,color:s})})})})})}function cs({color:s}){return e.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center text-token-text-primary",children:e.jsx(_s,{className:"h-3/4 w-3/4",style:{color:s}})})}function ce({gizmo:s,historyDisabled:t,section:a,onClick:n,isActive:r,hideOverflowMenu:i=!1,elementRef:u}){const{clientThreadId:d}=ya(),m=es(d),o=L(),[c,f]=l.useState(!1),[x,g]=l.useState(!1),v=s.gizmo.id,b=de.useStore(),j=de.useState(N=>de.selectFolderState(N,v)),S=aa(),C=!!s.gizmo.tags?.includes(Ps.FirstParty),w=De(),k=ze(),{items:M=[],hasNextPage:O}=Es(s.gizmo.id),_=Ls(v),T=Fs(s),B=As();let F=!1;r&&_&&!(j==="open"&&m)&&(F=!0),l.useEffect(()=>{j!=="open"&&r&&m&&b.expandProject(v)},[r,m,b,v]);let y;if(s!=null)y=s.gizmo.display.name||Os;else{if(S==null)return null;t?y=o.formatMessage(ne.clearChat):y=We}const U=w!=null&&w.kind==="conversation"&&(w.gizmoId==null||w.gizmoId!=v);return e.jsxs(e.Fragment,{children:[e.jsx(E.div,{onMouseEnter:B?()=>{g(!0)}:void 0,onMouseLeave:()=>{g(!1)},onDrop:N=>{N.preventDefault(),U&&(k({newGizmoId:v,conversation:w.conversation,previousGizmoId:w.gizmoId??null}),g(!1))},onDragOver:N=>{N.preventDefault(),U&&g(!0)},onDragLeave:()=>{g(!1)},children:e.jsx(Ue,{loggingGizmoId:s?.gizmo.id??"primary",href:Ve(s),onClick:n,showActiveIndicator:F,isHovered:x,icon:_&&M.length>0?e.jsx(Qa,{color:T,folderState:j,gizmoId:v,sidebarSnorlaxFolderStore:b}):_?e.jsx(cs,{color:T}):e.jsx(rs,{isFirstParty:C,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:c,label:y,rightIcon:a===J.Workspace&&e.jsx(z,{side:"right",label:o.formatMessage(Ee.workspaceRecommended,{workspace_name:S?.name??"Your Workspace"}),children:e.jsx(Bs,{className:"icon-md text-token-text-secondary",alt:o.formatMessage(Ee.workspaceRecommended,{workspace_name:S?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(x||c)&&!i&&(_?e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(Rs,{gizmo:s,isOpen:c,setIsOpen:f})}):e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(Ds,{gizmo:s,isOpen:c,setIsOpen:f,section:a})})),!_&&!i&&e.jsx(z,{side:"right",label:o.formatMessage(t?ne.clearChat:ne.newChat),className:"flex items-center",children:e.jsx("button",{className:c?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:t?e.jsx(zs,{className:"icon-md"}):e.jsx(Hs,{className:"icon-md"})})})]}),elementRef:u})}),e.jsx(se,{initial:!1,children:_&&j==="open"&&M.length>0&&e.jsx(E.div,{initial:"closed",animate:"open",exit:"closed",variants:qa,className:"overflow-hidden",children:e.jsx(Va,{gizmoResource:s,serverThreadId:m,isOnProjectPage:F,conversations:M,hasNextPage:O})},"nested-conversations")})]})}const Ee=Q({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Xa=2;function Ka({gizmos:s,maxToShowOnLoad:t=4,showAllSidebarItems:a}){const n=Vs(s,x=>x.flair.kind),r=[...(n[ae.Workspace]?.map(({resource:x})=>({gizmo:x,section:J.Workspace}))??[]).slice(0,3),...n[ae.FirstParty]?.map(({resource:x})=>({gizmo:x,section:J.Keep}))??[],...n[ae.SidebarKeep]?.map(({resource:x})=>({gizmo:x,section:J.Keep}))??[]],i=n[ae.Recent]??[],d=(a?i:i.slice(0,Xa)).map(({resource:x})=>({gizmo:x,section:J.Recents})),m=r.length;let o=[];o=[...r,...d],a||(o.length>t&&m>t?o=o.slice(0,m):o.length>t&&(o=o.slice(0,t)));const f=s.length>o.length;return{listItems:o,itemsLeft:s.length-o.length,needsToCollapseItems:f,total:s.length}}function Ya({gizmo:s,currentGizmoId:t,maxToShowOnLoad:a,hideOverflowMenu:n=!1}){const r=X(o=>!Us.isGptListCollapsed(o)),{listItems:i,needsToCollapseItems:u,itemsLeft:d}=Ka({gizmos:s,maxToShowOnLoad:a,showAllSidebarItems:r});function m(o,c){return e.jsx(ce,{gizmo:o,isActive:o.gizmo.id===t,section:c,hideOverflowMenu:n},o.gizmo.id)}return e.jsxs("div",{children:[i.map(({gizmo:o,section:c},f)=>e.jsxs(l.Fragment,{children:[f>1&&c!==i[f-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-border-light"}),m(o,c)]},f)),u?e.jsxs("button",{onClick:P.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx($e,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsx(p,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Gs,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:d}}),e.jsx(Ws,{className:"icon-xs"})]})})]}):null,e.jsx(Wa,{})]})}function Za({currentGizmoId:s}){const t=qe(),a=le(),{data:{gizmos:n}={}}=$s();let r=n;t&&(r=n?.filter(d=>!qs(d.resource))),h.markStart("GizmoSidebarList",h.NS_SIDEBAR),r!==void 0&&h.markRendered("GizmoSidebarList",h.NS_SIDEBAR);const i=Me("2152104812","hide_gpts_if_none",!1),u=Me("2152104812","hide_default_gpts",!1);return a?i&&n?.length===0?!u&&e.jsx(Pe,{isNewConversation:!0}):e.jsxs(e.Fragment,{children:[!u&&e.jsx(Pe,{isNewConversation:!0}),e.jsx(Ya,{gizmo:r??[],currentGizmoId:s,maxToShowOnLoad:7})]}):null}function Ja({currentGizmoId:s,onClick:t}){const{isSidebarFlyoutOpen:a,onSidebarFlyoutOpenChange:n}=Qs(),r=a(re.Snorlax);return e.jsx("div",{className:"group flex w-full items-center justify-start",children:e.jsx(na,{onOpenChange:i=>n(re.Snorlax,i),side:"right",sideOffset:4,open:r,contentAlign:"end",triggerButton:e.jsxs("button",{className:I("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-1.5 text-sm tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-sidebar-surface-secondary focus:ring-0 screen-arch:py-[7px] screen-arch:text-body screen-arch:can-hover:hover:bg-token-main-surface-secondary motion-safe:active:scale-[98%] motion-safe:active:transition-transform",r&&"bg-token-main-surface-secondary"),onClick:t,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx($e,{className:"icon-md font-semibold text-token-sidebar-icon"})})}),e.jsx("span",{className:"text-left",children:e.jsx(p,{...ee.seeMoreProjectItems})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(D,{children:e.jsx(Xs,{currentGizmoId:s,inSidebarFlyout:!0,customListItem:ce})})})})})}function en({snorlaxes:s,currentGizmoId:t}){return e.jsx(e.Fragment,{children:s.map(a=>e.jsx(ce,{gizmo:a.gizmo,isActive:a.gizmo.gizmo.id===t},a.gizmo.gizmo.id))})}function sn({currentGizmoId:s,includeRevisedSidebarIa:t}){const a=L(),{snorlaxes:n,data:r,isLoading:i,isError:u,refetch:d,hasNextPage:m}=Ks(),o=n.slice(0,ue),c=l.useRef(!1),[f,x]=l.useState(!0),g=l.useCallback(function(M){M&&x(!1),d()},[d,x]),v=(n??[]).length===0,b=u||r===void 0&&!i&&c.current;h.markStart("SnorlaxSidebarList",h.NS_SIDEBAR),r!=null&&!i&&h.markRendered("SnorlaxSidebarList",h.NS_SIDEBAR),r===void 0&&!i&&!c.current&&(c.current=!0,g(!1));const S=n?.find(k=>k.gizmo.gizmo.id===s),C=o.some(k=>k.gizmo.gizmo.id===s),w=n&&(n?.length>(!s||C?ue:ue+1)||m);return e.jsxs(e.Fragment,{children:[b&&e.jsx(Ys,{showRetry:f,refetch:g}),!b&&e.jsx(Zs,{id:"snorlax-heading",condensed:t,header:e.jsxs(D,{children:[a.formatMessage(ee.projectsHeading),!v&&e.jsx(Js,{})]}),isLastInGroup:!0,ulClassName:"screen-arch:mb-3",children:!i&&e.jsxs(e.Fragment,{children:[e.jsx(en,{snorlaxes:o,currentGizmoId:s}),S&&!C&&e.jsx(ce,{gizmo:S.gizmo,isActive:!0}),w&&e.jsx(Ja,{currentGizmoId:s}),!i&&v&&e.jsx(et,{})]})})]})}function tn({clientThreadId:s}){const t=es(s),{isUnauthenticated:a}=H(),n=Ke(s),r=ss(),i=qe(),[u,d]=l.useState(!1),m=l.useCallback(c=>c===re.Snorlax?u:!1,[u]),o=l.useCallback((c,f)=>{c===re.Snorlax&&d(f)},[]);return e.jsx(at,{value:{isSidebarFlyoutOpen:m,onSidebarFlyoutOpenChange:o},children:e.jsxs("div",{className:"group/sidebar",children:[!a&&e.jsx(Za,{currentGizmoId:n}),i&&e.jsx(sn,{currentGizmoId:n}),null,!a&&e.jsx(Da,{activeId:r?void 0:t})]})})}function Bn({clientThreadId:s}){const{isUnauthenticated:t}=H();return t?null:e.jsx(tn,{clientThreadId:s})}function an({className:s,onNewThread:t}){const a=L(),n=ia(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:r}=st(),i=is(it,nt,!0,!0),u=Na(),d=X(f=>f.isSidebarLocked),m=Se(),o=a.formatMessage({id:"Q6nsOM",defaultMessage:"Close sidebar"}),c=a.formatMessage({id:"FIsqAC",defaultMessage:"Lock sidebar open"});return e.jsxs("div",{className:I("flex",n?.visible&&n.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[d||!m?e.jsx(z,{sideOffset:4,label:o,className:"flex",side:"right",children:e.jsx(xe,{className:"no-draggable","aria-label":o,onClick:()=>{P.toggleNavCollapsed(!0,"button_click"),m&&P.setTemporaryDisableHoverSidebar()},icon:i,mobileIcon:fe,"data-testid":"close-sidebar-button"})}):e.jsx(z,{sideOffset:4,label:c,className:"flex",side:"right",children:e.jsx(xe,{className:"no-draggable","aria-label":c,onClick:()=>{oe.logEvent("chatgpt_web_sidebar_locked"),P.setIsSidebarLocked(!0),P.setTemporaryDisableHoverSidebar()},icon:tt,mobileIcon:fe,"data-testid":"lock-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[u&&e.jsx(Ca,{}),r&&e.jsx(Ua,{}),e.jsx(Ce,{onClick:t,testId:"create-new-chat-button"})]})]})}function nn({showFreeTrialLoadingPayment:s,handleGetPaymentLink:t}){const a=L(),n=()=>{s||(ie(!0),t())},r=g=>{g.stopPropagation(),rt(!0),ot(!0)},{data:i,isLoading:u,isSuccess:d}=hs({queryKey:["claimedReferralInvite"],queryFn:()=>ts.getClaimedReferralInvite(),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1,refetchOnReconnect:!1}),m=i?.invite_code,[o,c]=l.useState(!1);if(l.useEffect(()=>{m&&!o&&d&&(c(!0),oe.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),A.logEvent(pe.chatgptReferralShowClaimedSidebartMenuPromo))},[m,c,o,d]),!m||u||!d)return null;const f=m.invite_metadata.invite_data,x=f?.referral_trial_duration_months?f?.referral_trial_duration_months>1?a.formatMessage(me.monthsOfBenefit,{referralTrialDurationMonths:f?.referral_trial_duration_months}):a.formatMessage(me.daysOfBenefit,{referralTrialDurationDays:f?.referral_trial_duration_days}):null;return e.jsx(E.div,{className:I("relative",{"cursor-progress opacity-50":s}),layout:"position",initial:{y:-10,opacity:1},animate:{y:0,opacity:1,transition:{duration:.1,ease:"easeIn"}},children:e.jsxs(rn,{className:I(s&&"opacity-75"),onClick:n,children:[e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-3",children:[e.jsx(ra,{className:"icon-sm shrink-0"}),e.jsx(p,{...me.freeTrialCta,values:{duration:x}})]}),!s&&e.jsx(oa,{onClick:r,className:"icon-md shrink-0 rounded-full p-0.5 text-token-text-tertiary opacity-50 transition-colors duration-200 hover:bg-[#0077FF] hover:text-red-500 group-hover:opacity-100"}),e.jsx("span",{className:"absolute top-11 h-0 w-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]"})]})})}const rn=ye.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,me=Q({freeTrialCta:{id:"PaymentMenuItems.freeTrialCta",defaultMessage:"Get {duration}!"},monthsOfBenefit:{id:"FreeTrialMenuItem.monthsOfBenefit",defaultMessage:"{referralTrialDurationMonths, plural, one {one month free} other {# months free}}"},daysOfBenefit:{id:"FreeTrialMenuItem.daysOfBenefit",defaultMessage:"{referralTrialDurationDays, plural, one {one day free} other {# days free}}"}});function on(){const s=L(),t=la(),a=ca(),{isLoading:n,data:r}=da(),i=ua(r),u=i?.hasPaidSubscription()??!1,d=i?.hasClaimedFreeTrial()??!1,m=l.useMemo(()=>i?.subscriptionAnalyticsParams,[i]),o=async()=>{ie(!0),A.logEvent(pe.accountPayPaymentCheckoutClicked,m);try{const T=await ts.getCheckoutLink(a,"PaymentMenuItems");window.location.href=T.url}catch{t.warning(s.formatMessage(G.paymentErrorWarning),{hasCloseButton:!0}),ie(!1)}finally{}},c=()=>{x||(ie(!0),o())},f=ke(T=>T.didCloseFreeTrial),x=ke(T=>T.showFreeTrialLoadingPayment),g=!f&&d,v=i?.wasPaidCustomer()??!1;let b=i?.isWorkspaceAccount()??!1;const j=i?.hasPaidSubscription()??!1,S=i?.isPlus()??!1,C=r&&ma(r),{layer:w}=Ne("2670443078");let k=S;!b&&!S&&C&&w.get("is_gating_fix_enabled",!1)&&(k=C,b=!0);const M=!n&&!b,O=be(),_=()=>{A.logEvent(pe.accountPayClickSidebarAccountPay,m),ct(O,"Sidebar account payment menu item")};return e.jsxs(e.Fragment,{children:[!u&&g&&e.jsx(nn,{showFreeTrialLoadingPayment:x,handleGetPaymentLink:o}),M&&e.jsx(wa,{onClick:g?c:_,className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ln,{wasPaidCustomer:v,showFreeTrialLoadingPayment:x,hasPlusSubscription:k,hasPaidSubscription:j})})})})]})}const ln=({wasPaidCustomer:s,showFreeTrialLoadingPayment:t,hasPlusSubscription:a,hasPaidSubscription:n})=>t?e.jsx(he,{className:"icon-sm shrink-0"}):n&&!a?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full border border-token-border-light",children:e.jsx(lt,{className:"icon-sm"})}),e.jsx("div",{className:"flex flex-col",children:s?e.jsx(p,{...G.renewPlus}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a?e.jsx(p,{...G.viewPlans}):!n&&e.jsx(p,{...G.upgradePlan})}),e.jsx("span",{className:"line-clamp-1 text-xs text-token-text-tertiary",children:a?e.jsx(p,{...G.upgradeToProOrTeamUpsell}):!n&&e.jsx(p,{...G.upgradeToPlusUpsell})})]})})]}),G=Q({upgradePlan:{id:"PaymentMenuItems.upgradePlan",defaultMessage:"Upgrade plan"},createATeamWorkspace:{id:"PaymentMenuItems.createATeamWorkspace",defaultMessage:"Add Team workspace"},viewPlans:{id:"PaymentMenuItems.viewPlans",defaultMessage:"View plans"},upgradeToTeamUpsell:{id:"PaymentMenuItems.upgradeToTeamUpsell",defaultMessage:"Collaborate on a Team plan"},upgradeToProOrTeamUpsell:{id:"PaymentMenuItems.upgradeToProOrTeamUpsell",defaultMessage:"Unlimited access, team features, and more"},upgradeToPlusUpsell:{id:"PaymentMenuItems.upgradeToPlusUpsell.0",defaultMessage:"More access to the best models"},renewPlus:{id:"PaymentMenuItems.renewPlus",defaultMessage:"Renew Plus"},inviteReferral:{id:"PaymentMenuItems.inviteReferral",defaultMessage:"Refer a friend"},inviteMembers:{id:"PaymentMenuItems.inviteMembers.0",defaultMessage:"Invite members"},paymentErrorWarning:{id:"PaymentMenuItems.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}});function Rn({navHeader:s,children:t,className:a}){const n=L(),r=l.useRef(null),i=ss(),u=Oe(),d=i&&!u,{isUnauthenticated:m}=H(),{layer:o}=Ne("1578749296"),c=o.get("is_sticky_toggle_off",!1);return l.useEffect(()=>{c&&P.toggleNavCollapsed()},[c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"draggable relative h-full w-full flex-1 items-start border-white/20",children:[e.jsx(fa,{asChild:!0,children:e.jsx("h2",{children:e.jsx(p,{...V.chatHistoryLabel})})}),e.jsxs("nav",{className:I("flex h-full w-full flex-col pl-3",a),"aria-label":n.formatMessage(V.chatHistoryLabel),children:[s,e.jsx(dn,{ref:r,$disableScroll:d&&!m,children:t}),e.jsx(D,{children:e.jsx("div",{className:"pr-3",children:e.jsx(cn,{})})})]})]})})}function cn(){const[s]=l.useState(()=>{const i=xa.getCookie(ha.Workspace);return typeof i=="string"&&i!==ga}),t=le(),{isUnauthenticated:a}=H(),{openSettings:n}=dt(),r=ut();return s&&!t||!t?null:a?e.jsx(ds,{}):e.jsxs("div",{className:I("flex flex-col py-2 empty:hidden dark:border-white/20"),children:[e.jsx(mt,{}),e.jsx(on,{}),r&&e.jsx("div",{className:"flex w-full items-center md:hidden",children:e.jsx("div",{className:"max-w-[100%] grow",children:e.jsx(ka,{onClickSettings:()=>n()})})})]})}const ds=()=>{const s=Ae(),t=ve(),a=Be(V.unauthSignupCta),n=()=>{t({authType:"login",callback:d=>{A.logLogInButtonClicked({location:"Sidebar bottom unit",provider:d}),oe.logEvent("chatgpt_sidebar_login_button_clicked")}})},r=()=>{t({authType:"signup",callback:d=>{A.logSignUpButtonClicked({location:"Sidebar bottom unit",provider:d}),oe.logEvent("chatgpt_sidebar_signup_button_clicked")}})},i=e.jsx(q,{as:"button",size:"medium",color:s?"secondary":"primary","data-testid":"signup-button",onClick:r,children:e.jsx(p,{...a})},"signup-button"),u=e.jsx(q,{as:"button",size:"medium",color:s?"primary":"secondary","data-testid":"login-button",onClick:n,children:e.jsx(p,{...V.unauthLoginCta})},"login-button");return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"mb-4 mt-2",children:[e.jsx("p",{className:"mb-1 text-sm font-semibold text-token-text-primary",children:e.jsx(p,{...s?V.logInOrSignUp:V.signUpOrLogIn})}),e.jsx("p",{className:"text-sm text-token-text-secondary",children:e.jsx(p,{id:"tr+zlt",defaultMessage:"Get smarter responses, upload files and images, and save your conversations."})})]}),e.jsx("div",{className:"flex flex-row items-start gap-2",children:s?[u,i]:[i,u]})]})},dn=ye.div`flex-col flex-1 transition-opacity duration-500 relative pr-3
  ${({$disableScroll:s})=>s?"overflow-y-hidden opacity-20 pointer-events-none":"overflow-y-auto"}`,V=Q({chatHistoryLabel:{id:"NavigationContent.chatHistoryLabel",defaultMessage:"Chat history"},closeSidebar:{id:"NavigationContent.closeSidebar",defaultMessage:"Close sidebar"},signInToChat:{id:"NavigationContent.signInToChat",defaultMessage:"Sign in to ChatGPT"},signUpOrLogIn:{id:"NavigationContent.signUpOrLogIn",defaultMessage:"Sign up or log in"},logInOrSignUp:{id:"NavigationContent.logInOrSignUp",defaultMessage:"Log in or sign up for free"},unauthSignupCta:{id:"NavigationContent.unauthSignupCta",defaultMessage:"Sign up"},unauthLoginCta:{id:"NavigationContent.unauthLoginCta",defaultMessage:"Log in"}}),un=()=>{const s=be();return e.jsxs("div",{className:"flex h-full flex-col gap-2 p-3",children:[e.jsx(an,{className:"flex h-header-height items-center xs:pr-3",onNewThread:()=>{Ge(s)}}),e.jsx(mn,{}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ds,{})})]})},us="border border-token-border-xlight bg-token-sidebar-surface-secondary";function R({className:s,width:t}){return e.jsx("div",{className:I("h-2.5 grow rounded",us,s),style:{maxWidth:t+"px"}})}function mn(){const s=e.jsx("div",{className:I("h-4 w-4 shrink-0 grow-0 rounded-full",us)});return e.jsxs("div",{className:"mt-2 flex w-full grow flex-col gap-4 overflow-hidden px-2",style:{maskImage:"linear-gradient(to bottom, black 50%, transparent 100%)",WebkitMaskImage:"linear-gradient(to bottom, black 50%, transparent 100%)"},children:[e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:80})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:120})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:100})]}),e.jsx("div",{className:"mt-5 flex flex-row items-center justify-start gap-3",children:e.jsx(R,{width:150})}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:50})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:100})]}),e.jsxs("div",{className:"mb-5 flex flex-row items-center justify-start gap-3",children:[s,e.jsx(R,{width:80})]}),[120,180,160,100,90,190,140,120,180,170,100,120,180,150].map((t,a)=>e.jsx("div",{className:"flex flex-row items-center justify-start py-1",children:e.jsx(R,{width:t})},a))]})}function fn({children:s}){return e.jsx("div",{className:"h-full w-full bg-token-main-surface-primary px-[22px] py-4",children:s})}function xn(){return e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx(K,{className:"h-full w-full !rounded-full"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(K,{}),e.jsx(K,{}),e.jsx(K,{}),e.jsx(K,{})]})]})}function Y({icon:s,message:t,iconClassName:a}){return e.jsx("div",{className:"loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",children:e.jsx(je,{fillIcon:!1,icon:s,className:a,children:e.jsx("div",{className:"mt-[.5px] flex h-10",children:t})})})}const hn=({finalRow:s})=>{const t=L(),a=s.type==="fileOpen"?ft[s.iconType]??xt:null;return e.jsx(se,{children:e.jsx(E.div,{layout:!0,transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-start justify-start gap-4",children:s.type==="search"?e.jsx(Y,{icon:e.jsx(He,{className:"relative h-5 w-5 text-token-text-primary opacity-50"}),message:t.formatMessage({id:"f9wsyE",defaultMessage:"Searching…"})}):s.type==="websiteOpen"?e.jsx(Y,{icon:e.jsx(ht,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"8L6BBp",defaultMessage:"Reading…"})}):s.type==="fileOpen"?e.jsx(Y,{icon:e.jsx(a,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"h5M4/O",defaultMessage:"Reading file…"})}):s.type==="pythonAnalysis"?e.jsx(Y,{icon:e.jsx(gt,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"jZ7gNw",defaultMessage:"Analyzing…"})}):e.jsx(Y,{icon:e.jsx(as,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"bSPYmC",defaultMessage:"Thinking…"})})})})};function Z({children:s}){return e.jsx(E.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:s})}const gn=({previousRow:s,currentRow:t})=>e.jsx("div",{className:"flex flex-col items-start justify-start gap-4",children:t.type==="search"?e.jsx(Z,{children:e.jsx(pt,{row:t,showIcon:!s||s.type!=="search"})},`search_${t.id}`):t.type==="summary"?e.jsx(Z,{children:e.jsx(bt,{row:t,showIcon:!s||s.type!=="summary"})},`summary_${t.id}`):t.type==="websiteOpen"?e.jsx(Z,{children:e.jsx(vt,{website:t})},`website_${t.id}`):t.type==="fileOpen"?e.jsx(Z,{children:e.jsx(St,{row:t})},`file_${t.id}`):t.type==="pythonAnalysis"?e.jsx(Z,{children:e.jsx(jt,{row:t})},`python_${t.id}`):null}),pn=120,bn=1e3*60*2;function Le(s){s?.scrollIntoView({block:"center",behavior:"smooth"})}function vn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Qe,{type:"error",title:s.failureMessage,content:s.failureBannerContentMessage})})}function Sn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Qe,{title:s.cancelledMessage,content:""})})}function jn({interruptPrompt:s,setInterruptPrompt:t,handleInterruptCaterpillar:a}){const n=L();return e.jsxs("div",{className:"flex w-full flex-col justify-center gap-4 p-4",children:[e.jsx(kt,{ariaLabel:n.formatMessage({id:"aYWRtV",defaultMessage:"Press enter to interrupt task"}),name:"interrupt-caterpillar-prompt",value:s,onChange:r=>t(r.target.value),color:"search",onPressEnter:a}),e.jsx(q,{onClick:a,children:e.jsx(p,{id:"h73FdF",defaultMessage:"Interrupt task"})})]})}function yn({sourcesCount:s,taskInfo:t}){const a=Ye(t.originalConversationId,r=>Ze.findNode(r,i=>i.message.metadata?.b1de6e2_s===!0&&i.message.metadata?.async_task_id===t.taskId)?.message.metadata?.async_task_status_messages),n=l.useMemo(()=>a?.completed_no_time?e.jsxs(e.Fragment,{children:[a?.completed_with_time??a?.completed_no_time,e.jsx(p,{id:"zxfmo/",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:s}})]}):e.jsx(p,{id:"YG7a0T",defaultMessage:"Completed · {sourcesCount} sources",values:{sourcesCount:s}}),[s,a]);return!t.updatedAt&&!a?.completed?null:e.jsx(je,{icon:e.jsx(ba,{className:"text-token-text-secondary"}),fillIcon:!1,children:e.jsx("div",{className:"text-token-text-tertiary",children:n})})}function Nn({taskInfo:s,caterpillarStatusMessageTexts:t,sourcesCount:a,caterpillarHeaderRef:n}){const[r,i]=l.useState(""),[u,d]=l.useState(!1),m=pa("caterpillar-interrupts"),o=l.useRef(!1),c=l.useRef(null),f=l.useMemo(()=>(o.current=!!c.current&&yt(c.current,pn),s.rows??[]),[s.rows]);l.useEffect(()=>{if(f.length===0){const j=new Date(s.createdAt).getTime(),S=Date.now()-j,C=bn-S;if(C>0){const w=setTimeout(()=>{d(!0)},C);return()=>clearTimeout(w)}else d(!0)}else d(!1)},[f,s.createdAt]),l.useEffect(()=>{o.current&&Le(c.current)},[f]),l.useEffect(()=>{Ie(s)||setTimeout(()=>{c.current&&Le(c.current)},100)},[]);const x=Nt({taskId:s.taskId,prompt:r}),g=Ie(s)||Ct(s),v=l.useCallback(async()=>{await x.mutateAsync(),i("")},[x,i]),b=l.useMemo(()=>f.length?g?f:f.slice(0,f.length-1):f,[f,g]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{ref:n},"task-header"),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"text-base font-medium",children:s.title}),f.length?e.jsxs(se,{initial:!1,children:[b.map((j,S)=>e.jsx(gn,{previousRow:S>0?f[S-1]:null,currentRow:j},j.id)),!g&&e.jsx(hn,{finalRow:f[f.length-1]})]}):u?e.jsx(je,{fillIcon:!1,icon:e.jsx(as,{className:"inline-flex h-5 w-5 items-center justify-center text-token-text-primary"}),children:t.waitingInQueueMessage}):e.jsx(xn,{}),wt(s)&&m&&e.jsx(jn,{interruptPrompt:r,setInterruptPrompt:i,handleInterruptCaterpillar:v}),s.status==="failed"?e.jsx(vn,{caterpillarStatusMessageTexts:t}):s.status==="cancelled"?e.jsx(Sn,{caterpillarStatusMessageTexts:t}):s.status==="completed"?e.jsx(yn,{caterpillarStatusMessageTexts:t,taskInfo:s,sourcesCount:a}):null]}),e.jsx("div",{ref:c},"task-footer")]})}function Cn({taskId:s,setWidth:t=void 0,initialTab:a}){const n=It(x=>Mt.getTask(s,x)),{closeThreadSidebar:r}=va(),[i,u]=l.useState(a),d=Tt(),m=l.useRef(null),o=!1;l.useEffect(()=>{u(a)},[a]),l.useEffect(()=>{},[n?.taskId,n?.status,o]),l.useEffect(()=>{},[n?.taskId,n?.status,i]),l.useEffect(()=>{},[t,n,o]);const{uniqueSources:c,totalSources:f}=l.useMemo(()=>{if(!n?.rows)return{uniqueSources:[],totalSources:0};const x=_t(n.rows),g=x.reduce((v,b)=>v+b.count,0);return{uniqueSources:x,totalSources:g}},[n?.rows]);return e.jsx(Pt,{handleClose:r,leading:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Et,{activeTab:i,setActiveTab:u,showAuxTab:o,sourcesCount:f,caterpillarHeaderRef:m})}),children:n&&e.jsxs(fn,{children:[!1,i==="activity"&&e.jsx(Nn,{taskInfo:n,caterpillarStatusMessageTexts:d,sourcesCount:f,caterpillarHeaderRef:m}),i==="sources"&&e.jsx(Lt,{taskInfo:n,sources:c,caterpillarHeaderRef:m})]})})}function wn({isExpanded:s,children:t}){const a=l.useRef(null),[n,r]=l.useState("400px"),i=$.isValidElement(t)?$.cloneElement(t,{setWidth:r}):t;return e.jsx(se,{children:e.jsx(E.div,{className:"relative z-[1] flex-shrink-0 overflow-x-hidden bg-token-sidebar-surface-primary max-lg:!w-0",ref:a,initial:!1,animate:{width:s?n:0,transition:{type:"spring",bounce:.12,duration:.3}},onAnimationStart:()=>{a.current&&(a.current.style.visibility="visible")},onAnimationComplete:()=>{a.current&&(s||(a.current.style.visibility="hidden"))},children:e.jsx("div",{className:I("absolute h-full",!s&&"pointer-events-none"),style:{width:n},children:e.jsx("div",{className:"flex h-full flex-col",children:i})})})})}const Dn=({setWidth:s,clientThreadId:t})=>{const a=ns(),n=Xe();return a?e.jsxs(e.Fragment,{children:[W(a,"searchSources")&&e.jsx(Ft,{clientThreadId:t}),W(a,"retrievalResults")&&e.jsx(At,{clientThreadId:t}),n&&W(a,"summarizer")&&e.jsx(Ot,{clientThreadId:t}),W(a,"caterpillar")&&e.jsx(Cn,{taskId:a.caterpillarId,initialTab:a.initialTab,setWidth:s}),!1]}):null};function ms({children:s,hideNavigation:t=!1,mobileHeaderContent:a,mobileHeaderLeftContent:n,mobileHeaderRightContent:r,mobileHeaderBottomContent:i,renderNavSidebar:u,threadFlyout:d,forceOpenDesktopSidebar:m=!1}){const{isUnauthenticated:o}=H(),[c,f,x,g]=X(N=>[N.activeStageSidebar,N.activeSidebar,N.isSidebarLocked,N.temporaryDisableHoverSidebar]),v=Se(),b=Sa(),j=ns(),S=Bt(),C=[];let w=null;$.Children.forEach(s,N=>{$.isValidElement(N)&&(N.type===ms.Sidebars?w=N:C.push(N))});const{layer:k}=Ne("3737571708"),M=k.get("sidebar_type","slick"),O=(!o||M==="heavy")&&!t&&u!=null,_=!t&&(O||o),T=Xe(),B=j?W(j,"summarizer")&&T:!1,F=j?!W(j,"summarizer"):!1,y=b&&(B||F),U=O&&(m||!S);return e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsx(D,{children:e.jsx(Rt,{})}),e.jsxs("div",{className:I("relative flex h-full w-full flex-1 overflow-hidden transition-colors",f!=="popover-nav"&&"z-0"),children:[e.jsxs("div",{className:"relative flex h-full w-full flex-row overflow-hidden",children:[e.jsx(se,{initial:!1,children:U&&e.jsx(Aa,{isPopoverOnDesktop:c||v&&!x,children:o?e.jsx(un,{}):u()})}),e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col overflow-hidden",children:[_&&e.jsxs(D,{children:[e.jsx(Dt,{}),e.jsx(Fa,{onOpenSidebar:()=>P.toggleNavCollapsed(),showNavSidebar:O,leftContent:n,rightContent:r,bottomContent:i,children:a})]}),e.jsx("main",{className:"relative h-full w-full flex-1 overflow-auto transition-width",children:C})]})]}),e.jsx(D,{children:e.jsx(wn,{isExpanded:y,children:d})}),w]}),e.jsx(D,{children:e.jsx(zt,{useManuallyControlledVisibility:!0})}),v&&S&&!g&&e.jsx(Ht,{})]})}function kn({children:s}){return e.jsx(e.Fragment,{children:s})}ms.Sidebars=kn;export{Bn as C,Dn as F,Za as G,Da as H,Rn as N,ms as S,An as a,On as b,an as c,sn as d,Fn as e};
//# sourceMappingURL=wywpfzigeej0marp.js.map

import{r as p,j as i,M as E,e as D,R as G,a as V,o as On,L as Hn,b as Wn,d as Ut,f as he,u as Bn}from"./fs6h2trisr1juto6.js";import{W as $t,am as Ln,a3 as nt,M as Un,g as qe,L as ze,P as j,a as R,aF as st,de as $n,bF as at,aM as Kt,bG as Kn,gL as ot,H as qn,F as Ge,y as zn,eM as Gn,gQ as ye,gR as Vn,eO as qt,gS as Re,gT as De,gU as Qn,eQ as Yn,eP as Xn,gV as Jn,eN as Zn,cz as es,d9 as ts,dy as ns,d as $,eI as ss,l as yt,gW as as,n as os,aD as is,j as Ee,bH as ve,da as Te,av as it,V as rs,c0 as ls,dU as cs,dT as us,c2 as k,cp as Ve,c3 as ds,fQ as fs,bS as ie,e as ms,v as ps,dE as gs,R as zt,A as hs,al as vs,bw as xs,eS as Ss,aq as ws,aA as ys,aG as fe,eB as bs,dC as Ms,S as Gt,I as Cs,a0 as Vt,c4 as Qe}from"./cyi7nanrg0vdotzd.js";import{G as Qt,E as rt,B as Is,hQ as lt,hR as ct,l9 as ks,nD as Es,g7 as Yt,l6 as Ts,l4 as js,nE as Ps,nF as Ns,nG as _s,aR as Q,at as _,nH as Xt,am as bt,an as ee,ao as je,ay as As,aZ as Rs,a_ as Ds,aB as Fs,aC as Jt,aD as Ie,aE as te,aQ as Os,a$ as N,nI as A,b0 as Hs,aF as Ws,aG as Bs,aH as Ls,aJ as Zt,aI as Us,aq as $s,aN as Ks,aO as qs,aS as zs,aT as Gs,nJ as Vs,nK as Qs,nL as Ys,nM as Xs,aV as Mt,nN as en,aW as Js,aP as Zs,aY as ea,nO as ta,nP as na,nQ as sa,nR as tn,nS as aa,nT as oa,nU as Fe,nV as ia,nW as ra,nX as la,nY as nn,mm as ca,gD as ua,nZ as da,eg as fa,bT as ma,n_ as pa,ng as ga,Q as ha,eJ as va,e8 as xa,y as Sa,a3 as ut,gG as wa,nr as ya,n$ as ba,l as sn,bn as Pe,lY as dt,bo as an,cH as Ma,U as L,by as Ct,dM as Ca,dI as Ia,R as on,o0 as ft,o1 as rn,o2 as ln,o3 as cn,gZ as ka,bL as Ea,al as mt,$ as un,lX as dn,o4 as fn,o5 as mn,gk as Ta,o6 as ja,bd as pn,dH as Pa,o7 as Na,cw as _a,o8 as Aa,m7 as me,o9 as Ra,oa as Da,ob as Fa,oc as Oa,cj as Ha,od as Wa,g$ as Ba,I as pt,oe as La,gp as gn,of as Ua,og as $a,oh as hn,mX as Ka,oi as vn,a8 as qa,oj as za,ok as Ga,ol as It,om as Va,gb as kt,kK as Et,gM as Tt,on as Qa,oo as Ya,op as Xa,cP as Ja,oq as Za}from"./df9u9imhvwerk6zv.js";import{f as eo,a as to,T as no}from"./kg9pnjn9ianmg7dc.js";import{t as so,u as xn}from"./f3zzw463zuggq6da.js";import{a as ne,P as re,b as ao,D as oo,T as be,p as io,M as ro,k as Ye,d as jt,S as lo,E as co,e as uo,g as fo,i as mo,n as po,h as go}from"./069jlavvvdusqrfm.js";const Sn=Qt.DesktopBrowserExtensionAnnouncement,wn=Qt.DesktopBrowserExtensionReactiveAnnouncement,ho=5,gt="https://chromewebstore.google.com/detail/searchgpt/ejcfepkfckglbgocfkanmcdngdijcgld";function vo({announcementKey:e=Sn,onClose:t}){p.useEffect(()=>{j.logEventWithStatsig(R.chatgptBrowserExtensionAnnouncementShown,"chatgpt_browser_extension_announcement_shown")},[]);const{markAsViewed:n}=rt(e),s=p.useCallback(()=>{n(),j.logEventWithStatsig(R.chatgptBrowserExtensionAnnouncementClosed,"chatgpt_browser_extension_announcement_closed"),t&&t()},[n,t]),a=p.useCallback(()=>{j.logEventWithStatsig(R.chatgptBrowserExtensionAnnouncementCTAClicked,"chatgpt_browser_extension_announcement_cta_clicked"),n(),t&&t()},[n,t]);return i.jsx(xo,{downloadUrl:gt,announcementKey:e,handleCTAClicked:a,handleClose:s})}function yr({onClose:e}){return vo({announcementKey:wn,onClose:e})}function xo({downloadUrl:e,announcementKey:t,handleCTAClicked:n,handleClose:s}){const a=()=>{n(),window.open(e)},o=i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:"mb-0.5 font-semibold",children:i.jsx(E,{id:"uAZwaE",defaultMessage:"Use ChatGPT for every search"})}),i.jsx("span",{className:"text-token-text-secondary",children:i.jsx(E,{id:"+wTq4L",defaultMessage:"Download the Chrome extension to switch your default search engine to ChatGPT, and get instant answers from trusted sources with every search."})})]});return i.jsx(Is,{onPrimaryCtaClick:a,primaryCtaText:i.jsx(E,{id:"x9mKG0",defaultMessage:"Get Extension"}),onDismiss:()=>s(t),content:o})}function yn(e){const{value:t}=st("2634628831"),n=$n(()=>document.documentElement.dataset.searchExtension==="1"),s=lt(e.clientThreadId),a=ct(s,at.Search),r=!Kt()?.includes(Kn.SearchToolHoldout),{userIsInSearchHoldoutWithWebDisabled:l}=eo();return ot()&&!n&&a&&r&&!l&&t}function br(e){const t=yn(e),n=So(),s=rt(Sn);return s.eligible&&!s.isLoading&&t&&n&&!$t(e.clientThreadId)&&e.conversationMode?.kind===Ln.PrimaryAssistant}function Mr(e){const t=yn(e),n=nt(e.clientThreadId,r=>qn(Ge.getConversationTurns(r),l=>l.role===zn.User));let s=!1;const a=n?.messages[0];if(a?.content.content_type===Un.Text){const r=a?.content.parts[0]?.toLowerCase();r&&(s=r.includes("chrome extension")||r.includes("default search"))}const o=rt(wn);return o.eligible&&!o.isLoading&&t&&s}function Cr(e){const t=qe.getItem(ze.SearchSettings)??{};t.hasSearchedMinTimes||(t.searchMessageIds||(t.searchMessageIds=[]),t.searchMessageIds.includes(e)||(t.searchMessageIds.push(e),t.searchMessageIds.length>=ho&&(t.hasSearchedMinTimes=!0,delete t.searchMessageIds),qe.setItem(ze.SearchSettings,t)))}function So(){return(qe.getItem(ze.SearchSettings)??{}).hasSearchedMinTimes===!0}function wo({task:e}){const t=D(),n=!1,s=ks(e),{clearSystemHintModeTrigger:a}=to();return p.useEffect(()=>{e.notificationStatus?.recentlyCompleted&&!e.notificationStatus?.notificationSent&&!n&&(s(),Es(e,t),a(Yt.Research),Ts.setTaskNotificationSent(e.taskId))},[e,t,s,n,a]),i.jsx(G.Fragment,{})}function yo(){const e=js(Ps.getAllTasksOrdered);return Ns(),e.length?i.jsx(i.Fragment,{children:e.map(t=>i.jsx(wo,{task:t},t.taskId))}):null}const bn={...On},bo=bn.useInsertionEffect,Mo=bo||(e=>e());function Mn(e){const t=p.useRef(()=>{});return Mo(()=>{t.current=e}),p.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}var Xe=typeof document<"u"?p.useLayoutEffect:p.useEffect;let Pt=!1,Co=0;const Nt=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Co++;function Io(){const[e,t]=p.useState(()=>Pt?Nt():void 0);return Xe(()=>{e==null&&t(Nt())},[]),p.useEffect(()=>{Pt=!0},[]),e}const ko=bn.useId,Eo=ko||Io;function To(){const e=new Map;return{emit(t,n){var s;(s=e.get(t))==null||s.forEach(a=>a(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var s;e.set(t,((s=e.get(t))==null?void 0:s.filter(a=>a!==n))||[])}}}const jo=p.createContext(null),Po=p.createContext(null),No=()=>{var e;return((e=p.useContext(jo))==null?void 0:e.id)||null},_o=()=>p.useContext(Po),Ao="data-floating-ui-focusable";function Ro(e){const{open:t=!1,onOpenChange:n,elements:s}=e,a=Eo(),o=p.useRef({}),[r]=p.useState(()=>To()),l=No()!=null,[c,u]=p.useState(s.reference),m=Mn((f,g,v)=>{o.current.openEvent=f?g:void 0,r.emit("openchange",{open:f,event:g,reason:v,nested:l}),n?.(f,g,v)}),h=p.useMemo(()=>({setPositionReference:u}),[]),d=p.useMemo(()=>({reference:c||s.reference||null,floating:s.floating||null,domReference:s.reference}),[c,s.reference,s.floating]);return p.useMemo(()=>({dataRef:o,open:t,onOpenChange:m,elements:d,events:r,floatingId:a,refs:h}),[t,m,d,r,a,h])}function Do(e){e===void 0&&(e={});const{nodeId:t}=e,n=Ro({...e,elements:{reference:null,floating:null,...e.elements}}),s=e.rootContext||n,a=s.elements,[o,r]=p.useState(null),[l,c]=p.useState(null),m=a?.reference||o,h=p.useRef(null),d=_o();Xe(()=>{m&&(h.current=m)},[m]);const f=Gn({...e,elements:{...a,...l&&{reference:l}}}),g=p.useCallback(S=>{const M=ye(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),contextElement:S}:S;c(M),f.refs.setReference(M)},[f.refs]),v=p.useCallback(S=>{(ye(S)||S===null)&&(h.current=S,r(S)),(ye(f.refs.reference.current)||f.refs.reference.current===null||S!==null&&!ye(S))&&f.refs.setReference(S)},[f.refs]),x=p.useMemo(()=>({...f.refs,setReference:v,setPositionReference:g,domReference:h}),[f.refs,v,g]),y=p.useMemo(()=>({...f.elements,domReference:m}),[f.elements,m]),b=p.useMemo(()=>({...f,...s,refs:x,elements:y,nodeId:t}),[f,x,y,t,s]);return Xe(()=>{s.dataRef.current.floatingContext=b;const S=d?.nodesRef.current.find(M=>M.id===t);S&&(S.context=b)}),p.useMemo(()=>({...f,context:b,refs:x,elements:y}),[f,x,y,b])}const _t="active",At="selected";function Oe(e,t,n){const s=new Map,a=n==="item";let o=e;if(a&&e){const{[_t]:r,[At]:l,...c}=e;o=c}return{...n==="floating"&&{tabIndex:-1,[Ao]:""},...o,...t.map(r=>{const l=r?r[n]:null;return typeof l=="function"?e?l(e):null:l}).concat(e).reduce((r,l)=>(l&&Object.entries(l).forEach(c=>{let[u,m]=c;if(!(a&&[_t,At].includes(u)))if(u.indexOf("on")===0){if(s.has(u)||s.set(u,[]),typeof m=="function"){var h;(h=s.get(u))==null||h.push(m),r[u]=function(){for(var d,f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return(d=s.get(u))==null?void 0:d.map(x=>x(...g)).find(x=>x!==void 0)}}}else r[u]=m}),r),{})}}function Fo(e){e===void 0&&(e=[]);const t=e.map(l=>l?.reference),n=e.map(l=>l?.floating),s=e.map(l=>l?.item),a=p.useCallback(l=>Oe(l,e,"reference"),t),o=p.useCallback(l=>Oe(l,e,"floating"),n),r=p.useCallback(l=>Oe(l,e,"item"),s);return p.useMemo(()=>({getReferenceProps:a,getFloatingProps:o,getItemProps:r}),[a,o,r])}function Rt(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const Oo=e=>({name:"inner",options:e,async fn(t){const{listRef:n,overflowRef:s,onFallbackChange:a,offset:o=0,index:r=0,minItemsVisible:l=4,referenceOverflowThreshold:c=0,scrollRef:u,...m}=Vn(e,t),{rects:h,elements:{floating:d}}=t,f=n.current[r],g=u?.current||d,v=d.clientTop||g.clientTop,x=d.clientTop!==0,y=g.clientTop!==0,b=d===g;if(!f)return{};const S={...t,...await qt(-f.offsetTop-d.clientTop-h.reference.height/2-f.offsetHeight/2-o).fn(t)},M=await Re(Rt(S,g.scrollHeight+v+d.clientTop),m),P=await Re(S,{...m,elementContext:"reference"}),T=De(0,M.top),O=S.y+T,C=Qn(De(0,g.scrollHeight+(x&&b||y?v*2:0)-T-De(0,M.bottom)));if(g.style.maxHeight=C+"px",g.scrollTop=T,a){const I=g.scrollHeight>g.offsetHeight&&g.offsetHeight<f.offsetHeight*l-1||P.top>=-c||P.bottom>=-c;V.flushSync(()=>a(I))}return s&&(s.current=await Re(Rt({...S,y:O},g.offsetHeight+v+d.clientTop),m)),{y:O}}});function Ho(e,t){const{open:n,elements:s}=e,{enabled:a=!0,overflowRef:o,scrollRef:r,onChange:l}=t,c=Mn(l),u=p.useRef(!1),m=p.useRef(null),h=p.useRef(null);p.useEffect(()=>{if(!a)return;function f(v){if(v.ctrlKey||!g||o.current==null)return;const x=v.deltaY,y=o.current.top>=-.5,b=o.current.bottom>=-.5,S=g.scrollHeight-g.clientHeight,M=x<0?-1:1,P=x<0?"max":"min";g.scrollHeight<=g.clientHeight||(!y&&x>0||!b&&x<0?(v.preventDefault(),V.flushSync(()=>{c(T=>T+Math[P](x,S*M))})):/firefox/i.test(_s())&&(g.scrollTop+=x))}const g=r?.current||s.floating;if(n&&g)return g.addEventListener("wheel",f),requestAnimationFrame(()=>{m.current=g.scrollTop,o.current!=null&&(h.current={...o.current})}),()=>{m.current=null,h.current=null,g.removeEventListener("wheel",f)}},[a,n,s.floating,o,r,c]);const d=p.useMemo(()=>({onKeyDown(){u.current=!0},onWheel(){u.current=!1},onPointerMove(){u.current=!1},onScroll(){const f=r?.current||s.floating;if(!(!o.current||!f||!u.current)){if(m.current!==null){const g=f.scrollTop-m.current;(o.current.bottom<-.5&&g<-1||o.current.top<-.5&&g>1)&&V.flushSync(()=>c(v=>v+g))}requestAnimationFrame(()=>{m.current=f.scrollTop})}}}),[s.floating,c,o,r]);return p.useMemo(()=>a?{floating:d}:{},[a,d])}let le=p.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});le.displayName="FloatingContext";let ht=p.createContext(null);ht.displayName="PlacementContext";function Wo(e){return p.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function Bo(){return p.useContext(le).setReference}function Lo(){return p.useContext(le).getReferenceProps}function Uo(){let{getFloatingProps:e,slot:t}=p.useContext(le);return p.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":t.anchor}),[e,t])}function $o(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=p.useContext(ht),n=p.useMemo(()=>e,[JSON.stringify(e,(a,o)=>{var r;return(r=o?.outerHTML)!=null?r:o})]);Q(()=>{t?.(n??null)},[t,n]);let s=p.useContext(le);return p.useMemo(()=>[s.setFloating,e?s.styles:{}],[s.setFloating,e,s.styles])}let Dt=4;function Ko({children:e,enabled:t=!0}){let[n,s]=p.useState(null),[a,o]=p.useState(0),r=p.useRef(null),[l,c]=p.useState(null);qo(l);let u=t&&n!==null&&l!==null,{to:m="bottom",gap:h=0,offset:d=0,padding:f=0,inner:g}=zo(n,l),[v,x="center"]=m.split(" ");Q(()=>{u&&o(0)},[u]);let{refs:y,floatingStyles:b,context:S}=Do({open:u,placement:v==="selection"?x==="center"?"bottom":`bottom-${x}`:x==="center"?`${v}`:`${v}-${x}`,strategy:"absolute",transform:!1,middleware:[qt({mainAxis:v==="selection"?0:h,crossAxis:d}),Yn({padding:f}),v!=="selection"&&Xn({padding:f}),v==="selection"&&g?Oo({...g,padding:f,overflowRef:r,offset:a,minItemsVisible:Dt,referenceOverflowThreshold:f,onFallbackChange(K){var Y,ae;if(!K)return;let X=S.elements.floating;if(!X)return;let Se=parseFloat(getComputedStyle(X).scrollPaddingBottom)||0,ce=Math.min(Dt,X.childElementCount),w=0,ue=0;for(let H of(ae=(Y=S.elements.floating)==null?void 0:Y.childNodes)!=null?ae:[])if(H instanceof HTMLElement){let B=H.offsetTop,we=B+H.clientHeight+Se,Ae=X.scrollTop,wt=Ae+X.clientHeight;if(B>=Ae&&we<=wt)ce--;else{ue=Math.max(0,Math.min(we,wt)-Math.max(B,Ae)),w=H.clientHeight;break}}ce>=1&&o(H=>{let B=w*ce-ue+Se;return H>=B?H:B})}}):null,Jn({padding:f,apply({availableWidth:K,availableHeight:Y,elements:ae}){Object.assign(ae.floating.style,{overflow:"auto",maxWidth:`${K}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${Y}px)`})}})].filter(Boolean),whileElementsMounted:Zn}),[M=v,P=x]=S.placement.split("-");v==="selection"&&(M="selection");let T=p.useMemo(()=>({anchor:[M,P].filter(Boolean).join(" ")}),[M,P]),O=Ho(S,{overflowRef:r,onChange:o}),{getReferenceProps:C,getFloatingProps:I}=Fo([O]),se=_(K=>{c(K),y.setFloating(K)});return p.createElement(ht.Provider,{value:s},p.createElement(le.Provider,{value:{setFloating:se,setReference:y.setReference,styles:b,getReferenceProps:C,getFloatingProps:I,slot:T}},e))}function qo(e){Q(()=>{if(!e)return;let t=new MutationObserver(()=>{let n=window.getComputedStyle(e).maxHeight,s=parseFloat(n);if(isNaN(s))return;let a=parseInt(n);isNaN(a)||s!==a&&(e.style.maxHeight=`${Math.ceil(s)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function zo(e,t){var n,s,a;let o=He((n=e?.gap)!=null?n:"var(--anchor-gap, 0)",t),r=He((s=e?.offset)!=null?s:"var(--anchor-offset, 0)",t),l=He((a=e?.padding)!=null?a:"var(--anchor-padding, 0)",t);return{...e,gap:o,offset:r,padding:l}}function He(e,t,n=void 0){let s=Xt(),a=_((c,u)=>{if(c==null)return[n,null];if(typeof c=="number")return[c,null];if(typeof c=="string"){if(!u)return[n,null];let m=Ft(c,u);return[m,h=>{let d=Cn(c);{let f=d.map(g=>window.getComputedStyle(u).getPropertyValue(g));s.requestAnimationFrame(function g(){s.nextFrame(g);let v=!1;for(let[y,b]of d.entries()){let S=window.getComputedStyle(u).getPropertyValue(b);if(f[y]!==S){f[y]=S,v=!0;break}}if(!v)return;let x=Ft(c,u);m!==x&&(h(x),m=x)})}return s.dispose}]}return[n,null]}),o=p.useMemo(()=>a(e,t)[0],[e,t]),[r=o,l]=p.useState();return Q(()=>{let[c,u]=a(e,t);if(l(c),!!u)return u(l)},[e,t]),r}function Cn(e){let t=/var\((.*)\)/.exec(e);if(t){let n=t[1].indexOf(",");if(n===-1)return[t[1]];let s=t[1].slice(0,n).trim(),a=t[1].slice(n+1).trim();return a?[s,...Cn(a)]:[s]}return[]}function Ft(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let s=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),s}var Go=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Go||{}),Vo=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Vo||{}),Qo=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(Qo||{});function We(e,t=n=>n){let n=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,s=ia(t(e.items.slice()),o=>o.dataRef.current.domRef.current),a=n?s.indexOf(n):null;return a===-1&&(a=null),{items:s,activeItemIndex:a}}let Yo={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var n,s,a,o,r;if(e.menuState===1)return e;let l={...e,searchQuery:"",activationTrigger:(n=t.trigger)!=null?n:1,__demoMode:!1};if(t.focus===A.Nothing)return{...l,activeItemIndex:null};if(t.focus===A.Specific)return{...l,activeItemIndex:e.items.findIndex(m=>m.id===t.id)};if(t.focus===A.Previous){let m=e.activeItemIndex;if(m!==null){let h=e.items[m].dataRef.current.domRef,d=Fe(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(d!==null){let f=e.items[d].dataRef.current.domRef;if(((s=h.current)==null?void 0:s.previousElementSibling)===f.current||((a=f.current)==null?void 0:a.previousElementSibling)===null)return{...l,activeItemIndex:d}}}}else if(t.focus===A.Next){let m=e.activeItemIndex;if(m!==null){let h=e.items[m].dataRef.current.domRef,d=Fe(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(d!==null){let f=e.items[d].dataRef.current.domRef;if(((o=h.current)==null?void 0:o.nextElementSibling)===f.current||((r=f.current)==null?void 0:r.nextElementSibling)===null)return{...l,activeItemIndex:d}}}}let c=We(e),u=Fe(t,{resolveItems:()=>c.items,resolveActiveIndex:()=>c.activeItemIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});return{...l,...c,activeItemIndex:u}},3:(e,t)=>{let n=e.searchQuery!==""?0:1,s=e.searchQuery+t.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find(r=>{var l;return((l=r.dataRef.current.textValue)==null?void 0:l.startsWith(s))&&!r.dataRef.current.disabled}),o=a?e.items.indexOf(a):-1;return o===-1||o===e.activeItemIndex?{...e,searchQuery:s}:{...e,searchQuery:s,activeItemIndex:o,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let n=We(e,s=>[...s,{id:t.id,dataRef:t.dataRef}]);return{...e,...n}},6:(e,t)=>{let n=We(e,s=>{let a=s.findIndex(o=>o.id===t.id);return a!==-1&&s.splice(a,1),s});return{...e,...n,activationTrigger:1}},7:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},8:(e,t)=>e.itemsElement===t.element?e:{...e,itemsElement:t.element}},vt=p.createContext(null);vt.displayName="MenuContext";function Ne(e){let t=p.useContext(vt);if(t===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Ne),n}return t}function Xo(e,t){return Jt(t.type,Yo,e,t)}let Jo=p.Fragment;function Zo(e,t){let{__demoMode:n=!1,...s}=e,a=p.useReducer(Xo,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:o,itemsElement:r,buttonElement:l},c]=a,u=je(t);As(o===0,[l,r],(f,g)=>{c({type:1}),Rs(g,Ds.Loose)||(f.preventDefault(),l?.focus())});let m=_(()=>{c({type:1})}),h=p.useMemo(()=>({open:o===0,close:m}),[o,m]),d={ref:u};return G.createElement(Ko,null,G.createElement(vt.Provider,{value:a},G.createElement(Fs,{value:Jt(o,{0:Ie.Open,1:Ie.Closed})},te({ourProps:d,theirProps:s,slot:h,defaultTag:Jo,name:"Menu"}))))}let ei="button";function ti(e,t){var n;let s=p.useId(),{id:a=`headlessui-menu-button-${s}`,disabled:o=!1,autoFocus:r=!1,...l}=e,[c,u]=Ne("Menu.Button"),m=Lo(),h=Os(),d=je(t,Bo(),_(C=>u({type:7,element:C}))),f=_(C=>{switch(C.key){case N.Space:case N.Enter:case N.ArrowDown:C.preventDefault(),C.stopPropagation(),V.flushSync(()=>u({type:0})),u({type:2,focus:A.First});break;case N.ArrowUp:C.preventDefault(),C.stopPropagation(),V.flushSync(()=>u({type:0})),u({type:2,focus:A.Last});break}}),g=_(C=>{switch(C.key){case N.Space:C.preventDefault();break}}),v=_(C=>{var I;if(Hs(C.currentTarget))return C.preventDefault();o||(c.menuState===0?(V.flushSync(()=>u({type:1})),(I=c.buttonElement)==null||I.focus({preventScroll:!0})):(C.preventDefault(),u({type:0})))}),{isFocusVisible:x,focusProps:y}=Ws({autoFocus:r}),{isHovered:b,hoverProps:S}=Bs({isDisabled:o}),{pressed:M,pressProps:P}=Ls({disabled:o}),T=p.useMemo(()=>({open:c.menuState===0,active:M||c.menuState===0,disabled:o,hover:b,focus:x,autofocus:r}),[c,b,x,M,o,r]),O=Zt(m(),{ref:d,id:a,type:Us(e,c.buttonElement),"aria-haspopup":"menu","aria-controls":(n=c.itemsElement)==null?void 0:n.id,"aria-expanded":c.menuState===0,disabled:o||void 0,autoFocus:r,onKeyDown:f,onKeyUp:g,onClick:v},y,S,P);return te({mergeRefs:h,ourProps:O,theirProps:l,slot:T,defaultTag:ei,name:"Menu.Button"})}let ni="div",si=bt.RenderStrategy|bt.Static;function ai(e,t){var n,s;let a=p.useId(),{id:o=`headlessui-menu-items-${a}`,anchor:r,portal:l=!1,modal:c=!0,transition:u=!1,...m}=e,h=Wo(r),[d,f]=Ne("Menu.Items"),[g,v]=$o(h),x=Uo(),[y,b]=p.useState(null),S=je(t,h?g:null,_(w=>f({type:8,element:w})),b),M=$s(d.itemsElement);h&&(l=!0);let P=Ks(),[T,O]=qs(u,y,P!==null?(P&Ie.Open)===Ie.Open:d.menuState===0);zs(T,d.buttonElement,()=>{f({type:1})});let C=d.__demoMode?!1:c&&d.menuState===0;Gs(C,M);let I=d.__demoMode?!1:c&&d.menuState===0;Vs(I,{allowed:p.useCallback(()=>[d.buttonElement,d.itemsElement],[d.buttonElement,d.itemsElement])});let se=d.menuState!==0,K=Qs(se,d.buttonElement)?!1:T;p.useEffect(()=>{let w=d.itemsElement;w&&d.menuState===0&&w!==M?.activeElement&&w.focus({preventScroll:!0})},[d.menuState,d.itemsElement,M]),Ys(d.menuState===0,{container:d.itemsElement,accept(w){return w.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:w.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(w){w.setAttribute("role","none")}});let Y=Xt(),ae=_(w=>{var ue,H,B;switch(Y.dispose(),w.key){case N.Space:if(d.searchQuery!=="")return w.preventDefault(),w.stopPropagation(),f({type:3,value:w.key});case N.Enter:if(w.preventDefault(),w.stopPropagation(),f({type:1}),d.activeItemIndex!==null){let{dataRef:we}=d.items[d.activeItemIndex];(H=(ue=we.current)==null?void 0:ue.domRef.current)==null||H.click()}en(d.buttonElement);break;case N.ArrowDown:return w.preventDefault(),w.stopPropagation(),f({type:2,focus:A.Next});case N.ArrowUp:return w.preventDefault(),w.stopPropagation(),f({type:2,focus:A.Previous});case N.Home:case N.PageUp:return w.preventDefault(),w.stopPropagation(),f({type:2,focus:A.First});case N.End:case N.PageDown:return w.preventDefault(),w.stopPropagation(),f({type:2,focus:A.Last});case N.Escape:w.preventDefault(),w.stopPropagation(),V.flushSync(()=>f({type:1})),(B=d.buttonElement)==null||B.focus({preventScroll:!0});break;case N.Tab:w.preventDefault(),w.stopPropagation(),V.flushSync(()=>f({type:1})),Xs(d.buttonElement,w.shiftKey?Mt.Previous:Mt.Next);break;default:w.key.length===1&&(f({type:3,value:w.key}),Y.setTimeout(()=>f({type:4}),350));break}}),X=_(w=>{switch(w.key){case N.Space:w.preventDefault();break}}),Se=p.useMemo(()=>({open:d.menuState===0}),[d.menuState]),ce=Zt(h?x():{},{"aria-activedescendant":d.activeItemIndex===null||(n=d.items[d.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(s=d.buttonElement)==null?void 0:s.id,id:o,onKeyDown:ae,onKeyUp:X,role:"menu",tabIndex:d.menuState===0?0:void 0,ref:S,style:{...m.style,...v,"--button-width":Js(d.buttonElement,!0).width},...Zs(O)});return G.createElement(ea,{enabled:l?e.static||T:!1},te({ourProps:ce,theirProps:m,slot:Se,defaultTag:ni,features:si,visible:K,name:"Menu.Items"}))}let oi=p.Fragment;function ii(e,t){let n=p.useId(),{id:s=`headlessui-menu-item-${n}`,disabled:a=!1,...o}=e,[r,l]=Ne("Menu.Item"),c=r.activeItemIndex!==null?r.items[r.activeItemIndex].id===s:!1,u=p.useRef(null),m=je(t,u);Q(()=>{if(!r.__demoMode&&r.menuState===0&&c&&r.activationTrigger!==0)return ta().requestAnimationFrame(()=>{var I,se;(se=(I=u.current)==null?void 0:I.scrollIntoView)==null||se.call(I,{block:"nearest"})})},[r.__demoMode,u,c,r.menuState,r.activationTrigger,r.activeItemIndex]);let h=na(u),d=p.useRef({disabled:a,domRef:u,get textValue(){return h()}});Q(()=>{d.current.disabled=a},[d,a]),Q(()=>(l({type:5,id:s,dataRef:d}),()=>l({type:6,id:s})),[d,s]);let f=_(()=>{l({type:1})}),g=_(I=>{if(a)return I.preventDefault();l({type:1}),en(r.buttonElement)}),v=_(()=>{if(a)return l({type:2,focus:A.Nothing});l({type:2,focus:A.Specific,id:s})}),x=sa(),y=_(I=>{x.update(I),!a&&(c||l({type:2,focus:A.Specific,id:s,trigger:0}))}),b=_(I=>{x.wasMoved(I)&&(a||c||l({type:2,focus:A.Specific,id:s,trigger:0}))}),S=_(I=>{x.wasMoved(I)&&(a||c&&l({type:2,focus:A.Nothing}))}),[M,P]=tn(),[T,O]=aa(),C=p.useMemo(()=>({active:c,focus:c,disabled:a,close:f}),[c,a,f]);return G.createElement(P,null,G.createElement(O,null,te({ourProps:{id:s,ref:m,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-labelledby":M,"aria-describedby":T,disabled:void 0,onClick:g,onFocus:v,onPointerEnter:y,onMouseEnter:y,onPointerMove:b,onMouseMove:b,onPointerLeave:S,onMouseLeave:S},theirProps:o,slot:C,defaultTag:oi,name:"Menu.Item"})))}let ri="div";function li(e,t){let[n,s]=tn();return G.createElement(s,null,te({ourProps:{ref:t,"aria-labelledby":n,role:"group"},theirProps:e,slot:{},defaultTag:ri,name:"Menu.Section"}))}let ci="header";function ui(e,t){let n=p.useId(),{id:s=`headlessui-menu-heading-${n}`,...a}=e,o=oa();Q(()=>o.register(s),[s,o.register]);let r={id:s,ref:t,role:"presentation",...o.props};return te({ourProps:r,theirProps:a,slot:{},defaultTag:ci,name:"Menu.Heading"})}let di="div";function fi(e,t){return te({ourProps:{ref:t,role:"separator"},theirProps:e,slot:{},defaultTag:di,name:"Menu.Separator"})}let mi=ee(Zo),pi=ee(ti),gi=ee(ai),hi=ee(ii),vi=ee(li),xi=ee(ui),Si=ee(fi),pe=Object.assign(mi,{Button:pi,Items:gi,Item:hi,Section:vi,Heading:xi,Separator:Si});function wi({show:e,appear:t,children:n}){return i.jsx(ra,{as:p.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",show:e,appear:t,children:n})}const In=new ne("transactionEventPlugin"),Je="prosemirrorDispatchTransaction";function Ot(e,t){const{eventTarget:n}=In.getState(e.state);return n.addEventListener(Je,t),()=>{n.removeEventListener(Je,t)}}function yi(e){return new re({key:In,state:{init(){return{eventTarget:e}},apply(t,n){return n}}})}const Me=new ne("customKeymapPlugin");function bi(e,t){e.dispatch(e.state.tr.setMeta(Me,{handlers:t}))}function Mi(e={handlers:{}}){return new re({key:Me,state:{init(){return{...e}},apply(t,n){const s=t.getMeta(Me);return s?{...n,...s}:n}},props:{handleKeyDown(t,n){const a=Me.getState(t.state).handlers[n.key];return a?a(n):!1}}})}const J=new ne("menuSelectorPlugin");function Ht(e){e.dispatch(e.state.tr.setMeta(J,{active:!1,onMenuAction:void 0}))}function Ir(e,t){e.dispatch(e.state.tr.setMeta(J,{active:!0,onMenuAction:t}))}function Ci(e={submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}){return new re({key:J,state:{init(){return{...e,active:!1}},apply(t,n){const s=t.getMeta(J);return s?{...n,...s}:n}},props:{handleKeyDown(t,n){const s=J.getState(t.state);if(!s.active)return!1;if(!n.isComposing)return s.submitKeys.includes(n.key)?(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),Ht(t),s.onMenuAction?.("submit")??!0):s.cancelKeys.includes(n.key)?(n.preventDefault(),s.onMenuAction?.("cancel"),Ht(t),!0):n.key==="ArrowUp"?(n.preventDefault(),s.onMenuAction?.("up"),!0):n.key==="ArrowDown"?(n.preventDefault(),s.onMenuAction?.("down"),!0):s.checkStrictMatchKeys.includes(n.key)&&s.onMenuAction?.("checkMatch")?(n.preventDefault(),!0):!1},handleDOMEvents:{blur:t=>{J.getState(t.state).onMenuAction?.("cancel")}}}})}const de=new ne("placeholderPlugin");function Ii(e){return new re({key:de,state:{init(){return{placeholder:e}},apply(t,n){return t.getMeta(de)?{placeholder:t.getMeta(de).placeholder}:n}},props:{decorations(t){const{doc:n}=t;if(n.childCount===1&&n.firstChild?.isTextblock&&n.firstChild.content.size===0){const a=[],{placeholder:o}=de.getState(t);return t.doc.descendants((r,l)=>{const c=ao.node(l,l+r.nodeSize,{class:"placeholder","data-placeholder":o});a.push(c)}),oo.create(n,a)}}}})}const ge="command_token",ki={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:e=>["span",{"data-mention-id":e.attrs.id,"data-mention-hint":e.attrs.hint,class:"hint-pill"},e.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:e=>{const t=e.getAttribute("data-mention-id"),n=e.getAttribute("data-mention-hint");return{id:t,hint:n}}}]};function kn(e,t){if(e.depth===0)return;const n=e.nodeBefore?.text?.match(/(?:^|\s)(\/(\w*))$/);if(n?.[1].length!==void 0){const s=e.pos-n[1].length,a=e.pos,o=s===t?.from;return{range:{from:s,to:a},queryText:n[2],isDismissed:o}}}const Ze=new ne("systemHintPlugin");function En(e,t){return e.setMeta(Ze,t),e}function kr(e){const n=e.state.selection.$from,s=kn(n,void 0);e.dispatch(En(e.state.tr,{...ke(),dismissedRange:s?.range}))}function ke(){return{queryText:"",active:!1,range:void 0,dismissedRange:void 0}}function Ei(e,t,n,s,a){const o=e.state.tr;En(o,ke());const r=n+" ",l=e.state.schema.nodes[ge].create({id:t,hint:r},e.state.schema.text(r));if(a===s){const c=o.doc.resolve(s).nodeAfter;if(c?.isText){const u=c?.textContent.match(new RegExp(`^(?:${n}) ?`));u&&(a=s+u[0].length)}}o.replaceWith(s,a,l),o.doc.descendants((c,u)=>{c.type.name===ge&&c!==l&&(s===1&&u===s+l.nodeSize||u===1&&s===u+c.nodeSize?o.delete(u,u+c.nodeSize):o.insertText(c.textContent,u,u+c.nodeSize))}),e.dispatch(o)}function Ti(e){const t=e.state.tr;t.doc.descendants((n,s)=>{if(n.type.name===ge){const a=s+n.nodeSize;s===1&&t.doc.resolve(a).nodeAfter==null?t.delete(s,a):t.insertText(n.textContent,s,s+n.nodeSize)}}),t.steps.length>0&&e.dispatch(t)}function Wt(e){const{active:t,range:n,queryText:s,onHintMatch:a}=e;if(a)return a(!t||!n?void 0:{text:s,range:n})}function ji(e){const t=[];return e.descendants(n=>{n.type.name===ge&&typeof n.attrs?.id=="string"&&t.push(n.attrs.id)}),t}function Pi(){return new re({key:Ze,state:{init(){return ke()},apply(e,t,n,s){const a=e.getMeta(Ze),o={...ke(),...t,...a},r=e.selection;if(r.from!==r.to||s.doc.eq(n.doc))return Wt(o),o;const l=r.$from,c=kn(l,t.dismissedRange);return o.active=!!c&&!c.isDismissed,c&&(o.queryText=c.queryText,o.range=c.range,c.isDismissed&&(c.queryText===""&&t.queryText!==""?o.dismissedRange=void 0:o.dismissedRange=c.range)),Wt(o),o}}})}class Tn extends la{constructor(t){super(),this.view=t,this.subscribe("focus",()=>this._store.setState({isFocused:!0})),this.subscribe("blur",()=>this._store.setState({isFocused:!1}))}_store=es(t=>({isFocused:!1,autocompletions:[],showTaggingDropdown:!1,waveWidth:300,setShowTaggingDropdown:n=>t({showTaggingDropdown:n})}));get store(){return this._store}_usedDictation=!1;get usedDictation(){return this._usedDictation}set usedDictation(t){this._usedDictation=t}get element(){return this.view.dom}get document(){return this.view.dom.ownerDocument}isEmpty(){return this.view.state.doc.textContent.trim().length===0}isFocused(){return this.view.hasFocus()}trimLeadingText(t){const s=this.view.state.tr;let a=0;return s.doc.descendants((o,r)=>{if(o.isText&&o.text){if(typeof t=="string"&&o.text.startsWith(t))a=t.length;else if(t instanceof RegExp){const l=o.text.match(t);l?.index===0&&(a=l[0].length)}if(a){const l=o.text.substring(a).trimStart();a=o.text.length-l.length,s.delete(r,r+a)}}return!o.isLeaf}),a>0?(this.view.dispatch(s),!0):!1}replaceAll(t,n){const a=this.view.state.tr,o=[];a.doc.descendants((r,l)=>{!r.isText||r.text===void 0||o.push({node:r,pos:l})}),o.reverse(),o.forEach(({node:r,pos:l})=>{!r.isText||r.text===void 0||r.text.includes(t)&&a.insertText(r.text.replaceAll(t,n),l,l+r.text.length)}),this.view.dispatch(a)}appendText(t){this.view.dispatch(this.view.state.tr.insertText(t))}delete(t,n){this.view.dispatch(this.view.state.tr.delete(t,n))}focus(){this.view.hasFocus()||(this.view.focus(),this.view.dispatch(this.view.state.tr.setSelection(be.atEnd(this.view.state.doc)).scrollIntoView()))}setText(t){const{tr:n,schema:s}=this.view.state,a=t?s.nodes.paragraph.create(null,s.text(t)):s.nodes.paragraph.create();this.view.dispatch(n.replaceWith(0,this.view.state.doc.content.size,a)),this.view.hasFocus()&&this.view.dispatch(this.view.state.tr.setSelection(be.atEnd(this.view.state.doc)))}getContentLength(){return this.view.state.doc.content.size}getCurrentText(){return this.view.state.doc.textContent}hasMultipleLines(){let t=0;return this.view.state.doc.descendants(n=>{n.isBlock&&t++}),t>1}getContentToSend(){return io(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(t){this.view.dispatch(this.view.state.tr.setMeta(de,{placeholder:t}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}setSelection(t,n){this.view.dispatch(this.view.state.tr.setSelection(be.create(this.view.state.doc,t,n))),this.view.focus()}isMenuSelectorActive(){return J.getState(this.view.state).active}registerKeyHandlers(t){bi(this.view,t)}acceptLegacyKeydown(){return!1}subscribe(t,n){if(t==="change"){const s=()=>n(void 0);return Ot(this.view,s)}return this.view.dom?.addEventListener(t,n,{capture:!0}),()=>{this.view.dom?.removeEventListener(t,n,{capture:!0})}}useState(t){return p.useSyncExternalStore(n=>Ot(this.view,n),()=>t(this),()=>t(this))}getSystemHints(){const t=ji(this.view.state.tr.doc)[0];return t?[t]:[]}addSystemHint(t,n,s=1,a=1){Ei(this.view,t,n,s,a)}removeSystemHints(){Ti(this.view)}canShowAutocompletion(){return this.getSystemHints().some(n=>n===Yt.PictureV2)||!this.isMenuSelectorActive()&&!this.getSystemHints().length}}const Ni=500;class F{constructor(t,n){this.items=t,this.eventCount=n}popEvent(t,n){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let a,o;n&&(a=this.remapping(s,this.items.length),o=a.maps.length);let r=t.tr,l,c,u=[],m=[];return this.items.forEach((h,d)=>{if(!h.step){a||(a=this.remapping(s,d+1),o=a.maps.length),o--,m.push(h);return}if(a){m.push(new W(h.map));let f=h.step.map(a.slice(o)),g;f&&r.maybeStep(f).doc&&(g=r.mapping.maps[r.mapping.maps.length-1],u.push(new W(g,void 0,void 0,u.length+m.length))),o--,g&&a.appendMap(g,o)}else r.maybeStep(h.step);if(h.selection)return l=a?h.selection.map(a.slice(o)):h.selection,c=new F(this.items.slice(0,s).append(m.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:r,selection:l}}addTransform(t,n,s,a){let o=[],r=this.eventCount,l=this.items,c=!a&&l.length?l.get(l.length-1):null;for(let m=0;m<t.steps.length;m++){let h=t.steps[m].invert(t.docs[m]),d=new W(t.mapping.maps[m],h,n),f;(f=c&&c.merge(d))&&(d=f,m?o.pop():l=l.slice(0,l.length-1)),o.push(d),n&&(r++,n=void 0),a||(c=d)}let u=r-s.depth;return u>Ai&&(l=_i(l,u),r-=u),new F(l.append(o),r)}remapping(t,n){let s=new ro;return this.items.forEach((a,o)=>{let r=a.mirrorOffset!=null&&o-a.mirrorOffset>=t?s.maps.length-a.mirrorOffset:void 0;s.appendMap(a.map,r)},t,n),s}addMaps(t){return this.eventCount==0?this:new F(this.items.append(t.map(n=>new W(n))),this.eventCount)}rebased(t,n){if(!this.eventCount)return this;let s=[],a=Math.max(0,this.items.length-n),o=t.mapping,r=t.steps.length,l=this.eventCount;this.items.forEach(d=>{d.selection&&l--},a);let c=n;this.items.forEach(d=>{let f=o.getMirror(--c);if(f==null)return;r=Math.min(r,f);let g=o.maps[f];if(d.step){let v=t.steps[f].invert(t.docs[f]),x=d.selection&&d.selection.map(o.slice(c+1,f));x&&l++,s.push(new W(g,v,x))}else s.push(new W(g))},a);let u=[];for(let d=n;d<r;d++)u.push(new W(o.maps[d]));let m=this.items.slice(0,a).append(u).append(s),h=new F(m,l);return h.emptyItemCount()>Ni&&(h=h.compress(this.items.length-s.length)),h}emptyItemCount(){let t=0;return this.items.forEach(n=>{n.step||t++}),t}compress(t=this.items.length){let n=this.remapping(0,t),s=n.maps.length,a=[],o=0;return this.items.forEach((r,l)=>{if(l>=t)a.push(r),r.selection&&o++;else if(r.step){let c=r.step.map(n.slice(s)),u=c&&c.getMap();if(s--,u&&n.appendMap(u,s),c){let m=r.selection&&r.selection.map(n.slice(s));m&&o++;let h=new W(u.invert(),c,m),d,f=a.length-1;(d=a.length&&a[f].merge(h))?a[f]=d:a.push(h)}}else r.map&&s--},this.items.length,0),new F(nn.from(a.reverse()),o)}}F.empty=new F(nn.empty,0);function _i(e,t){let n;return e.forEach((s,a)=>{if(s.selection&&t--==0)return n=a,!1}),e.slice(n)}class W{constructor(t,n,s,a){this.map=t,this.step=n,this.selection=s,this.mirrorOffset=a}merge(t){if(this.step&&t.step&&!t.selection){let n=t.step.merge(this.step);if(n)return new W(n.getMap().invert(),n,this.selection)}}}class q{constructor(t,n,s,a,o){this.done=t,this.undone=n,this.prevRanges=s,this.prevTime=a,this.prevComposition=o}}const Ai=20;function Ri(e,t,n,s){let a=n.getMeta(Z),o;if(a)return a.historyState;n.getMeta(Oi)&&(e=new q(e.done,e.undone,null,0,-1));let r=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(r&&r.getMeta(Z))return r.getMeta(Z).redo?new q(e.done.addTransform(n,void 0,s,Ce(t)),e.undone,Bt(n.mapping.maps),e.prevTime,e.prevComposition):new q(e.done,e.undone.addTransform(n,void 0,s,Ce(t)),null,e.prevTime,e.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(r&&r.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),c=e.prevTime==0||!r&&e.prevComposition!=l&&(e.prevTime<(n.time||0)-s.newGroupDelay||!Di(n,e.prevRanges)),u=r?Be(e.prevRanges,n.mapping):Bt(n.mapping.maps);return new q(e.done.addTransform(n,c?t.selection.getBookmark():void 0,s,Ce(t)),F.empty,u,n.time,l??e.prevComposition)}else return(o=n.getMeta("rebased"))?new q(e.done.rebased(n,o),e.undone.rebased(n,o),Be(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new q(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),Be(e.prevRanges,n.mapping),e.prevTime,e.prevComposition)}function Di(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((s,a)=>{for(let o=0;o<t.length;o+=2)s<=t[o+1]&&a>=t[o]&&(n=!0)}),n}function Bt(e){let t=[];for(let n=e.length-1;n>=0&&t.length==0;n--)e[n].forEach((s,a,o,r)=>t.push(o,r));return t}function Be(e,t){if(!e)return null;let n=[];for(let s=0;s<e.length;s+=2){let a=t.map(e[s],1),o=t.map(e[s+1],-1);a<=o&&n.push(a,o)}return n}function Fi(e,t,n){let s=Ce(t),a=Z.get(t).spec.config,o=(n?e.undone:e.done).popEvent(t,s);if(!o)return null;let r=o.selection.resolve(o.transform.doc),l=(n?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),a,s),c=new q(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(r).setMeta(Z,{redo:n,historyState:c})}let Le=!1,Lt=null;function Ce(e){let t=e.plugins;if(Lt!=t){Le=!1,Lt=t;for(let n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){Le=!0;break}}return Le}const Z=new ne("history"),Oi=new ne("closeHistory");function Hi(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new re({key:Z,state:{init(){return new q(F.empty,F.empty,null,0,-1)},apply(t,n,s){return Ri(n,s,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,n){let s=n.inputType,a=s=="historyUndo"?Pn:s=="historyRedo"?et:null;return a?(n.preventDefault(),a(t.state,t.dispatch)):!1}}}})}function jn(e,t){return(n,s)=>{let a=Z.getState(n);if(!a||(e?a.undone:a.done).eventCount==0)return!1;if(s){let o=Fi(a,n,e);o&&s(t?o.scrollIntoView():o)}return!0}}const Pn=jn(!1,!0),et=jn(!0,!0);function Wi(){return Ye({"Shift-Enter":(e,t)=>jt(e,t),Enter:(e,t)=>window.innerWidth>ca[ua.Medium]||ts?!1:jt(e,t)})}const Bi=["p",0],Li=["br"],Ui=new lo({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM(){return Bi}},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return Li}},[ge]:ki,doc:{content:"block+"}},marks:{}});function $i(e=null){const t=new EventTarget,n=new co(null,{state:uo.create({schema:Ui,plugins:[Hi(),Ci(),Ii(""),Pi(),Wi(),Ye({"Mod-z":Pn,"Mod-y":et,"Mod-Shift-z":et}),Mi(),Ye(go),yi(t),fo()]}),dispatchTransaction(s){const a=n.state.apply(s);n.updateState(a),s.docChanged&&t.dispatchEvent(new Event(Je))},handlePaste(s,a){const o=a.clipboardData?.getData("text/plain");return o===void 0?!1:(a.defaultPrevented||mo(s,o),!0)},clipboardTextSerializer(s){return po(s.content).content}});return e!=null&&n.state.doc.textContent.trim().length===0&&n.dispatch(n.state.tr.insertText(e)),n}const tt=p.createContext(null),Ki=({children:e,clientThreadId:t})=>{const n=p.useContext(tt),s=p.useMemo(()=>n??new Tn($i(yt(t)!=null?as(yt(t))?.content??null:null)),[n,t]);return i.jsx(tt.Provider,{value:s,children:e})},Er=()=>os(p.useContext(tt)),Tr=({composerController:e,placeholder:t,vanguard:n})=>{const s=p.useRef(null),a=p.useRef(null),{isMobileOS:o}=da(),r=p.useRef(!1);return p.useEffect(()=>{if(r.current)return;if(!(e instanceof Tn))throw new Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);r.current=!0;const l=a.current;if(l!=null){const{value:c,selectionStart:u,selectionEnd:m}=l;e.view.dispatch(e.view.state.tr.insertText(c)),e.view.dispatch(e.view.state.tr.setSelection(be.create(e.view.state.doc,u+1,m+1))),l.style.display="none",l.value=""}s.current.appendChild(e.view.dom),e.view.dom.id=no,e.view.dom.dataset.virtualkeyboard="true",so(e.view.dom),!fa()&&!ns()&&requestAnimationFrame(()=>{e.view.focus()})},[e]),p.useEffect(()=>{e.setPlaceholder(t)},[t,e]),p.useEffect(()=>{e.logPageMount()},[]),i.jsxs("div",{ref:s,onKeyDown:ma.prefetch,className:$([pa["prosemirror-parent"],"text-token-text-primary","max-h-[25dvh]","max-h-52","overflow-auto [scrollbar-width:thin]",ss()?"firefox":"default-browser"],n&&"min-h-12 pr-3"),children:[i.jsx("textarea",{className:$("block h-10 w-full resize-none border-0 bg-transparent px-0 py-2 text-token-text-primary placeholder:pl-px placeholder:text-token-text-tertiary"),autoFocus:!o,placeholder:t,ref:a,"data-virtualkeyboard":!0}),i.jsx(ga,{scriptSrc:"window.__oai_logHTML?window.__oai_logHTML():window.__oai_SSR_HTML=window.__oai_SSR_HTML||Date.now();requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI||Date.now()}))"})]})};function Nn(){return{caModal:null,clientThreadId:"",isLoggedInUser:!1,focusedObject:null,currentModelId:"",isModelLoaded:!1,isEmbeddedInFocusedView:!1,isInstalledApp:!1,onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},onChangeRating:()=>{throw new Error("onChangeRating not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const _n=p.createContext(Nn());function xt(){try{return p.useContext(_n)}catch{return Nn()}}function jr({children:e,clientThreadId:t,setClientThreadId:n,routeType:s,prefetchSearchPromises:a}){const{createNewThread:o,resetThread:r}=ha({clientThreadId:t,setClientThreadId:n}),{data:l}=is(),c=va(l),u=nt(t,T=>T?.modelId),m=xa(),h=c.id,d=u??h,f=Sa(l?.models,d),g=ut(),v=wa(),{isUnauthenticated:x}=Ee(),y=!x,b=xn(t),{caModal:S,onChangeRating:M}=ya({clientThreadId:t,currentModelConfig:f}),P=p.useMemo(()=>({caModal:S,clientThreadId:t,currentModelId:d,isModelLoaded:!!u,isEmbeddedInFocusedView:m,isInstalledApp:g,isLoggedInUser:y,focusedObject:v,onNewThread:o,onRequestCompletion:b,onChangeRating:M,resetThread:r,prefetchSearchPromises:a,routeType:s}),[S,t,d,u,m,g,y,v,o,b,M,r,a,s]);return i.jsx(_n.Provider,{value:P,children:i.jsx(ba,{children:i.jsx(Ki,{clientThreadId:t,children:e})})})}function z({onClick:e,href:t,target:n,children:s,disabled:a,icon:o,testId:r}){return i.jsx(pe.Item,{disabled:a,children:({active:l})=>i.jsxs(_e,{onClick:e,href:t,target:n,className:$({"bg-token-sidebar-surface-secondary":l,"hover:bg-token-sidebar-surface-secondary":!l&&!a}),"data-testid":r,children:[o&&i.jsx(o,{className:"icon-md"}),s]})})}function qi({to:e,children:t,icon:n}){return i.jsx(pe.Item,{children:({active:s})=>i.jsx(Hn,{to:e,children:i.jsxs(_e,{$as:"span",className:$(s?"bg-token-sidebar-surface-secondary":"cursor-pointer"),children:[n&&i.jsx(n,{className:"icon-md"}),t]})})})}ve.a`p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer`;const _e=ve.a`flex gap-2 rounded p-2.5 text-sm cursor-pointer focus:ring-0 hover:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center`,Pr=ve(_e)`border dark:border-white/20 min-h-0 hover:bg-gray-500/10 h-10 rounded-lg border-[rgba(0,0,0,0.1)]`,Ue=ve.div`h-px bg-token-border-light my-1.5`,Nr=ve(_e)`${e=>e.$active?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary"} screen-arch:px-2 screen-arch:py-1.5 screen-arch:min-h-[47px]`;function _r({onClickSettings:e}){return i.jsxs(pe,{as:"div",className:"group relative",children:[i.jsx(Qi,{}),i.jsx(wi,{children:i.jsx(pe.Items,{className:"popover absolute bottom-full left-0 z-50 mb-1 w-full overflow-hidden rounded-lg border border-token-border-light bg-token-main-surface-primary p-1.5 shadow-lg outline-none",children:i.jsx(Vi,{onClickSettings:e})})})]})}function An({currentAccount:e}){const t=!e.isEnterprisey(),n=D(),s=Pe(),a=he();return s?i.jsxs("div",{className:"flex items-center justify-between gap-2 py-2 pl-5 pr-4",children:[s?.email&&i.jsx("div",{className:"text-sm text-token-text-secondary",children:s.email}),t&&i.jsx(ie,{label:n.formatMessage(U.addWorkspaceTooltip),side:"right",children:i.jsx("button",{onClick:()=>pn(a,"profile menu"),children:i.jsx(Pa,{className:"icon-sm text-token-text-primary"})})})]}):null}function zi({currentAccount:e}){return i.jsxs(i.Fragment,{children:[i.jsx(An,{currentAccount:e}),i.jsx("div",{className:"flex h-11 w-full items-center justify-start gap-3 px-3 py-1 text-sm",children:i.jsx(Dn,{workspace:e,isLoading:!1,currentWorkspaceId:e.id,showCheck:!1})})]})}function Rn({menuItemComponent:e}){const t=sn(),n=Wn(),{data:s}=Te(),a=it(s),[o,r]=p.useState(!1),l=Pe(),c=D(),u=rs();if(!a||!s)return null;const m=a.isWorkspaceAccount(),h=s.accountItems.length>1,d=s.accountItems,f=ls([d.find(v=>v.isPersonalAccount()),...d.filter(v=>!v.isPersonalAccount())]);if(f.sort((v,x)=>v.isPersonalAccount()?1:x.isPersonalAccount()?-1:0),!h)return m?i.jsx(zi,{currentAccount:a}):l?.email&&i.jsx("div",{className:"ml-3 mr-2 py-2 text-sm text-token-text-secondary",children:l.email});const g=f.map(v=>{const x=v.isDeactivated();return i.jsx(e,{disabled:x,onClick:()=>{if(x||v.id===a?.id)return;r(!0);const{willRedirect:y}=cs(n,v.id,t,c,u);y||us()},className:$(x&&"pointer-events-auto hover:bg-transparent"),children:v.isDeactivated()?i.jsx(Gi,{workspace:v,isLoading:o}):i.jsx(Dn,{workspace:v,isLoading:o,currentWorkspaceId:a?.id})},v.id)});return i.jsxs(i.Fragment,{children:[i.jsx(An,{currentAccount:a}),i.jsx(k.Separator,{}),g]})}function Dn({workspace:e,isLoading:t,currentWorkspaceId:n,showCheck:s=!0}){const a=e.canAccessWithCurrentSession,o=!t&&s&&e.id===n;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[i.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:i.jsx(dt,{iconSize:"small",workspace:e,className:$({"flex-shrink-0":!0})})}),i.jsx("div",{className:"line-clamp-1 text-token-text-primary",children:an(D(),e)}),t&&i.jsx(Ve,{}),o&&i.jsx("span",{className:"text-token-text-primary",children:i.jsx(ds,{className:"icon-sm"})}),!a&&i.jsx("span",{className:"text-token-text-primary",children:i.jsx(fs,{className:"icon-sm"})})]}),!a&&i.jsx("div",{className:"rowDivClassName",children:i.jsx("small",{className:"text-token-text-secondary",children:i.jsx(E,{...e.ssoConnectionName?U.authenticateWithSSOToAccessWorkspace:U.authenticateWithoutSSOToAccessWorkspace})})})]})}function Gi({workspace:e,isLoading:t}){const n=D(),s=e.isOwnerOfAccount(),[a,o]=p.useState(!1),r=Ma(e.id),l=e.mustGetSubscriptionBillingCurrency("DeactivatedWorkspaceMenuItem");return p.useEffect(()=>{r!=null&&a&&(L.setPurchaseWorkspaceData({minimumSeats:Math.max(r,Ct),billingDetails:{currency:l},existingAccount:e}),o(!1))},[r,a,e,l]),i.jsxs(i.Fragment,{children:[i.jsxs(ie,{className:"flex w-full flex-1 items-center gap-2.5",label:n.formatMessage(U.disabledWorkspaceTooltip),sideOffset:20,side:"right",children:[i.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:i.jsx(Ca,{className:"icon-sm flex-shrink-0 opacity-30"})}),i.jsx("div",{className:"truncate opacity-30",children:an(n,e)})]}),t&&i.jsx(Ve,{}),!t&&i.jsxs(k.Root,{children:[i.jsx(k.Trigger,{className:"rounded text-center hover:bg-token-main-surface-secondary",children:i.jsx(Ia,{className:"icon-sm m-1"})}),i.jsx(k.Portal,{children:i.jsxs(k.Content,{children:[s&&i.jsx(i.Fragment,{children:i.jsx(k.Item,{onClick:()=>{r==null?o(!0):L.setPurchaseWorkspaceData({minimumSeats:Math.max(r,Ct),billingDetails:{currency:l},existingAccount:e})},children:a?i.jsx(Ve,{}):i.jsx(E,{id:"navigation.reactivateWorkspace",defaultMessage:"Reactivate workspace"})})}),i.jsx(k.Item,{onClick:()=>{L.setLeaveWorkspaceData(e)},children:i.jsx(E,{id:"navigation.leaveWorkspace",defaultMessage:"Leave workspace"})})]})})]})]})}function Vi({onClickSettings:e}){const t=Pe(),{data:n}=Te(),s=it(n),a=on(),{clientThreadId:o}=xt(),{isDesktopAppAvailable:r,isSidekickAvailable:l}=ft(),c=Xi(o??"none"),{openModal:u}=rn();if(!s||!n)return null;const m=s.isWorkspaceAccount(),h=!a;return i.jsxs("nav",{children:[i.jsx(Rn,{menuItemComponent:z}),t?.email&&i.jsx(Ue,{}),m?i.jsx(cn,{menuItemComponent:z,routedMenuItemComponent:qi}):i.jsx(ln,{menuItemComponent:z}),h&&i.jsx(z,{href:ka(),target:"_blank",onClick:()=>{j.logEvent(R.clickFaqLink)},icon:Ea,children:i.jsx(E,{...U.helpAndFaq})}),i.jsx(z,{onClick:e,icon:mt,testId:"accounts-settings-button",children:i.jsx(E,{...U.settings})}),(r||c)&&i.jsx(Ue,{}),r&&i.jsx(Yi,{openDownloadModal:u,isSidekickAvailable:l}),c&&i.jsx(Ji,{}),i.jsx(Ue,{}),i.jsx(z,{onClick:()=>{j.logEvent(R.clickLogOut,{eventSource:"mouse"}),j.logLogOutButtonClicked({location:"account_switcher_menu"}),L.openModal(un.LogoutConfirm)},icon:dn,children:i.jsx(E,{...U.logOut})})]})}function Qi(){return Pe()?i.jsx(Zi,{}):null}function Yi({openDownloadModal:e,isSidekickAvailable:t}){return i.jsx("span",{children:i.jsx(z,{icon:fn,onClick:()=>{j.logEvent(R.accountMenuClickDownloadApp),e()},children:i.jsx(E,{...t?U.downloadMacosApp:U.downloadWindowsApp})})})}const Xi=e=>{const t=lt(e),n=ct(t,at.Search),s=ut();return n&&ot()&&!s},Ji=()=>i.jsx("span",{children:i.jsx(z,{icon:mn,onClick:()=>{window.open(gt),j.logEventWithStatsig(R.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:i.jsx(E,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function Zi(){const{data:e}=Te(),t=it(e),n=Ta(),s=ja(),a=D();if(!t||!e)return null;const o=t.isWorkspaceAccount(),r=e.accountItems.length>1;return i.jsxs(pe.Button,{className:"flex w-full max-w-[100%] items-center gap-2 rounded-lg p-2 text-sm hover:bg-token-sidebar-surface-secondary group-ui-open:bg-token-sidebar-surface-secondary","data-testid":"accounts-profile-button","aria-label":a.formatMessage({id:"VYC5Ys",defaultMessage:"Open profile menu for user {userName} in workspace: {workspaceName}"},{userName:s,workspaceName:n}),children:[i.jsx("div",{className:"flex-shrink-0",style:{viewTransitionName:"var(--vt-profile-avatar-sidebar)"},children:i.jsx(dt,{iconSize:"gizmo"})}),i.jsxs("div",{className:"relative -top-px grow -space-y-px truncate text-start text-token-text-primary",children:[i.jsx("div",{dir:"auto",children:s}),o||r?i.jsx("div",{className:"truncate text-xs text-token-text-secondary",dir:"auto",children:n}):null]})]})}const U=Ut({helpAndFaq:{id:"navigation.helpAndFaq",defaultMessage:"Help & FAQ"},settings:{id:"navigation.settings",defaultMessage:"Settings"},logOut:{id:"navigation.logOut",defaultMessage:"Log out"},accountSwitcherTitle:{id:"navigation.accountSwitcherTitle",defaultMessage:"Workspaces"},defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace"},addWorkspaceTooltip:{id:"navigation.addWorkspaceTooltip",defaultMessage:"Create a Team workspace"},disabledWorkspaceTooltip:{id:"navigation.disabledWorkspaceTooltip",defaultMessage:"This workspace has been deactivated"},downloadMacosApp:{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"},downloadWindowsApp:{id:"navigation.downloadWindowsApp",defaultMessage:"Download the Windows app"},authenticateWithSSOToAccessWorkspace:{id:"CV7pdM",defaultMessage:"Authenticate with SSO to access this workspace"},authenticateWithoutSSOToAccessWorkspace:{id:"zfCWFh",defaultMessage:"Authenticate without SSO to access this workspace"}}),xe=ms(ps(()=>({feedItems:[],hasUnreadNotifications:!1,isModalOpen:!1}))),$e=xe.getState,Ke=xe.setState,er={getIsModalOpen:(e=$e())=>e.isModalOpen,getFeedItems:(e=$e())=>e.feedItems,getHasUnreadNotifications:(e=$e())=>e.hasUnreadNotifications},oe={setIsModalOpen:e=>{Ke({isModalOpen:e})},setHasUnreadNotifications:e=>{Ke({hasUnreadNotifications:e})},bulkLoadFeedItems:e=>{Ke(t=>{t.feedItems=e})}};function tr(){const e=St(),t=xe(er.getHasUnreadNotifications);return e&&t}function Fn(e,t,n,s){const a=tr(),o=Na();return a||s&&o?e:t}function St(){const{layer:e}=gs("3606233934");return e.get("enable_notifications_feed")}function Ar(){const e=St(),t=xe(n=>n.isModalOpen);return e&&t}function nr(){const e=St(),t=Bn({queryKey:["fetch-notifications-feed"],queryFn:async()=>{const n=await zt.safeGet("/notifications/feed");return oe.bulkLoadFeedItems(n.items),oe.setHasUnreadNotifications(n.has_unreads),n.items},enabled:e});return{isLoading:t.isLoading,isFetching:t.isFetching}}function Rr(){const e=D(),t=Fn(Aa,_a,!0,!1),n=e.formatMessage({id:"1UHY6w",defaultMessage:"Notifications"});return nr(),i.jsx(ie,{sideOffset:4,label:n,className:"group",children:i.jsx(me,{icon:t,onClick:()=>oe.setIsModalOpen(!0),"aria-label":n})})}function sr({item:e,closeModal:t}){const s={announcement:Wa}[e.type];let a=null;try{const u=new Date(e.created_at);a=Ha({date:u})}catch{}const{clientThreadId:o}=xt(),r=xn(o),l=he(),c=u=>{if(e.action?.type==="show_conversation")t(),l(e.action.conversation_id);else if(e.action?.type==="new_conversation"){const m=e.action;m.prefilled_message&&(r({sourceEvent:u,promptMessage:Ss(m.prefilled_message),requestedModelId:m.model_slug??void 0}),t())}};return i.jsxs("button",{className:"flex w-full items-center justify-start gap-3 overflow-hidden border-t border-token-border-light py-4 first-of-type:border-none",onClick:c,disabled:!e.action,children:[i.jsx("div",{className:"relative",children:s&&i.jsx(s,{className:"icon-md"})}),i.jsxs("div",{className:"flex h-5 shrink grow basis-0 items-center justify-between",children:[i.jsx("div",{className:"text-sm font-normal leading-tight text-token-text-primary",children:e.message}),i.jsx("div",{className:"flex items-center justify-start gap-1",children:i.jsx("div",{className:"text-sm font-normal leading-tight text-token-text-tertiary",children:a??""})})]})]})}function Dr(){const{feedItems:e,isModalOpen:t}=xe();p.useEffect(()=>{t&&(oe.setHasUnreadNotifications(!1),zt.safePost("/notifications/feed/read",{authOption:hs.SendIfAvailable}))},[t]);const n=D(),s=he(),{value:a}=vs("3325813340"),o=new Date,r=Ra(e,c=>{const u=new Date(c.created_at);if(Da(u))return"today";const m=Fa(o,u);return m<=7?"last_7_days":m<=30?"last_30_days":"more_than_30_days"}),l=c=>{switch(c){case"today":return n.formatMessage({id:"zlkA39",defaultMessage:"Today"});case"last_7_days":return n.formatMessage({id:"FW89A4",defaultMessage:"Last 7 days"});case"last_30_days":return n.formatMessage({id:"2s3h/P",defaultMessage:"Last 30 days"});case"more_than_30_days":return n.formatMessage({id:"yArZiR",defaultMessage:"More than 30 days"})}};return i.jsx(xs,{isOpen:t,onClose:()=>{oe.setIsModalOpen(!1)},type:"success",size:"custom",className:"max-w-3xl",children:i.jsxs("div",{className:"flex flex-col gap-y-10",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-2xl font-bold",children:n.formatMessage({id:"kWt8Cx",defaultMessage:"Notifications"})}),a&&i.jsx(Oa,{icon:i.jsx(mt,{className:"icon-lg"}),onClick:()=>{s("/#settings/Notifications")},label:n.formatMessage({id:"mZVh0S",defaultMessage:"Notifications settings"})})]}),Object.entries(r).map(([c,u])=>i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:l(c)}),u.map(m=>i.jsx(sr,{item:m,closeModal:()=>oe.setIsModalOpen(!1)},m.id))]},c))]})})}function Fr({showShareButton:e,showProfileDropdown:t,clientThreadId:n}){const s=Cs(n),a=D(),{layer:o}=fe("1547743984"),[r,l,c]=nt(n,b=>[Ge.hasUserMessage(b),Ge.getGizmoId(b),Ka(b)]),u=vn(l),m=$t(n),{prefetchSearchPromises:h}=xt(),d=h!=null,f=o.get("show_share_button_text",!1),g=a.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),v=()=>L.openSharingModal(s),x=qa(l),y=Kt();return st("1154002920"),Vt(),Ee(),i.jsxs(i.Fragment,{children:[i.jsx(za,{}),u&&m&&!d&&!r&&i.jsx(Ga,{layout:"wide",clientThreadId:n}),y?.includes("caterpillar")&&i.jsx(yo,{}),!1,null,e&&s&&i.jsx(i.Fragment,{children:i.jsx(i.Fragment,{children:f?i.jsx(Qe,{onClick:v,icon:It,label:g,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{viewTransitionName:"var(--vt_share_chat_wide_button)"},children:g}):i.jsx(ie,{label:a.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:i.jsx(me,{"data-testid":"share-chat-button",onClick:v,icon:It,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})})}),!1,m&&l&&x&&i.jsx(i.Fragment,{children:i.jsx(Va,{gizmoId:l})}),t&&i.jsx(or,{clientThreadId:n})]})}function ar({to:e,children:t,icon:n}){const s=he();return i.jsx(k.Item,{icon:n,onSelect:()=>s(e),children:t})}function or({clientThreadId:e}){const{isUnauthenticated:t}=Ee();return kt.markStart("LoginOrProfileMenu"),kt.markRendered("LoginOrProfileMenu"),t?i.jsx(mr,{}):i.jsx(ir,{clientThreadId:e})}function ir({clientThreadId:e}){const{data:t}=Te(),n=ws(),s=ys(),a=n?.isPlus()??!1,o=n?.isWorkspaceAccount()??!1,{openSettings:r}=Ba(),{isDesktopAppAvailable:l}=ft(),c=cr(e??"none"),{openModal:u}=rn(),m=pt(b=>!b.isNavCollapsed),{layer:h}=fe("2888142241"),d=D(),f=t&&bs(t),{layer:g}=fe("2670443078");if(!n)return i.jsx("div",{className:"flex h-10 w-10 items-center justify-center",children:i.jsx("div",{className:"h-8 w-8 rounded-full bg-token-main-surface-tertiary"})});const v=t&&t.accountItems.length>1;let x=!1;!o&&!a&&f&&g.get("is_gating_fix_enabled",!1)&&(x=f);const y=!o&&!x&&h.get("is_upgrade_in_settings",!1);return La(),i.jsxs(Ms,{triggerButton:i.jsx("button",{onClick:()=>{j.logEvent(R.accountOpenProfileMenu),Gt.logEvent("chatgpt_account_open_profile_menu")},"aria-label":d.formatMessage({id:"wz2MQV",defaultMessage:"Open Profile Menu"}),"data-testid":"profile-button",style:{"--legacy-sidebar-offset":m?"260px":""},className:"flex h-10 w-10 items-center justify-center rounded-full hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary focus-visible:outline-0",children:i.jsx(dt,{iconSize:"medium"})}),children:[v&&i.jsx(Rn,{menuItemComponent:k.Item}),v?i.jsx(k.Separator,{}):null,o?i.jsx(cn,{menuItemComponent:k.Item,routedMenuItemComponent:ar}):i.jsx(ln,{menuItemComponent:k.Item}),i.jsx(k.Item,{icon:mt,onClick:()=>r(),"data-testid":"settings-menu-item",children:i.jsx(E,{defaultMessage:"Settings",id:"navigation.settings.0"})}),!1,!1,i.jsx(k.Separator,{}),l&&i.jsx(lr,{openDownloadModal:u}),y&&i.jsx(dr,{currentAccount:s}),c&&i.jsx(ur,{}),i.jsxs(i.Fragment,{children:[(y||l||c)&&i.jsx(k.Separator,{}),i.jsx(k.Item,{onClick:()=>{j.logEvent(R.clickLogOut,{eventSource:"mouse"}),j.logLogOutButtonClicked({location:"profile_drop_down"}),L.openModal(un.LogoutConfirm)},"data-testid":"log-out-menu-item",icon:dn,children:i.jsx(E,{defaultMessage:"Log out",id:"navigation.logOut.0"})}),null]})]})}function rr({onClick:e,className:t,testId:n}){const s=D(),a=Vt(),{value:o}=st("4192239497"),r=vn(),l=a&&!r,c=hn(),u=l?s.formatMessage({id:"yqd/J5",defaultMessage:"Clear chat"}):s.formatMessage({id:"OFyxqj",defaultMessage:"New chat"}),m=h=>{if(!l&&o){if(h.metaKey||h.ctrlKey){j.logEventWithStatsig(R.newChatOpenedInNewTab,"chatgpt_new_chat_opened_in_new_tab");return}h.preventDefault()}!Za(window)&&!c&&L.toggleNavCollapsed(!0),e()};return i.jsx(ie,{sideOffset:4,label:u,className:$("flex",t),children:l||!o?i.jsx(me,{onClick:m,icon:l?Et:Tt,"aria-label":u,"data-testid":n,as:"button"}):i.jsx(me,{onClick:m,icon:l?Et:Tt,"aria-label":u,"data-testid":n,as:"link"})})}function Or({clientThreadId:e,hideNewChat:t=!1}){const[n]=pt(o=>[o.activeStageSidebar]),s=gn(),a=Ua({clientThreadId:e,location:"Navigation actions"});return!s&&!n?null:i.jsxs("div",{className:"flex items-center",children:[i.jsx(fr,{}),!t&&i.jsx(rr,{onClick:a})]})}function lr({openDownloadModal:e}){const{isSidekickAvailable:t}=ft();return i.jsx("span",{children:i.jsx(k.Item,{icon:fn,onClick:()=>{e(),j.logEvent(R.accountMenuClickDownloadApp)},children:t?i.jsx(E,{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"}):i.jsx(E,{id:"navigation.downloadWindowsApp",defaultMessage:"Download the Windows app"})})})}const cr=e=>{const t=lt(e),n=ct(t,at.Search),s=ut();return n&&ot()&&!s},ur=()=>i.jsx("span",{children:i.jsx(k.Item,{icon:mn,onClick:()=>{window.open(gt),j.logEventWithStatsig(R.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:i.jsx(E,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function dr({currentAccount:e}){const t=he(),n=e?.hasPaidSubscription(),s=e?.isPlus(),a=e?.isWorkspacePlan(),o=e?.data.subscriptionStatus.planType;if(n&&!s&&!a)return null;const r=()=>{Gt.logEvent("chatgpt_upgrade_in_settings_menu_clicked",null,{current_plan_type:o??"unknown"}),j.logEvent(R.upgradeInSettingsMenuClicked,{planType:o??"unknown"}),pn(t,"Upper right settings menu")};return i.jsx(k.Item,{icon:$a,onClick:r,children:i.jsx(E,{id:"navigation.upgradePlan",defaultMessage:"Upgrade Plan"})})}function fr(){const e=D(),[t]=pt(u=>[u.activeStageSidebar]),n=gn(),s=on(),a=hn(),{isUnauthenticated:o}=Ee(),r=Fn(Ya,Qa,!0,!0),{layer:l}=fe("3737571708"),c=l.get("sidebar_type","slick");return o&&c==="slick"||!t&&!n||!s?null:i.jsx(ie,{label:e.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:i.jsx(me,{"aria-label":e.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:()=>{L.toggleNavCollapsed(!1,"button_click"),a&&L.setIsSidebarLocked(!0)},icon:r})})}function mr(){const e=sn(),t=Xa(),n=Ja(pr.signUpCta),{layer:s}=fe("3637408529"),a=s.get("is_desktop_primary_auth_button_on_right",!1),o=()=>{e({authType:"login",callback:m=>{j.logLogInButtonClicked({location:"Chat header",provider:m})}})},r=()=>{e({authType:"signup",callback:m=>{j.logSignUpButtonClicked({location:"Chat header",provider:m})}})},l=i.jsx(Qe,{onClick:o,color:t?"primary":"secondary","data-testid":"login-button",className:$(!t&&"screen-arch:hidden md:screen-arch:flex"),children:i.jsx(E,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),c=i.jsx(Qe,{color:t?"secondary":"primary",onClick:r,"data-testid":"signup-button",className:$(t&&"screen-arch:hidden md:screen-arch:flex"),children:i.jsx(E,{...n})},"signup"),u=t?[l,c]:[c,l];return i.jsx("div",{className:"flex items-center justify-center gap-2",children:a?u.reverse():u})}const pr=Ut({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"}});export{Ir as A,Ht as B,Ki as C,kr as D,fr as E,or as L,Ko as M,Dr as N,wi as P,$o as R,yr as S,Nr as U,jr as a,Uo as b,Tr as c,ir as d,Ar as e,_e as f,Tn as g,$i as h,tt as i,Or as j,Cr as k,xt as l,Fr as m,rr as n,Pr as o,Fn as p,St as q,Rr as r,_r as s,vo as t,Er as u,br as v,Mr as w,Wo as x,Bo as y,En as z};
//# sourceMappingURL=exwx6mc6hw49alht.js.map

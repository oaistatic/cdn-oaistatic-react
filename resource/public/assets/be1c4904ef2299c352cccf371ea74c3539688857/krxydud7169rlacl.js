import{fa as E,V as R,w as l,G as h}from"./cyi7nanrg0vdotzd.js";import{r as t,z as M,e as S,f as b,j as m,d as A}from"./fs6h2trisr1juto6.js";import{e as y,f as O}from"./df9u9imhvwerk6zv.js";const T="oauthRedirectUri",x=E(function(){const i=t.useRef(!1),[p,g]=t.useState(""),{code:s,error:r,error_description:n,state:e,[T]:C}=Object.fromEntries(new URLSearchParams(p.substring(1)).entries()),a=M().pluginId,o=S(),u=R(),c=b();t.useEffect(()=>{g(window.location.hash)},[]);const{refetch:d}=y({skip:!0});return t.useEffect(()=>{if(i.current)return;a&&s&&e&&(i.current=!0);async function D(){if(!a||!s||!e){c("/");return}if(e.startsWith("v2__"))try{const f=await O.user_connection_oauth_callback(a,s,e);d(),c(l(h.CUSTOM_MSG,f.redirect_to??"/",o.formatMessage(_.connectedDriveSyncDesc)))}catch{c(l(h.CUSTOM_ERROR,"/",o.formatMessage(_.connectedDriveErrorDesc)));return}}D()},[a,s,e,o,c,C,d]),t.useEffect(()=>{r&&u.danger(`${r}${n?`: ${n}`:""}`)},[r,n,u]),m.jsx(m.Fragment,{})}),_=A({connectedDriveSyncDesc:{id:"CACallback.connectedDriveSyncDesc.1",defaultMessage:"Your account has been connected."},connectedDriveErrorDesc:{id:"CACallback.connectedDriveErrorDesc.1",defaultMessage:"We encountered an issue. Please retry and contact your admin if this issue persists."},emailNotMatchDesc:{id:"CACallback.emailNotMatchDesc.1",defaultMessage:"The account you're trying to connect to doesn't match your ChatGPT account"}});export{x as default};
//# sourceMappingURL=krxydud7169rlacl.js.map

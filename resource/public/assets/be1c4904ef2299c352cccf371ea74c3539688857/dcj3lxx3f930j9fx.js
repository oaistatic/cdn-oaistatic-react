import{u as f,g as h}from"./d3vlrpumel0m4925.js";import{dJ as l,d9 as d,D as m}from"./cyi7nanrg0vdotzd.js";import{r}from"./fs6h2trisr1juto6.js";const g=l()&&d;function D(e){const s=r.useRef(void 0);r.useEffect(()=>{if(!(g||!navigator.permissions))return navigator.permissions.query({name:"microphone"}).then(n=>{s.current=n,n.onchange=()=>{e(n.state==="granted")}}),()=>{s.current&&(s.current.onchange=null)}},[e])}const E=()=>{const[e,s]=r.useState(!1),[n,t]=r.useState(!1),[c,a]=r.useState(),u=r.useCallback(o=>{s(o)},[]);D(u);const i=f(),p=r.useCallback(async()=>n?e:i().then(o=>(s(o),o)).finally(()=>{t(!0)}),[i,n,e]);return r.useEffect(()=>{e&&v().then(o=>{a(o)})},[e]),{requestMicrophonePermissions:p,userDeclinedMicrophonePermissions:n&&!e,microphoneAvailable:e,microphoneLabel:c}},v=async()=>{try{return(await h("audioinput"))?.label??""}catch(e){return m.addError("Failed to fetch default media device",{error:e}),"Error accessing microphone devices"}};export{E as u};
//# sourceMappingURL=dcj3lxx3f930j9fx.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/btrwhqtnzjbkk202.js","assets/bubexfvksfr7893o.js","assets/vu8erv8e9w00mpyg.js","assets/chuo6dbwu6l4alpy.js","assets/8yatsd42k1ox8n2w.js","assets/dt8ggo99jnbjbbe4.js"])))=>i.map(i=>d[i]);
import{R as U,c as E,r as R,j as o,M as V,_ as F,h as K}from"./bubexfvksfr7893o.js";import{u as Q,I as W,g as J,O as X,V as Y,qd as $,T as z,nH as Z,n as ee,nO as te,az as O,cz as T,dS as D,d$ as se,dQ as oe,aA as q}from"./ncw8zw682jinppua.js";import{T as ne}from"./inj2nldnq4zy6wa4.js";import{C as re}from"./b3zmi7k0e1dvao0m.js";import{c as ae}from"./dvti8r1ib1dywoqz.js";import"./gk9c5stronfar8qx.js";import"./lm3g1zm00rp6al39.js";import"./m214aojas5i8u5ss.js";import"./o4w8zbrq7mg3p422.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./drmwaklva7v056il.js";import"./imbbtedzs51am1ck.js";import"./mj32z5vcfl3ugvj5.js";import"./fuwv2o9dqpty536z.js";import"./ebn7bwt2w9d4cap9.js";import"./nxg251y5bix8gl53.js";import"./e2mpe7c8xvk51w5d.js";import"./ecforv0kxuh5qyzb.js";import"./o66elomacusdy99v.js";import"./i6hdqng3ufj5kq75.js";import"./cx20kzi1ifz7iwh5.js";import"./eewckg9c92mnp2ec.js";import"./nizbxgksf6o5ghfr.js";import"./gobx7791fcp89y6h.js";import"./kqh10hum5vnfnvgi.js";import"./gy1lpvuoewmzh42c.js";import"./o6p9t02t81236kdb.js";import"./hu1bt0oauegdhua6.js";import"./bitmj64bbwfuil93.js";import"./izjhrefsvxrmr1ks.js";import"./kbj1b07s2z6vxqkg.js";import"./h1em0bjkpkjv8ykw.js";import"./owbget26s04j6ot0.js";import"./eifqzljcxkeg8zns.js";import"./d5mh1yk0rnxpkd9n.js";import"./e8lckzowfybo0h8f.js";import"./gqlpgmzguho9n5oh.js";import"./lep2wptoy14cfe2w.js";import"./byvy8d7onv4dv8i1.js";import"./gtcvhpyyxjlawokm.js";import"./l8gfdbxyfhb5crrj.js";import"./75duwk5egbi68snc.js";import"./g6618aq5snuywl9f.js";import"./ol9d5wxhynx9q2is.js";import"./ekj7v0hd90m9gfgd.js";import"./hzasobp3hhjtq47p.js";function le({turn:n,turnIndex:e,conversation:t,hasActiveRequest:s,isFinalTurn:i}){return o.jsx(re,{turnIndex:e,conversation:t,groupedMessagesToRender:n.messageGroups,allGroupedMessages:n.messageGroups,allMessages:n.messages,isUserTurn:n.role==="user",isFinalUserTurn:!1,isFinalAssistantTurn:!1,isFinalTurn:i,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,hasActiveRequest:s,onRequestCompletion:()=>{},renderingView:"share-modal"})}function ie(n){"use forget";var g,b,C,N;const e=E.c(27),{messages:t,hasActiveRequest:s,clientThreadId:i,allowOrphanMessages:h}=n,u=Q();let l;e[0]!==u?(l=W(u),e[0]=u,e[1]=l):l=e[1];const{session:r}=l;let a;e[2]!==i||e[3]!==((g=r==null?void 0:r.account)==null?void 0:g.id)||e[4]!==((b=r==null?void 0:r.user)==null?void 0:b.id)?(a=()=>{var j,k;if(i)return null;const v=Z();return z.initThread({clientThreadId:v,conversationMode:{kind:ee.PrimaryAssistant},userId:(j=r==null?void 0:r.user)==null?void 0:j.id,accountId:(k=r==null?void 0:r.account)==null?void 0:k.id}),v},e[2]=i,e[3]=(C=r==null?void 0:r.account)==null?void 0:C.id,e[4]=(N=r==null?void 0:r.user)==null?void 0:N.id,e[5]=a):a=e[5];const[d]=R.useState(a),c=i!=null?i:d;let m;e[6]!==u||e[7]!==c?(m=J(u,c),e[6]=u,e[7]=c,e[8]=m):m=e[8];const p=m;let w;if(e[9]!==h||e[10]!==i||e[11]!==t||e[12]!==c){e:{const v=X(c);if(v&&c===i){let k=[];for(const A of t){let y=A;const I=Y.findNode(v,M=>{const{message:S}=M;return A.id===S.id});!I&&!h||(I&&(y=I.message),k=$(k,y))}w=k;break e}let j;if(e[14]!==t||e[15]!==c){const{allConversationMessages:k,threadResponse:A}=ae(t);z.updateThreadFromServer(c,A);let y=[];for(const I of k)y=$(y,I.message);j=y.filter(ce),e[14]=t,e[15]=c,e[16]=j}else j=e[16];w=j}e[9]=h,e[10]=i,e[11]=t,e[12]=c,e[13]=w}else w=e[13];const _=w;let x;if(e[17]!==p||e[18]!==_||e[19]!==s){let v;e[21]!==p||e[22]!==_.length||e[23]!==s?(v=(j,k)=>o.jsx(le,{turn:j,turnIndex:k,conversation:p,hasActiveRequest:s,isFinalTurn:k===_.length-1},j.messages[0].id),e[21]=p,e[22]=_.length,e[23]=s,e[24]=v):v=e[24],x=_.map(v),e[17]=p,e[18]=_,e[19]=s,e[20]=x}else x=e[20];let f;return e[25]!==x?(f=o.jsx("div",{className:"space-y-2",children:x}),e[25]=x,e[26]=f):f=e[26],f}function ce(n){return n.role!=="root"}const de=U.memo(ie),me=O(()=>F(()=>import("./btrwhqtnzjbkk202.js"),__vite__mapDeps([0,1])),{loading:n=>q(n)}),ue=O(()=>F(()=>import("./vu8erv8e9w00mpyg.js"),__vite__mapDeps([2,1])),{loading:n=>q(n)}),pe=O(()=>F(()=>import("./chuo6dbwu6l4alpy.js"),__vite__mapDeps([3,1])),{loading:n=>q(n)}),xe=O(()=>F(()=>import("./8yatsd42k1ox8n2w.js"),__vite__mapDeps([4,1])),{loading:n=>q(n)}),fe=O(()=>F(()=>import("./dt8ggo99jnbjbbe4.js"),__vite__mapDeps([5,1])),{loading:n=>q(n)}),he=R.memo(ne,(n,e)=>n.sharedTextdoc.sharedTextdocId===e.sharedTextdoc.sharedTextdocId&&n.showHeader===e.showHeader&&n.disableNetworkRequests===e.disableNetworkRequests&&n.unsafeAllowAllNetworkRequests===e.unsafeAllowAllNetworkRequests&&n.disablePermissions===e.disablePermissions);function H({children:n,className:e,fullscreen:t}){const s=R.useRef(null),[i,h]=R.useState(!1),l=oe()?"#353535":"#fff";return R.useEffect(()=>{const r=s.current;if(!r)return;const a=()=>h(r.scrollHeight>r.clientHeight);a();const d=new ResizeObserver(a);return d.observe(r),()=>{d.disconnect()}},[n]),o.jsxs("div",{ref:s,className:T(!t&&"relative",e,!i&&"pb-2"),children:[n,!t&&i&&o.jsx("div",{className:"pointer-events-none absolute start-0 end-0 bottom-0 h-40",style:{background:"linear-gradient(to top, ".concat(l,", transparent)")}})]})}function wt(){return o.jsx("div",{className:"w-full",children:o.jsx("div",{className:"bg-token-main-surface-secondary mx-auto block h-[120px] rounded-3xl",children:o.jsx(te,{})})})}const B={deep_research:o.jsx(pe,{title:"Deep Research",className:"h-[16px] w-[16px]"}),canvas:o.jsx(xe,{title:"Canvas",className:"h-[16px] w-[16px]"}),image:o.jsx(fe,{title:"Image",className:"h-[16px] w-[16px]"}),sora:o.jsx(ue,{title:"Sora",className:"h-[16px] w-[16px]"})},_e={deep_research:"Deep Research",canvas:"Canvas",image:"ImageGen",sora:"Sora"},ge=({icon:n,label:e})=>o.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-white/80 px-2 py-1 text-xs text-black backdrop-blur-xs dark:bg-black/50 dark:text-white",children:[n,o.jsx("span",{className:"font-semibold",children:e})]}),kt=({tags:n,badgeLabels:e})=>{const t=n.filter(s=>!!B[s]);return t.length===0?null:o.jsx("div",{className:"absolute end-3 top-3 z-10 flex gap-2",children:t.map(s=>{var i;return o.jsx(ge,{icon:B[s],label:(i=e==null?void 0:e[s])!=null?i:_e[s]||s},s)})})};function je(n){"use forget";const e=E.c(8),{url:t,attachment_width:s,attachment_height:i,isFullscreen:h}=n,u=h?"mx-auto block max-h-screen max-w-full rounded-none object-contain":"mx-auto block w-full rounded-3xl object-cover object-center";let l;e[0]!==u?(l=T(u),e[0]=u,e[1]=l):l=e[1];const r=s/i;let a;e[2]!==r?(a={aspectRatio:r},e[2]=r,e[3]=a):a=e[3];let d;return e[4]!==l||e[5]!==a||e[6]!==t?(d=o.jsx("video",{className:l,style:a,src:t,playsInline:!0,autoPlay:!0,muted:!0,loop:!0}),e[4]=l,e[5]=a,e[6]=t,e[7]=d):d=e[7],d}const ve=R.memo(je);function be(n){"use forget";const e=E.c(17),{attachment:t,isFullscreen:s,isInline:i,isComposer:h}=n,u=s&&"flex h-screen items-center justify-center",l=s&&"rounded-none",r=i&&"rounded-3xl",a=h&&"mx-24 rounded-3xl";let d;e[0]!==u||e[1]!==l||e[2]!==r||e[3]!==a?(d=T(u,l,r,a),e[0]=u,e[1]=l,e[2]=r,e[3]=a,e[4]=d):d=e[4];let c;e[5]!==t.generation_type||e[6]!==t.height||e[7]!==t.kind||e[8]!==t.output_blocked||e[9]!==t.url||e[10]!==t.width||e[11]!==s||e[12]!==i?(c=t.generation_type==="video_gen"?o.jsx(ve,{url:t.url,attachment_width:t.width,attachment_height:t.height,isFullscreen:s,isInline:i}):o.jsxs("div",{className:"relative",children:[o.jsx("img",{className:T(s?"mx-auto block max-h-screen max-w-full rounded-none object-contain":"mx-auto block rounded-3xl object-cover object-center"),style:{aspectRatio:t.width/t.height},src:t.url,alt:t.kind}),t.output_blocked&&o.jsxs("div",{className:"text-token-text-error absolute start-0 bottom-0 flex h-1/4 w-full items-center justify-center gap-1 bg-transparent text-xs font-medium",children:[o.jsx(me,{className:"text-red-500"}),o.jsx(V,{id:"post-tree-attachment-output-blocked",defaultMessage:"Blocked by moderation"})]})]}),e[5]=t.generation_type,e[6]=t.height,e[7]=t.kind,e[8]=t.output_blocked,e[9]=t.url,e[10]=t.width,e[11]=s,e[12]=i,e[13]=c):c=e[13];let m;return e[14]!==d||e[15]!==c?(m=o.jsx("div",{className:d,children:c}),e[14]=d,e[15]=c,e[16]=m):m=e[16],m}const we=R.memo(be);function ke(n){"use forget";const e=E.c(18),{url:t,isFullscreen:s,isInline:i,isComposer:h,isUnfurl:u}=n,l=K(),r=s&&"flex h-screen items-center justify-center",a=s&&"rounded-none",d=i&&"rounded-3xl",c=h&&"mx-24 rounded-3xl",m=u&&"h-full w-full";let p;e[0]!==r||e[1]!==a||e[2]!==d||e[3]!==c||e[4]!==m?(p=T(r,a,d,c,m),e[0]=r,e[1]=a,e[2]=d,e[3]=c,e[4]=m,e[5]=p):p=e[5];const w=s?"mx-auto block max-h-screen max-w-full":"mx-auto block aspect-square",_=s?"rounded-none object-contain":u?"h-full w-full rounded-none object-cover object-top":"rounded-3xl object-center";let x;e[6]!==w||e[7]!==_?(x=T(w,_),e[6]=w,e[7]=_,e[8]=x):x=e[8];let f;e[9]!==l?(f=l.formatMessage({id:"image-share-renderer-alt",defaultMessage:"User Shared Image"}),e[9]=l,e[10]=f):f=e[10];let g;e[11]!==f||e[12]!==x||e[13]!==t?(g=o.jsx("img",{src:t,className:x,alt:f}),e[11]=f,e[12]=x,e[13]=t,e[14]=g):g=e[14];let b;return e[15]!==g||e[16]!==p?(b=o.jsx("div",{className:p,children:g}),e[15]=g,e[16]=p,e[17]=b):b=e[17],b}const L=R.memo(ke);function Ce(n){"use forget";const e=E.c(14),{attachment:t,isFullscreen:s,isInline:i}=n,h=s?"h-[100vh] rounded-none":"",u=i?"h-[300px] cursor-zoom-in overflow-hidden rounded-3xl":"flex-1";let l;e[0]!==h||e[1]!==u?(l=T("bg-token-main-surface-primary w-full",h,u),e[0]=h,e[1]=u,e[2]=l):l=e[2];const r=!s,a=t.shared_textdoc.textdoc_type;let d;e[3]!==t.shared_textdoc.content||e[4]!==t.shared_textdoc.name||e[5]!==t.shared_textdoc_id||e[6]!==a?(d={sharedTextdocId:t.shared_textdoc_id,title:t.shared_textdoc.name,type:a,content:t.shared_textdoc.content},e[3]=t.shared_textdoc.content,e[4]=t.shared_textdoc.name,e[5]=t.shared_textdoc_id,e[6]=a,e[7]=d):d=e[7];let c;e[8]!==r||e[9]!==d?(c=o.jsx(he,{disablePermissions:r,sharedTextdoc:d,showHeader:!1,unsafeAllowAllNetworkRequests:!0}),e[8]=r,e[9]=d,e[10]=c):c=e[10];let m;return e[11]!==l||e[12]!==c?(m=o.jsx("div",{className:l,children:c}),e[11]=l,e[12]=c,e[13]=m):m=e[13],m}const Ne=R.memo(Ce);function ye({attachment:n,caption:e,variant:t,coverPhotoUrl:s,hasActiveRequest:i,clientThreadId:h}){var c;const u=(c=n.tags)==null?void 0:c.includes("deep_research"),l=t==="fullscreen",r=t==="inline",a=t==="composer",d=t==="unfurl";switch(n.kind){case"message_slice":return n.messages.length===0?null:o.jsx(P,{caption:e,variant:t,coverPhotoUrl:s,messages:n.messages,hasActiveRequest:i,hasCaption:!u,clientThreadId:h});case"conversation_share":{const m=n.share.linear_conversation.map(p=>p.message).filter(p=>p!=null);return m.length===0?null:o.jsx(P,{hasCaption:!1,caption:e,variant:t,coverPhotoUrl:s,messages:m,hasActiveRequest:i,clientThreadId:h})}case"image_share":return o.jsx(L,{url:n.file_public_url,isFullscreen:l,isInline:r,isComposer:a,isUnfurl:d});case"media_generation":return o.jsx(L,{url:n.url,isFullscreen:l,isInline:r,isComposer:a,isUnfurl:d});case"canvas":return o.jsx(Ne,{attachment:n,isFullscreen:l,isInline:r});case"sora":return o.jsx(we,{attachment:n,isFullscreen:l,isInline:r,isComposer:a});case"link":return o.jsx(Te,{url:n.url,ogData:n.og_data,isFullscreen:l,isInline:r,isComposer:a});case"error":return o.jsx("div",{children:o.jsx(V,{id:"post-tree-attachment-error",defaultMessage:"Error loading attachment"})});default:return null}}function Ie(n){"use forget";var j;const e=E.c(31),{url:t,ogData:s,isFullscreen:i,isInline:h,isComposer:u}=n,l=i&&"h-screen overflow-auto rounded-none",r=u&&"shadow-[0_12px_24px_-6px_rgb(0_0_0_/_0.1),0_0_1px_rgb(0_0_0_/_0.2)] dark:shadow-[0_10px_20px_-6px_rgb(20_20_20_/_0.5),inset_0_0_1px_rgb(255_255_255_/_0.3)]";let a;e[0]!==l||e[1]!==r?(a=T("bg-token-main-surface-primary inline-block w-full rounded-3xl dark:bg-[#353535]",l,r),e[0]=l,e[1]=r,e[2]=a):a=e[2];const d=!h,c=i&&"relative p-4 lg:px-24 lg:py-24";let m;e[3]!==c?(m=T("rounded-b-3xl",c),e[3]=c,e[4]=m):m=e[4];let p;e[5]!==s.og_image||e[6]!==s.og_title?(p=s.og_image&&o.jsx("img",{className:"h-40 w-40 object-cover",src:s.og_image,alt:(j=s.og_title)!=null?j:void 0}),e[5]=s.og_image,e[6]=s.og_title,e[7]=p):p=e[7];const w=s.og_title||t;let _;e[8]!==w?(_=o.jsx("div",{className:"text-token-text-primary font-medium",children:w}),e[8]=w,e[9]=_):_=e[9];let x;e[10]!==s.og_site_name?(x=s.og_site_name&&o.jsx("div",{className:"text-token-text-tertiary",children:s.og_site_name}),e[10]=s.og_site_name,e[11]=x):x=e[11];let f;e[12]!==s.og_description?(f=s.og_description&&o.jsx("div",{className:"text-token-text-secondary",children:s.og_description}),e[12]=s.og_description,e[13]=f):f=e[13];let g;e[14]!==x||e[15]!==f||e[16]!==_?(g=o.jsxs("div",{className:"flex flex-col gap-2",children:[_,x,f]}),e[14]=x,e[15]=f,e[16]=_,e[17]=g):g=e[17];let b;e[18]!==g||e[19]!==p?(b=o.jsxs("div",{className:"items-top flex flex-row gap-4",children:[p,g]}),e[18]=g,e[19]=p,e[20]=b):b=e[20];let C;e[21]!==b||e[22]!==t?(C=o.jsx("div",{className:"flex flex-col gap-2 p-4",children:o.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-token-main-surface-secondary break-words hover:underline",children:b})}),e[21]=b,e[22]=t,e[23]=C):C=e[23];let N;e[24]!==C||e[25]!==d||e[26]!==m?(N=o.jsx(H,{fullscreen:d,className:m,children:C}),e[24]=C,e[25]=d,e[26]=m,e[27]=N):N=e[27];let v;return e[28]!==N||e[29]!==a?(v=o.jsx(D.div,{layout:"position",className:a,children:N}),e[28]=N,e[29]=a,e[30]=v):v=e[30],v}const Te=R.memo(Ie);function P(n){"use forget";const e=E.c(36),{caption:t,variant:s,coverPhotoUrl:i,messages:h,hasActiveRequest:u,hasCaption:l,clientThreadId:r}=n,a=s==="fullscreen",d=s==="inline",c=s==="composer",m=s==="unfurl",p=a&&"h-screen overflow-auto rounded-none",w=c&&"shadow-[0_12px_24px_-6px_rgb(0_0_0_/_0.1),0_0_1px_rgb(0_0_0_/_0.2)] dark:shadow-[0_10px_20px_-6px_rgb(20_20_20_/_0.5),inset_0_0_1px_rgb(255_255_255_/_0.3)]",_=m&&"h-full";let x;e[0]!==p||e[1]!==w||e[2]!==_?(x=T("bg-token-main-surface-primary inline-block w-full rounded-3xl dark:bg-[#353535]",p,w,_),e[0]=p,e[1]=w,e[2]=_,e[3]=x):x=e[3];let f;e[4]!==t||e[5]!==i||e[6]!==a||e[7]!==s?(f=i&&o.jsx("img",{className:T("max-h-[300px] w-full object-cover object-center",{"rounded-t-3xl":s!=="fullscreen","rounded-none":a}),src:i,alt:t!=null?t:""}),e[4]=t,e[5]=i,e[6]=a,e[7]=s,e[8]=f):f=e[8];const g=!d,b=a&&"relative p-4 lg:px-24 lg:py-24",C=d&&"max-h-[300px] overflow-hidden p-6",N=c&&"max-h-[300px] overflow-auto p-6",v=m&&"h-full overflow-hidden p-5";let j;e[9]!==v||e[10]!==b||e[11]!==C||e[12]!==N?(j=T("rounded-b-3xl",b,C,N,v),e[9]=v,e[10]=b,e[11]=C,e[12]=N,e[13]=j):j=e[13];let k;e[14]===Symbol.for("react.memo_cache_sentinel")?(k={type:"spring",duration:.45,bounce:.15},e[14]=k):k=e[14];let A;e[15]!==t||e[16]!==l||e[17]!==s?(A=l?t==null&&s==="composer"?o.jsx(D.div,{layout:"position",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:o.jsx("div",{className:"text-token-text-primary max-w-[460px] pb-8 text-2xl leading-[1.4] font-medium",children:o.jsx("span",{className:"animate-pulse opacity-30",children:o.jsx(V,{id:"placeholder.generatingTitle",defaultMessage:"Generating title..."})})})},"loading-caption"):t!==""?o.jsx(D.div,{layout:"position",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:o.jsx("div",{className:"text-token-text-primary max-w-[460px] pb-8 text-2xl leading-[1.4] font-medium",children:t})},"caption"):null:null,e[15]=t,e[16]=l,e[17]=s,e[18]=A):A=e[18];let y;e[19]!==A?(y=o.jsx(se,{mode:"wait",children:A}),e[19]=A,e[20]=y):y=e[20];let I;e[21]!==r||e[22]!==u||e[23]!==h?(I=o.jsx(de,{messages:h,hasActiveRequest:u,clientThreadId:r,allowOrphanMessages:!0}),e[21]=r,e[22]=u,e[23]=h,e[24]=I):I=e[24];let M;e[25]!==y||e[26]!==I?(M=o.jsxs(D.div,{layout:"position",transition:k,children:[y,I]}),e[25]=y,e[26]=I,e[27]=M):M=e[27];let S;e[28]!==j||e[29]!==M||e[30]!==g?(S=o.jsx(H,{fullscreen:g,className:j,children:M}),e[28]=j,e[29]=M,e[30]=g,e[31]=S):S=e[31];let G;return e[32]!==S||e[33]!==x||e[34]!==f?(G=o.jsxs(D.div,{layout:"position",className:x,children:[f,S]}),e[32]=S,e[33]=x,e[34]=f,e[35]=G):G=e[35],G}const Ct=R.memo(ye);export{Ct as AttachmentContent,ye as AttachmentContentImpl,_e as BADGE_LABELS,ge as Badge,kt as BadgeContainer,wt as LoadingAttachmentContent};
//# sourceMappingURL=n17yjgieu7k6cshj.js.map

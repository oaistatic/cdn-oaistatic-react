const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dsh0s17w9xqme9qg.js","assets/bubexfvksfr7893o.js","assets/c0cigwrjirtldn2y.js","assets/diw1uvps7iz4sxyn.js","assets/lm3g1zm00rp6al39.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/jjcc0i8g6768wslh.js","assets/k1cl8bhg0vqi0zvs.js","assets/o14hp1xetur7zx0w.js","assets/gj3272f6kxuxc3jv.js","assets/gfe80db92046bqvj.js","assets/kf7tqzde2yk57qjr.js","assets/lv4xa94hrnn1trhl.js","assets/jt2omlt107se63w9.js","assets/l5e2clfxpgm30p9v.js","assets/khrrhmpc9956cz8v.js","assets/jxyz1kdkcze5jtww.js","assets/ei2rr3u86wwo8xvm.js","assets/mlll5kvj3qdj7fj8.js","assets/jx5pd8qsxc77tbjo.js","assets/d9d46aun6hvzsagm.js","assets/9paxni9f8n7suc5d.js","assets/m82uim4b34dlt07y.js","assets/ls5w4xhmfxey8hbl.js","assets/mub8z62y3ne5qedg.js","assets/uulovtkdggk971z9.js","assets/pctpk2nmf382irxh.js","assets/kux43ylsu8hzp3nl.js","assets/iqak4d8n645iefiy.js","assets/hqbshwkn4xaba14o.js","assets/czfk2xng6iz6p6m1.js","assets/d9bf8tg6o5lnic5i.js","assets/ns1vyo5kzmxgh5gj.js","assets/ef5noj24t7u7w8z6.js","assets/jeaomqbuafptryjs.js","assets/hahiy9dm7k71twz4.js","assets/ep5wvjiuce9gz0i0.js","assets/fccn8kjovbs6wko3.js","assets/byvy8d7onv4dv8i1.js","assets/gtcvhpyyxjlawokm.js","assets/l8gfdbxyfhb5crrj.js","assets/mg42e28yllzkdaxs.js","assets/mf0m4r73wo03szkn.js","assets/g78s6ea1fdv7ipue.js","assets/bitmj64bbwfuil93.js","assets/izjhrefsvxrmr1ks.js","assets/kbj1b07s2z6vxqkg.js","assets/hu1bt0oauegdhua6.js","assets/h1em0bjkpkjv8ykw.js","assets/owbget26s04j6ot0.js","assets/gy1lpvuoewmzh42c.js","assets/o6p9t02t81236kdb.js","assets/n117ifjno76hbo3f.js","assets/gqlpgmzguho9n5oh.js","assets/m609xwboj0zo059y.js","assets/eifqzljcxkeg8zns.js","assets/kqh10hum5vnfnvgi.js","assets/j51b3b8y7dx543la.js","assets/lep2wptoy14cfe2w.js","assets/nuc0uj19s7rn62on.js","assets/kpldwkdi6k2a2fdo.js","assets/g06xst48b3fvssvn.js","assets/mh06u253e6rqurrk.js","assets/of2lqa4u24wak95x.js","assets/product-variants-gcznzbx5.css","assets/oc4lr1ricjtltb4h.js","assets/hzasobp3hhjtq47p.js","assets/o31w8j5urfak3xuz.js","assets/iiok29s29bpdre61.js","assets/yp6xblbn4tr1qh0n.js","assets/cxp76v1gv71u5chl.js","assets/nzkkesm2p4dklarf.js","assets/iv5xwnwraxd9v7zq.js","assets/o0dw43fppqvaf7ws.js","assets/icif99f9c6x3iitu.js","assets/f1ucdf2dx4ztfnd4.js","assets/kou7k14ueo6peaoq.js","assets/k3w19w5sa48fujqs.js","assets/gfhyoobo4q8q2pzd.js","assets/n8w61inav9kre7iu.js","assets/n630qnacd2oui4py.js","assets/cxhvc6trae8s9e85.js","assets/ha3yj3u2f1w16goy.js","assets/ansi-1f6vhsjh.css","assets/mamq4h01m06sylys.js","assets/bjkxn2ge6s764t7e.js","assets/h4jnqd77fz22arvf.js","assets/d5mh1yk0rnxpkd9n.js","assets/gobx7791fcp89y6h.js","assets/eewckg9c92mnp2ec.js","assets/imbbtedzs51am1ck.js","assets/fuwv2o9dqpty536z.js","assets/nxg251y5bix8gl53.js","assets/e8lckzowfybo0h8f.js","assets/kzvpseqfc0j2fpii.js","assets/ce3hgmw4iyyhicud.js","assets/cifdjmblsrwrxxb4.js","assets/m214aojas5i8u5ss.js","assets/l4pcm542yc2tenou.js","assets/ecforv0kxuh5qyzb.js","assets/ffvjxtmoqooghm1t.js","assets/eqqsnl6kprwt6kvn.js","assets/cdu988xkidlznefj.js","assets/owg1t5lbjzwpi0hd.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/writing-block-focused-view-h5h01uzk.css","assets/5o6mgwufgbxa936e.js","assets/hdkg0cys1b7b4f0v.js","assets/dgs0l83heankdts0.js","assets/cxce66s7ooa3xwei.js","assets/b07v92w48quo33nt.js","assets/g6618aq5snuywl9f.js","assets/ol9d5wxhynx9q2is.js","assets/i0wiaw6wtevb2frn.js","assets/fna9z31n721lpf9f.js","assets/table-components-iztk4amh.css"])))=>i.map(i=>d[i]);
var Qs=Object.freeze,tn=Object.defineProperty,Pr=Object.defineProperties;var Ar=Object.getOwnPropertyDescriptors;var wt=Object.getOwnPropertySymbols;var sn=Object.prototype.hasOwnProperty,nn=Object.prototype.propertyIsEnumerable;var ss=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t);var en=(t,e,s)=>e in t?tn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,D=(t,e)=>{for(var s in e||(e={}))sn.call(e,s)&&en(t,s,e[s]);if(wt)for(var s of wt(e))nn.call(e,s)&&en(t,s,e[s]);return t},U=(t,e)=>Pr(t,Ar(e));var on=t=>typeof t=="symbol"?t:t+"",Te=(t,e)=>{var s={};for(var n in t)sn.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&wt)for(var n of wt(t))e.indexOf(n)<0&&nn.call(t,n)&&(s[n]=t[n]);return s};var jt=(t,e)=>Qs(tn(t,"raw",{value:Qs(e||t.slice())}));var kt=function(t,e){this[0]=t,this[1]=e},rn=(t,e,s)=>{var n=(i,l,c,d)=>{try{var u=s[i](l),m=(l=u.value)instanceof kt,h=u.done;Promise.resolve(m?l[0]:l).then(x=>m?n(i==="return"?i:"next",l[1]?{done:x.done,value:x.value}:x,c,d):c({value:x,done:h})).catch(x=>n("throw",x,c,d))}catch(x){d(x)}},r=i=>a[i]=l=>new Promise((c,d)=>n(i,l,c,d)),a={};return s=s.apply(t,e),a[ss("asyncIterator")]=()=>a,r("next"),r("throw"),r("return"),a};var ns=(t,e,s)=>(e=t[ss("asyncIterator")])?e.call(t):(t=t[ss("iterator")](),e={},s=(n,r)=>(r=t[n])&&(e[n]=a=>new Promise((i,l,c)=>(a=r.call(t,a),c=a.done,Promise.resolve(a.value).then(d=>i({value:d,done:c}),l)))),s("next"),s("return"),e);import{j as o,_ as Z,M as H,h as le,r as p,v as Ir,c as he,i as Lr,l as mt,d as Rr,w as Dr,b as Fr,g as Or,n as Ps,R as xo,e as As}from"./bubexfvksfr7893o.js";import{M as zr,u as bs,R as _s,c as vs,S as ws,m as Wr,d as Hr,I as Br,e as Vr,C as Ur,f as qr,g as Gr,h as Zr,i as Xr}from"./g78s6ea1fdv7ipue.js";import{az as X,aA as Q,cz as I,y0 as Yr,P as Bt,M as Vt,aw as Kr,e7 as yt,u as xe,p as Ut,J as Se,b7 as Is,pr as Jr,e4 as Qr,bd as ea,D as qt,c8 as ta,b9 as sa,a6 as an,d as Ve,bE as yo,e as na,aP as bo,au as _o,eF as oa,aB as Pe,dc as qe,dC as ra,du as aa,dv as ia,dS as at,cr as Ls,jU as la,jC as ca,rr as da,cp as Rs,dn as vo,dp as wo,ds as jo,lq as Lt,hs as ko,cv as Co,lT as ua,dN as ma,ct as bt,bp as We,hV as Gt,gC as So,z as Zt,aa as No,hK as Qe,l6 as fa,R as ha,A as pa,y1 as ga,hJ as xa,gG as ya,lX as ba,ji as os,d$ as js,ee as Mo,dQ as Xt,L as _a,fO as va,V as Ye,hP as wa,ic as ja,_ as Tt,gZ as ka,hi as Ca,ij as Sa,dR as Na,W as Ma,pZ as ut,ek as Eo,aN as To,n3 as Ea,i8 as Ta,cw as $o,e8 as $a,y2 as Pa,ff as Aa,eH as Ia,bx as La,e$ as Ra,kt as Da,fb as Po,ay as Fa,cs as rs,O as ln,nR as Oa,aT as za,$ as Wa,a0 as Ha}from"./ncw8zw682jinppua.js";import{u as Ba,g as Va,s as as,F as Ue,C as Ua,I as qa,P as Ga,a as Za,b as Xa,c as Ya,d as Ka}from"./nuc0uj19s7rn62on.js";import{yK as Ja,yL as Ao,gJ as Io,ak as Qa,al as Lo,o$ as ei,dg as ti,dr as si,cK as Ds,fa as Ke,f8 as ni,cc as oi,lD as ri,h9 as Fs,ha as Os,B as zs,E as Ws,qz as ai,cv as Ro,gf as ii,ge as li,lT as Je,cw as Hs,yM as Yt,qD as Do,yN as Fo,yO as Oo,yP as zo,yQ as ci,cs as Kt,c6 as $t,lC as di,S as ui,bK as mi,Q as _t,mo as Wo,lN as fi,yR as hi,nt as pi,gS as gi,lR as Ho,bO as xi,mc as yi,yS as bi,nc as _i,yT as Bo,ac as Vo,yU as vi,yV as wi,nf as ji,e0 as ki,cF as Ci,cA as Si,yW as Uo,a_ as Ee,yX as Ni,ab as Mi,j2 as Ei,jS as Ct,h7 as Ti,g9 as $i,yY as Pi,yZ as Ai,x1 as Ii}from"./lm3g1zm00rp6al39.js";import{u as Bs}from"./oc4lr1ricjtltb4h.js";import{N as Li}from"./hzasobp3hhjtq47p.js";import{g as cn,F as Ri,i as Di}from"./o31w8j5urfak3xuz.js";import{v as Fi,u as Oi,P as zi,W as Wi}from"./gfe80db92046bqvj.js";import{L as Hi}from"./iiok29s29bpdre61.js";import{b as Bi,C as Vi}from"./bitmj64bbwfuil93.js";import{a as Ui}from"./yp6xblbn4tr1qh0n.js";import{A as Pt,g as qi,c as Gi,b as ks,o as Zi,I as qo,D as Xi,d as Yi}from"./izjhrefsvxrmr1ks.js";import{u as Ki}from"./mf0m4r73wo03szkn.js";import{W as Ji,c as Qi,b as el,a as tl}from"./n117ifjno76hbo3f.js";import{W as Jt}from"./cxp76v1gv71u5chl.js";import{W as sl}from"./nzkkesm2p4dklarf.js";import{W as dn,i as nl}from"./iv5xwnwraxd9v7zq.js";import{u as ol}from"./cxhvc6trae8s9e85.js";import{k as rl,A as al,W as il,m as ll}from"./o0dw43fppqvaf7ws.js";import{A as cl}from"./ha3yj3u2f1w16goy.js";import{a as dl,d as Go,E as is,e as Zo,f as Xo,b as Yo,c as Ko,g as Cs,u as ul,W as un,p as ml}from"./mamq4h01m06sylys.js";import{u as Vs}from"./5o6mgwufgbxa936e.js";import{n as fl,p as hl,w as pl}from"./hdkg0cys1b7b4f0v.js";import{M as Us}from"./j51b3b8y7dx543la.js";import{a as gl,b as xl}from"./dgs0l83heankdts0.js";import{g as yl,b as bl,a as _l,c as vl,F as wl,d as jl}from"./byvy8d7onv4dv8i1.js";import{v as mn,C as kl,A as Cl,h as Sl,j as Nl,f as Ml,p as El,k as Tl,n as $l,P as Pl,o as Al,q as Il,L as Ll}from"./cxce66s7ooa3xwei.js";import{u as ft,t as fn,r as Ss,g as ze}from"./b07v92w48quo33nt.js";import{c as Jo}from"./g6618aq5snuywl9f.js";import{a as Rl,T as Dl}from"./i0wiaw6wtevb2frn.js";const Fl=Jo("ChevronDownFilled","1em",["M15.8 7.73c.28.3.27.78-.03 1.06l-5.25 5a.75.75 0 0 1-1.04 0l-5.25-5a.75.75 0 0 1 1.04-1.08L10 12.2l4.73-4.5a.75.75 0 0 1 1.06.02Z"]),Ol=Jo("ChevronLeftFilled","1em",["M12.27 15.8a.75.75 0 0 1-1.06-.03l-5-5.25a.75.75 0 0 1 0-1.04l5-5.25a.75.75 0 1 1 1.08 1.04L7.8 10l4.5 4.73c.29.3.28.78-.02 1.06Z"]);function zl(){var t=fl(arguments),e=t.text,s=t.options,n=t.metadata;return hl(e,s,n)}function Wl(){return pl(zl,arguments)}const Hl=X(()=>Z(()=>import("./dsh0s17w9xqme9qg.js"),__vite__mapDeps([0,1])),{loading:t=>Q(t)});function Bl(s){var n=s,{children:t}=n,e=Te(n,["children"]);return o.jsxs(zr,U(D({},e),{className:"decorated-link",children:[t,o.jsx("span",{"aria-hidden":!0,className:"ms-0.5 inline-block align-middle leading-none",children:o.jsx(Hl,{className:"block h-[0.75em] w-[0.75em] stroke-current stroke-[0.75]"})})]}))}const hn=({children:t,"data-start":e=null,"data-end":s=null,"data-is-last-node":n,"data-is-only-node":r,tag:a})=>{const{animationTiming:i,shouldAnimate:l,shouldHide:c,isDisabled:d,onComplete:u,onReady:m}=Ba({isMarker:!0,tag:a,children:t,start:e,end:s,isLastNode:n,isOnlyNode:r});return d||c?o.jsx(a,{"data-start":e,"data-end":s,className:I(c&&"hidden"),children:t}):o.jsx(a,{"data-start":e,"data-end":s,className:I(as.marker,l?as.animate:as.hidden),onAnimationStart:()=>m(0),onAnimationEnd:()=>u(0),style:Va(i),children:t})},Vl={p:t=>o.jsx(Ue,D({tag:"p"},t)),h1:t=>o.jsx(Ue,D({tag:"h1"},t)),h2:t=>o.jsx(Ue,D({tag:"h2"},t)),h3:t=>o.jsx(Ue,D({tag:"h3"},t)),h4:t=>o.jsx(Ue,D({tag:"h4"},t)),h5:t=>o.jsx(Ue,D({tag:"h5"},t)),h6:t=>o.jsx(Ue,D({tag:"h6"},t)),li:t=>o.jsx(hn,D({tag:"li",isListItem:!0},t)),hr:t=>o.jsx(hn,D({tag:"hr"},t))};function Ul(t){const e=t.split("\n");Gl(e);const s=e.pop();if(s===":"||s==="::")e.push("");else{const n=ql(s).trimEnd();n&&e.push(n)}return e.join("\n")}function ql(t){if(!t||/^\s*-\s*([*_]+)?\s*$/.test(t))return"";const e=[];let s="",n=0;for(;n<t.length;){if(t[n]==="*"&&t[n+1]==="*"){s+="**",e.length&&e[e.length-1]==="**"?e.pop():e.push("**"),n+=2;continue}if(t[n]==="*"||t[n]==="_"){s+=t[n];const a=t[n];e.length&&e[e.length-1]===a?e.pop():e.push(a),n++;continue}if(t[n]==="["){const a=t[n];s+=a,e.push(a),n++;continue}if(t[n]==="]"){const a=t[n];s+=a,e.length&&e[e.length-1]==="["&&e.pop(),n++;continue}if(t[n]==="("&&t[n-1]==="]"){const a=t[n];s+=a,e.push(a),n++;continue}if(t[n]===")"){const a=t[n];s+=a,e.length&&e[e.length-1]==="("&&e.pop(),n++;continue}s+=t[n],n++}if(e.length===0)return t;let r=s.trimEnd();for(;e.length;){const a=e.pop();if(a==null)break;a==="("?r+=")":r.endsWith(a)?r=r.slice(0,-a.length).trimEnd():a==="["?r+="]()":r+=a}return r}function Gl(t){let e=!1,s=null;for(let n=0;n<t.length;n++){const r=t[n],a=Ja(r);if(a){const l=a.info.trimStart(),c=a.info.trim();if(e)s&&a.marker===s.marker&&a.fence.length===s.fence.length&&c.length===0&&(s=null);else if(l.startsWith("{")){const d=Jl(t,n,a);t[n]=d.normalizedLine,(d.linesConsumed>0||d.replacementLines.length)&&t.splice(n+1,d.linesConsumed,...d.replacementLines),s=a}else if(c.length===0&&n===t.length-1){t[n]="";continue}e=!e;continue}if(e){s&&sc(r,s)&&(t[n]="".concat(s.leadingWhitespace).concat(s.fence),s=null,e=!1);continue}const i=r.trim();if(i.startsWith(":::")&&i!==":::"){const l=i.indexOf("{");if(l===-1){const c=i.slice(3).trim();if(c.length>0&&!(c in Yr)){t[n]=":::";continue}const d=r.replace(/\s+$/,"");t[n]=d+"{}";continue}Xl(i,l)||(t[n]=Zl(r,r.indexOf("{")))}t.length>1&&t[t.length-1]===":::"&&t[t.length-2]===":::"&&t.splice(-2)}s&&(t.push("".concat(s.leadingWhitespace).concat(s.fence)),s=null)}function Zl(t,e){const s=t.replace(/\s+$/,""),n=s.slice(0,e).replace(/\s+$/,""),r=s.slice(e+1);if(r.trim().length===0||!/=/.test(r))return n+"{}";let i=null,l=!1;for(let c=0;c<r.length;c++){const d=r[c];if(l){l=!1;continue}if(d==="\\"){l=!0;continue}if(i){d===i&&(i=null);continue}if(d==='"'||d==="'"){i=d;continue}}return i?s+i+"}":/=[\s]*$/.test(r)?s+'""}':s+"}"}function Xl(t,e){let s=null,n=0,r=!1;for(let a=e;a<t.length;a++){const i=t[a];if(r){r=!1;continue}if(i==="\\"){r=!0;continue}if(s){i===s&&(s=null);continue}if(i==='"'||i==="'"){s=i;continue}if(i==="{"){n++;continue}if(i==="}"){if(n--,n===0)return!0;continue}}return!1}function Yl(t){const e=t.match(/^\s*/),s=e?e[0]:"",n=t.slice(s.length);if(!n.startsWith("{"))return"".concat(s,"{}");let r;try{const[l]=Ao(n,!0);r=l}catch(l){return"".concat(s,"{}")}const a=Qo(r);if(!a)return"".concat(s,"{}");const i=JSON.stringify(a);return"".concat(s).concat(i)}function Qo(t){if(!(!t||Array.isArray(t)||typeof t!="object"))return t}const Kl=4,er=2048;function Jl(t,e,s){var d,u;const n=s.leadingWhitespace.length+s.fence.length;let a=(u=(d=t[e])==null?void 0:d.slice(n))!=null?u:"",i=0,l=pn(a);if(l.kind==="complete")return{normalizedLine:gn(s,l.value),linesConsumed:0,replacementLines:xn(l.remainder)};for(;l.kind==="needsMore"&&i<Kl&&a.length<er;){const m=e+i+1;if(m>=t.length)break;const h=t[m];if(!ec(h))break;if(i++,a="".concat(a,"\n").concat(h!=null?h:""),l=pn(a),l.kind==="complete")return{normalizedLine:gn(s,l.value),linesConsumed:i,replacementLines:xn(l.remainder)};if(l.kind==="invalid")break}return{normalizedLine:Ql(s,a),linesConsumed:i,replacementLines:[]}}function pn(t){if(!t)return{kind:"invalid"};const e=t.indexOf("{");if(e===-1)return{kind:"invalid"};const s=t.slice(e),n=tc(s);if(n==null)return t.length>=er?{kind:"invalid"}:{kind:"needsMore"};const r=s.slice(0,n+1);try{const[a,i]=Ao(r.trim()),l=Qo(a);if(!l)return{kind:"invalid"};if(i!=null)return{kind:"needsMore"};const c=s.slice(n+1);return{kind:"complete",value:l,remainder:c}}catch(a){return{kind:"invalid"}}}function gn(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence);return"".concat(s).concat(JSON.stringify(e))}function Ql(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence),n=Yl(e.replace(/\r?\n+/g," ").trimStart()).trim();return n.length===0?"".concat(s,"{}"):"".concat(s).concat(n)}function ec(t){if(!t)return!1;const e=t.trimStart();if(e.length===0)return!0;const s=e[0];return s==='"'||s==="'"||s==="{"||s==="}"||s==="["||s===","}function tc(t){let e=!1,s=0,n=!1,r=!1;for(let a=0;a<t.length;a++){const i=t[a];if(!e){i==="{"&&(e=!0,s=1);continue}if(r){r=!1;continue}if(i==="\\"){r=!0;continue}if(n){i==='"'&&(n=!1);continue}if(i==='"'){n=!0;continue}if(i==="{"){s++;continue}if(i==="}"){if(s--,s===0)return a;continue}}return null}function xn(t){if(!t)return[];const e=t.startsWith("\n")?t.slice(1):t;return e.length===0?[]:e.split("\n")}function sc(t,e){const s=t.trim();return s.length===0||!nc(s,e.marker)?!1:s.length<e.fence.length}function nc(t,e){for(let s=0;s<t.length;s++)if(t[s]!==e)return!1;return!0}const oc=X(()=>Z(()=>import("./c0cigwrjirtldn2y.js"),__vite__mapDeps([2,1])),{loading:t=>Q(t)});function rc({citation:t}){return o.jsx(Io,{side:"top",triggerButton:o.jsx("span",{className:"inline-flex items-center font-bold",children:o.jsx(H,{id:"ZNWtPG",defaultMessage:"{startChar}clipboard {icon}{endChar}",values:{startChar:"「",icon:o.jsx(oc,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:o.jsxs("div",{className:"flex flex-col items-stretch gap-1",children:[o.jsx("div",{className:"flex justify-end border-b",children:o.jsx(Qa,{onCopy:e=>Lo(t.text,void 0,e),buttonText:!0,textPosition:"left"})}),o.jsx("div",{children:t.text})]})})}const ac=X(()=>Z(()=>import("./diw1uvps7iz4sxyn.js"),__vite__mapDeps([3,1])),{loading:t=>Q(t)});function ic({citation:t,conversation:e,nodeType:s}){const n=le(),r=Bt(e.id),a=ei(t.screenshot_asset_pointer,r);return s==="containerDirective"&&n.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"}),o.jsx(Io,{side:"top",triggerButton:o.jsx("span",{className:"inline-flex items-center font-bold",children:o.jsx(H,{id:"qUxKU1",defaultMessage:"{startChar}screenshot {icon}{endChar}",values:{startChar:"「",icon:o.jsx(ac,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:a?o.jsx("img",{className:"w-xl max-w-screen",src:a,alt:n.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"})}):o.jsx("div",{className:"text-sm",children:o.jsx(H,{id:"BUdJTR",defaultMessage:"Screenshot not available"})})})}const lc=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.z9),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function tr({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r,isStandaloneAttachment:a}){const i=Bt(t.id),l=Vt(t.id,v=>{var w;return e?(w=v==null?void 0:v.tree.getNodeIfExists(e))==null?void 0:w.message:void 0}),c=p.useMemo(()=>{var j;if(!l)return null;const v={content_type:Kr.Text,parts:["{{file:".concat(s,"}}")]},w=U(D({},l==null?void 0:l.metadata),{is_synthetic_share_message:!0,is_standalone_share_attachment:a});return w.content_references=(j=r==null?void 0:r.displayedContentReferences.filter(C=>C.type!=="debug"))!=null?j:[],w.citations=[],r&&(v.parts=[r.rawText],w.n7jupd_crefs=r.n7jupdCrefs),U(D({},l),{id:Ir(),content:v,metadata:w})},[l,s,r,a]),d=p.useMemo(()=>{if(!(!l||!c||!i))return{previewMessage:c,clientThreadId:t.id,fileId:s,messageId:l.id,serverThreadId:i,isStandaloneAttachment:a,fileName:n}},[c,t.id,s,l,i,a,n]),u=ti({odysseyShareIntent:d,clientThreadId:t.id}),[m,h]=p.useState(!1);return{onClick:p.useCallback(async()=>{h(!0),await u(),h(!1)},[h,u]),isLoading:m,isEnabled:!!d}}function cc({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r}){const a=le(),{onClick:i,isLoading:l,isEnabled:c}=tr({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r,isStandaloneAttachment:!1});return c?o.jsx(si,{onClick:i,label:a.formatMessage({id:"ConversationTurn.sharePostButtonTooltip",defaultMessage:"Share"}),icon:l?yt:lc}):null}function dc(t){return t.endsWith(".md")}const uc=({citation:t,conversation:e,messageId:s})=>{const n=xe(),[r,a]=p.useState(!1),i=Bt(e.id),l=Ut(),[c,d]=p.useState(null),u=p.useRef(null),m=p.useCallback(k=>{l.danger(k,{toastId:"ttom_file_citation_failed_to_download_file"})},[l]),h=t.file_id,x=Se(n,"3154019201"),_=x,v=Ds(),w=Bs(!0,i,h,void 0,m),j=w==null?void 0:w.data,C=(w==null?void 0:w.isPending)||!1;p.useEffect(()=>{var k;if((j==null?void 0:j.status)==="success"&&j.download_url){(k=u.current)==null||k.abort();const S=new AbortController;u.current=S,a(!0),(async()=>{try{const N=await fetch(j.download_url,{headers:v?{}:Is(),signal:S.signal});if(!N.ok)throw new Error("HTTP ".concat(N.status));d(await N.text())}catch(N){N.name!=="AbortError"&&l.danger("Failed to download file",{toastId:"ttom_file_citation_failed_to_download_file"})}finally{a(!1)}})()}return()=>{var S;(S=u.current)==null||S.abort()}},[j,l,v]);const f=p.useContext(Ke),y=p.useMemo(()=>{var F,L,T,M,z,G,B,K,te;if(c==null)return null;const S=(M=((T=(L=(F=f==null?void 0:f.message)==null?void 0:F.metadata)==null?void 0:L.content_references_by_file)!=null?T:{})[t.cite_key])!=null?M:[],N=Jr(c,S);let E=N.processedText;const $=(z=N.displayedContentReferences)!=null?z:[],b=(te=((K=(B=(G=f==null?void 0:f.message)==null?void 0:G.metadata)==null?void 0:B.n7jupd_crefs_by_file)!=null?K:{})[t.cite_key])!=null?te:[];return b.length>0&&(E=ni(E,b)),{processedText:E,displayedContentReferences:$,n7jupdCrefs:b,rawText:c}},[c,f,t.cite_key]);return C||r?o.jsx(yt,{className:"inline"}):!y||!(f!=null&&f.message)?"[Could not display report]":o.jsx(Ke.Provider,{value:U(D({},f),{contentReferences:y.displayedContentReferences,n7jupdCrefs:y.n7jupdCrefs}),children:o.jsxs("div",{className:"border-token-border-light dark:border-token-bg-tertiary @container relative mx-[-16px] mt-4 mb-4 flex cursor-text flex-col items-start overflow-hidden rounded-[14px] border px-4 pt-6 pb-6 contain-inline-size sm:mx-[-32px] sm:rounded-[28px] sm:px-8 sm:shadow-sm",children:[o.jsx("div",{className:"w-full pt-1 pb-1 sm:pt-4 sm:pb-3",children:o.jsx(oi,{conversation:e,componentOverrides:Li,children:y.processedText})}),_&&o.jsx("div",{className:"flex",children:x&&o.jsx(cc,{conversation:e,messageId:s,fileId:h,fileName:t.file_name,processedMarkdownInfo:y,isStandaloneAttachment:!1})})]})})},yn=(t,e)=>{const s=new Hi(new URL("{{.assetPrefix}}/assets/walnut-worker-DDidQYdP.js",import.meta.url),{type:"module"});return new Promise((n,r)=>{s.onmessage=a=>{var i;s.terminate(),a.data.error?r(new Error(a.data.error)):n((i=a.data.protoBytes)!=null?i:new Uint8Array)},s.onerror=a=>{s.terminate(),r(a)},s.postMessage({bytes:t.buffer,ext:e},[t.buffer])})},mc="Walnut",fc={hash:"sha256-LqZfOaN8w1y5KOF6ytEmIdqOkXeRAKzJtivwaYHqku4=",fingerprinting:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"DocumentFormat.OpenXml.Framework.wasm","DocumentFormat.OpenXml.r766fg9imt.wasm":"DocumentFormat.OpenXml.wasm","Google.Protobuf.bvef67su4p.wasm":"Google.Protobuf.wasm","System.Collections.Concurrent.dg7gv773h7.wasm":"System.Collections.Concurrent.wasm","System.Collections.NonGeneric.xh26yzmj9q.wasm":"System.Collections.NonGeneric.wasm","System.Collections.Specialized.k9ijgfx3oq.wasm":"System.Collections.Specialized.wasm","System.Collections.e40hzefbp0.wasm":"System.Collections.wasm","System.ComponentModel.Primitives.p7eihts9gc.wasm":"System.ComponentModel.Primitives.wasm","System.ComponentModel.TypeConverter.yc3lg0zbud.wasm":"System.ComponentModel.TypeConverter.wasm","System.ComponentModel.nu6ttwym4t.wasm":"System.ComponentModel.wasm","System.Console.2u9f7xoyjt.wasm":"System.Console.wasm","System.Diagnostics.DiagnosticSource.3zzx5i2bbp.wasm":"System.Diagnostics.DiagnosticSource.wasm","System.IO.Compression.hdb1gzcatq.wasm":"System.IO.Compression.wasm","System.IO.Packaging.8th4tkd3a0.wasm":"System.IO.Packaging.wasm","System.Linq.Expressions.y2o66p61a5.wasm":"System.Linq.Expressions.wasm","System.Linq.pk029p0ix8.wasm":"System.Linq.wasm","System.Memory.pk7xw966yi.wasm":"System.Memory.wasm","System.Net.Http.ela86sx87h.wasm":"System.Net.Http.wasm","System.Net.Primitives.e24bsgwgy3.wasm":"System.Net.Primitives.wasm","System.ObjectModel.6ul5qo6tt0.wasm":"System.ObjectModel.wasm","System.Private.CoreLib.2ast54y18t.wasm":"System.Private.CoreLib.wasm","System.Private.Uri.34jz1zbpkm.wasm":"System.Private.Uri.wasm","System.Private.Xml.Linq.qo5fu6rx08.wasm":"System.Private.Xml.Linq.wasm","System.Private.Xml.jqrh4s0xni.wasm":"System.Private.Xml.wasm","System.Runtime.InteropServices.JavaScript.ptvo7oirfc.wasm":"System.Runtime.InteropServices.JavaScript.wasm","System.Security.Cryptography.yghuwbq1rf.wasm":"System.Security.Cryptography.wasm","System.Text.RegularExpressions.woo0o1jb20.wasm":"System.Text.RegularExpressions.wasm","System.8rv0tdtrxz.wasm":"System.wasm","System.Xml.Linq.fnt4rzi185.wasm":"System.Xml.Linq.wasm","Walnut.0vgw8eoql2.wasm":"Walnut.wasm","dotnet.native.0636i1lq9c.js":"dotnet.native.js","dotnet.native.zzbol9rv1j.wasm":"dotnet.native.wasm","dotnet.js":"dotnet.js","dotnet.runtime.drv0pr9n5o.js":"dotnet.runtime.js","icudt_CJK.tjcz0u77k5.dat":"icudt_CJK.dat","icudt_EFIGS.tptq2av103.dat":"icudt_EFIGS.dat","icudt_no_CJK.lfu7j35m59.dat":"icudt_no_CJK.dat"},jsModuleNative:{"dotnet.native.0636i1lq9c.js":"sha256-eOSbmdfdvZnWUgf0HnOlq0pzSFy11pyE4WY5A/bXqIY="},jsModuleRuntime:{"dotnet.runtime.drv0pr9n5o.js":"sha256-yfXUv1l/B489E8p12JxUvxly0JvHL9CCsoZUDlfGH9c="},wasmNative:{"dotnet.native.zzbol9rv1j.wasm":"sha256-v7sIQgsxYlZxP1U1O8+/+QbuogAs3q+OgUmKYGQEhL8="},icu:{"icudt_CJK.tjcz0u77k5.dat":"sha256-SZLtQnRc0JkwqHab0VUVP7T3uBPSeYzxzDnpxPpUnHk=","icudt_EFIGS.tptq2av103.dat":"sha256-8fItetYY8kQ0ww6oxwTLiT3oXlBwHKumbeP2pRF4yTc=","icudt_no_CJK.lfu7j35m59.dat":"sha256-L7sV7NEYP37/Qr2FPCePo5cJqRgTXRwGHuwF5Q+0Nfs="},coreAssembly:{"System.Private.CoreLib.2ast54y18t.wasm":"sha256-aklKXz16j6YsJZ7e7Kith4Jncrh9z8KwSVqmZ9onfUc=","System.Runtime.InteropServices.JavaScript.ptvo7oirfc.wasm":"sha256-46EslAlUY8PCFPNNdxh6xyl1tMDibDGNP8Izg1454zo="},assembly:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"sha256-kqKbud4eaFNkjKW0OqLAmn6WKvayLb00uusbPCIHELQ=","DocumentFormat.OpenXml.r766fg9imt.wasm":"sha256-CdxuDQwg/TCEGCjgMmTFDI1VqSvhCPjufTf6E34sRcc=","Google.Protobuf.bvef67su4p.wasm":"sha256-+YTHK5iMJ1qqT8rwso0msRnFimxTnVn7anp423wPdM4=","System.Collections.Concurrent.dg7gv773h7.wasm":"sha256-Q0t+lcdV4fbf4dlwKQCsokiL4Xwb5/RA4PKHw0Epfy4=","System.Collections.NonGeneric.xh26yzmj9q.wasm":"sha256-JUDrn7Om1WpQQdWHTaqXKj/3EobK0GWT1k1gVLEN/DM=","System.Collections.Specialized.k9ijgfx3oq.wasm":"sha256-OF8j9PfGV75lZ7E3FyULLUIRFPJQvpkm4IPxppAWJbc=","System.Collections.e40hzefbp0.wasm":"sha256-3sUZ64D/YCJbw5WumYeKGFTRuqgQauwlXdeT6qTqnfg=","System.ComponentModel.Primitives.p7eihts9gc.wasm":"sha256-dV0r23r7Lx5OxQXMJ14aC6agLulNBGIKSruhV0rx1yk=","System.ComponentModel.TypeConverter.yc3lg0zbud.wasm":"sha256-vvvYMybVeXzv4HJqiyd7iNAPMZ1jcbplD3jR0OUpKlU=","System.ComponentModel.nu6ttwym4t.wasm":"sha256-EdstTP9IiGWSnfAiUfYQU/+yVLpIFnkDsEhkbUYb1Bk=","System.Console.2u9f7xoyjt.wasm":"sha256-impSSXOvVI1OlM3VB67h2UWC8s89uwvX6Hgpj61TXr4=","System.Diagnostics.DiagnosticSource.3zzx5i2bbp.wasm":"sha256-X8GRK2kyaCYrvHDMMpZah01/45/agEOGsEGDme3FoYc=","System.IO.Compression.hdb1gzcatq.wasm":"sha256-1avnbMsYG348l6vTPbcjRPhUYpJotFC3oo4HhvAx0/U=","System.IO.Packaging.8th4tkd3a0.wasm":"sha256-1C+I5A7ESuL28X57RP+FiTL8ayuTe86SmJE6NSg4dQA=","System.Linq.Expressions.y2o66p61a5.wasm":"sha256-aim/Zu8aVv9Ks0amT1ETMHDVYou4htLWYVaiY6t6jFI=","System.Linq.pk029p0ix8.wasm":"sha256-l2OMvJ/4QA2lOgA9B5jpmCTtbi3eQCI6kzh8FtE2dRQ=","System.Memory.pk7xw966yi.wasm":"sha256-mWj1AQRTZv4MVK979XjQrZBgC+TsR5qspsObnCl0OZE=","System.Net.Http.ela86sx87h.wasm":"sha256-oq1HdWFv3md3LJ+cuYG4SvSqFkxHG9hAjiDKFOmitno=","System.Net.Primitives.e24bsgwgy3.wasm":"sha256-VsWTEOyEbltVNWebWtzswCEfVLEN7seHoNS6agRLaJw=","System.ObjectModel.6ul5qo6tt0.wasm":"sha256-Mqjt8iygUqGlnAvdiEdCvkrO/2e2oT04GXu9W3klLBw=","System.Private.Uri.34jz1zbpkm.wasm":"sha256-fbeiKtQPeS/eVZ4NLtr/UMtzpz1Qj7DWR1/jOBWoPfE=","System.Private.Xml.Linq.qo5fu6rx08.wasm":"sha256-do8HcvsRlHrzqquDkQl6MMvuTEgZIypo9T4sy8aw20Q=","System.Private.Xml.jqrh4s0xni.wasm":"sha256-VaUN8FKyCWvhqngi8AGac1fdW6tbrriW5tSxbTMpX6U=","System.Security.Cryptography.yghuwbq1rf.wasm":"sha256-8r8r+1iud18cVRj+drs6QMU+Pbi5fh3tj50AilEPWto=","System.Text.RegularExpressions.woo0o1jb20.wasm":"sha256-ANdAHV1xjhmnR3y6yA9nEMpmcfuT2mmd8oQ84iNsSd8=","System.8rv0tdtrxz.wasm":"sha256-xMF0eauQ5DkSzUozHLFFMQnL6DSJO09nJLtgag+Dzbw=","System.Xml.Linq.fnt4rzi185.wasm":"sha256-5claBNmyy8L12DFLS17Fh4SBiTjwhYts3ds7g8dX8Gc=","Walnut.0vgw8eoql2.wasm":"sha256-XB2iiH4JHEYveaOiBw5Lz1hhUTOkKGyw+VJNv+kAitM="}},hc=0,pc=!0,gc="sharded",xc={mainAssemblyName:mc,resources:fc,debugLevel:hc,linkerEnabled:pc,globalizationMode:gc};let St=null;async function yc(){const t=await Fi.withConfig(xc).withResourceLoader((s,n,r,a)=>s==="dotnetjs"?r:new URL(r,location.href).origin!==location.origin?fetch(r,{credentials:"omit",integrity:a}):r).create(),e=t.getConfig().mainAssemblyName;return e?t.getAssemblyExports(e):null}const bc=()=>(St!=null||(St=yc()),St);function _c(){"use forget";const t=he.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=bc(),t[0]=e):e=t[0],e}const vc=X(()=>Z(()=>import("./jjcc0i8g6768wslh.js"),__vite__mapDeps([8,1])),{loading:t=>Q(t)}),wc=X(()=>Z(()=>import("./k1cl8bhg0vqi0zvs.js"),__vite__mapDeps([9,1])),{loading:t=>Q(t)}),jc=X(()=>Z(()=>import("./o14hp1xetur7zx0w.js"),__vite__mapDeps([10,1,5,6,11,12,4,7,13,14,15])).then(t=>t.WalnutMiniPlayer)),kc=({citation:t,conversation:e,messageId:s})=>{var A,g,O,R,W;const n=_c(),[r,a]=p.useState(!1),[i,l]=p.useState(null),[c,d]=p.useState(!1),u=!!((g=(A=p.useContext(Ke))==null?void 0:A.message.metadata)!=null&&g.is_standalone_share_attachment),m=Qr(),{presentationMap:h,updatePresentationMap:x,open:_}=Oi(),v=xe(),w=Bt(e.id),j=Se(v,"3154019201")&&!!w,C=Se(v,"638971034"),f=ea(v,"2888003541").value,y=Number((O=f==null?void 0:f.max_bytes)!=null?O:3e7),k=Ut(),S=p.useRef(null),N=p.useCallback(V=>{k.danger(V,{toastId:"w_failed_to_download_file"})},[k]),E=!!t.file_id,$=Bs(!1,e.id,t.file_id,()=>{},N),P=(R=h[t.file_id])==null?void 0:R.presentation,b=(W=h[t.file_id])==null?void 0:W.workbook,F=p.useCallback(async V=>{if(e.id!==void 0){V.preventDefault();const{data:Y}=await $.refetch();if(Y===void 0||(Y==null?void 0:Y.status)!=="success"){k.danger("Failed to download file");return}const J=document.createElement("a");J.href=Y.download_url,J.click()}},[e.id,$,k]),{refetch:L}=$,T=Ds();p.useEffect(()=>{var Y;(Y=S.current)==null||Y.abort();const V=new AbortController;return S.current=V,a(!0),(async()=>{var de;let J=!1;try{const{data:oe}=await L();if(oe===void 0||(oe==null?void 0:oe.status)!=="success"){k.danger("Failed to download file");return}const ie=await fetch(oe.download_url,{headers:T?{}:Is(),signal:V.signal});if(!ie.ok)throw new Error("HTTP ".concat(ie.status));const ee=await ie.blob();if(y!==0&&ee.size>y){d(!0),l("fileTooLarge"),J=!0;return}const ye=new Uint8Array(await ee.arrayBuffer()),ue=(de=cn(t.file_name))!=null?de:"pptx";if(ue==="pptx"){let re;if(C)re=await yn(ye,ue);else{const ne=await n;if(!ne)return;re=ne.PptxReader.ExtractSlidesProto(ye,!1)}const be=zi.decode(re);x(t.file_id,{fileBlob:ee,fileName:t.file_name,presentation:be,workbook:null,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}else{let re;if(C)re=await yn(ye,ue);else{const ne=await n;if(!ne)return;re=ne.XlsxReader.ExtractXlsxProto(ye,!1)}const be=Wi.decode(re);x(t.file_id,{fileBlob:ee,fileName:t.file_name,presentation:null,workbook:be,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}}catch(oe){oe.name!=="AbortError"&&(d(!0),qt.addError(oe,{file_id:t.file_id}))}finally{a(!1),m&&!J&&_(t.file_id)}})(),()=>{var J;(J=S.current)==null||J.abort()}},[L,k,x,t.file_name,t.file_id,m,_,y,T,n,C]);function M(V){V.preventDefault(),_(t.file_id)}const{onClick:z,isLoading:G,isEnabled:B}=tr({conversation:e,messageId:s,fileId:t.file_id,fileName:t.file_name,processedMarkdownInfo:null,isStandaloneAttachment:!0}),K=u&&!m,te=cn(t.file_name);return o.jsxs("div",{className:I("border-token-border-light flex max-w-[calc(0.8*var(--thread-content-max-width,40rem))] flex-col overflow-hidden rounded-lg border",u&&"mx-auto my-0"),children:[o.jsxs("div",{className:"text-token-text-secondary border-token-border-light flex flex-row justify-between gap-4 border-b p-2",children:[o.jsxs("div",{className:"flex flex-row items-center gap-2 overflow-hidden",children:[o.jsx(Ri,{fileName:t.file_name}),o.jsx("div",{className:"truncate text-sm font-medium",children:te==="pptx"?o.jsx(H,{id:"HTIcmf",defaultMessage:"Presentation"}):o.jsx(H,{id:"pftlup",defaultMessage:"Spreadsheet"})})]}),o.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center",children:[!K&&o.jsxs(o.Fragment,{children:[E&&o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",onClick:F,children:o.jsx(wc,{})}),o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary disabled:text-token-text-tertiary rounded-full p-1 disabled:cursor-not-allowed disabled:bg-transparent",disabled:!P&&!b,onClick:M,children:o.jsx(vc,{})})]}),j&&!!s&&B&&o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",disabled:!B,onClick:z,children:G?o.jsx(yt,{}):o.jsx(Cc,{})})]})]}),o.jsxs("div",{className:"bg-token-bg-secondary group relative p-2",children:[o.jsx(jc,{walnutId:t.file_id,isLoading:r,isError:c,isInShareModal:K,errorMessage:i,handleDownloadClick:F}),K&&o.jsx("div",{className:"absolute end-5 top-46 z-10 inline-flex flex-shrink-0 items-end justify-end",children:o.jsx(ri,{className:I("inline h-4 w-24 text-end")})})]})]})},Cc=({className:t})=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:t,children:[o.jsx("path",{d:"M3 12.4428V12.2806C3 11.9219 3.2843 11.631 3.63497 11.631C3.98563 11.631 4.26993 11.9219 4.26993 12.2806V12.4428C4.26993 13.1372 4.2708 13.6193 4.3007 13.994C4.33 14.3609 4.38426 14.5675 4.46108 14.7218L4.52821 14.8459C4.69655 15.1266 4.93812 15.3556 5.22657 15.5061L5.35059 15.5604C5.48786 15.6107 5.6688 15.6476 5.938 15.6701C6.30417 15.7008 6.77519 15.7007 7.45408 15.7007H12.546C13.2246 15.7007 13.6959 15.7008 14.0621 15.6701C14.4204 15.6402 14.6226 15.5846 14.7735 15.5061L14.8946 15.4364C15.169 15.2642 15.3929 15.0169 15.5399 14.7218L15.593 14.595C15.6421 14.4546 15.6782 14.2692 15.7003 13.994C15.7301 13.6193 15.73 13.1372 15.73 12.4428V12.2806C15.73 11.922 16.0145 11.6312 16.3651 11.631C16.7157 11.631 17 11.9219 17 12.2806V12.4428C17 13.1158 17.0006 13.6601 16.9655 14.0999C16.9342 14.4916 16.8722 14.8443 16.7343 15.1731L16.6709 15.3123C16.4174 15.8213 16.0318 16.2469 15.5585 16.544L15.3506 16.6632C14.9909 16.8507 14.6028 16.9281 14.1655 16.9646C13.7356 17.0006 13.2038 17 12.546 17H7.45408C6.79615 17 6.26438 17.0006 5.8345 16.9646C5.45207 16.9327 5.10749 16.8699 4.78649 16.729L4.65035 16.6632C4.1528 16.4038 3.73604 16.0094 3.44569 15.5251L3.32914 15.3123C3.14585 14.9444 3.07023 14.5473 3.03451 14.0999C2.9994 13.6601 3 13.1158 3 12.4428Z"}),o.jsx("path",{d:"M9.99993 13.2544C10.3505 13.2544 10.6348 12.9635 10.6348 12.6047V5.218L12.7337 7.36545L12.8335 7.44845C13.0799 7.61506 13.4146 7.58749 13.6316 7.36545C13.8486 7.14342 13.8756 6.80101 13.7127 6.54884L13.6316 6.44677L10.4493 3.19088C10.3302 3.06897 10.1683 3 9.99993 3C9.8316 3.0001 9.67044 3.06906 9.55138 3.19088L6.36815 6.44677C6.12048 6.70037 6.12057 7.11179 6.36815 7.36545C6.58526 7.58755 6.92077 7.61523 7.1673 7.44845L7.26707 7.36545L9.36491 5.21897V12.6047C9.36491 12.9634 9.64934 13.2542 9.99993 13.2544Z"})]}),Sc=new Set(["jpg","jpeg","png","gif","webp","svg"]),Nc=t=>{const e=t.split(".").pop();return e?Sc.has(e):!1};function Mc({citation:t,conversation:e,messageId:s}){var c;const n=xe(),r=ta(),a=sa(),i=p.useRef(r!==an.Research),l=Ve(e.serverId$);if(p.useEffect(()=>{!i.current&&r===an.Research&&(i.current=!0,a(null))},[r,a]),Di(t.file_name)&&Se(n,"3392860057"))return o.jsx(kc,{citation:t,conversation:e,messageId:s,children:(c=t.label)!=null?c:t.file_name});if(dc(t.file_name))return o.jsx(uc,{citation:t,conversation:e,messageId:s});if(l)return o.jsx(Ec,{citation:t,serverThreadId:l})}function Ec({citation:t,serverThreadId:e}){var a,i;const s=Ut(),n=p.useCallback(l=>{s.danger(l,{toastId:"fcoa_renderer_failed_to_download_file"})},[s]),{data:r}=Bs(!0,e,t.file_id,void 0,n);return Nc(t.file_name)&&(r!=null&&r.download_url)?o.jsx("img",{src:r==null?void 0:r.download_url,alt:(a=t.label)!=null?a:t.file_name,className:"max-h-[350px] max-w-screen"}):o.jsx("a",{href:r==null?void 0:r.download_url,children:(i=t.label)!=null?i:t.file_name})}function Tc({citationIndex:t,conversation:e,nodeType:s,messageId:n}){var l;const r=parseInt(t,10),a=p.useContext(Ke);if(!a)return null;const i=(l=a.n7jupdCrefs)==null?void 0:l[r];if(!i)return null;switch(i.type){case"clipboard":return o.jsx(rc,{citation:i});case"computer_output":return o.jsx(ic,{citation:i,conversation:e,nodeType:s});case"file":return o.jsx(Mc,{citation:i,conversation:e,messageId:n});case"invalid":return null}}function $c(t){return t&&/^turn[0-9]+ifs[0-9]+$/.test(t)}const Pc=X(()=>Z(()=>import("./l5e2clfxpgm30p9v.js"),__vite__mapDeps([16,1])),{loading:t=>Q(t)}),Ac=X(()=>Z(()=>import("./khrrhmpc9956cz8v.js"),__vite__mapDeps([17,1])),{loading:t=>Q(t)});function Ic({path:t,lineRangeStart:e,lineRangeEnd:s,gitUrl:n}){const[r,a]=p.useState(!1),i=p.useContext(Jt),l=p.useRef(null),c=p.useRef(null),d=p.useRef(null),u=()=>{d.current&&(clearTimeout(d.current),d.current=null),a(!0)},m=()=>{d.current=window.setTimeout(()=>{a(!1)},200)};if(!t)return null;const h=i==null?void 0:i.fileSnapshots.find(_=>_.path===t);if(!h)return null;const x=Rc(e,s,h);return x.length?o.jsxs(Fs,{open:r,onOpenChange:a,children:[o.jsx(Os,{asChild:!0,onMouseEnter:u,onMouseLeave:m,children:o.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:o.jsx(Ac,{className:"size-[10px]"})})}),o.jsx(zs,{children:o.jsx(Ws,{ref:c,className:"z-50 focus:outline-none",side:"right",onMouseEnter:u,onMouseLeave:m,onOpenAutoFocus:_=>_.preventDefault(),children:o.jsx(Lc,{snapshot:h,snippetLines:x,lineRangeStart:e,lineRangeEnd:s,gitUrl:n})})})]}):null}function Lc({snapshot:t,snippetLines:e,lineRangeStart:s,lineRangeEnd:n,gitUrl:r}){var c;const a=(c=t.path.split(".").pop())!=null?c:"sh",i=e.reduce((d,u)=>{if(u.trim()==="")return d;const m=u.match(/^\s*/),h=m?m[0].length:0;return d===-1?h:Math.min(d,h)},-1),l=e.map(d=>i>0?d.slice(i):d).join("\n");return o.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex max-h-[600px] flex-col rounded-2xl border px-2 pt-2 pb-4 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[l&&o.jsx(ai,{wrapperClassName:"rounded-lg !bg-token-bg-tertiary !border-none mb-3 max-h-[400px] overflow-auto text-xs w-[600px] max-w-full",codeContainerClassName:"!p-2",language:a,content:l,showActionBar:!1}),o.jsxs("div",{className:"grid w-full grid-cols-[minmax(0,1fr)_auto] items-center justify-between gap-1 px-2 text-sm",children:[t.path,o.jsxs("div",{className:"text-token-text-tertiary flex items-center gap-1 whitespace-nowrap",children:[o.jsx(H,{id:"wham.citation.file.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:s,lineRangeEnd:n}}),r&&o.jsx("a",{className:"group flex w-full items-center gap-1 p-1",href:r,target:"_blank",rel:"noopener noreferrer",children:o.jsx(Pc,{className:"icon-xs hover:text-token-text-primary"})})]})]})]})}function Rc(t,e,s){var i;if(s.contents){const l=s.contents.split("\n"),c=Math.max(0,t-1),d=e?Math.min(l.length,e):c+1;return l.slice(c,d)}const n=(i=s.line_range_contents)==null?void 0:i.find(l=>Dc(l,t,e));if(!n)return[];const r=Math.max(t-n.line_range_start,0),a=r+(e-t+1);return n.content.slice(r,a)}function Dc(t,e,s){return e<t.line_range_start?!1:!(s>t.line_range_end)}function Fc({assetPointer:t}){var i,l,c,d,u;const e=p.useContext(Jt),s=le(),n=e==null?void 0:e.imagePointers.find(m=>m.asset_pointer===t),r=Ro({asset:{content_type:yo.ImageAssetPointer,asset_pointer:(i=n==null?void 0:n.asset_pointer)!=null?i:"",size_bytes:(l=n==null?void 0:n.size_bytes)!=null?l:0,width:(c=n==null?void 0:n.width)!=null?c:0,height:(d=n==null?void 0:n.height)!=null?d:0}});if(!n||!((u=r.data)!=null&&u.url))return null;const a=s.formatMessage({id:"wham.contentReference.imageAlt",defaultMessage:"Captured screenshot"});return o.jsx(ii,{src:r.data.url,alt:a,className:"max-h-[250px] max-w-[250px]",children:o.jsx(li,{src:r.data.url,alt:a,width:n.width,height:n.height,className:"max-h-[250px] max-w-[250px] object-contain"})})}function Oc(){const t=bo.getItem(_o.ProposedTasks);return t&&typeof t=="object"?t:{}}const bn=na(t=>({tasks:Oc(),store(e){t(s=>{const n=U(D({},s.tasks),{[e.contentId]:e});return bo.setItem(_o.ProposedTasks,n),{tasks:n}})}})),zc=X(()=>Z(()=>import("./jxyz1kdkcze5jtww.js"),__vite__mapDeps([18,1])),{loading:t=>Q(t)}),Wc=X(()=>Z(()=>import("./ei2rr3u86wwo8xvm.js"),__vite__mapDeps([19,1])),{loading:t=>Q(t)});function Hc({title:t,prompt:e,environmentId:s,branch:n,contentId:r,hasHitRateLimit:a}){const[i,l]=p.useState(!1),c=oa(),{setEnvironmentId:d,setBranch:u}=rl(),{refetch:m}=al(),h=le(),x=Ut(),_=bn(y=>y.tasks[r]),v=bn(y=>y.store),{mutate:w,isPending:j}=Lr({mutationFn:()=>il.createNewTask(s,n,e,!1).catch(y=>{throw x.danger(mt({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task"}),{id:"suggestion-".concat(r),duration:5,hasCloseButton:!0,toastId:"wham_proposed_task_failed_to_create_task"}),y}),onSuccess:async y=>{await m(),C(y)}}),C=y=>{try{const k=y.task.id,S=y.turn.id,N="/codex/tasks/".concat(k);v({contentId:r,prompt:e,scheduledTaskId:k,turnId:S,url:N}),l(!1)}catch(k){}},f=!s||!n||j||a;return o.jsxs("div",{className:I("mt-1 mb-3 flex w-full items-center rounded-xl px-3 py-3",_?"bg-token-bg-secondary border border-transparent":"bg-token-bg-primary border-token-border-default border shadow-[0px_1px_1px_0px_rgba(0,0,0,0.05)]"),children:[o.jsxs("div",{className:I("group flex flex-1 items-center gap-1",!_&&"-my-3 py-3",!_&&!f&&"cursor-pointer"),onClick:()=>{f||_||(d(s),u(n),l(!0),dn.recordProposedTaskClicked("edit"))},children:[o.jsxs("div",{className:"flex flex-col gap-0.5",children:[o.jsx("span",{className:"text-token-text-tertiary text-xs",children:o.jsx(H,{id:"wham.whamProposedTask.title",defaultMessage:"Suggested task"})}),o.jsx("span",{className:I("text-sm font-medium",_&&"text-token-text-tertiary"),children:t})]}),!f&&!_&&o.jsx(Wc,{className:"icon-sm text-token-text-secondary mb-0.5 cursor-pointer self-end opacity-0 transition-opacity group-hover:opacity-100"})]}),o.jsx("div",{className:"flex items-center justify-end gap-2 text-xs",children:_?o.jsx(Pe,{size:"small",color:"secondary",as:"a",to:_==null?void 0:_.url,openNewTab:!0,children:o.jsx("span",{className:"text-token-text-primary font-medium",children:o.jsx(H,{id:"lwqFNG",defaultMessage:"View task"})})}):o.jsx(Bc,{prompt:a?h.formatMessage({id:"wham.proposedTask.hitRateLimit",defaultMessage:"You have reached your rate limit"}):e,tooltipEnabled:!_&&!i,children:o.jsx(Pe,{size:"small",color:"secondary",disabled:f,onClick:()=>{dn.recordProposedTaskClicked("create"),w()},children:o.jsxs("div",{className:"flex items-center gap-0.5",children:[o.jsx(H,{id:"b2N2Y8",defaultMessage:"Start task"}),j?o.jsx(yt,{className:"icon-xs me-[2px]"}):o.jsx(zc,{className:"icon-sm"})]})})})}),o.jsx(qe.Root,{testId:"modal-task-stub-composer",isOpen:i,onClose:()=>l(!1),children:o.jsx(qe.Overlay,{children:o.jsxs(qe.Content,{className:"flex max-w-3xl! items-center justify-center px-12 py-4 focus:outline-hidden",size:"normal",removeBackground:!0,onEscapeKeyDown:y=>{y.stopPropagation(),l(!1)},children:[o.jsxs(ra,{children:[o.jsx(aa,{children:o.jsx(H,{id:"wham.proposedTaskModel.title",defaultMessage:"Kick off a new Codex task"})}),o.jsx(ia,{children:o.jsx(H,{id:"wham.proposedTaskModel.description",defaultMessage:"Codex can propose new follow up tasks"})})]}),o.jsx(at.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:{duration:c?0:.25},className:"w-full",children:o.jsxs("div",{className:"flex flex-col items-center gap-8",children:[o.jsx("h1",{className:"text-token-text-primary dark text-[28px] font-semibold",children:o.jsx(H,{id:"wham.proposedTaskModal.title",defaultMessage:"Edit suggested task"})}),o.jsx(Vc,{prompt:e,onSuccess:C})]})})]})})})]})}function Bc({prompt:t,tooltipEnabled:e,children:s}){return e?o.jsx(Ls,{side:"right",label:o.jsx("span",{className:"block p-2 text-start whitespace-pre-wrap",children:t}),wide:!0,children:s}):s}function Vc({prompt:t,onSuccess:e}){const{composerController:s}=ol();return p.useEffect(()=>{la(ca(s),t.trimEnd())},[s,t]),o.jsx(da.Provider,{value:s,children:o.jsx(sl,{isBigBoxMode:!0,expanded:!0,disableDuringSubmit:!0,onSuccess:e})})}function Uc({title:t,prompt:e}){const s=p.useContext(Jt),{data:n}=ll(),r=nl(n),a=p.useMemo(()=>qc("".concat(s==null?void 0:s.taskId,":").concat(t,":").concat(e)),[s==null?void 0:s.taskId,t,e]);return!s||!s.environmentId||!s.branch?null:o.jsx(Hc,{title:t,prompt:e,environmentId:s.environmentId,branch:s.branch,contentId:a,hasHitRateLimit:r})}function qc(t){let e=5381;for(let s=0;s<t.length;s++)e=(e<<5)+e^t.charCodeAt(s);return(e>>>0).toString(16).padStart(8,"0")}const Gc=X(()=>Z(()=>import("./mlll5kvj3qdj7fj8.js"),__vite__mapDeps([20,1])),{loading:t=>Q(t)});function Zc({chunkId:t,lineRangeStart:e,lineRangeEnd:s}){const[n,r]=p.useState(!1),a=p.useContext(Jt),i=a==null?void 0:a.terminalMessageContents.find(_=>_.includes(t)),l=p.useRef(null),c=p.useRef(null),d=p.useRef(null);if(!i)return null;const u=Yc(i);if(!u)return null;const m=u.output.slice(e-1,s);if(!m.some(_=>!!_.length))return null;const h=()=>{d.current&&(clearTimeout(d.current),d.current=null),r(!0)},x=()=>{d.current=window.setTimeout(()=>{r(!1)},200)};return o.jsxs(Fs,{open:n,onOpenChange:r,children:[o.jsx(Os,{asChild:!0,onMouseEnter:h,onMouseLeave:x,children:o.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:o.jsx(Gc,{className:"size-[10px]"})})}),o.jsx(zs,{children:o.jsx(Ws,{ref:c,className:"z-50 focus:outline-none",side:"right",onMouseEnter:h,onMouseLeave:x,onOpenAutoFocus:_=>_.preventDefault(),children:o.jsx("div",{className:"max-h-[500px] max-w-screen px-4",children:o.jsx(Xc,{lines:m,lineRangeStart:e,lineRangeEnd:s})})})})]})}function Xc({lines:t,lineRangeStart:e,lineRangeEnd:s}){return o.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex flex-col overflow-auto rounded-2xl border px-2 pt-2 pb-3 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[o.jsx(cl,{className:"bg-token-sidebar-surface-primary dark mb-2.5 max-h-[200px] w-full overflow-auto rounded-lg p-3 font-mono text-xs whitespace-pre text-white dark:border dark:border-white/10",children:t.join("\n")}),o.jsx("div",{className:"flex w-full justify-end gap-1 px-2 text-sm",children:o.jsx("span",{className:"text-token-text-tertiary",children:o.jsx(H,{id:"wham.citation.terminal.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:e,lineRangeEnd:s}})})})]})}function Yc(t){try{const e=JSON.parse(t);return!("chunk_id"in e)||typeof e.chunk_id!="string"||!("session_name"in e)||typeof e.session_name!="string"||!("start_line_no"in e)||typeof e.start_line_no!="number"?null:"output"in e?e:null}catch(e){return null}}const Kc=({children:t,analyticsMetadata:e,hasBeenEdited:s,messageId:n,clientThreadId:r,messageRef:a,editorViewRef:i,fullscreenEditorViewRef:l,dialogPortalContainer:c,shouldShowWritingBlockCanvasEdit:d=!1,isInlineWritingBlockEditEnabled:u,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,writingBlock:x,index:_,onChange:v,isStreaming:w,autosaveStatus:j,title:C,recipient:f,setDirty:y,flushPendingChanges:k,contentReferences:S})=>{const N=Rs(r),{headerLabel:E,emailSendButton:$,toField:P,subjectField:b,fullScreenEmailHeader:F}=dl({writingBlock:x,clientThreadId:r,messageId:n,onChange:v,setDirty:y,flushPendingChanges:k,isStreaming:w,streamingTitle:C,streamingRecipient:f,isInlineWritingBlockEditEnabled:u});return o.jsx("div",{ref:a,id:"writing-block-".concat(n),className:I(Cs,"pt-0.5 pb-3"),"data-writing-block":!0,children:o.jsxs(vo,{modal:!1,children:[o.jsx(Go,{primaryLabel:E,primaryAction:$,writingBlock:x,clientThreadId:r,messageId:n,title:C,hideDownloadButton:!0,isInlineWritingBlockEditEnabled:u,hasBeenEdited:s,autosaveStatus:j,shouldShowWritingBlockCanvasEdit:d,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,serverThreadId:N,index:_,messageRef:a,contentReferences:S,isStreaming:w}),o.jsx("hr",{className:I(is,"sm:mx-[1px]")}),P,o.jsx("hr",{className:I(is,"sm:mx-[1px]")}),b,o.jsx("hr",{className:I(is,"mb-4!","sm:mx-[1px]")}),o.jsx(Zo,{editorViewRef:i,analyticsMetadata:e,isInlineWritingBlockEditEnabled:u,writingBlock:x,onChange:v,isStreaming:w,setDirty:y,flushPendingChanges:k,contentReferences:S,children:t}),o.jsxs(wo,{container:c,children:[o.jsx("div",{className:Xo}),o.jsx(jo,{onOpenAutoFocus:L=>{L.preventDefault();const T=l.current;if(!T)return;T.focus();const M=T.state.doc.content.size,z=T.state.tr.setSelection(Lt.create(T.state.doc,M)).scrollIntoView();T.dispatch(z)},onCloseAutoFocus:L=>{L.preventDefault();const T=i.current;if(!T)return;T.focus();const M=T.state.doc.content.size,z=T.state.tr.setSelection(Lt.create(T.state.doc,M)).scrollIntoView();T.dispatch(z)},className:Yo,children:o.jsx(Ko,{editorViewRef:l,analyticsMetadata:e,primaryLabel:E,primaryAction:$,subHeader:F,hasBeenEdited:s,autosaveStatus:j,clientThreadId:r,messageId:n,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,serverThreadId:N,shouldShowWritingBlockCanvasEdit:d,title:C,index:_,messageRef:a,isInlineWritingBlockEditEnabled:u,writingBlock:x,onChange:v,isStreaming:w,setDirty:y,flushPendingChanges:k,contentReferences:S})})]})]})})},Jc=t=>{"use forget";const e=he.c(112),{conversation:s,title:n,children:r,originalContent:a,messageId:i,variant:l,recipient:c,isStreaming:d,index:u,id:m}=t,h=Ve(ua),x=xe(),_=ko(Co.EditInCanvas);let v;e[0]!==x?(v=Se(x,"669593727"),e[0]=x,e[1]=v):v=e[1];const w=v;let j;e[2]!==x?(j=Se(x,"1101084612"),e[2]=x,e[3]=j):j=e[3];const C=j;let f;e[4]!==s||e[5]!==m||e[6]!==u||e[7]!==i||e[8]!==a||e[9]!==c||e[10]!==n||e[11]!==l?(f={conversation:s,messageId:i,id:m,originalContent:a,index:u,variant:l,title:n,recipient:c},e[4]=s,e[5]=m,e[6]=u,e[7]=i,e[8]=a,e[9]=c,e[10]=n,e[11]=l,e[12]=f):f=e[12];const{conversation:y,serverThreadId:k,writingBlock:S,contentReferences:N,autosaveStatus:E,flushPendingChanges:$,handleOnChange:P,messageRef:b,editorViewRef:F,analyticsMetadata:L,hasBeenEdited:T,isWritingBlockEditingAllowed:M,setDirty:z}=ul(f),G=p.useRef(null),[B,K]=p.useState(null);let te,A;if(e[13]!==B||e[14]!==h?(te=()=>{if(typeof document>"u")return;if(!h){B!=null&&K(null);return}const g=document.getElementById("thread");g&&g!==B&&K(g)},A=[h,B],e[13]=B,e[14]=h,e[15]=te,e[16]=A):(te=e[15],A=e[16]),p.useEffect(te,A),d&&l===un.UNKNOWN&&a===""){const g="writing-block-".concat(i);let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=I(Cs,"px-4 py-2","h-10"),e[17]=O):O=e[17];let R;return e[18]!==b||e[19]!==g?(R=o.jsx("div",{ref:b,id:g,className:O,"data-writing-block":!0}),e[18]=b,e[19]=g,e[20]=R):R=e[20],R}switch(l){case un.EMAIL:{const g=y==null?void 0:y.id,O=n!=null?n:"",R=c!=null?c:"";let W;return e[21]!==L||e[22]!==E||e[23]!==r||e[24]!==N||e[25]!==B||e[26]!==F||e[27]!==$||e[28]!==P||e[29]!==T||e[30]!==u||e[31]!==w||e[32]!==d||e[33]!==M||e[34]!==C||e[35]!==i||e[36]!==b||e[37]!==z||e[38]!==_||e[39]!==g||e[40]!==O||e[41]!==R||e[42]!==S?(W=o.jsx(Kc,{analyticsMetadata:L,hasBeenEdited:T,messageRef:b,editorViewRef:F,dialogPortalContainer:B,fullscreenEditorViewRef:G,clientThreadId:g,messageId:i,index:u,shouldShowWritingBlockCanvasEdit:_,isInlineWritingBlockEditEnabled:M,isInlineWritingBlockExportEnabled:w,onChange:P,writingBlock:S,isStreaming:d,autosaveStatus:E,title:O,recipient:R,setDirty:z,flushPendingChanges:$,contentReferences:N,isWritingBlockFocusedModeEnabled:C,children:r}),e[21]=L,e[22]=E,e[23]=r,e[24]=N,e[25]=B,e[26]=F,e[27]=$,e[28]=P,e[29]=T,e[30]=u,e[31]=w,e[32]=d,e[33]=M,e[34]=C,e[35]=i,e[36]=b,e[37]=z,e[38]=_,e[39]=g,e[40]=O,e[41]=R,e[42]=S,e[43]=W):W=e[43],W}default:{const g="writing-block-".concat(i);let O;e[44]===Symbol.for("react.memo_cache_sentinel")?(O=I(Cs,"pt-0.5 pb-3"),e[44]=O):O=e[44];const R=y==null?void 0:y.id;let W;e[45]!==E||e[46]!==N||e[47]!==T||e[48]!==u||e[49]!==w||e[50]!==d||e[51]!==M||e[52]!==C||e[53]!==i||e[54]!==b||e[55]!==k||e[56]!==_||e[57]!==R||e[58]!==n||e[59]!==S?(W=o.jsx(Go,{hasBeenEdited:T,autosaveStatus:E,writingBlock:S,clientThreadId:R,messageId:i,isInlineWritingBlockExportEnabled:w,isInlineWritingBlockEditEnabled:M,isWritingBlockFocusedModeEnabled:C,serverThreadId:k,shouldShowWritingBlockCanvasEdit:_,title:n,index:u,messageRef:b,contentReferences:N,isStreaming:d}),e[45]=E,e[46]=N,e[47]=T,e[48]=u,e[49]=w,e[50]=d,e[51]=M,e[52]=C,e[53]=i,e[54]=b,e[55]=k,e[56]=_,e[57]=R,e[58]=n,e[59]=S,e[60]=W):W=e[60];let V;e[61]===Symbol.for("react.memo_cache_sentinel")?(V=o.jsx("hr",{className:"border-token-border-light! mx-4 my-0! mb-3! border-0 sm:mx-[1px]"}),e[61]=V):V=e[61];let Y;e[62]!==L||e[63]!==r||e[64]!==N||e[65]!==F||e[66]!==$||e[67]!==P||e[68]!==d||e[69]!==M||e[70]!==z||e[71]!==S?(Y=o.jsx(Zo,{editorViewRef:F,analyticsMetadata:L,setDirty:z,isInlineWritingBlockEditEnabled:M,writingBlock:S,onChange:P,isStreaming:d,flushPendingChanges:$,contentReferences:N,children:r}),e[62]=L,e[63]=r,e[64]=N,e[65]=F,e[66]=$,e[67]=P,e[68]=d,e[69]=M,e[70]=z,e[71]=S,e[72]=Y):Y=e[72];let J;e[73]===Symbol.for("react.memo_cache_sentinel")?(J=o.jsx("div",{className:Xo}),e[73]=J):J=e[73];let de;e[74]===Symbol.for("react.memo_cache_sentinel")?(de=me=>{me.preventDefault();const ae=G.current;if(!ae)return;ae.focus();const pe=ae.state.doc.content.size,ce=ae.state.tr.setSelection(Lt.create(ae.state.doc,pe)).scrollIntoView();ae.dispatch(ce)},e[74]=de):de=e[74];let oe;e[75]!==F?(oe=me=>{me.preventDefault();const ae=F.current;if(!ae)return;ae.focus();const pe=ae.state.doc.content.size,ce=ae.state.tr.setSelection(Lt.create(ae.state.doc,pe)).scrollIntoView();ae.dispatch(ce)},e[75]=F,e[76]=oe):oe=e[76];let ie;e[77]===Symbol.for("react.memo_cache_sentinel")?(ie=I(Yo),e[77]=ie):ie=e[77];const ee=y==null?void 0:y.id;let ye;e[78]!==L||e[79]!==E||e[80]!==N||e[81]!==$||e[82]!==P||e[83]!==T||e[84]!==u||e[85]!==w||e[86]!==d||e[87]!==M||e[88]!==C||e[89]!==i||e[90]!==b||e[91]!==k||e[92]!==z||e[93]!==_||e[94]!==ee||e[95]!==n||e[96]!==S?(ye=o.jsx(Ko,{editorViewRef:G,analyticsMetadata:L,hasBeenEdited:T,autosaveStatus:E,clientThreadId:ee,messageId:i,isInlineWritingBlockExportEnabled:w,isWritingBlockFocusedModeEnabled:C,serverThreadId:k,shouldShowWritingBlockCanvasEdit:_,title:n,index:u,messageRef:b,isInlineWritingBlockEditEnabled:M,writingBlock:S,onChange:P,isStreaming:d,setDirty:z,flushPendingChanges:$,contentReferences:N}),e[78]=L,e[79]=E,e[80]=N,e[81]=$,e[82]=P,e[83]=T,e[84]=u,e[85]=w,e[86]=d,e[87]=M,e[88]=C,e[89]=i,e[90]=b,e[91]=k,e[92]=z,e[93]=_,e[94]=ee,e[95]=n,e[96]=S,e[97]=ye):ye=e[97];let ue;e[98]!==oe||e[99]!==ye?(ue=o.jsx(jo,{onOpenAutoFocus:de,onCloseAutoFocus:oe,className:ie,children:ye}),e[98]=oe,e[99]=ye,e[100]=ue):ue=e[100];let re;e[101]!==B||e[102]!==ue?(re=o.jsxs(wo,{container:B,children:[J,ue]}),e[101]=B,e[102]=ue,e[103]=re):re=e[103];let be;e[104]!==Y||e[105]!==re||e[106]!==W?(be=o.jsxs(vo,{modal:!1,children:[W,V,Y,re]}),e[104]=Y,e[105]=re,e[106]=W,e[107]=be):be=e[107];let ne;return e[108]!==b||e[109]!==be||e[110]!==g?(ne=o.jsx("div",{ref:b,id:g,className:O,"data-writing-block":!0,children:be}),e[108]=b,e[109]=be,e[110]=g,e[111]=ne):ne=e[111],ne}}},Qc=X(()=>Z(()=>import("./jx5pd8qsxc77tbjo.js"),__vite__mapDeps([21,1])),{loading:t=>Q(t)});function ed({metadata:t,trackContentReferenceEvent:e}){var i;const s=Rr(),n=xe(),r=Ds(),a=Se(n,"3375735072");return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,{checkout_id:t.checkout_id})},[e,t.type,t.checkout_id]),a?o.jsxs("div",{className:"border-token-border-default bg-token-bg-primary not-prose mb-6 flex max-w-[420px] flex-col gap-4 rounded-[20px] border py-4 shadow-[0px_4px_16px_0px_rgba(0,_0,_0,_0.05)]","data-order-id":t.checkout_id,role:"group",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 text-sm font-medium",children:[o.jsx(Qc,{className:"icon-lg text-green-400"}),o.jsx(H,{id:"checkout_purchase_confirmation_status",defaultMessage:"Purchase complete"})]}),o.jsxs("div",{className:"border-token-border-light flex items-start gap-3 border-b px-4 pb-4",children:[o.jsx("div",{className:"flex-shrink-0 overflow-hidden rounded-xl bg-gray-100 dark:bg-gray-700",children:o.jsx("img",{src:t.product_image_urls[0],alt:t.title,className:"m-0 aspect-square h-32 w-32 object-cover mix-blend-darken dark:mix-blend-lighten"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"line-clamp-2 min-h-6 text-base leading-snug font-medium",title:t.title,children:t.title}),o.jsx("div",{className:"text-token-text-secondary text-[13px] leading-snug whitespace-pre-wrap",children:t.subtitle})]})]}),t.error_message&&o.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mx-4 flex items-center rounded-lg px-3 py-1 text-sm",children:t.error_message}),o.jsx("dl",{className:"space-y-1 px-4",children:(i=t.details)==null?void 0:i.map(l=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("dt",{className:"text-token-text-secondary flex-grow text-[13px] font-medium",children:l.label}),o.jsx("dd",{className:"text-token-text-primary text-[13px] font-medium",children:l.value})]},l.label))}),!r&&o.jsx("div",{className:"px-4",children:o.jsx(Pe,{fullWidth:!0,color:"secondary",className:"rounded-2xl border",onClick:()=>{s("#settings/".concat(ma.Orders,"?order=").concat(t.checkout_id))},children:o.jsx(H,{id:"2Dn5nu",defaultMessage:"View details"})})})]}):null}const _n=4;function td(t){"use forget";const e=he.c(50),{metadata:s,analyticsMetadata:n,trackContentReferenceEvent:r,imageSource:a,superWidgetContent:i,isFirstAssistantContent:l}=t,c=a!=null?a:Je.Turn,d=bt(),u=xe();let m;e[0]!==u?(m=We(u)&&!Gt(u),e[0]=u,e[1]=m):m=e[1];const h=m;let x;e:{if(!h||!i){x=s.images;break e}const $=i.widgets.images;let P;e[2]!==s.images||e[3]!==$?(P=So(s.images.concat($),id),e[2]=s.images,e[3]=$,e[4]=P):P=e[4],x=P}const _=x;let v,w,j;e[5]!==_||e[6]!==s.images?(v=s.images.some(ad)?[]:_.map(rd),j=Dr,w=v.map(od),e[5]=_,e[6]=s.images,e[7]=v,e[8]=w,e[9]=j):(v=e[7],w=e[8],j=e[9]);let C;e[10]!==v?(C=$=>{const P=new Set;return $.forEach((b,F)=>{b.isSuccess&&P.add(v[F])}),P},e[10]=v,e[11]=C):C=e[11];let f;e[12]!==w||e[13]!==C?(f={queries:w,combine:C},e[12]=w,e[13]=C,e[14]=f):f=e[14];const y=j(f);let k,S,N;if(e[15]!==n||e[16]!==y||e[17]!==c||e[18]!==_||e[19]!==l||e[20]!==d||e[21]!==s.images||e[22]!==h||e[23]!==r){N=Symbol.for("react.early_return_sentinel");e:{let $;e[27]!==y?($=T=>y.has(T.thumbnail_url),e[27]=y,e[28]=$):$=e[28];const P=_.filter($),b=s.images.length;if(s.images.some(nd)){let T;e[29]!==s.images?(T=s.images.find(sd),e[29]=s.images,e[30]=T):T=e[30];const M=T,z=M!=null&&M.float_top?"relative block":"float-image z-10 float-end clear-end ms-7 overflow-hidden";let G;e[31]!==z?(G=I("mb-7 mt-1 min-w-32 max-w-[22%] rounded-xl border-[0.5px] border-token-border-default",z),e[31]=z,e[32]=G):G=e[32];const B=G,K=M==null?void 0:M.content_url;let te;e[33]===Symbol.for("react.memo_cache_sentinel")?(te={imageUse:"deepResearch"},e[33]=te):te=e[33];let A;e[34]!==n||e[35]!==B||e[36]!==c||e[37]!==M||e[38]!==K||e[39]!==r?(A=o.jsx(Oe,{image:M,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:te,aspectRatio:Pt,className:B,contentReferenceType:"image_v2"},K),e[34]=n,e[35]=B,e[36]=c,e[37]=M,e[38]=K,e[39]=r,e[40]=A):A=e[40],N=A;break e}if(b===0){N=null;break e}if(b===1){const T=s.images[0];let M;e[41]===Symbol.for("react.memo_cache_sentinel")?(M={imageUse:"legacyCarousel"},e[41]=M):M=e[41];let z;e[42]!==n||e[43]!==c||e[44]!==T||e[45]!==r?(z=o.jsx(Oe,{image:T,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:M,aspectRatio:Pt,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 max-w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_v2"},T.content_url),e[42]=n,e[43]=c,e[44]=T,e[45]=r,e[46]=z):z=e[46],N=z;break e}const F=h?null:_n,L=d||F==null?P.length:Math.min(P.length,F);if(P.length>_n&&h){N=o.jsx(cd,{images:P.slice(0,L),imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,isFirstAssistantContent:l});break e}k="no-scrollbar mt-1 mb-6 flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",S=P.slice(0,L).map((T,M)=>o.jsx("div",{className:I("border-token-border-default relative aspect-square w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-48 sm:w-[calc((100%-0.5rem)/4)]",M===0&&"rounded-s-xl",M===L-1&&"rounded-e-xl"),children:o.jsx(Oe,{image:T,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:{imageUse:"legacyCarousel"},aspectRatio:Pt,className:"h-full w-full",contentReferenceType:"image_v2"},T.thumbnail_url)},T.thumbnail_url))}e[15]=n,e[16]=y,e[17]=c,e[18]=_,e[19]=l,e[20]=d,e[21]=s.images,e[22]=h,e[23]=r,e[24]=k,e[25]=S,e[26]=N}else k=e[24],S=e[25],N=e[26];if(N!==Symbol.for("react.early_return_sentinel"))return N;let E;return e[47]!==k||e[48]!==S?(E=o.jsx("div",{className:k,children:S}),e[47]=k,e[48]=S,e[49]=E):E=e[49],E}function sd(t){return t.is_proxied_image}function nd(t){return t.is_proxied_image}function od(t){return qi(t,"_ImageCarousel")}function rd(t){return t.thumbnail_url}function ad(t){return t.is_proxied_image}function id(t){return t.thumbnail_url}const qs=p.memo(td,(t,e)=>t.numImageResults===e.numImageResults&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.metadata.images.length===e.metadata.images.length&&t.metadata.images.every((s,n)=>s.content_url===e.metadata.images[n].content_url));function Oe(t){"use forget";var J,de;const e=he.c(72),{image:s,imageSource:n,className:r,imgClassName:a,style:i,analyticsMetadata:l,trackContentReferenceEvent:c,eventMetadata:d,badge:u,lightboxImages:m,aspectRatio:h,enableHoverAnimation:x,fadeInOnMount:_,skeletonEl:v,contentReferenceType:w}=t;let j;e[0]!==d?(j=d===void 0?{}:d,e[0]=d,e[1]=j):j=e[1];const C=j,f=x===void 0?!0:x,y=h!=null?h:void 0;let k;e[2]!==y?(k={width:Xi,aspectRatio:y},e[2]=y,e[3]=k):k=e[3];const S=Gi(s,k);let N;e[4]!==(s==null?void 0:s.content_url)?(N=s==null?void 0:s.content_url.replace(/^http:\/\//,"https://"),e[4]=s==null?void 0:s.content_url,e[5]=N):N=e[5];const E=N;let $;e[6]!==s?($=md(s),e[6]=s,e[7]=$):$=e[7];const P=$,{isSuccess:b}=ks(S,"ImageCarousel_thumbnail"),{isSuccess:F,isError:L}=ks(P?E:void 0,"ImageCarousel_full");s==null||s.title;const T=s==null?void 0:s.title;let M;e[8]!==C||e[9]!==T||e[10]!==S?(M=D({image_url:S,title:T},C),e[8]=C,e[9]=T,e[10]=S,e[11]=M):M=e[11];const z=M;let G,B;e[12]!==w||e[13]!==z||e[14]!==s||e[15]!==b||e[16]!==c?(G=()=>{s&&b&&c("Search Content Reference Shown","search_content_reference_shown",w,z)},B=[c,s,b,z,w],e[12]=w,e[13]=z,e[14]=s,e[15]=b,e[16]=c,e[17]=G,e[18]=B):(G=e[17],B=e[18]),p.useEffect(G,B);let K,te;e[19]!==E||e[20]!==L||e[21]!==S?(K=()=>{E&&L&&qt.addAction("Failed to download full image",{url:E,thumbnailUrl:S})},te=[E,L,S],e[19]=E,e[20]=L,e[21]=S,e[22]=K,e[23]=te):(K=e[22],te=e[23]),p.useEffect(K,te);const A=Hs.useStore();let g,O,R,W;if(e[24]!==l||e[25]!==h||e[26]!==r||e[27]!==w||e[28]!==E||e[29]!==f||e[30]!==z||e[31]!==_||e[32]!==s||e[33]!==A||e[34]!==n||e[35]!==a||e[36]!==F||e[37]!==b||e[38]!==m||e[39]!==P||e[40]!==v||e[41]!==i||e[42]!==S||e[43]!==c){const oe=Zi((J=s==null?void 0:s.thumbnail_crop_info)!=null?J:null,(de=s==null?void 0:s.thumbnail_size)!=null?de:null,h!=null?h:void 0),ie=!s||!(b||F||s.is_proxied_image);let ee;e:{if(ie){ee=void 0;break e}if(s.is_proxied_image){ee=s.url;break e}if(P&&F){ee=E;break e}ee=S}const ye=ee;let ue;e[48]!==h?(ue=h?{aspectRatio:"".concat(h.width,"/").concat(h.height)}:{},e[48]=h,e[49]=ue):ue=e[49];let re;e[50]!==i||e[51]!==ue?(re=D(D({},i),ue),e[50]=i,e[51]=ue,e[52]=re):re=e[52];const be=re;e[53]!==r?(g=I("relative overflow-hidden",r),e[53]=r,e[54]=g):g=e[54],O=be,e[55]!==l||e[56]!==w||e[57]!==z||e[58]!==s||e[59]!==A||e[60]!==n||e[61]!==m||e[62]!==c?(R=()=>{c("Search Content Reference Clicked","search_content_reference_clicked",w,z),A.setCurrentImage(s?{image:s,source:n,analyticsMetadata:l,imageResults:m}:void 0)},e[55]=l,e[56]=w,e[57]=z,e[58]=s,e[59]=A,e[60]=n,e[61]=m,e[62]=c,e[63]=R):R=e[63],W=ld({isLoading:ie,enableHoverAnimation:f,fadeInOnMount:_,src:ye,image:s,objectPosition:oe,className:a,skeletonEl:v}),e[24]=l,e[25]=h,e[26]=r,e[27]=w,e[28]=E,e[29]=f,e[30]=z,e[31]=_,e[32]=s,e[33]=A,e[34]=n,e[35]=a,e[36]=F,e[37]=b,e[38]=m,e[39]=P,e[40]=v,e[41]=i,e[42]=S,e[43]=c,e[44]=g,e[45]=O,e[46]=R,e[47]=W}else g=e[44],O=e[45],R=e[46],W=e[47];let V;e[64]!==u?(V=u&&o.jsx("div",{className:"pointer-events-none absolute end-2 bottom-2",children:u}),e[64]=u,e[65]=V):V=e[65];let Y;return e[66]!==g||e[67]!==O||e[68]!==R||e[69]!==W||e[70]!==V?(Y=o.jsxs("button",{className:g,style:O,onClick:R,children:[W,V]}),e[66]=g,e[67]=O,e[68]=R,e[69]=W,e[70]=V,e[71]=Y):Y=e[71],Y}function ld({isLoading:t,enableHoverAnimation:e,fadeInOnMount:s,src:n,image:r,objectPosition:a,className:i,skeletonEl:l}){if(t)return l!=null?l:o.jsx("div",{className:"bg-token-main-surface-tertiary aspect-square h-full w-full animate-pulse"});const c=o.jsx(at.img,{src:n,alt:r==null?void 0:r.content_url,style:a?{objectPosition:a}:{},className:I("bg-token-main-surface-tertiary m-0 h-full w-full object-cover",i),initial:s?{opacity:0}:!1,animate:{opacity:1},transition:s?{duration:.3,ease:"easeInOut"}:void 0});return e?o.jsx(qo,{children:c}):c}function cd(t){"use forget";const e=he.c(15),{images:s,imageSource:n,analyticsMetadata:r,trackContentReferenceEvent:a,isFirstAssistantContent:i}=t,l=xe();let c;e[0]!==l?(c=()=>Zt(l),e[0]=l,e[1]=c):c=e[1];const d=Ve(c),u=ud,m=i&&"mt-2",h=d?"-mx-[var(--thread-content-margin)]":"-mx-6";let x;e[2]!==m||e[3]!==h?(x=I("relative mb-6",m,h),e[2]=m,e[3]=h,e[4]=x):x=e[4];let _;e[5]!==r||e[6]!==n||e[7]!==a?(_=j=>o.jsx(Oe,{image:j,imageSource:n,analyticsMetadata:r,trackContentReferenceEvent:a,className:"aspect-auto h-full w-full",aspectRatio:null,contentReferenceType:"image_v2"}),e[5]=r,e[6]=n,e[7]=a,e[8]=_):_=e[8];let v;e[9]!==s||e[10]!==_?(v=o.jsx(Yt,{items:s,getItemKey:dd,itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)]",getItemStyle:u,onRenderItem:_,className:"h-48 min-h-48"}),e[9]=s,e[10]=_,e[11]=v):v=e[11];let w;return e[12]!==x||e[13]!==v?(w=o.jsx("div",{className:x,children:v}),e[12]=x,e[13]=v,e[14]=w):w=e[14],w}function dd(t){return t.thumbnail_url}function ud(t){const{width:e,height:s}=t.content_size;return{width:s?e/s*192:180}}function md(t){return!t||t.is_proxied_image?!1:t.thumbnail_url.includes("images.openai.com")}const vn=4,sr=5;function fd(t){"use forget";var N,E,$,P;const e=he.c(29),{images:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:a}=t,i=xe();let l;e[0]!==i?(l=We(i),e[0]=i,e[1]=l):l=e[1];const c=l;let d;e[2]!==n?(d=n?No(n):null,e[2]=n,e[3]=d):d=e[3];const u=d,m=(E=(N=r==null?void 0:r.widgets)==null?void 0:N.query)!=null?E:"";let h;e[4]!==u||e[5]!==m?(h=((P=($=m==null?void 0:m.trim())==null?void 0:$.length)!=null?P:0)>0?m:u,e[4]=u,e[5]=m,e[6]=h):h=e[6];const x=h;let _;e[7]!==i||e[8]!==s.length||e[9]!==c||e[10]!==x?(_=()=>{!c||s.length>=vn||!x||Fo(i,x,"images")},e[7]=i,e[8]=s.length,e[9]=c,e[10]=x,e[11]=_):_=e[11];let v;e[12]!==i||e[13]!==s.length||e[14]!==c||e[15]!==n||e[16]!==x||e[17]!==r?(v=[i,c,n,x,s.length,r],e[12]=i,e[13]=s.length,e[14]=c,e[15]=n,e[16]=x,e[17]=r,e[18]=v):v=e[18],p.useEffect(_,v);let w;e[19]!==c||e[20]!==x?(w=b=>{var T,M;if(!c||!x)return[[],!1];const L=(T=b.entries[x])!=null?T:Oo;return[(M=L.images)!=null?M:[],zo(L,"images")]},e[19]=c,e[20]=x,e[21]=w):w=e[21];const[j,C]=Do(w);let f;if(e[22]!==s||e[23]!==a||e[24]!==j){const b=s.map(xd).filter(gd);f=a&&s.every(pd)&&s.length<vn?So(b.concat(j.slice(0,sr)),hd):b,e[22]=s,e[23]=a,e[24]=j,e[25]=f}else f=e[25];const y=f,k=a&&C;let S;return e[26]!==y||e[27]!==k?(S={items:y,isLoading:k},e[26]=y,e[27]=k,e[28]=S):S=e[28],S}function hd(t){return t.thumbnail_url}function pd(t){return!!t.image_result}function gd(t){return!!t}function xd(t){return t.image_result?{title:t.image_result.title,url:t.image_result.url,content_url:t.image_result.content_url,thumbnail_url:t.image_result.thumbnail_url,content_size:t.image_result.content_size,thumbnail_size:t.image_result.thumbnail_size}:null}const yd=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zj),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function nr({numImages:t}){return o.jsxs("div",{className:"flex items-center gap-1 rounded-full px-2 py-1.5 text-white backdrop-blur-md backdrop-brightness-75",children:[o.jsx(yd,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs font-semibold",children:t})]})}const bd=X(()=>Z(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)}),_d=X(()=>Z(()=>import("./9paxni9f8n7suc5d.js"),__vite__mapDeps([23,1])),{loading:t=>Q(t)});function vd(t){"use forget";const e=he.c(70),{images:s,className:n,aspect:r,objectPosition:a,showArrows:i,imageClassName:l,slideClassName:c,gap:d,peekPercent:u,showDots:m,onClick:h}=t,x=n===void 0?"":n,_=r===void 0?"aspect-[16/9]":r,v=a===void 0?"object-cover":a,w=i===void 0?!0:i,j=l===void 0?"":l,C=c===void 0?"":c,f=d===void 0?2:d,y=u===void 0?95:u,k=m===void 0?!1:m,[S,N]=p.useState(0),[E,$]=p.useState(!1),P=p.useRef(null);let b;e[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],e[0]=b):b=e[0];const F=p.useRef(b),L=p.useRef(null),T=le(),M=s.length;let z;e[1]!==y?(z=nt(y,0,100),e[1]=y,e[2]=z):z=e[2];const G=z,B="".concat(G,"%");let K;e[3]!==B?(K={maxWidth:B},e[3]=B,e[4]=K):K=e[4];const te=K;let A;e[5]!==M?(A=(se,q)=>{const fe=F.current[se];if(!fe)return 0;const ge=fe.offsetLeft,ke=ge+fe.offsetWidth,st=q.clientWidth,Le=Math.max(0,q.scrollWidth-st);if(M<=1||se===0)return nt(ge,0,Le);if(se===M-1){const vt=ke-st;return nt(vt,0,Le)}const ts=ge-(st-fe.offsetWidth)/2;return nt(ts,0,Le)},e[5]=M,e[6]=A):A=e[6];const g=A;let O;e[7]!==g||e[8]!==M?(O=(se,q)=>{const fe=q===void 0?"smooth":q;if(M===0||se<0||se>=M)return;const ge=P.current;if(!ge)return;const ke=g(se,ge);if(jn(ge.scrollLeft,ke)){fe!=="auto"&&ge.scrollTo({left:ke,behavior:"auto"}),L.current=null;return}L.current=ke,ge.scrollTo({left:ke,behavior:fe})},e[7]=g,e[8]=M,e[9]=O):O=e[9];const R=O,W=E&&S!==0,V=E;let Y;e[10]!==S||e[11]!==R||e[12]!==M?(Y=se=>{if(M===0)return;const q=nt(se,0,M-1);R(q,"smooth"),q!==S&&N(q)},e[10]=S,e[11]=R,e[12]=M,e[13]=Y):Y=e[13];const J=Y;let de;e[14]!==J||e[15]!==S||e[16]!==M?(de=()=>{if(M!==0){if(S>=M-1){J(0);return}J(S+1)}},e[14]=J,e[15]=S,e[16]=M,e[17]=de):de=e[17];const oe=de;let ie;e[18]!==J||e[19]!==S?(ie=()=>J(S-1),e[18]=J,e[19]=S,e[20]=ie):ie=e[20];const ee=ie;let ye,ue;e[21]!==g||e[22]!==S||e[23]!==M?(ye=()=>{const se=P.current;if(!se)return;const q=()=>{const fe=se.scrollLeft||0,ge=L.current;if(ge!=null){jn(fe,ge)&&(L.current=null);return}let ke=S,st=Number.POSITIVE_INFINITY;for(let Le=0;Le<M;Le++){const ts=g(Le,se),vt=Math.abs(ts-fe);vt<st-.5&&(st=vt,ke=Le)}ke!==S&&N(ke)};return se.addEventListener("scroll",q,{passive:!0}),()=>se.removeEventListener("scroll",q)},ue=[M,S,g],e[21]=g,e[22]=S,e[23]=M,e[24]=ye,e[25]=ue):(ye=e[24],ue=e[25]),p.useEffect(ye,ue);let re,be;e[26]!==E||e[27]!==oe||e[28]!==ee||e[29]!==M?(re=()=>{if(!E)return;const se=q=>{if(q.defaultPrevented||q.altKey||q.ctrlKey||q.metaKey||q.shiftKey)return;const fe=q.target;if(fe instanceof HTMLElement){if(fe.isContentEditable)return;const ge=fe.tagName;if(ge==="INPUT"||ge==="TEXTAREA"||ge==="SELECT")return;const ke=fe.getAttribute("role");if(ke==="textbox"||ke==="combobox")return}M<=1||(q.key==="ArrowRight"?(q.preventDefault(),oe()):q.key==="ArrowLeft"&&(q.preventDefault(),ee()))};return window.addEventListener("keydown",se),()=>window.removeEventListener("keydown",se)},be=[E,M,oe,ee],e[26]=E,e[27]=oe,e[28]=ee,e[29]=M,e[30]=re,e[31]=be):(re=e[30],be=e[31]),p.useEffect(re,be);const ne="select-none ".concat(x," relative");let me,ae;e[32]===Symbol.for("react.memo_cache_sentinel")?(me=()=>$(!0),ae=()=>$(!1),e[32]=me,e[33]=ae):(me=e[32],ae=e[33]);const pe="relative w-full ".concat(_," overflow-clip");let ce;e[34]!==f?(ce={gap:f},e[34]=f,e[35]=ce):ce=e[35];let ve;e[36]!==j||e[37]!==s||e[38]!==T||e[39]!==v||e[40]!==h||e[41]!==C||e[42]!==M||e[43]!==te?(ve=s.map((se,q)=>{var fe;return o.jsx("div",{onClick:()=>h==null?void 0:h(se,q),ref:ge=>{F.current[q]=ge},className:I("relative flex h-full shrink-0 grow-0 snap-always items-stretch",q===0&&"snap-start",q===M-1&&"snap-end",q>0&&q<M-1&&"snap-center",C),style:te,children:se.content?se.content:o.jsx("img",{src:se.src,alt:(fe=se.alt)!=null?fe:T.formatMessage({id:"wHCsqa",defaultMessage:"Slide {index}"},{index:q+1}),className:"h-full w-auto ".concat(v," ").concat(j)})},q)}),e[36]=j,e[37]=s,e[38]=T,e[39]=v,e[40]=h,e[41]=C,e[42]=M,e[43]=te,e[44]=ve):ve=e[44];let Ne;e[45]!==ce||e[46]!==ve?(Ne=o.jsx("div",{ref:P,className:"no-scrollbar flex h-full w-full touch-pan-x snap-x snap-mandatory overflow-x-scroll scroll-smooth",style:ce,children:ve}),e[45]=ce,e[46]=ve,e[47]=Ne):Ne=e[47];let _e;e[48]!==s.length||e[49]!==T||e[50]!==W||e[51]!==oe||e[52]!==ee||e[53]!==V||e[54]!==w?(_e=w&&s.length>1&&o.jsxs(o.Fragment,{children:[o.jsx(kn,{ariaLabel:T.formatMessage({id:"l9pylv",defaultMessage:"Previous slide"}),onClick:ee,side:"start",visible:W,children:o.jsx(_d,{className:"icon-md"})}),o.jsx(kn,{ariaLabel:T.formatMessage({id:"L0pbQh",defaultMessage:"Next slide"}),onClick:oe,side:"end",visible:V,children:o.jsx(bd,{className:"icon-md"})})]}),e[48]=s.length,e[49]=T,e[50]=W,e[51]=oe,e[52]=ee,e[53]=V,e[54]=w,e[55]=_e):_e=e[55];let we;e[56]!==J||e[57]!==s||e[58]!==S||e[59]!==T||e[60]!==k?(we=k&&s.length>1&&s.length<=20&&o.jsx("div",{className:"absolute start-0 end-0 bottom-3 flex items-center justify-center",children:o.jsx("div",{className:"flex w-fit items-center justify-center gap-2 rounded-full bg-[#0D0D0D66] bg-clip-padding p-1 backdrop-blur",children:s.map((se,q)=>o.jsx("button",{onClick:()=>J(q),"aria-label":T.formatMessage({id:"PUV+4+",defaultMessage:"Go to slide {index}"},{index:q+1}),className:"h-1.5 w-1.5 rounded-full transition-opacity ".concat(q===S?"bg-white":"bg-gray-400 opacity-60")},q))})}),e[56]=J,e[57]=s,e[58]=S,e[59]=T,e[60]=k,e[61]=we):we=e[61];let je;e[62]!==pe||e[63]!==Ne||e[64]!==_e||e[65]!==we?(je=o.jsxs("div",{className:pe,children:[Ne,_e,we]}),e[62]=pe,e[63]=Ne,e[64]=_e,e[65]=we,e[66]=je):je=e[66];let Me;return e[67]!==ne||e[68]!==je?(Me=o.jsx("div",{className:ne,"aria-roledescription":"carousel",onMouseEnter:me,onMouseLeave:ae,children:je}),e[67]=ne,e[68]=je,e[69]=Me):Me=e[69],Me}const wn={width:4,height:5};function wd(t){"use forget";const e=he.c(7),{image:s}=t,n=wn.height/wn.width;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={maxHeight:"calc(100cqw * ".concat(n,")")},e[0]=r):r=e[0];let a;e[1]!==s.alt||e[2]!==s.content||e[3]!==s.src?(a=s.content?s.content:o.jsx("img",{src:s.src,alt:s.alt,className:"h-full w-full object-cover"}),e[1]=s.alt,e[2]=s.content,e[3]=s.src,e[4]=a):a=e[4];let i;return e[5]!==a?(i=o.jsx("div",{className:"[container-type:inline-size] w-full overflow-hidden [font-size:0] leading-none",style:r,children:a}),e[5]=a,e[6]=i):i=e[6],i}function jd(t){"use forget";const e=he.c(4);if(t.images.length===0)return null;if(t.images.length===1){let n;return e[0]!==t.images[0]?(n=o.jsx(wd,{image:t.images[0]}),e[0]=t.images[0],e[1]=n):n=e[1],n}let s;return e[2]!==t?(s=o.jsx(vd,D({},t)),e[2]=t,e[3]=s):s=e[3],s}const nt=(t,e,s)=>Math.min(Math.max(t,e),s),jn=(t,e,s=1)=>Math.abs(t-e)<=s;function kn(t){"use forget";const e=he.c(11),{ariaLabel:s,onClick:n,side:r,visible:a,children:i}=t,l=r==="start"?"start-0 justify-end":"end-0 justify-start",c=a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none ";let d;e[0]!==l||e[1]!==c?(d=I("group absolute top-0 bottom-0 flex h-full w-12.5 cursor-pointer items-center transition-opacity duration-300",l,c),e[0]=l,e[1]=c,e[2]=d):d=e[2];let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=I("btn-secondary active:bg-token-bg-tertiary group-hover:bg-token-bg-secondary flex h-8 w-8 items-center justify-center rounded-full bg-clip-padding shadow-sm group-hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!"),e[3]=u):u=e[3];let m;e[4]!==s||e[5]!==i?(m=o.jsx("button",{"aria-label":s,className:u,children:i}),e[4]=s,e[5]=i,e[6]=m):m=e[6];let h;return e[7]!==n||e[8]!==d||e[9]!==m?(h=o.jsx("div",{className:d,onClick:n,children:m}),e[7]=n,e[8]=d,e[9]=m,e[10]=h):h=e[10],h}const Gs="mt-1 mb-5 [&:not(:first-child)]:mt-4",kd=/^image_group[\s\S]*$/;function Cd({contentReference:t,trackContentReferenceEvent:e,analyticsMetadata:s,superWidgetContent:n,lastUserMsgOfPrevTurn:r,isFirstAssistantTurn:a}){var x;const i=xe(),l=We(i),c=Gt(i),{images:d,layout:u="carousel"}=t,m=kd.test((x=t.matched_text)!=null?x:""),h={images:d,trackContentReferenceEvent:e,analyticsMetadata:s,isReferenceComplete:m};return l&&!c&&a&&(u==="carousel"||u==="bento")&&n?o.jsx(Bd,D({superWidgetContent:n,lastUserMsgOfPrevTurn:r,imageSource:Je.ImageGroup},h)):u==="carousel"?o.jsx(Fd,D({},h)):u==="bento"?o.jsx(Ad,D({},h)):u==="full_width"?o.jsx(Hd,D({},h)):null}const Sd={width:9,height:5},Nd={width:21,height:9};function Md(t){switch(t){case 0:return"rounded-se-md rounded-ee-md rounded-ss-xl rounded-es-xl";case 1:return"rounded-se-xl rounded-ee-md rounded-ss-md rounded-es-md";case 2:return"rounded-se-md rounded-ee-xl rounded-ss-md rounded-es-md";default:return""}}const Ed=(t,e)=>{var s;return t.image_result?t.image_result.content_url:"".concat((s=t.image_search_query)!=null?s:t.image_ref_id,"-").concat(e)};function Td(t){"use forget";const e=he.c(14),{images:s,trackContentReferenceEvent:n,analyticsMetadata:r}=t,a=xe(),l=We(a)?Nd:Sd,c=l.width/3,d=l.height/2;let u;e[0]!==c||e[1]!==d?(u={width:c,height:d},e[0]=c,e[1]=d,e[2]=u):u=e[2];const m=u;let h;e[3]===Symbol.for("react.memo_cache_sentinel")?(h=I("grid grid-flow-dense grid-cols-3 grid-rows-2 gap-1",Gs),e[3]=h):h=e[3];const x="".concat(l.width,"/").concat(l.height);let _;e[4]!==x?(_={aspectRatio:x},e[4]=x,e[5]=_):_=e[5];let v;e[6]!==r||e[7]!==s||e[8]!==m||e[9]!==n?(v=s.map((j,C)=>{var k;if(C>=3)return null;const y=C===Math.min(3,s.length)-1&&s.length>3;return o.jsx(Oe,{image:(k=j.image_result)!=null?k:void 0,imageSource:Je.ImageGroup,className:I("border-token-border-default h-full w-full border-[0.5px]",C===0&&"col-span-2 row-span-2",Md(C)),badge:y?o.jsx(nr,{numImages:s.length}):void 0,lightboxImages:s.map(Pd).filter($d),aspectRatio:m,trackContentReferenceEvent:n,eventMetadata:{imageUse:"imageGroup",layout:"bento"},analyticsMetadata:r,contentReferenceType:"image_group"},Ed(j,C))}),e[6]=r,e[7]=s,e[8]=m,e[9]=n,e[10]=v):v=e[10];let w;return e[11]!==_||e[12]!==v?(w=o.jsx("div",{className:h,style:_,children:v}),e[11]=_,e[12]=v,e[13]=w):w=e[13],w}function $d(t){return!!t}function Pd(t){return t.image_result}const Zs=(t,e)=>t.images.length===e.images.length&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.images.every((s,n)=>{var r,a;return((r=s.image_result)==null?void 0:r.content_url)===((a=e.images[n].image_result)==null?void 0:a.content_url)}),Ad=p.memo(Td,Zs),Id=3,ls={width:5,height:4};function Ld(t){"use forget";var _;const e=he.c(23),{images:s,analyticsMetadata:n,trackContentReferenceEvent:r,isReferenceComplete:a}=t,i=bt(),l=s.length;let c;e[0]!==s?(c=s.map(Dd).filter(Rd),e[0]=s,e[1]=c):c=e[1];const d=c;if(l===0)return null;if(l===1){const v=s[0];if(!v.image_result&&!a)return null;let w;e[2]===Symbol.for("react.memo_cache_sentinel")?(w=o.jsx("span",{"aria-hidden":!0,className:"clear-both m-0 block h-0 p-0"}),e[2]=w):w=e[2];const j=(_=v==null?void 0:v.image_result)!=null?_:void 0;let C;e[3]===Symbol.for("react.memo_cache_sentinel")?(C={imageUse:"imageGroup",layout:"single"},e[3]=C):C=e[3];let f;return e[4]!==n||e[5]!==j||e[6]!==r?(f=o.jsxs(o.Fragment,{children:[w,o.jsx(Oe,{image:j,imageSource:Je.ImageGroup,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:C,aspectRatio:Pt,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_group"})]}),e[4]=n,e[5]=j,e[6]=r,e[7]=f):f=e[7],f}const u=i?s.length:Math.min(s.length,Id);let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=I("no-scrollbar flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",Gs),e[8]=m):m=e[8];let h;if(e[9]!==n||e[10]!==d||e[11]!==s||e[12]!==u||e[13]!==r){let v;e[15]!==n||e[16]!==d||e[17]!==s.length||e[18]!==u||e[19]!==r?(v=(w,j)=>{var f,y,k;const C=j===u-1;return o.jsx("div",{className:I("border-token-border-default relative w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-64 sm:w-[calc((100%-0.5rem)/3)]",j===0&&"rounded-s-xl",C&&"rounded-e-xl"),style:{aspectRatio:"".concat(ls.width,"/").concat(ls.height)},children:o.jsx(Oe,{image:(f=w.image_result)!=null?f:void 0,imageSource:Je.ImageGroup,lightboxImages:d,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:{imageUse:"imageGroup",layout:"carousel"},className:"h-full w-full",badge:C&&s.length>u&&o.jsx(nr,{numImages:s.length}),aspectRatio:ls,contentReferenceType:"image_group"})},(k=(y=w.image_result)==null?void 0:y.thumbnail_url)!=null?k:"".concat(w.image_search_query,"-").concat(w.image_ref_id,"-").concat(j))},e[15]=n,e[16]=d,e[17]=s.length,e[18]=u,e[19]=r,e[20]=v):v=e[20],h=s.slice(0,u).map(v),e[9]=n,e[10]=d,e[11]=s,e[12]=u,e[13]=r,e[14]=h}else h=e[14];let x;return e[21]!==h?(x=o.jsx("div",{className:m,children:h}),e[21]=h,e[22]=x):x=e[22],x}function Rd(t){return!!t}function Dd(t){return t.image_result}const Fd=p.memo(Ld,Zs);function Od(t){"use forget";var j;const e=he.c(14),{images:s,analyticsMetadata:n,trackContentReferenceEvent:r}=t,a=Vs();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={track:"height"},e[0]=i):i=e[0];const[l,c]=ci(i),d=(j=l==null?void 0:l.height)!=null?j:null,u=a==null?void 0:a.onFullWidthImageHeightChange;let m,h;e[1]!==u||e[2]!==d?(m=()=>{!u||d==null||u(d)},h=[u,d],e[1]=u,e[2]=d,e[3]=m,e[4]=h):(m=e[3],h=e[4]),p.useEffect(m,h);let x;e[5]!==n||e[6]!==s||e[7]!==r?(x=s.map(C=>{var f;return{content:o.jsx(Oe,{image:(f=C.image_result)!=null?f:void 0,imageSource:Je.ImageGroup,aspectRatio:null,enableHoverAnimation:!1,analyticsMetadata:n,trackContentReferenceEvent:r,skeletonEl:o.jsx("div",{className:"bg-token-main-surface-tertiary aspect-[3/2] h-full w-full animate-pulse"}),lightboxImages:s.map(Wd).filter(zd),className:"h-full w-full",contentReferenceType:"image_group",fadeInOnMount:!0})}}),e[5]=n,e[6]=s,e[7]=r,e[8]=x):x=e[8];const _=x;let v;e[9]!==_?(v=o.jsx(jd,{images:_,aspect:"aspect-[5/4]",showDots:!0}),e[9]=_,e[10]=v):v=e[10];let w;return e[11]!==c||e[12]!==v?(w=o.jsx("div",{ref:c,className:"-mx-6 mt-[calc(-1rem-3px)] pb-5",children:v}),e[11]=c,e[12]=v,e[13]=w):w=e[13],w}function zd(t){return!!t}function Wd(t){return t.image_result}const Hd=p.memo(Od,Zs);function Bd(t){"use forget";const e=he.c(21),{images:s,imageSource:n,superWidgetContent:r,lastUserMsgOfPrevTurn:a,analyticsMetadata:i,trackContentReferenceEvent:l,isReferenceComplete:c}=t,d=xe(),u=We(d);let m;e[0]!==d?(m=()=>Zt(d),e[0]=d,e[1]=m):m=e[1];const h=Ve(m);let x;e[2]!==s||e[3]!==c||e[4]!==a||e[5]!==r?(x={images:s,lastUserMsgOfPrevTurn:a,superWidgetContent:r,isContentReferenceComplete:c},e[2]=s,e[3]=c,e[4]=a,e[5]=r,e[6]=x):x=e[6];const{items:_,isLoading:v}=fd(x),w=v&&u?sr:0,j=Ud,C=h?"-mx-[var(--thread-content-margin)]":"-mx-6";let f;e[7]!==C?(f=I("relative mb-6",Gs,C),e[7]=C,e[8]=f):f=e[8];let y;e[9]!==i||e[10]!==n||e[11]!==_||e[12]!==l?(y=E=>o.jsx(Oe,{image:E,imageSource:n,analyticsMetadata:i,trackContentReferenceEvent:l,className:"aspect-auto h-full w-full",aspectRatio:null,contentReferenceType:"image_group",lightboxImages:_}),e[9]=i,e[10]=n,e[11]=_,e[12]=l,e[13]=y):y=e[13];const k=_.length===0?4:w;let S;e[14]!==_||e[15]!==y||e[16]!==k?(S=o.jsx(Yt,{items:_,getItemKey:Vd,itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)]",loadingItemClassName:"min-w-[240px]",getItemStyle:j,onRenderItem:y,className:"h-48 min-h-48",numLoadingItems:k}),e[14]=_,e[15]=y,e[16]=k,e[17]=S):S=e[17];let N;return e[18]!==f||e[19]!==S?(N=o.jsx("div",{className:f,children:S}),e[18]=f,e[19]=S,e[20]=N):N=e[20],N}function Vd(t){return t.thumbnail_url}function Ud(t){const{width:e,height:s}=t.content_size;return{width:s?e/s*192:180}}const qd=200,Gd=100,Nt=mt({id:"imagePill.screenshot",defaultMessage:"screenshot"}),or="m-0 p-[2px] pe-1",Zd=I(or,"h-full rounded-lg object-contain"),Xd=I(or,"p-[4px]");function Cn({image:t}){const[e,s]=p.useState(!1),n=Hs.useStore(),r=p.useRef(null),a=p.useRef(null),i=le(),l=t==null?void 0:t.content_url,c=p.useMemo(()=>l?Kt(l,"hostname"):null,[l]),d=p.useCallback(()=>{r.current&&clearTimeout(r.current)},[]),u=p.useCallback(()=>{t&&(d(),s(!1),n.setCurrentImage({image:t}))},[n,t,d]),m=p.useCallback(()=>{a.current&&clearTimeout(a.current)},[]),h=p.useCallback(()=>{s(!1)},[s]),x=p.useCallback(w=>{w.stopPropagation(),m(),r.current=setTimeout(()=>{s(!0)},qd)},[m]),_=p.useCallback(w=>{w.stopPropagation(),d(),a.current=setTimeout(()=>{h()},Gd)},[d,h]);p.useEffect(()=>{e&&m()},[e,m]);const v=p.useMemo(()=>({onBlur:_,onMouseLeave:_,onMouseEnter:x,onFocus:x}),[_,x]);return t?o.jsxs("span",U(D({onClick:u,className:"relative"},v),{children:[o.jsxs(Sn,{isOpen:e,children:[o.jsx("img",{className:Zd,src:t.thumbnail_url}),o.jsx("span",{children:c!=null?c:i.formatMessage(Nt)})]}),e&&o.jsx("div",{className:"absolute start-0 z-50",children:o.jsxs("div",U(D({className:I("text-token-text-secondary border-token-border-light w-[256px] cursor-pointer px-3 pt-2 pb-3 text-sm shadow-md outline-[0.5px] outline-black/5",fa)},v),{children:[o.jsxs(Qe,{href:t.content_url,target:"_blank",rel:"noopener",className:"z-50 mb-2 flex items-center gap-2 hover:opacity-70",onClick:w=>w.stopPropagation(),children:[o.jsx($t,{url:t.content_url,className:"m-0 size-4 p-0",size:32}),c!=null?c:i.formatMessage(Nt)]}),o.jsx("img",{className:"border-token-border-light m-0 cursor-pointer rounded-lg object-contain p-0 outline-[0.5px] outline-black/5",src:t.thumbnail_url,alt:c!=null?c:i.formatMessage(Nt),onClick:w=>{w.preventDefault(),u()}})]}))})]})):o.jsxs(Sn,{isOpen:!1,children:[o.jsx("span",{className:Xd,children:o.jsx(yt,{})}),o.jsx("span",{children:c!=null?c:i.formatMessage(Nt)})]})}function Sn(n){var r=n,{children:t,isOpen:e}=r,s=Te(r,["children","isOpen"]);return o.jsx("span",U(D({className:I("ms-1 cursor-pointer","inline-flex max-w-full items-center","relative top-[0.2rem]","animate-[show_150ms_ease-in]")},s),{children:o.jsx("span",{className:I("text-token-text-secondary flex h-4.5 overflow-hidden rounded-xl bg-[#F4F4F4] pe-2 text-[0.5625em] font-medium dark:bg-[#303030]","hover:bg-token-text-primary! hover:text-token-text-inverted",e&&"bg-token-main-surface-tertiary text-token-text-secondary","transition-colors duration-150 ease-in-out","items-center justify-center"),children:t})}))}async function Yd({conversationId:t,messageId:e,assetPointerLinks:s,sharedConversationLikeId:n}){return await ha.safePost("/conversation/get_images_for_message",{requestBody:{conversation_id:t!=null?t:null,share_id:n!=null?n:null,message_id:e,asset_pointer_links:s},authOption:pa.SendIfAvailable})}function Kd({reference:t,conversationId:e,messageId:s,sharedConversationLikeId:n,isN7jupdMessage:r}){return Fr(D({queryKey:["inline-images",t,e,s],queryFn:async()=>{if(!t.asset_pointer_links||t.asset_pointer_links.length===0||!e&&!n)return{images:[],formats:[]};const i=await Yd({conversationId:e,messageId:s,assetPointerLinks:t.asset_pointer_links,sharedConversationLikeId:n});for(let l=0;l<i.images.length;l++){const c=i.images[l],d=i.formats[l],u="image/".concat(d),m=Jd(c,u);i.images[l]=m}return i}},r?{retry:3,retryDelay:5e3}:{}))}function Jd(t,e="",s=512){const n=atob(t),r=[];for(let i=0;i<n.length;i+=s){const l=n.slice(i,i+s),c=new Array(l.length);for(let u=0;u<l.length;u++)c[u]=l.charCodeAt(u);const d=new Uint8Array(c);r.push(d)}const a=new Blob(r,{type:e});return URL.createObjectURL(a)}const Qd=200;function eu({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:n}){var h;const r=Rs(e),{postId:a}=p.useContext(di),{data:i,isLoading:l,isError:c,error:d}=Kd({reference:t,conversationId:r,messageId:s.id,sharedConversationLikeId:a,isN7jupdMessage:(h=s.metadata)==null?void 0:h.n7jupd_message}),u=p.useRef([]);p.useEffect(()=>()=>{u.current.forEach(x=>{URL.revokeObjectURL(x)}),u.current=[]},[]);const m=rr(s,t);return d||c||i&&!("images"in i)||l||!(i!=null&&i.images.length)?null:(u.current=[],o.jsx(o.Fragment,{children:i==null?void 0:i.images.map((x,_)=>{const v=ar(t,x,m);return o.jsx(qs,{metadata:v,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:n},"image-carousel-inline-".concat(_))})}))}const tu=(t,e)=>{const s=new RegExp(e+"\\s*([^\\n]+)","m"),n=t.match(s);return n&&n[1]?n[1].trim().length:0};function rr(t,e){return p.useMemo(()=>{let s=-1;return t.content.content_type==="text"&&(s=tu(t.content.parts.join(""),e.matched_text)),s<Qd||s===-1},[t,e.matched_text])}function ar(t,e,s){var n,r,a;return{matched_text:t.matched_text,start_idx:t.start_idx,end_idx:t.end_idx,safe_urls:t.safe_urls,alt:t.alt,prompt_text:t.prompt_text,type:"image_v2",refs:[],images:[{url:e,content_url:(n=t.clicked_from_url)!=null?n:"",thumbnail_url:e,title:(r=t.clicked_from_title)!=null?r:"",attribution:Kt((a=t.clicked_from_url)!=null?a:e,"hostname"),content_size:{width:Nn,height:Mn},thumbnail_size:{width:Nn,height:Mn},is_proxied_image:!0,float_top:s}]}}const Nn=141,Mn=143;function su({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:n}){var x,_,v,w,j;const r=((x=s.metadata)==null?void 0:x.n7jupd_message)&&t.matched_text.includes("screenshot"),a=Rs(e),i=(v=(_=p.useContext(ui))==null?void 0:_.serverSharedThreadId)!=null?v:void 0,l=mi(t.asset_pointer_links[0]),c=p.useMemo(()=>({content_type:yo.ImageAssetPointer,size_bytes:0,width:0,height:0,asset_pointer:l}),[l]),d=Ro({asset:c,sharedThreadId:i,conversationId:a}),u=(w=d.data)==null?void 0:w.url,m=rr(s,t),h=p.useMemo(()=>u?ar(t,u,m):null,[u,t,m]);return d.error||d.isError?null:r&&!((j=d.data)!=null&&j.url)&&d.isLoading?o.jsx(Cn,{image:null},"image-pill-loading"):!r&&(d.isLoading||!d.data)||!h?null:r?o.jsx(Cn,{image:h.images[0]}):o.jsx(qs,{metadata:h,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:n})}const Ce=1e-6;let it=typeof Float32Array<"u"?Float32Array:Array;function nu(){const t=new it(2);return it!=Float32Array&&(t[0]=0,t[1]=0),t}function En(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t}function ou(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ir(t,e,s,n){const r=e[0],a=e[1];return t[0]=r+n*(s[0]-r),t[1]=a+n*(s[1]-a),t}(function(){const t=nu();return function(e,s,n,r,a,i){let l,c;for(s||(s=2),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],a(t,t,i),e[l]=t[0],e[l+1]=t[1];return e}})();function ru(){const t=new it(3);return it!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function au(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t}function iu(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t}function lu(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}const cu=iu;(function(){const t=ru();return function(e,s,n,r,a,i){let l,c;for(s||(s=3),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,i),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();function du(t,e){const s=e[0],n=e[1],r=e[2],a=e[3],i=e[4],l=e[5],c=e[6],d=e[7],u=e[8],m=e[9],h=e[10],x=e[11],_=e[12],v=e[13],w=e[14],j=e[15],C=s*l-n*i,f=s*c-r*i,y=s*d-a*i,k=n*c-r*l,S=n*d-a*l,N=r*d-a*c,E=u*v-m*_,$=u*w-h*_,P=u*j-x*_,b=m*w-h*v,F=m*j-x*v,L=h*j-x*w;let T=C*L-f*F+y*b+k*P-S*$+N*E;return T?(T=1/T,t[0]=(l*L-c*F+d*b)*T,t[1]=(r*F-n*L-a*b)*T,t[2]=(v*N-w*S+j*k)*T,t[3]=(h*S-m*N-x*k)*T,t[4]=(c*P-i*L-d*$)*T,t[5]=(s*L-r*P+a*$)*T,t[6]=(w*y-_*N-j*f)*T,t[7]=(u*N-h*y+x*f)*T,t[8]=(i*F-l*P+d*E)*T,t[9]=(n*P-s*F-a*E)*T,t[10]=(_*S-v*y+j*C)*T,t[11]=(m*y-u*S-x*C)*T,t[12]=(l*$-i*b-c*E)*T,t[13]=(s*b-n*$+r*E)*T,t[14]=(v*f-_*k-w*C)*T,t[15]=(u*k-m*f+h*C)*T,t):null}function cs(t,e,s){const n=e[0],r=e[1],a=e[2],i=e[3],l=e[4],c=e[5],d=e[6],u=e[7],m=e[8],h=e[9],x=e[10],_=e[11],v=e[12],w=e[13],j=e[14],C=e[15];let f=s[0],y=s[1],k=s[2],S=s[3];return t[0]=f*n+y*l+k*m+S*v,t[1]=f*r+y*c+k*h+S*w,t[2]=f*a+y*d+k*x+S*j,t[3]=f*i+y*u+k*_+S*C,f=s[4],y=s[5],k=s[6],S=s[7],t[4]=f*n+y*l+k*m+S*v,t[5]=f*r+y*c+k*h+S*w,t[6]=f*a+y*d+k*x+S*j,t[7]=f*i+y*u+k*_+S*C,f=s[8],y=s[9],k=s[10],S=s[11],t[8]=f*n+y*l+k*m+S*v,t[9]=f*r+y*c+k*h+S*w,t[10]=f*a+y*d+k*x+S*j,t[11]=f*i+y*u+k*_+S*C,f=s[12],y=s[13],k=s[14],S=s[15],t[12]=f*n+y*l+k*m+S*v,t[13]=f*r+y*c+k*h+S*w,t[14]=f*a+y*d+k*x+S*j,t[15]=f*i+y*u+k*_+S*C,t}function Ns(t,e,s){const n=s[0],r=s[1],a=s[2];let i,l,c,d,u,m,h,x,_,v,w,j;return e===t?(t[12]=e[0]*n+e[4]*r+e[8]*a+e[12],t[13]=e[1]*n+e[5]*r+e[9]*a+e[13],t[14]=e[2]*n+e[6]*r+e[10]*a+e[14],t[15]=e[3]*n+e[7]*r+e[11]*a+e[15]):(i=e[0],l=e[1],c=e[2],d=e[3],u=e[4],m=e[5],h=e[6],x=e[7],_=e[8],v=e[9],w=e[10],j=e[11],t[0]=i,t[1]=l,t[2]=c,t[3]=d,t[4]=u,t[5]=m,t[6]=h,t[7]=x,t[8]=_,t[9]=v,t[10]=w,t[11]=j,t[12]=i*n+u*r+_*a+e[12],t[13]=l*n+m*r+v*a+e[13],t[14]=c*n+h*r+w*a+e[14],t[15]=d*n+x*r+j*a+e[15]),t}function lr(t,e,s){const n=s[0],r=s[1],a=s[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function uu(t,e,s){const n=Math.sin(s),r=Math.cos(s),a=e[4],i=e[5],l=e[6],c=e[7],d=e[8],u=e[9],m=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+d*n,t[5]=i*r+u*n,t[6]=l*r+m*n,t[7]=c*r+h*n,t[8]=d*r-a*n,t[9]=u*r-i*n,t[10]=m*r-l*n,t[11]=h*r-c*n,t}function mu(t,e,s){const n=Math.sin(s),r=Math.cos(s),a=e[0],i=e[1],l=e[2],c=e[3],d=e[4],u=e[5],m=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+d*n,t[1]=i*r+u*n,t[2]=l*r+m*n,t[3]=c*r+h*n,t[4]=d*r-a*n,t[5]=u*r-i*n,t[6]=m*r-l*n,t[7]=h*r-c*n,t}function fu(t,e,s,n,r){const a=1/Math.tan(e/2);if(t[0]=a/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0){const i=1/(n-r);t[10]=(r+n)*i,t[14]=2*r*n*i}else t[10]=-1,t[14]=-2*n;return t}const hu=fu;function Tn(t,e){const s=t[0],n=t[1],r=t[2],a=t[3],i=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=t[9],h=t[10],x=t[11],_=t[12],v=t[13],w=t[14],j=t[15],C=e[0],f=e[1],y=e[2],k=e[3],S=e[4],N=e[5],E=e[6],$=e[7],P=e[8],b=e[9],F=e[10],L=e[11],T=e[12],M=e[13],z=e[14],G=e[15];return Math.abs(s-C)<=Ce*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(n-f)<=Ce*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-y)<=Ce*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-k)<=Ce*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(i-S)<=Ce*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(l-N)<=Ce*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(c-E)<=Ce*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(d-$)<=Ce*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(u-P)<=Ce*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(m-b)<=Ce*Math.max(1,Math.abs(m),Math.abs(b))&&Math.abs(h-F)<=Ce*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(x-L)<=Ce*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(_-T)<=Ce*Math.max(1,Math.abs(_),Math.abs(T))&&Math.abs(v-M)<=Ce*Math.max(1,Math.abs(v),Math.abs(M))&&Math.abs(w-z)<=Ce*Math.max(1,Math.abs(w),Math.abs(z))&&Math.abs(j-G)<=Ce*Math.max(1,Math.abs(j),Math.abs(G))}function pu(){const t=new it(4);return it!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function gu(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t}function xu(t,e,s){const n=e[0],r=e[1],a=e[2],i=e[3];return t[0]=s[0]*n+s[4]*r+s[8]*a+s[12]*i,t[1]=s[1]*n+s[5]*r+s[9]*a+s[13]*i,t[2]=s[2]*n+s[6]*r+s[10]*a+s[14]*i,t[3]=s[3]*n+s[7]*r+s[11]*a+s[15]*i,t}(function(){const t=pu();return function(e,s,n,r,a,i){let l,c;for(s||(s=4),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,i),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();function At(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rt(t,e){const s=xu([],e,t);return gu(s,s,1/s[3]),s}function Ms(t,e,s){return t<e?e:t>s?s:t}function yu(t){return Math.log(t)*Math.LOG2E}const bu=Math.log2||yu;function Be(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const $e=Math.PI,cr=$e/4,Ie=$e/180,Es=180/$e,gt=512,$n=4003e4,Mt=85.051129,dr=1.5;function _u(t){return Math.pow(2,t)}function ot(t){const[e,s]=t;Be(Number.isFinite(e)),Be(Number.isFinite(s)&&s>=-90&&s<=90,"invalid latitude");const n=e*Ie,r=s*Ie,a=gt*(n+$e)/(2*$e),i=gt*($e+Math.log(Math.tan(cr+r*.5)))/(2*$e);return[a,i]}function ht(t){const[e,s]=t,n=e/gt*(2*$e)-$e,r=2*(Math.atan(Math.exp(s/gt*(2*$e)-$e))-cr);return[n*Es,r*Es]}function vu(t){const{latitude:e,longitude:s,highPrecision:n=!1}=t;Be(Number.isFinite(e)&&Number.isFinite(s));const r=gt,a=Math.cos(e*Ie),i=r/360,l=i/a,c=r/$n/a,d={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[i,l,c],degreesPerUnit:[1/i,1/l,1/c]};if(n){const u=Ie*Math.tan(e*Ie)/a,m=i*u/2,h=r/$n*u,x=h/l*c;d.unitsPerDegree2=[0,m,h],d.unitsPerMeter2=[x,0,x]}return d}function wu(t){const{height:e,pitch:s,bearing:n,altitude:r,scale:a,center:i}=t,l=At();Ns(l,l,[0,0,-r]),uu(l,l,-s*Ie),mu(l,l,n*Ie);const c=a/e;return lr(l,l,[c,c,c]),i&&Ns(l,l,lu([],i)),l}function ju(t){const{width:e,height:s,altitude:n,pitch:r=0,offset:a,center:i,scale:l,nearZMultiplier:c=1,farZMultiplier:d=1}=t;let{fovy:u=Rt(dr)}=t;n!==void 0&&(u=Rt(n));const m=u*Ie,h=r*Ie,x=ur(u);let _=x;i&&(_+=i[2]*l/Math.cos(h)/s);const v=m*(.5+(a?a[1]:0)/s),w=Math.sin(v)*_/Math.sin(Ms(Math.PI/2-h-v,.01,Math.PI-.01)),j=Math.sin(h)*w+_,C=_*10,f=Math.min(j*d,C);return{fov:m,aspect:e/s,focalDistance:x,near:c,far:f}}function ku(t){const{fov:e,aspect:s,near:n,far:r}=ju(t);return hu([],e,s,n,r)}function Rt(t){return 2*Math.atan(.5/t)*Es}function ur(t){return .5/Math.tan(.5*t*Ie)}function Cu(t,e){const[s,n,r=0]=t;return Be(Number.isFinite(s)&&Number.isFinite(n)&&Number.isFinite(r)),rt(e,[s,n,r,1])}function Pn(t,e,s=0){const[n,r,a]=t;if(Be(Number.isFinite(n)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(a))return rt(e,[n,r,a,1]);const i=rt(e,[n,r,0,1]),l=rt(e,[n,r,1,1]),c=i[2],d=l[2],u=c===d?0:((s||0)-c)/(d-c);return ir([],i,l,u)}function Su(t){const{width:e,height:s,bounds:n,minExtent:r=0,maxZoom:a=24,offset:i=[0,0]}=t,[[l,c],[d,u]]=n,m=Nu(t.padding),h=ot([l,Ms(u,-Mt,Mt)]),x=ot([d,Ms(c,-Mt,Mt)]),_=[Math.max(Math.abs(x[0]-h[0]),r),Math.max(Math.abs(x[1]-h[1]),r)],v=[e-m.left-m.right-Math.abs(i[0])*2,s-m.top-m.bottom-Math.abs(i[1])*2];Be(v[0]>0&&v[1]>0);const w=v[0]/_[0],j=v[1]/_[1],C=(m.right-m.left)/2/w,f=(m.top-m.bottom)/2/j,y=[(x[0]+h[0])/2+C,(x[1]+h[1])/2+f],k=ht(y),S=Math.min(a,bu(Math.abs(Math.min(w,j))));return Be(Number.isFinite(S)),{longitude:k[0],latitude:k[1],zoom:S}}function Nu(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Be(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const An=Math.PI/180;function Mu(t,e=0){const{width:s,height:n,unproject:r}=t,a={targetZ:e},i=r([0,n],a),l=r([s,n],a);let c,d;const u=t.fovy?.5*t.fovy*An:Math.atan(.5/t.altitude),m=(90-t.pitch)*An;return u>m-.01?(c=In(t,0,e),d=In(t,s,e)):(c=r([0,0],a),d=r([s,0],a)),[i,l,d,c]}function In(t,e,s){const{pixelUnprojectionMatrix:n}=t,r=rt(n,[e,0,1,1]),a=rt(n,[e,t.height,1,1]),l=(s*t.distanceScales.unitsPerMeter[2]-r[2])/(a[2]-r[2]),c=ir([],r,a,l),d=ht(c);return d.push(s),d}class Dt{constructor(e={width:1,height:1}){this.equals=j=>j instanceof Dt?j.width===this.width&&j.height===this.height&&Tn(j.projectionMatrix,this.projectionMatrix)&&Tn(j.viewMatrix,this.viewMatrix):!1,this.project=(j,C={})=>{const{topLeft:f=!0}=C,y=this.projectPosition(j),k=Cu(y,this.pixelProjectionMatrix),[S,N]=k,E=f?N:this.height-N;return j.length===2?[S,E]:[S,E,k[2]]},this.unproject=(j,C={})=>{const{topLeft:f=!0,targetZ:y=void 0}=C,[k,S,N]=j,E=f?S:this.height-S,$=y&&y*this.distanceScales.unitsPerMeter[2],P=Pn([k,E,N],this.pixelUnprojectionMatrix,$),[b,F,L]=this.unprojectPosition(P);return Number.isFinite(N)?[b,F,L]:Number.isFinite(y)?[b,F,y]:[b,F]},this.projectPosition=j=>{const[C,f]=ot(j),y=(j[2]||0)*this.distanceScales.unitsPerMeter[2];return[C,f,y]},this.unprojectPosition=j=>{const[C,f]=ht(j),y=(j[2]||0)*this.distanceScales.metersPerUnit[2];return[C,f,y]};let{width:s,height:n,altitude:r=null,fovy:a=null}=e;const{latitude:i=0,longitude:l=0,zoom:c=0,pitch:d=0,bearing:u=0,position:m=null,nearZMultiplier:h=.02,farZMultiplier:x=1.01}=e;s=s||1,n=n||1,a===null&&r===null?(r=dr,a=Rt(r)):a===null?a=Rt(r):r===null&&(r=ur(a));const _=_u(c);r=Math.max(.75,r);const v=vu({longitude:l,latitude:i}),w=ot([l,i]);w.push(0),m&&au(w,w,cu([],m,v.unitsPerMeter)),this.projectionMatrix=ku({width:s,height:n,scale:_,center:w,pitch:d,fovy:a,nearZMultiplier:h,farZMultiplier:x}),this.viewMatrix=wu({height:n,scale:_,center:w,pitch:d,bearing:u,altitude:r}),this.width=s,this.height=n,this.scale=_,this.latitude=i,this.longitude=l,this.zoom=c,this.pitch=d,this.bearing=u,this.altitude=r,this.fovy=a,this.center=w,this.meterOffset=m||[0,0,0],this.distanceScales=v,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:s,projectionMatrix:n,viewMatrix:r}=this,a=At();cs(a,a,n),cs(a,a,r),this.viewProjectionMatrix=a;const i=At();lr(i,i,[e/2,-s/2,1]),Ns(i,i,[1,-1,0]),cs(i,i,a);const l=du(At(),i);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=i,this.pixelUnprojectionMatrix=l}projectFlat(e){return ot(e)}unprojectFlat(e){return ht(e)}getMapCenterByLngLatPosition({lngLat:e,pos:s}){const n=Pn(s,this.pixelUnprojectionMatrix),r=ot(e),a=En([],r,ou([],n)),i=En([],this.center,a);return ht(i)}fitBounds(e,s={}){const{width:n,height:r}=this,{longitude:a,latitude:i,zoom:l}=Su(Object.assign({width:n,height:r,bounds:e},s));return new Dt({width:n,height:r,longitude:a,latitude:i,zoom:l})}getBounds(e){const s=this.getBoundingRegion(e),n=Math.min(...s.map(l=>l[0])),r=Math.max(...s.map(l=>l[0])),a=Math.min(...s.map(l=>l[1])),i=Math.max(...s.map(l=>l[1]));return[[n,a],[r,i]]}getBoundingRegion(e={}){return Mu(this,e.z||0)}getLocationAtPoint({lngLat:e,pos:s}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:s})}}function Eu(t,e,s={}){const n={type:"Feature"};return(s.id===0||s.id)&&(n.id=s.id),s.bbox&&(n.bbox=s.bbox),n.properties=e||{},n.geometry=t,n}function mr(t,e,s={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ln(t[0])||!Ln(t[1]))throw new Error("coordinates must contain numbers");return Eu({type:"Point",coordinates:t},e,s)}function Tu(t,e={}){const s={type:"FeatureCollection"};return e.id&&(s.id=e.id),e.bbox&&(s.bbox=e.bbox),s.features=t,s}function Ln(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function fr(t,e,s){if(t!==null)for(var n,r,a,i,l,c,d,u=0,m=0,h,x=t.type,_=x==="FeatureCollection",v=x==="Feature",w=_?t.features.length:1,j=0;j<w;j++){d=_?t.features[j].geometry:v?t.geometry:t,h=d?d.type==="GeometryCollection":!1,l=h?d.geometries.length:1;for(var C=0;C<l;C++){var f=0,y=0;if(i=h?d.geometries[C]:d,i!==null){c=i.coordinates;var k=i.type;switch(u=0,k){case null:break;case"Point":if(e(c,m,j,f,y)===!1)return!1;m++,f++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],m,j,f,y)===!1)return!1;m++,k==="MultiPoint"&&f++}k==="LineString"&&f++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(r=0;r<c[n].length-u;r++){if(e(c[n][r],m,j,f,y)===!1)return!1;m++}k==="MultiLineString"&&f++,k==="Polygon"&&y++}k==="Polygon"&&f++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(y=0,r=0;r<c[n].length;r++){for(a=0;a<c[n][r].length-u;a++){if(e(c[n][r][a],m,j,f,y)===!1)return!1;m++}y++}f++}break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(fr(i.geometries[n],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function hr(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const s=[1/0,1/0,-1/0,-1/0];return fr(t,n=>{s[0]>n[0]&&(s[0]=n[0]),s[1]>n[1]&&(s[1]=n[1]),s[2]<n[0]&&(s[2]=n[0]),s[3]<n[1]&&(s[3]=n[1])}),s}var $u=hr;function Pu(t,e={}){const s=hr(t),n=(s[0]+s[2])/2,r=(s[1]+s[3])/2;return mr([n,r],e.properties,e)}var Au=Pu,ds,Rn;function Iu(){if(Rn)return ds;Rn=1;var t=ga(),e=xa(),s=ya(),n=ba(),r=t.isFinite,a=Math.min;function i(l){var c=Math[l];return function(d,u){if(d=s(d),u=u==null?0:a(e(u),292),u&&r(d)){var m=(n(d)+"e").split("e"),h=c(m[0]+"e"+(+m[1]+u));return m=(n(h)+"e").split("e"),+(m[0]+"e"+(+m[1]-u))}return c(d)}}return ds=i,ds}var us,Dn;function Lu(){if(Dn)return us;Dn=1;var t=Iu(),e=t("round");return us=e,us}var Ru=Lu();const He=Or(Ru),Du=p.createContext(null);function Fu(t,e){const s=Array.isArray(t)?t[0]:t?t.x:0,n=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return s===r&&n===a}function Fe(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!Fe(t[s],e[s]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const s=Object.keys(t),n=Object.keys(e);if(s.length!==n.length)return!1;for(const r of s)if(!e.hasOwnProperty(r)||!Fe(t[r],e[r]))return!1;return!0}return!1}function Ou(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function Fn(t,e){if(!t.getProjection)return;const s=t.getProjection(),n=e.getProjection();Fe(s,n)||e.setProjection(s)}function On(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function zn(t,e){const s=e.viewState||e;let n=!1;if("longitude"in s&&"latitude"in s){const r=t.center;t.center=new r.constructor(s.longitude,s.latitude),n=n||r!==t.center}if("zoom"in s){const r=t.zoom;t.zoom=s.zoom,n=n||r!==t.zoom}if("bearing"in s){const r=t.bearing;t.bearing=s.bearing,n=n||r!==t.bearing}if("pitch"in s){const r=t.pitch;t.pitch=s.pitch,n=n||r!==t.pitch}return s.padding&&!t.isPaddingEqual(s.padding)&&(n=!0,t.padding=s.padding),n}const zu=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wn(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const n of t.layers)e[n.id]=n;const s=t.layers.map(n=>{let r=null;"interactive"in n&&(r=Object.assign({},n),delete r.interactive);const a=e[n.ref];if(a){r=r||Object.assign({},n),delete r.ref;for(const i of zu)i in a&&(r[i]=a[i])}return r||n});return U(D({},t),{layers:s})}var Hn={};const Bn={version:8,sources:{},layers:[]},Vn={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ms={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Un={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Wu=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Hu=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class lt{constructor(e,s,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const a=this.props[Un[r.type]];a?a(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const a=this.props[Vn[r.type]];a&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),a(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const a=this.props[ms[r.type]];a&&a(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=s,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const s=this.props;this.props=e;const n=this._updateSettings(e,s);n&&this._createShadowTransform(this._map);const r=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,s),this._updateStyleComponents(e,s),this._updateHandlers(e,s),(n||r||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,s){const n=lt.savedMaps.pop();if(!n)return null;const r=n.map,a=r.getContainer();for(s.className=a.className;a.childNodes.length>0;)s.appendChild(a.childNodes[0]);r._container=s;const i=r._resizeObserver;i&&(i.disconnect(),i.observe(s)),n.setProps(U(D({},e),{styleDiffing:!1})),r.resize();const{initialViewState:l}=e;return l&&(l.bounds?r.fitBounds(l.bounds,U(D({},l.fitBoundsOptions),{duration:0})):n._updateViewState(l,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),n}_initialize(e){const{props:s}=this,{mapStyle:n=Bn}=s,r=U(D(D({},s),s.initialViewState),{accessToken:s.mapboxAccessToken||Bu()||null,container:e,style:Wn(n)}),a=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),s.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,s.gl)}const i=new this._MapClass(r);a.padding&&i.setPadding(a.padding),s.cursor&&(i.getCanvas().style.cursor=s.cursor),this._createShadowTransform(i);const l=i._render;i._render=u=>{this._inRender=!0,l.call(i,u),this._inRender=!1};const c=i._renderTaskQueue.run;i._renderTaskQueue.run=u=>{c.call(i._renderTaskQueue,u),this._onBeforeRepaint()},i.on("render",()=>this._onAfterRepaint());const d=i.fire;i.fire=this._fireEvent.bind(this,d),i.on("resize",()=>{this._renderTransform.resize(i.transform.width,i.transform.height)}),i.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Fn(i.transform,this._renderTransform)}),i.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in Vn)i.on(u,this._onPointerEvent);for(const u in ms)i.on(u,this._onCameraEvent);for(const u in Un)i.on(u,this._onEvent);this._map=i}recycle(){const s=this.map.getContainer().querySelector("[mapboxgl-children]");s==null||s.remove(),lt.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const s=Ou(e.transform);e.painter.transform=s,this._renderTransform=s}_updateSize(e){const{viewState:s}=e;if(s){const n=this._map;if(s.width!==n.transform.width||s.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(e,s){if(this._internalUpdate)return!1;const n=this._map,r=this._renderTransform,{zoom:a,pitch:i,bearing:l}=r,c=n.isMoving();c&&(r.cameraElevationReference="sea");const d=zn(r,D(D({},On(n.transform)),e));if(c&&(r.cameraElevationReference="ground"),d&&s){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=a!==r.zoom),u.rotate||(u.rotate=l!==r.bearing),u.pitch||(u.pitch=i!==r.pitch)}return c||zn(n.transform,e),d}_updateSettings(e,s){const n=this._map;let r=!1;for(const a of Wu)if(a in e&&!Fe(e[a],s[a])){r=!0;const i=n["set".concat(a[0].toUpperCase()).concat(a.slice(1))];i==null||i.call(n,e[a])}return r}_updateStyle(e,s){if(e.cursor!==s.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==s.mapStyle){const{mapStyle:n=Bn,styleDiffing:r=!0}=e,a={diff:r};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Wn(n),a),!0}return!1}_updateStyleComponents(e,s){const n=this._map;let r=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!Fe(e.light,s.light)&&(r=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!Fe(e.fog,s.fog)&&(r=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!Fe(e.terrain,s.terrain)&&(!e.terrain||n.getSource(e.terrain.source))&&(r=!0,n.setTerrain(e.terrain))),r}_updateHandlers(e,s){var n,r;const a=this._map;let i=!1;for(const l of Hu){const c=(n=e[l])!==null&&n!==void 0?n:!0,d=(r=s[l])!==null&&r!==void 0?r:!0;Fe(c,d)||(i=!0,c?a[l].enable(c):a[l].disable())}return i}_queryRenderedFeatures(e){const s=this._map,n=s.transform,{interactiveLayerIds:r=[]}=this.props;try{return s.transform=this._renderTransform,s.queryRenderedFeatures(e,{layers:r.filter(s.getLayer.bind(s))})}catch(a){return[]}finally{s.transform=n}}_updateHover(e){var s;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=e.type,i=((s=this._hoveredFeatures)===null||s===void 0?void 0:s.length)>0,l=this._queryRenderedFeatures(e.point),c=l.length>0;!c&&i&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,c&&!i&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,s,n){const r=this._map,a=r.transform,i=typeof s=="string"?s:s.type;return i==="move"&&this._updateViewState(this.props,!1),i in ms&&(typeof s=="object"&&(s.viewState=On(a)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,s,n),r.transform=a,r):(e.call(r,s,n),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const s=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Fn(this._renderTransform,s),e.transform=s}}}lt.savedMaps=[];function Bu(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||Hn.MapboxAccessToken}catch(e){}try{t=t||Hn.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(e){}return t}const Vu=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Uu(t){if(!t)return null;const e=t.map,s={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:n=>{const r=e.transform;e.transform=t.transform;const a=e.project(n);return e.transform=r,a},unproject:n=>{const r=e.transform;e.transform=t.transform;const a=e.unproject(n);return e.transform=r,a},queryTerrainElevation:(n,r)=>{const a=e.transform;e.transform=t.transform;const i=e.queryTerrainElevation(n,r);return e.transform=a,i},queryRenderedFeatures:(n,r)=>{const a=e.transform;e.transform=t.transform;const i=e.queryRenderedFeatures(n,r);return e.transform=a,i}};for(const n of qu(e))!(n in s)&&!Vu.includes(n)&&(s[n]=e[n].bind(e));return s}function qu(t){const e=new Set;let s=t;for(;s;){for(const n of Object.getOwnPropertyNames(s))n[0]!=="_"&&typeof t[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&e.add(n);s=Object.getPrototypeOf(s)}return Array.from(e)}const Gu=typeof document<"u"?p.useLayoutEffect:p.useEffect,Zu=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Xu(t,e){for(const n of Zu)n in e&&(t[n]=e[n]);const{RTLTextPlugin:s="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;s&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(s,n=>{n&&console.error(n)},!0)}const Qt=p.createContext(null);function Yu(t,e,s){const n=p.useContext(Du),[r,a]=p.useState(null),i=p.useRef(),{current:l}=p.useRef({mapLib:null,map:null});p.useEffect(()=>{const u=t.mapLib;let m=!0,h;return Promise.resolve(u||s).then(x=>{if(!m)return;if(!x)throw new Error("Invalid mapLib");const _="Map"in x?x:x.default;if(!_.Map)throw new Error("Invalid mapLib");if(Xu(_,t),!_.supported||_.supported(t))t.reuseMaps&&(h=lt.reuse(t,i.current)),h||(h=new lt(_.Map,t,i.current)),l.map=Uu(h),l.mapLib=_,a(h),n==null||n.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(x=>{const{onError:_}=t;_?_({type:"error",target:null,originalEvent:null,error:x}):console.error(x)}),()=>{m=!1,h&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),Gu(()=>{r&&r.setProps(t)}),p.useImperativeHandle(e,()=>l.map,[r]);const c=p.useMemo(()=>D({position:"relative",width:"100%",height:"100%"},t.style),[t.style]),d={height:"100%"};return p.createElement("div",{id:t.id,ref:i,style:c},r&&p.createElement(Qt.Provider,{value:l},p.createElement("div",{"mapboxgl-children":"",style:d},t.children)))}const Ku=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function et(t,e){if(!t||!e)return;const s=t.style;for(const n in e){const r=e[n];Number.isFinite(r)&&!Ku.test(n)?s[n]="".concat(r,"px"):s[n]=r}}function Ju(t,e){const{map:s,mapLib:n}=p.useContext(Qt),r=p.useRef({props:t});r.current.props=t;const a=p.useMemo(()=>{let v=!1;p.Children.forEach(t.children,C=>{C&&(v=!0)});const w=U(D({},t),{element:v?document.createElement("div"):null}),j=new n.Marker(w);return j.setLngLat([t.longitude,t.latitude]),j.getElement().addEventListener("click",C=>{var f,y;(y=(f=r.current.props).onClick)===null||y===void 0||y.call(f,{type:"click",target:j,originalEvent:C})}),j.on("dragstart",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDragStart)===null||y===void 0||y.call(f,k)}),j.on("drag",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDrag)===null||y===void 0||y.call(f,k)}),j.on("dragend",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDragEnd)===null||y===void 0||y.call(f,k)}),j},[]);p.useEffect(()=>(a.addTo(s.getMap()),()=>{a.remove()}),[]);const{longitude:i,latitude:l,offset:c,style:d,draggable:u=!1,popup:m=null,rotation:h=0,rotationAlignment:x="auto",pitchAlignment:_="auto"}=t;return p.useEffect(()=>{et(a.getElement(),d)},[d]),p.useImperativeHandle(e,()=>a,[]),(a.getLngLat().lng!==i||a.getLngLat().lat!==l)&&a.setLngLat([i,l]),c&&!Fu(a.getOffset(),c)&&a.setOffset(c),a.isDraggable()!==u&&a.setDraggable(u),a.getRotation()!==h&&a.setRotation(h),a.getRotationAlignment()!==x&&a.setRotationAlignment(x),a.getPitchAlignment()!==_&&a.setPitchAlignment(_),a.getPopup()!==m&&a.setPopup(m),Ps.createPortal(t.children,a.getElement())}const Qu=p.memo(p.forwardRef(Ju));function qn(t){return new Set(t?t.trim().split(/\s+/):[])}function em(t,e){const{map:s,mapLib:n}=p.useContext(Qt),r=p.useMemo(()=>document.createElement("div"),[]),a=p.useRef({props:t});a.current.props=t;const i=p.useMemo(()=>{const l=D({},t),c=new n.Popup(l);return c.setLngLat([t.longitude,t.latitude]),c.once("open",d=>{var u,m;(m=(u=a.current.props).onOpen)===null||m===void 0||m.call(u,d)}),c},[]);if(p.useEffect(()=>{const l=c=>{var d,u;(u=(d=a.current.props).onClose)===null||u===void 0||u.call(d,c)};return i.on("close",l),i.setDOMContent(r).addTo(s.getMap()),()=>{i.off("close",l),i.isOpen()&&i.remove()}},[]),p.useEffect(()=>{et(i.getElement(),t.style)},[t.style]),p.useImperativeHandle(e,()=>i,[]),i.isOpen()&&((i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!Fe(i.options.offset,t.offset)&&i.setOffset(t.offset),(i.options.anchor!==t.anchor||i.options.maxWidth!==t.maxWidth)&&(i.options.anchor=t.anchor,i.setMaxWidth(t.maxWidth)),i.options.className!==t.className)){const l=qn(i.options.className),c=qn(t.className);for(const d of l)c.has(d)||i.removeClassName(d);for(const d of c)l.has(d)||i.addClassName(d);i.options.className=t.className}return Ps.createPortal(t.children,r)}p.memo(p.forwardRef(em));function ct(t,e,s,n){const r=p.useContext(Qt),a=p.useMemo(()=>t(r),[]);return p.useEffect(()=>{const i=e,l=typeof e=="function"?e:null,{map:c}=r;return c.hasControl(a)||c.addControl(a,i==null?void 0:i.position),()=>{l&&l(r),c.hasControl(a)&&c.removeControl(a)}},[]),a}function tm(t){const e=ct(({mapLib:s})=>new s.AttributionControl(t),{position:t.position});return p.useEffect(()=>{et(e._container,t.style)},[t.style]),null}p.memo(tm);function sm(t){const e=ct(({mapLib:s})=>new s.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return p.useEffect(()=>{et(e._controlContainer,t.style)},[t.style]),null}p.memo(sm);function nm(t,e){const s=p.useRef({props:t}),n=ct(({mapLib:r})=>{const a=new r.GeolocateControl(t),i=a._setupUI;return a._setupUI=l=>{a._container.hasChildNodes()||i(l)},a.on("geolocate",l=>{var c,d;(d=(c=s.current.props).onGeolocate)===null||d===void 0||d.call(c,l)}),a.on("error",l=>{var c,d;(d=(c=s.current.props).onError)===null||d===void 0||d.call(c,l)}),a.on("outofmaxbounds",l=>{var c,d;(d=(c=s.current.props).onOutOfMaxBounds)===null||d===void 0||d.call(c,l)}),a.on("trackuserlocationstart",l=>{var c,d;(d=(c=s.current.props).onTrackUserLocationStart)===null||d===void 0||d.call(c,l)}),a.on("trackuserlocationend",l=>{var c,d;(d=(c=s.current.props).onTrackUserLocationEnd)===null||d===void 0||d.call(c,l)}),a},{position:t.position});return s.current.props=t,p.useImperativeHandle(e,()=>n,[]),p.useEffect(()=>{et(n._container,t.style)},[t.style]),null}p.memo(p.forwardRef(nm));function om(t){const e=ct(({mapLib:s})=>new s.NavigationControl(t),{position:t.position});return p.useEffect(()=>{et(e._container,t.style)},[t.style]),null}const rm=p.memo(om);function am(t){const e=ct(({mapLib:a})=>new a.ScaleControl(t),{position:t.position}),s=p.useRef(t),n=s.current;s.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==n.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==n.unit&&e.setUnit(t.unit),p.useEffect(()=>{et(e._container,r)},[r]),null}p.memo(am);const im=Z(()=>import("./m82uim4b34dlt07y.js").then(t=>t.m),__vite__mapDeps([24,1])),lm=p.forwardRef(function(e,s){return Yu(e,s,im)}),cm=Qu,dm=rm,um=X(()=>Z(()=>import("./ls5w4xhmfxey8hbl.js"),__vite__mapDeps([25,1])),{loading:t=>Q(t)}),pr=X(()=>Z(()=>import("./mub8z62y3ne5qedg.js"),__vite__mapDeps([26,1])),{loading:t=>Q(t)}),mm=X(()=>Z(()=>import("./uulovtkdggk971z9.js"),__vite__mapDeps([27,1])),{loading:t=>Q(t)}),fm=X(()=>Z(()=>import("./pctpk2nmf382irxh.js"),__vite__mapDeps([28,1])),{loading:t=>Q(t)}),hm=X(()=>Z(()=>import("./kux43ylsu8hzp3nl.js"),__vite__mapDeps([29,1])),{loading:t=>Q(t)}),pm=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zq),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),gm=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zv),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function es({business:t,showHourDetail:e}){const s=le();if(t.is_closed_permanently)return o.jsx("span",{className:"text-red-600",children:o.jsx(H,{id:"businessMetadata.closedPermanently",defaultMessage:"Closed Permanently"})},"closed_permanently");const n=t.next_open_hour,r=t.is_open!==void 0&&t.is_open!=null?t.is_open?o.jsx("span",{className:"text-green-600",children:o.jsx(H,{id:"businessMetadata.openHourDetail",defaultMessage:"Open"})},"open"):o.jsx("span",{children:o.jsx(H,{id:"businessMetadata.closedStatus",defaultMessage:"Closed"})},"closed"):null;if(!e||!n)return r;const a=n.day===new Date().getDay(),i=Ts(s,t.is_open?n.end:n.start),l=a?s.formatMessage({id:"Adun59",defaultMessage:"{openClosedText} until {time}"},{openClosedText:r,time:i}):s.formatMessage({id:"tMworT",defaultMessage:"{openClosedText} until {day} {time}"},{openClosedText:r,day:xr(s,n.day),time:i});return o.jsx("div",{children:l&&o.jsx("span",{children:l})})}function xm({business:t,isLoading:e=!1,mapUrl:s,showTitle:n=!1,showPrice:r=!0,showHourDetail:a=!0,showActionButtons:i=!0,showActionButtonsIcons:l=!1,showExtendedDetails:c=!1,trackContentReferenceEvent:d,topOffset:u=0}){const m=!(a&&t.next_open_hour)||t.is_closed_permanently;return o.jsxs("div",{className:I("text-token-text-primary bg-token-bg-primary mb-4 max-w-md rounded-md",e&&"pointer-events-none animate-pulse opacity-80",u&&"mt-[".concat(u,"px]")),children:[n&&t.name&&o.jsx("h2",{className:"mb-0! leading-tight",children:t.name}),o.jsx("div",{className:"leaading-tight",children:o.jsx(gr,{business:t,showPrice:r,showHours:m})}),!m&&!c&&o.jsx("div",{className:"leading-tight",children:o.jsx(es,{business:t,showHourDetail:!0})}),i&&o.jsx(bm,{business:t,trackContentReferenceEvent:d,mapUrl:s,showActionButtonsIcons:l}),c&&!m&&o.jsx(_m,{business:t})]})}function gr(t){"use forget";const e=he.c(15),{business:s,showPrice:n,showHours:r}=t,a=n===void 0?!0:n,i=r===void 0?!0:r,l=s.categories&&s.categories.length>0?s.categories[0]:"";let c;e[0]!==s.rating?(c=s.rating?o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(um,{className:"mt-0.25 h-3.5 w-3.5"}),s.rating.toFixed(1)]},"rating"):null,e[0]=s.rating,e[1]=c):c=e[1];let d;e[2]!==l?(d=l?o.jsx("span",{children:o.jsx(H,{id:"businessMetadata.category",defaultMessage:"{category}",values:{category:l}})},"category"):null,e[2]=l,e[3]=d):d=e[3];let u;e[4]!==s.price_str||e[5]!==a?(u=a&&s.price_str?o.jsx("span",{children:s.price_str},"price"):null,e[4]=s.price_str,e[5]=a,e[6]=u):u=e[6];let m;e[7]!==s||e[8]!==i?(m=i&&s.is_open!=null&&o.jsx(es,{business:s,showHourDetail:!1}),e[7]=s,e[8]=i,e[9]=m):m=e[9];let h;return e[10]!==c||e[11]!==d||e[12]!==u||e[13]!==m?(h=o.jsx("div",{className:"flex flex-wrap items-center font-normal",children:[c,d,u,m].filter(Boolean).map(ym)}),e[10]=c,e[11]=d,e[12]=u,e[13]=m,e[14]=h):h=e[14],h}function ym(t,e){return o.jsxs(xo.Fragment,{children:[e>0&&o.jsx("span",{className:"mx-1",children:"•"}),t]},e)}function bm({business:t,trackContentReferenceEvent:e,mapUrl:s,showActionButtonsIcons:n}){const r=p.useRef({directions:null,website:null,phone:null});p.useEffect(()=>{r.current={directions:null,website:null,phone:null}},[t.id]);const a=p.useMemo(()=>({section:"entity_metadata",section_location:"response",entity_type:"local_business",business_id:t.id,provider:t.provider}),[t.id,t.provider]),i=p.useCallback((l,c,d)=>{if(!e)return;const u=U(D({},a),{cta_type:l,url:d,link_type:"button",action:c});e("link_action",null,"entity_metadata",u),c==="show"?e("Entity Metadata Content Reference Shown","entity_metadata_content_reference_shown","entity_metadata",u):c==="click"&&e("Entity Metadata Content Reference Clicked","entity_metadata_content_reference_clicked","entity_metadata",u)},[a,e]);return p.useEffect(()=>{if(e&&(s&&r.current.directions!==s&&(i("directions","show",s),r.current.directions=s),t.website_url&&r.current.website!==t.website_url&&(i("website","show",t.website_url),r.current.website=t.website_url),t.phone)){const l="tel:".concat(t.phone);r.current.phone!==l&&(i("phone","show",l),r.current.phone=l)}},[t.phone,t.website_url,s,e,i]),o.jsxs("div",{className:"justify-left mt-3 flex w-full flex-wrap gap-2",children:[s&&o.jsx(os,{type:"button",className:"btn btn-primary btn-small relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{i("directions","click",s),window.open(s,"_blank","noopener,noreferrer")},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(mm,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.directions",defaultMessage:"Directions"})]},"rating")}),t.website_url&&o.jsx(os,{type:"button",className:"btn btn-secondary btn-small text-token-text-primary relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{const l=t.website_url;l&&(i("website","click",l),window.open(l,"_blank","noopener,noreferrer"))},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(pm,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.website",defaultMessage:"Website"})]},"rating")}),t.phone&&o.jsx(os,{type:"button",className:"btn btn-secondary btn-small text-token-text-primary relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{const l="tel:".concat(t.phone);i("phone","click",l),window.location.href=l},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(pr,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.call",defaultMessage:"Call"})]},"rating")})]})}function _m({business:t}){var c;const e=le(),[s,n]=p.useState(!1),r=t.hours&&t.hours.length>0||t.next_open_hour||t.is_open!=null||t.is_closed_permanently,a=t.hours?vm(t.hours):[],i=a.length>0,l=t.phone?(c=Wl(t.phone))==null?void 0:c.formatNational():null;return o.jsx("div",{className:"mt-3",children:o.jsxs("div",{className:"divide-token-border-light divide-y",children:[r&&o.jsxs(o.Fragment,{children:[o.jsx(fs,{icon:o.jsx(hm,{className:"h-6 w-6"}),value:o.jsx(es,{business:t,showHourDetail:!0}),isExpandable:!0,isExpanded:s,onClick:()=>n(d=>i&&!d)}),o.jsx(js,{initial:!1,children:s&&i&&o.jsx(at.div,{className:"divide-token-border-light divide-y overflow-hidden select-none",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"tween",duration:.2,ease:"easeInOut"},children:a.map(d=>o.jsxs("div",{className:"flex min-h-[40px] items-center gap-2 py-2 text-sm",children:[o.jsx("div",{className:"w-[125px]",children:xr(e,d.day,"long")}),o.jsx("div",{children:d.isClosed?o.jsx(H,{id:"businessMetadata.closed",defaultMessage:"Closed"}):o.jsx(o.Fragment,{children:d.times.map((u,m)=>o.jsx("div",{children:"".concat(Ts(e,u.start)," - ").concat(Ts(e,u.end))},m))})})]},d.day))},"hours-details")})]}),t.address&&o.jsx(fs,{icon:o.jsx(fm,{className:"h-6 w-6"}),value:t.address}),l&&o.jsx(fs,{icon:o.jsx(pr,{className:"h-5 w-5"}),value:l})]})})}function fs({icon:t,value:e,onClick:s,isExpandable:n=!1,isExpanded:r=!1}){return o.jsxs("div",{className:I("flex min-h-[44px] items-center gap-4 py-2",s&&"cursor-pointer"),onClick:s,children:[o.jsx("div",{className:"flex h-6 w-6 items-center justify-center",children:t}),o.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),n&&o.jsx("button",{type:"button",className:I("text-token-text-secondary p-1 transition-all",r&&"rotate-180"),children:o.jsx(gm,{className:"h-5 w-5"})})]})}function vm(t){var n;const e=[1,2,3,4,5,6,0];let s=[];if(Array.isArray(t)&&t.length>0){const r=new Map;for(const a of t){const i=(n=r.get(a.day))!=null?n:[];i.push({start:a.start,end:a.end}),r.set(a.day,i)}s=e.map(a=>{var l;const i=(l=r.get(a))!=null?l:[];return i.sort((c,d)=>c.start.localeCompare(d.start)),{day:a,times:i,isClosed:i.length===0}})}return s}function Ts(t,e){const s=e.slice(0,2),n=e.slice(2,4),r=new Date(0,0,0,parseInt(s,10),parseInt(n,10));return t.formatTime(r,{hour:"numeric",minute:"2-digit"})}function xr(t,e,s="short"){return t.formatDate(new Date(0,0,e),{weekday:s})}const wm="pk.eyJ1Ijoib2FpLWRhdGEiLCJhIjoiY20yYzRzZmFtMGNqNjJscHo2dThqdnkwNCJ9.rTosfWNn9lUu4slvYfMzHg",jm=X(()=>Z(()=>import("./ls5w4xhmfxey8hbl.js"),__vite__mapDeps([25,1])),{loading:t=>Q(t)}),km=X(()=>Z(()=>import("./iqak4d8n645iefiy.js"),__vite__mapDeps([30,1])),{loading:t=>Q(t)}),Cm=X(()=>Z(()=>import("./hqbshwkn4xaba14o.js"),__vite__mapDeps([31,1])),{loading:t=>Q(t)}),Sm=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zw),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),Nm=X(()=>Z(()=>import("./czfk2xng6iz6p6m1.js"),__vite__mapDeps([32,1])),{loading:t=>Q(t)}),Gn=50,Zn=20,Xn=20,Yn=20,Mm=400;function Em(t){"use forget";const e=he.c(56),{contentReference:s,clientThreadId:n,messageId:r,trackContentReferenceEvent:a}=t,i=le(),l=xe();let c;e[0]!==l?(c=Se(l,"1950533395"),e[0]=l,e[1]=c):c=e[1];const d=c,u=s.entities,m=p.useRef(!0),h=p.useRef(null),x=p.useRef(null);let _;e[2]===Symbol.for("react.memo_cache_sentinel")?(_={longitude:0,latitude:0,zoom:12},e[2]=_):_=e[2];const v=_,w=p.useRef(v);let j;e[3]===Symbol.for("react.memo_cache_sentinel")?(j=U(D({},v),{pitch:0,bearing:0}),e[3]=j):j=e[3];const[C,f]=p.useState(j),[y,k]=p.useState(-1),S=p.useRef(y);let N;e[4]===Symbol.for("react.memo_cache_sentinel")?(N=ne=>{S.current=ne,k(ne)},e[4]=N):N=e[4];const E=N,$=!Mo(),[P,b]=p.useState(!1),F=p.useRef(!1);let L,T;e[5]!==a?(L=()=>{F.current||(a("Search Content Reference Shown","search_content_reference_shown","map"),F.current=!0)},T=[a],e[5]=a,e[6]=L,e[7]=T):(L=e[6],T=e[7]),p.useEffect(L,T);let M,z;e[8]===Symbol.for("react.memo_cache_sentinel")?(M=()=>{if(!h.current)return;const ne=_a(()=>{var ae;(ae=x.current)==null||ae.resize()},100),me=new ResizeObserver(ne);return me.observe(h.current),()=>{me.disconnect()}},z=[],e[8]=M,e[9]=z):(M=e[8],z=e[9]),p.useEffect(M,z);let G;e[10]===Symbol.for("react.memo_cache_sentinel")?(G=new Set,e[10]=G):G=e[10];const[B,K]=p.useState(G),te=p.useRef(-1),[A,g]=p.useState(!1);let O;e[11]!==u||e[12]!==A||e[13]!==C.zoom?(O=()=>{var me,ae,pe;if(!x.current||!A)return;const ne=Im;if(te.current==-1||te.current!==C.zoom){const ce=[];for(const _e of u){const we=(me=x.current)==null?void 0:me.project([_e.longitude,_e.latitude]);if(!we)return;const je=we.x-30,Me=we.y,se=(ae=_e.entity.rating)!=null?ae:0,q=(pe=_e.entity.is_open)!=null?pe:!1;ce.push({id:_e.id,x:je,y:Me,w:60,h:30,rating:se,openNow:q})}ce.sort(Am);const ve=new Set,Ne=new Map(ce.map(Pm));for(const _e of ce){let we=!1;for(const je of ve){const Me=Ne.get(je);if(Me&&ne(_e,Me)){we=!0;break}}we||ve.add(_e.id)}K(_e=>_e.size===ve.size&&[..._e].every(we=>ve.has(we))?_e:ve)}te.current=C.zoom},e[11]=u,e[12]=A,e[13]=C.zoom,e[14]=O):O=e[14];let R;e[15]!==u||e[16]!==A||e[17]!==C.zoom||e[18]!==B?(R=[C.zoom,B,A,u],e[15]=u,e[16]=A,e[17]=C.zoom,e[18]=B,e[19]=R):R=e[19],p.useEffect(O,R);let W,V;e[20]!==u||e[21]!==y?(W=()=>{const ne=function(){var _e;const pe=function(je,Me){const se=x.current;if(!se)return!1;const{width:q,height:fe}=se.getContainer().getBoundingClientRect(),ge=se.unproject([Zn,Gn]),ke=se.unproject([q-Xn,fe-Yn]);return He(je,5)>=He(ke.lat,5)&&He(je,5)<=He(ge.lat,5)&&He(Me,5)>=He(ge.lng,5)&&He(Me,5)<=He(ke.lng,5)},ce=Tu(u.filter((we,je)=>m.current||y===-1||je===y).map($m)),ve=$u(ce),Ne=Au(ce);if(h.current){const we=h.current.clientWidth,je=h.current.clientHeight,Me=new Dt({width:we,height:je,longitude:Ne.geometry.coordinates[0],latitude:Ne.geometry.coordinates[1]}),{zoom:se,latitude:q,longitude:fe}=Me.fitBounds([[ve[0],ve[1]],[ve[2],ve[3]]],{maxZoom:13.5,padding:{top:Gn,left:Zn,right:Xn,bottom:Yn}});m.current?(f(ge=>U(D({},ge),{zoom:se,latitude:q,longitude:fe})),w.current={longitude:fe,latitude:q,zoom:se},m.current=!1):pe(q,fe)||(_e=x.current)==null||_e.flyTo({center:[fe,q]})}};if(u.length===0)return;if(m.current){ne();return}if(y===-1)return;const me=setTimeout(ne,200);return()=>clearTimeout(me)},V=[u,y],e[20]=u,e[21]=y,e[22]=W,e[23]=V):(W=e[22],V=e[23]),p.useEffect(W,V);const{openThreadSidebar:Y}=_t(),{resetSidebarHistory:J}=Wo(),de=Vs();let oe;e[24]!==n||e[25]!==s.start_idx||e[26]!==de||e[27]!==r||e[28]!==Y||e[29]!==J?(oe=(ne,me)=>{E(ne),n&&(de||J(),Y({type:"entity",debugThreadId:void 0,messageId:r,contentReferenceStartIndex:s.start_idx,query:me.name,category:"local_business",extraParams:me.entity.location?{location:me.entity.location}:void 0}))},e[24]=n,e[25]=s.start_idx,e[26]=de,e[27]=r,e[28]=Y,e[29]=J,e[30]=oe):oe=e[30];const ie=oe,ee=Xt();let ye;if(e[31]!==u||e[32]!==ee||e[33]!==d||e[34]!==ie||e[35]!==y||e[36]!==a||e[37]!==B){let ne;e[39]!==y?(ne=(ae,pe)=>ae.idx===y?1:pe.idx===y?-1:ae.idx-pe.idx,e[39]=y,e[40]=ne):ne=e[40];let me;e[41]!==ee||e[42]!==d||e[43]!==ie||e[44]!==y||e[45]!==a||e[46]!==B?(me=ae=>{const{business:pe,idx:ce}=ae,ve=ce===y;return o.jsx(cm,{longitude:pe.longitude,latitude:pe.latitude,anchor:"bottom",children:o.jsx(Ls,{label:o.jsx(Om,{business:pe.entity,idx:ce,trackContentReferenceEvent:a,onOpenEntity:()=>ie(ce,pe),enableSidebarNavigation:d}),onOpenChange:Ne=>E(Ne?ce:-1),delayDuration:150,theme:ee?"default":"white",customPaddingClassName:"bg-clip-padding",customBorderClassName:"border-token-border-default border",contentClassName:"animate-show rounded-[20px]!",side:"top",sideOffset:10,wide:!0,interactive:!0,children:o.jsxs("div",{className:"relative",children:[o.jsx(Lm,{business:pe,isSelected:ve}),o.jsx("div",{className:"absolute start-1/2 top-full -translate-x-1/2 font-bold text-nowrap text-gray-800 [text-shadow:_-0.8px_-0.8px_0_#fff,_0.8px_-0.8px_0_#fff,_-0.8px_0.8px_0_#fff,_0.8px_0.8px_0_#fff]",style:{opacity:B.has(pe.id)?1:0},children:pe.name}),o.jsx("div",{className:I("absolute inset-0 rounded-xl",d&&"cursor-pointer"),onClick:d?Ne=>{Ne.preventDefault(),E(ce),ie(ce,pe)}:void 0})]})},ce)},ce)},e[41]=ee,e[42]=d,e[43]=ie,e[44]=y,e[45]=a,e[46]=B,e[47]=me):me=e[47],ye=u.map(Tm).sort(ne).map(me),e[31]=u,e[32]=ee,e[33]=d,e[34]=ie,e[35]=y,e[36]=a,e[37]=B,e[38]=ye}else ye=e[38];const ue=ye;let re;e[48]!==i||e[49]!==$||e[50]!==ue||e[51]!==P||e[52]!==C?(re=!$&&o.jsx("div",{className:"bg-token-bg-primary pt-4",children:o.jsxs("div",{style:{height:Mm},className:"bg-token-bg-primary relative w-full",ref:h,children:[o.jsx("div",{className:"relative h-full w-full overflow-hidden rounded-xl",children:o.jsxs(lm,U(D({},C),{mapboxAccessToken:wm,mapStyle:"mapbox://styles/oai-data/cmhawgfb0000n01sd7bcybf4f",attributionControl:!1,renderWorldCopies:!1,cooperativeGestures:!0,onMove:ne=>{f(ne.viewState),Rm(w.current,ne)&&b(!0)},locale:{"ScrollZoomBlocker.CtrlMessage":i.formatMessage({id:"1aF2nO",defaultMessage:"Hold Ctrl to zoom"}),"ScrollZoomBlocker.CmdMessage":i.formatMessage({id:"8R2Dga",defaultMessage:"Hold ⌘ to zoom"})},ref:x,keyboard:!1,onLoad:()=>{g(!0)},children:[o.jsx(dm,{position:"top-right",showCompass:!1,style:{borderRadius:9999,overflow:"hidden"}}),o.jsx(Dm,{show:P,onClick:()=>{f(U(D({},w.current),{pitch:0,bearing:0})),b(!1)}}),ue]}))}),o.jsx("div",{className:"absolute start-3 top-3",children:o.jsx(Wm,{})})]})}),e[48]=i,e[49]=$,e[50]=ue,e[51]=P,e[52]=C,e[53]=re):re=e[53];let be;return e[54]!==re?(be=o.jsx(va,{children:o.jsx("div",{className:"not-prose","data-testid":"businesses-map-widget",children:re})}),e[54]=re,e[55]=be):be=e[55],be}function Tm(t,e){return{business:t,idx:e}}function $m(t){return mr([t.longitude,t.latitude])}function Pm(t){return[t.id,t]}function Am(t,e){const s=t.openNow,n=e.openNow;return s&&!n?-1:!s&&n?1:e.rating-t.rating}function Im(t,e){return!(t.x+t.w<=e.x||e.x+e.w<=t.x||t.y+t.h<=e.y||e.y+e.h<=t.y)}const Lm=({business:t,isSelected:e})=>{var s;return o.jsx("div",{className:I("border-token-border-default shadow-elevation-03 flex h-7 min-w-7 items-center justify-center rounded-full border bg-clip-padding text-xs font-medium",e?"bg-token-interactive-bg-primary-press text-token-interactive-label-primary-press":"bg-token-bg-primary"),children:t.entity.rating?o.jsxs("div",{className:"flex items-center gap-0.75 px-2.5",children:[o.jsx("span",{children:(s=t.entity.rating)==null?void 0:s.toFixed(1)}),o.jsx(jm,{className:"h-3 w-3"})]}):o.jsx(Nm,{className:"h-3 w-3"})})},Rm=(t,e)=>{if(t){const s=Math.abs(e.viewState.zoom-t.zoom),n=Math.abs(e.viewState.latitude-t.latitude),r=Math.abs(e.viewState.longitude-t.longitude);return s>.05||n>5e-4||r>5e-4}return!1};function Dm(t){"use forget";const e=he.c(6),{show:s,onClick:n}=t,[r,a]=p.useState(null);let i,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=()=>({onAdd(){const u=document.createElement("div");return u.className="mapboxgl-ctrl mapboxgl-ctrl-group",a(u),u},onRemove(){a(null)}}),l={position:"top-right"},e[0]=i,e[1]=l):(i=e[0],l=e[1]),ct(i,l);let c;return e[2]!==r||e[3]!==n||e[4]!==s?(c=r&&s?Ps.createPortal(o.jsx(Fm,{onClick:n}),r):null,e[2]=r,e[3]=n,e[4]=s,e[5]=c):c=e[5],c}function Fm(t){"use forget";const e=he.c(8),{onClick:s}=t,n=le();let r;e[0]!==s?(r=c=>{c.preventDefault(),s()},e[0]=s,e[1]=r):r=e[1];let a;e[2]!==n?(a=n.formatMessage({id:"dUWlu0",defaultMessage:"Reset view"}),e[2]=n,e[3]=a):a=e[3];let i;e[4]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx(km,{className:"icon h-[18px]! w-[18px]!"}),e[4]=i):i=e[4];let l;return e[5]!==r||e[6]!==a?(l=o.jsx(Pe,{type:"button",color:"secondary",size:"small",className:"flex h-[30px] items-center justify-center bg-clip-padding text-black",contentWrapperClassName:"font-semibold",onClick:r,title:a,children:i}),e[5]=r,e[6]=a,e[7]=l):l=e[7],l}function Om({business:t,idx:e,trackContentReferenceEvent:s,onOpenEntity:n,enableSidebarNavigation:r}){var u;const a=!Mo(),i={section:"map",section_location:"response",section_index:e},l="https://www.google.com/maps/dir/?api=1&destination=".concat(encodeURIComponent([t.name,t.address].join(",")));t.address&&s("link_action",null,"map",U(D({},i),{url:l,link_type:"button",action:"show"})),t.website_url&&s("link_action",null,"map",U(D({},i),{url:t.website_url,link_type:"button",action:"show"}));function c(){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"text-token-text-primary mt-auto flex min-h-[30px] w-full min-w-0 flex-wrap justify-center gap-2 text-base",children:[t.address&&o.jsx(hs,{to:l,onClick:()=>{s("link_action",null,"map",U(D({},i),{url:l,link_type:"button",action:"click"}))},children:o.jsx(H,{id:"+a2f/C",defaultMessage:"Directions"})}),t.website_url&&o.jsx(hs,{to:t.website_url,onClick:()=>{s("link_action",null,"map",U(D({},i),{url:t.website_url,link_type:"button",action:"click"}))},children:o.jsx(H,{id:"r0oqXM",defaultMessage:"Website"})}),t.phone&&o.jsx(hs,{to:"tel:"+t.phone,children:o.jsx(H,{id:"B/an6M",defaultMessage:"Call"})})]})})}const d=(u=t.image_urls)==null?void 0:u[0];return o.jsx(at.div,{initial:{x:"0%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}},animate:{x:"0%",opacity:1,pointerEvents:"auto",transition:{duration:.15,ease:"easeOut"}},children:o.jsxs("div",{className:I("bg-token-main-surface-primary relative text-start font-normal"),children:[o.jsxs("div",{className:"flex flex-col gap-2 p-3",children:[o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:I("h-23 w-23 shrink-0 overflow-hidden rounded-lg",r&&"cursor-pointer"),onClick:r?m=>{m.preventDefault(),n==null||n()}:void 0,children:d?o.jsx("img",{className:"h-full w-full object-cover",src:d!=null?d:void 0,alt:t.name}):o.jsx("div",{className:"h-full w-full bg-gray-100"})}),o.jsxs("div",{className:"flex min-w-0 flex-1 flex-col justify-center gap-0.5",children:[r?o.jsx("div",{className:"hover:entity-accent line-clamp-2 w-full cursor-pointer text-[17px] font-medium",onClick:m=>{m.preventDefault(),n==null||n()},title:t.name,children:t.name}):o.jsx("div",{title:t.name,className:"text-token-text-primary line-clamp-2 w-full text-[17px] font-medium",children:t.name}),o.jsx(zm,{business:t})]})]}),!a&&o.jsx("div",{className:"mt-1",children:c()})]}),a&&c()]})})}function hs(t){"use forget";const e=he.c(4),{to:s,onClick:n,children:r}=t;let a;return e[0]!==r||e[1]!==n||e[2]!==s?(a=o.jsx(Pe,{onClick:n,as:"link",to:s,openNewTab:!0,rel:"noreferrer",color:"secondary",size:"small",className:"h-[30px] min-w-25 flex-1 rounded-full border",contentWrapperClassName:"text-token-text-primary font-semibold",children:r}),e[0]=r,e[1]=n,e[2]=s,e[3]=a):a=e[3],a}function zm({business:t}){return o.jsxs("div",{className:"text-token-text-primary flex flex-col gap-0.5 text-sm",children:[o.jsx(gr,{business:t,showPrice:!0,showHours:!1}),o.jsx(es,{business:t,showHourDetail:!0})]})}function Wm(){const[t,e]=p.useState(!1),s=()=>e(r=>!r),n=t?Sm:Cm;return o.jsxs("div",{className:I("text-token-text-primary flex h-5 items-center justify-start overflow-hidden rounded-full text-[10px] font-light whitespace-nowrap transition-all",t?"w-full bg-white":"w-5 bg-white/60 backdrop-blur-xl backdrop-filter hover:bg-white/70"),children:[o.jsx("button",{onClick:s,className:I("flex min-w-5 items-center justify-center transition-all"),children:o.jsx(n,{className:"icon-sm transition-colors"})}),o.jsxs("div",{className:"pe-2",children:["© ",o.jsx("a",{href:"https://www.mapbox.com/about/maps",target:"_blank",rel:"noreferrer",className:"text-[#2964aa]!",children:"Mapbox"})," ",o.jsx("a",{href:"https://www.mapbox.com/legal/end-user-terms",target:"_blank",rel:"noreferrer",className:"me-2 text-[#2964aa]!",children:o.jsx(H,{id:"u3dZJq",defaultMessage:"Terms"})}),"© ",o.jsx("a",{href:"http://www.openstreetmap.org/about",target:"_blank",rel:"noreferrer",className:"text-[#2964aa]!",children:"OpenStreetMap"})]})]})}const De={TTFP:"products.ttfp",TTLT:"products.ttlt",TTF_VISIBLE_CONTENT_TOKEN:"products.ttf_visible_content_token"},Xs={[De.TTFP]:new Set,[De.TTLT]:new Set,[De.TTF_VISIBLE_CONTENT_TOKEN]:new Set};function ps({profiler:t,messageId:e,metric:s,overrideDurationMs:n}){Xs[s].add(e);const r=gi();t.logTimingOnce(s,{context:{eval_preset:r.eval_preset},overrideDurationMs:n})}function gs({messageId:t,metric:e}){return Xs[e].has(t)}function yr(t){"use forget";const e=he.c(27),{clientThreadId:s,messageId:n,products:r}=t;let a;e[0]!==n?(a=y=>[Ye.getRequestId(y),Ye.isMessageTurnEnded(y,n)],e[0]=n,e[1]=a):a=e[1];const[i,l]=Vt(s,a);let c;e[2]!==s?(c={namespace:fi.ProductsCompletionRequest,clientThreadId:s},e[2]=s,e[3]=c):c=e[3];const{profiler:d,isRequestActive:u}=hi(c),m=u&&!l,h=pi(m);let x,_;e[4]!==m||e[5]!==n||e[6]!==r.length||e[7]!==d?(x=()=>{gs({messageId:n,metric:De.TTFP})||d&&m&&r.length>0&&ps({profiler:d,messageId:n,metric:De.TTFP})},_=[m,n,r.length,d],e[4]=m,e[5]=n,e[6]=r.length,e[7]=d,e[8]=x,e[9]=_):(x=e[8],_=e[9]),p.useEffect(x,_);let v,w;e[10]!==m||e[11]!==n||e[12]!==h||e[13]!==d?(v=()=>{gs({messageId:n,metric:De.TTLT})||d&&h.current&&!m&&ps({profiler:d,messageId:n,metric:De.TTLT})},w=[n,h,m,d],e[10]=m,e[11]=n,e[12]=h,e[13]=d,e[14]=v,e[15]=w):(v=e[14],w=e[15]),p.useEffect(v,w);const j=xe();let C;e[16]!==j||e[17]!==n||e[18]!==d||e[19]!==i?(C=()=>{if(gs({messageId:n,metric:De.TTF_VISIBLE_CONTENT_TOKEN}))return;const y=i?wa(j,i):null;if(d&&y){const k=De.TTF_VISIBLE_CONTENT_TOKEN;Xs[k].add(n),ps({profiler:d,messageId:n,metric:k,overrideDurationMs:y.turnTracker.first_visible_content_token_lat})}},e[16]=j,e[17]=n,e[18]=d,e[19]=i,e[20]=C):C=e[20];let f;e[21]!==j||e[22]!==n||e[23]!==r.length||e[24]!==d||e[25]!==i?(f=[n,d,i,r.length,j],e[21]=j,e[22]=n,e[23]=r.length,e[24]=d,e[25]=i,e[26]=f):f=e[26],p.useEffect(C,f)}function Hm({contentReference:t,clientThreadId:e,messageId:s,turnIndex:n,trackContentReferenceEvent:r}){const a=p.useCallback(()=>r("Search Content Reference Shown","search_content_reference_shown","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[r,t.start_idx,t.product.id]),i=p.useCallback(()=>r("Search Content Reference Clicked","search_content_reference_clicked","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[r,t.start_idx,t.product.id]),l=t.product;p.useEffect(()=>a(),[a]),yr({clientThreadId:e,messageId:s,products:[l]});const{openThreadSidebar:c}=_t();return o.jsx("span",{className:"entity-underline hover:entity-accent inline cursor-pointer align-baseline",onClick:()=>{if(i(),l.offers||!l.url){if(!e)return;c({type:"product",messageId:s,turnIndex:n,contentReferenceStartIndex:t.start_idx,productIndex:0,productId:l.id,productUrl:l.url,interactionSource:"inline_link"})}else window.open(l.url,"_blank")},children:o.jsx("span",{className:"whitespace-normal",children:l.title})})}const Bm=X(()=>Z(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)}),Vm=X(()=>Z(()=>import("./9paxni9f8n7suc5d.js"),__vite__mapDeps([23,1])),{loading:t=>Q(t)}),Um=X(()=>Z(()=>import("./d9bf8tg6o5lnic5i.js"),__vite__mapDeps([33,1])),{loading:t=>Q(t)});function br({items:t,targetItemCount:e,onCardRender:s,onCardShown:n,onCardClicked:r,onReplyClicked:a,allowFullWidth:i=!1,cardClassName:l,showGradient:c=!0,arrowClassName:d}){const u=p.useRef(null),[m,h]=p.useState(null),x=p.useRef(null),_=()=>{x.current=setTimeout(()=>{h(null),x.current=null},200)},v=()=>{x.current&&(clearTimeout(x.current),x.current=null)},w=p.useRef(null),[j,C]=p.useState({left:0,top:0}),f=8;p.useEffect(()=>{const E=u.current,$=w.current;if(!a||!m||!E||!$)return;const P=()=>{const b=m.card.getBoundingClientRect(),F=E.getBoundingClientRect(),L=$.getBoundingClientRect(),T=b.bottom-F.top+f;var M=b.left-F.left;M=Math.max(0,M),M=Math.min(M,F.width-L.width),C({left:M,top:T})};return P(),E.addEventListener("scroll",P),()=>E.removeEventListener("scroll",P)},[m,t,a]);const y=bt(),k=y?2:4;if(e===void 0)e=t.length;else if(!e&&t.length<k)return null;const S=(e!=null?e:t.length)>=k,N=S&&y;return o.jsxs("div",{className:"relative",children:[o.jsx("div",{ref:u,className:I("flex flex-row gap-4 py-2",N&&"mx-[-1rem] px-[1rem]",S&&"no-scrollbar snap-x snap-proximity scroll-ps-4 overflow-x-scroll scroll-smooth"),children:t.map((E,$)=>o.jsx("div",{className:I(S||!i?"thread-lg:w-61 w-50 shrink-0 snap-start":"min-w-0 flex-1"),children:o.jsx(qm,{cardClassName:l,onShown:()=>n(E,$),onClick:()=>r(E,$),onHover:P=>{v(),P?h({card:P,item:E,index:$}):_()},children:s(E,!y&&e===1)})},$))}),S&&!N&&o.jsx(Gm,{scrollableRef:u,units:t.length,showGradient:c,arrowClassName:d}),a&&o.jsx("div",{ref:w,className:I("absolute z-10",m?"pointer-events-auto opacity-100":"pointer-events-none opacity-0","transition-[transform,opacity] duration-200"),style:{willChange:"opacity, transform",left:j.left,top:j.top,transform:m?"translateY(0)":"translateY(".concat(-f,"px)")},onMouseEnter:v,onMouseLeave:_,children:o.jsx(Pe,{className:I(m?"pointer-events-auto":"pointer-events-none","border-light bg-clip-padding px-4 py-2 shadow-md"),size:"small",color:"secondary",onClick:()=>m&&a(m.item,m.index),children:o.jsxs("div",{className:"flex flex-row items-center gap-1",children:[o.jsx(Um,{className:"icon-sm text-token-text-secondary"}),o.jsx(H,{id:"9TG7OR",defaultMessage:"Ask about this"})]})})})]})}function qm({onShown:t,onClick:e,onHover:s,children:n,cardClassName:r}){const a=p.useRef(null),i=p.useRef(t);return p.useEffect(()=>{i.current=t},[t]),p.useEffect(()=>{if(!a.current)return;const l=new IntersectionObserver(([c])=>c.isIntersecting&&i.current(),{threshold:.5});return l.observe(a.current),()=>l.disconnect()},[]),o.jsx("div",{ref:a,className:I("h-full w-full","bg-token-bg-primary cursor-pointer",r),onClick:e,onMouseEnter:()=>a.current&&s(a.current),onMouseLeave:()=>s(null),children:n})}function Gm({scrollableRef:t,units:e,showGradient:s,arrowClassName:n}){const[r,a]=p.useState({left:!1,right:!1}),[i,l]=p.useState(!1);p.useEffect(()=>{const d=t.current;if(!d)return;const u=()=>{const{scrollLeft:m,scrollWidth:h,clientWidth:x}=d,_=m/(h-x);a({left:_>0,right:_<1}),!i&&m>0&&l(!0)};return u(),d.addEventListener("scroll",u),()=>d.removeEventListener("scroll",u)},[t,e,i]);const c=d=>{if(!t.current)return;l(!0);const{clientWidth:u,scrollWidth:m}=t.current,h=m/e,x=Math.floor(u/h)*h;t.current.scrollBy({left:x*d,behavior:"smooth"})};return o.jsxs("div",{className:"pointer-events-none absolute start-0 top-0 flex h-full w-full flex-row",children:[o.jsx("div",{className:I("flex h-full w-9 items-center justify-start",i&&s&&"bg-linear-to-r from-(--bg-primary) to-transparent",r.left?"opacity-100":"opacity-0","transition-opacity duration-100"),children:o.jsx(Pe,{color:"secondary",size:"small",className:I("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[-50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",n),onClick:()=>c(-1),children:o.jsx(Vm,{className:"icon"})})}),o.jsx("div",{className:I("ms-auto flex h-full w-9 items-center justify-end",i&&s&&"bg-linear-to-l from-(--bg-primary) to-transparent",r.right?"opacity-100":"opacity-0","transition-opacity duration-200"),children:o.jsx(Pe,{color:"secondary",size:"small",className:I("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",n),onClick:()=>c(1),children:o.jsx(Bm,{className:"icon"})})})]})}const Ys=X(()=>Z(()=>import("./diw1uvps7iz4sxyn.js"),__vite__mapDeps([3,1])),{loading:t=>Q(t)}),Zm=X(()=>Z(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)});function Xm({contentReference:t,clientThreadId:e,messageId:s,turnIndex:n,analyticsMetadata:r}){const a=t.products,i=t.target_product_count;yr({clientThreadId:e,messageId:s,products:a});const{showDebugConversationTurns:l}=ja(),c=Vt(e,N=>{var P,b;const $=(b=(P=Ye.getNode(N,s).message.metadata)==null?void 0:P.content_references)==null?void 0:b.find(F=>F.type==="products");return t.start_idx===($==null?void 0:$.start_idx)}),d=xe(),u=Se(d,"3144771298"),m=We(d),h=Ve(()=>Zt(d)),x=Gt(d),_=Se(d,"2212894775"),v=Ho(r),w=p.useCallback((N,E)=>v("Search Content Reference Shown","search_content_reference_shown","products",{content_reference_start_index:t.start_idx,product_index:E,product_id:N.id,product_url:N.url}),[v,t.start_idx]),j=p.useCallback((N,E)=>v("Search Content Reference Clicked","search_content_reference_clicked","products",{content_reference_start_index:t.start_idx,product_index:E,product_id:N.id}),[v,t.start_idx]),C=xi(d),{openThreadSidebar:f}=_t(),y=(N,E)=>{if(e)if(j(N,E),N.offers){const $=bi(),P=$?C.rooms$().get($):null,b={type:"product",messageId:s,turnIndex:n,contentReferenceStartIndex:t.start_idx,productIndex:E,productId:N.id,productUrl:N.url,interactionSource:"carousel"};P!=null?C.hasAccess&&C.openThreadSidebar$(P,b):f(b)}else window.open(N.url,"_blank")},{setTargetedContent:k}=yi(),S=(N,E)=>{Tt.logEventWithStatsig("Product Targeted Reply Clicked","product_targeted_reply_clicked",U(D({},ka(r)),{content_reference_start_index:t.start_idx,product_index:(E+1).toString(),product_id:N.id})),k({type:"object",label:N.title,createNewCompletionParams:$=>{var b;const P=Ca(N.title);return U(D({},$),{promptMessage:_i($.promptMessage,{metadata:{targeted_reply:N.title,targeted_reply_label:N.title,targeted_reply_icon:"product_tag"}}),appendMessages:[...(b=$.appendMessages)!=null?b:[],P]})},onCreateCompletion:({serverThreadId:$,currentLeafId:P})=>{Tt.logEventWithStatsig("Targeted Reply Submitted","chatgpt_targeted_reply_submitted",{conversation_id:$,current_leaf_id:P,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(E+1).toString(),product_id:N.id})},onCleared:({serverThreadId:$,currentLeafId:P})=>{Tt.logEventWithStatsig("Targeted Reply Cleared","chatgpt_targeted_reply_cleared",{conversation_id:$,current_leaf_id:P,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(E+1).toString(),product_id:N.id})}})};if(t.inline_carousel&&a.length===1){const N=a[0];return o.jsx("div",{className:"flex flex-col","data-testid":"shopping-widget",children:o.jsx(Qm,{product:N,showDebug:l,onShown:()=>w(N,0),onClicked:()=>y(N,0)})})}return o.jsxs("div",{className:"flex flex-col","data-testid":"products-widget",children:[m&&!x?o.jsx("div",{className:I("relative mb-6",h?"-mx-[var(--thread-content-margin)]":"-mx-6"),children:o.jsx(Yt,{items:a,getItemKey:N=>N.id,onRenderItem:N=>o.jsx(Kn,{product:N,wide:!1,showDebug:l,isProductV2CardEnabled:_}),className:"min-h-36",itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)] thread-lg:w-61 w-50 shrink-0 border-none",arrowClassName:_?"translate-y-[-85%]!":"",onShown:w,onClick:y})}):o.jsx(br,{items:a,targetItemCount:i,onCardRender:(N,E)=>o.jsx(Kn,{product:N,wide:E,showDebug:l,isProductV2CardEnabled:_}),onCardShown:w,onCardClicked:y,onReplyClicked:_?void 0:S,arrowClassName:_?"translate-y-[-85%]":"",allowFullWidth:!0,showGradient:!_,cardClassName:I(_?"group":"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden")}),c&&u&&!_&&o.jsxs("div",{className:"text-token-text-tertiary flex text-xs hover:cursor-pointer hover:underline",onClick:()=>window.open("https://help.openai.com/en/articles/11128490","_blank"),children:[o.jsx(H,{id:"4Y5Zn5",defaultMessage:"ChatGPT chooses products independently. Learn more"}),o.jsx(Zm,{className:"icon -ms-0.5"})]}),!1]})}function Kn(t){"use forget";const e=he.c(5),{product:s,wide:n,showDebug:r,isProductV2CardEnabled:a}=t,i=r===void 0?!1:r;let l;return e[0]!==a||e[1]!==s||e[2]!==i||e[3]!==n?(l=a?o.jsx(Km,{product:s,wide:n,showDebug:i}):o.jsx(Ym,{product:s,wide:n,showDebug:i}),e[0]=a,e[1]=s,e[2]=i,e[3]=n,e[4]=l):l=e[4],l}function Ym({product:t,wide:e,showDebug:s=!1}){var l,c;const n=t.image_urls?t.image_urls[0]:void 0,[r,a]=p.useState("contain"),i=p.useRef(null);return o.jsxs("div",{className:I("flex",e?"flex-row":"flex-col"),children:[o.jsxs("div",{className:I("relative aspect-square",e?"w-1/3":"w-full","bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse"),children:[n?o.jsx("img",{ref:i,className:"absolute inset-0 m-0 h-full w-full mix-blend-darken object-".concat(r),src:n,alt:t.title,onLoad:()=>{if(!i.current)return;const{naturalWidth:d,naturalHeight:u}=i.current,m=d/u;a(Math.abs(m-1)<.25?"cover":"contain")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})}),t.featured_tag&&o.jsx("div",{className:"absolute start-3 end-3 bottom-3",children:o.jsxs("div",{className:"relative max-w-fit px-2 py-1",children:[o.jsx("div",{className:"absolute inset-0 rounded-full bg-white/60 backdrop-blur-xl"}),o.jsx("div",{className:"relative truncate text-xs font-semibold text-gray-950",children:t.featured_tag})]})})]}),o.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[o.jsx("div",{className:"line-clamp-2 leading-snug font-semibold text-ellipsis",children:t.title}),t.description&&o.jsx("div",{className:"line-clamp-3 pt-3 text-sm text-ellipsis",children:t.description}),o.jsx("div",{className:"flex-1"}),o.jsxs("div",{className:"flex flex-row items-end pt-3",children:[o.jsxs("div",{className:"flex flex-col overflow-hidden",children:[o.jsx("div",{className:"text-md leading-snug font-semibold",children:t.price}),o.jsx("div",{className:"text-token-text-secondary overflow-hidden pt-0.5 text-xs text-ellipsis whitespace-nowrap",children:t.merchants})]}),o.jsx("div",{className:"flex-1"}),t.num_reviews&&t.num_reviews>0&&o.jsxs("div",{className:"text-token-text-secondary flex w-fit flex-row gap-1 text-sm",children:[o.jsx(Ua,{rating:(l=t.rating)!=null?l:0/5}),((c=t.rating)!=null?c:0).toFixed(1)]})]}),!1]})]})}function Km({product:t,wide:e,showDebug:s=!1}){const n=t.image_urls?t.image_urls[0]:void 0,[r,a]=p.useState("contain"),[i,l]=p.useState("top"),c=p.useRef(null);return o.jsxs("div",{className:I("flex pb-2",e?"flex-row gap-3":"flex-col gap-2"),children:[o.jsx("div",{className:I("relative",e?"aspect-square w-1/4":"aspect-[13/16] w-full","overflow-clip rounded-xl bg-[#F3F3F3] dark:bg-[#F3F3F3]"),children:o.jsx(qo,{className:"mix-blend-darken",children:n?o.jsx("img",{ref:c,className:"absolute inset-0 m-0 h-full w-full object-".concat(r," object-").concat(i),src:n,alt:t.title,onLoad:()=>{if(!c.current)return;const{naturalWidth:d,naturalHeight:u}=c.current,m=d/u;a(Math.abs(m-1)<.4?"cover":"contain"),l(u>d?"top":"center")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})})})}),o.jsxs("div",{className:"flex flex-col gap-1 px-1",children:[o.jsx("div",{className:I("line-clamp-2 font-medium text-ellipsis",e?"text-base":"text-sm"),children:t.title}),o.jsxs("div",{className:"text-token-text-secondary flex flex-row gap-0.25 text-sm",children:[o.jsx("div",{children:t.price}),o.jsx("div",{className:"mx-0.5",children:"•"}),o.jsx("div",{className:"truncate",children:t.merchants})]}),!1]})]})}function Jm({className:t,imageUrl:e,productTitle:s,onClicked:n}){const[r,a]=p.useState("contain"),i=p.useRef(null);return o.jsx("div",{className:I(t,"hover:scale-[1.005]","dark:bg-token-text-inverted bg-token-bg-primary","cursor-pointer overflow-hidden rounded-xl shadow-inner transition-all duration-200","relative aspect-square max-h-60"),onClick:n,children:e?o.jsx("img",{ref:i,className:"m-0 h-full w-full overflow-hidden object-".concat(r," mix-blend-darken"),src:e,alt:s,onLoad:()=>{if(!i.current)return;const{naturalWidth:l,naturalHeight:c}=i.current,d=l/c;a(Math.abs(d-1)<.5?"cover":"contain")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})})})}function Qm({product:t,showDebug:e=!1,onShown:s,onClicked:n}){return p.useEffect(()=>{s()},[s]),o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex flex-row gap-2 py-2",children:t.image_urls&&t.image_urls.length>0&&t.image_urls.slice(0,3).map(r=>o.jsx(Jm,{imageUrl:r,productTitle:t.title,onClicked:n},r))}),!1]})}function ef({attribution:t,wordFadeType:e}){var a;const s=p.useContext(Ke),n=vi(s==null?void 0:s.message.id,t.attributable_index),r=wi();return o.jsx(nf,{isHighlighted:n,isDebugMode:r&&!1,content:(a=t.alt)!=null?a:"",attributableIndex:t.attributable_index,attributions:void 0,attributionsDebug:void 0,wordFadeType:e})}const tf=p.memo(Us);function sf({content:t,isHighlighted:e,isDebugMode:s,attributableIndex:n,attributions:r,attributionsDebug:a,wordFadeType:i}){const l=i==="indexed",c=Bo(),d=p.useMemo(()=>l?{handlers:{text:(h,x,_)=>{const v=[];for(const w of c(x.value))v.push({type:"element",tagName:"span",properties:{className:Vo.fadeIn},children:[{type:"text",value:w}]});return v}}}:void 0,[l,c]),u=p.useMemo(()=>({p:({children:h})=>o.jsx(o.Fragment,{children:h})}),[]),m=o.jsx(tf,{rehypePlugins:vs,remarkPlugins:_s,urlTransform:bs,remarkRehypeOptions:d,components:u,children:t});return o.jsx(of,{isHighlighted:e,children:m})}const nf=xo.memo(sf);function of({isHighlighted:t,className:e,children:s}){return o.jsx("span",{className:I("relative","-mx-px my-[-0.2rem] rounded px-px py-[0.2rem]",t&&"attribution-highlight-bg","transition-colors duration-100 ease-in-out",e),children:s})}function Jn(t,e){try{return BigInt(t).toLocaleString(e)}catch(s){const n=Number(t);return t.includes("e")||t.includes("E")?n.toExponential():n.toLocaleString(e,{maximumFractionDigits:6})}}function rf({data:t,trackContentReferenceEvent:e}){p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=Sa().locale;return t.expression&&t.result!=null?o.jsxs("div",{className:"no-scrollbar overflow-auto sm:overflow-hidden",children:[o.jsxs("div",{className:"pb-1 text-lg font-semibold",children:[t.prefix&&o.jsx("span",{children:t.prefix}),o.jsx("span",{children:Jn(t.result,s)}),t.suffix&&o.jsx("span",{children:t.suffix})]}),o.jsx("div",{className:"text-token-text-primary tracking-wide",children:"".concat(t.expression,"=").concat(Jn(t.result,s))})]}):null}const af=X(()=>Z(()=>import("./ns1vyo5kzmxgh5gj.js"),__vite__mapDeps([34,1])),{loading:t=>Q(t)});function _r({ref:t,onClick:e,onMouseEnter:s,onMouseLeave:n}){const r=le();return o.jsx("button",{ref:t,"aria-label":r.formatMessage({id:"citation.icon.label",defaultMessage:"Coding Citation"}),onClick:e,onMouseEnter:s,onMouseLeave:n,className:I("rounded-xl px-1","bg-token-interactive-bg-tertiary-press text-token-text-secondary hover:text-token-text-inverted hover:bg-token-interactive-bg-primary-selected"),children:o.jsx(af,{className:"icon-sm"})})}function lf({codeMessage:t,codeExecutionOutputMessage:e,onDismiss:s,FormattedText:n}){const r=le();return o.jsx(qe.Root,{isOpen:!0,onClose:s,testId:"modal-code-execution",children:o.jsx(qe.Overlay,{children:o.jsxs(qe.Content,{className:"flex max-h-[75vh] max-w-lg flex-col overflow-hidden",children:[o.jsx(qe.Header,{title:r.formatMessage(cf.title),type:"success",closeButton:o.jsx(Na,{onClick:s})}),o.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[o.jsx("div",{children:o.jsx(gl,{FormattedText:n,message:t,codeRendererClassName:"border-none rounded-none",removeTopBorderRadius:!0})}),o.jsx("div",{children:o.jsx(xl,{message:e})})]})]})})})}const cf=As({title:{id:"CodeExecutionOutputModal.title",defaultMessage:"Analysis"}});function df({displayInfo:t,FormattedText:e,trackContentReferenceEvent:s}){const[n,r]=p.useState(!1),a=le();return p.useEffect(()=>{s("Search Content Reference Shown","search_content_reference_shown",t.type)},[s,t.type]),o.jsxs(o.Fragment,{children:[o.jsx(Ls,{label:a.formatMessage(uf.viewAnalysis),side:"top",delayDuration:150,className:"align-middle",children:o.jsx(_r,{onClick:()=>r(!0)})}),n&&o.jsx(lf,{FormattedText:e,codeMessage:t.codeMessage,codeExecutionOutputMessage:t.codeExecutionOutputMessage,onDismiss:()=>r(!1)})]})}const uf=As({viewAnalysis:{id:"viewAnalysis",defaultMessage:"View analysis"}});function mf({contentReference:t,clientThreadId:e,turnIndex:s}){var x,_,v,w,j,C,f;const{toggleThreadSidebar:n}=_t(),r=ji("codingCitations"),[a,i]=p.useState(!1),l=p.useRef(null),c=()=>{l.current!=null&&window.clearTimeout(l.current),i(!0)},d=()=>{l.current=window.setTimeout(()=>i(!1),100)},u=p.useCallback(()=>{var y,k;e&&n({type:"codingCitations",turnIndex:s||1,messageId:(k=(y=t.cited_message)==null?void 0:y.id)!=null?k:"",matchedText:t.matched_text},r)},[n,e,r,t,s]);if(!t.cited_message||!t.highlighted_text)return null;let m;t.type==="python"?m=(v=(_=(x=t.cited_message)==null?void 0:x.metadata)==null?void 0:_.aggregate_result)==null?void 0:v.code:t.type==="container"&&(m=(C=(j=(w=t.cited_message)==null?void 0:w.metadata)==null?void 0:j.container_citation)==null?void 0:C.source_cmd);const h=(f=m==null?void 0:m.split("\n").length)!=null?f:0;return o.jsx("span",{className:"relative top-[0.1rem] inline-block align-middle",children:o.jsx("span",{className:"inline-flex items-center",children:o.jsxs(Fs,{open:a,onOpenChange:i,children:[o.jsx(Os,{asChild:!0,children:o.jsx(_r,{onClick:u,onMouseEnter:c,onMouseLeave:d})}),o.jsx(zs,{children:o.jsx(Ws,{align:"start",sideOffset:4,onMouseEnter:c,onMouseLeave:d,className:I("border-default bg-token-bg-primary rounded-2xl border p-3"),children:o.jsxs("aside",{className:"flex flex-col gap-3",children:[o.jsx("h2",{className:I("text-token-text-secondary text-xs font-medium"),children:t.type==="python"?o.jsx(H,{id:"citation.popover.label.python",defaultMessage:"Python script · {count, number} lines",values:{count:h}}):o.jsx(H,{id:"citation.popover.label.container",defaultMessage:"Bash script · {count, number} lines",values:{count:h}})}),o.jsx("hr",{}),o.jsx("h2",{className:I("text-sm font-medium","max-w-full break-words whitespace-pre-line sm:max-w-[300px]"),children:t.highlighted_text})]})})})]})})})}const ff="2758269539",hf=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zg),__vite__mapDeps([4,1,5,6,7])).then(t=>t.DILWidget));function pf({dil:t,dilUrl:e,trackContentReferenceEvent:s,widgetName:n}){p.useEffect(()=>{const a=n==null?void 0:{widget_name:n};s("Search Content Reference Shown","search_content_reference_shown","dil",a)},[s,n]);const r=xe();return Se(r,ff)?null:o.jsx(hf,{dil:t})}function gf({product:t,clientThreadId:e,messageId:s,contentReferenceStartIndex:n,trackContentReferenceEvent:r,showTitle:a=!1,showImageGallery:i=!1}){var f,y,k,S;const l=xe(),c=Se(l,"3375735072"),d=Se(l,"232003972"),u=p.useMemo(()=>({clientThreadId:e,messageId:s}),[e,s]),m=Hs.useStore(),[h,x]=p.useState(!1),[_,v]=p.useState(t),[w,j]=p.useState(!1),C=a||d||c;return p.useEffect(()=>{let N=!0;return(async $=>{j(!0);try{try{for(var P=ns(xf($)),b,F,L;b=!(F=await P.next()).done;b=!1){const T=F.value;N&&v(T)}}catch(F){L=[F]}finally{try{b&&(F=P.return)&&await F.call(P)}finally{if(L)throw L[0]}}}finally{N&&j(!1)}})(_),()=>{N=!1}},[(f=_.product_lookup_key)==null?void 0:f.variant_options_query]),_?o.jsxs("div",{className:"-mx-6",children:[i&&o.jsx(qa,{imageUrls:(y=_.image_urls)!=null?y:[],title:_.title,onImageClick:N=>{m.setCurrentImage({image:{url:N,content_url:N,thumbnail_url:N,title:_.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:Je.ProductDetails,analyticsMetadata:u,contentReferenceStartIndex:n})}}),o.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col",children:[C&&o.jsxs("div",{className:"border-token-border-light flex flex-col border-b px-6 pb-3",children:[a&&o.jsx("div",{className:"text-token-text-primary text-xl font-medium capitalize",children:_.title}),d&&_.num_reviews&&_.rating&&o.jsx(Ga,{rating:_.rating,numReviews:_.num_reviews,ratingGroupedCitation:_.rating_grouped_citation,trackContentReferenceEvent:()=>{},analyticsMetadata:u}),c&&_.variants&&_.variants.length>0&&o.jsx("div",{className:"mt-5 mb-2",children:o.jsx(Za,{options:_.variants,showErrors:h,updateOption:(N,E,$)=>v(P=>yf({optionGroupId:N,selectedId:E,variant_index:$,product:P,trackContentReferenceEvent:r}))})})]}),o.jsx(Xa,{className:"border-token-border-light -pt-3 -mx-3 flex flex-col border-b px-6 pb-3",offers:(k=t.offers)!=null?k:[],contentReferenceStartIndex:n,productIndex:0,product:t,trackContentReferenceEvent:r,analyticsMetadata:u,imageUrls:(S=t.image_urls)!=null?S:[],isLoading:w,onOpenCheckout:()=>x(!0)})]})]}):null}function xf(t){return rn(this,null,function*(){const{product_lookup_key:e}=t;if(!!!(e!=null&&e.variant_options_query)){yield t;return}const n=ki("".concat(Ma,"/search/product_info_variants"),{method:"POST",headers:D({},Is({isAuthOptional:!0})),body:{product_lookup_key:t.product_lookup_key}});try{for(var r=ns(n),a,i,l;a=!(i=yield new kt(r.next())).done;a=!1){const c=i.value;"data"in c&&(yield c.data.product)}}catch(i){l=[i]}finally{try{a&&(i=r.return)&&(yield new kt(i.call(r)))}finally{if(l)throw l[0]}}})}function yf({optionGroupId:t,selectedId:e,variant_index:s,product:n,trackContentReferenceEvent:r}){var d,u,m,h,x,_;const a=(d=n.variants)==null?void 0:d.find(v=>v.id===t);r("product_detail","product_detail","product_entity",{product_id:n.id,action:"variant_selected",section:"product_detail",section_location:"sidebar",variant_name:(u=a==null?void 0:a.label)!=null?u:"",variant_value:(h=(m=a==null?void 0:a.options.find(v=>v.id===e))==null?void 0:m.label)!=null?h:"",variant_index:s});const i=(_=(x=n.variants)==null?void 0:x.map(v=>v.id===t?U(D({},v),{options:v.options.map(w=>U(D({},w),{selected:w.id===e})),selected_option_id:e}):v))!=null?_:n.variants,c=(i==null?void 0:i.every(v=>v.selected_option_id))?i==null?void 0:i.reduce((v,w)=>(w.selected_option_id&&(v[w.id]=w.selected_option_id),v),{}):null;return U(D({},n),{variants:i,product_lookup_key:U(D({},n.product_lookup_key),{variant_options_query:c})})}function bf({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:n}){var r,a,i;if(p.useEffect(()=>{var l,c;n("Entity Metadata Content Reference Shown","entity_metadata_content_reference_shown","entity_metadata",D({entity_type:t.entity_type},t.entity_type==="local_business"?{business_id:(l=t.entity_data)==null?void 0:l.id}:t.entity_type==="product"?{product_id:(c=t.entity_data)==null?void 0:c.id}:{}))},[n,t.entity_type,(r=t.entity_data)==null?void 0:r.id]),!(t!=null&&t.entity_data))return null;if(t.entity_type==="local_business"){const c=t.layout!=="one-line";return o.jsx(xm,{isLoading:(a=t.metadata)==null?void 0:a.is_loading,business:t.entity_data,mapUrl:(i=t.metadata)==null?void 0:i.map_url,showActionButtons:c,showExtendedDetails:c,showTitle:c,showHourDetail:c,showPrice:c,trackContentReferenceEvent:n,topOffset:c?0:-4})}else if(t.entity_type==="product")return o.jsx(gf,{product:t.entity_data,clientThreadId:e,messageId:s,contentReferenceStartIndex:t.start_idx,trackContentReferenceEvent:n});return null}function _f(t,e){return new Date(t).toLocaleDateString(e,{month:"long",day:"numeric",year:"numeric"})}function vf({metadata:t,trackContentReferenceEvent:e}){const s=t.items.filter(n=>n.cloud_doc_url||Ci(n.id));return s.length===0?null:o.jsx("div",{className:"mt-6 flex flex-col gap-3",children:s.map((n,r)=>o.jsx(wf,{item:n,index:r,trackContentReferenceEvent:e},r))})}function wf({item:t,index:e,trackContentReferenceEvent:s}){const n=le(),r=xe(),a=Si(),{fileName:i,fileTypeDisplayName:l,fileTypeIcon:c,snippet:d,url:u,fileLastModifiedTime:m}=yl(t,"icon object-contain",r,n,a),h={title:i,description:d!=null?d:"",index:e};return p.useEffect(()=>{s("Contextual Answers Content Reference Shown","contextual_answers_content_reference_shown","file_navlist",h)},[]),o.jsxs(Qe,{className:"group/nav-list relative flex items-center gap-6 py-1.5",href:u!=null?u:"/",onClick:()=>{s("Contextual Answers Content Reference Clicked","contextual_answers_content_reference_clicked","file_navlist",h)},children:[o.jsx("div",{className:"absolute start-0 top-0 bottom-0 w-[3px] rounded-t-lg rounded-b-lg bg-black/10"}),o.jsxs("div",{className:"ms-4 flex grow flex-col gap-1 overflow-hidden text-ellipsis",children:[o.jsxs("div",{className:"not-prose text-token-text-primary flex items-center gap-1.5 text-sm",children:[c,o.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm",children:l})]}),o.jsx("div",{className:"text-token-link decoration-token-link line-clamp-2 font-semibold group-hover/nav-list:underline",children:i}),o.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm leading-snug font-normal",children:d}),m&&o.jsx("div",{className:"text-token-text-secondary text-sm",children:_f(m,n.locale)})]})]})}var xs={line:{color:"#F66",width:1,dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(t,e){return!0},afterZoom:function(t,e){}}},jf={id:"crosshair",afterInit:function(t){if(t.config.options.scales.x){var e=t.config.options.scales.x.type;if(!(e!=="linear"&&e!=="time"&&e!=="category"&&e!=="logarithmic")){t.options.plugins.crosshair===void 0&&(t.options.plugins.crosshair=xs),t.crosshair={enabled:!1,suppressUpdate:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,ignoreNextEvents:0,reset:function(){this.resetZoom(t,!1,!1)}.bind(this)};var s=this.getOption(t,"sync","enabled");s&&(t.crosshair.syncEventHandler=function(n){this.handleSyncEvent(t,n)}.bind(this),t.crosshair.resetZoomEventHandler=function(n){var r=this.getOption(t,"sync","group");n.chartId!==t.id&&n.syncGroup===r&&this.resetZoom(t,!0)}.bind(this),window.addEventListener("sync-event",t.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler)),t.panZoom=this.panZoom.bind(this,t)}}},afterDestroy:function(t){var e=this.getOption(t,"sync","enabled");e&&(window.removeEventListener("sync-event",t.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler))},panZoom:function(t,e){if(t.crosshair.originalData.length!==0){var s=t.crosshair.end-t.crosshair.start,n=t.crosshair.min,r=t.crosshair.max;e<0?(t.crosshair.start=Math.max(t.crosshair.start+e,n),t.crosshair.end=t.crosshair.start===n?n+s:t.crosshair.end+e):(t.crosshair.end=Math.min(t.crosshair.end+e,t.crosshair.max),t.crosshair.start=t.crosshair.end===r?r-s:t.crosshair.start+e),this.doZoom(t,t.crosshair.start,t.crosshair.end)}},getOption:function(t,e,s){return mn(t.options.plugins.crosshair[e]?t.options.plugins.crosshair[e][s]:void 0,xs[e][s])},getXScale:function(t){return t.data.datasets.length?t.scales[t.getDatasetMeta(0).xAxisID]:null},getYScale:function(t){return t.scales[t.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(t,e){var s=this.getOption(t,"sync","group");if(e.chartId!==t.id&&e.syncGroup===s){var n=this.getXScale(t);if(n){var r=e.original.native.buttons===void 0?e.original.native.which:e.original.native.buttons;e.original.type==="mouseup"&&(r=0);var a={type:e.original.type=="click"?"mousemove":e.original.type,chart:t,x:n.getPixelForValue(e.xValue),y:e.original.y,native:{buttons:r},stop:!0};t._eventHandler(a)}}},afterEvent:function(t,e){if(t.config.options.scales.x.length==0)return;let s=e.event;var n=t.config.options.scales.x.type;if(!(n!=="linear"&&n!=="time"&&n!=="category"&&xscaleType!=="logarithmic")){var r=this.getXScale(t);if(r){if(t.crosshair.ignoreNextEvents>0){t.crosshair.ignoreNextEvents-=1;return}var a=s.native.buttons===void 0?s.native.which:s.native.buttons;s.native.type==="mouseup"&&(a=0);var i=this.getOption(t,"sync","enabled"),l=this.getOption(t,"sync","group");if(!s.stop&&i){var e=new CustomEvent("sync-event");e.chartId=t.id,e.syncGroup=l,e.original=s,e.xValue=r.getValueForPixel(s.x),window.dispatchEvent(e)}var c=this.getOption(t,"sync","suppressTooltips");if(t.crosshair.suppressTooltips=s.stop&&c,t.crosshair.enabled=s.type!=="mouseout"&&s.x>r.getPixelForValue(r.min)&&s.x<r.getPixelForValue(r.max),!t.crosshair.enabled&&!t.crosshair.suppressUpdate)return s.x>r.getPixelForValue(r.max)&&(t.crosshair.suppressUpdate=!0,t.update("none")),t.crosshair.dragStarted=!1,!1;t.crosshair.suppressUpdate=!1;var d=this.getOption(t,"zoom","enabled");if(a===1&&!t.crosshair.dragStarted&&d&&(t.crosshair.dragStartX=s.x,t.crosshair.dragStarted=!0),t.crosshair.dragStarted&&a===0){t.crosshair.dragStarted=!1;var u=r.getValueForPixel(t.crosshair.dragStartX),m=r.getValueForPixel(t.crosshair.x);Math.abs(t.crosshair.dragStartX-t.crosshair.x)>1&&this.doZoom(t,u,m),t.update("none")}t.crosshair.x=s.x,t.draw()}}},afterDraw:function(t){if(t.crosshair.enabled)return t.crosshair.dragStarted?this.drawZoombox(t):(this.drawTraceLine(t),this.interpolateValues(t),this.drawTracePoints(t)),!0},beforeTooltipDraw:function(t){return!t.crosshair.dragStarted&&!t.crosshair.suppressTooltips},resetZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(s){if(t.crosshair.originalData.length>0)for(var n=0;n<t.data.datasets.length;n++){var r=t.data.datasets[n];r.data=t.crosshair.originalData.shift(0)}t.crosshair.originalXRange.min?(t.options.scales.x.min=t.crosshair.originalXRange.min,t.crosshair.originalXRange.min=null):delete t.options.scales.x.min,t.crosshair.originalXRange.max?(t.options.scales.x.max=t.crosshair.originalXRange.max,t.crosshair.originalXRange.max=null):delete t.options.scales.x.max}t.crosshair.button&&t.crosshair.button.parentNode&&(t.crosshair.button.parentNode.removeChild(t.crosshair.button),t.crosshair.button=!1);var a=this.getOption(t,"sync","enabled");if(!e&&s&&a){var i=this.getOption(t,"sync","group"),l=new CustomEvent("reset-zoom-event");l.chartId=t.id,l.syncGroup=i,window.dispatchEvent(l)}s&&t.update("none")},doZoom:function(t,e,s){if(e>s){var n=e;e=s,s=n}var r=mn(t.options.plugins.crosshair.callbacks?t.options.plugins.crosshair.callbacks.beforeZoom:void 0,xs.callbacks.beforeZoom);if(!r(e,s))return!1;if(t.crosshair.dragStarted=!1,t.options.scales.x.min&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.min=t.options.scales.x.min),t.options.scales.x.max&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.max=t.options.scales.x.max),!t.crosshair.button){var a=document.createElement("button"),i=this.getOption(t,"zoom","zoomButtonText"),l=this.getOption(t,"zoom","zoomButtonClass"),c=document.createTextNode(i);a.appendChild(c),a.className=l,a.addEventListener("click",function(){this.resetZoom(t)}.bind(this)),t.canvas.parentNode.appendChild(a),t.crosshair.button=a}t.options.scales.x.min=e,t.options.scales.x.max=s;var d=t.crosshair.originalData.length===0,u=t.config.options.scales.x.type!=="category";if(u)for(var m=0;m<t.data.datasets.length;m++){var h=[],x=0,_=!1,v=!1;d&&(t.crosshair.originalData[m]=t.data.datasets[m].data);for(var w=t.crosshair.originalData[m],j=0;j<w.length;j++){var C=w[j],f=C.x!==void 0?C.x:NaN;f>=e&&!_&&x>0&&(h.push(w[x-1]),_=!0),f>=e&&f<=s&&h.push(C),f>s&&!v&&x<w.length&&(h.push(C),v=!0),x+=1}t.data.datasets[m].data=h}if(t.crosshair.start=e,t.crosshair.end=s,d){var y=this.getXScale(t);t.crosshair.min=y.min,t.crosshair.max=y.max}t.crosshair.ignoreNextEvents=2,t.update("none");var k=this.getOption(t,"callbacks","afterZoom");k(e,s)},drawZoombox:function(t){var e=this.getYScale(t),s=this.getOption(t,"zoom","zoomboxBorderColor"),n=this.getOption(t,"zoom","zoomboxBackgroundColor");t.ctx.beginPath(),t.ctx.rect(t.crosshair.dragStartX,e.getPixelForValue(e.max),t.crosshair.x-t.crosshair.dragStartX,e.getPixelForValue(e.min)-e.getPixelForValue(e.max)),t.ctx.lineWidth=1,t.ctx.strokeStyle=s,t.ctx.fillStyle=n,t.ctx.fill(),t.ctx.fillStyle="",t.ctx.stroke(),t.ctx.closePath()},drawTraceLine:function(t){var e=this.getYScale(t),s=this.getOption(t,"line","width"),n=this.getOption(t,"line","color"),r=this.getOption(t,"line","dashPattern"),a=this.getOption(t,"snap","enabled"),i=t.crosshair.x;a&&t._active.length&&(i=t._active[0].element.x),t.ctx.beginPath(),t.ctx.setLineDash(r),t.ctx.moveTo(i,e.getPixelForValue(e.max)),t.ctx.lineWidth=s,t.ctx.strokeStyle=n,t.ctx.lineTo(i,e.getPixelForValue(e.min)),t.ctx.stroke(),t.ctx.setLineDash([])},drawTracePoints:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],n=t.getDatasetMeta(e),r=t.scales[n.yAxisID];n.hidden||!s.interpolate||(t.ctx.beginPath(),t.ctx.arc(t.crosshair.x,r.getPixelForValue(s.interpolatedValue),3,0,2*Math.PI,!1),t.ctx.fillStyle="white",t.ctx.lineWidth=2,t.ctx.strokeStyle=s.borderColor,t.ctx.fill(),t.ctx.stroke())}},interpolateValues:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],n=t.getDatasetMeta(e),r=t.scales[n.xAxisID],a=r.getValueForPixel(t.crosshair.x);if(!(n.hidden||!s.interpolate)){var i=s.data,l=i.findIndex(function(m){return m.x>=a}),c=i[l-1],d=i[l];if(t.data.datasets[e].steppedLine&&c)s.interpolatedValue=c.y;else if(c&&d){var u=(d.y-c.y)/(d.x-c.x);s.interpolatedValue=c.y+(a-c.x)*u}else s.interpolatedValue=NaN}}}};const Ft=(t=1)=>"rgba(48, 166, 51, ".concat(t,")"),Ot=(t=1)=>"rgba(241, 77, 66, ".concat(t,")"),Qn="text-[#30a633]",eo="text-[#f14d42]",kf=["1d","5d","1m","6m","ytd","1y","5y","max"];function Cf({histories:t,selectedInterval:e,onSelectHistoryInterval:s}){var r;const n=Object.keys((r=t==null?void 0:t.quotes)!=null?r:{});return o.jsx("div",{className:"text-token-text-tertiary inline-flex items-start justify-between rounded-[10px] bg-[#f4f4f4] p-[3px] text-xs font-semibold sm:justify-start sm:gap-1 dark:bg-[#393939]",children:n.map(a=>o.jsx("button",{onClick:()=>{s==null||s(a)},className:I("border border-transparent px-3 py-1.5 text-xs font-semibold uppercase",e===a?"border-token-border-default! bg-token-main-surface-primary text-token-text-primary shadow-xxs dark:border-token-border-medium! rounded-lg":"hover:text-token-text-secondary"),children:vr[a].label},a))})}const vr={"1d":{label:"1D",formatTimestampLabel:to,formatTimestampTooltip:to,maxTicksLimit:6,lineTension:.1},"5d":{label:"5D",formatTimestampLabel:so,formatTimestampTooltip:Nf,maxTicksLimit:6,lineTension:.1},"1m":{label:"1M",formatTimestampLabel:so,formatTimestampTooltip:Mf,maxTicksLimit:6,lineTension:.1,useUtc:!0},"6m":{label:"6M",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.1,useUtc:!0},ytd:{label:"YTD",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.1,useUtc:!0},"1y":{label:"1Y",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0},"5y":{label:"5Y",formatTimestampLabel:no,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0},max:{label:"max",formatTimestampLabel:no,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0}};function Sf(t){return t?kf.filter(s=>s in t.quotes).find(s=>t.quotes[s].length>0):void 0}function tt(t,e){return ft(new Date(t*1e3),e!=null?e:"America/New_York")}function to(t,e,s){const n=tt(e,s);return t.formatTime(n,{hour:"numeric",minute:"numeric"})}function Nf(t,e,s){const n=tt(e,s);return t.formatDate(n,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}function dt(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",day:"numeric",year:"numeric"})}function ys(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",year:"numeric"})}function so(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",day:"numeric"})}function Mf(t,e,s){const n=tt(e,s);return t.formatDate(n,{weekday:"short",month:"short",day:"numeric"})}function no(t,e,s){const n=tt(e,s);return t.formatDate(n,{year:"numeric"})}kl.register(Cl,Sl,Nl,Ml,El,Tl,$l,Pl,Al,jf,Il);const Ef=100,oo={color:"#b4b4b4",font:{size:10,weight:"600",family:"Menlo"}};function Tf({isUp:t,histories:e,selectedInterval:s,setHighlightedPrice:n,latestTradingPeriod:r,timezone:a}){return o.jsx(o.Fragment,{children:e&&s&&r?o.jsx($f,{isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:r,timezone:a,setHighlightedPrice:n}):o.jsx(ut,{className:"h-full",index:1,width:100})})}function $f({isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:n,timezone:r,setHighlightedPrice:a}){const[i,l]=p.useState(null),[c,d]=p.useState(!1),u=s==="1d",m=p.useMemo(()=>{let y=e.quotes[s].filter(k=>k.close>=0);if(u&&n){const k=n.regular.start_timestamp,S=n.regular.end_timestamp;if(y=y.filter(N=>N.timestamp>=k&&N.timestamp<=S),y.length===0||y[y.length-1].timestamp<S){let E=y.length>0?y[y.length-1].timestamp:k-600;for(;E<S;)E+=600,y.push({timestamp:E,close:null})}}return y},[e,s,u,n]),h=vr[s],{formatTimestampTooltip:x,maxTicksLimit:_,useUtc:v=!1}=h,w=le(),j=Eo(),C=Xt(),f=p.useMemo(()=>{const{formatTimestampLabel:y,lineTension:k}=h;return{labels:m.map(S=>y(w,S.timestamp,v?"UTC":r)),datasets:[{data:m.map(S=>S.close),borderColor:t?Ft():Ot(),pointRadius:0,pointHoverRadius:4,pointStyle:"circle",pointBackgroundColor:t?Ft():Ot(),pointHoverBorderWidth:2,pointHoverBorderColor:"rgba(255, 255, 255, 1)",backgroundColor:function(S){const{ctx:N,chartArea:E}=S.chart;if(E)return Af(N,E,t)},fill:!0,borderWidth:2,lineTension:k!=null?k:.4}]}},[h,m,t,v,r,w]);return o.jsx("div",{className:"flex h-full flex-col gap-6",children:o.jsxs("div",{className:"relative h-full",onMouseEnter:()=>d(!0),onMouseLeave:()=>{d(!1),a(null)},children:[o.jsx(Ll,{options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},hover:{mode:c?"index":"point"},animation:!1,scales:{x:{afterBuildTicks:y=>{if(y.ticks.length>_)if(u)y.ticks=y.ticks.filter((k,S)=>m[S].timestamp%(j?3600:7200)===0);else{const k=Math.ceil(y.ticks.length/(_-1));y.ticks=y.ticks.filter((S,N)=>N>0&&(N%k===0||N===y.ticks.length-1))}},grid:{display:!1},ticks:U(D({},oo),{align:"end"})},y:{ticks:U(D({},oo),{maxTicksLimit:7}),border:{display:!1},grid:{color:C?"rgba(255, 255, 255, 0.1)":"rgba(229, 229, 229, 0.5)"}}},plugins:{datalabels:{display:!1},legend:{display:!1},tooltip:{enabled:!1,animation:!1,displayColors:!1,callbacks:{title:function(y){var N;const k=y[0];if(!k)return"";const S=(N=m[k.dataIndex])==null?void 0:N.timestamp;return S?x(w,S,v?"UTC":r):""}},external:({tooltip:y})=>{var k,S,N,E;c&&y.opacity>0&&a(pt((E=(N=(S=(k=y.dataPoints)==null?void 0:k[0])==null?void 0:S.parsed)==null?void 0:N.y)!=null?E:0)),l($=>{var F,L,T,M,z;const P=y.chart.width,b=y.caretX>P-Ef;return!$||$.x!==y.caretX||$.y!==y.caretY||$.opacity!==y.opacity||$.flip!==b?U(D({},$),{x:y.caretX,y:y.caretY,dateLabel:(F=y.title)==null?void 0:F[0],value:pt((z=(M=(T=(L=y.dataPoints)==null?void 0:L[0])==null?void 0:T.parsed)==null?void 0:M.y)!=null?z:0),opacity:y.opacity,flip:b}):$})}},dropShadow:!1,crosshair:{line:{color:C?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)",width:.5},zoom:{enabled:!1}}}},data:f}),o.jsx(Pf,{tooltipData:i})]})})}function Pf({tooltipData:t}){return!t||!t.opacity?null:o.jsx("div",{style:{left:t.x-5,top:10,transform:"translate(-50%, -50%)"},className:I("text-token-main-surface-primary dark:bg-token-main-surface-secondary pointer-events-none absolute translate-y-[-100%] rounded-lg bg-black px-2 py-1 font-mono font-semibold whitespace-nowrap dark:text-white"),children:o.jsx("div",{className:"text-xs",children:t.dateLabel})})}function Af(t,e,s){const n=t.createLinearGradient(0,e.top,0,e.bottom);return n.addColorStop(0,s?Ft(.4):Ot(.4)),n.addColorStop(1,s?Ft(0):Ot(0)),n}function pt(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function Re({label:t,value:e,className:s}){return o.jsxs("div",{className:I("flex w-full flex-1 flex-row justify-between text-sm",s),children:[o.jsx("span",{className:"text-token-text-secondary font-normal whitespace-nowrap",children:t}),o.jsx("span",{className:"text-token-text-primary font-normal whitespace-nowrap",children:e})]})}function If({metrics:t}){const e=le(),s=!!(t.marketCap&&t.peRatio&&t.eps);return o.jsx("div",{className:"border-token-border-default flex flex-col gap-1 rounded-b-lg border-t bg-[#f4f4f4] px-4 py-3 dark:bg-[#393939]",children:o.jsxs("div",{className:I("grid grid-cols-2 gap-x-10 gap-y-3 lg:grid-cols-3 lg:gap-x-6"),children:[o.jsx(Re,{label:e.formatMessage({id:"MDHEj7",defaultMessage:"Open"}),value:e.formatNumber(t.openPrice,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-1"}),o.jsx(Re,{label:e.formatMessage({id:"PboNMC",defaultMessage:"Volume"}),value:e.formatNumber(t.intradayVolume,{notation:"compact",maximumFractionDigits:1}),className:I("order-2",!s&&"lg:order-last")}),o.jsxs("div",{className:"order-4 row-span-2 flex flex-col gap-3",children:[o.jsx(Re,{label:e.formatMessage({id:"bresUW",defaultMessage:"Day Low"}),value:e.formatNumber(t.intradayLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),o.jsx(Re,{label:e.formatMessage({id:"oWyv5V",defaultMessage:"Day High"}),value:e.formatNumber(t.intradayHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),o.jsxs("div",{className:"order-5 row-span-2 flex flex-col gap-3",children:[o.jsx(Re,{label:e.formatMessage({id:"DcEYIK",defaultMessage:"Year Low"}),value:e.formatNumber(t.fiftyTwoWeekLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),o.jsx(Re,{label:e.formatMessage({id:"ZfFtJ4",defaultMessage:"Year High"}),value:e.formatNumber(t.fiftyTwoWeekHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),t.marketCap&&o.jsx(Re,{label:e.formatMessage({id:"o7Vbua",defaultMessage:"Market Cap (TTM)"}),value:e.formatNumber(t.marketCap,{notation:"compact",maximumFractionDigits:2}),className:"order-last lg:order-3"}),t.peRatio&&t.eps&&o.jsxs(o.Fragment,{children:[o.jsx(Re,{label:e.formatMessage({id:"edGd+S",defaultMessage:"EPS (TTM)"}),value:e.formatNumber(t.eps,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"}),o.jsx(Re,{label:e.formatMessage({id:"uX5YWo",defaultMessage:"P/E Ratio (TTM)"}),value:e.formatNumber(t.peRatio,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"})]})]})})}function Lf({data:t,priceChange:e,highlightedPrice:s,extendedPriceChange:n,url:r}){var i;function a(l,c="intraday",d=null){const{isUp:u,changePercentage:m,changeLabel:h,changeAmount:x}=l,_=Math.abs(m).toFixed(2),v=pt(x);return o.jsxs("span",{className:"flex min-w-0 items-center gap-1",children:[c==="extended_hours"&&d!=null&&o.jsx("span",{className:"font-semibold",children:o.jsx(H,{id:"HWwWpW",defaultMessage:"{price}",values:{price:d}})}),o.jsx("span",{className:I("font-semibold",u?Qn:eo),children:o.jsx(H,{id:"3x4Lkl",defaultMessage:"{sign}{changeAmount}",values:{changeAmount:v,sign:u?"+":""}})}),o.jsx("span",{className:I("font-semibold",u?Qn:eo),children:o.jsx(H,{id:"MbfF1T",defaultMessage:"({sign}{changePercentage}%)",values:{changePercentage:_,sign:u?"+":"-"}})}),c==="extended_hours"?o.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h}):o.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h})]})}return o.jsxs("div",{children:[o.jsx("div",{className:"mt-2 text-sm",children:t?o.jsx(H,{id:"+2WHuv",defaultMessage:"{name} ({ticker})",values:{name:t.asset.name,ticker:t.asset.ticker}}):o.jsx("div",{className:"w-32 font-medium",children:o.jsx(ut,{index:9,width:100})})}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:t?o.jsx(o.Fragment,{children:r!=null&&o.jsxs(o.Fragment,{children:[" · ",o.jsx(Qe,{href:r,className:"text-token-link hover:underline",children:Kt(r,"hostname")})]})}):o.jsx("div",{className:"mt-2 w-36",children:o.jsx(ut,{index:6,width:100})})}),o.jsx("div",{className:"mt-2 flex text-4xl font-semibold",children:t?o.jsx(H,{id:"s+1uly",defaultMessage:"{price}",values:{price:s!=null?s:pt(t.price.price)}}):o.jsx("div",{className:"w-32",children:o.jsx(ut,{index:0,width:100})})}),o.jsx("div",{className:"mt-2 flex items-center justify-start gap-1 text-sm",children:e?a(e):o.jsx("div",{className:"mt-2 w-40",children:o.jsx(ut,{index:3,width:100})})}),o.jsx("div",{className:"mt-0.5 flex items-center justify-start gap-1 text-sm",children:((i=t==null?void 0:t.price)==null?void 0:i.extended_price)!=null&&n!=null&&a(n,"extended_hours",pt(t.price.extended_price))})]})}function Rf({contentReference:t,trackContentReferenceEvent:e}){var C,f,y,k,S,N,E,$,P,b,F,L,T,M,z;const s=le();p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown","stock")},[e]);const n=Sf((C=t==null?void 0:t.stock)==null?void 0:C.histories),r=t==null?void 0:t.stock,[a,i]=p.useState(n),[l,c]=p.useState(null),d=a==="1d",u=(k=(y=(f=r==null?void 0:r.histories)==null?void 0:f.quotes)==null?void 0:y[a!=null?a:""])==null?void 0:k[0],m=a&&a in It?a:void 0,h=r&&(u&&!d?{changePercentage:(r.price.price-u.close)/u.close*100,changeAmount:r.price.price-u.close,changeLabel:m?s.formatMessage(It[m]):"",isUp:r.price.price>u.close}:r.price.change_percent&&r.price.change?{changePercentage:r.price.change_percent*100,changeAmount:r.price.change,changeLabel:Ff(r.price.latest_trade_timestamp,r.asset.timezone,s),isUp:r.price.change?r.price.change>0:!1}:null),x=r&&r.price.extended_price!=null&&r.price.extended_change_percent!=null&&r.price.extended_change!=null?{changePercentage:r.price.extended_change_percent*100,changeAmount:r.price.extended_change,changeLabel:s.formatMessage((S=Df(r.price.market_status))!=null?S:It.extended),isUp:r.price.extended_change>0}:null,{fiftyTwoWeekHigh:_,fiftyTwoWeekLow:v}=p.useMemo(()=>{var te;const G=(te=r==null?void 0:r.histories)==null?void 0:te.quotes["1y"];if(!G)return{fiftyTwoWeekHigh:null,fiftyTwoWeekLow:null};const B=G.map(A=>A.high).filter(A=>A!=null),K=G.map(A=>A.low).filter(A=>A!=null);return{fiftyTwoWeekHigh:B.length>0?Math.max(...B):null,fiftyTwoWeekLow:K.length>0?Math.min(...K):null}},[(N=r==null?void 0:r.histories)==null?void 0:N.quotes]),w=r!=null&&r.price.open_price&&r.price.intraday_high&&r.price.intraday_low&&r.price.intraday_volume&&_&&v?{openPrice:r.price.open_price,intradayHigh:r.price.intraday_high,intradayLow:r.price.intraday_low,intradayVolume:r.price.intraday_volume,fiftyTwoWeekHigh:_,fiftyTwoWeekLow:v,marketCap:($=(E=r.metrics)==null?void 0:E.market_cap)!=null?$:void 0,peRatio:(b=(P=r.metrics)==null?void 0:P.pe_ratio)!=null?b:void 0,eps:(L=(F=r.metrics)==null?void 0:F.eps)!=null?L:void 0}:null,j=w!=null;return o.jsxs("div",{"data-testid":"finance-widget",className:I("border-token-border-default mb-2 flex min-h-[480px] flex-col gap-8 rounded-lg border"),children:[o.jsxs("div",{className:"mx-6 flex flex-wrap items-end justify-between",children:[o.jsx(Lf,{data:r!=null?r:null,highlightedPrice:l,priceChange:h!=null?h:null,extendedPriceChange:x!=null?x:null,url:(T=t==null?void 0:t.url)!=null?T:null}),o.jsx("div",{className:"mt-4",children:o.jsx(Cf,{selectedInterval:a,onSelectHistoryInterval:i,histories:r==null?void 0:r.histories})})]}),o.jsx("div",{className:"mx-6 h-[340px]",children:o.jsx(Tf,{isUp:(M=h==null?void 0:h.isUp)!=null?M:!1,selectedInterval:a,histories:r==null?void 0:r.histories,setHighlightedPrice:c,onSelectHistoryInterval:G=>i(G),latestTradingPeriod:r==null?void 0:r.asset.latest_trading_period,timezone:(z=r==null?void 0:r.asset.timezone)!=null?z:null})}),j&&o.jsx("div",{className:"-mt-4",children:o.jsx(If,{metrics:w})})]})}function Df(t){if(t==null)return null;const e=t.toLowerCase();return e==="premarket"||e==="open"?mt({id:"By+pvF",defaultMessage:"Pre-Market"}):e==="afterhours"||e==="closed"?mt({id:"aLCg3c",defaultMessage:"After Hours"}):mt({id:"2p526c",defaultMessage:"Extended Hours"})}function Ff(t,e,s){function n(r,a){const l=ft(new Date,a),c=s.formatDate(l,{year:"numeric",month:"2-digit",day:"2-digit"}),d=fn(r*1e3),u=ft(d,a),m=s.formatDate(u,{year:"numeric",month:"2-digit",day:"2-digit"});return c===m}if(!t||!e||n(t,e))return s.formatMessage(It["1d"]);{const r=fn(t*1e3),a=ft(r,e);return s.formatDate(a,{month:"long",day:"numeric"})}}const It=As({"1d":{id:"SMdcuo",defaultMessage:"Today"},extended:{id:"2p526c",defaultMessage:"Extended Hours"},"5d":{id:"HCA6lr",defaultMessage:"Past 5 days"},"1m":{id:"DJpPMq",defaultMessage:"Past month"},"6m":{id:"1mUJ2L",defaultMessage:"Past 6 months"},ytd:{id:"b9KkhV",defaultMessage:"Year to date"},"1y":{id:"XnvD9A",defaultMessage:"Past year"},"5y":{id:"DfI1RB",defaultMessage:"Past 5 years"},max:{id:"WzOhuU",defaultMessage:"Max"}});function Of({metadata:t,trackContentReferenceEvent:e}){const s=p.useCallback(l=>{e("link_action",null,t.type,{url:t.url,title:t.title,pub_date:null,sub_pill_index:null,link_type:"link_title",action:l})},[t.title,t.type,t.url,e]);p.useEffect(()=>{s("show")},[s]);const[n,r]=p.useState(!1),a=()=>{n||(s("hover"),r(!0))},i=()=>{s("click")};return o.jsx(Qe,{href:t.url,onClick:i,onMouseEnter:a,onFocus:a,className:"underline",children:t.title})}const zf={google_maps:{title:"Google Maps"}};function Wf({metadata:t,trackContentReferenceEvent:e}){var n,r;p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=(r=(n=zf[t.provider])==null?void 0:n.title)!=null?r:"Maps";return o.jsx("span",{children:o.jsx(H,{id:"ZSUz1k",defaultMessage:" ({link}) ",values:{link:o.jsx(Qe,{href:t.url,children:s})}})})}const Hf=4,wr=3;function Bf(t){"use forget";var $,P,b,F;const e=he.c(34),{metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:a}=t,i=xe();let l;e[0]!==i?(l=()=>To(i),e[0]=i,e[1]=l):l=e[1];const c=Ve(l);let d;e[2]!==n?(d=n?No(n):null,e[2]=n,e[3]=d):d=e[3];const u=d,m=(P=($=r==null?void 0:r.widgets)==null?void 0:$.query)!=null?P:"";let h;e[4]!==u||e[5]!==m?(h=((F=(b=m==null?void 0:m.trim())==null?void 0:b.length)!=null?F:0)>0?m:u,e[4]=u,e[5]=m,e[6]=h):h=e[6];const x=h;let _;e[7]!==i||e[8]!==c||e[9]!==x||e[10]!==s.items.length?(_=()=>{!c||s.items.length>=Hf||!x||Fo(i,x,"news")},e[7]=i,e[8]=c,e[9]=x,e[10]=s.items.length,e[11]=_):_=e[11];let v;e[12]!==i||e[13]!==c||e[14]!==n||e[15]!==x||e[16]!==s.items.length||e[17]!==r?(v=[i,c,n,x,s.items.length,r],e[12]=i,e[13]=c,e[14]=n,e[15]=x,e[16]=s.items.length,e[17]=r,e[18]=v):v=e[18],p.useEffect(_,v);let w;e[19]!==c||e[20]!==x?(w=L=>{var z,G;if(!c||!x)return[[],!1];const M=(z=L.entries[x])!=null?z:Oo;return[(G=M.news)!=null?G:[],zo(M,"news")]},e[19]=c,e[20]=x,e[21]=w):w=e[21];const[j,C]=Do(w);let f;e[22]!==s.items?(f=new Set(s.items.map(Uf)),e[22]=s.items,e[23]=f):f=e[23];const y=f;let k;if(e[24]!==a||e[25]!==s.items||e[26]!==y||e[27]!==j){let L;e[29]!==y?(L=M=>!y.has(Uo(M.url)),e[29]=y,e[30]=L):L=e[30];const T=j.filter(L).slice(0,wr).map(Vf);k=a?[...s.items,...T]:s.items,e[24]=a,e[25]=s.items,e[26]=y,e[27]=j,e[28]=k}else k=e[28];const S=k,N=a&&C;let E;return e[31]!==S||e[32]!==N?(E={items:S,isLoading:N},e[31]=S,e[32]=N,e[33]=E):E=e[33],E}function Vf(t){const e=t.pub_date?new Date(t.pub_date).getTime()/1e3:null;return U(D({},t),{pub_date:e,attribution:t.domain})}function Uf(t){return Uo(t.url)}const qf=/^navlist[\s\S]*$/;function Gf(t){"use forget";const e=he.c(31),{metadata:s,trackContentReferenceEvent:n,isFirstAssistantContent:r,superWidgetContent:a,lastUserMsgOfPrevTurn:i}=t,l=xe();let c;e[0]!==l?(c=We(l),e[0]=l,e[1]=c):c=e[1];const d=c;let u;e[2]!==l?(u=Gt(l),e[2]=l,e[3]=u):u=e[3];const m=u,h=s.items.length>0,x=p.useRef(n);let _,v;e[4]!==n?(_=()=>{x.current=n},v=[n],e[4]=n,e[5]=_,e[6]=v):(_=e[5],v=e[6]),p.useEffect(_,v);let w,j;e[7]!==h?(w=()=>{h&&x.current("Search Content Reference Shown","search_content_reference_shown","nav_list")},j=[h],e[7]=h,e[8]=w,e[9]=j):(w=e[8],j=e[9]),p.useEffect(w,j);let C;e[10]!==n?(C=(L,T)=>{n("link_action",null,"nav_list",U(D({},ro(L,T)),{action:"click"}))},e[10]=n,e[11]=C):C=e[11];const f=C;let y;e[12]!==n?(y=(L,T)=>{n("link_action",null,"nav_list",U(D({},ro(L,T)),{action:"show"}))},e[12]=n,e[13]=y):y=e[13];const k=y,S=d&&r,N=s.title&&!S;if(s.items.length===0)return null;const E=!S&&"mt-6";let $;e[14]!==E?($=I("mb-1",E),e[14]=E,e[15]=$):$=e[15];let P;e[16]!==s.title||e[17]!==N?(P=N&&o.jsx("div",{className:"text-token-text-primary -mb-1 pb-3 font-semibold",children:s.title}),e[16]=s.title,e[17]=N,e[18]=P):P=e[18];let b;e[19]!==f||e[20]!==k||e[21]!==d||e[22]!==m||e[23]!==i||e[24]!==s||e[25]!==a?(b=d&&!m?o.jsx(Xf,{metadata:s,lastUserMsgOfPrevTurn:i,superWidgetContent:a,onCardShown:k,onCardClicked:f}):o.jsx(br,{items:s.items,onCardRender:Zf,onCardShown:k,onCardClicked:f,cardClassName:"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden"}),e[19]=f,e[20]=k,e[21]=d,e[22]=m,e[23]=i,e[24]=s,e[25]=a,e[26]=b):b=e[26];let F;return e[27]!==$||e[28]!==P||e[29]!==b?(F=o.jsxs("div",{className:$,"data-testid":"nav-list-widget",children:[P,b]}),e[27]=$,e[28]=P,e[29]=b,e[30]=F):F=e[30],F}function Zf(t){return o.jsx(jr,{item:t})}function Xf(t){"use forget";var k;const e=he.c(19),{metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,onCardShown:a,onCardClicked:i}=t,l=xe();let c;e[0]!==l?(c=()=>[To(l),Zt(l)],e[0]=l,e[1]=c):c=e[1];const[d,u]=Ve(c);let m;e[2]!==s.matched_text?(m=qf.test((k=s.matched_text)!=null?k:""),e[2]=s.matched_text,e[3]=m):m=e[3];const h=m;let x;e[4]!==h||e[5]!==n||e[6]!==s||e[7]!==r?(x={metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:h},e[4]=h,e[5]=n,e[6]=s,e[7]=r,e[8]=x):x=e[8];const{items:_,isLoading:v}=Bf(x),w=v&&d?wr:0,j=u?"-mx-[var(--thread-content-margin)]":"-mx-6";let C;e[9]!==j?(C=I("relative mb-6",j),e[9]=j,e[10]=C):C=e[10];let f;e[11]!==_||e[12]!==w||e[13]!==i||e[14]!==a?(f=o.jsx(Yt,{items:_,getItemKey:Kf,onRenderItem:Yf,className:"min-h-36",itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)] thread-lg:w-61! w-50! shrink-0",onShown:a,onClick:i,numLoadingItems:w}),e[11]=_,e[12]=w,e[13]=i,e[14]=a,e[15]=f):f=e[15];let y;return e[16]!==C||e[17]!==f?(y=o.jsx("div",{className:C,children:f}),e[16]=C,e[17]=f,e[18]=y):y=e[18],y}function Yf(t){return o.jsx(jr,{item:t})}function Kf(t){return t.url}function jr({item:t}){var i,l;const{isSuccess:e}=ks((i=t.thumbnail_url)!=null?i:void 0,"NavListItem"),s=le(),n=xe(),r=We(n),a=Ea(s,t.pub_date);return o.jsxs(Qe,{className:"flex flex-col items-center gap-4 overflow-hidden pb-6",href:t.url,children:[e&&t.thumbnail_url?o.jsx("div",{className:"relative h-36 w-full overflow-hidden",children:o.jsx("img",{src:t.thumbnail_url,className:"m-0 h-full w-full",style:{objectFit:"cover"},alt:t.title})}):o.jsxs("div",{className:I("icon-bg relative flex h-36 w-full shrink-0 items-center justify-center overflow-hidden",r&&"bg-token-bg-secondary"),children:[o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-cover bg-center bg-no-repeat blur-3xl",children:o.jsx($t,{url:t.url,size:256,minSize:128,className:"mix-soft-light opacity-30 dark:opacity-20"})}),o.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:o.jsx($t,{url:t.url,size:128,minSize:80,className:"icon-xl rounded-full"})})]}),o.jsxs("div",{className:I("flex flex-col gap-2 overflow-hidden px-4 text-ellipsis",r&&"w-full items-start"),children:[o.jsxs("div",{className:"text-token-text-primary flex items-center gap-1.5 text-xs",children:[o.jsx($t,{url:t.url,size:32,minSize:16,className:"icon-xs my-0 rounded-full"}),(l=t.attribution)!=null?l:Kt(t.url)]}),o.jsx("div",{className:"text-token-text-primary decoration-token-link line-clamp-5 text-sm font-medium",children:t.title}),a&&o.jsx("div",{className:"text-token-text-secondary text-xs",children:a})]})]})}const ro=(t,e)=>({url:t.url,title:t.title,section_index:e,link_type:"text",section:"nav_list",section_location:"response"}),Jf="{{.assetPrefix}}/assets/missing-logo-h96s4tk9.webp",ao={src:Jf};function kr({team:t,className:e}){var a;const[s,n]=p.useState((a=t.logo)!=null?a:ao.src),r=()=>{qt.addError("Unable to load sports widget logo",{name:t.name,logo:t.logo}),n(ao.src)};return o.jsx("img",{src:s,alt:t.name,className:e,onError:r})}const xt=["ipl"],Qf=X(()=>Z(()=>import("./ef5noj24t7u7w8z6.js"),__vite__mapDeps([35,1])),{loading:t=>Q(t)}),eh=X(()=>Z(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zv),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),io=6,Ge="home",Ze="away";function th({scheduleRef:t,trackContentReferenceEvent:e}){var _,v,w,j;const[s,n]=p.useState(!0),r=le(),a=t.games.length>0,i=t.league.id,l=Ta(),c=bt();if(p.useEffect(()=>{a&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasSchedule:!0})},[a]),!a)return null;const u=((v=(_=r.formatDateToParts(new Date,{timeZoneName:"long"}).find(C=>C.type==="timeZoneName"))==null?void 0:_.value)!=null?v:Intl.DateTimeFormat().resolvedOptions().timeZone).replace(/Daylight|Standard/g,"");let m=t.games;const h=C=>Math.abs(new Date().getTime()-new Date(C.date).getTime());h(m[0])>h(m[m.length-1])&&(m=m.slice().reverse());const x=s?m.slice(0,io):m;return o.jsxs("div",{className:"not-prose mb-3","data-testid":"sports-schedule-widget",children:[o.jsx("div",{className:"font-semibold",children:o.jsx(H,{id:"LA6z9q",defaultMessage:"{league} Schedule",values:{league:t.league.display_name}})}),o.jsx("div",{className:"text-token-text-secondary text-sm",children:u}),x.length===1?o.jsx("div",{children:o.jsx(js,{children:o.jsx(at.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},exit:{opacity:0,y:-15},transition:{duration:.2},children:o.jsx("div",{className:"border-token-border-medium mt-3 rounded-xl border py-3",children:o.jsx(nh,{game:x[0],useAlias:xt.includes(i),leagueId:i,activeTeam:(j=(w=x[0])==null?void 0:w.active_team)!=null?j:null,isMobile:c})})})})}):o.jsx("div",{className:"grid grid-cols-1 pt-3 lg:grid-cols-2",children:o.jsx(js,{children:x.map((C,f)=>{var y;return o.jsx(at.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0,transition:{delay:f*.04}},exit:{opacity:0,y:-15},transition:{duration:.2},children:o.jsx("div",{className:I("border-token-border-medium border-b py-3",f%2===0&&"lg:border-e lg:pe-4",f%2===1&&"lg:ps-4",Math.floor(f/2)===Math.ceil(m.length/2)-1&&"lg:border-b-0",f===m.length-1&&"border-b-0"),children:o.jsx(sh,{game:C,useAlias:(l||c)&&xt.includes(i),leagueId:i,activeTeam:(y=C.active_team)!=null?y:null})})},f)})})}),m.length>io&&o.jsx("div",{className:"mt-2 flex items-center justify-between",children:o.jsx("button",{className:"flex items-center text-sm font-semibold",onClick:()=>n(!s),children:s?o.jsx(H,{id:"BH/Ee5",defaultMessage:"Show more {icon}",values:{icon:o.jsx(eh,{className:"mb-[-2px]"})}}):o.jsx(H,{id:"Z9BlEu",defaultMessage:"Show less {icon}",values:{icon:o.jsx(Qf,{className:"mb-[-2px]"})}})})})]})}function sh({game:t,useAlias:e=!1,leagueId:s,activeTeam:n}){var u,m;const r=Sr(t),a=[t.first_team_info,t.second_team_info],i=(u=a.find(h=>h.location===Ge))!=null?u:t.first_team_info,l=(m=a.find(h=>h.location===Ze))!=null?m:t.second_team_info,c=(r==null?void 0:r.team.name)===(i==null?void 0:i.team.name),d=(r==null?void 0:r.team.name)===(l==null?void 0:l.team.name);return o.jsxs("div",{className:"flex w-full gap-1.5 py-3 text-base",children:[o.jsxs("div",{className:"flex flex-auto flex-col items-start gap-1 pe-3",children:[o.jsx(Wt,{team:l.team,isWinner:d,isActive:n===Ze,logoSize:"small",useAlias:e}),o.jsx(Wt,{team:i.team,isWinner:c,isActive:n===Ge,logoSize:"small",useAlias:e})]}),o.jsxs("div",{className:I("flex flex-none flex-col items-start gap-1",xt.includes(s)&&"me-4"),children:[o.jsx(Ht,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"right"}:null,isWinner:d,negateScore:zt(s,Ze,n)}),o.jsx(Ht,{score:i.score,scoreSuffix:i.score_suffix,scoreParenthetical:i.score_parenthetical?{message:i.score_parenthetical,position:"right"}:null,isWinner:c,negateScore:zt(s,Ge,n)})]}),o.jsx("div",{className:"flex min-w-24 flex-none flex-col items-end justify-center gap-1 text-sm",children:o.jsx(Nr,{game:t})})]})}function nh({game:t,useAlias:e=!1,leagueId:s,activeTeam:n,isMobile:r}){var m,h;const a=Sr(t),i=[t.first_team_info,t.second_team_info],l=(m=i.find(x=>x.location===Ge))!=null?m:t.first_team_info,c=(h=i.find(x=>x.location===Ze))!=null?h:t.second_team_info,d=(a==null?void 0:a.team.name)===(l==null?void 0:l.team.name),u=(a==null?void 0:a.team.name)===(c==null?void 0:c.team.name);return o.jsxs("div",{className:"flex w-full py-3 text-base",children:[o.jsx("div",{className:"flex flex-1 items-center justify-center px-2",children:o.jsx(Wt,{team:c.team,isWinner:u,isActive:n===Ze,useAlias:e,layoutDirection:r?"column":"row"})}),o.jsx("div",{className:"ms-2 flex items-center justify-start sm:ms-8",children:o.jsx(Ht,{score:c.score,scoreSuffix:c.score_suffix,scoreParenthetical:c.score_parenthetical?{message:c.score_parenthetical,position:"bottom"}:null,isWinner:u,negateScore:zt(s,Ze,n),className:"text-sm font-semibold sm:text-lg"})}),o.jsx("div",{className:"mx-2 flex w-24 shrink flex-col items-center justify-center gap-1 align-middle text-sm",children:o.jsx(Nr,{game:t})}),o.jsx("div",{className:"me-2 flex items-center justify-end sm:me-8",children:o.jsx(Ht,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"bottom"}:null,isWinner:d,negateScore:zt(s,Ge,n),className:"text-sm font-semibold sm:text-lg"})}),o.jsx("div",{className:"flex flex-1 items-center justify-center md:px-2",children:o.jsx(Wt,{team:l.team,isWinner:d,isActive:n===Ge,useAlias:e,layoutDirection:r?"column":"row"})})]})}function Cr(t){return t.live?"live":new Date(t.date)<new Date?"complete":"scheduled"}function Sr(t){return Cr(t)!=="complete"||t.first_team_info.score==null||t.second_team_info.score==null?null:t.first_team_info.score>t.second_team_info.score?t.first_team_info:t.second_team_info}function zt(t,e,s){return xt.includes(t)&&e===Ge&&s===Ze}function Wt({team:t,isWinner:e,isActive:s,logoSize:n,useAlias:r=!1,layoutDirection:a="row"}){return o.jsxs("span",{className:I("flex items-center gap-1",e&&"font-semibold","max-w-64 lg:max-w-52 xl:max-w-64",a==="column"&&"flex-col"),children:[t.logo&&o.jsx(kr,{team:{name:t.name,logo:t.logo},className:I(n==="small"?"w-6":"w-8")}),o.jsx("span",{className:"truncate",children:r?t.alias:t.name}),s&&o.jsx("span",{className:"bg-token-surface-error inline-block h-2 w-2 rounded-full"})]})}function Ht({score:t,scoreSuffix:e,scoreParenthetical:s,isWinner:n,negateScore:r=!1,className:a}){const i=le();return t==null?null:o.jsxs("span",{className:I(n&&"font-semibold",a),children:[r?i.formatMessage({id:"sports.dash",defaultMessage:"-"}):t,e&&!r&&o.jsx("span",{children:e}),s&&!r&&o.jsx("span",{className:I("text-token-text-secondary font-normal",s.position==="right"&&"ms-1",s.position==="bottom"&&"mx-auto block text-center"),children:"(".concat(s.message,")")})]})}function Nr({game:t}){const e=le();switch(Cr(t)){case"live":return o.jsxs(o.Fragment,{children:[o.jsx(oh,{}),o.jsx("div",{children:t.details})]});case"complete":return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:o.jsx(H,{id:"q/iMZL",defaultMessage:"Final"})}),o.jsx("div",{className:"text-token-text-secondary",children:Ss(e,new Date(t.date))})]});case"scheduled":{const s=new Date(t.date);return isNaN(s.getTime())?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{children:Ss(e,s)}),o.jsx("div",{className:"text-token-text-secondary",children:e.formatDate(s,{timeStyle:"short"})})]})}}}function oh(){return o.jsx("div",{className:"bg-token-surface-error rounded-[4px] px-1.5 py-1 text-xs font-semibold text-white",children:o.jsx(H,{id:"vObALn",defaultMessage:"Live"})})}function rh({standingsRef:t,trackContentReferenceEvent:e}){const[s,n]=p.useState(0),r=t.conferences.length>0,a=bt(),i=t.league.id;p.useEffect(()=>{r&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasStandings:!0})},[r]);const l=t.conferences[s],c=t.conferences.length>1?t.conferences.map((d,u)=>o.jsx("button",{className:I(s===u?"text-token-text-primary":"text-token-text-tertiary","text-sm font-semibold"),onClick:()=>n(u),children:d.name},d.name)):null;return o.jsxs("div",{"data-testid":"sports-standings-widget",children:[c&&o.jsx("div",{className:"flex gap-4",children:c}),o.jsx("div",{className:"mt-3",children:l.divisions.map(d=>d.name?o.jsx("div",{className:"mt-3",children:o.jsx(lo,{division:d,teamsColumnHeader:d.name})},d.name):o.jsx(lo,{division:d,useAlias:a&&xt.includes(i)}))})]})}function lo({division:t,teamsColumnHeader:e,useAlias:s}){const n=t.headers.map(r=>r.key);return o.jsxs(Ee.Root,{size:"compact",className:"not-prose",children:[o.jsxs(Ee.Header,{children:[o.jsx(ah,{children:e!=null?e:o.jsx(H,{id:"kKSGje",defaultMessage:"Team"})}),t.headers.map(r=>o.jsx(Mr,{textAlign:"center",className:"min-w-11 px-0!",children:o.jsx(co,{data:r})},r.key))]}),o.jsx(Ee.Body,{children:t.teams.map(({team:r,data:a},i)=>{const l=a.reduce((c,d)=>(c[d.key]=d,c),{});return o.jsxs(Ee.Row,{children:[o.jsx(Ee.Cell,{className:"w-full border-0! py-0! ps-0!",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"text-token-text-tertiary me-2 w-4 whitespace-nowrap tabular-nums",children:i+1}),o.jsxs("div",{className:"flex items-center justify-start gap-2",children:[o.jsx(kr,{team:r,className:"w-6"}),o.jsx("span",{className:"text-base whitespace-nowrap",children:s?r.alias:r.name})]})]})}),n.map(c=>o.jsx(Ee.Cell,{className:"min-w-11 border-0! px-0! py-0! text-start whitespace-nowrap tabular-nums",textAlign:"center",children:o.jsx(co,{data:l[c]})},c))]},r.name)})})]})}function co({data:t}){switch(t.type){case"text":return o.jsx(o.Fragment,{children:t.text});default:return o.jsx(o.Fragment,{children:t.alt})}}var ho;const Mr=$o(Ee.HeaderCell)(ho||(ho=jt(["text-token-text-secondary font-normal! text-sm static! bg-transparent! border-token-border-default! border-t-0! border-s-0! border-e-0!"])));var po;const ah=$o(Mr)(po||(po=jt(["text-token-text-primary ps-0!"])));function ih({metadata:t,trackContentReferenceEvent:e}){p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=le(),n=ft(t.utc_time,t.utc_offset),r=s.formatDate(n,{hour:"numeric",minute:"numeric"});return o.jsx("span",{children:r})}function lh({metadata:t,trackContentReferenceEvent:e}){return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]),o.jsx("div",{children:t.url?o.jsx(bl,{webpageItem:{url:t.url,title:t.description,pub_date:null,snippet:"",attributions:null},className:"inline-flex flex-col",children:o.jsx(Qe,{href:t.url,className:"font-semibold!",children:t.description})}):o.jsx("div",{className:"font-semibold!",children:t.description})})}function ch({videoId:t,title:e="YouTube video player",fallbackText:s,cookieLess:n=!0,timeoutMs:r=5e3,className:a=""}){const i=p.useRef(null),l=p.useRef(null),c=p.useRef(!1),[d,u]=p.useState("idle"),m=()=>{c.current=!0,l.current&&(clearTimeout(l.current),l.current=null)};if(p.useEffect(()=>{u("loading"),c.current=!1;let x=null;return dh().then(()=>{if(!i.current)return;i.current.textContent="",x=document.createElement("div"),x.style.width="200px",x.style.height="150px",i.current.appendChild(x),l.current=window.setTimeout(()=>{c.current||u("timeout")},r);const _=n?"https://www.youtube-nocookie.com":"https://www.youtube.com";new window.YT.Player(x,{width:200,height:150,videoId:t,host:_,playerVars:{rel:0,playsinline:1,origin:window.location.origin},events:{onReady:()=>{m(),u("ready")},onError:()=>{m(),u("error")}}})}).catch(()=>u("error")),()=>{m()}},[t,n,r]),d==="error"||d==="timeout")return o.jsx("a",{href:"https://www.youtube.com/watch?v=".concat(t),target:"_blank",rel:"noopener noreferrer",children:s});const h=n?"https://www.youtube-nocookie.com":"https://www.youtube.com";return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:i,"aria-hidden":!0,inert:!0,className:"hidden"}),o.jsx("iframe",{src:"".concat(h,"/embed/").concat(t),allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:a,title:e})]})}function dh(){return new Promise(t=>{var s;if((s=window.YT)!=null&&s.Player)return t();const e=window.onYouTubeIframeAPIReady;if(window.onYouTubeIframeAPIReady=()=>{e==null||e(),t(),window.onYouTubeIframeAPIReady=e||(()=>{})},!document.querySelector("script[src*='youtube.com/iframe_api']")){const n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.head.appendChild(n)}})}function uh({url:t,className:e,iframeClassName:s,iframeTitle:n}){let r;const a=I("aspect-video w-full",s),i=mh(t);i&&(r=o.jsx(ch,{className:a,videoId:i,title:n,fallbackText:n!=null?n:o.jsx(H,{id:"sonic.video.youtube.title",defaultMessage:"YouTube video link"}),cookieLess:!1}));const l=fh(t);return l&&(r=o.jsx(hh,{videoId:l,className:a,iframeTitle:n})),r?o.jsx("div",{className:e,children:r}):null}function mh(t){const e=/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|shorts\/|embed\/|v\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,s=t.match(e);return s?s[1]:null}function fh(t){const e=/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/[^/]+\/videos\/|video\/|)(\d+)/,s=t.match(e);return s?s[1]:null}function hh({videoId:t,className:e,iframeTitle:s}){return o.jsx(o.Fragment,{children:o.jsx("iframe",{className:e,src:"https://player.vimeo.com/video/".concat(t),frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:s})})}function ph({video:t,trackContentReferenceEvent:e}){const s={url:t.url,title:t.title};return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,s)},[]),t.url==null||t.url===""?null:o.jsx("div",{className:"not-prose mb-3 flex flex-col gap-4 text-base","data-testid":"video-widget",children:o.jsx(uh,{url:t.url,iframeClassName:"rounded-lg"})})}const gh="webp",xh=96,yh=96,bh="srgb",_h=4,vh="uchar",wh=288,jh=!1,kh=!1,Ch=!0,Sh="{{.assetPrefix}}/assets/cloud-foggy-o4a3hmky.webp",Nh={format:gh,width:xh,height:yh,space:bh,channels:_h,depth:vh,density:wh,isProgressive:jh,hasProfile:kh,hasAlpha:Ch,src:Sh},Mh="webp",Eh=96,Th=96,$h="srgb",Ph=4,Ah="uchar",Ih=288,Lh=!1,Rh=!1,Dh=!0,Fh="{{.assetPrefix}}/assets/cloudy-co8vwrk7.webp",Oh={format:Mh,width:Eh,height:Th,space:$h,channels:Ph,depth:Ah,density:Ih,isProgressive:Lh,hasProfile:Rh,hasAlpha:Dh,src:Fh},zh="webp",Wh=96,Hh=96,Bh="srgb",Vh=4,Uh="uchar",qh=288,Gh=!1,Zh=!1,Xh=!0,Yh="{{.assetPrefix}}/assets/heavy-snow-mke52kag.webp",Kh={format:zh,width:Wh,height:Hh,space:Bh,channels:Vh,depth:Uh,density:qh,isProgressive:Gh,hasProfile:Zh,hasAlpha:Xh,src:Yh},Jh="webp",Qh=96,ep=96,tp="srgb",sp=4,np="uchar",op=288,rp=!1,ap=!1,ip=!0,lp="{{.assetPrefix}}/assets/light-snow-mcy1l7t9.webp",cp={format:Jh,width:Qh,height:ep,space:tp,channels:sp,depth:np,density:op,isProgressive:rp,hasProfile:ap,hasAlpha:ip,src:lp},dp="webp",up=96,mp=96,fp="srgb",hp=4,pp="uchar",gp=288,xp=!1,yp=!1,bp=!0,_p="{{.assetPrefix}}/assets/moon-drizzle-cplxr2ub.webp",vp={format:dp,width:up,height:mp,space:fp,channels:hp,depth:pp,density:gp,isProgressive:xp,hasProfile:yp,hasAlpha:bp,src:_p},wp="webp",jp=96,kp=96,Cp="srgb",Sp=4,Np="uchar",Mp=288,Ep=!1,Tp=!1,$p=!0,Pp="{{.assetPrefix}}/assets/moon-hazy-jvgt25bp.webp",Ap={format:wp,width:jp,height:kp,space:Cp,channels:Sp,depth:Np,density:Mp,isProgressive:Ep,hasProfile:Tp,hasAlpha:$p,src:Pp},Ip="webp",Lp=96,Rp=96,Dp="srgb",Fp=4,Op="uchar",zp=288,Wp=!1,Hp=!1,Bp=!0,Vp="{{.assetPrefix}}/assets/moon-mostly-cloudy-cia3do0v.webp",Up={format:Ip,width:Lp,height:Rp,space:Dp,channels:Fp,depth:Op,density:zp,isProgressive:Wp,hasProfile:Hp,hasAlpha:Bp,src:Vp},qp="webp",Gp=96,Zp=96,Xp="srgb",Yp=4,Kp="uchar",Jp=288,Qp=!1,eg=!1,tg=!0,sg="{{.assetPrefix}}/assets/moon-mostly-sunny-n3mh1b6a.webp",ng={format:qp,width:Gp,height:Zp,space:Xp,channels:Yp,depth:Kp,density:Jp,isProgressive:Qp,hasProfile:eg,hasAlpha:tg,src:sg},og="webp",rg=96,ag=96,ig="srgb",lg=4,cg="uchar",dg=288,ug=!1,mg=!1,fg=!0,hg="{{.assetPrefix}}/assets/moon-shower-ntzhti9o.webp",pg={format:og,width:rg,height:ag,space:ig,channels:lg,depth:cg,density:dg,isProgressive:ug,hasProfile:mg,hasAlpha:fg,src:hg},gg="webp",xg=96,yg=96,bg="srgb",_g=4,vg="uchar",wg=288,jg=!1,kg=!1,Cg=!0,Sg="{{.assetPrefix}}/assets/moon-sunny-eg2emh4d.webp",Ng={format:gg,width:xg,height:yg,space:bg,channels:_g,depth:vg,density:wg,isProgressive:jg,hasProfile:kg,hasAlpha:Cg,src:Sg},Mg="webp",Eg=96,Tg=96,$g="srgb",Pg=4,Ag="uchar",Ig=288,Lg=!1,Rg=!1,Dg=!0,Fg="{{.assetPrefix}}/assets/rain-thunder-bx7a0l5g.webp",Og={format:Mg,width:Eg,height:Tg,space:$g,channels:Pg,depth:Ag,density:Ig,isProgressive:Lg,hasProfile:Rg,hasAlpha:Dg,src:Fg},zg="webp",Wg=96,Hg=96,Bg="srgb",Vg=4,Ug="uchar",qg=288,Gg=!1,Zg=!1,Xg=!0,Yg="{{.assetPrefix}}/assets/rain-cxs76xuj.webp",Kg={format:zg,width:Wg,height:Hg,space:Bg,channels:Vg,depth:Ug,density:qg,isProgressive:Gg,hasProfile:Zg,hasAlpha:Xg,src:Yg},Jg="webp",Qg=96,ex=96,tx="srgb",sx=4,nx="uchar",ox=288,rx=!1,ax=!1,ix=!0,lx="{{.assetPrefix}}/assets/sleet-gc63vwmo.webp",cx={format:Jg,width:Qg,height:ex,space:tx,channels:sx,depth:nx,density:ox,isProgressive:rx,hasProfile:ax,hasAlpha:ix,src:lx},dx="webp",ux=96,mx=96,fx="srgb",hx=4,px="uchar",gx=288,xx=!1,yx=!1,bx=!0,_x="{{.assetPrefix}}/assets/snow-d0k6tmmc.webp",vx={format:dx,width:ux,height:mx,space:fx,channels:hx,depth:px,density:gx,isProgressive:xx,hasProfile:yx,hasAlpha:bx,src:_x},wx="webp",jx=96,kx=96,Cx="srgb",Sx=4,Nx="uchar",Mx=288,Ex=!1,Tx=!1,$x=!0,Px="{{.assetPrefix}}/assets/sun-drizzle-g94obr5e.webp",Ax={format:wx,width:jx,height:kx,space:Cx,channels:Sx,depth:Nx,density:Mx,isProgressive:Ex,hasProfile:Tx,hasAlpha:$x,src:Px},Ix="webp",Lx=96,Rx=96,Dx="srgb",Fx=4,Ox="uchar",zx=288,Wx=!1,Hx=!1,Bx=!0,Vx="{{.assetPrefix}}/assets/sun-hazy-c3z1j0hy.webp",Ux={format:Ix,width:Lx,height:Rx,space:Dx,channels:Fx,depth:Ox,density:zx,isProgressive:Wx,hasProfile:Hx,hasAlpha:Bx,src:Vx},qx="webp",Gx=96,Zx=96,Xx="srgb",Yx=4,Kx="uchar",Jx=288,Qx=!1,e1=!1,t1=!0,s1="{{.assetPrefix}}/assets/sun-mostly-cloudy-d4o4zkga.webp",n1={format:qx,width:Gx,height:Zx,space:Xx,channels:Yx,depth:Kx,density:Jx,isProgressive:Qx,hasProfile:e1,hasAlpha:t1,src:s1},o1="webp",r1=96,a1=96,i1="srgb",l1=4,c1="uchar",d1=288,u1=!1,m1=!1,f1=!0,h1="{{.assetPrefix}}/assets/sun-mostly-sunny-livrdkgu.webp",p1={format:o1,width:r1,height:a1,space:i1,channels:l1,depth:c1,density:d1,isProgressive:u1,hasProfile:m1,hasAlpha:f1,src:h1},g1="webp",x1=96,y1=96,b1="srgb",_1=4,v1="uchar",w1=288,j1=!1,k1=!1,C1=!0,S1="{{.assetPrefix}}/assets/sun-shower-lvtjthah.webp",N1={format:g1,width:x1,height:y1,space:b1,channels:_1,depth:v1,density:w1,isProgressive:j1,hasProfile:k1,hasAlpha:C1,src:S1},M1="webp",E1=96,T1=96,$1="srgb",P1=4,A1="uchar",I1=288,L1=!1,R1=!1,D1=!0,F1="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",O1={format:M1,width:E1,height:T1,space:$1,channels:P1,depth:A1,density:I1,isProgressive:L1,hasProfile:R1,hasAlpha:D1,src:F1},z1="webp",W1=96,H1=96,B1="srgb",V1=4,U1="uchar",q1=288,G1=!1,Z1=!1,X1=!0,Y1="{{.assetPrefix}}/assets/thunder-jgjqg9ai.webp",K1={format:z1,width:W1,height:H1,space:B1,channels:V1,depth:U1,density:q1,isProgressive:G1,hasProfile:Z1,hasAlpha:X1,src:Y1},J1="webp",Q1=96,e0=96,t0="srgb",s0=4,n0="uchar",o0=288,r0=!1,a0=!1,i0=!0,l0="{{.assetPrefix}}/assets/tornado-opa24tq3.webp",c0={format:J1,width:Q1,height:e0,space:t0,channels:s0,depth:n0,density:o0,isProgressive:r0,hasProfile:a0,hasAlpha:i0,src:l0},d0="webp",u0=96,m0=96,f0="srgb",h0=4,p0="uchar",g0=288,x0=!1,y0=!1,b0=!0,_0="{{.assetPrefix}}/assets/windy-mw0a3u21.webp",v0={format:d0,width:u0,height:m0,space:f0,channels:h0,depth:p0,density:g0,isProgressive:x0,hasProfile:y0,hasAlpha:b0,src:_0},w0="webp",j0=96,k0=96,C0="srgb",S0=4,N0="uchar",M0=288,E0=!1,T0=!1,$0=!0,P0="{{.assetPrefix}}/assets/cloud-foggy-fhg0jn0w.webp",A0={format:w0,width:j0,height:k0,space:C0,channels:S0,depth:N0,density:M0,isProgressive:E0,hasProfile:T0,hasAlpha:$0,src:P0},I0="webp",L0=96,R0=96,D0="srgb",F0=4,O0="uchar",z0=288,W0=!1,H0=!1,B0=!0,V0="{{.assetPrefix}}/assets/cloudy-disd26f3.webp",U0={format:I0,width:L0,height:R0,space:D0,channels:F0,depth:O0,density:z0,isProgressive:W0,hasProfile:H0,hasAlpha:B0,src:V0},q0="webp",G0=96,Z0=96,X0="srgb",Y0=4,K0="uchar",J0=288,Q0=!1,ey=!1,ty=!0,sy="{{.assetPrefix}}/assets/heavy-snow-g6jjwo2d.webp",ny={format:q0,width:G0,height:Z0,space:X0,channels:Y0,depth:K0,density:J0,isProgressive:Q0,hasProfile:ey,hasAlpha:ty,src:sy},oy="webp",ry=96,ay=96,iy="srgb",ly=4,cy="uchar",dy=288,uy=!1,my=!1,fy=!0,hy="{{.assetPrefix}}/assets/light-snow-iz0efpkh.webp",py={format:oy,width:ry,height:ay,space:iy,channels:ly,depth:cy,density:dy,isProgressive:uy,hasProfile:my,hasAlpha:fy,src:hy},gy="webp",xy=96,yy=96,by="srgb",_y=4,vy="uchar",wy=288,jy=!1,ky=!1,Cy=!0,Sy="{{.assetPrefix}}/assets/moon-drizzle-b1nfv39c.webp",Ny={format:gy,width:xy,height:yy,space:by,channels:_y,depth:vy,density:wy,isProgressive:jy,hasProfile:ky,hasAlpha:Cy,src:Sy},My="webp",Ey=96,Ty=96,$y="srgb",Py=4,Ay="uchar",Iy=288,Ly=!1,Ry=!1,Dy=!0,Fy="{{.assetPrefix}}/assets/moon-hazy-nfnzea7a.webp",Oy={format:My,width:Ey,height:Ty,space:$y,channels:Py,depth:Ay,density:Iy,isProgressive:Ly,hasProfile:Ry,hasAlpha:Dy,src:Fy},zy="webp",Wy=96,Hy=96,By="srgb",Vy=4,Uy="uchar",qy=288,Gy=!1,Zy=!1,Xy=!0,Yy="{{.assetPrefix}}/assets/moon-mostly-cloudy-e56e3z55.webp",Ky={format:zy,width:Wy,height:Hy,space:By,channels:Vy,depth:Uy,density:qy,isProgressive:Gy,hasProfile:Zy,hasAlpha:Xy,src:Yy},Jy="webp",Qy=96,eb=96,tb="srgb",sb=4,nb="uchar",ob=288,rb=!1,ab=!1,ib=!0,lb="{{.assetPrefix}}/assets/moon-mostly-sunny-ffu4gzf4.webp",cb={format:Jy,width:Qy,height:eb,space:tb,channels:sb,depth:nb,density:ob,isProgressive:rb,hasProfile:ab,hasAlpha:ib,src:lb},db="webp",ub=96,mb=96,fb="srgb",hb=4,pb="uchar",gb=288,xb=!1,yb=!1,bb=!0,_b="{{.assetPrefix}}/assets/moon-shower-e5dy9u48.webp",vb={format:db,width:ub,height:mb,space:fb,channels:hb,depth:pb,density:gb,isProgressive:xb,hasProfile:yb,hasAlpha:bb,src:_b},wb="webp",jb=96,kb=96,Cb="srgb",Sb=4,Nb="uchar",Mb=288,Eb=!1,Tb=!1,$b=!0,Pb="{{.assetPrefix}}/assets/moon-sunny-d9o08xiw.webp",Ab={format:wb,width:jb,height:kb,space:Cb,channels:Sb,depth:Nb,density:Mb,isProgressive:Eb,hasProfile:Tb,hasAlpha:$b,src:Pb},Ib="webp",Lb=96,Rb=96,Db="srgb",Fb=4,Ob="uchar",zb=288,Wb=!1,Hb=!1,Bb=!0,Vb="{{.assetPrefix}}/assets/rain-thunder-eplemvu1.webp",Ub={format:Ib,width:Lb,height:Rb,space:Db,channels:Fb,depth:Ob,density:zb,isProgressive:Wb,hasProfile:Hb,hasAlpha:Bb,src:Vb},qb="webp",Gb=96,Zb=96,Xb="srgb",Yb=4,Kb="uchar",Jb=288,Qb=!1,e_=!1,t_=!0,s_="{{.assetPrefix}}/assets/rain-ogayr6kt.webp",n_={format:qb,width:Gb,height:Zb,space:Xb,channels:Yb,depth:Kb,density:Jb,isProgressive:Qb,hasProfile:e_,hasAlpha:t_,src:s_},o_="webp",r_=96,a_=96,i_="srgb",l_=4,c_="uchar",d_=288,u_=!1,m_=!1,f_=!0,h_="{{.assetPrefix}}/assets/sleet-o8noil7l.webp",p_={format:o_,width:r_,height:a_,space:i_,channels:l_,depth:c_,density:d_,isProgressive:u_,hasProfile:m_,hasAlpha:f_,src:h_},g_="webp",x_=96,y_=96,b_="srgb",__=4,v_="uchar",w_=288,j_=!1,k_=!1,C_=!0,S_="{{.assetPrefix}}/assets/snow-lq4cl3uc.webp",N_={format:g_,width:x_,height:y_,space:b_,channels:__,depth:v_,density:w_,isProgressive:j_,hasProfile:k_,hasAlpha:C_,src:S_},M_="webp",E_=96,T_=96,$_="srgb",P_=4,A_="uchar",I_=288,L_=!1,R_=!1,D_=!0,F_="{{.assetPrefix}}/assets/sun-drizzle-htsohv65.webp",O_={format:M_,width:E_,height:T_,space:$_,channels:P_,depth:A_,density:I_,isProgressive:L_,hasProfile:R_,hasAlpha:D_,src:F_},z_="webp",W_=96,H_=96,B_="srgb",V_=4,U_="uchar",q_=288,G_=!1,Z_=!1,X_=!0,Y_="{{.assetPrefix}}/assets/sun-hazy-nfj7clcd.webp",K_={format:z_,width:W_,height:H_,space:B_,channels:V_,depth:U_,density:q_,isProgressive:G_,hasProfile:Z_,hasAlpha:X_,src:Y_},J_="webp",Q_=96,ev=96,tv="srgb",sv=4,nv="uchar",ov=288,rv=!1,av=!1,iv=!0,lv="{{.assetPrefix}}/assets/sun-mostly-cloudy-e3pqqgs7.webp",cv={format:J_,width:Q_,height:ev,space:tv,channels:sv,depth:nv,density:ov,isProgressive:rv,hasProfile:av,hasAlpha:iv,src:lv},dv="webp",uv=96,mv=96,fv="srgb",hv=4,pv="uchar",gv=288,xv=!1,yv=!1,bv=!0,_v="{{.assetPrefix}}/assets/sun-mostly-sunny-o99k1c7a.webp",vv={format:dv,width:uv,height:mv,space:fv,channels:hv,depth:pv,density:gv,isProgressive:xv,hasProfile:yv,hasAlpha:bv,src:_v},wv="webp",jv=96,kv=96,Cv="srgb",Sv=4,Nv="uchar",Mv=288,Ev=!1,Tv=!1,$v=!0,Pv="{{.assetPrefix}}/assets/sun-shower-ldwl4jbp.webp",Av={format:wv,width:jv,height:kv,space:Cv,channels:Sv,depth:Nv,density:Mv,isProgressive:Ev,hasProfile:Tv,hasAlpha:$v,src:Pv},Iv="webp",Lv=96,Rv=96,Dv="srgb",Fv=4,Ov="uchar",zv=288,Wv=!1,Hv=!1,Bv=!0,Vv="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",Uv={format:Iv,width:Lv,height:Rv,space:Dv,channels:Fv,depth:Ov,density:zv,isProgressive:Wv,hasProfile:Hv,hasAlpha:Bv,src:Vv},qv="webp",Gv=96,Zv=96,Xv="srgb",Yv=4,Kv="uchar",Jv=288,Qv=!1,ew=!1,tw=!0,sw="{{.assetPrefix}}/assets/thunder-xzn1cku3.webp",nw={format:qv,width:Gv,height:Zv,space:Xv,channels:Yv,depth:Kv,density:Jv,isProgressive:Qv,hasProfile:ew,hasAlpha:tw,src:sw},ow="webp",rw=96,aw=96,iw="srgb",lw=4,cw="uchar",dw=288,uw=!1,mw=!1,fw=!0,hw="{{.assetPrefix}}/assets/tornado-diqu61wg.webp",pw={format:ow,width:rw,height:aw,space:iw,channels:lw,depth:cw,density:dw,isProgressive:uw,hasProfile:mw,hasAlpha:fw,src:hw},gw="webp",xw=96,yw=96,bw="srgb",_w=4,vw="uchar",ww=288,jw=!1,kw=!1,Cw=!0,Sw="{{.assetPrefix}}/assets/windy-n2v8wtyp.webp",Nw={format:gw,width:xw,height:yw,space:bw,channels:_w,depth:vw,density:ww,isProgressive:jw,hasProfile:kw,hasAlpha:Cw,src:Sw},Mw={foggy:{default:Nh},cloudy:{default:Oh},"heavy-snow":{default:Kh},"light-snow":{default:cp},sleet:{default:cx},drizzle:{default:Ax,night:vp},hazy:{default:Ux,night:Ap},"mostly-cloudy":{default:n1,night:Up},"mostly-sunny":{default:p1,night:ng},shower:{default:N1,night:pg},sunny:{default:O1,night:Ng},"rain-thunder":{default:Og},rain:{default:Kg},snow:{default:vx},thunder:{default:K1},tornado:{default:c0},windy:{default:v0}},Ew={foggy:{default:A0},cloudy:{default:U0},"heavy-snow":{default:ny},"light-snow":{default:py},sleet:{default:p_},drizzle:{default:O_,night:Ny},hazy:{default:K_,night:Oy},"mostly-cloudy":{default:cv,night:Ky},"mostly-sunny":{default:vv,night:cb},shower:{default:Av,night:vb},sunny:{default:Uv,night:Ab},"rain-thunder":{default:Ub},rain:{default:n_},snow:{default:N_},thunder:{default:nw},tornado:{default:pw},windy:{default:Nw}};function Tw({weatherCode:t,isDarkMode:e,isNight:s}){const n=e?Ew:Mw,r=$w(t),a=n[r];return a.night&&s?a.night:a.default}function $w(t){switch(t){case 1:case 33:return"sunny";case 2:case 3:case 34:case 35:case 36:return"mostly-sunny";case 4:case 6:case 13:case 14:case 38:return"mostly-cloudy";case 5:case 37:return"hazy";case 7:case 8:return"cloudy";case 11:return"foggy";case 12:case 39:case 40:return"shower";case 15:case 16:case 17:case 41:case 42:return"thunder";case 18:return"rain";case 19:case 20:case 21:case 43:return"light-snow";case 22:case 23:case 44:return"snow";case 24:case 25:case 26:case 29:return"sleet";case 32:return"windy";default:return"cloudy"}}const Pw="C";function Aw(t,e){return Math.round(t==="F"?e*9/5+32:(e-32)*5/9)}function uo(t,e,s=Pw){return t===s?"".concat(Math.round(e),"°"):"".concat(Aw(t,e),"°")}const Iw=X(()=>Z(()=>import("./jeaomqbuafptryjs.js"),__vite__mapDeps([36,1])),{loading:t=>Q(t)}),Lw=X(()=>Z(()=>import("./hahiy9dm7k71twz4.js"),__vite__mapDeps([37,1])),{loading:t=>Q(t)}),Rw=X(()=>Z(()=>import("./ep5wvjiuce9gz0i0.js"),__vite__mapDeps([38,1])),{loading:t=>Q(t)}),Dw=7,mo=8,Fw=p.memo(function({weatherResults:e,dateRange:s,turnIndex:n,trackContentReferenceEvent:r}){const[a,i]=Xw(),l=Ww(e);p.useEffect(()=>{r("Search Content Reference Shown","search_content_reference_shown","forecast")},[r]);const{daily:c,hourly:d,historical:u}=e;let m="daily";if(s||d&&c.length<2)m="hourly";else if(c.length>0)m="daily";else if(u&&(u==null?void 0:u.length)>0)m="historical";else return null;return o.jsxs("div",{className:"relative","data-testid":"weather-widget",children:[l?o.jsxs(o.Fragment,{children:[o.jsx(zw,{weatherResults:e}),o.jsx(Hw,{weatherResults:e,temperatureUnit:a,setTemperatureUnit:i})]}):o.jsx("div",{className:"bg-token-main-surface-primary absolute end-0 top-3 z-10 rounded-sm",children:o.jsx(Er,{onTemperatureUnitChange:i,temperatureUnit:a})}),o.jsx(qw,{turnIndex:n}),m==="hourly"&&o.jsx(Bw,{weatherResults:e,temperatureUnit:a,dateRange:s}),m==="daily"&&o.jsx(Vw,{dailyForecast:c.slice(0,Dw),temperatureUnit:a}),m==="historical"&&o.jsx(Uw,{historical:u,temperatureUnit:a})]})});function Ow({weatherAlert:t}){const[e,s]=p.useState(!1),n=le(),r=Eo(),a=ze(t.start_timestamp,t.utc_offset_sec),i=t.end_timestamp?ze(t.end_timestamp,t.utc_offset_sec):null,l=o.jsxs(o.Fragment,{children:[o.jsx("div",{children:o.jsx(H,{id:"JnuGPS",defaultMessage:"{start}{separator}{end}",values:{start:n.formatDate(a,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),separator:i?" - ":"",end:i?n.formatDate(i,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):""}})}),o.jsx("div",{children:t.summary})]});return o.jsxs("button",{className:"my-2 flex w-full flex-col gap-2 rounded-xl border border-red-200 bg-red-100 px-4 py-3 text-start text-sm text-red-800",onClick:()=>s(!e),children:[o.jsxs("div",{className:"flex w-full items-center gap-4",children:[o.jsx(Lw,{className:"h-9 w-9 shrink-0"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"font-bold",children:o.jsx(H,{id:"y+fy/l",defaultMessage:"Severe Weather: {name}",values:{name:t.name}})}),r&&l]}),o.jsx("div",{className:"grow"}),o.jsx("div",{className:"opacity-30",children:e?o.jsx(Ol,{className:"icon-lg"}):o.jsx(Fl,{className:"icon-lg"})})]}),e&&t.details&&o.jsxs(o.Fragment,{children:[!r&&l,o.jsx("div",{className:"mt-1 whitespace-pre-wrap",children:t.details.trim()})]})]})}function zw({weatherResults:t}){const{severe:e}=t;return e?o.jsx("div",{className:"my-2",children:e.map((s,n)=>o.jsx(Ow,{weatherAlert:s},n))}):null}function Ww(t){const{historical:e,daily:s,hourly:n,current:r}=t;if(!r)return!1;let a=!1;const i=ze(r.timestamp,r.utc_offset_sec);for(const l of[e,s,n])l&&(a=a||(l==null?void 0:l.some(c=>Pa(i,ze(c.timestamp,c.utc_offset_sec)))));return a}function Hw({weatherResults:t,temperatureUnit:e,setTemperatureUnit:s}){const n=le(),{current:r}=t;if(!r)return null;const a=r.temperature.current,i=r.description,l=a!=null&&i&&" · ";return o.jsxs("div",{className:"not-prose flex items-center gap-4",children:[o.jsxs("div",{className:"grow",children:[o.jsxs("div",{className:"text-lg font-semibold",children:[a!=null&&o.jsx(H,{id:"FiwByI",defaultMessage:"Currently {temperature}",values:{temperature:Xe(n,a,e)}}),l,i.description]}),o.jsx("div",{className:"text-token-text-secondary",children:Zw(t.location)})]}),o.jsxs("div",{className:"flex",children:[o.jsx(Er,{onTemperatureUnitChange:s,temperatureUnit:e}),o.jsx(Js,{weatherDescriptionData:i,isNight:r.night})]})]})}function Ks({children:t}){return o.jsx("div",{className:"no-scrollbar not-prose mt-1 overflow-auto sm:overflow-hidden",children:o.jsx(Ee.Root,{className:"min-w-0",children:o.jsx(Ee.Body,{className:"border-token-border-medium border-b-[0.5px] [&_tr:last-child]:border-b-0",children:t})})})}function Bw({weatherResults:t,temperatureUnit:e,dateRange:s}){const n=le(),{hourly:r,current:a}=t;let i=r!=null?r:[];s&&(i=i.filter(u=>u.timestamp>=s.start_timestamp&&u.timestamp<s.end_timestamp));const[l,c]=p.useState(!1),d=i.length>mo;if(!l&&d){const u=i[0],m=ze(u.timestamp,u.utc_offset_sec);let h=!1;if(a){const x=ze(a.timestamp,a.utc_offset_sec);m.getTime()-x.getTime()>480*60*1e3&&i.length>18&&(i=i.slice(7,18),h=!0)}h||(i=i.slice(0,mo))}return o.jsxs(Ks,{children:[i.map((u,m)=>o.jsxs(Ee.Row,{children:[o.jsxs(Ae,{className:"w-44",children:[o.jsx(Js,{weatherDescriptionData:u.description,isNight:u.night,size:"small"}),o.jsx("div",{className:"ms-3 whitespace-nowrap",children:o.jsx("span",{className:"lowercase",children:Gw(n,u)})})]}),o.jsx(Ae,{className:"w-[60px] tabular-nums",children:o.jsx("div",{children:Xe(n,u.temperature.current,e)})}),o.jsx(Ae,{children:u.description.description})]},m)),d&&o.jsx(Ee.Row,{children:o.jsx(Ae,{className:"w-44",children:o.jsx(Pe,{color:"secondary",onClick:()=>c(!l),size:"small",children:l?o.jsx(H,{id:"KoC8Ym",defaultMessage:"Show less"}):o.jsx(H,{id:"X8F8Y/",defaultMessage:"Show more"})})})})]})}function Vw({dailyForecast:t,temperatureUnit:e}){const s=le();return o.jsx(Ks,{children:t.map((n,r)=>o.jsxs(Ee.Row,{children:[o.jsxs(Ae,{className:"w-[7.5rem] min-w-[7.5rem]",children:[o.jsx(Js,{weatherDescriptionData:n.description,isNight:n.night,size:"small"}),o.jsx("div",{className:"ms-3 whitespace-nowrap",children:Ss(s,ze(n.timestamp,n.utc_offset_sec))})]}),o.jsxs(Ae,{className:"tabular-nums",children:[o.jsx("div",{children:Xe(s,n.temperature.max,e)}),o.jsx("div",{className:"text-token-text-secondary ms-1",children:Xe(s,n.temperature.min,e)})]}),o.jsx(Ae,{className:"min-w-80",children:n.description.description})]},r))})}function Uw({historical:t,temperatureUnit:e}){const s=le();return t?o.jsx(Ks,{children:t.map((n,r)=>{const a=ze(n.timestamp,n.utc_offset_sec);return o.jsxs(Ee.Row,{children:[o.jsx(Ae,{className:"w-[250px]",children:o.jsx("div",{className:"ms-3 whitespace-nowrap",children:s.formatDate(a,{weekday:"long",month:"short",day:"numeric"})})}),o.jsx(Ae,{className:"tabular-nums",children:n.temperature.max&&n.temperature.min?o.jsxs(o.Fragment,{children:[o.jsx("div",{children:Xe(s,n.temperature.max,e)}),o.jsx("div",{className:"text-token-text-secondary ms-1",children:Xe(s,n.temperature.min,e)})]}):o.jsx("div",{children:Xe(s,n.temperature.current,e)})}),o.jsx(Ae,{})]},r)})}):null}function Ae({className:t,children:e}){return o.jsx(Ee.Cell,{className:I("border-token-border-xlight! border-s-0! border-e-0! py-2! ps-4! pe-3! first:ps-0! last:pe-0!",t),divClassName:"items-start leading-relaxed",children:e})}function qw({turnIndex:t}){const e=Yi(n=>{var r,a;return(a=(r=n.thread)==null?void 0:r.turns[t])==null?void 0:a.use_location}),[s]=Ki();return!s.useLocation&&e?o.jsx("div",{className:"mt-3",children:o.jsx(Pe,{color:"secondary",icon:Iw,onClick:()=>{Ui.setSettingsModalOpen(!0)},children:o.jsx(H,{id:"f47VEc",defaultMessage:"Share precise location"})})}):null}function Er({temperatureUnit:t,onTemperatureUnitChange:e}){const s=n=>t===n?"font-bold":"font-light";return o.jsx(Aa,{size:"small",triggerButton:o.jsx("button",{className:"text-token-text-tertiary hover:text-token-text-primary flex items-center justify-center p-1.5",children:o.jsx(Rw,{className:"icon-sm"})}),children:o.jsxs(Ia.Item,{onClick:()=>{e(t==="C"?"F":"C")},className:"text-token-text-primary",children:[o.jsx(H,{id:"bQIoe/",defaultMessage:"Temperature"}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:s("F"),children:o.jsx(H,{id:"bvDeBB",defaultMessage:"°F"})}),o.jsx("div",{className:"mx-1 h-4 border-s border-gray-300"}),o.jsx("div",{className:s("C"),children:o.jsx(H,{id:"iNiz6O",defaultMessage:"°C"})})]})]})})}function Js({weatherDescriptionData:t,isNight:e=!1,size:s="normal"}){const n=Xt(),r=s==="small"?30:50;return o.jsx("img",{draggable:!1,alt:t.description,src:Tw({weatherCode:t.id,isDarkMode:n,isNight:e}).src,width:r,height:r})}function Gw(t,e){const s=ze(e.timestamp,e.utc_offset_sec);return t.formatDate(s,{hour:"numeric"})}function Xe(t,e,s){return e==null?"-":uo(s?s!=null?s:"F":Tr(t),e)}function Tr(t){const e=["en-US","en-BZ","en-BS","en-KY","en-PW"],s=t.locale||"en-US";return e.includes(s)?"F":"C"}function Zw(t){const e=t.name.split(",").map(s=>s.trim());return t.country&&!e.includes(t.country)&&e.push(t.country),e.join(", ")}const Xw=()=>{const t=le(),[e,s]=$a("USER_TEMPERATURE_UNIT",Tr(t),n=>["F","C"].includes(n));return[e,s]};function Yw({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:n,contentReferenceIndex:r}){var _;const a=xe(),i=Se(a,"1950533395"),l=Vs(),c=l?"sidebar":"primary",d="metadata"in t&&((_=t.metadata)!=null&&_.location)?String(t.metadata.location):void 0,u=p.useMemo(()=>({content_reference_start_index:t.start_idx,entity_name:t.name,category:t.category,conversation_type:c,contentReferenceIndex:r,metadata_location:d}),[t.start_idx,t.name,t.category,c,r,d]);p.useEffect(()=>{n("Entity Anchor Content Reference Shown","entity_anchor_content_reference_shown","entity",u)},[n,u]);const{openThreadSidebar:m}=_t(),{resetSidebarHistory:h}=Wo(),x=p.useCallback(v=>{var w,j;v.preventDefault(),n("Entity Anchor Content Reference Clicked","entity_anchor_content_reference_clicked","entity",u),e&&(l||h(),m({type:"entity",debugThreadId:void 0,messageId:s,contentReferenceStartIndex:t.start_idx,query:t.name,category:(w=t.category)!=null?w:void 0,extraParams:(j=t.extra_params)!=null?j:void 0}))},[n,u,e,l,m,s,t.start_idx,t.name,t.category,t.extra_params,h]);return t.category==="product_link"?i?o.jsx(Pe,{size:"medium",color:"secondary",className:"my-2",onClick:x,children:o.jsx(H,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):o.jsx("span",{className:"text-token-text-primary font-semibold",children:o.jsx(H,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):!i||t.status==="loading"?o.jsx("span",{className:"text-token-text-primary font-semibold",children:t.name}):o.jsx("span",{className:"hover:entity-accent entity-underline inline cursor-pointer align-baseline",onClick:x,children:o.jsx("span",{className:"whitespace-normal",children:t.name})})}const Kw=X(()=>Z(()=>import("./fccn8kjovbs6wko3.js"),__vite__mapDeps([39,1,5,6,40,4,7,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,12,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118])).then(t=>t.BusinessesMap)),Jw=t=>!!t.dil,Qw=t=>(t==null?void 0:t.type)==="element",e2=t=>t==="inline"||t==="block"||t==="container",t2=t=>{var s;if(!Qw(t))return;const e=(s=t.properties)==null?void 0:s.displayLayout;return e2(e)?e:void 0};function s2(t){"use forget";var B,K,te,A;const e=he.c(176),{index:s,FormattedText:n,node:r,wordFadeType:a}=t;let i;e[0]!==r?(i=t2(r),e[0]=r,e[1]=i):i=e[1];const l=i,c=parseInt(s,10),d=p.useContext(Ke),u=xe(),h=La({id:(te=(K=(B=d==null?void 0:d.message)==null?void 0:B.metadata)==null?void 0:K.model_slug)!=null?te:""},u)||Se(u,"2137702454");let x;e[2]!==u?(x=We(u),e[2]=u,e[3]=x):x=e[3];const _=x;let v;e[4]!==d||e[5]!==_?(v=g=>{if(!_||(d==null?void 0:d.analyticsMetadata.turnIndex)===void 0)return[void 0,void 0];const O=Ye.getConversationTurns(g),R=d.analyticsMetadata.turnIndex,W=O.findIndex(r2)===R,V=R>0?Ye.getConversationTurnAtIndex(g,R-1):null,Y=Ra(V==null?void 0:V.messages.filter(Da));return[W,Y]},e[4]=d,e[5]=_,e[6]=v):v=e[6];const[w,j]=Vt(d==null?void 0:d.clientThreadId,v),C=w===!0&&c===0,f=Ho(d==null?void 0:d.analyticsMetadata),y=p.useRef(!1);if(d==null)return null;const{contentReferences:k,onShowSearchResults:S,numImageResults:N,analyticsMetadata:E,message:$,superWidgetContent:P}=d,b=k==null?void 0:k[c];if(!b||E.turnIndex===void 0||b.type===void 0)return null;let F;e[7]===Symbol.for("react.memo_cache_sentinel")?(F={img:o2},e[7]=F):F=e[7];let L;e[8]!==b.alt?(L=o.jsx(Us,{components:F,children:b.alt}),e[8]=b.alt,e[9]=L):L=e[9];const T=L;let M=null;e:switch(b.type){case"title_citation":{let g;e[10]!==b||e[11]!==f?(g=o.jsx(lh,{metadata:b,trackContentReferenceEvent:f}),e[10]=b,e[11]=f,e[12]=g):g=e[12],M=g;break e}case"link_title":{let g;e[13]!==b||e[14]!==f?(g=o.jsx(Of,{metadata:b,trackContentReferenceEvent:f}),e[13]=b,e[14]=f,e[15]=g):g=e[15],M=g;break e}case"location_search":{let g;e[16]!==b||e[17]!==f?(g=o.jsx(Wf,{metadata:b,trackContentReferenceEvent:f}),e[16]=b,e[17]=f,e[18]=g):g=e[18],M=g;break e}case"time":{let g;e[19]!==b||e[20]!==f?(g=o.jsx(ih,{metadata:b,trackContentReferenceEvent:f}),e[19]=b,e[20]=f,e[21]=g):g=e[21],M=g;break e}case"image_v2":{const g=N!=null?N:0;let O;e[22]!==E||e[23]!==b||e[24]!==f||e[25]!==C||e[26]!==P||e[27]!==g?(O=o.jsx(qs,{metadata:b,numImageResults:g,analyticsMetadata:E,trackContentReferenceEvent:f,superWidgetContent:P,isFirstAssistantContent:C}),e[22]=E,e[23]=b,e[24]=f,e[25]=C,e[26]=P,e[27]=g,e[28]=O):O=e[28],M=O;break e}case"nav_list":{const g=j!=null?j:null,O=P!=null?P:null;let R;e[29]!==b||e[30]!==f||e[31]!==C||e[32]!==g||e[33]!==O?(R=o.jsx(Gf,{metadata:b,trackContentReferenceEvent:f,isFirstAssistantContent:C,lastUserMsgOfPrevTurn:g,superWidgetContent:O}),e[29]=b,e[30]=f,e[31]=C,e[32]=g,e[33]=O,e[34]=R):R=e[34],M=R;break e}case"file_navlist":{let g;e[35]!==b||e[36]!==f?(g=o.jsx(vf,{metadata:b,trackContentReferenceEvent:f}),e[35]=b,e[36]=f,e[37]=g):g=e[37],M=g;break e}case"file":{if(h){let g;e[38]!==b||e[39]!==k||e[40]!==f||e[41]!==c?(g=o.jsx(wl,{contentReferences:k,fileRef:b,index:c,trackContentReferenceEvent:f}),e[38]=b,e[39]=k,e[40]=f,e[41]=c,e[42]=g):g=e[42],M=g}else{let g;e[43]!==b||e[44]!==f||e[45]!==c?(g=o.jsx(jl,{fileRef:b,index:c,trackContentReferenceEvent:f}),e[43]=b,e[44]=f,e[45]=c,e[46]=g):g=e[46],M=g}break e}case"grouped_webpages_model_predicted_fallback":{let g;e[47]!==b||e[48]!==d.message||e[49]!==f||e[50]!==c||e[51]!==r?(g=o.jsx(vl,{webpageRef:b,node:r,trackContentReferenceEvent:f,message:d.message,index:c}),e[47]=b,e[48]=d.message,e[49]=f,e[50]=c,e[51]=r,e[52]=g):g=e[52],M=g;break e}case"grouped_webpages":{let g;e[53]!==b||e[54]!==d.message||e[55]!==f||e[56]!==c||e[57]!==r?(g=o.jsx(_l,{webpageRef:b,node:r,trackContentReferenceEvent:f,message:d.message,index:c}),e[53]=b,e[54]=d.message,e[55]=f,e[56]=c,e[57]=r,e[58]=g):g=e[58],M=g;break e}case"tldr":break e;case"navigation":{let g;e[59]!==b||e[60]!==f||e[61]!==S?(g=o.jsx(Ni,{navigation:b,onShowSearchResults:S,trackContentReferenceEvent:f}),e[59]=b,e[60]=f,e[61]=S,e[62]=g):g=e[62],M=g;break e}case"stock":{let g;e[63]!==b||e[64]!==f?(g=o.jsx(Rf,{contentReference:b,trackContentReferenceEvent:f}),e[63]=b,e[64]=f,e[65]=g):g=e[65],M=g;break e}case"calculator":{let g;e[66]!==b||e[67]!==f?(g=o.jsx(rf,{data:b,trackContentReferenceEvent:f}),e[66]=b,e[67]=f,e[68]=g):g=e[68],M=g;break e}case"python":case"container":{let g;e[69]!==E.turnIndex||e[70]!==b||e[71]!==d.clientThreadId?(g=o.jsx(mf,{clientThreadId:d.clientThreadId,turnIndex:E.turnIndex,contentReference:b}),e[69]=E.turnIndex,e[70]=b,e[71]=d.clientThreadId,e[72]=g):g=e[72],M=g;break e}case"code_execution":{let g;e[73]!==n||e[74]!==b||e[75]!==f?(g=o.jsx(df,{FormattedText:n,displayInfo:b,trackContentReferenceEvent:f}),e[73]=n,e[74]=b,e[75]=f,e[76]=g):g=e[76],M=g;break e}case"forecast":{let g;e[77]!==E||e[78]!==b.date_range||e[79]!==b.forecast||e[80]!==f?(g=(b==null?void 0:b.forecast)&&o.jsx(Fw,{weatherResults:b.forecast,dateRange:b.date_range,turnIndex:E.turnIndex,trackContentReferenceEvent:f}),e[77]=E,e[78]=b.date_range,e[79]=b.forecast,e[80]=f,e[81]=g):g=e[81],M=g;break e}case"businesses_map":{let g;e[82]!==b||e[83]!==f?(g=o.jsx(Kw,{contentReference:b,trackContentReferenceEvent:f}),e[82]=b,e[83]=f,e[84]=g):g=e[84],M=g;break e}case"map":{let g;e[85]!==b||e[86]!==d.clientThreadId||e[87]!==d.message.id||e[88]!==f?(g=o.jsx(Em,{contentReference:b,trackContentReferenceEvent:f,clientThreadId:d.clientThreadId,messageId:d.message.id}),e[85]=b,e[86]=d.clientThreadId,e[87]=d.message.id,e[88]=f,e[89]=g):g=e[89],M=g;break e}case"video":{let g;e[90]!==b||e[91]!==f?(g=o.jsx(ph,{video:b,trackContentReferenceEvent:f}),e[90]=b,e[91]=f,e[92]=g):g=e[92],M=g;break e}case"sports_standings":{let g;e[93]!==b||e[94]!==f?(g=o.jsx(rh,{standingsRef:b,trackContentReferenceEvent:f}),e[93]=b,e[94]=f,e[95]=g):g=e[95],M=g;break e}case"sports_schedule":{let g;e[96]!==b||e[97]!==f?(g=o.jsx(th,{scheduleRef:b,trackContentReferenceEvent:f}),e[96]=b,e[97]=f,e[98]=g):g=e[98],M=g;break e}case"attribution":{let g;e[99]!==b||e[100]!==a?(g=o.jsx(ef,{attribution:b,wordFadeType:a}),e[99]=b,e[100]=a,e[101]=g):g=e[101],M=g;break e}case"debug":{let g;e[102]!==b?(g=o.jsx(o.Fragment,{children:Object.entries(b).map(n2)}),e[102]=b,e[103]=g):g=e[103],M=g;break e}case"image_inline":{let g;e[104]!==b||e[105]!==d.clientThreadId||e[106]!==f||e[107]!==$?(g=(A=$.metadata)!=null&&A.b1de6e2_rm?o.jsx(eu,{reference:b,clientThreadId:d.clientThreadId,trackContentReferenceEvent:f,message:$}):o.jsx(su,{reference:b,clientThreadId:d.clientThreadId,trackContentReferenceEvent:f,message:$}),e[104]=b,e[105]=d.clientThreadId,e[106]=f,e[107]=$,e[108]=g):g=e[108],M=g;break e}case"image_group":{const g=j!=null?j:null,O=P!=null?P:null;let R;e[109]!==E||e[110]!==b||e[111]!==f||e[112]!==w||e[113]!==g||e[114]!==O?(R=o.jsx(Cd,{contentReference:b,trackContentReferenceEvent:f,analyticsMetadata:E,isFirstAssistantTurn:w,lastUserMsgOfPrevTurn:g,superWidgetContent:O}),e[109]=E,e[110]=b,e[111]=f,e[112]=w,e[113]=g,e[114]=O,e[115]=R):R=e[115],M=R;break e}case"product_entity":{let g;e[116]!==E.turnIndex||e[117]!==b||e[118]!==d.clientThreadId||e[119]!==d.message.id||e[120]!==f?(g=o.jsx(Hm,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:E.turnIndex,trackContentReferenceEvent:f}),e[116]=E.turnIndex,e[117]=b,e[118]=d.clientThreadId,e[119]=d.message.id,e[120]=f,e[121]=g):g=e[121],M=g;break e}case"entity_metadata":{let g;e[122]!==b||e[123]!==d.clientThreadId||e[124]!==d.message.id||e[125]!==f?(g=o.jsx(bf,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,trackContentReferenceEvent:f}),e[122]=b,e[123]=d.clientThreadId,e[124]=d.message.id,e[125]=f,e[126]=g):g=e[126],M=g;break e}case"checkout_confirmation":{let g;e[127]!==b||e[128]!==f?(g=o.jsx(ed,{metadata:b,trackContentReferenceEvent:f}),e[127]=b,e[128]=f,e[129]=g):g=e[129],M=g;break e}case"entity":{let g;e[130]!==E.turnIndex||e[131]!==b||e[132]!==d.clientThreadId||e[133]!==d.message.id||e[134]!==f||e[135]!==c?(g=o.jsx(Yw,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:E.turnIndex,trackContentReferenceEvent:f,contentReferenceIndex:c}),e[130]=E.turnIndex,e[131]=b,e[132]=d.clientThreadId,e[133]=d.message.id,e[134]=f,e[135]=c,e[136]=g):g=e[136],M=g;break e}case"product":{let g;e[137]!==E||e[138]!==b||e[139]!==d.clientThreadId||e[140]!==d.message||e[141]!==l||e[142]!==f||e[143]!==c?(g=null,e[137]=E,e[138]=b,e[139]=d.clientThreadId,e[140]=d.message,e[141]=l,e[142]=f,e[143]=c,e[144]=g):g=e[144],M=g;break e}case"products":{let g;e[145]!==E||e[146]!==b||e[147]!==d.clientThreadId||e[148]!==d.message.id?(g=o.jsx(Xm,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:E.turnIndex,analyticsMetadata:E}),e[145]=E,e[146]=b,e[147]=d.clientThreadId,e[148]=d.message.id,e[149]=g):g=e[149],M=g;break e}case"product_reviews":{let g;e[150]!==b||e[151]!==f?(g=o.jsx(Ka,{contentReference:b,disableAnimation:!0,trackContentReferenceEvent:f}),e[150]=b,e[151]=f,e[152]=g):g=e[152],M=g;break e}case"product_rationale":{let g;e[153]!==b||e[154]!==f?(g=o.jsx(Ya,{contentReference:b,trackContentReferenceEvent:f,disableAnimation:!0}),e[153]=b,e[154]=f,e[155]=g):g=e[155],M=g;break e}case"dil":{let g;e[156]!==b.dil||e[157]!==b.dil_url||e[158]!==b.name||e[159]!==f?(g=o.jsx(pf,{dil:b.dil,dilUrl:b.dil_url,trackContentReferenceEvent:f,widgetName:b.name}),e[156]=b.dil,e[157]=b.dil_url,e[158]=b.name,e[159]=f,e[160]=g):g=e[160],M=g;break e}case"strix":break e;case"sources_footnote":return null}Jw(b)&&"dil_url"in b;let z;e[169]!==T||e[170]!==b||e[171]!==f?(z=g=>(y.current||(f("Search Content Reference Failed","search_content_reference_failed",b.type),qt.addError("Error rendering content reference: ".concat(b.type),U(D({},g),{contentReference:b})),y.current=!0),b!=null&&b.alt?T:o.jsx("span",{className:"errored-object-".concat(b.type)})),e[169]=T,e[170]=b,e[171]=f,e[172]=z):z=e[172];let G;return e[173]!==M||e[174]!==z?(G=o.jsx(Po,{name:"content-reference-renderer",fallback:z,children:M}),e[173]=M,e[174]=z,e[175]=G):G=e[175],G}function n2(t){const[e,s]=t;return o.jsx("sub",{className:"ms-1 w-fit rounded-md border-2 border-solid border-orange-500 px-1 leading-none",children:s},e)}function o2(t){const{src:e,alt:s}=t;return o.jsx("img",{src:e,alt:s,className:"max-h-28"})}function r2(t){return t.role===Fa.Assistant}var go;const a2=new RegExp(String.raw(go||(go=jt(["]((?!<)(","[^)\r\n]+?))"],["\\]\\((?!<)(","[^)\\r\\n]+?)\\)"])),ws),"g"),i2=/\s/;function fo(t){return t.replace(a2,(e,s)=>i2.test(s)?"](".concat("<".concat(s,">"),")"):e)}const Et=(t,e,s)=>{za(s,t,void 0,e),Wa.count(Ha.WRITING_BLOCKS,t)};function l2(t){const l=t,{src:e,conversation:s}=l,n=Te(l,["src","conversation"]),r=Ve(()=>s==null?void 0:s.serverId$()),a=p.useContext(Ke),i=Ii(r,e,a==null?void 0:a.useSafeUrls);return i==null?o.jsx("div",{}):o.jsx("img",U(D({},n),{src:i}))}function c2(t){return o.jsx(s2,U(D({},t),{FormattedText:$r}))}function $r({size:t="medium",children:e,className:s,conversation:n,messageId:r,isActivelyStreaming:a=!1,componentOverrides:i,isDeepResearchResultMessage:l,forceDarkMode:c,disableWordFade:d}){const u=Xt()||c,{wordFadeType:m}=Mi(),h=Ei(),x=p.useRef(!1),_=p.useRef(!1);x.current=!1;const v=xe(),w=ko(Co.DisableWritingBlockRendering),j=p.useMemo(()=>{var O;if(!i)return;const R=i,{[O=rs]:A}=R;return Te(R,[on(O)])},[i]),C=p.useMemo(()=>i==null?void 0:i[rs],[i]),f=p.useMemo(()=>D(D(U(D({pre:({children:A,"data-start":g,"data-end":O,"data-is-last-node":R})=>o.jsx("pre",{className:"overflow-visible!","data-start":g,"data-end":O,"data-is-last-node":R,children:A}),code:A=>o.jsx($i,D({},A)),[Oa]:A=>o.jsx(c2,D({wordFadeType:m},A)),[Ti]:A=>n==null?null:o.jsx(Tc,U(D({},A),{conversation:n,messageId:r})),[Vi]:Bi,[tl]:Ic,[el]:Zc,[Qi]:Uc,[Ji]:Fc,a:A=>{var Y,J,de,oe;const V=A,{node:g,children:O}=V,R=Te(V,["node","children"]),W=(Y=g==null?void 0:g.properties)==null?void 0:Y.href;if(typeof W=="string"&&W.startsWith(ws))return n!=null&&r!=null?o.jsx(Hr,U(D({},R),{conversation:n,messageId:r,href:W,children:O})):null;if(typeof W=="string"&&W===Br){if(n==null||r==null)return O;const ie=(J=g==null?void 0:g.children)==null?void 0:J.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(Vr,U(D({},A),{text:ie,conversation:n,messageId:r,className:"cursor-pointer"}))}if(typeof W=="string"&&W===Ur){if(n==null||r==null)return O;const ie=(de=g==null?void 0:g.children)==null?void 0:de.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(qr,U(D({},A),{text:ie,conversation:n,messageId:r}))}if(typeof W=="string"&&W===Gr){if(n==null||r==null)return O;const ie=(oe=g==null?void 0:g.children)==null?void 0:oe.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(Zr,U(D({},A),{text:ie,conversation:n,messageId:r}))}return W&&typeof W=="string"&&$c(W)?O:o.jsx(Bl,U(D({},A),{messageId:r}))},table:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);return o.jsx(Dl,U(D({},g),{onClickCopy:W=>{var Y;Tt.logEvent("ChatGPT Table Copy Clicked");const V=n!=null&&r!=null?Ye.getNode(ln(n.id),r).message:void 0;Lo(Wr(A.markdownSource,(Y=V==null?void 0:V.metadata)==null?void 0:Y.content_references),void 0,W)}}))},td:Rl},h?{h1:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);return o.jsx("h1",D({"data-section-id":Ct(A.markdownSource)},g))},h2:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);return o.jsx("h2",D({"data-section-id":Ct(A.markdownSource)},g))},h3:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);return o.jsx("h3",D({"data-section-id":Ct(A.markdownSource)},g))},li:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);return o.jsx("li",D({"data-section-id":Ct(A.markdownSource)},g))}}:{}),{img:O=>{var R=O,{node:A}=R,g=Te(R,["node"]);var V;const W=(V=A==null?void 0:A.properties)==null?void 0:V.src;return typeof W=="string"&&(W.startsWith(ws)||W.startsWith("attachment:"))?null:o.jsx(l2,U(D({},g),{conversation:n}))}}),m==="delay"?Vl:[]),j!=null?j:{}),[h,m,j,n,r]),y=p.useCallback((A,g)=>{var O,R,W,V;if(A==null||n==null||r==null)return g;try{const Y=ln(n.id),J=Ye.getNode(Y,r),de=(V=(W=(R=(O=J==null?void 0:J.message)==null?void 0:O.metadata)==null?void 0:R.writing_blocks)==null?void 0:W[A])==null?void 0:V.content;return de!=null?de:g}catch(Y){return g}},[n,r]),k=p.useCallback((A,g)=>A?o.jsx($s,{components:f,remarkPlugins:_s,rehypePlugins:vs,urlTransform:bs,children:fo(A)}):o.jsx(o.Fragment,{children:g}),[f]),S=p.useCallback(A=>{var O,R;if(x.current=!0,w){const W=(O=A.id)!=null?O:A.index!=null?String(A.index):void 0,V=y(W,A.content);return k(V,A.children)}if(typeof C=="function")return C(A);const g=ml(A.variant);return o.jsx(Jc,{conversation:n,messageId:r,title:A.title,originalContent:A.content,variant:g,recipient:A.recipient,isStreaming:a,index:A.index,id:(R=A.id)!=null?R:String(A.index),children:A.children})},[w,y,k,C,r,a,n]),N=p.useMemo(()=>U(D({},f),{[rs]:S}),[f,S]),E=Se(v,"1839283687"),[$,P]=p.useState(!1),b=p.useMemo(()=>{const A=e!=null?e:"",g=a&&e?Ul(e):A;return fo(g)},[e,a]),F=p.useMemo(()=>Pi(b),[b]),L=p.useMemo(()=>$?Ai(b):b,[b,$]),T=Bo(),M=p.useMemo(()=>[...vs,[Xr,L]],[L]),z=p.useRef(!1);a&&(z.current=!0);const G=p.useMemo(()=>m==="indexed"&&!d?{handlers:{text:(A,g,O)=>{const R=[];for(const W of T(g.value))R.push({type:"element",tagName:"span",properties:{className:Vo.fadeIn},children:[{type:"text",value:W}]});return R}}}:void 0,[m,T,d]),B=p.useMemo(()=>a||!F?!1:b.includes(":::writing"),[a,F,b]),K=p.useMemo(()=>{var A;return{contains_writing_directive:F?"true":"false",uses_old_syntax:B?"true":"false",client_thread_id:(A=n==null?void 0:n.id)!=null?A:"",message_id:r!=null?r:""}},[F,B,r,n]),te=p.useRef(!1);return p.useEffect(()=>{!B||te.current||(Et("chatgpt_writing_block_uses_old_syntax",K,v),z.current&&Et("chatgpt_new_writing_block_uses_old_syntax",K,v),te.current=!0)},[K,B,v]),p.useEffect(()=>{F&&(a||x.current||_.current||(Et("chatgpt_writing_block_render_failed",K,v),z.current&&Et("chatgpt_writing_block_first_render_failed",K,v),_.current=!0,P(!0)))},[v,n,a,r,F,P,B,K]),E?!1:o.jsx(Po,{name:"formatted_text_error",fallback:()=>o.jsx(o.Fragment,{children:L}),children:o.jsx($s,{rehypePlugins:M,remarkPlugins:_s,remarkRehypeOptions:G,className:I(s,"markdown prose dark:prose-invert w-full break-words",u?"dark":"light",t==="small"&&"prose-xs",l&&"deep-research-result","markdown-new-styling"),urlTransform:bs,components:N,children:L})})}const $s=p.memo(Us),H2=Object.freeze(Object.defineProperty({__proto__:null,FormattedText:$r,ReactMarkdownMemo:$s},Symbol.toStringTag,{value:"Module"}));export{H2 as F,lm as M,Dt as W,wm as a,cm as b,Au as c,Tu as f,mr as p,He as r,$u as t};
//# sourceMappingURL=dc3wx0vhq5cgao26.js.map

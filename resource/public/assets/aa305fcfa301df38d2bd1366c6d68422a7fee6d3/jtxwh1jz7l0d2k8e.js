const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/btrwhqtnzjbkk202.js","assets/bubexfvksfr7893o.js"])))=>i.map(i=>d[i]);
import{r as b,h as W,j as n,e as $,_ as q}from"./bubexfvksfr7893o.js";import{u as B,bh as D,N as Z,hy as J,hD as K,k4 as Q,hz as X,cz as I,e7 as Y,az as ee,aA as se,g7 as E}from"./ncw8zw682jinppua.js";import{gb as z,gc as ae,gd as te,S as oe,cZ as ne,cv as re,ge as ie,gf as le,gg as de}from"./lm3g1zm00rp6al39.js";const ce=ee(()=>q(()=>import("./btrwhqtnzjbkk202.js"),__vite__mapDeps([0,1])),{loading:e=>se(e)});function ge({asset:e,contextConnectorSourceUrl:r,disableExpandable:d=!1,isSingle:c,isUserTurn:u,className:i}){var _,A;const t=B(),l=D(t).flags,[f,s]=b.useState(!1),o=!Z(t),g=l==null?void 0:l.includes(J.NoAuthEnableFileUploads),h=K(e.asset_pointer),a=z.useState(V=>z.selectFile(V,h)),M=ae((_=a==null?void 0:a.file)!=null?_:null,a==null?void 0:a.file.name,(A=a==null?void 0:a.fileId)!=null?A:void 0,a==null?void 0:a.gizmoId,a==null?void 0:a.contextConnectorInfo,!0),N=o&&a&&g,{gizmoEditorData:x}=Q(),v=te(),F=b.useContext(oe),R=(F==null?void 0:F.serverSharedThreadId)&&u,O=X(),{isOpen:G}=ne(),S=W(),{data:T,isLoading:k,error:H}=re({asset:e,gizmoId:x==null?void 0:x.id,getServerUrl:!N}),{url:j,width:p,height:C}=M&&g?{width:e.width,height:e.height,url:M}:T!=null?T:{},U=k||!f,w=p&&C?{Landscape:p>C,Portrait:p<C}:void 0,m=["overflow-hidden rounded-lg"];if(c&&(m.push("w-full h-full"),w!=null&&w.Landscape?m.push("max-w-96 max-h-64"):w!=null&&w.Portrait?m.push("max-h-96 max-w-64"):m.push("max-w-64 max-h-64")),i&&m.unshift(i),R&&O())return null;let L;return j!=null&&(L=n.jsx(ie,{alt:S.formatMessage(y.imageAltText),className:I(G?"max-w-[88px]":"max-w-full",!c&&"aspect-square","object-cover object-center",m),src:j,width:p,height:C,onLoad:()=>s(!0)}),!v&&!d&&(L=n.jsx(le,{src:j,alt:S.formatMessage(y.imageAltText),contextConnectorSourceUrl:r,className:I(m),children:L}))),n.jsx("div",{className:I(m),children:n.jsx("div",{className:I("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!c&&"aspect-square"),children:j!=null?L:n.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:"".concat(p," / ").concat(C),width:p},title:U?S.formatMessage(y.loadingImage):S.formatMessage(y.errorLoadingImage),children:U?n.jsx(Y,{}):H?n.jsx(ce,{className:"icon-sm"}):null})})})}const y=$({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function P({assets:e,attachments:r,isUserTurn:d=!0,clientThreadId:c}){const u=e.length===1,{containerClassname:i,imageClassnames:t}=P.computeClassnames(e.length);let l=E.ATTACHMENT;return e&&!(r&&r.length>0)&&(l=E.IMAGE),n.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[n.jsx("div",{className:I("flex flex-row items-center justify-end gap-1",i),children:e.map((f,s)=>{var g;const o=r==null?void 0:r.find(h=>h.id&&f.asset_pointer.includes(h.id));return n.jsx(ge,{asset:f,isSingle:u,isUserTurn:d,contextConnectorSourceUrl:(g=o==null?void 0:o.context_connector_info)==null?void 0:g.source_url,className:t[s]},s)})}),n.jsx(de,{featureType:l,isUserTurn:d,clientThreadId:c})]})}P.computeClassnames=e=>{if(e<2)return{containerClassname:null,imageClassnames:[]};let r=e>=4?"flex-wrap":"";const d=Array(e),c=s=>{d.fill(s)},u=s=>{r+=" ".concat(s)},i=(s,o)=>{d[s]=I(d[s],o)},t=e<=4&&e%2===0?2:3,l=Math.ceil(e/t),f=e%t!==0;t===2?(c("h-32 w-32"),u("max-w-72")):l<=2?(c("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(c("h-16 w-16"),u("max-w-52"));for(let s=0;s<e;s++){const o=Math.floor(s/t),g=s%t,h=Math.min(e-o*t,t),a=o===0,M=o===l-1,N=o===l-2,x=g===0,v=g===h-1;a&&x&&i(s,"rounded-ss-2xl"),a&&v&&i(s,"rounded-se-2xl"),M&&x&&i(s,"rounded-es-2xl"),M&&v&&i(s,"rounded-ee-sm"),f&&x&&N&&i(s,"rounded-es-2xl")}return{containerClassname:r,imageClassnames:d}};export{P as TextMessageImageGroup};
//# sourceMappingURL=jtxwh1jz7l0d2k8e.js.map

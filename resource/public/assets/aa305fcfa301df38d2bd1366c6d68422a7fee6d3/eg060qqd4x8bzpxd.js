const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lm3g1zm00rp6al39.js","assets/bubexfvksfr7893o.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/h6qizh4p4j2yeqz2.js","assets/fe9gcm3fcqux5tvc.js","assets/lcnxs0h9184gwafk.js","assets/m53wqwxcskue6q8s.js","assets/jxyz1kdkcze5jtww.js","assets/dni8akjyvev2h15q.js","assets/dkjdqjcct64qk1e4.js","assets/kivvchsexr54fuso.js"])))=>i.map(i=>d[i]);
var ks=Object.defineProperty,Ts=Object.defineProperties;var Ns=Object.getOwnPropertyDescriptors;var Rt=Object.getOwnPropertySymbols;var Cs=Object.prototype.hasOwnProperty,Ss=Object.prototype.propertyIsEnumerable;var it=(e,s,o)=>s in e?ks(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,lt=(e,s)=>{for(var o in s||(s={}))Cs.call(s,o)&&it(e,o,s[o]);if(Rt)for(var o of Rt(s))Ss.call(s,o)&&it(e,o,s[o]);return e},ct=(e,s)=>Ts(e,Ns(s));var Ot=(e,s,o)=>it(e,typeof s!="symbol"?s+"":s,o);import{r as l,j as t,_ as Ee,M as Ie,c as ts,e as ss,h as je,R as ut}from"./bubexfvksfr7893o.js";import{dS as re,cz as J,az as Me,aA as Re,aB as ns,fH as gt,sQ as Ne,e$ as yt,a6 as Is,u as rt,bd as os,i8 as rs,d$ as Ue,hm as As,a4 as Es,ea as Ms,rk as Pt,pV as Lt,iS as Rs,iT as Os,iU as Ps,i_ as Ls,sF as dt,D as Je,dQ as Ds,P as as,e4 as Vs,J as is,bJ as $s,i7 as xe,aw as $e,bE as Dt,fx as Hs,c8 as Ws,d as zs,ay as Bs,M as Us,$ as ls,a0 as cs,_ as Vt,gk as $t,z as qs,aN as Qs}from"./ncw8zw682jinppua.js";import{oV as Xs,oX as Ys,c6 as at,wN as us,o$ as nt,gl as Zs,cd as D,wO as jt,cK as ds,mV as Fs,h9 as Js,ha as Gs,B as Ks,E as en,wP as tn,wQ as sn,wR as nn,wS as on,wT as rn,wU as an,gm as ln,wV as Ht,wW as ft,wX as Wt,gn as fs,aj as cn,Q as un,mo as dn,wY as fn,oU as mn,wZ as pn,iK as hn,nt as xn}from"./lm3g1zm00rp6al39.js";import{C as gn}from"./kldvd03dc86uawjw.js";import{g as yn,c as wn,d as bn,a as zt,e as mt,f as Bt,b as jn,C as vn,S as _n}from"./fwwkwalw87hti22b.js";import{M as kn}from"./hzasobp3hhjtq47p.js";import{s as Tn}from"./of2lqa4u24wak95x.js";import{p as Nn}from"./gwwqbtk9yto9dekb.js";import{S as Cn,C as Sn,H as In,t as Be}from"./i6hdqng3ufj5kq75.js";import{shell as An}from"./pbl95wx6493wq92j.js";import{E as wt,e as En,V as Mn,R as Rn,D as ms}from"./ecforv0kxuh5qyzb.js";import{a as On}from"./od50gemg82u3x7jt.js";import{C as Pn}from"./owg1t5lbjzwpi0hd.js";import{D as Ln}from"./a4n81fjtfjy1tyjw.js";import{u as Dn}from"./oc4lr1ricjtltb4h.js";import"./fk5dn736y6oc9os0.js";import"./dgs0l83heankdts0.js";import"./l8gfdbxyfhb5crrj.js";import"./lowm54usy4rzuo31.js";const Vn=({url:e,withBorder:s=!1})=>{const{isSuccess:o,isError:r}=Xs(Ys(e,32)),[n]=l.useState(o);return r?null:t.jsx(re.div,{initial:{opacity:n?1:0},animate:{opacity:o?1:0},className:J("bg-primary -ms-3 box-content size-4 shrink-0 overflow-hidden rounded-full first:-ms-1",s&&"border-token-main-surface-secondary group-hover:border-token-text-primary dark:group-hover:border-token-text-primary border"),children:t.jsx(at,{url:e,size:32,className:"m-0"})})},$n=Me(()=>Ee(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zq),__vite__mapDeps([0,1,2,3,4])),{loading:e=>Re(e)});function Hn({tabs:e,activeTab:s,setActiveTab:o,initializing:r=!1}){const n=t.jsx(Ie,{id:"odyssey.tabBar.newTab",defaultMessage:"New tab"});return r?t.jsx("nav",{className:"bg-token-bg-tertiary flex flex-1 items-center gap-1 rounded-t-xl",children:t.jsx("div",{className:"flex flex-1 items-center gap-1",children:t.jsx(qt,{onClick:()=>{},active:!0,children:n})})}):t.jsx("nav",{className:"bg-token-bg-tertiary flex flex-1 items-center gap-1 rounded-t-xl",children:t.jsx("div",{className:"flex flex-1 items-center gap-1",children:e.map(i=>t.jsx(qt,{active:s===i.label,icon:i.icon,onClick:()=>o(i.label),children:i.label},i.icon))})})}function Ut({side:e}){return t.jsx("span",{"aria-hidden":!0,className:J("pointer-events-none absolute bottom-0 h-3 w-3 bg-transparent z-10",e==="left"?"end-full rounded-ee-[50%] shadow-[4px_0_0_0_var(--bg-primary)]":"start-full rounded-es-[50%] shadow-[-4px_0_0_0_var(--bg-primary)]")})}function qt({active:e=!1,icon:s,children:o,onClick:r}){return t.jsxs("div",{className:J("relative rounded-t-xl py-2 ps-4 pe-4.5 text-[11px] leading-[13px] font-medium whitespace-nowrap",e?"bg-token-bg-primary text-token-text-primary":"text-token-text-secondary hover:bg-token-bg-primary/60 hover:text-token-text-primary"),onClick:r,children:[e&&t.jsxs(t.Fragment,{children:[t.jsx(Ut,{side:"left"}),t.jsx(Ut,{side:"right"})]}),t.jsxs("div",{className:"flex flex-row items-center gap-1",children:[s?t.jsx(Vn,{url:s}):t.jsx($n,{className:"size-4"}),o]})]})}const Wn=Me(()=>Ee(()=>import("./h6qizh4p4j2yeqz2.js"),__vite__mapDeps([5,1])),{loading:e=>Re(e)}),zn=({chunk:e,isFinalAssistantTurn:s,hidePowTombstone:o,isKAUR1BR5:r})=>{const n=e.screenshots.at(-1),{origin:i,domain:u}=l.useMemo(()=>us(n),[n]),c=nt(n,void 0),{open:m,isVNCEnabled:d}=Zs(),[p,x]=l.useState(null),[y,w]=l.useState(!1);return l.useEffect(()=>{if(!c)return;let b=!1;w(!1);const j=new Image;return j.src=c,j.onload=()=>!b&&x(c),j.onerror=()=>{b||(w(!0),x(null))},()=>{b=!0}},[c]),s?t.jsxs(re.div,{className:"group border-token-border-heavy relative flex max-w-md flex-1 cursor-default flex-col gap-2 overflow-hidden rounded-2xl border",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4,ease:"easeInOut"},children:[t.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col",children:[t.jsx("div",{className:"align-start flex flex-row gap-1 px-1 pt-1 text-sm",children:t.jsx(Hn,{tabs:[{icon:i!=null?i:"",label:u!=null?u:""}],activeTab:u,setActiveTab:()=>{},initializing:!1})}),t.jsx("div",{className:"group relative aspect-[1024/698] w-full",children:p?t.jsx("img",{src:p,alt:"Screenshot that shows the model used the computer",className:"absolute inset-0 h-full w-full object-cover object-bottom"},p):t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"border-token-border-heavy h-4 w-4 animate-spin rounded-full border-2 border-t-transparent"})})})]}),d&&t.jsx("div",{className:"absolute inset-0 z-100 flex h-full w-full items-center justify-center bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:t.jsx(ns,{color:"primary-inverse",onClick:()=>m(),children:t.jsx("div",{className:"flex items-center gap-1",children:r?t.jsx(Ie,{id:"ahugQu",defaultMessage:"Open tabs"}):t.jsx(Ie,{id:"Kj2mXr",defaultMessage:"Take over"})})})})]},"proof-of-work"):o?null:t.jsx(Bn,{})},Bn=()=>t.jsxs(re.div,{className:"border-token-border-default group flex max-w-xs items-center gap-2 rounded-2xl border p-4 select-none",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeInOut"},children:[t.jsx(Wn,{className:"icon"}),t.jsx("span",{className:"flex-1 truncate text-sm font-medium",children:t.jsx(Ie,{id:"cot.proofofwork.tombstone",defaultMessage:"Used the browser"})})]},"tombstone"),Un=e=>{"use forget";const s=ts.c(8),{chunks:o,isExpanded:r,isFinalAssistantTurn:n,hidePowTombstone:i,isKAUR1BR5:u}=e;let c;s[0]!==o?(c=Qn(o),s[0]=o,s[1]=c):c=s[1];const m=c;if(!m)return null;let d;return s[2]!==i||s[3]!==r||s[4]!==n||s[5]!==u||s[6]!==m?(d=t.jsx(Xn,{chunk:m,isExpanded:r,isFinalAssistantTurn:n,hidePowTombstone:i,isKAUR1BR5:u}),s[2]=i,s[3]=r,s[4]=n,s[5]=u,s[6]=m,s[7]=d):d=s[7],d},qn=l.memo(Un),Qn=e=>gt(e,s=>{var o;return s.type===D.ComputerOutput&&!s.isBlank&&((o=s.screenshots)==null?void 0:o.length)>0}),Xn=e=>{"use forget";const s=ts.c(6),{chunk:o,isExpanded:r,isFinalAssistantTurn:n,hidePowTombstone:i,isKAUR1BR5:u}=e;if(o.type!==D.ComputerOutput)return null;let c;return s[0]!==o||s[1]!==i||s[2]!==r||s[3]!==n||s[4]!==u?(c=t.jsx(zn,{chunk:o,isExpanded:r,isFinalAssistantTurn:n,hidePowTombstone:i,isKAUR1BR5:u}),s[0]=o,s[1]=i,s[2]=r,s[3]=n,s[4]=u,s[5]=c):c=s[5],c};function Yn(e,s,o,r,n){const[i,u]=l.useState(Ne.Setup),c=l.useMemo(()=>e.every(d=>d.type===D.N7jupdLoading)&&s,[e,s]),m=l.useMemo(()=>{const d=yt(e);return(d==null?void 0:d.type)!==D.N7jupdLoading?!1:d==null?void 0:d.needs_startup},[e]);return l.useEffect(()=>{const d=setTimeout(()=>{u(Ne.Random)},7e3),p=setTimeout(()=>{u(Ne.Animation)},15e3);return()=>{clearTimeout(d),clearTimeout(p)}},[]),r&&c?Ne.Autoswitch:o===Is.Research&&c?Ne.Research:c?m?i:n?Ne.KAUR1BR5:Ne.Thinking:Ne.Done}function Zn(){const e=rt(),o=os(e,"chatgpt_cot_config").get("shimmer_duration_ms",2e3);l.useEffect(()=>{document.documentElement.style.setProperty("--cot-shimmer-duration","".concat(o,"ms"))},[o])}const Fn=({radius:e=8,className:s=""})=>t.jsx("svg",{width:e,height:e,viewBox:"0 0 ".concat(e," ").concat(e),className:s,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"\n        M 0 0 H ".concat(e," V ").concat(e," H 0 Z\n        M ").concat(e," 0\n          A ").concat(e," ").concat(e," 0 0 1 0 ").concat(e,"\n          L 0 0 Z\n      "),fill:"currentColor",fillRule:"evenodd"})}),Jn=({radius:e=8,className:s=""})=>t.jsx("svg",{width:e,height:e,viewBox:"0 0 ".concat(e," ").concat(e),className:s,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"\n        M 0 0 H ".concat(e," V ").concat(e," H 0 Z\n        M 0 0\n          A ").concat(e," ").concat(e," 0 0 0 ").concat(e," ").concat(e,"\n          L ").concat(e," 0 Z\n      "),fill:"currentColor",fillRule:"evenodd"})}),Ce=ss({live:{id:"odyssey.live",defaultMessage:"LIVE"},search:{id:"odyssey.search",defaultMessage:"Search"},restoringDesktop:{id:"odyssey.restoringDesktop",defaultMessage:"Restoring my virtual desktop..."},terminal:{id:"odyssey.terminal",defaultMessage:"Terminal"},newTab:{id:"odyssey.newTab",defaultMessage:"New tab"},libreoffice:{id:"odyssey.libreoffice",defaultMessage:"LibreOffice"},reader:{id:"odyssey.reader",defaultMessage:"Browser"},readingMode:{id:"odyssey.readingMode",defaultMessage:"Reading mode"},imageViewer:{id:"odyssey.imageViewer",defaultMessage:"Image Viewer"},stopAgent:{id:"odyssey.stopAgent",defaultMessage:"Stop agent"},generatingImage:{id:"odyssey.generatingImage",defaultMessage:"Generating image"}}),Gn=({lines:e=10,speed:s=5,width:o="100%",height:r=400,className:n=""})=>{const u=rs()?4:3,c=l.useMemo(()=>Array.from({length:e+u},()=>"".concat(60+Math.random()*40,"%")),[e,u]),m="bg-token-bg-tertiary rounded-md h-6",d=()=>t.jsxs("div",{className:"flex shrink-0 flex-col gap-4 pb-4",style:{width:"100%",height:r},children:[t.jsxs("div",{className:"flex w-full flex-row items-start gap-4",children:[t.jsx("div",{style:{width:"25%",aspectRatio:"1 / 1",position:"relative"},children:t.jsx("div",{className:m,style:{position:"absolute",inset:0,width:"100%",height:"100%"}})}),t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4",style:{height:"100%"},children:Array.from({length:u}).map((x,y)=>t.jsx("div",{className:m,style:{width:c[y],flex:1}},y))})]}),c.slice(u).map((x,y)=>t.jsx("div",{className:m,style:{width:x}},y+u))]}),p=typeof r=="number"?"".concat(r,"px"):r;return l.useEffect(()=>{const x=document.createElement("style");return x.innerHTML="\n      @keyframes ws-scroll {\n        0% {\n          transform: translateY(calc(-1 * var(--ws-page-h)));\n        }\n        100% {\n          /* Move up exactly one page height */\n          transform: translateY(calc(-2* var(--ws-page-h)));\n        }\n      }\n      .animate-ws-scroll {\n        animation-name: ws-scroll;\n        animation-timing-function: ease-in-out;\n        animation-iteration-count: infinite;\n      }\n    ",document.head.appendChild(x),()=>{document.head.removeChild(x)}},[]),t.jsx("div",{className:"relative ".concat(n),style:{width:o,height:p},children:t.jsxs("div",{className:"animate-ws-scroll absolute inset-0 flex flex-col",style:{"--ws-page-h":p,animationDuration:"".concat(s,"s")},children:[t.jsx(d,{}),t.jsx(d,{})," ",t.jsx(d,{})," "]})})},Ge=({children:e,isKAUR1BR5:s=!1})=>t.jsx("div",{className:J("bg-token-bg-tertiary flex h-7 w-full flex-row px-1",s?"h-12 shrink-0":"pt-1 text-[11px]"),children:e}),He=({children:e,className:s,isActive:o=!0,isKAUR1BR5:r=!1})=>{const[n,i]=l.useState(!1);l.useEffect(()=>{i(!0)},[]);const u=n?.5:.8,c=r?.9:.8,m=r?o?[c,1,1]:c:[c,1,1];return t.jsx("div",{className:J("flex w-full shrink-0 flex-row p-4",s),children:t.jsx(re.div,{className:"text-token-text-secondary bg-token-bg-primary flex size-full shrink-0 flex-col overflow-hidden rounded-lg shadow-md",initial:{opacity:0,scale:c,y:20},animate:{opacity:[0,1,1],scale:m,y:[20,0,0]},transition:{delay:u,duration:.55,times:[0,.75,1],ease:[.16,1,.3,1]},children:e})})},Kn=Me(()=>Ee(()=>import("./fe9gcm3fcqux5tvc.js"),__vite__mapDeps([6,1])),{loading:e=>Re(e)});function eo({title:e,url:s,domain:o}){const{formatMessage:r}=je();return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:r(Ce.reader)})}),t.jsx("div",{className:"flex flex-1 flex-col bg-black/10 px-16 pt-16",children:t.jsx(ps,{title:e})})]})}function ps({title:e}){const{formatMessage:s}=je();return t.jsx("div",{className:"bg-token-bg-primary justify-top relative flex h-full w-full flex-col items-center rounded-t-xl",children:t.jsxs("div",{className:"w-full overflow-clip",children:[t.jsxs("div",{className:"bg-token-bg-primary relative z-2 flex flex-col items-center justify-start rounded-t-xl pt-0 pb-0",style:{WebkitMaskImage:"linear-gradient(to top, transparent 0px, black 12px, black 12px, black 100%)",maskImage:"linear-gradient(to top, transparent 0px, black 12px, black 12px, black 100%)"},children:[t.jsxs("div",{className:"text-token-text-secondary z-2 flex flex-row items-center gap-2 py-2 text-xs font-medium",children:[t.jsx(Kn,{className:"text-token-text-secondary size-4"}),s(Ce.readingMode)]}),t.jsx("div",{className:"text-token-text-primary z-1 mb-4 line-clamp-3 w-full px-4 text-start text-2xl font-semibold overflow-ellipsis lg:text-3xl",children:e})]}),t.jsx("div",{className:"inset-0 z-0 w-full overflow-visible px-4",children:t.jsx(Gn,{})})]})})}const to=Me(()=>Ee(()=>import("./lcnxs0h9184gwafk.js"),__vite__mapDeps([7,1])),{loading:e=>Re(e)});function so({tabMetadata:e,signedScreenshotUrl:s,newTabTitle:o,isReaderMode:r,domain:n,title:i,tetherData:u,isKAUR1BR5:c,isActive:m,serverThreadId:d,isStreaming:p}){var b,j;const x=jt(s),y=r?n:(b=e==null?void 0:e.domain)!=null?b:o,w=r?n:(j=e==null?void 0:e.origin)!=null?j:"";return t.jsxs(He,{isActive:m,isKAUR1BR5:c,className:J(c&&"p-0!"),children:[t.jsx(Ge,{isKAUR1BR5:c,children:c?t.jsx(oo,{isReaderMode:r,windowBarDomain:y,windowBarFaviconUrl:w,tetherData:u,serverThreadId:d,showOpenTabButton:p}):t.jsx(no,{isReaderMode:r,windowBarDomain:y,windowBarFaviconUrl:w,tetherData:u})}),t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-secondary relative aspect-[1024/697] w-full overflow-hidden rounded-b-lg",children:[x&&t.jsx("img",{src:x,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom"},x),t.jsx(Ue,{children:r&&t.jsx(re.div,{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-b-md bg-black/20 backdrop-blur-[2px] dark:bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4},children:t.jsx(re.div,{className:"flex h-full w-full px-8 pt-4 lg:px-16 lg:pt-8",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0,transition:{y:{duration:.6}}},transition:{type:"spring",stiffness:400,damping:32},children:t.jsx(ps,{domain:n,title:i})})})})]})]})}function no({isReaderMode:e,windowBarDomain:s,windowBarFaviconUrl:o,tetherData:r}){var i;const{formatMessage:n}=je();return t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-secondary relative flex items-center rounded-t-[4px] px-2 shadow-md",children:[t.jsxs("div",{className:"flex items-center gap-1 text-[10px]",children:[t.jsx(at,{className:"size-3",url:e?(i=r==null?void 0:r.url)!=null?i:"":o!=null?o:"",size:32}),t.jsx("span",{className:"max-w-16 truncate",children:e?r==null?void 0:r.domain:s||n(hs.newTab)})]}),t.jsx(Fn,{radius:4,className:"text-token-bg-primary dark:text-token-bg-secondary absolute start-[-4px] bottom-0"}),t.jsx(Jn,{radius:4,className:"text-token-bg-primary dark:text-token-bg-secondary absolute end-[-4px] bottom-0"})]})}function oo({isReaderMode:e,windowBarDomain:s,windowBarFaviconUrl:o,tetherData:r,serverThreadId:n,showOpenTabButton:i}){var m;const{formatMessage:u}=je(),c=ds();return t.jsxs("div",{className:"relative flex w-full items-center justify-between px-1.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[t.jsx(at,{className:"size-5",url:e?(m=r==null?void 0:r.url)!=null?m:"":o!=null?o:"",size:32}),t.jsx("span",{className:"max-w-32 truncate",children:e?r==null?void 0:r.domain:s||u(hs.newTab)})]}),i&&!c&&t.jsxs(ns,{color:"ghost",className:"text-token-text-secondary rounded-lg font-normal",contentWrapperClassName:"gap-1",onClick:()=>{var d;try{const p=As();return(d=p==null?void 0:p.tryOpenAgentViewer(n))!=null?d:!1}catch(p){Es.error("Failed to open local agent viewer - error thrown")}},children:[t.jsx(Ie,{defaultMessage:"Open tab",id:"odyssey.browserWindow.openTab"}),t.jsx(to,{className:"icon-sm"})]})]})}const hs=ss({newTab:{defaultMessage:"New tab",id:"odyssey.browserWindow.newTab"}}),ro=({text:e,cadence:s=.1,fadeDuration:o=.5,className:r="",numLines:n=4})=>{const i=l.useMemo(()=>e.trim().split(/\s+/),[e]),u=l.useRef(null),c=l.useRef([]),[m,d]=l.useState(-1),[,p]=l.useState([]),x=l.useRef([]),[y,w]=l.useState(1),[b,j]=l.useState(0),[A,L]=l.useState(!1),[E,a]=l.useState(0),ae=l.useRef(null),G=l.useRef(null),$=l.useRef(1),ie=l.useRef(y);l.useEffect(()=>{ie.current=y},[y]);const ee=rs();l.useEffect(()=>{d(-1),p([]),x.current=[],x.current[0]=1,w(1),j(0),L(!1),c.current=[],a(U=>U+1),ae.current=null,G.current=null,$.current=1},[e,ee]),l.useEffect(()=>{if(i.length===0)return;let U,X;const V=k=>{var P,v;if(!x.current[k]){const H=c.current[k];if(H){const Z=H.offsetTop;ae.current==null?(ae.current=Z,G.current=Z,$.current=1):Z>((P=G.current)!=null?P:0)&&($.current+=1,G.current=Z),x.current[k]=$.current,p([...x.current])}}d(k);const N=(v=x.current[k])!=null?v:$.current;N>ie.current&&(N<=n?w(N):j(N-n)),k<i.length-1?U=window.setTimeout(()=>V(k+1),s*1e3):X=window.setTimeout(()=>L(!0),(o+1)*1e3)};return V(0),()=>{clearTimeout(U),clearTimeout(X)}},[i,s,o,n,ee]);const[le,te]=l.useState(null);Ms(()=>{if(u.current&&le==null){const U=parseFloat(getComputedStyle(u.current).lineHeight);te(U)}},[le]);const he=le?-b*le:0,B=b===0?0:Math.min(100,s*500),Y={lineHeight:"1.4em",height:"calc(1.4em * ".concat(Math.min(y,n),")"),transition:"height 0.25s cubic-bezier(0.4, 0, 0.2, 1)"};return t.jsx("div",{className:"cursor-chat-bubble text-token-text-primary border-[hsba(0,0%,5%,0.2) bg-token-bg-elevated-primary w-full overflow-hidden rounded-lg border p-2 text-xs shadow-[0px_20px_25.000001907348633px_-5px_rgba(0,0,0,0.10)] lg:text-sm",style:{opacity:A||e.length===0?0:1,transition:"opacity ".concat(o,"s ease-in-out")},children:t.jsx("div",{ref:u,className:"teleprompter ".concat(r),style:Y,children:t.jsx("div",{className:"teleprompter-inner",style:{transform:"translateY(".concat(he,"px)"),transition:"transform ".concat(B,"ms linear")},children:i.map((U,X)=>{var V;return t.jsxs("span",{ref:k=>{c.current[X]=k},style:{opacity:X<=m&&((V=x.current[X])!=null?V:1/0)>b?1:0,transition:"opacity ".concat(o,"s"),animation:"none"},className:"teleprompter-word",children:[U,"Â "]},X)})},E)})})},ao=768,io=1024;function xs(e,s){return{top:e/ao*100,left:s/io*100}}function gs(e){try{return new URL(e)}catch(s){return null}}function ys(e){return e?e.replace(/^www\./,""):null}function Qt(e){const s=gs(e),o=ys(s==null?void 0:s.hostname);return{domain:o!=null?o:null,name:null}}function lo(e){return e.startsWith("http://localhost:8451/")?e.replace(/^http:\/\/localhost:8451\//,""):e}function co(e){const s=e.match(/([^\/]+\.pdf)(?:[?#].*)?$/i);return s?s[1]:null}function Xt(e,s){var m;let o=e!=null?e:"",r=s!=null?s:null;const n=/\.pdf(?:[?#].*)?$/i.test(e),i=e.startsWith("http://localhost:8451/");if(n||i){const d=lo(e);o=d;const p=co(d);p&&(r=p)}const u=gs(o),c=(m=ys(u==null?void 0:u.hostname))!=null?m:null;return{tetherUrl:o,tetherTitle:r,domain:c}}const uo=Me(()=>Ee(()=>import("./m53wqwxcskue6q8s.js"),__vite__mapDeps([8,1])),{loading:e=>Re(e)}),fo=120,mo=1.2,po="right",ho=.2,xo=.75,Yt=.08,go=100,yo=80,wo=1.2,st=(e=0)=>new Promise(s=>setTimeout(s,e));function bo(e,s=120){const[o,r]=ut.useState(e),[n,i]=ut.useState(!1);return ut.useEffect(()=>{i(!0);const u=setTimeout(()=>{r(e),i(!1)},s);return()=>clearTimeout(u)},[e,s]),[o,n]}const jo=({top:e,left:s,params:o={},text:r,actions:n,isKAUR1BR5:i})=>{const{forearmLength:u=fo,speed:c=mo,handBias:m=po,curveFactor:d=ho,shortMoveSlowdown:p=.8,slowDistance:x=100,dragSlowdown:y=wo}=o,[w,b]=l.useState({x:s,y:e}),j=Pt(1),A=Pt(0),L=l.useRef(null),E=l.useRef(w),a=l.useRef({p0:w,p1:w,p2:w}),ae=(k,N,P,v)=>{const H=1-v;return{x:H*H*k.x+2*H*v*N.x+v*v*P.x,y:H*H*k.y+2*H*v*N.y+v*v*P.y}},G=l.useRef(1),$=l.useRef(!1),ie=Lt(A,k=>{const{p0:N,p1:P,p2:v}=a.current;return"".concat(ae(N,P,v,k).x,"%")}),ee=Lt(A,k=>{const{p0:N,p1:P,p2:v}=a.current;return"".concat(ae(N,P,v,k).y,"%")}),[le,te]=bo(r,150),he=te?"":le,{x:B,y:Y,refs:{setReference:U,setFloating:X},strategy:V}=Rs({placement:"right-start",whileElementsMounted:(k,N,P)=>Ls(k,N,P,{animationFrame:!0}),middleware:[Os({mainAxis:4,crossAxis:24}),Ps({padding:8,crossAxis:!0})]});return l.useEffect(()=>{var Ae;const k=w,N=E.current;if(k.x===N.x&&k.y===N.y){(Ae=L.current)==null||Ae.call(L),L.current=null;return}const P=k.x-N.x,v=k.y-N.y,H=Math.hypot(P,v),Z={x:N.x+P/2,y:N.y+v/2},q=(()=>{const ue={x:-v,y:P},ge=Math.hypot(ue.x,ue.y)||1;return{x:ue.x/ge,y:ue.y/ge}})(),Q=(P>=0?1:-1)*(m==="right"?1:-1),S=Math.min(u,H/1.5)*d*Q,se={x:Z.x+q.x*S,y:Z.y+q.y*S};a.current={p0:N,p1:se,p2:k};const ve=Math.max(yo/1e3,H/(c*120))*G.current,_e=1+p*Math.max(0,1-H/x),Pe=ve*_e;A.stop(),A.set(0);const Le=dt(A,1,{duration:Pe,ease:$.current?"linear":[.42,0,.58,1],onComplete:()=>{var ue;(ue=L.current)==null||ue.call(L),L.current=null}});return E.current=k,()=>Le.stop()},[w,u,c,m,d,p,x,A]),l.useEffect(()=>{if(!n||n.length===0)return;const k=n.filter(q=>["click","move","drag"].includes(q.action));if(k.length===0)return;const N=(q,Q)=>{const{top:me,left:S}=xs(Q,q);return new Promise(se=>{if(E.current.x===S&&E.current.y===me){st().then(se);return}L.current=se,b({x:S,y:me})})},P=async()=>{await dt(j,xo,{duration:Yt}).finished},v=async()=>{await dt(j,1,{duration:Yt}).finished},H=async()=>{await P(),await st(go),await v()};let Z=!1;return(async()=>{try{for(const q of k){if($.current=!1,Z)break;switch(q.action){case"click":{const Q=q;await N(Q.x,Q.y),await st(200),await H();break}case"move":{const Q=q;await N(Q.x,Q.y);break}case"drag":{const Q=q;if(Q.path.length===0)break;const[me,...S]=Q.path;await N(me[0],me[1]),await st(100),await P(),$.current=!0,G.current=y;for(let se=0;se<S.length;se++){const[ve,_e]=S[se];se===S.length-1&&(G.current=1,$.current=!1),await N(ve,_e)}await v();break}default:break}}}catch(q){Je.addError(q)}})(),()=>{Z=!0}},[n,j,y]),t.jsx("div",{className:J("absolute inset-0",i?"mt-2":"m-4 mb-12"),children:t.jsx("div",{className:J("relative",i?"aspect-[1024/777]":"aspect-[1024/755]"),children:t.jsxs("div",{className:"absolute inset-0",children:[t.jsx(re.div,{ref:U,style:{left:ie,top:ee,scale:j},className:"pointer-events-none absolute z-10 -translate-x-[30%] -translate-y-[55%]",children:t.jsx(uo,{className:"size-6"})}),t.jsx("div",{ref:X,className:"pointer-events-none absolute z-9 flex w-[240px] items-center justify-center lg:w-[320px]",style:{position:V,top:Y!=null?Y:0,left:B!=null?B:0},children:t.jsx(ro,{text:he})})]})})})},vo=Me(()=>Ee(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zl),__vite__mapDeps([0,1,2,3,4])),{loading:e=>Re(e)}),_o=({searchQuery:e,searchResults:s})=>{const[r,n]=l.useState(""),[i,u]=l.useState(null),c=l.useRef(null);l.useEffect(()=>{let d=!1;const p=y=>new Promise(w=>setTimeout(w,y));return(async()=>{if(await p(1e3),d)return;n(""),u(null);const y=[...e],w=y.length?1e3/y.length:1e3;for(let b=1;b<=y.length;b++){if(d)return;n(e.slice(0,b)),await p(w)}if(!d&&(u(s),await p(3e3),!d&&c.current)){const b=Math.floor(Math.random()*90)+10,j=(c.current.scrollHeight-c.current.clientHeight)*(b/100);c.current.scrollBy({top:j,behavior:"smooth"})}})(),()=>{d=!0}},[e,s]);const m=je();return t.jsxs(He,{className:"flex flex-col p-10",children:[t.jsx("div",{className:"border-token-border-default border-b p-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(vo,{className:"icon text-token-text-primary absolute start-2 top-1/2 mt-[1px] size-4 -translate-y-1/2"}),t.jsx("input",{type:"text",className:"text-token-text-primary text-s w-full border-none bg-transparent px-2 py-1 ps-7 outline-none focus:ring-0",value:r,placeholder:m.formatMessage(Fs.searchPlaceholder),readOnly:!0,tabIndex:-1})]})}),t.jsx("div",{ref:c,className:"flex flex-1 flex-col gap-4 overflow-auto px-4 py-4",children:t.jsx(Ue,{initial:!1,children:i==null?void 0:i.map((d,p)=>{var x;return t.jsxs(re.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{delay:p*.06,duration:.25},className:"mb-2 flex max-w-full flex-col",children:[t.jsxs("a",{className:"text-token-text-secondary flex max-w-full items-center gap-1 text-xs",href:d.rawUrl,target:"_blank",rel:"noopener noreferrer",children:[t.jsx("div",{className:"flex w-5 shrink-0 items-center justify-start",children:t.jsx(at,{className:"size-4",url:(x=d.rawUrl)!=null?x:"",size:128})}),t.jsx("div",{className:"flex min-w-0 flex-1 flex-row items-center gap-1",children:d.url})]}),t.jsx("span",{className:"text-token-text-secondary text-s mt-1 truncate",children:d.title})]},p)})})})]})},ko=In.define([{tag:Be.keyword,color:"#C280DF"},{tag:Be.string,color:"#A1C281"},{tag:Be.number,color:"#C99C6E"},{tag:Be.bool,color:"#DFC184"},{tag:Be.comment,color:"#5C6370",fontStyle:"italic"},{tag:Be.variableName,color:"#D27378"},{tag:Be.operator,color:"#73ABE5"},{tag:Be.invalid,color:"#FFFFFF"}]),ot="chatgpt-agent % ",bt="cm-input-line",ws="cm-input-prefix",To=()=>l.useMemo(()=>wt.theme({"&":{color:"#B0B6C3",backgroundColor:"#292C33",fontSize:"10px",height:"100%",width:"100%"},".cm-content":{caretColor:"#528BFF"},".cm-cursor, .cm-dropCursor":{borderLeftColor:"#528BFF"},".cm-selected":{backgroundColor:"#3E4451"},".cm-gutters":{backgroundColor:"#21252B",display:"none"},".cm-editor, .cm-scroller":{height:"100%"},".cm-scroller":{overflow:"auto"},".cm-line":{whiteSpace:"pre"},[".".concat(bt," *")]:{color:"#B0B6C3 !important"},[".".concat(bt," .").concat(ws)]:{color:"#73ABE5 !important"},".cm-content, .cm-line":{fontWeight:600,textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"}},{dark:!0}),[]),No=ms.line({class:bt}),Co=ms.mark({class:ws}),So=Mn.fromClass(class{constructor(e){Ot(this,"decorations");this.decorations=this.build(e)}update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=this.build(e.view))}build(e){const s=new Rn;for(const{from:o,to:r}of e.visibleRanges){let n=o;for(;n<=r;){const i=e.state.doc.lineAt(n);i.text.startsWith(ot)&&(s.add(i.from,i.from,No),s.add(i.from,i.from+ot.length,Co)),n=i.to+1}}return s.finish()}},{decorations:e=>e.decorations});function Io({title:e,code:s}){const o=l.useRef(null),r=l.useRef(null),{docInstant:n,docDelayed:i,needsDelay:u}=l.useMemo(()=>{const m=s.map(d=>d.type==="input"?"".concat(ot).concat(d.content):d.content).join("\n");return s.length>0&&s[s.length-1].type==="input"?{docInstant:m,docDelayed:"".concat(m,"\n"),needsDelay:!0}:{docInstant:"".concat(m,"\n").concat(ot),docDelayed:"",needsDelay:!1}},[s]),c=To();return l.useEffect(()=>{!o.current||r.current||(r.current=new wt({state:En.create({doc:n,extensions:[Cn.define(An),Sn(ko),wt.editable.of(!1),c,So]}),parent:o.current}))},[n,c]),l.useEffect(()=>{const m=r.current;if(m){if(m.dispatch({changes:{from:0,to:m.state.doc.length,insert:n}}),u){const d=setTimeout(()=>{m.dispatch({changes:{from:0,to:m.state.doc.length,insert:i}}),m.scrollDOM.scrollTop=m.scrollDOM.scrollHeight},500);return()=>clearTimeout(d)}requestAnimationFrame(()=>{m.scrollDOM.scrollTop=m.scrollDOM.scrollHeight})}},[n,i,u]),t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:e})}),t.jsx("div",{className:"flex flex-1 bg-[#282C34]",style:{minHeight:0},children:t.jsx("div",{ref:o,className:"h-full w-full flex-1",style:{minHeight:0}})})]})}const Ao=({id:e,children:s,content:o,side:r="bottom",sideOffset:n=4,align:i="center",className:u,triggerClassName:c,dismissOnOutsideClick:m=!0,allowReopen:d=!1})=>{const p="only-once-tooltip-dismissed:".concat(e),[x,y]=l.useState(!1),w=l.useRef(!1);l.useEffect(()=>{if(!w.current){w.current=!0;try{localStorage.getItem(p)==="true"||y(!0)}catch(j){y(!0)}}},[p]);const b=j=>{if(j){if(!d)try{if(localStorage.getItem(p)==="true")return}catch(A){}y(!0);return}try{localStorage.setItem(p,"true")}catch(A){}y(!1)};return t.jsxs(Js,{open:x,onOpenChange:b,children:[t.jsx(Gs,{asChild:!0,className:c,children:t.jsx("span",{children:s})}),t.jsx(Ks,{children:t.jsxs(en,{side:r,sideOffset:n,align:i,onPointerDownOutside:m?void 0:j=>j.preventDefault(),updatePositionStrategy:"always",className:J("animate-slideLeftAndFade z-30 rounded-xl border bg-blue-400 p-4 text-white shadow-sm",u),children:[o,t.jsx(tn,{asChild:!0,children:t.jsx("div",{className:"relative top-[-6px] h-3 w-3 rotate-45 transform rounded-ee-sm bg-blue-400"})})]})})]})},Zt="shadow-[0_5px_8px_3px_rgba(0,0,0,0.05),_0_0.5px_1px_0px_rgba(0,0,0,0.09)] outline outline-[0.5px] outline-black/5";function Eo(){return t.jsx("div",{className:"flex items-center justify-center gap-1",children:[0,1,2].map(e=>t.jsx("div",{className:"bg-token-border-heavy animate-dot-fade h-[6px] w-[6px] rounded-full opacity-50",style:{animationDelay:"".concat(e*.2,"s")}},e))})}const bs=52,Mo={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{stiffness:260,damping:20}}},Ro={initial:()=>({x:0}),animate:e=>({x:e?bs:0,transition:{stiffness:260,damping:20}})},Oo={initial:{opacity:0,scale:.8,x:0},animate:{opacity:1,scale:1,x:-bs,transition:{stiffness:260,damping:20}},exit:{opacity:0,scale:.8,x:0}},Po=({connector:e,action:s,connectorFetchResult:o,connectorSearchResults:r})=>{const n=je(),i=Ds(),u=l.useMemo(()=>s?yn({action:s,source:e!=null?e:void 0,intl:n}):null,[s,e,n]);let c=i?e==null?void 0:e.logo_url_dark:e==null?void 0:e.logo_url;return i&&!c&&(c=e==null?void 0:e.logo_url),t.jsxs(He,{className:"p-12",children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center gap-2 text-center",children:t.jsx(Ie,{id:"cua.cot.agent.connectors",defaultMessage:"Connectors"})})}),t.jsxs("div",{className:"flex w-full flex-1 flex-col items-center justify-center gap-4",children:[t.jsxs("div",{className:"relative h-16 w-32",children:[t.jsx(Ue,{children:c&&t.jsx(re.div,{className:"absolute inset-0 flex items-center justify-center",variants:Oo,initial:"initial",animate:"animate",exit:"exit",children:t.jsx("div",{className:J("bg-token-bg-elevated-primary rounded-lg p-2",Zt),children:t.jsx("img",{src:c,alt:e==null?void 0:e.name,className:"h-8 w-8 select-none"})})})}),t.jsx(Ue,{children:c&&t.jsx(re.div,{className:"absolute inset-0 flex items-center justify-center",variants:Mo,initial:"hidden",animate:"visible",exit:"hidden",children:t.jsx(Eo,{})})}),t.jsx(re.div,{className:"absolute inset-0 z-10 flex items-center justify-center",variants:Ro,custom:c,initial:"initial",animate:"animate",children:t.jsx("div",{className:J("bg-token-bg-elevated-primary rounded-lg p-3",Zt),children:t.jsx(On,{className:"text-token-text-primary h-6 w-6",matchTextColor:!0})})})]}),t.jsx("div",{className:"relative z-10 h-6 w-full",children:t.jsx(Ue,{mode:"sync",children:t.jsx(re.div,{className:"text-token-text-secondary pointer-events-none absolute inset-0 flex items-center justify-center text-center text-sm font-medium",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25},children:u},u)})}),e&&(o||r)&&t.jsx("div",{className:"flex w-full flex-col items-center justify-center px-8",children:t.jsx(Lo,{connectorFetchResult:o,connectorSearchResults:r,action:s})})]})]})},Lo=({connectorFetchResult:e,connectorSearchResults:s,action:o})=>{const r=[];let n=[];if(o==="n7jupd_cs"&&s)n=s.map(u=>({entries:[{url:u.url,title:u.title,snippet:"",attribution:u.title}]}));else if(o==="n7jupd_cf"&&e)n=[{entries:[{url:e==null?void 0:e.url,title:e==null?void 0:e.title,snippet:"",attribution:e==null?void 0:e.title}]}];else return null;const i={type:D.Search,queries:r,sources:n};return t.jsx(wn,{chunk:i,isExpanded:!0,isComplete:!0,useCloudDocIcons:!0,isSmall:!1,isVisualCoT:!0})},Do="_frostedContainer_1rwq4_1",Vo="_blurStack_1rwq4_8",$o="_blur_1rwq4_8",Ho="_layer0_1rwq4_42",Wo="_layer1_1rwq4_47",zo="_layer2_1rwq4_52",Bo="_layer3_1rwq4_57",Uo="_layer4_1rwq4_62",qo="_layer5_1rwq4_67",pe={frostedContainer:Do,blurStack:Vo,blur:$o,layer0:Ho,layer1:Wo,layer2:zo,layer3:Bo,layer4:Uo,layer5:qo};function Qo({file_id:e,title:s,clientThreadId:o}){const[r,n]=l.useState(!1),i=as(o),{data:u}=Dn(!0,i,e,void 0,()=>{});return t.jsx("div",{className:"bg-token-bg-tertiary flex h-full w-full flex-col items-center justify-center",children:t.jsxs("div",{className:"".concat(pe.frostedContainer," relative flex h-full w-full flex-row items-center justify-center text-center text-sm"),children:[t.jsx("div",{className:"text-token-text-secondary absolute top-0 z-10 flex w-full flex-row items-center justify-center py-2 text-xs font-medium",children:s}),!r&&t.jsx("img",{src:u==null?void 0:u.download_url,alt:"",className:"h-full w-full object-cover",onError:()=>n(!0)}),t.jsxs("div",{className:pe.blurStack,children:[t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer0)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer1)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer2)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer3)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer4)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer5)})]})]})})}const Xo=({file_id:e,title:s,clientThreadId:o,prompt:r})=>{const{formatMessage:n}=je();return e?t.jsx(He,{children:t.jsx("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center",children:t.jsx(Qo,{file_id:e,title:s,clientThreadId:o})})}):t.jsx(He,{children:t.jsxs("div",{className:"bg-token-bg-tertiary flex h-full flex-col items-center justify-center",children:[t.jsx("div",{className:"flex w-full flex-row items-center justify-center py-2 text-center text-xs",children:n(Ce.generatingImage)}),t.jsxs("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center gap-4",children:[t.jsx(Pn,{children:t.jsx(Ln,{matchTextColor:!0})}),t.jsx("div",{className:"text-token-text-secondary line-clamp-5 px-12 text-center text-xs italic",children:r})]})]})})},Yo=({signedScreenshotUrl:e})=>{const{formatMessage:s}=je(),o=jt(e);return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:s(Ce.imageViewer)})}),t.jsx("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center",children:o&&t.jsx("img",{src:o,alt:"",className:"max-h-full object-contain"})})]})};function Zo({signedScreenshotUrl:e}){const{formatMessage:s}=je(),o=jt(e);return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:s(Ce.libreoffice)})}),o&&t.jsx("div",{className:"bg-primary relative aspect-[1024/768] w-full overflow-hidden rounded-b-lg",children:t.jsx("img",{src:o,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom"},o)})]})}const Oe=e=>typeof e=="object"&&e!=null,Se=e=>typeof e=="number",vt=e=>typeof e=="string",Fo=e=>Oe(e)&&e.action==="drag"&&Array.isArray(e.path)&&e.path.every(s=>Se(s[0])&&Se(s[1])),Jo=e=>Oe(e)&&e.action==="move"&&Se(e.x)&&Se(e.y),Go=e=>Oe(e)&&e.action==="scroll"&&Se(e.x)&&Se(e.y)&&Se(e.scroll_y)&&Se(e.scroll_x),Ko=e=>Oe(e)&&e.action==="click"&&Se(e.x)&&Se(e.y)&&Se(e.button),er=e=>Oe(e)&&e.action==="type"&&vt(e.text),tr=e=>Oe(e)&&e.action==="keypress"&&Array.isArray(e.keys)&&e.keys.every(vt),sr=e=>Oe(e)&&e.action==="wait",nr=e=>Go(e)||Ko(e)||er(e)||tr(e)||sr(e)||Fo(e)||Jo(e),or=e=>Oe(e)&&e.action==="search_with_snippets"&&Array.isArray(e.queries)&&e.queries.every(vt),rr=e=>or(e);function ar(e){const s=e.indexOf("{");if(s<0)return;let o;try{o=JSON.parse(e.slice(s))}catch(n){Je.addError(n);return}if(!Oe(o)||!Array.isArray(o.actions))return;const r=o.actions.filter(nr);return r.length>0?{actions:r}:void 0}function Ft(e){let s;try{s=JSON.parse(e!=null?e:"{}")}catch(r){Je.addError(r);return}if(!Oe(s)||!Array.isArray(s.actions))return;const o=s.actions.filter(rr);return o.length>0?{actions:o}:void 0}const ir=Me(()=>Ee(()=>import("./jxyz1kdkcze5jtww.js"),__vite__mapDeps([9,1])),{loading:e=>Re(e)}),lr=Me(()=>Ee(()=>import("./dni8akjyvev2h15q.js"),__vite__mapDeps([10,1])),{loading:e=>Re(e)}),cr=Me(()=>Ee(()=>import("./dkjdqjcct64qk1e4.js"),__vite__mapDeps([11,1])),{loading:e=>Re(e)}),ur=({value:e,max:s,isPlaying:o,onChange:r,onPlayPause:n,onRestart:i,onLive:u,isLive:c,isComplete:m,isKAUR1BR5:d})=>{const{formatMessage:p}=je(),x=ds(),y=Vs();return x||y?null:t.jsxs("div",{className:J("z-10 flex w-full items-center gap-2 px-4 py-0 pb-4 text-xs select-none",d?"absolute bottom-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100":"relative"),children:[t.jsx("div",{className:J("absolute start-0 w-full bg-gradient-to-t from-gray-950/90 to-gray-500/0",d?"-top-5 h-20":"top-0 h-16")}),m&&t.jsx("button",{className:"border-token-border-light hover:bg-token-surface-primary/20 relative z-10 rounded text-white",onClick:c?i:n,children:o?t.jsx(lr,{className:"size-4"}):c?t.jsx(cr,{className:"size-4"}):t.jsx(ir,{className:"size-4"})}),t.jsxs(sn,{className:"group relative flex flex-1 items-center",min:0,max:s,step:1,value:[e],onValueChange:([w])=>r(w),children:[t.jsx(nn,{className:"relative h-[4px] w-full grow cursor-pointer rounded-full bg-black/20",children:t.jsx(on,{className:"absolute h-full rounded-full bg-white/90"})}),t.jsx(rn,{className:"touch:h-3 touch:w-3 relative block h-1.5 w-1.5 scale-100 cursor-pointer rounded-full border bg-white shadow-md transition-transform group-hover:scale-200 before:pointer-events-auto before:absolute before:inset-[-12px] before:rounded-full before:bg-transparent before:content-[''] focus:outline-none"})]}),!m&&t.jsx("span",{className:J("z-1 cursor-pointer font-medium text-white uppercase opacity-50",c&&"text-gray-500 opacity-100"),onClick:u,children:p(Ce.live)})]})},dr=Me(()=>Ee(()=>import("./kivvchsexr54fuso.js"),__vite__mapDeps([12,1])),{loading:e=>Re(e)}),Jt="file:///home/oai/redirect.html",fr=0,Gt=35,Kt=20;function pt(e,s){const{cursorTop:o,cursorLeft:r}=e;return o<s.top||o>s.top+s.height||r<s.left||r>s.left+s.width?(e.cursorTop=Math.random()*s.height+s.top,e.cursorLeft=Math.random()*s.width+s.left,!0):!1}const ht={image_viewer:{top:80,left:0,width:100,height:20},api_tool:{top:0,left:50,width:50,height:10}},mr=(e,s,o)=>{var m,d,p,x,y,w,b,j,A,L,E,a,ae,G,$,ie,ee,le,te,he,B,Y,U,X,V,k,N,P,v,H,Z,q,Q,me,S,se,ve,_e,Pe,Le,Ae,ue,ge,ye,Ze,qe,Qe,Xe,de,We,De,ze,C,W,fe,I,_,ne,oe,we,ke;let r=0;const{message:n,groupType:i}=s;let u=!1;const c=f=>{const g=e.openApps.indexOf(f);g!==-1?e.currentWindowIndex=g:(e.openApps.push(f),e.currentWindowIndex=e.openApps.length-1)};switch(i){case xe.StructuredThoughts:break;case xe.CodeInterpreter:if(c("terminal"),n.author.role==="tool"&&n.author.name==="container.exec"&&n.content.content_type==="text"){const f=n.content.parts.map(g=>({type:"output",content:g}));e.code.push(...f)}else if(n.author.role==="assistant"&&n.recipient==="python"&&n.content.content_type==="code"){const f=(m=n.content.text)!=null?m:"";e.code.push({type:"input",content:"python <<EOF\n".concat(f,"\nEOF\n")})}else if(n.author.role==="tool"&&n.author.name==="python"&&n.content.content_type==="execution_output"){const f=(d=n.content.text)!=null?d:"";e.code.push({type:"output",content:f})}else if(n.author.role==="assistant"&&n.recipient==="container.exec"&&n.content.content_type==="code")try{const f=JSON.parse(n.content.text).cmd;e.code.push({type:"input",content:f.join(" ")})}catch(f){Je.addError(f)}r=2e3;break;case xe.n7jupd:if(n.content.content_type===$e.ComputerOutput){const f=(x=(p=n.metadata)==null?void 0:p.n7jupd_v)==null?void 0:x.title,g=(w=(y=n.metadata)==null?void 0:y.n7jupd_v)==null?void 0:w.application,T=ct(lt({},n.content.screenshot),{vmMetadata:(b=n.metadata)==null?void 0:b.n7jupd_v,messageId:n.id});g==="Browser"?(e.isReaderMode=!1,c("browser"),e.screenshots.push(T)):g!=null&&g.startsWith("LibreOffice")||g!=null&&g.startsWith("Select a Template")?(e.isReaderMode=!1,c("libreoffice"),e.libreOfficeScreenshots.push(T)):(e.isReaderMode=!1,c("browser"),e.screenshots.push(T)),e.tabMetadata=us(T),e.computerApplication=g!=null?g:null,e.computerTitle=f!=null?f:null,r=2e3}if(n.content.content_type===$e.StructuredThoughts&&(e.thought=n.content.thoughts.map(f=>f.content).join(""),r=1e3),n.recipient!=="computer.switch_app"){if((j=n.recipient)!=null&&j.includes("computer")&&n.content.content_type===$e.Code){const f=n.content.text,g=ar(f);e.actions=(A=g==null?void 0:g.actions)!=null?A:[],r=1e3,g&&(g.actions.forEach(T=>{switch(T.action){case"click":{u=!0;const{top:R,left:M}=xs(T.y,T.x);e.cursorTop=R,e.cursorLeft=M,e.isCursorInInitialPosition=!1,r+=1e3;break}case"type":break;case"scroll":break;case"keypress":break;case"wait":break;case"move":break;case"drag":r+=1e3;break}}),r=Math.min(r,4e3))}}break;case xe.n7jupd_x:if(n.author.role==="assistant"&&n.content.content_type===$e.Code){const f=Ft(n.content.text),g=f==null?void 0:f.actions.find(T=>T.action==="search_with_snippets"&&T.queries.length);g&&(c("search"),e.searchResults=null,e.searchQuery=g.queries.join(" || "),r=1e3)}else if(n.author.name==="browser.search"){c("search");const f=(ae=(a=(E=(L=n.metadata)==null?void 0:L.n7jupd_title)==null?void 0:E.match(/`(.*)`/))==null?void 0:a[1])!=null?ae:"",g=($=(G=n.metadata)==null?void 0:G.n7jupd_titles)==null?void 0:$.map((T,R)=>{var ce,be,Te;const M=(Te=(be=(ce=n.metadata)==null?void 0:ce.n7jupd_urls)==null?void 0:be[R])!=null?Te:"",{domain:F}=Qt(M);return{title:T,url:F!=null?F:void 0,name:void 0,rawUrl:M}});e.searchResults=g!=null?g:null,e.searchQuery=f,r=6e3}else if(n.author.name==="browser.open"&&n.content.content_type==="tether_browsing_display"){c("browser"),e.isReaderMode=!0;const f=(ee=(ie=n.metadata)==null?void 0:ie.n7jupd_url)!=null?ee:"",{tetherUrl:g,tetherTitle:T,domain:R}=Xt(f,(te=(le=n.metadata)==null?void 0:le.n7jupd_title)!=null?te:null);e.tetherData={summary:(he=n.content.summary)!=null?he:null,result:(B=n.content.result)!=null?B:null,domain:R,title:T,url:g},e.tetherData.title===Jt&&(e.isReaderMode=!1),r=6e3}else if(n.author.name==="browser.run"&&n.content.content_type==="tether_browsing_display"){const f=(V=(X=(U=(Y=n.metadata)==null?void 0:Y.n7jupd_title)==null?void 0:U.match(/`(.*)`/))==null?void 0:X[1])!=null?V:"",g=(N=(k=n.metadata)==null?void 0:k.n7jupd_titles)==null?void 0:N.map((T,R)=>{var ce,be,Te;const M=(Te=(be=(ce=n.metadata)==null?void 0:ce.n7jupd_urls)==null?void 0:be[R])!=null?Te:"",{domain:F}=Qt(M);return{title:T,url:F!=null?F:void 0,name:void 0,rawUrl:M}});if(g!=null&&g.length)c("search"),e.searchResults=g,e.searchQuery=f,r=6e3;else{c("browser"),e.isReaderMode=!0;const T=(v=(P=n.metadata)==null?void 0:P.n7jupd_url)!=null?v:"",{tetherUrl:R,tetherTitle:M,domain:F}=Xt(T,(Z=(H=n.metadata)==null?void 0:H.n7jupd_title)!=null?Z:null);e.tetherData={summary:(q=n.content.summary)!=null?q:null,result:(Q=n.content.result)!=null?Q:null,domain:F,title:M,url:R},e.tetherData.title===Jt&&(e.isReaderMode=!1),r=6e3}}break;case xe.n7jupd_a:{const f=(me=n.metadata)==null?void 0:me.n7jupd_subtool,g=Ht();(S=f==null?void 0:f.subtool)!=null&&S.includes("search")?e.apiAction="n7jupd_as":(se=f==null?void 0:f.subtool)!=null&&se.includes("api_doc")&&(e.apiAction="n7jupd_ag");const T=(_e=(ve=n.metadata)==null?void 0:ve.n7jupd_subtool)==null?void 0:_e.generic_api_func;let R=(Le=(Pe=T==null?void 0:T.match(ft))==null?void 0:Pe[0])!=null?Le:void 0;R||(R=(ye=(ge=(ue=(Ae=n.metadata)==null?void 0:Ae.n7jupd_url)==null?void 0:ue.match(ft))==null?void 0:ge[0])!=null?ye:void 0);const M=g==null?void 0:g.get(R!=null?R:"");if(!R||!M)e.apiAction="n7jupd_cf";else if((Ze=n.metadata)!=null&&Ze.connector_source&&n.content.content_type===$e.TetherBrowsingDisplay){(qe=n.metadata)!=null&&qe.display_url&&((Qe=n.metadata)!=null&&Qe.display_title)&&(e.apiAction="n7jupd_cf",e.connector=M,e.connectorFetchResult={url:(Xe=n.metadata)==null?void 0:Xe.display_url,title:(de=n.metadata)==null?void 0:de.display_title});const F=Wt(n.content.result);F.length&&(e.apiAction="n7jupd_cs",e.connector=M,e.connectorSearchResults=F.map(([ce,be])=>({url:ce,title:be})))}c("api_tool"),pt(e,ht.api_tool),r=1e3,M&&(e.connector=M);break}case xe.n7jupd_native_api_tool:{const f=n.recipient;if(f!=null&&f.includes("list_resources")||f!=null&&f.includes("search_tools")?e.apiAction="n7jupd_as":(f!=null&&f.includes("read_resources")||f!=null&&f.includes("get_resource"))&&(e.apiAction="n7jupd_ag"),n.content.content_type!==$e.CitableCodeOutput)e.apiAction="n7jupd_cf";else{const g=Ht();e.apiAction="n7jupd_cf";let T=(De=(We=n.content.metadata)==null?void 0:We.connector_id)!=null?De:void 0;T||(T=(C=(ze=n.content.output_str.match(ft))==null?void 0:ze[0])!=null?C:void 0);const R=g==null?void 0:g.get(T!=null?T:"");R&&(e.connector=R),(W=n.content.metadata)!=null&&W.display_url&&((fe=n.content.metadata)!=null&&fe.display_title)&&(e.connectorFetchResult={url:(I=n.content.metadata)==null?void 0:I.display_url,title:(_=n.content.metadata)==null?void 0:_.display_title});const M=Wt(n.content.output_str);M.length&&(e.apiAction="n7jupd_cs",e.connectorSearchResults=M.map(([F,ce])=>({url:F,title:ce})))}c("api_tool"),pt(e,ht.api_tool),r=1e3;break}case xe.Container:n.content.content_type===$e.MultimodalText&&(c("image_viewer"),pt(e,ht.image_viewer),n.content.parts.forEach(f=>{typeof f!="string"&&f.content_type===Dt.ImageAssetPointer&&e.imageViewerScreenshots.push(ct(lt({},f),{messageId:n.id}))}),r=3e3);break;case xe.t2uay3k:if(!o)break;if(n.author.name==="t2uay3k.sj1i4kz"&&n.content.content_type===$e.MultimodalText){const f=n.content.parts.at(0);if(typeof f=="string")break;(f==null?void 0:f.content_type)===Dt.ImageAssetPointer?(e.imageGenFileId=f.asset_pointer,r=2e3):Je.addError("Error parsing image gen file id",{message:n}),e.imageGenTitle=(oe=(ne=n.metadata)==null?void 0:ne.image_gen_title)!=null?oe:null,r=2e3}break;case xe.Debug:{if(n.author.role==="assistant"&&n.content.content_type===$e.Code){const f=Ft(n.content.text),g=f==null?void 0:f.actions.find(T=>T.action==="search_with_snippets"&&T.queries.length);g&&(c("search"),e.searchResults=null,e.searchQuery=g.queries.join(" || "),r=Math.max(r,1e3))}if(!o)break;if(n.recipient==="imagegen.make_image"&&n.content.content_type==="code"){c("image_gen"),e.imageGenFileId=null,r=1e3,e.imageGenTitle=(ke=(we=n.metadata)==null?void 0:we.image_gen_title)!=null?ke:null;try{e.imageGenPrompt=JSON.parse(n.content.text).prompt}catch(f){Je.addError("Error parsing image gen prompt",{e:f,text:n.content.text})}}break}}return!u&&(e.isCursorInInitialPosition||Math.random()<fr)&&e.openApps.length&&(e.isCursorInInitialPosition=!1,e.cursorTop=Math.random()*30+20,e.cursorLeft=Math.random()*60+20),r},pr=({messageGroups:e,isStreaming:s,isFinalAssistantTurn:o,isComplete:r,clientThreadId:n,enableVisualReaderMode:i=!1,isKAUR1BR5:u=!1})=>{var k,N,P,v,H,Z,q,Q,me,S,se,ve,_e,Pe,Le,Ae,ue,ge,ye,Ze,qe,Qe,Xe,de,We,De,ze;const c=as(n),m=rt(),d=is(m,"3639187874"),p=l.useMemo(()=>e.flatMap(W=>W.messages.map(fe=>({message:fe,groupType:W.type}))).map(W=>({message:W.message,messageType:$s(W.message),groupType:W.groupType})),[e]),[x,y]=l.useState([]),[w,b]=l.useState(0),[j,A]=l.useState(s),[L,E]=l.useState(!0),[a,ae]=l.useState(null),G=an(n),$=l.useRef(null),ie=nt(a==null?void 0:a.screenshot,c),ee=nt(a==null?void 0:a.libreOfficeScreenshots.at(-1),c),le=nt(a==null?void 0:a.imageViewerScreenshots.at(-1),c),te=l.useCallback((C,W)=>{var ne,oe,we,ke,f,g,T,R,M,F,ce,be,Te,et,tt;const fe=[...C];let I=fe.length>0?fe[fe.length-1]:null,_;I?_={cursorTop:I.cursorTop,cursorLeft:I.cursorLeft,thought:I.thought,openApps:[...I.openApps],currentWindowIndex:I.currentWindowIndex,screenshots:I.screenshot?[I.screenshot]:[],libreOfficeScreenshots:(ne=I.libreOfficeScreenshots)!=null?ne:[],searchResults:(oe=I.searchResults)!=null?oe:null,searchQuery:(we=I.searchQuery)!=null?we:null,code:[...I.code],tabMetadata:(ke=I.tabMetadata)!=null?ke:null,isCursorInInitialPosition:!1,tetherData:(f=I.tetherData)!=null?f:null,lastVisualAppSwitch:(g=I.lastVisualAppSwitch)!=null?g:null,imageViewerScreenshots:(T=I.imageViewerScreenshots)!=null?T:[],connector:(R=I.connector)!=null?R:null,computerApplication:(M=I.computerApplication)!=null?M:null,computerTitle:(F=I.computerTitle)!=null?F:null,isReaderMode:(ce=I.isReaderMode)!=null?ce:!1,actions:null,imageGenTitle:(be=I.imageGenTitle)!=null?be:null,imageGenFileId:(Te=I.imageGenFileId)!=null?Te:null,imageGenPrompt:null}:_={cursorTop:Gt,cursorLeft:Kt,thought:"",openApps:[],currentWindowIndex:0,screenshots:[],searchResults:null,searchQuery:null,code:[],tabMetadata:null,isCursorInInitialPosition:!0,isReaderMode:!1,tetherData:null,libreOfficeScreenshots:[],lastVisualAppSwitch:null,imageViewerScreenshots:[],connector:null,computerApplication:null,computerTitle:null,actions:null,imageGenTitle:null,imageGenFileId:null,imageGenPrompt:null};for(let Fe=fe.length;Fe<=W;Fe++){const Ye=mr(_,p[Fe],d),Ke={cursorTop:_.cursorTop,cursorLeft:_.cursorLeft,thought:_.thought,openApps:[..._.openApps],currentWindowIndex:_.currentWindowIndex,screenshot:(tt=((et=_.screenshots)!=null?et:[]).at(-1))!=null?tt:null,searchResults:_.searchResults,searchQuery:_.searchQuery,code:[..._.code],tabMetadata:_.tabMetadata,isReaderMode:_.isReaderMode,tetherData:_.tetherData,libreOfficeScreenshots:[..._.libreOfficeScreenshots],lastVisualAppSwitch:_.lastVisualAppSwitch,imageViewerScreenshots:[..._.imageViewerScreenshots],connector:_.connector,apiAction:_.apiAction,connectorFetchResult:_.connectorFetchResult,connectorSearchResults:_.connectorSearchResults,delayMs:Ye,computerApplication:_.computerApplication,computerTitle:_.computerTitle,actions:_.actions,imageGenTitle:_.imageGenTitle,imageGenFileId:_.imageGenFileId,imageGenPrompt:_.imageGenPrompt};I&&(Ke.lastVisualAppSwitch=I.lastVisualAppSwitch),fe.push(Ke),I=Ke}return{newFrames:fe}},[p,d]);l.useEffect(()=>{if(x.length<p.length){const{newFrames:C}=te(x,p.length-1);y(C)}L&&b(p.length-1)},[p.length,te,x,L]);const he=l.useCallback(()=>{if(w>=x.length-1){r&&(A(!1),E(!0));return}const C=x[w];$.current&&clearTimeout($.current),$.current=setTimeout(()=>{b(W=>W+1)},C.delayMs)},[w,x,r]);l.useEffect(()=>{if(!L)return j&&he(),()=>{$.current&&clearTimeout($.current)}},[j,w,x.length,he,L]),l.useEffect(()=>{const C=x[w];C&&ae(C)},[w,x]);const{formatMessage:B}=je(),Y=(a==null?void 0:a.currentWindowIndex)===(a==null?void 0:a.openApps.findIndex(C=>C==="browser")),U={browser:t.jsx(so,{tabMetadata:(k=a==null?void 0:a.tabMetadata)!=null?k:null,signedScreenshotUrl:ie,newTabTitle:B(Ce.newTab),isReaderMode:(N=a==null?void 0:a.isReaderMode)!=null?N:!1,url:(v=(P=a==null?void 0:a.tetherData)==null?void 0:P.url)!=null?v:"",domain:(Z=(H=a==null?void 0:a.tetherData)==null?void 0:H.domain)!=null?Z:"",title:(Q=(q=a==null?void 0:a.tetherData)==null?void 0:q.title)!=null?Q:"",tetherData:(me=a==null?void 0:a.tetherData)!=null?me:null,isKAUR1BR5:u,isActive:Y,serverThreadId:c!=null?c:"",isStreaming:s}),terminal:t.jsx(Io,{title:B(Ce.terminal),code:(S=a==null?void 0:a.code)!=null?S:[]}),search:t.jsx(_o,{searchQuery:(se=a==null?void 0:a.searchQuery)!=null?se:"",searchResults:(ve=a==null?void 0:a.searchResults)!=null?ve:null}),libreoffice:t.jsx(Zo,{title:B(Ce.libreoffice),signedScreenshotUrl:ee}),tether_browser:i?null:t.jsx(eo,{url:(Pe=(_e=a==null?void 0:a.tetherData)==null?void 0:_e.url)!=null?Pe:"",domain:(Ae=(Le=a==null?void 0:a.tetherData)==null?void 0:Le.domain)!=null?Ae:"",title:(ge=(ue=a==null?void 0:a.tetherData)==null?void 0:ue.title)!=null?ge:""}),image_viewer:t.jsx(Yo,{signedScreenshotUrl:le}),api_tool:t.jsx(Po,{connector:(ye=a==null?void 0:a.connector)!=null?ye:null,connectorFetchResult:a==null?void 0:a.connectorFetchResult,connectorSearchResults:a==null?void 0:a.connectorSearchResults,action:a==null?void 0:a.apiAction}),image_gen:t.jsx(Xo,{file_id:(Ze=a==null?void 0:a.imageGenFileId)!=null?Ze:"",title:(qe=a==null?void 0:a.imageGenTitle)!=null?qe:"",clientThreadId:n,prompt:(Qe=a==null?void 0:a.imageGenPrompt)!=null?Qe:""})},X=a==null?void 0:a.openApps.map(C=>U[C]),V=s&&o&&G;return t.jsxs("div",{className:"group flex w-full flex-col gap-2",children:[t.jsx("div",{className:J("border-token-border-default bg-token-surface-primary relative flex w-full flex-col items-center overflow-hidden rounded-2xl border",V&&"outline-2 outline-offset-1 outline-orange-500"),children:t.jsxs("div",{className:"relative flex w-full flex-col overflow-hidden",children:[t.jsx("div",{className:"absolute start-0 end-0 top-0 bottom-0 dark:hue-rotate-180 dark:invert",children:t.jsx("video",{className:"h-full w-full object-cover",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:t.jsx("source",{src:"https://persistent.oaistatic.com/deep-research/d9a42348470e-bg.mp4",type:"video/mp4"})})}),t.jsx(jo,{top:(Xe=a==null?void 0:a.cursorTop)!=null?Xe:Gt,left:(de=a==null?void 0:a.cursorLeft)!=null?de:Kt,text:(We=a==null?void 0:a.thought)!=null?We:"",actions:(De=a==null?void 0:a.actions)!=null?De:[],isKAUR1BR5:u}),t.jsx("div",{className:"relative flex h-full w-full flex-row",style:{transform:"translateX(-".concat(((ze=a==null?void 0:a.currentWindowIndex)!=null?ze:0)*100,"%)"),transition:"transform 0.5s cubic-bezier(0.4,0,0.2,1)",width:"100%",paddingTop:u?"calc((714 / 1024 * 100%) + 38px)":"calc((697 / 1024 * 100%) + 38px)"},children:t.jsx("div",{className:"absolute inset-0 flex h-full flex-row",children:X})}),t.jsx(ur,{value:w,max:Math.max(x.length-1,0),isPlaying:j,onChange:C=>{A(!1),b(C),C===x.length-1?E(!0):E(!1)},onPlayPause:()=>A(C=>!C),onRestart:()=>{b(0),A(!0),E(!1)},onLive:()=>{b(x.length-1),A(!0),E(!0)},isLive:L,isComplete:r,isKAUR1BR5:u})]})}),V&&t.jsxs("div",{className:"flex flex-row items-center justify-start gap-1",children:[t.jsx(Ao,{id:"risky-domain-warning",side:"top",sideOffset:-8,allowReopen:!0,className:"max-w-sm",content:t.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[t.jsx("div",{className:"font-semibold",children:t.jsx(Ie,{id:"OZapq8",defaultMessage:"Watch while ChatGPT works with sensitive data"})}),t.jsx("div",{children:t.jsx(Ie,{id:"1orBxj",defaultMessage:"ChatGPT is working with {riskyDomain}, which contains sensitive data. If you notice anything bad happening, you can stop the task.",values:{riskyDomain:t.jsx("span",{className:"font-medium",children:G})}})})]}),children:t.jsxs("div",{className:"flex flex-row items-center gap-1 text-orange-500",children:[t.jsx(dr,{className:"size-4 cursor-pointer"}),t.jsx(Ie,{id:"51tzX5",defaultMessage:"Sensitive data Â· Something not right?"})]})}),t.jsx("button",{className:"text-token-text-secondary underline","aria-label":B(Ce.stopAgent),onClick:async()=>{await ln(n,void 0,{clientInitiated:!0,reason:"watch_mode_stop",isLastTurnAgent:!0})},children:B(Ce.stopAgent)})]})]})},hr=({isAgentTurn:e,clientThreadId:s,children:o,messageGroups:r,isExpanded:n,visualMode:i,isStreaming:u,isComplete:c,isStopping:m,isFinalAssistantTurn:d,isKAUR1BR5:p,enableVisualReaderMode:x=!1})=>{if(!e)return o;if(!n&&!u||m)return null;const y=i==="visual-cot",w=i==="list-cot";return t.jsxs("div",{className:"flex flex-col",children:[y&&t.jsx(pr,{clientThreadId:s,messageGroups:r,isStreaming:u,isComplete:c,isFinalAssistantTurn:d,enableVisualReaderMode:x,isKAUR1BR5:p}),w&&t.jsx(xr,{children:o})]})},xr=({children:e})=>{const s=l.useRef(null),[o,r]=l.useState(!0);return l.useEffect(()=>{const n=s.current;if(!n)return;const i=()=>{const u=n.scrollHeight-n.scrollTop-n.clientHeight;r(u<=1)};return n.addEventListener("scroll",i,{passive:!0}),()=>n.removeEventListener("scroll",i)},[]),l.useEffect(()=>{const n=s.current;!n||!o||requestAnimationFrame(()=>{n.scrollTop=n.scrollHeight})},[e,o]),t.jsx("div",{ref:s,className:"border-token-border-light flex aspect-[614/493] flex-col overflow-auto rounded-lg border p-4",children:t.jsx("div",{className:"flex flex-col",children:e})})},es={duration:.3,ease:"easeInOut"},xt=.2,Hr=({isStreaming:e,isFinalAssistantTurn:s,messageGroups:o,nextMessageGroup:r,prevMessageGroup:n,isAutoswitchOptOutEnabled:i,handleSkipClick:u,isAgentTurn:c,isGlauxTurn:m,isKAUR1BR5:d,taskType:p,latestError:x,wasInterrupted:y,lastAgentMetadataNode:w,conversation:b,turnIndex:j,currentGroupedMessageIndex:A,activeTask:L})=>{const E=rt(),a=fs(E,!!c),ae=l.useMemo(()=>o.some(V=>V.type===xe.n7jupd_a||V.type===xe.n7jupd_native_api_tool),[o]),{platformConnectors:G}=Hs(ae),[$,ie]=l.useState(!1);Zn();const{chunks:ee,isAgentVisualCoT:le,containsAuraComputerTool:te}=l.useMemo(()=>Nn(E,o,m),[E,o,m]),he=r==null?void 0:r.messages.some(V=>cn(V)),{toggleThreadSidebar:B}=un(),{resetSidebarHistory:Y}=dn(),U=l.useCallback(()=>{Y(),B({type:"cot",turnIndex:j,reasoningGroupIndex:A})},[B,j,A,Y]),X=l.useCallback(()=>{var V,k;B({type:"retrievalResults",turnIndex:j,messageId:(k=(V=o[0])==null?void 0:V.messages[0])==null?void 0:k.id})},[B,j,o]);return x&&!he?t.jsx(kn,{errorState:x,nodeId:x.messageId,isFeedbackEnabled:!1,conversation:x.conversation,isUserTurn:!1}):t.jsx(fn,{value:{platformConnectors:G},children:t.jsx(yr,{conversation:b,isStreaming:e,isFinalAssistantTurn:s,chunks:ee,isAutoswitchOptOutEnabled:i,isAgentTurn:c,containsAuraComputerTool:te,handleSkipClick:u,handleOpenCotSidebar:U,handleShowRetrievalResults:X,nextMessageGroup:r,prevMessageGroup:n,messageGroups:o,isAgentVisualCoT:le,isKAUR1BR5:d,isGlauxTurn:m,taskType:p,wasInterrupted:y,lastAgentMetadataNode:w,isExpanded:!a&&$,setIsExpanded:ie,turnIndex:j,activeTask:L})})},gr=e=>{for(const{messages:s}of e)for(const{metadata:o}of s)if(o!=null&&o.skip_reasoning_title)return o.skip_reasoning_title},yr=({conversation:e,isStreaming:s,isFinalAssistantTurn:o,chunks:r,isAutoswitchOptOutEnabled:n,isAgentTurn:i,handleSkipClick:u,handleOpenCotSidebar:c,handleShowRetrievalResults:m,nextMessageGroup:d,prevMessageGroup:p,messageGroups:x=[],isAgentVisualCoT:y,containsAuraComputerTool:w=!1,isKAUR1BR5:b,isGlauxTurn:j,taskType:A,wasInterrupted:L,lastAgentMetadataNode:E,isExpanded:a,setIsExpanded:ae,turnIndex:G,activeTask:$})=>{var Nt,Ct,St;const ie=je(),ee=rt(),le=((Nt=E==null?void 0:E.metadata)==null?void 0:Nt.agent_entrypoint)==="autoswitcher",te=i?le:n,he=te?gr(x):void 0,B=Ws(),Y=Yn(r,s,B,le,b!=null?b:!1),U=i?Y!==Ne.Done:!1,[X,V]=zs(()=>[qs(ee),Qs(ee)]),v=is(ee,"1668913216")&&y&&!(X||V&&!w),H=l.useMemo(()=>{var O,z;let h="visual-cot";return E&&(h=(z=(O=E==null?void 0:E.metadata)==null?void 0:O.default_view)!=null?z:"visual-cot"),h},[E]),[Z,q]=l.useState(H),[Q,me]=l.useState([]),S=!s,se=l.useMemo(()=>i?r.filter(O=>O.type!==D.Recap&&O.type!==D.Thought).slice(-3).some(O=>O.type===D.ComputerOutput):!1,[r,i]),ve=l.useMemo(()=>i&&r.some(h=>h.type===D.Recap&&h.content.includes("Stopped")),[r,i]),_e=h=>{var O,z,K,Ve,It,At,Et,Mt;return(z=(O=h.metadata)==null?void 0:O.content_references)!=null&&z.length?((Ve=(K=h.metadata)==null?void 0:K.content_references)==null?void 0:Ve.length)>0:(At=(It=h.metadata)==null?void 0:It.n7jupd_crefs)!=null&&At.length?((Mt=(Et=h.metadata)==null?void 0:Et.n7jupd_crefs)==null?void 0:Mt.length)>0:!1},Pe=h=>{var O;return((O=h.metadata)==null?void 0:O.n7jupd_button_type)!==void 0},Le=l.useMemo(()=>i&&(d==null?void 0:d.messages.some(h=>_e(h))),[d,i]),Ae=l.useMemo(()=>i&&(d==null?void 0:d.messages.some(h=>Pe(h))),[d,i]),ue=(se||Ae)&&!ve&&S&&!Le&&!X&&!b,ge=((p==null?void 0:p.type)===xe.Text||(p==null?void 0:p.type)===xe.MultiText)&&(p==null?void 0:p.messages[0].author.role)===Bs.Assistant,[ye,Ze]=l.useState(s?-1:r.length),qe=ye===-1?void 0:r[ye],Qe=l.useRef(performance.now()),Xe=l.useRef(performance.now());l.useEffect(()=>{Qe.current=performance.now()},[ye]),l.useEffect(()=>{Xe.current=performance.now()},[qe]);const de=fs(ee,!!i),We=os(ee,"349489989"),De=We.get("per_chunk_time_ms",4e3),ze=We.get("per_search_chunk_time_ms",500),C=l.useMemo(()=>{const h=[];for(const[O,z]of r.entries())if(z.type===D.Thought&&z.thought.chunks)for(const K of z.thought.chunks)h.push({chunk:z,text:K,timeoutMs:De,isStreamingAnimation:!0});else if(z.type===D.Search)for(const K of z.sources)h.push({chunk:z,text:K.domain,timeoutMs:ze,isStreamingAnimation:!1});else{const K=bn({chunk:z,intl:ie,isLast:r.length-1===O,hasGlauxMessages:r.some(Ve=>Ve.type===D.Glaux)});h.push({chunk:z,text:K,timeoutMs:De,isStreamingAnimation:!0})}return h},[r,ie,De,ze]),[W,fe]=l.useState(-1),I=l.useRef(C),_=l.useRef(null);l.useEffect(()=>{I.current=C,W>=C.length&&C.length>0&&fe(C.length-1)},[C,W]),l.useEffect(()=>{W==-1&&C.length>0&&fe(0)},[C.length,W]);const ne=s?C[W]:null;l.useEffect(()=>{if(ne)return _.current!=null&&(clearTimeout(_.current),_.current=null),_.current=setTimeout(()=>{const h=I.current;h.length!==0&&W<h.length-1&&fe(O=>O+1)},ne.timeoutMs),()=>{_.current&&(clearTimeout(_.current),_.current=null)}},[ne==null?void 0:ne.text,W]);const oe=r,we=Us(e.id,h=>h==null?void 0:h.interruptionInProgress),ke=l.useMemo(()=>{var O,z;let h=yt(oe);if(S)return(h==null?void 0:h.type)===D.Recap?h:void 0;if(de&&(h=(O=C[W])==null?void 0:O.chunk),(h==null?void 0:h.type)===D.Thought)return h.thought.summary!=null&&h.thought.summary.length>0?h:gt(oe,K=>K.type===D.Thought&&K.thought.summary!=null&&K.thought.summary.length>0);if(!(j&&(h==null?void 0:h.type)===D.Recap&&((z=oe[oe.length-2])==null?void 0:z.type)!==D.Thought)){if((h==null?void 0:h.type)===D.CodeAnalysis&&i){const K=gt(oe.slice(0,-1),Ve=>Ve.type===D.Thought?Ve.thought.summary&&Ve.thought.summary.length>0:Ve.type!==D.CodeAnalysis);if(K)return K}return h}},[oe,S,de,j,i,C,W]),f=[...oe.entries()],g=a||v?f:f.slice(-1);wr(ye,S);const T=oe.some(h=>h.type===D.Glaux),R=oe.length>0&&(r[0].type!==D.Recap||r[0].type===D.Recap&&A||r[0].didFailReasoning||T),M=yt(oe),F=(M==null?void 0:M.type)===D.Browsing&&!a||(M==null?void 0:M.type)===D.N7jupdAPI&&!a,ce=mn(),be=(ce==null?void 0:ce.type)==="cot",Te=R&&(!S&&(i||de)||a)&&!be&&!F&&!U&&(i?!we:!0),et=Tn(Q)+(Q.length-1)*zt+2*mt,tt=S||v?"auto":a?et:"auto",Fe=ke&&Bt(ie,ke,S,we,!0,Y),Ye=l.useCallback((h,O)=>{ae(h),de&&(c==null||c()),ls.count(cs.COT_SUMMARIZER,h?"expand":"collapse",[{key:"is_streaming",value:String(s)},{key:"source",value:O}]),Vt.logEventWithStatsig(h?"CoT Expanded":"CoT Collapsed",h?"chatgpt_cot_expanded":"chatgpt_cot_collapsed",{is_streaming:String(s),source:O})},[ae,de,s,c]),Ke=l.useCallback(()=>{Ye(!0,"chunk")},[Ye]),js=l.useCallback((h,O)=>{me(z=>{const K=[...z];return K[h]=O,K})},[]);l.useEffect(()=>{S||ye<0||Vt.logEventWithStatsig(a?"Streamed CoT Chunk Viewed":"Streamed CoT Chunk Ignored",a?"chatgpt_streamed_cot_chunk_viewed":"chatgpt_streamed_cot_chunk_ignored")},[ye,S,a,s]);const _t=S&&!R,vs=s&&!R&&!te||i&&Y===Ne.Thinking,kt=(R||te)&&(!i||Y!==Ne.Thinking),_s=i&&!(i&&we)&&!v,Tt=t.jsxs(t.Fragment,{children:[!ge&&!V&&t.jsx(pn,{}),t.jsxs("div",{className:J("relative my-1 min-h-6",ge&&"mt-3",ge&&kt&&"mt-6"),children:[vs&&t.jsx(re.div,{className:J("loading-shimmer text-token-text-secondary absolute start-2 top-0 mx-[calc(--spacing(-2)-1px)] select-none",A===$t.PRO_MODE&&"font-medium"),initial:s&&{translateX:-8,opacity:0},animate:{translateX:0,opacity:1},transition:{ease:"easeInOut",duration:xt},onClick:()=>{Ye(!a,"header")},role:"button",children:A===$t.PRO_MODE?t.jsx(Ie,{id:"wOEgCa",defaultMessage:"Pro thinking"}):t.jsx(Ie,{id:"hgnsat",defaultMessage:"Thinking"})}),kt&&t.jsxs(re.div,{className:J("origin-top-start relative flex flex-col gap-2 overflow-x-clip",U&&"mx-[calc(--spacing(-2)-1px)]",i&&"overflow-x-visible"),initial:s&&i&&{opacity:0,scale:.85},animate:{opacity:1,scale:1},transition:{ease:"easeOut",duration:xt},children:[U&&!te?t.jsx(re.div,{className:"loading-shimmer text-token-text-secondary absolute start-2 top-0 select-none",initial:s&&{translateX:-8,opacity:0},animate:{translateX:0,opacity:1},transition:{ease:"easeInOut",duration:xt},children:Fe},Fe):t.jsx(gn,{conversation:e,isAgentVisualCoT:y,isAgentTurn:i,latestHeadline:ke&&Bt(ie,ke,S,we,i,i?Y:void 0,!de),latestChunk:ke,onToggleExpanded:()=>Ye(!a,"header"),showChunkIcon:_s,isExpanded:a,isComplete:S,onSkip:te?u:void 0,skipTitle:he,shouldDisplayVisualCoT:v,agentVisualMode:Z,setAgentVisualMode:q,isStreaming:s,interruptionInProgress:we,isKAUR1BR5:b,wasInterrupted:L,isGlauxTurn:j,taskType:A,activeTask:$}),j&&de&&m&&t.jsx(hn,{className:"my-2",handleShowRetrievalResults:m,turnIndex:G,clientThreadId:e.id,responseComplete:!s}),t.jsxs("div",{className:J(X?"max-w-[var(--thread-content-max-width,40rem)]":"max-w-[calc(0.8*var(--thread-content-max-width,40rem))]"),children:[t.jsx(hr,{clientThreadId:e.id,isAgentTurn:!!v,isFinalAssistantTurn:o,messageGroups:x,isExpanded:a,visualMode:Z,isStreaming:s,isComplete:S,isStopping:!!we,isKAUR1BR5:!!b,children:de&&!v?Te&&o&&t.jsx("div",{className:"relative flex h-full flex-col",style:{margin:"".concat(mt,"px 0")},children:t.jsx(jn,{text:(Ct=ne==null?void 0:ne.text)!=null?Ct:"",isStreamingAnimation:(St=ne==null?void 0:ne.isStreamingAnimation)!=null?St:!0,onClick:()=>Ye(!a,"chunk")})}):t.jsx(Ue,{children:(Te||v)&&t.jsx(re.div,{className:"relative z-0",initial:S?{opacity:0,height:v?"auto":0,overflowY:"hidden"}:!1,animate:{opacity:1,height:tt},exit:{height:v?"auto":0,opacity:0,pointerEvents:"none",overflowY:"hidden",filter:S?"blur(8px)":void 0,translateY:-_n},transition:es,children:t.jsx("div",{className:"relative flex h-full flex-col",style:{margin:"".concat(mt,"px 0")},children:t.jsx(Ue,{children:g.map(([h,O],z)=>t.jsx(vn,{index:h,chunk:O,gap:zt,isLast:g.length-1===z,onClick:Ke,onAnimationComplete:()=>{},onMeasure:js,isAnimationComplete:S,isExpanded:a||v,showBullet:a||v,isKAUR1BR5:b,hasGlauxMessages:T,disableAnimation:de,isAgentTurn:i},h))})})})})}),ue&&t.jsx(qn,{chunks:oe,isExpanded:a,isFinalAssistantTurn:o,hidePowTombstone:!!v,isKAUR1BR5:!!b})]})]})]})]});return i?t.jsx(Ue,{mode:"wait",children:!_t&&t.jsx(re.div,{initial:!1,animate:{height:"auto",opacity:1,scale:1},exit:{height:0,opacity:0,scale:.9,filter:"blur(6px)"},transition:{height:es,opacity:{duration:0,ease:"linear"}},children:Tt},"cot-wrapper")}):_t?null:Tt};function wr(e,s){const o=l.useRef(null),r=xn(e),n=l.useCallback(()=>{if(o.current!=null){const i=performance.now()-o.current;ls.hist(cs.COT_SUMMARIZER,"cot_chunk_display_time",void 0,i)}},[r]);l.useEffect(()=>{if(s){n();return}e!==-1&&(n(),o.current=performance.now())},[e,s,n])}export{Hr as CoT,yr as CoTChunks};
//# sourceMappingURL=eg060qqd4x8bzpxd.js.map

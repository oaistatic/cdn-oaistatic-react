const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kivvchsexr54fuso.js","assets/bubexfvksfr7893o.js","assets/d9d46aun6hvzsagm.js","assets/9paxni9f8n7suc5d.js","assets/jg4vn08ghs7w0riy.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/dzi98izg642pbca6.js","assets/joa8jajuiu4xqpzn.js"])))=>i.map(i=>d[i]);
var V=Object.defineProperty,W=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var b=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T=(e,t)=>{for(var n in t||(t={}))z.call(t,n)&&b(e,n,t[n]);if(S)for(var n of S(t))G.call(t,n)&&b(e,n,t[n]);return e},v=(e,t)=>W(e,H(t));import{r as c,j as o,M as N,_ as I,u as U,h as q,l as J}from"./bubexfvksfr7893o.js";import{az as y,aA as A,dS as K,cz as Q,M as Z,bK as E,bJ as M,aw as B,ax as X,D as Y,p as $,V as ee}from"./ncw8zw682jinppua.js";import{F as te}from"./i2fnvzvjvu5c6tcn.js";import{fS as ne,c3 as se,mb as oe,d6 as k,d7 as P,mc as ae,md as ie,me as re,mf as ce,ge as de,jE as ue}from"./lm3g1zm00rp6al39.js";import"./egzpifha5criht1h.js";import"./bqnf7jbq8xd3572o.js";import"./fwn4bwvyx3h4ty5g.js";import"./l1teaxoievyk0rz1.js";import"./guejgwxn789esoyt.js";import"./m7ky6cnx5e7w4637.js";import"./j4cpzybta3my41wg.js";import"./dpidockywf8envd2.js";import"./fvq06q6sopd9r6rx.js";import"./j703u6xl4odnuo39.js";import"./me0ap2djy50z6upd.js";import"./nbm98bu0q3774lnr.js";import"./i9ddjt6oaiw4vo4g.js";import"./fum95d46v8d5jv8u.js";import"./n2u3q2i5341kdx8j.js";import"./matxjx64xjrpxbwa.js";import"./ip2dsbq9712r5wna.js";import"./o45zl9yl00508gad.js";import"./mxzk2kf77c8eueuw.js";import"./bc00p2ldn9cv9q32.js";import"./8ix1du5tuckfsvqq.js";import"./hzasobp3hhjtq47p.js";import"./jro698t78r3v26vt.js";import"./mqabubffkpko61wr.js";import"./lxa5p4s1fgqvzcgw.js";import"./ekj7v0hd90m9gfgd.js";import"./c929hhheh8pnurrs.js";import"./b3zmi7k0e1dvao0m.js";import"./i0yczuhbjrdxz6ve.js";import"./cyrjh6r9wv2bzsqv.js";function le(){const[e,t]=c.useState({undoStack:[],currentIndex:-1});function n(s){t(r=>({undoStack:[...r.undoStack.slice(0,r.currentIndex+1),s],currentIndex:r.currentIndex+1}))}function d(){t(s=>({undoStack:s.undoStack,currentIndex:Math.max(s.currentIndex-1,-1)}))}function a(){t(s=>({undoStack:s.undoStack,currentIndex:Math.min(s.currentIndex+1,s.undoStack.length-1)}))}function i(){t({undoStack:[],currentIndex:-1})}return{currentDrawnShape:e.undoStack.length>0?e.undoStack[e.currentIndex]:null,onNewDrawnShape:n,canUndoDrawing:e.currentIndex>=0,undoDrawing:d,canRedoDrawing:e.currentIndex<e.undoStack.length-1,redoDrawing:a,clearAllDrawings:i}}const me=y(()=>I(()=>import("./kivvchsexr54fuso.js"),__vite__mapDeps([0,1])),{loading:e=>A(e)}),ge=y(()=>I(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([2,1])),{loading:e=>A(e)}),fe=y(()=>I(()=>import("./9paxni9f8n7suc5d.js"),__vite__mapDeps([3,1])),{loading:e=>A(e)});function he({mode:e,imageIndex:t,allImages:n,onSwitchImage:d,isLoadingNewImage:a}){const i=t>0,s=c.useCallback(()=>{i&&d(n[t-1])},[i,n,t,d]),r=t<n.length-1,l=c.useCallback(()=>{r&&d(n[t+1])},[r,n,t,d]);return c.useEffect(()=>{function g(u){u.target instanceof HTMLTextAreaElement||e==="default"&&(u.key==="ArrowLeft"?s():u.key==="ArrowRight"&&l())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[e,s,l]),o.jsx("div",{className:"text-token-text-secondary flex h-16 w-full items-center justify-center gap-3 font-semibold",children:e==="inpaint"?!a&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(N,{id:"imageEditor.selectArea",defaultMessage:"Select an area to edit"}),o.jsx("a",{href:"https://help.openai.com/en/articles/9055440",target:"_blank",rel:"noreferrer",children:o.jsx(me,{className:"icon"})})]}):n.length>1?o.jsxs(o.Fragment,{children:[o.jsx("button",{disabled:!i,className:"disabled:text-token-text-tertiary",onClick:s,children:o.jsx(fe,{className:"icon"})}),o.jsx("div",{children:o.jsx(N,{id:"imageEditor.imageNumber",defaultMessage:"Image {num} of {numImages}",values:{num:t+1,numImages:n.length}})}),o.jsx("button",{disabled:!r,className:"disabled:text-token-text-tertiary",onClick:l,children:o.jsx(ge,{className:"icon"})})]}):null})}const pe=0,we=64;function xe({imageAsset:e,children:t,containerDimensions:n,isLoadingNewImage:d}){return o.jsxs(K.div,v(T({className:"absolute",style:Ee(e,n)},ne),{children:[t,o.jsx("div",{className:Q("bg-token-main-surface-primary absolute inset-0 flex items-center justify-center transition-opacity duration-1000",d?"pointer-events-auto opacity-60":"pointer-events-none opacity-0")})]}))}function Ee(e,t){const{width:n,height:d}=e,{width:a,height:i}=t,s=a-2*pe,r=i-2*we,l=n/d,g=s/r,u=l>g,w=u?s:r*l,h=u?s/l:r,p=(i-h)/2,C=(a-w)/2;return{top:p,left:C,width:w,height:h}}const Ie=y(()=>I(()=>import("./jg4vn08ghs7w0riy.js"),__vite__mapDeps([4,1,5,6,7,8])).then(e=>e.DynamicDrawingCanvas));function st({clientThreadId:e,messageId:t,image:n,allImages:d}){const a=Z(e,ee.getCurrentNode),i=[E.Dalle,E.t2uay3k].includes(M(a.message))&&!se(a.message),s=U();return c.useEffect(()=>{async function r(l,g){try{const u=await oe(s,l);k.setFocusedObject({type:P.Image,image:u[0],allImages:u,messageId:g})}catch(u){Y.addError(new Error("Failed to load newly created images:",{cause:u}))}}if(a!=null&&[E.Dalle,E.t2uay3k].includes(M(a.message))&&a.message.content.content_type===B.MultimodalText){const l=X.getImageAssetPointers(a.message);r(l,a.id)}},[s,a]),o.jsx(ye,{image:n,allImages:d,isLoadingNewImage:i,clientThreadId:e,messageId:t})}function ye({image:e,allImages:t,isLoadingNewImage:n,clientThreadId:d,messageId:a}){const[i,s]=c.useState("default"),[r,l]=c.useState({width:window.innerWidth-te,height:window.innerHeight}),g=c.useRef(null),[u,w]=c.useState(136),h=le(),{currentDrawnShape:p,onNewDrawnShape:C,clearAllDrawings:R}=h,j=c.useRef(null),_=q(),D=$(),{setTargetedContent:x}=ae();c.useEffect(()=>{const m=new ResizeObserver(f=>{const{width:F,height:O}=f[0].contentRect;l({width:F,height:O})});return g.current&&m.observe(g.current),()=>{m.disconnect()}},[]),c.useEffect(()=>{function m(f){f.key==="Escape"&&(i==="inpaint"?s("default"):k.close())}return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[i]),c.useEffect(()=>(p==null?x({type:"object",placeholderTextOverride:J({id:"imageEditor.transformationTextareaPlaceholder",defaultMessage:"Edit imageâ€¦"}),shouldPersistAcrossMessages:!0,isFocusedViewContent:!0,createNewCompletionParams:m=>ie(m,e)}):x({type:"object",label:_.formatMessage({id:"imageEditor.inpaintingTargetedContentLabel",defaultMessage:"Edit selection"}),isFocusedViewContent:!0,createNewCompletionParams:async m=>{var f;return await re(m,e,(f=j.current)==null?void 0:f.getImageData(),_,D)},onCleared:()=>s("default")}),()=>{x(void 0)}),[e,_,x,p,D]),c.useEffect(()=>{i!=="inpaint"&&R()},[i]),c.useEffect(()=>{s("default")},[e]);const L=t.findIndex(m=>m.asset_pointer===e.asset_pointer);return o.jsxs("div",{ref:g,className:"flex h-full w-full flex-col justify-between",children:[o.jsx(ce,{imageAsset:e,mode:i,setMode:s,clientThreadId:d,messageId:a,cursorWidth:u,setCursorWidth:w,inpaintingDrawingState:h,isLoadingNewImage:n}),o.jsx(he,{mode:i,imageIndex:L,allImages:t,onSwitchImage:m=>{k.setFocusedObject({type:P.Image,image:m,allImages:t,messageId:a})},isLoadingNewImage:n}),o.jsxs(xe,{imageAsset:e,containerDimensions:r,isLoadingNewImage:n,children:[o.jsx(de,{className:"h-full w-full",alt:ue(e),src:e.url,width:e.width,height:e.height,fadeIn:!1}),i==="inpaint"&&o.jsx("div",{className:"absolute inset-0",children:o.jsx(Ie,{drawingCanvasRef:j,color:"rgba(0, 122, 255, 0.5)",dashedOutlineColor:"rgba(255, 255, 255, 0.65)",cursorWidth:u,canvasWidth:e.width,canvasHeight:e.height,currentDrawnShape:p,onNewDrawnShape:C})})]})]})}export{st as ImageEditor};
//# sourceMappingURL=c6rj4af6vlx7bzfk.js.map

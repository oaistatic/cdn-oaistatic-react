const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l5e2clfxpgm30p9v.js","assets/bubexfvksfr7893o.js","assets/lm3g1zm00rp6al39.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/jnabziqdczabgqdk.js","assets/l4db4kf3uum0xsyv.js","assets/evxrp5263774zr36.js"])))=>i.map(i=>d[i]);
var _e=Object.defineProperty,je=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var ne=(s,e,r)=>e in s?_e(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,F=(s,e)=>{for(var r in e||(e={}))oe.call(e,r)&&ne(s,r,e[r]);if(W)for(var r of W(e))le.call(e,r)&&ne(s,r,e[r]);return s},L=(s,e)=>je(s,ye(e));var de=(s,e)=>{var r={};for(var a in s)oe.call(s,a)&&e.indexOf(a)<0&&(r[a]=s[a]);if(s!=null&&W)for(var a of W(s))e.indexOf(a)<0&&le.call(s,a)&&(r[a]=s[a]);return r};import{j as t,_ as G,h as A,c as V,M as P,r as ee,e as ke,R as B,a as be,d as Ne,y as Me,ac as we}from"./bubexfvksfr7893o.js";import{c as Se,r as Pe,s as ce,f as Q,A as Ae,S as Ce,a as Y,F as Z,P as Ee,b as xe,m as Re,d as Te,p as pe,e as De,u as Fe,E as te}from"./h1isumrrk8gn5a51.js";import{A as Ie,a as Le,b as Ve}from"./fjd11y6s2jq9dlu1.js";import{ak as $e,al as se,qz as Be,qA as Ge}from"./lm3g1zm00rp6al39.js";import{az as O,aA as H,p as re,cz as J,R as Oe,D as me,aB as He,e7 as qe,u as ze,ij as Ue,nF as We}from"./ncw8zw682jinppua.js";import{A as Ke,p as Qe,P as Ye,D as Je,C as Xe}from"./fy4l2kpcbjlox0ps.js";import{R as Ze}from"./o0dw43fppqvaf7ws.js";import{g as X}from"./ffjw65gjnc6j0nz8.js";import{M as ae}from"./j51b3b8y7dx543la.js";import{r as fe}from"./owbget26s04j6ot0.js";import{b as et}from"./ip2dsbq9712r5wna.js";import"./krengkwf9us2g646.js";import"./luif5kl8klbqcpjy.js";import"./bc00p2ldn9cv9q32.js";import"./8ix1du5tuckfsvqq.js";import"./fwn4bwvyx3h4ty5g.js";import"./l1teaxoievyk0rz1.js";import"./nbm98bu0q3774lnr.js";import"./i9ddjt6oaiw4vo4g.js";import"./hzasobp3hhjtq47p.js";import"./cxp76v1gv71u5chl.js";import"./ha3yj3u2f1w16goy.js";import"./fyy6o8kal64rtpos.js";import"./e5q3f3k67x71csb7.js";import"./lptwpbjabrvjmhsj.js";import"./nnaau44w7pxfjjn3.js";import"./lv98i5lrm8g24nlg.js";import"./ffvjxtmoqooghm1t.js";import"./eqqsnl6kprwt6kvn.js";import"./iqtpdwh2n8o5iyd7.js";import"./ckeauhcg4pu33xfw.js";import"./n630qnacd2oui4py.js";import"./n117ifjno76hbo3f.js";import"./gqlpgmzguho9n5oh.js";import"./h1em0bjkpkjv8ykw.js";import"./m609xwboj0zo059y.js";import"./eifqzljcxkeg8zns.js";import"./o6p9t02t81236kdb.js";import"./hu1bt0oauegdhua6.js";import"./gy1lpvuoewmzh42c.js";import"./kbj1b07s2z6vxqkg.js";import"./o45zl9yl00508gad.js";import"./mxzk2kf77c8eueuw.js";import"./jro698t78r3v26vt.js";import"./fum95d46v8d5jv8u.js";import"./n2u3q2i5341kdx8j.js";import"./j703u6xl4odnuo39.js";import"./me0ap2djy50z6upd.js";function R({title:s,children:e,className:r=""}){return t.jsx("div",{className:"border-token-border-light bg-token-main-surface-primary ring-token-border-light/60 overflow-hidden rounded-lg border p-4 shadow ring-1 shadow-black/20 md:p-5 dark:shadow-black/60 dark:ring-white/10 ".concat(r),children:t.jsxs("section",{children:[s&&t.jsx("div",{className:"text-title-small mb-5 font-semibold tracking-wide",children:s}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:e})]})})}function E({label:s,children:e}){return t.jsxs("div",{className:"grid grid-cols-2 items-start gap-1 text-sm md:grid-cols-[auto,1fr] md:gap-2",children:[t.jsx("div",{className:"text-token-text-tertiary md:w-44",children:s}),t.jsx("div",{className:"w-full min-w-0 overflow-hidden break-words hyphens-auto",children:e})]})}const tt=O(()=>G(()=>import("./l5e2clfxpgm30p9v.js"),__vite__mapDeps([0,1])),{loading:s=>H(s)});function ue(s){if(s==null)return"";const e=String(s).trim();return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1).trim():e}function st({finding:s}){var o,f,x,p,u,i;const e=A(),r=re(),a=s,d=(f=(o=a.commit_analysis)==null?void 0:o.commit_hash)!=null?f:"",n=Se(a.repo_url,d);return t.jsxs(R,{title:e.formatMessage({id:"aardvark.findings.metadataTitle",defaultMessage:"Metadata"}),children:[t.jsxs("div",{className:"grid grid-cols-1 items-stretch gap-3 text-sm",children:[t.jsx(E,{label:e.formatMessage({id:"aardvark.table.repo",defaultMessage:"Repository"}),children:a.repo_url?t.jsx("a",{href:a.repo_url,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent hover:underline",children:Pe(a.repo_url)}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})})}),t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.commit",defaultMessage:"Commit"}),children:n?t.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent font-mono text-xs hover:underline",children:ce(d)}):t.jsx("code",{className:"bg-token-bg-elevated-secondary rounded px-1 py-0.5 text-[10px]",children:ce(d)})}),t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.author",defaultMessage:"Author"}),children:t.jsxs("div",{className:"flex min-w-0 flex-col",children:[(()=>{var l;const c=ue((l=a.commit_analysis)==null?void 0:l.author);return c?t.jsx("span",{className:"truncate",children:c}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"})})})(),(()=>{var l;const c=ue((l=a.commit_analysis)==null?void 0:l.author_email);return c?t.jsx("span",{className:"text-token-text-tertiary font-mono text-xs break-all",children:c}):null})()]})}),t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.authoredAt",defaultMessage:"Authored at"}),children:Q((p=(x=a.commit_analysis)==null?void 0:x.author_date)!=null?p:null)}),t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.committedAt",defaultMessage:"Committed at"}),children:Q((i=(u=a.commit_analysis)==null?void 0:u.committer_date)!=null?i:null)}),t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.createdAt",defaultMessage:"Detected at"}),children:Q(a.created_at)}),t.jsx(E,{label:e.formatMessage({id:"aardvark.table.assignee",defaultMessage:"Assignee"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Ae,{finding:a})})}),t.jsx(E,{label:e.formatMessage({id:"aardvark.table.status",defaultMessage:"Status"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Ce,{finding:a})})}),(()=>{var m,j,_;const c=(m=a==null?void 0:a.commit_analysis)!=null?m:{},l=String((j=c.security_related)!=null?j:"no").toLowerCase()==="yes",v=String((_=c.privacy_related)!=null?_:"no").toLowerCase()==="yes",g=c.validated===!0||String(c.validated).toLowerCase()==="true";return!l&&!v&&!g?null:t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.signals",defaultMessage:"Signals"}),children:t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l&&t.jsx(Y,{variant:"critical",children:e.formatMessage(Z.security)}),v&&t.jsx(Y,{variant:"warning",children:e.formatMessage(Z.privacy)}),g&&t.jsx(Y,{variant:"success",children:e.formatMessage(Z.validated)})]})})})(),a.resolution_reason?t.jsx(E,{label:e.formatMessage({id:"aardvark.findings.resolutionReason",defaultMessage:"Resolution notes"}),children:t.jsxs("div",{className:"text-sm whitespace-pre-wrap",children:[a.resolution_reason,a.resolution_set_by_email?t.jsx("div",{className:"text-token-text-tertiary mt-1 text-xs",children:e.formatMessage({id:"aardvark.findings.resolutionSetBy",defaultMessage:"Set by {email}"},{email:a.resolution_set_by_email})}):null]})}):null]}),t.jsxs("div",{className:"mt-3 grid grid-cols-1 items-stretch gap-3 p-1 sm:grid-cols-2",children:[n&&t.jsx(at,{commitUrlStr:n}),t.jsx($e,{className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",iconClassName:"icon-sm",buttonText:e.formatMessage({id:"aardvark.actions.share",defaultMessage:"Share link"}),onCopy:c=>{const l=typeof window<"u"&&window.location?"".concat(window.location.origin).concat(window.location.pathname):"";se(l,r,c),r.successNeutral(e.formatMessage({id:"aardvark.toast.linkCopied",defaultMessage:"Link copied"}),{duration:2})}})]})]})}function at({commitUrlStr:s}){const e=A();return t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",children:[t.jsx(tt,{className:"icon-sm me-1","aria-hidden":!0}),e.formatMessage({id:"aardvark.actions.openGithub",defaultMessage:"Open in GitHub"})]})}const rt={pending:"muted",running:"warning",failed:"danger",success:"success",unknown:"muted"},it=s=>s.status=="created"?"pending":s.status=="patch_generation_running"?"running":s.status=="patch_generation_failed"?"failed":s.patch_generation_success?"success":"unknown",nt=s=>s.status=="created"?"pending":s.status=="awaiting_validation"?"running":s.status=="failed_validation"?"failed":s.status=="validated"?"success":"unknown";function ge(s){"use forget";const e=V.c(9),{task:r,mode:a}=s,d=A();let n;e[0]!==a||e[1]!==r?(n=a=="generation"?it(r):nt(r),e[0]=a,e[1]=r,e[2]=n):n=e[2];const o=n,f=rt[o];let x;e[3]!==d||e[4]!==o?(x=d.formatMessage(Ee[o]),e[3]=d,e[4]=o,e[5]=x):x=e[5];const p=x;let u;return e[6]!==p||e[7]!==f?(u=t.jsx(Y,{variant:f,children:p}),e[6]=p,e[7]=f,e[8]=u):u=e[8],u}function ot(s){"use forget";var T,$;const e=V.c(34),{latestTask:r,turn:a,formatStepTime:d}=s,n=r==null?void 0:r.patch_generation_submitted_at,o=($=(T=a==null?void 0:a.latest_event)==null?void 0:T.created)!=null?$:null;let f;if(e[0]!==a){const N=a&&Array.isArray(a.output_items)?xe(X(a,"output_items",[]),mt):[],M=Re(N,dt);f=a?L(F({},a),{output_items:[...M]}):null,e[0]=a,e[1]=f}else f=e[1];const x=f;let p;e[2]!==d||e[3]!==n?(p=n?d(n):null,e[2]=d,e[3]=n,e[4]=p):p=e[4];const u=p;let i;e[5]!==d||e[6]!==o?(i=o?d(o):null,e[5]=d,e[6]=o,e[7]=i):i=e[7];const c=i;let l;if(e[8]!==c||e[9]!==u){if(l=[],u){let N;e[11]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx(P,{id:"aardvark.proposedPatch.patchGeneration.startedLabel",defaultMessage:"Started"}),e[11]=N):N=e[11];let M;e[12]!==u?(M={key:"started",label:N,value:u},e[12]=u,e[13]=M):M=e[13],l.push(M)}if(c){let N;e[14]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx(P,{id:"aardvark.proposedPatch.patchGeneration.finishedLabel",defaultMessage:"Completed"}),e[14]=N):N=e[14];let M;e[15]!==c?(M={key:"finished",label:N,value:c},e[15]=c,e[16]=M):M=e[16],l.push(M)}e[8]=c,e[9]=u,e[10]=l}else l=e[10];let v;e[17]!==a?(v=a?Ze(a):"",e[17]=a,e[18]=v):v=e[18];const g=v;let m,j;e[19]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:t.jsx(P,{id:"aardvark.proposedPatch.patchGeneration.title",defaultMessage:"Patch generation"})}),j=J("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[19]=m,e[20]=j):(m=e[19],j=e[20]);let _;e[21]!==l?(_=l.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:l.map(lt)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(P,{id:"aardvark.proposedPatch.patchGeneration.noTiming",defaultMessage:"Timing details will appear once generation starts."})}),e[21]=l,e[22]=_):_=e[22];let k;e[23]!==r?(k=r&&t.jsx("div",{className:"sm:ms-4 sm:flex sm:min-w-[120px] sm:justify-end",children:t.jsx(ge,{task:r,mode:"generation"})}),e[23]=r,e[24]=k):k=e[24];let h;e[25]!==_||e[26]!==k?(h=t.jsxs("div",{className:j,children:[_,k]}),e[25]=_,e[26]=k,e[27]=h):h=e[27];let y;e[28]!==g||e[29]!==x?(y=x&&t.jsx(Ke,{assistantTurn:x,outputText:g,className:"text-token-text-secondary text-sm leading-6"}),e[28]=g,e[29]=x,e[30]=y):y=e[30];let I;return e[31]!==y||e[32]!==h?(I=t.jsxs(t.Fragment,{children:[m,h,y]}),e[31]=y,e[32]=h,e[33]=I):I=e[33],I}function lt(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function dt(s){return L(F({},s),{content:xe(X(s,"content",[]),ct)})}function ct(s){return X(s,"content_type")==="text"}function mt(s){return X(s,"type")==="message"}function ft(s){"use forget";var k;const e=V.c(29),{latestTask:r,formatStepTime:a}=s,d=r==null?void 0:r.fix_checker_started_at,n=r==null?void 0:r.fix_checker_finished_at,o=(k=r==null?void 0:r.fix_checker_rubric)!=null?k:"";let f;e[0]!==a||e[1]!==d?(f=d?a(d):null,e[0]=a,e[1]=d,e[2]=f):f=e[2];const x=f;let p;e[3]!==a||e[4]!==n?(p=n?a(n):null,e[3]=a,e[4]=n,e[5]=p):p=e[5];const u=p;let i;if(e[6]!==u||e[7]!==x){if(i=[],x){let h;e[9]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx(P,{id:"aardvark.proposedPatch.patchValidation.startedLabel",defaultMessage:"Started"}),e[9]=h):h=e[9];let y;e[10]!==x?(y={key:"started",label:h,value:x},e[10]=x,e[11]=y):y=e[11],i.push(y)}if(u){let h;e[12]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx(P,{id:"aardvark.proposedPatch.patchValidation.finishedLabel",defaultMessage:"Completed"}),e[12]=h):h=e[12];let y;e[13]!==u?(y={key:"finished",label:h,value:u},e[13]=u,e[14]=y):y=e[14],i.push(y)}e[6]=u,e[7]=x,e[8]=i}else i=e[8];let c,l;e[15]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx("div",{className:"text-token-text-tertiary mt-4 text-xs font-semibold tracking-wide uppercase",children:t.jsx("span",{children:t.jsx(P,{id:"aardvark.proposedPatch.patchValidation.title",defaultMessage:"Patch validation"})})}),l=J("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[15]=c,e[16]=l):(c=e[15],l=e[16]);let v;e[17]!==i?(v=i.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:i.map(ut)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(P,{id:"aardvark.proposedPatch.patchValidation.noTiming",defaultMessage:"Validation timeline will populate once checks begin."})}),e[17]=i,e[18]=v):v=e[18];let g;e[19]!==r?(g=t.jsx(ge,{task:r,mode:"validation"}),e[19]=r,e[20]=g):g=e[20];let m;e[21]!==v||e[22]!==g?(m=t.jsxs("div",{className:l,children:[v,g]}),e[21]=v,e[22]=g,e[23]=m):m=e[23];let j;e[24]!==o?(j=o&&t.jsx("div",{className:"prose prose-sm text-token-text-secondary mb-4 max-w-none",children:t.jsx(ae,{children:o})}),e[24]=o,e[25]=j):j=e[25];let _;return e[26]!==m||e[27]!==j?(_=t.jsxs(t.Fragment,{children:[c,m,j]}),e[26]=m,e[27]=j,e[28]=_):_=e[28],_}function ut(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function xt(s){return typeof s!="object"||s==null||!("role"in s)||!("output_items"in s)?!1:s.role==="assistant"&&Array.isArray(s.output_items)}function pt(s){"use forget";const e=V.c(53),{proposed_patch:r,findingId:a,refetchFinding:d}=s,n=A(),o=re(),[f,x]=ee.useState(!1),[p,u]=ee.useState(!1);if(!r)return null;const i=r.latest_task;if(!i){let g;e[0]!==n?(g=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[0]=n,e[1]=g):g=e[1];let m;e[2]!==n?(m=n.formatMessage({id:"aardvark.proposedPatch.noTaskAvailable",defaultMessage:"A proposed patch has not been generated yet."}),e[2]=n,e[3]=m):m=e[3];let j;e[4]!==m?(j=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:m}),e[4]=m,e[5]=j):j=e[5];let _;return e[6]!==g||e[7]!==j?(_=t.jsx(R,{title:g,children:j}),e[6]=g,e[7]=j,e[8]=_):_=e[8],_}const c=i.codex_task_turn,l=xt(c==null?void 0:c.turn)?c.turn:null;let v;if(e[9]!==l||e[10]!==a||e[11]!==n||e[12]!==p||e[13]!==i||e[14]!==r.id||e[15]!==d||e[16]!==o||e[17]!==f){const g=l?Qe({assistantTurn:l}):[],m=g.map(vt).join("\n\n"),j=async()=>{try{await se(m,o),o.successNeutral(n.formatMessage(K.copyPatchSuccess),{duration:5,hasCloseButton:!0})}catch(b){}};let _;e[19]!==m||e[20]!==n||e[21]!==o?(_=async()=>{try{await se("git apply - <<PATCH\n"+m+"\nPATCH",o),o.successNeutral(n.formatMessage(K.copyApplySuccess),{duration:5,hasCloseButton:!0})}catch(b){}},e[19]=m,e[20]=n,e[21]=o,e[22]=_):_=e[22];const k=_;let h;e[23]!==a||e[24]!==n||e[25]!==p||e[26]!==i.codex_task_id||e[27]!==i.codex_task_turn_id||e[28]!==d||e[29]!==o?(h=async b=>{if(!(i!=null&&i.codex_task_id)||!(i!=null&&i.codex_task_turn_id)||!a||p)return;u(!0);const w={parameters:{path:{id:a}},requestBody:{}};b!==void 0&&(w.requestBody.mode=b);try{if(await Oe.safePost("/aardvark/scan-findings/{id}/pr",w),d)try{await d()}catch(C){const S=C;let D;S instanceof Error?D=S.message:D=String(S),me.addError("aardvark.proposedPatch.refetchFindingError",{findingId:a,message:D})}o.successNeutral(n.formatMessage(K.createPrSuccess),{duration:3,hasCloseButton:!0})}catch(C){const S=C;me.addError("aardvark.proposedPatch.createPrError",{findingId:a,taskId:i.codex_task_id,taskTurnId:i.codex_task_turn_id,mode:b!=null?b:null,message:S instanceof Error?S.message:String(S)}),o.danger(n.formatMessage(K.createPrError),{duration:3,hasCloseButton:!0}),u(!1);return}u(!1)},e[23]=a,e[24]=n,e[25]=p,e[26]=i.codex_task_id,e[27]=i.codex_task_turn_id,e[28]=d,e[29]=o,e[30]=h):h=e[30];const y=h,I=!!(i!=null&&i.codex_task_id)&&!!(i!=null&&i.codex_task_turn_id)&&!!a;let T;e[31]===Symbol.for("react.memo_cache_sentinel")?(T=function(w){return w?typeof w=="string"?Q(w):Te(w):null},e[31]=T):T=e[31];const $=T;let N;e[32]!==n?(N=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[32]=n,e[33]=N):N=e[33];let M;e[34]!==l||e[35]!==i?(M=t.jsx(ot,{latestTask:i,turn:l,formatStepTime:$}),e[34]=l,e[35]=i,e[36]=M):M=e[36];let q;e[37]!==i?(q=t.jsx(ft,{latestTask:i,formatStepTime:$}),e[37]=i,e[38]=q):q=e[38];let z;if(g.length>0){let b;e[39]!==f?(b=t.jsx(Je,{unifiedDiff:f,setUnifiedDiff:x,showFullDiff:!1,setShowFullDiff:ht}),e[39]=f,e[40]=b):b=e[40];const w=t.jsxs("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[b,t.jsx(Ye,{copyApplyToClipboard:k,copyPatchToClipboard:j,createPr:y,navigateToCreatingPrPage:gt,updateBranch:void 0,canCreatePr:I,isCreatingPr:p,permissions:"write",assistantTurn:l,showOnlyViewPr:!1})]});let C;e[41]!==w?(C=t.jsx("div",{className:"mb-2 flex w-full flex-col gap-2",children:w}),e[41]=w,e[42]=C):C=e[42];let S;e[43]!==r.id||e[44]!==f?(S=(he,ve)=>{var ie;return t.jsx(Xe,{diff:he,viewType:f?"unified":"split",stickyHeader:!1},"".concat((ie=r==null?void 0:r.id)!=null?ie:"diff","-canonical-").concat(ve))},e[43]=r.id,e[44]=f,e[45]=S):S=e[45];const D=t.jsx("div",{className:"flex flex-col gap-4",children:g.map(S)});let U;e[46]!==C||e[47]!==D?(U=t.jsxs(t.Fragment,{children:[C,D]}),e[46]=C,e[47]=D,e[48]=U):U=e[48],z=U}else if((i==null?void 0:i.status)==="patch_generation_running")z=null;else{let b;e[49]!==n?(b=n.formatMessage({id:"aardvark.proposedPatch.noDiffsInHead",defaultMessage:"No diffs—this usually means the issue no longer exists in HEAD."}),e[49]=n,e[50]=b):b=e[50];let w;e[51]!==b?(w=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:b}),e[51]=b,e[52]=w):w=e[52],z=w}v=t.jsxs(R,{title:N,children:[M,q,z]}),e[9]=l,e[10]=a,e[11]=n,e[12]=p,e[13]=i,e[14]=r.id,e[15]=d,e[16]=o,e[17]=f,e[18]=v}else v=e[18];return v}function gt(){}function ht(){}function vt(s){var e;return(e=s.hunksText)!=null?e:""}const K=ke({createPrSuccess:{id:"aardvark.proposedPatch.createPrSuccess",defaultMessage:"Pull request created"},createPrError:{id:"aardvark.proposedPatch.createPrErrorToast",defaultMessage:"Failed to create pull request"},copyPatchSuccess:{id:"aardvark.proposedPatch.copyPatchSuccess",defaultMessage:"Patch copied"},copyApplySuccess:{id:"aardvark.proposedPatch.copyApplySuccess",defaultMessage:"Command copied"}}),_t=O(()=>G(()=>import("./lm3g1zm00rp6al39.js").then(s=>s.zv),__vite__mapDeps([2,1,3,4,5])),{loading:s=>H(s)});function jt({content:s,start:e,className:r=""}){const a=B.useMemo(()=>s.trimEnd().split("\n"),[s]),d=typeof e=="number"?e:1;return t.jsx("div",{className:"bg-token-bg-elevated-secondary overflow-auto rounded ".concat(r),style:{maxHeight:400},children:t.jsx("table",{className:"w-full border-separate border-spacing-0",children:t.jsx("tbody",{children:a.map((n,o)=>t.jsxs("tr",{className:"align-top",children:[t.jsx("td",{className:"text-token-text-tertiary py-0.5 ps-3 pe-3 text-end align-top text-[11px] whitespace-nowrap select-none",children:d+o}),t.jsx("td",{className:"py-0.5 pe-3 font-mono text-sm whitespace-pre",children:n===""?" ":n})]},o))})})})}function yt({finding:s}){var f,x,p,u;const e=A();let r=(x=(f=s.commit_analysis)==null?void 0:f.relevant_lines)!=null?x:[],a=Array.isArray(r)&&r.length>0;const d=(p=s.commit_analysis)==null?void 0:p.proposed_patch,n=typeof d=="string"&&d.trim().length>0;if(!a){const i=pe(d);r=(u=i==null?void 0:i.relevant_lines)!=null?u:[],a=Array.isArray(r)&&r.length>0}if(!a){if(n)return t.jsx(R,{title:e.formatMessage({id:"aardvark.findings.detailsTitle",defaultMessage:"Details"}),children:t.jsx("div",{className:"p-2",children:d})});if(!n)return t.jsx(R,{title:e.formatMessage({id:"aardvark.findings.evidence",defaultMessage:"Evidence"}),children:t.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.formatMessage({id:"aardvark.findings.noEvidence",defaultMessage:"No evidence available."})})})}const o=(()=>{var c,l,v,g;const i=new Map;for(const m of r){const j=m.path||(m==null?void 0:m.file_path)||"(unknown)",_=(c=m.start_line_number)!=null?c:0,k=(v=(l=m.end_line_number)!=null?l:m.start_line_number)!=null?v:0,h="".concat(j,"|").concat(_,"-").concat(k),y=(g=i.get(h))!=null?g:[];y.push(m),i.set(h,y)}return Array.from(i.entries()).sort((m,j)=>m[0].localeCompare(j[0]))})();return t.jsx(R,{title:e.formatMessage({id:"aardvark.findings.relevantLinesTitle",defaultMessage:"Relevant lines"}),children:t.jsx("div",{className:"space-y-3",children:o.map(([i,c])=>{const[l,v]=i.split("|");return t.jsxs("details",{open:!0,className:"group ring-token-border-light bg-token-main-surface-primary rounded-lg ring-1",children:[t.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium select-none",children:[t.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[t.jsx(_t,{className:"icon-sm text-token-text-tertiary transition-transform group-open:rotate-180","aria-hidden":!0}),t.jsx("span",{className:"truncate",children:l})]}),t.jsx("span",{className:"text-token-text-tertiary ms-2 text-xs whitespace-nowrap",children:e.formatMessage({id:"aardvark.findings.lineRange",defaultMessage:"L{range}"},{range:v==null?void 0:v.replace("-","–")})})]}),t.jsx("div",{children:c.map((g,m)=>t.jsxs("div",{className:"space-y-2",children:[g.comment&&t.jsx("p",{className:"text-token-text-secondary mb-0 bg-yellow-50/60 px-3 py-3 text-sm dark:bg-yellow-900/30",children:g.comment}),g.content&&t.jsx(jt,{content:g.content,start:g.start_line_number,className:"mb-0"})]},"".concat(i,"-").concat(m)))})]},i)})})})}const kt=O(()=>G(()=>import("./jnabziqdczabgqdk.js"),__vite__mapDeps([6,1])),{loading:s=>H(s)});function bt({finding:s}){var o,f,x,p,u;const e=A(),r=s,a=B.useMemo(()=>{var i;return pe((i=r.commit_analysis)==null?void 0:i.proposed_patch)},[(o=r.commit_analysis)==null?void 0:o.proposed_patch]),d=B.useMemo(()=>{var i,c,l;return(l=(c=a==null?void 0:a.cvss_score)!=null?c:(i=r.commit_analysis)==null?void 0:i.cvss_score)!=null?l:null},[a,r.commit_analysis]),n=B.useMemo(()=>{var i,c,l;return(l=(c=a==null?void 0:a.criticality_cvss_reason)!=null?c:(i=r.commit_analysis)==null?void 0:i.criticality_cvss_score_reason)!=null?l:null},[a,r.commit_analysis]);return t.jsxs(R,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[((f=r.commit_analysis)==null?void 0:f.title)||e.formatMessage({id:"aardvark.findings.vulnerability",defaultMessage:"Vulnerability"}),t.jsx(De,{level:r.criticality})]}),children:[t.jsx("div",{children:((x=r.commit_analysis)==null?void 0:x.bugs_found_or_fixed)&&t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(p=r.commit_analysis)==null?void 0:p.bugs_found_or_fixed})}),d!=null&&t.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-token-text-secondary flex items-center gap-1",children:t.jsx("div",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.cvssLabel",defaultMessage:"CVSS"})})}),t.jsxs("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-yellow-500 ring-amber-500/20",style:{backgroundColor:"rgba(245, 158, 11, 0.12)"},title:e.formatMessage({id:"aardvark.findings.cvssScore",defaultMessage:"CVSS score"}),children:[t.jsx(kt,{className:"me-1 h-[14px] w-[14px]","aria-hidden":!0}),d]})]}),n&&t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:n&&t.jsx("p",{className:"mb-2",children:n})}),t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(u=r.commit_analysis)==null?void 0:u.description})]})}const Nt=O(()=>G(()=>import("./l4db4kf3uum0xsyv.js"),__vite__mapDeps([7,1])),{loading:s=>H(s)}),Mt=O(()=>G(()=>import("./evxrp5263774zr36.js"),__vite__mapDeps([8,1])),{loading:s=>H(s)});function wt({finding:s}){var x,p,u;const e=A(),[r,a]=B.useState(!1),d=(x=s.commit_analysis)==null?void 0:x.validation_report,n=(p=s.commit_analysis)==null?void 0:p.validation_rubric,o=String(d||((u=s==null?void 0:s.commit_analysis)==null?void 0:u.validation_str)||"");if(!o&&!n)return null;const f=n&&o?2:1;return t.jsx(R,{title:e.formatMessage({id:"aardvark.findings.validation",defaultMessage:"Validation"}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-".concat(f),children:[n&&t.jsx("div",{className:"lg:col-span-1",children:t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:t.jsx(ae,{remarkPlugins:[fe],components:{code(v){var g=v,{inline:i,children:c}=g,l=de(g,["inline","children"]);const m=String(c!=null?c:"");if(i)return t.jsx("code",L(F({className:"bg-token-bg-primary rounded px-1 py-0.5 text-[12px]"},l),{children:m}));const j=String((l==null?void 0:l.className)||""),_=/language-([\w-]+)/.exec(j),k=_==null?void 0:_[1];return t.jsx(Be,{content:m,language:k,wrapperClassName:"mt-1",showActionBar:!1,codeContainerClassName:"p-3"})},input(i){return(i==null?void 0:i.type)!=="checkbox"?t.jsx("input",F({},i)):!!i.checked?t.jsx(Mt,{className:"mt-0.5 h-4 w-4 shrink-0 text-emerald-600"}):t.jsx(Nt,{className:"text-token-text-quaternary mt-0.5 h-4 w-4 shrink-0 opacity-70"})},li({children:i}){return t.jsx("li",{className:"hover:bg-token-bg-elevated-secondary/40 flex items-start gap-2 rounded-lg p-2",children:i})}},children:n})})}),o&&o.trim().length>0&&t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs font-semibold tracking-wide uppercase",children:e.formatMessage({id:"aardvark.findings.validationReportLabel",defaultMessage:"Validation report"})}),t.jsxs("div",{className:J("relative rounded-md p-3 text-sm leading-6","bg-token-main-surface-primary/40"),children:[t.jsx("div",{className:J("prose prose-sm text-foreground max-w-none",r?"max-h-none":"max-h-36 overflow-hidden"),children:t.jsx(ae,{remarkPlugins:[fe],children:o})}),!r&&t.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t"})]}),t.jsx("div",{className:"mt-2 flex items-center justify-end",children:t.jsx("button",{type:"button",className:"hover:bg-token-bg-elevated-secondary inline-flex h-8 items-center justify-center rounded px-2 text-xs",onClick:()=>a(i=>!i),children:r?e.formatMessage({id:"aardvark.findings.collapse",defaultMessage:"Collapse"}):e.formatMessage({id:"aardvark.findings.expand",defaultMessage:"Expand"})})})]})]})})}function St({finding:s,refetchFinding:e}){var r;return A(),t.jsx("div",{className:"relative mx-auto w-full max-w-[1200px]",children:t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3 md:gap-6",children:[t.jsx("div",{className:"flex flex-col gap-4 md:col-span-2",children:t.jsx(bt,{finding:s})}),t.jsx("div",{className:"flex h-fit flex-col gap-4 self-start",children:t.jsx(st,{finding:s})}),s.proposed_patch?t.jsx("div",{className:"md:col-span-3",children:t.jsx(pt,{proposed_patch:s.proposed_patch,findingId:(r=s.hid)!=null?r:s.id,refetchFinding:e})}):null,t.jsx("div",{className:"md:col-span-3",children:t.jsx(yt,{finding:s})}),t.jsx("div",{className:"md:col-span-3",children:t.jsx(wt,{finding:s})})]})})})}function Pt(s){"use forget";const e=V.c(24),{findingId:r}=s,a=A(),d=be(),n=Ne(),o=re();let f;e[0]!==d.search||e[1]!==n?(f=()=>t.jsx("div",{className:"mx-auto mb-4 w-full max-w-[1200px]",children:t.jsx(He,{as:"button",size:"small",color:"secondary",onClick:()=>{n("/aardvark"+(d.search||""))},children:t.jsx(P,{id:"aardvark.details.back",defaultMessage:"Back to findings"})})}),e[0]=d.search,e[1]=n,e[2]=f):f=e[2];const x=f;let p;e[3]!==x?(p=h=>t.jsxs("div",{className:"w-full px-4 pb-6",children:[x(),t.jsx("div",{className:"border-token-border-light text-token-text-secondary mx-auto w-full max-w-[1200px] rounded-lg border px-4 py-6 text-center",children:t.jsx(P,L(F({},te.findingLoad),{values:{details:h.message}}))})]}),e[3]=x,e[4]=p):p=e[4];const u=p,{data:i,isLoading:c,refetch:l,error:v}=Fe(r);let g,m;if(e[5]!==v||e[6]!==a||e[7]!==o?(g=()=>{if(!v)return;const h=a.formatMessage(te.findingLoad,{details:v.message});o.danger(h)},m=[v,a,o],e[5]=v,e[6]=a,e[7]=o,e[8]=g,e[9]=m):(g=e[8],m=e[9]),ee.useEffect(g,m),c){let h;return e[10]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("div",{className:"w-full px-4 pb-6",children:t.jsx("div",{className:"flex h-[60vh] w-full items-center justify-center",children:t.jsx(qe,{})})}),e[10]=h):h=e[10],h}if(v||!i){let h;e[11]!==v?(h=v!=null?v:new Error("Unknown error loading finding"),e[11]=v,e[12]=h):h=e[12];let y;return e[13]!==u||e[14]!==h?(y=u(h),e[13]=u,e[14]=h,e[15]=y):y=e[15],y}let j;e[16]!==x?(j=x(),e[16]=x,e[17]=j):j=e[17];let _;e[18]!==i||e[19]!==l?(_=t.jsx(St,{finding:i,refetchFinding:l}),e[18]=i,e[19]=l,e[20]=_):_=e[20];let k;return e[21]!==j||e[22]!==_?(k=t.jsxs("div",{className:"w-full px-4 pb-6",children:[j,_]}),e[21]=j,e[22]=_,e[23]=k):k=e[23],k}function At({findingId:s}){const e=ze(),r=Ge(e),a=Ue();return r?t.jsx(Ct,L(F({},a),{findingId:s})):null}function Ct(s){"use forget";const e=V.c(15),{findingId:r}=s,a=A();let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx(Ie,{}),e[0]=d):d=e[0];let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(Le,{children:t.jsx(Ve,{})}),e[1]=n):n=e[1];let o;e[2]!==r?(o=t.jsx("div",{className:"no-scrollbar h-full w-full overflow-y-auto",children:t.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:t.jsx(Pt,{findingId:r})})}),e[2]=r,e[3]=o):o=e[3];let f;e[4]!==a?(f=a.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[4]=a,e[5]=f):f=e[5];let x;e[6]!==a?(x=a.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[6]=a,e[7]=x):x=e[7];let p;e[8]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(P,{id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[8]=p):p=e[8];let u;e[9]!==f||e[10]!==x?(u=t.jsx("a",{href:"https://forms.gle/arrj4MzLN1YqdR8S6",target:"_blank",rel:"noopener noreferrer","aria-label":f,title:x,"data-testid":"aardvark-feedback-fab",className:"border-token-border-light bg-token-main-surface-primary shadow-long hover:bg-token-main-surface-secondary fixed end-4 bottom-4 z-50 flex h-10 items-center justify-center rounded-full border px-4 text-sm font-medium focus:outline-hidden",children:p}),e[9]=f,e[10]=x,e[11]=u):u=e[11];let i;return e[12]!==o||e[13]!==u?(i=t.jsxs(et,{mobileHeaderRightContent:null,children:[d,n,t.jsxs(We,{children:[o,u]})]}),e[12]=o,e[13]=u,e[14]=i):i=e[14],i}const ws=Me(function(){const e=we(),r=A();if(!e.id){const a=r.formatMessage(te.findingNotFound);return t.jsx("div",{children:a})}return t.jsx(At,{findingId:e.id})});export{ws as default};
//# sourceMappingURL=kkf5gcaul2rzvamz.js.map

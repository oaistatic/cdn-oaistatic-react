var h=(o,e)=>(e=Symbol[o])?e:Symbol.for("Symbol."+o);var g=(o,e,r)=>(e=o[h("asyncIterator")])?e.call(o):(o=o[h("iterator")](),e={},r=(i,d)=>(d=o[i])&&(e[i]=n=>new Promise((a,u,m)=>(n=d.call(o,n),m=n.done,Promise.resolve(n.value).then(p=>a({value:p,done:m}),u)))),r("next"),r("return"),e);import{y as R,ac as F,o as B,d as A,r as c,u as D,j as t}from"./bubexfvksfr7893o.js";import{u as H,cj as T,i2 as v,fT as L,el as N,g as y,n as O,T as j,nE as Q,nF as _,m5 as $,fO as k,e$ as q,L as G}from"./ncw8zw682jinppua.js";import{C as K}from"./gk9c5stronfar8qx.js";import{r as V,u as W,s as z,C as P,a as J,g as U,b as w,T as X,c as Y}from"./lm3g1zm00rp6al39.js";import{T as Z,C as ee}from"./l1vbk597qxt6gnzf.js";import{g as te}from"./o4w8zbrq7mg3p422.js";import{C as I,T as oe}from"./dktrrnr6sah4uda0.js";import"./m214aojas5i8u5ss.js";import"./drmwaklva7v056il.js";import"./ns51nblw8ziscsgd.js";import"./imbbtedzs51am1ck.js";import"./mj32z5vcfl3ugvj5.js";import"./ce3hgmw4iyyhicud.js";import"./fuwv2o9dqpty536z.js";import"./ebn7bwt2w9d4cap9.js";import"./nxg251y5bix8gl53.js";import"./eii6zxu7kogjx11x.js";import"./mstl8wgfzorpgdoe.js";import"./e9acc0j1u83xdcvx.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./orkdsokm67upvzbu.js";import"./deakbbf27g8e7ba0.js";import"./cdu988xkidlznefj.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./eg96d9s49vx4uh5w.js";import"./o66elomacusdy99v.js";import"./ecforv0kxuh5qyzb.js";import"./oumcmu9jw5n6nb3o.js";import"./n8xi1u5k4xaewewd.js";import"./bo0p7vuujjmng48f.js";import"./l4pcm542yc2tenou.js";import"./ffvjxtmoqooghm1t.js";import"./eqqsnl6kprwt6kvn.js";import"./b3zmi7k0e1dvao0m.js";import"./ekj7v0hd90m9gfgd.js";import"./hzasobp3hhjtq47p.js";import"./irqko7c1s7qpl41n.js";import"./knfzy5vszhnec9ql.js";import"./bc00p2ldn9cv9q32.js";import"./8ix1du5tuckfsvqq.js";import"./fwn4bwvyx3h4ty5g.js";import"./l1teaxoievyk0rz1.js";import"./nbm98bu0q3774lnr.js";import"./i9ddjt6oaiw4vo4g.js";import"./ke3w2t9x8i7kgfhv.js";const et=()=>(V(),null),tt=R(function(){const e=H(),r=F(),[i]=B(),d=A(),n=T(r.conversationId),a=v(i.get("readonly"),!1),u=v(i.get("isFullScreen"),!1),m=v(i.get("header"),!0),p=v(i.get("appPreview"),!1),C=L(),S=N(),b=v(i.get("hideBottomComposer"),!!a),f=T(r.canmoreId),s=c.useMemo(()=>y(e,n),[e,n]),l=W();c.useEffect(()=>{z({type:P.Textdoc,textdocId:f})},[f]),J(s.id,{kind:O.PrimaryAssistant});const x=D();if(c.useEffect(()=>(j.retainThread(s.id),()=>{setTimeout(()=>{x.invalidateQueries(U({clientThreadId:s.id}))},0),j.releaseThread(s.id)}),[s.id,x]),c.useEffect(()=>{f||d("/")},[f,d]),c.useEffect(()=>{w().sendMessage({type:I.Loaded})},[f]),!f||(l==null?void 0:l.type)!==P.Textdoc)return null;const E=()=>{w().sendMessage({type:I.Close})},M=a&&!m;return t.jsxs("div",{className:"h-full w-full overflow-hidden contain-content",children:[t.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}),t.jsx(Q.Provider,{value:y(e,s.id),children:t.jsx(_,{conversation:s,children:t.jsx($,{conversation:s,children:t.jsx(X,{clientThreadId:s.id,children:p?t.jsx(k,{children:t.jsx(se,{textdocId:l.textdocId})}):M?t.jsxs(t.Fragment,{children:[t.jsx(Z,{clientThreadId:s.id,disableScroll:!C,textdocId:l.textdocId}),t.jsx(ee,{})]}):t.jsx(oe,{isEmbedded:!0,hideRunCode:!C,isFullScreen:u,hideHeader:!m,hideBottomComposer:b,isReadonlyFromQueryParam:a,hideRenameButton:S,clientThreadId:s.id,focusedTextdoc:l,onClose:E},"textdocContent")})})})})]})}),se=({textdocId:o})=>{var m;const e=c.useRef(null),r=Y(o),[i,d]=c.useState(!1),n=(m=r==null?void 0:r.versions)!=null?m:[],a=q(n),u=c.useCallback(G(async p=>{const C=te(p.type,p.content);if(e.current&&(C==="react"||C==="html")){d(!0);const s=e.current.evalAsync({language:C,code:p.content});try{for(var re=g(s),S,b,f;S=!(b=await re.next()).done;S=!1){const l=b.value;console.debug(l)}}catch(b){f=[b]}finally{try{S&&(b=re.return)&&await b.call(re)}finally{if(f)throw f[0]}}}d(!1)},100),[]);return c.useEffect(()=>{a&&u(a)},[a,u]),t.jsx(K,{id:o,visuallyHidden:!i,ref:e,enableTransition:!0,title:""})};export{et as clientLoader,tt as default};
//# sourceMappingURL=gmj1no02crubprky.js.map

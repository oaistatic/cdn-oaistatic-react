var Y=Object.defineProperty;var N=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var O=(n,e,i)=>e in n?Y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,K=(n,e)=>{for(var i in e||(e={}))V.call(e,i)&&O(n,i,e[i]);if(N)for(var i of N(e))G.call(e,i)&&O(n,i,e[i]);return n};var H=(n,e)=>{var i={};for(var r in n)V.call(n,r)&&e.indexOf(r)<0&&(i[r]=n[r]);if(n!=null&&N)for(var r of N(n))e.indexOf(r)<0&&G.call(n,r)&&(i[r]=n[r]);return i};import{c as $,j as w,o as Z,y as ee,a5 as te,d as ie,u as re,r as Q,ag as q}from"./bubexfvksfr7893o.js";import{cs as ne,D as oe,nE as se,u as z,J as X,i2 as ae,g as ce,n as le,M as J,aa as de,T as U}from"./ncw8zw682jinppua.js";import{h5 as me,r as ue,a as pe,cK as ge,g as fe}from"./lm3g1zm00rp6al39.js";import{R as he}from"./g78s6ea1fdv7ipue.js";import{p as ve,u as Ee,a as Ie,W as Be,b as ke,c as Ce}from"./mamq4h01m06sylys.js";import{u as xe}from"./gqlpgmzguho9n5oh.js";import{r as Se}from"./kbj1b07s2z6vxqkg.js";import"./bitmj64bbwfuil93.js";import"./izjhrefsvxrmr1ks.js";import"./owbget26s04j6ot0.js";import"./gy1lpvuoewmzh42c.js";import"./o6p9t02t81236kdb.js";import"./hu1bt0oauegdhua6.js";import"./n117ifjno76hbo3f.js";import"./m609xwboj0zo059y.js";import"./eifqzljcxkeg8zns.js";import"./kqh10hum5vnfnvgi.js";import"./j51b3b8y7dx543la.js";import"./lep2wptoy14cfe2w.js";import"./bjkxn2ge6s764t7e.js";import"./h4jnqd77fz22arvf.js";import"./d5mh1yk0rnxpkd9n.js";import"./gobx7791fcp89y6h.js";import"./eewckg9c92mnp2ec.js";import"./imbbtedzs51am1ck.js";import"./fuwv2o9dqpty536z.js";import"./nxg251y5bix8gl53.js";import"./e8lckzowfybo0h8f.js";import"./kzvpseqfc0j2fpii.js";import"./ce3hgmw4iyyhicud.js";import"./cifdjmblsrwrxxb4.js";import"./m214aojas5i8u5ss.js";import"./l4pcm542yc2tenou.js";import"./ecforv0kxuh5qyzb.js";import"./ffvjxtmoqooghm1t.js";import"./eqqsnl6kprwt6kvn.js";import"./cdu988xkidlznefj.js";import"./owg1t5lbjzwpi0hd.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./h1em0bjkpkjv8ykw.js";function Pe(n,e){var s;if(!n||!e)return null;const i=xe().use(Se).use(he),r=i.parse(n);i.runSync(r);const t=r.children.filter(me).find(c=>{var u,a;const d=(a=(u=c.data)==null?void 0:u.hProperties)==null?void 0:a.id;return c.name===ne&&d===e});return!t||!((s=t.data)!=null&&s.hProperties)?(oe.addError(new Error("Writing block node not found"),{writingBlockId:e}),null):{id:String(t.data.hProperties.id),index:Number(t.data.hProperties.index),variant:ve(String(t.data.hProperties.variant)),title:t.data.hProperties.title?String(t.data.hProperties.title):void 0,recipient:t.data.hProperties.recipient?String(t.data.hProperties.recipient):void 0,content:String(t.data.hProperties.content)}}function We(n){"use forget";var c;const e=$.c(8);let i,r;e[0]!==n?(c=n,{conversation:i}=c,r=H(c,["conversation"]),e[0]=n,e[1]=i,e[2]=r):(i=e[1],r=e[2]);let t;e[3]!==r?(t=w.jsx(Te,K({},r)),e[3]=r,e[4]=t):t=e[4];let s;return e[5]!==i||e[6]!==t?(s=w.jsx(se.Provider,{value:i,children:t}),e[5]=i,e[6]=t,e[7]=s):s=e[7],s}function Te(n){"use forget";const e=$.c(44),{clientThreadId:i,serverThreadId:r,messageId:t,writingBlockId:s,originalContent:c,title:d,recipient:u,index:a,variant:l}=n,B=z();let E;e[0]!==B?(E=X(B,"669593727"),e[0]=B,e[1]=E):E=e[1];const k=E;let I;e[2]!==a||e[3]!==t||e[4]!==c||e[5]!==u||e[6]!==d||e[7]!==l||e[8]!==s?(I={messageId:t,id:s,originalContent:c,index:a,variant:l,title:d,recipient:u},e[2]=a,e[3]=t,e[4]=c,e[5]=u,e[6]=d,e[7]=l,e[8]=s,e[9]=I):I=e[9];const{writingBlock:p,contentReferences:C,autosaveStatus:x,flushPendingChanges:g,handleOnChange:m,messageRef:f,editorViewRef:S,analyticsMetadata:o,hasBeenEdited:P,isWritingBlockEditingAllowed:h,setDirty:v}=Ee(I),W=d!=null?d:"",T=u!=null?u:"";let _;e[10]!==i||e[11]!==g||e[12]!==m||e[13]!==h||e[14]!==t||e[15]!==v||e[16]!==W||e[17]!==T||e[18]!==p?(_={writingBlock:p,clientThreadId:i,messageId:t,onChange:m,setDirty:v,flushPendingChanges:g,isStreaming:!1,streamingTitle:W,streamingRecipient:T,isInlineWritingBlockEditEnabled:h},e[10]=i,e[11]=g,e[12]=m,e[13]=h,e[14]=t,e[15]=v,e[16]=W,e[17]=T,e[18]=p,e[19]=_):_=e[19];const y=Ie(_),L=l===Be.EMAIL,[A]=Z();let b;e[20]!==A?(b=ae(A.get("header"),!0),e[20]=A,e[21]=b):b=e[21];const D=b,M=L?y.headerLabel:void 0,j=L?y.emailSendButton:void 0,F=L?y.fullScreenEmailHeader:void 0;let R;return e[22]!==o||e[23]!==x||e[24]!==i||e[25]!==C||e[26]!==S||e[27]!==g||e[28]!==m||e[29]!==P||e[30]!==a||e[31]!==k||e[32]!==h||e[33]!==t||e[34]!==f||e[35]!==r||e[36]!==v||e[37]!==D||e[38]!==M||e[39]!==j||e[40]!==F||e[41]!==d||e[42]!==p?(R=w.jsx("div",{className:"bg-token-bg-primary h-full w-full",children:w.jsx("div",{className:ke,children:w.jsx(Ce,{editorViewRef:S,analyticsMetadata:o,showHeader:D,primaryLabel:M,primaryAction:j,subHeader:F,hasBeenEdited:P,autosaveStatus:x,clientThreadId:i,messageId:t,isInlineWritingBlockExportEnabled:k,isWritingBlockFocusedModeEnabled:!0,serverThreadId:r,shouldShowWritingBlockCanvasEdit:!1,title:d,index:a,messageRef:f,isInlineWritingBlockEditEnabled:h,writingBlock:p,onChange:m,isStreaming:!1,setDirty:v,flushPendingChanges:g,contentReferences:C,permalink:!0})})}),e[22]=o,e[23]=x,e[24]=i,e[25]=C,e[26]=S,e[27]=g,e[28]=m,e[29]=P,e[30]=a,e[31]=k,e[32]=h,e[33]=t,e[34]=f,e[35]=r,e[36]=v,e[37]=D,e[38]=M,e[39]=j,e[40]=F,e[41]=d,e[42]=p,e[43]=R):R=e[43],R}function we(n){var t,s,c;const e=(t=n.conversationId)==null?void 0:t.trim();if(!e)throw q("/");const i=(s=n.messageId)==null?void 0:s.trim(),r=(c=n.writingBlockId)==null?void 0:c.trim();if(!i||!r)throw q("/c/".concat(e));return{conversationId:e,messageId:i,writingBlockId:r}}const Et=n=>(ue(),we(n.params)),It=ee(function(){"use forget";const e=$.c(35),{conversationId:i,messageId:r,writingBlockId:t}=te(),s=z(),c=ie(),d=i;let u;e[0]!==s||e[1]!==d?(u=ce(s,d),e[0]=s,e[1]=d,e[2]=u):u=e[2];const a=u,l=a.id;let B;e[3]===Symbol.for("react.memo_cache_sentinel")?(B={kind:le.PrimaryAssistant},e[3]=B):B=e[3],pe(a.id,B);const E=ge();let k;e[4]!==s?(k=X(s,"1101084612"),e[4]=s,e[5]=k):k=e[5];const I=k,p=re();let C,x;e[6]!==l||e[7]!==p?(C=()=>(U.retainThread(l),()=>{setTimeout(()=>{p.invalidateQueries(fe({clientThreadId:l}))},0),U.releaseThread(l)}),x=[l,p],e[6]=l,e[7]=p,e[8]=C,e[9]=x):(C=e[8],x=e[9]),Q.useEffect(C,x);let g;e[10]!==r?(g=W=>{var T;return r?(T=W==null?void 0:W.tree.getNodeIfExists(r))==null?void 0:T.message:void 0},e[10]=r,e[11]=g):g=e[11];const m=J(a==null?void 0:a.id,g),f=J(a==null?void 0:a.id,_e);let S;e[12]!==m||e[13]!==t?(S=m?Pe(de(m),t):null,e[12]=m,e[13]=t,e[14]=S):S=e[14];const o=S;let P,h;if(e[15]!==l||e[16]!==E||e[17]!==I||e[18]!==m||e[19]!==c||e[20]!==f||e[21]!==o?(P=()=>{if(!(f!=null&&f.isLoading)){if(!l||!I){c("/",{replace:!0});return}if(f&&!m||E||m&&!o){c("/c/".concat(l),{replace:!0});return}}},h=[f,m,l,c,I,E,o],e[15]=l,e[16]=E,e[17]=I,e[18]=m,e[19]=c,e[20]=f,e[21]=o,e[22]=P,e[23]=h):(P=e[22],h=e[23]),Q.useEffect(P,h),!m||!o)return null;let v;return e[24]!==l||e[25]!==a||e[26]!==r||e[27]!==d||e[28]!==o.content||e[29]!==o.index||e[30]!==o.recipient||e[31]!==o.title||e[32]!==o.variant||e[33]!==t?(v=w.jsx(We,{conversation:a,clientThreadId:l,messageId:r,writingBlockId:t,serverThreadId:d,originalContent:o.content,index:o.index,variant:o.variant,title:o.title,recipient:o.recipient}),e[24]=l,e[25]=a,e[26]=r,e[27]=d,e[28]=o.content,e[29]=o.index,e[30]=o.recipient,e[31]=o.title,e[32]=o.variant,e[33]=t,e[34]=v):v=e[34],v});function _e(n){return n}export{Et as clientLoader,It as default};
//# sourceMappingURL=eji3ltllouzkznzq.js.map

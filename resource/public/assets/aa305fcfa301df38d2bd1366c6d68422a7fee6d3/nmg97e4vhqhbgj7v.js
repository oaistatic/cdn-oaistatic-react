const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/qrcm3utllwqs3zx5.js","assets/bubexfvksfr7893o.js","assets/jx5pd8qsxc77tbjo.js"])))=>i.map(i=>d[i]);
var ge=Object.defineProperty,pe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var W=(t,s,i)=>s in t?ge(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,w=(t,s)=>{for(var i in s||(s={}))fe.call(s,i)&&W(t,i,s[i]);if(Y)for(var i of Y(s))xe.call(s,i)&&W(t,i,s[i]);return t},_=(t,s)=>pe(t,me(s));import{r as d,j as e,h as J,u as he,e as ye,M as u,_ as Z}from"./bubexfvksfr7893o.js";import{cr as ve,az as X,u as $,d5 as z,d6 as Me,p as ee,pa as je,pb as ke,pc as Te,e_ as Se,gu as D,d9 as n,pd as Ce,pe as Pe,j as we,cu as _e,J as be,aC as se,aB as k,pf as b,pg as R,aA as ae}from"./ncw8zw682jinppua.js";import{dA as Re,dB as Le,dC as Ie,dD as te,dE as Ae}from"./lm3g1zm00rp6al39.js";import{S as Be,i as Ne,G as Ue,A as qe,M as Ve}from"./fd4xn0lvqrlxixyo.js";import"./oedzukfju6acynd1.js";const Ee=X(()=>Z(()=>import("./qrcm3utllwqs3zx5.js"),__vite__mapDeps([0,1])),{loading:t=>ae(t)}),Fe=X(()=>Z(()=>import("./jx5pd8qsxc77tbjo.js"),__vite__mapDeps([2,1])),{loading:t=>ae(t)});function Je({gizmo:t,updateGizmo:s,publishedGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:m,showActionsModal:y,shareOnly:T,onClose:M}){const[f,j]=d.useState({type:"privacy"});return f.type==="privacy"?e.jsx(Ge,{gizmo:t,updateGizmo:s,publishedGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:m,setStep:j,showActionsModal:y,shareOnly:T,onClose:M}):e.jsx(He,{publishedGizmo:f.publishedGizmo,onClose:M})}function Oe(t){return t?n.Workspace:n.Link}function Ge({gizmo:t,publishedGizmo:s,updateGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:m,setStep:y,showActionsModal:T,shareOnly:M,onClose:f}){var F,O,G,H,Q;const j=$(),[ie,I]=d.useState(!1),A=z(Me.isBusinessWorkspace),o=J(),x=ee(),[r,B]=d.useState(je(t)?Oe(!!A):t.sharingRecipient),re=he(),N=Ne(r,t.sharingTargets),{data:S,isLoading:ne}=ke(),U=Te(),[c,C]=d.useState(s!=null&&s.gizmo.display.categories.length>0?(O=(F=U.data)==null?void 0:F.categories.find(a=>a.id===s.gizmo.display.categories[0]))==null?void 0:O.id:void 0);d.useEffect(()=>{C(s==null?void 0:s.gizmo.display.categories[0])},[s==null?void 0:s.gizmo.display.categories]);const[le,q]=d.useState(void 0),oe=d.useRef(Se((a,l)=>D.generateCategory(a,l),1e3)),v=S!=null&&S.is_verified?void 0:o.formatMessage({id:"qUMu4e",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile in the user settings page."});r===n.Marketplace&&v!=null&&!ne&&B(n.Link);const ce=A&&!((G=t.sharingTargets)!=null&&G.some(a=>a.recipient===n.Link)),V=Ce(t,r,c),de=V.includes(Pe.MissingPublicActionPrivacyPolicyURL),P=t.tools.find(a=>a.type===we.JIT_PLUGIN&&!a.metadata.privacy_policy_url),h=z(a=>a.currentWorkspace),ue=_e();d.useEffect(()=>{let a=!0;return(async()=>{try{if(c!=null)return;const l=await oe.current(t.name,t.instructions);a&&c==null&&(l?C(l.id):q(!0))}catch(l){a&&c==null&&q(!0)}})(),()=>{a=!1}},[t.instructions,t.name,ue,c]);const E=be(j,"4226692983");return e.jsx(se,{testId:"modal-simple-share-gizmo",type:"success",isOpen:!0,onClose:f,title:e.jsx(u,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:N?e.jsx(k,{color:"primary",disabled:V.length>0,loading:ie,onClick:async()=>{try{if(I(!0),M){if(!(s!=null&&s.gizmo.id)){x.danger(o.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}),{toastId:"simple_share_gizmo_modal",loggingTitle:"Error sharing GPT",loggingDescription:"Error message when GPT ID is missing (shouldn't happen)"});return}const a=await D.shareGizmo(s.gizmo.id,c?{sharing:b(r,[],R),categories:[c]}:{sharing:b(r,[],R)});a.error?(x.warning(o.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),i({sharingTargets:a.sharing_targets}),m({gizmoId:s.gizmo.id,sharingRecipient:r,categories:s.gizmo.display.categories,moderationType:Ve.PublishBlocked,sharingTargets:a.sharing_targets,showModal:qe.AppealAvailable})):(re.setQueryData(["gizmo",{gizmoId:s.gizmo.id},{draft:!1}],l=>a.resource),i(l=>_(w({},l),{sharingRecipient:r})),x.success(o.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),f())}else{const a=await g({recipient:r,subjects:b(r,[],R)},c);a?(y({type:"published",publishedGizmo:a}),i(l=>_(w({},l),{id:a.gizmo.id,sharingRecipient:r})),a.gizmo.live_version!=null&&i({liveVersion:a.gizmo.live_version}),x.success(o.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(x.warning(o.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),f())}}finally{I(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(u,{id:"SW4DG4",defaultMessage:"Save"})}):E?e.jsx(e.Fragment,{children:e.jsx(k,{color:"primary",onClick:async()=>{await p(r,c)},children:e.jsx(u,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:s?e.jsx(k,{color:"secondary",onClick:a=>te(j,s,x,a,o.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(u,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(Ie,{value:r,onValueChange:a=>B(a),children:[t.sharingTargets&&t.sharingTargets.map((a,l)=>e.jsx(L,{value:a.recipient,disabled:a.recipient===n.Marketplace&&v!=null,tooltipText:a.recipient===n.Marketplace?v!=null?v:o.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:a.recipient},l)),ce&&e.jsxs(e.Fragment,{children:[e.jsx(L,{value:n.Link,disabled:!0,tooltipText:o.formatMessage(K.workspaceDisabledHint),shareLevel:n.Link,workspaceName:h==null?void 0:h.name}),e.jsx(L,{value:n.Link,disabled:!0,tooltipText:o.formatMessage(K.workspaceDisabledHint),shareLevel:n.Marketplace,workspaceName:h==null?void 0:h.name})]})]})}),de&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(u,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:a=>e.jsx("button",{onClick:()=>{T(P==null?void 0:P.metadata.action_id)},className:"underline",children:a})}})}),r!==n.Private&&e.jsx(Ue,{gizmo:t,category:c,categories:r===n.Marketplace?(Q=(H=U.data)==null?void 0:H.categories)!=null?Q:[]:void 0,onCategoryChange:r===n.Marketplace?a=>C(a.id):void 0}),r===n.Marketplace&&(le?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(u,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!N&&E&&e.jsx("div",{className:"text-token-text-secondary flex items-center justify-between text-sm",children:e.jsx(u,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function He({publishedGizmo:t,onClose:s}){const i=$(),g=Ae(i,t),p=J(),m=ee();return e.jsx(se,{testId:"modal-simple-share-published",type:"success",isOpen:!0,onClose:s,title:e.jsx(u,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(k,{color:"primary",as:"link",to:g,children:e.jsx(u,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex gap-1 rounded-sm px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 break-all text-ellipsis",children:g}),e.jsx("button",{onClick:y=>{te(i,t,m,y,p.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary hover:text-token-text-primary transition","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Ee,{className:"icon-sm"})})]})})})}const K=ye({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function L({shareLevel:t,workspaceName:s,value:i,disabled:g=!1,tooltipText:p}){const m=d.useId();return e.jsx(ve,{disabled:p==null,label:p,side:"top",triggerAs:null,children:e.jsxs(Re,{id:m,value:i,disabled:g,className:"hover:bg-token-main-surface-secondary flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold",children:[e.jsx("label",{htmlFor:m,className:"flex cursor-pointer items-center gap-1",children:e.jsx(Be,{shareLevel:t,workspaceName:s!=null?s:"",hasInviteSharing:!1})}),e.jsx(Le,{children:e.jsx(Fe,{className:"icon-lg me-1"})})]})})}export{L as ShareLevelRadioOption,Je as SimpleShareGizmoModal};
//# sourceMappingURL=nmg97e4vhqhbgj7v.js.map

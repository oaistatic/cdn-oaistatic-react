const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ncw8zw682jinppua.js","assets/bubexfvksfr7893o.js","assets/root-ookb7xuw.css","assets/d9d46aun6hvzsagm.js","assets/e7nua9i1wznz1yhn.js","assets/d1smcjt0gndyvbhy.js","assets/e2mpe7c8xvk51w5d.js","assets/ecforv0kxuh5qyzb.js","assets/o66elomacusdy99v.js","assets/mj32z5vcfl3ugvj5.js","assets/lm3g1zm00rp6al39.js","assets/conversation-small-lq38g8zw.css","assets/ce3hgmw4iyyhicud.js","assets/o4w8zbrq7mg3p422.js","assets/ns51nblw8ziscsgd.js","assets/m214aojas5i8u5ss.js","assets/fuwv2o9dqpty536z.js","assets/imbbtedzs51am1ck.js","assets/i6hdqng3ufj5kq75.js","assets/cx20kzi1ifz7iwh5.js","assets/eewckg9c92mnp2ec.js","assets/comments-plugin-tah3dlup.css","assets/codemirror-g1j9yafs.css","assets/bo0p7vuujjmng48f.js","assets/l4pcm542yc2tenou.js","assets/ba1u0o49onpmd3kx.js","assets/kzvpseqfc0j2fpii.js","assets/cifdjmblsrwrxxb4.js","assets/ffvjxtmoqooghm1t.js","assets/eqqsnl6kprwt6kvn.js","assets/oumcmu9jw5n6nb3o.js","assets/mstl8wgfzorpgdoe.js","assets/e9acc0j1u83xdcvx.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/orkdsokm67upvzbu.js","assets/deakbbf27g8e7ba0.js","assets/cdu988xkidlznefj.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/eg96d9s49vx4uh5w.js","assets/nweo10d387670cht.js","assets/nizbxgksf6o5ghfr.js","assets/gobx7791fcp89y6h.js","assets/kqh10hum5vnfnvgi.js","assets/gy1lpvuoewmzh42c.js","assets/o6p9t02t81236kdb.js","assets/hu1bt0oauegdhua6.js","assets/nxg251y5bix8gl53.js","assets/bitmj64bbwfuil93.js","assets/izjhrefsvxrmr1ks.js","assets/kbj1b07s2z6vxqkg.js","assets/h1em0bjkpkjv8ykw.js","assets/owbget26s04j6ot0.js","assets/eifqzljcxkeg8zns.js","assets/d5mh1yk0rnxpkd9n.js","assets/e8lckzowfybo0h8f.js","assets/gqlpgmzguho9n5oh.js","assets/lep2wptoy14cfe2w.js","assets/byvy8d7onv4dv8i1.js","assets/gtcvhpyyxjlawokm.js","assets/l8gfdbxyfhb5crrj.js","assets/prosemirror-egdr15sq.css","assets/n8xi1u5k4xaewewd.js","assets/qrcm3utllwqs3zx5.js","assets/kaw18xu9jo85v1g9.js","assets/g78s6ea1fdv7ipue.js","assets/n117ifjno76hbo3f.js","assets/m609xwboj0zo059y.js","assets/j51b3b8y7dx543la.js"])))=>i.map(i=>d[i]);
var Q=Object.defineProperty;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var k=(e,n,t)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,I=(e,n)=>{for(var t in n||(n={}))V.call(n,t)&&k(e,t,n[t]);if(R)for(var t of R(n))ee.call(n,t)&&k(e,t,n[t]);return e};import{j as l,r as g,_,h as U,e as ne,c as te,g as oe,i as se}from"./bubexfvksfr7893o.js";import{Z as ae,C as W}from"./ce3hgmw4iyyhicud.js";import{dS as le,cz as y,az as h,ct as $,d$ as ie,aA as T,mF as q,p as z,lN as re,u as X,P as Y,D as ce,R as ue,_ as j}from"./ncw8zw682jinppua.js";import{de as fe,um as pe,fh as s,fd as de,fg as v,fe as me,uG as be,mD as M,mE as Ee,al as Ce,uH as J}from"./lm3g1zm00rp6al39.js";import{b as P}from"./mstl8wgfzorpgdoe.js";import{_ as xe,a as _e,b as ge,c as ye,u as he,B as Te,d as De}from"./e9acc0j1u83xdcvx.js";import{u as Oe}from"./orkdsokm67upvzbu.js";import{T as ve}from"./fuwv2o9dqpty536z.js";import{u as Le}from"./m214aojas5i8u5ss.js";import{d as Ie}from"./deakbbf27g8e7ba0.js";import{s as K}from"./cdu988xkidlznefj.js";import{d as w}from"./kl7c6054usfnqmd4.js";import{g as we}from"./k97n0y6ba9c9h39c.js";import{r as Se}from"./eg96d9s49vx4uh5w.js";function Ae({className:e,zIndexKey:n,onClick:t}){return l.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:y("absolute inset-0",e,ae[n]),onClick:t})}function Ne({zIndexKey:e,onClick:n}){return l.jsx(Ae,{zIndexKey:e,onClick:n,className:"bg-gray-50/50 dark:bg-black/50"})}function Re(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];e&&typeof e!="function"?console.error('react-scroll-to-bottom: First argument passed to "useObserveScrollPosition" must be a function.'):xe(t)||console.error('react-scroll-to-bottom: Second argument passed to "useObserveScrollPosition" must be an array if specified.');var o=_e(),a=o.observeScrollPosition;g.useEffect(function(){return e&&a(e)},ge(n=[]).call(n,ye(t),[!e,a]))}function ke(){var e=he(),n=e.scrollToTop;return n}const je=h(()=>_(()=>import("./ncw8zw682jinppua.js").then(e=>e.yq),__vite__mapDeps([0,1,2])),{loading:e=>T(e)}),Me=h(()=>_(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([3,1])),{loading:e=>T(e)}),Pe=h(()=>_(()=>import("./e7nua9i1wznz1yhn.js"),__vite__mapDeps([4,1])),{loading:e=>T(e)}),Fe=({onScroll:e})=>(Re(({scrollTop:n})=>{e==null||e(n)}),null),Be=({shouldScrollToTop:e})=>{const n=ke();return g.useEffect(()=>{e===!0&&n({behavior:"smooth"})},[e,n]),null},He=()=>{const e=Oe();g.useEffect(()=>{e({behavior:"smooth"})},[e]);const[n]=De();return n?null:l.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"border-token-border-default bg-token-main-surface-primary text-token-text-secondary absolute end-1/2 bottom-5 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border bg-clip-padding",children:l.jsx(Pe,{className:"icon text-token-text-primary"})})};function Ge({children:e,onScroll:n,shouldScrollToTop:t,scrollToBottomMode:o="top",isLoading:a=!1,header:r,height:i="auto",overlay:u,hideChildren:p=!1,disableScroll:b=!1,ref:d,onCopy:E}){const c=l.jsx("div",{onCopy:E,className:y(p?"hidden":"block",i==="auto"?"h-auto":"h-full"),children:e});return l.jsxs("section",{ref:d,className:y("relative flex min-h-0 flex-auto grow flex-col",b&&"overflow-hidden"),children:[l.jsx(ie,{children:a&&l.jsx(Ne,{zIndexKey:"textdocDiffLoadingOverlay"})}),!b&&l.jsxs(Te,{followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:"flex flex-col",className:"h-full",mode:o,children:[r,c,u&&l.jsx("div",{className:"pointer-events-none w-full flex-1",children:u}),o==="bottom"&&l.jsx(He,{}),l.jsx(Fe,{onScroll:n}),l.jsx(Be,{shouldScrollToTop:t})]}),b&&l.jsxs(l.Fragment,{children:[r,c,u&&l.jsx("div",{className:"pointer-events-none h-full w-full",children:u})]})]})}function Ue({className:e,children:n}){return l.jsx("header",{className:y(e,"touch:px-2.5 h-header-height flex flex-none items-center justify-between gap-1 px-2"),children:n})}function We({className:e,children:n,size:t="lg",bold:o}){return l.jsx("h2",{className:y(e,"text-token-text-primary truncate",o?"font-bold":"font-normal",t==="lg"&&"text-lg",t==="base"&&"text-base"),children:n})}const $e=({onClick:e})=>{const t=$()?Me:je;return l.jsx(fe,{icon:t,onClick:e})},F=e=>{const{r:n,g:t,b:o}=P.toRGBA(P.parse(e));return(n*299+t*587+o*114)/1e3<125},L=({children:e,isPreviewingCode:n=!1,transitionBackground:t=!1,previewBackgroundColor:o=null})=>{const a=n&&o&&F(o),r=n&&o&&!F(o);return l.jsx("section",{className:y("popover flex h-full w-full flex-col",t&&"transition-colors",a&&"dark",r&&"light",n?"bg-[rgba(249,249,249,1)] dark:bg-[rgba(33,33,33,1)]":"bg-transparent"),style:{backgroundColor:n&&o?o:void 0},children:e})};L.Title=We;L.CloseButton=$e;L.Header=Ue;L.Content=Ge;const qe=h(()=>_(()=>import("./d1smcjt0gndyvbhy.js"),__vite__mapDeps([5,1,6,7,0,2,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.CodeComposer),{loading:()=>l.jsx("div",{className:W.code,children:l.jsx("div",{className:"h-full w-full px-4",children:l.jsx(q,{lines:20})})})}),vn=e=>l.jsx(qe,I({},e)),Ln=(e=[])=>e.filter(({status:n})=>n!==pe.DISMISSED);var ze=(e=>(e.ALL_HIDDEN="all_hidden",e.COMMENTS_READONLY="comments_readonly",e.ENABLED="enabled",e))(ze||{});const B=775,Xe=580,Ye=36,Je=18,In=24,wn=16,Ke=({numLines:e=20})=>{const[{width:n},t]=Le(),o=$(),a=n>=B+ve?B:Xe,r=o?Je:Ye;return l.jsx("div",{className:y(W.document,"mt-4"),ref:t,style:{margin:"0 ".concat(r,"px")},children:l.jsx("div",{style:{width:a},children:l.jsx(q,{lines:e})})})},Ze=h(()=>_(()=>import("./nweo10d387670cht.js"),__vite__mapDeps([42,1,43,0,2,19,7,18,13,10,11,14,12,15,20,17,9,16,21,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,23,24,25,26,27,28,29,64,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.DocumentComposer),{loading:({value:e,width:n=window.innerWidth})=>l.jsx(Ke,{numLines:Math.ceil(e.length/(n/8))})}),Sn=e=>l.jsx(Ze,I({},e));var O=(e=>(e.ADDED="added",e.REMOVED="removed",e.UNCHANGED="unchanged",e))(O||{});function N(e){if(e==="")return 0;const n=e.split("\n").length;return e.endsWith("\n")?n-1:n}function Qe(e,n){return Ie(e,n,{newlineIsToken:!0}).map(o=>{var a;return{count:(a=o.count)!=null?a:N(o.value),value:o.value,type:o.added?"added":o.removed?"removed":"unchanged"}})}function Ve(e){let n="";for(const{type:t,value:o}of e)(t==="added"||t==="unchanged")&&(n+=o);return n}function en(e,n){const t=N(n),o=on(e,t);return{changes:Qe(o,n),numLinesDiffed:t}}function nn(e){const n=[...e],t=[],o=[];for(;n.length>0;){const a=n[n.length-1];if(a.type===O.REMOVED)n.pop(),a.type===O.REMOVED&&t.unshift(a);else if(a.type===O.ADDED)n.pop(),o.unshift(a);else break}return{prunedChanges:[...n,...o],prunedRemovedChanges:t}}function tn(e,n){const{changes:t,numLinesDiffed:o}=en(e,n),{prunedChanges:a,prunedRemovedChanges:r}=nn(t),i=Ve(a),u=r.map(b=>b.value).join("\n"),p=Z(e,o,"start");return{content:i+u+p,numLinesDiffed:N(i)}}function on(e,n){if(n<=0)return"";let t=0,o=e.length;for(let a=0;a<e.length;a++)if(e[a]==="\n"&&(t++,t===n)){o=a+1;break}return e.substring(0,o)}function Z(e,n,t="start"){if(n<=0)return e;if(t==="start"){let i=0;for(let u=0;u<e.length;u++)if(e[u]==="\n"&&(i++,i===n))return e.substring(u+1);return""}let o=0,a=-1;const r=e.endsWith("\n")?n+1:n;for(let i=e.length-1;i>=0;i--)if(e[i]==="\n"&&(o++,o===r)){a=i;break}return a===-1?"":e.substring(0,a+1)}function An(e,n){var u,p;const t=(u=e==null?void 0:e.type)!=null?u:s.LOADING,o=(p=e==null?void 0:e.content)!=null?p:"",a=de(e);if(!v(t)||n==null||!a||!me(e))return{content:o,currentlyStreamingLineIndex:null};const r=Z(o,1,"end");if(r==="")return{content:n.content,currentlyStreamingLineIndex:0};const i=tn(n.content,r);return{content:i.content,currentlyStreamingLineIndex:i.numLinesDiffed}}const sn=h(()=>_(()=>import("./qrcm3utllwqs3zx5.js"),__vite__mapDeps([65,1])),{loading:e=>T(e)}),an=h(()=>_(()=>import("./kaw18xu9jo85v1g9.js"),__vite__mapDeps([66,1])),{loading:e=>T(e)});function ln(e){"use forget";const n=te.c(8),{textdocVersion:t,clientThreadId:o}=e,a=X();let r;n[0]!==t?(r=d=>t&&(d==null?void 0:d.lastCanvasAssistantMessageById[t.textdocId]),n[0]=t,n[1]=r):r=n[1];const i=be(r),u=t==null?void 0:t.type,p=t!=null;let b;return n[2]!==o||n[3]!==a||n[4]!==p||n[5]!==i||n[6]!==u?(b=d=>{if(!d.selectedText)return;const E=Y(o);p&&E!=null&&i!=null&&J(a,{type:"copy",source:d.source,location:"canvas",selectedText:d.selectedText,messageId:i,serverThreadId:E,contentType:u!=null&&v(u)?"code":"text",productLogOnly:d.productLogOnly})},n[2]=o,n[3]=a,n[4]=p,n[5]=i,n[6]=u,n[7]=b):b=n[7],b}function Nn({textdocVersion:e,clientThreadId:n}){var d;const t=U(),o=z(),[a,r]=g.useState(!1),i=re(),u=ln({textdocVersion:e,clientThreadId:n}),p=g.useRef((d=e==null?void 0:e.content)!=null?d:"");return g.useEffect(()=>{var E;p.current=(E=e==null?void 0:e.content)!=null?E:""},[e]),{handleCopy:E=>{a||(i(async()=>{const c=await K(p.current);u({source:"mouse",selectedText:c}),M.logButtonClick(Ee.COPY,{contentLength:c.length,textdocType:e==null?void 0:e.type});let f={"text/plain":c};if((e==null?void 0:e.type)===s.DOCUMENT)try{const{markdownToClipboardContent:m}=await _(async()=>{const{markdownToClipboardContent:C}=await import("./g78s6ea1fdv7ipue.js").then(x=>x.j);return{markdownToClipboardContent:C}},__vite__mapDeps([67,10,1,0,2,11,50,51,52,48,53,54,46,47,68,58,69,55,45,70,59]));f=m(c,[])}catch(m){M.logError("Error copying rich text",m)}Ce(f,o,E)},0),r(!0),i(()=>r(!1),2e3))},Icon:a?an:sn,copyLabel:t.formatMessage(rn.copy)}}const rn=ne({copy:{id:"rbIYfo",defaultMessage:"Copy"}}),H={[s.CODE_BASH]:{filenameExtension:"sh",blobType:"text/x-shellscript"},[s.CODE_ZSH]:{filenameExtension:"zsh",blobType:"text/x-shellscript"},[s.CODE_JAVASCRIPT]:{filenameExtension:"js",blobType:"application/javascript"},[s.CODE_TYPESCRIPT]:{filenameExtension:"ts",blobType:"application/typescript"},[s.CODE_HTML]:{filenameExtension:"html",blobType:"text/html"},[s.CODE_CSS]:{filenameExtension:"css",blobType:"text/css"},[s.CODE_PYTHON]:{filenameExtension:"py",blobType:"text/x-python"},[s.CODE_JSON]:{filenameExtension:"json",blobType:"application/json"},[s.CODE_SQL]:{filenameExtension:"sql",blobType:"application/sql"},[s.CODE_GO]:{filenameExtension:"go",blobType:"text/x-go"},[s.CODE_YAML]:{filenameExtension:"yaml",blobType:"application/x-yaml"},[s.CODE_JAVA]:{filenameExtension:"java",blobType:"text/x-java-source"},[s.CODE_RUST]:{filenameExtension:"rs",blobType:"text/rust"},[s.CODE_CPP]:{filenameExtension:"cpp",blobType:"text/x-c++src"},[s.CODE_SWIFT]:{filenameExtension:"swift",blobType:"text/swift"},[s.CODE_PHP]:{filenameExtension:"php",blobType:"application/x-httpd-php"},[s.CODE_XML]:{filenameExtension:"xml",blobType:"application/xml"},[s.CODE_RUBY]:{filenameExtension:"rb",blobType:"text/x-ruby"},[s.CODE_HASKELL]:{filenameExtension:"hs",blobType:"text/x-haskell"},[s.CODE_KOTLIN]:{filenameExtension:"kt",blobType:"text/x-kotlin"},[s.CODE_CSHARP]:{filenameExtension:"cs",blobType:"text/x-csharp"},[s.CODE_C]:{filenameExtension:"c",blobType:"text/x-csrc"},[s.CODE_OBJECTIVEC]:{filenameExtension:"m",blobType:"text/x-objectivec"},[s.CODE_R]:{filenameExtension:"r",blobType:"text/plain"},[s.CODE_LUA]:{filenameExtension:"lua",blobType:"text/x-lua"},[s.CODE_DART]:{filenameExtension:"dart",blobType:"text/x-dart"},[s.CODE_SCALA]:{filenameExtension:"scala",blobType:"text/x-scala"},[s.CODE_PERL]:{filenameExtension:"pl",blobType:"text/x-perl"},[s.CODE_COMMONLISP]:{filenameExtension:"lisp",blobType:"text/x-common-lisp"},[s.CODE_CLOJURE]:{filenameExtension:"clj",blobType:"text/x-clojure"},[s.CODE_OCAML]:{filenameExtension:"ml",blobType:"text/x-ocaml"},[s.CODE_POWERSHELL]:{filenameExtension:"ps1",blobType:"text/x-powershell"},[s.CODE_VERILOG]:{filenameExtension:"v",blobType:"text/x-verilog"},[s.CODE_DOCKERFILE]:{filenameExtension:"Dockerfile",blobType:"text/x-dockerfile"},[s.CODE_VUE]:{filenameExtension:"vue",blobType:"text/x-vue"},[s.CODE_REACT]:{filenameExtension:"jsx",blobType:"application/javascript"},[s.CODE_OTHER]:{filenameExtension:"txt",blobType:"text/plain"},[s.DOCUMENT]:{filenameExtension:"md",blobType:"text/markdown"},[s.LOADING]:{filenameExtension:"txt",blobType:"text/plain"}};var S,G;function cn(){if(G)return S;G=1;var e=Se(),n=e(function(t,o,a){return t+(a?"_":"")+o.toLowerCase()});return S=n,S}var un=cn();const A=oe(un);function Rn({textdocVersion:e,clientThreadId:n}){const t=U(),o=z(),a=X(),r=g.useCallback((c,f)=>{var x;const m=(x=e==null?void 0:e.messageId)!=null?x:void 0,C=n!=null?Y(n):void 0;!C||!m||J(a,{source:"mouse",type:"download",selectedText:c,location:"canvas",contentType:f,messageId:m,serverThreadId:C,productLogOnly:!0})},[n,a,e]),i=t.formatMessage({id:"canvas.downloadFileError",defaultMessage:"Failed to download file. Please try again later."}),{mutate:u,isPending:p}=se({mutationFn:async({textdocId:c,exportType:f})=>{const m=await ue.safePost("/export_doc/canvas",{requestBody:{textdoc_id:c,export_type:f},skipJsonTransform:!0});if(!m.ok)throw new Error("Failed to download file");return m},onSuccess:async(c,{exportType:f})=>{var D;if(!e)return;const m=await c.blob(),C=c.headers.get("Content-Disposition"),x=(D=we(C))!=null?D:"".concat(A(e.title),".").concat(f);w(m,x)},onError:c=>{o.danger(i,{toastId:"textdoc_download_button",loggingTitle:i,loggingDescription:"Failed to download file"}),ce.addError(c)}}),b=async c=>{if(e&&e.type!==s.LOADING&&e.type===s.DOCUMENT){let f;switch(c){case"md":f="chatgpt_canvas_md_download";break;case"pdf":f="chatgpt_canvas_pdf_download";break;case"docx":f="chatgpt_canvas_docx_download";break}if(j.logEventWithStatsig("ChatGPT Canvas Download",f),r(e.content,v(e.type)?"code":"text"),c==="pdf"||c==="docx")u({textdocId:e.textdocId,exportType:c});else if(c==="md"){const{filenameExtension:m,blobType:C}=H[e.type],x=await K(e.content),D=new Blob([x],{type:C});w(D,"".concat(A(e.title),".").concat(m))}}},d=()=>{if(!e)return;const{filenameExtension:c,blobType:f}=H[e.type];if(e.type===s.LOADING)return;j.logEventWithStatsig("ChatGPT Canvas Download","chatgpt_canvas_code_download",{blobType:f});const m=new Blob([e.content],{type:f});w(m,"".concat(A(e.title),".").concat(c)),r(e.content,v(e.type)?"code":"text")},E=t.formatMessage({id:"canvas.download-button",defaultMessage:"Download"});return{handleFileDownload:b,handleBlobDownload:d,isLoading:p,downloadCopyLabel:E,isDocument:(e==null?void 0:e.type)===s.DOCUMENT}}export{vn as A,ze as C,Ke as D,Ne as L,In as M,Ae as O,wn as S,Sn as a,L as b,Rn as c,B as d,Xe as e,Ln as f,An as g,Ye as h,Je as i,ln as j,Nn as u};
//# sourceMappingURL=eii6zxu7kogjx11x.js.map

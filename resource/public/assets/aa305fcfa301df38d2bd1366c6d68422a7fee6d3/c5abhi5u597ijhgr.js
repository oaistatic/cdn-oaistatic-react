const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lm3g1zm00rp6al39.js","assets/bubexfvksfr7893o.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/kaw18xu9jo85v1g9.js"])))=>i.map(i=>d[i]);
var oe=Object.defineProperty,se=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var X=(n,c,s)=>c in n?oe(n,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[c]=s,C=(n,c)=>{for(var s in c||(c={}))ce.call(c,s)&&X(n,s,c[s]);if(q)for(var s of q(c))ae.call(c,s)&&X(n,s,c[s]);return n},h=(n,c)=>se(n,te(c));import{h as ie,r as g,j as e,M as v,_ as M}from"./bubexfvksfr7893o.js";import{u as le,dQ as re,ks as de,eg as f,fD as ue,fE as _e,nJ as pe,fv as ge,ol as fe,oC as xe,p6 as me,e7 as H,mo as k,dZ as J,d_ as I,p7 as ye,oB as K,oD as Y,dN as Ce,az as A,aP as he,aC as ve,dR as ke,cz as Z,aB as ee,aA as w}from"./ncw8zw682jinppua.js";import{bE as Ne,bq as be}from"./lm3g1zm00rp6al39.js";const je=A(()=>M(()=>import("./lm3g1zm00rp6al39.js").then(n=>n.zp),__vite__mapDeps([0,1,2,3,4])),{loading:n=>w(n)}),Se=A(()=>M(()=>import("./lm3g1zm00rp6al39.js").then(n=>n.zd),__vite__mapDeps([0,1,2,3,4])),{loading:n=>w(n)}),Oe=A(()=>M(()=>import("./kaw18xu9jo85v1g9.js"),__vite__mapDeps([5,1])),{loading:n=>w(n)});function Ae({onClose:n,onContinue:c}){const s=le(),R=re(),N=ie(),{openSettings:L}=Ne(),x=de(),[b,ne]=g.useState(!1),r=f(()=>ue(s)),P=!r,d=f(()=>_e(s)),D=d===void 0,{mutateAsync:z,isPending:G,isSuccess:j}=pe(),u=f(()=>ge(s)),_=f(()=>fe(s,{}).data),V=_===void 0,p=f(()=>xe(s,{fetchValidLinksOnly:!0}).data),$=p===void 0,B=g.useMemo(()=>{const o=new Set(r==null?void 0:r.map(a=>a.type)),m=new Set(d==null?void 0:d.map(a=>"".concat(a.user_connection_details.connection_type))),i=new Set(me().filter(a=>o.has(a)||m.has(a)));return Array.from(i).slice(0,5)},[r,d]),S=g.useMemo(()=>{var m;const o=[];if(P||V||$||D)return Array.from({length:5},(i,a)=>({icon:e.jsx(H,{}),label:"",key:"loading-"+a,connected:!1,onClick:void 0,loading:void 0}));for(const i of B){const a=r.find(t=>t.type===i);if(a){const t=u!=null&&u.has(a.type);o.push({icon:e.jsx(be,{connector:a,size:"small"}),label:a.name,key:a.type,connected:t,onClick:t?void 0:()=>{x({connectorId:a.id,noRedirect:!0})},loading:void 0})}const l=[...d].find(t=>i===k.notion_sync_connector?t.user_connection_details.connection_instance_id.startsWith("ks--merge")&&t.user_connection_details.connection_type===i:t.user_connection_details.connection_type===i);if(l){const t=["partially_activated","activated","activating"].includes(l.user_connection_details.activation_status),y={icon:e.jsx("img",{src:R&&l.connection_display_info.icon_dark_url?l.connection_display_info.icon_dark_url:(m=l.connection_display_info.icon_url)!=null?m:"",alt:l.connection_display_info.display_name,className:"icon-lg"}),label:l.connection_display_info.display_name,key:l.user_connection_details.connection_type,connected:t,loading:void 0};i===k.notion_sync_connector?o.push(h(C({},y),{connected:t||!!(u!=null&&u.has(I.NOTION_CONNECTOR)),onClick:t?void 0:()=>{x({connectorId:J[I.NOTION_CONNECTOR],noRedirect:!0,syncOnly:!0})}})):i===k.slack_sync_connector?o.push(h(C({},y),{connected:t||b,label:"Slack",onClick:t||b?void 0:async()=>{const{success:T}=await ye({connectorType:"slack",connectionId:l.user_connection_details.connection_instance_id,location:"user_nux_modal",intl:N});T&&(ne(!0),setTimeout(()=>{K(s)},1e3))}})):i===k.gdrive_sync_connector?o.push(h(C({},y),{connected:t||j,loading:G,label:"Google Drive",onClick:t||j?void 0:async()=>{var Q,W;const T=(Q=_==null?void 0:_.find(E=>E.id===Y))==null?void 0:Q.id,F=(W=p==null?void 0:p.get(Y))==null?void 0:W.find(E=>E.connector_id===T);F?(await z({link:F}),setTimeout(()=>{K(s)},1e3)):x({connectorId:J[I.GDRIVE_ACTION_CONNECTOR],noRedirect:!0})}})):o.push(y)}}return o.push({icon:e.jsx(Se,{className:"icon-lg"}),label:N.formatMessage({id:"+rj0FA",defaultMessage:"More apps"}),key:"more-apps",onClick:()=>{L(Ce.Connectors)}}),o},[s,P,V,$,D,N,B,r,d,u,x,R,b,j,G,_,p,z,L]),O=g.useMemo(()=>S.filter(o=>o.connected),[S]),U=g.useCallback(()=>{he.setItem("oai/apps/connectors/glauxOnboarding",new Date().getTime()),n(!1),c()},[c,n]);return e.jsxs(ve,{className:"max-w-[480px] pb-8",hideSeparator:!0,isOpen:!0,onClose:()=>n(!1),showCloseButton:!1,testId:"modal-glaux-nux",type:"success",children:[e.jsx("div",{className:"flex justify-end pb-6",children:e.jsx(ke,{onClick:()=>n(!1)})}),e.jsxs("div",{className:"flex flex-col px-8",children:[e.jsx("div",{className:"text-center text-2xl font-semibold",children:e.jsx(v,{id:"uXSq7y",defaultMessage:"Enable internal knowledge"})}),e.jsx("div",{className:"text-token-text-secondary mt-2 text-center",children:e.jsx(v,{id:"KyWNjA",defaultMessage:"Connect these apps for the best experience"})}),e.jsx("div",{className:"grid grid-cols-3 gap-2 py-10",children:S.map(o=>e.jsxs("div",{className:Z("border-token-border-secondary flex grow flex-col gap-2 rounded-xl border p-3",o.onClick?"hover:bg-token-bg-tertiary cursor-pointer":""),onClick:o.onClick,children:[e.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:o.icon}),typeof o.connected=="boolean"?e.jsx("div",{className:"bg-token-bg-tertiary h-5 w-5 rounded-full",children:e.jsx("div",{className:Z("flex h-full w-full items-center justify-center rounded-full",o.connected?"bg-blue-400":"bg-token-bg-tertiary"),children:o.loading?e.jsx(H,{}):o.connected?e.jsx(Oe,{className:"icon-xs fill-white"}):e.jsx(je,{className:"icon-xs"})})}):null]}),e.jsx("div",{className:"text-token-text-secondary mt-3 line-clamp-1 text-sm",children:o.label})]},o.key))}),e.jsx("div",{className:"flex flex-col gap-3",children:O.length<5&&O.length>0?e.jsx(ee,{onClick:U,size:"large",children:e.jsx(v,{id:"vec4yt",defaultMessage:"Continue with limited apps"})}):e.jsx(ee,{disabled:O.length<5,onClick:U,size:"large",children:e.jsx(v,{id:"MCrtpI",defaultMessage:"Continue"})})})]})]})}export{Ae as GlauxNuxModal};
//# sourceMappingURL=c5abhi5u597ijhgr.js.map

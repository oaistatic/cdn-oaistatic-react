const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/g683sukvvwb09shg.js","assets/bubexfvksfr7893o.js","assets/lm3g1zm00rp6al39.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var S=Object.freeze,V=Object.defineProperty;var I=(s,n)=>S(V(s,"raw",{value:S(n||s.slice())}));import{h as B,u as G,r as b,d as Z,b as J,j as e,M as u,i as X,l as Y,_ as L}from"./bubexfvksfr7893o.js";import{u as $,al as z,_,aC as ee,aB as se,cw as te,p as ae,R as Q,cr as re,az as U,eH as j,aA as K}from"./ncw8zw682jinppua.js";import{bv as ne,bw as oe,a_ as f,bx as O,by as W,b6 as ie,bz as le,bA as de}from"./lm3g1zm00rp6al39.js";import{M as me,R as ce,t as ue}from"./hmf9tq54zhr2dacw.js";const he=U(()=>L(()=>import("./g683sukvvwb09shg.js"),__vite__mapDeps([0,1])),{loading:s=>K(s)}),xe=U(()=>L(()=>import("./lm3g1zm00rp6al39.js").then(s=>s.zv),__vite__mapDeps([2,1,3,4,5])),{loading:s=>K(s)});function fe({gizmo:s,memory:n}){var v;const i=B(),l=ae(),d=G(),{mutate:t,isPending:m}=X({mutationFn:async M=>{const{success:y}=await Q.safeDelete("/memories/{memory_id}",{parameters:{path:{memory_id:M}},requestBody:{gizmo_id:s==null?void 0:s.id}});if(!y)throw new Error("An error occurred while deleting the memory")},onSettled:()=>{d.invalidateQueries({queryKey:O(s==null?void 0:s.id)}),d.invalidateQueries({queryKey:W()})},onError:()=>{l.danger(Y({id:"MemoriesModal.deleteFailed",defaultMessage:"Failed to forget memory"}),{id:"memoryDeleteFailed",toastId:"memory_delete_failed"})}}),[p,a]=b.useState(!1),c=i.formatMessage({id:"N0czuB",defaultMessage:"Remove"});return e.jsxs(e.Fragment,{children:[e.jsxs(f.Row,{disabled:m,children:[e.jsx(f.Cell,{children:e.jsx("div",{className:"py-2 whitespace-pre-wrap",children:n.content})}),e.jsx(f.Cell,{textAlign:"right",children:e.jsx(f.Actions,{children:e.jsx("button",{onClick:()=>{_.logEvent("Memory Manage Modal Memory Delete Clicked"),a(!0)},"aria-label":c,className:"text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(re,{className:"leading-none",label:c,side:"top",children:e.jsx(he,{className:"icon-sm"})})})})})]}),p&&e.jsx(le,{isOpen:!0,primaryButtonColor:"danger",title:c,confirmText:i.formatMessage({id:"fCn0ar",defaultMessage:"Forget"}),onConfirm:()=>{_.logEvent("Memory Manage Modal Memory Delete Confirmed"),t(n.id),a(!1)},onClose:()=>{a(!1)},children:e.jsx(u,{id:"j2cZHW",defaultMessage:'Remove "{title}" from {name}’s saved memories. This can’t be undone. <link>Learn more</link>',values:{name:(v=s==null?void 0:s.name)!=null?v:"ChatGPT",title:e.jsx("strong",{children:ue(n.content,{length:130,omission:"..."})}),link:M=>e.jsx("a",{href:"https://help.openai.com/en/articles/8590148-memory-faq",target:"_blank",className:"underline",rel:"noreferrer",children:M})}})})]})}function Me({selectedGizmoId:s,onSelect:n,items:i}){const l=i.find(t=>t.id===s);function d(t){var m;return e.jsx(de,{isFirstParty:t.id===void 0,src:(m=t.iconUrl)!=null?m:null,className:"icon"})}return e.jsx("div",{className:"border-token-border-medium mb-2 inline-flex rounded-md border",children:e.jsxs(j.Root,{children:[e.jsx(j.Trigger,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[l?e.jsxs(e.Fragment,{children:[d(l),e.jsx("span",{className:"text-token-text-primary",children:l.name})]}):e.jsx(u,{id:"MemoriesModal.unknownGizmo",defaultMessage:"Unknown GPT"}),e.jsx(xe,{className:"icon-sm text-token-text-tertiary"})]})}),e.jsx(j.Portal,{children:e.jsx(j.Content,{children:i.map(t=>e.jsxs(j.Item,{className:"flex items-center gap-3",onClick:()=>{n(t.id)},children:[d(t),t.name]},t.id))})})]})})}var q;const P=te.div(q||(q=I(["flex h-full items-center justify-center pb-8 text-sm text-token-text-tertiary rounded-lg border border-token-border-default"])));function be({onClose:s,initialGizmoId:n,contextScopes:i,memoryEntriesFilter:l,requiredContextScopes:d}){var R,A,F;const t=B(),m=G(),p=ne(),[a,c]=b.useState(n),v=$(),M=Z(),y=z(v),E=y==null?void 0:y.hasPlusFeatures();b.useEffect(()=>{_.logEvent("Memory Modal Shown")},[]);const{data:h,isLoading:w,isError:C,refetch:T}=oe(a,!0,p,i,l,d),x=h==null?void 0:h.memories,{data:N,refetch:H}=J({queryKey:["memory_gizmos"],queryFn:()=>Q.safeGet("/memories/gizmos"),refetchOnMount:"always"}),k=[{id:void 0,name:"ChatGPT",iconUrl:null},...(R=N==null?void 0:N.items.map(({gizmo:r})=>{var D;return{id:r.id,name:r.display.name,iconUrl:(D=r.display.profile_picture_url)!=null?D:null}}))!=null?R:[]],o=k.find(r=>r.id===a);b.useEffect(()=>{!w&&!C&&a!==void 0&&(!x||x.length===0)&&c(void 0)},[w,C,x,a]);let g;return w?g=e.jsx(P,{children:e.jsx(u,{id:"MemoriesModal.loading",defaultMessage:"Loading..."})}):C?g=e.jsx(P,{children:e.jsxs("div",{className:"max-w-sm text-center",children:[e.jsx("div",{className:"mb-4 text-red-500",children:e.jsx(u,{id:"MemoriesModal.somethingWentWrong",defaultMessage:"Something went wrong..."})}),e.jsx("div",{children:e.jsx(se,{color:"secondary",onClick:()=>{T()},children:e.jsx(u,{id:"MemoriesModal.retry",defaultMessage:"Retry"})})})]})}):!x||x.length===0?g=e.jsx(P,{children:e.jsx("div",{className:"max-w-sm text-center",children:p?e.jsx(u,{id:"MemoriesModal.noMemories.1",defaultMessage:"As you chat with {name}, the details and preferences it saves will be shown here.",values:{name:(A=o==null?void 0:o.name)!=null?A:"ChatGPT"}}):e.jsx(u,{id:"MemoriesModal.noMemoriesAndDisabled",defaultMessage:"Memory is disabled. ChatGPT won't use or save memories."})})}):g=e.jsx(f.Root,{className:"border-token-border-default h-full",size:"compact",bordered:!0,children:e.jsx(f.Body,{children:x.map(r=>e.jsx(fe,{gizmo:o?{id:o.id,name:o.name}:void 0,memory:r},r.id))})}),e.jsxs(ee,{testId:"modal-memories",isOpen:!0,onClose:s,size:"custom",className:"max-w-5xl",type:"success",title:t.formatMessage({id:"MemoriesModal.title",defaultMessage:"Saved memories"}),showCloseButton:!0,children:[E&&k.length>1&&e.jsx("div",{className:"mb-4",children:e.jsx(Me,{selectedGizmoId:a,items:k,onSelect:r=>{m.invalidateQueries({queryKey:O(r)}),m.invalidateQueries({queryKey:W()}),c(r)}})}),e.jsx(me,{memoryFullPct:h==null?void 0:h.memoryFullPct,isPaid:E,showUpgradeCTA:!1,onUpgrade:()=>{_.logEventWithStatsig("Memories Upgrade Button Clicked","chatgpt_memories_upgrade_button_clicked_settings"),ie(M,"chatgpt_memories_upgrade_button")},className:"mb-5"}),e.jsx("div",{className:"h-[24rem]",children:g}),e.jsx("div",{className:"mt-5 flex justify-end",children:e.jsx(ce,{onReset:()=>{T(),H(),a&&c(void 0)},gizmoId:a,memoryName:(F=o==null?void 0:o.name)!=null?F:"ChatGPT",contextScopes:i,requiredContextScopes:d,memoryEntriesFilter:l})})]})}export{be as default};
//# sourceMappingURL=b5saxx3revwce53b.js.map

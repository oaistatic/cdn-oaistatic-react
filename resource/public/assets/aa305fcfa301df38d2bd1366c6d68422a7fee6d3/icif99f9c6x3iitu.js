const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lm3g1zm00rp6al39.js","assets/bubexfvksfr7893o.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/d9d46aun6hvzsagm.js","assets/gvtiiblfdceltjne.js","assets/paev76b70tpkjsm5.js","assets/m6indp0ntvnk1g4e.js","assets/impv9cw906sxjwad.js","assets/l5e2clfxpgm30p9v.js"])))=>i.map(i=>d[i]);
var $e=Object.defineProperty,Xe=Object.defineProperties;var Ye=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ke=(n,e,s)=>e in n?$e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,xe=(n,e)=>{for(var s in e||(e={}))ye.call(e,s)&&ke(n,s,e[s]);if(me)for(var s of me(e))Re.call(e,s)&&ke(n,s,e[s]);return n},pe=(n,e)=>Xe(n,Ye(e));var Se=(n,e)=>{var s={};for(var r in n)ye.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&me)for(var r of me(n))e.indexOf(r)<0&&Re.call(n,r)&&(s[r]=n[r]);return s};import{_ as G,j as t,h as de,r as g,t as Ze,M as W,g as Je,c as Qe,d as et}from"./bubexfvksfr7893o.js";import{az as K,cr as fe,cz as oe,e7 as Ee,aA as U,l7 as tt,tv as nt,tw as st,j1 as De,tx as rt,ty as ot,tz as at,hg as it,gB as lt,u as ct,pP as dt,i3 as Ie,d_ as Pe,d as ut,aB as ge,sc as mt}from"./ncw8zw682jinppua.js";import{ha as ft,a$ as ht,aV as Oe,aW as qe,qK as Fe,bZ as xt,lG as pt,x as Ve,z as gt,qL as vt}from"./lm3g1zm00rp6al39.js";import{C as He}from"./f1ucdf2dx4ztfnd4.js";import{I as bt}from"./kou7k14ueo6peaoq.js";import{u as We}from"./k3w19w5sa48fujqs.js";import{k as he,S as wt,T as jt,W as Et,U as _t,V as Nt,h as Mt}from"./o0dw43fppqvaf7ws.js";const Ct=K(()=>G(()=>import("./lm3g1zm00rp6al39.js").then(n=>n.zv),__vite__mapDeps([0,1,2,3,4])),{loading:n=>U(n)});function Ge({triggerText:n,toolTip:e,ariaLabel:s,Icon:r,truncate:i=!0,isLoading:l=!1}){return t.jsx(ft,{className:"composer-btn px-2","aria-label":s,"aria-busy":l,children:t.jsx(fe,{label:e,className:"text-sm font-medium",children:t.jsxs("div",{className:"flex max-w-full items-center gap-1.5 ps-1",children:[r,t.jsx("span",{className:oe("hidden sm:block",i?"max-w-[8rem] truncate md:max-w-[10rem]":"w-fit"),children:n}),l&&t.jsx(Ee,{"aria-hidden":!0,className:"icon-sm"}),t.jsx(Ct,{"aria-hidden":!0,className:"icon-sm"})]})})})}const kt=K(()=>G(()=>import("./d9d46aun6hvzsagm.js"),__vite__mapDeps([5,1])),{loading:n=>U(n)}),yt=K(()=>G(()=>import("./ncw8zw682jinppua.js").then(n=>n.yr),__vite__mapDeps([2,1,3])),{loading:n=>U(n)});function ae(N){var d=N,{children:n,className:e,onClick:s,isSelected:r,isActive:i,isVirtualHover:l=!1,label:w,isDisabled:u,tooltipLabel:o,isSubMenuTrigger:c,noDefaultHoverState:b,as:a="button",truncateLabel:_,infoIcon:j,infoLink:v,icon:x}=d,p=Se(d,["children","className","onClick","isSelected","isActive","isVirtualHover","label","isDisabled","tooltipLabel","isSubMenuTrigger","noDefaultHoverState","as","truncateLabel","infoIcon","infoLink","icon"]);const E=de();let y=t.jsx(t.Fragment,{});n?y=t.jsx("div",{className:"flex flex-1 items-center gap-4",children:n}):w&&(y=t.jsxs("div",{className:oe("flex items-center gap-3",_?"w-0 flex-1":"w-full"),children:[x&&(g.isValidElement(x)?x:t.jsx(Rt,{icon:x})),w&&t.jsx("div",{className:oe("flex flex-col items-start py-1",u&&"text-token-text-quaternary pointer-events-none",_&&"w-[100%]"),children:t.jsx("div",{className:oe("flex items-center text-start text-sm",_&&"w-full"),children:t.jsx("span",{className:"w-full overflow-hidden text-ellipsis whitespace-nowrap",children:w})})})]}),o&&(y=t.jsx(fe,{sideOffset:-10,label:o,className:"w-full",children:y})));const R=t.jsxs("div",{className:oe("flex items-center justify-center",(r||j&&v||c)&&"min-w-5"),children:[r&&t.jsx(yt,{className:"icon color:var(--tint-color,#0285FF) icon-sm","aria-label":E.formatMessage({id:"wham.codexMenuRow.selected",defaultMessage:"Selected"})}),j&&v&&t.jsx("a",{href:v,target:"_blank",rel:"noopener noreferrer",children:j}),c&&t.jsx(kt,{className:"icon text-token-text-tertiary w-7","aria-label":E.formatMessage({id:"wham.codexMenuRow.openSubmenu",defaultMessage:"Open submenu"})})]}),M=oe("flex cursor-pointer items-center rounded-[10px] px-2.5 py-1",(r||j&&v||c)&&"gap-4",i&&"bg-black/5 dark:bg-white/5",!b&&"hover:bg-black/5 dark:hover:bg-white/5",l&&"bg-black/5 dark:bg-white/5",e);if(a==="div"){const m=p;return t.jsxs("div",pe(xe({},m),{className:M,children:[y,R]}))}const B=p;return t.jsxs("button",pe(xe({type:"button"},B),{onClick:m=>{m.persist(),requestAnimationFrame(()=>{s==null||s(m)})},className:M,children:[y,R]}))}function Rt({icon:n}){const e=n;return t.jsx("div",{className:"text-token-text-secondary flex h-5 w-5 items-center justify-center",children:t.jsx(e,{className:"h-5 w-5 shrink-0","aria-label":""})})}const ve="wham-environment-popover-event";function Ke(n,e,s){g.useEffect(()=>{function i(l){l.detail.popover!==n&&s()}return window.addEventListener(ve,i),()=>{window.removeEventListener(ve,i)}},[n,s]);const r=g.useCallback(i=>{window.dispatchEvent(new CustomEvent(ve,{detail:{popover:i}}))},[]);g.useEffect(()=>{e&&r(n)},[e,r,n])}const Ue=({items:n,onSelect:e,keyExtractor:s})=>{const[r,i]=g.useState(null),[l]=g.useState(new Map);return{hoveredId:r,setHoveredId:i,getItemRef:u=>o=>{const c=s(u);return o&&l.set(c,o),()=>{l.delete(c)}},itemRefs:l,onKeyDown:u=>{var j;const o=u.key==="ArrowDown"||u.key==="n"&&u.ctrlKey,c=u.key==="ArrowUp"||u.key==="p"&&u.ctrlKey;if(!(o||c||u.key==="Enter"))return;if(u.preventDefault(),u.key==="Enter"){r&&e(r);return}const b=n.findIndex(v=>s(v)===r),a=ht(b-(c?1:-1),0,n.length-1),_=s(n[a]);(j=l.get(_))==null||j.scrollIntoView({behavior:"instant",block:"nearest"}),i(_)}}},St=K(()=>G(()=>import("./gvtiiblfdceltjne.js"),__vite__mapDeps([6,1])),{loading:n=>U(n)});function It({environment:n,repository:e}){var v,x,p,N;const s=de(),{branch:r,setBranch:i}=he(),[l,w]=g.useState(""),[u,o]=g.useState(!1),c=g.useRef(null),b=()=>o(!1),a=(p=(x=(v=n==null?void 0:n.repos)==null?void 0:v[0])!=null?x:e==null?void 0:e.id)!=null?p:null,_=g.useRef(a),j=n?Lt(n):(N=e==null?void 0:e.default_branch)!=null?N:"main";return g.useEffect(()=>{const d=_.current;if(_.current=a,!a){i(null);return}const E=wt(a);if(d!==a){if(E){i(E);return}i(j);return}r||i(E!=null?E:j)},[r,a,j,i]),Ke("branch",u,()=>o(!1)),We([{key:"whamBranches",action:()=>o(!0),actionMessageDescriptor:s.formatMessage({id:"wham.keyboardActions.whamBranches",defaultMessage:"Branches"}),group:qe.Chat,keyboardBinding:[Oe.Mod,"b"]}]),t.jsx("div",{className:"items-center rounded-full",children:t.jsxs(Fe,{open:u,onOpenChange:o,children:[t.jsx(Ge,{triggerText:r!=null?r:s.formatMessage({id:"wham.codexBranchPopover.selectABranch",defaultMessage:"Select a Branch"}),toolTip:r===""||u?"":r!=null&&r.length?r:s.formatMessage({id:"wham.codexBranchPopover.searchForYourBranchTooltip",defaultMessage:"Search for your branch"}),ariaLabel:s.formatMessage({id:"wham.codexBranchPopover.searchForYourBranchAria",defaultMessage:"Search for your branch"}),Icon:t.jsx(St,{"aria-hidden":!0,className:"icon-sm"})}),t.jsx(He,{align:"start",isOpen:u,closePopover:b,popoverContentRef:c,children:t.jsx(Pt,{defaultBranch:j,repoId:a,searchQuery:l,setSearchQuery:w,setBranch:i,selectedBranch:r!=null?r:"",closePopover:b})})]})})}function Pt({repoId:n,defaultBranch:e,setBranch:s,selectedBranch:r,searchQuery:i,setSearchQuery:l,closePopover:w}){const u=de(),o=g.useRef(null),c=xt(i,300),b=g.useMemo(()=>n?jt(n):[],[n]),{data:a,isLoading:_,fetchNextPage:j,hasNextPage:v,isFetchingNextPage:x,error:p}=Ze({queryKey:["searchBranches",n,c],enabled:!!n,initialPageParam:null,queryFn:({pageParam:m})=>Et.searchBranchesByRepository(n!=null?n:"",c,pt,m!=null?m:null),getNextPageParam:m=>{var k;return(k=m==null?void 0:m.cursor)!=null?k:null}}),N=g.useMemo(()=>{var z,f,L;const m=(L=(f=(z=a==null?void 0:a.pages)==null?void 0:z.flat().map(I=>I.items.flatMap(O=>O.branch)))==null?void 0:f.flat())!=null?L:[],k=new Set,T=[];e&&!k.has(e)&&(k.add(e),T.push(e));for(const I of b)k.has(I)||(k.add(I),T.push(I));for(const I of m)k.has(I)||(k.add(I),T.push(I));return T},[a,e,b]),d=m=>{s(m),w()},E=g.useMemo(()=>i!=null&&i.trim()?N.filter(m=>m.toLowerCase().includes(i.toLowerCase())):N!=null?N:[],[i,N]),{hoveredId:y,setHoveredId:R,onKeyDown:M,getItemRef:B}=Ue({items:E,keyExtractor:m=>m,onSelect:d});return g.useEffect(()=>{o.current&&o.current.focus()},[]),t.jsxs("div",{className:"gap flex max-h-[280px] w-90 flex-col rounded-lg p-0 md:max-h-[360px]",onClick:m=>{m.stopPropagation()},children:[t.jsx(Ve,{ref:o,className:"placeholder:text-token-text-tertiary !focus-within:ring-0 my-1.5 w-full border-0 bg-transparent ps-4 outline-none focus:border-0 focus:ring-0 focus:outline-none",type:"text",autoComplete:"off",inputClassName:"text-sm",name:"search-branch",value:i,suppressFocus:!0,onKeyDown:M,onChange:m=>l(m.target.value),placeholder:u.formatMessage({id:"wham.codexBranchPopover.branch",defaultMessage:"Search branches…"}),ariaLabel:u.formatMessage({id:"wham.codexBranchPopover.createBranchAria",defaultMessage:"Create a new branch"})}),t.jsx("div",{className:"bg-token-border-default h-px w-full"}),t.jsxs("div",{className:"min-h-18 w-full overflow-y-auto p-1.5",children:[E==null?void 0:E.map(m=>{const k=m===r;return t.jsx(ae,{className:"w-full max-w-full whitespace-nowrap",as:"button",onMouseEnter:()=>R(m),isVirtualHover:y===m,ref:B(m),onClick:()=>{d(m)},isSelected:k,label:m,truncateLabel:!0},m)}),p?t.jsx("div",{className:"flex items-center justify-center",children:t.jsx(W,{id:"wham.branchPopover.error",defaultMessage:"Error loading branches"})}):null,t.jsx(bt,{bgColor:"dark:bg-token-bg-secondary",hasNextPage:v,fetchNextPage:j,isFetchingNextPage:x||_})]})]})}function Lt(n){var e;for(const s of n.repos){const r=(e=n.repo_map)==null?void 0:e[s];if(r!=null&&r.default_branch)return r.default_branch}return"main"}function At({repository:n,disabledRepositoryIds:e,isCreating:s,creatingRepositoryId:r,isSelected:i,onSelect:l}){var b,a;const w=(a=(b=n.repository_full_name)!=null?b:n.name)!=null?a:"",u=r===n.id,c=!!(e==null?void 0:e.has(n.id))||!!s&&!u||!!u;return t.jsx(ae,{as:"button",className:"w-full",onClick:()=>{c||l(n)},isSelected:i,isDisabled:c,label:w})}const Bt=K(()=>G(()=>import("./paev76b70tpkjsm5.js"),__vite__mapDeps([7,1])),{loading:n=>U(n)});function Tt({repositories:n,isLoading:e,isError:s,search:r,onSelectRepository:i,existingEnvironmentRepositoryIds:l,showRepositoriesHeader:w}){"use no forget";const u=tt("installations/select_target"),o=he(a=>a.selectedRepositoryId),c=he(a=>a.useRepositoryAsEnvironment),b=g.useMemo(()=>n.length?n.filter(a=>{var v,x,p,N,d;if(!a.id||l.has(a.id))return!1;if(!r)return!0;const _=((x=(v=a.repository_full_name)!=null?v:a.name)!=null?x:"").toLowerCase(),j=(d=(N=(p=a.owner)==null?void 0:p.login)==null?void 0:N.toLowerCase())!=null?d:"";return _.includes(r)||j.includes(r)}).sort((a,_)=>{var x,p,N,d;const j=(p=(x=a.repository_full_name)!=null?x:a.name)!=null?p:"",v=(d=(N=_.repository_full_name)!=null?N:_.name)!=null?d:"";return j.localeCompare(v)}):[],[l,r,n]);return t.jsxs("div",{className:"text-token-text-primary flex flex-col gap-0.5",children:[w&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-token-border-default mt-2 h-px w-full"}),t.jsx("div",{className:"px-1.5",children:t.jsx(ae,{as:"div",className:"text-token-text-tertiary pointer-events-none w-full text-sm",label:t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(W,{id:"wham.codexEnvironmentPopover.repositoriesWithoutEnvironments",defaultMessage:"Repositories"})})})})]}),t.jsx("div",{className:"px-1.5",children:e?t.jsx("div",{className:"flex w-full items-center justify-center py-2",children:t.jsx(Ee,{className:"ms-2"})}):s?t.jsx("div",{className:"p-5 text-center",children:t.jsx("p",{className:"text-token-text-tertiary text-sm",children:t.jsx(W,{id:"wham.codexEnvironmentPopover.repositoriesWithoutEnvironmentsError",defaultMessage:"Failed to load repositories"})})}):b.length===0?t.jsx("div",{className:"p-5 text-center",children:t.jsx("p",{className:"text-token-text-tertiary text-sm",children:t.jsx(W,{id:"wham.environmentPopover.noRepositories",defaultMessage:"No repositories found"})})}):b.map(a=>t.jsx(At,{repository:a,isSelected:c&&o===a.id,onSelect:i},a.id))}),t.jsx("div",{className:"bg-token-border-default mt-1 h-px w-full"}),t.jsx("div",{className:"px-1.5 pb-1.5",children:t.jsx(ae,{as:"button",className:"mt-1 w-full",onClick:()=>{window.open(u,"_blank")},icon:t.jsx(Bt,{className:"icon-sm inline-block"}),label:t.jsx("div",{className:"flex items-center gap-2 text-sm",children:t.jsx(W,{id:"o1jiyf",defaultMessage:"Configure Repositories on GitHub"})})})})]})}function ze({className:n}){return t.jsx(gt,{className:oe("flex w-[8rem] items-center gap-1.5 rounded-full! md:w-[10rem]",n)})}var be,Le;function Dt(){if(Le)return be;Le=1;var n=nt(),e=st(),s=at(),r=De(),i=rt(),l=ot(),w=Math.min;function u(o,c,b){for(var a=b?s:e,_=o[0].length,j=o.length,v=j,x=Array(j),p=1/0,N=[];v--;){var d=o[v];v&&c&&(d=r(d,i(c))),p=w(d.length,p),x[v]=!b&&(c||_>=120&&d.length>=120)?new n(v&&d):void 0}d=o[0];var E=-1,y=x[0];e:for(;++E<_&&N.length<p;){var R=d[E],M=c?c(R):R;if(R=b||R!==0?R:0,!(y?l(y,M):a(N,M,b))){for(v=j;--v;){var B=x[v];if(!(B?l(B,M):a(o[v],M,b)))continue e}y&&y.push(M),N.push(R)}}return N}return be=u,be}var we,Ae;function Ot(){if(Ae)return we;Ae=1;var n=vt();function e(s){return n(s)?s:[]}return we=e,we}var je,Be;function qt(){if(Be)return je;Be=1;var n=De(),e=Dt(),s=it(),r=Ot(),i=s(function(l){var w=n(l,r);return w.length&&w[0]===l[0]?e(w):[]});return je=i,je}var Ft=qt();const Vt=Je(Ft),Ht=K(()=>G(()=>import("./m6indp0ntvnk1g4e.js"),__vite__mapDeps([8,1])),{loading:n=>U(n)}),Wt=K(()=>G(()=>import("./impv9cw906sxjwad.js"),__vite__mapDeps([9,1])),{loading:n=>U(n)}),Gt=K(()=>G(()=>import("./l5e2clfxpgm30p9v.js"),__vite__mapDeps([10,1])),{loading:n=>U(n)});function Kt(){const{data:n,isError:e}=Nt(),{data:s,isLoading:r,isError:i}=Mt();return{environments:s!=null?s:n,fullEnvironmentsLoading:r,isErrorEnvironments:i&&e}}function Ut({onCreateEnvironment:n,showBranchSelector:e=!0,allowRepositorySelection:s=!0,filters:r=null}={}){"use no forget";var re,C,X,ue;const i=de(),{environmentId:l,setEnvironmentId:w,selectedRepositoryId:u,setSelectedRepositoryId:o,setBranch:c,setUseRepositoryAsEnvironment:b,useRepositoryAsEnvironment:a}=he(),[_,j]=g.useState(!1),v=g.useRef(null),[x,p]=g.useState(!1),N=g.useRef(l),[d,E]=g.useState(null),[y,R]=g.useState(""),{data:M,isLoading:B,isError:m}=_t(y),{environments:k,fullEnvironmentsLoading:T,isErrorEnvironments:z}=Kt(),f=g.useMemo(()=>r!=null&&r.repos?k==null?void 0:k.filter(h=>Vt(h.repos,r.repos).length>0):k,[k,r]),L=f==null?void 0:f.find(h=>h.id===l),I=g.useCallback(h=>{var D,q;if(!h)return null;const S=(q=h.repos)!=null?q:Object.keys((D=h.repo_map)!=null?D:{});if(!S.length)return null;const[P]=S;return P!=null?P:null},[]);Ke("environment",_,()=>j(!1)),g.useEffect(()=>{N.current!==l&&(N.current=l,l!=null&&(p(!1),E(null)))},[l]),g.useEffect(()=>{if(!a){E(null);return}},[a]),g.useEffect(()=>{if(x||T)return;if(l&&!L){w(null),o(null);return}else if(!l&&(f!=null&&f.length)){const P=lt(f,[q=>{var H;return!((H=q.is_pinned)!=null&&H)},q=>{var H;return-((H=q.task_count)!=null?H:0)}])[0];w(P.id);const D=I(P);o(D!=null?D:null);return}const h=I(L);h!=null&&h!==u?o(h):L&&h==null&&u!=null&&o(null)},[T,l,L,f,w,u,o,I,x]),g.useEffect(()=>{var S;if(z||x||T||((S=f==null?void 0:f.length)!=null?S:0)>0||!(M!=null&&M.repositories.length))return;const[h]=M.repositories;if(h!=null&&h.id&&s&&!l){if(u===h.id&&a){(d==null?void 0:d.id)!==h.id&&E(h);return}b(!0),o(h.id),E(h),c(null)}},[M,z,a,l,u,c,o,b,E,x,T,f==null?void 0:f.length,d==null?void 0:d.id,s]),We([{key:"whamEnvironments",action:()=>j(!0),actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.whamEnvironments",defaultMessage:"Environments"}),group:qe.Chat,keyboardBinding:[Oe.Mod,"e"]}]);const O=g.useCallback(()=>j(!1),[]),Y=g.useCallback(h=>{h!=null&&h.id&&(p(!0),w(null),b(!0),o(h.id),E(h),c(null),O())},[O,c,w,o,b]),Z=i.formatMessage({id:"wham.codexEnvironmentPopover.selectEnvironment",defaultMessage:"Select environment"}),J=i.formatMessage({id:"wham.codexEnvironmentPopover.selectRepository",defaultMessage:"Select repository"}),ie=i.formatMessage({id:"wham.codexEnvironmentPopover.viewAllCodeEnvironments",defaultMessage:"View all code environments"}),A=L==null?void 0:L.label,Q=((re=A==null?void 0:A.length)!=null?re:0)>16,F=s&&(a||(f==null?void 0:f.length)===0&&!T),V=(X=(C=d==null?void 0:d.repository_full_name)!=null?C:d==null?void 0:d.name)!=null?X:J,ee=V.length>16,te=F?V:A!=null?A:Z,le=F?ee?V:"":Q?A!=null?A:"":A||_?"":ie,ne=F?t.jsx(Gt,{"aria-hidden":!0,className:"icon-sm"}):t.jsx(Ht,{"aria-hidden":!0,className:"icon-sm"}),ce=g.useMemo(()=>{const h=new Set;return f==null||f.forEach(S=>{var D,q;((q=S.repos)!=null?q:Object.keys((D=S.repo_map)!=null?D:{})).forEach(H=>{H&&h.add(H)})}),h},[f]),$=s&&a&&d?d:null,se=e&&!!(L||$);return T&&!(f!=null&&f.length)?t.jsx("div",{className:"flex items-center gap-3 rounded-full",children:t.jsx(ze,{})}):t.jsxs("div",{className:"flex items-center gap-2 rounded-full",children:[t.jsxs(Fe,{open:_,onOpenChange:j,children:[t.jsx(Ge,{triggerText:te,toolTip:le,ariaLabel:i.formatMessage({id:"wham.codexEnvironmentPopover.viewAll",defaultMessage:"View all code environments"}),Icon:ne}),t.jsx(He,{align:"start",isOpen:_,closePopover:O,popoverContentRef:v,children:t.jsx(zt,{searchTerm:y,setSearchTerm:R,repositories:(ue=M==null?void 0:M.repositories)!=null?ue:[],isLoadingRepositories:B,isErrorRepositories:m,isLoading:T,environments:f!=null?f:[],environmentId:l,setEnvironmentId:h=>{w(h);const S=f==null?void 0:f.find(D=>D.id===h),P=I(S);o(P!=null?P:null)},closePopover:O,onSelectRepository:Y,disabledRepositoryIds:ce,onCreateEnvironment:n,allowRepositorySelection:s})})]}),se&&t.jsx(It,{environment:L,repository:$})]})}function zt(n){"use forget";const e=Qe.c(77),{searchTerm:s,setSearchTerm:r,repositories:i,isLoadingRepositories:l,isErrorRepositories:w,isLoading:u,environments:o,environmentId:c,setEnvironmentId:b,closePopover:a,onSelectRepository:_,disabledRepositoryIds:j,onCreateEnvironment:v,allowRepositorySelection:x}=n,p=de(),N=g.useRef(null);let d;e[0]!==a||e[1]!==b?(d=C=>{b(C),a()},e[0]=a,e[1]=b,e[2]=d):d=e[2];const E=d,y=et(),R=o.length>0;let M;if(e[3]!==c||e[4]!==o||e[5]!==s){e:{let C;e[7]!==c?(C=S=>S.slice().sort((P,D)=>{var Me,Ce;if(P.id===c)return-1;if(D.id===c)return 1;const q=!!P.is_pinned,H=!!D.is_pinned;if(q!==H)return q?-1:1;const _e=(Me=P.task_count)!=null?Me:0,Ne=(Ce=D.task_count)!=null?Ce:0;return _e!==Ne?Ne-_e:P.label.localeCompare(D.label)}),e[7]=c,e[8]=C):C=e[8];const X=C,ue=s.trim().toLowerCase();if(!ue){let S;e[9]!==o||e[10]!==X?(S=X(o),e[9]=o,e[10]=X,e[11]=S):S=e[11],M=S;break e}const h=o.filter(S=>{var P;return((P=S.label)!=null?P:"").toLowerCase().includes(ue)});M=X(h)}e[3]=c,e[4]=o,e[5]=s,e[6]=M}else M=e[6];const B=M;let m;e[12]!==B||e[13]!==E?(m={items:B,keyExtractor:Xt,onSelect:E},e[12]=B,e[13]=E,e[14]=m):m=e[14];const{hoveredId:k,setHoveredId:T,onKeyDown:z,getItemRef:f}=Ue(m);let L,I;e[15]===Symbol.for("react.memo_cache_sentinel")?(L=()=>{var C;(C=N.current)==null||C.focus()},I=[],e[15]=L,e[16]=I):(L=e[15],I=e[16]),g.useEffect(L,I);let O;e[17]!==r?(O=C=>r(C.target.value),e[17]=r,e[18]=O):O=e[18];let Y;e[19]!==x||e[20]!==o.length||e[21]!==p?(Y=x?o.length>0?p.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsTooltip.envless",defaultMessage:"Search environments and repos…"}):p.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsTooltip.envlessRepos",defaultMessage:"Search repositories…"}):p.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsTooltip.environmentsOnly",defaultMessage:"Search environments…"}),e[19]=x,e[20]=o.length,e[21]=p,e[22]=Y):Y=e[22];let Z;e[23]!==x||e[24]!==p?(Z=x?p.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsAria.envless",defaultMessage:"Search environments and repos"}):p.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsAria.environmentsOnly",defaultMessage:"Search environments"}),e[23]=x,e[24]=p,e[25]=Z):Z=e[25];let J;e[26]!==z||e[27]!==s||e[28]!==O||e[29]!==Y||e[30]!==Z?(J=t.jsx(Ve,{ref:N,className:"placeholder:text-token-text-tertiary !focus-within:ring-0 my-1.5 w-full border-0 bg-transparent ps-4 outline-none focus:border-0 focus:ring-0 focus:outline-none",inputClassName:"text-sm",type:"text",autoComplete:"off",name:"branch-to-add",value:s,onChange:O,onKeyDown:z,suppressFocus:!0,placeholder:Y,ariaLabel:Z}),e[26]=z,e[27]=s,e[28]=O,e[29]=Y,e[30]=Z,e[31]=J):J=e[31];let ie;e[32]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("div",{className:"bg-token-border-default h-px w-full"}),e[32]=ie):ie=e[32];let A;e[33]!==J?(A=t.jsxs("div",{className:"contents",onClick:$t,children:[J,ie]}),e[33]=J,e[34]=A):A=e[34];let Q;e[35]!==o.length?(Q=o.length>0&&t.jsx(ae,{as:"div",className:"text-token-text-tertiary pointer-events-none w-full text-sm",label:t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(W,{id:"wham.codexEnvironmentPopover.envlessModeRepositories",defaultMessage:"Environments"})})}),e[35]=o.length,e[36]=Q):Q=e[36];let F;e[37]!==Q?(F=t.jsx("div",{className:"px-1.5 pt-1.5",children:Q}),e[37]=Q,e[38]=F):F=e[38];let V;e[39]!==c||e[40]!==o.length||e[41]!==B||e[42]!==f||e[43]!==E||e[44]!==k||e[45]!==u||e[46]!==T?(V=u?t.jsx("div",{className:"px-1.5",children:t.jsx("div",{className:"flex w-full items-center justify-center py-2",children:t.jsx(Ee,{className:"ms-2"})})}):o.length>0?B.length>0?t.jsx("div",{className:"px-1.5",children:B.map(C=>{const X=c===C.id;return t.jsx(ae,{as:"button",ref:f(C),onMouseEnter:()=>T(C.id),className:"w-full",truncateLabel:!0,onClick:()=>{E(C.id)},isVirtualHover:k===C.id,isSelected:X,label:C.label},C.id)})}):t.jsx("div",{className:"p-1.5 text-center",children:t.jsx("p",{className:"text-token-text-tertiary text-sm",children:t.jsx(W,{id:"wham.environmentPopover.noMatches",defaultMessage:"No environments found"})})}):null,e[39]=c,e[40]=o.length,e[41]=B,e[42]=f,e[43]=E,e[44]=k,e[45]=u,e[46]=T,e[47]=V):V=e[47];let ee;e[48]!==x||e[49]!==j||e[50]!==o.length||e[51]!==w||e[52]!==l||e[53]!==_||e[54]!==i||e[55]!==s?(ee=x?t.jsx(Tt,{onSelectRepository:_,existingEnvironmentRepositoryIds:j,showRepositoriesHeader:o.length>0,search:s.trim().toLowerCase(),repositories:i,isLoading:l,isError:w}):null,e[48]=x,e[49]=j,e[50]=o.length,e[51]=w,e[52]=l,e[53]=_,e[54]=i,e[55]=s,e[56]=ee):ee=e[56];let te;e[57]!==F||e[58]!==V||e[59]!==ee?(te=t.jsxs("div",{className:"flex min-h-0 flex-1 flex-col overflow-y-auto",children:[F,V,ee]}),e[57]=F,e[58]=V,e[59]=ee,e[60]=te):te=e[60];let le;e[61]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx("div",{className:"bg-token-border-default h-px w-full"}),e[61]=le):le=e[61];let ne;e[62]!==R||e[63]!==y||e[64]!==v?(ne=()=>{!R&&v?v():y("/codex/settings/environments")},e[62]=R,e[63]=y,e[64]=v,e[65]=ne):ne=e[65];let ce;e[66]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(Wt,{className:"icon-sm"}),e[66]=ce):ce=e[66];let $;e[67]!==R||e[68]!==p?($=R?p.formatMessage({id:"wham.codexEnvironmentPopover.manageEnvironments",defaultMessage:"Manage environments"}):p.formatMessage({id:"wham.codexEnvironmentPopover.createEnvironment",defaultMessage:"Create environment"}),e[67]=R,e[68]=p,e[69]=$):$=e[69];let se;e[70]!==ne||e[71]!==$?(se=t.jsx("div",{className:"bg-token-bg-tertiary flex flex-shrink-0 flex-col gap-1 px-2 py-1.5",children:t.jsx(ae,{className:"w-full",noDefaultHoverState:!0,onClick:ne,isSelected:!1,icon:ce,label:$},"environment-action")}),e[70]=ne,e[71]=$,e[72]=se):se=e[72];let re;return e[73]!==A||e[74]!==te||e[75]!==se?(re=t.jsxs("div",{className:"flex max-h-[280px] w-80 flex-col overflow-y-auto rounded-lg md:max-h-[360px]",children:[A,te,le,se]}),e[73]=A,e[74]=te,e[75]=se,e[76]=re):re=e[76],re}function $t(n){n.stopPropagation()}function Xt(n){return n.id}const Yt=K(()=>G(()=>import("./m6indp0ntvnk1g4e.js"),__vite__mapDeps([8,1])),{loading:n=>U(n)}),Te=K(()=>G(()=>import("./gvtiiblfdceltjne.js"),__vite__mapDeps([6,1])),{loading:n=>U(n)});function on({onCreateEnvironment:n,showBranchSelector:e,filters:s,allowRepositorySelection:r}={}){const i=ct(),l=de(),{isConnected:w,isLoading:u,openGithubModal:o,error:c,refetch:b}=dt(Pe.GITHUB_CONNECTOR,"github","/codex",Ie.CODEX),a=ut(()=>mt(i,Pe.GITHUB_CONNECTOR,{productSku:Ie.CODEX}));return u?t.jsx(ze,{className:"h-9"}):c?t.jsx(fe,{label:l.formatMessage({id:"wham.whamComposerEnvironmentsSelector.failedClickToRetry",defaultMessage:"Click to retry"}),children:t.jsx(ge,{color:"secondary",type:"button",className:"border-token-border-default flex w-fit items-center gap-1.5 rounded-full! border",onClick:b,children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(Yt,{"aria-hidden":!0,className:"icon-sm"}),t.jsx(W,{id:"wham.environmentsSelector.retry",defaultMessage:"Failed to load environments"})]})})}):a?t.jsx(t.Fragment,{children:t.jsx("div",{className:"z-0 flex w-full justify-between",children:w?t.jsx("div",{className:"flex gap-4",children:t.jsx(Ut,{onCreateEnvironment:n,showBranchSelector:e!=null?e:!0,allowRepositorySelection:r!=null?r:!0,filters:s!=null?s:null})}):t.jsx("div",{className:"flex gap-2",children:t.jsxs(ge,{type:"button",color:"secondary",size:"small",onClick:o,children:[t.jsx(Te,{"aria-hidden":!0,className:"icon-sm me-1.5"}),t.jsx(W,{id:"wham.environmentsSelector.connectGithub",defaultMessage:"Connect GitHub"})]})})})}):t.jsx(fe,{label:l.formatMessage({id:"wham.whamComposerEnvironmentsSelector.disabledByWorkspaceAdmin",defaultMessage:"Disabled by workspace admin"}),children:t.jsxs(ge,{type:"button",color:"secondary",onClick:o,disabled:!0,children:[t.jsx(Te,{"aria-hidden":!0,className:"icon-sm me-1.5"}),t.jsx(W,{id:"wham.environmentsSelector.connectGithub",defaultMessage:"Connect GitHub"})]})})}export{Ge as C,on as W,ae as a,Lt as g,Vt as i};
//# sourceMappingURL=icif99f9c6x3iitu.js.map

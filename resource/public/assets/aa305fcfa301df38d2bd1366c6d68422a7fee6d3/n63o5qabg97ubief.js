import{ac as R,j as a,aj as T,h as U,d as E,u as B,i as D,l as O,M as v,y as $}from"./bubexfvksfr7893o.js";import{ok as I,p as L,e7 as q}from"./ncw8zw682jinppua.js";import{e4 as z}from"./lm3g1zm00rp6al39.js";import{W as Q}from"./gtzjihtnvt59spmg.js";import{R as G,I as c,S as M}from"./fy2609bx486syiqb.js";import{E as H,R as J,g as K}from"./div6rw9ctuec3dis.js";import{u as X}from"./cwx3lrtca3zesjiz.js";import{c as Y,W as Z,d as V,w as ee,a as te,f as ae}from"./o0dw43fppqvaf7ws.js";import"./egzpifha5criht1h.js";import"./bqnf7jbq8xd3572o.js";import"./fwn4bwvyx3h4ty5g.js";import"./l1teaxoievyk0rz1.js";import"./guejgwxn789esoyt.js";import"./m7ky6cnx5e7w4637.js";import"./j4cpzybta3my41wg.js";import"./lowm54usy4rzuo31.js";import"./iv5xwnwraxd9v7zq.js";import"./bc00p2ldn9cv9q32.js";import"./8ix1du5tuckfsvqq.js";import"./nbm98bu0q3774lnr.js";import"./i9ddjt6oaiw4vo4g.js";import"./hzasobp3hhjtq47p.js";import"./i8ns2k0nyu6k62qc.js";import"./owg1t5lbjzwpi0hd.js";import"./f1ucdf2dx4ztfnd4.js";import"./e5q3f3k67x71csb7.js";import"./cty4owpsgisnj83c.js";import"./baz0q256ww4uq6xs.js";import"./f00k5a6r01z8wq07.js";import"./boj7ctg8ggfk4dia.js";import"./lptwpbjabrvjmhsj.js";import"./opgbrqj637eoxt1g.js";import"./nxpg01wwuofkn1k1.js";import"./ha3yj3u2f1w16goy.js";import"./m214aojas5i8u5ss.js";import"./drp7x5ntnuk0iqtu.js";import"./n117ifjno76hbo3f.js";import"./gqlpgmzguho9n5oh.js";import"./h1em0bjkpkjv8ykw.js";import"./m609xwboj0zo059y.js";import"./eifqzljcxkeg8zns.js";import"./o6p9t02t81236kdb.js";import"./hu1bt0oauegdhua6.js";function se(){const{environmentId:s}=R(),{eligible:r}=z();return r?a.jsx(T,{to:"/codex"}):s?a.jsx(re,{environmentId:s}):a.jsx(I,{})}function re({environmentId:s}){var u,l,h,_,f,g,S;const r=U(),i=L(),b=E(),d=B(),{data:e,isLoading:k,isError:C}=Y(s),p=(u=e==null?void 0:e.secrets)!=null?u:{},N=X()?"workspace":"private",{mutate:A,isPending:x}=D({mutationFn:t=>Z.updateEnvironment(s,t),onSuccess:async t=>{await te(d,s),ae(d,s,t),i.success(r.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),b("/codex/settings/environment/".concat(s))},onError:t=>{if(t instanceof V){ee(t,"wham_edit_environment_".concat(s),r,i);return}i.danger(O({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment"}),{toastId:"wham_edit_environment_failed_to_update_environment"})}});function F(t){var j,w;const n=K(t.secrets,p),W=t.envVars.reduce((o,y)=>(o[y.key]=y.value,o),{}),m=(w=(j=t.share_targets)==null?void 0:j.map(o=>o.trim()))==null?void 0:w.filter(Boolean),P=t.share_settings==="private"?[]:m==null?void 0:m.map(o=>({email:o,permission:"editor",type:"user"}));A({etag:e==null?void 0:e.etag,label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,share_targets:P,secrets:n,env_vars:W,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return a.jsx(Q,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:k?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(q,{})}):C?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?a.jsxs(a.Fragment,{children:[a.jsxs(G,{className:"sticky top-0 px-4",children:[a.jsx(c,{label:r.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),a.jsx(M,{}),a.jsx(c,{label:e.label,url:"/codex/settings/environment/".concat(s),className:"font-medium"}),a.jsx(M,{}),a.jsx(c,{label:r.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),a.jsx(H,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e==null?void 0:e.label,description:(l=e==null?void 0:e.description)!=null?l:"",share_settings:(h=e==null?void 0:e.share_settings)!=null?h:N,share_targets:(f=(_=e==null?void 0:e.share_targets)==null?void 0:_.map(t=>t.email))!=null?f:[],machine:e==null?void 0:e.machine_id,repositoryId:e==null?void 0:e.repos[0],workspaceDirectory:(g=e==null?void 0:e.workspace_dir)!=null?g:"",agentNetworkAccess:e==null?void 0:e.agent_network_access,setupCommands:e!=null&&e.setup?Array.isArray(e==null?void 0:e.setup)?e.setup.join("\n"):e.setup:"",maintenanceSetupCommands:e!=null&&e.maintenance_setup?Array.isArray(e==null?void 0:e.maintenance_setup)?e.maintenance_setup.join("\n"):e.maintenance_setup:"",envVars:Object.entries((S=e==null?void 0:e.env_vars)!=null?S:{}).map(([t,n])=>({key:t,value:n})),secrets:Object.keys(p).map(t=>({key:t,value:J,isEditing:!1})),autoSetupSettings:e==null?void 0:e.auto_setup_settings,cacheSettings:e==null?void 0:e.cache_settings},primaryButtonText:r.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:F,isPending:x})]}):a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const Ke=()=>[{title:"Codex"}],Xe=$(function(){return a.jsx(se,{})});export{Xe as default,Ke as meta};
//# sourceMappingURL=n63o5qabg97ubief.js.map

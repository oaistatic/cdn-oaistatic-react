const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lm3g1zm00rp6al39.js","assets/bubexfvksfr7893o.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/conversation-small-lq38g8zw.css","assets/dwgk7r4s1fwn35jq.js","assets/jx5pd8qsxc77tbjo.js","assets/d0fvtivu8wtjjx2a.js","assets/okzsq1aji2s9p1ex.js","assets/cmff6ny7qwtuxu45.js"])))=>i.map(i=>d[i]);
var hs=Object.defineProperty,ps=Object.defineProperties;var vs=Object.getOwnPropertyDescriptors;var $t=Object.getOwnPropertySymbols;var bs=Object.prototype.hasOwnProperty,ys=Object.prototype.propertyIsEnumerable;var Dt=(e,t,a)=>t in e?hs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,G=(e,t)=>{for(var a in t||(t={}))bs.call(t,a)&&Dt(e,a,t[a]);if($t)for(var a of $t(t))ys.call(t,a)&&Dt(e,a,t[a]);return e},fe=(e,t)=>ps(e,vs(t));import{b as Qt,r as _,j as s,M as x,h as oe,a as De,d as Ve,c as Ce,e as mt,_ as be,F as it,ar as ot,L as kt,u as ks,t as js,g as ws,y as Ms}from"./bubexfvksfr7893o.js";import{A as Ns,a as Ss,b as Cs}from"./fjd11y6s2jq9dlu1.js";import{W as jt,b7 as dt,aB as Se,p as at,dU as wt,dl as Wt,cz as ie,gC as _s,az as ye,aA as ke,e7 as ut,ff as Rs,eH as vt,cr as As,u as rt,al as Mt,cC as Kt,pP as Yt,i3 as Xt,d_ as Jt,vQ as Ps,h9 as Ls,ea as Es,iG as Is,ij as Fs,nF as Os}from"./ncw8zw682jinppua.js";import{g as Nt,h as ct,i as Ts,E as $e,r as ft,b as $s,e as St,j as Zt,k as Ds,l as Bs,S as es,A as ts,n as zs,o as Hs}from"./h1isumrrk8gn5a51.js";import{i as Vs,W as Us}from"./icif99f9c6x3iitu.js";import{y as qs,bZ as Gs,h9 as ss,ha as as,B as rs,E as ns,a_ as R,bo as Bt,J as He,x as ls,lB as Qs,qA as Ws}from"./lm3g1zm00rp6al39.js";import{k as Ks,x as Ys,W as Xs}from"./o0dw43fppqvaf7ws.js";import{b as Js}from"./ip2dsbq9712r5wna.js";import"./bc00p2ldn9cv9q32.js";import"./8ix1du5tuckfsvqq.js";import"./fwn4bwvyx3h4ty5g.js";import"./l1teaxoievyk0rz1.js";import"./nbm98bu0q3774lnr.js";import"./i9ddjt6oaiw4vo4g.js";import"./hzasobp3hhjtq47p.js";import"./krengkwf9us2g646.js";import"./luif5kl8klbqcpjy.js";import"./f1ucdf2dx4ztfnd4.js";import"./kou7k14ueo6peaoq.js";import"./k3w19w5sa48fujqs.js";import"./n117ifjno76hbo3f.js";import"./gqlpgmzguho9n5oh.js";import"./h1em0bjkpkjv8ykw.js";import"./m609xwboj0zo059y.js";import"./eifqzljcxkeg8zns.js";import"./o6p9t02t81236kdb.js";import"./hu1bt0oauegdhua6.js";import"./o45zl9yl00508gad.js";import"./mxzk2kf77c8eueuw.js";import"./jro698t78r3v26vt.js";import"./fum95d46v8d5jv8u.js";import"./n2u3q2i5341kdx8j.js";import"./j703u6xl4odnuo39.js";import"./me0ap2djy50z6upd.js";function gt(e){const{data:t,isLoading:a,refetch:r,isFetching:n,error:l}=Qt({queryKey:["aardvark","scan-configs",e!=null?e:"personal"],enabled:!0,queryFn:async()=>{var g,m;const o=new Nt(jt),f={limit:1e3},y=await o.get("/aardvark/scan_configurations",{headers:dt(),query:f});if(y.status!==200)throw ct(y.status,y.data);return(m=(g=y.data.items)==null?void 0:g.map(d=>{var u;return fe(G({},d),{lookback_days:(u=d.lookback_days)!=null?u:null})}))!=null?m:[]},refetchOnWindowFocus:!0}),{scanMap:i,configIdByRepo:c,configVersionById:h}=_.useMemo(()=>{const o=new Map,f=new Map,y=new Map;for(const g of t!=null?t:[])f.set(g.repo_id,g.id),y.set(g.id,g.version),o.set(g.repo_id,g);return{scanMap:o,configIdByRepo:f,configVersionById:y}},[t]);return{scanMap:i,configIdByRepo:c,configVersionById:h,isLoading:a||n,refetch:r,error:l}}function zt(e,t,a){const r=["aardvark","scan-configs",e!=null?e:"personal"];a.setQueryData(r,n=>{const l=Array.isArray(n)?[...n]:[],i=Ts(l,c=>c.id===t.id);return i>=0?l[i]=t:l.push(t),l})}function is({error:e=!1,handleOpenGithubModal:t}={}){const a=_.useMemo(()=>e?s.jsx("div",{className:"bg-token-danger-muted text-token-text-secondary mt-4 rounded-md px-3 py-2 text-sm",role:"alert",children:s.jsx(x,G({},$e.githubConnectionInline))}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"mt-4 flex items-center justify-center",children:s.jsx(Se,{as:"button",size:"small",color:"secondary",onClick:t,children:s.jsx(x,{id:"aardvark.whamRepos.connectGithub",defaultMessage:"Connect GitHub"})})})}),[e,t]);return s.jsxs("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mx-auto mt-6 w-full max-w-[640px] rounded-lg border px-5 py-6 text-center shadow-sm backdrop-blur-[2px]",children:[s.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.home.connectGithub.title",defaultMessage:"Connect GitHub to start scanning repositories with Aardvark."})}),a]})}function Ge(e,t){const r=new URLSearchParams(e).get(t);return!r||r.trim()===""?[]:r.split(",").map(n=>n.trim()).filter(Boolean)}function Zs(){const e=De(),t=Ve(),a=wt(),r=Wt(),n=r==null?void 0:r.email,l=a==null?void 0:a.getWorkspaceId(),{isLoading:i,scanMap:c,error:h}=gt(l),{repoOptions:o,repoScanIdMap:f}=_.useMemo(()=>{var p,v;const m=new Map,d=new Map;for(const b of c.values()){const j=String((p=b.repo_url)!=null?p:"").trim();if(!j)continue;m.set(j,ft(j)||j);const N=String((v=b.id)!=null?v:"").trim();N&&d.set(j,N)}const u=Array.from(m.entries()).map(([b,w])=>({value:b,label:w}));return u.sort((b,w)=>b.label.localeCompare(w.label)),{repoOptions:u,repoScanIdMap:d}},[c]);return _.useEffect(()=>{var u;const m=new URLSearchParams(e.search);if(!e.search||e.search===""||e.search==="?"){if(i)return;m.has("recommended")||m.set("recommended","true");const v=Vs([],o.map(b=>b.value));!m.has("repo")&&v.length>0&&m.set("repo",v.join(",")),m.set("sort",(u=m.get("sort"))!=null?u:"sev_desc"),t({search:"?".concat(m.toString())},{replace:!0})}},[e.search,t,n,o,i]),_.useEffect(()=>{var j,N;if(i||o.length===0)return;const m=new URLSearchParams(e.search);if(!(m.get("recommended")==="true"))return;const u=(j=o[0])==null?void 0:j.value;if(!u)return;const p=(N=m.get("repo"))!=null?N:"",v=p.split(",").map(C=>C.trim()).filter(Boolean);let b=v.length>0?v[0]:u;o.some(C=>C.value===b)||(b=u),(v.length!==1||v[0]!==b||p!==b)&&(m.set("repo",b),t({search:"?".concat(m.toString())},{replace:!0}))},[e.search,t,o,i]),{filters:_.useMemo(()=>{var z,H;const m=new Set(Ge(e.search,"status")),d=new Set(Ge(e.search,"criticality")),u=Ge(e.search,"repo"),p=Ge(e.search,"assignee"),v=Ge(e.search,"path_prefix"),b=(H=(z=new URLSearchParams(e.search).get("q"))==null?void 0:z.trim())!=null?H:"",w=new URLSearchParams(e.search).get("validated"),j=w==="true"?"validated":w==="false"?"unvalidated":"all",N=new URLSearchParams(e.search).get("recommended")==="true",C=new Set(Array.from(m)),F=new Set(Array.from(d)),I=new Set(u),k=I.size===1?Array.from(I)[0]:"all",M=new Set(p),L=Ge(e.search,"author"),S=new Set(L),P=new Set(v);return{selectedCriticalities:F,securityOnly:!1,privacyOnly:!1,selectedStatuses:C,selectedRepo:k,selectedRepos:I,selectedPathPrefixes:P,keywordQuery:b,recommendedOnly:N,existsInHeadOnly:!1,validationFilter:j,selectedAssignees:M,selectedAuthors:S}},[e.search]),onChangeFilters:m=>{const d=new URLSearchParams(e.search),u=m;u.recommendedOnly?d.set("recommended","true"):d.delete("recommended"),u.selectedRepos&&u.selectedRepos.size>0?d.set("repo",Array.from(u.selectedRepos).join(",")):d.delete("repo"),u.selectedCriticalities&&u.selectedCriticalities.size>0?d.set("criticality",Array.from(u.selectedCriticalities).join(",")):d.delete("criticality"),u.selectedStatuses&&u.selectedStatuses.size>0?d.set("status",Array.from(u.selectedStatuses).join(",")):d.delete("status"),u.validationFilter==="validated"?d.set("validated","true"):u.validationFilter==="unvalidated"?d.set("validated","false"):d.delete("validated"),u.selectedAssignees&&u.selectedAssignees.size>0?d.set("assignee",Array.from(u.selectedAssignees).join(",")):d.delete("assignee"),u.selectedAuthors&&u.selectedAuthors.size>0?d.set("author",Array.from(u.selectedAuthors).join(",")):d.delete("author"),u.selectedPathPrefixes&&u.selectedPathPrefixes.size>0?d.set("path_prefix",Array.from(u.selectedPathPrefixes).join(",")):d.delete("path_prefix");const p=u.keywordQuery.trim();p?d.set("q",p):d.delete("q"),t({search:"?".concat(d.toString())},{replace:!0})},repoOptions:o,repoOptionsLoading:i,repoScanIdMap:f,repoOptionsError:h}}const os=_.createContext(null);function ea({children:e}){const{filters:t,onChangeFilters:a,repoOptions:r,repoOptionsLoading:n,repoScanIdMap:l,repoOptionsError:i}=Zs(),c=at(),h=oe();return _.useEffect(()=>{if(!i)return;const o=h.formatMessage($e.scanConfigLoad,{details:i.message});c.danger(o)},[h,i,c]),s.jsx(os.Provider,{value:{filters:t,onChangeFilters:a,repoOptions:r,repoOptionsLoading:n,repoScanIdMap:l,repoOptionsError:i},children:e})}function nt(){const e=_.useContext(os);if(!e)throw new Error("useAardvarkFiltersContext must be used within AardvarkFiltersProvider");return e}const ta=e=>{const t=e.split(/[\n,]/g).map(a=>a.trim()).filter(Boolean);return Array.from(new Set(t)).join("\n")};function sa({intl:e,label:t,placeholder:a,helper:r,clearMessage:n,value:l,onChange:i}){const[c,h]=_.useState(l),o=_.useRef(l);_.useEffect(()=>{l!==o.current&&(o.current=l,h(l))},[l]);const f=g=>{const m=g.target.value;h(m);const d=ta(m);o.current=d,i(d)},y=()=>{o.current="",h(""),i("")};return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("textarea",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong min-h-[96px] rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c,onChange:f,placeholder:e.formatMessage(a)}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(r)}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:y,children:e.formatMessage(n)})]})]})}function aa({intl:e,label:t,options:a,selectedValues:r,onToggle:n}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(l=>{const i=r.has(l.value);return s.jsxs("label",{className:ie("flex cursor-pointer items-center justify-between px-3 py-2 text-sm transition-colors",i?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsx("span",{className:"flex items-center gap-3",children:l.label}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:i,onChange:()=>n(l.value)})]},l.value)})})]})}function ra(e,t,a=50,r=!0){const n=String(t!=null?t:"").trim(),l=Math.max(1,Math.min(a,500));return Qt({queryKey:["aardvark","authors",e||null,n||null,l],queryFn:async()=>{const i=new Nt(jt),c={limit:String(l)};e&&e.size>0&&(c.repo=Array.from(e).join(",")),n&&(c.q=n);const h=await i.get("/aardvark/scan-findings/list-authors",{headers:dt(),query:c});if(h.status!==200)throw ct(h.status,h.data);return h.data},staleTime:3e4,refetchOnWindowFocus:!0,enabled:r})}function na({intl:e,label:t,placeholder:a,loadingMessage:r,emptyMessage:n,clearMessage:l,fieldState:i}){const c=i;return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c.query,onChange:h=>c.setQuery(h.target.value),placeholder:e.formatMessage(a)}),s.jsx("div",{className:"border-token-border-light max-h-48 overflow-y-auto rounded-md border",children:c.isLoading?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:e.formatMessage(r)}):c.options.length===0?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:e.formatMessage(n)}):c.options.map(({email:h,label:o,subtitle:f})=>s.jsxs("label",{className:ie("border-token-border-subtle flex cursor-pointer items-center justify-between gap-2 border-b px-3 py-2 text-sm last:border-b-0",c.selection.has(h)?"bg-token-main-surface-secondary/60 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col",children:[s.jsx("span",{children:o||h}),f?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:f}):null]}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:c.selection.has(h),onChange:()=>c.toggle(h)})]},h))}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:c.clear,children:e.formatMessage(l)})})]})}const Ht=e=>(e!=null?e:"").trim().toLowerCase(),la=(e,t)=>{const a=t.trim().toLowerCase();return a?e.filter(({label:r,email:n,subtitle:l})=>"".concat(r," ").concat(n," ").concat(l!=null?l:"").toLowerCase().includes(a)):e};function ds({ctx:e,factory:t,items:a,isFetching:r}){var h;const n=Wt(),l=(h=n==null?void 0:n.email)!=null?h:"",i=Ht(l);return{options:_.useMemo(()=>{const o=[];l&&t.selfOptionMessage&&o.push({email:l,label:e.intl.formatMessage(t.selfOptionMessage),subtitle:l});const f=_s($s(a.map(y=>{var u,p;const g=(u=y.email)!=null?u:void 0,m=Ht(g);if(!g||!m||m===i)return null;const d=(p=y.name)!=null?p:void 0;return{email:g,label:d||g,subtitle:d?g:void 0,_norm:m}}),Boolean),"_norm");return o.push(...f),o},[e.intl,t.selfOptionMessage,a,l,i]),isLoading:r}}const ia=(e,t,a)=>{var l;const{data:r,isFetching:n}=ra(e.filters.selectedRepos,t,100,!0);return ds({ctx:e,factory:a,items:(l=r==null?void 0:r.items)!=null?l:[],isFetching:n})},oa=(e,t,a)=>{var l,i;const{data:r,isFetching:n}=qs((l=e.workspaceId)!=null?l:void 0,0,t,100);return ds({ctx:e,factory:a,items:(i=r==null?void 0:r.items)!=null?i:[],isFetching:n})};function da({section:e,ctx:t}){const[a,r]=_.useState(""),n=Gs(a,300),{options:l,isLoading:i}=e.useOptionsHook(t,n,e),c={query:a,setQuery:r,options:la(l,a),isLoading:i,clear:()=>t.setField(e.field,new Set),selection:t.draft[e.field],toggle:h=>t.toggleSetValue(e.field,h)};return s.jsx(na,{intl:t.intl,label:e.label,placeholder:e.placeholder,loadingMessage:e.loadingMessage,emptyMessage:e.emptyMessage,clearMessage:e.clearMessage,fieldState:c})}function ca({intl:e,label:t,options:a,selectedValue:r,onSelect:n}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(l=>{const i=r===l.value;return s.jsxs("label",{className:ie("flex cursor-pointer items-center justify-between gap-3 px-3 py-2 text-sm transition-colors",i?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"font-medium",children:s.jsx(x,G({},l.label))}),l.helper?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(l.helper)}):null]}),s.jsx("span",{className:ie("flex h-4 w-4 items-center justify-center rounded-full border-2",i?"border-token-text-primary bg-token-text-primary":"border-token-border-light bg-transparent"),"aria-hidden":!0,children:i?s.jsx("span",{className:"bg-token-bg-primary block h-2 w-2 rounded-full"}):null}),s.jsx("input",{type:"radio",className:"sr-only",checked:i,onChange:()=>n(l.value)})]},l.value)})})]})}function ma({intl:e,label:t,placeholder:a,helper:r,value:n,onChange:l}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:n,onChange:i=>l(i.target.value),placeholder:e.formatMessage(a)}),s.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(r)})]})}const xt="text",ht="comma-text",tt="multiselect",pt="singleselect",st="searchable-multiselect",ua=e=>Array.from(e).join("\n");function fa(e,t){switch(e.kind){case xt:return t[e.field].trim().length>0;case ht:case st:case tt:return t[e.field].size>0;case pt:return e.inactiveValue!==void 0?t[e.field]!==e.inactiveValue:!0;default:return!1}}function ga(e,t,a){switch(e.kind){case xt:{const r=t[e.field].trim();return r?r.length>24?"".concat(r.slice(0,24),"…"):r:null}case ht:case st:case tt:{const r=t[e.field].size;return r===0?null:a.formatMessage(e.summaryMessage,{count:r})}case pt:{const r=e.options.find(n=>n.value===t[e.field]);return r?a.formatMessage(r.label):null}default:return null}}function xa(e){"use forget";const t=Ce.c(44),{section:a,ctx:r}=e;switch(a.kind){case xt:{const n=r.draft[a.field];let l;t[0]!==r||t[1]!==a.field?(l=c=>r.setField(a.field,c),t[0]=r,t[1]=a.field,t[2]=l):l=t[2];let i;return t[3]!==r.intl||t[4]!==a.helper||t[5]!==a.label||t[6]!==a.placeholder||t[7]!==n||t[8]!==l?(i=s.jsx(ma,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,value:n,onChange:l}),t[3]=r.intl,t[4]=a.helper,t[5]=a.label,t[6]=a.placeholder,t[7]=n,t[8]=l,t[9]=i):i=t[9],i}case ht:{const n=r.draft[a.field];let l;t[10]!==n?(l=ua(n),t[10]=n,t[11]=l):l=t[11];const i=l;let c;t[12]!==r||t[13]!==a.field?(c=o=>{const f=o?o.split("\n"):[];r.setField(a.field,new Set(f))},t[12]=r,t[13]=a.field,t[14]=c):c=t[14];let h;return t[15]!==r.intl||t[16]!==i||t[17]!==a.clearMessage||t[18]!==a.helper||t[19]!==a.label||t[20]!==a.placeholder||t[21]!==c?(h=s.jsx(sa,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,clearMessage:a.clearMessage,value:i,onChange:c}),t[15]=r.intl,t[16]=i,t[17]=a.clearMessage,t[18]=a.helper,t[19]=a.label,t[20]=a.placeholder,t[21]=c,t[22]=h):h=t[22],h}case st:{let n;return t[23]!==r||t[24]!==a?(n=s.jsx(da,{section:a,ctx:r}),t[23]=r,t[24]=a,t[25]=n):n=t[25],n}case tt:{const n=r.draft[a.field];let l;t[26]!==r||t[27]!==a.field?(l=c=>{r.toggleSetValue(a.field,c)},t[26]=r,t[27]=a.field,t[28]=l):l=t[28];let i;return t[29]!==r.intl||t[30]!==a.label||t[31]!==a.options||t[32]!==n||t[33]!==l?(i=s.jsx(aa,{intl:r.intl,label:a.label,options:a.options,selectedValues:n,onToggle:l}),t[29]=r.intl,t[30]=a.label,t[31]=a.options,t[32]=n,t[33]=l,t[34]=i):i=t[34],i}case pt:{const n=r.draft[a.field];let l;t[35]!==r||t[36]!==a.field?(l=c=>r.setField(a.field,c),t[35]=r,t[36]=a.field,t[37]=l):l=t[37];let i;return t[38]!==r.intl||t[39]!==a.label||t[40]!==a.options||t[41]!==n||t[42]!==l?(i=s.jsx(ca,{intl:r.intl,label:a.label,options:a.options,selectedValue:n,onSelect:l}),t[38]=r.intl,t[39]=a.label,t[40]=a.options,t[41]=n,t[42]=l,t[43]=i):i=t[43],i}default:return null}}const ha=["new","triaged","in_progress","fixed","wontfix","duplicate"],pa=["critical","high","medium","low"],va=["all","validated","unvalidated"],T=mt({keywordLabel:{id:"aardvark.filtersPopover.keyword",defaultMessage:"Keyword"},keywordHint:{id:"aardvark.filtersPopover.keyword.hint",defaultMessage:"Matches title, summary, vulnerability text, and analysis details."},keywordPlaceholder:{id:"aardvark.filtersPopover.keyword.placeholder",defaultMessage:"Search vulnerability details…"},navSearchPlaceholder:{id:"aardvark.filtersPopover.nav.search",defaultMessage:"Search filters"},navEmpty:{id:"aardvark.filtersPopover.nav.empty",defaultMessage:"No filters match your search."},navPlaceholder:{id:"aardvark.filtersPopover.nav.placeholder",defaultMessage:"Select a filter from the list to configure it."},directoriesLabel:{id:"aardvark.filtersPopover.directories",defaultMessage:"Directories"},directoriesHint:{id:"aardvark.filtersPopover.directories.hint",defaultMessage:"Separate prefixes with commas or new lines. Example: services/auth/, web/app/"},directoriesPlaceholder:{id:"aardvark.filtersPopover.directories.placeholder",defaultMessage:"services/auth/, web/app/, shared/utils/"},pathsSummary:{id:"aardvark.filtersPopover.directories.summary",defaultMessage:"{count} paths"},clearDirectories:{id:"aardvark.filtersPopover.directories.clear",defaultMessage:"Clear directories"},authorsLabel:{id:"aardvark.filtersPopover.authors",defaultMessage:"Authors"},authorsPlaceholder:{id:"aardvark.filtersPopover.authors.placeholder",defaultMessage:"Search by author email…"},authorsLoading:{id:"aardvark.filtersPopover.authors.loading",defaultMessage:"Loading authors…"},authorsEmpty:{id:"aardvark.filtersPopover.authors.empty",defaultMessage:"No matching authors"},clearAuthors:{id:"aardvark.filtersPopover.authors.clear",defaultMessage:"Clear authors"},authoredByMe:{id:"aardvark.filtersPopover.authors.me",defaultMessage:"Authored by me"},assigneesLabel:{id:"aardvark.filtersPopover.assignees",defaultMessage:"Assignees"},assigneePlaceholder:{id:"aardvark.filtersPopover.assignees.placeholder",defaultMessage:"Search assignees…"},assigneesLoading:{id:"aardvark.filtersPopover.assignees.loading",defaultMessage:"Loading assignees…"},assigneesEmpty:{id:"aardvark.filtersPopover.assignees.empty",defaultMessage:"No matching assignees"},countSummary:{id:"aardvark.filtersPopover.countSummary",defaultMessage:"{count} selected"},clearAssignees:{id:"aardvark.filtersPopover.assignees.clear",defaultMessage:"Clear assignees"},assignedToMe:{id:"aardvark.filtersPopover.assignees.me",defaultMessage:"Assigned to me"},criticalityLabel:{id:"aardvark.filtersPopover.criticality",defaultMessage:"Criticality"},statusLabel:{id:"aardvark.filtersPopover.status",defaultMessage:"Status"},validationLabel:{id:"aardvark.filtersPopover.validation",defaultMessage:"Validation"},validationValidatedDetail:{id:"aardvark.filtersPopover.validation.validated.detail",defaultMessage:"Aardvark was able to trigger the exploit in an isolated sandbox to confirm it’s real."},applyButton:{id:"aardvark.filtersPopover.apply",defaultMessage:"Apply filters"},cancelButton:{id:"aardvark.filtersPopover.cancel",defaultMessage:"Cancel"},clearFiltersButton:{id:"aardvark.filtersPopover.clear",defaultMessage:"Clear filters"}}),ba={all:{id:"aardvark.filtersPopover.validation.all",defaultMessage:"All findings",description:"Radio label that keeps the validation filter unset so all findings appear."},validated:{id:"aardvark.filtersPopover.validation.validated",defaultMessage:"Validated only",description:"Radio label that filters the list to validated findings only."},unvalidated:{id:"aardvark.filtersPopover.validation.unvalidated",defaultMessage:"Unvalidated only",description:"Radio label that filters the list to unvalidated findings only."}},bt=[{kind:xt,id:"keyword",label:T.keywordLabel,field:"keywordQuery",placeholder:T.keywordPlaceholder,helper:T.keywordHint},{kind:ht,id:"directories",label:T.directoriesLabel,field:"selectedPathPrefixes",placeholder:T.directoriesPlaceholder,helper:T.directoriesHint,clearMessage:T.clearDirectories,summaryMessage:T.pathsSummary},{kind:st,id:"authors",label:T.authorsLabel,field:"selectedAuthors",placeholder:T.authorsPlaceholder,loadingMessage:T.authorsLoading,emptyMessage:T.authorsEmpty,clearMessage:T.clearAuthors,selfOptionMessage:T.authoredByMe,useOptionsHook:ia,summaryMessage:T.countSummary},{kind:st,id:"assignees",label:T.assigneesLabel,field:"selectedAssignees",placeholder:T.assigneePlaceholder,loadingMessage:T.assigneesLoading,emptyMessage:T.assigneesEmpty,clearMessage:T.clearAssignees,selfOptionMessage:T.assignedToMe,useOptionsHook:oa,summaryMessage:T.countSummary},{kind:tt,id:"criticalities",label:T.criticalityLabel,field:"selectedCriticalities",options:pa.map(e=>({value:e,label:s.jsx(St,{level:e})})),summaryMessage:T.countSummary},{kind:tt,id:"statuses",label:T.statusLabel,field:"selectedStatuses",options:ha.map(e=>({value:e,label:s.jsx(x,G({},Zt[e]))})),summaryMessage:T.countSummary},{kind:pt,id:"validation",label:T.validationLabel,field:"validationFilter",options:va.map(e=>({value:e,label:ba[e],helper:e==="validated"?T.validationValidatedDetail:void 0})),inactiveValue:"all"}];function ya({isOpen:e,onClose:t}){var F,I;const a=oe(),{filters:r,onChangeFilters:n}=nt(),l=wt(),i=l==null?void 0:l.getWorkspaceId(),c=_.useCallback(()=>{var k,M;return{keywordQuery:(k=r.keywordQuery)!=null?k:"",selectedPathPrefixes:new Set((M=r.selectedPathPrefixes)!=null?M:[]),selectedAuthors:new Set(r.selectedAuthors),selectedAssignees:new Set(r.selectedAssignees),selectedStatuses:new Set(r.selectedStatuses),selectedCriticalities:new Set(r.selectedCriticalities),validationFilter:r.validationFilter}},[r]),h=_.useCallback(()=>({keywordQuery:"",selectedPathPrefixes:new Set,selectedAuthors:new Set,selectedAssignees:new Set,selectedStatuses:new Set,selectedCriticalities:new Set,validationFilter:"all"}),[]),[o,f]=_.useState(c),[y,g]=_.useState(""),[m,d]=_.useState((I=(F=bt[0])==null?void 0:F.id)!=null?I:"");_.useEffect(()=>{e&&(f(c()),g(""))},[c,e]);const u=_.useMemo(()=>{const k=y.trim().toLowerCase();return k?bt.filter(M=>a.formatMessage(M.label).toLowerCase().includes(k)):bt},[a,y]);_.useEffect(()=>{var k,M;if(u.length===0){m!==""&&d("");return}u.some(L=>L.id===m)||d((M=(k=u[0])==null?void 0:k.id)!=null?M:"")},[u,m]);const p=_.useMemo(()=>{var k,M;return(M=(k=u.find(L=>L.id===m))!=null?k:u[0])!=null?M:null},[u,m]),v=_.useCallback((k,M)=>{f(L=>fe(G({},L),{[k]:M}))},[]),b=_.useCallback((k,M)=>{f(L=>{const S=new Set(L[k]);return S.has(M)?S.delete(M):S.add(M),fe(G({},L),{[k]:S})})},[]),w=()=>{n(G(G({},r),o)),t()},j=()=>{f(c()),g(""),t()},N=()=>{f(h())},C={draft:o,filters:r,workspaceId:i,setField:v,toggleSetValue:b,intl:a};return s.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:[s.jsxs("div",{className:"border-token-border-subtle w-full shrink-0 border-b pe-0 pb-2 md:w-60 md:border-e md:border-b-0 md:pe-3 md:pb-0",children:[s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong mb-2 w-full rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:y,onChange:k=>g(k.target.value),placeholder:a.formatMessage(T.navSearchPlaceholder),"aria-label":a.formatMessage(T.navSearchPlaceholder)}),s.jsx("div",{className:"flex max-h-[420px] flex-col gap-1 overflow-y-auto pe-1",children:u.length===0?s.jsx("div",{className:"text-token-text-tertiary rounded-md px-3 py-4 text-xs",children:a.formatMessage(T.navEmpty)}):u.map(k=>{const M=a.formatMessage(k.label),L=k.id===(p==null?void 0:p.id),S=ga(k,o,a),P=fa(k,o);return s.jsx("button",{type:"button",className:ie("text-token-text-secondary flex flex-col rounded-md px-3 py-2 text-start text-sm transition-colors",L?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"hover:bg-token-bg-secondary"),onClick:()=>d(k.id),children:s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:"truncate",children:M}),s.jsxs("div",{className:"flex items-center gap-2",children:[S?s.jsx("span",{className:"text-token-text-tertiary text-[11px]",children:S}):null,P?s.jsx("span",{className:"bg-token-text-secondary inline-block h-2.5 w-2.5 rounded-full","aria-hidden":!0}):null]})]})},k.id)})})]}),s.jsxs("div",{className:"flex min-h-[320px] flex-1 flex-col gap-4",children:[s.jsx("div",{className:"flex-1 overflow-y-auto pe-1",children:p?s.jsx(xa,{section:p,ctx:C}):s.jsx("div",{className:"text-token-text-tertiary text-sm",children:a.formatMessage(T.navPlaceholder)})}),s.jsxs("div",{className:"border-token-border-light flex items-center justify-end gap-3 border-t pt-3",children:[s.jsx(Se,{color:"ghost",type:"button",onClick:N,children:a.formatMessage(T.clearFiltersButton)}),s.jsx(Se,{color:"secondary",type:"button",onClick:j,children:a.formatMessage(T.cancelButton)}),s.jsx(Se,{type:"button",onClick:w,children:a.formatMessage(T.applyButton)})]})]})]})}const cs=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zv),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)}),Oe=mt({keyword:{id:"aardvark.filter.summary.keyword",defaultMessage:'contains "{value}"'},directories:{id:"aardvark.filter.summary.directories",defaultMessage:"{count, plural, one {# path} other {# paths}}"},authors:{id:"aardvark.filter.summary.authors",defaultMessage:"is {value}"},assignees:{id:"aardvark.filter.summary.assignees",defaultMessage:"is {value}"},statuses:{id:"aardvark.filter.summary.statuses",defaultMessage:"is {value}"},criticalities:{id:"aardvark.filter.summary.criticalities",defaultMessage:"is {value}"},validation:{id:"aardvark.filter.summary.validation",defaultMessage:"is {value}"},clearAria:{id:"aardvark.filter.summary.clear",defaultMessage:'Clear "{label}" filter chip'},clearIcon:{id:"aardvark.filter.summary.clearIcon",defaultMessage:"×"}}),ze=mt({keyword:{id:"aardvark.filter.summary.title.keyword",defaultMessage:"Keyword"},directories:{id:"aardvark.filter.summary.title.directories",defaultMessage:"Paths"},authors:{id:"aardvark.filter.summary.title.authors",defaultMessage:"Author"},assignees:{id:"aardvark.filter.summary.title.assignees",defaultMessage:"Assignee"},statuses:{id:"aardvark.filter.summary.title.statuses",defaultMessage:"Status"},criticalities:{id:"aardvark.filter.summary.title.criticalities",defaultMessage:"Criticality"},validation:{id:"aardvark.filter.summary.title.validation",defaultMessage:"Validation"}}),ka=mt({all:{id:"aardvark.filter.summary.validation.all",defaultMessage:"All findings"},validated:{id:"aardvark.filter.summary.validation.validated",defaultMessage:"Validated only"},unvalidated:{id:"aardvark.filter.summary.validation.unvalidated",defaultMessage:"Unvalidated only"}}),ja=(e,t=30)=>e.length>t?"".concat(e.slice(0,t),"…"):e,lt=e=>e.join(", "),wa=e=>e.charAt(0).toUpperCase()+e.slice(1);function Ma(){var h;const e=oe(),{filters:t,onChangeFilters:a}=nt(),[r,n]=_.useState(!1),l=((h=t.keywordQuery)!=null?h:"").trim(),i=_.useMemo(()=>{var f,y,g,m,d,u,p,v,b,w,j,N;let o=0;return o+=(y=(f=t.selectedRepos)==null?void 0:f.size)!=null?y:0,o+=(m=(g=t.selectedAuthors)==null?void 0:g.size)!=null?m:0,o+=(u=(d=t.selectedAssignees)==null?void 0:d.size)!=null?u:0,o+=(v=(p=t.selectedStatuses)==null?void 0:p.size)!=null?v:0,o+=(w=(b=t.selectedCriticalities)==null?void 0:b.size)!=null?w:0,o+=(N=(j=t.selectedPathPrefixes)==null?void 0:j.size)!=null?N:0,o+=l?1:0,o+=t.existsInHeadOnly?1:0,o+=t.validationFilter!=="all"?1:0,o+=t.recommendedOnly?1:0,o},[t,l]),c=_.useMemo(()=>{var p,v,b,w,j,N;const o=[],f=((p=t.keywordQuery)!=null?p:"").trim();f&&o.push({id:"keyword",title:e.formatMessage(ze.keyword),value:e.formatMessage(Oe.keyword,{value:ja(f)}),onClear:()=>a(fe(G({},t),{keywordQuery:""}))});const y=Array.from((v=t.selectedPathPrefixes)!=null?v:[]);y.length>0&&o.push({id:"directories",title:e.formatMessage(ze.directories),value:e.formatMessage(Oe.directories,{count:y.length}),onClear:()=>a(fe(G({},t),{selectedPathPrefixes:new Set}))});const g=Array.from((b=t.selectedAuthors)!=null?b:[]);g.length>0&&o.push({id:"authors",title:e.formatMessage(ze.authors),value:e.formatMessage(Oe.authors,{value:lt(g)}),onClear:()=>a(fe(G({},t),{selectedAuthors:new Set}))});const m=Array.from((w=t.selectedAssignees)!=null?w:[]);m.length>0&&o.push({id:"assignees",title:e.formatMessage(ze.assignees),value:e.formatMessage(Oe.assignees,{value:lt(m)}),onClear:()=>a(fe(G({},t),{selectedAssignees:new Set}))});const d=Array.from((j=t.selectedStatuses)!=null?j:[]);if(d.length>0){const C=d.map(F=>e.formatMessage(Zt[F]));o.push({id:"statuses",title:e.formatMessage(ze.statuses),value:e.formatMessage(Oe.statuses,{value:lt(C)}),onClear:()=>a(fe(G({},t),{selectedStatuses:new Set}))})}const u=Array.from((N=t.selectedCriticalities)!=null?N:[]);if(u.length>0){const C=u.map(wa);o.push({id:"criticalities",title:e.formatMessage(ze.criticalities),value:e.formatMessage(Oe.criticalities,{value:lt(C)}),onClear:()=>a(fe(G({},t),{selectedCriticalities:new Set}))})}return t.validationFilter!=="all"&&o.push({id:"validation",title:e.formatMessage(ze.validation),value:e.formatMessage(Oe.validation,{value:e.formatMessage(ka[t.validationFilter])}),onClear:()=>a(fe(G({},t),{validationFilter:"all"}))}),o},[t,e,a]);return s.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col gap-2 rounded-lg px-2 py-2",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(ss,{open:r,onOpenChange:n,children:[s.jsx(as,{asChild:!0,children:s.jsxs("button",{type:"button",className:ie("border-token-border-light inline-flex h-9 items-center gap-2 rounded-md border px-3 text-sm font-medium transition-colors",i>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),"aria-label":e.formatMessage({id:"aardvark.filter.dropdown.trigger",defaultMessage:"Filter findings"}),children:[s.jsx("span",{children:e.formatMessage({id:"aardvark.filter.dropdown.label",defaultMessage:"Filter"})}),i>0?s.jsx("span",{className:"bg-token-main-surface-primary/70 text-token-text-primary inline-flex items-center rounded-full px-2 text-xs font-medium",children:e.formatMessage({id:"aardvark.filter.dropdown.count",defaultMessage:"{count}"},{count:i})}):null,s.jsx(cs,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]})}),s.jsx(rs,{children:s.jsx(ns,{side:"bottom",align:"end",sideOffset:8,collisionPadding:16,className:"border-token-border-light bg-token-bg-primary z-30 max-h-[85vh] w-[min(720px,calc(100vw-16px))] overflow-y-auto rounded-lg border p-4 shadow-2xl sm:max-h-[80vh] sm:w-[min(720px,calc(100vw-32px))]",children:s.jsx(ya,{isOpen:r,onClose:()=>n(!1)})})})]})}),c.length>0?s.jsx("div",{className:"mb-10 flex flex-wrap items-center gap-2",children:c.map(o=>s.jsxs("div",{className:"border-token-border-light bg-token-bg-secondary/80 text-token-text-primary inline-flex items-center gap-3 rounded-md border px-2 py-1 text-xs shadow-sm",children:[s.jsx("span",{className:"text-token-text-tertiary text-[10px] font-semibold tracking-wide uppercase",children:o.title}),s.jsx("span",{className:"text-token-text-primary text-xs",children:o.value}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-sm",onClick:o.onClear,"aria-label":e.formatMessage(Oe.clearAria,{label:"".concat(o.title," ").concat(o.value)}),children:s.jsx("span",{"aria-hidden":"true",children:s.jsx(x,G({},Oe.clearIcon))})})]},o.id))}):null]})}function Na(){var y;const e=oe(),{filters:t,onChangeFilters:a,repoOptions:r,repoOptionsLoading:n}=nt(),[l,i]=_.useState(""),h=(y=_.useMemo(()=>{var g;return Array.from((g=t.selectedRepos)!=null?g:[])},[t.selectedRepos])[0])!=null?y:"",o=_.useMemo(()=>{var m;if(!h)return"";const g=r.find(d=>d.value===h);return(m=g==null?void 0:g.label)!=null?m:h},[h,r]),f=_.useMemo(()=>{var g,m,d,u,p;if(t.recommendedOnly){if(o)return o;const v=(g=r[0])==null?void 0:g.label;return v&&v.trim().length>0?v:e.formatMessage({id:"aardvark.filter.recommended.selectRepo",defaultMessage:"Choose a repository"})}return t.selectedRepos&&t.selectedRepos.size>0?t.selectedRepos.size===1?o||e.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(d=(m=t.selectedRepos)==null?void 0:m.size)!=null?d:0}):e.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(p=(u=t.selectedRepos)==null?void 0:u.size)!=null?p:0}):e.formatMessage({id:"aardvark.filter.allRepos.label",defaultMessage:"All repos"})},[t.recommendedOnly,t.selectedRepos,e,o,r]);return r.length===0?s.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[t.recommendedOnly?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:s.jsx(x,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories:"})}),s.jsx("span",{className:"border-token-border-light text-token-text-tertiary inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm",children:n?s.jsxs(s.Fragment,{children:[s.jsx(ut,{className:"text-token-text-tertiary h-4 w-4"}),s.jsx(x,{id:"aardvark.filter.repos.loading",defaultMessage:"Loading repositories..."})]}):s.jsx(x,{id:"aardvark.filter.repos.empty",defaultMessage:"No repositories available"})})]})]}):s.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[t.recommendedOnly?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:s.jsx(x,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories:"})}),s.jsxs(Rs,{triggerButton:s.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm transition-colors "+(t.selectedRepos&&t.selectedRepos.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[s.jsx("span",{children:f}),s.jsx(cs,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[s.jsx("div",{className:"p-2.5",children:s.jsx(vt.InputItem,{autoFocus:!0,holdFocus:!0,value:l,onChange:g=>i(g.target.value),placeholder:e.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"}),"aria-label":e.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"})})}),t.recommendedOnly?null:s.jsx(vt.MultiSelectCheckboxItem,{checked:!(t.selectedRepos&&t.selectedRepos.size>0),onCheckedChange:()=>a(fe(G({},t),{selectedRepos:new Set,selectedRepo:"all"})),children:e.formatMessage({id:"aardvark.filter.allRepos",defaultMessage:"All repos"})}),r.filter(g=>l?"".concat(g.label," ").concat(g.value).toLowerCase().includes(l.toLowerCase()):!0).map(g=>{var m;return s.jsx(vt.MultiSelectCheckboxItem,{checked:!!((m=t.selectedRepos)!=null&&m.has(g.value)),onCheckedChange:()=>{var u,p;const d=new Set(t.selectedRepos);if(d.has(g.value)?d.delete(g.value):(t.recommendedOnly&&d.clear(),d.add(g.value)),t.recommendedOnly){if(d.size===0){const v=(p=(u=r[0])==null?void 0:u.value)!=null?p:"";v&&d.add(v)}else if(d.size>1){const[v]=Array.from(d);d.clear(),v&&d.add(v)}}a(fe(G({},t),{selectedRepos:d,selectedRepo:d.size===1?Array.from(d)[0]:"all"}))},children:g.label},g.value)})]})]})]})}function ms(e){var t;return(t=e.created_at)!=null?t:null}function Sa(e){var t,a;return(a=(t=e.commit_analysis)==null?void 0:t.committer_date)!=null?a:null}function us(e,t){return e?e.length<=t?e:e.slice(0,t-1)+"…":""}const Ca=ye(()=>be(()=>import("./dwgk7r4s1fwn35jq.js"),__vite__mapDeps([5,1])),{loading:e=>ke(e)}),fs=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zv),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)}),_a=ye(()=>be(()=>import("./jx5pd8qsxc77tbjo.js"),__vite__mapDeps([6,1])),{loading:e=>ke(e)}),Ne="items-center h-full min-h-14",Vt=2;function Ra(){"use forget";var Qe,We,Ke,Ye,Xe,Je;const e=Ce.c(102),t=oe(),a=at(),r=Ve(),n=De();let l;e[0]!==n.search?(l=new URLSearchParams(n.search),e[0]=n.search,e[1]=l):l=e[1];const i=l;let c;e[2]!==i?(c=((Qe=i.get("limit"))!=null?Qe:"").toLowerCase(),e[2]=i,e[3]=c):c=e[3];const h=c;let o;e[4]!==i?(o=i.get("cursor"),e[4]=i,e[5]=o):o=e[5];const f=o,y=new Set(["10","20","50","100"]);let g;e[6]!==h?(g=Number.isFinite(Number(h))?Math.max(50,Number(h)):50,e[6]=h,e[7]=g):g=e[7];const m=g,d=f?Number(f):NaN;let u;e[8]!==d?(u=Number.isFinite(d)?Math.max(0,d):0,e[8]=d,e[9]=u):u=e[9];const p=u,v=Number(y.has(h)?h:"50");let b;e[10]!==p||e[11]!==m?(b={limit:m,cursor:p},e[10]=p,e[11]=m,e[12]=b):b=e[12];const w=Ds(n.search,b);let j,N;e[13]!==w.error||e[14]!==t||e[15]!==a?(j=()=>{if(w.error){const A=t.formatMessage($e.findingsLoad,{details:w.error.message});a.danger(A)}},N=[w.error,t,a],e[13]=w.error,e[14]=t,e[15]=a,e[16]=j,e[17]=N):(j=e[16],N=e[17]),_.useEffect(j,N);let C;e[18]!==((We=w.data)==null?void 0:We.items)?(C=(Ye=(Ke=w.data)==null?void 0:Ke.items)!=null?Ye:[],e[18]=(Xe=w.data)==null?void 0:Xe.items,e[19]=C):C=e[19];const F=C,I=(Je=w.data)==null?void 0:Je.total,k=typeof I=="number"?I:F.length,M=p,L=w.isLoading,S=Math.max(1,Math.ceil(k/v)),P=Math.min(Math.max(1,Math.floor(M/v)+1),S);let V;e[20]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx(Ma,{}),e[20]=V):V=e[20];let z;e[21]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx(R.HeaderCell,{className:"w-10 pe-2 text-end text-sm",children:s.jsx(x,{id:"aardvark.findings.number",defaultMessage:"#"})}),e[21]=z):z=e[21];let H;e[22]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.table.repoHeader",defaultMessage:"Repository"})}),e[22]=H):H=e[22];let J;e[23]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(x,{id:"aardvark.table.pathHeader",defaultMessage:"Directories"})}),e[23]=J):J=e[23];let K;e[24]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(Ia,{})}),e[24]=K):K=e[24];let ge;e[25]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(x,{id:"aardvark.table.vulnerability",defaultMessage:"Vulnerability"})}),e[25]=ge):ge=e[25];let Y;e[26]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(R.HeaderCell,{className:"w-16 text-center text-sm",children:s.jsx("span",{className:"inline-flex items-center justify-center gap-1",children:s.jsx(x,{id:"aardvark.table.validated",defaultMessage:"Validated"})})}),e[26]=Y):Y=e[26];let ae;e[27]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(x,{id:"aardvark.table.statusHeader",defaultMessage:"Status"})}),e[27]=ae):ae=e[27];let Q;e[28]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(x,{id:"aardvark.table.assigneeHeader",defaultMessage:"Assignee"})}),e[28]=Q):Q=e[28];let W;e[29]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(Ut,{field:"commit_date",messageDescriptorId:"committedAtHeader"})}),e[29]=W):W=e[29];let B;e[30]===Symbol.for("react.memo_cache_sentinel")?(B=s.jsxs(R.Header,{children:[z,H,J,K,ge,Y,ae,Q,W,s.jsx(R.HeaderCell,{className:"text-sm",children:s.jsx(Ut,{field:"date",messageDescriptorId:"detectedAtHeader"})}),s.jsx(R.HeaderCell,{className:"text-sm"})]}),e[30]=B):B=e[30];let q;e[31]!==t||e[32]!==L||e[33]!==n.search||e[34]!==r||e[35]!==F||e[36]!==M?(q=L?s.jsx(R.Row,{children:s.jsx(R.Cell,{colSpan:11,divClassName:Ne,children:s.jsx("div",{className:"flex h-full w-full items-center justify-center",children:s.jsx(ut,{className:"text-token-text-tertiary h-6 w-6"})})})}):F.length===0?s.jsx(R.Row,{children:s.jsx(R.Cell,{colSpan:11,divClassName:Ne,children:s.jsx(x,{id:"aardvark.table.emptyFindings",defaultMessage:"No findings"})})}):F.map((A,O)=>{var Ct,_t,Rt,At,Pt,Lt,Et,It,Ft,Ot;const ee=(_t=(Ct=A.hid)!=null?Ct:A.id)!=null?_t:"",Ie=Bs(A),Ze=Ie.slice(0,Vt),Fe=Ie.length>Vt,Te=Sa(A),Ue=ms(A),qe=Te&&Te.trim().length>0?new Date(Te):null,et=Ue&&Ue.trim().length>0?new Date(Ue):null;return s.jsxs(R.Row,{className:"group/row hover:bg-token-bg-tertiary min-h-14 cursor-pointer px-2 text-sm",onClick:()=>{ee&&r("/aardvark/findings/".concat(encodeURIComponent(ee)).concat(n.search||""))},children:[s.jsx(R.Cell,{divClassName:ie(Ne,"justify-end pe-2 text-token-text-tertiary tabular-nums"),children:M+O+1}),s.jsx(R.Cell,{divClassName:ie(Ne,"ps-2"),children:ft((Rt=A.repo_url)!=null?Rt:"")||t.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})}),s.jsx(R.Cell,{divClassName:ie(Ne),children:s.jsx(As,{label:Ie.join("\n"),children:s.jsxs("div",{className:"my-2 flex max-w-[12rem] min-w-0 flex-wrap gap-2",children:[Ze.map(Tt=>s.jsx("span",{className:"bg-token-main-surface-secondary/70 text-token-text-secondary rounded-lg px-2 py-0.5 text-xs break-all",children:Tt},"".concat(Tt.toLowerCase(),"-").concat(O))),Fe&&s.jsx("span",{className:"bg-token-main-surface-secondary/70 text-token-text-secondary rounded-lg px-2 py-0.5 text-xs break-all",children:s.jsx(x,{id:"aardvark.table.more",defaultMessage:"..."})})]})})}),s.jsx(R.Cell,{divClassName:Ne,children:s.jsx(St,{level:A.criticality})}),s.jsx(R.Cell,{divClassName:ie(Ne,"max-w-100 pt-3 pb-3"),children:s.jsx("span",{className:"text-start",title:(Pt=(At=A.commit_analysis)==null?void 0:At.description)!=null?Pt:"",children:us((Ft=(It=(Lt=A.commit_analysis)==null?void 0:Lt.title)!=null?It:(Et=A.commit_analysis)==null?void 0:Et.description)!=null?Ft:"",140)})}),s.jsx(R.Cell,{divClassName:ie(Ne,"justify-center"),children:(Ot=A.commit_analysis)!=null&&Ot.validated?s.jsxs(s.Fragment,{children:[s.jsx(_a,{className:"icon-sm","aria-hidden":!0}),s.jsx("span",{className:"sr-only",children:s.jsx(x,{id:"aardvark.findings.validated.sr",defaultMessage:"Validated finding"})})]}):s.jsx("span",{className:"text-token-text-tertiary text-sm",children:s.jsx(x,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})}),s.jsx(R.Cell,{divClassName:Ne,children:s.jsx("div",{onClick:Ea,children:s.jsx(es,{finding:A})})}),s.jsx(R.Cell,{divClassName:Ne,children:s.jsx("div",{onClick:La,children:s.jsx(ts,{finding:A})})}),s.jsx(R.Cell,{divClassName:Ne,children:qe?s.jsxs(s.Fragment,{children:[s.jsx(it,{value:qe,year:"numeric",month:"long",day:"numeric"}),s.jsx("span",{className:"text-token-text-tertiary ms-2",children:s.jsx(ot,{value:qe,hour:"numeric",minute:"2-digit"})})]}):s.jsx(x,{id:"aardvark.placeholder.missing",defaultMessage:"—"})}),s.jsx(R.Cell,{divClassName:Ne,children:et?s.jsxs(s.Fragment,{children:[s.jsx(it,{value:et,year:"numeric",month:"long",day:"numeric"}),s.jsx("span",{className:"text-token-text-tertiary ms-2",children:s.jsx(ot,{value:et,hour:"numeric",minute:"2-digit"})})]}):s.jsx(x,{id:"aardvark.placeholder.missing",defaultMessage:"—"})}),s.jsx(R.Cell,{divClassName:Ne,children:s.jsxs(kt,{to:ee?"/aardvark/findings/".concat(encodeURIComponent(ee)).concat(n.search||""):"#",onClick:Pa,className:ie("inline-flex items-center gap-1",ee?"text-token-text-accent hover:underline":"text-token-text-tertiary pointer-events-none"),children:[s.jsx(x,{id:"aardvark.table.viewButton",defaultMessage:"View"}),s.jsx(Ca,{className:"icon-sm","aria-hidden":!0})]})})]},"".concat(ee||"finding","-").concat(O))}),e[31]=t,e[32]=L,e[33]=n.search,e[34]=r,e[35]=F,e[36]=M,e[37]=q):q=e[37];let U;e[38]!==q?(U=s.jsxs(R.Root,{className:"overflow-x-auto",disableScroll:!0,children:[B,s.jsx(R.Body,{children:q})]}),e[38]=q,e[39]=U):U=e[39];const Z="border-token-border-light bg-token-bg-primary mt-3 flex items-center justify-between border-t px-3 py-2 ".concat(L?"animate-pulse blur-[1px]":""),re=F.length===0?0:M+1,te=F.length===0?0:Math.min(M+F.length,k);let xe;e[40]!==re||e[41]!==te||e[42]!==k?(xe=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.findings.range",defaultMessage:"{from}-{to} of {total} results",values:{from:re,to:te,total:k}})}),e[40]=re,e[41]=te,e[42]=k,e[43]=xe):xe=e[43];let he;e[44]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"rows-per-page",children:s.jsx(x,{id:"aardvark.pagination.rowsPerPage",defaultMessage:"Rows per page"})}),e[44]=he):he=e[44];const pe=String(v);let E;e[45]!==n.search||e[46]!==r?(E=A=>{const O=new URLSearchParams(n.search);O.set("limit",A),O.set("cursor","0"),r({search:"?".concat(O.toString())},{replace:!0})},e[45]=n.search,e[46]=r,e[47]=E):E=e[47];let D;e[48]===Symbol.for("react.memo_cache_sentinel")?(D=[{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],e[48]=D):D=e[48];let $;e[49]!==pe||e[50]!==E?($=s.jsx(Bt,{triggerId:"rows-per-page",triggerClassName:"min-w-[84px]",contentClassName:"!min-w-[84px]",value:pe,onValueChange:E,options:D}),e[49]=pe,e[50]=E,e[51]=$):$=e[51];let _e;e[52]===Symbol.for("react.memo_cache_sentinel")?(_e=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"page-select",children:s.jsx(x,{id:"aardvark.pagination.page",defaultMessage:"Page"})}),e[52]=_e):_e=e[52];const Ae=String(P);let je;e[53]!==n.search||e[54]!==r||e[55]!==S||e[56]!==v?(je=A=>{const O=Math.min(Math.max(1,Number(A)),S),ee=new URLSearchParams(n.search);ee.set("cursor",String((O-1)*v)),r({search:"?".concat(ee.toString())},{replace:!0})},e[53]=n.search,e[54]=r,e[55]=S,e[56]=v,e[57]=je):je=e[57];let de;e[58]!==S?(de=Array.from({length:S},Aa),e[58]=S,e[59]=de):de=e[59];let ne;e[60]!==Ae||e[61]!==je||e[62]!==de?(ne=s.jsx(Bt,{triggerId:"page-select",triggerClassName:"min-w-[72px]",contentClassName:"!min-w-[72px]",value:Ae,onValueChange:je,options:de}),e[60]=Ae,e[61]=je,e[62]=de,e[63]=ne):ne=e[63];let we;e[64]!==S?(we=s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.pagination.of",defaultMessage:"of {count}",values:{count:S}})}),e[64]=S,e[65]=we):we=e[65];let ve;e[66]!==ne||e[67]!==we?(ve=s.jsxs(s.Fragment,{children:[_e,ne,we]}),e[66]=ne,e[67]=we,e[68]=ve):ve=e[68];const Le=L||P<=1;let Re;e[69]!==n.search||e[70]!==r||e[71]!==v||e[72]!==P?(Re=()=>{const A=Math.max(1,P-1),O=new URLSearchParams(n.search);O.set("cursor",String((A-1)*v)),r({search:"?".concat(O.toString())},{replace:!0})},e[69]=n.search,e[70]=r,e[71]=v,e[72]=P,e[73]=Re):Re=e[73];let Pe;e[74]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(x,{id:"aardvark.pagination.prev",defaultMessage:"Previous"}),e[74]=Pe):Pe=e[74];let se;e[75]!==Le||e[76]!==Re?(se=s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:Le,onClick:Re,children:Pe}),e[75]=Le,e[76]=Re,e[77]=se):se=e[77];const ce=L||P>=S;let me;e[78]!==n.search||e[79]!==r||e[80]!==S||e[81]!==v||e[82]!==P?(me=()=>{const A=Math.min(S,P+1),O=new URLSearchParams(n.search);O.set("cursor",String((A-1)*v)),r({search:"?".concat(O.toString())},{replace:!0})},e[78]=n.search,e[79]=r,e[80]=S,e[81]=v,e[82]=P,e[83]=me):me=e[83];let ue;e[84]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(x,{id:"aardvark.pagination.next",defaultMessage:"Next"}),e[84]=ue):ue=e[84];let X;e[85]!==ce||e[86]!==me?(X=s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:ce,onClick:me,children:ue}),e[85]=ce,e[86]=me,e[87]=X):X=e[87];let le;e[88]!==se||e[89]!==X?(le=s.jsxs("div",{className:"flex items-center gap-2",children:[se,X]}),e[88]=se,e[89]=X,e[90]=le):le=e[90];let Me;e[91]!==$||e[92]!==ve||e[93]!==le?(Me=s.jsxs("div",{className:"flex items-center gap-3",children:[he,$,ve,le]}),e[91]=$,e[92]=ve,e[93]=le,e[94]=Me):Me=e[94];let Ee;e[95]!==Z||e[96]!==xe||e[97]!==Me?(Ee=s.jsxs("div",{className:Z,children:[xe,Me]}),e[95]=Z,e[96]=xe,e[97]=Me,e[98]=Ee):Ee=e[98];let Be;return e[99]!==U||e[100]!==Ee?(Be=s.jsxs("div",{className:"mx-auto w-full",children:[V,U,Ee]}),e[99]=U,e[100]=Ee,e[101]=Be):Be=e[101],Be}function Aa(e,t){return{label:String(t+1),value:String(t+1)}}function Pa(e){return e.stopPropagation()}function La(e){return e.stopPropagation()}function Ea(e){return e.stopPropagation()}function Ia(){"use forget";var g,m,d,u;const e=Ce.c(16),t=Ve(),a=De();let r,n,l;if(e[0]!==a.search){const b=((g=new URLSearchParams(a.search).get("sort"))!=null?g:"").split(",").map(Oa).filter(Boolean);n=(m=b.find(Fa))!=null?m:"sev_desc",r=n==="sev_asc",l=(u=(d=b[0])==null?void 0:d.startsWith("sev_"))!=null?u:!0,e[0]=a.search,e[1]=r,e[2]=n,e[3]=l}else r=e[1],n=e[2],l=e[3];const i=l;let c;e[4]!==i||e[5]!==a.search||e[6]!==t||e[7]!==n?(c=()=>{const p=new URLSearchParams(a.search);if(i){const v=n==="sev_desc"?"sev_asc":"sev_desc";p.set("sort","".concat(v,",date_desc"))}else p.set("sort","sev_desc,date_desc");t({search:"?".concat(p.toString())},{replace:!0})},e[4]=i,e[5]=a.search,e[6]=t,e[7]=n,e[8]=c):c=e[8];const h=c;let o;e[9]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(x,{id:"aardvark.table.criticality",defaultMessage:"Criticality"}),e[9]=o):o=e[9];let f;e[10]!==r||e[11]!==i?(f=i?s.jsx(fs,{className:ie("icon-sm text-token-text-tertiary transition-transform",r&&"rotate-180"),"aria-hidden":!0}):null,e[10]=r,e[11]=i,e[12]=f):f=e[12];let y;return e[13]!==f||e[14]!==h?(y=s.jsxs("button",{className:"inline-flex items-center gap-1 hover:underline",onClick:h,children:[o,f]}),e[13]=f,e[14]=h,e[15]=y):y=e[15],y}function Fa(e){return e.startsWith("sev_")}function Oa(e){return e.trim()}function Ut(e){"use forget";var p,v,b,w;const t=Ce.c(20),{field:a,messageDescriptorId:r}=e,n=Ve(),l=De();let i,c,h;if(t[0]!==a||t[1]!==l.search){const C=((p=new URLSearchParams(l.search).get("sort"))!=null?p:"".concat(a,"_desc")).split(",").map(Ta).filter(Boolean);i=(v=C.find(F=>F.startsWith(a)))!=null?v:"".concat(a,"_desc"),c=i==="".concat(a,"_asc"),h=(w=(b=C[0])==null?void 0:b.startsWith(a))!=null?w:!0,t[0]=a,t[1]=l.search,t[2]=i,t[3]=c,t[4]=h}else i=t[2],c=t[3],h=t[4];const o=h;let f;t[5]!==i||t[6]!==a||t[7]!==o||t[8]!==l.search||t[9]!==n?(f=()=>{const j=new URLSearchParams(l.search);if(o){const N=i==="".concat(a,"_desc")?"".concat(a,"_asc"):"".concat(a,"_desc");j.set("sort","".concat(N,",sev_desc"))}else j.set("sort","".concat(a,"_desc,sev_desc"));n({search:"?".concat(j.toString())},{replace:!0})},t[5]=i,t[6]=a,t[7]=o,t[8]=l.search,t[9]=n,t[10]=f):f=t[10];const y=f,g=zs[r];let m;t[11]!==g?(m=s.jsx(x,G({},g)),t[11]=g,t[12]=m):m=t[12];let d;t[13]!==c||t[14]!==o?(d=o?s.jsx(fs,{className:ie("icon-sm text-token-text-tertiary transition-transform",c&&"rotate-180"),"aria-hidden":!0}):null,t[13]=c,t[14]=o,t[15]=d):d=t[15];let u;return t[16]!==m||t[17]!==d||t[18]!==y?(u=s.jsxs("button",{className:"inline-flex items-center gap-1 hover:underline",onClick:y,children:[m,d]}),t[16]=m,t[17]=d,t[18]=y,t[19]=u):u=t[19],u}function Ta(e){return e.trim()}const $a=ye(()=>be(()=>import("./dwgk7r4s1fwn35jq.js"),__vite__mapDeps([5,1])),{loading:e=>ke(e)}),Da=ye(()=>be(()=>import("./jx5pd8qsxc77tbjo.js"),__vite__mapDeps([6,1])),{loading:e=>ke(e)});function Ba(){"use forget";var te,xe,he,pe;const e=Ce.c(55),t=oe(),{filters:a,repoOptions:r,repoOptionsLoading:n,repoScanIdMap:l}=nt(),i=at(),c=De(),h=Ve();let o,f;e[0]!==c.search||e[1]!==h?(o=()=>{const E=new URLSearchParams(c.search);let D=!1;if(E.has("cursor")&&(E.delete("cursor"),D=!0),E.has("limit")&&(E.delete("limit"),D=!0),!D)return;const $=E.toString();h({search:$?"?".concat($):""},{replace:!0})},f=[c.search,h],e[0]=c.search,e[1]=h,e[2]=o,e[3]=f):(o=e[2],f=e[3]),_.useEffect(o,f);let y,g;e[4]!==a.selectedRepos||e[5]!==l?(y=a.selectedRepos&&a.selectedRepos.size>0?Array.from(a.selectedRepos)[0]:null,g=y&&(te=l.get(y))!=null?te:null,e[4]=a.selectedRepos,e[5]=l,e[6]=y,e[7]=g):(y=e[6],g=e[7]);const m=g,{data:d,isLoading:u,error:p}=Hs(m);let v,b;e[8]!==t||e[9]!==p||e[10]!==i?(v=()=>{if(p){const E=t.formatMessage($e.recommendedLoad,{details:p.message});i.danger(E)}},b=[t,p,i],e[8]=t,e[9]=p,e[10]=i,e[11]=v,e[12]=b):(v=e[11],b=e[12]),_.useEffect(v,b);const w=d==null?void 0:d.items;let j;e[13]!==w?(j=w!=null?w:[],e[13]=w,e[14]=j):j=e[14];const N=j,C=d==null?void 0:d.total,F=!n&&!!y&&!m;let I,k;e[15]!==t||e[16]!==F||e[17]!==i?(I=()=>{F&&i.danger(t.formatMessage($e.recommendedMissingScanToast))},k=[t,F,i],e[15]=t,e[16]=F,e[17]=i,e[18]=I,e[19]=k):(I=e[18],k=e[19]),_.useEffect(I,k);let M=null;if(e[20]!==N||e[21]!==M){for(const E of N){const D=E.ranking_end_time,$=typeof D=="number"?D:typeof D=="string"?Number(D):null;$==null||!Number.isFinite($)||(M==null||$>M)&&(M=$)}e[20]=N,e[21]=M,e[22]=M}else M=e[22];const L=M;let S;e:{if(L==null){S=null;break e}const E=L*1e3;if(!Number.isFinite(E)){S=null;break e}let D,$;if(e[23]!==E?(D=new Date(E),$=Number.isNaN(D.getTime()),e[23]=E,e[24]=D,e[25]=$):(D=e[24],$=e[25]),$){S=null;break e}S=D}const P=S;let V;if(e[26]!==a.selectedRepos||e[27]!==r){e:{const[E]=Array.from((xe=a.selectedRepos)!=null?xe:[]);if(!E){V="";break e}const D=r.find($=>$.value===E);V=(pe=(he=D==null?void 0:D.label)!=null?he:ft(E))!=null?pe:E}e[26]=a.selectedRepos,e[27]=r,e[28]=V}else V=e[28];const z=V;let H;e[29]!==N?(H=N.slice(0,10),e[29]=N,e[30]=H):H=e[30];const J=H;let K;e[31]!==t?(K=t.formatMessage({id:"aardvark.recommended.heading.targetAll",defaultMessage:"all repositories"}),e[31]=t,e[32]=K):K=e[32];const Y=z||K,ae=J.length;if(F){let E;return e[33]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:s.jsx(x,G({},$e.recommendedMissingScan))})}),e[33]=E):E=e[33],E}if(n||u){let E;return e[34]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary flex min-h-[240px] items-center justify-center rounded-2xl border",children:s.jsx(ut,{className:"text-token-text-tertiary h-6 w-6"})})}),e[34]=E):E=e[34],E}if(J.length===0){let E;return e[35]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:s.jsx(x,{id:"aardvark.recommended.empty",defaultMessage:"No recommended findings right now"})})}),e[35]=E):E=e[35],E}let Q;e[36]!==Y?(Q=s.jsx("div",{className:"space-y-2",children:s.jsx("h3",{className:"text-token-text-primary text-xl leading-7 font-semibold",children:s.jsx(x,{id:"aardvark.recommended.heading.top",defaultMessage:"Aardvark Top {count} for {repo}",values:{count:10,repo:Y}})})}),e[36]=Y,e[37]=Q):Q=e[37];let W;e[38]!==P?(W=P?s.jsx("div",{className:"text-token-text-tertiary text-xs sm:text-sm",children:s.jsx(x,{id:"aardvark.recommended.updated",defaultMessage:"Updated {date} at {time}",values:{date:s.jsx(it,{value:P,year:"numeric",month:"long",day:"numeric"}),time:s.jsx(ot,{value:P,hour:"numeric",minute:"2-digit"})}})}):null,e[38]=P,e[39]=W):W=e[39];let B;e[40]!==Q||e[41]!==W?(B=s.jsxs("header",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[Q,W]}),e[40]=Q,e[41]=W,e[42]=B):B=e[42];let q;e[43]!==J?(q=J.map(za),e[43]=J,e[44]=q):q=e[44];let U;e[45]!==q?(U=s.jsx("ol",{className:"flex flex-col gap-4",children:q}),e[45]=q,e[46]=U):U=e[46];let Z;e[47]!==C||e[48]!==z||e[49]!==ae?(Z=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:C?z?s.jsx(x,{id:"aardvark.recommended.range.forRepo",defaultMessage:"Showing top {count} findings for {repo}",values:{count:ae,repo:z}}):s.jsx(x,{id:"aardvark.recommended.range",defaultMessage:"Showing top {count} recommended findings",values:{count:ae}}):z?s.jsx(x,{id:"aardvark.recommended.range.forRepo.noTotal",defaultMessage:"Showing top {count} findings for {repo}",values:{count:ae,repo:z}}):s.jsx(x,{id:"aardvark.recommended.range.noTotal",defaultMessage:"Showing top {count} recommended findings",values:{count:ae}})}),e[47]=C,e[48]=z,e[49]=ae,e[50]=Z):Z=e[50];let re;return e[51]!==B||e[52]!==U||e[53]!==Z?(re=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsxs("div",{className:"flex flex-col gap-5",children:[B,U,Z]})}),e[51]=B,e[52]=U,e[53]=Z,e[54]=re):re=e[54],re}function za(e,t){return s.jsx(Ha,{finding:e,index:t,baseIndex:0},"".concat(e.hid,"-").concat(t))}function Ha(e){"use forget";var re,te,xe,he,pe,E,D,$,_e,Ae;const t=Ce.c(102),{finding:a,index:r,baseIndex:n}=e,l=oe(),i=Ve(),c=De();let h;t[0]!==a.repo_url||t[1]!==l?(h=ft((re=a.repo_url)!=null?re:"")||l.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"}),t[0]=a.repo_url,t[1]=l,t[2]=h):h=t[2];const o=h;let f,y,g,m,d,u,p,v,b,w,j,N,C,F,I,k,M,L,S;if(t[3]!==n||t[4]!==a||t[5]!==r||t[6]!==l||t[7]!==c.search||t[8]!==i||t[9]!==o){const je=(pe=(he=(te=a.commit_analysis)==null?void 0:te.title)!=null?he:(xe=a.commit_analysis)==null?void 0:xe.description)!=null?pe:l.formatMessage({id:"aardvark.recommended.missingTitle",defaultMessage:"Untitled finding"}),de=(D=(E=a.commit_analysis)==null?void 0:E.description)!=null?D:"",ne=typeof a.ranking_reason=="string"?a.ranking_reason:void 0;let we;t[29]!==de||t[30]!==ne?(we=ne&&ne.trim().length>0?ne:de,t[29]=de,t[30]=ne,t[31]=we):we=t[31];const ve=we,Le=ms(a),Re=n+r+1;let Pe;t[32]!==a.hid||t[33]!==c.search||t[34]!==i?(Pe=()=>{i("/aardvark/findings/".concat(encodeURIComponent(a.hid)).concat(c.search||""))},t[32]=a.hid,t[33]=c.search,t[34]=i,t[35]=Pe):Pe=t[35];const se=Pe;let ce;t[36]!==se?(ce=Me=>{(Me.key==="Enter"||Me.key===" ")&&(Me.preventDefault(),se())},t[36]=se,t[37]=ce):ce=t[37];const me=ce;u="button",p=0,v=l.formatMessage({id:"aardvark.recommended.card.ariaLabel",defaultMessage:"View details for {title}"},{title:je}),b=se,w=me,N="border-token-border-light/70 bg-token-main-surface-secondary/40 hover:border-token-border-strong hover:bg-token-main-surface-tertiary focus-visible:border-token-border-strong focus-visible:ring-token-border-strong dark:bg-token-main-surface-secondary/70 group/card flex cursor-pointer flex-col gap-4 rounded-2xl border px-4 py-4 shadow-md transition-all hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:outline-none",d="flex flex-col gap-4 lg:flex-row lg:items-start",g="flex flex-1 gap-4",t[38]!==Re?(m=s.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-primary border-token-border-light flex h-9 w-9 shrink-0 items-center justify-center rounded-full border text-sm font-semibold",children:Re}),t[38]=Re,t[39]=m):m=t[39],L="min-w-0 flex-1 space-y-3";let ue;t[40]!==a.criticality?(ue=s.jsx(St,{level:a.criticality}),t[40]=a.criticality,t[41]=ue):ue=t[41];let X;t[42]!==(($=a.commit_analysis)==null?void 0:$.validated)?(X=(_e=a.commit_analysis)!=null&&_e.validated?s.jsxs("span",{className:"bg-token-main-surface-secondary text-token-text-primary inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-medium",children:[s.jsx(Da,{className:"h-3 w-3","aria-hidden":!0}),s.jsx(x,{id:"aardvark.recommended.validated",defaultMessage:"Validated"})]}):null,t[42]=(Ae=a.commit_analysis)==null?void 0:Ae.validated,t[43]=X):X=t[43],t[44]!==ue||t[45]!==X?(S=s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ue,X]}),t[44]=ue,t[45]=X,t[46]=S):S=t[46],t[47]!==je?(f=s.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:je}),t[47]=je,t[48]=f):f=t[48],t[49]!==ve?(y=ve?s.jsx("p",{className:"text-token-text-secondary text-sm leading-6",children:us(ve,260)}):null,t[49]=ve,t[50]=y):y=t[50],k="mt-1 flex flex-wrap gap-x-6 gap-y-2 text-xs";let le;t[51]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(x,{id:"aardvark.recommended.meta.repo",defaultMessage:"Repository:"})}),t[51]=le):le=t[51],t[52]!==o?(M=s.jsxs("div",{className:"flex gap-1",children:[le,s.jsx("dd",{className:"text-token-text-primary",children:o})]}),t[52]=o,t[53]=M):M=t[53],F="flex gap-1",t[54]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(x,{id:"aardvark.recommended.meta.detected",defaultMessage:"Detected:"})}),t[54]=I):I=t[54],j="text-token-text-primary",C=Le?s.jsxs(s.Fragment,{children:[s.jsx(it,{value:new Date(Le),year:"numeric",month:"long",day:"numeric"}),s.jsx("span",{className:"ms-1",children:s.jsx(ot,{value:new Date(Le),hour:"numeric",minute:"2-digit"})})]}):s.jsx(x,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),t[3]=n,t[4]=a,t[5]=r,t[6]=l,t[7]=c.search,t[8]=i,t[9]=o,t[10]=f,t[11]=y,t[12]=g,t[13]=m,t[14]=d,t[15]=u,t[16]=p,t[17]=v,t[18]=b,t[19]=w,t[20]=j,t[21]=N,t[22]=C,t[23]=F,t[24]=I,t[25]=k,t[26]=M,t[27]=L,t[28]=S}else f=t[10],y=t[11],g=t[12],m=t[13],d=t[14],u=t[15],p=t[16],v=t[17],b=t[18],w=t[19],j=t[20],N=t[21],C=t[22],F=t[23],I=t[24],k=t[25],M=t[26],L=t[27],S=t[28];let P;t[55]!==j||t[56]!==C?(P=s.jsx("dd",{className:j,children:C}),t[55]=j,t[56]=C,t[57]=P):P=t[57];let V;t[58]!==P||t[59]!==F||t[60]!==I?(V=s.jsxs("div",{className:F,children:[I,P]}),t[58]=P,t[59]=F,t[60]=I,t[61]=V):V=t[61];let z;t[62]!==V||t[63]!==k||t[64]!==M?(z=s.jsxs("dl",{className:k,children:[M,V]}),t[62]=V,t[63]=k,t[64]=M,t[65]=z):z=t[65];let H;t[66]!==f||t[67]!==y||t[68]!==z||t[69]!==L||t[70]!==S?(H=s.jsxs("div",{className:L,children:[S,f,y,z]}),t[66]=f,t[67]=y,t[68]=z,t[69]=L,t[70]=S,t[71]=H):H=t[71];let J;t[72]!==g||t[73]!==m||t[74]!==H?(J=s.jsxs("div",{className:g,children:[m,H]}),t[72]=g,t[73]=m,t[74]=H,t[75]=J):J=t[75];let K;t[76]!==a?(K=s.jsx("div",{onClick:qa,children:s.jsx(es,{finding:a})}),t[76]=a,t[77]=K):K=t[77];let ge;t[78]!==a?(ge=s.jsx("div",{onClick:Ua,children:s.jsx(ts,{finding:a})}),t[78]=a,t[79]=ge):ge=t[79];let Y;t[80]!==K||t[81]!==ge?(Y=s.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:[K,ge]}),t[80]=K,t[81]=ge,t[82]=Y):Y=t[82];const ae="/aardvark/findings/".concat(encodeURIComponent(a.hid)).concat(c.search||"");let Q,W;t[83]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(x,{id:"aardvark.table.viewButton",defaultMessage:"View"}),W=s.jsx($a,{className:"icon-sm","aria-hidden":!0}),t[83]=Q,t[84]=W):(Q=t[83],W=t[84]);let B;t[85]!==ae?(B=s.jsx("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:s.jsxs(kt,{to:ae,onClick:Va,className:"text-token-text-accent inline-flex items-center gap-1 text-sm font-medium hover:underline",children:[Q,W]})}),t[85]=ae,t[86]=B):B=t[86];let q;t[87]!==Y||t[88]!==B?(q=s.jsxs("div",{className:"flex w-full flex-col gap-3 lg:max-w-[260px] lg:items-end",children:[Y,B]}),t[87]=Y,t[88]=B,t[89]=q):q=t[89];let U;t[90]!==d||t[91]!==J||t[92]!==q?(U=s.jsxs("div",{className:d,children:[J,q]}),t[90]=d,t[91]=J,t[92]=q,t[93]=U):U=t[93];let Z;return t[94]!==u||t[95]!==p||t[96]!==v||t[97]!==b||t[98]!==w||t[99]!==N||t[100]!==U?(Z=s.jsx("li",{children:s.jsx("article",{role:u,tabIndex:p,"aria-label":v,onClick:b,onKeyDown:w,className:N,children:U})}),t[94]=u,t[95]=p,t[96]=v,t[97]=b,t[98]=w,t[99]=N,t[100]=U,t[101]=Z):Z=t[101],Z}function Va(e){return e.stopPropagation()}function Ua(e){return e.stopPropagation()}function qa(e){return e.stopPropagation()}const Ga=ye(()=>be(()=>import("./d0fvtivu8wtjjx2a.js"),__vite__mapDeps([7,1])),{loading:e=>ke(e)});function Qa(){"use forget";var I;const e=Ce.c(33),t=De(),a=Ve();let r;e[0]!==t.search?(r=new URLSearchParams(t.search),e[0]=t.search,e[1]=r):r=e[1];const n=r;let l;e[2]!==n?(l=n.get("recommended"),e[2]=n,e[3]=l):l=e[3];const i=l==="true";let c;if(e[4]!==t.search){const k=new URLSearchParams(t.search),M=["repo","status","criticality","assignee","author","validated","path_prefix","q"],L={};for(const S of M)L[S]=(I=k.get(S))!=null?I:"";c=JSON.stringify(L),e[4]=t.search,e[5]=c}else c=e[5];const h=c,o=_.useRef(h);let f,y;e[6]!==h||e[7]!==t.search||e[8]!==a||e[9]!==n?(f=()=>{if(o.current!==h){const k=new URLSearchParams(t.search);k.set("cursor","0"),k.toString()!==n.toString()&&a({search:"?".concat(k.toString())},{replace:!0})}o.current=h},y=[h,a,t.search,n],e[6]=h,e[7]=t.search,e[8]=a,e[9]=n,e[10]=f,e[11]=y):(f=e[10],y=e[11]),_.useEffect(f,y);let g,m;e[12]!==t.search||e[13]!==a?(g=()=>{const k=new URLSearchParams(t.search),M=k.get("finding");if(!M)return;k.delete("finding");const L=k.toString(),S=L?"?".concat(L):"";a("/aardvark/findings/".concat(encodeURIComponent(M)).concat(S),{replace:!0})},m=[t.search,a],e[12]=t.search,e[13]=a,e[14]=g,e[15]=m):(g=e[14],m=e[15]),_.useEffect(g,m);let d;e[16]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.home.findings",defaultMessage:"Manage findings"})}),e[16]=d):d=e[16];let u;e[17]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(Ga,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),e[17]=u):u=e[17];let p;e[18]!==t.search||e[19]!==a?(p=k=>{var L;k.preventDefault(),a({search:t.search,hash:"#configurescans-connected-repos"},{replace:!1});const M=typeof globalThis<"u"?(L=globalThis.document)==null?void 0:L.getElementById("connected-repos"):null;if(M)try{M.scrollIntoView({behavior:"smooth",block:"start"})}catch(S){}},e[18]=t.search,e[19]=a,e[20]=p):p=e[20];let v;e[21]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsx(x,{id:"aardvark.findings.configured.link",defaultMessage:"connected repos"}),e[21]=v):v=e[21];let b;e[22]!==p?(b=s.jsx("div",{role:"note",className:"border-token-border-light/60 bg-token-bg-tertiary/50 flex flex-col gap-2 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",children:s.jsx("div",{className:"text-token-text-secondary flex items-start gap-3 text-sm leading-6",children:s.jsxs("div",{className:"flex items-center gap-x-2",children:[u,s.jsx("p",{className:"m-0",children:s.jsx("span",{className:"text-token-text-primary",children:s.jsx(x,{id:"aardvark.findings.configured.notice",defaultMessage:"Only showing findings from repositories you can access and have connected. View all {link}.",values:{link:s.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:p,children:v})}})})})]})})}),e[22]=p,e[23]=b):b=e[23];let w,j;e[24]===Symbol.for("react.memo_cache_sentinel")?(w=s.jsx("div",{className:"mt-3 flex w-full flex-wrap items-center justify-center gap-3",children:s.jsx(Wa,{})}),j=s.jsx(Na,{}),e[24]=w,e[25]=j):(w=e[24],j=e[25]);let N;e[26]!==b?(N=s.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[d,b,w,j]}),e[26]=b,e[27]=N):N=e[27];let C;e[28]!==i?(C=s.jsx("div",{children:i?s.jsx(Ba,{}):s.jsx(Ra,{})}),e[28]=i,e[29]=C):C=e[29];let F;return e[30]!==N||e[31]!==C?(F=s.jsx("section",{className:"mt-8",children:s.jsx(ea,{children:s.jsxs("div",{className:"mx-auto w-full",children:[N,C]})})}),e[30]=N,e[31]=C,e[32]=F):F=e[32],F}function Wa(){"use forget";const e=Ce.c(25),{filters:t,onChangeFilters:a,repoOptions:r}=nt();let n;e[0]!==t||e[1]!==a||e[2]!==r?(n=j=>{var F,I;if(j===t.recommendedOnly)return;let N=new Set(t.selectedRepos);if(j){const k=(I=(F=r[0])==null?void 0:F.value)!=null?I:"";if(N.size===0)k&&(N=new Set([k]));else if(N.size>1){const[M]=Array.from(N),L=M&&M.trim().length>0?M:k;N=L&&L.trim().length>0?new Set([L]):new Set}else{const[M]=Array.from(N);M&&!r.some(L=>L.value===M)&&k&&(N=new Set([k]))}}else N=new Set;const C=j?fe(G({},t),{selectedCriticalities:new Set,selectedStatuses:new Set,selectedPathPrefixes:new Set,selectedAssignees:new Set,selectedAuthors:new Set,keywordQuery:"",validationFilter:"all"}):t;a(fe(G({},C),{recommendedOnly:j,selectedRepos:N,selectedRepo:N.size===1?Array.from(N)[0]:"all"}))},e[0]=t,e[1]=a,e[2]=r,e[3]=n):n=e[3];const l=n,i=t.recommendedOnly?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary";let c;e[4]!==i?(c=ie("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-token-outline-primary",i),e[4]=i,e[5]=c):c=e[5];const h=c,o=t.recommendedOnly?"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary":"bg-token-main-surface-secondary text-token-text-primary shadow-sm";let f;e[6]!==o?(f=ie("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible-outline-2 focus-visible-outline-offset-2 focus-visible-outline-token-outline-primary",o),e[6]=o,e[7]=f):f=e[7];const y=f;let g;e[8]!==l?(g=()=>l(!0),e[8]=l,e[9]=g):g=e[9];let m;e[10]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx(x,{id:"aardvark.filter.recommended",defaultMessage:"Recommended findings"}),e[10]=m):m=e[10];let d;e[11]!==t.recommendedOnly||e[12]!==h||e[13]!==g?(d=s.jsx("button",{type:"button","aria-pressed":t.recommendedOnly,className:h,onClick:g,children:m}),e[11]=t.recommendedOnly,e[12]=h,e[13]=g,e[14]=d):d=e[14];const u=!t.recommendedOnly;let p;e[15]!==l?(p=()=>l(!1),e[15]=l,e[16]=p):p=e[16];let v;e[17]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsx(x,{id:"aardvark.filter.allFindings",defaultMessage:"All findings"}),e[17]=v):v=e[17];let b;e[18]!==y||e[19]!==u||e[20]!==p?(b=s.jsx("button",{type:"button","aria-pressed":u,className:y,onClick:p,children:v}),e[18]=y,e[19]=u,e[20]=p,e[21]=b):b=e[21];let w;return e[22]!==b||e[23]!==d?(w=s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary inline-flex items-center gap-1 rounded-lg border px-1 py-1 shadow-sm",children:[d,b]}),e[22]=b,e[23]=d,e[24]=w):w=e[24],w}const qt=14;function gs(e){return e===void 0||typeof e=="number"&&Number.isFinite(e)&&e>=0&&e<=90}function Ka({value:e,onChange:t,isSaving:a}){const r=oe(),n=gs(e);return s.jsxs("div",{className:"grid w-full grid-cols-[1fr,auto] grid-rows-[auto,auto] gap-x-4 gap-y-1 ".concat(a?"pointer-events-none opacity-60":""),children:[s.jsx("label",{className:"col-start-1 row-start-1 justify-self-start text-start text-sm font-medium",children:s.jsx(x,{id:"aardvark.whamRepos.lookbackDays",defaultMessage:"Lookback window"})}),s.jsx("div",{className:"text-token-text-tertiary col-start-1 row-start-2 justify-self-start text-start text-[11px]",children:s.jsx(x,{id:"aardvark.whamRepos.lookbackDays.help",defaultMessage:"How far back to scan existing commits when first enabled."})}),s.jsxs("div",{className:"col-start-2 row-span-2 flex flex-col items-end gap-2 self-center justify-self-end",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:r.formatMessage({id:"aardvark.whamRepos.preset.1w",defaultMessage:"1w"}),value:7},{label:r.formatMessage({id:"aardvark.whamRepos.preset.2w",defaultMessage:"2w"}),value:14},{label:r.formatMessage({id:"aardvark.whamRepos.preset.1m",defaultMessage:"1m"}),value:30},{label:r.formatMessage({id:"aardvark.whamRepos.preset.3m",defaultMessage:"3m"}),value:90},{label:r.formatMessage({id:"aardvark.whamRepos.preset.indefinite",defaultMessage:"Indefinite"}),value:void 0}].map(l=>{var i;return s.jsx("button",{type:"button",onClick:()=>t(l.value),className:"border-token-border-light rounded-md border px-2 py-1 text-xs "+(e===l.value?"bg-token-main-surface-secondary text-token-text-primary":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:l.label},String((i=l.value)!=null?i:"indefinite"))})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"number",value:e!=null?e:"",placeholder:e===void 0?r.formatMessage({id:"aardvark.whamRepos.preset.placeholder.indefinite",defaultMessage:"Indefinite"}):void 0,onChange:l=>{const i=l.target.value;if(i===""||i==="indefinite"){t(void 0);return}const c=parseInt(i,10);Number.isFinite(c)&&t(c)},"aria-invalid":!n,"aria-describedby":n?void 0:"lookback-error",className:"border-token-border-light bg-token-main-surface-secondary text-token-text-primary w-24 rounded-md border px-2 py-1 text-end text-xs focus:ring-1 focus:outline-none "+(n?"focus:ring-token-border-light":"border-red-500 focus:ring-red-500"),"aria-label":r.formatMessage({id:"aardvark.whamRepos.lookbackDays.input",defaultMessage:"Lookback days"})}),e!==void 0&&s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.whamRepos.lookbackDays.suffix",defaultMessage:"days"})})]}),n?null:s.jsx("div",{id:"lookback-error",className:"self-end text-[11px] text-red-500",children:s.jsx(x,{id:"aardvark.whamRepos.lookbackDays.error",defaultMessage:"Enter a value between 0 and 90."})})]})]})}function Ya(e){"use no forget";var L;const{open:t,onOpenChange:a,repoName:r,repoId:n,repoFullName:l}=e,i=oe(),c=at(),h=rt(),o=Mt(h),f=(L=o==null?void 0:o.authUserId)!=null?L:"",y=o==null?void 0:o.getWorkspaceId(),{environmentId:g,setEnvironmentId:m}=Ks(),{scanMap:d,configIdByRepo:u,configVersionById:p}=gt(y),v=ks(),[b,w]=_.useState(!1),[j,N]=_.useState(!1),[C,F]=_.useState(qt),I=_.useMemo(()=>d.get(n),[d,n]);_.useEffect(()=>{var P,V;if(!t)return;if(w(((P=I==null?void 0:I.state)!=null?P:"disabled")==="enabled"),m((V=I==null?void 0:I.environment_id)!=null?V:null),!I){F(qt);return}const S=I.lookback_days;F(S==null?void 0:S)},[t,I,m]);const k=()=>{a(!1)},M=async()=>{N(!0);try{const S=u.get(n),P=new Nt(jt);if(!S){const H=await P.post("/aardvark/scan_configurations",{headers:dt(),body:{environment_id:g||"env-default",repo_id:n,repo_url:"https://github.com/".concat(l),state:b?"enabled":"disabled",owner_id:f,lookback_days:C!=null?C:null}});if(H.status!==201)throw ct(H.status,H.data);zt(y,H.data,v),a(!1),c.successNeutral(i.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"}));return}const V=p.get(S),z=await P.patch("/aardvark/scan_configurations/{id}",{headers:dt(),path:{id:S},body:{version:V,state:b?"enabled":"disabled",owner_id:b?f:void 0,environment_id:g,lookback_days:C!=null?C:null}});if(z.status!==200)throw ct(z.status,z.data);zt(y,z.data,v),a(!1),c.successNeutral(i.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"}))}catch(S){const P=S,V=i.formatMessage($e.scanSettingsSave,{details:P.message});c.danger(V)}finally{N(!1)}};return s.jsxs(ss,{open:t,onOpenChange:a,children:[s.jsx(as,{asChild:!0,children:s.jsx(Se,{as:"button",color:"secondary",size:"small",children:s.jsx(x,{id:"aardvark.whamRepos.configureButton",defaultMessage:"Configure"})})}),s.jsx(rs,{children:s.jsxs(ns,{side:"bottom",align:"end",sideOffset:8,className:"border-token-border-light bg-token-bg-primary z-10 w-[520px] rounded-lg border p-4 shadow-xl",children:[s.jsx("div",{className:"text-token-text-primary mb-3 text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.whamRepos.scanSettingsInlineTitle",defaultMessage:"Scan settings for {repo}",values:{repo:r}})}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-medium",children:s.jsx(x,{id:"aardvark.whamRepos.enabledToggle",defaultMessage:"Enabled"})}),s.jsx(Kt,{checked:b,onCheckedChange:S=>w(S),"aria-hidden":!0,disabled:j})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium",children:s.jsx(x,{id:"aardvark.whamRepos.environment",defaultMessage:"Codex environment"})}),s.jsx("div",{className:j?"pointer-events-none opacity-60":"",children:s.jsx(Us,{showBranchSelector:!1,filters:{repos:[n]},allowRepositorySelection:!1})})]}),s.jsx(Ka,{value:C,onChange:F,isSaving:j}),s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(Se,{color:"secondary",onClick:k,children:s.jsx(x,{id:"aardvark.whamRepos.cancel",defaultMessage:"Cancel"})}),s.jsx(Se,{color:"primary",disabled:j||b&&(!g||!gs(C)),onClick:()=>void M(),children:j?s.jsx(x,{id:"aardvark.whamRepos.saving",defaultMessage:"Saving..."}):s.jsx(x,{id:"aardvark.whamRepos.save",defaultMessage:"Save"})})]})]})]})})]})}const Xa=ye(()=>be(()=>import("./okzsq1aji2s9p1ex.js"),__vite__mapDeps([8,1])),{loading:e=>ke(e)});function Ja({hasGithubConnection:e,openGithubModal:t}){const a=oe();return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{id:"connected-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.whamRepos.connectedSectionTitle",defaultMessage:"Your connected repositories"})}),s.jsx("a",{href:"#configurescans-connected-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":a.formatMessage({id:"aardvark.whamRepos.connectedLinkAria",defaultMessage:"Deep link to connected repositories"}),children:s.jsx(Xa,{className:"icon-sm"})})]}),s.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:s.jsx(x,{id:"aardvark.whamRepos.connectedSectionDescription",defaultMessage:"These are repositories from your GitHub organizations that you’ve connected. You can configure scans for them here. Missing a repo? {link}",values:{link:s.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:r=>{r.preventDefault(),e?window.open("https://github.com/apps/chatgpt-codex-connector/installations/select_target","_blank"):t()},children:s.jsx(x,{id:"aardvark.whamRepos.configureAccess",defaultMessage:"Configure repository access."})})}})})]})}const Za=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zl),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)}),er=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zD),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)}),xs=100;function tr(e){"use forget";var Me,Ee,Be,Qe,We,Ke,Ye,Xe,Je;const t=Ce.c(87),{scanMap:a}=e,r=oe(),{data:n,isLoading:l}=Ys();let i;t[0]!==(n==null?void 0:n.memberships)?(i=(Me=n==null?void 0:n.memberships)!=null?Me:[],t[0]=n==null?void 0:n.memberships,t[1]=i):i=t[1];let c;t[2]!==(n==null?void 0:n.other)?(c=(Ee=n==null?void 0:n.other)!=null?Ee:[],t[2]=n==null?void 0:n.other,t[3]=c):c=t[3];let h;t[4]!==i||t[5]!==c?(h=[...i,...c],t[4]=i,t[5]=c,t[6]=h):h=t[6];const o=h,[f,y]=_.useState(null);let g,m;t[7]!==o||t[8]!==f?(g=()=>{if(o.length===0){y(null);return}(f==null||!o.some(A=>A.id===f))&&y(o[0].id)},m=[o,f],t[7]=o,t[8]=f,t[9]=g,t[10]=m):(g=t[9],m=t[10]),_.useEffect(g,m);const[d,u]=_.useState(""),{openGithubModal:p,error:v}=Yt(Jt.GITHUB_CONNECTOR,"github","/aardvark",Xt.CODEX);let b;t[11]!==f?(b=["aardvark","wham","repositories",f],t[11]=f,t[12]=b):b=t[12];const w=!!f;let j;t[13]!==f?(j=A=>{const{pageParam:O}=A;return Xs.getRepositoriesByInstallationId(f!=null?f:0,O,xs)},t[13]=f,t[14]=j):j=t[14];let N;t[15]!==b||t[16]!==w||t[17]!==j?(N={queryKey:b,enabled:w,initialPageParam:1,queryFn:j,getNextPageParam:or,refetchOnWindowFocus:!0},t[15]=b,t[16]=w,t[17]=j,t[18]=N):N=t[18];const{data:C,isLoading:F,fetchNextPage:I,hasNextPage:k,isFetchingNextPage:M}=js(N);let L;t[19]!==(C==null?void 0:C.pages)?(L=(Be=C==null?void 0:C.pages.flatMap(ir))!=null?Be:[],t[19]=C==null?void 0:C.pages,t[20]=L):L=t[20];const S=L,P=l||F,V=(We=(Qe=n==null?void 0:n.memberships)==null?void 0:Qe.length)!=null?We:0,z=(Ye=(Ke=n==null?void 0:n.other)==null?void 0:Ke.length)!=null?Ye:0,H=V+z>0,J=rt(),K=Mt(J),ge=(Xe=K==null?void 0:K.authUserId)!=null?Xe:"";let Y;t[21]!==d?(Y=A=>A.name.toLowerCase().includes(d.trim().toLowerCase()),t[21]=d,t[22]=Y):Y=t[22];const ae=S.filter(Y);let Q,W;t[23]!==I||t[24]!==k||t[25]!==M||t[26]!==d?(Q=()=>{d.trim()!==""&&k&&!M&&I()},W=[d,k,M,I],t[23]=I,t[24]=k,t[25]=M,t[26]=d,t[27]=Q,t[28]=W):(Q=t[27],W=t[28]),_.useEffect(Q,W);const[B,q]=_.useState(!1);let U;t[29]!==a||t[30]!==B?(U=A=>{var ee;if(!B)return!0;const O=a.get(A.id);return((ee=O==null?void 0:O.state)!=null?ee:"disabled")==="enabled"},t[29]=a,t[30]=B,t[31]=U):U=t[31];const Z=ae.filter(U);let re;if(t[32]!==Z||t[33]!==a){re=[...Z];let A;t[35]!==a?(A=(O,ee)=>{var Fe,Te;const Ie=((Fe=a.get(O.id))==null?void 0:Fe.state)==="enabled",Ze=((Te=a.get(ee.id))==null?void 0:Te.state)==="enabled";return Ie===Ze?O.name.localeCompare(ee.name):Ie?-1:1},t[35]=a,t[36]=A):A=t[36],re.sort(A),t[32]=Z,t[33]=a,t[34]=re}else re=t[34];const te=re,[xe,he]=_.useState(1),pe=Math.max(1,Math.ceil(te.length/5)),E=Math.min(xe,pe),D=(E-1)*5,$=Math.min(D+5,te.length);let _e,Ae;t[37]!==$||t[38]!==I||t[39]!==k||t[40]!==M||t[41]!==S.length?(_e=()=>{$>=S.length&&k&&!M&&I()},Ae=[$,S.length,k,M,I],t[37]=$,t[38]=I,t[39]=k,t[40]=M,t[41]=S.length,t[42]=_e,t[43]=Ae):(_e=t[42],Ae=t[43]),_.useEffect(_e,Ae);const je=te.slice(D,$);let de;t[44]===Symbol.for("react.memo_cache_sentinel")?(de=()=>{he(1)},t[44]=de):de=t[44];let ne;t[45]!==d||t[46]!==f||t[47]!==B?(ne=[d,f,B],t[45]=d,t[46]=f,t[47]=B,t[48]=ne):ne=t[48],_.useEffect(de,ne);const[we,ve]=_.useState(null),Le=A=>ve(A),Re=()=>ve(null),Pe="flex flex-col gap-3";let se;t[49]!==o.length||t[50]!==v||t[51]!==n||t[52]!==P||t[53]!==p?(se=!P&&(n==null||o.length===0)?s.jsx(is,{error:!!v,handleOpenGithubModal:p}):null,t[49]=o.length,t[50]=v,t[51]=n,t[52]=P,t[53]=p,t[54]=se):se=t[54];let ce;t[55]!==o.length||t[56]!==H||t[57]!==n||t[58]!==P||t[59]!==p?(ce=(!n||o.length===0)&&!P?null:s.jsx(Ja,{hasGithubConnection:H,openGithubModal:p}),t[55]=o.length,t[56]=H,t[57]=n,t[58]=P,t[59]=p,t[60]=ce):ce=t[60];let me;t[61]!==o||t[62]!==n||t[63]!==r||t[64]!==P||t[65]!==d||t[66]!==f||t[67]!==q||t[68]!==B?(me=(!n||o.length===0)&&!P?null:s.jsxs("div",{className:"flex flex-row items-end gap-3",children:[s.jsxs("div",{className:"flex w-60 flex-col gap-2",children:[s.jsx("p",{className:"text-token-text-primary text-sm leading-6 font-medium",children:s.jsx(x,{id:"aardvark.whamRepos.githubOrg",defaultMessage:"GitHub organization"})}),s.jsxs(He.Root,{value:(Je=f==null?void 0:f.toString())!=null?Je:"",onValueChange:A=>y(parseInt(A)),disabled:o.length===0,children:[s.jsx(He.Trigger,{className:"border-token-border-heavy bg-token-bg-primary w-60 rounded-md border",children:s.jsxs("div",{className:"flex w-full items-center justify-between",children:[s.jsx("div",{className:"truncate",children:s.jsx(He.Value,{placeholder:r.formatMessage({id:"aardvark.whamRepos.selectOrg",defaultMessage:"Select organization"})})}),s.jsx(He.Icon,{})]})}),s.jsx(He.Portal,{children:s.jsx(He.Content,{align:"start",className:"rounded-lg",children:o.map(lr)})})]})]}),s.jsx("div",{className:"flex-1",children:s.jsx(ls,{color:"search",iconPosition:"left",icon:Za,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:d,onChange:A=>u(A.target.value),placeholder:r.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:r.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})}),s.jsxs("div",{className:"flex h-9 items-center gap-2 self-end whitespace-nowrap",children:[s.jsx(Kt,{checked:B,onCheckedChange:A=>q(A),"aria-label":r.formatMessage({id:"aardvark.whamRepos.toggleShowEnabled",defaultMessage:"Enabled only"})}),s.jsx("span",{className:"text-xs",children:s.jsx(x,{id:"aardvark.whamRepos.showEnabled",defaultMessage:"Enabled only"})})]})]}),t[61]=o,t[62]=n,t[63]=r,t[64]=P,t[65]=d,t[66]=f,t[67]=q,t[68]=B,t[69]=me):me=t[69];const ue=(!n||o.length===0)&&!P?null:s.jsxs(R.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[s.jsxs(R.Header,{children:[s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.settingsHeader",defaultMessage:"Settings"})})]}),s.jsxs(R.Body,{children:[P&&s.jsx(s.Fragment,{children:Array.from({length:5}).map(nr)}),!P&&te.length===0&&s.jsx(R.Row,{children:s.jsx(R.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:s.jsx(x,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}),je.map(A=>{var qe;const O=a.get(A.id),ee=(O==null?void 0:O.state)==="enabled",Ie=(qe=O==null?void 0:O.owner)==null?void 0:qe.email,Ze=Ie||r.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),Fe=!!O,Te=!!(O!=null&&O.owner_id)&&O.owner_id===ge,Ue="https://github.com/"+A.repository_full_name;return s.jsx(s.Fragment,{children:s.jsxs(R.Row,{className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm",children:[s.jsxs(R.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:[s.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(Ue,"_blank"),children:A.name}),s.jsx("a",{href:Ue,target:"_blank",rel:"noopener noreferrer",className:"ms-2 opacity-0 group-hover/row:opacity-100",onClick:rr,children:s.jsx(er,{className:"icon-sm"})})]}),s.jsx(R.Cell,{divClassName:"flex h-14 items-center justify-start gap-3 ps-2",children:s.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(Fe&&ee?"bg-green-500/10 text-green-600":Fe&&!ee?"bg-token-text-status-error/15 text-token-text-status-error":"bg-token-bg-tertiary text-token-text-tertiary"),children:Fe?ee?s.jsx(x,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):s.jsx(x,{id:"aardvark.status.disabled",defaultMessage:"Disabled"}):s.jsx(x,{id:"aardvark.status.unconfigured",defaultMessage:"Unconfigured"})})}),s.jsx(R.Cell,{divClassName:"flex h-14 items-center ps-2",children:!Fe||Te?s.jsx(Ya,{open:we===A.id,onOpenChange:et=>et?Le(A.id):Re(),repoName:A.name,repoId:A.id,repoFullName:A.repository_full_name}):s.jsx("div",{className:"flex flex-col",children:s.jsx("span",{children:s.jsx(x,{id:"aardvark.whamRepos.ownedBy",defaultMessage:"Owned by {email}",values:{email:Ze}})})})})]},A.id)})})]})]});let X;t[70]!==o.length||t[71]!==$||t[72]!==te.length||t[73]!==k||t[74]!==n||t[75]!==P||t[76]!==pe||t[77]!==E||t[78]!==B||t[79]!==D?(X=(!n||o.length===0)&&!P?null:s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary flex items-center justify-between border-t px-3 py-2 ".concat(P?"animate-pulse blur-[1px]":""),children:[s.jsxs("div",{className:"text-token-text-tertiary text-xs",children:[s.jsx(x,{id:"aardvark.whamRepos.range",defaultMessage:"{from}-{to} of {total} repositories",values:{from:te.length===0?0:D+1,to:$,total:te.length}}),B&&s.jsx("span",{className:"text-token-text-secondary ms-2",children:s.jsx(x,{id:"aardvark.whamRepos.filteredEnabled",defaultMessage:"Showing enabled only"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:P||E<=1,onClick:()=>he(ar),children:s.jsx(x,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:P||E>=pe&&!k,onClick:()=>he(sr),children:s.jsx(x,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]}),t[70]=o.length,t[71]=$,t[72]=te.length,t[73]=k,t[74]=n,t[75]=P,t[76]=pe,t[77]=E,t[78]=B,t[79]=D,t[80]=X):X=t[80];let le;return t[81]!==se||t[82]!==ce||t[83]!==me||t[84]!==ue||t[85]!==X?(le=s.jsxs("div",{className:Pe,children:[se,ce,me,ue,X]}),t[81]=se,t[82]=ce,t[83]=me,t[84]=ue,t[85]=X,t[86]=le):le=t[86],le}function sr(e){return e+1}function ar(e){return Math.max(1,e-1)}function rr(e){return e.stopPropagation()}function nr(e,t){return s.jsx(R.Row,{children:s.jsx(R.Cell,{colSpan:4,divClassName:"p-2",children:s.jsx("div",{className:"bg-token-bg-primary border-token-border-light h-6 w-full animate-pulse rounded-md border blur-[1px]"})})},"skeleton-".concat(t))}function lr(e){return s.jsx(He.Item,{value:e.id.toString(),children:e.account_login},e.id)}function ir(e){var t;return(t=e.repositories)!=null?t:[]}function or(e,t){var r;if(!(((r=e==null?void 0:e.repositories)!=null?r:[]).length<xs))return t.length+1}const dr=ye(()=>be(()=>import("./okzsq1aji2s9p1ex.js"),__vite__mapDeps([8,1])),{loading:e=>ke(e)});function cr(){const e=oe();return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{id:"configured-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.whamRepos.configuredSectionTitle",defaultMessage:"All configured repositories"})}),s.jsx("a",{href:"#configurescans-configured-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":e.formatMessage({id:"aardvark.whamRepos.configuredLinkAria",defaultMessage:"Deep link to configured repositories"}),children:s.jsx(dr,{className:"icon-sm"})})]}),s.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:s.jsx(x,{id:"aardvark.whamRepos.configuredSectionDescription",defaultMessage:"This is the full list of repositories in the workspace with scan configurations, created by you or other workspace members. You may not see findings for repos you haven’t connected."})})]})}var yt,Gt;function mr(){if(Gt)return yt;Gt=1;var e=Ps(),t=Ls();function a(r,n,l,i){return r==null?[]:(t(n)||(n=n==null?[]:[n]),l=i?void 0:l,t(l)||(l=l==null?[]:[l]),e(r,n,l))}return yt=a,yt}var ur=mr();const fr=ws(ur),gr=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zl),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)}),xr=ye(()=>be(()=>import("./lm3g1zm00rp6al39.js").then(e=>e.zD),__vite__mapDeps([0,1,2,3,4])),{loading:e=>ke(e)});function hr({scanConfigurations:e}){const t=oe(),a=5,[r,n]=_.useState(1),[l,i]=_.useState(""),c=_.useMemo(()=>{const m=l.trim().toLowerCase(),d=e.filter(u=>{var j,N;const p=u.repo_url.replace("https://github.com/",""),v=p.split("/"),b=(j=v.pop())!=null?j:p,w=(N=v[0])!=null?N:"";return m?b.toLowerCase().includes(m)||w.toLowerCase().includes(m):!0});return fr(d,[u=>{var p;return((p=u.state)!=null?p:"disabled")==="enabled"?0:1},u=>{var v;return((v=u.repo_url.replace("https://github.com/","").split("/")[0])!=null?v:"").toLowerCase()},u=>{var w;const p=u.repo_url.replace("https://github.com/","");return((w=p.split("/").pop())!=null?w:p).toLowerCase()}],["asc","asc","asc"])},[e,l]),h=Math.max(1,Math.ceil(c.length/a)),o=Math.min(r,h),f=(o-1)*a,y=Math.min(f+a,c.length),g=c.slice(f,y);return _.useEffect(()=>{n(1)},[e.length,l]),s.jsxs(s.Fragment,{children:[s.jsx(cr,{}),s.jsx("div",{className:"mb-3 flex justify-end",children:s.jsx("div",{className:"w-64",children:s.jsx(ls,{color:"search",iconPosition:"left",icon:gr,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-configured-repos",type:"text",value:l,onChange:m=>i(m.target.value),placeholder:t.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:t.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})})}),s.jsxs(R.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[s.jsxs(R.Header,{children:[s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.organizationHeader",defaultMessage:"Organization"})}),s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),s.jsx(R.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(x,{id:"aardvark.whamRepos.ownerHeader",defaultMessage:"Owner"})})]}),s.jsx(R.Body,{children:g.length===0?s.jsx(R.Row,{children:s.jsx(R.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:s.jsx(x,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}):s.jsx(s.Fragment,{children:g.map(m=>{var w,j,N,C;const d=m.repo_url.replace("https://github.com/",""),u=(w=d.split("/").pop())!=null?w:d,p=(j=d.split("/")[0])!=null?j:d,v=(C=(N=m.owner)==null?void 0:N.email)!=null?C:t.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),b=m.state==="enabled";return s.jsxs(R.Row,{className:"h-14 px-2 text-sm",children:[s.jsx(R.Cell,{divClassName:"flex h-14 items-center ps-2",children:p}),s.jsxs(R.Cell,{divClassName:"flex h-14 items-center ps-2",children:[s.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(m.repo_url,"_blank"),children:u}),s.jsx("a",{href:m.repo_url,target:"_blank",rel:"noopener noreferrer",className:"ms-2",onClick:F=>F.stopPropagation(),children:s.jsx(xr,{className:"icon-sm"})})]}),s.jsx(R.Cell,{divClassName:"flex h-14 items-center ps-2",children:s.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(b?"bg-green-500/10 text-green-600":"bg-token-text-status-error/15 text-token-text-status-error"),children:b?s.jsx(x,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):s.jsx(x,{id:"aardvark.repos.status.disabled",defaultMessage:"Disabled"})})}),s.jsx(R.Cell,{divClassName:"flex h-14 items-center ps-2",children:v})]},"other-".concat(m.repo_id))})})})]}),s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary mt-2 flex items-center justify-between border-t px-3 py-2",children:[s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,{id:"aardvark.whamRepos.configuredRange",defaultMessage:"{from}-{to} of {total} repositories",values:{from:c.length===0?0:f+1,to:y,total:c.length}})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:o<=1,onClick:()=>n(m=>Math.max(1,m-1)),children:s.jsx(x,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),s.jsx(Se,{as:"button",size:"small",color:"secondary",disabled:o>=h,onClick:()=>n(m=>m+1),children:s.jsx(x,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]})]})}const pr=ye(()=>be(()=>import("./cmff6ny7qwtuxu45.js"),__vite__mapDeps([9,1])),{loading:e=>ke(e)});function vr(){const e=oe(),t=De(),[a,r]=_.useState(!1);return Es(()=>{const l=(t.hash||"").replace(/^#/,"").toLowerCase();(l==="configurescans-connected-repos"||l==="configurescans-configured-repos")&&r(!0)},[t.hash]),_.useEffect(()=>{const l=(t.hash||"").replace(/^#/,"").toLowerCase();let i=!1,c="configure-scans";if(l==="configurescans-connected-repos"?(i=!0,c="connected-repos"):l==="configurescans-configured-repos"&&(i=!0,c="configured-repos"),i){r(!0);try{let h=0;const o=()=>{const f=document.getElementById(c)||document.getElementById("configure-scans");f?f.scrollIntoView({behavior:"smooth",block:"start"}):h<10&&(h+=1,setTimeout(o,50))};requestAnimationFrame(o)}catch(h){}}},[t.hash]),s.jsxs("section",{id:"configure-scans",className:"mt-8",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[s.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(x,{id:"aardvark.home.repository",defaultMessage:"Configure scans"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-xs leading-5",children:s.jsx(x,{id:"aardvark.home.showRepos.message",defaultMessage:"Expand scan configuration"})}),s.jsx(Is,{label:"",ariaLabel:e.formatMessage({id:"aardvark.home.showRepos.toggle",defaultMessage:"Expand scan configuration"}),enabled:a,onChange:n=>r(n)})]})]}),a?s.jsx(br,{}):null]})}function br(){const e=rt(),t=Mt(e),a=t==null?void 0:t.getWorkspaceId(),{scanMap:r}=gt(a),n=Array.from(r.values());return s.jsxs("div",{children:[s.jsx("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mb-5 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",role:"note",children:s.jsxs("div",{className:"text-token-text-secondary flex items-center gap-2 text-sm leading-6",children:[s.jsx(pr,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),s.jsxs("p",{className:"m-0",children:[s.jsx("span",{className:"text-token-text-primary font-semibold",children:s.jsx(x,{id:"aardvark.home.configureScans.disclaimer.title",defaultMessage:"Workspace visibility:"})}),s.jsx("span",{className:"text-token-text-secondary ms-1",children:s.jsx(x,{id:"aardvark.home.configureScans.disclaimer",defaultMessage:"Scan configurations are visible to all workspace members. However, findings are only visible to workspace members with access to the repository."})})]})]})}),s.jsx(tr,{scanMap:r}),n.length>0?s.jsx("div",{className:"mt-6",children:s.jsx(hr,{scanConfigurations:n})}):null]})}function yr(){"use forget";const e=Ce.c(19),t=at(),a=oe(),r=wt();let n;e[0]!==r?(n=r==null?void 0:r.getWorkspaceId(),e[0]=r,e[1]=n):n=e[1];const l=n,{scanMap:i,isLoading:c}=gt(l),h=i.size>0,o=rt();let f;e[2]!==o?(f=Qs(o),e[2]=o,e[3]=f):f=e[3];const y=f,{isConnected:g,isLoading:m,error:d,openGithubModal:u}=Yt(Jt.GITHUB_CONNECTOR,"github","/aardvark",Xt.CODEX);let p,v;e[4]!==d||e[5]!==a||e[6]!==t?(p=()=>{d&&t.danger(a.formatMessage($e.githubConnection),{id:"github_connection_error",duration:5,error:d})},v=[d,a,t],e[4]=d,e[5]=a,e[6]=t,e[7]=p,e[8]=v):(p=e[7],v=e[8]),_.useEffect(p,v);let b;e[9]!==d||e[10]!==y||e[11]!==h||e[12]!==g||e[13]!==m||e[14]!==u||e[15]!==c?(b=()=>m||c?s.jsx("div",{className:"flex h-40 items-center justify-center",children:s.jsx(ut,{className:"text-token-text-tertiary h-6 w-6"})}):g||!c&&h?s.jsxs(s.Fragment,{children:[y&&s.jsx(kr,{}),s.jsx(vr,{}),s.jsx(Qa,{})]}):s.jsx(is,{error:!!d,handleOpenGithubModal:u}),e[9]=d,e[10]=y,e[11]=h,e[12]=g,e[13]=m,e[14]=u,e[15]=c,e[16]=b):b=e[16];const w=b;let j;return e[17]!==w?(j=s.jsx("div",{className:"w-full px-4 pb-6",children:w()}),e[17]=w,e[18]=j):j=e[18],j}function kr(){return s.jsx("div",{className:"border-token-border-light from-token-surface-secondary/90 via-token-surface-primary/80 to-token-surface-secondary/80 mb-4 w-full rounded-3xl border bg-gradient-to-r p-6 shadow-sm",children:s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-token-text-tertiary text-xs font-semibold tracking-[0.16em] uppercase",children:s.jsx(x,{id:"bY8EMn",defaultMessage:"New · repo access controls"})}),s.jsx("h2",{className:"text-token-text-primary mt-1 text-lg font-semibold",children:s.jsx(x,{id:"k+BhWu",defaultMessage:"Manage repository access in the admin console"})}),s.jsx("p",{className:"text-token-text-secondary text-sm",children:s.jsx(x,{id:"mmxIEp",defaultMessage:"Grant or revoke user access using the live Habitat-backed ACLs. Audit all active grants without leaving Aardvark."})})]}),s.jsx(kt,{to:"/aardvark/admin",className:"bg-token-highlight text-token-surface-primary inline-flex items-center justify-center rounded-full px-5 py-2 text-sm font-semibold shadow-sm transition hover:brightness-110",children:s.jsx(x,{id:"M+gdBA",defaultMessage:"Open admin console"})})]})})}function jr(){"use forget";const e=Ce.c(2),t=rt(),a=Ws(t),r=Fs();if(!a)return null;let n;return e[0]!==r?(n=s.jsx(wr,G({},r)),e[0]=r,e[1]=n):n=e[1],n}function wr(e){"use forget";const t=Ce.c(2);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(Ns,{}),t[0]=a):a=t[0];let r;return t[1]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx(s.Fragment,{children:s.jsxs(Js,{mobileHeaderRightContent:null,children:[a,s.jsx(Ss,{children:s.jsx(Cs,{})}),s.jsx(Mr,{})]})}),t[1]=r):r=t[1],r}const Mr=()=>{"use forget";const e=Ce.c(9),t=oe();let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx("div",{className:"no-scrollbar h-full w-full overflow-y-auto",children:s.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:s.jsx(yr,{})})}),e[0]=a):a=e[0];let r;e[1]!==t?(r=t.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[1]=t,e[2]=r):r=e[2];let n;e[3]!==t?(n=t.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[3]=t,e[4]=n):n=e[4];let l;e[5]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx(x,{id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),e[5]=l):l=e[5];let i;return e[6]!==r||e[7]!==n?(i=s.jsxs(Os,{children:[a,s.jsx("a",{href:"https://forms.gle/arrj4MzLN1YqdR8S6",target:"_blank",rel:"noopener noreferrer","aria-label":r,title:n,"data-testid":"aardvark-feedback-fab",className:"border-token-border-light bg-token-main-surface-primary shadow-long hover:bg-token-main-surface-secondary fixed end-4 bottom-4 z-50 flex h-10 items-center justify-center rounded-full border px-4 text-sm font-medium focus:outline-hidden",children:l})]}),e[6]=r,e[7]=n,e[8]=i):i=e[8],i},ln=Ms(function(){return s.jsx(jr,{})});export{ln as default};
//# sourceMappingURL=ovkk7kh1adqreee4.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/g683sukvvwb09shg.js","assets/bubexfvksfr7893o.js","assets/h6662v3to5g8p21c.js","assets/d0fvtivu8wtjjx2a.js","assets/okzsq1aji2s9p1ex.js","assets/jaztged0ed1qpm4w.js","assets/qrcm3utllwqs3zx5.js","assets/hyub38ofpwemwztz.js","assets/9paxni9f8n7suc5d.js","assets/czfk2xng6iz6p6m1.js","assets/aqoo0lpldi915242.js","assets/fd4xn0lvqrlxixyo.js","assets/ncw8zw682jinppua.js","assets/root-ookb7xuw.css","assets/lm3g1zm00rp6al39.js","assets/conversation-small-lq38g8zw.css","assets/oedzukfju6acynd1.js","assets/nmg97e4vhqhbgj7v.js","assets/jjcc0i8g6768wslh.js","assets/kivvchsexr54fuso.js","assets/hthps8s6hg6mj1wr.js","assets/mspnxrdz24xb25t6.js","assets/eii6zxu7kogjx11x.js","assets/ce3hgmw4iyyhicud.js","assets/mstl8wgfzorpgdoe.js","assets/e9acc0j1u83xdcvx.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/orkdsokm67upvzbu.js","assets/fuwv2o9dqpty536z.js","assets/m214aojas5i8u5ss.js","assets/deakbbf27g8e7ba0.js","assets/cdu988xkidlznefj.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/eg96d9s49vx4uh5w.js","assets/dktrrnr6sah4uda0.js","assets/gk9c5stronfar8qx.js","assets/o4w8zbrq7mg3p422.js","assets/ns51nblw8ziscsgd.js","assets/drmwaklva7v056il.js","assets/imbbtedzs51am1ck.js","assets/mj32z5vcfl3ugvj5.js","assets/ebn7bwt2w9d4cap9.js","assets/nxg251y5bix8gl53.js","assets/o66elomacusdy99v.js","assets/ecforv0kxuh5qyzb.js","assets/oumcmu9jw5n6nb3o.js","assets/n8xi1u5k4xaewewd.js","assets/bo0p7vuujjmng48f.js","assets/l4pcm542yc2tenou.js","assets/ffvjxtmoqooghm1t.js","assets/eqqsnl6kprwt6kvn.js","assets/b3zmi7k0e1dvao0m.js","assets/ekj7v0hd90m9gfgd.js","assets/hzasobp3hhjtq47p.js","assets/irqko7c1s7qpl41n.js","assets/knfzy5vszhnec9ql.js","assets/bc00p2ldn9cv9q32.js","assets/8ix1du5tuckfsvqq.js","assets/fwn4bwvyx3h4ty5g.js","assets/l1teaxoievyk0rz1.js","assets/nbm98bu0q3774lnr.js","assets/i9ddjt6oaiw4vo4g.js","assets/ke3w2t9x8i7kgfhv.js","assets/bj1ejin6tzi0v3v8.js","assets/nf2j3wjd224o26ze.js","assets/dd0g9eln2d0qm261.js","assets/d3gl9smdb5iqto0t.js","assets/6sb0te5xkk0og38q.js","assets/m89x2zftpo6hrypr.js","assets/mqabubffkpko61wr.js","assets/fum95d46v8d5jv8u.js","assets/n2u3q2i5341kdx8j.js","assets/j703u6xl4odnuo39.js","assets/me0ap2djy50z6upd.js","assets/lxa5p4s1fgqvzcgw.js","assets/c929hhheh8pnurrs.js","assets/i0yczuhbjrdxz6ve.js","assets/dpidockywf8envd2.js","assets/fvq06q6sopd9r6rx.js","assets/cyrjh6r9wv2bzsqv.js","assets/o45zl9yl00508gad.js","assets/mxzk2kf77c8eueuw.js","assets/fx2avrqgl1byz3tn.js","assets/gx8wj1d12os1vp8m.js","assets/gmyu2fkkxx6mrf2g.js","assets/ip2dsbq9712r5wna.js","assets/jro698t78r3v26vt.js"])))=>i.map(i=>d[i]);
var Je=Object.freeze,ss=Object.defineProperty,Js=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var es=(t,e,n)=>e in t?ss(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))et.call(e,n)&&es(t,n,e[n]);if(De)for(var n of De(e))st.call(e,n)&&es(t,n,e[n]);return t},S=(t,e)=>Js(t,Ds(e));var je=(t,e)=>Je(ss(t,"raw",{value:Je(e||t.slice())}));import{R as xs,r as j,j as s,_ as O,d as fe,M as x,F as tt,c as pe,e as ge,h as te,u as nt,y as ot,ac as it,o as rt}from"./bubexfvksfr7893o.js";import{cb as ue,fd as Ve,V as ae,O as he,hp as $e,hq as Be,D as Le,ai as at,ax as lt,hD as ct,u as ee,g as vs,l3 as dt,lp as Y,ch as We,kb as js,c as _s,be as ut,t9 as ys,nF as bs,m5 as Ms,d as we,qO as ws,gc as ze,n as me,l as He,m as mt,kt as ft,ay as pt,aw as gt,ab as ht,bz as xt,eM as vt,az as F,cw as qe,cz as le,ta as jt,pa as Ps,d9 as de,p as xe,s3 as _t,gp as yt,eH as re,gu as bt,dU as Mt,pe as oe,pd as Qe,tb as Ue,qB as wt,pf as Pt,pg as Tt,d5 as Ts,aA as W,br as It,ff as Ke,py as Is,pB as Ct,pz as Cs,c5 as kt,tc as Gt,j9 as Ee,td as St,kI as ks,px as Nt,qQ as ke,qR as Ge,j as X,_ as Gs,kH as At,aC as Rt,te as Ss,tf as Lt,al as Pe,cv as be,rY as zt,tg as Ut,oO as Et,th as Ot,a7 as Ft,ti as ts,cr as Ns,d$ as Vt,dS as As,ge as Rs,gi as $t,aZ as Bt,e7 as Ls,eX as zs,fS as Wt,nG as Me,P as Ht,J as Us,jl as Es,bS as qt,tj as Qt,ca as ns,qK as Kt,tk as Yt,d6 as Xt,dl as Zt,go as Jt,cu as Dt,H as en,tl as sn,tm as tn,L as nn,tn as on,ao as rn,aP as os,au as is,jr as an,fa as rs,to as as,tp as ln,hZ as cn,h_ as dn,pN as un,i as ls,nY as mn}from"./ncw8zw682jinppua.js";import{a as Os,bA as Fs,dD as fn,js as ie,qn as pn,jC as gn,qo as cs,gU as ds,g1 as Vs,qp as $s,g2 as hn,g4 as xn,T as vn,qq as jn,qr as _n,n0 as yn,dd as bn,hN as Mn,jR as us,bG as wn,dC as Pn,dA as Tn,ez as In,d0 as Cn,r as kn,l8 as Gn,l9 as Sn,la as Nn}from"./lm3g1zm00rp6al39.js";import{b as ms,s as An,c as Rn,g as Ln,A as _e,d as zn,M as Un}from"./fd4xn0lvqrlxixyo.js";import{f as Bs}from"./m89x2zftpo6hrypr.js";import{M as Ws}from"./mqabubffkpko61wr.js";import{i as Oe}from"./fx2avrqgl1byz3tn.js";import{G as En}from"./oedzukfju6acynd1.js";import{C as On}from"./gx8wj1d12os1vp8m.js";import{h as Fn}from"./fum95d46v8d5jv8u.js";import{u as Hs}from"./n2u3q2i5341kdx8j.js";import{a as Vn,G as $n}from"./gmyu2fkkxx6mrf2g.js";import{F as Z,a as J,b as Se,c as Bn,G as Wn}from"./6sb0te5xkk0og38q.js";import{b as Hn}from"./ip2dsbq9712r5wna.js";function qn(t,e){const n=he(t),o=ae.getTree(n),i=[];let r=ae.getCurrentNode(n);for(;r!=null&&(e==null||r.id!==e);)i.unshift(r.message),r=r.parentId!==""?o.getNodeByIdOrMessageId(r.parentId):void 0;return i}function Qn(t){return t.filter(o=>o.recipient==="gizmo_editor.update_behavior").flatMap(o=>o.content.content_type==="text"?o.content.parts:o.content.content_type==="code"?[o.content.text]:[]).map(o=>JSON.parse(o)).reduce((o,i)=>v(v({},o),i),{})}async function Kn(t){let e;for(const n of t)if(n.author.name==="gizmo_editor.generate_profile_pic"){const o=lt.getImageAssetPointers(n);o.length>0&&(e=o.at(-1))}if(e!=null){const n=ct(e.asset_pointer),o=await $e(n);if(o.status===Be.Success)return{id:n,permalink:o.download_url}}}async function Yn(t,e,n,o){const i=qn(e,o),r=Qn(i);let a=await Kn(i);if(Oe(r)&&a==null)return;const{name:f,context:l,description:u,profile_pic_file_id:M,prompt_starters:c}=r;if(M!=null)try{const p=await $e(M,t.id);p.status===Be.Success&&(a={id:M,permalink:p.download_url})}catch(p){Le.addError(new Error("Error while retrieving profile pic in update",{cause:p})),n.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const k={name:typeof f=="string"?f:void 0,description:typeof u=="string"?u:void 0,instructions:typeof l=="string"?l:void 0,promptStarters:Array.isArray(c)?c:void 0,profilePictureId:a==null?void 0:a.id,profilePictureUrl:a==null?void 0:a.permalink};return at(k,p=>p!=null)}function Xn(t){var l,u,M;const e=new Set;for(const c of t.tools)e.add(c.type);const n=(l=t.name)!=null?l:"",o=(u=t.description)!=null?u:"",i=(M=t.instructions)!=null?M:"",r=Array.from(e).join(","),a=n===""&&o===""&&i==="",f=t.profilePictureUrl!=null;return a?"The GPT you are about to has the following abilities: ".concat(r,"."):"This is the GPT's current set of fields:\n\nname: ".concat(n,"\n\ndescription: ").concat(o,"\n\ncontext: ").concat(i,"\n\nabilities: ").concat(r,"\n\n").concat(f?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}const Zn=10;function Jn(t,e){var M,c,k,p,g,m,h,G,P,T,w;const n=t.current,o=e.current;if(Ve(n,o))return;const i={};n.name!==(o==null?void 0:o.name)&&(i.name=n.name),((M=n.description)!=null?M:"")!==((c=o==null?void 0:o.description)!=null?c:"")&&(i.description=(k=n.description)!=null?k:""),n.instructions!==((p=o==null?void 0:o.instructions)!=null?p:"")&&(i.context=(g=n.instructions)!=null?g:"");const r=new Set((h=(m=o==null?void 0:o.files)==null?void 0:m.map(_=>_.file_id))!=null?h:[]),a=new Set((P=(G=n.files)==null?void 0:G.map(_=>_.file_id))!=null?P:[]),f=((T=n.files)!=null?T:[]).filter(_=>!r.has(_.file_id)),l=((w=o==null?void 0:o.files)!=null?w:[]).filter(_=>!a.has(_.file_id));if(Oe(i)&&f.length===0&&l.length===0)return;const u=[];if(!Oe(i)){const _="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(i,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');u.push(ue(_))}if(l.length>0&&u.push(ue("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(l.map(_=>_.file_id).join(", ")))),f.length>0){const _=f.slice(0,Zn);u.push(ue("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(_.map(N=>N.file_id).join(", ")),{attachments:_.map(N=>({id:N.file_id,name:N.name,size:N.size}))}))}return u}function Dn(t){if(t.length===0)return;const e="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(t.map(n=>'"'.concat(n.fileId,'"')).join(", "));return[ue(e)]}function eo(t){const e="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.";if(!ae.findNode(he(t),o=>o.message.content.content_type==="text"&&o.message.content.parts[0]===e))return[ue(e)]}function so(t,e){j.useEffect(()=>{ae.findNode(he(t),o=>ft(o.message)||o.message.author.role===pt.System&&o.message.content.content_type===gt.Text)||He(t,o=>{ht.updateTree(o,(i,r)=>{const a=i.findNode(f=>{var l;return((l=f.message.clientMetadata)==null?void 0:l.isPlaceholderTemplateAssistantWelcomeMessage)===!0},r);return a&&(a.id===r&&(r=i.rootId),i.deleteNode(a.id)),e?i.addMessageNode(r,xt(e,void 0,{isPlaceholderTemplateAssistantWelcomeMessage:!0})):r})})},[t,e])}function to(t,e,n){var l;const o=ee(),i=vs(o,t),r=we(()=>vt(i)),a=(l=r.models.get(ws))!=null?l:r&&Bs(r.models.values(),u=>u.tags.includes(ze.GPT_4o));Os(t,{kind:me.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:n},{forcedModelId:a==null?void 0:a.id}),j.useEffect(()=>{He(t,u=>{u.mode={kind:me.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:mt(n)}})},[o,t,e.id,n,a,r]);const[f]=j.useState(()=>{const u=e.id==null,M=e.id!=null&&e.name!==""&&e.description!=null&&e.instructions!==""&&e.profilePictureUrl!=null;return u?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':M?"Welcome back! Is there anything ".concat(e.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});so(t,f)}function no({gizmoEditorData:t,updateGizmo:e,clientThreadId:n,gizmoEditorDataRef:o,magicMakerBehaviorOverrides:i,magicMakerConversationGizmoEditorDataRef:r,requireGizmoId:a}){const f=ee(),l=vs(f,n),u=j.useRef(a);u.current=a;const M=j.useMemo(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:i,getGizmoId:u.current}),[t,i]),c=dt(p=>p.files.filter(g=>g.status===Y.Ready&&g.gizmoId!=null)),k=j.useCallback(p=>{var g,m,h,G,P;if(e(T=>{var w;return S(v({},T),{files:[...(w=T.files)!=null?w:[],...We(c.map(_=>{var N;return _.fileId!=null&&{file_id:_.fileId,name:_.file.name,size:_.file.size,type:js(_.file),last_modified:_.file.lastModified,file_size_tokens:(N=_.fileSpec)==null?void 0:N.fileTokenSize}}))]})}),r.current=_s(o.current),!p.completionType||p.completionType===ut.Next){const T=ae.getCurrentNode(he(n)),w=(g=T.message.clientMetadata)!=null&&g.isPlaceholderTemplateAssistantWelcomeMessage?T.message:void 0;w&&(p.existingMessages=[w]),p.prependMessages=[...(m=Dn(c))!=null?m:[],...(h=Jn(o,r))!=null?h:[],...(G=eo(n))!=null?G:[],...(P=p.prependMessages)!=null?P:[]]}return p},[n,c,o,r,e]);return s.jsx(ys.Provider,{value:M,children:s.jsx("div",{className:"relative flex h-full grow overflow-auto",children:s.jsx("div",{className:"grow",children:s.jsx(bs,{conversation:l,children:s.jsx(Ms,{conversation:l,children:s.jsx(Ws,{conversation:l,withCustomCompletionParams:k,hideHeader:!0})})})})})})}const oo=xs.memo(no),io=F(()=>O(()=>import("./g683sukvvwb09shg.js"),__vite__mapDeps([0,1])),{loading:t=>W(t)}),ro=F(()=>O(()=>import("./h6662v3to5g8p21c.js"),__vite__mapDeps([2,1])),{loading:t=>W(t)}),ao=F(()=>O(()=>import("./d0fvtivu8wtjjx2a.js"),__vite__mapDeps([3,1])),{loading:t=>W(t)}),qs=F(()=>O(()=>import("./okzsq1aji2s9p1ex.js"),__vite__mapDeps([4,1])),{loading:t=>W(t)}),lo=F(()=>O(()=>import("./jaztged0ed1qpm4w.js"),__vite__mapDeps([5,1])),{loading:t=>W(t)}),co=F(()=>O(()=>import("./qrcm3utllwqs3zx5.js"),__vite__mapDeps([6,1])),{loading:t=>W(t)}),uo=F(()=>O(()=>import("./hyub38ofpwemwztz.js"),__vite__mapDeps([7,1])),{loading:t=>W(t)}),mo=F(()=>O(()=>import("./9paxni9f8n7suc5d.js"),__vite__mapDeps([8,1])),{loading:t=>W(t)}),fo=F(()=>O(()=>import("./czfk2xng6iz6p6m1.js"),__vite__mapDeps([9,1])),{loading:t=>W(t)}),po=F(()=>O(()=>import("./aqoo0lpldi915242.js"),__vite__mapDeps([10,1])),{loading:t=>W(t)}),go=F(()=>O(()=>import("./fd4xn0lvqrlxixyo.js").then(t=>t.e),__vite__mapDeps([11,1,12,13,14,15,16])).then(t=>t.ShareGizmoModal)),ho=F(()=>O(()=>import("./nmg97e4vhqhbgj7v.js"),__vite__mapDeps([17,1,12,13,14,15,11,16])).then(t=>t.SimpleShareGizmoModal));function Fe(t){return!!(t&&typeof t=="object"&&"gizmo"in t)}function Qs(t){window.history.length>1?t(-1):t(jt())}function xo(t){"use forget";var z;const e=pe.c(38),{gizmo:n,publishedGizmo:o,isUpsertLoading:i,isPromoteLoading:r,isUploadingProfilePic:a,updateGizmo:f,promoteGizmo:l,appealGizmo:u,setAppealState:M,showActionsModal:c}=t,k=ee(),p=Mt();let g;if(e[0]!==n||e[1]!==r||e[2]!==a||e[3]!==i){if(g=[],(n==null||r||i)&&g.push(oe.Loading),n!=null){let U;e[5]!==n?(U=Qe(n),e[5]=n,e[6]=U):U=e[6],g.push(...U)}a&&g.push(oe.UploadingProfilePic),e[0]=n,e[1]=r,e[2]=a,e[3]=i,e[4]=g}else g=e[4];const m=g;let h;e[7]!==n?(h=Ps(n),e[7]=n,e[8]=h):h=e[8];const G=h;let P;e[9]!==p||e[10]!==u||e[11]!==k||e[12]!==n||e[13]!==l||e[14]!==o||e[15]!==M||e[16]!==c||e[17]!==f?(P=U=>{requestAnimationFrame(()=>It(k,p!=null&&p.isWorkspaceAccount()?go:ho,{gizmo:n,publishedGizmo:o,promoteGizmo:l,appealGizmo:u,setAppealState:M,showActionsModal:c,updateGizmo:f,shareOnly:U==="share"}))},e[9]=p,e[10]=u,e[11]=k,e[12]=n,e[13]=l,e[14]=o,e[15]=M,e[16]=c,e[17]=f,e[18]=P):P=e[18];const T=P,[w,_]=j.useState(!1),N=n.sharingRecipient?ms[n.sharingRecipient]:ms.private,y=r||i;let I;e[19]!==N||e[20]!==m||e[21]!==n.id||e[22]!==n.sharing||e[23]!==T||e[24]!==y||e[25]!==G||e[26]!==r||e[27]!==i||e[28]!==l||e[29]!==o?(I=G?s.jsx(ie,{color:"primary",onClick:()=>T("promote"),loading:m.length>0&&m.every(vo),disabled:y||n.id===void 0||m.length>0,tooltip:m.length>0?m.map(Ue).join("\n"):void 0,"data-testid":"gizmo-editor-create-gpt-button",children:s.jsx(x,{id:"svUGIb",defaultMessage:"Create"})}):s.jsxs(s.Fragment,{children:[s.jsx(ie,{color:"secondary",loading:r||!o,disabled:y,icon:N,onClick:()=>T("share"),children:s.jsx(x,{id:"aXKW4G",defaultMessage:"Share"})}),s.jsx(ie,{color:"primary",onClick:async()=>{var E;let U=n.sharing.subjects.map(An);const B=wt(n.sharing.subjects);U=Pt(n.sharing.recipient,U,(E=B==null?void 0:B.capabilities)!=null?E:Tt);const d=o&&Fe(o)?o.gizmo.display.categories[0]:void 0;await l({recipient:n.sharing.recipient,subjects:U},d)&&_(!0)},loading:i||!o,disabled:y||m.length>0,tooltip:m.length>0?m.map(Ue).join("\n"):void 0,children:s.jsx(x,{id:"84QVoj",defaultMessage:"Update"})})]}),e[19]=N,e[20]=m,e[21]=n.id,e[22]=n.sharing,e[23]=T,e[24]=y,e[25]=G,e[26]=r,e[27]=i,e[28]=l,e[29]=o,e[30]=I):I=e[30];let C;e[31]!==(p==null?void 0:p.data)||e[32]!==w||e[33]!==o?(C=w&&o&&s.jsx(Rn,{publishedGizmo:o,sharing:Fe(o)?o.gizmo.sharing:void 0,onClose:()=>_(!1),workspaceName:(z=p==null?void 0:p.data.name)!=null?z:""}),e[31]=p==null?void 0:p.data,e[32]=w,e[33]=o,e[34]=C):C=e[34];let V;return e[35]!==I||e[36]!==C?(V=s.jsxs(s.Fragment,{children:[I,C]}),e[35]=I,e[36]=C,e[37]=V):V=e[37],V}function vo(t){return[oe.Loading,oe.UploadingProfilePic].includes(t)}function jo(t){"use forget";var N;const e=pe.c(26),{gizmoEditorData:n,publishedGizmo:o,revertDraft:i}=t,r=ee(),a=te(),f=xe(),l=fe(),[u,M]=j.useState(!1),{canDelete:c}=_t(o),{canCreate:k}=yt();if(!!!(o||i||n!=null&&n.id&&n.liveVersion>0||c))return null;let g;e[0]===Symbol.for("react.memo_cache_sentinel")?(g=s.jsx(ie,{color:"ghost",icon:lo}),e[0]=g):g=e[0];let m;e[1]!==r||e[2]!==o||e[3]!==f?(m=o!=null&&s.jsxs(re.Item,{onClick:y=>{fn(r,o,f,y)},children:[s.jsx(qs,{className:"icon-sm"}),s.jsx(x,v({},D.copyLink))]}),e[1]=r,e[2]=o,e[3]=f,e[4]=m):m=e[4];let h;e[5]!==a||e[6]!==i?(h=i!=null&&s.jsxs(re.Item,{onClick:()=>{window.confirm(a.formatMessage(D.revertConfirm))&&i()},children:[s.jsx(ro,{className:"icon-sm"}),s.jsx(x,{id:"W2blnV",defaultMessage:"Revert..."})]}),e[5]=a,e[6]=i,e[7]=h):h=e[7];let G;e[8]!==k||e[9]!==n||e[10]!==l?(G=(n==null?void 0:n.id)!=null&&n.liveVersion>0&&s.jsxs(s.Fragment,{children:[s.jsxs(re.Item,{onClick:()=>{l("/g/".concat(n.id,"/view"))},children:[s.jsx(uo,{className:"icon-sm"}),s.jsx(x,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),k&&s.jsxs(re.Item,{onClick:async()=>{const y=await bt.copyGizmo({gizmoId:n.id});y.gizmo.id&&l("/gpts/editor/".concat(y.gizmo.id))},children:[s.jsx(co,{className:"icon-sm"}),s.jsx(x,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),e[8]=k,e[9]=n,e[10]=l,e[11]=G):G=e[11];let P;e[12]!==o?(P=o&&Fe(o)&&((N=o.gizmo.current_user_permission)==null?void 0:N.can_delete)&&s.jsxs(re.Item,{color:"danger",onClick:()=>{M(!0)},children:[s.jsx(io,{className:"icon-sm"}),s.jsx(x,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),e[12]=o,e[13]=P):P=e[13];let T;e[14]!==m||e[15]!==h||e[16]!==G||e[17]!==P?(T=s.jsxs(Ke,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:g,children:[m,h,G,P]}),e[14]=m,e[15]=h,e[16]=G,e[17]=P,e[18]=T):T=e[18];let w;e[19]!==(n==null?void 0:n.id)||e[20]!==l||e[21]!==u?(w=u&&s.jsx(En,{gizmoId:(n==null?void 0:n.id)||"",onSuccess:()=>Qs(l),onClose:()=>{M(!1)}}),e[19]=n==null?void 0:n.id,e[20]=l,e[21]=u,e[22]=w):w=e[22];let _;return e[23]!==T||e[24]!==w?(_=s.jsxs(s.Fragment,{children:[T,w]}),e[23]=T,e[24]=w,e[25]=_):_=e[25],_}var ps;const ye=qe.div(ps||(ps=je(["flex items-center gap-1"])));function _o(t){"use forget";const e=pe.c(7),{gizmoEditorData:n}=t,o=Ts(yo);switch(n.sharingRecipient){case de.Private:{let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(ao,{className:"icon-xs"}),s.jsx(x,v({},D.onlyMe))]}),e[0]=i):i=e[0],i}case de.Link:{let i;return e[1]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(qs,{className:"icon-xs"}),s.jsx(x,v({},D.anyoneWithLink))]}),e[1]=i):i=e[1],i}case de.Workspace:{let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(fo,{className:"icon-xs"}),e[2]=i):i=e[2];let r;return e[3]!==o?(r=s.jsxs(ye,{children:[i,o]}),e[3]=o,e[4]=r):r=e[4],r}case de.Marketplace:{let i;return e[5]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(po,{className:"icon-xs"}),s.jsx(x,v({},D.public))]}),e[5]=i):i=e[5],i}default:{let i;return e[6]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx("div",{}),e[6]=i):i=e[6],i}}}function yo(t){var e;return(e=t.currentWorkspace)==null?void 0:e.name}function bo(t){"use forget";const e=pe.c(14),{gizmoEditorData:n}=t;let o;e[0]!==n.profilePictureUrl?(o=n.profilePictureUrl!=null?s.jsx(Fs,{isFirstParty:!1,src:n.profilePictureUrl,className:"h-8 w-8"}):s.jsx("div",{className:"border-token-border-medium h-8 w-8 rounded-full border-2 border-dashed"}),e[0]=n.profilePictureUrl,e[1]=o):o=e[1];let i;e[2]!==n.name?(i=n.name||s.jsx(x,v({},D.newGPT)),e[2]=n.name,e[3]=i):i=e[3];let r;e[4]!==i?(r=s.jsx("div",{className:"text-sm font-semibold",children:i}),e[4]=i,e[5]=r):r=e[5];let a;e[6]!==n?(a=s.jsx("div",{className:"text-token-text-secondary text-xs",children:Ps(n)?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-token-text-tertiary h-1.5 w-1.5 rounded-full"}),s.jsx(x,v({},D.draft))]}):s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-brand-green h-1.5 w-1.5 rounded-full"}),n.sharingRecipient===de.Marketplace?s.jsx(x,v({},D.published)):s.jsx(x,{id:"gizmoEditorHeader.live",defaultMessage:"Live"}),s.jsx(x,S(v({},D.dotSeparator),{tagName:"span"})),s.jsx(_o,{gizmoEditorData:n})]})}),e[6]=n,e[7]=a):a=e[7];let f;e[8]!==r||e[9]!==a?(f=s.jsxs("div",{children:[r,a]}),e[8]=r,e[9]=a,e[10]=f):f=e[10];let l;return e[11]!==o||e[12]!==f?(l=s.jsxs("div",{className:"flex items-center gap-2",children:[o,f]}),e[11]=o,e[12]=f,e[13]=l):l=e[13],l}var gs;const Mo=qe.div(gs||(gs=je(["\n  cursor-pointer\n  border-b\n  pb-[1px]\n  pt-[2px]\n  text-sm\n  text-token-text-secondary\n  hover:border-token-border-xheavy\n  hover:text-token-text-primary\n  mx-2\n"])));function wo({gizmoEditorData:t,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,publishedGizmo:i,updateGizmo:r,promoteGizmo:a,appealGizmo:f,setAppealState:l,revertDraft:u,draftMessage:M,className:c,hasUnpublishedChanges:k,showActionsModal:p}){var m,h;const g=fe();return s.jsxs("div",{className:le("border-token-border-medium relative flex h-14 w-full items-center justify-between gap-2 border-b px-3",c),children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("a",{className:"text-token-text-primary cursor-pointer",onClick:()=>Qs(g),children:s.jsx(mo,{className:"icon"})}),s.jsx(bo,{gizmoEditorData:t})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[i&&((h=(m=i==null?void 0:i.gizmo)==null?void 0:m.live_version)!=null?h:0)>1&&s.jsx(Mo,{onClick:()=>g("/g/".concat(t.id,"/view")),children:s.jsx(x,{id:"P0Ri/k",defaultMessage:"Last edited {date}",values:{date:s.jsx(tt,{value:i.gizmo.updated_at,day:"numeric",month:"short",year:new Date(i.gizmo.updated_at).getFullYear()===new Date().getFullYear()?void 0:"numeric"})}})}),M,s.jsx(jo,{gizmoEditorData:t,publishedGizmo:i,revertDraft:u}),s.jsx(xo,{gizmo:t,publishedGizmo:i,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,updateGizmo:r,promoteGizmo:a,appealGizmo:f,setAppealState:l,hasUnpublishedChanges:k,showActionsModal:p})]})]})}const D=ge({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},dotSeparator:{id:"gizmo.dotSeparator",defaultMessage:"Â·"}}),Po=F(()=>O(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zp),__vite__mapDeps([14,1,12,13,15])),{loading:t=>W(t)}),To=512;function Io({gizmoEditorData:t,onFileChange:e}){const n=te(),o=xe(),[i,r]=j.useState(void 0),a=j.useRef(e);j.useEffect(()=>{a.current=e});async function f(M){if(M.length>0){const c=await Gt(M[0],To),k=Ee(c);r({tempId:k,file:c,status:Y.Uploading,progress:1,fileId:null,cdnUrl:null}),a.current("uploading"),St(k,c,n,o,ks.ProfilePicture,{onFileCreated(p,g,m){r(h=>h!=="initial"&&(h==null?void 0:h.tempId)===p&&h.status===Y.Uploading?S(v({},h),{progress:10,fileId:g,cdnUrl:m}):h)},onFileUploadProgress(p,g){r(m=>m!=="initial"&&(m==null?void 0:m.tempId)===p&&m.status===Y.Uploading?S(v({},m),{progress:g}):m)},onFileUploaded(p,g,m){r(h=>h!=="initial"&&(h==null?void 0:h.tempId)===p?(a.current(h),S(v({},h),{status:Y.Ready,progress:100,fileSpec:v({name:h.file.name,id:h.fileId,size:h.file.size},m!=null?m:{})})):h)},onError(p){r(g=>{if(g!=="initial"&&(g==null?void 0:g.tempId)===p){a.current(void 0);return}return g})}})}}const{open:l,getInputProps:u}=Hs(v({disabled:!1,noClick:!0,onDropAccepted:f,onDropRejected:M=>Fn(M,n,o,kt.ProfilePicture),multiple:!0,maxSize:Cs},Is(Ct)));return s.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[s.jsx(Ke,{sideOffset:8,triggerButton:s.jsx("button",{className:"h-20 w-20",children:i!=null&&i!="initial"&&i.status!=Y.Ready?s.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[s.jsx(pn,{file:i.file}),i.status===Y.Uploading&&i.progress<90?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:s.jsx(gn,{percentage:i.progress,className:"h-6 w-6"})}):null]}):(t==null?void 0:t.profilePictureUrl)!=null&&(t==null?void 0:t.profilePictureUrl)!==""?s.jsx(Fs,{isFirstParty:!1,src:t.profilePictureUrl}):s.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:s.jsx(Po,{className:"text-4xl"})})}),children:s.jsx(re.Item,{onClick:l,children:s.jsx(x,{id:"ERQwXg",defaultMessage:"Upload Photo"})})}),s.jsx("input",v({},u()))]})}function Co({gizmoEditorData:t,requireGizmoId:e,currentModelConfig:n,updateGizmo:o}){var N;const i=te(),r=xe(),[a,f]=j.useState(0),l=j.useRef(new Map),u=Nt(n,void 0),M=async y=>{Gs.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const I=await e();y.length>0&&await Promise.all(y.map(C=>{const V=Ee(C);l.current.set(V,{tempId:V,gizmoId:I,file:C,status:Y.Uploading,progress:1,fileId:null,cdnUrl:null}),At(Ee(C),C,i,r,{kind:ks.Gizmo,gizmoId:I},{onFileUploaded:(z,U,B,d)=>{const R=l.current.get(z);R==null||R.fileId==null||(o(E=>{var H,se;return S(v({},E),{files:[...(H=E.files)!=null?H:[],{file_id:R.fileId,name:R.file.name,size:R.file.size,type:(se=d==null?void 0:d.mimeType)!=null?se:js(C),last_modified:R.file.lastModified,file_size_tokens:d==null?void 0:d.fileTokenSize}]})}),l.current.delete(z),f(E=>E+1))},onFileCreated:(z,U,B)=>{l.current.set(z,S(v({tempId:z,gizmoId:I,file:C,status:Y.Uploading,progress:1},l.current.get(z)),{fileId:U,cdnUrl:B})),f(d=>d+1)},onFileUploadProgress:(z,U)=>{const B=l.current.get(z);(B==null?void 0:B.status)===Y.Uploading&&l.current.set(z,S(v({},B),{progress:U})),f(d=>d+1)},onError:z=>{l.current.delete(z)}},{usesRetrievalIndex:n!=null&&ke(n,C.type,C.name)===Ge.Retrieval})}))},{getInputProps:c,open:k}=Hs(v({disabled:!1,noClick:!0,onDropAccepted:M,multiple:!0,maxSize:Cs,maxFiles:10},Is(u))),p=(N=t==null?void 0:t.files)!=null?N:[];function g(y){return s.jsx(ds,{onRemoveFileClick:()=>{l.current.delete(y.tempId),f(I=>I+1)},file:y.file,loadingPercentage:y.status===Y.Uploading?y.progress:void 0},y.tempId)}function m(y){return s.jsx(ds,{file:y.name,fileId:y.file_id,onRemoveFileClick:()=>o(I=>{var C;return S(v({},I),{files:(C=I==null?void 0:I.files)==null?void 0:C.filter(V=>V.file_id!==y.file_id)})}),gizmoId:t==null?void 0:t.id},y.file_id)}const h=Array.from(l.current.values()).filter(y=>p.every(I=>I.file_id!==y.fileId)),[G,P]=cs(h,y=>n!=null&&ke(n,y.file.type,y.file.name)===Ge.CodeInterpreter),[T,w]=cs(p,y=>n!=null&&y.type!=null&&ke(n,y.type,y.name)===Ge.CodeInterpreter),_=j.useRef(T.length);return j.useEffect(()=>{T.length>_.current&&o(y=>{var I,C;return(I=y.tools)!=null&&I.some(V=>V.type===X.PYTHON)?y:S(v({},y),{tools:[...(C=y.tools)!=null?C:[],{type:X.PYTHON}]})}),_.current=T.length},[T.length]),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"text-token-text-tertiary rounded-lg text-xs",children:s.jsx(x,v({},ko.knowledgeWarning))}),P.length>0||w.length>0?s.jsxs("div",{className:"flex flex-wrap gap-2",children:[P.map(g),w.map(m)]}):null,G.length>0||T.length>0?s.jsxs("div",{children:[s.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:s.jsx(x,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[G.map(g),T.map(m)]})]}):null,s.jsx("div",{children:s.jsxs(ie,{onClick:k,children:[s.jsx("input",v({},c())),s.jsx(x,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const ko=ge({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT can potentially reveal part or all of the files uploaded."}});function Go({placeholder:t,text:e,onChange:n,onClose:o}){return s.jsxs(Rt,{testId:"modal-gizmo-editor-form",className:"max-h-[100vh]! max-w-[80vw]!",type:"success",isOpen:!0,onClose:o,primaryButton:s.jsx(ie,{onClick:o,children:s.jsx(x,{id:"FeFVdS",defaultMessage:"Close"})}),children:[s.jsx("textarea",{className:"bg-token-main-surface-primary h-[70vh] w-full resize-none rounded-lg dark:border-gray-700",value:e,onChange:i=>{n(i.target.value)},placeholder:t}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,v({},Ss.instructionsWarning))})]})}const So=F(()=>O(()=>import("./jjcc0i8g6768wslh.js"),__vite__mapDeps([18,1])),{loading:t=>W(t)}),No=F(()=>O(()=>import("./ncw8zw682jinppua.js").then(t=>t.yq),__vite__mapDeps([12,1,13])),{loading:t=>W(t)});var hs;const Ne=qe.div(hs||(hs=je(["text-sm text-red-500"])));function Ao({children:t,collapsed:e,initial:n}){return s.jsx(Vt,{initial:n,children:!e&&s.jsx(As.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})})}function Ro({gizmo:t,onShowActionsEditor:e,isDisabled:n}){var a,f,l;const o=te(),i=xe(),r=s.jsxs("div",{className:"space-y-1",children:[(a=t==null?void 0:t.tools)==null?void 0:a.map((u,M)=>{var c;return u.type!==X.JIT_PLUGIN?null:s.jsxs("div",{children:[s.jsx(Wn,{isDisabled:n,actionTool:u,onShowActionsEditor:()=>e(u.metadata.domain)}),((c=u.metadata.auth)==null?void 0:c.type)==="oauth"&&s.jsx(On,{label:o.formatMessage($.callbackUrlLabel),value:"https://chat.openai.com/aip/".concat(u.metadata.action_id,"/oauth/callback"),onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},M)}),((l=(f=t==null?void 0:t.tools)==null?void 0:f.filter(u=>u.type===X.JIT_PLUGIN))!=null?l:[]).length>=ts?s.jsx("div",{children:o.formatMessage($.maxActionsReached,{number:ts})}):s.jsx(ie,{disabled:n,onClick:()=>{e("Unknown domain")},className:"mt-2",children:s.jsx(x,v({},$.createActionLabel))})]});return n?s.jsx(Ns,{side:"top",label:o.formatMessage($.disabledCustomActionsTooltip),children:r}):r}function Lo(t){var e,n,o;return((n=(e=t.files)==null?void 0:e.length)!=null?n:0)>0||((o=t==null?void 0:t.tools)==null?void 0:o.some(i=>i.type===X.JIT_PLUGIN))}function zo({gizmoEditorData:t,updateGizmo:e,currentModelConfig:n,setIsUploadingProfilePic:o,requireGizmoId:i,onShowActionsEditor:r}){var y,I,C,V,z,U,B;const a=(y=t==null?void 0:t.tools)!=null?y:[],[f,l]=j.useState(!1),[u,M]=j.useState(!0),c=(I=t==null?void 0:t.promptStarters)!=null?I:[],k=[...c,...c.length<Lt?[""]:[]],p=Qe(t),g=ee(),m=Pe(g),h=m==null?void 0:m.isWorkspaceAccount(),G=Vs(be.WorkspaceGPTCustomActions),P=te(),T=we(()=>Rs(g,{isGizmo:!0})),w=m==null?void 0:m.hasPaidFeatures(),{data:_}=we(()=>$t(g)),N=_!=null&&_.editor?$s((C=t==null?void 0:t.tools)!=null?C:[])?_.editor.models_list_with_custom_actions:_.editor.models_list:[];return s.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[s.jsxs("div",{className:"grow",children:[s.jsxs(Z,{children:[s.jsx(Io,{gizmoEditorData:t,onFileChange:async d=>{if(d!=null&&d!=="uploading"&&d.fileId!=null){const R=await $e(d.fileId);R.status===Be.Success&&e({profilePictureId:d.fileId!=null?d.fileId:void 0,profilePictureUrl:R.download_url})}else e({profilePictureId:void 0,profilePictureUrl:void 0});o(d==="uploading")}}),s.jsx(J,{label:s.jsx(x,{id:"M4dZms",defaultMessage:"Name"}),description:s.jsx(x,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),s.jsx(Se,{type:"text",placeholder:P.formatMessage($.gptNamePlaceholder),value:(V=t==null?void 0:t.name)!=null?V:"",onChange:d=>{e({name:d.target.value})},onBlurCapture:()=>e(d=>S(v({},d),{name:d.name.trim()})),"data-testid":"gizmo-name-input"}),p.includes(oe.GizmoNameTooLong)?s.jsx(Ne,{className:"mt-1",children:s.jsx(x,S(v({},$.nameTooLong),{values:{length:zt}}))}):null]}),s.jsxs(Z,{className:"mt-4",children:[s.jsx(J,{label:s.jsx(x,{id:"YDzNvf",defaultMessage:"Description"}),description:s.jsx(x,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),s.jsx(Se,{type:"text",placeholder:P.formatMessage($.descriptionPlaceholder),value:(z=t==null?void 0:t.description)!=null?z:"",onChange:d=>e({description:d.target.value}),onBlurCapture:()=>e(d=>{var R,E;return S(v({},d),{description:(E=(R=d.description)==null?void 0:R.trim())!=null?E:""})}),"data-testid":"gizmo-description-input"}),p.includes(oe.GizmoDescriptionTooLong)?s.jsx(Ne,{className:"mt-1",children:s.jsx(x,S(v({},$.descriptionTooLong),{values:{length:Ut}}))}):null]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:P.formatMessage($.instructionsSubtitle)}),s.jsxs("div",{className:"relative",children:[s.jsx(Bn,{className:"resize-none",rows:8,value:t==null?void 0:t.instructions,onChange:d=>e({instructions:d.target.value}),onBlurCapture:()=>e(d=>S(v({},d),{instructions:d.instructions.trim()})),placeholder:P.formatMessage($.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),s.jsx("button",{className:"text-token-text-tertiary absolute end-2 bottom-3",onClick:()=>l(!0),children:s.jsx(So,{className:"icon-sm"})})]}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,v({},Ss.instructionsWarning))}),p.includes(oe.GizmoInstructionsTooLong)?s.jsx(Ne,{className:"mt-1",children:s.jsx(x,S(v({},$.instructionsTooLong),{values:{length:Et}}))}):null]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:s.jsx(x,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),s.jsx("div",{className:"flex flex-col gap-1",children:k.map((d,R)=>s.jsxs("div",{className:"flex items-center",children:[s.jsx(Se,{className:"rounded-e-none",value:d,type:"text",maxLength:Ot,onChange:E=>{const H=E.target.value;e(se=>{var Q;return S(v({},se),{promptStarters:We(R>=((Q=c.length)!=null?Q:0)?[...c!=null?c:[],H]:c.map((ve,Te)=>Te===R?H===""?void 0:H:ve))})})}}),s.jsx("button",{className:"border-token-border-medium flex h-9 w-9 items-center justify-center rounded-lg rounded-s-none border border-s-0",onClick:()=>e(E=>S(v({},E),{promptStarters:c.filter((H,se)=>se!==R)})),children:s.jsx(No,{className:"icon-sm"})})]},R))})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:P.formatMessage($.knowledgeExplanation)}),s.jsx(Co,{gizmoEditorData:t,requireGizmoId:i,currentModelConfig:n,updateGizmo:e})]}),w&&s.jsxs(Z,{children:[s.jsx(J,{label:s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[s.jsx(x,{id:"wnVs4X",defaultMessage:"Recommended Model"}),s.jsx(Vn,{description:s.jsx(x,v({},$.recommendedModelExplainer))})]})}),s.jsx("div",{style:{fontSize:"12px",color:"var(--gray-600)",marginTop:"4px",marginBottom:"8px"},children:s.jsx(x,v({},$.recommendedModelDescriberUnderTitle))}),s.jsxs("select",{className:"border-token-border-medium bg-token-main-surface-primary w-full rounded-lg border px-3 py-2 text-sm",value:(U=t.defaultModel)!=null?U:"",onChange:d=>{Ft.logEvent("gizmo_recommended_model_selected",d.target.value),e({defaultModel:d.target.value===""?null:d.target.value})},children:[s.jsx("option",{value:"",children:P.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"})}),[...T.models.values()].filter(d=>N.includes(d.id)).sort((d,R)=>d.title.localeCompare(R.title)).map(d=>s.jsx("option",{value:d.id,children:d.title},d.id))]})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:s.jsx(x,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),s.jsx($n,{enabledTools:a,onEnabledToolsChange:d=>e({tools:d})})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"7r7v+u",defaultMessage:"Actions"}),description:s.jsx(x,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),s.jsx(Ro,{isDisabled:!!(h&&!G),gizmo:t,onShowActionsEditor:r})]}),!h&&Lo(t)&&s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!u,onClick:()=>{M(d=>!d)}}),s.jsx(Ao,{collapsed:u,initial:!1,children:s.jsx(hn,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:s.jsx(x,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!t.trainingDisabled,onChange:()=>{e({trainingDisabled:!t.trainingDisabled})}})})]})]}),f&&s.jsx(Go,{text:(B=t.instructions)!=null?B:"",onChange:d=>{e({instructions:d})},onClose:()=>l(!1),placeholder:P.formatMessage($.instructionsSubtitle)})]})}const $=ge({recommendedModelDescriberUnderTitle:{id:"gizmo.recommendedModelDescriberUnderTitle",defaultMessage:"Recommend a model to the user, which should be used by default for best results."},recommendedModelExplainer:{id:"gizmo.recommendedModelExplainer",defaultMessage:"When the user loads a new conversation with the GPT the recommended model will be used. If the model is not available to the user, a similar model may be automatically selected."},nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters. If you need to provide more context, you may want to attach a file or knowledge document."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}}),Uo=F(()=>O(()=>import("./kivvchsexr54fuso.js"),__vite__mapDeps([19,1])),{loading:t=>W(t)});function Eo(t,e){const n=zs(t);if(!Array.isArray(t.detail))return n;const o=We(t.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return e.formatMessage($.nameTooLong,{length:i.ctx.limit_value});case"description":return e.formatMessage($.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return e.formatMessage($.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return o.length>0?o.join("\n"):n}function Oo({upsertDraftError:t}){const e=te(),n=Eo(t,e);return s.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[s.jsx("div",{children:s.jsx(x,v({},Ks.errorSavingDraft))}),n!=null&&s.jsx(Ns,{label:n,children:s.jsx(Uo,{className:"icon-sm"})})]})}function Fo({isPublished:t,isSavingDraft:e,hasUnpublishedChanges:n,upsertDraftError:o,className:i}){return o instanceof Bt?s.jsx(Oo,{upsertDraftError:o}):n?s.jsxs("div",{className:le("flex items-center gap-2",i),children:[s.jsx("span",{className:"text-token-text-secondary",children:t?s.jsx(x,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):s.jsx(x,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),s.jsx("div",{className:"text-token-text-tertiary w-4",children:e&&s.jsx(Ls,{})})]}):null}const Ks=ge({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}}),Vo=F(()=>O(()=>import("./lm3g1zm00rp6al39.js").then(t=>t.zv),__vite__mapDeps([14,1,12,13,15])),{loading:t=>W(t)}),$o=F(()=>O(()=>import("./hthps8s6hg6mj1wr.js"),__vite__mapDeps([20,1])),{loading:t=>W(t)}),Bo=F(()=>O(()=>import("./mspnxrdz24xb25t6.js"),__vite__mapDeps([21,1,12,13,14,15,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66])).then(t=>t.CanvasFocusedViewManager));var Wo=(t=>(t.TestGizmoAction="test_gizmo_action",t))(Wo||{});const Ho=new Wt;function qo({conversation:t,gizmoHasCustomActions:e,preferredModelId:n}){const{modelLabel:o,dropdownSections:i}=jn(t,e,n),r=s.jsxs(yn,{children:[s.jsx(x,{id:"IhcP1l",defaultMessage:"Model"}),s.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:o}),s.jsx(Vo,{className:"icon-sm text-token-text-tertiary"})]});return s.jsx(Ke,{size:"small",alignOffset:-4,triggerButton:r,children:s.jsx(_n,{sections:i})})}function Qo({gizmoEditorData:t,isSavingDraft:e,showTitle:n=!0}){var G,P,T;const o=ee(),[i,r]=j.useState(()=>Me(o,{urlGizmoId:t.id}));Os(i.id,{kind:me.GizmoTest,gizmo_id:t.id}),j.useEffect(()=>{He(i.id,w=>{w.mode={kind:me.GizmoTest,gizmo_id:t.id}})},[i.id,t.id]);const a=(G=t.files)==null?void 0:G.map(w=>w.file_id).join();j.useEffect(()=>{Ht(i.id)!=null&&r(Me(o,{urlGizmoId:t.id}))},[o,t.id,t.instructions,t.tools,a,i.id]);const f=j.useMemo(()=>({gizmoEditorData:t,mode:"test"}),[t]),l=Us(o,"1213809372"),u=(P=Pe(o))==null?void 0:P.hasPaidFeatures(),M=l||u,[c,k]=j.useState(0),p=()=>{k(w=>w-360)},g=t.id,m=Ko(i);j.useEffect(()=>Es(Ho,{test_gizmo_action:({rootDomain:w,operationName:_})=>{g&&m(g,w,_)}}),[m,g]);const h=j.useCallback(()=>s.jsx("div",{className:"h-full w-full",children:s.jsx(xn,{gizmo:t,hideOwner:!0,showStarterPrompts:!0})}),[t]);return s.jsx(ys.Provider,{value:f,children:s.jsx(bs,{conversation:i,children:s.jsx(Ms,{conversation:i,children:s.jsx(vn,{clientThreadId:i.id,children:s.jsx("div",{className:le("flex h-full w-full",e&&"cursor-wait opacity-80 transition"),children:s.jsxs("div",{className:"flex grow flex-col",children:[s.jsx("div",{className:"relative mb-2 shrink-0",children:s.jsx("div",{className:"flex justify-center py-1",children:n&&s.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[s.jsx("div",{className:"icon"}),s.jsxs("button",{onClick:()=>{p(),r(Me(o,{urlGizmoId:t.id}))},className:"flex items-center gap-2",children:[s.jsx(x,{id:"2u/6Ja",defaultMessage:"Preview"}),s.jsx(As.div,{className:"text-token-text-primary",animate:{rotate:c},transition:{duration:.3},children:s.jsx($o,{className:"icon invisible group-hover:visible"})})]}),M&&s.jsx(qo,{conversation:i,gizmoHasCustomActions:!!$s(t.tools),preferredModelId:(T=t.defaultModel)!=null?T:void 0})]})})}),s.jsxs("div",{className:le("relative grow overflow-auto px-2",e&&"pointer-events-none"),children:[s.jsx(Ws,{conversation:i,hideHeader:!0,renderEmptyState:h()}),s.jsx(Hn.Sidebars,{children:s.jsx(Bo,{clientThreadId:i.id,overrideWidth:0,isAutoFocusDisabled:!0})})]})]})})})})})})}const fs=xs.memo(Qo);function Ko(t){"use forget";const e=pe.c(2);let n;return e[0]!==t?(n=(o,i,r)=>{bn({conversation:t,eventSource:"url",promptMessage:qt("Call the ".concat(i," API with the ").concat(r," operation"),{jit_plugin_data:{from_client:{type:"test",operation:r,tool_name:Qt(i)}}}),completionMetadata:{conversationMode:{kind:me.GizmoTest,gizmo_id:o}}})},e[0]=t,e[1]=n):n=e[1],n}const Yo=F(()=>O(()=>import("./nf2j3wjd224o26ze.js"),__vite__mapDeps([67,1,12,13,68,14,15,69,70,11,16,71,72,73,74,75,76,63,64,61,62,77,55,56,78,54,79,59,60,80,81,82,83,84,85,86,87,88,89])).then(t=>t.GizmoActionsEditor));var Ys=(t=>(t.MAGIC_MAKER="magic",t.ADVANCED="advanced",t.PREVIEW="preview",t))(Ys||{});function Ae({value:t,label:e,testId:n}){return s.jsx(Tn,{value:t,className:"text-md border-token-border-default text-token-text-tertiary hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] w-1/3 grow rounded-lg p-1.5 font-semibold transition md:w-1/2","data-testid":n,children:e})}function Xo({className:t,editorTab:e,setEditorTab:n}){const o=te();return s.jsxs(Pn,{className:le("bg-token-main-surface-secondary flex w-full overflow-hidden rounded-xl p-1.5 md:w-1/2",t),value:e,onValueChange:i=>{n(i)},children:[s.jsx(Ae,{value:"magic",label:o.formatMessage(Re.magicMakerLabel)}),s.jsx(Ae,{value:"advanced",label:o.formatMessage(Re.configureLabel),testId:"gizmo-editor-configure-button"}),s.jsx("div",{className:"flex w-1/3 md:hidden",children:s.jsx(Ae,{value:"preview",label:o.formatMessage(Re.previewLabel)})})]})}function Zo(t,e){return t.length!==e.length?!1:t.every(n=>e.some(o=>o.type===n.type))}function Jo(t,e){var n,o,i,r;return t.name===e.gizmo.display.name&&t.description===e.gizmo.display.description&&t.instructions===e.gizmo.instructions&&Zo(t.tools,e.tools)&&Ve((o=(n=t.files)==null?void 0:n.map(a=>a.file_id))!=null?o:[],(r=(i=e.files)==null?void 0:i.map(a=>a.file_id))!=null?r:[])&&t.profilePictureUrl==e.gizmo.display.profile_picture_url&&t.profilePictureId==e.gizmo.display.profile_pic_id}const Xs=({gizmo:t,onNewGizmoId:e})=>{var Xe;const n=nt(),o=Dt(),i=Vs(be.BrowsingAvailable),r=(o==null?void 0:o.includes(be.GizmoCanvasToggle))&&(o==null?void 0:o.includes(be.Canvas)),a=ee(),f=Us(a,"4148168517"),l=te(),u=xe(),M=()=>{const b=[];i&&b.push({type:X.BROWSER}),r&&b.push({type:X.CANVAS});const A=S(v({},as),{tools:[...as.tools,...b]});return f?S(v({},A),{tools:[...A.tools.filter(L=>L.type!==X.DALLE),{type:X.IMAGE_GEN}]}):A},c=j.useRef(t!=null?us(t):M()),k=j.useRef(t),p=j.useRef(c.current),[g,m]=j.useState(()=>c.current),[h]=j.useState(()=>Me(a)),[G]=j.useState(()=>({context_message:Xn(c.current),model_slug:ze.GPT_4o,enabled_tools:[{tool_id:t!=null?"gizmo_editor":"gizmo_creator"}]}));to(h.id,p.current,G);const P=we(()=>Rs(a,{isGizmo:!0})),T=(Xe=P.models.get(ws))!=null?Xe:P&&Bs(P.models.values(),b=>b.tags.includes(ze.GPT_4o)),{data:w}=en(c.current.id),_=sn(),{isPending:N,error:y}=_,I=tn(),C=j.useMemo(()=>w!=null&&!Jo(g,w),[g,w]),V=async()=>{var A;const b=c.current;try{const L=await _.mutateAsync({editorData:b,gizmoId:b.id});if(k.current=L,c.current.id==null){const q=L.gizmo.id;c.current=S(v({},c.current),{id:q,sharingTargets:L.gizmo.sharing_targets}),m(c.current),e==null||e(q)}for(const q of L.tools.filter(K=>K.type===X.JIT_PLUGIN)){const K=c.current.tools.find(ce=>ce.type===X.JIT_PLUGIN&&ce.metadata.domain===q.metadata.domain);K&&K.metadata.action_id!==q.metadata.action_id&&(K.metadata=S(v({},K.metadata),{action_id:q.metadata.action_id}),m(c.current))}return L}catch(L){const q=(A=zs(L))!=null?A:l.formatMessage(Ks.errorSavingDraft);throw u.warning(q,{duration:2}),L}},z=j.useRef(void 0),U=async()=>c.current.id!=null?c.current.id:(z.current==null&&(z.current=V().then(b=>b.gizmo.id).catch(b=>{throw z.current=void 0,b})),z.current),[B]=j.useState(()=>nn(()=>V(),2e3,{trailing:!0})),d=j.useCallback((b,A=!0)=>{const L=typeof b=="function"?b(c.current):on(c.current,b);Ve(L,c.current)||(c.current=L,m(c.current),A&&B())},[B]),R=j.useRef(void 0);j.useEffect(()=>Es(rn,{completionFinished:async b=>{const A=b.serverThreadId;if(A!=null)try{const L=await Yn(c.current,A,u,R.current);L!=null&&(d(L),p.current=_s(c.current))}catch(L){Le.addError(L),u.warning("Something went wrong generating your GPT",{duration:3})}finally{R.current=ae.getCurrentNode(he(A)).message.id}}}),[u,d]);const[E,H]=j.useState(void 0);j.useEffect(()=>{H(Ln(t))},[t==null?void 0:t.gizmo.id]);const se=async(b,A)=>{var ce,Ze;const L=Qe(c.current,b.recipient,A);if(L.length>0){u.warning("Could not save GPT:\n\n".concat(L.map(ne=>"- ".concat(Ue(ne))).join("\n")),{duration:3});return}const q=await V(),K=q.gizmo.id;try{return Gs.logEvent("Promote Gizmo",{gizmo_id:q.gizmo.id,sharing_recipient:b.recipient,editor_tab:Q}),await I.mutateAsync({gizmoId:q.gizmo.id,data:{sharingSubjects:b.subjects,sharingRecipient:b.recipient,categories:A==null?void 0:[A]}},{onSuccess(Ce){n.setQueryData(rs(n,K).queryKey,Ce),n.invalidateQueries({queryKey:["gizmos"]}),n.invalidateQueries({queryKey:["gizmo",{gizmoId:K}]}),n.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:K}]})}})}catch(ne){if(ne instanceof ln)H({gizmoId:K,sharingRecipient:b.recipient,moderationType:Un.PublishBlocked,sharingTargets:(ce=ne.response)==null?void 0:ce.sharing_targets,showModal:_e.AppealAvailable});else{Le.addError(ne);const Ce=(Ze=ne.detail)!=null?Ze:"An unknown error occurred";u.warning("Error saving GPT - "+Ce,{duration:6})}}},[Q,ve]=j.useState(()=>{const b=os.getItem(is.GizmoEditorTab);return Object.values(Ys).includes(b)?b:"magic"});j.useEffect(()=>an(()=>{const b=wn(a).width;b!=null&&b>=768&&Q==="preview"&&ve("magic")}),[a,Q]);const[Te,Zs]=j.useState(!1),[Ye,Ie]=j.useState(void 0);return s.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[s.jsx(wo,{gizmoEditorData:g,isUpsertLoading:_.isPending,isPromoteLoading:I.isPending,hasUnpublishedChanges:C,isUploadingProfilePic:Te,publishedGizmo:w,updateGizmo:d,promoteGizmo:async(b,A)=>{const L=await se(b,A);return c.current=S(v({},c.current),{sharingRecipient:b.recipient}),m(c.current),os.setItem(is.GizmoEditorTab,Q),L},appealGizmo:async(b,A)=>{E!=null&&H(S(v({},E),{sharingRecipient:b,categories:A==null?void 0:[A],showModal:_e.AppealAvailable}))},setAppealState:H,revertDraft:w!=null&&C?()=>{const b=n.getQueryData(rs(n,c.current.id).queryKey);if(b!=null){const A=us(b);c.current=A,m(A),V()}}:void 0,draftMessage:s.jsx(Fo,{isPublished:w!=null&&(w.gizmo.share_recipient==="marketplace"||w.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:C,isSavingDraft:N,upsertDraftError:y,className:"text-sm"}),showActionsModal:b=>{Ie(b)},className:"shrink-0"}),E&&s.jsx(zn,{appealState:E,onAppealClose:()=>H(S(v({},E),{showModal:_e.None})),onAppealSubmitted:()=>H(S(v({},E),{showModal:_e.AppealSent}))}),s.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[s.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:s.jsx("div",{className:"h-full grow overflow-hidden",children:Ye!==void 0?s.jsx(Yo,{currentlyEditingActionDomain:Ye,gizmoEditorData:g,updateGizmo:d,onClose:()=>{Ie(void 0)}}):s.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[s.jsx("div",{className:"flex w-full flex-row justify-center",children:s.jsx(Xo,{editorTab:Q,setEditorTab:ve,className:"mb-2 shrink-0 self-center"})}),s.jsx("div",{className:"grow overflow-hidden",children:Q==="magic"?s.jsx("div",{className:"h-full w-full",children:s.jsx(oo,{gizmoEditorData:g,updateGizmo:d,clientThreadId:h.id,gizmoEditorDataRef:c,magicMakerBehaviorOverrides:G,magicMakerConversationGizmoEditorDataRef:p,requireGizmoId:U},h.id)}):Q==="advanced"?s.jsx(zo,{gizmoEditorData:g,updateGizmo:d,currentModelConfig:T,setIsUploadingProfilePic:Zs,requireGizmoId:U,onShowActionsEditor:b=>{Ie(b)}}):s.jsx(fs,{gizmoEditorData:g,isSavingDraft:N,showTitle:!1})})]})})}),s.jsx("div",{className:le("border-token-border-medium bg-token-main-surface-secondary hidden w-1/2 justify-center border-s pt-4",Q!=="preview"&&"md:flex"),children:s.jsx("div",{className:"grow",children:s.jsx(fs,{gizmoEditorData:g,isSavingDraft:N})})})]})]})};function Do({gizmoId:t,version:e}){const{data:n}=Yt({gizmoId:t,draft:!0,version:e}),o=Ts(Xt.accountUserId),i=Zt(),r=i==null?void 0:i.id,a=Jt(n)&&n!=null&&o!=null&&r!=null;return n==null||!a?null:s.jsx(Xs,{gizmo:n})}function ei({onNewGizmoId:t}){return s.jsx(Xs,{onNewGizmoId:t})}const si=({gizmoId:t,remixSourceId:e,version:n})=>{const o=fe(),i=ee(),r=Pe(i),a=j.useRef(void 0);j.useEffect(()=>(ns.enterGizmoEditor(),()=>{ns.exitGizmoEditor()}),[]);let f=t;return t!=null&&a.current===t&&(f=void 0),Mn({newChatAction:l=>{In(i,l,{location:"Keyboard command"}),l.defaultPrevented||Cn(o)}}),r?f!==void 0?s.jsx(Do,{gizmoId:f,version:n},f):s.jsx(ei,{remixSourceId:e,onNewGizmoId:l=>{a.current=l,window.history.replaceState(window.history.state,"",Kt(l))}}):s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsx(Ls,{})})},Re=ge({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});function ti(t){const e=fe();j.useEffect(()=>{t||e(cn(dn.NO_ACCESS))},[t,e])}const vi=()=>(kn(),null),ji=ot(function(){const e=ee(),n=Pe(e),o=!!(n!=null&&n.hasPlusFeatures());ti(n==null||o);const i=it(),[r]=rt(),a=fe(),f=i.slug,l=r.get("version"),u=f?un(f):void 0,M=r.get("remixFrom");return j.useEffect(()=>{Gn(!0).then(c=>{Sn.initializeAndGatherData(c),Nn.initializeAndGatherData(c)})},[]),j.useEffect(()=>{n!=null&&!o&&a("/")},[n,a,o]),j.useEffect(()=>{u&&ls(u)&&a("/g/".concat(f,"/project"))},[u,a,f]),!o||u&&ls(u)?null:s.jsx(mn,{children:s.jsx(si,{gizmoId:u,remixSourceId:M!=null?M:void 0,version:l!=null?Number(l):void 0})})});export{Ho as G,Wo as a,vi as c,ji as g};
//# sourceMappingURL=nmhehvf58ksgbtxp.js.map

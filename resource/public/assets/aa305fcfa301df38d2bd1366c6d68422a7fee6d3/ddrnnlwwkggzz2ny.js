import{c as de,al as le,j as B}from"./bubexfvksfr7893o.js";import{u as ue,dU as fe,eg as R,ks as _e,dQ as Ce,nJ as me,mo as ge,ol as pe,oC as ye,fD as Ne,fE as ke,oD as oe,oB as Ie,dZ as Te,d_ as Oe}from"./ncw8zw682jinppua.js";import{bH as be,bq as te}from"./lm3g1zm00rp6al39.js";function Me(t){"use forget";var U,$,W,q,Q,V,z,G,F,H,J,K,X;const e=de.c(34),o=ue(),a=fe();let d;e[0]!==o?(d=()=>pe(o,{}).data,e[0]=o,e[1]=d):d=e[1];const c=R(d),ce=c===void 0;let N;e[2]!==o?(N=()=>{var s;return(s=ye(o,{fetchValidLinksOnly:!0}))==null?void 0:s.data},e[2]=o,e[3]=N):N=e[3];const l=R(N),se=l===void 0;let k;e[4]!==o?(k=()=>Ne(o),e[4]=o,e[5]=k):k=e[5];const f=R(k);let I;e[6]!==o?(I=()=>ke(o),e[6]=o,e[7]=I):I=e[7];const _=R(I),ie=f===void 0||_===void 0,m=_e(),x=Ce(),{mutateAsync:h,isSuccess:L}=me();let T;e[8]===Symbol.for("react.memo_cache_sentinel")?(T={filters:{mutationKey:["upgradeConnectorToSync"]},select:xe},e[8]=T):T=e[8];const S=le(T);let O;e[9]!==a?(O=a==null?void 0:a.getWorkspaceId(),e[9]=a,e[10]=O):O=e[10];const{totalsByConnectorId:b}=be(O);let g;if(e[11]!==S){g=new Set;for(const s of S)s.status==="success"&&g.add(s.variables.link.connector_id);e[11]=S,e[12]=g}else g=e[12];const D=g;let v;if(e[13]!==f||e[14]!==D||e[15]!==l||e[16]!==o||e[17]!==_||e[18]!==x||e[19]!==m||e[20]!==t.referrer||e[21]!==c||e[22]!==b||e[23]!==h||e[24]!==L){const s=new Map;for(const n of f!=null?f:[]){const r=((U=l==null?void 0:l.get(n.id))!=null?U:[]).length>0,u=($=b.get(n.id))!=null?$:0;s.set(n.id,{key:n.id,label:n.name,connected:r,isSync:!1,totalCount:u,icon:B.jsx(te,{connector:n,size:"small"}),onClick:r?void 0:()=>m({connectorId:n.id,noRedirect:!0,referrer:t.referrer})})}for(const n of _!=null?_:[]){const i=n.user_connection_details.connector_id,r=c==null?void 0:c.find(w=>w.id===i);if(!r||!i)continue;const u=(Q=(q=r==null?void 0:r.name)!=null?q:(W=n==null?void 0:n.connection_display_info)==null?void 0:W.display_name)!=null?Q:"",re=D.has(i),Y=((z=i&&((V=s.get(i))==null?void 0:V.connected))!=null?z:!1)||(n==null?void 0:n.user_connection_details.auth_status)==="admin_connected"||(n==null?void 0:n.user_connection_details.auth_status)==="user_connected"||["partially_activated","activated","activating"].includes(n==null?void 0:n.user_connection_details.activation_status)||re,y={key:n.user_connection_details.connection_type,label:u,connected:Y,isSync:!0,totalCount:(G=b.get(i))!=null?G:0,icon:r?B.jsx(te,{connector:r,size:"small"}):B.jsx("img",{src:x&&((F=n==null?void 0:n.connection_display_info)!=null&&F.icon_dark_url)?(H=n==null?void 0:n.connection_display_info)==null?void 0:H.icon_dark_url:(K=(J=n==null?void 0:n.connection_display_info)==null?void 0:J.icon_url)!=null?K:"",alt:u,className:"icon-lg"}),onClick:Y?void 0:()=>m({connectorId:i,noRedirect:!0,referrer:t.referrer})};n.user_connection_details.connection_type===ge.gdrive_sync_connector&&(y.connected=y.connected||L,y.onClick=y.connected?void 0:async()=>{var ee,ne;const w=(ee=c==null?void 0:c.find(Re))==null?void 0:ee.id,Z=(ne=l==null?void 0:l.get(oe))==null?void 0:ne.find(ae=>ae.connector_id===w);Z?(await h({link:Z}),setTimeout(()=>{Ie(o)},1e3)):m({connectorId:Te[Oe.GDRIVE_ACTION_CONNECTOR],noRedirect:!0,referrer:t.referrer})}),s.set(i,y)}v=Array.from(s.values()),e[13]=f,e[14]=D,e[15]=l,e[16]=o,e[17]=_,e[18]=x,e[19]=m,e[20]=t.referrer,e[21]=c,e[22]=b,e[23]=h,e[24]=L,e[25]=v}else v=e[25];const M=v;let p;if(e[26]!==M){const s=new Map,n=Ee;for(const i of M){const r=String((X=i.label)!=null?X:"").toLowerCase().trim(),u=s.get(r);s.set(r,u?n(u,i):i)}p=Array.from(s.values()),p.sort(Ae),e[26]=M,e[27]=p}else p=e[27];const C=p;let A;e[28]!==C?(A=C.filter(ve),e[28]=C,e[29]=A):A=e[29];const P=A.length,j=ie||se||ce;let E;return e[30]!==P||e[31]!==j||e[32]!==C?(E={uniqueItems:C,connectedCount:P,isLoading:j},e[30]=P,e[31]=j,e[32]=C,e[33]=E):E=e[33],E}function ve(t){return t.connected}function Ae(t,e){var d,c;if(t.connected!==e.connected)return Number(e.connected)-Number(t.connected);const o=Number((d=t.totalCount)!=null?d:0),a=Number((c=e.totalCount)!=null?c:0);return o!==a?a-o:0}function Ee(t,e){var d,c;if(t.connected!==e.connected)return e.connected?e:t;if(t.isSync!==e.isSync)return e.isSync?e:t;const o=Number((d=t.totalCount)!=null?d:0),a=Number((c=e.totalCount)!=null?c:0);return o!==a&&a>o?e:t}function Re(t){return t.id===oe}function xe(t){return t.state}export{Me as u};
//# sourceMappingURL=ddrnnlwwkggzz2ny.js.map

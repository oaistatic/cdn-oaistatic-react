const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mfp49cbmiwd1jt8h.js","assets/bubexfvksfr7893o.js"])))=>i.map(i=>d[i]);
var Ee=Object.defineProperty,Ae=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var me=s=>{throw TypeError(s)};var he=(s,e,t)=>e in s?Ee(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,P=(s,e)=>{for(var t in e||(e={}))Le.call(e,t)&&he(s,t,e[t]);if(ge)for(var t of ge(e))Ne.call(e,t)&&he(s,t,e[t]);return s},J=(s,e)=>Ae(s,je(e));var pe=(s,e,t)=>e.has(s)||me("Cannot "+t);var k=(s,e,t)=>(pe(s,e,"read from private field"),t?t.call(s):e.get(s)),O=(s,e,t)=>e.has(s)?me("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),W=(s,e,t,a)=>(pe(s,e,"write to private field"),a?a.call(s,t):e.set(s,t),t);import{c as K,j as l,g as ce,b as ue,_ as Fe,u as ke,h as fe,r as $}from"./bubexfvksfr7893o.js";import{cz as Te,W as X,b7 as Z,az as Pe,aA as Ie,p as Me,dU as Re,dl as qe,ff as Ue,aC as De,dc as ve,m$ as Be,v0 as $e,bG as Ge,h9 as Oe}from"./ncw8zw682jinppua.js";import{y as We,x as He,J as H}from"./lm3g1zm00rp6al39.js";import{r as ze}from"./krengkwf9us2g646.js";import{r as Ve}from"./luif5kl8klbqcpjy.js";const Qe={new:{id:"aardvark.status.new",defaultMessage:"New",description:"New status"},triaged:{id:"aardvark.status.triaged",defaultMessage:"Triaged",description:"Triaged status"},in_progress:{id:"aardvark.status.inProgress",defaultMessage:"In progress",description:"In progress status"},fixed:{id:"aardvark.status.fixed",defaultMessage:"Fixed",description:"Fixed status"},wontfix:{id:"aardvark.status.wontfix",defaultMessage:"Won't fix",description:"Won't fix status"},duplicate:{id:"aardvark.status.duplicate",defaultMessage:"Duplicate",description:"Duplicate status"}},Ke={critical:{id:"aardvark.crit.critical",defaultMessage:"Critical",description:"Critical severity"},high:{id:"aardvark.crit.high",defaultMessage:"High",description:"High severity"},medium:{id:"aardvark.crit.medium",defaultMessage:"Medium",description:"Medium severity"},low:{id:"aardvark.crit.low",defaultMessage:"Low",description:"Low severity"}},Je={none:{id:"aardvark.assignee.none",defaultMessage:"None",description:"None assignee option label"}},xe={search:{id:"aardvark.filter.assignee.search",defaultMessage:"Search by name or email",description:"Search assignees by name or email"}},wt={success:{id:"aardvark.proposedPatch.generation.validation.success",defaultMessage:"Success",description:"Badge label indicating the patch generation or validation is successful."},failed:{id:"aardvark.proposedPatch.generation.validation.failed",defaultMessage:"Failed",description:"Badge label indicating the patch generation or validation is failed."},pending:{id:"aardvark.proposedPatch.generation.validation.pending",defaultMessage:"Pending",description:"Badge label indicating the patch generation or validation is pending."},running:{id:"aardvark.proposedPatch.generation.validation.running",defaultMessage:"Running",description:"Badge label indicating the patch generation or validation is running."},unknown:{id:"aardvark.proposedPatch.generation.validation.unknown",defaultMessage:"Unknown",description:"Badge label indicating the patch generation or validation is unknown."}},kt={security:{id:"aardvark.finding.signal.security",defaultMessage:"Security",description:"Security signal"},privacy:{id:"aardvark.finding.signal.privacy",defaultMessage:"Privacy",description:"Privacy signal"},validated:{id:"aardvark.finding.signal.validated",defaultMessage:"Validated",description:"Validated signal"}},Mt={committedAtHeader:{id:"aardvark.table.committedAtHeader",defaultMessage:"Committed at",description:"Committed at header"},detectedAtHeader:{id:"aardvark.table.detectedAtHeader",defaultMessage:"Detected at",description:"Detected at header"}},_e={statusUpdate:{id:"aardvark.toast.statusError",defaultMessage:"Failed to update status: {details}",description:"Toast message shown when updating a finding's status fails"},assigneeUpdate:{id:"aardvark.toast.assigneeError",defaultMessage:"Failed to update assignee: {details}",description:"Toast message shown when updating the assignee fails"},scanSettingsSave:{id:"aardvark.toast.scanSettingsError",defaultMessage:"Failed to save scan settings: {details}",description:"Toast shown when saving scan settings fails"},findingsLoad:{id:"aardvark.toast.findingsLoadError",defaultMessage:"Failed to load findings: {details}",description:"Toast shown when the findings table fails to load"},recommendedLoad:{id:"aardvark.toast.recommendedLoadError",defaultMessage:"Failed to load recommended findings: {details}",description:"Toast shown when the recommended list fails to load"},findingLoad:{id:"aardvark.toast.findingLoadError",defaultMessage:"Failed to load finding: {details}",description:"Toast shown when the finding details page fails to load"},scanConfigLoad:{id:"aardvark.toast.scanConfigLoadError",defaultMessage:"Failed to load scan configurations: {details}",description:"Toast shown when scan configurations cannot be retrieved"},githubConnection:{id:"aardvark.toast.githubConnectionError",defaultMessage:"GitHub connection error",description:"Toast shown when the GitHub connector fails to load"},githubConnectionInline:{id:"aardvark.home.connectGithub.error",defaultMessage:"We're having trouble connecting to GitHub right now. See console for full error details.",description:"Inline message shown on the Connect GitHub card when the connector is down"},recommendedMissingScan:{id:"aardvark.recommended.missingScan",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Inline error shown when no configured scan exists for the selected repo"},recommendedMissingScanToast:{id:"aardvark.recommended.missingScan.toast",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Toast shown when no configured scan exists for the selected repo"},findingNotFound:{id:"aardvark.finding.details.notFound",defaultMessage:"Finding not found",description:"Message shown when the finding details page fails to load because the finding ID is invalid"}},Ye={success:"bg-green-700/15 text-green-700 dark:bg-green-900/40 dark:text-green-300",warning:"bg-yellow-700/15 text-yellow-700 dark:bg-yellow-900/40 dark:text-yellow-300",critical:"bg-red-700/15 text-red-700 dark:bg-red-900/60 dark:text-red-300",danger:"bg-red-500/15 text-red-500 dark:bg-red-500/15 dark:text-red-300",muted:"bg-token-bg-elevated-secondary text-token-text-tertiary dark:bg-token-bg-elevated-secondary/70 dark:text-token-text-tertiary",purple:"bg-purple-400/15 text-purple-400"};function Xe(s){"use forget";const e=K.c(7),{variant:t,children:a,className:i,size:n}=s,c=(n===void 0?"md":n)==="sm"?"px-1.5 py-0 text-[11px]":"px-2 py-0.5 text-xs",u=Ye[t];let r;e[0]!==i||e[1]!==c||e[2]!==u?(r=Te("inline-flex items-center rounded-full",c,u,i),e[0]=i,e[1]=c,e[2]=u,e[3]=r):r=e[3];let d;return e[4]!==a||e[5]!==r?(d=l.jsx("span",{className:r,children:a}),e[4]=a,e[5]=r,e[6]=d):d=e[6],d}function _t(s){return s.slice(0,7)}function Ct(s){if(!s)return"";try{const e=new URL(s);if(e.pathname.endsWith(".git")&&(e.pathname=e.pathname.slice(0,-4)),e.hostname.includes("github.com")){const t=e.pathname.split("/").filter(Boolean);if(t.length>=2)return"".concat(t[0],"/").concat(t[1])}return e.hostname}catch(e){return s}}function St(s,e){if(!s)return null;try{const t=new URL(s.replace(/\.git$/,""));if(t.hostname.includes("github.com"))return"".concat(t.origin).concat(t.pathname,"/commit/").concat(e)}catch(t){}return null}function Ze(s){try{const e=typeof s=="string"?JSON.parse(s):s;if(e&&typeof e=="object"){const t=e,a={};return Array.isArray(t.relevant_lines)&&(a.relevant_lines=t.relevant_lines),typeof t.cvss_score=="number"&&(a.cvss_score=t.cvss_score),typeof t.criticality_cvss_reason=="string"&&(a.criticality_cvss_reason=t.criticality_cvss_reason),a}}catch(e){}return null}function Et(s){if(!s)return"—";try{const e=new Date(s);return Number.isNaN(e.getTime())?"—":e.toLocaleString()}catch(e){return"—"}}function At(s){if(typeof s!="number"||!Number.isFinite(s))return"—";try{const e=new Date(s*1e3);return Number.isNaN(e.getTime())?"—":e.toLocaleString()}catch(e){return"—"}}function et(s){if(!s)return null;const e=typeof s.path=="string"&&s.path.trim()||typeof s.file_path=="string"&&s.file_path.trim();return e?e.replace(/\\/g,"/"):null}function jt(s,e=3){var n,o,c,u;const t=[...(o=(n=s.commit_analysis)==null?void 0:n.relevant_lines)!=null?o:[]];if(!t.length){const r=Ze((u=(c=s.commit_analysis)==null?void 0:c.proposed_patch)!=null?u:null);r!=null&&r.relevant_lines&&t.push(...r.relevant_lines)}const a=new Map;for(const r of t){const d=et(r);if(!d)continue;const f=d.lastIndexOf("/");if(f<=0)continue;const g=d.slice(0,f);if(!g)continue;const p=g.toLowerCase(),m=a.get(p);m?m.count+=1:a.set(p,{label:g,count:1})}if(a.size===0)return[];const i=Array.from(a.values()).sort((r,d)=>d.count!==r.count?d.count-r.count:r.label.localeCompare(d.label));return i.slice(0,Math.max(e,0)||i.length).map(r=>r.label)}const tt=["application/json"];function st(s){return tt.includes(s)}function ne(s){const e={};for(const[t,a]of Object.entries(s))a!=null&&(e[t]="".concat(a));return e}function at(s,e){for(const[t,a]of Object.entries(e))s=s.replace("{".concat(t,"}"),a);return s}var U,z,V,I,D,B;const Y=class Y{constructor(e,t,a,i,n,o){O(this,U);O(this,z);O(this,V);O(this,I);O(this,D);O(this,B);var c;if(/\/+$/.test(a))throw new Error("The prefix is not allowed to have trailing slashes");if(/\/+$/.test(t))throw new Error("The baseUrl is not allowed to have trailing slashes");W(this,z,a),W(this,B,t),W(this,V,i),W(this,I,n),W(this,U,e),W(this,D,{fetchFn:(c=o==null?void 0:o.fetchFn)!=null?c:fetch.bind(globalThis)})}withProduces(e){return new Y(k(this,U),k(this,B),k(this,z),e,k(this,I),k(this,D))}withConsumes(e){return new Y(k(this,U),k(this,B),k(this,z),k(this,V),e,k(this,D))}withPrefix(e){return new Y(k(this,U),k(this,B),e,k(this,V),k(this,I),k(this,D))}async _request(e,t,a,i){var f,g,p,m;let n=new URLSearchParams(ne((f=a==null?void 0:a.query)!=null?f:{})).toString();n&&(n="?"+n);const o=k(this,B)+k(this,z)+t,c=a==null?void 0:JSON.stringify(a.body),u=c?{"Content-Type":k(this,V)}:null,r=await k(this,D).fetchFn(at(o,ne((g=a==null?void 0:a.path)!=null?g:{}))+n,J(P({credentials:"same-origin"},i!=null?i:{}),{method:e,headers:J(P(P(J(P({},u!=null?u:{}),{Accept:k(this,I)}),(p=i==null?void 0:i.headers)!=null?p:{}),ne((m=a==null?void 0:a.headers)!=null?m:{})),{"X-OpenAI-Client":k(this,U)}),body:c})),d=r.headers.get("Content-Type");if(!d)throw new Error("Content-Type was not provided with the response");if(!st(d))throw new Error("Unsupported return content type ".concat(d));if(d!==k(this,I))throw new Error("Return content type ".concat(d," was provided but this client only accepts ").concat(k(this,I),"."));switch(d){case"application/json":const b=await r.json();return{status:r.status,data:b,raw:r}}}async get(e,...t){return await this._request("GET",e,...t)}async post(e,...t){return await this._request("POST",e,...t)}async put(e,...t){return await this._request("PUT",e,...t)}async patch(e,...t){return await this._request("PATCH",e,...t)}async delete(e,...t){return await this._request("DELETE",e,...t)}async head(e,...t){return await this._request("HEAD",e,...t)}};U=new WeakMap,z=new WeakMap,V=new WeakMap,I=new WeakMap,D=new WeakMap,B=new WeakMap;let le=Y;class ee extends le{constructor(e,t){super("aardvark",e,"","application/json","application/json",t)}}var it=ze();const Lt=ce(it);function nt(s){var e;if(!(typeof s!="object"||s===null)&&typeof((e=s.error)==null?void 0:e.message)=="string")return s.error.message}function te(s,e){var i,n;const t=nt(e),a=t!=null?t:"".concat(s," ").concat((n=(i=e.error)==null?void 0:i.code)!=null?n:"");return new Error(a)}const T=s=>s.split(",").map(e=>e.trim()).filter(e=>e&&e.toLowerCase()!=="all");function rt(s){"use forget";var a,i,n,o,c,u,r,d,f;const e=K.c(40);let t;e:{if(!s){let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=[],e[0]=x):x=e[0];let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h=[],e[1]=h):h=e[1];let G;e[2]===Symbol.for("react.memo_cache_sentinel")?(G=[],e[2]=G):G=e[2];let Q;e[3]===Symbol.for("react.memo_cache_sentinel")?(Q=[],e[3]=Q):Q=e[3];let R;e[4]===Symbol.for("react.memo_cache_sentinel")?(R=[],e[4]=R):R=e[4];let q;e[5]===Symbol.for("react.memo_cache_sentinel")?(q={repoCsv:"",repoList:x,validationFilter:"all",statusesCsv:"",statusList:h,critCsv:"",criticalityList:G,assigneesCsv:"",assigneeList:Q,assigneeEmailsCsv:"",assigneeEmailList:R,authorsCsv:"",authorList:[],sortParam:"",pathPrefixesCsv:"",queryText:""},e[5]=q):q=e[5],t=q;break e}let g,p,m,b,w,j,N,L,S,E,A,y,F,_,v,C;if(e[6]!==s){const x=new URLSearchParams(s),h=(a=x.get("repo"))!=null?a:"",G=x.get("validated"),Q=G==="true"?"validated":G==="false"?"unvalidated":"all",R=(i=x.get("status"))!=null?i:"",q=(n=x.get("criticality"))!=null?n:"",se=(o=x.get("assignee"))!=null?o:"",ae=(c=x.get("assignee_email"))!=null?c:"",ie=(u=x.get("author"))!=null?u:"";m=(r=x.get("sort"))!=null?r:"",g=(d=x.get("path_prefix"))!=null?d:"",p=(f=x.get("q"))!=null?f:"",b=h,S=h?T(h):[],E=Q,A=R,y=R?T(R):[],F=q,_=q?T(q):[],v=se,C=se?T(se):[],w=ae,j=ae?T(ae):[],N=ie,L=ie?T(ie):[],e[6]=s,e[7]=g,e[8]=p,e[9]=m,e[10]=b,e[11]=w,e[12]=j,e[13]=N,e[14]=L,e[15]=S,e[16]=E,e[17]=A,e[18]=y,e[19]=F,e[20]=_,e[21]=v,e[22]=C}else g=e[7],p=e[8],m=e[9],b=e[10],w=e[11],j=e[12],N=e[13],L=e[14],S=e[15],E=e[16],A=e[17],y=e[18],F=e[19],_=e[20],v=e[21],C=e[22];let M;e[23]!==g||e[24]!==p||e[25]!==m||e[26]!==b||e[27]!==w||e[28]!==j||e[29]!==N||e[30]!==L||e[31]!==S||e[32]!==E||e[33]!==A||e[34]!==y||e[35]!==F||e[36]!==_||e[37]!==v||e[38]!==C?(M={repoCsv:b,repoList:S,validationFilter:E,statusesCsv:A,statusList:y,critCsv:F,criticalityList:_,assigneesCsv:v,assigneeList:C,assigneeEmailsCsv:w,assigneeEmailList:j,authorsCsv:N,authorList:L,sortParam:m,pathPrefixesCsv:g,queryText:p},e[23]=g,e[24]=p,e[25]=m,e[26]=b,e[27]=w,e[28]=j,e[29]=N,e[30]=L,e[31]=S,e[32]=E,e[33]=A,e[34]=y,e[35]=F,e[36]=_,e[37]=v,e[38]=C,e[39]=M):M=e[39],t=M}return t}function Nt(s,e){"use forget";const t=K.c(29),{repoCsv:a,validationFilter:i,statusesCsv:n,critCsv:o,assigneesCsv:c,assigneeEmailsCsv:u,authorsCsv:r,sortParam:d,pathPrefixesCsv:f,queryText:g}=rt(s),p=e==null?void 0:e.limit,m=e==null?void 0:e.cursor,b=p!=null?p:null,w=m!=null?m:null,j=d||null,N=f||null,L=g||null;let S;t[0]!==u||t[1]!==c||t[2]!==r||t[3]!==o||t[4]!==a||t[5]!==n||t[6]!==b||t[7]!==w||t[8]!==j||t[9]!==N||t[10]!==L||t[11]!==i?(S=["aardvark","findings","scan",a,i,n,o,c,u,r,b,w,j,N,L],t[0]=u,t[1]=c,t[2]=r,t[3]=o,t[4]=a,t[5]=n,t[6]=b,t[7]=w,t[8]=j,t[9]=N,t[10]=L,t[11]=i,t[12]=S):S=t[12];let E;t[13]!==u||t[14]!==c||t[15]!==r||t[16]!==o||t[17]!==m||t[18]!==p||t[19]!==f||t[20]!==g||t[21]!==a||t[22]!==d||t[23]!==n||t[24]!==i?(E=async()=>{const y={},F=typeof p=="number"&&Number.isFinite(p)&&p>0?p:500,_=typeof m=="number"&&Number.isFinite(m)&&m>=0,v=_?m:0;if(y.limit=String(F),_&&(y.cursor=String(v)),a){const h=T(a);h.length>0&&(y.repo=h.join(","))}if(i==="validated"?y.validated="true":i==="unvalidated"&&(y.validated="false"),d&&(y.sort=d),n){const h=T(n);h.length>0&&(y.status=h.join(","))}if(o){const h=T(o);h.length>0&&(y.criticality=h.join(","))}if(c){const h=T(c);h.length>0&&(y.assignee=h.join(","))}if(u){const h=T(u);h.length>0&&(y.assignee_email=h.join(","))}if(r){const h=T(r);h.length>0&&(y.author=h.join(","))}if(f){const h=T(f);h.length>0&&(y.path_prefix=h.join(","))}const C=g.trim();C&&(y.q=C);const x=await new ee(X).get("/aardvark/scan-findings",{headers:Z(),query:y});if(x.status!==200)throw te(x.status,x.data);return x.data},t[13]=u,t[14]=c,t[15]=r,t[16]=o,t[17]=m,t[18]=p,t[19]=f,t[20]=g,t[21]=a,t[22]=d,t[23]=n,t[24]=i,t[25]=E):E=t[25];let A;return t[26]!==S||t[27]!==E?(A={queryKey:S,queryFn:E,staleTime:3e4,refetchOnWindowFocus:!0},t[26]=S,t[27]=E,t[28]=A):A=t[28],ue(A)}function Ft(s){"use forget";const e=K.c(8),t=s!=null?s:null;let a;e[0]!==t?(a=["aardvark","findings","recommended",t],e[0]=t,e[1]=a):a=e[1];const i=!!t;let n;e[2]!==t?(n=async()=>{var r,d,f,g,p;if(!t)throw new Error("No configured scan id found for recommended findings");const u=await new ee(X).get("/aardvark/rankings",{headers:Z(),query:{configured_scan_id:t}});if(u.status!==200)throw te(u.status,u.data);return{items:(d=(r=u.data.ranking_item_list)==null?void 0:r.map(ot))!=null?d:[],total:(g=(f=u.data.ranking_item_list)==null?void 0:f.length)!=null?g:0,ranking_end_time:(p=u.data.ranking_end_time)!=null?p:null}},e[2]=t,e[3]=n):n=e[3];let o;return e[4]!==a||e[5]!==i||e[6]!==n?(o={queryKey:a,enabled:i,queryFn:n,staleTime:3e4,refetchOnWindowFocus:!0},e[4]=a,e[5]=i,e[6]=n,e[7]=o):o=e[7],ue(o)}function ot(s){return s}function Tt(s){"use forget";const e=K.c(2);let t;return e[0]!==s?(t={queryKey:["aardvark","finding",s],queryFn:async()=>{const i=await new ee(X).get("/aardvark/scan-findings/{id}",{headers:Z(),path:{id:s}});if(i.status!==200)throw te(i.status,i.data);return i.data},staleTime:3e4,refetchInterval:dt,refetchIntervalInBackground:!0,refetchOnWindowFocus:!0},e[0]=s,e[1]=t):t=e[1],ue(t)}function dt(s){const e=s.state.data,t=e==null?void 0:e.proposed_patch;return t?t.status!=="finished"?5e3:t.status==="finished"&&t.success!==!0?1e4:!1:!1}function Ce(s,e,t){s.setQueriesData({queryKey:["aardvark","findings"],exact:!1},a=>{var n;if(!a)return a;const i=((n=a.items)!=null?n:[]).map(o=>o.hid===e?P(P({},o),t):o);return J(P({},a),{items:i})})}function Se(s,e,t){s.setQueryData(["aardvark","finding",e],a=>a&&P(P({},a),t))}const re=Pe(()=>Fe(()=>import("./mfp49cbmiwd1jt8h.js"),__vite__mapDeps([0,1])),{loading:s=>Ie(s)});function ye({name:s,email:e}){var n;const t=(s!=null?s:"").trim();if(t.length>0){const o=t.split(/\s+/).filter(Boolean);return o.length>=2?(o[0][0]+o[o.length-1][0]).toUpperCase():o[0].slice(0,2).toUpperCase()}const a=(n=(e!=null?e:"").split("@")[0])!=null?n:"";if(!a)return"?";const i=a.split(/[._-]+/).filter(Boolean);return i.length>=2?(i[0][0]+i[1][0]).toUpperCase():a.slice(0,2).toUpperCase()}function Pt({finding:s}){var E,A,y,F,_;const e=ke(),t=Me(),a=fe(),i=Re(),n=i==null?void 0:i.getWorkspaceId(),o=i==null?void 0:i.normalizedAccountUserId,[c,u]=$.useState(""),[r,d]=$.useState(!1),f=qe(),{data:g,isLoading:p}=We(n!=null?n:void 0,0,c,100),m=$.useMemo(()=>{var v,C;return{id:o!=null?o:"",email:(v=f==null?void 0:f.email)!=null?v:"",name:(C=f==null?void 0:f.name)!=null?C:void 0}},[o,f==null?void 0:f.email,f==null?void 0:f.name]),b=$.useMemo(()=>{var C;const v=((C=g==null?void 0:g.items)!=null?C:[]).map(M=>{var x,h;return{id:M.account_user_id,email:(x=M.email)!=null?x:"",name:(h=M.name)!=null?h:void 0}}).filter(M=>M.email.length>0);return m.id&&m.email&&(v.some(x=>x.id===m.id||x.email.toLowerCase()===m.email.toLowerCase())||v.unshift(m)),v},[g==null?void 0:g.items,m]),w=(E=s.assignee_id)!=null?E:"none",j=w==="none"?"":(y=(A=s.assignee)==null?void 0:A.email)!=null?y:"",N=w==="none"?void 0:(_=(F=s.assignee)==null?void 0:F.name)!=null?_:"",L=w==="none"?"—":ye({name:N,email:j}),S=async v=>{try{d(!0);const M=await new ee(X).patch("/aardvark/scan-findings/{id}",{headers:Z(),path:{id:s.id},body:{version:s.version,assignee_user_email:v}});if(M.status!==200)throw te(M.status,M.data);Ce(e,s.hid,M.data),Se(e,s.hid,M.data),t.successNeutral(a.formatMessage({id:"aardvark.toast.assigneeUpdated",defaultMessage:"Assignee updated"}),{duration:5,hasCloseButton:!0})}catch(C){const M=C,x=a.formatMessage(_e.assigneeUpdate,{details:M.message});t.danger(x,{duration:5,hasCloseButton:!0})}finally{d(!1)}};return r?l.jsx("button",{disabled:!0,title:j,className:"border-token-border-light bg-token-bg-primary inline-flex h-8 w-8 cursor-not-allowed items-center justify-center rounded-full border text-[11px] font-semibold opacity-60","aria-disabled":!0,children:w==="none"?l.jsx(re,{className:"icon-sm","aria-hidden":!0}):L}):l.jsx(Ue,{triggerButton:l.jsx("button",{title:j,className:"border-token-border-light bg-token-bg-primary inline-flex h-8 w-8 items-center justify-center rounded-full border text-[11px] font-semibold","aria-busy":p,children:w==="none"?l.jsx(re,{className:"icon-sm","aria-hidden":!0}):L}),children:l.jsxs("div",{className:"p-2.5",children:[l.jsx(He,{color:"search",name:"assignee-search",type:"text",value:c,onChange:v=>u(v.target.value),placeholder:a.formatMessage(xe.search),ariaLabel:a.formatMessage(xe.search),className:"text-token-text-tertiary flex h-8 w-full items-center rounded-sm",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full"}),l.jsxs("div",{className:"mt-2 max-h-60 overflow-y-auto",children:[l.jsxs("button",{type:"button",onClick:()=>S(null),className:"hover:bg-token-bg-tertiary flex w-full items-center gap-2 rounded-sm px-2 py-1 text-start text-sm ".concat(w==="none"?"bg-token-bg-tertiary":""),children:[l.jsx("div",{className:"border-token-border-light bg-token-bg-primary inline-flex h-7 w-7 items-center justify-center rounded-full border text-[11px] font-semibold",children:l.jsx(re,{className:"icon-sm","aria-hidden":!0})}),l.jsx("div",{className:"flex flex-col",children:l.jsx("span",{className:"leading-4",children:a.formatMessage(Je.none)})})]},"none"),b.map(v=>{var M;const C=ye({name:v.name,email:v.email});return l.jsxs("button",{type:"button",onClick:()=>S(v.email),className:"hover:bg-token-bg-tertiary flex w-full items-center gap-2 rounded-sm px-2 py-1 text-start text-sm ".concat(v.id===w?"bg-token-bg-tertiary":""),children:[l.jsx("div",{className:"border-token-border-light bg-token-bg-primary inline-flex h-7 w-7 items-center justify-center rounded-full border text-[11px] font-semibold",children:C}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"leading-4",children:(M=v.name)!=null?M:v.email}),l.jsx("span",{className:"text-token-text-tertiary text-xs leading-4",children:v.email})]})]},v.id)})]})]})})}var lt=Ve();const ct=ce(lt);function It({finding:s}){const e=fe(),t=s.status,a=ke(),i=Me(),[n,o]=$.useState(!1),[c,u]=$.useState(!1),[r,d]=$.useState(null),[f,g]=$.useState(""),p=async({id:b,hid:w,payload:j,onSuccess:N,onError:L,setIsSaving:S,intl:E,queryClient:A,toaster:y})=>{try{S(!0);const _=await new ee(X).patch("/aardvark/scan-findings/{id}",{path:{id:b},body:j,headers:Z()});if(_.status!==200)throw te(_.status,_.data);Ce(A,w,_.data),Se(A,w,_.data),y.successNeutral(E.formatMessage({id:"aardvark.toast.statusUpdated",defaultMessage:"Status updated"}),{duration:5,hasCloseButton:!0}),N&&N(_.data)}catch(F){const _=F,v=E.formatMessage(_e.statusUpdate,{details:_.message});y.danger(v),L&&L(_)}finally{S(!1)}},m=async b=>{if(b==="wontfix"||b==="fixed"||b==="duplicate"){d(b),u(!0);return}await p({id:s.id,hid:s.hid,payload:{version:s.version,status:b},setIsSaving:o,intl:e,queryClient:a,toaster:i})};return l.jsxs(l.Fragment,{children:[l.jsxs(H.Root,{value:t,onValueChange:m,disabled:n,children:[l.jsx(H.Trigger,{className:"border-token-border-light bg-token-bg-primary h-7 rounded-md border px-2 text-xs",children:l.jsxs("div",{className:"flex w-full items-center justify-between",children:[l.jsx("div",{className:"truncate",children:l.jsx(H.Value,{})}),l.jsx(H.Icon,{})]})}),l.jsx(H.Portal,{children:l.jsx(H.Content,{align:"start",className:"rounded-lg text-sm",children:ct(Qe,(b,w)=>l.jsx(H.Item,{value:w,children:e.formatMessage(b,{status:w})},w))})})]}),c&&l.jsx(De,{testId:"modal-wontfix-reason",isOpen:!0,onClose:()=>{u(!1),g(""),d(null)},title:r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.title",defaultMessage:"Add PR link"}):r==="duplicate"?e.formatMessage({id:"aardvark.findings.duplicate.title",defaultMessage:"Mark as duplicate"}):e.formatMessage({id:"aardvark.findings.wontfix.title",defaultMessage:"Add reason"}),showCloseButton:!0,primaryButton:l.jsx(ve.Button,{title:r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.save",defaultMessage:"Save"}):e.formatMessage({id:"aardvark.findings.wontfix.save",defaultMessage:"Save"}),color:"primary",loading:n,onClick:async()=>{if(r){if(!f.trim()){i.danger(r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.required",defaultMessage:"Please paste a PR link"}):r==="duplicate"?e.formatMessage({id:"aardvark.findings.duplicate.required",defaultMessage:"Please paste a link to the original scan finding"}):e.formatMessage({id:"aardvark.findings.wontfix.required",defaultMessage:"Please enter a reason"}));return}await p({id:s.id,hid:s.hid,payload:{version:s.version,status:r,resolution_reason:f.trim()},setIsSaving:o,intl:e,queryClient:a,toaster:i,onSuccess:()=>{u(!1),g(""),d(null)}})}}}),secondaryButton:l.jsx(ve.Button,{title:r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.cancel",defaultMessage:"Cancel"}):e.formatMessage({id:"aardvark.findings.wontfix.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:()=>{u(!1),g(""),d(null)}}),children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{children:l.jsx("div",{className:"text-token-text-secondary mt-1 text-sm",children:r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.prompt",defaultMessage:"Which PR merged the fix? Paste the URL."}):r==="duplicate"?e.formatMessage({id:"aardvark.findings.duplicate.prompt",defaultMessage:"Which scan finding does this duplicate? Paste a link to the original finding."}):e.formatMessage({id:"aardvark.findings.wontfix.prompt",defaultMessage:"Why won't this be fixed?"})})}),l.jsx("div",{children:l.jsx("textarea",{value:f,onChange:b=>g(b.target.value),className:"border-token-border-default bg-token-bg-primary text-token-text-primary placeholder:text-token-text-tertiary w-full rounded-lg border p-3 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none",placeholder:r==="fixed"?e.formatMessage({id:"aardvark.findings.fixed.placeholder",defaultMessage:"Paste PR URL (required)"}):r==="duplicate"?e.formatMessage({id:"aardvark.findings.duplicate.placeholder",defaultMessage:"Paste link (required)"}):e.formatMessage({id:"aardvark.findings.wontfix.placeholder",defaultMessage:"Add a short reason (required)"}),rows:5})})]})})]})}var oe,be;function ut(){if(be)return oe;be=1;var s=Be();function e(t,a){var i=[];return s(t,function(n,o,c){a(n,o,c)&&i.push(n)}),i}return oe=e,oe}var de,we;function ft(){if(we)return de;we=1;var s=$e(),e=ut(),t=Ge(),a=Oe();function i(n,o){var c=a(n)?s:e;return c(n,t(o,3))}return de=i,de}var gt=ft();const Rt=ce(gt),ht={critical:"critical",high:"danger",medium:"purple",low:"warning"};function qt(s){"use forget";const e=K.c(6),{level:t}=s,a=fe(),i=ht[t];let n;e[0]!==a||e[1]!==t?(n=a.formatMessage(Ke[t]),e[0]=a,e[1]=t,e[2]=n):n=e[2];const o=n;let c;return e[3]!==o||e[4]!==i?(c=l.jsx(Xe,{variant:i,children:o}),e[3]=o,e[4]=i,e[5]=c):c=e[5],c}export{Pt as A,_e as E,kt as F,wt as P,It as S,Xe as a,Rt as b,St as c,At as d,qt as e,Et as f,ee as g,te as h,Lt as i,Qe as j,Nt as k,jt as l,ct as m,Mt as n,Ft as o,Ze as p,Ct as r,_t as s,Tt as u};
//# sourceMappingURL=h1isumrrk8gn5a51.js.map

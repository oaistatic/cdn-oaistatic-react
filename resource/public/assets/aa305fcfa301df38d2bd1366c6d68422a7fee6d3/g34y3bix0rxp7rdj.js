import{c as E,r as A,j as _,y as P,a5 as v}from"./bubexfvksfr7893o.js";import{nO as h,D as R}from"./ncw8zw682jinppua.js";import{g as N}from"./g4swdbr5jmfp7d0n.js";import{r as x}from"./lm3g1zm00rp6al39.js";const S=window.location.origin,I=()=>{if(!(typeof window>"u"))return window.location.origin},b="/mobile/age-verification/result",C="status",w="inquiry_id",T="error_code",V="error_status";function j(r){"use forget";const e=E.c(7),{inquiryId:t}=r,o=A.useRef(!1),n=A.useRef(F);let s;e[0]!==t?(s=(d,g)=>{if(o.current)return;o.current=!0,n.current();const u=U(t,d,g);window.location.replace(u)},e[0]=t,e[1]=s):s=e[1];const i=s;let a,l;e[2]!==t||e[3]!==i?(a=()=>{if(typeof window>"u")return()=>{n.current()};let d=!0;return(async()=>{const u=I(),y=u?[u]:void 0;try{const m=await N({inquiryId:t,messageTargetOrigin:u,frameAncestors:y,onComplete:c=>{const{status:O}=c;R.addAction("persona.age_verification.webview.complete",{status:O}),i("success")},onCancel:()=>{R.addAction("persona.age_verification.webview.cancelled"),i("cancelled")},onError:c=>{R.addError(c,{area:"persona.age_verification.webview",action:"error"}),i("error",{[T]:p(c.code),[V]:p(c.status)})}});if(!d){m.destroy();return}n.current=()=>{m.destroy(),n.current=q}}catch(m){const c=m;R.addError(c,{area:"persona.age_verification.webview",action:"start"}),i("error")}})(),()=>{d=!1,n.current()}},l=[t,i],e[2]=t,e[3]=i,e[4]=a,e[5]=l):(a=e[4],l=e[5]),A.useEffect(a,l);let f;return e[6]===Symbol.for("react.memo_cache_sentinel")?(f=_.jsx("main",{className:"bg-token-bg-primary text-token-text-primary flex min-h-screen flex-col",children:_.jsx("div",{className:"flex flex-1 items-center justify-center",children:_.jsx(h,{className:"h-12 w-12"})})}),e[6]=f):f=e[6],f}function q(){}function F(){}function U(r,e,t){var s;const o=(s=I())!=null?s:S,n=new URL(b,o);if(n.searchParams.set(C,e),n.searchParams.set(w,r),t)for(const[i,a]of Object.entries(t))a&&n.searchParams.set(i,a);return n.toString()}function p(r){if(r==null)return;const e=String(r).trim();return e===""?void 0:e}function L(r){const t=new URL(r.url).searchParams.get(w);if(!t)throw new Response("Missing inquiryId",{status:400});return t}const Q=r=>(x(),{inquiryId:L(r.request)}),W=P(function(){"use forget";const e=E.c(2),{inquiryId:t}=v();let o;return e[0]!==t?(o=_.jsx(j,{inquiryId:t}),e[0]=t,e[1]=o):o=e[1],o});export{Q as clientLoader,W as default};
//# sourceMappingURL=g34y3bix0rxp7rdj.js.map

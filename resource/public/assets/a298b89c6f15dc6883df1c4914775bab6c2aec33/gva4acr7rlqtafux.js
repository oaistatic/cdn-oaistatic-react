const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mv02x91ggz8bo74w.js","assets/n75kuy1cx6f5mogg.js","assets/ewse8exzafeu10ji.js","assets/root-l2v84m1w.css","assets/hcnw7po3t2ndjshp.js","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css","assets/k6kbayc5yys4ai47.js","assets/neqgr1r8uemp4194.js","assets/kj8rd4pu8k32z2dy.js","assets/d65yyyom1modmtdi.js","assets/fh2tsu8ocsi22jc3.js","assets/ifxxnmh3s31g51fc.js","assets/pauhxwu99lgnazxx.js","assets/iegl1ilokzh5w0cb.js","assets/i0mzhgcuc92krelf.js","assets/fzk9fwuo4wro7wsn.js","assets/euq7ybw4dhrsufo2.js","assets/j2tluvxda4ll72qx.js"])))=>i.map(i=>d[i]);
var ca=Object.defineProperty,da=Object.defineProperties;var ua=Object.getOwnPropertyDescriptors;var zs=Object.getOwnPropertySymbols;var ma=Object.prototype.hasOwnProperty,ha=Object.prototype.propertyIsEnumerable;var Gs=(t,e,a)=>e in t?ca(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,X=(t,e)=>{for(var a in e||(e={}))ma.call(e,a)&&Gs(t,a,e[a]);if(zs)for(var a of zs(e))ha.call(e,a)&&Gs(t,a,e[a]);return t},le=(t,e)=>da(t,ua(e));import{f as as,R as ys,aF as cs,dG as nt,ix as rt,fB as pa,ex as ga,fC as fa,i as se,n5 as Vs,gl as $s,gg as Ys,gn as xa,aT as Sa,jT as va,jS as qs,gk as ba,mf as ya,a6 as os,bq as ds,at as Ze,f$ as ns,Y as _e,Z as we,O as q,cT as ja,eN as wa,T as js,qK as Ca,a9 as es,fI as it,du as lt,fQ as Ma,eQ as ct,x as dt,hE as Na,e6 as _a,e as z,s as Pa,aE as ut,gz as ws,a3 as ka,b as Ta,sH as Ea,ao as Oe,ap as Re,d9 as Ge,sI as Aa,$ as Ks,a0 as Qs,sJ as Oa,aM as Ra,sK as Ha,aR as ne,aN as Ia,br as Cs,aP as me,bJ as Se,aY as Da,f2 as mt,jt as Fa,bj as La,gs as ht,ms as Wa,gt as Ba,sL as Ua,sM as za,d4 as pt,au as Ms,r as ss,lv as Ga,eS as Js,fR as Va,a8 as rs,a2 as $a,px as Ya,P as xe,qh as qa,sN as Ka,aS as Qa,cy as vs,ec as Ja,cw as Xa,aV as Za,fU as eo,w as so,lz as to,so as ao,mp as oo,gB as no,sO as ro,sP as io,am as lo,gW as ke,y as gt,d5 as ft,hD as xt,j as Ve,io as co,gV as Pe,ej as St,ek as vt,bL as uo,dv as mo,m as ho,rk as po,ip as bt,cr as bs,mJ as go,gf as fo,oB as xo,ia as Xs,im as So,fy as vo,fq as yt,iw as bo,an as ze,e5 as jt,mW as wt,eu as Ct,ba as yo,eW as jo,eJ as wo,eK as Mt,iq as Co,bK as Mo,cW as No,eM as _o,f6 as Po,ce as ko,ax as To,kc as Eo,hX as Ao,f5 as Oo,b7 as Ro,eH as Ho,db as Io,q as Do,sQ as Fo,jP as Lo,aa as Wo,f7 as Bo}from"./ewse8exzafeu10ji.js";import{b as Ce,g as Ye,r as x,j as s,M as he,m as $e,n as Nt,d as _t,L as Pt,c as Te,as as Zs,G as et,aw as us,A as Uo,R as Ns,i as zo}from"./n75kuy1cx6f5mogg.js";import{dJ as Go,dK as Vo,dN as $o,N as je,dP as Yo,dQ as qo,dV as Ko,dW as Qo,Y as kt,bv as Tt,rD as Jo,dD as Xo,bL as Zo,bM as en,bN as sn,l as _s,k0 as tn,kM as an,rE as on,rF as nn,j$ as rn,rG as ln,rH as cn,bt as dn,gm as un,pV as Et,rI as At,oR as Ot,rJ as mn,gU as hn,rK as pn,df as gn,mx as ms,iB as de,rL as fn,rM as Rt,rN as Ht,ig as qe,rO as He,mE as xn,rP as Sn,rQ as is,eL as vn,rR as ts,rS as bn,rT as yn,mT as jn,gX as It,rU as wn,b2 as Cn,b1 as Mn,X as Ps,rV as Nn,bj as _n,ib as Pn,rW as kn,rX as Tn,iz as Ie,h6 as Dt,rY as En,bk as An,rZ as On,oV as Ft,pW as Rn,r_ as Hn,p7 as In,r$ as Dn,s0 as Fn,s1 as Ln,qz as Wn,i1 as Bn,fL as Un,cO as zn,u as Gn,i5 as ks,s2 as Vn,jH as $n,cj as Yn,x as qn,s3 as Kn,mV as hs,s4 as Qn,E as Jn,g_ as Lt,iV as Wt,fe as Xn,fd as Zn,e$ as er,s5 as sr,s6 as tr,o$ as ar,j8 as or,dc as Bt,p0 as nr,j0 as rr,o1 as ir,s7 as lr,s8 as cr,s9 as dr,sa as ur,sb as mr,pU as hr,sc as pr,sd as gr,se as fr,dG as xr,sf as Sr,ft as vr,sg as br,lK as yr,sh as jr,si as st,da as wr,d9 as Cr,sj as Mr,sk as Nr,me as _r,mk as Pr,sl as kr,sm as Tr,sn as Er,so as Ar,sp as Or,sq as Rr,sr as Hr,ss as Ir,o4 as tt,iY as Dr,i9 as Fr,st as Lr,su as Wr,jk as Br,sv as Ur,bl as zr,sw as Gr,sx as Vr,sy as $r,sz as Yr,sA as qr,sB as Kr,mz as Qr,sC as Jr,sD as Xr,sE as Zr,sF as ei,sG as si,sH as ti,sI as ai,sJ as oi,sK as ni,sL as ri,sM as ii,sN as li,sO as ci,sP as di,sQ as ui,sR as mi,sS as hi,sT as pi}from"./ny10lj7zpuz89fvf.js";import{C as Ut,S as gi,u as Ts,a as fi}from"./k5jwqq80a0png05z.js";import{M as xi,S as zt,a as Si,u as Es,b as vi,D as bi,c as Gt,d as yi,T as ji}from"./da0anzdj3bll2tbv.js";import"./kg55sov6c624o43c.js";import{F as wi}from"./h2dwuj1m5ps9l7uv.js";import{P as Ci}from"./lksc5q29mjlblqoo.js";import Mi from"./7pd84i0fdyounev7.js";import{I as Ni}from"./ca3g7gcaj954pu3h.js";import{C as _i}from"./kj8rd4pu8k32z2dy.js";import"./d5vv6ct7n3prp63a.js";import{g as Pi}from"./em5q5yhbyv41ft0j.js";const ki=({image:t,onClose:e,onRequestCompletion:a,clientThreadId:o,currentModelId:r,post:l,canDelete:d,onOpenReport:i})=>{var _;const n=Ce(),c=as(),u=Ye(),[m,f]=x.useState("default"),p=Go(),h=x.useRef(null),y=x.useRef(p);x.useEffect(()=>{y.current=p},[p]);const S=x.useCallback(()=>Vo(n),[n]),b=x.useCallback(()=>{t&&f("inpaint")},[t]),g=x.useCallback(()=>{f("default"),y.current.clearAllDrawings()},[]),v=x.useCallback(()=>{t&&$o({url:t.url,fileName:S()})},[t,S]),C=x.useCallback(()=>{var j;return(j=h.current)==null?void 0:j.getImageData()},[]),N=x.useCallback(async()=>{if(window.confirm(n.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await ys.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:l.id}}}),u("/",{replace:!0})}catch(j){c.danger({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post",description:"Error message for deleting a post"},{toastId:"post_receiver_modal.delete_post_error"})}},[l.id,n,c,u]),P=m==="inpaint"?n.formatMessage({id:"TjVqYb",defaultMessage:"Edit Selection"}):(_=l.text)!=null?_:n.formatMessage({id:"htGxHc",defaultMessage:"Image"}),T=x.useCallback(j=>{j.key==="Escape"&&(e(),j.preventDefault())},[e]);return x.useEffect(()=>(document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)),[T]),s.jsx(cs.Root,{isOpen:!0,onClose:e,testId:"modal-lightbox-post-share",shouldIgnoreClickOutside:m==="inpaint",children:s.jsx(cs.Overlay,{children:s.jsxs(cs.Content,{size:"fullscreen",removePopoverStyling:!0,className:"grid min-h-0 grid-rows-[auto_minmax(0,1fr)] overflow-hidden",children:[s.jsxs("header",{className:"flex h-14 w-full items-center justify-between gap-2 px-2 md:px-4",children:[s.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[s.jsx(je,{icon:nt,onClick:e,"aria-label":n.formatMessage({id:"EYLKSm",defaultMessage:"Close"})}),s.jsx("h2",{className:"line-clamp-1 text-base font-medium",children:P})]}),s.jsx("div",{className:"flex items-center gap-2",children:m==="inpaint"?s.jsxs(s.Fragment,{children:[s.jsx(je,{className:"aspect-square",icon:Yo,onClick:p.undoDrawing,disabled:!p.canUndoDrawing,"aria-label":n.formatMessage({id:"OmaTPx",defaultMessage:"Undo"})}),s.jsx(je,{className:"aspect-square",icon:qo,onClick:p.redoDrawing,disabled:!p.canRedoDrawing,"aria-label":n.formatMessage({id:"ZUr4oh",defaultMessage:"Redo"})}),s.jsx(je,{className:"w-auto px-3",onClick:g,children:n.formatMessage({id:"D9xvar",defaultMessage:"Cancel"})})]}):s.jsxs(s.Fragment,{children:[s.jsx(je,{className:"aspect-square",icon:Ko,onClick:b,"aria-label":n.formatMessage({id:"pRGwlp",defaultMessage:"Edit image"})}),s.jsx(je,{className:"aspect-square",icon:Qo,onClick:v,"aria-label":n.formatMessage({id:"9DNHka",defaultMessage:"Download image"})}),s.jsx(je,{className:"aspect-square",icon:kt,onClick:i,"aria-label":n.formatMessage({id:"2gNXdX",defaultMessage:"Report content"})}),d&&s.jsx(je,{className:"aspect-square",icon:Tt,onClick:N,"aria-label":n.formatMessage({id:"rzlDpj",defaultMessage:"Delete post"})})]})})]}),s.jsxs("div",{className:"grid h-full w-full grid-rows-[1fr_auto] items-center overflow-y-auto overscroll-contain",children:[s.jsx("div",{className:"flex h-full w-full items-center justify-center px-4 pb-4",children:t&&s.jsxs("div",{className:"relative inline-block max-h-full rounded bg-neutral-100",children:[s.jsx("img",{src:t.url,alt:P,className:"h-full max-h-[70vh] w-auto max-w-full rounded object-contain",fetchPriority:"high"}),m==="inpaint"&&s.jsx(Jo,{image:t,drawingState:p,drawingCanvasRef:h})]})}),s.jsx("div",{className:"flex w-full justify-center px-4 pb-8",children:s.jsx("div",{className:"w-full max-w-[768px]",children:s.jsx(Ni,{clientThreadId:o,currentModelId:r,onRequestCompletion:a,onClose:e,activeImage:t,currentDrawnShape:p.currentDrawnShape,getImageData:C,onCancelInpaint:g})})})]})]})})})};function Hl({postWithProfile:t,clientThreadId:e,onClose:a}){var o,r;return((o=t.post.attachments[0])==null?void 0:o.kind)==="media_generation"?s.jsx(Ti,{postWithProfile:t,clientThreadId:e,onClose:a}):((r=t.post.attachments[0])==null?void 0:r.kind)==="message_slice"?s.jsx(Ei,{postWithProfile:t,onClose:a}):null}function Ti({postWithProfile:t,clientThreadId:e,onClose:a}){var T;const o=x.useRef(null),[r,l]=x.useState(!1),d=Ye(),{post:i}=t,n=i.attachments[i.attachments.length-1],c={url:n.url,content_type:Ys.ImageAssetPointer,asset_pointer:(T=n.asset_pointer)!=null?T:$s(n.id),width:n.width,height:n.height},u=Ce(),m=xa(),f=Sa(e),p=as(),h=x.useCallback(_=>m.getState().files.find(j=>j.tempId===_),[m]),y=n.url,S=x.useCallback(async _=>{if(o.current){const j=await o.current,M=j?h(j==null?void 0:j.tempId):null;if(M)return M}return o.current=fetch(_).then(j=>j.blob()).then(j=>{const M=new File([j],"image.png",{type:"image/png"}),A=va(M);return qs.uploadFile(m,A,M,ba.Multimodal,[M.type],u,p).then(()=>{const O=h(A);return O&&O.status===ya.Ready&&O.fileId?O:null})}),o.current},[m,u,p,h]),{onRequestCompletion:b,currentModelId:g}=_s(),{isUnauthenticated:v}=os(),C=x.useCallback(async _=>{var j;if(!(!_.promptMessage||v))try{const M=await S(y);if(!M||!M.fileId||!M.fileSpec)return;const A=[{content_type:Ys.ImageAssetPointer,asset_pointer:$s(M.fileId),size_bytes:M.fileSpec.size,width:n.width,height:n.height},..._.promptMessage.content.content_type===ds.MultimodalText||_.promptMessage.content.content_type===ds.Text?_.promptMessage.content.parts:[]],O=le(X({},_),{promptMessage:le(X({},_.promptMessage),{content:{content_type:ds.MultimodalText,parts:A}}),extraStreamParams:le(X({},(j=_.extraStreamParams)!=null?j:{}),{continueFromSharedPostId:i.id})});b(O),qs.reset(m)}catch(M){Ze.addError(new Error("post_receiver_handle_request_failed",{cause:M})),p.danger({id:"postReceiverModal.editImageError",defaultMessage:"Failed to edit the image",description:"Error message for editing an image"},{toastId:"post_receiver_modal.edit_image_error"})}},[n.height,n.width,S,b,m,y,v,p,i.id]),N={id:i.id,archived:!1,transformationId:null,url:c.url,assetPointer:c.asset_pointer,thumbnail:null,width:c.width,height:c.height,title:null,conversationId:f,messageId:i.id},P=x.useCallback(()=>{a(),d("/",{replace:!0})},[a,d]);return s.jsxs(s.Fragment,{children:[s.jsx(ki,{image:N,onClose:P,onRequestCompletion:C,clientThreadId:e,currentModelId:g,post:i,canDelete:!!i.permissions.can_delete,onOpenReport:()=>l(!0)}),r&&s.jsx(Vt,{post:i,onClose:()=>l(!1)})]})}function Ei({postWithProfile:t,onClose:e}){const[a,o]=x.useState(!1),{post:r}=t;return s.jsxs("div",{className:"bg-token-bg-primary absolute start-0 end-0 top-0 bottom-0 h-full w-full",children:[s.jsx(Ai,{post:r,setIsReportModalOpen:o,onClose:e}),s.jsx(tn,{attachments:r.attachments,variant:"fullscreen"}),a&&s.jsx(Vt,{post:r,onClose:()=>o(!1)})]})}function Ai({post:t,setIsReportModalOpen:e,onClose:a,additionalButtons:o}){const r=Ye(),l=Ce(),d=as(),i=x.useCallback(async()=>{if(window.confirm(l.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await ys.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:t.id}}}),r("/",{replace:!0})}catch(n){d.danger({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post",description:"Error message for deleting a post"},{toastId:"post_receiver_modal.delete_post_error"})}},[t.id,l,d,r]);return s.jsx(s.Fragment,{children:s.jsxs($e.div,le(X({className:"flex h-16 w-full px-2 sm:px-4"},an),{children:[s.jsx("div",{className:"flex items-center justify-self-start text-start",children:s.jsx(on,{onClose:()=>{a(),r("/",{replace:!0})}})}),s.jsx("div",{className:"flex w-full flex-1 flex-col items-center justify-center justify-self-stretch",children:s.jsx(nn,{areButtonsFullWidth:!0,post:t,setIsReportModalOpen:e})}),s.jsxs("div",{className:"flex items-center justify-self-end text-end",children:[t.permissions.can_delete&&s.jsx(rn,{tooltip:l.formatMessage({id:"postReceiverModal.deletePost",defaultMessage:"Delete"}),onClick:i,children:s.jsx(Tt,{})}),o]})]}))})}function Vt({post:t,onClose:e}){var i;const a=se(),{data:o}=Zo(a,Vs.Post),r=Ce(),l=en(a,r,t.id,Vs.Post);if(o==null)return null;const d="Report ".concat((i=t.text)!=null?i:"Post");return s.jsx(sn,{reasons:o.reasons,submitReport:l,title:d,onClose:e,header:o.header,subHeader:o.header_explanation})}function Oi(){var o;const t=x.useContext(rt),e=(o=t==null?void 0:t.postWithProfile)==null?void 0:o.post,a=t==null?void 0:t.setIsReportModalOpen;return!e||!a?null:s.jsxs("div",{className:"outline-token-border-default mx-4 flex items-center justify-between gap-2.5 rounded-2xl py-1 ps-4 pe-0.5 outline-1 outline-offset-[-1px]",children:[s.jsx("span",{className:"text-token-text-secondary justify-center text-sm leading-tight",children:s.jsx(he,{id:"e2L5bY",defaultMessage:"Content created using ChatGPT"})}),s.jsx(pa,{size:"default",contentAlign:"end",sideOffset:4,triggerButton:s.jsx(Xo,{className:"rounded-full",label:"",icon:s.jsx(fa,{className:"icon-sm"})}),children:s.jsx(ga.Item,{icon:kt,onClick:()=>a(!0),children:s.jsx(he,{id:"jHHbcM",defaultMessage:"Flag content as unsafe"})})})]})}function Ri(){var o;const t=x.useContext(rt),e=(o=t==null?void 0:t.postWithProfile)==null?void 0:o.post,a=t==null?void 0:t.setIsReportModalOpen;return!e||!a?null:s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(he,{id:"iRpGVT",defaultMessage:"Content created using ChatGPT. <reportButton>Report</reportButton> if unsafe.",values:{reportButton:r=>s.jsx("button",{className:"text-token-text-primary decoration-token-text-primary underline",onClick:()=>{a(!0)},children:r})}})})}function Hi({projectResource:t}){var b,g,v,C,N;const e=Ce(),a=se(),o=(b=t.gizmo)==null?void 0:b.id,r=ns(o),l=_e(we),d=Nt(),i=(()=>{const P=d.pathname.replace(/\/+$/,"");return/^\/g\/[^/]+\/project$/.test(P)})(),c=((N=(C=(v=(g=t.gizmo)==null?void 0:g.sharing)==null?void 0:v.subjects)==null?void 0:C.length)!=null?N:0)>0,u=t.gizmo.display.name,m=q(()=>ln(a,t)),f=q(()=>cn(a,t));if(!(r&&!l&&!i)||t.gizmo.gizmo_type!==ja.PROJECT)return null;const h=u?e.formatMessage(ps.openProjectHome,{projectName:u}):e.formatMessage(ps.openProjectHomeFallback),y=wa(a,t),S=s.jsx(s.Fragment,{children:s.jsx(Pt,{to:y,"aria-label":h,className:"hover:bg-token-bg-tertiary focus-visible:outline-token-outline-primary text-token-text-secondary ms-2 inline-flex h-9 w-9 items-center justify-center rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:s.jsx(un,{color:m,emoji:f,strict:!0,isSharedProject:c})})});return s.jsxs("div",{className:"flex items-center",children:[s.jsx(js,{label:u!=null?u:e.formatMessage(ps.projectNameFallback),children:S}),s.jsx(dn,{className:"icon-sm text-token-text-tertiary","aria-hidden":"true"})]})}const ps=_t({openProjectHome:{id:"threadHeader.openProjectHome",defaultMessage:"Open {projectName} project"},openProjectHomeFallback:{id:"threadHeader.openProjectHomeFallback",defaultMessage:"Open project home"},projectNameFallback:{id:"threadHeader.projectNameFallback",defaultMessage:"Project"}});function Ii(t){"use forget";const e=Te.c(21),{clientThreadId:a,headlineOption:o,starterPromptStyle:r,currentModelId:l,isModelLoaded:d,overrideMessage:i}=t,n=At(),c=ws();let u;e[0]!==c?(u=Ot(c),e[0]=c,e[1]=u):u=e[1];const m=q(u.shouldShowAutocomplete$);let f;e[2]!==a?(f={shouldBeEnabledForDefaultAssistant:!0,clientThreadId:a},e[2]=a,e[3]=f):f=e[3];const p=mn(f),h=n?"keyboard-open:h-[calc(100%-var(--screen-keyboard-height,0px)-var(--composer-height,100px))] h-full motion-safe:[transition:height_0.3s_var(--easing-common)]":"h-full",y=m?"pointer-events-none opacity-0":"opacity-100";let S;e[4]!==h||e[5]!==y?(S=z("text-token-text-primary mt-[var(--screen-optical-compact-offset-amount)] [display:var(--display-hidden-until-loaded,flex)] w-full shrink flex-col items-center justify-center px-4 transition-opacity sm:hidden",h,y),e[4]=h,e[5]=y,e[6]=S):S=e[6];let b;e[7]!==o||e[8]!==i||e[9]!==r?(b=o==="CHATGPT_LOGO"?s.jsx(lt,{className:"inline-block h-12 w-12"}):r!=="tiles"?s.jsx($t,{headlineOption:o,overrideMessage:i}):null,e[7]=o,e[8]=i,e[9]=r,e[10]=b):b=e[10];let g;e[11]!==a||e[12]!==l||e[13]!==d||e[14]!==p||e[15]!==r?(g=r==="chips"||!p?s.jsx(xi,{isModelLoaded:d,currentModelId:l,clientThreadId:a}):r==="tiles"&&d&&l&&a?s.jsx(zt,{}):null,e[11]=a,e[12]=l,e[13]=d,e[14]=p,e[15]=r,e[16]=g):g=e[16];let v;return e[17]!==S||e[18]!==b||e[19]!==g?(v=s.jsxs("div",{className:S,children:[b,g]}),e[17]=S,e[18]=b,e[19]=g,e[20]=v):v=e[20],v}function Di({activeSystemHintType:t,isAnonModeEnabled:e,currentModelId:a}){if(t===ka.Research)return I.deepResearchPlaceholder;const r=Ma(t);if(a==="n7jupd"||r)return I.whatCanIDo}function Fi({clientThreadId:t,currentModelId:e,isModelLoaded:a}){"use forget";const o=se(),{isUnauthenticated:r}=os(),l=Ca(),d=es(o,"4031588851"),i=es(o,"3533083032",{disableExposureLog:!0}),c=(r?i:d).get("headline_option","HELP_WITH"),u=Et({shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t}),f=x.useMemo(()=>{},[null]),p=it(),h=Di({activeSystemHintType:p,isAnonModeEnabled:l,currentModelId:e});return s.jsxs("div",{className:"flex justify-center",children:[s.jsx("div",{className:"mb-7 hidden text-center sm:block",children:c==="CHATGPT_LOGO"?s.jsx(lt,{className:"inline-block h-12 w-12"}):s.jsx($t,{headlineOption:c,overrideMessage:f||h})}),s.jsx(Ii,{headlineOption:c,starterPromptStyle:u,clientThreadId:t,isModelLoaded:a,currentModelId:e,overrideMessage:h})]})}function Li(t){"use forget";var O,L;const e=Te.c(16),{headlineOption:a,overrideMessage:o}=t,r=function(E){const{name:D}=E;return s.jsx(js,{label:n.formatMessage(I.editNicknameTooltip),delayDuration:300,side:"top",children:s.jsx("button",{onClick:()=>{Ge.setAutoHighlightNicknameInput(!0),N("#settings/".concat(ut.Personalization))},style:{textDecoration:"none",transition:"color 0.2s"},onMouseEnter:Bi,onMouseLeave:Wi,children:D})})};let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=function(){const E=[],D=[];E.push("READY_WHEN_YOU_ARE","ON_YOUR_MIND","WHAT_ARE_YOU_WORKING_ON","AGENDA_TODAY","SHOULD_WE_BEGIN"),D.push("GOOD_TO_SEE_YOU","DIVE_IN","HOW_CAN_I_HELP",...E);const W=D[Math.floor(Math.random()*D.length)],$=E[Math.floor(Math.random()*E.length)],U="".concat($," | ").concat(W);Oe.setCookie(Re.headlineMessage,U)},e[0]=l):l=e[0];const d=l,i=function(){var F,w;const E=Oe.getCookie(Re.GreetingName),D=Oe.getCookie(Re.headlineMessage),W=D==null?void 0:D.split("|"),$=(F=W==null?void 0:W[0])==null?void 0:F.trim(),U=(w=W==null?void 0:W[1])==null?void 0:w.trim();return{cookieName:E,isReadyForPersonalized:!!E&&E.length<=m,headline:$,namedHeadline:U}},n=Ce(),c=se(),u=es(c,"1704793646"),m=u.get("name_char_limit",20),[f,p]=x.useState(i),{isUnauthenticated:h}=os(),y=Ta(),S=Ea(!h&&!!y),b=S==null?void 0:S.data,g=hn(),v=u.get("greeting_web",!1),C=u.get("full_name_llm",!1),N=Ye();let P,T;e[1]!==y||e[2]!==C||e[3]!==g||e[4]!==v||e[5]!==b?(P=()=>{if(v&&g){if(y&&b){const R=Aa(b,y,C);Oe.setCookie(Re.GreetingName,R),Ks.count(Qs.MOONSHINE,"splashScreenV2.greeting_cookie_name_set_web")}d()}else Oe.deleteCookie(Re.GreetingName),Oe.deleteCookie(Re.headlineMessage)},T=[b,y,v,C,g],e[1]=y,e[2]=C,e[3]=g,e[4]=v,e[5]=b,e[6]=P,e[7]=T):(P=e[6],T=e[7]),x.useEffect(P,T);let _;e[8]!==i||e[9]!==g||e[10]!==v?(_=()=>{const R=()=>{if(v&&g){const{cookieName:E,isReadyForPersonalized:D}=i();p(W=>le(X({},W),{cookieName:E,isReadyForPersonalized:D}))}};return window.addEventListener("refreshGreeting",R),()=>window.removeEventListener("refreshGreeting",R)},e[8]=i,e[9]=g,e[10]=v,e[11]=_):_=e[11],x.useEffect(_);let j,M;e[12]!==g||e[13]!==v?(j=()=>{v&&g&&Ks.count(Qs.MOONSHINE,"splashScreenV2.greeting_shown_web")},M=[v,g],e[12]=g,e[13]=v,e[14]=j,e[15]=M):(j=e[14],M=e[15]),x.useEffect(j,M);let A;return o?A=n.formatMessage(o):f.isReadyForPersonalized&&v?A=s.jsx(s.Fragment,{children:s.jsx(he,le(X({},gs[(O=f.namedHeadline)!=null?O:a].withName),{values:{name:s.jsx(r,{name:(L=f.cookieName)!=null?L:""},"name")}}))}):v&&f.headline?A=n.formatMessage(gs[f.headline].original):A=n.formatMessage(gs[a].original),A}function Wi(t){t.currentTarget.className="text-inherit"}function Bi(t){t.currentTarget.className="text-token-text-secondary"}function $t(t){"use forget";const e=Te.c(23),{headlineOption:a,overrideMessage:o}=t,r=ct(),l=x.useRef(null);let d;e[0]!==r?(d={isTempChatVisible:r,titleTranslate:0},e[0]=r,e[1]=d):d=e[1];const[i,n]=x.useState(d);let c,u;e[2]!==r?(c=()=>{var N,P;n({isTempChatVisible:r,titleTranslate:r?-(((P=(N=l.current)==null?void 0:N.offsetHeight)!=null?P:0)-40):0})},u=[r],e[2]=r,e[3]=c,e[4]=u):(c=e[3],u=e[4]),dt(c,u);const m=Na(),{openSettings:f}=_a();let p;e[5]===Symbol.for("react.memo_cache_sentinel")?(p={viewTransitionName:"var(--vt-splash-screen-headline)"},e[5]=p):p=e[5];let h;e[6]!==a||e[7]!==m||e[8]!==r||e[9]!==f||e[10]!==o||e[11]!==i.isTempChatVisible||e[12]!==i.titleTranslate?(h=m?s.jsxs("div",{className:z("text-page-header flex flex-col items-center gap-2",i.isTempChatVisible?"invisible opacity-0":"opacity-100"),children:[s.jsx("h1",{className:"text-[28px] leading-[34px] font-normal tracking-[0.38px]",children:s.jsx(he,X({},I.developerModeTitle))}),s.jsx("p",{className:"text-token-text-secondary dark:text-token-text-tertiary max-w-md text-center text-base leading-[24px] font-normal tracking-[-0.32px] text-balance",children:s.jsx(he,le(X({},I.developerModeSubtitle),{values:{settings:s.jsx(Pa,{onClick:()=>f(ut.ConnectorsAdvanced),children:s.jsx(he,X({},I.settingsLink))})}}))})]}):s.jsx("h1",{className:z("text-page-header inline-flex min-h-10.5 items-baseline whitespace-pre-wrap",i.isTempChatVisible?"invisible opacity-0":"opacity-100"),"aria-hidden":r,style:{transform:"translateY(".concat(i.titleTranslate,"px)")},children:s.jsx("div",{className:"px-1 text-pretty whitespace-pre-wrap",children:s.jsx(Li,{headlineOption:a,overrideMessage:o})})}),e[6]=a,e[7]=m,e[8]=r,e[9]=f,e[10]=o,e[11]=i.isTempChatVisible,e[12]=i.titleTranslate,e[13]=h):h=e[13];const y=i.isTempChatVisible?"translate-y-0 opacity-100":"invisible translate-y-10 opacity-0";let S;e[14]!==y?(S=z("absolute bottom-0",y),e[14]=y,e[15]=S):S=e[15];const b=!r;let g;e[16]===Symbol.for("react.memo_cache_sentinel")?(g=s.jsx(pn,{}),e[16]=g):g=e[16];let v;e[17]!==S||e[18]!==b?(v=s.jsx("div",{className:S,"aria-hidden":b,ref:l,children:g}),e[17]=S,e[18]=b,e[19]=v):v=e[19];let C;return e[20]!==v||e[21]!==h?(C=s.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl leading-9 font-semibold",children:s.jsx("div",{children:s.jsxs("div",{className:"grid-cols-1 items-center justify-end",style:p,children:[h,v]})})}),e[20]=v,e[21]=h,e[22]=C):C=e[22],C}const I=_t({developerModeTitle:{id:"SplashScreenV2.developerModeTitle",defaultMessage:"Developer mode"},developerModeSubtitle:{id:"SplashScreenV2.developerModeSubtitle",defaultMessage:"Memory is not used for this chat. {settings}"},settingsLink:{id:"SplashScreenV2.settingsLink",defaultMessage:"Settings"},whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whatCanIHelpWithWithName:{id:"SplashScreenV2.whatCanIHelpWith.withName",defaultMessage:"What can I help with, {name}?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},whereShouldWeStartWithName:{id:"SplashScreenV2.whereShouldWeStart.withName",defaultMessage:"Where should we start, {name}?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},askChatgptAnythingWithName:{id:"SplashScreenV2.askChatgptAnything.withName",defaultMessage:"Ask ChatGPT anything, {name}"},shouldWeBegin:{id:"SplashScreenV2.shouldWeBegin",defaultMessage:"Where should we begin?"},goodToSeeYouWithName:{id:"SplashScreenV2.goodToSeeYou.withName",defaultMessage:"Good to see you, {name}."},diveInWithName:{id:"SplashScreenV2.diveInWithName",defaultMessage:"Hey, {name}. Ready to dive in?"},readyWhenYouAre:{id:"SplashScreenV2.readyWhenYouAre",defaultMessage:"Ready when you are."},onYourMind:{id:"SplashScreenV2.onYourMind",defaultMessage:"What’s on your mind today?"},whatAreYouWorkingOn:{id:"SplashScreenV2.whatAreYouWorkingOn",defaultMessage:"What are you working on?"},agendaToday:{id:"SplashScreenV2.agendaToday",defaultMessage:"What’s on the agenda today?"},deepResearchPlaceholder:{id:"G1v9do",defaultMessage:"What are you researching?"},editNicknameTooltip:{id:"SplashScreenV2.editNicknameTooltip",defaultMessage:"Edit nickname"},howCanIHelp:{id:"SplashScreenV2.howCanIHelp",defaultMessage:"How can I help?"},howCanIHelpWithName:{id:"SplashScreenV2.howCanIHelp.withName",defaultMessage:"How can I help, {name}?"},chatgpt:{id:"SplashScreenV2.chatgpt",defaultMessage:"ChatGPT"},whatCanIDo:{id:"SplashScreenV2.whatCanIDo",defaultMessage:"What can I do for you?"}}),gs={HELP_WITH:{original:I.whatCanIHelpWith,withName:I.whatCanIHelpWithWithName},WHERE_TO_START:{original:I.whereShouldWeStart,withName:I.whereShouldWeStartWithName},ASK_CHATGPT:{original:I.askChatgptAnything,withName:I.askChatgptAnythingWithName},HOW_CAN_I_HELP:{original:I.howCanIHelp,withName:I.howCanIHelpWithName},GOOD_TO_SEE_YOU:{original:I.goodToSeeYouWithName,withName:I.goodToSeeYouWithName},DIVE_IN:{original:I.diveInWithName,withName:I.diveInWithName},READY_WHEN_YOU_ARE:{original:I.readyWhenYouAre,withName:I.readyWhenYouAre},ON_YOUR_MIND:{original:I.onYourMind,withName:I.onYourMind},WHAT_ARE_YOU_WORKING_ON:{original:I.whatAreYouWorkingOn,withName:I.whatAreYouWorkingOn},AGENDA_TODAY:{original:I.agendaToday,withName:I.agendaToday},SHOULD_WE_BEGIN:{original:I.shouldWeBegin,withName:I.shouldWeBegin},WHAT_CAN_I_DO:{original:I.whatCanIDo,withName:I.whatCanIDo}},Yt=t=>{var e,a;return(a=(e=ne.getBranch(t))==null?void 0:e.findLast(({message:o})=>o.author.role===Cs.Assistant&&o.recipient==="all"))==null?void 0:a.message},fs=Oa(t=>{const e=Ra(()=>Ha(t)),a=e?Yt(e):null;return Ia(new Set(a?[a.id]:[]))}),Ui=t=>{"use forget";const e=Te.c(40),{clientThreadId:a,zIndex:o,onClick:r,onReveal:l}=t,d=se(),i=Ce();let n;e[0]!==a||e[1]!==d?(n=me(d,a),e[0]=a,e[1]=d,e[2]=n):n=e[2];const c=n;let u;e[3]!==c?(u=()=>fs(c),e[3]=c,e[4]=u):u=e[4];const m=q(u),[f,p]=Se(a,zi),h=gn(p);let y;e[5]!==f?(y=f&&!!Da(f),e[5]=f,e[6]=y):y=e[6];const S=y,b=f==null?void 0:f.id;let g;e[7]!==m||e[8]!==b?(g=b&&m.has(b),e[7]=m,e[8]=b,e[9]=g):g=e[9];const v=g;let C;e[10]!==c||e[11]!==b?(C=()=>{b&&fs.set(c,new Set(fs(c).add(b)))},e[10]=c,e[11]=b,e[12]=C):C=e[12];const N=ms(C);let P;e[13]!==r||e[14]!==N?(P=()=>{N(),r()},e[13]=r,e[14]=N,e[15]=P):P=e[15];const T=ms(P),_=ms(l);let j,M;e[16]!==v||e[17]!==S||e[18]!==_?(j=()=>{S&&!v&&_()},M=[S,v,_],e[16]=v,e[17]=S,e[18]=_,e[19]=j,e[20]=M):(j=e[19],M=e[20]),x.useEffect(j,M);let A,O;e[21]!==v||e[22]!==h||e[23]!==S||e[24]!==N?(O=()=>{if(S&&!v&&!h){const D=setTimeout(()=>N(),5e3);return()=>{clearTimeout(D),N()}}},A=[S,v,h,N],e[21]=v,e[22]=h,e[23]=S,e[24]=N,e[25]=A,e[26]=O):(A=e[25],O=e[26]),x.useEffect(O,A);let L,R;e[27]!==N?(L=()=>()=>N(),R=[N],e[27]=N,e[28]=L,e[29]=R):(L=e[28],R=e[29]),x.useEffect(L,R);let E;return e[30]!==a||e[31]!==T||e[32]!==v||e[33]!==i||e[34]!==h||e[35]!==S||e[36]!==f||e[37]!==N||e[38]!==o?(E=S&&!v&&s.jsx(de,{className:"relative",style:{zIndex:o},children:s.jsxs($e.div,{className:z(fn.main,"group bg-token-bg-primary/80 shadow-long pointer-events-auto absolute -top-2 mx-0 mb-4 h-32 w-full cursor-pointer overflow-hidden rounded-3xl px-5 py-3 backdrop-blur-2xl select-none"),initial:{opacity:0,translateY:"-50%"},animate:{opacity:1,translateY:"-100%"},exit:{opacity:0,scale:.925,filter:"blur(12px)"},transition:{duration:.6,type:"spring",bounce:.12},onClick:T,children:[s.jsx("button",{"aria-label":i.formatMessage({id:"rbCAqY",defaultMessage:"Dismiss"}),className:"dark:bg-token-bg-secondary dark:hover:bg-token-bg-tertiary text-token-text-primary absolute end-2.5 top-2.5 z-50 flex h-6 w-6 items-center justify-center rounded-full bg-black/5 opacity-0 transition-opacity group-hover:opacity-100 hover:bg-black/10",onClick:D=>{D.stopPropagation(),N()},type:"button",children:s.jsx(nt,{className:"icon icon-sm"})}),f&&s.jsx(Mi,{messages:[f],clientThreadId:a,isFeedbackEnabled:!1,isCompletionInProgress:h,hasActiveRequest:h})]})}),e[30]=a,e[31]=T,e[32]=v,e[33]=i,e[34]=h,e[35]=S,e[36]=f,e[37]=N,e[38]=o,e[39]=E):E=e[39],E};function zi(t){return[Yt(t),ne.getRequestId(t)]}const Gi=t=>{"use forget";const e=Te.c(15),{clientThreadId:a,onRequestCompletion:o}=t,r=Rt(a),l=Ht(a),d=mt(a),[i]=Se(a,Vi);let n;if(e[0]!==a||e[1]!==i||e[2]!==(d==null?void 0:d.id)||e[3]!==l||e[4]!==o){let u;e[6]!==a||e[7]!==i.length||e[8]!==(d==null?void 0:d.id)||e[9]!==l||e[10]!==o?(u=(m,f)=>{var p;return s.jsx(Ut,{isFinalTurn:f===i.length-1,turnIndex:f,clientThreadId:a,onRequestCompletion:o,currentModelId:(p=d==null?void 0:d.id)!=null?p:null,scrollToBottom:void 0,scrollToMessageId:void 0,dateHeaderType:l(f),hideUserActions:!0,disableHorizontalPadding:!0},m)},e[6]=a,e[7]=i.length,e[8]=d==null?void 0:d.id,e[9]=l,e[10]=o,e[11]=u):u=e[11],n=i.map(u),e[0]=a,e[1]=i,e[2]=d==null?void 0:d.id,e[3]=l,e[4]=o,e[5]=n}else n=e[5];let c;return e[12]!==r||e[13]!==n?(c=s.jsx("div",{onCopy:r,className:"flex flex-col px-7 text-sm",children:n}),e[12]=r,e[13]=n,e[14]=c):c=e[14],c};function Vi(t){return[ne.getConversationTurnIds(t)]}const xs={duration:.4,type:"spring",bounce:.1},$i=50,at=.5,Ss=is["fullscreen-widget-composer-transition"],Yi=is["fullscreen-popover-thread-opening-transition"],ot=is["fullscreen-popover-thread-closing-transition"],qi=t=>{"use forget";const e=Te.c(74),{clientThreadId:a,onRequestCompletion:o,composerController:r}=t,l=se();let d;e[0]!==a||e[1]!==l?(d=me(l,a),e[0]=a,e[1]=l,e[2]=d):d=e[2];const i=d,n=x.useRef(null),[c,u]=x.useState(!1),[m,f]=x.useState(!1);let p;e[3]!==l?(p=()=>vn(l).height,e[3]=l,e[4]=p):p=e[4];const h=q(p);let y;e[5]!==i?(y=()=>ts(i).height$(),e[5]=i,e[6]=y):y=e[6];const S=q(y);let b;e[7]!==i?(b=()=>ts(i).marginBottom$(),e[7]=i,e[8]=b):b=e[8];const g=q(b);let v;e[9]!==i?(v=qe(i),e[9]=i,e[10]=v):v=e[10];const C=v;let N;e[11]!==C?(N=()=>C.pinnedWidgetType$(),e[11]=C,e[12]=N):N=e[12];const P=q(N);let T;e[13]!==C?(T=()=>C.showLoadingBar$(),e[13]=C,e[14]=T):T=e[14];const _=q(T),j=h*at,M=h-$i-(g!=null?g:0),A=Zs(0),O=Zs(at);let L;e[15]!==A||e[16]!==O?(L=[O,A],e[15]=A,e[16]=O,e[17]=L):L=e[17];let R;e[18]!==M||e[19]!==j||e[20]!==h?(R=H=>{const[G,V]=H;return Math.min(Math.max(G*h-V,j),M)},e[18]=M,e[19]=j,e[20]=h,e[21]=R):R=e[21];const E=et(L,R);let D;e[22]!==C.showLoadingBar$?(D=()=>Fa(La,{requestCompletion:()=>{He({forceFlushSync:!0,className:[Ss,ot],update:()=>{u(!1),C.showLoadingBar$.set(!0)}})},completionFinished:()=>{He({forceFlushSync:!0,className:Ss,update:()=>{C.showLoadingBar$.set(!1)}})}}),e[22]=C.showLoadingBar$,e[23]=D):D=e[23];let W;e[24]!==C?(W=[C],e[24]=C,e[25]=W):W=e[25],x.useEffect(D,W);let $;e[26]!==r?($=()=>{He({forceFlushSync:!0,className:Yi,update:()=>u(!0)});try{ht(r).focus()}catch(H){requestAnimationFrame(()=>{var G;(G=n.current)==null||G.focus()})}},e[26]=r,e[27]=$):$=e[27];const U=$;let F;e[28]!==r||e[29]!==c?(F=()=>!c&&(Wa()&&Ba(r)||Ua(r)),e[28]=r,e[29]=c,e[30]=F):F=e[30];const w=q(F);let Y;e[31]!==M||e[32]!==j?(Y=[j,M],e[31]=M,e[32]=j,e[33]=Y):Y=e[33];let K;e[34]===Symbol.for("react.memo_cache_sentinel")?(K=[0,1],e[34]=K):K=e[34];const Z=et(E,Y,K);let ve;e[35]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx(bn,{},"blur"),e[35]=ve):ve=e[35];let re;e[36]!==a||e[37]!==g||e[38]!==U||e[39]!==P||e[40]!==_?(re=_&&s.jsx(yn,{clientThreadId:a,bottom:g!=null?g:0,onClick:U,pinnedWidgetType:P},"loading-bar"),e[36]=a,e[37]=g,e[38]=U,e[39]=P,e[40]=_,e[41]=re):re=e[41];let te;e[42]!==Z||e[43]!==c?(te=c&&s.jsx($e.div,{initial:{opacity:0},animate:{opacity:Z.get()},style:{opacity:Z},exit:{opacity:0},className:"bg-token-bg-primary/50 pointer-events-auto fixed inset-0 top-(--header-height) opacity-0 backdrop-blur-xs",onClick:()=>{He({forceFlushSync:!0,className:ot,update:()=>{f(!0),u(!1)}}).finished.then(()=>{f(!1)})}},"drag-overlay"),e[42]=Z,e[43]=c,e[44]=te):te=e[44];let ee;e[45]!==a||e[46]!==U||e[47]!==c||e[48]!==C.showLoadingBar$?(ee=!c&&s.jsx(Ui,{zIndex:1,clientThreadId:a,onClick:U,onReveal:()=>{He({forceFlushSync:!0,className:Ss,update:()=>{C.showLoadingBar$.set(!1)}})}},"last-message-banner"),e[45]=a,e[46]=U,e[47]=c,e[48]=C.showLoadingBar$,e[49]=ee):ee=e[49];let ie;e[50]!==te||e[51]!==ee?(ie=s.jsxs(Uo,{children:[te,ee]}),e[50]=te,e[51]=ee,e[52]=ie):ie=e[52];let ae;e[53]!==U||e[54]!==c||e[55]!==w?(ae=!c&&s.jsx(de,{className:z("pointer-events-auto absolute start-0 end-0 top-0 z-[100] flex -translate-y-full justify-center pb-2 opacity-0 transition-opacity hover:opacity-100",w&&"opacity-100"),children:s.jsx("button",{onClick:U,className:"text-token-text-secondary border-token-border-default bg-token-bg-primary/50 relative z-30 flex h-6 w-6 cursor-pointer items-center justify-center rounded-full border bg-clip-padding backdrop-blur-md after:absolute after:-inset-2 after:content-['']",children:s.jsx(xn,{className:"icon-sm text-token-text-primary"})})},"open-button"),e[53]=U,e[54]=c,e[55]=w,e[56]=ae):ae=e[56];let B;e[57]!==E||e[58]!==a||e[59]!==S||e[60]!==A||e[61]!==m||e[62]!==c||e[63]!==M||e[64]!==j||e[65]!==o||e[66]!==O||e[67]!==h?(B=(c||m)&&s.jsx("div",{tabIndex:-1,ref:n,className:z(m?"invisible":"[view-transition-name:fullscreen-popover-thread]","pointer-events-none absolute inset-x-0 bottom-0 mx-auto flex items-center justify-center rounded-3xl focus:ring-0 focus:outline-hidden focus-visible:ring-0 focus-visible:outline-hidden md:bottom-6"),role:"dialog","aria-modal":"true",onClick:Ji,children:s.jsx(de,{children:s.jsxs("div",{className:"relative overflow-visible",children:[s.jsx(Ki,{onDoubleClick:()=>{us(O,(E.get()===M?j:M)/h,xs)},onDragStart:()=>A.set(0),onDragEnd:H=>{const{velocity:G}=H,{y:V}=G,pe=Qi(-V,j,M,E.get());us(O,(pe===M?M:j)/h,xs),us(A,0,xs)},onDrag:H=>{const{delta:G}=H,{y:V}=G;return A.set(A.get()+V)}}),s.jsx("div",{className:"bg-token-bg-primary shadow-long pointer-events-auto mx-0 flex overflow-hidden rounded-t-3xl backdrop-blur-2xl md:-mx-2! md:rounded-[34px]",children:s.jsx($e.div,{className:"relative flex w-full flex-col-reverse overflow-y-auto",style:{height:E,paddingBottom:S!=null?S:0,WebkitMaskImage:"linear-gradient(to bottom, black 0, black calc(100% - 64px), transparent calc(100% - 40px), transparent 100%)",maskImage:"linear-gradient(to bottom, black 0, black calc(100% - 64px), transparent calc(100% - 40px), transparent 100%)"},children:s.jsx(Sn,{children:s.jsx(Gi,{onRequestCompletion:o,clientThreadId:a})})})})]})})},"popover-thread"),e[57]=E,e[58]=a,e[59]=S,e[60]=A,e[61]=m,e[62]=c,e[63]=M,e[64]=j,e[65]=o,e[66]=O,e[67]=h,e[68]=B):B=e[68];let Q;return e[69]!==re||e[70]!==ie||e[71]!==ae||e[72]!==B?(Q=s.jsxs(s.Fragment,{children:[ve,re,ie,ae,B]}),e[69]=re,e[70]=ie,e[71]=ae,e[72]=B,e[73]=Q):Q=e[73],Q},Ki=t=>{"use forget";const e=Te.c(17),{onDrag:a,onDragEnd:o,onDoubleClick:r,onDragStart:l,onPointerUp:d}=t;let i,n,c,u;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={opacity:1},n={opacity:1},c={type:"tween",duration:.1},u={x:0,y:0,transform:"translateY(0px)"},e[0]=i,e[1]=n,e[2]=c,e[3]=u):(i=e[0],n=e[1],c=e[2],u=e[3]);let m;e[4]!==l?(m=()=>{l==null||l()},e[4]=l,e[5]=m):m=e[5];let f;e[6]===Symbol.for("react.memo_cache_sentinel")?(f={left:0,right:0,top:0,bottom:0},e[6]=f):f=e[6];let p;e[7]!==a?(p=(S,b)=>{a==null||a(b)},e[7]=a,e[8]=p):p=e[8];let h;e[9]!==o?(h=(S,b)=>o==null?void 0:o(b),e[9]=o,e[10]=h):h=e[10];let y;return e[11]!==r||e[12]!==d||e[13]!==m||e[14]!==p||e[15]!==h?(y=s.jsx($e.div,{drag:"y",tabIndex:-1,className:"bg-token-border-default pointer-events-auto absolute start-10 end-10 top-0 z-10 h-[4px] cursor-ns-resize rounded-b-full opacity-0 after:absolute after:inset-0 after:top-[-18px] after:h-[28px] after:bg-transparent after:content-['']",whileHover:i,whileDrag:n,transition:c,style:u,onPointerDown:m,dragMomentum:!1,dragSnapToOrigin:!1,dragElastic:!1,dragConstraints:f,onDrag:p,onPointerUp:d,onDragEnd:h,onDoubleClick:r}),e[11]=r,e[12]=d,e[13]=m,e[14]=p,e[15]=h,e[16]=y):y=e[16],y};function Qi(t,e,a,o){if(!(e<=a))throw new Error("min must be <= max");const r=.25,l=8,d=24,i=1200,n=Math.abs(o-e)<=Math.abs(o-a)?e:a,c=o+t*r,u=Math.abs(c-e)<=Math.abs(c-a)?e:a;if(u===n)return n;const m=(n+u)/2,f=Math.sign(u-n)||1,p=m+f*l;if(!(f>0?c>=p:c<=p))return n;const y=Math.abs(t),S=Math.min(y/i,1),b=d*(1-S*S);return Math.abs(c-n)-Math.abs(c-u)<b?n:u}function Ji(t){return t.stopPropagation()}const Xi=({clientThreadId:t,isNewThread:e,isGizmoThread:a,isProjectThread:o,isModelLoaded:r,currentModelId:l,onRequestCompletion:d,shouldUseUnifiedComposer:i,onlyAllowImageUploads:n,isWidgetFullScreen:c=!1,layoutMode:u})=>{const m=se(),f=me(m,t),{height$:p}=ts(f),h=_e(we),y=ws(),{pageType:S}=jn(),b=(S==null?void 0:S.type)==="landing-page",g=za(S==null?void 0:S.type),v=It(t).isOdysseyMode,C=pt(m),N=Ms(),P=as(),T=Ce(),_=ss(m);wn(y);const j=_e(we),M=Ga(m),A=q(Js.sidebarUrlTrayOpen$),O=q(Js.context$),L=it(),R=j&&M&&A,E=es(m,"1925940714"),{platformConnectors:D}=Va(),W=Cn(Mn.hasSeenOdysseyConnectorsModal),$=Se(t,B=>ne.getConversationTurns(B).some(Q=>Q.messages.some(H=>{var G;return(G=H.metadata)==null?void 0:G.n7jupd_message}))),U=Ps(),F=rs(),w=q(()=>qe(me(m,t)).showLoadingBar$()),Y=(U||F)&&$||c&&w;Nn(async()=>{if(!R)return;const B=L?[L]:[],Q=typeof performance<"u"?performance.now():Date.now();try{const H=await ro(O,Wn,B,t),G=Math.round((typeof performance<"u"?performance.now():Date.now())-Q);return H!=null?xe.logEventWithStatsig("kaur1br5: Sidebar context collected","chatgpt_sidebar_context_collected",{duration_ms:G,count:Array.isArray(H)?H.length:1}):xe.logEventWithStatsig("kaur1br5: Sidebar context collection failure","chatgpt_sidebar_context_collection_failure",{duration_ms:G,failure_reason:"null"}),H}catch(H){const G=Math.round((typeof performance<"u"?performance.now():Date.now())-Q),V=H instanceof io;xe.logEventWithStatsig("kaur1br5: Sidebar context collection failure","chatgpt_sidebar_context_collection_failure",X({duration_ms:G,failure_reason:V?"timeout":"error"},H&&typeof H=="object"&&"message"in H?{error_message:String(H.message)}:H?{error_message:String(H)}:{}));return}},()=>R||!E.get("completion_request_blocking_promise_optimization",!1));const K=async B=>{var Me,ge,De,Fe,Le,We,Ke,be;if(((Me=Qa(t))==null?void 0:Me.isLoading)!==!1)return;const Q=()=>{const J=ht(y);ao(J),oo(J,B.contentToSend.content),no(J)},H=await An(B),G=Z((De=(ge=H.promptMessage.metadata)==null?void 0:ge.attachments)!=null?De:[]),V=(Le=(Fe=H.completionMetadata)==null?void 0:Fe.systemHints)==null?void 0:Le.includes(vs),pe=Array.from((We=B.selectedSources)!=null?We:[]).filter(J=>J!=="web")[0];if(V&&pe&&W.eligible){const J=(Ke=Ja[pe])!=null?Ke:pe,Ne=D.get(J);if(Ne){let Ee=!1;Xa(m,On,{connector:Ne,onConfirm:()=>{W.markAsViewed(),Ee=!0,d(H)},onTurnOffConnectors:()=>{Za(t,oe=>{var ce,fe;(ce=oe.selectedSources)!=null||(oe.selectedSources=new Map),oe.selectedSources.set(L,new Set(["web"])),(fe=oe.selectedMCPSources)!=null||(oe.selectedMCPSources=new Map),oe.selectedMCPSources.set(L,new Set),oe.mentionedSources=new Set,eo({selectedSourcesMap:oe.selectedSources,selectedMCPSourcesMap:oe.selectedMCPSources,scope:{userId:_==null?void 0:_.authUserId,workspaceId:_==null?void 0:_.id}})})},onClose:()=>{Ee||Q()}});return}}if(j){const J=!!O,Ne=A===!0;M&&(!J||!Ne)&&so.error("Missing context chip on message send",{clientThreadId:t,hasSidebarContext:J,isContextChipOpen:Ne,contextEnabled:M,isBridgedDesktopSidebar:j,shouldCollectSidebarContext:R}),(be=to())==null||be.triggerProductEvent("messageSent")}G&&d(H)},Z=x.useCallback(B=>{let Q=Ya;const H=B.reduce((V,pe)=>{var Me;return V+((Me=pe.size)!=null?Me:0)},0);v&&(Q=$a(m,"1504865540").get("max_file_size_mb",25));const G=H<=Q*1024*1024;return G||P.danger(T.formatMessage({id:"odyssey.fileTooLarge",defaultMessage:"The attached files are too large. The maximum size is {maxFileSizeMB}MB."},{maxFileSizeMB:Q})),G},[m,T,v,P]),ve=x.useCallback(B=>{xe.logEvent("Continue Completion"),d(_n(B))},[d]),re=Pn.useState(B=>B.isReplayEnabled),te=qa({clientThreadId:t}),ee=Ka({clientThreadId:t});if(te)return s.jsx(kn,{safetyLimited:ee});const ie=s.jsxs(s.Fragment,{children:[s.jsx(Tn,{clientThreadId:t}),s.jsxs(Ie,{ref:Dt({axis:"height",onChange:({height:B})=>p.set(B)}),verticalMargin:"none",verticalPadding:C?"last-standard":"none",horizontalPadding:j?"none":"standard",children:[c&&s.jsx(qi,{clientThreadId:t,composerController:y,onRequestCompletion:d}),s.jsx(de,{className:z(h&&"w-full max-w-full"),children:re?s.jsx(En,{clientThreadId:t},t):Y?s.jsx("div",{className:"pointer-events-none h-14"}):s.jsx(Ci,{clientThreadId:t,currentModelId:l,isNewThread:e,isProjectThread:o,hideHeader:e,onRequestCompletion:K,onContinueGenerating:ve,onlyAllowImageUploads:n,layoutMode:u})})]})]}),ae=e&&s.jsx("div",{className:z("[display:var(--display-hidden-until-loaded,block)] md:absolute md:start-0 md:bottom-8 md:w-full"),children:s.jsx(Ie,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:s.jsx(de,{className:z(h&&"w-full max-w-full"),children:s.jsx(Si,{className:"block flex-1"})})})});return i?s.jsxs(s.Fragment,{children:[!N&&ae,s.jsx("div",{id:"thread-bottom",children:ie}),N&&ae,e&&!b&&!a&&!g&&!v&&!o&&s.jsx(Zi,{clientThreadId:t,currentModelId:l,isModelLoaded:r})]}):ie},Zi=({clientThreadId:t,currentModelId:e,isModelLoaded:a})=>{const o=ws(),r=q(Ot(o).shouldShowAutocomplete$),l=Ft(),d=Et({shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t}),i=Rn(),{shouldShow:n,newUpsellsDismissible:c}=Es({clientThreadId:t,variant:"banner"}),{shouldShow:u}=vi({clientThreadId:t,canShowBanner:!n});return s.jsxs("div",{className:z(r&&"hidden"),children:[s.jsx(Ie,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:s.jsxs(de,{children:[!l&&s.jsx(s.Fragment,{children:s.jsx(Hn,{clientThreadId:t})}),d==="tiles"||d==="hscroll"?a&&e&&t?s.jsx(zt,{className:"mt-10 max-sm:hidden",layout:"carousel"}):null:d==="image_gen_banner"&&i?s.jsx("div",{className:"mt-16 flex justify-center max-sm:hidden",children:s.jsx(In,{})}):d==="chips"?s.jsx(bi,{clientThreadId:t,currentModelId:e,isModelLoaded:a}):null,n&&s.jsx("div",{className:"hidden justify-center pt-8 sm:flex",children:s.jsx(Gt,{isDismissible:c()})}),u&&s.jsx("div",{className:"hidden justify-center pt-8 sm:flex",children:s.jsx(yi,{})})]})}),l&&s.jsxs("div",{className:"thread-sm:flex mt-5 hidden flex-col gap-2",children:[s.jsx(Dn,{}),s.jsx(Fn,{}),s.jsx(Ln,{})]})]})};function el({className:t,threadHeaderDropdown:e,conversationActions:a,superWidgetTabs:o}){const r=se(),l=lo(),d=ke(r),i=!(l&&!gt(r)),n=o!=null?o:s.jsx(gi,{textClassName:d?"text-sm":"text-base"});return d?s.jsx(tl,{className:t,conversationActions:a,threadHeaderDropdown:i&&e,superWidgetTabs:n}):s.jsx(sl,{className:t,conversationActions:a,threadHeaderDropdown:i&&e,superWidgetTabs:n})}function sl({className:t,conversationActions:e,threadHeaderDropdown:a,superWidgetTabs:o}){return s.jsxs("div",{className:z("grid w-full grid-cols-[minmax(max-content,1fr)_auto_minmax(0,1fr)] lg:grid-cols-[1fr_auto_1fr]",Bn("default"),t),children:[s.jsx("div",{className:"col-start-1 row-start-1 justify-self-start pe-2",children:a}),s.jsx("div",{className:"col-span-2 col-start-2 row-start-1 me-7 min-w-0 place-self-center [justify-self:end] lg:col-span-1 lg:me-0 lg:min-w-(--thread-content-max-width) lg:flex-1 lg:[justify-self:center]",children:o}),s.jsx("div",{className:"col-start-3 row-start-1 hidden items-center justify-self-end overflow-visible lg:flex",children:e})]})}function tl({className:t,conversationActions:e,threadHeaderDropdown:a,superWidgetTabs:o}){const r=x.useRef(null),l=x.useRef(null),d=x.useRef(null),i=x.useRef(null);return dt(()=>{const n=r.current,c=l.current,u=d.current,m=i.current;if(!n||!c||!u||!m)return;const f=()=>{const h=n.getBoundingClientRect().width,y=u.getBoundingClientRect().width,S=c.getBoundingClientRect(),b=.5*(h-y),g=S.right>b;u.style.justifySelf=g?"start":"center"},p=new ResizeObserver(f);return p.observe(n,{box:"border-box"}),p.observe(c,{box:"border-box"}),p.observe(u,{box:"border-box"}),f(),()=>{p.disconnect()}},[]),s.jsxs("div",{className:z("h-header-height w-full px-2 sm:grid sm:grid-cols-[minmax(max-content,1fr)_auto_minmax(0,1fr)] sm:px-0",t),ref:r,children:[s.jsx("div",{className:"z-10 col-start-1 row-start-1 hidden self-center justify-self-start pe-2 md:flex",ref:l,children:a}),s.jsx(de,{className:"col-span-3 col-start-1 row-start-1 w-full",children:s.jsx("div",{className:"w-full",ref:i})}),s.jsx("div",{className:z("no-scrollbar col-start-2 row-start-1 -mb-px h-full w-full min-w-0 overflow-x-auto overflow-y-hidden"),ref:d,children:o}),s.jsx("div",{className:"col-start-3 row-start-1 hidden items-center justify-self-end overflow-visible md:flex",children:e})]})}const al=({clientThreadId:t})=>{const e=se(),a=ft(y=>y.activeStageSidebar),o=Un(zn.WorkspaceShareLinks),{isUnauthenticated:r}=os(),l=ct(),d=xt(t),i=ns(d),n=Ve(e,"16480203"),c=Gn(),u=co(),m=_e(Pe),f=o&&!r&&!l&&(!i||n)&&!c&&!u&&!(ke(e)&&m),p=!a,h=m;return s.jsx("div",{className:"flex items-center",id:"conversation-header-actions",children:s.jsx(_i,{showShareButton:f,showProfileDropdown:p,showConversationPrivacyIndicator:h,clientThreadId:t})})},ol=St(()=>vt(()=>import("./mv02x91ggz8bo74w.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(t=>t.GizmoUsingAsOwnerNotice)),nl="text-lg",rl="icon-sm";function il({clientThreadId:t,transparentBackground:e,isEmptyState:a}){var U,F,w,Y;const o=se(),r=ks(o),l=xt(t),d=ns(l),i=Vn(),{data:n}=uo(l),c=ss(o),u=c==null?void 0:c.getWorkspaceId(),m=mo(),{data:f}=ho(u),p=(U=m==null?void 0:m.data.profilePictureUrl)!=null?U:null,h=(F=m==null?void 0:m.data.name)!=null?F:void 0,y=!!(m!=null&&m.isWorkspaceAccount()&&p&&((w=f==null?void 0:f.beta_settings)!=null&&w[po.SHOW_LOGO_IN_HEADER])),S=Ms(),b=bt(),[g,v]=_e(K=>[Pe(K),we(K)]),C=bs(t),N=ft(K=>K.isConversationScrolledFromTop),P=Se(t,ne.hasUserMessage)||!C,T=rs(),_=T&&b,j=Ts()&&P&&!T,M=!l&&!j&&!v,{shouldShow:A}=Es({clientThreadId:t,variant:"pill"}),O=A&&!_,L=!gt(o);go();const R=s.jsx(Lt,{clientThreadId:t,children:s.jsx(al,{clientThreadId:t})}),E=g&&!j?{textClassName:nl,chevronClassName:rl}:{},D=j?s.jsx(el,{threadHeaderDropdown:s.jsx(hs,X({clientThreadId:t},E)),conversationActions:R}):v?s.jsx(Qn,{clientThreadId:t}):S&&(d||!l)?s.jsx(hs,{clientThreadId:t}):s.jsx(hs,X({clientThreadId:t},E)),W=(()=>{const K="[box-shadow:var(--sharp-edge-top-shadow)]",Z="[box-shadow:var(--sharp-edge-top-shadow-placeholder)]";return g&&ke(o)?"":r?Z+" group-data-scroll-from-top/thread:"+K:N?K:Z})(),$=q(()=>qe(me(o,t)).hasPinnedWidget$());return s.jsxs(s.Fragment,{children:[s.jsxs($n,{id:"page-header",className:z("pointer-events-none select-none [view-transition-name:var(--vt-page-header)] *:pointer-events-auto motion-safe:transition",!j&&!v&&"max-md:hidden",a&&"absolute start-0 end-0",d&&C&&"sharp-edge-on-scroll-start sticky top-0",M&&"thread-xl:absolute thread-xl:start-0 thread-xl:end-0 thread-xl:shadow-none!",M&&!T&&!$&&"thread-xl:bg-transparent",e&&!T&&!j&&!v&&"bg-transparent",W,N&&O&&"thread-xl:bg-token-main-surface-primary thread-xl:[box-shadow:var(--sharp-edge-top-shadow)]!"),children:[!v&&!j&&s.jsxs("div",{className:"absolute start-1/2 flex flex-col items-center gap-2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[n==null&&y&&p&&s.jsx(Yn,{src:p,alt:h!=null?h:""}),n!=null&&(c==null?void 0:c.isWorkspaceAccount())&&((Y=n.gizmo.tags)==null?void 0:Y.includes(fo.WorkspaceDisabled))&&s.jsx(ol,{gizmo:n}),s.jsx(qn,{gizmoId:l,clientThreadId:t}),O?s.jsx(ji,{}):null,_&&s.jsx(Ri,{})]}),s.jsxs("div",{className:z("flex",j||v?"w-full":"items-center"),children:[L&&!v&&Ve(o,"2860321732")&&s.jsx(ll,{}),n&&s.jsx(Hi,{projectResource:n}),D]}),!j&&!v&&s.jsx("div",{className:"flex items-center",children:R})]}),i&&s.jsx(Kn,{})]})}const ll=()=>{const t=se(),e=Pe(t),{resetThread:a}=_s();return s.jsx(js,{label:s.jsx(he,{id:"mG13YW",defaultMessage:"New chat"}),contentClassName:"cant-hover:hidden",triggerAs:null,children:s.jsx(Pt,{to:"/",className:z("hover:bg-token-bg-tertiary group touch:h-10 flex aspect-square h-9 items-center justify-center rounded-[10px]",e&&"self-center"),onClick:o=>{o.metaKey||o.ctrlKey?xe.logEventWithStatsig("New Chat Opened In New Tab","chatgpt_new_chat_opened_in_new_tab"):(xe.logNewChatButtonClicked({location:"Anon desktop header"}),a(),o.preventDefault())},children:s.jsxs("div",{children:[s.jsx(xo,{className:"icon-lg -m-1 group-hover:hidden"}),s.jsx(Jn,{className:"icon not-group-hover:hidden"})]})})})};function cl(t){var r;const e=ne.getConversationTurns(t),a=e.findIndex(l=>l.role===Cs.Assistant);if(a===-1)return;const o=e[a];for(let l=0;l<o.messageGroups.length;l++)if(o.messageGroups[l].type===Xs.SearchGPTQuery){const i=o.messageGroups.slice(l+1).find(({type:c})=>c===Xs.Text);if(i==null)return;const n=So(i.messages[0]);if(((r=n==null?void 0:n[0])==null?void 0:r.type)==="navigation")return{turnIndex:a,navigationCitation:n[0],message:i.messages[0]}}}function dl(t,e){var o,r;if(e==null||t==null)return t;const a=new Set(t.domains.map(l=>l.url));return le(X({},t),{domains:[...t.domains,...e.domains.filter(l=>!a.has(l.url))],safe_urls:[...(o=t.safe_urls)!=null?o:[],...(r=e.safe_urls)!=null?r:[]]})}function ul({query:t}){return s.jsx(Ie,{horizontalPadding:"standard",children:s.jsx(de,{className:Wt({isUserTurn:!0}),children:s.jsx("div",{className:Pi(!0),children:s.jsx(Xn,{containsImagesOrAttachments:!1,children:s.jsx(Zn,{text:t})})})})})}function ml({clientThreadId:t,prefetchNavlink:e,clearPrefetchNavlink:a}){var c;const o=x.use(e),r=se(),l=Ve(r,"1032814809");x.useEffect(()=>{window.__oai_SSR_NAVLINK&&er.logEvent("Search Tool Page Load Time To Fast Nav SSR",{server_timing:o==null?void 0:o.timing},window.__oai_SSR_NAVLINK)},[]),x.useEffect(()=>{o==null&&a()},[o,a]);const d=x.useMemo(()=>o==null?null:le(X({},o.navlink),{domains:o.navlink.domains.map(u=>{var m;return le(X({},u),{subtitle:(m=u.subtitle)!=null?m:u.domain})})}),[o]),i=Se(t,cl),n=x.useMemo(()=>dl(d,i==null?void 0:i.navigationCitation),[i,d]);return o==null||n==null?null:s.jsxs("div",{children:[s.jsx("div",{className:"mt-10",children:s.jsx(Ie,{horizontalPadding:"standard",children:s.jsxs(de,{className:Wt({isUserTurn:!1}),children:[s.jsx(sr,{clientThreadId:t,turnIndex:(c=i==null?void 0:i.turnIndex)!=null?c:2,nextMessage:i==null?void 0:i.message,navigationCitation:n}),l?s.jsxs("div",{className:"text-token-text-secondary relative -top-2 flex justify-end gap-2 font-mono text-xs",children:[s.jsxs("div",{elementtiming:"navlink",children:["server: ",o.timing,"ms"]}),s.jsx(hl,{})]}):null]})})}),s.jsx(tr,{scriptSrc:"requestAnimationFrame(()=>window.__oai_SSR_NAVLINK=window.__oai_SSR_NAVLINK||performance.now());"})]})}function hl(){const[t,e]=x.useState(null);return x.useEffect(()=>{const a=new PerformanceObserver(o=>{o.getEntries().forEach(r=>{if(r.identifier==="navlink"){const l=r.renderTime;e(d=>d==null?l:d)}})});return a.observe({type:"element",buffered:!0}),()=>a.disconnect()},[]),t==null?null:s.jsxs("span",{children:["render: ",t,"ms"]})}function pl(t){const{prefetchNavlink:e,clearPrefetchNavlink:a,clientThreadId:o,pageLoadSearchQuery:r}=t,l=se(),d=ks(l),i=Rt(o),n=At(),c=ar(),u=Pe(l),m=we(l),[f]=or(),{isOpen:p}=Bt(),h=c.store.useContentAreaDimensions(nr.Header,g=>g!=null&&g.height?g.height:void 0);let y=null;h||(y=!d&&p?"max-sm:pb-25":"pb-25",(u||m)&&(y=f===rr.Chat?"pb-0":"pb-8"));let S=s.jsx(gl,X({isNewScrollEnabled:d},t));const b=Ts();return b&&(S=s.jsx(fi,{clientThreadId:o,children:S})),S=s.jsx(Lt,{clientThreadId:o,children:S}),s.jsxs("div",{onCopy:i,className:z("flex flex-col text-sm",ke(l)&&b?"pt-4":m?"thread-xl:pt-0 pt-0":"thread-xl:pt-header-height",n&&"keyboard-open:pb-[calc(var(--composer-height,100px)+var(--screen-keyboard-height,0))]",y),style:{paddingBottom:h},children:[r&&s.jsx("div",{children:s.jsx(ul,{query:r})}),e?s.jsx(vo,{name:"prefetch-navlink",onError:g=>{Ze.addError("Error with prefetch navlink",{error:g}),a()},children:s.jsx(x.Suspense,{fallback:null,children:s.jsx(ml,{clientThreadId:o,prefetchNavlink:e,clearPrefetchNavlink:a})})}):null,s.jsx(yt,{children:S})]})}function gl({onRequestCompletion:t,clientThreadId:e,scrollContainerRef:a,isNewScrollEnabled:o}){var $,U,F;const r=se(),l=Pe(r),d=we(r),i=Pe(r)&&bo(r),[n,c,u,m,f,p]=Se(e,w=>[ne.getConversationTurnIds(w),(w==null?void 0:w.conversationOrigin)===Ct.APPLE,w==null?void 0:w.pulseCardId,w==null?void 0:w.scrollToMessageId,i?ne.getConversationTurns(w):null,ne.hasUserMessage(w)]),h=f==null?void 0:f.findIndex(w=>w.role===Cs.User),{data:y}=ir(u),S=u&&!p,b=Ps(),g=rs(),v=bt(),C=lr(),[N]=cr(),P=dr(),[T]=ur(),_=mt(e);mr({isSharedConversation:b,clientThreadId:e}),x.useEffect(()=>{b&&(ze.logEvent("chatgpt_continue_conversation_page_loaded"),xe.logEvent("Continue Conversation: Page Loaded"),ze.logEvent("chatgpt_conversation_share_page_loaded"),xe.logEvent("Share Public Chat: Shared Conversation Loaded"))},[b]);const j=q(()=>e?hr(me(r,e)).activeSystemHintSuggestionChips$():[]),M=x.useCallback(()=>{o||C({behavior:"smooth"})},[o,C]),A=d||ke(r)&&l,[O,L]=x.useState(!1),R=(O||!1)&&!j.length&&!d,E=x.useRef(null),D=Ht(e),W=g&&!v;return s.jsxs(s.Fragment,{children:[W&&s.jsx(Oi,{}),b&&s.jsxs(s.Fragment,{children:[s.jsx(de,{children:s.jsx("p",{className:"text-xs text-gray-500",children:s.jsx(he,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),s.jsx("div",{className:"text-token-text-primary mb-5 text-center text-xs font-semibold",children:s.jsx("button",{onClick:()=>{Ge.openModal(jt.ReportConversation),ze.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),xe.logEvent("Share Public Chat: Report Content Clicked",{location:"Dynamic Shared Thread Page"})},children:s.jsx(he,{id:"thread.reportSharedConversation",defaultMessage:"Report conversation"})})})]}),u&&y&&s.jsx(Ie,{horizontalPadding:"standard",children:s.jsx(de,{children:s.jsx(pr,{imageUrl:(U=($=y.image)==null?void 0:$.url)!=null?U:"",title:(F=y.title)!=null?F:""})})}),n.map((w,Y)=>{var Z;const K=h!==void 0&&Y===h;return s.jsxs(Ns.Fragment,{children:[s.jsx(Ut,{isFinalTurn:Y===n.length-1,turnIndex:Y,clientThreadId:e,onRequestCompletion:t,currentModelId:(Z=_==null?void 0:_.id)!=null?Z:null,scrollToBottom:o?void 0:M,scrollToMessageId:o||S?void 0:m,dateHeaderType:D(Y),hideUserActions:A},w),i&&K&&s.jsx(gr,{})]},w)}),!o&&s.jsxs(s.Fragment,{children:[(a==null?void 0:a.current)&&s.jsx(wt,{setIsScrolledToEdge:w=>{L(w)},options:{root:a.current,threshold:0,rootMargin:"0%"}},"threadBottomEdgeScrollObserver"),s.jsx("div",{ref:E}),c&&N&&!T&&s.jsx(fr,{className:z("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{ze.logEvent("chatgpt_thread_scroll_to_top"),P({behavior:"smooth"})},children:s.jsx(xr,{className:"icon text-token-text-primary"})}),s.jsx(Sr,{show:R,className:z("bottom-[calc(var(--composer-overlap-px)+--spacing(6))]"),onClick:()=>{var w;ze.logEvent("chatgpt_thread_scroll_to_bottom"),(w=E.current)==null||w.scrollIntoView({behavior:"smooth",block:"end"})}})]})]})}const fl=St(()=>vt(()=>import("./iegl1ilokzh5w0cb.js"),__vite__mapDeps([14,1,2,3,15,16,5,6,17,18])));function xl({clientThreadId:t,isNewScrollEnabled:e,pageLoadSearchQuery:a,messagesVerticalAlign:o,footerRootContainerElementRef:r,threadRootRef:l,scrollContainerRef:d,hideHeader:i,isModalView:n=!1,children:c}){const[u]=zo(),m=!!u.get("message"),f=se(),[p,h]=_e(g=>[we(g),Pe(g)]),y=ke(f),S=Se(t,g=>(g==null?void 0:g.conversationOrigin)===Ct.APPLE),b=q(()=>qe(me(f,t)).pinnedWidgetHeight$());if(e)return s.jsx(hi,{allowScrollToEnd:!p,allowScrollToTop:!p&&S,clientThreadId:t,initScrolledToEnd:a==null&&!m,threadFooterRef:r,threadRootRef:l,children:c});{const g=s.jsx("div",{className:"relative h-full",style:{"--pip-widget-height":b?"".concat(b,"px"):"0px"},children:s.jsxs("div",{className:z("flex h-full flex-col overflow-y-auto",!h&&!n&&(b?"pt-(--pip-widget-height)":"thread-xl:pt-(--header-height)"),(h||p)&&y?"thread-sm:[scrollbar-gutter:stable_both-edges] [scrollbar-gutter:stable]":"[scrollbar-gutter:stable_both-edges]",n&&"thread-md:pt-4"),ref:d,children:[s.jsx(wt,{className:"absolute start-0 top-0",setIsScrolledToEdge:v=>{Ge.setIsConversationScrolledFromTop(v)},options:{root:d==null?void 0:d.current}}),c]})});return a!=null?g:s.jsx(yt,{children:s.jsxs(x.Suspense,{fallback:null,children:[s.jsx(pi,{}),g]})})}}const Sl=function({clientThreadId:t,withCustomCompletionParams:e,hideDisclaimer:a,hideHeader:o,messagesVerticalAlign:r="top",renderEmptyState:l,isModalView:d=!1}){"use forget";var Ws,Bs,Us;const i=yo(),n=se(),c=Ft(),u=ks(n),m=Ms(),f=jo(),{data:p}=wo({isGizmo:!!f}),h=vr(t),[y,S,b,g,v,C]=Se(t,k=>[k==null?void 0:k.isLoading,ne.hasUserMessage(k),ne.getConversationTurns(k).length,ne.isArchived(k),k==null?void 0:k.modelId,k?ne.getGizmoId(k):f]),N=Mt(t),{prefetchSearchPromises:P}=_s();x.useEffect(()=>br(n,t),[n,t]);const[T]=x.useState(P==null?void 0:P.query),[_,j]=x.useState(P==null?void 0:P.navlink);x.useEffect(()=>{y||(bs(t)?Ze.addTiming("chatgpt.web.chatPage.renderNewConversation"):Ze.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,y]);const{setTargetedContent:M}=yr(),A=i==null?void 0:i.includes(jr),O=b>=2,[L,R]=_e(k=>[Co(k),we(k)]),E=Ps(),{hash:D}=Nt(),W=Ye(),$=rs(),{isOpen:U}=Bt();x.useEffect(()=>{D==="#report"&&(Ge.openModal(jt.ReportConversation),W({hash:""},{replace:!0}))},[D,W]);const F=!!C,w=bs(t)&&!O&&(st(h)||(h==null?void 0:h.kind)===Mo.GizmoTest)&&!E&&!$&&P==null&&(!L||F),Y=w&&!S&&P==null&&(!L||F),K=R&&!S&&!F,Z=No(p),ve=Z==null?void 0:Z.id,re=_o(n),te=q(()=>{if(re)return Po(me(n,t))}),ee=re?(Ws=te==null?void 0:te.id)!=null?Ws:null:(Bs=v!=null?v:ve)!=null?Bs:null,ie=re?(te==null?void 0:te.id)!=null:!!v,ae=ko.useStore(),{systemHints:B}=To(),Q=(Us=ss(n))==null?void 0:Us.isWorkspaceAccount(),{isOpen:H,isInPreview:G}=wr(),{data:V}=Cr(),pe=H&&G;x.useEffect(()=>{if(ee===Eo)return ae.setActiveSystemHint(vs,B,{locked:!0,analyticsMetadata:{clientThreadId:t}}),()=>{ae.setActiveSystemHint(null,B,{locked:!1,ifPrevSystemHint:vs,analyticsMetadata:{clientThreadId:t}},Q)}},[ee,ae,t,B,Q]);const Me=Ao(p==null?void 0:p.models,ee),ge=Mr(t,h),De=Oo();x.useEffect(()=>{De||M(void 0)},[t,M,De]),x.useEffect(()=>{Ge.setIsConversationScrolledFromTop(!1)},[t]),x.useEffect(()=>{const k=new URLSearchParams(window.location.search),ue=k.get("src");if(ue==="history_search"){k.delete("src");const ye=k.toString(),Ue="".concat(window.location.pathname).concat(ye?"?".concat(ye):"").concat(window.location.hash);window.history.replaceState({},document.title,Ue)}N&&ue==="history_search"&&ys.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:N}},requestBody:{touch:!0},intercomEventOnError:"fetch-error:conversation:edit"}).then(()=>{const ye=Ro(n);Nr(ye,C)})},[n,N,C]);const Fe=Ho(),Le=x.useCallback(k=>{const ue=le(X({ctx:n,clientThreadId:t},e?e(k):k),{updateModelQueryParam:Fe});_r(ue)},[n,t,e,Fe]),We=Pr(),Ke=Io(),be=x.useRef(null);be.current=k=>{w&&!Ke&&!L&&Do(n,"3253785454").get("should_animate_composer",!1)?He({className:is["composer-slide"],update:()=>Le(k)}):Le(k)};const J=x.useCallback(k=>{var ue;return(ue=be.current)==null?void 0:ue.call(be,k)},[be]);x.useEffect(()=>{We.signalTransitionReady()},[We,t]),kr(t,J),Tr(),Er(t),Ar(t),Or(w);const Ne=Rr({clientThreadId:t,handleRequestCompletion:J,prefetchSearchThreadIdPromise:P==null?void 0:P.threadId})&&T==null,Ee=x.useRef(null);x.useEffect(()=>{!$&&!c&&(document.title=ge!=null?ge:"ChatGPT")},[ge,$,c]);const oe=ns(C),ce=F&&oe,fe=Y&&!l&&F&&Fo(n,C),qt=pt(n),Ae=ss(n),Qe=Se(t,k=>k==null?void 0:k.sharedProjectConversationOwner),As=ce&&(Qe==null?void 0:Qe.id)!=null&&Qe.id!==(Ae==null?void 0:Ae.normalizedAccountUserId),Kt=Ae&&!Ae.isTeam()&&!Ae.isEnterprisey(),Os=!a&&!qt&&!R&&!fe&&!(L&&!m)&&!(w&&Kt)&&st(h),Qt=It(t).isOdysseyMode,Rs=x.useRef(null),Hs=x.useRef(null),Is=Hr(k=>k.composerHeight),Ds=!w&&!U&&!R,Jt=Ts()&&ke(n)&&!Y,Je=!ce,Xt=w,Zt=x.useCallback(()=>j(void 0),[]),{isSingleLine:Fs}=Lo(),Ls=!Wo(),Be=q(()=>qe(me(n,t)).displayMode$()==="fullscreen"),{shouldShow:ea,newUpsellsDismissible:sa}=Es({clientThreadId:t,variant:"banner"}),ta=w&&!F&&!Ls?"center":"bottom",{data:Xe}=Ir(),aa=tt(n)&&w&&!Be&&!U&&!Ls&&!F&&!L&&Xe,oa=Dr();function na(){return s.jsx(ci,{clientThreadId:t,scrollContainerRef:Ee})}function ra(){var k,ue;if(y||Ne)return null;if(tt(n)&&pe){const ye=(ue=(k=V==null?void 0:V.survey)==null?void 0:k.survey_config)==null?void 0:ue.overlay_content,Ue=V==null?void 0:V.feedback,ls=V==null?void 0:V.onboarding,{title:ia,body:la}=ye!=null?ye:{};return s.jsx(di,{title:ia,body:la,suggestions:Ue==null?void 0:Ue.suggestions,imageUrls:ls==null?void 0:ls.image_urls})}return Y?fe?s.jsx(ui,{clientThreadId:t,gizmoId:C,currentModelId:ee,onRequestCompletion:J}):l!=null?l:s.jsx(s.Fragment,{children:F?s.jsx(mi,{clientThreadId:t,gizmoId:C,onRequestCompletion:J,currentModelId:ee}):s.jsx(Fi,{clientThreadId:t,currentModelId:ee,isModelLoaded:ie})}):O||T!=null?s.jsx(xl,{clientThreadId:t,isNewScrollEnabled:u,pageLoadSearchQuery:T,messagesVerticalAlign:r,footerRootContainerElementRef:Hs,threadRootRef:Rs,scrollContainerRef:Ee,hideHeader:o,isModalView:d,children:s.jsx(pl,{onRequestCompletion:J,clientThreadId:t,scrollContainerRef:Ee,pageLoadSearchQuery:T,prefetchNavlink:_,clearPrefetchNavlink:Zt},t)}):null}return s.jsx(Fr.Provider,{value:_?"user-query-with-navlink":T?"user-query":null,children:s.jsx(Lr,{serverThreadId:N,children:s.jsx(Wr,{clientThreadId:t,children:s.jsxs(Bo,{clientThreadId:t,children:[s.jsx(bl,{clientThreadId:t,conversationTurnsLength:b}),A&&s.jsx(fl,{}),!$&&!c&&s.jsx(Br,{children:ge!=null&&s.jsx("title",{children:ge})}),s.jsx(Ur.Provider,{value:J,children:s.jsxs(zr,{children:[s.jsx("div",{id:"thread",ref:Rs,className:z("group/thread @container/thread h-full w-full",u&&Xr.threadRoot),children:s.jsxs(wi,{noKeyboard:!0,clientThreadId:t,currentModelConfig:Me,className:z("composer-parent flex flex-col focus-visible:outline-0",!ce&&"overflow-hidden",fe?"min-h-full":"h-full"),children:[ea&&Y&&!fe&&!l&&s.jsx("div",{className:"flex justify-center pt-2 sm:hidden",children:s.jsx(Gt,{isDismissible:sa()})}),!o&&s.jsx(il,{transparentBackground:w&&!fe,clientThreadId:t,isEmptyState:Y}),Ve(n,"1909635392")&&s.jsx(Gr,{clientThreadId:t}),s.jsxs("div",{className:z("relative basis-auto flex-col",Ds&&"-mb-(--composer-overlap-px)",Ds&&(Fs?"[--composer-overlap-px:28px]":"[--composer-overlap-px:55px]"),ce||F||!w?"grow":"shrink",fe?"grid":"flex",!w&&"overflow-hidden",w&&c&&"sm:min-h-[21svh]!",w&&!ce&&!F&&"flex-col justify-end max-sm:grow max-sm:justify-center sm:min-h-[42svh]"),style:{"--composer-height":Is?"".concat(Is,"px"):void 0},children:[oa&&na(),ra(),L&&K&&s.jsx(Vr,{}),Jt&&s.jsx($r,{})]}),s.jsxs("div",{id:"thread-bottom-container",className:z("group/thread-bottom-container relative isolate z-10 w-full basis-auto has-data-has-thread-error:pt-2 has-data-has-thread-error:[box-shadow:var(--sharp-edge-bottom-shadow)] md:border-transparent md:pt-0 dark:border-white/20 md:dark:border-transparent",Be&&"pointer-events-none",!w&&!Be&&"content-fade",Fs&&"single-line",As&&"[--content-fade-height:110px]",As&&"[--content-fade-top:-110px]",w&&"min-h-0",!Os&&!R&&!Qt&&"mb-4",F||ce||!w?"":Je&&w&&"sm:grow",Je&&"flex flex-col",Be&&"z-60"),ref:Hs,children:[g?s.jsx(Yr,{clientThreadId:t}):s.jsxs(s.Fragment,{children:[(!w||Je)&&!U&&s.jsxs(s.Fragment,{children:[s.jsx(Xi,{isGizmoThread:F,isProjectThread:ce,clientThreadId:t,isNewThread:w,currentModelId:ee,onRequestCompletion:J,shouldUseUnifiedComposer:Je,isModelLoaded:ie,layoutMode:ta,isWidgetFullScreen:Be}),m&&w&&Ve(n,"537200474")&&s.jsx(qr,{clientThreadId:t})]}),Xt&&s.jsx(Kr,{clientThreadId:t,isGizmoThread:F,isNewThread:w,isProjectThread:ce})]}),Os?s.jsx("div",{ref:Dt({axis:"height",onChange:({height:k})=>ts(me(n,t)).marginBottom$.set(k)}),className:"text-token-text-secondary relative mt-auto flex min-h-8 w-full items-center justify-center p-2 text-center text-xs [view-transition-name:var(--vt-disclaimer)] md:px-[60px]",children:s.jsx(Qr,{clientThreadId:t})}):null]}),aa&&s.jsx(Jr,{pulseId:Xe.id,caption:Xe.caption,previewItems:Xe.preview_items,onClick:()=>W("/pulse")})]})}),s.jsx(Zr,{clientThreadId:t,isStaticSharedThread:!1,isSharedConversation:E}),s.jsx(ei,{}),s.jsx(si,{conversationId:t}),s.jsx(ti,{}),s.jsx(ai,{})]})})]})})})})},Il=Ns.memo(Sl);function vl({clientThreadId:t,conversationTurnsLength:e}){const a=Mt(t);return oi(a),ni(),ri(),ii(t),li(e,t),null}const bl=Ns.memo(vl);export{al as C,Il as M,Hl as P,Vt as a,Hi as b};
//# sourceMappingURL=gva4acr7rlqtafux.js.map

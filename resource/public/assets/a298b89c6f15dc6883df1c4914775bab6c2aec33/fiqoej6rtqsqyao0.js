var T=Object.defineProperty,b=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var d=(e,t,a)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,u=(e,t)=>{for(var a in t||(t={}))U.call(t,a)&&d(e,a,t[a]);if(g)for(var a of g(t))w.call(t,a)&&d(e,a,t[a]);return e},_=(e,t)=>b(e,k(t));import{D as A,a7 as C,g as I,r as l,j as L}from"./n75kuy1cx6f5mogg.js";import{f as $,fl as m,fm as R,R as x}from"./ewse8exzafeu10ji.js";import{a as P}from"./ci57adu98ddr6ebh.js";const S="chatgpt://oauth_complete";async function y(e,t,a,i){const s=await x.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:e},query:u({code:t,redirect_uri:a},i!=null?{state:i}:{})}});return _(u({},s),{redirect_path:P(s.redirect_path).toString()})}const q=A(function(){const{pluginId:t,code:a,state:i,error:s,errorDesc:c}=C(),o=I(),p=l.useRef(!1);l.useEffect(()=>{if(p.current===!0)return;p.current=!0;async function E(){var f;const O="https://chat.openai.com/aip/".concat(t,"/oauth/callback");try{const r=await y(t,a,O,i);if(r.success)if(r.redirect_path===S)window.location.href=S;else{const n=new URL(m(R.OAUTH_SUCCESS,r.redirect_path),location.origin);n.searchParams.set("oauth_success","true"),o(n.pathname+n.search+n.hash)}else o(m(R.CUSTOM_ERROR,r.redirect_path,(f=r.error)!=null?f:r.message))}catch(r){o({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:t,loginSuccess:"false"}).toString()})}}E()},[t,a,i,o]);const h=$();return l.useEffect(()=>{s&&h.danger("".concat(s).concat(c?": ".concat(c):""),{duration:5,toastId:"oauth_callback: AIPOauth",loggingTitle:s,loggingDescription:c!=null?c:""})},[s,c,h]),L.jsx("div",{})});export{q as default};
//# sourceMappingURL=fiqoej6rtqsqyao0.js.map

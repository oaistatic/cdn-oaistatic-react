import{r as S,j as m}from"./n75kuy1cx6f5mogg.js";import{C as M}from"./f7w0ep5soxjuc5hb.js";import{D as Q,a as X}from"./gvh5p107yczbfviz.js";import{u as Y,i as Z,C as $,g as y}from"./bhfid1ryaups609y.js";import{C as z,T as tt}from"./ctddpbsbr3gj60l1.js";import{C as k}from"./fdv2df7jppwbz4po.js";import{a as ot,b as et,c as rt,d as U}from"./iqk1tse6yz14y9t9.js";import{C as it}from"./ce3hgmw4iyyhicud.js";import{T as nt,a as st,A as P}from"./j91jff36pcuewy8o.js";import{b as mt,eM as lt,bs as R,lA as ct}from"./ny10lj7zpuz89fvf.js";import{cq as at}from"./ewse8exzafeu10ji.js";import{u as ut}from"./j2tluvxda4ll72qx.js";import"./ly9hghfho7bi4z70.js";import"./o423tfdeb6azgv8l.js";import"./cg9mamkqgsk8mjh0.js";import"./ns51nblw8ziscsgd.js";import"./ibchrxf1juu2j0jw.js";import"./hrsgt0zeavq3ouip.js";import"./gvudnmdzjyrmv9hw.js";import"./e52t6kvr8rhywzf0.js";import"./j0qx0vaadhi6g6bi.js";import"./jwqkjcig49ehpyv5.js";import"./ooyih0iwl35v1a7o.js";import"./peahhkmucc5rd7ov.js";import"./jiz6zc3ys9fjr045.js";import"./cl7dmrzdmwy44poc.js";import"./d0p97pwfptqt3nvy.js";import"./hkwix64yhkotslv1.js";import"./5hoqitp3r2hkdtny.js";import"./czwq62q5rbh9b1yi.js";import"./gowyl4x2bs7hfi4a.js";import"./em5q5yhbyv41ft0j.js";import"./irqko7c1s7qpl41n.js";import"./i3bw46mavo9n01l8.js";import"./ga8p3rr9o0mc72h0.js";import"./gbvlxp0nrrwdd6eq.js";import"./kj8rd4pu8k32z2dy.js";import"./d65yyyom1modmtdi.js";import"./fh2tsu8ocsi22jc3.js";import"./ou1s0kowmldvhx32.js";import"./co6h42pxywtlg2op.js";import"./d5vv6ct7n3prp63a.js";import"./npn63o3tt9liv4y2.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./je40yyidw4ukzc9u.js";import"./e79nci3z6bwkg1aw.js";function dt(t,o){const s=t.doc.lineAt(o.from);return o.from===s.from&&o.to-1===s.to}function pt(t){const o=t.dom.querySelector(".cm-gutters");return o?o.offsetWidth:0}const ft=({onAddComment:t,isSendDisabled:o=!1,isWaitingForCommentResponse:s=!1})=>{const i=ot(),f=et(),e=rt(),L=S.useCallback(r=>{const{height:n,width:u}=r,l=i();if(!f||!l)return null;const c=f.selection.asSingle();if(c.ranges.length===0)return null;const a=c.ranges[0],{empty:H,to:O}=a;let{head:g}=a;const{platform:N}=mt();g=N==="web"?g:O;const C=g===O;let v=g;if(C&&dt(f,a)&&(v-=1),H)return null;const{left:h,top:x,bottom:_}=l.contentDOM.getBoundingClientRect(),{left:w,top:G,bottom:b}=at(l.coordsAtPos(v,C?-1:1)),E=pt(l);function A(){if(C)return Math.max(w-h+E-u,E);let d=w-h+E;return d+u>e&&(d=-(u-e)),d}function W(d){const T=n*2,V=d.contentHeight-(b-_)>T&&window.innerHeight-b>T,B=b-x+8,I=G-x-n-8;return C&&V||I<0?{top:B,aboveOrBelow:P.BELOW}:{top:I,aboveOrBelow:P.ABOVE}}const j=W(l);return{left:A(),top:j.top,aboveOrBelow:j.aboveOrBelow,toolbarSize:r}},[f,i,e]),D=S.useCallback(()=>{var r,n;return(n=(r=i())==null?void 0:r.dom)!=null?n:null},[i]);return m.jsx(nt,{onAddComment:t,isWaitingForCommentResponse:s,isSendDisabled:o,toolbarType:st.CODE,getToolbarPosition:L,getEditorDom:D,getSelectionRange:()=>{const r=i();if(!r)return null;const{state:n}=r,u=n.selection.asSingle();if(u.ranges.length===0)return null;const l=u.ranges[0],{from:c,to:a}=l;return c==null||a==null?null:{from:c,to:a,sourceFrom:c,sourceTo:a}}})};function gt({diff:t}){var o;return Y((o=t==null?void 0:t.edits)!=null?o:[]),null}function Ct(t,o,s){const i=s?y():0;return t<=1e3-i?t-(o?z:0):t-(o?tt:0)}const ao=({comments:t,currentlyStreamingLineIndex:o,isPreview:s=!1,isWaitingForCommentResponse:i=!1,isSendDisabled:f=!1,readonlyReason:e,isRequestActive:L=!1,language:D,value:r,textdocDiff:n,maxLength:u,onAcceleratorsExpandedChange:l,onAddComment:c,onAcceptComment:a,onDismissComment:H,onBlur:O,onSave:g,onChange:N,onCancelRequest:C,getStableCommentId:v=ct,commentsMode:h=k.ENABLED,hideToolbar:x,hideAccelerators:_=!1,onSubmitAccelerator:w,modelCursor:G,codemirrorRef:b})=>{var F;const E=S.useRef(null),A=lt(),[{width:W},j]=ut(),d=S.useRef(null),T=t.length>0,V=d.current,B=Ct(W,T,(F=Z(V))!=null?F:!1),I=U(({commentingOn:p})=>p),q=U(({hoveredCommentId:p})=>p),J=U(({focusedCommentId:p})=>p);S.useEffect(()=>{var p;(p=E.current)==null||p.UNSAFE_setValue(r||"")},[r]);const K=W-B;return m.jsx("div",{className:it.code,ref:R(j,d),style:A&&s?{margin:"0 16px"}:{},children:m.jsxs(M,{id:"codemirror",comments:h===k.ALL_HIDDEN?void 0:t,commentingOn:I,currentlyStreamingLineIndex:o,hoveredCommentId:q,focusedCommentId:J,language:D,readonlyReason:e,onChange:N,maxLength:u,value:r,textdocDiff:n,editorRef:R(E,b),width:B,modelCursor:G,isPreview:s,hideLineNumbers:A&&s,onBlur:O,onSave:g,children:[m.jsxs(M.EditorChildren,{children:[!x&&m.jsx(ft,{onAddComment:c,isSendDisabled:f,isWaitingForCommentResponse:i}),h!==k.ALL_HIDDEN&&m.jsx("div",{className:T?"me-4":"",children:m.jsx($,{getStableCommentId:v,availableWidth:K,comments:t,commentsMode:h,onAddComment:c,onAcceptComment:a,onDismissComment:H,isWaitingForCommentResponse:i,isRequestActive:L,disableBlockComments:!0})})]}),m.jsxs(M.ContextChildren,{children:[n&&m.jsx(gt,{diff:n}),!_&&m.jsx(Q,{isRequestActive:L,isVisuallyHidden:f||!!(e!=null&&e.isStreamingFromNative)||(e==null?void 0:e.isReadonly)&&!e.isStreaming,onSubmit:w,onCancel:C,actions:X,onExpandedChange:l})]})]})})};export{ao as CodeComposer};
//# sourceMappingURL=mx1vyxd6m2kpsmaz.js.map

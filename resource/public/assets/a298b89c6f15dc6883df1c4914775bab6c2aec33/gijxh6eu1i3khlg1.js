var Ie=Object.defineProperty,Se=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var fe=(s,a,t)=>a in s?Ie(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,x=(s,a)=>{for(var t in a||(a={}))pe.call(a,t)&&fe(s,t,a[t]);if(z)for(var t of z(a))je.call(a,t)&&fe(s,t,a[t]);return s},N=(s,a)=>Se(s,Ae(a));var H=(s,a)=>{var t={};for(var n in s)pe.call(s,n)&&a.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&z)for(var n of z(s))a.indexOf(n)<0&&je.call(s,n)&&(t[n]=s[n]);return t};import{f as ee,b as M,u as $,a as D,d as k,j as e,g as ye,r as p,M as f,i as qe,D as De}from"./n75kuy1cx6f5mogg.js";import{f as T,R as C,sR as Q,e as re,dv as ie,sS as Ne,J as Te,E as Y,dB as Me,gT as Ee,W as B,aj as Be,b as Fe,i as oe,cw as Ce,sT as Ve,C as We,aF as ve,rD as He,ex as j,fC as O,dh as Le,T as Re,B as Z,bU as le,j as Oe,qO as ce,an as Ge,fB as $e,d9 as Qe,m as ze,ho as Ke}from"./ewse8exzafeu10ji.js";import{cm as Ue,bU as Je,a5 as Ye,sU as se,bZ as Ze,lY as ae,sV as te,jq as Xe,lh as be,lg as de,bv as es,c7 as ss,a2 as as,sW as ts,fD as ns,sX as rs,li as is,a7 as os,jk as ls}from"./ny10lj7zpuz89fvf.js";import{T as d}from"./e0z6030ycsi62lhu.js";import{m as Pe}from"./kfoe5mkcypm5nk21.js";import{G as cs}from"./ox99k03vnvnrihmv.js";import{i as ds,R as ms}from"./noq3mkmgllmrw99g.js";import{T as us,a as gs}from"./jfylj2lx3vqh7vyo.js";import{a as xs,c as hs,u as fs}from"./6tgqoqudeah698zo.js";import"./eblhjx87s4n4864h.js";import"./3mp3j06lb1q5ttzm.js";import"./gy07ow2dyy5du4ny.js";import"./h2dwuj1m5ps9l7uv.js";import"./j2ui4c2m3nj8pqst.js";import"./lksc5q29mjlblqoo.js";import"./da0anzdj3bll2tbv.js";import"./mzj5jqjjpo006z7a.js";import"./nnb0v70g00lhjclz.js";import"./fh2tsu8ocsi22jc3.js";import"./jaupzjmp9wknd4io.js";import"./jtxj1xvdu5i7mvdh.js";import"./d65yyyom1modmtdi.js";import"./kj8rd4pu8k32z2dy.js";import"./em5q5yhbyv41ft0j.js";import"./n81diue0m3az0e3g.js";import"./ca7esdp3innmhgb2.js";import"./ga8p3rr9o0mc72h0.js";const W=25;function ps(s,a,t){return ee({queryKey:["workspace",s,"invites",a,t],queryFn:async()=>await C.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:a,limit:W,query:t}}})})}function _e(s,a,t){return ee({queryKey:["workspace",s,"invites","requests",a,t],queryFn:()=>C.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:a,limit:W,query:t}}})})}function we(s){const a=M(),t=T(),n=$();return D({mutationFn:({inviteId:r,role:i,acceptRequest:o})=>C.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:r}},requestBody:{role:i,accept_request:o}}).catch(l=>{throw t.danger(a.formatMessage(w.updateInviteError,{error:l.message}),{loggingTitle:w.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),l}),onSuccess:(r,i)=>{if(i.acceptRequest)n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var c;if(!o)return o;const l=o.items.filter(u=>u.id!==i.inviteId),m=Math.max(0,((c=o.total)!=null?c:0)-1);return N(x({},o),{items:l,total:m})});else if(i.role){const o=i.role;n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{if(!l)return l;const m=l.items.map(c=>c.id===i.inviteId?N(x({},c),{role:o}):c);return N(x({},l),{items:m})})}}})}function ke(s){const a=M(),t=T(),n=$();return D({mutationFn:({email:r})=>C.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:r}}).catch(i=>{throw t.danger(a.formatMessage(w.deleteInviteError,{email:r,error:i.message}),{loggingTitle:w.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),i}),onSuccess:(r,{email:i})=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var c;if(!o)return o;const l=o.items.filter(u=>u.email_address!==i),m=Math.max(0,((c=o.total)!=null?c:0)-1);return N(x({},o),{items:l,total:m})})}})}function js(s){const a=M(),t=T(),n=$();return D({mutationFn:()=>C.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(r=>{throw t.danger(a.formatMessage(w.acceptAllInviteRequestsError,{error:r.message}),{loggingTitle:w.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),r}),onSuccess:()=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},r=>r&&N(x({},r),{items:[],total:0}))}})}function Ms(s){const a=M(),t=T(),n=$();return D({mutationFn:({role:r,email:i})=>C.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[i],role:r,resend_emails:!0}}).then(({account_invites:o,errored_emails:l})=>{if(l.length>0)throw new Error(l[0].error);o.length>0&&t.success(a.formatMessage(w.resendInviteSuccess,{email:i}))}).catch(o=>{t.danger(a.formatMessage(w.resendInviteError,{email:i,error:o.message}),{loggingTitle:w.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["workspace",s,"invites"]}),n.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const w=k({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),me=({userName:s,isScimManaged:a,dotted:t=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(Ue,{user:{name:s,picture:null},size:"default",dotted:t}),a&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(Je,{width:10,height:10})})]}),vs=n=>{var r=n,{children:s,ref:a}=r,t=H(r,["children","ref"]);return e.jsx(Q.Root,N(x({license:"commercial",sheetRole:"dialog"},t),{ref:a,children:s}))},bs=i=>{var o=i,{children:s,ref:a,className:t,contentPlacement:n="left"}=o,r=H(o,["children","ref","className","contentPlacement"]);return e.jsx(Q.View,N(x({className:re("z-1",t),contentPlacement:n,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0},r),{ref:a,children:s}))},ys=n=>{var r=n,{className:s,ref:a}=r,t=H(r,["className","ref"]);return e.jsx(Q.Backdrop,N(x({className:s},t),{ref:a}))},Ns=r=>{var i=r,{children:s,ref:a,className:t}=i,n=H(i,["children","ref","className"]);return e.jsx(Q.Content,N(x({className:re("bg-token-bg-primary box-border shadow-lg",t)},n),{ref:a,children:s}))},Cs=Q.Portal,L={Root:vs,Portal:Cs,View:bs,Backdrop:ys,Content:Ns},Rs=({workspaceId:s,userId:a})=>ee({queryKey:[s,a,"user-roles"],queryFn:async()=>(await C.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s},path:{workspace_id:s,principal_id:a}}})).roles}),Us=({workspaceId:s,userId:a,enabled:t})=>ee({enabled:t,queryKey:[s,a,"user-groups"],queryFn:async()=>(await C.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:a}}})).items}),Ps=({workspaceId:s,user:a,onClose:t})=>{var h;const n=M(),r=ie(),i=ye(),o=Ne(),l=r==null?void 0:r.isEnterprisey(),{data:m}=Rs({workspaceId:s,userId:a.id}),c=p.useMemo(()=>m==null?void 0:m.filter(g=>!g.predefined_role),[m]),{data:u}=Us({workspaceId:s,userId:a.account_user_id,enabled:l});return e.jsx(L.Root,{presented:!0,defaultPresented:!0,onPresentedChange:t,children:e.jsx(L.Portal,{children:e.jsxs(L.View,{contentPlacement:"right",children:[e.jsx(L.Backdrop,{}),e.jsxs(L.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsx(Te,{onClick:t,iconSize:"lg",autoFocus:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(Ue,{user:{name:(h=a.name)!=null?h:"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:a.name}),e.jsx("div",{children:a.email})]})]}),e.jsx("hr",{className:"my-2.5"}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(K.groups)}),u==null&&e.jsx(Y,{}),(u==null?void 0:u.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(K.noGroups)}),u==null?void 0:u.map(g=>e.jsx(Me,{className:"mx-0",as:"button",onClick:()=>i("/admin/groups/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(cs,{group:g})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:g.name}),ds(g)&&e.jsx(ms,{})]})]})})},g.id))]}),e.jsx("hr",{className:"my-2.5"})]}),o&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(K.customRoles)}),c==null&&e.jsx(Y,{}),(c==null?void 0:c.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(K.noCustomRoles)}),c==null?void 0:c.map(g=>e.jsx(Me,{className:"mx-0",as:"button",onClick:()=>i("/admin/permissions/roles/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:g.predefined_role?e.jsx(Ye,{className:"icon"}):e.jsx(Ee,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:g.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:g.description})]})]})})},g.id))]})]})]})]})})})},K=k({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"}});function ue({currentRole:s,onUpdateUserRole:a,disabled:t=!1}){const n=se();return e.jsx(Ze,{disabled:t,defaultValue:s,onValueChange:r=>{a(r)},triggerClassName:"text-base",options:[{label:n[B.STANDARD],value:B.STANDARD},{label:n[B.ADMIN],value:B.ADMIN},{label:n[B.OWNER],value:B.OWNER}]})}const G=Be(()=>({confirmModalUserData:null})),X={openModalForUser:s=>{G.setState({confirmModalUserData:s})},closeModal:()=>{G.setState({confirmModalUserData:null})}};function _s({workspaceId:s,filterInputValue:a}){var xe;const[t,n]=p.useState(0),r=Fe(),[i,o]=p.useState(),l=Ne(),m=r==null?void 0:r.id,c=ae(s),u=te(s),h=c||u,g=As(),P=Ds(s),R=qs(s),{data:S}=Xe(s,t*be,a);p.useEffect(()=>{n(0)},[a]);const I=p.useCallback(v=>{X.openModalForUser(v)},[]),E=p.useCallback(()=>{var y;const v=(y=G.getState().confirmModalUserData)==null?void 0:y.id;v!==void 0&&P.mutate({userId:v}),X.closeModal(),o(void 0)},[P]),A=p.useCallback((v,y)=>{g.mutate({userId:v,value:y,workspaceId:s})},[g,s]);if(S===void 0)return e.jsx(ge,{});const U=S.items,_=Math.ceil(((xe=S.total)!=null?xe:0)/be);return t>=_&&_!==0&&n(Math.max(_-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),h&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:e.jsx(f,x({},b.name))}),e.jsx(d.HeaderCell,{children:e.jsx("span",{className:c?"ps-3":"",children:e.jsx(f,x({},b.accountType))})}),e.jsx(d.HeaderCell,{children:e.jsx(f,x({},b.dateAdded))}),h&&e.jsx(d.HeaderCell,{className:"w-16"})]}),e.jsxs(d.Body,{children:[U.map(v=>e.jsx(Is,{isCurrentUser:m!==void 0&&v.id===m,user:v,currentUserHasAdminRights:h,isCurrentUserOwner:c,onRemoveUserClick:()=>{var y,he;return I({id:v.id,name:(y=v.name)!=null?y:"",email:(he=v.email)!=null?he:"",created_time:v.created_time})},onUpdateUserRole:A,onLogoutUser:async y=>{await R.mutateAsync({userId:y})},onClick:l?y=>o(y):void 0},v.id)),U.length===0&&e.jsx(d.Row,{className:"[&>td]:py-2",children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(f,x({},b.noResults))})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:_>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(de,{currentPage:t,onChangeIndex:n,length:_})})}),i&&e.jsx(Ps,{workspaceId:s,user:i,onClose:()=>o(void 0)}),e.jsx(ks,{onDeleteConfirm:E})]})}function ws({onConfirm:s,onClose:a}){const t=M(),[n,r]=p.useState(!1);return e.jsx(ss,{title:t.formatMessage(b.logoutMemberModalTitle),isOpen:!0,onClose:a,onConfirm:async()=>{try{r(!0),await s()}finally{r(!1)}a()},loading:n,confirmText:t.formatMessage(b.logoutMemberModalConfirm),primaryButtonColor:"danger"})}function ks({onDeleteConfirm:s}){var r;const a=M(),t=G(i=>i.confirmModalUserData!==null),n=G(i=>i.confirmModalUserData===null?{}:{userId:i.confirmModalUserData.id,email:i.confirmModalUserData.email,name:i.confirmModalUserData.name,dateAdded:Ve(i.confirmModalUserData.created_time)});return e.jsx(We,{testId:"modal-remove-member",isOpen:t,title:a.formatMessage(b.removeMemberModalTitle),onClose:()=>X.closeModal(),type:"success",primaryButton:e.jsx(ve.Button,{title:a.formatMessage(b.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(ve.Button,{title:a.formatMessage(b.removeMemberModalCancel),color:"secondary",onClick:()=>X.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(r=n.name)!=null?r:n.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(f,N(x({},b.dateJoined),{values:{dateAdded:a.formatDate(n.dateAdded,{year:"numeric",month:"long",day:"numeric"})}}))})]})})}function Is({user:s,currentUserHasAdminRights:a,isCurrentUserOwner:t,isCurrentUser:n,onRemoveUserClick:r,onUpdateUserRole:i,onLogoutUser:o,onClick:l}){var P;const c=se()[s.role],u=M(),h=(P=s.name)!=null?P:u.formatMessage(b.missingName),g=oe();return e.jsxs(d.Row,{className:re("[&>td]:py-2"),onClick:l?()=>l==null?void 0:l(s):void 0,children:[e.jsxs(d.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(me,{userName:h,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[h,n&&e.jsx("span",{className:"ms-1",children:e.jsx(f,x({},b.youSpecifier))})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(d.Cell,{children:t?e.jsx(ue,{currentRole:s.role,onUpdateUserRole:R=>{i(s.id,R)},disabled:n}):c}),e.jsx(d.Cell,{children:u.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),a&&e.jsx(d.Cell,{children:e.jsx(Ss,{userId:s.id,onRemoveUserClick:r,onLogoutUserClick:()=>{Ce(g,ws,{onConfirm:()=>o(s.id)})},isCurrentUser:n,isScimManaged:s.is_scim_managed})})]})}function Ss({isCurrentUser:s,onRemoveUserClick:a,onLogoutUserClick:t,userId:n,isScimManaged:r}){const i=M(),o=He(),l=e.jsx(j.Item,{onClick:r?void 0:m=>{m.stopPropagation(),a(n)},color:"danger",icon:e.jsx(es,{}),disabled:r,children:e.jsx(f,x({},b.removeMemberModalTitle))});return s?null:e.jsxs(j.Root,{children:[e.jsx(j.Trigger,{className:"-my-2",children:e.jsx(O,{className:"icon-sm"})}),e.jsx(j.Portal,{children:e.jsxs(j.Content,{size:"small",children:[o&&e.jsx(j.Item,{onClick:m=>{m.stopPropagation(),t(n)},icon:e.jsx(Le,{}),children:e.jsx(f,x({},b.logoutMember))}),r?e.jsx(Re,{label:i.formatMessage(Pe.managedViaSCIMTooltip),className:"flex",side:"right",children:l}):l]})})]})}function As(){const s=T();return D({mutationFn:({userId:a,workspaceId:t,value:n})=>C.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:t,user_id:a}},requestBody:{role:n}}).catch(r=>{s.danger("Unable to update user (".concat(a,") role: ").concat(r.message),{toastId:"user_manager_table"})})})}function qs(s){const a=T();return D({mutationFn:({userId:t})=>C.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:t}}}),onError:(t,n)=>{a.danger("Unable to logout user (".concat(n.userId,") from workspace"),{toastId:"user_manager_table"})},onSuccess:()=>{a.success("User logged out of all sessions",{id:"user_logout_success"})}})}function Ds(s){const a=$(),t=T();return D({mutationFn:({userId:n})=>C.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:n}}}).catch(r=>{t.danger("Unable to remove user (".concat(n,") from workspace: ").concat(r.message),{toastId:"user_manager_table"})}),onSuccess:()=>{a.invalidateQueries({queryKey:["workspace",s]})}})}function ge(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(Y,{})})}const b=k({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}});function Ts({workspaceId:s,filterInputValue:a}){var h;const[t,n]=p.useState(0),{data:r}=_e(s,t*W,a),i=ae(s),o=te(s),l=M(),m=i||o;if(r===void 0)return e.jsx(ge,{});const c=r.items,u=Math.ceil(((h=r.total)!=null?h:0)/W);return t>=u&&u!==0&&n(Math.max(u-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(f,x({},F.email))}),e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:m?"ps-3":"",children:e.jsx(f,x({},F.role))})}),m&&e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:l.formatMessage(F.actions)})]}),e.jsxs(d.Body,{children:[c.map(g=>e.jsx(Es,{workspaceId:s,invite:g,isCurrentUserOwner:i,currentUserHasAdminRights:m},g.id)),c.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(f,x({},F.noResults))})})})]})]}),u>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(de,{currentPage:t,onChangeIndex:n,length:u})})]})}function Es({workspaceId:s,invite:a,isCurrentUserOwner:t,currentUserHasAdminRights:n}){var m;const r=se(),i=we(s),o=ke(s),l=M();return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:i.isPending||o.isPending||o.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(me,{userName:(m=a.email_address)!=null?m:"",isScimManaged:a.is_scim_managed,dotted:!0}),e.jsx("span",{children:a.email_address})]})}),e.jsx(d.Cell,{children:t?e.jsx(ue,{currentRole:a.role,onUpdateUserRole:c=>{i.mutate({inviteId:a.id,role:c})}}):r[a.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{color:"secondary",onClick:()=>i.mutate({inviteId:a.id,acceptRequest:!0}),children:l.formatMessage(F.accept)}),e.jsxs(j.Root,{children:[e.jsx(j.Trigger,{disabled:a.is_scim_managed,children:e.jsx(O,{className:"icon-sm"})}),e.jsx(j.Portal,{children:e.jsx(j.Content,{children:e.jsx(j.Item,{color:"danger",onClick:()=>{var c;return o.mutate({email:(c=a.email_address)!=null?c:""})},children:l.formatMessage(F.reject)})})})]})]})})})]})}const F=k({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),Bs=({workspaceId:s})=>{var I,E,A;const a=M(),t=oe(),n=ae(s),r=te(s),i=n||r,o=js(s),[l,m]=p.useState(""),[c,u]=p.useState(""),h=p.useMemo(()=>le(U=>u(U),300,{leading:!1,trailing:!0}),[]),{data:g}=_e(s,0,c),P=(I=Oe(t,"3677330697"))!=null?I:!1,R=(E=g==null?void 0:g.total)!=null?E:0,S=R?a.formatMessage(ne.acceptAllWithCount,{count:R}):a.formatMessage(ne.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ce,{value:l,onChange:U=>{m(U.target.value),h(U.target.value)},placeholder:a.formatMessage(ne.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),i&&P&&e.jsx(Z,{loading:o.isPending,disabled:((A=g==null?void 0:g.total)!=null?A:0)===0,onClick:()=>o.mutate(),children:S})]}),e.jsx(Ts,{workspaceId:s,filterInputValue:c})]})},ne=k({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}});function Fs({workspaceId:s,filterInputValue:a}){var u;const[t,n]=p.useState(0),r=ae(s),i=te(s),o=r||i,{data:l}=ps(s,t*W,a);if(l===void 0)return e.jsx(ge,{});const m=l.items,c=Math.ceil(((u=l.total)!=null?u:0)/W);return t>=c&&c!==0&&n(Math.max(c-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),o&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(f,x({},V.email))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(f,x({},V.invitedDate))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:o?"ps-3":"",children:e.jsx(f,x({},V.role))})}),o&&e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(d.Body,{children:[m.map(h=>e.jsx(Vs,{workspaceId:s,invite:h,isCurrentUserOwner:r,currentUserHasAdminRights:o},h.id)),m.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(f,x({},V.noResults))})})})]})]}),c>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(de,{currentPage:t,onChangeIndex:n,length:c})})]})}function Vs({workspaceId:s,invite:a,isCurrentUserOwner:t,currentUserHasAdminRights:n}){var c;const r=M(),i=se(),o=we(s),l=ke(s),m=Ms(s);return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:o.isPending||l.isPending||l.isSuccess||m.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(me,{userName:(c=a.email_address)!=null?c:"",isScimManaged:a.is_scim_managed,dotted:!0}),e.jsx("span",{children:a.email_address})]})}),e.jsx(d.Cell,{children:r.formatDate(a.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(d.Cell,{children:t?e.jsx(ue,{currentRole:a.role,onUpdateUserRole:u=>{o.mutate({inviteId:a.id,role:u})}}):i[a.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsx(Ws,{onDeleteUser:()=>{var u;l.mutate({email:(u=a.email_address)!=null?u:""})},onResendInvite:()=>{var u,h;m.mutate({email:(u=a.email_address)!=null?u:"",role:(h=a.role)!=null?h:""})},disabled:a.is_scim_managed})})})]})}function Ws({onDeleteUser:s,onResendInvite:a,disabled:t}){const n=M();return e.jsx(e.Fragment,{children:t?e.jsx(j.Root,{children:e.jsx(j.Trigger,{disabled:!0,children:e.jsx(Re,{label:n.formatMessage(Pe.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(O,{className:"icon-sm"})})})}):e.jsxs(j.Root,{children:[e.jsx(j.Trigger,{children:e.jsx(O,{className:"icon-sm"})}),e.jsx(j.Portal,{children:e.jsxs(j.Content,{children:[e.jsx(j.Item,{onClick:a,children:e.jsx(f,x({},V.resendInvite))}),e.jsx(j.Item,{onClick:s,children:e.jsx(f,x({},V.revokeInvite))})]})})]})})}const V=k({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),Hs=({workspaceId:s})=>{const a=M(),[t,n]=p.useState(""),[r,i]=p.useState(""),o=p.useMemo(()=>le(l=>i(l),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(ce,{value:t,onChange:l=>{n(l.target.value),o(l.target.value)},placeholder:a.formatMessage(Ls.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Fs,{workspaceId:s,filterInputValue:r})]})},Ls=k({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}});function Os({workspaceId:s}){const a=M(),t=ie(),[n,r]=p.useState(""),[i,o]=p.useState(""),l=p.useMemo(()=>le(g=>o(g),300,{leading:!1,trailing:!0}),[]),m=oe();if(!t)return null;const c=t==null?void 0:t.isTeam(),u=t.isAdminOfAccount(),h=t.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(ce,{value:n,onChange:g=>{r(g.target.value),l(g.target.value)},placeholder:a.formatMessage(J.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(u||h||c)&&e.jsx(Z,{onClick:()=>{Ge.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),Ce(m,({onClose:g})=>e.jsx(ts,{workspace:t,onClose:g}))},icon:as,children:e.jsx(f,x({},J.inviteMemberButton))}),c?e.jsx($e,{triggerButton:e.jsx(Z,{color:"secondary",icon:O}),children:e.jsx(j.Item,{onClick:()=>{t&&Qe.setLeaveWorkspaceData(t)},children:e.jsx(f,x({},J.leaveWorkspace))})}):null]})]}),e.jsx(_s,{workspaceId:s,filterInputValue:i}),e.jsx("p",{className:"text-token-text-secondary mt-4 text-sm",children:e.jsx(f,x({},J.memberListUpdateDelayNote))})]})}const J=k({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"},memberListUpdateDelayNote:{id:"adminPage.memberListUpdateDelayNote",defaultMessage:"Note: Although new workspace members can access ChatGPT immediately, it may take up to 24 hours to show them in this list."}}),Gs=s=>s==="members"||s==="invites"||s==="requests";function $s({currentWorkspaceId:s}){var A,U;const a=M(),t=ie(),n=(A=ns(s))!=null?A:"?",r=rs(t),i=p.useMemo(()=>[{key:"members",label:a.formatMessage(q.allMembers),children:e.jsx(Os,{workspaceId:s})},{key:"invites",label:a.formatMessage(q.pendingInvites),children:e.jsx(Hs,{workspaceId:s})},{key:"requests",label:a.formatMessage(q.pendingRequests),children:e.jsx(Bs,{workspaceId:s})}],[s,a]),o=ye(),[l]=qe(),m=l.get("tab"),[c,u]=p.useState(m&&Gs(m)?m:i[0].key),h=t!=null?is(t.data.role):void 0,g=t!=null?os(t.data.role):void 0,P=t==null?void 0:t.isEnterprisey(),{data:R,isLoading:S}=ze(s);let I=!1;g||h||!P?I=!0:I=!!((U=R==null?void 0:R.permissions)!=null&&U.includes("chatgpt.workspace.member.role.view"));const E=_=>{u(_),o({pathname:window.location.pathname,search:new URLSearchParams({tab:_}).toString()})};return t?S?e.jsx("div",{className:"mt-6 flex min-h-[40vh] items-center justify-center",children:e.jsx(Y,{})}):I?e.jsxs(e.Fragment,{children:[e.jsx(ls,{children:e.jsx("title",{children:a.formatMessage(q.adminBrowserPageTitle)})}),e.jsx(xs,{title:a.formatMessage(q.adminPageTitle),subtitle:e.jsx(f,x({values:{totalMembers:n,planName:r}},q.totalMembers)),tabsHeader:e.jsx(us,{items:i,activeTab:c,onTabChange:E})}),e.jsx(hs,{children:e.jsx(gs,{items:i,activeTab:c})})]}):e.jsx("div",{className:"m-6",children:e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-secondary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[e.jsx(Ke,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),e.jsx(f,x({},q.membersPagePermissionDenied))]})}):null}const q=k({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} Â· {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},membersPagePermissionDenied:{id:"adminPage.membersPagePermissionDenied",defaultMessage:"You don't have permission to view this members list. Please contact your workspace admin for access or update the workspace settings."}}),ba=De(function(){const a=fs();return e.jsx($s,x({},a))});export{ba as default};
//# sourceMappingURL=gijxh6eu1i3khlg1.js.map

import{j as e,b as S,M as E,h as ne,r as w,m as z}from"./n75kuy1cx6f5mogg.js";import{m as G,i as oe,c as le,b as re,T as de}from"./cg9mamkqgsk8mjh0.js";import{aT as ie,eR as ce,dW as _,gR as me,g9 as J,lb as xe,nz as fe,c as ue,eM as $,eQ as he,nA as be,nB as pe,nC as ge,N as je}from"./ny10lj7zpuz89fvf.js";import{u as ve,c as ye,D as Ne}from"./fdv2df7jppwbz4po.js";import{aa as U,e as j,ex as y,T as k,B as K,qM as ke,eK as Me,bG as Ce,lU as Q,fA as we}from"./ewse8exzafeu10ji.js";import{S as Ee}from"./l351nx0zzb742rw6.js";import{t as Se}from"./fna9z31n721lpf9f.js";import{C as Y,T as Te}from"./i8z30y8uhn6o6j41.js";import{g as Be}from"./bj1ejin6tzi0v3v8.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./j2tluvxda4ll72qx.js";import"./d5vv6ct7n3prp63a.js";import"./ctddpbsbr3gj60l1.js";import"./npn63o3tt9liv4y2.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./je40yyidw4ukzc9u.js";function De({textdocVersion:l,clientThreadId:n}){const{handleCopy:c,copyLabel:m}=ve({textdocVersion:l,clientThreadId:n}),d=!U();return e.jsx(ie,{onCopy:c,className:"px-1.5 py-1",iconClassName:j("icon-md",!d&&"hidden"),iconOnly:d,buttonText:d?void 0:m})}function Le({textdocVersion:l,isDisabled:n=!1,clientThreadId:c}){const m=S(),{handleFileDownload:d,handleBlobDownload:f,isLoading:u,downloadCopyLabel:t,isDocument:s}=ye({textdocVersion:l,clientThreadId:c});return n||(n=u||!l||l.type===ce.LOADING),s?e.jsxs(y.Root,{open:!u&&!n?void 0:!1,children:[e.jsx(y.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:t,children:e.jsx(_,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{align:"end",children:[e.jsx(y.Item,{onClick:r=>{r.preventDefault(),d("pdf")},children:m.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(y.Item,{onClick:r=>{r.preventDefault(),d("docx")},children:m.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(y.Item,{onClick:r=>{r.preventDefault(),d("md")},children:m.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:t,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:e.jsx(_,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function Ae({onClick:l}){const n=S();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:l,children:[e.jsx(k,{label:e.jsx(E,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(me,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Re({onClick:l,disabled:n,isCodePreviewable:c}){const d=S().formatMessage(c?G.previewCode:G.runCode);return n?e.jsx(K,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(k,{label:e.jsx(E,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(J,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d})]})}):e.jsxs(K,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:l,disabled:!1,children:[e.jsx(k,{label:e.jsx(E,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(J,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d})]})}var A,Z;function We(){if(Z)return A;Z=1;var l=fe(),n=xe(),c=ke(),m=parseFloat,d=Math.min,f=Math.random;function u(t,s,r){if(r&&typeof r!="boolean"&&n(t,s,r)&&(s=r=void 0),r===void 0&&(typeof s=="boolean"?(r=s,s=void 0):typeof t=="boolean"&&(r=t,t=void 0)),t===void 0&&s===void 0?(t=0,s=1):(t=c(t),s===void 0?(s=t,t=0):s=c(s)),t>s){var a=t;t=s,s=a}if(r||t%1||s%1){var h=f();return d(t+h*(s-t+m("1e-"+((h+"").length-1))),s)}return l(t,s)}return A=u,A}var Fe=We();const He=ne(Fe),qe=({isCanvasHovered:l=!1,onClick:n})=>{const c=S();return e.jsx(k,{label:c.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(je,{color:l?"primary":"secondary",icon:Ee,onClick:n})})},ze=({textdocId:l,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,marginBottom:u,size:t="large",height:s=t==="large"?"22rem":"10rem",minHeight:r,isCanvasOpen:a=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:T=!1,isInlinePreview:o=!1,isStreaming:p=!1,isUserMessage:g=!1,onClick:v,onPreview:B,children:D})=>{const L=w.useRef(null),[N,R]=w.useState(!1),[X]=w.useState(()=>He(100,180,!1)),M=ue(l),V=Me(n),i=Ce(M==null?void 0:M.versions),x=$(),C=!x,I=M==null&&V===void 0,P=i==null||p,W=!!i&&oe(i.type,i.content),O=!!i&&le(i.type),ee=W||O,F=b&&a&&f!=null?f:d,te=F?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!N}),children:F}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(Q,{lines:1,size:"base",width:100,widthVariance:0})}),H=i!=null&&i.type&&he(i.type)?re(i.type):void 0,q=!c||T?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:X},children:e.jsx(Q,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":x}),children:c}),x&&H&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",H]})]}),ae=()=>{!L.current||h||(be.logButtonClick(pe.MESSAGE_ATTACHMENT,{type:m}),ge(L.current),v==null||v())},se=U();return e.jsxs(z.div,{role:C?"button":void 0,id:Be(l),initial:{opacity:p?0:1,scale:p?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:x?0:.72},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",x?"overflow-visible":"overflow-hidden",h?"cursor-default":C?"cursor-pointer":"cursor-text",{"select-none":C,"border-token-text-tertiary font-medium dark:border-gray-600":b&&a,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":a||!o,"rounded-3xl":!a&&o,"max-w-full":!g&&(a||!o),"max-w-[var(--user-chat-width,70%)]":g&&(a||!o),[se?"w-full":"".concat(Se.tableContainer," rounded-none")]:!g&&!a&&o,"w-[var(--user-chat-width,70%)]":g&&!a&&o,"w-full pt-1 pb-3 sm:max-w-none":o&&x}),onMouseEnter:()=>!h&&R(!0),onMouseLeave:()=>R(!1),onClick:()=>C?ae():void 0,ref:L,style:{marginBottom:u,height:o&&!a?s:void 0,minHeight:o&&!a?r:void 0,width:t==="small"?"300px":void 0},children:[!(x&&o)&&e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!N&&!b,"border-token-border-heavy":N&&!b,"text-token-text-primary text-sm font-medium":!a&&N&&o,"py-2":a||!o,"py-3":!x&&!a&&o,"text-token-text-secondary text-sm font-medium":!a&&!N&&o,"pt-0 pb-2 sm:px-6":x}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":a||!o,"gap-3.5":!a&&o}),children:[!x&&te,q]}),a?e.jsx(z.span,{animate:p?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:p&&e.jsx(de,{gap:1,padding:0})}):e.jsx(qe,{isCanvasHovered:N,onClick:v})]}),x&&o&&!h?e.jsx("div",{className:"thread-xl:-top-[var(--header-height)] sticky top-0 z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:j("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:q}),e.jsx("div",{className:"flex items-center justify-end",children:I&&!a?e.jsxs("span",{className:"bg-token-surface-tertiary/40 text-token-text-tertiary inline-flex items-center px-2.5 py-0.5 text-xs font-normal",children:[e.jsx(we,{className:"me-1 h-3 w-3 shrink-0"}),e.jsx(E,{id:"m8Uz8Y",defaultMessage:"Canvas is not supported in shared conversations"})]}):x&&!a?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(De,{textdocVersion:i!=null?i:null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ae,{onClick:v})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Le,{isDisabled:P,textdocVersion:i!=null?i:null,clientThreadId:n})}),ee&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Re,{isCodePreviewable:W,disabled:p,onClick:B})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!a&&D,o&&!a&&!x&&e.jsx(Y,{size:t,position:"bottom"}),o&&t==="small"&&!a&&!x&&e.jsx(Y,{size:t,position:"right"})]})]})},nt=({textdocId:l,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,isCanvasOpen:u=!1,isFetching:t=!1,isFocused:s=!1,isInlinePreview:r=!1,isStreaming:a=!1,isUserMessage:h=!1,onClick:b,onPreview:T})=>{const[o,p]=w.useState(!1),g=$(),v=D=>{p(D>0)},B=r&&!u?16:12;return e.jsx(ze,{textdocId:l,name:c,tag:m,icon:d,height:g?"auto":void 0,iconSelected:f,marginBottom:B,isCanvasOpen:u,isFocused:s,isInlinePreview:r,isStreaming:a,isUserMessage:h,onClick:b,onPreview:T,clientThreadId:n,children:r&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":o,"border-transparent":!o}),children:t&&!(g&&a)?e.jsx(Ne,{numLines:20}):!!l&&e.jsx(Te,{disableScroll:g,onScroll:v,textdocId:l,clientThreadId:n})})})};export{nt as CanvasMessageAttachment,ze as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=d4d29peqkh0q3gat.js.map

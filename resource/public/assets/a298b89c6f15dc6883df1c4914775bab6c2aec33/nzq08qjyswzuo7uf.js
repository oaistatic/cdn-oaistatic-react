import{r as E,b as k,j as o,d as q}from"./n75kuy1cx6f5mogg.js";import{i as V,cm as B,a6 as J,iR as K,iy as Q,gA as X,f5 as Y,iO as Z,e as p,E as D,ho as ee,h$ as R}from"./ewse8exzafeu10ji.js";import{gI as O,gJ as se,S as ae,dc as te,gK as ne,gu as oe,gL as re,gM as ie}from"./ny10lj7zpuz89fvf.js";function le({asset:s,contextConnectorSourceUrl:r,disableExpandable:d=!1,isSingle:c,isUserTurn:u,className:i}){var b,A;const n=V(),l=B(n).flags,[f,e]=E.useState(!1),{isUnauthenticated:t}=J(),g=l==null?void 0:l.includes(K.NoAuthEnableFileUploads),h=Q(s.asset_pointer),a=O.useState(W=>O.selectFile(W,h)),M=se((b=a==null?void 0:a.file)!=null?b:null,a==null?void 0:a.file.name,(A=a==null?void 0:a.fileId)!=null?A:void 0,a==null?void 0:a.gizmoId,a==null?void 0:a.contextConnectorInfo,!0),F=t&&a&&g,{gizmoEditorData:x}=X(),v=Y(),N=E.useContext(ae),_=(N==null?void 0:N.serverSharedThreadId)&&u,z=Z(),{isOpen:P}=te(),S=k(),{data:y,isLoading:$,error:H}=ne({asset:s,gizmoId:x==null?void 0:x.id,getServerUrl:!F}),{url:j,width:w,height:C}=M&&g?{width:s.width,height:s.height,url:M}:y!=null?y:{},T=$||!f,I=w&&C?{Landscape:w>C,Portrait:w<C}:void 0,m=["overflow-hidden rounded-lg"];if(c&&(m.push("w-full h-full"),I!=null&&I.Landscape?m.push("max-w-96 max-h-64"):I!=null&&I.Portrait?m.push("max-h-96 max-w-64"):m.push("max-w-64 max-h-64")),i&&m.unshift(i),_&&z())return null;let L;return j!=null&&(L=o.jsx(oe,{alt:S.formatMessage(U.imageAltText),className:p(P?"max-w-[88px]":"max-w-full",!c&&"aspect-square","object-cover object-center",m),src:j,width:w,height:C,onLoad:()=>e(!0)}),!v&&!d&&(L=o.jsx(re,{src:j,alt:S.formatMessage(U.imageAltText),contextConnectorSourceUrl:r,className:p(m),children:L}))),o.jsx("div",{className:p(m),children:o.jsx("div",{className:p("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!c&&"aspect-square"),children:j!=null?L:o.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:"".concat(w," / ").concat(C),width:w},title:T?S.formatMessage(U.loadingImage):S.formatMessage(U.errorLoadingImage),children:T?o.jsx(D,{}):H?o.jsx(ee,{className:"icon-sm"}):null})})})}const U=q({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function G({assets:s,attachments:r,isUserTurn:d=!0,clientThreadId:c}){const u=s.length===1,{containerClassname:i,imageClassnames:n}=G.computeClassnames(s.length);let l=R.ATTACHMENT;return s&&!(r&&r.length>0)&&(l=R.IMAGE),o.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[o.jsx("div",{className:p("flex flex-row items-center justify-end gap-1",i),children:s.map((f,e)=>{var g;const t=r==null?void 0:r.find(h=>h.id&&f.asset_pointer.includes(h.id));return o.jsx(le,{asset:f,isSingle:u,isUserTurn:d,contextConnectorSourceUrl:(g=t==null?void 0:t.context_connector_info)==null?void 0:g.source_url,className:n[e]},e)})}),o.jsx(ie,{featureType:l,isUserTurn:d,clientThreadId:c})]})}G.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let r=s>=4?"flex-wrap":"";const d=Array(s),c=e=>{d.fill(e)},u=e=>{r+=" ".concat(e)},i=(e,t)=>{d[e]=p(d[e],t)},n=s<=4&&s%2===0?2:3,l=Math.ceil(s/n),f=s%n!==0;n===2?(c("h-32 w-32"),u("max-w-72")):l<=2?(c("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(c("h-16 w-16"),u("max-w-52"));for(let e=0;e<s;e++){const t=Math.floor(e/n),g=e%n,h=Math.min(s-t*n,n),a=t===0,M=t===l-1,F=t===l-2,x=g===0,v=g===h-1;a&&x&&i(e,"rounded-ss-2xl"),a&&v&&i(e,"rounded-se-2xl"),M&&x&&i(e,"rounded-es-2xl"),M&&v&&i(e,"rounded-ee-sm"),f&&x&&F&&i(e,"rounded-es-2xl")}return{containerClassname:r,imageClassnames:d}};export{G as TextMessageImageGroup};
//# sourceMappingURL=nzq08qjyswzuo7uf.js.map

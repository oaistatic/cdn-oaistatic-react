var J=Object.defineProperty,D=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var b=(e,t,n)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))v.call(t,n)&&b(e,n,t[n]);if(f)for(var n of f(t))N.call(t,n)&&b(e,n,t[n]);return e},p=(e,t)=>D(e,E(t));var S=(e,t)=>{var n={};for(var a in e)v.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&f)for(var a of f(e))t.indexOf(a)<0&&N.call(e,a)&&(n[a]=e[a]);return n};import{j as s,r as l,M as g,l as I,g as P}from"./n75kuy1cx6f5mogg.js";import{f as R,fB as F,ex as _,fC as T,E as L,e as m,bm as q,is as B}from"./ewse8exzafeu10ji.js";import{bv as w,n8 as z,n9 as x,js as O,na as Q,nb as U,nc as H,bU as K,nd as G,cQ as V,cR as W,cS as X,c0 as Y,d5 as Z,jL as $,h1 as ee,h2 as se,lD as te}from"./ny10lj7zpuz89fvf.js";import{S as ne}from"./jid4dm2x85nktrcg.js";function ae({automation:e,updateForceShowActions:t,onClickEdit:n,onClickDelete:a}){return e.next_run_times.length===0?s.jsx(oe,{onClickDelete:a}):s.jsx(re,{automation:e,updateForceShowActions:t,onClickEdit:n,onClickDelete:a})}function oe({onClickDelete:e}){return s.jsx("div",{children:s.jsx(C,{onClick:e,children:s.jsx(w,{className:"icon"})})})}function re({automation:e,updateForceShowActions:t,onClickEdit:n,onClickDelete:a}){const r=R(),[o,i]=l.useState(e.is_enabled);l.useEffect(()=>i(e.is_enabled),[e.is_enabled]);const{mutate:d}=z({automation_id:e.id,onError:c=>{r.danger(c?x.messages.enableFailure:x.messages.pauseFailure,{toastId:"toggle_automation_status"}),i(!c)}});return s.jsxs("div",{className:"flex",children:[s.jsx(C,{onClick:n,children:s.jsx(O,{className:"icon"})}),s.jsxs(F,{size:"auto",contentAlign:"end",sideOffset:4,triggerButton:s.jsx("button",{className:"hover:bg-token-main-surface-secondary rounded-md p-2",children:s.jsx(T,{className:"icon"})}),onOpenChange:c=>{t(c)},children:[s.jsx(_.Item,{label:o?s.jsx(g,u({},x.messages.pause)):s.jsx(g,u({},x.messages.resume)),icon:o?s.jsx(Q,{className:"icon"}):s.jsx(U,{className:"icon"}),onClick:()=>{i(!o),d({is_enabled:!o})}}),s.jsx(_.Item,{color:"danger",label:s.jsx(g,u({},x.messages.delete)),icon:s.jsx(w,{className:"icon"}),onClick:a})]})]})}function C(n){var a=n,{children:e}=a,t=S(a,["children"]);return s.jsx("button",p(u({className:"hover:bg-token-main-surface-secondary rounded-md p-2"},t),{children:e}))}function ie({automation:e}){return e.next_run_times.length===0?e.last_run_time?s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(H,{dateString:e.last_run_time})}):null:e.schedule_components?s.jsx(ce,{automation:e}):null}function ce({automation:e}){return s.jsxs("div",{className:"text-token-text-secondary flex items-center gap-1 text-sm",children:[le(e)&&s.jsx(K,{className:"icon-sm"}),s.jsx(G,{item:e,useShortForm:!0})]})}function le(e){var t;return((t=e.schedule_components)==null?void 0:t.frequency)!=="once"}function de({filter:e}){const{isLoading:t,isFetchingNextPage:n,hasNextPage:a,fetchNextPage:r}=I({queryKey:["automations",e],queryFn:async({pageParam:o})=>{const i=await W.getAutomations(o,e);return X.initJawbonesFromServerData(i.items,i.cursor,e),i},initialPageParam:V.getCursor(e),getNextPageParam:o=>{var i;return(i=o.cursor)!=null?i:void 0}});return t||n?s.jsx(L,{}):a?s.jsxs("button",{className:"flex cursor-pointer items-center gap-1",onClick:()=>{r()},children:[s.jsx(Y,{className:"icon text-token-text-secondary"}),s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(g,u({},Z.seeMore))})]}):null}function ue({icon:e,title:t,onClickTitle:n,details:a,actions:r,showActions:o}){return s.jsxs("div",{className:"flex items-center gap-1.5",children:[e,s.jsx("div",{className:m("me-6 flex-1 py-4 text-sm",n&&"cursor-pointer"),onClick:n,children:t}),s.jsx("div",{children:o?r:a})]})}function xe({label:e,activeIndex:t}){return s.jsx("div",{className:m("border-token-border-default mx-4 border-b pb-4 text-base font-medium",t===0&&"border-transparent"),children:e})}function me({automation:e}){return e.is_enabled?e.target_time_utc?s.jsx(te,{className:"icon text-token-text-secondary"}):s.jsx(B,{className:"icon text-token-text-tertiary"}):s.jsx(ne,{className:"icon text-token-text-tertiary"})}function fe({automation:e,filter:t,index:n,activeIndex:a}){const r=P(),[o,i]=l.useState(!1),d=l.useCallback(M=>{i(M)},[]),c=n===a,k=n+1===a,[y,h]=l.useState(!1),[A,j]=l.useState(!1);return s.jsxs("div",{className:m("rounded-2xl",c&&"dark:bg-token-main-surface-secondary bg-[#f4f4f4]"),children:[s.jsx("div",{className:m("border-token-border-default mx-4 border-b",c&&"border-transparent",k&&"border-transparent"),children:s.jsx(ue,{icon:s.jsx(me,{automation:e}),title:s.jsx("span",{className:m(t==="scheduled"?"text-token-text-primary":"text-token-text-secondary"),children:e.title}),onClickTitle:()=>{e.conversation_id&&r(q(e.conversation_id))},details:s.jsx(ie,{automation:e}),actions:s.jsx(ae,{automation:e,updateForceShowActions:d,onClickEdit:()=>h(!0),onClickDelete:()=>j(!0)}),showActions:c||o})}),A&&s.jsx($,{item:e,onClose:()=>j(!1),onConfirm:()=>j(!1)}),y&&s.jsx(ee,{initialScheduleComponents:e.schedule_components,nextRunTimes:e.next_run_times,children:s.jsx(se,{item:e,source:"tasks",onClose:()=>h(!1)})})]})}function pe({label:e,filter:t,automations:n,isActiveSection:a}){const[r,o]=l.useState(void 0);l.useEffect(()=>{a||o(void 0)},[a]);const i=l.useMemo(()=>t==="scheduled"?ge(n):n,[n,t]);return s.jsxs("div",{children:[s.jsx(xe,{label:e,activeIndex:r}),s.jsxs("div",{className:"flex flex-col",children:[i.map((d,c)=>s.jsx("div",{onMouseEnter:()=>o(c),onMouseLeave:()=>o(void 0),children:s.jsx(fe,{automation:d,filter:t,activeIndex:a?r:void 0,index:c})},d.id)),s.jsx("div",{className:"p-4",children:s.jsx(de,{filter:t})})]})]})}function ge(e){return[...e].sort((t,n)=>{const a=t.next_run_times&&t.next_run_times.length?new Date(t.next_run_times[0]).getTime():NaN,r=n.next_run_times&&n.next_run_times.length?new Date(n.next_run_times[0]).getTime():NaN;return!isNaN(a)&&!isNaN(r)?a-r:isNaN(a)?1:-1})}const Se={};export{ae as A,me as J,ue as T,ie as a,pe as b,Se as c};
//# sourceMappingURL=eqect4railuw6dh2.js.map

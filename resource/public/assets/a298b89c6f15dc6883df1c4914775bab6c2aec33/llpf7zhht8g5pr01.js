var pe=Object.freeze,je=Object.defineProperty,rt=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Pe=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,mt=Object.prototype.propertyIsEnumerable;var Ce=(a,l,c)=>l in a?je(a,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[l]=c,n=(a,l)=>{for(var c in l||(l={}))dt.call(l,c)&&Ce(a,c,l[c]);if(Pe)for(var c of Pe(l))mt.call(l,c)&&Ce(a,c,l[c]);return a},u=(a,l)=>rt(a,ct(l));var Me=(a,l)=>pe(je(a,"raw",{value:pe(l||a.slice())}));import{r as E,n as Fe,R as ut,b as ue,i as ft,j as e,M as f,d as gt}from"./n75kuy1cx6f5mogg.js";import{fN as Ie,fO as Oe,b6 as I,b7 as Q,fP as ie,fQ as re,dk as ce,fR as Ue,dn as ht,bg as He,fS as $e,fT as de,fU as xt,dh as yt,b5 as Ve,fV as We,fW as Ye,bb as F,bc as H,bx as Tt,fX as bt,fY as qe,fZ as ae,f_ as C,f$ as Ne,g0 as Z,g1 as le,g2 as St,g3 as Xe,g4 as ze,g5 as pt,g6 as Pt,g7 as Ct}from"./ny10lj7zpuz89fvf.js";import{i as J,dv as Qe,d9 as ve,f as jt,b as Mt,v as Nt,h7 as vt,d5 as wt,P as z,au as _t,q as Et,a9 as At,C as we,du as Lt,hC as ne,e as me,el as oe,B as _e,y as kt,ae as Bt,at as Ge,pN as Ee,F as Rt}from"./ewse8exzafeu10ji.js";import{u as Ae}from"./jrb3eqknnmp1dh1j.js";import{S as Ft,F as It,c as R,L as Ot}from"./lj2w9b5ogapjsanu.js";import{u as Ut}from"./jibfal0i45wkyt1w.js";import{a as Ht,b as $t}from"./jaupzjmp9wknd4io.js";import{S as Vt}from"./kvd65smf2xr8kpw2.js";const Wt=Ue(ce),Yt=({promoData:a,initialPromoCoupon:l,initialSeats:c}={})=>{var S;J();const M=He(),x=ht(),s=(S=Ie())!=null?S:l,{data:t}=Oe(s!=null?s:"");let d=a;!a&&t&&(d=t);const b=(d==null?void 0:d.coupon)===I&&d.state==="eligible",y=d&&Q(d.coupon)&&d.state==="eligible",o=typeof window<"u"?new URLSearchParams(window==null?void 0:window.location.search):new URLSearchParams,h=o.get(ie),m=o.get(re),T=b?ce.FLEXIBLE:m&&Wt(m)?m:ce.FLEXIBLE,[_,j]=E.useState(T),[A,g]=E.useState(c!=null?c:h&&!isNaN(parseInt(h,10))?parseInt(h,10):Math.max(x,M));return{promoData:d,selectedPlan:_,setSelectedPlan:j,numSeats:A,setNumSeats:g,minTeamSeats:M,TEAM1DOLLAR_COUPON_IsEligible:b,TEAM_FREE_TRIAL_COUPON_IsEligible:y}};var Ke=(a=>(a.FLEXIBLE="month",a.ANNUAL="year",a))(Ke||{});const qt={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"},Le=Ue(Ke),ls=a=>{const l=E.useRef(!1),c=Fe(),M=c.hash.split("#")[1]===$e||c.hash.split("#")[1]===de,x=Qe(),s=!l.current&&M&&x&&!a,{country:t}=Ht(),d=$t({country:t,currentAccount:x,location:"team-workspace-purchase-modal"}),b=Ie(),{data:y,isLoading:o}=Oe(b!=null?b:"");J();const h=He(),m=ut.useRef(void 0);E.useEffect(()=>{s&&(ve.setPurchaseWorkspaceData({minimumSeats:h,billingDetails:d,promoData:y}),l.current=!0)},[x,d,h,M,a,b,y,s]),E.useEffect(()=>{const T=m.current;m.current=o,!(o||!l.current)&&T&&ve.setPurchaseWorkspaceData({minimumSeats:h,billingDetails:d,promoData:y})},[y,o,h,d])};var Re;const ke=Rt.p(Re||(Re=Me(["text-base font-medium mb-3"]))),Y=gt({preDiscountTotal:{id:"teamBilling.nativeCurrency.preDiscountTotal",defaultMessage:"{amount}"},breakdownAmount:{id:"teamBilling.nativeCurrency.breakdownAmount",defaultMessage:"{amount}/seat"},temporaryCardHoldAmount:{id:"promo.teamFreeTrial.temporaryCardHoldAmountWithFormattedCurrency",defaultMessage:"{amount}"},discountAmount:{id:"teamBilling.nativeCurrency.discountAmount",defaultMessage:"{amount}"},totalAmount:{id:"teamBilling.nativeCurrency.totalAmount",defaultMessage:"{currencyCode} {totalAmount}"},afterPromoAmount:{id:"promo.teamFreeTrial.afterPromoAmountWithFormattedCurrency",defaultMessage:"After promotional period {amount} per month"}}),Xt=({isOpen:a,onClose:l,onSubmit:c,minimumSeats:M,billingDetails:x,isDirectFlow:s=!1,promoData:t=void 0})=>{const d=Qe(),{trackSelectedPixels:b}=Ae({key:Nt.SELF_SERVE_BUSINESS}),{trackSelectedPixels:y}=Ae({key:"team-secondary"}),{selectedPlan:o,setSelectedPlan:h,numSeats:m,setNumSeats:T,minTeamSeats:_,TEAM1DOLLAR_COUPON_IsEligible:j,TEAM_FREE_TRIAL_COUPON_IsEligible:A}=Yt({promoData:t}),[g,S]=E.useState(!1),i=ue(),p=x.currency,N=Math.max(M,_),{flexibleBillingPlan:k,annualBillingPlan:L}=Ve(p);let v=k,G=null;if(j||A){G=(t==null?void 0:t.coupon)===I?We(p):Ye(p);let r,P;j?(r=n({},p===vt?F.team1dollarMonthlyCostINR:F.team1dollarMonthlyCost),P=u(n({},F.team1dollarMonthlyStructure),{defaultMessage:"Then ".concat(i.formatMessage(v.currencySign)).concat(v.monthlyCost," seat/mo after 1 month"),id:"promo.team1dollar.monthlyPlanStructure",description:"Subsequent pricing description for team1dollar promo. Describing the monthly then the annual price after."})):(r=n({},H.teamFreeTrialMonthlyCost),P=u(n({},H.teamFreeTrialMonthlyStructure),{defaultMessage:"Then ".concat(i.formatMessage(v.currencySign)).concat(v.monthlyCost," seat/mo after 1 month"),id:"promo.teamFreeTrial.monthlyPlanStructure",description:"Subsequent pricing description for teamFreeTrial promo. Describing the monthly then the annual price after."})),v=u(n({},v),{cost:r,costStructure:P,discountedMonthlyCost:G!=null?G:v.discountedMonthlyCost})}const $=(t==null?void 0:t.coupon)===I,Ze=t&&Q(t==null?void 0:t.coupon),q=$||Ze,fe=(t==null?void 0:t.state)==="not_eligible"&&q,ge=(t==null?void 0:t.state)==="temporary_disabled"&&q,Je=(t==null?void 0:t.state)==="offline"&&q,O=Tt(isNaN(m)?0:m,N,bt),V=E.useMemo(()=>d==null?void 0:d.subscriptionAnalyticsParams,[d]),w=wt(r=>r.purchaseWorkspaceData);E.useEffect(()=>{var P;const r=(P=w==null?void 0:w.referrer)!=null?P:document.referrer;z.logEvent("Account Pay: Select Team Plan Modal Show",u(n({},V),{referrer:r}))},[V,w==null?void 0:w.referrer]);const D=r=>{switch(r){case"month":z.logEvent("Account Pay: Team Plan Selection Clicked",u(n({},V),{buttonType:"Continue",numberOfSeats:m,planLength:Ee.MONTHLY}));break;case"year":z.logEvent("Account Pay: Select Team Plan Modal Clicked",u(n({},V),{buttonType:"Continue",numberOfSeats:m,planLength:Ee.ANNUAL}));break}},De=(r,P)=>{z.logEventWithStatsig("Account Pay: Select Team Plan Modal Clicked","chatgpt_select_team_plan_modal_continue_to_billing_clicked",u(n({},V),{buttonType:"Continue",numberOfSeats:P,planLength:r})),Ge.addAction("chatgpt_funnel.team_plan_modal_checkout_initiated",{planLength:r,numberOfSeats:P.toString(),accountId:d==null?void 0:d.id}),(t==null?void 0:t.state)==="eligible"&&q&&Ct.logCouponApplied(t.coupon)},et=()=>{z.logEvent("Account Pay: Select Team Plan Modal Dismiss",V)},B=Fe(),X=E.useMemo(()=>B.hash.split("#")[1]===de,[B.hash]);E.useEffect(()=>{var Se;const r=new URLSearchParams;r.set(ie,O.toString()),r.set(re,o),r.set("referrer",(Se=w==null?void 0:w.referrer)!=null?Se:document.referrer);const P=t!=null&&t.coupon&&t.coupon!==qe?t.coupon:null;P&&r.set(ae,P);const be=s||X?"#".concat(de):"#".concat($e),at="".concat(B.pathname,"?").concat(r.toString()).concat(be),K=new URL(window.location.href).searchParams,lt=K.get(ie)===O.toString(),nt=K.get(re)===o,ot=P==null&&!K.has(ae)||K.get(ae)===P,it=window.location.hash===be;(!lt||!nt||!ot||!it)&&window.history.pushState({from:B.pathname+B.search},"",at)},[O,s,X,B.pathname,B.search,B.hash,o,t==null?void 0:t.coupon,w==null?void 0:w.referrer]);let W;fe?W=$?F.team1dollarNotEligible:H.teamFreeTrialNotEligible:ge?W=$?F.team1dollarTemporarilyDisabled:H.teamFreeTrialTemporarilyDisabled:W=$?F.team1dollarOffline:H.teamFreeTrialOffline;const ee=fe||ge||Je,te=async()=>{S(!0),De(o,O),b(),y(),await c(o,O),S(!1)},he=()=>{l(),et()},xe=J(),tt=_t(),se=!(s||X)&&Et(xe,"2307162844").get("enabled",!1),ye=!tt&&!(s||X)&&At(xe,"3469223149").get("enabled_compact_seat_picker",!1),Te=e.jsx(Be,{numSeats:O,selectedPlan:o,billingDetails:x,totalLabel:C.allPlansTodayTotal,billDate:e.jsx(f,n({},C.today)),promoData:t}),U=j||A;if(s||X||se)return e.jsxs(we,{testId:"modal-workspace-purchase",type:"success",isOpen:a,onClose:l,size:"fullscreen",noPadding:!0,removePopoverStyling:!0,showCloseButton:!0,children:[!ye&&e.jsxs("div",{className:"grid grid-flow-row grid-cols-1 md:h-full md:grid-cols-2",children:[e.jsx("div",{className:"flex-column col-span-1 flex justify-center p-5 md:grid-cols-2",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col items-center md:max-w-[600px]",children:[e.jsx(Lt,{className:"mt-8 mb-6 h-8 w-8 md:fixed md:start-4 md:top-4 md:mt-0 md:h-6 md:w-6"}),ee&&e.jsx("div",{className:"mb-4 w-full","data-testid":"team-promo-banner",children:e.jsx(ne,{content:i.formatMessage(W),type:"info"})}),e.jsx("div",{className:"mb-8 text-3xl font-medium md:mt-[120px]",children:e.jsx(f,{id:"selectTeamPlanModal.title",defaultMessage:"Pick your plan"})}),e.jsxs(Ne,{className:me("col-span-3 mb-6 grid w-full gap-4 md:col-span-2 md:grid-cols-2"),defaultValue:o,onValueChange:r=>{Le(r)&&(h(r),D(r))},children:[e.jsx(Z,u(n({billingType:"year"},L),{selectedValue:o,hideSavingsMessage:U,hideDetails:!se})),e.jsx(Z,u(n({billingType:"month"},v),{selectedValue:o,hideDetails:!se,hideSavingsMessage:U,showWelcomeOfferLabel:U}))]}),e.jsx(le,{numSeats:m,minSeats:N,setNumSeats:T}),e.jsx("div",{className:"text-token-text-secondary self-start text-xs",children:i.formatMessage({id:"selectTeamPlanModal.seatsDescription",defaultMessage:"Add more seats at any time. Minimum of {minSeats} seats."},{minSeats:_})})]})}),e.jsx("div",{className:"col-span-3 flex h-full flex-col items-center overflow-hidden p-6 md:col-span-1 md:shadow-lg",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col md:mt-[120px]",children:[e.jsx(ke,{className:"mb-8 text-xl font-medium",children:e.jsx(f,n({},C.summaryTitle))}),Te,e.jsx(oe,{title:i.formatMessage(C.continueToBillingButton),onClick:te,loading:g,color:"green",className:"mt-8 w-full rounded-xl"}),e.jsx(oe,{title:i.formatMessage(C.cancel),onClick:he,color:"ghost",className:"mt-4 w-full rounded-xl"})]})})]}),ye&&e.jsx(Ft,{headerPaddingClassName:"pt-10 [@media(min-width:450px)]:pt-0",content:e.jsxs(It,{title:i.formatMessage(R.purchaseStepTitle),subTitle:i.formatMessage(R.purchaseStepSubtitle),children:[ee&&e.jsx("div",{"data-testid":"team-promo-banner",children:e.jsx(ne,{content:i.formatMessage(W),type:"info"})}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(le,{numSeats:m,minSeats:N,setNumSeats:T,classNames:qt,label:e.jsx(f,n({},R.seatsCountLabel))}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx(Ot,{required:!0,children:i.formatMessage(R.planSummaryTitle)}),e.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[e.jsx(Vt,{ariaLabel:i.formatMessage(R.planTypeLabel),leftItem:{label:e.jsxs("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:[i.formatMessage(C.annualPlanName),!U&&e.jsx("span",{className:"text-blue-400",children:i.formatMessage(C.annualPlanSavingsLabel,{percent:St(L.monthlyCost,L.discountedMonthlyCost)})})]}),value:"year"},rightItem:{label:i.formatMessage(R.monthlyPlanLabel),value:"month"},value:o,onChange:r=>{h(r),D(r)}}),e.jsx(Be,{numSeats:O,selectedPlan:o,billingDetails:x,totalLabel:R.allPlansTodayTotal,billDate:i.formatMessage(R.today),promoData:t,nonZeroDiscountClassName:"text-blue-400"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 pb-10 [@media(min-width:450px)]:pb-0",children:[e.jsx(_e,{size:"large",loading:g,onClick:te,children:i.formatMessage(C.continueToBillingButton)}),e.jsx(_e,{color:"ghost",size:"large",className:"w-full",onClick:he,disabled:g,children:i.formatMessage(C.cancel)})]})]})})]});const st=$?Xe:ze;return e.jsxs(we,{testId:"modal-select-team-plan",type:"success",isOpen:a,onClose:l,size:"custom",noPadding:!0,removePopoverStyling:!0,className:"max-w-4xl",showCloseButton:!0,hasSeparator:!0,title:i.formatMessage(C.selectTeamPlanModalTitle),children:[ee&&e.jsx("div",{className:"px-5 pt-4","data-testid":"team-promo-banner",children:e.jsx(ne,{content:i.formatMessage(W),type:"info"})}),e.jsxs("div",{className:"grid grid-flow-row grid-cols-3",children:[e.jsxs("div",{className:"flex-column col-span-3 p-5 md:col-span-2 md:grid-cols-2",children:[e.jsx(le,{numSeats:m,minSeats:N,setNumSeats:T}),q&&(t==null?void 0:t.state)==="eligible"&&o==="month"&&m>st&&e.jsx("div",{className:"text-token-text-secondary mt-1 self-start text-xs","data-testid":"team-promo-overseats-disclaimer",children:e.jsx(f,n({},$?F.team1dollarOverSeatsDisclaimer:H.teamFreeTrialOverSeatsDisclaimer))}),e.jsxs(Ne,{className:me("col-span-3 mt-5 grid gap-4 md:col-span-2 md:grid-cols-2"),defaultValue:o,onValueChange:r=>{Le(r)&&(h(r),D(r))},children:[e.jsx(Z,u(n({billingType:"year"},L),{selectedValue:o,hideSavingsMessage:U})),e.jsx(Z,u(n({billingType:"month"},v),{selectedValue:o,hideSavingsMessage:U,showWelcomeOfferLabel:U}))]})]}),e.jsxs("div",{className:"border-token-main-surface-tertiary bg-token-bg-elevated-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(ke,{children:e.jsx(f,n({},C.summaryTitle))}),Te,e.jsx(oe,{title:i.formatMessage(C.continueToBillingButton),onClick:te,loading:g,color:"primary",className:"mt-8 w-full rounded-xl"})]})]})]})},Be=({numSeats:a,selectedPlan:l,billingDetails:c,totalLabel:M,billDate:x,promoData:s,extraDiscountAmount:t,nonZeroDiscountClassName:d="text-[#10A37F]",footerNote:b})=>{const y=ue(),o=E.useCallback(L=>y.formatNumber(L,{style:"currency",currency:c.currency,currencyDisplay:"narrowSymbol",trailingZeroDisplay:"stripIfInteger"}),[c.currency,y]),{flexibleBillingPlan:h,annualBillingPlan:m}=Ve(c.currency),T=h,_=l==="month"?T:m,j=pt[l],A=(a||0)*(l==="year"?m.monthlyCost*12:T.monthlyCost);let g=(a||0)*_.unitCost,S=A-g,i=0,p=A,N=!1;if(s!=null&&(s.coupon===I||Q(s.coupon))&&s.state==="eligible"&&l==="month"){N=!0;const L=(s==null?void 0:s.coupon)===I?We(c.currency):Ye(c.currency),v=(s==null?void 0:s.coupon)===I?Xe:ze;a<=v?(i=L,p=a*T.monthlyCost,S=p-i,g=i):(i=L+(a-v)*T.monthlyCost,p=a*T.monthlyCost,S=p-i,g=i)}t&&t>0&&(S+=t,g=Math.max(g-t,0));let k;return s!=null&&Q(s.coupon)&&s.coupon!==qe&&s.state==="eligible"&&l==="month"&&(k={title:{id:"promo.teamFreeTrial.temporaryCardHold",defaultMessage:"Temporary card hold",description:"Label for the temporary card hold line item in the billing summary"},description:{id:"promo.teamFreeTrial.temporaryCardHoldDescription",defaultMessage:"Used to verify payment â€” we'll refund it",description:"Description for the temporary card hold line item in the billing summary"},amount:1},g+=1),e.jsxs("div",{className:"flex grow flex-col text-sm",children:[e.jsxs("div",{className:"text-token-text-secondary flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(f,n({},j.name))}),e.jsx("div",{className:"flex",children:e.jsx(f,u(n({},Y.preDiscountTotal),{values:{amount:o(A)}}))})]}),e.jsxs("div",{className:"text-token-text-tertiary flex w-full justify-between text-xs",children:[e.jsx("div",{className:"flex",children:e.jsx(f,u(n({},j.breakdown),{values:{numSeats:a}}))}),e.jsx("div",{className:"flex",children:e.jsx(f,u(n({},Y.breakdownAmount),{values:{amount:o(_.monthlyCost)}}))})]}),k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-token-text-secondary mt-3 flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(f,n({},k.title))}),e.jsx("div",{className:"flex",children:e.jsx(f,u(n({},Y.temporaryCardHoldAmount),{values:{amount:o(k.amount)}}))})]}),k.description&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,n({},k.description))})]}),e.jsxs("div",{className:"text-token-text-secondary mt-3 flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(f,n({},C.planDiscountLabel))}),e.jsx("div",{className:me("flex",S>0&&"font-medium",S>0&&d),children:e.jsx(f,u(n({},Y.discountAmount),{values:{amount:o(-S)}}))})]}),s!=null&&(s.coupon===I||Q(s.coupon))&&s.state==="eligible"&&l==="month"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,n({},(s==null?void 0:s.coupon)===I?F.team1dollarBelowDiscount:H.teamFreeTrialBelowDiscount))}),j.discountDescription&&m.discountedMonthlyCost<m.monthlyCost&&l==="year"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,u(n({},j.discountDescription),{values:{discountPercentage:Pt(m.monthlyCost,m.discountedMonthlyCost)}}))}),e.jsx("hr",{className:"border-token-border-default my-3"}),e.jsxs("div",{className:"flex w-full justify-between text-base font-medium",children:[e.jsx("div",{className:"flex",children:e.jsx(f,n({},M))}),e.jsx("div",{className:"flex",children:N?e.jsxs(e.Fragment,{children:[y.formatMessage(_.currencyCode)," ",o(g)]}):e.jsx(f,u(n({},Y.totalAmount),{values:{currencyCode:y.formatMessage(_.currencyCode),totalAmount:o(g)}}))})]}),e.jsxs("div",{className:"text-token-text-tertiary mt-2 text-xs",children:[N?e.jsx(f,u(n({},Y.afterPromoAmount),{values:{amount:o(p)}})):e.jsx(f,u(n({},j.billed),{values:{billDate:x}})),b&&e.jsx("div",{className:"mt-1",children:b})]})]})},ns=({isOpen:a,onClose:l,minimumSeats:c,billingDetails:M,existingAccount:x=void 0,promoData:s=void 0})=>{const t=ue(),d=jt(),b=Mt(),{prepareCheckoutSession:y,navigateToCheckout:o}=Ut(),h=J(),[m]=ft(),T=m.get("from_webview")==="ios",_=xt(t,x,b),{eligible:j,campaignId:A}=yt(),g=s!=null?s:j?{coupon:A,state:"eligible",redemption:null}:void 0,S=async(i,p)=>{if(!kt(h)){Bt(h,{fallbackScreenHint:"login",callbackUrl:window.location.href});return}try{const N=await y({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:_,price_interval:i,seat_quantity:p,existing_workspace_id:x==null?void 0:x.id},billing_details:M,cancel_url:window.location.href,promo_campaign:i==="month"?g==null?void 0:g.coupon:null},{fromiOSWebview:T});await o(N)}catch(N){Ge.addError(N),d.warning(t.formatMessage(C.paymentErrorWarning),{hasCloseButton:!0})}};return e.jsx(Xt,{isOpen:a,onClose:l,onSubmit:(i,p)=>S(i,p),minimumSeats:c,billingDetails:M,promoData:g})};export{Be as B,ns as T,ls as a,Yt as u};
//# sourceMappingURL=llpf7zhht8g5pr01.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/o90q6toygudvj850.js","assets/n75kuy1cx6f5mogg.js"])))=>i.map(i=>d[i]);
import{c as S,j as t,m as U,r as v,M as k,ar as Z,b as q,as as W,G as ee,a as te}from"./n75kuy1cx6f5mogg.js";import{ek as $,eB as se,eC as V,eD as oe,aY as Y,e as K,r5 as ne,T as ae,i as re,aP as le,O as ie,fy as de,f as ce,fR as ue,fS as fe,r6 as me,r7 as pe,J as xe,iV as ge,fA as he}from"./ewse8exzafeu10ji.js";import{L as _}from"./gvudnmdzjyrmv9hw.js";import{mi as G,cM as je,bx as ve,mj as ke,N as Me,bU as be}from"./ny10lj7zpuz89fvf.js";import{g as X}from"./kwx0iuln6nvklwc7.js";import{p as we}from"./dqiha9wnhddhrhyu.js";const Ce=a=>{"use forget";const e=S.c(17),{onDrag:s,onDragEnd:o,onDoubleClick:r,onDragStart:l,onPointerUp:u}=a;let d,n,f,i;e[0]===Symbol.for("react.memo_cache_sentinel")?(d={opacity:1},n={opacity:1},f={type:"tween",duration:.1},i={x:0,y:0,transform:"translateY(0px)"},e[0]=d,e[1]=n,e[2]=f,e[3]=i):(d=e[0],n=e[1],f=e[2],i=e[3]);let p;e[4]!==l?(p=()=>{l==null||l()},e[4]=l,e[5]=p):p=e[5];let h;e[6]===Symbol.for("react.memo_cache_sentinel")?(h={left:0,right:0,top:0,bottom:0},e[6]=h):h=e[6];let x;e[7]!==s?(x=(C,N)=>{s==null||s(N)},e[7]=s,e[8]=x):x=e[8];let g;e[9]!==o?(g=(C,N)=>o==null?void 0:o(N),e[9]=o,e[10]=g):g=e[10];let b;return e[11]!==r||e[12]!==u||e[13]!==p||e[14]!==x||e[15]!==g?(b=t.jsx(U.div,{drag:"x",tabIndex:-1,className:"bg-token-border-default pointer-events-auto absolute top-0 bottom-0 z-20 w-[4px] cursor-ew-resize rounded-full opacity-0 after:absolute after:inset-0 after:top-[-18px] after:w-[28px] after:bg-transparent after:content-['']",whileHover:d,whileDrag:n,transition:f,style:i,onPointerDown:p,dragMomentum:!1,dragSnapToOrigin:!1,dragElastic:!1,dragConstraints:h,onDrag:x,onPointerUp:u,onDragEnd:g,onDoubleClick:r}),e[11]=r,e[12]=u,e[13]=p,e[14]=x,e[15]=g,e[16]=b):b=e[16],b},ye=a=>{"use forget";const e=S.c(6),{content:s,tiktokenImport:o,o200kBaseImport:r}=a,{Tiktoken:l}=v.use(o),{default:u}=v.use(r);let d,n;e[0]!==l||e[1]!==s||e[2]!==u?(n=new l(u).encode(s),e[0]=l,e[1]=s,e[2]=u,e[3]=n):n=e[3],d=n.length;const f=d;let i;return e[4]!==f?(i=t.jsx("div",{className:"text-token-text-secondary min-w-0 truncate font-mono text-xs",children:t.jsx(k,{id:"NUKG65",defaultMessage:"{tokenCount} tokens",values:{tokenCount:t.jsx(Z,{value:f})}})}),e[4]=f,e[5]=i):i=e[5],i},I=({content:a})=>{"use forget";const e=v.useMemo(()=>$(()=>import("./o90q6toygudvj850.js"),__vite__mapDeps([0,1])),[]),s=v.useMemo(()=>$(()=>import("./o5eltwebd0mkim81.js"),[]),[]);return t.jsx(v.Suspense,{name:"dev-mode-token-count",fallback:t.jsx("div",{className:"loading-results-shimmer h-5 w-10 rounded-lg"}),children:t.jsx(ye,{content:a,tiktokenImport:e,o200kBaseImport:s})})},Se=a=>{const[e]=G(Y(a),se({path:V,args:s=>{const[o]=G(V(s),oe);return o!=null?o:{}}}));return e},_e=a=>{var e;try{const s=Y(a);return s&&(e=JSON.parse(s))!=null?e:void 0}catch(s){return null}},Ne=a=>{var e,s;return(s=(e=a.metadata)==null?void 0:e.chatgpt_sdk)==null?void 0:s.tool_response_metadata},Ie=(a,e)=>{for(const s of a.values())for(const o of s)if(o.id===e)return o;return null},Te=a=>{"use forget";const e=S.c(2),{children:s}=a;let o;return e[0]!==s?(o=t.jsx("div",{className:"relative z-0 border-b pb-2",children:s}),e[0]=s,e[1]=o):o=e[1],o},De=a=>{"use forget";const e=S.c(2),{children:s}=a;let o;return e[0]!==s?(o=t.jsx("div",{className:"z-0 px-3",children:s}),e[0]=s,e[1]=o):o=e[1],o},Re=a=>{"use forget";const e=S.c(14),{children:s,tooltip:o,accessory:r}=a,[l,u]=v.useState(!1),d=l?"border-token-border-default":"border-transparent";let n;e[0]!==d?(n=K("bg-token-bg-elevated-secondary sticky top-0 z-20 flex w-full min-w-0 items-center border-b px-3 py-1",d),e[0]=d,e[1]=n):n=e[1];let f;e[2]!==s?(f=t.jsx("span",{className:"text-token-text-secondary flex min-w-0 flex-1 gap-2 truncate text-base",children:s}),e[2]=s,e[3]=f):f=e[3];let i;e[4]!==r?(i=r&&t.jsx("div",{className:"ms-auto",children:r}),e[4]=r,e[5]=i):i=e[5];let p;e[6]!==n||e[7]!==f||e[8]!==i?(p=t.jsxs("div",{className:n,children:[f,i]}),e[6]=n,e[7]=f,e[8]=i,e[9]=p):p=e[9];const h=p;let x;e[10]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx("span",{"aria-hidden":"true",className:"pointer-events-none absolute block h-[1px] bg-transparent",ref:ne({options:{threshold:0},onChange(b,C){u(C.intersectionRatio===0)}})}),e[10]=x):x=e[10];let g;return e[11]!==h||e[12]!==o?(g=t.jsxs(t.Fragment,{children:[x,o?t.jsx(ae,{side:"left",triggerAs:null,labelTextAlign:"left",label:t.jsx(je,{size:"small",className:"text-sm leading-5 font-normal",forceDarkMode:!0,children:o}),children:h}):h]}),e[11]=h,e[12]=o,e[13]=g):g=e[13],g},c={Content:De,Header:Re,Root:Te},Ee=({focusedMessages:a,conversation:e})=>{"use forget";var H,z,J;const s=ce(),o=q(),r=W(0),l=W(400),u=ee([l,r],([m,y])=>ve(m-y,200,800)),[d,n]=v.useState(!1),{assistantMessage:f,toolMessages:i}=we(a),{platformConnectors:p,refetch:h}=ue(),{connectorLinks:x,refetch:g}=fe(),{path:b="",args:C={}}=(H=Se(f))!=null?H:{},[N,E,P]=b.split("/").filter(Boolean),[T,Q]=v.useState(!1),L=Ie(x,E),j=L?p.get(L.connector_id):null,w=j==null?void 0:j.actions.find(m=>m.name===P),O=(z=w==null?void 0:w.templates)==null?void 0:z[0],M=i.findLast(m=>{var y;return(y=m.author.name)==null?void 0:y.startsWith("api_tool.call_tool")}),B=v.useMemo(()=>M?_e(M):null,[M]),D=v.useMemo(()=>{var m;return(m=M==null?void 0:M.metadata)!=null&&m.chatgpt_sdk?ke(M.metadata.chatgpt_sdk):null},[M]),F=v.useMemo(()=>{const m=i.findLast(y=>{var A;return(A=y.author.name)==null?void 0:A.startsWith("api_tool.call_tool")});return m?Ne(m):null},[i]),R=te({mutationFn:async m=>{await me(m),await Promise.all([g(),h()])},onError:m=>{s.danger({defaultMessage:"Error refreshing actions.",description:"Error message when refreshing actions fails"},{error:m})}});return t.jsxs(t.Fragment,{children:[d&&t.jsx("div",{className:"fixed inset-0 z-0 bg-transparent"}),t.jsxs("div",{className:"border-token-border-default bg-token-bg-elevated-secondary z-10 h-full border-s",children:[t.jsx(Ce,{onDragStart:()=>{n(!0),r.set(0)},onDragEnd:()=>{n(!1),r.set(0),l.set(u.get())},onDrag:m=>r.set(r.get()+m.delta.x)}),t.jsxs(U.div,{className:"relative flex h-full flex-col",style:{width:u},children:[t.jsxs("div",{className:"flex h-(--header-height) items-center gap-1 ps-3 pe-2",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:"text-token-text-secondary text-xl font-medium",children:(J=j==null?void 0:j.name)!=null?J:t.jsx(k,{id:"lDDPYo",defaultMessage:"Unknown Connector"})})}),t.jsx(Me,{className:"ms-auto",onClick:()=>R.mutate(E),disabled:R.isPending,icon:R.isPending?pe:be}),t.jsx(xe,{onClick:()=>X(e).blur()})]}),t.jsxs("div",{className:"flex h-full flex-col overflow-x-hidden overflow-y-auto",children:[t.jsxs(c.Root,{children:[t.jsxs(c.Header,{accessory:w&&t.jsx(I,{content:w.description}),children:[(j==null?void 0:j.logo_url)&&t.jsx("img",{className:"h-5 w-5 rounded-md",src:j.logo_url,alt:j.name}),t.jsx("span",{className:"truncate font-mono text-sm",children:P})]}),w&&t.jsxs(c.Content,{children:[t.jsx("span",{className:K("text-token-text-primary text-sm whitespace-pre-wrap",T?"line-clamp-none":"line-clamp-4"),children:w.description}),t.jsx("button",{className:"text-token-text-secondary mt-1 flex justify-start text-sm hover:underline",onClick:()=>Q(!T),children:T?t.jsx(k,{id:"Mggt6n",defaultMessage:"See less"}):t.jsx(k,{id:"yhD38v",defaultMessage:"See all"})})]})]}),O&&t.jsxs(c.Root,{children:[t.jsx(c.Header,{accessory:t.jsx(ge,{href:"https://developers.openai.com/apps-sdk",children:t.jsx(he,{})}),children:t.jsx(k,{id:"hHDKiZ",defaultMessage:"Widget"})}),t.jsx(c.Content,{children:t.jsx(_,{isInitialLevelExpanded:!0,unwrap:!0,value:O.meta})})]}),t.jsxs(c.Root,{children:[t.jsx(c.Header,{tooltip:o.formatMessage({id:"yXxwQR",defaultMessage:"Tool input is the model-written input to the MCP tool. It is exposed to the widget code as `window.openai.toolInput`."}),accessory:t.jsx(I,{content:JSON.stringify(C)}),children:t.jsx(k,{id:"t5GE25",defaultMessage:"Tool input"})}),t.jsx(c.Content,{children:t.jsx(_,{isInitialLevelExpanded:!0,unwrap:!0,value:C})})]}),t.jsxs(c.Root,{children:[t.jsx(c.Header,{tooltip:o.formatMessage({id:"85NXIC",defaultMessage:"Tool output is the `structuredContent` field of the MCP tool response. It is exposed to the model, and to the widget code as `window.openai.toolOutput`."}),accessory:t.jsx(I,{content:JSON.stringify(B)}),children:t.jsx(k,{id:"E9SGiy",defaultMessage:"Tool output"})}),t.jsx(c.Content,{children:t.jsx(_,{isInitialLevelExpanded:!0,unwrap:!0,value:B})})]}),F&&t.jsxs(c.Root,{children:[t.jsx(c.Header,{tooltip:o.formatMessage({id:"4BhV8x",defaultMessage:"The tool response metadata is the `_meta` field of the MCP tool response. It is not exposed to the model, but is exposed to widget code as `window.openai.toolResponseMetadata`."}),children:t.jsx(k,{id:"OP/Fmv",defaultMessage:"Tool response metadata"})}),t.jsx(c.Content,{children:t.jsx(_,{isInitialLevelExpanded:!0,unwrap:!0,value:F})})]}),D&&t.jsxs(c.Root,{children:[t.jsx(c.Header,{tooltip:o.formatMessage({id:"pPuRCH",defaultMessage:"Persisted state of the widget. It is exposed to the widget code as `window.openai.widgetState`, and updated via `window.openai.setWidgetState`."}),accessory:t.jsx(I,{content:JSON.stringify(D)}),children:t.jsx(k,{id:"BtTaJR",defaultMessage:"Widget state"})}),t.jsx(c.Content,{children:t.jsx(_,{isInitialLevelExpanded:!0,unwrap:!0,value:D})})]})]})]})]},"dev-mode-sidebar")]})},ze=a=>{"use forget";const e=S.c(8),{clientThreadId:s}=a,o=re();let r;e[0]!==s||e[1]!==o?(r=le(o,s),e[0]=s,e[1]=o,e[2]=r):r=e[2];const l=r;let u;e[3]!==l?(u=()=>X(l).focusedMessages$(),e[3]=l,e[4]=u):u=e[4];const d=ie(u);let n;return e[5]!==l||e[6]!==d?(n=d.length>0&&t.jsx(de,{name:"DevModeSidebar",children:t.jsx(Ee,{focusedMessages:d,conversation:l})}),e[5]=l,e[6]=d,e[7]=n):n=e[7],n};export{ze as DevModeSidebar};
//# sourceMappingURL=bqopp0ylyt0pofvu.js.map

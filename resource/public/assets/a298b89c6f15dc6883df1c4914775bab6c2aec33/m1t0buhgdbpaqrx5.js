const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jwsjryhasdl9p2nq.js","assets/n75kuy1cx6f5mogg.js","assets/ewse8exzafeu10ji.js","assets/root-l2v84m1w.css","assets/go4mpxmt63qgntp4.js","assets/fzrn137102spawew.js","assets/dv12g54ivgixitjp.js","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css"])))=>i.map(i=>d[i]);
var X=Object.freeze,Y=Object.defineProperty,me=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var q=(s,n,t)=>n in s?Y(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,se=(s,n)=>{for(var t in n||(n={}))Z.call(n,t)&&q(s,t,n[t]);if(y)for(var t of y(n))ee.call(n,t)&&q(s,t,n[t]);return s},ne=(s,n)=>me(s,xe(n));var te=(s,n)=>{var t={};for(var l in s)Z.call(s,l)&&n.indexOf(l)<0&&(t[l]=s[l]);if(s!=null&&y)for(var l of y(s))n.indexOf(l)<0&&ee.call(s,l)&&(t[l]=s[l]);return t};var oe=(s,n)=>X(Y(s,"raw",{value:X(n||s.slice())}));import{C as ue,fa as pe,fb as fe,fc as C,B as he,J as je,nH as N,e as F,ej as ge,F as _e,f as be,lR as ve,fG as we,fS as Ce,ek as Ne}from"./ewse8exzafeu10ji.js";import{j as e,r as j}from"./n75kuy1cx6f5mogg.js";import{dW as ke,e2 as ye,a3 as Se,aT as Le}from"./ny10lj7zpuz89fvf.js";import{u as Me,D as Oe}from"./f19z8prril37x47b.js";import{u as De,U as Fe,a as le}from"./ezgtgas8dtpm62t5.js";import{s as Pe}from"./go4mpxmt63qgntp4.js";import{S as M}from"./c4s32epvqc9sbuhy.js";import{S as O}from"./l351nx0zzb742rw6.js";import"./d5vv6ct7n3prp63a.js";import"./l5i1wpx91f7uj9ss.js";import"./ba67rckyafl646eq.js";import"./byq2jfs2d5331lqi.js";import"./fb5r26w2lbkp5hh3.js";const Ee=ge(()=>Ne(()=>import("./jwsjryhasdl9p2nq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(s=>s.JsonViewer));function es({threadId:s,threadUserId:n}){return De(Fe.isDebugModalOpen)&&e.jsx(ue,{testId:"modal-sonic-debug",isOpen:!0,onClose:()=>le.toggleDebugModalOpen(),type:"success",size:"fullscreen",noPadding:!0,rootClassName:"z-50",children:e.jsx(ze,{threadId:s,threadUserId:n!=null?n:void 0,onClose:()=>le.toggleDebugModalOpen()})})}const Te=(s,n)=>{const t=JSON.stringify(n,null,2),l=new Blob([t],{type:"application/json"}),a=window.URL.createObjectURL(l),i=document.createElement("a");i.href=a,i.download=s,i.click(),window.URL.revokeObjectURL(a)},ae="<|im_start|>",re="<|im_sep|>",ce="<|im_end|>",Re="<|fim_suffix|>",$e="<|meta_sep|>";function ie({prompt:s}){const[n,t]=j.useState({}),l=[],a=[];let i=0;for(;;){const r=s.indexOf(ae,i);if(r===-1)break;const d=s.indexOf(re,r);if(d===-1)break;let o=s.indexOf(ce,d);const m=s.indexOf(Re,d);if(m!==-1&&(o===-1||m<o)&&(o=m),o===-1)break;const c=s.substring(r+ae.length,d).replace($e," channel="),g=s.substring(d+re.length,o);a.push(r);const k=n[r];l.push(e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>t(_=>ne(se({},_),{[r]:!_[r]})),children:k?e.jsx(O,{size:14}):e.jsx(M,{size:14})}),e.jsxs("span",{className:"font-semibold",children:["[",c,"]"]})]}),e.jsx("div",{className:F("whitespace-pre-wrap",k&&"line-clamp-2 truncate"),children:g})]},r)),i=o+ce.length}function u(r){const d={};for(const o of a)d[o]=r;t(d)}return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute end-0 top-0 flex items-center gap-2 text-xs font-semibold",children:[e.jsxs("button",{className:"flex items-center gap-1 underline",onClick:()=>u(!0),children:[e.jsx(M,{size:14})," Collapse All"]}),"/",e.jsxs("button",{className:"flex items-center gap-1 underline",onClick:()=>u(!1),children:[e.jsx(O,{size:14})," Expand All"]})]}),e.jsx("div",{className:"flex flex-col gap-3",children:l})]})}var de;const h=_e.div(de||(de=oe(["mb-[-5px] pb-0.5 font-semibold uppercase border-b-2 ",""])),({$isSelected:s})=>s?"border-black dark:border-white":"border-transparent");function ze({threadId:s,threadUserId:n,message:t,onClose:l}){var E,T,R,$,z,A,V,J,B,U,I;const[a,i]=j.useState(t?"message":"json"),{data:u,isLoading:r,refetch:d}=Me({threadId:s,threadUserId:n,refetchOnMount:"always"}),o=u==null?void 0:u.thread;if(j.useEffect(()=>{i(t?"message":o!=null&&o.turns.length?"turn".concat((o==null?void 0:o.turns.length)-1):"thread")},[o==null?void 0:o.turns.length,t]),!r&&!o&&!t)return e.jsxs(Oe,{onClickRetry:()=>d(),children:["Failed to load."," "]});if(r)return e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:"Loading..."});const m=o==null?void 0:o.turns,c=o==null?void 0:o.turns[o.turns.length-1],g=(T=(E=c==null?void 0:c.artifacts__)==null?void 0:E.model_snapshots)==null?void 0:T.default_id,k=(A=(z=($=(R=c==null?void 0:c.artifacts__)==null?void 0:R.settings)==null?void 0:$.model_response)==null?void 0:z.completion_model)==null?void 0:A.model,_=g!=null?g:k,S=(V=c==null?void 0:c.artifacts__)==null?void 0:V.eval_preset,P=n&&s?ye(n,s):null,b=(U=(B=(J=t==null?void 0:t.metadata)==null?void 0:J.__internal)==null?void 0:B.debug)==null?void 0:U.render_for_completion_result_decoded;return e.jsx("div",{className:"flex flex-col gap-2 font-mono text-xs break-words",children:e.jsxs(pe,{orientation:"vertical",value:a,onValueChange:p=>i(p),children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs(fe,{className:"flex items-center justify-start gap-3 p-2",children:[t&&e.jsx(C,{value:"message",children:e.jsx(h,{$isSelected:a==="message",children:"Message"})},"message"),b&&e.jsx(C,{value:"render_for_completion",children:e.jsx(h,{$isSelected:a==="render_for_completion",children:"Prompt"})},"render_for_completion"),o&&e.jsx(C,{value:"thread",children:e.jsx(h,{$isSelected:a==="thread",children:"Thread"})},"thread"),e.jsx(C,{value:"connectors",children:e.jsx(h,{$isSelected:a==="connectors",children:"Connectors"})},"connectors"),m==null?void 0:m.map((p,x)=>{var f,v;return e.jsxs(j.Fragment,{children:[e.jsx(C,{value:"turn".concat(x),children:e.jsxs(h,{$isSelected:a==="turn".concat(x),children:["Turn[",x,"]"]})},x),(v=(f=p.artifacts__)==null?void 0:f.debug_ddtrace_urls)==null?void 0:v.map(w=>e.jsx(h,{$isSelected:!1,children:e.jsxs("a",{target:"_blank",href:w,className:"text-nowrap",rel:"noreferrer",children:["Trace[",x,"] â†—"]})},w))]},x)})]}),e.jsxs("div",{className:"flex items-center justify-end",children:[o&&e.jsxs(he,{size:"small",color:"secondary",onClick:()=>Te("thread.json",o),children:[e.jsx(ke,{className:"icon-sm"})," thread.json"]}),e.jsx(je,{onClick:l})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[_&&e.jsxs(e.Fragment,{children:[e.jsx(L,{name:"Model",id:_,className:"shrink-0"})," ",e.jsx("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),S&&S!=="production"&&e.jsxs(e.Fragment,{children:[e.jsx(L,{name:"Eval Preset",id:S,className:"shrink-0"}),e.jsx("span",{className:"text-gray-500 dark:text-white",children:"|"})]}),P&&e.jsx(e.Fragment,{children:e.jsx(L,{name:"Permalink",id:P,className:"flex-shrink-1"})})]}),m==null?void 0:m.map((p,x)=>{var v,w,K,W,G,H,Q;const f=(v=p.model_response)==null?void 0:v.text;return e.jsxs(N,{value:"turn".concat(x),className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth",children:[e.jsxs("div",{className:F("flex flex-col gap-2 p-2",((w=p.index)!=null?w:0)%2===1&&"bg-token-main-surface-secondary"),children:[e.jsx(ie,{prompt:(H=(G=(W=(K=p.artifacts__)==null?void 0:K.debug_info)==null?void 0:W.main_model_response)==null?void 0:G.prompt_string)!=null?H:""}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"[assistant]"}),e.jsx("div",{"data-testid":"assistant-response",className:"whitespace-pre-wrap",children:(Q=Pe(f!=null?f:""))!=null?Q:f})]})]})," "]},x)}),o&&e.jsx(N,{value:"thread",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-2",children:e.jsx(D,{data:o,collapsed:4,jsonFiltersKey:"thread"})}),t&&e.jsx(N,{value:"message",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-2",children:e.jsx(D,{data:t,collapsed:4,jsonFiltersKey:"message"})}),b&&e.jsx(N,{value:"render_for_completion",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-2",children:e.jsx(ie,{prompt:b!=null?b:""})}),e.jsx(N,{value:"connectors",className:"max-h-[calc(100vh-46px)] w-full overflow-y-scroll scroll-smooth p-2",children:e.jsx(Ae,{})})]},(I=o==null?void 0:o.turns.length)!=null?I:"message")})}function D({data:s,collapsed:n,jsonFiltersKey:t}){const[l,a]=j.useState(n!=null?n:!0);return e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsx("button",{onClick:()=>a(!l),className:"flex items-center gap-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:14})," Expand all"]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:14})," Collapse all"]})}),e.jsx("div",{className:"w-full",children:e.jsx(Ee,{jsonFiltersKey:t,json:s,jsonViewProps:{collapsed:l,shortenTextAfterLength:0}},String(l))})]})}function Ae(){const{availableConnectors:s,isLoading:n}=ve(),{connectionInstanceData:t,isLoading:l}=we({}),{connectorLinks:a,isLoading:i}=Ce({fetchValidLinksOnly:!0});if(n||l||i)return e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:"Loading connectors..."});const u=s.map(r=>{const c=r,{logo_url:d,logo_url_dark:o}=c;return te(c,["logo_url","logo_url_dark"])});return e.jsx(D,{data:{availableConnectors:u,syncConnectors:t,accessConnectors:a},collapsed:2,jsonFiltersKey:"connectors"})}function L({name:s,id:n,className:t}){const l=be(),a=j.useCallback(i=>{Se(n,l,i)},[n,l]);return e.jsxs("div",{className:F("flex items-center gap-2 truncate",t),children:[e.jsxs("span",{className:"font-semibold text-nowrap",children:[s,":"]}),e.jsx("span",{title:n,className:"truncate text-gray-500 dark:text-white",children:n}),e.jsx(Le,{onCopy:a})]})}export{D as DebugJsonViewer,es as DebugModal,ze as DebugModalContents};
//# sourceMappingURL=m1t0buhgdbpaqrx5.js.map

import{r as S,c as M,j as C}from"./n75kuy1cx6f5mogg.js";import{jY as L,jZ as R,j_ as x,cz as E,ie as F,cy as j}from"./ny10lj7zpuz89fvf.js";import{br as T,aS as I,aR as k,cN as v,i as N}from"./ewse8exzafeu10ji.js";function w(A,s){return H[s]}const H={inProgress:"Running tool",finished:"Finished running tool",error:"Error running tool"};function b({messages:A,isRequestActive:s,isLastMessageInTurn:m,clientThreadId:u}){"use forget";const c=A.filter(t=>t.author.role===T.Assistant&&t.recipient&&L(t.recipient)),g=I(u),f=g?k.getConversationTurns(g).flatMap(t=>t.messages):[],i=f.findLastIndex(t=>t.author.role===T.Assistant&&t.recipient&&L(t.recipient)),r=i>=0?f[i]:void 0,e=r&&r.recipient,d=i>=0?f.slice(i+1).filter(t=>t.author.role===T.Tool&&t.author.name===e):[],l=i>=0?f.slice(i+1).find(t=>t.author.role===T.Assistant&&(!t.recipient||!L(t.recipient))):void 0,h=l!=null&&v(l),y=d.length>0,o=r==null?void 0:r.id,n=R(t=>o?t.getToolState(u,o):void 0);let a=null;y||(n==null?void 0:n.status)===x.Finished?a={key:"finished",status:E.Finished}:(n==null?void 0:n.status)===x.Error?a={key:"error",status:E.Error}:((n==null?void 0:n.status)===x.Running||s&&m&&!n)&&(a={key:"inProgress",status:E.Running});const p=S.useMemo(()=>!e||!a?null:w(e,a.key),[e,a]);return c.length===0||!e||!c.some(t=>t.id===(r==null?void 0:r.id))||h||!a?null:{type:"message",message:p,display:a}}function U(A){"use forget";const s=M.c(20),{messages:m,isRequestActive:u,isLastMessageInTurn:c,clientThreadId:g,isWithinFirstAssistantTurns:f}=A,i=N();let r;s[0]!==g||s[1]!==c||s[2]!==u||s[3]!==m?(r={messages:m,isRequestActive:u,isLastMessageInTurn:c,clientThreadId:g},s[0]=g,s[1]=c,s[2]=u,s[3]=m,s[4]=r):r=s[4];const e=b(r);let d;s[5]!==i?(d=F(i),s[5]=i,s[6]=d):d=s[6];const{clearLoadingState:l,onUseLoadingText:h,areLoadingStatesEnabled:y}=d,o=f&&(e==null?void 0:e.type)==="message"&&e.message&&y;let n,a;if(s[7]!==o||s[8]!==l||s[9]!==e||s[10]!==h?(n=()=>{if((e==null?void 0:e.type)==="suggestion"){l();return}o&&e.message&&h(e.message)},a=[o,l,e,h],s[7]=o,s[8]=l,s[9]=e,s[10]=h,s[11]=n,s[12]=a):(n=s[11],a=s[12]),S.useEffect(n,a),!e||o||e.type==="suggestion")return null;let p;return s[17]!==e.display.status||s[18]!==e.message?(p=C.jsx(j,{highlightedCommand:e.message,showWorkUserSetting:!1,status:e.display.status,children:null}),s[17]=e.display.status,s[18]=e.message,s[19]=p):p=s[19],p}export{U as BrowserToolMessage};
//# sourceMappingURL=ifwohzs2c8tav0z4.js.map

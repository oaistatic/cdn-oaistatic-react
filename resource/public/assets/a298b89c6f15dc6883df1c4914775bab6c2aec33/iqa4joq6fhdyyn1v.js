var Y=Object.defineProperty,z=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(e,n,o)=>n in e?Y(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,a=(e,n)=>{for(var o in n||(n={}))Q.call(n,o)&&B(e,o,n[o]);if(S)for(var o of S(n))$.call(n,o)&&B(e,o,n[o]);return e},h=(e,n)=>z(e,K(n));import{f as V,r as v,j as t,M as m,d as X,n as w,R as J}from"./n75kuy1cx6f5mogg.js";import{pS as Z,R as ee,pT as te,pU as O,E as W,B as R,i as ne,j as oe,pV as se,P as k,pW as ie,kY as P,pX as re,dg as ae,at as ce,pY as de}from"./ewse8exzafeu10ji.js";import{u as le,a as ue}from"./efc6pm86205um7c5.js";import{S as me,a as ge}from"./lt9kme5w6dg8d0tp.js";import{u as F}from"./frf4c35l48b0bjrb.js";import{gh as fe}from"./ny10lj7zpuz89fvf.js";const G=v.createContext(null),xe=async(e,n)=>await ee.safeGet("/aip/connectors/{connector_id}/tos",{parameters:{path:{connector_id:e}},additionalHeaders:n?{[te]:n}:void 0}),U=(e,n,{enabled:o=!0}={})=>V({queryKey:Z(e,n),queryFn:()=>{if(!e)throw new Error("connectorId is required to fetch connector TOS");return xe(e,n)},staleTime:5*60*1e3,enabled:o&&!!e}),pe=({connectorId:e,productSku:n,children:o,enabled:s=!0})=>{const i=U(e,n,{enabled:s}),c=v.useMemo(()=>({query:i}),[i]);return t.jsx(G.Provider,{value:c,children:o})},he=()=>{const e=v.useContext(G);if(!e)throw new Error("useRedirectTos must be used within a RedirectTosProvider");return e.query},je=e=>{const n=[],o=/\[([^\]]+)\]\(([^)]+)\)/g;let s=0,i;for(;(i=o.exec(e))!==null;){i.index>s&&n.push(e.slice(s,i.index));const[c,d,r]=i;n.push(t.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"underline",children:d},"".concat(r,"-").concat(i.index))),s=i.index+c.length}return s<e.length&&n.push(e.slice(s)),n.length===0?e:n.length===1?n[0]:n},Me=(e,n)=>{var o,s;return n?{genericName:(o=n.generic_name)!=null?o:e.name,blurbs:(s=n.blurbs)!=null?s:[]}:null};function A(){const e=w();return J.useMemo(()=>{var o;const n=e.hash.includes("?")?e.hash.substring(e.hash.indexOf("?")+1):e.search.substring(1);return(o=new URLSearchParams(n).get("referrer"))!=null?o:void 0},[e.hash,e.search])}const H=({blurbs:e})=>{var n;return t.jsx("div",{className:"border-token-border-default rounded-2xl border px-4",children:Array.from({length:(n=e==null?void 0:e.length)!=null?n:3}).map((o,s)=>{const i=e==null?void 0:e[s];return t.jsx("div",{className:"border-token-border-default flex gap-4 border-b py-2 last-of-type:border-none",children:i?t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("div",{className:"pb-0.5 text-sm font-medium",children:i.title}),t.jsx("div",{className:"text-token-text-secondary text-xs",children:je(i.description)})]}):t.jsx(re,{lines:2})},"".concat(s))})})},ve=({connector:e,onClose:n})=>{var o,s;return t.jsx(O,{onClose:n,connectorIcon:t.jsx(fe,{connector:e,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),connectorDeveloper:(s=(o=e.branding)==null?void 0:o.developer)!=null?s:void 0,title:t.jsx(m,h(a({},g.addConnectorLinkModalTitle),{values:{connectorName:e.name}}))})},C=({loading:e,onClick:n,children:o})=>t.jsx(R,{className:"w-full",size:"large",onClick:n,loading:e,children:o}),ke=({loading:e,onClick:n,children:o})=>t.jsx(R,{className:"text-token-text-secondary w-full border-0",size:"large",onClick:n,loading:e,color:"secondary",children:o}),N=({connector:e,tos:n,onClose:o,children:s,beforeBlurbs:i})=>t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("div",{children:t.jsx(ve,{connector:e,onClose:o})}),i,t.jsx(H,{blurbs:n==null?void 0:n.blurbs}),s]}),E=({connector:e,tos:n,onClose:o})=>t.jsx(N,{connector:e,tos:n,onClose:o,children:t.jsx(C,{loading:!0,onClick:()=>{}})}),D=({connector:e,tos:n,onClose:o,retry:s})=>t.jsx(N,{connector:e,tos:n,onClose:o,children:t.jsx("div",{className:"flex items-center justify-center pt-4",children:t.jsx(R,{onClick:s,size:"large",className:"w-full",children:t.jsx(m,a({},g.errorLoadingStateButton))})})}),Se=({connectorIcon:e,connectorName:n,connectorId:o,onClose:s,isConnecting:i,onContinue:c,productSku:d})=>{var x,p;const{data:r,isLoading:f,isError:j,refetch:M}=U(o,d),l=(x=r==null?void 0:r.blurbs)!=null?x:[],u=(p=r==null?void 0:r.generic_name)!=null?p:"Google";return t.jsxs(t.Fragment,{children:[t.jsx(O,{onClose:s,connectorIcon:e,title:t.jsx(m,h(a({},g.addConnectorLinkModalTitle),{values:{connectorName:n}}))}),f?t.jsx("div",{className:"flex items-center justify-center p-4",children:t.jsx(W,{})}):j?t.jsx("div",{className:"flex items-center justify-center pt-4",children:t.jsx(R,{onClick:()=>void M(),size:"large",className:"w-full",children:t.jsx(m,a({},g.errorLoadingStateButton))})}):l.length>0?t.jsx(H,{blurbs:l}):null,t.jsx("div",{className:"pt-4",children:t.jsx(C,{loading:i,onClick:c,children:t.jsx(m,h(a({},g.continueButton),{values:{connectorName:u}}))})})]})},I=({connector:e,tos:n,onClose:o,isConnecting:s,isConnectingAuthType:i,onContinue:c,showExternalIcon:d,additionalMessageThatDoesNotContainLegalClaims:r})=>{const f=ne(),j=f&&oe(f,"2792858552"),M=se(),l=A();v.useEffect(()=>{k.logEventWithStatsig("connectors.shown_connect_modal","connectors.shown_connect_modal",a({mfa:"not_required",type:e.id},l&&{referrer:l}))},[e.id,l]);const u=T=>{k.logEventWithStatsig("connectors.click_continue_modal","connectors.click_continue_modal",{action:"connection",type:e.id}),c(T)},x=ie(e,M),{supported_auth:p}=e,y=j&&!M&&p.some(T=>T.type==="OAUTH")&&p.some(T=>T.type==="NONE"),L=r?t.jsx("div",{className:"bg-token-interactive-bg-accent-muted-context rounded-xl p-4 text-center text-sm text-[#0285FF]",children:r}):void 0,_=t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(C,{loading:s&&i==="OAUTH",onClick:()=>u("OAUTH"),children:t.jsxs("span",{className:"flex items-center justify-center gap-1",children:[t.jsx(m,h(a({},g.continueButton),{values:{connectorName:e.name}})),d&&t.jsx(P,{className:"icon-sm"})]})}),t.jsx(ke,{loading:s&&i==="NONE",onClick:()=>u("NONE"),children:t.jsx("span",{className:"flex items-center justify-center gap-1",children:t.jsx(m,a({},g.connectWithoutAccountButton))})})]}),b=t.jsx(C,{loading:s,onClick:()=>u(),children:t.jsxs("span",{className:"flex items-center justify-center gap-1",children:[x==="OAUTH"?t.jsx(m,h(a({},g.continueButton),{values:{connectorName:e.name}})):t.jsx(m,h(a({},g.connectButton),{values:{connectorName:e.name}})),x==="OAUTH"&&d&&t.jsx(P,{className:"icon-sm"})]})});return t.jsx(N,{connector:e,tos:n,onClose:o,beforeBlurbs:L,children:y?_:b})},ye=({connector:e,tos:n,onClose:o})=>{const s=w(),[i,c]=v.useState(!1),d=s.hash?s.pathname+s.hash:s.pathname,{setupMfa:r}=F({redirectUrl:d}),f=A();v.useEffect(()=>{k.logEventWithStatsig("connectors.shown_connect_modal","connectors.shown_connect_modal",a({mfa:"required",type:e.id},f&&{referrer:f}))},[e.id,f]);const j=()=>{c(!0),k.logEventWithStatsig("connectors.click_continue_modal","connectors.click_continue_modal",{action:"mfa",type:e.id}),r()};return t.jsxs(N,{connector:e,tos:n,onClose:o,children:[t.jsx("div",{className:"pt-2"}),t.jsx("div",{className:"border-token-border-default border-t p-4",children:t.jsx("div",{className:"text-token-text-primary font-medium",children:t.jsx(m,a({},g.mfaRequiredTitle))})}),t.jsx(C,{loading:i,onClick:j,children:t.jsx(m,a({},g.mfaRequiredButton))})]})},q={"google-oauth2":{icon:t.jsx(de,{}),name:"Google"},windowslive:{icon:t.jsx(ge,{}),name:"Microsoft"},apple:{icon:t.jsx(me,{}),name:"Apple"}},Ce=({connector:e,tos:n,onClose:o,isConnecting:s,onContinue:i})=>{var _;const{session:c}=ae(),d=(_=c==null?void 0:c.user)==null?void 0:_.idp,r=w(),[f,j]=v.useState(!1),M=r.hash?r.pathname+r.hash:r.pathname,{setupMfa:l}=F({redirectUrl:M}),u=A();v.useEffect(()=>{k.logEventWithStatsig("connectors.shown_connect_modal","connectors.shown_connect_modal",a({mfa:"suggested",type:e.id},u&&{referrer:u}))},[e.id,u]);const x=()=>{j(!0),k.logEventWithStatsig("connectors.click_continue_modal","connectors.click_continue_modal",{action:"mfa",type:e.id}),l()},p=()=>{k.logEventWithStatsig("connectors.click_continue_modal","connectors.click_continue_modal",{action:"connection"}),i()};if(!d||!q[d])return ce.addError("Unknown idp found on suggested mfa requirement",{idp:d}),t.jsx(I,{connector:e,onClose:o,tos:n,isConnecting:s,onContinue:i});const{icon:y,name:L}=q[d];return t.jsxs(N,{connector:e,tos:n,onClose:o,children:[t.jsxs("div",{className:"border-token-border-default flex items-center gap-4 rounded-xl border p-4 text-sm",children:[t.jsx("div",{className:"text-token-text-primary",children:y}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"text-token-text-primary font-medium",children:t.jsx(m,h(a({},g.socialLoginTitle),{values:{socialProvider:L}}))}),t.jsx("div",{className:"text-token-text-secondary",children:t.jsx(m,h(a({},g.socialLoginDescription),{values:{socialProvider:L,link:b=>t.jsx("button",{onClick:x,className:"underline",children:t.jsxs("span",{className:"flex items-center gap-2",children:[b,f&&t.jsx(W,{className:"h-4 w-4"})]})})}}))})]})]}),t.jsx("div",{className:"pt-6",children:t.jsx(C,{loading:s,onClick:p,children:t.jsx(m,h(a({},g.continueButton),{values:{connectorName:e.name}}))})})]})},Te=({connector:e,onClose:n,isConnecting:o,isConnectingAuthType:s,onContinue:i,showExternalIcon:c,additionalMessageThatDoesNotContainLegalClaims:d})=>{const{data:r,isLoading:f,isError:j,refetch:M}=he(),l=Me(e,r),{status:u,retry:x}=le(e.id),{status:p,retry:y}=ue({enabled:u==="required"||u==="suggested"});return f?t.jsx(E,{connector:e,tos:l,onClose:n}):j||!l?t.jsx(D,{connector:e,tos:l,onClose:n,retry:()=>{M(),y(),x()}}):p==="loading"||u==="loading"?t.jsx(E,{connector:e,tos:l,onClose:n}):p==="enabled"||u==="not_required"?t.jsx(I,{connector:e,tos:l,onClose:n,isConnecting:o,isConnectingAuthType:s,onContinue:i,showExternalIcon:c,additionalMessageThatDoesNotContainLegalClaims:d}):u==="required"?t.jsx(ye,{connector:e,tos:l,onClose:n}):u==="suggested"?t.jsx(Ce,{connector:e,tos:l,onClose:n,isConnecting:o,onContinue:i}):t.jsx(D,{connector:e,tos:l,onClose:n,retry:()=>{y(),x(),M()}})},Be=({connector:e,onClose:n,isConnecting:o,isConnectingAuthType:s,onContinue:i,showExternalIcon:c,productSku:d,additionalMessageThatDoesNotContainLegalClaims:r})=>t.jsx(pe,{connectorId:e.id,productSku:d,children:t.jsx(Te,{connector:e,onClose:n,isConnecting:o,isConnectingAuthType:s,onContinue:i,showExternalIcon:c,additionalMessageThatDoesNotContainLegalClaims:r})}),g=X({addConnectorLinkModalTitle:{id:"addConnectorLinkModal.title",defaultMessage:"Connect {connectorName}"},permissionsTitle:{id:"addConnectorLinkModal.permissionsTitle",defaultMessage:"Permissions always respected"},permissionsDescription:{id:"addConnectorLinkModal.permissionsDescription",defaultMessage:"ChatGPT is strictly limited to permissions you've explicitly set."},inControlTitle:{id:"addConnectorLinkModal.inControlTitle",defaultMessage:"You're in control"},inControlDescription:{id:"addConnectorLinkModal.inControlDescription",defaultMessage:"ChatGPT always respects your training data preferences."},noTrainTitle:{id:"addConnectorLinkModal.noTrainTitle",defaultMessage:"How ChatGPT uses data"},noTrainDescription:{id:"addConnectorLinkModal.noTrainDescription",defaultMessage:"Data accessed from this connector is not used to train our models."},neverTrainTitle:{id:"addConnectorLinkModal.neverTrainTitle",defaultMessage:"How ChatGPT uses data"},neverTrainDescription:{id:"addConnectorLinkModal.neverTrainDescription",defaultMessage:"Your data is never used for training."},risksTitle:{id:"addConnectorLinkModal.risksTitle",defaultMessage:"Connectors may introduce risk"},risksDescription:{id:"addConnectorLinkModal.risksDescription",defaultMessage:"Connectors are designed to respect your privacy, but sites may attempt to steal your data. <link>Learn more on how to stay safe</link>"},redirectTitle:{id:"addConnectorLinkModal.redirectTitle",defaultMessage:"This page will redirect to {connectorName}"},redirectDescription:{id:"addConnectorLinkModal.redirectDescription",defaultMessage:"You'll sign in and confirm permissions on {connectorName}'s page."},googlePrivacyTitle:{id:"addConnectorLinkModal.googlePrivacyTitle",defaultMessage:"Private and secure"},googlePrivacyDescription:{id:"addConnectorLinkModal.googlePrivacyDescription",defaultMessage:"Data accessed from {connectorName} may be used to reply to prompts. We do not train generalized models on this data or derivations of it, unless you choose to submit it as feedback. <link>Learn more</link>"},googleControlTitle:{id:"addConnectorLinkModal.googleControlTitle",defaultMessage:"You're in control of your data"},googleControlDescription:{id:"addConnectorLinkModal.googleControlDescription",defaultMessage:"You can delete your conversations, which will also delete any {connectorName} data used in those conversations. <link>Learn more</link>"},connectButton:{id:"addConnectorLinkModal.connectButton",defaultMessage:"Connect {connectorName}"},connectWithoutAccountButton:{id:"addConnectorLinkModal.connectWithoutAccountButton",defaultMessage:"Continue without account"},continueButton:{id:"addConnectorLinkModal.continueButton",defaultMessage:"Continue to {connectorName}"},socialLoginTitle:{id:"addConnectorLinkModal.socialLoginTitle",defaultMessage:"You use {socialProvider} to authenticate"},socialLoginDescription:{id:"addConnectorLinkModal.socialLoginDescription",defaultMessage:"For added security, enable Multi-factor authentication (MFA) on your {socialProvider} account or <link>your ChatGPT account.</link>"},mfaRequiredTitle:{id:"addConnectorLinkModal.mfaRequiredTitle",defaultMessage:"Multi-factor authentication (MFA) required"},mfaRequiredButton:{id:"addConnectorLinkModal.mfaRequiredButton",defaultMessage:"Turn on MFA to continue"},errorLoadingStateButton:{id:"addConnectorLinkModal.errorLoadingStateButton",defaultMessage:"Failed to load connector settings, please retry"}});export{Se as GoogleRedirectContent,I as MainRedirectContent,Te as MainRedirectContentWrapper,Be as RedirectContent};
//# sourceMappingURL=iqa4joq6fhdyyn1v.js.map

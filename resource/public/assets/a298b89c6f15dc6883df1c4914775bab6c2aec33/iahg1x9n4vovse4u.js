var de=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var se=(t,e,a)=>e in t?de(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,T=(t,e)=>{for(var a in e||(e={}))oe.call(e,a)&&se(t,a,e[a]);if(H)for(var a of H(e))ae.call(e,a)&&se(t,a,e[a]);return t},K=(t,e)=>ue(t,me(e));var Y=(t,e)=>{var a={};for(var o in t)oe.call(t,o)&&e.indexOf(o)<0&&(a[o]=t[o]);if(t!=null&&H)for(var o of H(t))e.indexOf(o)<0&&ae.call(t,o)&&(a[o]=t[o]);return a};import{c as ee,b as te,j as s,r as S,M as G}from"./n75kuy1cx6f5mogg.js";import{B as fe,O as q,aN as y,aF as re,ex as O,eO as C,aa as pe,i as ie,b5 as he,e as xe,gT as je,V as z,P as ce,f as ge,r as ye,aM as Q,C as be,fk as Se}from"./ewse8exzafeu10ji.js";import{gm as Me,l$ as ve,m0 as $e,e1 as Pe,m1 as Ce,fI as Ee,c4 as Oe,fJ as we,m2 as Ne,m3 as _e,m4 as ne}from"./ny10lj7zpuz89fvf.js";import{S as Ae}from"./m6ic61btmczsc56b.js";import{P as Le,a as ke}from"./cn9z0lgeg3afumh6.js";function Re(t){"use forget";const e=ee.c(15),a=te(),{preset:o,onSelectPreset:l}=t;let i;e[0]!==l||e[1]!==o?(i=()=>l(o),e[0]=l,e[1]=o,e[2]=i):i=e[2];let u;e[3]!==o.color||e[4]!==o.emoji?(u=s.jsx(Me,{color:o.color,emoji:o.emoji}),e[3]=o.color,e[4]=o.emoji,e[5]=u):u=e[5];let n;e[6]!==a||e[7]!==o.label?(n=a.formatMessage(o.label),e[6]=a,e[7]=o.label,e[8]=n):n=e[8];let d;e[9]!==u||e[10]!==n?(d=s.jsxs("div",{className:"flex gap-1.5",children:[u,n]}),e[9]=u,e[10]=n,e[11]=d):d=e[11];let h;return e[12]!==i||e[13]!==d?(h=s.jsx(fe,{color:"secondary",className:"border-token-border-default hover:bg-token-interactive-bg-secondary-hover active:bg-token-interactive-bg-secondary-press flex items-center justify-center py-2 ps-2.5 pe-3 font-normal select-none",onFocus:Te,onClick:i,type:"button",children:d}),e[12]=i,e[13]=d,e[14]=h):h=e[14],h}function Te(t){t.target.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}function Fe(t){"use forget";const e=ee.c(62),{isNewProject:a,isPending:o,onSubmit:l,submitTitle:i,planType:u}=t,n=te();let d;e[0]!==t.emoji$||e[1]!==t.theme$||e[2]!==t.title$||e[3]!==t.validationErrors$?(d=()=>{var P,F,U,X;return{title$:(P=t.title$)!=null?P:y(""),validationErrors$:(F=t.validationErrors$)!=null?F:y([]),theme$:(U=t.theme$)!=null?U:y(null),emoji$:(X=t.emoji$)!=null?X:y(null),stylePickerOpen$:y(!1),autofilledFromPreset$:y(!1)}},e[0]=t.emoji$,e[1]=t.theme$,e[2]=t.title$,e[3]=t.validationErrors$,e[4]=d):d=e[4];const[h]=S.useState(d),{title$:m,validationErrors$:w,theme$:p,emoji$:f,autofilledFromPreset$:b}=h,j=q(m),M=q(w),v=S.useRef(null),x=q(b);let N;e[5]===Symbol.for("react.memo_cache_sentinel")?(N=[],e[5]=N):N=e[5],S.useEffect(Be,N);let _;e[6]!==b||e[7]!==f||e[8]!==p||e[9]!==m?(_=P=>{const{color:F,emoji:U,title:X}=P;p.set(F),f.set(U),m.set(X),b.set(!0)},e[6]=b,e[7]=f,e[8]=p,e[9]=m,e[10]=_):_=e[10];const $=_;let g;e[11]!==n?(g=n.formatMessage({id:"A4Fd7M",defaultMessage:"Copenhagen Trip"}),e[11]=n,e[12]=g):g=e[12];let r;e[13]!==m?(r=P=>m.set(P.target.value),e[13]=m,e[14]=r):r=e[14];let c;e[15]!==g||e[16]!==r||e[17]!==j?(c=s.jsx("input",{autoFocus:!0,ref:v,className:"border-token-interactive-border-tertiary-default focus:border-token-interactive-border-focus bg-token-bg-primary col-span-full row-1 w-full resize-none overflow-y-auto rounded-lg border px-2 py-2 ps-9 pe-9 text-sm focus:ring-0",type:"text",name:"projectName",autoComplete:"off",placeholder:g,value:j,onChange:r}),e[15]=g,e[16]=r,e[17]=j,e[18]=c):c=e[18];const E=a?"var(--text-tertiary)":void 0;let A;e[19]!==f||e[20]!==E||e[21]!==p?(A=s.jsx(Le,{emoji$:f,theme$:p,defaultColor:E}),e[19]=f,e[20]=E,e[21]=p,e[22]=A):A=e[22];let R;e[23]!==f||e[24]!==A||e[25]!==p?(R=s.jsx(ke,{theme$:p,emoji$:f,children:A}),e[23]=f,e[24]=A,e[25]=p,e[26]=R):R=e[26];let L;e[27]!==x||e[28]!==b||e[29]!==f||e[30]!==n||e[31]!==a||e[32]!==p||e[33]!==j||e[34]!==m?(L=a&&x&&j.trim().length>0&&s.jsx("button",{type:"button","aria-label":n.formatMessage({id:"z/7Lq7",defaultMessage:"Clear project name"}),className:"col-span-full row-1 me-2 self-center justify-self-end rounded-full p-1 hover:opacity-80 focus:outline-hidden",onClick:()=>{var P;m.set(""),f.set(null),p.set(null),b.set(!1),(P=v.current)==null||P.focus()},children:s.jsx(Ae,{className:"icon text-token-text-tertiary"})}),e[27]=x,e[28]=b,e[29]=f,e[30]=n,e[31]=a,e[32]=p,e[33]=j,e[34]=m,e[35]=L):L=e[35];let k;e[36]!==L||e[37]!==c||e[38]!==R?(k=s.jsxs("div",{className:"content-sheet-root:contents mb-2 grid grid-cols-[auto_minmax(0,1fr)]",children:[c,R,L]}),e[36]=L,e[37]=c,e[38]=R,e[39]=k):k=e[39];let B;e[40]!==n||e[41]!==a||e[42]!==$||e[43]!==u?(B=a&&s.jsx("ul",{className:"focus-outline-margin-default -ms-4 flex w-[calc(100%+32px)] gap-2 overflow-x-auto ps-4 pe-4 [scrollbar-width:none]","aria-label":n.formatMessage({id:"mStfWq",defaultMessage:"Project presets"}),children:ve(u).map(P=>s.jsx("li",{children:s.jsx(Re,{preset:P,onSelectPreset:F=>{$(K(T({},F),{title:n.formatMessage(F.label)}))}})},P.emoji))}),e[40]=n,e[41]=a,e[42]=$,e[43]=u,e[44]=B):B=e[44];let I;e[45]!==a?(I=a&&s.jsxs("aside",{className:"bg-token-bg-tertiary mt-4 flex items-center rounded-xl p-3",children:[s.jsx("div",{className:"me-2 h-6 w-6",children:s.jsx("div",{className:"text-token-text-secondary relative flex h-full items-center justify-center",children:s.jsx($e,{className:"icon"})})}),s.jsx("p",{className:"text-token-text-secondary text-xs text-pretty",children:s.jsx(G,T({},Pe.projectHelperBoxDescription))})]}),e[45]=a,e[46]=I):I=e[46];let D;e[47]!==M?(D=M.map(Ge),e[47]=M,e[48]=D):D=e[48];let V;e[49]!==k||e[50]!==B||e[51]!==I||e[52]!==D?(V=s.jsxs("div",{className:"flex-1 px-4 pt-1",children:[k,B,I,D]}),e[49]=k,e[50]=B,e[51]=I,e[52]=D,e[53]=V):V=e[53];const Z=!j.trim()||M.length>0;let W;e[54]!==o||e[55]!==i||e[56]!==Z?(W=s.jsx("div",{className:"flex items-center justify-end px-3 pb-3",children:s.jsx(re.Actions,{primaryButton:s.jsx(re.Button,{title:i,type:"submit",form:"project-modal-form",color:"primary",loading:o,disabled:Z})})}),e[54]=o,e[55]=i,e[56]=Z,e[57]=W):W=e[57];let J;return e[58]!==l||e[59]!==V||e[60]!==W?(J=s.jsxs("form",{id:"project-modal-form",onSubmit:l,children:[V,W]}),e[58]=l,e[59]=V,e[60]=W,e[61]=J):J=e[61],J}function Ge(t,e){return s.jsx("div",{className:"mb-4 text-sm text-red-500",children:t},e)}function Be(){Ce()}function Ie(o){var l=o,{children:t,onCloseAutoFocus:e}=l,a=Y(l,["children","onCloseAutoFocus"]);const i=S.useRef(!1),u=S.useRef(!1),n=S.useRef(!1);return s.jsx(O.Content,K(T({},a),{onCloseAutoFocus:d=>{const h=i.current,m=u.current,w=n.current;if(i.current=!1,u.current=!1,n.current=!1,w)d.preventDefault();else{if(h||m)return;e&&e(d)}},onEscapeKeyDown:()=>{i.current=!0},onPointerDownOutside:()=>{u.current=!0},onFocusOutside:()=>{n.current=!0},children:t}))}const De=he(()=>{const t=y(!1),e=y(!1);return{isSheetVisible$:z(()=>t()||e()),isSheetOpen$:t,keepSheetOpen$:e}}),Ve=t=>{"use forget";const e=ee.c(24),{onCloseAutoFocus:a,children:o,isNewProject:l,mode:i,displayedMemoryScope$:u,memoryScope$:n}=t,d=i===void 0?"dropdown":i;let h;e[0]!==u?(h=u===void 0?y(C.GLOBAL):u,e[0]=u,e[1]=h):h=e[1];const m=h;let w;e[2]!==n?(w=n===void 0?y(C.GLOBAL):n,e[2]=n,e[3]=w):w=e[3];const p=w,f=!pe();let b;e[4]!==m?(b=()=>m(),e[4]=m,e[5]=b):b=e[5];const j=q(b),M=ie();let v;e[6]!==M?(v=De(M),e[6]=M,e[7]=v):v=e[7];const x=v,N=q(x.isSheetOpen$),_=d==="auto"?f?"sheet":"dropdown":d;let $;e[8]!==d||e[9]!==x.isSheetOpen$?($=c=>{x.isSheetOpen$.set(c),c&&ce.logEventWithStatsig("Project Customization: Open","chatgpt_web_project_customization_menu_open",{mode:d})},e[8]=d,e[9]=x.isSheetOpen$,e[10]=$):$=e[10];let g;e[11]!==j||e[12]!==l||e[13]!==p||e[14]!==a?(g=s.jsx(O.Portal,{children:s.jsx(We,{displayedMemoryScope:j,memoryScope$:p,isNewProject:l,onCloseAutoFocus:a})}),e[11]=j,e[12]=l,e[13]=p,e[14]=a,e[15]=g):g=e[15];let r;return e[16]!==o||e[17]!==f||e[18]!==N||e[19]!==x||e[20]!==g||e[21]!==_||e[22]!==$?(r=s.jsxs(O.Root,{mode:_,open:N,store:x,modal:f,onOpenChange:$,children:[o,g]}),e[16]=o,e[17]=f,e[18]=N,e[19]=x,e[20]=g,e[21]=_,e[22]=$,e[23]=r):r=e[23],r},We=l=>{var i=l,{displayedMemoryScope:t=C.GLOBAL,memoryScope$:e=y(C.GLOBAL),isNewProject:a}=i,o=Y(i,["displayedMemoryScope","memoryScope$","isNewProject"]);return s.jsxs(Ie,K(T({size:"auto",align:"end",alignOffset:-7,loop:!0},o),{children:[s.jsxs(O.Group,{children:[s.jsx(O.Label,{children:s.jsx(G,{id:"w7+gZm",defaultMessage:"Memory"})}),s.jsxs(O.RadioGroup,{value:t,className:"flex flex-col",onValueChange:u=>{e.set(u)},children:[s.jsx(le,{value:C.GLOBAL,disabled:!a,label:s.jsx(G,{id:"AA7d3d",defaultMessage:"Default"}),secondary:s.jsx(G,{id:"XHfasG",defaultMessage:"Project can access memories from outside chats, and vice versa."})}),s.jsx(le,{value:C.PROJECT_V2,disabled:!a,label:s.jsx(G,{id:"XToOAe",defaultMessage:"Project-only"}),secondary:s.jsx(G,{id:"W99WlO",defaultMessage:"Project can only access its own memories. Its memories are hidden from outside chats."})})]})]}),s.jsx(O.Group,{children:s.jsx(O.Label,{children:s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("div",{className:"text-token-text-secondary flex items-center text-xs text-pretty",children:s.jsx(G,{id:"FrohSq",defaultMessage:"Note that this setting can't be changed later."})})})})})]}))},Ke=t=>s.jsx(O.BasicTrigger,K(T({className:xe("dropdown-btn"),"data-testid":"composer-plus-btn"},t),{children:s.jsx(je,{className:"icon"})}));function le(t){return s.jsx(O.RadioItem,T({trailing:s.jsx(O.RadioItemCheck,{})},t))}function Ye({submitButtonTitle:t,onClose:e,onSuccess:a,gizmo:o,project:l}){"use forget";const i=te(),u=ge(),n=Ee(),[d,h]=S.useState(()=>n.isPending),m=!o,w=Oe(),p=ie(),f=ye(p),b=f==null?void 0:f.planType;!m&&!l&&(l=we(p)(o.gizmo.id,n));const[j]=S.useState(()=>y(Q(()=>{var r,c;return(c=(r=l==null?void 0:l.emoji$())!=null?r:o==null?void 0:o.gizmo.display.emoji)!=null?c:null}))),[M]=S.useState(()=>y(Q(()=>{var r,c;return(c=(r=l==null?void 0:l.theme$())!=null?r:o==null?void 0:o.gizmo.display.theme)!=null?c:null}))),[v]=S.useState(()=>y(Q(()=>{var r,c;return(c=(r=l==null?void 0:l.title$())!=null?r:o==null?void 0:o.gizmo.display.name)!=null?c:""}))),[x]=S.useState(()=>{const r=o==null?void 0:o.gizmo.memory_scope;let c=r;switch(r){case C.PROJECT_V2:c=C.PROJECT_V2;break;case C.GLOBAL:case C.PROJECT:c=C.GLOBAL;break;default:c=C.UNSET;break}return y(c)}),[N]=S.useState(()=>z(()=>_e(x()))),[_]=S.useState(()=>z(()=>{const r=[];return v().length>ne&&r.push(i.formatMessage({id:"feWA6K",defaultMessage:"Project names cannot be longer than {length} characters."},{length:ne})),r})),$=async()=>{var r;try{h(!0);const c=l?await l.queueUpdate$({emoji:j(),theme:M(),name:v(),opts:{memoryScope:x()}}):await n.mutateAsync({update:R=>{var L,k;return K(T({},R),{emoji:(L=j())!=null?L:void 0,theme:(k=M())!=null?k:void 0,name:v(),memoryScope:x()})},id:(r=o==null?void 0:o.gizmo.id)!=null?r:Ne}),{id:E,resource:A}=c;h(!1),a&&a(E!=null?E:A==null?void 0:A.gizmo.id),e()}catch(c){const E=Se(c);u.warning(E!=null?E:i.formatMessage({id:"project-modal.error.create-or-update",defaultMessage:"Error creating or updating project"}),{duration:5,hasCloseButton:!0}),h(!1)}},g=m?i.formatMessage({id:"PoqmRT",defaultMessage:"Create project"}):i.formatMessage({id:"RT8KNi",defaultMessage:"Save"});return s.jsx(be,{testId:"modal-new-project-enhanced",isOpen:!0,hideSeparator:!0,noPadding:!0,headerAccessory:w&&s.jsx(Ve,{isNewProject:m,displayedMemoryScope$:N,memoryScope$:x,children:s.jsx(Ke,{})}),showCloseButton:!d,type:"success",size:"large",title:m?i.formatMessage({defaultMessage:"Project name",id:"project-modal.title.new-project"}):i.formatMessage({defaultMessage:"Edit project",id:"project-modal.title.edit-project"}),onClose:()=>{d||e()},children:s.jsx(Fe,{emoji$:j,isNewProject:m,isPending:d,onClose:e,onSubmit:r=>{r.preventDefault(),ce.logEventWithStatsig("Projects: Create Submit Enhanced","chatgpt_web_projects_create_submit"),$()},submitTitle:t!=null?t:g,title$:v,theme$:M,validationErrors$:_,planType:b})})}export{Ye as CreateOrEditProjectModal};
//# sourceMappingURL=iahg1x9n4vovse4u.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pczcidkowas9b02w.js","assets/ewse8exzafeu10ji.js","assets/n75kuy1cx6f5mogg.js","assets/root-l2v84m1w.css","assets/iyo1rlkyg0rac5kz.js","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css"])))=>i.map(i=>d[i]);
var Qt=Object.freeze,Zt=Object.defineProperty,Bs=Object.defineProperties;var Ps=Object.getOwnPropertyDescriptors;var Yt=Object.getOwnPropertySymbols;var Ws=Object.prototype.hasOwnProperty,Us=Object.prototype.propertyIsEnumerable;var je=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),zs=s=>{throw TypeError(s)};var Xt=(s,e,n)=>e in s?Zt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,q=(s,e)=>{for(var n in e||(e={}))Ws.call(e,n)&&Xt(s,n,e[n]);if(Yt)for(var n of Yt(e))Us.call(e,n)&&Xt(s,n,e[n]);return s},ue=(s,e)=>Bs(s,Ps(e));var fe=(s,e)=>Qt(Zt(s,"raw",{value:Qt(e||s.slice())}));var Xe=function(s,e){this[0]=s,this[1]=e},ct=(s,e,n)=>{var a=(i,l,d,c)=>{try{var u=n[i](l),h=(l=u.value)instanceof Xe,g=u.done;Promise.resolve(h?l[0]:l).then(x=>h?a(i==="return"?i:"next",l[1]?{done:x.done,value:x.value}:x,d,c):d({value:x,done:g})).catch(x=>a("throw",x,d,c))}catch(x){c(x)}},o=i=>r[i]=l=>new Promise((d,c)=>a(i,l,d,c)),r={};return n=n.apply(s,e),r[je("asyncIterator")]=()=>r,o("next"),o("throw"),o("return"),r},dt=s=>{var e=s[je("asyncIterator")],n=!1,a,o={};return e==null?(e=s[je("iterator")](),a=r=>o[r]=i=>e[r](i)):(e=e.call(s),a=r=>o[r]=i=>{if(n){if(n=!1,r==="throw")throw i;return i}return n=!0,{done:!1,value:new Xe(new Promise(l=>{var d=e[r](i);d instanceof Object||zs("Object expected"),l(d)}),1)}}),o[je("iterator")]=()=>o,a("next"),"throw"in e?a("throw"):o.throw=r=>{throw r},"return"in e&&a("return"),o},es=(s,e,n)=>(e=s[je("asyncIterator")])?e.call(s):(s=s[je("iterator")](),e={},n=(a,o)=>(o=s[a])&&(e[a]=r=>new Promise((i,l,d)=>(r=o.call(s,r),d=r.done,Promise.resolve(r.value).then(c=>i({value:c,done:d}),l)))),n("next"),n("return"),e);import{b as Ce,j as t,d as tt,r as S,c as te,M as I,v as Vs,A as Hs,m as ts,e as Z,i as Ds}from"./n75kuy1cx6f5mogg.js";import{K as Gs,B as ee,F as Me,fI as ys,fS as _s,fR as kt,e as ge,n as qs,fA as bs,aR as gt,aS as ss,at as Js,lf as Ks,sq as Qs,bq as Ys,br as Xs,cj as Zs,mL as en,hC as tn,dG as jt,jU as Nt,tE as sn,tF as nn,aM as ns,ms as an,iQ as on,aN as rn,kz as ln,cq as ht,fq as cn,ek as _e,fB as dn,ex as mt,C as mn,fy as un,i as vs,cm as fn,aP as yt,ce as xn,O as ne,d9 as pn,c0 as gn,tG as hn,mm as yn,cw as as,dD as _n,il as bn,eW as vn,bJ as wn,bL as kn,p2 as os,hE as jn,i6 as Nn,ld as Cn,j as Mn,aT as Sn,bm as En,ed as An,iT as Tn,aV as Ln,s as Rn}from"./ewse8exzafeu10ji.js";import{gh as _t,c8 as st,aT as In,a3 as On,uu as Fn,dD as ut,dH as $n,gN as Bn,mx as ye,lR as Pn,bs as Wn,uv as Un,ig as zn,uw as Vn,ux as Hn,rO as Dn,rQ as Be,rR as Gn,uy as qn,h5 as ws,cE as Jn,ii as Kn,cz as Ne,is as ft,bw as Qn,cy as rs,uz as Yn,js as Xn,i$ as Zn}from"./ny10lj7zpuz89fvf.js";import{S as ea}from"./l1imugsbrc47mdf9.js";import{g as ta}from"./kwx0iuln6nvklwc7.js";import{L as bt}from"./gvudnmdzjyrmv9hw.js";import{p as ks,h as he,g as Ct,a as js,b as Ns,J as y,c as Cs,i as ae,d as sa,e as na,f as aa,j as oa,k as ra,l as ia,m as is}from"./dqiha9wnhddhrhyu.js";import{S as la}from"./eq0refymwif7pcpz.js";import{i as ca,C as ls,a as da}from"./ibchrxf1juu2j0jw.js";import{M as xt,E as ma}from"./ns51nblw8ziscsgd.js";import{A as Ms,C as ua}from"./b1getay2qyb9u6r4.js";import{S as fa}from"./jiz6zc3ys9fjr045.js";var us;const xa=Me.div(us||(us=fe(["h-px bg-token-border-default"])));var fs;const de=Me.div(fs||(fs=fe(["text-sm font-medium py-3 leading-6"])));var xs;const pa=Me.div(xs||(xs=fe(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),pt=":",ga=({to:s,cc:e,bcc:n,subject:a,body:o,onClick:r,isDraft:i=!0,isCanceled:l=!1})=>{const d=Ce(),c=[];return s&&c.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(de,{className:"text-token-text-tertiary me-1",children:[d.formatMessage(xe.draftToFieldLabel),pt]}),t.jsx(de,{children:s})]})},"to")),e&&c.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(de,{className:"text-token-text-tertiary me-1",children:[d.formatMessage(xe.draftCcFieldLabel),pt]}),t.jsx(de,{children:e})]})},"cc")),n&&c.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(de,{className:"text-token-text-tertiary me-1",children:[d.formatMessage(xe.draftBccFieldLabel),pt]}),t.jsx(de,{children:n})]})},"bcc")),a&&c.push(t.jsx(de,{children:a},"subject")),o&&c.push(t.jsx(de,{className:"whitespace-pre-line",children:o},"body")),t.jsxs(pa,{children:[t.jsxs("div",{className:"mb-4 flex items-center",children:[t.jsx(Gs,{className:"icon-sm me-4"}),t.jsx("div",{className:"font-semibold",children:i?d.formatMessage(xe.draftMessageLabel):d.formatMessage(xe.sentMessageLabel)})]}),c.map((u,h)=>t.jsxs(S.Fragment,{children:[t.jsx(xa,{}),u]},h)),i&&!l&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(ee,{color:"primary",className:"py-2",onClick:r,children:d.formatMessage(xe.sendButton)})}),l&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(ee,{color:"primary",className:"py-2",disabled:!0,children:d.formatMessage(xe.canceledButton)})})]})},xe=tt({draftMessageLabel:{id:"emailView.draftMessageLabel",defaultMessage:"Draft Message"},sentMessageLabel:{id:"emailView.sentMessageLabel",defaultMessage:"Sent Message"},sendButton:{id:"emailView.sendButton",defaultMessage:"Send"},draftToFieldLabel:{id:"emailView.draftToLabel",defaultMessage:"To"},draftCcFieldLabel:{id:"emailView.draftCcLabel",defaultMessage:"Cc"},draftBccFieldLabel:{id:"emailView.draftBccLabel",defaultMessage:"Bcc"},canceledButton:{id:"emailView.canceledButton",defaultMessage:"Canceled"}}),ha=s=>{"use forget";const e=te.c(16),{clientThreadId:n,action:a,messages:o,onRequestCompletion:r,handleUserAction:i,rememberAnswer:l,toolCallSafetySummary:d}=s;let c;e[0]!==o?(c=ks(o),e[0]=o,e[1]=c):c=e[1];const{assistantMessage:u}=c,h=ys();let g;return e[2]!==a.allow||e[3]!==a.always_allow||e[4]!==a.deny||e[5]!==a.name||e[6]!==a.type||e[7]!==h||e[8]!==u||e[9]!==n||e[10]!==i||e[11]!==o||e[12]!==r||e[13]!==l||e[14]!==d?(g=a.type==="deny"?t.jsx(ee,{className:"flex-1",color:"secondary",size:"medium",onClick:x=>{i({clientThreadId:n,sourceEvent:x,onRequestCompletion:r,assistantMessage:u,allMessages:o,actionData:ue(q({type:"deny"},a.deny),{remember_answer:l}),activeSystemHint:h})},children:t.jsx(I,q({},a.name==="decline"?Pe.decline:Pe.deny))}):a.type==="allow"?t.jsx(ee,{className:"flex-1",color:(d==null?void 0:d.danger_level)=="HIGH"?"danger":"primary",size:"medium",onClick:x=>{i({clientThreadId:n,sourceEvent:x,onRequestCompletion:r,assistantMessage:u,allMessages:o,actionData:ue(q({type:"allow"},a.allow),{remember_answer:l}),activeSystemHint:h})},children:d!=null&&d.action_name?d.action_name:t.jsx(I,q({},a.name==="allow"?Pe.allow:Pe.confirm))}):a.type==="always_allow"?t.jsx(ee,{className:"flex-1",color:"secondary",size:"medium",onClick:x=>{i({clientThreadId:n,sourceEvent:x,onRequestCompletion:r,assistantMessage:u,allMessages:o,actionData:q({type:"always_allow"},a.always_allow),activeSystemHint:h})},children:t.jsx(I,q({},Pe.alwaysAllow))}):null,e[2]=a.allow,e[3]=a.always_allow,e[4]=a.deny,e[5]=a.name,e[6]=a.type,e[7]=h,e[8]=u,e[9]=n,e[10]=i,e[11]=o,e[12]=r,e[13]=l,e[14]=d,e[15]=g):g=e[15],g},Pe=tt({alwaysAllow:{id:"jitPluginMessage.alwaysAllow",defaultMessage:"Always Allow"},allow:{id:"jitPluginMessage.allow",defaultMessage:"Allow"},decline:{id:"jitPluginMessage.decline",defaultMessage:"Decline"},confirm:{id:"jitPluginMessage.confirm",defaultMessage:"Confirm"},deny:{id:"jitPluginMessage.deny",defaultMessage:"Deny"}});function ya({functionName:s,params:e,toolCallSafetySummary:n,result:a,isWrite:o,messages:r,clientThreadId:i,jitPluginData:l,onRequestCompletion:d,rememberForThisConversation:c,onRememberForThisConversationChange:u}){var m,v,w,$;const h=_s(),g=kt(),{namespace:x,actionName:f}=_a(s),p=((m=l==null?void 0:l.from_server)==null?void 0:m.type)!=="denied_by_user"?(v=l==null?void 0:l.from_server)==null?void 0:v.body.actions.map((k,A)=>t.jsx(ha,{clientThreadId:i,messages:r,onRequestCompletion:d,action:k,handleUserAction:he,rememberAnswer:c,toolCallSafetySummary:n},A)):null;if(x==="api_tool"&&f==="call_tool"&&e&&"path"in e&&"args"in e&&typeof e.path=="string"&&(typeof e.args=="object"||typeof e.args=="string")&&e.args!=null){const[k,A,T]=e.path.split("/").filter(Boolean);if(k&&A&&T){const O=[...h.connectorLinks.values()].flat().find(C=>C.id===A),B=O&&g.platformConnectors.get(O.connector_id);return t.jsx(cs,{connector:{name:(w=B==null?void 0:B.name)!=null?w:k,logo_url:($=B==null?void 0:B.logo_url)!=null?$:null},actionName:T,isWrite:o,params:typeof e.args=="object"?e.args:JSON.parse(e.args),toolCallSafetySummary:n,result:a,actionButtons:p,rememberForThisConversation:c,onRememberForThisConversationChange:u})}}return t.jsx(cs,{connector:{name:x,logo_url:null},actionName:f,isWrite:o,params:e,result:a,actionButtons:p,rememberForThisConversation:c,onRememberForThisConversationChange:u})}function _a(s){const e=s.indexOf("."),n=e===-1?s:s.slice(0,e),a=e===-1?"":s.slice(e+1);return{namespace:n,actionName:a}}function cs({connector:s,actionName:e,params:n,result:a,isWrite:o,toolCallSafetySummary:r,actionButtons:i,rememberForThisConversation:l,onRememberForThisConversationChange:d}){var v,w,$;const c=Ce(),[u,h]=S.useState(!1),g=S.useId(),x=(v=r==null?void 0:r.title)!=null?v:"",f=(w=r==null?void 0:r.description)!=null?w:"",p=e,m=(($=r==null?void 0:r.data_shared.length)!=null?$:0)>0;return r?t.jsxs("div",{className:"mt-1 mb-4 w-full max-w-sm",children:[t.jsxs("div",{className:"border-token-border-medium bg-token-bg-tertiary/20 my-2 flex w-full max-w-xl flex-col rounded-3xl border px-2 py-6 text-start",children:[t.jsxs("div",{className:"mt-2 mb-5 flex flex-col items-center text-center",children:[t.jsx(_t,{connector:{name:s.name,logo_url:s.logo_url,logo_url_dark:void 0},size:"large"}),t.jsx("h2",{className:"text-token-text-primary mt-4 text-base font-semibold",children:x}),f&&t.jsx("p",{className:"text-token-text-tertiary mt-2 max-w-md px-3 text-sm",children:f})]}),t.jsxs("div",{className:"mt-1 flex flex-1 flex-col",children:[m&&t.jsxs("div",{className:"mx-4",children:[t.jsx("div",{className:"text-token-text-tertiary px-2 text-xs tracking-wide",children:c.formatMessage(pe.dataShared)}),t.jsx("p",{className:"text-token-text-primary mt-1 px-2 text-sm font-normal",children:r.data_shared.join(", ")}),t.jsx("div",{className:"token-border-subtle mx-2 mt-3 h-0 border-t"})]}),n!=null&&t.jsxs("div",{className:"mx-3 mt-1 pt-1",children:[t.jsxs("button",{type:"button",onClick:()=>h(k=>!k),"aria-expanded":u,"aria-controls":g,className:"text-token-text-primary hover:bg-token-bg-tertiary/80 flex w-full items-end justify-between rounded-xl px-3 py-2 text-start font-normal transition focus-visible:ring-2 focus-visible:outline-none",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-normal tracking-wide",children:t.jsx(I,q({},pe.functionLabel))}),t.jsx("span",{className:"text-token-text-primary mt-1 text-sm font-normal",children:p})]}),t.jsx("div",{className:"mb-0.5 flex h-full flex-col items-center justify-end",children:t.jsxs("span",{className:"flex items-center justify-end gap-2",children:[o&&t.jsx("span",{className:"bg-token-bg-status-error text-token-text-error inline-flex items-center rounded-full px-2 py-0.5 text-[9px] font-semibold tracking-wide uppercase",children:t.jsx(I,{id:"APIToolCallCard.write",defaultMessage:"Write"})}),t.jsx(st,{className:ge("icon-sm transition-transform",u&&"rotate-180")})]})})]}),u&&t.jsx("div",{className:"mt-2",id:g,children:t.jsx(We,{isInitialLevelExpanded:o,name:pe.request,params:n})}),u&&a!=null&&t.jsx("div",{className:"mt-2",children:t.jsx(We,{name:pe.response,params:a})}),a==null&&t.jsx("div",{className:"token-border-subtle mx-2 mt-2 h-0 border-t"})]}),(r==null?void 0:r.danger_level)!=="HIGH"&&a==null&&t.jsxs("div",{className:"mx-4 mt-3 mb-3 flex items-center justify-between",children:[t.jsx("div",{className:"ps-2 text-sm font-normal",children:c.formatMessage(pe.allowForConversation)}),t.jsx("div",{className:"pt-1",children:t.jsx(qs,{id:"api-tool-write-action-remember",checked:l,"aria-hidden":!0,size:"normal",onCheckedChange:d})})]}),i&&Array.isArray(i)&&i.length>0?t.jsx("div",{className:"mx-4 mt-5 flex flex-wrap items-center justify-between gap-2",children:i}):t.jsx("div",{})]})]}),o&&t.jsx("div",{className:"text-token-text-tertiary flex items-center justify-center rounded-lg p-1 text-center text-sm",children:t.jsx(I,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:k=>t.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:k},"link")}})})]}):t.jsxs("div",{className:"bg-token-bg-default mt-1 mb-4 grid max-w-xl gap-4 rounded-xl p-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(_t,{connector:{name:s.name,logo_url:s.logo_url,logo_url_dark:void 0},size:"large"}),t.jsxs("div",{className:"flex flex-1 flex-col",children:[t.jsx("div",{className:"text-token-text-secondary text-xs",children:s.name}),t.jsx("div",{className:"text-token-text-primary text-sm",children:e})]}),o&&t.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:t.jsx(I,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),n!=null&&t.jsx(We,{isInitialLevelExpanded:o,name:pe.request,params:n}),a!=null&&t.jsx(We,{name:pe.response,params:a}),o&&t.jsxs("div",{className:"text-token-text-secondary text-sm",children:[t.jsx(bs,{className:"icon-sm me-1 mb-0.5 inline-block"}),t.jsx(I,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:k=>t.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:k},"link")}})]})]})}function We({name:s,afterName:e,params:n,isInitialLevelExpanded:a=!1}){const o=Ce();return t.jsxs("div",{className:"bg-token-bg-secondary/30 max-w-full min-w-0 space-y-3 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-token-text-secondary text-xs",children:typeof s=="string"?s:o.formatMessage(s)}),e]}),t.jsx(In,{buttonText:!0,className:"text-token-text-secondary text-xs",onCopy:()=>On(typeof n=="string"?n:JSON.stringify(n))})]}),typeof n=="string"?t.jsx("div",{className:"text-token-text-primary line-clamp-3 font-mono text-sm",children:n}):t.jsx(bt,{isInitialLevelExpanded:a,value:n})]})}const pe=tt({request:{id:"APIToolCallCard.request",defaultMessage:"Request"},response:{id:"APIToolCallCard.response",defaultMessage:"Response"},dataShared:{id:"APIToolCallCard.dataShared",defaultMessage:"Data Shared"},functionLabel:{id:"APIToolCallCard.function",defaultMessage:"Function"},allowForConversation:{id:"APIToolCallCard.allowForConversation",defaultMessage:"Allow for conversation"}}),ba=(s,{csp:e,domain:n,subdomain:a})=>"".concat(s.metadata.html_asset_pointer,"-").concat(JSON.stringify(e),"-").concat(n,"-").concat(a),va=({chatSDK:s,prompt:e,persistedSystemHintsStore:n,clientThreadId:a})=>{var i;const o=gt.getRequestId(ss(a));if(Fn(o))return null;if(!e)return Js.addError("No prompt provided to sendFollowUpMessage"),null;const r=gt.getBranch(ss(a)).findLast(({message:l})=>Ks(l));return{completionType:Zs.Next,promptMessage:{id:Vs(),author:{role:Xs.User,name:"user"},content:{content_type:Ys.Text,parts:[e]},recipient:"all",metadata:{system_hints:Qs(n),developer_mode_connector_ids:(i=r==null?void 0:r.message.metadata)==null?void 0:i.developer_mode_connector_ids,chatgpt_sdk_attribution:s.metadata.attribution_id,is_visually_hidden_from_conversation:!0}},eventSource:"mouse"}},Ss=new Set(["http:","https:"]),ds={"http:":80,"https:":443,"ws:":80,"wss:":443};function Es(s){if(!s)return null;const e=s.trim();if(!e||e.includes("\\"))return null;try{return{url:new URL(e)}}catch(n){if(!/^[a-z][a-z0-9+.-]*:/.test(e))try{const a=e.startsWith("//")?"https:".concat(e):"https://".concat(e);return{url:new URL(a)}}catch(a){return null}return null}}function As(s){var g,x;const e=s.trim();if(!e)return null;const n=/^([a-z][a-z0-9+.-]*):$/i.exec(e);if(n)return{kind:"scheme",scheme:"".concat(n[1].toLowerCase(),":")};const a=/^(?:([a-z][a-z0-9+.+-]*):\/\/)?(\*|\*\.[^/:]+|[^/:]+)(?::(\*|\d+))?(\/.*)?$/i.exec(e);if(!a)return null;const o=a[1]?"".concat(a[1].toLowerCase(),":"):void 0,r=a[2],i=(g=a[3])!=null?g:null,l=(x=a[4])!=null?x:null,d=r.startsWith("*."),c=(d?r.slice(2):r).toLowerCase().replace(/\.$/,"");let u=null,h=!1;return i!==null&&(h=!0,u=i==="*"?"*":Number(i),u!=="*"&&(!Number.isFinite(u)||u<0))?null:{kind:"host",scheme:o,host:c,wildcard:d,portExplicit:h,port:u,path:l}}function Ze(s){return s.toLowerCase().replace(/\.$/,"")}function Ts(s,e){const n=Ze(s),a=Ze(e);return n===a||n.endsWith("."+a)}function wa(s,e,n){return n?Ts(s,e):Ze(s)===Ze(e)}function ka(s,e){var a,o;if(e.port==="*")return!0;const n=s.port?Number(s.port):(a=ds[s.protocol])!=null?a:null;if(!e.portExplicit){const r=(o=ds[s.protocol])!=null?o:null;return n===r}return typeof e.port=="number"&&n===e.port}function ja(s){var o,r;const e=(o=s.scheme)!=null?o:"https:";if(!Ss.has(e)||!s.host)return null;const n=typeof s.port=="number"?":".concat(s.port):"",a=(r=s.path)!=null?r:"";try{return new URL("".concat(e,"//").concat(s.host).concat(n).concat(a))}catch(i){return null}}function Na(s){var a,o;const e=Es(s!=null?s:void 0);if(e&&Ss.has(e.url.protocol)&&!e.url.hostname.includes("*"))return e.url.toString();if(!s)return null;const n=As(s);return!n||n.kind==="scheme"?null:(o=(a=ja(n))==null?void 0:a.toString())!=null?o:null}function Ca(s,e,n){var l;if(!s)return!1;const a=Es(s);if(!a)return!1;const o=a.url;if(o.username||o.password)return!1;const r=[];(l=e==null?void 0:e.connectDomains)!=null&&l.length&&r.push(...e.connectDomains);const i=n==null?void 0:n.trim();return i&&r.push(i),r.length?r.some(d=>{const c=As(d);if(!c)return!1;if(c.kind==="scheme")return o.protocol===c.scheme;if(c.scheme)return!(o.protocol!==c.scheme||!wa(o.hostname,c.host,c.wildcard)||!ka(o,c));{const u=c.host;return!!Ts(o.hostname,u)}}):!1}const Ma=s=>{"use forget";const e=te.c(18),{logoUrl:n,name:a,isLoading:o,addGutter:r,after:i,onClick:l}=s,c=(r===void 0?!1:r)&&"px-4";let u;e[0]!==c?(u=ge("text-token-text-secondary dark:text-token-text-tertiary flex w-full items-center gap-2 pb-4 max-sm:mt-1",c),e[0]=c,e[1]=u):u=e[1];let h;e[2]!==o||e[3]!==n||e[4]!==a?(h=!n||o?t.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-lg"}):n&&a&&t.jsx("img",{className:"h-5 w-5 rounded-lg",src:n,alt:a}),e[2]=o,e[3]=n,e[4]=a,e[5]=h):h=e[5];let g;e[6]!==a?(g=a?t.jsx("button",{className:"hover:text-token-text-primary group-hover:text-token-text-primary",children:a}):t.jsx("div",{className:"loading-results-shimmer h-5 w-16 rounded-md"}),e[6]=a,e[7]=g):g=e[7];let x;e[8]!==l||e[9]!==h||e[10]!==g?(x=t.jsxs("span",{className:"group inline-flex items-center gap-2",onClick:l,role:"button",children:[h,g]}),e[8]=l,e[9]=h,e[10]=g,e[11]=x):x=e[11];let f;e[12]!==i?(f=i&&t.jsx("div",{className:"ms-auto",onClick:Sa,children:i}),e[12]=i,e[13]=f):f=e[13];let p;return e[14]!==u||e[15]!==x||e[16]!==f?(p=t.jsxs("div",{className:u,children:[x,f]}),e[14]=u,e[15]=x,e[16]=f,e[17]=p):p=e[17],p};function Sa(s){return s.stopPropagation()}const Ea=({title:s,logoUrl:e})=>t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light my-2 flex w-fit items-center gap-2 rounded-xl px-4 py-2 pe-6",children:[e?t.jsx("img",{className:"h-5 w-5 rounded-md",src:e,alt:s!=null?s:""}):t.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-md"}),t.jsx("div",{className:"text-token-text-primary text-base font-medium",children:s})]}),Aa=s=>{"use forget";const e=te.c(5),{onClickRetry:n}=s;let a,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(en,{className:"icon"}),o=t.jsx(I,{id:"DTbTrQ",defaultMessage:"Error loading app"}),e[0]=a,e[1]=o):(a=e[0],o=e[1]);let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(I,{id:"thEh3U",defaultMessage:"Retry"}),e[2]=r):r=e[2];let i;return e[3]!==n?(i=t.jsx(tn,{type:"error",icon:a,title:o,content:null,primaryCtaText:r,primaryCtaColor:"secondary",onPrimaryCtaClick:n}),e[3]=n,e[4]=i):i=e[4],i},vt=44,Ta=s=>{"use forget";const e=te.c(6),{safeAreaInsetTop:n,onClick:a}=s;let o;e[0]!==n?(o={height:vt,width:vt,marginTop:n},e[0]=n,e[1]=o):o=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(jt,{}),e[2]=r):r=e[2];let i;return e[3]!==a||e[4]!==o?(i=t.jsx("button",{className:"bg-token-bg-primary text-token-text-primary shadow-short dark:shadow-long fixed start-4 top-0 z-10 aspect-square rounded-full p-3 transition-transform active:scale-115 active:opacity-75",onClick:a,style:o,children:r}),e[3]=a,e[4]=o,e[5]=i):i=e[5],i},Ls=8,La=s=>{"use forget";const e=te.c(34),{title:n,widgetDisplayName:a,widgetDomain:o,onClickBack:r,onClickClose:i,onClickForward:l,onClickOpenInApp:d,canGoBack:c,canGoForward:u,logo:h}=s,g=Ce();if(Nt()){let C;return e[0]!==i?(C=t.jsx(Ta,{safeAreaInsetTop:Ls,onClick:i}),e[0]=i,e[1]=C):C=e[1],C}let x;e[2]!==g?(x=g.formatMessage({id:"H0F9KU",defaultMessage:"Close"}),e[2]=g,e[3]=x):x=e[3];let f;e[4]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx(jt,{className:"icon"}),e[4]=f):f=e[4];let p;e[5]!==i||e[6]!==x?(p=t.jsx(ut,{label:x,className:"h-7! w-7!",onClick:i,icon:f}),e[5]=i,e[6]=x,e[7]=p):p=e[7];let m;e[8]!==c||e[9]!==u||e[10]!==g||e[11]!==r||e[12]!==l?(m=(c||u)&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ut,{label:g.formatMessage({id:"y0H9Ps",defaultMessage:"Back"}),className:"h-7! w-7!",onClick:r,disabled:!c,icon:t.jsx($n,{className:"icon"})}),t.jsx(ut,{label:g.formatMessage({id:"4zGgS+",defaultMessage:"Forward"}),className:"h-7! w-7!",onClick:l,disabled:!u,icon:t.jsx(la,{className:"icon"})})]}),e[8]=c,e[9]=u,e[10]=g,e[11]=r,e[12]=l,e[13]=m):m=e[13];let v;e[14]!==p||e[15]!==m?(v=t.jsxs("div",{className:"flex items-center justify-start gap-3",children:[p,m]}),e[14]=p,e[15]=m,e[16]=v):v=e[16];let w;e[17]!==n?(w=t.jsx("div",{className:"text-token-text-secondary flex items-center justify-center text-base",children:n}),e[17]=n,e[18]=w):w=e[18];const $=h?void 0:Bn,k=!o;let A;e[19]!==h||e[20]!==a?(A=h&&t.jsx("img",{src:h,alt:a,className:"me-2 h-4 w-4"}),e[19]=h,e[20]=a,e[21]=A):A=e[21];let T;e[22]!==a?(T=t.jsx(I,{id:"JvQEOX",defaultMessage:"Open in {app}",values:{app:a}}),e[22]=a,e[23]=T):T=e[23];let O;e[24]!==d||e[25]!==T||e[26]!==$||e[27]!==k||e[28]!==A?(O=t.jsx("div",{className:"flex items-center justify-end",children:t.jsxs(ee,{icon:$,disabled:k,onClick:d,color:"secondary",children:[A,T]})}),e[24]=d,e[25]=T,e[26]=$,e[27]=k,e[28]=A,e[29]=O):O=e[29];let B;return e[30]!==O||e[31]!==v||e[32]!==w?(B=t.jsxs("div",{className:"border-token-border-secondary bg-token-bg-primary sm:bg-token-bg-primary z-10 grid h-(--header-height) grid-cols-[1fr_auto_1fr] border-b px-2",children:[v,w,O]}),e[30]=O,e[31]=v,e[32]=w,e[33]=B):B=e[33],B},Ra=()=>{let s="unknown";return Nt()?s="mobile":sn()?s="tablet":nn()&&(s="desktop"),{device:{type:s},capabilities:{hover:ns(on),touch:ns(an)}}},Ia=(s,e)=>"?"+["","app=".concat(s),"locale=".concat(e)].filter(Boolean).join("&"),Oa=s=>{if(s){const e=new URL(ls);return e.hostname="".concat(s,".").concat(e.hostname),e.protocol=da,e.origin}return ls},Fa=({host:s="chatgpt",isInert:e=!1,title:n,ref:a,subdomain:o,iframeRef:r,api:i,locale:l})=>{"use forget";const[d]=S.useState(()=>rn(null)),c=ye(async(x,...f)=>{var m;return await ln(()=>!!d()),ht((m=d())==null?void 0:m[x],"Method ".concat(String(x)," not found"))(...f)});S.useImperativeHandle(a,()=>new Proxy({},{get:(x,f)=>(...p)=>c(f,...p)}),[c]);const u=ye((x,...f)=>{const p=i[x];if(!p){console.warn("HostAPI method not found",x);return}return p(...f)}),h=ye(x=>x?(ca(x,{drawBoundingBoxes:(...f)=>u("drawBoundingBoxes",...f),notifyBackgroundColor:(...f)=>u("notifyBackgroundColor",...f),notifyIntrinsicHeight:(...f)=>u("notifyIntrinsicHeight",...f),sendInstrument:(...f)=>u("sendInstrument",...f),getDownloadURL:(...f)=>u("getDownloadURL",...f),callTool:(...f)=>u("callTool",...f),streamCompletion:function(...p){return ct(this,null,function*(){yield*dt(u("streamCompletion",...p))})},callCompletion:(...f)=>u("callCompletion",...f),notifySecurityPolicyViolation:(...f)=>u("notifySecurityPolicyViolation",...f),notifyEnvironmentError:(...f)=>u("notifyEnvironmentError",...f),updateWidgetState:(...f)=>u("updateWidgetState",...f),sendFollowUpMessage:(...f)=>u("sendFollowUpMessage",...f),requestDisplayMode:(...f)=>u("requestDisplayMode",...f),notifyNavigation:(...f)=>u("notifyNavigation",...f),notifyEscapeKey:(...f)=>u("notifyEscapeKey",...f),openExternal:(...f)=>u("openExternal",...f)},["runUserCode","runWidgetCode"]).then(f=>{d.set(f)}),()=>{d.set(null)}):d.set(null)),g=Oa(o);return t.jsx(cn,{children:t.jsx("iframe",{title:n,inert:e,src:"".concat(g,"/index.html").concat(Ia(s,l)),ref:Pn(h,r),sandbox:"allow-scripts allow-same-origin allow-forms",className:"h-full w-full max-w-full"},"sandbox-".concat(g))})},$a=async(s,e)=>{const{trackFatalWidgetError:n}=await _e(async()=>{const{trackFatalWidgetError:a}=await import("./pczcidkowas9b02w.js");return{trackFatalWidgetError:a}},__vite__mapDeps([0,1,2,3]));n(s,e)},Ba=async(s,e)=>{const{trackWidgetError:n}=await _e(async()=>{const{trackWidgetError:a}=await import("./pczcidkowas9b02w.js");return{trackWidgetError:a}},__vite__mapDeps([0,1,2,3]));n(s,e)},Pa=async s=>{const{trackWidgetLinkOut:e}=await _e(async()=>{const{trackWidgetLinkOut:n}=await import("./pczcidkowas9b02w.js");return{trackWidgetLinkOut:n}},__vite__mapDeps([0,1,2,3]));e(s)},Wa=async(s,e)=>{const{trackSandboxInstrument:n}=await _e(async()=>{const{trackSandboxInstrument:a}=await import("./pczcidkowas9b02w.js");return{trackSandboxInstrument:a}},__vite__mapDeps([0,1,2,3]));n(s,e)},Ua=async s=>{const{trackSecurityPolicyViolation:e}=await _e(async()=>{const{trackSecurityPolicyViolation:n}=await import("./pczcidkowas9b02w.js");return{trackSecurityPolicyViolation:n}},__vite__mapDeps([0,1,2,3]));e(s)},za={insets:{top:0,bottom:0,left:0,right:0}},Va=({host:s,ref:e,iframeRef:n,html:a,accessToken:o,safeArea:r=za,attributionId:i,clientThreadId:l,widgetId:d,widgetParent:c,widgetType:u,csp:h,subdomain:g,widgetState:x=null,toolInput:f=null,toolOutput:p=null,toolResponseMetadata:m=null,maxHeight:v,theme:w,title:$,api:k,locale:A,displayMode:T="inline",onReady:O,onError:B})=>{"use forget";var G;const C=S.useRef(null),V=S.useRef(null),H=ye(()=>{B==null||B()}),R=ye(()=>{O==null||O()}),D=ye(async _=>{var P;const E=(P=C.current)==null?void 0:P.runWidgetCode({html:_,widgetId:d,widgetState:x,toolInput:f,toolOutput:p,toolResponseMetadata:m,maxHeight:v,theme:w,displayMode:T,safeArea:r,userAgent:Ra(),csp:h});if(E)try{for(var W=es(await E),K,z,Y;K=!(z=await W.next()).done;K=!1){const M=z.value;M.type===xt.ENVIRONMENT_STATUS&&M.status===ma.RUNNING_CODE?R():M.type===xt.ERROR?(Ba(J,M.error),V.current=M.error):M.type===xt.RUN_COMPLETE&&M.wasFatalError&&($a(J,V.current),H())}}catch(z){Y=[z]}finally{try{K&&(z=W.return)&&await z.call(W)}finally{if(Y)throw Y[0]}}});S.useEffect(()=>{a&&D(a)},[a,D]),S.useEffect(()=>{var _;(_=C.current)==null||_.setWidgetProps({widgetId:d,widgetState:x,toolInput:f,toolOutput:p,toolResponseMetadata:m})},[d,x,f,p,m]),S.useEffect(()=>{var _;(_=C.current)==null||_.setAdditionalGlobals({additionalGlobals:{maxHeight:v}})},[v]),S.useEffect(()=>{var _;(_=C.current)==null||_.setAdditionalGlobals({additionalGlobals:{displayMode:T}})},[T]),S.useEffect(()=>{var _;(_=C.current)==null||_.setTheme({theme:w})},[w]),S.useEffect(()=>{var _;(_=C.current)==null||_.setSafeArea({safeArea:r})},[r]);const J={attribution_id:(G=i!=null?i:c)!=null?G:"",name:u,conversation_id:l!=null?l:null,message_id:d||null};return t.jsx(Fa,{title:$,host:s,subdomain:g,api:ue(q({},k),{openExternal:_=>{var E;Pa(J),(E=k.openExternal)==null||E.call(k,_)},sendInstrument:_=>{Wa(_,J)},notifySecurityPolicyViolation:_=>{var E;Ua({attribution_id:(E=i!=null?i:c)!=null?E:"",name:u,conversation_id:l!=null?l:null,message_id:d||null,violation:_})},streamCompletion:function(_){return ct(this,null,function*(){const{completionStream:E}=yield new Xe(_e(async()=>{const{completionStream:P}=await import("./iyo1rlkyg0rac5kz.js");return{completionStream:P}},__vite__mapDeps([4,1,2,3,5,6])));yield*dt(E(_,ht(c),o))})},callCompletion:async function(_){const{callCompletion:E}=await _e(async()=>{const{callCompletion:P}=await import("./iyo1rlkyg0rac5kz.js");return{callCompletion:P}},__vite__mapDeps([4,1,2,3,5,6]));return await E(_,ht(c),o)}}),iframeRef:n,ref:Wn(C,e),locale:A})},Ha=s=>{"use forget";var c;const e=te.c(7),{clientThreadId:n,messages:a,isLastMessageInTurn:o,rememberForThisConversation:r,onRequestCompletion:i}=s;let l,d;if(e[0]!==n||e[1]!==o||e[2]!==a||e[3]!==i||e[4]!==r){d=Symbol.for("react.early_return_sentinel");e:{const{jitPluginData:u}=Ct(a,o);if(!(u!=null&&u.from_server)||((c=u.from_server)==null?void 0:c.type)==="denied_by_user"){d=null;break e}const{from_server:h}=u,{body:g}=h,{domain:x,actions:f}=g;l=f.map((p,m)=>t.jsx(Ms,{clientThreadId:n,messages:a,onRequestCompletion:i,action:p,domain:x,handleUserAction:he,rememberAnswer:r},m))}e[0]=n,e[1]=o,e[2]=a,e[3]=i,e[4]=r,e[5]=l,e[6]=d}else l=e[5],d=e[6];return d!==Symbol.for("react.early_return_sentinel")?d:l};function Da(s){"use forget";var B,C;const e=te.c(55),{messages:n,isLastMessageInTurn:a,clientThreadId:o,onRequestCompletion:r}=s,[i,l]=S.useState(!1);let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx(I,{id:"WidgetOverlay.alwaysAsk",defaultMessage:"Always ask"}),e[0]=d):d=e[0];const c=d;let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(I,{id:"WidgetOverlay.allowThisConversation",defaultMessage:"Allow for this conversation"}),e[1]=u):u=e[1];const h=u,g=_s(),x=kt();let f;e[2]!==a||e[3]!==n?(f=Ct(n,a),e[2]=a,e[3]=n,e[4]=f):f=e[4];const{uiState:p}=f;let m;e[5]!==a||e[6]!==n?(m=js(n,a),e[5]=a,e[6]=n,e[7]=m):m=e[7];const v=m;let w,$,k,A;if(e[8]!==o||e[9]!==x||e[10]!==a||e[11]!==g.connectorLinks||e[12]!==n||e[13]!==v||e[14]!==r||e[15]!==i||e[16]!==p){const V=Ns(n,a),[H,R,D]=(B=V==null?void 0:V.path.split("/").filter(Boolean))!=null?B:[];let J;if(e[21]!==x||e[22]!==R||e[23]!==g.connectorLinks){let Y;e[25]!==R?(Y=be=>be.id===R,e[25]=R,e[26]=Y):Y=e[26];const M=[...g.connectorLinks.values()].flat().find(Y);J=M&&x.platformConnectors.get(M.connector_id),e[21]=x,e[22]=R,e[23]=g.connectorLinks,e[24]=J}else J=e[24];const G=J;w=p===y.UserConfirmation,$="bg-token-bg-primary text-token-text-primary shadow-long pointer-events-auto grid w-[min(90%,40rem)] max-w-[min(100%,600px)] gap-4 rounded-2xl p-4 sm:rounded-3xl";const _=(C=G==null?void 0:G.logo_url)!=null?C:null;let E;e[27]!==H||e[28]!==_?(E=t.jsx(_t,{connector:{name:H,logo_url:_},size:"medium",className:"bg-primary shadow-xxs max-h-fit rounded-2xl border bg-clip-padding p-2"}),e[27]=H,e[28]=_,e[29]=E):E=e[29];let P;e[30]!==H?(P=t.jsx("div",{className:"text-token-text-primary ms-3 font-medium",children:t.jsx(I,{id:"VHhzt6",defaultMessage:"{connectorName} wants to perform an action",values:{connectorName:H}})}),e[30]=H,e[31]=P):P=e[31];let W;e[32]!==v||e[33]!==i?(W=v?t.jsx("div",{className:"-mt-0.5 flex justify-start text-sm",children:t.jsx(dn,{size:"small",triggerButton:t.jsxs("button",{className:"bg-token-bg-primary hover:bg-token-bg-tertiary text-token-text-primary inline-flex items-center gap-1 rounded-lg px-2 py-1 ps-3 transition-colors",children:[i?h:c,t.jsx(st,{strokeWidth:1,className:"icon-sm opacity-30","aria-hidden":!0})]}),children:t.jsxs(mt.RadioGroup,{value:i?"allow":"ask",onValueChange:Y=>l(Y==="allow"),children:[t.jsx(mt.RadioItem,{value:"ask",children:c}),t.jsx(mt.RadioItem,{value:"allow",children:h})]})})}):null,e[32]=v,e[33]=i,e[34]=W):W=e[34];let K;e[35]!==P||e[36]!==W?(K=t.jsxs("div",{className:"flex flex-1 flex-col",children:[P,W]}),e[35]=P,e[36]=W,e[37]=K):K=e[37];let z;e[38]!==o||e[39]!==a||e[40]!==n||e[41]!==r||e[42]!==i?(z=t.jsx("div",{className:"flex items-center justify-center gap-2",children:t.jsx(Ha,{clientThreadId:o,messages:n,isLastMessageInTurn:a,rememberForThisConversation:i,onRequestCompletion:r})}),e[38]=o,e[39]=a,e[40]=n,e[41]=r,e[42]=i,e[43]=z):z=e[43],e[44]!==E||e[45]!==K||e[46]!==z?(k=t.jsxs("div",{className:"flex items-center gap-1",children:[E,K,z]}),e[44]=E,e[45]=K,e[46]=z,e[47]=k):k=e[47],A=V!=null&&t.jsx(We,{name:D,afterName:w&&t.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:t.jsx(I,{id:"APIToolCallCard.write",defaultMessage:"Write"})}),params:typeof V.args=="object"?V.args:JSON.parse(V.args)}),e[8]=o,e[9]=x,e[10]=a,e[11]=g.connectorLinks,e[12]=n,e[13]=v,e[14]=r,e[15]=i,e[16]=p,e[17]=w,e[18]=$,e[19]=k,e[20]=A}else w=e[17],$=e[18],k=e[19],A=e[20];let T;e[48]!==w?(T=w&&t.jsxs("div",{className:"text-token-text-secondary text-xs",children:[t.jsx(bs,{className:"icon-sm me-2 mb-0.5 inline-block"}),t.jsx(I,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:Ga}})]}),e[48]=w,e[49]=T):T=e[49];let O;return e[50]!==$||e[51]!==k||e[52]!==A||e[53]!==T?(O=t.jsxs("div",{className:$,children:[k,A,T]}),e[50]=$,e[51]=k,e[52]=A,e[53]=T,e[54]=O):O=e[54],O}function Ga(s){return t.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:s},"link")}function qa(s){"use forget";const e=te.c(21),{onClose:n,url:a}=s;let o=a;try{let v;e[0]!==a?(v=new URL(a),e[0]=a,e[1]=v):v=e[1],o=v.hostname}catch(v){}let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(I,{id:"SuMJ5a",defaultMessage:"You're leaving ChatGPT"}),e[2]=r):r=e[2];const i=r;let l;e[3]!==o?(l=t.jsx(I,{id:"imLIvA",defaultMessage:"You'll be redirected to {host}",values:{host:o}}),e[3]=o,e[4]=l):l=e[4];const d=l;let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(I,{id:"RoCZcb",defaultMessage:"Continue"}),e[5]=c):c=e[5];let u;e[6]!==n||e[7]!==a?(u=t.jsx(ee,{className:"w-fit flex-1",color:"primary",size:"large",onClick:n,as:"link",openNewTab:!0,rel:"noopener noreferrer",to:a,children:c}),e[6]=n,e[7]=a,e[8]=u):u=e[8];let h;e[9]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx(I,{id:"Db8ziG",defaultMessage:"Stay"}),e[9]=h):h=e[9];let g;e[10]!==n?(g=t.jsx(ee,{className:"w-fit flex-1",color:"secondary",size:"large",onClick:n,children:h}),e[10]=n,e[11]=g):g=e[11];let x;e[12]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(fa,{"aria-hidden":"true",className:"text-token-text-primary h-12 w-12"}),e[12]=x):x=e[12];let f;e[13]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx("h2",{className:"text-token-text-primary text-xl font-semibold",children:i}),e[13]=f):f=e[13];let p;e[14]!==d?(p=t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[x,t.jsxs("div",{className:"space-y-2",children:[f,t.jsx("p",{className:"text-token-text-tertiary text-base",children:d})]})]}),e[14]=d,e[15]=p):p=e[15];let m;return e[16]!==n||e[17]!==u||e[18]!==g||e[19]!==p?(m=t.jsx(mn,{testId:"modal-safe-link-warning",isOpen:!0,onClose:n,hideSeparator:!0,noPadding:!0,textCenter:!0,contentClassName:"px-6 pb-6 pt-8 text-center w-fit",className:"w-fit!",title:i,visuallyHiddenHeader:!0,footerIsSpacedBetween:!0,primaryButton:u,secondaryButton:g,children:p}),e[16]=n,e[17]=u,e[18]=g,e[19]=p,e[20]=m):m=e[20],m}const Ja=({chatSDK:s,clientThreadId:e,onRequestCompletion:n,isLastMessageInTurn:a})=>{"use forget";var Ie,Oe;const o=vs(),{locale:r}=fn(o),i=yt(o,e),l=zn(i),d=Vn(),[c,u]=S.useState(null),h=Hn(s),{refetch:g,isLoading:x,isError:f,html:p,domain:m,subdomain:v,name:w,logoUrl:$,csp:k,prefersBorder:A}=h,{widgetParent:T,widgetType:O,metadata:B}=s,[C,V]=S.useState(null),H=S.useRef(null),R=S.useRef(null),D=xn.useStore(),J=b=>{const L=va(ue(q({},b),{chatSDK:s,persistedSystemHintsStore:D,clientThreadId:e}));L!=null&&n(L)},G=ne(()=>l.title$()),_=ne(()=>l.isPinned$(s)),E=ne(()=>l.isPinOrigin$(s)),P=ne(()=>l.isPinOrigin$(s)?l.displayMode$():"inline"),W=P==="fullscreen",K=P==="pip",z=ne(()=>l.maxWidgetHeight$()),Y=ne(()=>l.transitioningId$()===s.widgetId),M=ye((b,L)=>b===P?{mode:b}:(b==="fullscreen"&&(pn.setSidebarOpen(!1),D.setActiveSystemHint(null)),E?l.transitioningId$.set(ve):l.transitioningId$.set(s.widgetId),b!=="inline"&&l.subscribeToNewMessages$(s,u),Dn({forceFlushSync:!0,className:b==="inline"?[Be["pinned-widget"],Be["becoming-inline"]]:P==="inline"?[Be["pinned-widget"],Be["becoming-pinned"]]:Be["pinned-widget"],update:()=>{var Fe,$e;(Fe=R.current)==null||Fe.focus(),b==="inline"?($e=H.current)==null||$e.navigate({popToRoot:!0}):l.setPinnedWidgetHeight(C!=null?C:0),u(null),l.setDisplayMode$(s,b,L)}}).finished.then(()=>{l.transitioningId$.set(null)}),{mode:b}));S.useEffect(()=>{if(_)return gn(window,{keydown:b=>{b.key==="Escape"&&M("inline")}})},[_,M]);const be=ne(()=>l.getLatestChatSDK$(s)),me=c!=null?c:s,{toolInput:nt,toolOutput:Se,widgetState:at,toolResponseMetadata:oe}=S.useMemo(()=>l.getWidgetStateAndProps(me),[l,me]),re=be.messages,ve=me.widgetId,Ue=(Ie=B==null?void 0:B.attribution_id)!=null?Ie:T,[Ee,ot]=S.useState(0),[ie,Ae]=S.useState(!1),[we,ze]=S.useState(!1),[rt,Ve]=S.useState(!1),[it,lt]=S.useState(!1),le=hn(),se=()=>{g(),Ae(!1),ze(!1),ot(Ee+1)},He=()=>{Ae(!0),M("inline")},{height$:De,marginBottom$:Ge}=Gn(yt(o,e)),Te=ne(()=>{var b,L;return W&&E?16+((b=De())!=null?b:0)+((L=Ge())!=null?L:0):0}),Le=ne(()=>W&&Nt()?vt+Ls:0),qe=S.useMemo(()=>({insets:{top:Le,bottom:Te,left:0,right:0}}),[Te,Le]);if(d)return t.jsx(Ea,{title:w,logoUrl:$});if(_&&!E&&!Y)return null;const Je=W?void 0:C?"".concat(Math.min(C,z!=null?z:1/0),"px"):"auto",ke=Cs(re,a||E)&&t.jsx(Da,{messages:re,isLastMessageInTurn:a||E,clientThreadId:e,onRequestCompletion:n}),Re=x||!we||C==null,X=Na(m),Ke=t.jsxs("div",{className:ge("no-scrollbar",Y&&"[view-transition-name:pinned-kanzi-widget]",!E&&"relative mb-2",P==="inline"&&ge("thread-sm:w-full",!_&&"mx-0 max-sm:-mx-(--thread-content-margin) max-sm:w-[100cqw] max-sm:overflow-hidden",A&&!_&&!W&&"max-sm:overflow-visible max-sm:px-4"),K&&"thread-xl:top-4 fixed start-4 end-4 top-4 z-50 mx-auto max-w-(--thread-content-max-width) sm:start-0 sm:end-0 sm:top-(--header-height) sm:w-full",W?"fixed start-0 end-0 top-0 bottom-0 z-50 mx-auto flex w-auto flex-col overflow-hidden":"overflow-visible"),style:{maxHeight:z},children:[_&&!W&&t.jsx("button",{className:"absolute -start-2 -top-1.5 z-10 rounded-full bg-[#3a3a3a] p-1.25 text-white shadow-[0px_0px_0px_1px_var(--border-heavy),0px_4px_12px_rgba(0,0,0,0.12)] hover:bg-[#6a6a6a] md:-start-6",onClick:()=>M("inline"),children:t.jsx(jt,{className:"h-4.5 w-4.5"})}),W&&t.jsx(La,{logo:$,onClickBack:()=>{var b;return(b=H.current)==null?void 0:b.navigate({delta:-1})},onClickClose:()=>M("inline"),onClickForward:()=>{var b;return(b=H.current)==null?void 0:b.navigate({delta:1})},canGoBack:rt,canGoForward:it,title:(Oe=G!=null?G:w)!=null?Oe:"",widgetDisplayName:w!=null?w:"",widgetDomain:X!=null?X:null,onClickOpenInApp:()=>{var b;(b=H.current)==null||b.getCurrentPath().then(L=>{L==null||!X||window.open(new URL(L.replace(/^\/+/,""),X),"_blank")})}}),t.jsxs("div",{className:ge("relative overflow-hidden",W?"flex-1":"h-full",!_&&A&&"border-token-border-light shadow-short rounded-2xl sm:rounded-3xl dark:shadow-[0px_0px_0px_1px_#414141,0px_4px_14px_rgba(0,0,0,0.24)]",!W&&(A||K)&&"rounded-2xl sm:rounded-3xl",K&&"shadow-[0px_0px_0px_1px_var(--border-heavy),0px_6px_20px_rgba(0,0,0,0.1)] md:-mx-4"),style:{height:Re?406:Je},children:[t.jsx(Hs,{initial:!1,children:Re&&t.jsx(ts.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"loading-results-shimmer absolute inset-0 sm:rounded-3xl"},"loading-results-shimmer")}),t.jsx(Va,{iframeRef:R,ref:H,host:"chatgpt",title:O,locale:r,html:p,csp:k,subdomain:v,attributionId:Ue,clientThreadId:e,widgetId:ve,widgetType:O,widgetParent:T,widgetState:at,toolInput:nt,toolOutput:Se,toolResponseMetadata:oe,maxHeight:z,theme:le!=null?le:"light",displayMode:P!=null?P:"inline",safeArea:qe,onReady:()=>ze(!0),onError:He,api:{openExternal(b){const L=b.href;if(L){if(Ca(L,k,m)){yn()?as(o,qa,{url:L}):window.open(L,"_blank","noopener,noreferrer");return}as(o,qn,{urls:L})}},notifyEscapeKey:()=>M("inline"),notifyNavigation:({canGoBack:b,canGoForward:L})=>{Ve(b),lt(L)},notifyIntrinsicHeight:V,sendFollowUpMessage:J,updateWidgetState:(b,L)=>l.setWidgetState$(b,L),requestDisplayMode:({mode:b,title:L})=>M(b,L),callTool:(b,L)=>l.callTool$(T,b,L)}},Ee||ba(me,h)),!!ke&&t.jsx("div",{className:"bg-token-bg-secondary/50 pointer-events-auto absolute inset-0 z-0 flex items-center justify-center rounded-none sm:rounded-3xl"})]}),we&&ke&&t.jsx(ts.div,{className:ge("pointer-events-none absolute inset-0 z-10 flex justify-center",W?"top-(--header-height) items-center":"items-start pt-10"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:.1,duration:.24},children:ke})]}),Qe=f||ie;return t.jsxs(t.Fragment,{children:[W&&t.jsx("div",{className:"bg-token-bg-primary fixed start-0 end-0 top-0 bottom-0 z-10"}),!_&&!f&&t.jsx("div",{className:"mt-2 sm:mt-4",children:t.jsx(Ma,{onClick:X?()=>window.open(X,"_blank","noopener,noreferrer"):void 0,after:!1,isLoading:x,logoUrl:$,name:w})}),Qe?t.jsx("div",{className:ge(f&&"mt-2"),children:t.jsx(Aa,{onClickRetry:se})}):Ke,!W&&!A&&t.jsx("div",{className:"bg-token-border-default my-3 h-px w-full"})]})},Ka=s=>{"use forget";const e=te.c(7),{messages:n,clientThreadId:a,onRequestCompletion:o,isLastMessageInTurn:r}=s;let i;e[0]!==n?(i=Un(n),e[0]=n,e[1]=i):i=e[1];const l=i;if(l.isError)return null;let d;return e[2]!==l||e[3]!==a||e[4]!==r||e[5]!==o?(d=t.jsx(Ja,{clientThreadId:a,onRequestCompletion:o,isLastMessageInTurn:r,chatSDK:l}),e[2]=l,e[3]=a,e[4]=r,e[5]=o,e[6]=d):d=e[6],d},Qa=s=>{"use forget";const e=te.c(5),{messages:n,clientThreadId:a,onRequestCompletion:o,isLastMessageInTurn:r}=s;let i;return e[0]!==a||e[1]!==r||e[2]!==n||e[3]!==o?(i=t.jsx(un,{name:"ChatSDKContent",children:t.jsx(Ka,{messages:n,clientThreadId:a,onRequestCompletion:o,isLastMessageInTurn:r})}),e[0]=a,e[1]=r,e[2]=n,e[3]=o,e[4]=i):i=e[4],i};function Ya({messageMetadata:s}){const[e,n]=S.useState(!1);return t.jsxs("div",{className:"my-2 flex flex-col text-sm",children:[t.jsxs("div",{className:"flex flex-row items-center hover:cursor-pointer",onClick:()=>{n(!e)},children:[e?t.jsx(st,{className:"icon-sm"}):t.jsx(_n,{className:"icon-sm"}),t.jsx("div",{className:"font-semibold",children:s.display_message})]}),e&&t.jsx("pre",{children:JSON.stringify(s.data,null,2)})]})}function Xa({debugMessages:s}){return s.length===0?null:t.jsx("div",{children:s.map((e,n)=>{var o,r;const a=(r=(o=e.metadata)==null?void 0:o.jit_plugin_data)==null?void 0:r.from_server;return a&&a.type==="debug"?t.jsx(Ya,{messageMetadata:a.body},n):null})})}const Rs="openaiFileIdRefs",Za=["send_email","batch_modify_email","create_event","update_event","delete_event"];function eo({name:s,params:e,result:n,privacyPolicyUrl:a,isPromptingForPermission:o}){var l;const i=((l=e==null?void 0:e[Rs])!=null?l:[]).map((d,c)=>{const u=d.name.startsWith("dalle-");let h=d.name;return u&&(h="".concat(h,".webp")),t.jsx(ws,{file:h,fileId:d.id},c)});return t.jsxs("div",{className:"divide-token-border-default border-token-border-default mt-1 mb-4 divide-y overflow-hidden rounded-xl border",children:[s&&t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary px-4 py-2 text-sm",children:t.jsx(I,{id:"JITPluginMessage.params.toolCall",defaultMessage:"Tool call: {name}",values:{name:t.jsx("span",{className:"text-token-text-primary",children:s})}})}),e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:[o?t.jsx(I,{id:"JITPluginMessage.params.sharing.present",defaultMessage:"The following will be shared:"}):t.jsx(I,{id:"JITPluginMessage.params.sharing.past",defaultMessage:"The following was shared:"}),a&&t.jsx("a",{href:bn(a),className:"text-token-text-primary",target:"_blank",rel:"noreferrer",children:t.jsx(I,q({},ae.privacyPolicyLink))})]}),t.jsx("div",{className:"px-4 py-2",children:t.jsx(bt,{value:e})}),i.length>0&&t.jsx("div",{className:"px-4 py-2",children:i})]}),n&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:t.jsx(I,{id:"JITPluginMessage.params.result",defaultMessage:"Result:"})}),t.jsx("div",{className:"px-4 py-2",children:t.jsx(bt,{value:n})})]})]})}var ps;const to=Me.div(ps||(ps=fe(["h-px bg-token-border-default"])));var gs;const ms=Me.div(gs||(gs=fe(["text-sm font-medium py-3 leading-6"])));var hs;const so=Me.div(hs||(hs=fe(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),no=":",ao=({functionName:s,parameters:e,onClick:n,isDraft:a=!0,isCanceled:o=!1})=>{const r=Ce(),i=Object.entries(e).filter(([l,d])=>!d||l==="timezone_str"&&d===Intl.DateTimeFormat().resolvedOptions().timeZone?!1:d.length>0);return t.jsxs(so,{children:[t.jsx("div",{className:"mb-4 flex items-center font-semibold",children:t.jsx("div",{children:a?wt(s):oo(s,r)})}),i.map(([l,d])=>t.jsxs("div",{children:[t.jsx(to,{}),t.jsxs("div",{className:"flex",children:[t.jsxs(ms,{className:"text-token-text-tertiary me-1",children:[wt(l),no]}),t.jsx(ms,{className:"whitespace-pre-line",children:Is(d,r)})]})]},l)),a&&!o&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(ee,{color:"primary",className:"py-2",onClick:n,children:r.formatMessage(et.approveButton)})}),o&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(ee,{color:"primary",className:"py-2",disabled:!0,children:r.formatMessage(et.canceledButton)})})]})},oo=(s,e)=>{switch(s){case"create_event":return"Created Event ✅";default:return"".concat(wt(s)," ").concat(e.formatMessage(et.completedAction)," ✅")}},wt=s=>{switch(s){case"timezone_str":return"Timezone";default:return s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}},Is=(s,e)=>{if(Array.isArray(s))return s.map(o=>Is(o,e)).join(e.formatMessage(et.valueSeparator));if(typeof s=="object")return JSON.stringify(s);if(s.match(/^\s*\d{4}-\d{2}-\d{2}/)==null)return s;const a=new Date(s);return Number.isNaN(a.getTime())?s:e.formatDate(a,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},et=tt({approveButton:{id:"ParametersView.approveButton",defaultMessage:"Approve"},completedAction:{id:"ParametersView.completedAction",defaultMessage:"Completed"},canceledButton:{id:"ParametersView.canceledButton",defaultMessage:"Canceled"},valueSeparator:{id:"ParametersView.valueSeparator",defaultMessage:","}}),Os="api_tool.list_resources",Fs="api_tool.search_tools",ro="api_tool",io=new Set([Os,Fs,ro]),lo=s=>io.has(s);function co(s,e,n,a,o,r=null){const i=mo(e,a,o,r);return i?typeof i=="string"?i:s.formatMessage(i,n):null}function mo(s,e,n,a=null){if(![y.Finished,y.Running,y.Stopped].includes(n)||!e)return s;switch(e){case"ecosystem_demo.daw":case"ecosystem_demo.daw_drums":return n===y.Finished||n===y.Stopped?Z({id:"BYgUCC",defaultMessage:"Composed track"}):Z({id:"9n1xDI",defaultMessage:"Composing track"});case"ecosystem_demo.flashcards":return n===y.Finished||n===y.Stopped?Z({id:"szZeVr",defaultMessage:"Created flashcards"}):Z({id:"NYOjya",defaultMessage:"Creating flashcards"});case Os:{const o=a==null?void 0:a[n];return o!=null?o:n===y.Finished||n===y.Stopped?Z({id:"OdEouq",defaultMessage:"Looked for available tools"}):Z({id:"hSyoq0",defaultMessage:"Looking for available tools"})}case Fs:{const o=a==null?void 0:a[n];return o!=null?o:n===y.Finished||n===y.Stopped?Z({id:"4et5qC",defaultMessage:"Searched tools"}):Z({id:"V0IDh0",defaultMessage:"Searching tools"})}case"api_tool.call_tool":{const o=a==null?void 0:a[n];return o!=null?o:n===y.Finished||n===y.Stopped?Z({id:"NTASw4",defaultMessage:"Called tool"}):Z({id:"gc64KQ",defaultMessage:"Calling tool"})}}return s}function No({messages:s,nextMessage:e,clientThreadId:n,isLastMessageInTurn:a,isLastTurnInConversation:o,connectorFixture:r,onRequestCompletion:i}){var He,De,Ge,Te,Le,qe,Je,ke,Re,X,Ke,Qe,Ie,Oe,b,L,Fe,$e,Mt,St,Et,At,Tt,Lt,Rt,It,Ot,Ft,$t,Bt,Pt,Wt,Ut,zt,Vt,Ht;const[l,d]=Ds(),{assistantMessage:c,toolMessages:u,debugMessages:h}=ks(s),g=(He=c.recipient)!=null?He:"",x=ys(),{addSource:f}=Jn(n),{uiState:p,jitPluginData:m,fileAttachments:v,invokedPlugin:w,lastConfirmActionJitPluginData:$}=Ct(s,a),k=Ce(),A=vn(),[T,O]=wn(n,j=>{var N,U;const F=(U=(N=c.metadata)==null?void 0:N.gizmo_id)!=null?U:j?gt.getGizmoId(j):A;return[F,Zn(j==null?void 0:j.mode,F)]}),B=Kn(O)&&O.gizmo_id===T,C=(De=kn(T,B))==null?void 0:De.data,[V,H]=S.useState(!1),R=os(c.recipient);let D;if((R==null?void 0:R.functionName)!=null&&(C==null?void 0:C.tools)!=null){for(const j of C.tools)if(sa(j,R.functionName)){D=j;break}}const J=(Ge=os(e==null?void 0:e.recipient))==null?void 0:Ge.namespace,{connectorId:G,connectorToolStatus:_,connectorStatusMessage:E,showConnectorConnect:P}=na(R==null?void 0:R.namespace,J,u,o),W=jn(),K=kt(!0,Nn.JIT_PLUGIN),z=r!=null?r:K.platformConnectors.get(G!=null?G:""),Y=Cn();let M=((Te=m==null?void 0:m.from_server)==null?void 0:Te.type)!=="denied_by_user"?(Le=m==null?void 0:m.from_server)==null?void 0:Le.body.domain:(qe=D==null?void 0:D.metadata)==null?void 0:qe.domain,be=null,me=null;if(!M&&(R!=null&&R.functionName)&&R.namespace==="kanzi_app"){const[j,F]=R.functionName.split("/");M=j.replace(/_/g," "),be=t.jsx(Rn,{openNewTab:!0,className:"text-token-text-secondary pt-1 opacity-0 transition-opacity duration-200 group-hover/tool-message:opacity-100",href:"/kanzi/studio/c/".concat(F),children:t.jsx(Xn,{})})}W&&g==="api_tool.call_tool"&&(me=t.jsx("button",{onClick:()=>ta(yt(Se,n)).focusMessage$(c.id),className:"text-token-text-secondary",children:t.jsx(ea,{})})),M?M.endsWith("__jit_plugin")&&(M=M.slice(0,-12)):M="connector";const nt=(Je=D==null?void 0:D.metadata)==null?void 0:Je.privacy_policy_url;S.useEffect(()=>{var N,U;if(((N=aa(m==null?void 0:m.from_client))==null?void 0:N.type)==="oauth_success")return;const j=l.get("oauth_success"),F=l.get("system_hint");if(((U=m==null?void 0:m.from_server)==null?void 0:U.type)==="oauth_required"&&j){d(Q=>(Q.delete("oauth_success"),Q.delete("system_hint"),Q),{replace:!0});for(const Q of m.from_server.body.actions)if(Q.type==="oauth_redirect"){const ce="jit_oauth_success:".concat(Q.oauth_redirect.target_message_id);if(sessionStorage.getItem(ce))return;sessionStorage.setItem(ce,"1"),he({eventSource:"url",assistantMessage:c,onRequestCompletion:i,actionData:{type:"oauth_success",target_message_id:Q.oauth_redirect.target_message_id},clientThreadId:n,activeSystemHint:F||null});return}}},[O,c,s,n,i,m,o,l,d,x,f]),S.useEffect(()=>{var N;const j=l.get("link_success"),F=l.get("oauth_success");if((j||F)&&((N=m==null?void 0:m.from_server)==null?void 0:N.type)==="link_required"){d(U=>(U.delete("link_success"),U.delete("oauth_success"),U.delete("system_hint"),U),{replace:!0});for(const U of m.from_server.body.actions)if(U.type==="link_created"){he({eventSource:"url",assistantMessage:c,onRequestCompletion:i,actionData:{type:"link_success",target_message_id:U.link_created.target_message_id},clientThreadId:n,activeSystemHint:x!=null?x:null});return}}},[l,d,c,n,i,m,x]);const Se=vs(),at=Se&&Mn(Se,"2792858552");let oe=Ne.Running,re=M?ae.running:ae.starting,ve={domain:M};if(p===y.Hidden)return null;if(p===y.OauthLogin||p===y.UserConfirmation||p===y.NoAuthLink){oe=Ne.Paused,re=ae.confirmingSimple;const j={gizmoName:(ke=C==null?void 0:C.gizmo.display.name)!=null?ke:"ChatGPT",domain:M};ve=ue(q({},j),{title:F=>t.jsxs("div",{className:"inline-flex items-center gap-1 text-sm",children:[F,t.jsx(st,{className:"icon-sm"})]}),subtitle:F=>t.jsx("div",{className:"text-xs",children:F})})}else p===y.Finished?(oe=Ne.Finished,re=ae.finished,ve={domain:M}):p===y.Error?(oe=Ne.Error,re=ae.error):(p===y.Stopped||p===y.Denied)&&(oe=Ne.Stopped,re=p===y.Denied?ae.declined:ae.stopped);const Ue=((Re=m==null?void 0:m.from_server)==null?void 0:Re.type)!=="denied_by_user"?(X=m==null?void 0:m.from_server)==null?void 0:X.body.actions.map((j,F)=>t.jsx(Ms,{clientThreadId:n,messages:s,onRequestCompletion:i,action:j,domain:M,handleUserAction:he,rememberAnswer:V},F)):null;let Ee=null;((Ke=c.metadata)!=null&&Ke.tool_invoking_message||(Qe=c.metadata)!=null&&Qe.tool_invoked_message||(Oe=(Ie=c.metadata)==null?void 0:Ie.chatgpt_sdk)!=null&&Oe.tool_invoking_message||(L=(b=c.metadata)==null?void 0:b.chatgpt_sdk)!=null&&L.tool_invoked_message)&&(Ee={[y.Running]:(Et=(St=($e=(Fe=c.metadata)==null?void 0:Fe.chatgpt_sdk)==null?void 0:$e.tool_invoking_message)!=null?St:(Mt=c.metadata)==null?void 0:Mt.tool_invoking_message)!=null?Et:void 0,[y.Finished]:(It=(Rt=(Tt=(At=c.metadata)==null?void 0:At.chatgpt_sdk)==null?void 0:Tt.tool_invoked_message)!=null?Rt:(Lt=c.metadata)==null?void 0:Lt.tool_invoked_message)!=null?It:void 0,[y.Stopped]:(Pt=(Bt=(Ft=(Ot=c.metadata)==null?void 0:Ot.chatgpt_sdk)==null?void 0:Ft.tool_invoked_message)!=null?Bt:($t=c.metadata)==null?void 0:$t.tool_invoked_message)!=null?Pt:void 0});const ot=co(k,re,ve,g,p,Ee);if(lo(g)&&!a&&!W)return null;const ie=Ns(s,a),Ae=oa(s,a),we=ra(s),ze=(Wt=ie==null?void 0:ie[Rs])!=null?Wt:[],rt=!ft(s)&&(!!ie||!!we||ze.length>0),Ve=Cs(s,a),it=js(s,a),lt=ft(s)&&p!==y.Denied&&!W;let le=t.jsx(t.Fragment,{});const se=ia(s,a);if(Za.includes(se)&&(p===y.UserConfirmation||p===y.Finished||p===y.Stopped||p===y.Denied)){const j=p!==y.Finished,F=(p===y.Stopped||p===y.Denied)&&!o,N=(Ut=is(m,w))!=null?Ut:is($,void 0),U=Q=>{var ce,Ye,Dt,Gt,qt,Jt,Kt;((ce=m==null?void 0:m.from_server)==null?void 0:ce.type)==="confirm_action"&&((Gt=(Dt=(Ye=m==null?void 0:m.from_server)==null?void 0:Ye.body)==null?void 0:Dt.actions)==null?void 0:Gt[0].type)==="allow"&&(he({clientThreadId:n,assistantMessage:c,onRequestCompletion:i,sourceEvent:Q,actionData:ue(q({type:"allow"},(Kt=(Jt=(qt=m==null?void 0:m.from_server)==null?void 0:qt.body)==null?void 0:Jt.actions)==null?void 0:Kt[0].allow),{remember_answer:V}),activeSystemHint:x}),Ln(n,$s=>{$s.scrollToMessageId=n}))};switch(se){case"send_email":le=t.jsx(ga,{to:N==null?void 0:N.to,cc:N==null?void 0:N.cc,bcc:N==null?void 0:N.bcc,subject:N==null?void 0:N.subject,body:N==null?void 0:N.body,onClick:p===y.UserConfirmation?U:()=>{},isDraft:j,isCanceled:F});break;default:le=t.jsx(ao,{functionName:se!=null?se:"",parameters:N!=null?N:{},onClick:p===y.UserConfirmation?U:()=>{},isDraft:j,isCanceled:F});break}}else(p===y.UserConfirmation||p===y.NoAuthLink||p===y.OauthLogin)&&Ue&&!Ae&&(le=t.jsx(t.Fragment,{children:t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[Ue,((zt=m==null?void 0:m.from_server)==null?void 0:zt.type)==="confirm_action"&&it?t.jsx("div",{className:"flex gap-2 text-sm",children:t.jsx(Qn,{id:"dont-ask-again",label:t.jsx(I,q({},ae.rememberForThisConversation)),checked:V,onChange:j=>H(j.target.checked)})}):null]})}));return G?t.jsxs(t.Fragment,{children:[E&&t.jsx(rs,{highlightedCommand:z?k.formatMessage(E,{domain:z.name}):t.jsx("br",{}),status:_,showWorkUserSetting:!1}),P&&z&&t.jsx("div",{className:"mb-2 flex gap-2",children:t.jsx(ua,{connector:z,onConnect:()=>{var N;const j=Sn(n),F=j?new URL(En(j),window.location.origin):new URL(window.location.href);F.searchParams.set("oauth_success","true"),x&&F.searchParams.set("system_hint",x),Y({connectorId:z.id,redirectAfter:F.toString(),referrer:An.JitPluginMessage,authTypeOverride:((N=m==null?void 0:m.from_server)==null?void 0:N.type)==="oauth_required"?"OAUTH":at?void 0:"NONE"})},onProceedWithoutConnecting:j=>{var N,U,Q;const F=(N=m==null?void 0:m.from_server)==null?void 0:N.type;if(F==="oauth_required"||F==="link_required"){for(const ce of(Q=(U=m==null?void 0:m.from_server)==null?void 0:U.body.actions)!=null?Q:[])if(ce.type==="deny"){const Ye=ce.deny.target_message_id;he({eventSource:Yn(j),assistantMessage:c,onRequestCompletion:i,actionData:{type:"deny",target_message_id:Ye},clientThreadId:n,activeSystemHint:x});return}}}})})]}):t.jsxs(t.Fragment,{children:[t.jsx(Xa,{debugMessages:h}),!lt&&t.jsx("span",{className:"group/tool-message",children:t.jsx(rs,{highlightedCommand:ot,status:oe,showWorkUserSetting:!1,accessory:be,labelPrefix:me,forceExpanded:p===y.UserConfirmation,children:rt?(R==null?void 0:R.namespace)==="api_tool"?Ve?null:t.jsx(ya,{isWrite:p===y.UserConfirmation,functionName:(Vt=c.recipient)!=null?Vt:se,params:ie,result:we,toolCallSafetySummary:Ae,messages:s,clientThreadId:n,jitPluginData:m!=null?m:{},onRequestCompletion:i,rememberForThisConversation:V,onRememberForThisConversationChange:H}):t.jsx(eo,{privacyPolicyUrl:nt,name:(Ht=c.recipient)!=null?Ht:se,params:ie,result:we,isPromptingForPermission:oe===Ne.Paused}):null})}),t.jsx("div",{className:"mt-1 flex flex-wrap gap-2 empty:hidden",children:v==null?void 0:v.map(j=>t.jsx(ws,{file:j.name,fileId:j.id,width:"wide",alwaysShowData:!0,showDownloadButton:!0,downloadLink:j.download_url,contextConnectorInfo:Tn(j.context_connector_info)},j.id))}),ft(s)&&p!==y.Denied&&t.jsx(Qa,{clientThreadId:n,messages:s,isLastMessageInTurn:a,onRequestCompletion:i}),!Ve&&le]})}export{No as JITPluginMessage};
//# sourceMappingURL=cq8dery9zrxb6hjr.js.map

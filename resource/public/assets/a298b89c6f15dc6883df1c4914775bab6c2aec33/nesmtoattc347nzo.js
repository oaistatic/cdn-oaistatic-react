var U=Object.defineProperty,D=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var _=(r,t,e)=>t in r?U(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,y=(r,t)=>{for(var e in t||(t={}))Q.call(t,e)&&_(r,e,t[e]);if(M)for(var e of M(t))V.call(t,e)&&_(r,e,t[e]);return r},N=(r,t)=>D(r,H(t));import{b as E,j as o,M as J,g as X,r as p,D as Y,a7 as Z}from"./n75kuy1cx6f5mogg.js";import{B as tt,du as O,e as et,qN as rt,i as G,j as ot,ix as W,f7 as nt,cw as st,P as at,dg as it,f4 as F,bN as z,bK as ct,bG as mt}from"./ewse8exzafeu10ji.js";import{m as k}from"./nc6572sivljsjb83.js";import{R as pt}from"./mpxypd9p8phumu7j.js";import{S as dt}from"./mkutoen1npt6ybr6.js";import{lc as lt,ld as ut,le as ht,jQ as b,jR as R,lf as gt}from"./ny10lj7zpuz89fvf.js";import{C as L}from"./dam1y7iericdl8m3.js";import{a as ft}from"./gva4acr7rlqtafux.js";import{a as xt}from"./munzcsmgsqrfqkn8.js";import{b as kt,g as Pt,T as Tt,W as yt,c as bt}from"./on3o5me2wsmfitl8.js";import{n as A,o as Ct,q as jt}from"./fmsmhem5hrm2cxrs.js";import{u as vt}from"./nyfr63odztw7y2ja.js";import"./czwq62q5rbh9b1yi.js";import"./gowyl4x2bs7hfi4a.js";import"./em5q5yhbyv41ft0j.js";import"./mv12q8bkkijgf9zf.js";import"./3mp3j06lb1q5ttzm.js";import"./gy07ow2dyy5du4ny.js";import"./h2dwuj1m5ps9l7uv.js";import"./j2ui4c2m3nj8pqst.js";import"./lksc5q29mjlblqoo.js";import"./da0anzdj3bll2tbv.js";import"./mzj5jqjjpo006z7a.js";import"./nnb0v70g00lhjclz.js";import"./fh2tsu8ocsi22jc3.js";import"./jaupzjmp9wknd4io.js";import"./jtxj1xvdu5i7mvdh.js";import"./d65yyyom1modmtdi.js";import"./kj8rd4pu8k32z2dy.js";import"./ca3g7gcaj954pu3h.js";import"./k5jwqq80a0png05z.js";import"./kg55sov6c624o43c.js";import"./7pd84i0fdyounev7.js";import"./d5vv6ct7n3prp63a.js";import"./fno7ypwqdtl0x211.js";import"./i70dhxk1j381usod.js";import"./j4iu4cyxlby9nd33.js";import"./jhe3wdj1wdglvpku.js";import"./eq0refymwif7pcpz.js";import"./iquhayvbn8ec35rz.js";import"./kas18igmwglc2mb4.js";import"./lptwpbjabrvjmhsj.js";import"./jwsjryhasdl9p2nq.js";import"./go4mpxmt63qgntp4.js";import"./fzrn137102spawew.js";import"./dv12g54ivgixitjp.js";import"./jx9lof8tzg97x4l9.js";import"./e2tpmvaykwot5faa.js";import"./ne36kgu5w1zang50.js";import"./frf4c35l48b0bjrb.js";import"./h76aawyn0y8q6s6p.js";import"./hkwix64yhkotslv1.js";import"./5hoqitp3r2hkdtny.js";import"./hm7mxp554vts8hxt.js";import"./j2tluvxda4ll72qx.js";import"./abgjeqojg38moqsp.js";import"./ca0tcsne49xiprm9.js";import"./gbvlxp0nrrwdd6eq.js";import"./n9nk4w8voewwsboc.js";import"./i3bw46mavo9n01l8.js";import"./ga8p3rr9o0mc72h0.js";import"./jocaiq9wugboh64i.js";import"./heyok871zyju5auh.js";import"./ltsv6em2m484o9yy.js";const wt=({title:r})=>{const e=E().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return o.jsxs("div",{className:"flex justify-between print:hidden",children:[o.jsxs("div",{className:"flex flex-col justify-start",children:[o.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:r}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:o.jsx(J,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:n=>o.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:n})}})})]}),o.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[o.jsx(dt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),o.jsx(tt,{className:et("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:O,label:e,children:e})]})]})};function St({postWithProfile:r,title:t,children:e}){return o.jsx(lt.Provider,{value:{postId:r.post.id},children:o.jsx(rt,{children:o.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:o.jsxs("div",{className:"mx-auto max-w-3xl",children:[o.jsx("div",{className:"px-2 py-6",children:!!t&&o.jsx(wt,{title:t})}),o.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:o.jsxs("div",{className:"p-14 pt-8",children:[o.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:o.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[o.jsx(O,{className:"text-token-text-primary h-8 w-8"}),o.jsx(ut,{})]})}),e]})})]})})})})}function It(r){if(r.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const t=r.post.attachments[0];return{task:t.task,fetchedTurns:t.turns,current_user_turn:t.current_user_turn,current_assistant_turn:t.current_assistant_turn,current_diff_task_turn:t.current_diff_task_turn,exampleTaskInfo:t.example_task_info}}function Mt({postWithProfile:r}){var S;vt();const t=A(u=>u.addTurnToTaskMap),{task:e,fetchedTurns:n,current_user_turn:s,current_assistant_turn:a,current_diff_task_turn:c,exampleTaskInfo:l}=It(r),m=G(),i=E(),d=X(),g=ht.useCurrentImage()!=null,P=ot(m,"2818336692"),[x,T]=p.useState([]),C=p.useCallback(()=>{T([])},[]),{focusedAssistantTurn:h,setFocusedAssistantTurnId:j}=kt({taskId:e.id,task:e,currentUserTurn:s!=null?s:null,currentAssistantTurn:a!=null?a:null}),v=p.useMemo(()=>Ct(h),[h]),K=p.useMemo(()=>({comments:x,setComments:T,clearComments:C,readonlyComments:v}),[x,T,C,v]),f=A(({getTurnsForTask:u})=>e?u(e.id):[]),w=p.useMemo(()=>{var u;return Pt({focusedAssistantTurn:h,pastTurns:f,currentDiffTaskTurnId:(u=c==null?void 0:c.id)!=null?u:null})},[h,c==null?void 0:c.id,f]),q=p.useMemo(()=>({setFocusedAssistantTurnId:j,focusedAssistantTurn:h,currentDiffTaskTurn:w,taskId:e==null?void 0:e.id,task:e,pastTurns:f,canFollowUp:!1}),[h,w,e,f,j]);return p.useEffect(()=>{var u;Object.values((u=n==null?void 0:n.turn_mapping)!=null?u:{}).forEach($=>{var I;t((I=e==null?void 0:e.id)!=null?I:"",$.turn)})},[n,t,e]),jt([{key:"newTask",action:()=>{d("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:R.Chat,keyboardBinding:[b.Mod,b.Shift,"o"]},{key:"closeTask",action:()=>{d("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:R.Chat,keyboardBinding:[b.Escape],enabled:!g}]),!e||!f?null:o.jsx(W.Provider,{value:{postWithProfile:r,setIsReportModalOpen:()=>{}},children:o.jsx(nt,{children:o.jsx(Tt,{value:K,children:o.jsx(yt,{value:q,children:o.jsx(bt,{permissions:"read",turnId:(S=a==null?void 0:a.id)!=null?S:"",showForkButton:P,loadingTurnMapping:!1,isSharedExampleTask:!!l})})})})})}const De=Y(function(){const t=Z();return t.kind==="forbidden"?o.jsx(At,{chatPageProps:t.chatPageProps,reason:"workspace"}):o.jsx(_t,{loaderData:t})});function _t({loaderData:r}){var s,a,c,l;p.useEffect(()=>{var m,i;at.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:r.postWithProfile.post.id,primary_attachment_type:(i=(m=r.postWithProfile.post.attachments)==null?void 0:m[0])==null?void 0:i.kind,referrer:r.referrer})},[r]);const{session:t}=it(),e=p.useMemo(()=>{var i,d;const m=F();return z.initThread({clientThreadId:m,conversationMode:{kind:ct.PrimaryAssistant},userId:(i=t==null?void 0:t.user)==null?void 0:i.id,accountId:(d=t==null?void 0:t.account)==null?void 0:d.id}),m},[(s=t==null?void 0:t.account)==null?void 0:s.id,(a=t==null?void 0:t.user)==null?void 0:a.id]),n=(c=r.postWithProfile.post.attachments)==null?void 0:c[0];if(n.kind==="deep_research"){const m=n.messages,i=mt(m),d=(l=i==null?void 0:i.metadata)==null?void 0:l.async_task_title;return i?o.jsx(St,{postWithProfile:r.postWithProfile,title:d,children:o.jsx(pt,{messages:m,threadId:e})}):null}return n.kind==="codex"?o.jsx(Mt,{postWithProfile:r.postWithProfile}):o.jsx(Et,{postWithProfile:r.postWithProfile,chatPageProps:r.chatPageProps})}function B(r){return{url:"https://ogimg.chatgpt.com/?postId=".concat(r),size:[1200,630]}}function Nt(r,t){var n,s,a,c,l,m,i;if(!r.attachments||r.attachments.length===0)return{url:k.src};const e=r.attachments[0];switch(e.kind){case"media_generation":{const d=(s=(n=e.encodings)==null?void 0:n.md)!=null&&s.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,g=(c=(a=e.encodings)==null?void 0:a.unfurl)!=null&&c.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,P=(m=(l=e.encodings)==null?void 0:l.thumbnail)!=null&&m.path?{url:e.encodings.thumbnail.path}:void 0,x={url:e.url,size:[e.width,e.height]};return t&&d!=null?d:(i=g!=null?g:P)!=null?i:x}case"message_slice":return B(r.id);default:return{url:k.src}}}function Rt(r){var n,s,a;const t=(n=r.text)==null?void 0:n.trim();if(t)return t;const e=(s=r.attachments)==null?void 0:s[0];return(e==null?void 0:e.kind)==="media_generation"&&((a=e.title)!=null&&a.trim())?e.title.trim():"Shared Content"}const He=({data:r})=>{const t=r,e={name:"robots",content:"noindex,nofollow"};if(!t||t.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:k.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:k.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:n}=t.postWithProfile,s=t.enforceRenderedOgImg?B(n.id):Nt(n,t.preferIntrinsicAspectRatioForOgImage),a=Rt(n),c=n.permalink,l=new Date(n.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:s.url},{property:"og:image:secure_url",content:s.url},...s.size?[{property:"og:image:width",content:s.size[0]},{property:"og:image:height",content:s.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:l},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:s.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function At({chatPageProps:r,reason:t}){const e=G();return p.useEffect(()=>{st(e,gt,{reason:t})},[]),o.jsx(L,y({},r))}function Et({postWithProfile:r,chatPageProps:t}){const[e,n]=p.useState(!1),[s]=p.useState(()=>F()),a=xt(r.post.attachments);if(a){const{threadResponse:c}=a;z.updateThreadFromServer(s,c,{skipIfExisting:!0,continuingFromSharedPostId:r.post.id,forkFromSharedPost:!0})}return o.jsxs(W.Provider,{value:{postWithProfile:r,setIsReportModalOpen:n},children:[e&&o.jsx(ft,{post:r.post,onClose:()=>n(!1)}),o.jsx(L,N(y({},t),{clientThreadId:s}))]})}export{De as default,He as meta};
//# sourceMappingURL=nesmtoattc347nzo.js.map

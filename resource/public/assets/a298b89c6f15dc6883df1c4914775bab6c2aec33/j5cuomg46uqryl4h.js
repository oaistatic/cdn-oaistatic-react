var T=Object.freeze,B=Object.defineProperty;var D=(t,e)=>T(B(t,"raw",{value:T(e||t.slice())}));import{c as v,j as l,M as y,r as k,b as O,D as z}from"./n75kuy1cx6f5mogg.js";import{B as F,e as C,i_ as H,c0 as W,aT as Q,d9 as V,F as q,lE as A,i as L,cw as Y}from"./ewse8exzafeu10ji.js";import{C as Z}from"./mv12q8bkkijgf9zf.js";import{N as X}from"./kj8rd4pu8k32z2dy.js";import{gR as G,d9 as E,nZ as J,n_ as K,n$ as ee,o0 as te,o1 as se,dR as le,dS as re,dT as oe,dU as ne,t as ie,dC as ae,o2 as ce,da as U,lQ as de,o3 as ue,o4 as me}from"./ny10lj7zpuz89fvf.js";import{M as fe}from"./gva4acr7rlqtafux.js";import{P as xe,a as pe}from"./f6sng9ks3aiumkep.js";import{S as he,a as ge,b as ve}from"./hnrxlut3g9njspbj.js";import"./3mp3j06lb1q5ttzm.js";import"./gy07ow2dyy5du4ny.js";import"./h2dwuj1m5ps9l7uv.js";import"./j2ui4c2m3nj8pqst.js";import"./lksc5q29mjlblqoo.js";import"./da0anzdj3bll2tbv.js";import"./mzj5jqjjpo006z7a.js";import"./nnb0v70g00lhjclz.js";import"./fh2tsu8ocsi22jc3.js";import"./jaupzjmp9wknd4io.js";import"./jtxj1xvdu5i7mvdh.js";import"./d65yyyom1modmtdi.js";import"./em5q5yhbyv41ft0j.js";import"./ca3g7gcaj954pu3h.js";import"./k5jwqq80a0png05z.js";import"./czwq62q5rbh9b1yi.js";import"./gowyl4x2bs7hfi4a.js";import"./kg55sov6c624o43c.js";import"./7pd84i0fdyounev7.js";import"./d5vv6ct7n3prp63a.js";const je=t=>{"use forget";const e=v.c(3),{onClick:o}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=l.jsx(y,{id:"sZVLRv",defaultMessage:"Curate"}),e[0]=r):r=e[0];let s;return e[1]!==o?(s=l.jsx(F,{icon:G,onClick:o,children:r}),e[1]=o,e[2]=s):s=e[2],s},ke=t=>{"use forget";const e=v.c(3),{onClick:o}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=l.jsx(y,{id:"PYkj8c",defaultMessage:"Curate for tomorrow"}),e[0]=r):r=e[0];let s;return e[1]!==o?(s=l.jsx(F,{onClick:o,size:"large",className:"w-full max-w-80",children:r}),e[1]=o,e[2]=s):s=e[2],s},be=t=>{"use forget";const e=v.c(9),{cards:o,activeCardId:r,onSelect:s}=t;let i;if(e[0]!==r||e[1]!==o||e[2]!==s){let c;e[4]!==r||e[5]!==s?(c=u=>{var d,a;const f=(d=u.image)==null?void 0:d.url,m=u.id===r;return l.jsx("img",{src:f,alt:(a=u.title)!=null?a:"",className:C("h-11 w-11 cursor-pointer rounded-lg object-cover opacity-50",m&&"h-14 w-14 opacity-100"),onClick:()=>s(u.id)},u.id)},e[4]=r,e[5]=s,e[6]=c):c=e[6],i=o.map(c),e[0]=r,e[1]=o,e[2]=s,e[3]=i}else i=e[3];let n;return e[7]!==i?(n=l.jsx("div",{className:"absolute top-1/2 z-20 -translate-y-1/2 flex-col items-center gap-3 lg:flex",children:i}),e[7]=i,e[8]=n):n=e[8],n},ye=t=>{"use forget";var j;const e=v.c(15),{cardId:o,onClose:r}=t,{data:s}=E();let i;e[0]!==(s==null?void 0:s.items)?(i=(j=s==null?void 0:s.items)!=null?j:[],e[0]=s==null?void 0:s.items,e[1]=i):i=e[1];const n=i.filter(J),[c,u]=k.useState(o);let f;e[2]!==c?(f=b=>b.id===c,e[2]=c,e[3]=f):f=e[3];const m=n.find(f),d=m!=null&&m.conversation_id?m.conversation_id:void 0;let a;e[4]!==c||e[5]!==n||e[6]!==d||e[7]!==u?(a=d?l.jsxs("div",{className:"relative flex h-full w-full",children:[l.jsx(be,{cards:n,activeCardId:c,onSelect:u}),l.jsx("div",{className:"flex h-full min-h-0 w-full flex-1 flex-col",children:l.jsx(fe,{clientThreadId:d,hideHeader:!0,hideDisclaimer:!0,isModalView:!0},d)})]}):null,e[4]=c,e[5]=n,e[6]=d,e[7]=u,e[8]=a):a=e[8];const x=a;if(!d)return null;const p=m==null?void 0:m.title;let h;e[9]===Symbol.for("react.memo_cache_sentinel")?(h=l.jsx(xe,{}),e[9]=h):h=e[9];let g;return e[10]!==d||e[11]!==r||e[12]!==p||e[13]!==x?(g=l.jsx(pe,{onClose:r,clientThreadId:d,testId:"modal-pulse-card-view",title:p,headerAccessory:h,contentClassName:"flex h-full",threadContent:x}),e[10]=d,e[11]=r,e[12]=p,e[13]=x,e[14]=g):g=e[14],g},Ce=3e3,_e=()=>{"use forget";const t=v.c(9),{mutate:e}=K();let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],t[0]=o):o=t[0];const r=k.useRef(o),s=k.useRef(null);let i;t[1]!==e?(i=()=>{r.current.length>0&&(e({events:r.current}),r.current=[])},t[1]=e,t[2]=i):i=t[2];const n=i;H(n,Ce);let c,u;t[3]!==n?(c=()=>{const p=W(window,{pagehide:()=>n(),beforeunload:()=>n(),visibilitychange:()=>n()});return()=>{p(),n()}},u=[n],t[3]=n,t[4]=c,t[5]=u):(c=t[4],u=t[5]),k.useEffect(c,u);let f;t[6]===Symbol.for("react.memo_cache_sentinel")?(f=p=>{s.current={cardId:p,openTimestamp:Date.now()}},t[6]=f):f=t[6];const m=f;let d;t[7]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{s.current&&(r.current.push({type:"read_expanded",card_id:s.current.cardId,dwell_time_seconds:(Date.now()-s.current.openTimestamp)/1e3,timestamp:new Date().toISOString()}),s.current=null)},t[7]=d):d=t[7];const a=d;let x;return t[8]===Symbol.for("react.memo_cache_sentinel")?(x={trackCardOpen:m,trackCardClose:a,trackCardImpression:h=>{r.current.push({type:"impression",card_id:h,dwell_time_seconds:0,timestamp:new Date().toISOString()})}},t[8]=x):x=t[8],x};function Se({cardId:t}){const e=O(),{mutate:o}=ee(t),{mutate:r}=te(t),{data:s}=se(t),i=(s==null?void 0:s.reaction)==="like",n=(s==null?void 0:s.reaction)==="dislike",c=s==null?void 0:s.conversation_id,u=c?Q(c):void 0,f=[{key:"upvote",icon:i?le:re,label:e.formatMessage({id:"wN6PjH",defaultMessage:"Like"}),onClick:()=>o(i?"remove":"like")},{key:"downvote",icon:n?oe:ne,label:e.formatMessage({id:"FMxx3D",defaultMessage:"Dislike"}),onClick:()=>o(n?"remove":"dislike")},{key:"share",icon:ie,label:e.formatMessage({id:"BNIqUa",defaultMessage:"Share"}),disabled:!u,onClick:()=>u&&V.openSharingModal(u)},{key:"save",icon:s!=null&&s.is_saved?he:ge,label:e.formatMessage({id:"Fy5DRu",defaultMessage:"Save"}),onClick:()=>r(s!=null&&s.is_saved?"unsave":"save")}];return l.jsx("div",{className:"text-token-text-secondary flex",children:f.map(m=>l.jsx(ae,{icon:m.icon,label:m.label,disabled:m.disabled,onClick:d=>{d.stopPropagation(),m.onClick()}},m.key))})}const we=t=>{"use forget";const e=v.c(7);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={threshold:.8,onlyOnce:!0},e[0]=o):o=e[0];const[r,s]=de(o);let i,n;e[1]!==r||e[2]!==t?(i=()=>{r&&t()},n=[r,t],e[1]=r,e[2]=t,e[3]=i,e[4]=n):(i=e[3],n=e[4]),k.useEffect(i,n);let c;return e[5]!==s?(c={ref:s},e[5]=s,e[6]=c):c=e[6],c};function Me(t){"use forget";const e=v.c(21),{cardId:o,title:r,description:s,imageUrl:i,onClick:n,onImpression:c}=t;let u;e[0]!==c?(u=()=>c(),e[0]=c,e[1]=u):u=e[1];const{ref:f}=we(u);let m;e[2]!==i?(m=l.jsx("div",{className:"flex h-40 flex-shrink-0 items-center justify-center",children:l.jsx("img",{src:i,className:"h-32 w-32 rounded-2xl object-cover shadow-lg"})}),e[2]=i,e[3]=m):m=e[3];let d;e[4]!==r?(d=l.jsx("div",{className:"text-xl font-medium",children:r}),e[4]=r,e[5]=d):d=e[5];let a;e[6]!==s?(a=l.jsx("div",{children:s}),e[6]=s,e[7]=a):a=e[7];let x;e[8]!==d||e[9]!==a?(x=l.jsxs("div",{className:"flex flex-col gap-1",children:[d,a]}),e[8]=d,e[9]=a,e[10]=x):x=e[10];let p;e[11]!==o?(p=l.jsx(Se,{cardId:o}),e[11]=o,e[12]=p):p=e[12];let h;e[13]!==x||e[14]!==p?(h=l.jsxs("div",{className:"flex flex-1 flex-col justify-between p-4",children:[x,p]}),e[13]=x,e[14]=p,e[15]=h):h=e[15];let g;return e[16]!==n||e[17]!==f||e[18]!==m||e[19]!==h?(g=l.jsxs("div",{className:"hover:bg-token-main-surface-secondary flex w-full cursor-pointer items-stretch gap-4 rounded-2xl transition-colors",onClick:n,ref:f,children:[m,h]}),e[16]=n,e[17]=f,e[18]=m,e[19]=h,e[20]=g):g=e[20],g}function Ne({body:t,dateTs:e,className:o}){const r=new Date(e*1e3).toLocaleDateString(void 0,{month:"long",day:"numeric"});return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:C("text-token-text-primary text-4xl",o),children:r}),l.jsx($,{children:t})]})}function $({children:t,includeDivider:e=!1}){return l.jsxs(l.Fragment,{children:[e&&l.jsx(_,{}),l.jsx("div",{className:C("text-token-text-primary py-2 text-xl font-medium",e&&"pt-8"),children:t})]})}function Ie({title:t,suggestions:e}){return l.jsxs(l.Fragment,{children:[l.jsx(_,{}),l.jsxs("div",{className:"flex flex-col gap-6 pt-6",children:[l.jsx("div",{className:"text-token-text-primary text-start text-xl font-medium",children:t}),l.jsx("div",{className:"flex w-full flex-col gap-2",children:l.jsx(ce,{suggestions:e,question:t})})]})]})}function Pe({title:t,body:e}){const{openModal:o}=U();return l.jsxs(l.Fragment,{children:[l.jsx(_,{}),l.jsxs("div",{className:"flex flex-col items-center gap-6 py-8",children:[l.jsx("div",{className:"bg-token-text-primary flex h-12 w-12 items-center justify-center rounded-full",children:l.jsx(ve,{className:"text-token-bg-primary"})}),l.jsxs("div",{className:"text-token-text-primary text-center text-xl font-medium",children:[t," ",l.jsx("br",{})," ",e]}),l.jsx(ke,{onClick:o})]})]})}var R;const _=q.div(R||(R=D(["border-token-border-medium border-b pb-8"])));function Te(){"use forget";const t=v.c(7),{openModal:e}=U();let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=l.jsx(X,{clientThreadId:A,hideNewChat:!0}),t[0]=o):o=t[0];let r;t[1]===Symbol.for("react.memo_cache_sentinel")?(r=l.jsx("h1",{className:"text-lg font-normal",children:l.jsx(y,{id:"I1hXU9",defaultMessage:"Pulse"})}),t[1]=r):r=t[1];let s;t[2]!==e?(s=l.jsx("div",{className:"h-header-height border-token-border-light bg-token-bg-primary sticky top-0 z-10 flex shrink-0 items-center border-b ps-6 pe-3",children:l.jsxs("div",{className:"flex grow items-center gap-2",children:[o,l.jsxs("div",{className:"flex w-full items-center justify-between",children:[r,l.jsx(je,{onClick:e})]})]})}),t[2]=e,t[3]=s):s=t[3];let i;t[4]===Symbol.for("react.memo_cache_sentinel")?(i=l.jsx(De,{}),t[4]=i):i=t[4];let n;return t[5]!==s?(n=l.jsxs("div",{className:"flex min-h-screen flex-col",children:[s,i]}),t[5]=s,t[6]=n):n=t[6],n}function De(){"use forget";var m;const t=v.c(15),{data:e}=E(),o=L(),{trackCardOpen:r,trackCardClose:s,trackCardImpression:i}=_e();ue(e==null?void 0:e.id);let n;t[0]!==(e==null?void 0:e.items)?(n=(m=e==null?void 0:e.items)!=null?m:[],t[0]=e==null?void 0:e.items,t[1]=n):n=t[1];const c=n;let u;if(t[2]!==o||t[3]!==c||t[4]!==s||t[5]!==i||t[6]!==r){let d;t[8]!==o||t[9]!==s||t[10]!==i||t[11]!==r?(d=(a,x)=>{var p,h,g,j,b,S,w,M,N,I,P;switch(a.content_type){case"header_with_date":return l.jsx(Ne,{body:a.body,dateTs:(p=a.date)!=null?p:0},x);case"commentary":return l.jsx($,{includeDivider:x>0,children:a.title},x);case"card":return l.jsx(Me,{cardId:a.id,imageUrl:(g=(h=a.image)==null?void 0:h.url)!=null?g:"",title:a.title,description:(j=a.preview_markdown_text)!=null?j:"",onImpression:()=>i(a.id),onClick:()=>{a.conversation_id&&(r(a.id),Y(o,ye,{cardId:a.id,onClose:s}))}},x);case"footer":return l.jsx(Pe,{title:(b=a.title)!=null?b:"",body:(S=a.body)!=null?S:""},x);case"survey":return l.jsx(Ie,{suggestions:(M=(w=a.survey_config)==null?void 0:w.prompt.suggestions)!=null?M:[],title:(P=(I=(N=a.survey_config)==null?void 0:N.content)==null?void 0:I.title)!=null?P:""},x);default:return null}},t[8]=o,t[9]=s,t[10]=i,t[11]=r,t[12]=d):d=t[12],u=c.map(d),t[2]=o,t[3]=c,t[4]=s,t[5]=i,t[6]=r,t[7]=u}else u=t[7];let f;return t[13]!==u?(f=l.jsx("div",{className:"mx-auto flex w-full max-w-3xl grow flex-col gap-4 px-4 py-12",children:u}),t[13]=u,t[14]=f):f=t[14],f}function Re(){const t=L();return me(t)?l.jsx(Fe,{}):l.jsx("div",{children:"No Access!"})}function Fe(){return l.jsx(Ae,{children:l.jsx(Te,{})})}function Ae({children:t}){return l.jsx(Z,{clientThreadId:A,setClientThreadId:()=>{},threadContent:t})}const ut=()=>null,mt=()=>!1,ft=z(function(){return l.jsx(Re,{})});export{ut as clientLoader,ft as default,mt as shouldRevalidate};
//# sourceMappingURL=j5cuomg46uqryl4h.js.map

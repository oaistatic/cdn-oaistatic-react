const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/d7ewkvaapz2odnhr.js","assets/n75kuy1cx6f5mogg.js","assets/ewse8exzafeu10ji.js","assets/root-l2v84m1w.css","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css","assets/fdv2df7jppwbz4po.js","assets/ce3hgmw4iyyhicud.js","assets/d5vv6ct7n3prp63a.js","assets/ctddpbsbr3gj60l1.js","assets/j2tluvxda4ll72qx.js","assets/npn63o3tt9liv4y2.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/je40yyidw4ukzc9u.js","assets/gvh5p107yczbfviz.js","assets/o423tfdeb6azgv8l.js","assets/cg9mamkqgsk8mjh0.js","assets/ns51nblw8ziscsgd.js","assets/ibchrxf1juu2j0jw.js","assets/iqk1tse6yz14y9t9.js","assets/ly9hghfho7bi4z70.js","assets/hrsgt0zeavq3ouip.js","assets/gvudnmdzjyrmv9hw.js","assets/e52t6kvr8rhywzf0.js","assets/peahhkmucc5rd7ov.js","assets/jiz6zc3ys9fjr045.js","assets/cl7dmrzdmwy44poc.js","assets/d0p97pwfptqt3nvy.js","assets/hkwix64yhkotslv1.js","assets/5hoqitp3r2hkdtny.js","assets/czwq62q5rbh9b1yi.js","assets/gowyl4x2bs7hfi4a.js","assets/em5q5yhbyv41ft0j.js","assets/irqko7c1s7qpl41n.js","assets/i3bw46mavo9n01l8.js","assets/ga8p3rr9o0mc72h0.js","assets/gbvlxp0nrrwdd6eq.js","assets/kj8rd4pu8k32z2dy.js","assets/d65yyyom1modmtdi.js","assets/fh2tsu8ocsi22jc3.js","assets/ou1s0kowmldvhx32.js","assets/co6h42pxywtlg2op.js","assets/bj1ejin6tzi0v3v8.js","assets/mnl5qjy02l9upyzg.js","assets/j3zgnwb11nmn5ark.js","assets/d3gl9smdb5iqto0t.js","assets/hy8iy5kkz96gp2o5.js","assets/pauhxwu99lgnazxx.js","assets/neqgr1r8uemp4194.js","assets/gva4acr7rlqtafux.js","assets/k5jwqq80a0png05z.js","assets/da0anzdj3bll2tbv.js","assets/mzj5jqjjpo006z7a.js","assets/nnb0v70g00lhjclz.js","assets/jaupzjmp9wknd4io.js","assets/jtxj1xvdu5i7mvdh.js","assets/j2ui4c2m3nj8pqst.js","assets/h2dwuj1m5ps9l7uv.js","assets/kg55sov6c624o43c.js","assets/lksc5q29mjlblqoo.js","assets/7pd84i0fdyounev7.js","assets/ca3g7gcaj954pu3h.js","assets/elomx9ae98due72j.js","assets/njvh3glmlpv82mn7.js","assets/l351nx0zzb742rw6.js","assets/j27sg7lrtao9b6kk.js","assets/3mp3j06lb1q5ttzm.js","assets/gy07ow2dyy5du4ny.js"])))=>i.map(i=>d[i]);
var us=Object.freeze,ps=Object.defineProperty,pt=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var ms=Object.getOwnPropertySymbols;var ht=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable;var fs=(s,t,n)=>t in s?ps(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,x=(s,t)=>{for(var n in t||(t={}))ht.call(t,n)&&fs(s,n,t[n]);if(ms)for(var n of ms(t))xt.call(t,n)&&fs(s,n,t[n]);return s},C=(s,t)=>pt(s,gt(t));var we=(s,t)=>us(ps(s,"raw",{value:us(t||s.slice())}));import{R as Ns,r as p,j as e,b as ee,u as As,d as xe,M as f,g as Me,t as vt,A as jt,m as Gs,D as yt,ae as Mt,i as bt}from"./n75kuy1cx6f5mogg.js";import{go as pe,bW as Ye,aR as ge,aS as be,iA as Ke,iB as Xe,at as qe,b2 as wt,dg as Pt,bN as Tt,bK as de,bp as kt,iy as _t,md as St,mf as J,bR as Ze,kU as Rs,bM as Ls,cj as Ct,sA as Us,nb as Fs,i as se,eJ as Je,qD as Os,qG as ze,aV as De,ch as It,eM as Nt,lf as At,br as Gt,bq as Rt,aZ as Lt,cl as Ut,d as Ie,h as Bs,f as ue,rp as es,qr as Ft,qn as Ot,bX as Bt,f8 as He,G as O,o as X,ba as Es,j as ye,C as ss,B as Te,qs as ke,ff as _e,T as ts,is as Et,F as ns,e as he,sB as qt,ro as zt,gN as Ht,fB as as,ex as le,fC as Wt,dv as $t,qo as Vt,dh as Qt,cw as Yt,pz as qs,pH as Kt,pA as zs,gk as Xt,pI as Zt,jT as We,pJ as Jt,lq as Hs,E as is,py as Dt,qE as Re,qF as Le,P as Ws,lp as en,r as rs,eI as sn,dG as tn,an as nn,k as an,fA as rn,fk as $s,ej as Vs,ek as Qs,fr as on,f4 as Se,aT as ln,jt as Ys,cS as cn,sC as dn,gI as un,d9 as gs,qx as mn,sD as fn,b as pn,gM as gn,bL as hn,sE as xn,sF as vn,bU as jn,bj as yn,L as hs,p as xs,j_ as Mn,fd as vs,fi as bn,fl as wn,fm as Pn,pM as Tn,b6 as js,ov as kn}from"./ewse8exzafeu10ji.js";import{gk as Ks,k7 as Xs,a as Zs,jl as Ne,jm as D,f$ as Js,jo as os,lw as _n,bJ as Ds,lP as et,rk as Sn,dm as Cn,c9 as st,aq as tt,bU as In,bv as Nn,jA as ce,rl as $e,jp as An,a5 as Gn,rm as Rn,fC as Ln,a2 as Un,rn as ys,h5 as Ms,ro as nt,rp as Fn,fL as at,cO as Ce,rq as it,jB as ne,jC as ae,jD as Ue,m4 as On,rr as Bn,jE as En,k9 as qn,rs as zn,fM as Hn,jF as Wn,rt as bs,ru as $n,nw as Vn,T as Qn,eY as Yn,rv as Kn,mC as Xn,c8 as Zn,jG as Jn,k6 as ws,rw as Dn,eL as ea,rx as Ps,r as sa,kY as ta,kZ as na,k_ as aa}from"./ny10lj7zpuz89fvf.js";import{i as ia,G as ra,A as je,M as rt,a as oa,b as Ts,s as la,c as ca,S as da,g as ua,d as ma}from"./hy8iy5kkz96gp2o5.js";import{M as ot}from"./gva4acr7rlqtafux.js";import{i as Ve}from"./elomx9ae98due72j.js";import{S as fa}from"./gbvlxp0nrrwdd6eq.js";import{G as pa}from"./pauhxwu99lgnazxx.js";import{C as ga}from"./njvh3glmlpv82mn7.js";import{S as ha}from"./l351nx0zzb742rw6.js";import{u as lt}from"./j2ui4c2m3nj8pqst.js";import{h as xa}from"./h2dwuj1m5ps9l7uv.js";import{a as va,G as ja}from"./j27sg7lrtao9b6kk.js";import{b as ya}from"./3mp3j06lb1q5ttzm.js";function Ma(s,t){const n=be(s),a=ge.getTree(n),i=[];let r=ge.getCurrentNode(n);for(;r!=null&&(t==null||r.id!==t);)i.unshift(r.message),r=r.parentId!==""?a.getNodeByIdOrMessageId(r.parentId):void 0;return i}function ba(s){return s.filter(a=>a.recipient==="gizmo_editor.update_behavior").flatMap(a=>a.content.content_type==="text"?a.content.parts:a.content.content_type==="code"?[a.content.text]:[]).map(a=>JSON.parse(a)).reduce((a,i)=>x(x({},a),i),{})}async function wa(s){let t;for(const n of s)if(n.author.name==="gizmo_editor.generate_profile_pic"){const a=kt.getImageAssetPointers(n);a.length>0&&(t=a.at(-1))}if(t!=null){const n=_t(t.asset_pointer),a=await Ke(n);if(a.status===Xe.Success)return{id:n,permalink:a.download_url}}}async function Pa(s,t,n,a){const i=Ma(t,a),r=ba(i);let l=await wa(i);if(Ve(r)&&l==null)return;const{name:u,context:o,description:c,profile_pic_file_id:P,prompt_starters:d}=r;if(P!=null)try{const j=await Ke(P,s.id);j.status===Xe.Success&&(l={id:P,permalink:j.download_url})}catch(j){qe.addError(new Error("Error while retrieving profile pic in update",{cause:j})),n.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const _={name:typeof u=="string"?u:void 0,description:typeof c=="string"?c:void 0,instructions:typeof o=="string"?o:void 0,promptStarters:Array.isArray(d)?d:void 0,profilePictureId:l==null?void 0:l.id,profilePictureUrl:l==null?void 0:l.permalink};return wt(_,j=>j!=null)}function Ta(s){var o,c,P;const t=new Set;for(const d of s.tools)t.add(d.type);const n=(o=s.name)!=null?o:"",a=(c=s.description)!=null?c:"",i=(P=s.instructions)!=null?P:"",r=Array.from(t).join(","),l=n===""&&a===""&&i==="",u=s.profilePictureUrl!=null;return l?"The GPT you are about to has the following abilities: ".concat(r,"."):"This is the GPT's current set of fields:\n\nname: ".concat(n,"\n\ndescription: ").concat(a,"\n\ncontext: ").concat(i,"\n\nabilities: ").concat(r,"\n\n").concat(u?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}const ka=10;function ct(s,t){var P,d,_,j,v,S,y,k,T,m,U;const n=s.current,a=t.current;if(Ye(n,a))return;const i={};n.name!==(a==null?void 0:a.name)&&(i.name=n.name),((P=n.description)!=null?P:"")!==((d=a==null?void 0:a.description)!=null?d:"")&&(i.description=(_=n.description)!=null?_:""),n.instructions!==((j=a==null?void 0:a.instructions)!=null?j:"")&&(i.context=(v=n.instructions)!=null?v:"");const r=new Set((y=(S=a==null?void 0:a.files)==null?void 0:S.map(h=>h.file_id))!=null?y:[]),l=new Set((T=(k=n.files)==null?void 0:k.map(h=>h.file_id))!=null?T:[]),u=((m=n.files)!=null?m:[]).filter(h=>!r.has(h.file_id)),o=((U=a==null?void 0:a.files)!=null?U:[]).filter(h=>!l.has(h.file_id));if(Ve(i)&&u.length===0&&o.length===0)return;const c=[];if(!Ve(i)){const h="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(i,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');c.push(pe(h))}if(o.length>0&&c.push(pe("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(o.map(h=>h.file_id).join(", ")))),u.length>0){const h=u.slice(0,ka);c.push(pe("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(h.map(L=>L.file_id).join(", ")),{attachments:h.map(L=>({id:L.file_id,name:L.name,size:L.size}))}))}return c}function _a(s){if(s.length===0)return;const t="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(s.map(n=>'"'.concat(n.fileId,'"')).join(", "));return[pe(t)]}function Sa(s){const t="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.";if(!ge.findNode(be(s),a=>a.message.content.content_type==="text"&&a.message.content.parts[0]===t))return[pe(t)]}function Ca(s,t){var r,l;const{session:n}=Pt();Tt.initThread({clientThreadId:s,conversationMode:{kind:de.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:t},userId:(r=n==null?void 0:n.user)==null?void 0:r.id,accountId:(l=n==null?void 0:n.account)==null?void 0:l.id});const a=Ks(s);return async(u,o,c,P)=>{a({sourceEvent:u,promptMessage:pe(P),prependMessages:ct(o,c),completionMetadata:{conversationMode:{kind:de.GizmoMagicCreate,gizmo_id:o.current.id,behavior_overrides:t}}})}}const Ia="Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response.";function Na(s,t){p.useEffect(()=>{ge.findNode(be(s),a=>At(a.message)||a.message.author.role===Gt.System&&a.message.content.content_type===Rt.Text)||De(s,a=>{Lt.updateTree(a,(i,r)=>{const l=i.findNode(u=>{var o;return((o=u.message.clientMetadata)==null?void 0:o.isPlaceholderTemplateAssistantWelcomeMessage)===!0},r);return l&&(l.id===r&&(r=i.rootId),i.deleteNode(l.id)),t?i.addMessageNode(r,Ut(t,void 0,{isPlaceholderTemplateAssistantWelcomeMessage:!0})):r})})},[s,t])}function Aa(s,t,n){var u;const a=se(),{data:i}=Je(),r=(u=i==null?void 0:i.models.get(Os))!=null?u:i&&Xs(i.models.values(),o=>o.tags.includes(ze.GPT_4o));Zs(s,{kind:de.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:n},{forcedModelId:r==null?void 0:r.id}),p.useEffect(()=>{De(s,o=>{var c;o.mode={kind:de.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:It(n)},Nt(a)||(o.modelId=(c=r==null?void 0:r.id)!=null?c:o.modelId)})},[a,s,t.id,n,r,i]);const[l]=p.useState(()=>{const o=t.id==null,c=t.id!=null&&t.name!==""&&t.description!=null&&t.instructions!==""&&t.profilePictureUrl!=null;return o?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':c?"Welcome back! Is there anything ".concat(t.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});Na(s,l)}function Ga({gizmoEditorData:s,updateGizmo:t,clientThreadId:n,gizmoEditorDataRef:a,magicMakerBehaviorOverrides:i,magicMakerConversationGizmoEditorDataRef:r,requireGizmoId:l}){const u=p.useRef(l);u.current=l;const o=p.useMemo(()=>({gizmoEditorData:s,gizmoId:s.id,mode:"magic",behaviorOverrides:i,getGizmoId:u.current}),[s,i]),c=St(d=>d.files.filter(_=>_.status===J.Ready&&_.gizmoId!=null)),P=p.useCallback(d=>{var _,j,v,S,y;if(t(k=>{var T;return C(x({},k),{files:[...(T=k.files)!=null?T:[],...Ze(c.map(m=>{var U;return m.fileId!=null&&{file_id:m.fileId,name:m.file.name,size:m.file.size,type:Rs(m.file),last_modified:m.file.lastModified,file_size_tokens:(U=m.fileSpec)==null?void 0:U.fileTokenSize}}))]})}),r.current=Ls(a.current),!d.completionType||d.completionType===Ct.Next){const k=ge.getCurrentNode(be(n)),T=(_=k.message.clientMetadata)!=null&&_.isPlaceholderTemplateAssistantWelcomeMessage?k.message:void 0;T&&(d.existingMessages=[T]),d.prependMessages=[...(j=_a(c))!=null?j:[],...(v=ct(a,r))!=null?v:[],...(S=Sa(n))!=null?S:[],...(y=d.prependMessages)!=null?y:[]]}return d},[n,c,a,r,t]);return e.jsx(Us.Provider,{value:o,children:e.jsx("div",{className:"relative flex h-full grow overflow-auto",children:e.jsx("div",{className:"grow",children:e.jsx(Fs,{clientThreadId:n,children:e.jsx(ot,{clientThreadId:n,withCustomCompletionParams:P,hideHeader:!0})})})})})}const Ra=Ns.memo(Ga);function La({gizmo:s,updateGizmo:t,publishedGizmo:n,promoteGizmo:a,appealGizmo:i,setAppealState:r,showActionsModal:l,shareOnly:u,onClose:o}){const[c,P]=p.useState({type:"privacy"});return c.type==="privacy"?e.jsx(Fa,{gizmo:s,updateGizmo:t,publishedGizmo:n,promoteGizmo:a,appealGizmo:i,setAppealState:r,setStep:P,showActionsModal:l,shareOnly:u,onClose:o}):e.jsx(Oa,{publishedGizmo:c.publishedGizmo,onClose:o})}function Ua(s){return s?O.Workspace:O.Link}function Fa({gizmo:s,publishedGizmo:t,updateGizmo:n,promoteGizmo:a,appealGizmo:i,setAppealState:r,setStep:l,showActionsModal:u,shareOnly:o,onClose:c}){var te,Q,re,me,fe;const P=se(),[d,_]=p.useState(!1),j=Ie(Bs.isBusinessWorkspace),v=ee(),S=ue(),[y,k]=p.useState(es(s)?Ua(!!j):s.sharingRecipient),T=As(),m=ia(y,s.sharingTargets),{data:U,isLoading:h}=Ft(),L=Ot(),[M,I]=p.useState(t!=null&&t.gizmo.display.categories.length>0?(Q=(te=L.data)==null?void 0:te.categories.find(w=>w.id===t.gizmo.display.categories[0]))==null?void 0:Q.id:void 0);p.useEffect(()=>{I(t==null?void 0:t.gizmo.display.categories[0])},[t==null?void 0:t.gizmo.display.categories]);const[N,W]=p.useState(void 0),F=p.useRef(Bt((w,H)=>He.generateCategory(w,H),1e3)),E=U!=null&&U.is_verified?void 0:v.formatMessage({id:"qUMu4e",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile in the user settings page."});y===O.Marketplace&&E!=null&&!h&&k(O.Link);const V=j&&!((re=s.sharingTargets)!=null&&re.some(w=>w.recipient===O.Link)),B=Ne(s,y,M),q=B.includes(D.MissingPublicActionPrivacyPolicyURL),Y=s.tools.find(w=>w.type===X.JIT_PLUGIN&&!w.metadata.privacy_policy_url),g=Ie(w=>w.currentWorkspace),A=Es();p.useEffect(()=>{let w=!0;return(async()=>{try{if(M!=null)return;const H=await F.current(s.name,s.instructions);w&&M==null&&(H?I(H.id):W(!0))}catch(H){w&&M==null&&W(!0)}})(),()=>{w=!1}},[s.instructions,s.name,A,M]);const $=ye(P,"4226692983");return e.jsx(ss,{testId:"modal-simple-share-gizmo",type:"success",isOpen:!0,onClose:c,title:e.jsx(f,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:m?e.jsx(Te,{color:"primary",disabled:B.length>0,loading:d,onClick:async()=>{try{if(_(!0),o){if(!(t!=null&&t.gizmo.id)){S.danger(v.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}),{toastId:"simple_share_gizmo_modal",loggingTitle:"Error sharing GPT",loggingDescription:"Error message when GPT ID is missing (shouldn't happen)"});return}const w=await He.shareGizmo(t.gizmo.id,M?{sharing:ke(y,[],_e),categories:[M]}:{sharing:ke(y,[],_e)});w.error?(S.warning(v.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),n({sharingTargets:w.sharing_targets}),r({gizmoId:t.gizmo.id,sharingRecipient:y,categories:t.gizmo.display.categories,moderationType:rt.PublishBlocked,sharingTargets:w.sharing_targets,showModal:je.AppealAvailable})):(T.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],H=>w.resource),n(H=>C(x({},H),{sharingRecipient:y})),S.success(v.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),c())}else{const w=await a({recipient:y,subjects:ke(y,[],_e)},M);w?(l({type:"published",publishedGizmo:w}),n(H=>C(x({},H),{id:w.gizmo.id,sharingRecipient:y})),w.gizmo.live_version!=null&&n({liveVersion:w.gizmo.live_version}),S.success(v.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(S.warning(v.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),c())}}finally{_(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(f,{id:"SW4DG4",defaultMessage:"Save"})}):$?e.jsx(e.Fragment,{children:e.jsx(Te,{color:"primary",onClick:async()=>{await i(y,M)},children:e.jsx(f,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:t?e.jsx(Te,{color:"secondary",onClick:w=>os(P,t,S,w,v.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(f,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(Js,{value:y,onValueChange:w=>k(w),children:[s.sharingTargets&&s.sharingTargets.map((w,H)=>e.jsx(Fe,{value:w.recipient,disabled:w.recipient===O.Marketplace&&E!=null,tooltipText:w.recipient===O.Marketplace?E!=null?E:v.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:w.recipient},H)),V&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{value:O.Link,disabled:!0,tooltipText:v.formatMessage(ks.workspaceDisabledHint),shareLevel:O.Link,workspaceName:g==null?void 0:g.name}),e.jsx(Fe,{value:O.Link,disabled:!0,tooltipText:v.formatMessage(ks.workspaceDisabledHint),shareLevel:O.Marketplace,workspaceName:g==null?void 0:g.name})]})]})}),q&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(f,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:w=>e.jsx("button",{onClick:()=>{u(Y==null?void 0:Y.metadata.action_id)},className:"underline",children:w})}})}),y!==O.Private&&e.jsx(ra,{gizmo:s,category:M,categories:y===O.Marketplace?(fe=(me=L.data)==null?void 0:me.categories)!=null?fe:[]:void 0,onCategoryChange:y===O.Marketplace?w=>I(w.id):void 0}),y===O.Marketplace&&(N?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(f,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!m&&$&&e.jsx("div",{className:"text-token-text-secondary flex items-center justify-between text-sm",children:e.jsx(f,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function Oa({publishedGizmo:s,onClose:t}){const n=se(),a=_n(n,s),i=ee(),r=ue();return e.jsx(ss,{testId:"modal-simple-share-published",type:"success",isOpen:!0,onClose:t,title:e.jsx(f,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(Te,{color:"primary",as:"link",to:a,children:e.jsx(f,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex gap-1 rounded-sm px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 break-all text-ellipsis",children:a}),e.jsx("button",{onClick:l=>{os(n,s,r,l,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary hover:text-token-text-primary transition","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Ds,{className:"icon-sm"})})]})})})}const ks=xe({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function Fe({shareLevel:s,workspaceName:t,value:n,disabled:a=!1,tooltipText:i}){const r=p.useId();return e.jsx(ts,{disabled:i==null,label:i,side:"top",triggerAs:null,children:e.jsxs(et,{id:r,value:n,disabled:a,className:"hover:bg-token-main-surface-secondary flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold",children:[e.jsx("label",{htmlFor:r,className:"flex cursor-pointer items-center gap-1",children:e.jsx(oa,{shareLevel:s,workspaceName:t!=null?t:"",hasInviteSharing:!1})}),e.jsx(Sn,{children:e.jsx(Et,{className:"icon-lg me-1"})})]})})}function Qe(s){return!!(s&&typeof s=="object"&&"gizmo"in s)}function dt(s){window.history.length>1?s(-1):s(qt())}function Ba({gizmo:s,publishedGizmo:t,isUpsertLoading:n,isPromoteLoading:a,isUploadingProfilePic:i,isGeneratingProfilePic:r,updateGizmo:l,promoteGizmo:u,appealGizmo:o,setAppealState:c,showActionsModal:P}){var U;const d=se(),_=$t(),j=p.useMemo(()=>{const h=[];return(s==null||a||n)&&h.push(D.Loading),s!=null&&h.push(...Ne(s)),i&&h.push(D.UploadingProfilePic),r&&h.push(D.GeneratingProfilePic),h},[s,a,n,i,r]),v=es(s),S=h=>{requestAnimationFrame(()=>Yt(d,_!=null&&_.isWorkspaceAccount()?da:La,{gizmo:s,publishedGizmo:t,promoteGizmo:u,appealGizmo:o,setAppealState:c,showActionsModal:P,updateGizmo:l,shareOnly:h==="share"}))},[y,k]=p.useState(!1),T=s.sharingRecipient?Ts[s.sharingRecipient]:Ts.private,m=a||n;return e.jsxs(e.Fragment,{children:[v?e.jsx(ce,{color:"primary",onClick:()=>S("promote"),loading:j.length>0&&j.every(h=>[D.Loading,D.UploadingProfilePic,D.GeneratingProfilePic].includes(h)),disabled:m||s.id===void 0||j.length>0,tooltip:j.length>0?j.map($e).join("\n"):void 0,"data-testid":"gizmo-editor-create-gpt-button",children:e.jsx(f,{id:"svUGIb",defaultMessage:"Create"})}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{color:"secondary",loading:a||!t,disabled:m,icon:T,onClick:()=>S("share"),children:e.jsx(f,{id:"aXKW4G",defaultMessage:"Share"})}),e.jsx(ce,{color:"primary",onClick:async()=>{var N;let h=s.sharing.subjects.map(la);const L=Vt(s.sharing.subjects);h=ke(s.sharing.recipient,h,(N=L==null?void 0:L.capabilities)!=null?N:_e);const M=t&&Qe(t)?t.gizmo.display.categories[0]:void 0;await u({recipient:s.sharing.recipient,subjects:h},M)&&k(!0)},loading:n||!t,disabled:m||j.length>0,tooltip:j.length>0?j.map($e).join("\n"):void 0,children:e.jsx(f,{id:"84QVoj",defaultMessage:"Update"})})]}),y&&t&&e.jsx(ca,{publishedGizmo:t,sharing:Qe(t)?t.gizmo.sharing:void 0,onClose:()=>k(!1),workspaceName:(U=_==null?void 0:_.data.name)!=null?U:""})]})}function Ea({gizmoEditorData:s,publishedGizmo:t,revertDraft:n}){var _;const a=se(),i=ee(),r=ue(),l=Me(),[u,o]=p.useState(!1),{canDelete:c}=zt(t),{canCreate:P}=Ht();return!(t||n||s!=null&&s.id&&s.liveVersion>0||c)?null:e.jsxs(e.Fragment,{children:[e.jsxs(as,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:e.jsx(ce,{color:"ghost",icon:Wt}),children:[t!=null&&e.jsxs(le.Item,{onClick:j=>{os(a,t,r,j)},children:[e.jsx(tt,{className:"icon-sm"}),e.jsx(f,x({},ie.copyLink))]}),n!=null&&e.jsxs(le.Item,{onClick:()=>{window.confirm(i.formatMessage(ie.revertConfirm))&&n()},children:[e.jsx(In,{className:"icon-sm"}),e.jsx(f,{id:"W2blnV",defaultMessage:"Revert..."})]}),(s==null?void 0:s.id)!=null&&s.liveVersion>0&&e.jsxs(e.Fragment,{children:[e.jsxs(le.Item,{onClick:()=>{l("/g/".concat(s.id,"/view"))},children:[e.jsx(fa,{className:"icon-sm"}),e.jsx(f,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),P&&e.jsxs(le.Item,{onClick:async()=>{const j=await He.copyGizmo({gizmoId:s.id});j.gizmo.id&&l("/gpts/editor/".concat(j.gizmo.id))},children:[e.jsx(Ds,{className:"icon-sm"}),e.jsx(f,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),t&&Qe(t)&&((_=t.gizmo.current_user_permission)==null?void 0:_.can_delete)&&e.jsxs(le.Item,{color:"danger",onClick:()=>{o(!0)},children:[e.jsx(Nn,{className:"icon-sm"}),e.jsx(f,{id:"tNrOLG",defaultMessage:"Delete GPT"})]})]}),u&&e.jsx(pa,{gizmoId:(s==null?void 0:s.id)||"",onSuccess:()=>dt(l),onClose:()=>{o(!1)}})]})}var Ss;const Pe=ns.div(Ss||(Ss=we(["flex items-center gap-1"])));function qa({gizmoEditorData:s}){const t=Ie(n=>{var a;return(a=n.currentWorkspace)==null?void 0:a.name});switch(s.sharingRecipient){case O.Private:return e.jsxs(Pe,{children:[e.jsx(Qt,{className:"icon-xs"}),e.jsx(f,x({},ie.onlyMe))]});case O.Link:return e.jsxs(Pe,{children:[e.jsx(tt,{className:"icon-xs"}),e.jsx(f,x({},ie.anyoneWithLink))]});case O.Workspace:return e.jsxs(Pe,{children:[e.jsx(Gn,{className:"icon-xs"}),t]});case O.Marketplace:return e.jsxs(Pe,{children:[e.jsx(An,{className:"icon-xs"}),e.jsx(f,x({},ie.public))]});default:return e.jsx("div",{})}}function za({gizmoEditorData:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[s.profilePictureUrl!=null?e.jsx(st,{isFirstParty:!1,src:s.profilePictureUrl,className:"h-8 w-8"}):e.jsx("div",{className:"border-token-border-medium h-8 w-8 rounded-full border-2 border-dashed"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:s.name||e.jsx(f,x({},ie.newGPT))}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:es(s)?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-token-text-tertiary h-1.5 w-1.5 rounded-full"}),e.jsx(f,x({},ie.draft))]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-brand-green h-1.5 w-1.5 rounded-full"}),s.sharingRecipient===O.Marketplace?e.jsx(f,x({},ie.published)):e.jsx(f,{id:"gizmoEditorHeader.live",defaultMessage:"Live"}),e.jsx(f,C(x({},ie.dotSeparator),{tagName:"span"})),e.jsx(qa,{gizmoEditorData:s})]})})]})]})}var Cs;const Ha=ns.div(Cs||(Cs=we(["\n  cursor-pointer\n  border-b\n  pb-[1px]\n  pt-[2px]\n  text-sm\n  text-token-text-secondary\n  hover:border-token-border-xheavy\n  hover:text-token-text-primary\n  mx-2\n"])));function Wa({gizmoEditorData:s,isUpsertLoading:t,isPromoteLoading:n,isUploadingProfilePic:a,isGeneratingProfilePic:i,publishedGizmo:r,updateGizmo:l,promoteGizmo:u,appealGizmo:o,setAppealState:c,revertDraft:P,draftMessage:d,className:_,hasUnpublishedChanges:j,showActionsModal:v}){var y,k;const S=Me();return e.jsxs("div",{className:he("border-token-border-medium relative flex h-14 w-full items-center justify-between gap-2 border-b px-3",_),children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("a",{className:"text-token-text-primary cursor-pointer",onClick:()=>dt(S),children:e.jsx(Cn,{className:"icon"})}),e.jsx(za,{gizmoEditorData:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&((k=(y=r==null?void 0:r.gizmo)==null?void 0:y.live_version)!=null?k:0)>1&&e.jsx(Ha,{onClick:()=>S("/g/".concat(s.id,"/view")),children:e.jsx(f,{id:"P0Ri/k",defaultMessage:"Last edited {date}",values:{date:e.jsx(vt,{value:r.gizmo.updated_at,day:"numeric",month:"short",year:new Date(r.gizmo.updated_at).getFullYear()===new Date().getFullYear()?void 0:"numeric"})}})}),d,e.jsx(Ea,{gizmoEditorData:s,publishedGizmo:r,revertDraft:P}),e.jsx(Ba,{gizmo:s,publishedGizmo:r,isUpsertLoading:t,isPromoteLoading:n,isUploadingProfilePic:a,isGeneratingProfilePic:i,updateGizmo:l,promoteGizmo:u,appealGizmo:o,setAppealState:c,hasUnpublishedChanges:j,showActionsModal:v})]})]})}const ie=xe({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},dotSeparator:{id:"gizmo.dotSeparator",defaultMessage:"·"}}),$a=512;function Va(){return e.jsx("div",{className:"border-token-border-medium relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:e.jsx(is,{className:"h-1/4 w-1/4"})})}function Qa({gizmoEditorData:s,onFileChange:t,generateProfilePic:n,isGeneratingProfilePic:a,setIsGeneratingProfilePic:i}){const r=ee(),l=ue(),[u,o]=p.useState(void 0),c=p.useRef(t);p.useEffect(()=>{c.current=t});async function P(j){if(j.length>0){i(!1);const v=await Zt(j[0],$a),S=We(v);o({tempId:S,file:v,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),c.current("uploading"),Jt(S,v,r,l,Hs.ProfilePicture,{onFileCreated(y,k,T){o(m=>m!=="initial"&&(m==null?void 0:m.tempId)===y&&m.status===J.Uploading?C(x({},m),{progress:10,fileId:k,cdnUrl:T}):m)},onFileUploadProgress(y,k){o(T=>T!=="initial"&&(T==null?void 0:T.tempId)===y&&T.status===J.Uploading?C(x({},T),{progress:k}):T)},onFileUploaded(y,k,T){o(m=>m!=="initial"&&(m==null?void 0:m.tempId)===y?(c.current(m),C(x({},m),{status:J.Ready,progress:100,fileSpec:x({name:m.file.name,id:m.fileId,size:m.file.size},T!=null?T:{})})):m)},onError(y){o(k=>{if(k!=="initial"&&(k==null?void 0:k.tempId)===y){c.current(void 0);return}return k})}})}}const{open:d,getInputProps:_}=lt(x({disabled:!1,noClick:!0,onDropAccepted:P,onDropRejected:j=>xa(j,r,l,Xt.ProfilePicture),multiple:!0,maxSize:zs},qs(Kt)));return e.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[e.jsxs(as,{sideOffset:8,triggerButton:e.jsx("button",{className:"h-20 w-20",children:a?e.jsx(Va,{}):u!=null&&u!="initial"&&u.status!=J.Ready?e.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[e.jsx(Rn,{file:u.file}),u.status===J.Uploading&&u.progress<90?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:e.jsx(Ln,{percentage:u.progress,className:"h-6 w-6"})}):null]}):(s==null?void 0:s.profilePictureUrl)!=null&&(s==null?void 0:s.profilePictureUrl)!==""?e.jsx(st,{isFirstParty:!1,src:s.profilePictureUrl}):e.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:e.jsx(Un,{className:"text-4xl"})})}),children:[e.jsx(le.Item,{onClick:d,children:e.jsx(f,{id:"ERQwXg",defaultMessage:"Upload Photo"})}),e.jsx(le.Item,{onClick:n,children:e.jsx(f,{id:"NXAog/",defaultMessage:"Use DALL·E"})})]}),e.jsx("input",x({},_()))]})}function Ya({gizmoEditorData:s,requireGizmoId:t,currentModelConfig:n,updateGizmo:a}){var L;const i=ee(),r=ue(),[l,u]=p.useState(0),o=p.useRef(new Map),c=Dt(n,void 0),P=async M=>{Ws.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const I=await t();M.length>0&&await Promise.all(M.map(N=>{const W=We(N);o.current.set(W,{tempId:W,gizmoId:I,file:N,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),en(We(N),N,i,r,{kind:Hs.Gizmo,gizmoId:I},{onFileUploaded:(F,E,V,B)=>{const q=o.current.get(F);q==null||q.fileId==null||(a(Y=>{var g,A;return C(x({},Y),{files:[...(g=Y.files)!=null?g:[],{file_id:q.fileId,name:q.file.name,size:q.file.size,type:(A=B==null?void 0:B.mimeType)!=null?A:Rs(N),last_modified:q.file.lastModified,file_size_tokens:B==null?void 0:B.fileTokenSize}]})}),o.current.delete(F),u(Y=>Y+1))},onFileCreated:(F,E,V)=>{o.current.set(F,C(x({tempId:F,gizmoId:I,file:N,status:J.Uploading,progress:1},o.current.get(F)),{fileId:E,cdnUrl:V})),u(B=>B+1)},onFileUploadProgress:(F,E)=>{const V=o.current.get(F);(V==null?void 0:V.status)===J.Uploading&&o.current.set(F,C(x({},V),{progress:E})),u(B=>B+1)},onError:F=>{o.current.delete(F)}},{usesRetrievalIndex:n!=null&&Re(n,N.type,N.name)===Le.Retrieval})}))},{getInputProps:d,open:_}=lt(x({disabled:!1,noClick:!0,onDropAccepted:P,multiple:!0,maxSize:zs,maxFiles:10},qs(c))),j=(L=s==null?void 0:s.files)!=null?L:[];function v(M){return e.jsx(Ms,{onRemoveFileClick:()=>{o.current.delete(M.tempId),u(I=>I+1)},file:M.file,loadingPercentage:M.status===J.Uploading?M.progress:void 0},M.tempId)}function S(M){return e.jsx(Ms,{file:M.name,fileId:M.file_id,onRemoveFileClick:()=>a(I=>{var N;return C(x({},I),{files:(N=I==null?void 0:I.files)==null?void 0:N.filter(W=>W.file_id!==M.file_id)})}),gizmoId:s==null?void 0:s.id},M.file_id)}const y=Array.from(o.current.values()).filter(M=>j.every(I=>I.file_id!==M.fileId)),[k,T]=ys(y,M=>n!=null&&Re(n,M.file.type,M.file.name)===Le.CodeInterpreter),[m,U]=ys(j,M=>n!=null&&M.type!=null&&Re(n,M.type,M.name)===Le.CodeInterpreter),h=p.useRef(m.length);return p.useEffect(()=>{m.length>h.current&&a(M=>{var I,N;return(I=M.tools)!=null&&I.some(W=>W.type===X.PYTHON)?M:C(x({},M),{tools:[...(N=M.tools)!=null?N:[],{type:X.PYTHON}]})}),h.current=m.length},[m.length]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"text-token-text-tertiary rounded-lg text-xs",children:e.jsx(f,x({},Ka.knowledgeWarning))}),T.length>0||U.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(v),U.map(S)]}):null,k.length>0||m.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:e.jsx(f,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[k.map(v),m.map(S)]})]}):null,e.jsx("div",{children:e.jsxs(ce,{onClick:_,children:[e.jsx("input",x({},d())),e.jsx(f,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const Ka=xe({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT can potentially reveal part or all of the files uploaded."}});function Xa({placeholder:s,text:t,onChange:n,onClose:a}){return e.jsxs(ss,{testId:"modal-gizmo-editor-form",className:"max-h-[100vh]! max-w-[80vw]!",type:"success",isOpen:!0,onClose:a,primaryButton:e.jsx(ce,{onClick:a,children:e.jsx(f,{id:"FeFVdS",defaultMessage:"Close"})}),children:[e.jsx("textarea",{className:"bg-token-main-surface-primary h-[70vh] w-full resize-none rounded-lg dark:border-gray-700",value:t,onChange:i=>{n(i.target.value)},placeholder:s}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,x({},nt.instructionsWarning))})]})}var Is;const Oe=ns.div(Is||(Is=we(["text-sm text-red-500"])));function Za({children:s,collapsed:t,initial:n}){return e.jsx(jt,{initial:n,children:!t&&e.jsx(Gs.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:s})})}function Ja({gizmo:s,onShowActionsEditor:t,isDisabled:n}){var l,u,o;const a=ee(),i=ue(),r=e.jsxs("div",{className:"space-y-1",children:[(l=s==null?void 0:s.tools)==null?void 0:l.map((c,P)=>{var d;return c.type!==X.JIT_PLUGIN?null:e.jsxs("div",{children:[e.jsx(Wn,{isDisabled:n,actionTool:c,onShowActionsEditor:()=>t(c.metadata.domain)}),((d=c.metadata.auth)==null?void 0:d.type)==="oauth"&&e.jsx(ga,{label:a.formatMessage(z.callbackUrlLabel),value:"https://chat.openai.com/aip/".concat(c.metadata.action_id,"/oauth/callback"),onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},P)}),((o=(u=s==null?void 0:s.tools)==null?void 0:u.filter(c=>c.type===X.JIT_PLUGIN))!=null?o:[]).length>=bs?e.jsx("div",{children:a.formatMessage(z.maxActionsReached,{number:bs})}):e.jsx(ce,{disabled:n,onClick:()=>{t("Unknown domain")},className:"mt-2",children:e.jsx(f,x({},z.createActionLabel))})]});return n?e.jsx(ts,{side:"top",label:a.formatMessage(z.disabledCustomActionsTooltip),children:r}):r}function Da(s){var t,n,a;return((n=(t=s.files)==null?void 0:t.length)!=null?n:0)>0||((a=s==null?void 0:s.tools)==null?void 0:a.some(i=>i.type===X.JIT_PLUGIN))}function ei({gizmoEditorData:s,updateGizmo:t,currentModelConfig:n,generateProfilePic:a,setIsUploadingProfilePic:i,isGeneratingProfilePic:r,setIsGeneratingProfilePic:l,requireGizmoId:u,onShowActionsEditor:o}){var W,F,E,V,B,q,Y;const c=(W=s==null?void 0:s.tools)!=null?W:[],[P,d]=p.useState(!1),[_,j]=p.useState(!0),v=(F=s==null?void 0:s.promptStarters)!=null?F:[],S=[...v,...v.length<Fn?[""]:[]],y=Ne(s),k=se(),T=rs(k),m=T==null?void 0:T.isWorkspaceAccount(),U=at(Ce.WorkspaceGPTCustomActions),h=ee(),{data:L}=Je({isGizmo:!0}),M=ye(k,"1854238036"),{gizmoModelsData:I}=sn(),N=I!=null&&I.editor?it((E=s==null?void 0:s.tools)!=null?E:[])?I.editor.models_list_with_custom_actions:I.editor.models_list:[];return e.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[e.jsxs("div",{className:"grow",children:[e.jsxs(ne,{children:[e.jsx(Qa,{gizmoEditorData:s,generateProfilePic:a,isGeneratingProfilePic:r,setIsGeneratingProfilePic:l,onFileChange:async g=>{if(g!=null&&g!=="uploading"&&g.fileId!=null){const A=await Ke(g.fileId);A.status===Xe.Success&&t({profilePictureId:g.fileId!=null?g.fileId:void 0,profilePictureUrl:A.download_url})}else t({profilePictureId:void 0,profilePictureUrl:void 0});i(g==="uploading")}}),e.jsx(ae,{label:e.jsx(f,{id:"M4dZms",defaultMessage:"Name"}),description:e.jsx(f,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),e.jsx(Ue,{type:"text",placeholder:h.formatMessage(z.gptNamePlaceholder),value:(V=s==null?void 0:s.name)!=null?V:"",onChange:g=>{t({name:g.target.value})},onBlurCapture:()=>t(g=>C(x({},g),{name:g.name.trim()})),"data-testid":"gizmo-name-input"}),y.includes(D.GizmoNameTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,C(x({},z.nameTooLong),{values:{length:On}}))}):null]}),e.jsxs(ne,{className:"mt-4",children:[e.jsx(ae,{label:e.jsx(f,{id:"YDzNvf",defaultMessage:"Description"}),description:e.jsx(f,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),e.jsx(Ue,{type:"text",placeholder:h.formatMessage(z.descriptionPlaceholder),value:(B=s==null?void 0:s.description)!=null?B:"",onChange:g=>t({description:g.target.value}),onBlurCapture:()=>t(g=>{var A,$;return C(x({},g),{description:($=(A=g.description)==null?void 0:A.trim())!=null?$:""})}),"data-testid":"gizmo-description-input"}),y.includes(D.GizmoDescriptionTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,C(x({},z.descriptionTooLong),{values:{length:Bn}}))}):null]}),e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:h.formatMessage(z.instructionsSubtitle)}),e.jsxs("div",{className:"relative",children:[e.jsx(En,{className:"resize-none",rows:8,value:s==null?void 0:s.instructions,onChange:g=>t({instructions:g.target.value}),onBlurCapture:()=>t(g=>C(x({},g),{instructions:g.instructions.trim()})),placeholder:h.formatMessage(z.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),e.jsx("button",{className:"text-token-text-tertiary absolute end-2 bottom-3",onClick:()=>d(!0),children:e.jsx(ha,{className:"icon-sm"})})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,x({},nt.instructionsWarning))}),y.includes(D.GizmoInstructionsTooLong)?e.jsx(Oe,{className:"mt-1",children:e.jsx(f,C(x({},z.instructionsTooLong),{values:{length:qn}}))}):null]}),e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:e.jsx(f,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),e.jsx("div",{className:"flex flex-col gap-1",children:S.map((g,A)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ue,{className:"rounded-e-none",value:g,type:"text",maxLength:zn,onChange:$=>{const te=$.target.value;t(Q=>{var re;return C(x({},Q),{promptStarters:Ze(A>=((re=v.length)!=null?re:0)?[...v!=null?v:[],te]:v.map((me,fe)=>fe===A?te===""?void 0:te:me))})})}}),e.jsx("button",{className:"border-token-border-medium flex h-9 w-9 items-center justify-center rounded-lg rounded-s-none border border-s-0",onClick:()=>t($=>C(x({},$),{promptStarters:v.filter((te,Q)=>Q!==A)})),children:e.jsx(tn,{className:"icon-sm"})})]},A))})]}),e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:h.formatMessage(z.knowledgeExplanation)}),e.jsx(Ya,{gizmoEditorData:s,requireGizmoId:u,currentModelConfig:n,updateGizmo:t})]}),M&&L&&e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx(f,{id:"wnVs4X",defaultMessage:"Recommended Model"}),e.jsx(va,{description:e.jsx(f,x({},z.recommendedModelExplainer))})]})}),e.jsx("div",{style:{fontSize:"12px",color:"var(--gray-600)",marginTop:"4px",marginBottom:"8px"},children:e.jsx(f,x({},z.recommendedModelDescriberUnderTitle))}),e.jsxs("select",{className:"border-token-border-medium bg-token-main-surface-primary w-full rounded-lg border px-3 py-2 text-sm",value:(q=s.defaultModel)!=null?q:"",onChange:g=>{nn.logEvent("gizmo_recommended_model_selected",g.target.value),t({defaultModel:g.target.value===""?null:g.target.value})},children:[e.jsx("option",{value:"",children:h.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"})}),[...L.models.values()].filter(g=>N.includes(g.id)).sort((g,A)=>g.title.localeCompare(A.title)).map(g=>e.jsx("option",{value:g.id,children:g.title},g.id))]})]}),e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:e.jsx(f,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),e.jsx(ja,{enabledTools:c,onEnabledToolsChange:g=>t({tools:g})})]}),e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"7r7v+u",defaultMessage:"Actions"}),description:e.jsx(f,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),e.jsx(Ja,{isDisabled:!!(m&&!U),gizmo:s,onShowActionsEditor:o})]}),!m&&Da(s)&&e.jsxs(ne,{children:[e.jsx(ae,{label:e.jsx(f,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!_,onClick:()=>{j(g=>!g)}}),e.jsx(Za,{collapsed:_,initial:!1,children:e.jsx(Hn,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:e.jsx(f,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!s.trainingDisabled,onChange:()=>{t({trainingDisabled:!s.trainingDisabled})}})})]})]}),P&&e.jsx(Xa,{text:(Y=s.instructions)!=null?Y:"",onChange:g=>{t({instructions:g})},onClose:()=>d(!1),placeholder:h.formatMessage(z.instructionsSubtitle)})]})}const z=xe({recommendedModelDescriberUnderTitle:{id:"gizmo.recommendedModelDescriberUnderTitle",defaultMessage:"Recommend a model to the user, which should be used by default for best results."},recommendedModelExplainer:{id:"gizmo.recommendedModelExplainer",defaultMessage:"When the user loads a new conversation with the GPT the recommended model will be used. If the model is not available to the user, a similar model may be automatically selected."},nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters. If you need to provide more context, you may want to attach a file or knowledge document."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function si(s,t){const n=$s(s);if(!Array.isArray(s.detail))return n;const a=Ze(s.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return t.formatMessage(z.nameTooLong,{length:i.ctx.limit_value});case"description":return t.formatMessage(z.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return t.formatMessage(z.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return a.length>0?a.join("\n"):n}function ti({upsertDraftError:s}){const t=ee(),n=si(s,t);return e.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[e.jsx("div",{children:e.jsx(f,x({},ut.errorSavingDraft))}),n!=null&&e.jsx(ts,{label:n,children:e.jsx(rn,{className:"icon-sm"})})]})}function ni({isPublished:s,isSavingDraft:t,hasUnpublishedChanges:n,upsertDraftError:a,className:i}){return a instanceof an?e.jsx(ti,{upsertDraftError:a}):n?e.jsxs("div",{className:he("flex items-center gap-2",i),children:[e.jsx("span",{className:"text-token-text-secondary",children:s?e.jsx(f,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):e.jsx(f,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),e.jsx("div",{className:"text-token-text-tertiary w-4",children:t&&e.jsx(is,{})})]}):null}const ut=xe({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}}),ai=Vs(()=>Qs(()=>import("./d7ewkvaapz2odnhr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])).then(s=>s.CanvasFocusedViewManager));var ii=(s=>(s.TestGizmoAction="test_gizmo_action",s))(ii||{});const ri=new on;function oi({clientThreadId:s,gizmoHasCustomActions:t,preferredModelId:n}){const{modelLabel:a,dropdownSections:i}=Kn(s,t,n),r=e.jsxs(Xn,{children:[e.jsx(f,{id:"IhcP1l",defaultMessage:"Model"}),e.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:a}),e.jsx(Zn,{className:"icon-sm text-token-text-tertiary"})]});return e.jsx(as,{size:"small",alignOffset:-4,triggerButton:r,children:e.jsx(un,{sections:i})})}function li({gizmoEditorData:s,isSavingDraft:t,showTitle:n=!0}){var k,T;const[a,i]=p.useState(()=>Se());Zs(a,{kind:de.GizmoTest,gizmo_id:s.id}),p.useEffect(()=>{De(a,m=>{m.mode={kind:de.GizmoTest,gizmo_id:s.id}})},[a,s.id]);const r=(k=s.files)==null?void 0:k.map(m=>m.file_id).join();p.useEffect(()=>{ln(a)!=null&&i(Se())},[s.id,s.instructions,s.tools,r,a]);const l=p.useMemo(()=>({gizmoEditorData:s,mode:"test"}),[s]),u=se(),o=ye(u,"1213809372"),c=ye(u,"1854238036");$n(a,s.defaultModel,void 0,s.id);const P=o||c,[d,_]=p.useState(0),j=()=>{_(m=>m-360)},v=s.id,S=ci(a);p.useEffect(()=>Ys(ri,{test_gizmo_action:({rootDomain:m,operationName:U})=>{v&&S(v,m,U)}}),[S,v]);const y=p.useCallback(()=>e.jsx("div",{className:"h-full w-full",children:e.jsx(Vn,{gizmo:s,hideOwner:!0,showStarterPrompts:!0})}),[s]);return e.jsx(Us.Provider,{value:l,children:e.jsx(Qn,{clientThreadId:a,children:e.jsx("div",{className:he("flex h-full w-full",t&&"cursor-wait opacity-80 transition"),children:e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("div",{className:"relative mb-2 shrink-0",children:e.jsx("div",{className:"flex justify-center py-1",children:n&&e.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[e.jsx("div",{className:"icon"}),e.jsxs("button",{onClick:()=>{j(),i(Se())},className:"flex items-center gap-2",children:[e.jsx(f,{id:"2u/6Ja",defaultMessage:"Preview"}),e.jsx(Gs.div,{className:"text-token-text-primary",animate:{rotate:d},transition:{duration:.3},children:e.jsx(Yn,{className:"icon invisible group-hover:visible"})})]}),P&&e.jsx(oi,{clientThreadId:a,gizmoHasCustomActions:!!it(s.tools),preferredModelId:(T=s.defaultModel)!=null?T:void 0})]})})}),e.jsxs("div",{className:he("relative grow overflow-auto px-2",t&&"pointer-events-none"),children:[e.jsx(Fs,{clientThreadId:a,children:e.jsx(ot,{clientThreadId:a,hideHeader:!0,renderEmptyState:y()})}),e.jsx(ya.Sidebars,{children:e.jsx(ai,{clientThreadId:a,overrideWidth:0,isAutoFocusDisabled:!0})})]})]})})})})}const _s=Ns.memo(li);function ci(s){const t=Ks(s);return p.useCallback((a,i,r)=>{t({eventSource:"url",promptMessage:cn("Call the ".concat(i," API with the ").concat(r," operation"),{jit_plugin_data:{from_client:{type:"test",operation:r,tool_name:dn(i)}}}),completionMetadata:{conversationMode:{kind:de.GizmoTest,gizmo_id:a}}})},[t])}const di=Vs(()=>Qs(()=>import("./mnl5qjy02l9upyzg.js"),__vite__mapDeps([44,1,2,3,45,4,5,46,47,48,49,50,51,31,32,33,52,53,54,40,55,56,57,58,59,60,61,62,38,39,8,63,37,64,65,66,67,68])).then(s=>s.GizmoActionsEditor));var mt=(s=>(s.MAGIC_MAKER="magic",s.ADVANCED="advanced",s.PREVIEW="preview",s))(mt||{});function Be({value:s,label:t,testId:n}){return e.jsx(et,{value:s,className:"text-md border-token-border-default text-token-text-tertiary hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] w-1/3 grow rounded-lg p-1.5 font-semibold transition md:w-1/2","data-testid":n,children:t})}function ui({className:s,editorTab:t,setEditorTab:n}){const a=ee();return e.jsxs(Js,{className:he("bg-token-main-surface-secondary flex w-full overflow-hidden rounded-xl p-1.5 md:w-1/2",s),value:t,onValueChange:i=>{n(i)},children:[e.jsx(Be,{value:"magic",label:a.formatMessage(Ee.magicMakerLabel)}),e.jsx(Be,{value:"advanced",label:a.formatMessage(Ee.configureLabel),testId:"gizmo-editor-configure-button"}),e.jsx("div",{className:"flex w-1/3 md:hidden",children:e.jsx(Be,{value:"preview",label:a.formatMessage(Ee.previewLabel)})})]})}function mi(s,t){return s.length!==t.length?!1:s.every(n=>t.some(a=>a.type===n.type))}function fi(s,t){var n,a,i,r;return s.name===t.gizmo.display.name&&s.description===t.gizmo.display.description&&s.instructions===t.gizmo.instructions&&mi(s.tools,t.tools)&&Ye((a=(n=s.files)==null?void 0:n.map(l=>l.file_id))!=null?a:[],(r=(i=t.files)==null?void 0:i.map(l=>l.file_id))!=null?r:[])&&s.profilePictureUrl==t.gizmo.display.profile_picture_url&&s.profilePictureId==t.gizmo.display.profile_pic_id}const ft=({gizmo:s,onNewGizmoId:t})=>{var cs;const n=As(),a=Es(),i=at(Ce.BrowsingAvailable),r=(a==null?void 0:a.includes(Ce.GizmoCanvasToggle))&&(a==null?void 0:a.includes(Ce.Canvas)),l=se(),u=ye(l,"4148168517"),o=ee(),c=ue(),P=()=>{const b=[];i&&b.push({type:X.BROWSER}),r&&b.push({type:X.CANVAS});const G=C(x({},Ps),{tools:[...Ps.tools,...b]});return u?C(x({},G),{tools:[...G.tools.filter(R=>R.type!==X.DALLE),{type:X.IMAGE_GEN}]}):G},d=p.useRef(s!=null?ws(s):P()),_=p.useRef(s),j=p.useRef(d.current),[v,S]=p.useState(()=>d.current),[y,k]=p.useState(()=>Se()),[T]=p.useState(()=>({context_message:Ta(d.current),model_slug:ze.GPT_4o,enabled_tools:[{tool_id:s!=null?"gizmo_editor":"gizmo_creator"}]}));Aa(y,j.current,T);const{data:m}=Je({isGizmo:!0}),U=(cs=m==null?void 0:m.models.get(Os))!=null?cs:m&&Xs(m.models.values(),b=>b.tags.includes(ze.GPT_4o)),{data:h}=hn(d.current.id),L=xn(),{isPending:M,error:I}=L,N=vn(),W=p.useMemo(()=>h!=null&&!fi(v,h),[v,h]),F=async()=>{var G;const b=d.current;try{const R=await L.mutateAsync({editorData:b,gizmoId:b.id});if(_.current=R,d.current.id==null){const K=R.gizmo.id;d.current=C(x({},d.current),{id:K,sharingTargets:R.gizmo.sharing_targets}),S(d.current),t==null||t(K)}for(const K of R.tools.filter(Z=>Z.type===X.JIT_PLUGIN)){const Z=d.current.tools.find(ve=>ve.type===X.JIT_PLUGIN&&ve.metadata.domain===K.metadata.domain);Z&&Z.metadata.action_id!==K.metadata.action_id&&(Z.metadata=C(x({},Z.metadata),{action_id:K.metadata.action_id}),S(d.current))}return R}catch(R){const K=(G=$s(R))!=null?G:o.formatMessage(ut.errorSavingDraft);throw c.warning(K,{duration:2}),R}},E=p.useRef(void 0),V=async()=>d.current.id!=null?d.current.id:(E.current==null&&(E.current=F().then(b=>b.gizmo.id).catch(b=>{throw E.current=void 0,b})),E.current),[B]=p.useState(()=>jn(()=>F(),2e3,{trailing:!0})),q=p.useCallback((b,G=!0)=>{const R=typeof b=="function"?b(d.current):Dn(d.current,b);Ye(R,d.current)||(d.current=R,S(d.current),G&&B())},[B]),Y=p.useRef(void 0);p.useEffect(()=>Ys(yn,{completionFinished:async b=>{const G=b.serverThreadId;if(G==null){H(!1);return}try{const R=await Pa(d.current,G,c,Y.current);R!=null&&(q(R),j.current=Ls(d.current))}catch(R){qe.addError(R),c.warning("Something went wrong generating your GPT",{duration:3})}finally{Y.current=ge.getCurrentNode(be(G)).message.id,H(!1)}}}),[c,q]);const g=Ca(y,T),[A,$]=p.useState(void 0);p.useEffect(()=>{$(ua(s))},[s==null?void 0:s.gizmo.id]);const te=async(b,G)=>{var ve,ds;const R=Ne(d.current,b.recipient,G);if(R.length>0){c.warning("Could not save GPT:\n\n".concat(R.map(oe=>"- ".concat($e(oe))).join("\n")),{duration:3});return}const K=await F(),Z=K.gizmo.id;try{return Ws.logEvent("Promote Gizmo",{gizmo_id:K.gizmo.id,sharing_recipient:b.recipient,editor_tab:Q}),await N.mutateAsync({gizmoId:K.gizmo.id,data:{sharingSubjects:b.subjects,sharingRecipient:b.recipient,categories:G==null?void 0:[G]}},{onSuccess(Ge){n.setQueryData(vs(n,Z).queryKey,Ge),n.invalidateQueries({queryKey:["gizmos"]}),n.invalidateQueries({queryKey:["gizmo",{gizmoId:Z}]}),n.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:Z}]})}})}catch(oe){if(oe instanceof bn)$({gizmoId:Z,sharingRecipient:b.recipient,moderationType:rt.PublishBlocked,sharingTargets:(ve=oe.response)==null?void 0:ve.sharing_targets,showModal:je.AppealAvailable});else{qe.addError(oe);const Ge=(ds=oe.detail)!=null?ds:"An unknown error occurred";c.warning("Error saving GPT - "+Ge,{duration:6})}}},[Q,re]=p.useState(()=>{const b=hs.getItem(xs.GizmoEditorTab);return Object.values(mt).includes(b)?b:"magic"});p.useEffect(()=>Mn(()=>{const b=ea(l).width;b!=null&&b>=768&&Q==="preview"&&re("magic")}),[l,Q]);const[me,fe]=p.useState(!1),[w,H]=p.useState(!1),[ls,Ae]=p.useState(void 0);return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[e.jsx(Wa,{gizmoEditorData:v,isUpsertLoading:L.isPending,isPromoteLoading:N.isPending,hasUnpublishedChanges:W,isUploadingProfilePic:me,isGeneratingProfilePic:w,publishedGizmo:h,updateGizmo:q,promoteGizmo:async(b,G)=>{const R=await te(b,G);return d.current=C(x({},d.current),{sharingRecipient:b.recipient}),S(d.current),hs.setItem(xs.GizmoEditorTab,Q),R},appealGizmo:async(b,G)=>{A!=null&&$(C(x({},A),{sharingRecipient:b,categories:G==null?void 0:[G],showModal:je.AppealAvailable}))},setAppealState:$,revertDraft:h!=null&&W?()=>{const b=n.getQueryData(vs(n,d.current.id).queryKey);if(b!=null){const G=ws(b);d.current=G,S(G),F()}}:void 0,draftMessage:e.jsx(ni,{isPublished:h!=null&&(h.gizmo.share_recipient==="marketplace"||h.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:W,isSavingDraft:M,upsertDraftError:I,className:"text-sm"}),showActionsModal:b=>{Ae(b)},className:"shrink-0"}),A&&e.jsx(ma,{appealState:A,onAppealClose:()=>$(C(x({},A),{showModal:je.None})),onAppealSubmitted:()=>$(C(x({},A),{showModal:je.AppealSent}))}),e.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[e.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:e.jsx("div",{className:"h-full grow overflow-hidden",children:ls!==void 0?e.jsx(di,{currentlyEditingActionDomain:ls,gizmoEditorData:v,updateGizmo:q,onClose:()=>{Ae(void 0)}}):e.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[e.jsx("div",{className:"flex w-full flex-row justify-center",children:e.jsx(ui,{editorTab:Q,setEditorTab:re,className:"mb-2 shrink-0 self-center"})}),e.jsx("div",{className:"grow overflow-hidden",children:Q==="magic"?e.jsx("div",{className:"h-full w-full",children:e.jsx(Ra,{gizmoEditorData:v,updateGizmo:q,clientThreadId:y,gizmoEditorDataRef:d,magicMakerBehaviorOverrides:T,magicMakerConversationGizmoEditorDataRef:j,requireGizmoId:V},y)}):Q==="advanced"?e.jsx(ei,{gizmoEditorData:v,updateGizmo:q,currentModelConfig:U,generateProfilePic:b=>{H(!0),g(b,d,j,Ia)},setIsUploadingProfilePic:fe,isGeneratingProfilePic:w,setIsGeneratingProfilePic:H,requireGizmoId:V,onShowActionsEditor:b=>{Ae(b)}}):e.jsx(_s,{gizmoEditorData:v,isSavingDraft:M,showTitle:!1})})]})})}),e.jsx("div",{className:he("border-token-border-medium bg-token-main-surface-secondary hidden w-1/2 justify-center border-s pt-4",Q!=="preview"&&"md:flex"),children:e.jsx("div",{className:"grow",children:e.jsx(_s,{gizmoEditorData:v,isSavingDraft:M})})})]})]})};function pi({gizmoId:s,version:t}){const{data:n}=fn({gizmoId:s,draft:!0,version:t}),a=Ie(Bs.accountUserId),i=pn(),r=i==null?void 0:i.id,l=gn(n)&&n!=null&&a!=null&&r!=null;return n==null||!l?null:e.jsx(ft,{gizmo:n})}function gi({onNewGizmoId:s}){return e.jsx(ft,{onNewGizmoId:s})}const hi=({gizmoId:s,remixSourceId:t,version:n})=>{const a=Me(),i=se(),r=rs(i),l=p.useRef(void 0);p.useEffect(()=>(gs.enterGizmoEditor(),()=>{gs.exitGizmoEditor()}),[]);let u=s;return s!=null&&l.current===s&&(u=void 0),Jn({resetThreadAction:()=>{a("/")}}),r?u!==void 0?e.jsx(pi,{gizmoId:u,version:n},u):e.jsx(gi,{remixSourceId:t,onNewGizmoId:o=>{l.current=o,window.history.replaceState(window.history.state,"",mn(o))}}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(is,{})})},Ee=xe({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});function xi(s){const t=Me();p.useEffect(()=>{s||t(wn(Pn.NO_ACCESS))},[s,t])}const Gi=()=>(sa(),null),Ri=yt(function(){const t=se(),n=rs(t),a=!!(n!=null&&n.hasPlusFeatures());xi(n==null||a);const i=Mt(),[r]=bt(),l=Me(),u=i.slug,o=r.get("version"),c=u?Tn(u):void 0,P=r.get("remixFrom");return p.useEffect(()=>{ta(!0).then(d=>{na.initializeAndGatherData(d),aa.initializeAndGatherData(d)})},[]),p.useEffect(()=>{n!=null&&!a&&l("/")},[n,l,a]),p.useEffect(()=>{c&&js(c)&&l("/g/".concat(u,"/project"))},[c,l,u]),!a||c&&js(c)?null:e.jsx(kn,{children:e.jsx(hi,{gizmoId:c,remixSourceId:P!=null?P:void 0,version:o!=null?Number(o):void 0})})});export{ri as G,ii as a,Gi as c,Ri as g};
//# sourceMappingURL=gnx0tdaycrt4vcxz.js.map

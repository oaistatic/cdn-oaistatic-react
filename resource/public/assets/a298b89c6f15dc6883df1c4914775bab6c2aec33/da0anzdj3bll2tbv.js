const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/nib1icwsb20oe75f.js","assets/n75kuy1cx6f5mogg.js","assets/ewse8exzafeu10ji.js","assets/root-l2v84m1w.css","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css","assets/ef5ky5jy1k52ka9g.js","assets/hhoxxrihkac1vju6.js","assets/nwkahx754oj8hp36.js","assets/oivlyqzjs00veeza.js"])))=>i.map(i=>d[i]);
var Nr=Object.defineProperty,Lr=Object.defineProperties;var Ur=Object.getOwnPropertyDescriptors;var eo=Object.getOwnPropertySymbols;var Or=Object.prototype.hasOwnProperty,Hr=Object.prototype.propertyIsEnumerable;var so=(e,s,n)=>s in e?Nr(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,ne=(e,s)=>{for(var n in s||(s={}))Or.call(s,n)&&so(e,n,s[n]);if(eo)for(var n of eo(s))Hr.call(s,n)&&so(e,n,s[n]);return e},_t=(e,s)=>Lr(e,Ur(s));import{hC as Nt,L as Ve,p as ze,k_ as Lt,dv as Lo,i as _e,jL as Ir,y as Qs,cr as Ut,bJ as Qe,b as Ot,a as Wr,a9 as be,a2 as qr,j as Be,e as de,P as ae,aR as ve,cw as _s,z as je,gD as Gr,H as Cs,lk as Vr,jJ as zr,N as $r,U as Yr,jI as Jr,gE as st,gz as Uo,O as Se,B as Kr,a6 as Ht,ej as It,ek as Wt,eM as Oo,aP as Xs,f6 as Ho,Y as tt,Z as nt,s8 as Qr,ab as Xr,fA as Zr,x as Bt,fI as Io,aa as ei,bK as si,s9 as ti,cy as jt,br as Wo,cN as ni,gn as qo,f as Go,ex as Ne,gk as As,fK as oi,p4 as ai,hE as ri,k5 as Vo,a3 as R,aV as Le,aD as ii,aE as li,V as Zs,gs as oe,kS as ci,mp as ui,sa as Rt,fT as rs,jz as di,jA as mi,jB as pi,jD as gi,jH as hi,sb as fi,eK as zo,sc as Si,sd as xi,se as $s,lE as Ct,g$ as bi,gB as Ge,jX as yi,hZ as Ai,sf as Pi,dB as _i,T as Ci,bW as $o,sg as wi,lF as Ti,qG as ki,ey as Mi,sh as Ei,si as vi,c2 as Bi,bZ as ji,c3 as Ri,gf as Yo,bb as Fi,sj as Di,jP as Jo,aG as to,md as wt,gA as Ni,ba as Li,eQ as Ui,f5 as Oi,sk as Hi,ay as Ii,sl as Wi,iq as qi,lv as Gi,d4 as Vi,s2 as zi,iQ as no,cI as $i,ce as oo,nu as Yi,q0 as Ji,fG as Ki,sm as Qi,i6 as ao,fR as Xi,fL as Zi,sn as el,gi as ro,lC as sl,cm as tl,iR as nl,k7 as ol,eH as al,eY as rl,mz as il,eL as ll,d0 as io,gp as cl,gj as ul,py as dl,gh as ml,me as lo,mx as pl,pv as gl,pw as hl,aT as Ys,aO as co,mh as fl,fQ as uo,gv as Js,ee as Sl,nZ as xl,kT as bl,pB as yl,c0 as mo,pz as Al,pA as Pl,aI as _l,so as Cl,jS as bs,eS as po,m1 as wl,ax as Tl,sp as go,$ as Tt,a0 as kt,sq as ho,cp as kl,aM as Ml,d9 as fo,mf as El,sr as vl,gw as Bl,ss as jl,aS as So,kc as Rl,st as Fl,js as xo,su as Dl,fs as Nl,bU as Ll,sv as Ul,sw as Ol,sx as Hl,at as bo,sy as Il,b9 as yo,cW as Wl,k9 as ql,eX as Gl,sz as Vl,d5 as zl,ka as Ao}from"./ewse8exzafeu10ji.js";import{b as $e,g as Ye,r as u,j as t,M as O,c as qt,d as Gt,A as $l,m as ws,i as Yl}from"./n75kuy1cx6f5mogg.js";import{b2 as Ue,oG as Jl,oH as Kl,of as is,oI as Ql,oJ as Xl,oK as Zl,oC as ec,b1 as Xe,oL as sc,oM as tc,a6 as nc,oN as Ts,oO as Ko,oP as oc,aa as ac,al as rc,og as ic,dh as lc,h_ as cc,c5 as uc,oQ as dc,mg as mc,oR as Qo,oS as Po,oT as pc,oU as gc,oV as hc,lF as Xo,oW as Zo,mh as _o,oX as fc,oY as Sc,jO as ea,jP as xc,oZ as bc,o_ as yc,o$ as Ce,p0 as ls,p1 as h,p2 as Ac,p3 as Pc,as as _c,p4 as Cc,p5 as sa,p6 as wc,p7 as Tc,p8 as kc,p9 as Co,pa as Mc,pb as Ec,pc as vc,pd as Bc,pe as jc,pf as Rc,pg as Fc,ph as Dc,pi as Nc,pj as wo,pk as Lc,pl as Uc,pm as Oc,pn as Hc,po as Ic,pp as Wc,pq as qc,pr as Gc,ps as Vc,pt as zc,pu as $c,pv as Yc,pw as Jc,px as Kc,jU as Qc,py as Xc,pz as Zc,pA as eu,pB as su,pC as tu,pD as nu,pE as ou,pF as au,pG as ru,pH as iu,pI as lu,pJ as cu,pK as uu,pL as du,pM as mu,pN as pu,pO as gu,pP as hu,pQ as fu,pR as Su,pS as xu,ft as bu,pT as ta,pU as yu,pV as Au,pW as Pu,pX as _u,pY as Cu,pZ as wu,d8 as Tu,fo as na,oF as oa,bG as ku,p_ as Mu,p$ as aa,q0 as Eu,q1 as vu,q2 as Ft,q3 as Bu,q4 as To,q5 as Ps,h9 as Ks,q6 as ju,q7 as ra,q8 as ia,q9 as la,qa as ko,qb as Ru,mq as Fu,c9 as ca,a2 as Du,qc as Nu,qd as Lu,P as Mo,qe as Uu,qf as Ou,gI as Hu,qg as Iu,qh as Wu,da as qu,qi as Gu,qj as Vu,cE as zu,qk as $u,ql as Yu,qm as Ju,qn as Ku,qo as Qu,qp as Xu,qq as Zu,qr as ed,qs as sd,cF as td,m8 as nd,qt as od,gY as ad,lK as rd,qu as id,qv as ld,qw as Eo,gO as ys,qx as Ke,qy as vo,nD as cd,qz as ud,qA as dd,qB as md,qC as pd,mx as Mt,qD as gd,qE as Bo,qF as hd,qG as fd,gz as Sd,qH as xd,qI as bd,kY as yd,kZ as Ad,k_ as Pd,qJ as _d,qK as Cd,qL as wd,ig as Td,qM as kd,lr as he,e1 as Md,qN as Ed,qO as vd,qP as Bd,fs as jd,qQ as Et,qR as Rd,jR as Fd,fr as Dd,qS as Nd,qT as jo,qU as Ld,qV as Ud,qW as vt,qX as Od,qY as Hd,fq as Ro,qZ as Id,q_ as Wd,q$ as qd,r0 as Gd,r1 as Vd,r2 as zd,r3 as $d,r4 as Yd,r5 as Jd,r6 as Kd,r7 as Qd,r8 as Xd,r9 as Zd,ra as em,rb as sm,rc as tm,rd as nm,re as om,rf as am,rg as rm,rh as im,ri as lm,rj as cm}from"./ny10lj7zpuz89fvf.js";import{P as um,u as dm}from"./mzj5jqjjpo006z7a.js";import{g as Vt}from"./nnb0v70g00lhjclz.js";import{a as zt,P as mm}from"./fh2tsu8ocsi22jc3.js";import{u as pm}from"./jaupzjmp9wknd4io.js";import{getTabScreenshot as gm}from"./jtxj1xvdu5i7mvdh.js";import{u as hm}from"./j2ui4c2m3nj8pqst.js";import{P as fm,u as Sm,h as xm}from"./h2dwuj1m5ps9l7uv.js";function bm(){const e=$e(),s=Ye(),{markAsViewed:n}=Ue(Jl),{shouldShowBanner:l,referralCode:i,discountValue:r,discountDuration:m}=Kl();if(u.useEffect(()=>{l&&i&&r&&m&&is.logShowRefereeRedemptionBanner(i)},[l,i,r,m]),!l||!r||!m)return null;const a=ym(e,r,m);return t.jsx(Nt,{onPrimaryCtaClick:()=>{n(),is.logClickRefereeRedeemButton(i),Ve.removeItem(ze.ReferralCode),s(Ql(i))},primaryCtaText:t.jsx(O,{id:"refereeRedemptionBannerPrimaryCta",defaultMessage:"Redeem"}),onDismiss:()=>{n(),is.logCloseRefereeRedemptionBanner(i),Ve.removeItem(ze.ReferralCode)},title:a,content:t.jsx(O,{id:"xoQacW",defaultMessage:"Verify you are a student to get your first month of Plus for free."})})}function ym(e,s,n){var m,a;const{currencySymbol:l}=Vt(zt(),s.currency_code),i=(a=(m=l.code.defaultMessage)==null?void 0:m.toString())!=null?a:Lt,r=e.formatNumber(s.value,{style:"currency",currency:i,minimumFractionDigits:0,maximumFractionDigits:2});return s.value===mm?t.jsx(O,{id:"refereeRedemptionFree",defaultMessage:"Finish redeeming your free month of Plus"}):t.jsx(O,{id:"refereeRedemptionDiscount",defaultMessage:"Get ChatGPT Plus for {discount} off for the {months, plural, one {first month} other {first # months}}.",values:{discount:r,months:n.num_periods}})}const et="month",ua="year";function Am(){const e=Lo(),s=_e(),n=$e(),{markAsViewed:l}=Ue(Xl),{initialBillingDetails:i}=pm(e,!0),r=u.useMemo(()=>_t(ne({},e==null?void 0:e.subscriptionAnalyticsParams),{referrer:document.referrer}),[e]);async function m(){try{await ec(i,r)}catch(w){}}const{shouldShowBanner:a,discountValue:c,discountDuration:d}=Zl();if(u.useEffect(()=>{a&&c&&d&&is.logShowReferrerRedemptionBanner()},[a,c,d]),!a||!c||!d)return null;const f=Pm(n,i,c,d),A=_m(n,i,c,d),P=t.jsxs("div",{className:"grow",children:[t.jsx("div",{className:"mb-0.5 font-semibold",children:f}),t.jsx("span",{className:"text-token-text-secondary",children:A})]});return t.jsx(Nt,{onPrimaryCtaClick:()=>{l(),is.logClickReferrerRedeemButton(),m()},primaryCtaText:t.jsx(O,ne({},Ir(s))),onDismiss:()=>{l(),is.logCloseReferrerRedemptionBanner()},content:P})}function Pm(e,s,n,l){var f,A;const{currencySymbol:i}=Vt(zt(),s.currency),r=l?l.period:et,m=l?l.num_periods:1,a=(A=(f=i.code.defaultMessage)==null?void 0:f.toString())!=null?A:Lt,c=e.formatNumber(n.value,{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2});let d;return r===et?d=m===1?t.jsx(O,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:c}}):t.jsx(O,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:c}}):r===ua&&(d=m===1?t.jsx(O,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:c}}):t.jsx(O,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:c}})),d}function _m(e,s,n,l){var f,A;const{currencySymbol:i}=Vt(zt(),s.currency),r=l?l.period:et,m=l?l.num_periods:1,a=(A=(f=i.code.defaultMessage)==null?void 0:f.toString())!=null?A:Lt,c=e.formatNumber(n.value,{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2});let d;return r===et?d=m===1?t.jsx(O,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used — claim your free month of Plus."}):t.jsx(O,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:c,num_months:m}}):r===ua&&(d=m===1?t.jsx(O,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:c}}):t.jsx(O,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:c,num_years:m}})),d}const Fo=Gt({bannerBody:{id:"gqtTeH",defaultMessage:"Work smarter and better with coworkers in your organization"},dismissBanner:{id:"hbc/Bs",defaultMessage:"Dismiss banner"}});function Cm(e){"use forget";const s=qt.c(13),{clientThreadId:n,canShowBanner:l}=e,i=l===void 0?!1:l,r=_e();let m;s[0]!==r?(m=Qs(r),s[0]=r,s[1]=m):m=s[1];const a=m;let c;s[2]!==n?(c=Ut(n),s[2]=n,s[3]=c):c=s[3];const d=c,f=Qe(n,km),{eligible:A}=Ue(Xe.hasSeenJoinWorkspaceBanner),P=d&&!f,w=Ot(),y=(w==null?void 0:w.email_domain_type)==="professional",T=a&&y&&i&&P&&d&&!f&&A,{data:B,isLoading:F}=Wr(),k=!!(B!=null&&B.accountItems.some(Tm));let Y;s[4]!==r?(Y=be(r,"3217430380",{disableExposureLog:!0}).get("enable_workspace_discovery",!1),s[4]=r,s[5]=Y):Y=s[5];const ie=!F&&!k&&Y&&T,Z=Ve.getItem(ze.WorkspaceDiscoveryInfo),me=qr(r,"2801792036").get("cache_ttl_ms",6048e5),{isFresh:x,hasWorkspacesToJoin:W}=sc(Z,me);let q;s[6]!==r?(q=Be(r,"69563813"),s[6]=r,s[7]=q):q=s[7];const L=!x&&q&&ie,{data:G,isFetching:pe}=tc(L),le=G==null?void 0:G.workspaces.some(wm);if(!(!pe&&(x?!!W:!!le)&&ie)){let Q;return s[8]===Symbol.for("react.memo_cache_sentinel")?(Q={shouldShow:!1},s[8]=Q):Q=s[8],Q}let V;s[9]!==r?(V=be(r,"1200251816").get("enable-join-workspaces-banner",!1),s[9]=r,s[10]=V):V=s[10];const H=V;let ue;return s[11]!==H?(ue={shouldShow:H},s[11]=H,s[12]=ue):ue=s[12],ue}function wm(e){return!e.requested}function Tm(e){return e.isEnterprisey()}function km(e){return ve.hasUserMessage(e)}function Np(){"use forget";const e=qt.c(22),s=_e(),{markAsViewed:n}=Ue(Xe.hasSeenJoinWorkspaceBanner);let l;e[0]!==n?(l=()=>{ae.logEventWithStatsig("Thread Join Workspace Banner Button Dismissed","chatgpt_thread_join_workspace_banner_button_dismissed"),n()},e[0]=n,e[1]=l):l=e[1];const i=l;let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[2]=r):r=e[2],u.useEffect(Mm,r);let m;e[3]!==s||e[4]!==n?(m=()=>{ae.logEventWithStatsig("Thread Join Workspace Banner Button Clicked","chatgpt_thread_join_workspace_banner_button_clicked"),n(),_s(s,nc,{mode:"dismissible",section:"both",source:"join_workspace_banner"})},e[3]=s,e[4]=n,e[5]=m):m=e[5];const a=m;let c;e[6]===Symbol.for("react.memo_cache_sentinel")?(c=de("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden","pe-7"),e[6]=c):c=e[6];let d;e[7]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Ts,{className:"icon-sm","aria-hidden":"true"})}),e[7]=d):d=e[7];let f,A;e[8]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsxs("span",{className:"flex items-center gap-1.5",children:[d,t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(O,ne({},Fo.bannerBody))})]}),A=t.jsx("span",{className:de("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:t.jsx("span",{children:t.jsx(O,{id:"V/M/bo",defaultMessage:"Find Workspaces"})})}),e[8]=f,e[9]=A):(f=e[8],A=e[9]);let P;e[10]!==a?(P=t.jsxs("button",{type:"button",onClick:a,className:c,children:[f,A]}),e[10]=a,e[11]=P):P=e[11];let w;e[12]!==i?(w=Y=>{Y.stopPropagation(),i()},e[12]=i,e[13]=w):w=e[13];let y,T;e[14]===Symbol.for("react.memo_cache_sentinel")?(T=de("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),y=t.jsx(Ko,{className:"icon-xs","aria-hidden":"true"}),e[14]=y,e[15]=T):(y=e[14],T=e[15]);let B;e[16]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx("span",{className:"sr-only",children:t.jsx(O,ne({},Fo.dismissBanner))}),e[16]=B):B=e[16];let F;e[17]!==w?(F=t.jsxs("button",{type:"button",onClick:w,className:T,children:[y,B]}),e[17]=w,e[18]=F):F=e[18];let k;return e[19]!==F||e[20]!==P?(k=t.jsxs("div",{className:"relative",children:[P,F]}),e[19]=F,e[20]=P,e[21]=k):k=e[21],k}function Mm(){ae.logEventWithStatsig("Thread Join Workspace Banner Button Shown","chatgpt_thread_join_workspace_banner_button_shown")}const Do=Gt({bannerBody:{id:"WAgvN5",defaultMessage:"Unlock extra messages, images & more"},dismissBanner:{id:"+X3EGU",defaultMessage:"Dismiss banner"}}),Em=7*24*60*60*1e3;function vm(e,s){const n=Date.parse(e.dismissedAt);return Number.isNaN(n)?!0:Date.now()-n>s}function Bm(e){const s=Ve.getItem(ze.ThreadUpgradeBannerDismissedAt);return s?vm(s,e):!0}function da({isDismissible:e,dismissTtlMs:s=Em}){const[n,l]=u.useState(!1);return u.useEffect(()=>{if(!e){l(!0);return}l(Bm(s))},[s,e]),{isVisible:n,dismiss:()=>{if(!e)return;ae.logEventWithStatsig("Thread Upgrade Banner Button Dismissed","chatgpt_thread_upgrade_banner_button_dismissed",{type:"banner"});const r={dismissedAt:new Date().toISOString()};Ve.setItem(ze.ThreadUpgradeBannerDismissedAt,r),l(!1)}}}function Lp({isDismissible:e=!0}){const s=Ye(),{isVisible:n,dismiss:l}=da({isDismissible:e});if(u.useEffect(()=>{n&&ae.logEventWithStatsig("Thread Upgrade Banner Button Shown","chatgpt_thread_upgrade_banner_button_shown",{type:"banner"})},[n]),!n)return null;const i=()=>{ae.logEventWithStatsig("Thread Upgrade Banner Button Clicked","chatgpt_thread_upgrade_banner_button_clicked",{type:"banner"}),Cs(s,"thread_splash_upgrade_banner_cta")};return t.jsxs("div",{className:"relative",children:[t.jsxs("button",{type:"button",onClick:i,className:de("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden",e&&"pe-7",!e&&"pe-4"),children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Ts,{className:"icon-sm","aria-hidden":"true"})}),t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(O,ne({},Do.bannerBody))})]}),t.jsxs("span",{className:de("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:[t.jsx("span",{className:"hidden sm:inline",children:t.jsx(O,ne({},je.upgradePlan))}),t.jsx("span",{className:"sm:hidden",children:t.jsx(O,ne({},je.upgrade))}),!e&&t.jsx(Gr,{className:"icon-xs"})]})]}),e&&t.jsxs("button",{type:"button",onClick:r=>{r.stopPropagation(),l()},className:de("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),children:[t.jsx(Ko,{className:"icon-xs","aria-hidden":"true"}),t.jsx("span",{className:"sr-only",children:t.jsx(O,ne({},Do.dismissBanner))})]})]})}var ma=(e=>(e.GENERIC="generic",e.GENERIC_FREE_TRIAL="generic_free_trial",e.GO="go",e.PLUS="plus",e.BANNER="banner",e))(ma||{});function jm({clientThreadId:e,variant:s}){var T;const n=_e(),l=oc(),{enableThreadHeaderUpgradePill:i}=ac(),{enableNewSplashUpgradeBanner:r,newUpsellsDismissible:m}=rc(),{isVisible:a}=da({isDismissible:m()}),c=Ut(e),d=Qe(e,B=>ve.hasUserMessage(B)),f=Vr(),A=be(n,"4048646334"),P=(T=f==null?void 0:f.call_to_action)==null?void 0:T.includes(zr.GET_PLUS),y=l&&(c&&!d)&&i&&!(P&&!A.get("should_show_thread_header_upgrade_pill",!0));return s==="banner"?{shouldShow:y&&a&&r(),newUpsellsDismissible:m}:{shouldShow:y&&!r(),newUpsellsDismissible:()=>!1}}function Up(){var F,k;const e=_e(),s=Lo(),{eligible:n}=ic(),{eligible:l}=lc(),i=n||l,r=cc(),a=be(e,"684023316",{disableExposureLog:!0}).get("memory_almost_full_threshold",80),{isLoading:c}=$r(Yr.Sunshine),{data:d,isLoading:f}=uc(void 0,!1,r),A=r&&((F=d==null?void 0:d.memoryFullPct)!=null?F:0)>=100,T=((((k=d==null?void 0:d.memoryFullPct)!=null?k:0)>=a?be(e,"684023316").get("upsell_variant","control"):"control")!=="control"||f)&&(c||A);if(!s||T)return null;let B="generic";if(i)B="generic_free_trial";else if(Jr(e))B="go";else{const re=be(e,"497415788").get("upgrade_pill_type","plus");if(Lm(re))B=re;else return null}switch(B){case"generic":return t.jsx(Dm,{});case"generic_free_trial":return t.jsx(Nm,{});case"plus":return t.jsx(Rm,{});case"go":return t.jsx(Fm,{});case"banner":return null}}function Rm(){const e=Ye(),s=_e(),n=()=>{Cs(e,"thread_header_get_plus_pill")};return t.jsxs(ot,{onClick:n,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"plus",children:[t.jsx(Ts,{className:"icon-sm"}),t.jsx(O,ne({},Um(s)))]})}function Fm(){const e=Ye(),s=()=>{Cs(e,"thread_header_get_plus_pill")};return t.jsxs(ot,{onClick:s,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"go",children:[t.jsx(dc,{className:"icon-sm"}),t.jsx(O,ne({},je.upgradeToGo))]})}function Dm(){const e=Ye(),s=()=>{Cs(e,"thread_header_generic_upgrade_pill_button")};return t.jsxs(ot,{onClick:s,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic",children:[t.jsx(Ts,{className:"icon-sm"}),t.jsx(O,ne({},je.upgrade))]})}function Nm(){const e=Ye(),s=()=>{Cs(e,"thread_header_generic_free_trial_upgrade_pill_button")};return t.jsxs(ot,{onClick:s,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic_free_trial",children:[t.jsx(Ts,{className:"icon-sm"}),t.jsx(O,ne({},je.upgradeForFree))]})}function ot({children:e,className:s,onClick:n,type:l}){u.useEffect(()=>{ae.logEventWithStatsig("Thread Header Upgrade Pill Button Shown","chatgpt_thread_header_upgrade_pill_button_shown",{type:l})},[l]);const i=()=>{ae.logEventWithStatsig("Thread Header Upgrade Pill Button Clicked","chatgpt_thread_header_upgrade_pill_button_clicked",{type:l}),n==null||n()};return t.jsx("button",{onClick:i,className:de("flex items-center gap-1 rounded-full py-2 ps-2.5 pe-3 text-sm font-medium",s),children:e})}function Lm(e){return Object.values(ma).includes(e)}function Um(e){switch(be(e,"497415788").get("plus_upgrade_pill_cta","get_plus")){case"try_plus":return je.tryPlus;case"upgrade_to_plus":return je.upgradeToPlus;case"upgrade_your_plan":return je.upgradeYourPlan;case"upgrade_plan":return je.upgradePlan;case"get_plus":default:return je.getPlus}}function No({clientThreadId:e,onClick:s}){u.useEffect(()=>{bc(e)},[e]);const n=$e();return t.jsx(ws.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:t.jsx(ea,{onClick:()=>{yc(e),s()},label:n.formatMessage(Dt.moreStarterPrompts)})})}function Om({starterPrompt:e,starterPrompts:s,index:n,disabled:l,onSelectStarterPrompt:i}){var d;const r=(d=e.theme)!=null?d:e.title,m=fc(),{mutate:a}=Sc(),c=e.category==="onboarding"?f=>{a({key:Xe.hasUsedConversationalOnboardingStarterPrompt}),m(f,e,s,n)}:f=>i==null?void 0:i(f,e,s,n);return t.jsx(ea,{disabled:l,onClick:c,icon:t.jsx(xc,{category:e.category,useV2Colors:!0}),label:r})}const Hm=5,Im=3;function pa({starterPrompts:e,onSelectStarterPrompt:s,disabled:n,clientThreadId:l,onExpand:i,mobileLayout:r=!1}){const m=r?Im:Hm,[a,c]=u.useState(m),[d,f]=u.useState(!1),A=u.useRef(null),P=e.length<=a;u.useEffect(()=>{_o(e.slice(0,m),l)},[l]),u.useEffect(()=>{if(!d&&!P&&A.current){const y=A.current,T=y.getBoundingClientRect(),B=T.width,F=Array.from(y.children);let k=0;for(let Y=0;Y<F.length&&F[Y].getBoundingClientRect().right-T.left<=B;Y++)k++;c(k),f(!0)}},[e,P,d]);const w=()=>{const y=e.slice(a,e.length).map(T=>_t(ne({},T),{isAdditional:!0}));y.length>0&&_o(y,l),c(e.length),i()};return t.jsxs("div",{"data-testid":"starter-prompt-chips",className:de("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",d&&e.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[t.jsxs("ul",{className:de("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",P||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:A,children:[e.slice(0,a).map((y,T)=>{var B;return t.jsx(ws.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:t.jsx(Om,{starterPrompt:y,starterPrompts:e,index:T,disabled:n,onSelectStarterPrompt:s})},(B=y.id)!=null?B:T)}),r&&e.length>a&&t.jsx(No,{clientThreadId:l,onClick:w})]}),!r&&e.length>a&&t.jsx(No,{clientThreadId:l,onClick:w})]})}const Op=({clientThreadId:e,currentModelId:s,isModelLoaded:n})=>{const[l,i]=u.useState(!1),r=st(),{prospectiveModelId:m}=Xo(e),a=n?s:m!=null?m:"auto",{promptStarters:c,shouldShowStarterPrompts:d,onSelectStarterPrompt:f}=Zo({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:e,limit:8,modelSlug:a});return t.jsx(ws.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:de(d&&!l&&"h-[116px]"),children:d&&c&&t.jsx(pa,{starterPrompts:c,onSelectStarterPrompt:f,disabled:r,clientThreadId:e,onExpand:()=>i(!0),mobileLayout:!0})})},Hp=({currentModelId:e,clientThreadId:s,isModelLoaded:n})=>{const{isUnauthenticated:l}=Ht(),i=hc(),[r,m]=u.useState(!1),a=st(),{prospectiveModelId:c}=Xo(s),d=n?e:c!=null?c:"auto",{promptStarters:f,shouldShowStarterPrompts:A,onSelectStarterPrompt:P}=Zo({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:d}),{shouldShow:w}=jm({clientThreadId:s,variant:"banner"}),{shouldShow:y}=Cm({clientThreadId:s,canShowBanner:!w}),T=A&&f;return(y||w)&&!T?null:t.jsx(ws.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:de("max-w-full max-sm:hidden",!i&&"min-h-[108px]",l&&r||i?"":"h-[70px]"),children:T&&t.jsx(pa,{starterPrompts:f,onSelectStarterPrompt:P,disabled:a,clientThreadId:s,onExpand:()=>m(!0)})})};function Wm({className:e,layout:s="grid",hideShuffleButton:n}){const l=$e(),i=st(),r=mc(),m=Uo(),a=Se(Qo(m).shouldShowAutocomplete$),[c,d]=u.useState(Po(r,[],4,s==="carousel"?1:2)),f=()=>{d(Po(r,c,4,2))};return!r||r.length===0?null:t.jsxs("div",{className:de("flex w-full flex-col gap-y-4 transition-opacity",e,a?"pointer-events-none opacity-0":"opacity-100"),children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("div",{className:"text-token-text-secondary text-base leading-7 sm:text-sm",children:l.formatMessage(Dt.trySomethingNew)}),!n&&t.jsx(Kr,{type:"button",onClick:f,label:l.formatMessage(Dt.shuffleTiles),color:"ghost",size:"medium",icon:pc})]}),t.jsx("div",{"data-testid":"starter-prompt-tiles",className:de(s==="grid"?"grid grid-cols-2 gap-4 sm:flex sm:flex-row":"-mx-(--thread-content-margin) flex flex-row gap-3 overflow-x-auto px-(--thread-content-margin) pb-4 sm:gap-4"),children:Array.from({length:4}).map((A,P)=>{const w=c[P];return w?t.jsx("div",{className:de("max-sm:short:h-[116px] relative h-[132px] sm:h-[144px]",s==="carousel"?"flex-1 max-sm:w-[164px] max-sm:flex-none":"w-full flex-1 sm:basis-0"),children:t.jsx($l,{initial:!1,children:t.jsx(ws.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeOut"},className:"absolute inset-0 h-full w-full",children:t.jsx(gc,{starterPrompt:w,allPrompts:r,index:P,disabled:i,className:"h-full w-full"})},w.id)})},P):t.jsx("div",{},P)})})]})}const Dt=Gt({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"},trySomethingNew:{id:"StarterPromptTiles.trySomethingNew",defaultMessage:"Try something new"},shuffleTiles:{id:"StarterPromptTiles.shuffle",defaultMessage:"Shuffle"}}),qm=It(()=>Wt(()=>import("./nib1icwsb20oe75f.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(e=>e.JawboneNotificationsBanner)),Gm=u.memo(function({className:s}){const{store:n}=Ce(),l=n.useIsHeaderContentAreaPopulated(),r=n.useContentAreaId(ls.HeaderTop)===h.AgentModeAnnouncementBanner?"z-0":Ac.PromptTextareaHeader;return t.jsx("div",{className:de(s!=null?s:"absolute start-0 end-0 bottom-full",r),children:t.jsx(Pc,{shouldRender:l,contentArea:ls.Header,children:t.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[t.jsx(Vm,{}),t.jsx(zm,{})]})})})});function Vm(){const e=_e(),{store:s}=Ce(),n=s.useSharedProps(d=>d==null?void 0:d.clientThreadId),l=s.useContentAreaId(ls.HeaderTop),i=_c(),r=Qe(n,d=>d==null?void 0:d.modelId),m=Se(()=>{var d;if(n&&Oo(e)){const f=Xs(e,n);return(d=Ho(f))==null?void 0:d.id}return r}),a=tt(nt);let c;switch(l){case h.ProjectConversationTaskNoFileAccess:c=t.jsx(Km,{});break;case h.AdvancedVoiceOnMobileAnnouncement:c=t.jsx(Ic,{clientThreadId:n});break;case h.S09KM1:c=null;break;case h.BannerSignup:c=t.jsx(Jm,{});break;case h.BannerTermsDisclaimer:c=t.jsx(Qm,{});break;case h.NewUserBannerTermsDisclaimer:c=t.jsx(Xm,{});break;case h.PromptTextareaAction:c=t.jsx(Zm,{});break;case h.BannersRateLimit:c=t.jsx(ep,{});break;case h.BannersBeaconUI:c=t.jsx(sp,{});break;case h.BannerSidekickAnnouncement:c=t.jsx(Hc,{});break;case h.SearchBrowserExtensionAnnouncement:c=t.jsx(Oc,{});break;case h.MoonshineAnnouncement:c=t.jsx(Uc,{});break;case h.GoldenHourAnnouncementBanner:c=!1;break;case h.SearchBrowserExtensionReactiveAnnouncement:c=t.jsx(Lc,{});break;case h.BannerMemoryAlmostFull:c=t.jsx(wo,{memoryAlmostFullVariant:!0});break;case h.BannerMemoryFull:c=t.jsx(wo,{});break;case h.Box:c=t.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",t.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case h.JawboneAnnouncement:i?c=t.jsx(qm,{}):c=null;break;case h.JawboneMaxActiveAnnouncement:i?c=t.jsx(Nc,{}):c=null;break;case h.PromoRedemptionAnnouncement:c=t.jsx(um,{});break;case h.OperatorAnnouncement:c=t.jsx(Dc,{});break;case h.BannerPlusUpsell:c=t.jsx(Fc,{});break;case h.BannerNoAuthTrials:c=t.jsx(Rc,{});break;case h.ReferrerRedemptionAvailableAnnouncement:c=t.jsx(Am,{});break;case h.RefereeRedemptionAvailableAnnouncement:c=t.jsx(bm,{});break;case h.ReferralProgramUpsellAnnouncement:c=t.jsx(jc,{});break;case h.TatertotIntakeFormAnnouncement:c=!1;break;case h.StudentsUpsellAnnouncement:c=t.jsx(Bc,{});break;case h.ModelDeprecationBanner:c=vc(m);break;case h.TeamSeatsPromoAnnouncement:c=t.jsx(Ec,{});break;case h.TeamsContextualAnswersUpsell:c=t.jsx(Mc,{});break;case h.AgentModeAnnouncementBanner:c=Qr(e)&&!a&&t.jsx(Cc,{});break;case h.LanguageUpsellBanner:c=t.jsx(kc,{onDismissSideEffect:()=>{ae.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),Co.set(e,!0)},onPrimaryCtaClickSideEffect:()=>{ae.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),Co.set(e,!0)}});break;case h.StarterPrompts:c=t.jsx(Wm,{hideShuffleButton:!0,layout:"carousel"});break;case h.ImageGenBanner:c=t.jsx(Tc,{className:"mb-3"});break;case h.SystemHintSuggestion:c=t.jsx(wc,{});break;default:c=null;break}return c}function zm(){const{store:e}=Ce(),s=e.useContentAreaId(ls.HeaderBottom);let n;switch(s){case sa.DallePromptControls:n=t.jsx(Ym,{});break;default:n=null;break}return n}const $m=It(()=>Wt(()=>import("./hhoxxrihkac1vju6.js"),__vite__mapDeps([7,1,2,3,4,5])).then(e=>e.default));function Ym(){const{store:e}=Ce(),s=e.useSharedProps(n=>n==null?void 0:n.composerController);return s?t.jsx($m,{composerController:s}):null}function Jm(){const{store:e}=Ce(),s=e.useSharedProps(i=>i==null?void 0:i.clientThreadId),n=Xr(),l=$c();return s?n?t.jsx(Yc,{threadId:s,showSignUp:l}):t.jsx(Jc,{threadId:s,showLogin:l}):null}function Km(){return u.useEffect(()=>()=>{Ve.getItem(ze.TasksHasSeenProjectDisclaimerBanner)||Ve.setItem(ze.TasksHasSeenProjectDisclaimerBanner,!0)},[]),t.jsx(Nt,{icon:t.jsx(Zr,{}),title:t.jsx(O,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:t.jsx(O,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{Ve.setItem(ze.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Qm(){const{store:e}=Ce(),s=e.useSharedProps(n=>n==null?void 0:n.clientThreadId);return s?t.jsx(zc,{threadId:s}):null}function Xm(){const{store:e}=Ce(),s=e.useSharedProps(n=>n==null?void 0:n.clientThreadId);return s?t.jsx(Vc,{threadId:s}):null}function Zm(){const{store:e}=Ce(),s=e.useSharedProps();return s?t.jsx(Gc,ne({},s)):null}function ep(){const{store:e}=Ce(),s=e.useSharedProps(l=>l==null?void 0:l.clientThreadId),n=e.useSharedProps(l=>l==null?void 0:l.composerController);return!s||!n?null:t.jsx(qc,{clientThreadId:s,composerController:n})}function sp(){const{store:e}=Ce(),s=e.useSharedProps(i=>i==null?void 0:i.openFileDialog),n=e.useSharedProps(i=>i==null?void 0:i.clientThreadId),l=e.useSharedProps(i=>i==null?void 0:i.composerController);return!n||!l||!s?null:t.jsx(Wc,{clientThreadId:n,openFileDialog:s})}const tp=5,np=u.memo(function(s){return op(s),ap(s),Kc({clientThreadId:s.clientThreadId,composerController:s.composerController,openFileDialog:s.openFileDialog}),rp(),null});function op(e){const{store:s}=Ce(),n=s.useSetSharedProps();Bt(()=>{n(e)},[e,n])}function ap(e){const{clientThreadId:s,canContinue:n}=e,{store:l}=Ce(),i=_e(),r=u.useRef({top:l.useContentAreaApi(ls.HeaderTop),bottom:l.useContentAreaApi(ls.HeaderBottom)}).current,m=Qc(s),{shouldShowBannerSignup:a,shouldShowBannerTermsDisclaimer:c}=ip(s),{isOpen:d}=Xc(),f=Zc(s),A=eu(s),P=su(e);tu(e);const w=nu(),y=ou(e),{shouldShowMemoryFull:T,shouldShowMemoryAlmostFull:B}=au(s),F=ru(e),k=iu(s),Y=lu(s),re=dm(),{eligible:ie}=Ue(cu),Z=uu(),me=du(),x=mu(),W=pu(),{eligible:q}=Ue(Xe.hasSeenTeamSeatsPromoAnnouncement),S=gu(s),L=hu(s),G=fu(),pe=Su(),le=xu(s),fe=Qe(s,se=>se==null?void 0:se.modelId),D=Se(()=>{var se;if(Oo(i)){const U=Xs(i,s);return(se=Ho(U))==null?void 0:se.id}return fe}),V=bu(s),H=Io(),ue=ta(),{eligible:Q}=Ue(Xe.hasSeenAgentModeAnnouncementBanner),M=Se(()=>yu(Xs(i,s)).activeSystemHintSuggestionChips$().length>0),X=Q&&ue&&H!==jt,z=ei(),ee=Ut(s),g=Au({shouldBeEnabledForDefaultAssistant:ee&&!z,clientThreadId:s}),C=Pu(),v=g==="hscroll",j=g==="image_gen_banner"&&C;Bt(()=>{c?r.top.set(h.BannerTermsDisclaimer):d?r.top.set(h.NewUserBannerTermsDisclaimer):D&&(V==null?void 0:V.kind)===si.GizmoInteraction&&V.gizmo&&ti(D,V.gizmo)?r.top.set(h.ProjectConversationTaskNoFileAccess):F.eligible?r.top.set(h.AdvancedVoiceOnMobileAnnouncement):f?r.top.set(h.BannersRateLimit):A?r.top.set(h.BannersBeaconUI):G?r.top.set(h.BannerPlusUpsell):pe?r.top.set(h.BannerNoAuthTrials):k?r.top.set(h.JawboneAnnouncement):Y?r.top.set(h.JawboneMaxActiveAnnouncement):P.eligible?r.top.set(h.BannerSidekickAnnouncement):w?r.top.set(h.MoonshineAnnouncement):y?r.top.set(h.SearchBrowserExtensionReactiveAnnouncement):re?r.top.set(h.PromoRedemptionAnnouncement):ie?r.top.set(h.OperatorAnnouncement):x?r.top.set(h.ReferralProgramUpsellAnnouncement):n?r.top.set(h.PromptTextareaAction):a?r.top.set(h.BannerSignup):B&&be(i,"684023316",{disableExposureLog:!0}).get("upsell_variant","control")!=="control"?r.top.set(h.BannerMemoryAlmostFull):T?r.top.set(h.BannerMemoryFull):Z?r.top.set(h.ReferrerRedemptionAvailableAnnouncement):me?r.top.set(h.RefereeRedemptionAvailableAnnouncement):W?r.top.set(h.StudentsUpsellAnnouncement):q?r.top.set(h.TeamSeatsPromoAnnouncement):S?r.top.set(h.ModelDeprecationBanner):L?r.top.set(h.TeamsContextualAnswersUpsell):le?r.top.set(h.LanguageUpsellBanner):X?r.top.set(h.AgentModeAnnouncementBanner):v?r.top.set(h.StarterPrompts):j?r.top.set(h.ImageGenBanner):M?r.top.set(h.SystemHintSuggestion):r.top.set(null)},[r,H,n,c,d,a,f,P,T,F,X,q,v,j,M]),Bt(()=>{m&&r.bottom.set(sa.DallePromptControls)},[r,m])}function rp(){const{store:e}=Ce();u.useEffect(()=>()=>{e.reset()},[e])}function ip(e){const s=_e(),{isUnauthenticated:n}=Ht(),l=be(s,"3637408529",{disableExposureLog:!0}),r=be(s,"3637408529").get("no_auth_banner_signup_rate_limit",tp),m=l.get("should_show_no_auth_signup_banner",!0),a=_u(P=>P.bannerDisclaimerClientThreadId),c=Cu(),d={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[f,A]=Qe(e,P=>{var w;return[ve.getConversationTurns(P).filter(y=>y.role===Wo.User).length,lp((w=ve.getCurrentNode(P))==null?void 0:w.message)]});return e&&(d.shouldShowBannerTermsDisclaimer=A&&n&&f===1&&!c&&(a==null||a===e),d.shouldShowBannerSignup=m&&A&&n&&f>0&&f%r===0),d}function lp(e){return(e==null?void 0:e.author.role)===Wo.Assistant&&ni(e)}function cp({modelSupportedImageMimeTypes:e}){const s=tt(nt),n=qo(),l=Go(),i=$e();return s?t.jsx(Ne.Item,{icon:wu,onClick:async()=>{const r=await gm();if(r)try{const m=atob(r.base64image),a=m.length,c=new Uint8Array(a);for(let f=0;f<a;f++)c[f]=m.charCodeAt(f);const d=new File([c],r.filename,{type:r.mimetype});Tu.uploadFile(n,d,e,i,l,void 0,void 0,As.Multimodal)}catch(m){}},children:t.jsx(O,{id:"HiFPUD",defaultMessage:"Attach screenshot"})},"attach_screenshot"):null}const up="manage-prompts",dp=()=>({data:null,isLoading:!1});function mp({hint:e,isHighlighted:s,onHighlight:n,onClick:l}){"use no forget";const i=ia(e.systemHint),r=t.jsx(_i,{as:"div",hasManagedFocus:!0,disabled:i.isBlocked,highlighted:s,icon:t.jsx(la,{hint:e,isNextToLabel:!0}),secondary:i.blockedLabel,onPointerMove:n,onClick:l,children:t.jsx("span",{className:"break-all",children:e.name})});return i.remainingLabel?t.jsx(Ci,{side:"right",labelTextAlign:i.isBlocked?"left":"center",label:i.remainingLabel,secondaryLabel:i.remainingLabelSecondary,contentClassName:"cant-hover:hidden",triggerAs:null,children:r}):r}const pp=yi(e=>{var s,n,l,i;return Ps(e)?{targets:[e.command,...(s=e.aliases)!=null?s:[],...(n=e.regexMatches)!=null?n:[],e.secondary?"".concat(e.title," ").concat(e.secondary):e.title],weight:e.matchWeight}:{targets:[e.systemHint,...(l=e.aliases)!=null?l:[],...(i=e.regexMatches)!=null?i:[],e.name]}});function gp({gptsAndAppsSlashCommands$:e,modelSlashCommands$:s,libraryPromptSlashCommands:n,slashCommands:l,systemHints:i,composerController:r,clientThreadId:m,layoutMode:a}){"use forget";const c=_e(),d=aa(),f=Ye(),A=$e(),{refs:P,floatingStyles:w}=di({placement:a==="center"?"bottom-start":"top-start",middleware:[mi({mainAxis:10,alignmentAxis:-18}),pi({padding:6}),gi({apply:({elements:g,availableWidth:C,availableHeight:v})=>{g.floating.style.setProperty("--radix-popper-available-width","".concat(C,"px")),g.floating.style.setProperty("--radix-popper-available-height","".concat(v,"px"))}})],whileElementsMounted:hi}),[y,T]=u.useState(void 0);u.useEffect(()=>{const g=oe(r);g.dispatch(fi(g.state.tr,{setReferencePosition:P.setReference,onHintMatch(C){T(v=>$o(v,C)?v:C)}}))},[r,P]);const B=Eu(),F=zo(m),{setThreadSystemHintMode:k,clearAllSystemHintModeTriggers:Y}=vu(),re=tt(nt),ie=Se(()=>y&&(e==null?void 0:e())),Z=Se(()=>{var g;return(g=s==null?void 0:s())!=null?g:[]}),me=(y==null?void 0:y.triggerSymbol)==="@",x=(y==null?void 0:y.triggerSymbol)==="/",W=!1,q=u.useCallback(()=>{},[c]),S=u.useMemo(()=>{const g=me?ie:ie==null?void 0:ie.filter(v=>v.type!==Ft.App),C=[g!=null?g:[]];return me?re?[]:C:C.concat([l,i,Z])},[me,x,n,ie,l,i,Z,W,A,f,q,re]),{displayGroups:L,suggestions:G}=u.useMemo(()=>{if(!y)return{displayGroups:[],suggestions:[]};const g=y.text?[Bu(To(S),y.text,pp,{locale:A.locale})]:S.map(v=>v.filter(j=>!Ps(j)||!j.noMatchEmpty)),C=a==="bottom"?g.reverse().map(v=>v.reverse()):g;return{displayGroups:C,suggestions:To(C)}},[S,y,a,A]),[pe,le]=u.useState(a==="bottom"?-1:0),fe=pe==null?null:(pe+G.length)%G.length,D=u.useCallback(g=>{le(C=>{if(C==null)return null;const v=G.length;for(let j=0;j<v;j++){const se=(C+v+(j+1)*g)%v,U=G[se];if(!("systemHint"in U?B.includes(U.systemHint):U.disabled))return se}return null})},[G,B]),V=Ks(D),H=G.length,ue=H===0;u.useEffect(()=>{a==="bottom"?(le(0),V.current(-1)):(le(-1),V.current(1))},[H,a,V]);const Q=fe==null?null:G[fe],M=u.useCallback(()=>{if(y!=null&&y.range){const g=oe(r);Si(g,y.range.from,y.range.to)}},[y,r]),X=({hintToSave:g=Q,expectPerfectMatch:C})=>{var Je;if(!y||!g)return!1;const v=y.text.toLocaleLowerCase(),se=(Ps(g)?g.command:g.name).toLocaleLowerCase()===v||((Je=g.aliases)==null?void 0:Je.some(b=>b.toLocaleLowerCase()===v));if(C&&!se)return!1;if(M(),$s(oe(r)),Ps(g))return g.onSelect(),!0;ae.logEvent("System Hint Selected",{system_hint:g.systemHint,conversation_id:F!=null?F:Ct});const U={clientThreadId:m};Y();const Me=g.systemHint===R.Search;return k(g.systemHint,!0,U,Me?Ai.CONVERSATION_COMPOSER_SLASH_SEARCH:Pi.SLASH_COMMAND),g.systemHint===R.Agent&&d==="show"&&_s(c,({onClose:b})=>t.jsx(ra,{clientThreadId:m!=null?m:Ct,onClose:b,source:"slash_agent"})),!0},z=Ks(X);u.useEffect(()=>{const g=oe(r);return ue||xi(g,C=>{if(C==="up")V.current(-1);else if(C==="down")V.current(1);else if(C==="cancel")$s(g),wi(g);else{if(C==="submit")return $s(g),z.current({expectPerfectMatch:!1});if(C==="checkMatch")return z.current({expectPerfectMatch:!0})}}),()=>$s(g)},[r,ue,Q,M,V,z]);const ee=Ks(F);return u.useEffect(()=>{var g;ue||ae.logEvent("System Hint List Opened",{conversation_id:(g=ee.current)!=null?g:Ct})},[ee,ue]),ue?null:t.jsx(bi,{ref:P.setFloating,style:w,className:de("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",G.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]"),onPointerDown:g=>{g.preventDefault()},children:L.map((g,C)=>{let v=0;for(let j=0;j<C;j++)v+=L[j].length;return t.jsx(Ne.Group,{children:g.map((j,se)=>{const U=v+se;return Ps(j)?t.jsx(ju,{command:j,isHighlighted:U===fe,onHighlight:()=>le(U),onClick:()=>{X({hintToSave:j,expectPerfectMatch:!1}),Ge(oe(r))}},j.command):t.jsx(mp,{hint:j,isHighlighted:U===fe,onHighlight:()=>le(U),onClick:()=>{X({hintToSave:j,expectPerfectMatch:!1}),Ge(oe(r))}},j.systemHint)})},C)})})}function hp({systemHints:e,availableSystemHints:s,composerController:n,clientThreadId:l,layoutMode:i,composerLayer:r,canUseInlineTagging:m,isFileUploadEnabled:a,fileUploadDisabledReason:c,currentModelConfig:d,openFileDialog:f,connectionInstanceData:A,setActiveSystemHintType:P,defaultModelId:w,selectModelId:y,gizmoId:T,hasGizmoFeatureRateLimit:B,setSelectedGizmoTag:F}){"use forget";const k=_e(),Y=$e(),re=Ye(),{connectedTypes:ie}=oi(),Z=Ot(),me=Z!=null&&ai(Z),x=ri(),{isSingleLine:W,showModelSlashCommands:q}=r,S=Vo(),L=u.useMemo(()=>{var ee;const M=[];W&&M.push({command:"upload",aliases:["file","attach","photo"],title:na(k,Y,!a,c,d==null?void 0:d.title),icon:t.jsx(oa,{"aria-label":"",className:"icon"}),onSelect:f,disabled:!a});const X=(ee=A==null?void 0:A.connection_statuses.filter(g=>g.user_connection_details.activation_status==="activated"&&["google_drive_oauth","google_drive_dwd"].includes(g.user_connection_details.knowledge_connector_type)).map(g=>g.user_connection_details.connection_type))!=null?ee:[],z=e==null?void 0:e.some(g=>g.systemHint===R.Slurm);return me&&(ie.size>0||X.length>0)&&z&&M.push({command:"all-connectors",title:Y.formatMessage({id:"6YT2cp",defaultMessage:"Use all connectors"}),icon:t.jsx(ku,{}),noMatchEmpty:!0,onSelect:()=>{P(R.Slurm,{analyticsMetadata:{clientThreadId:l}}),Le(l,g=>{var v,j;const C=(j=(v=g.selectedSources)==null?void 0:v.get(R.Slurm))!=null?j:new Set;g.selectedSources==null&&(g.selectedSources=new Map),g.selectedSources.set(R.Slurm,new Set([...C,...ie,...X]))})}}),x&&M.push({command:"add-mcp",aliases:["mcp"],title:"Add MCP",icon:t.jsx(Mu,{}),noMatchEmpty:!0,onSelect:()=>{re(ii(li.Connectors))}}),M},[k,e,W,d,a,c,x,A==null?void 0:A.connection_statuses,me,ie,Y,f,P,l,re]),G=u.useMemo(()=>Zs(()=>{if(!q)return[];const{data:M}=Ti(k);if(!M)return[];const X=[];for(const z of M.categories)z.defaultModel!==w&&X.push({command:z.defaultModel,title:z.label,disabled:!1,icon:t.jsx(ko,{className:"icon"}),onSelect:()=>{y(z.defaultModel,"slash menu")}});for(const z of M.groups)for(const ee of z.modelIds){const g=M.models.get(ee);if(g&&!g.tags.includes(ki.HIDDEN)){let C=g.title;X.push({command:g.id,title:C,secondary:void 0,trailing:t.jsx(Mi,{children:z.label}),noMatchEmpty:!0,matchWeight:.1,disabled:!1,icon:t.jsx(ko,{className:"icon"}),onSelect:()=>{y(g.id,"slash menu")}})}}return X}),[k,w,y,q]),pe=u.useMemo(()=>(s!=null?s:[]).filter(M=>!(M.isConnector&&M.hideFromInitialSelection)),[s]),le=u.useMemo(()=>(s!=null?s:[]).filter(M=>M.isConnector),[s]),fe=u.useMemo(()=>Zs(()=>{var j,se,U,Me,Je;if(!m)return[];const{data:M}=Ei(k),{data:X}=vi(k),{data:z}=Ru(k),ee=Fu([...(j=M==null?void 0:M.items)!=null?j:[],...(U=(se=X==null?void 0:X.list.items)==null?void 0:se.map(b=>b.resource))!=null?U:[],...Be(k,"773249106")?(Je=(Me=z==null?void 0:z.items)==null?void 0:Me.map(b=>b.gizmo))!=null?Je:[]:[]],b=>b.gizmo.id),g=T?ee.filter(b=>b.gizmo.id!==T):ee,C=le.map(b=>{var Ee,cs;return{command:(Ee=b.actionLabel)!=null?Ee:b.name,title:(cs=b.actionLabel)!=null?cs:b.name,type:Ft.App,icon:t.jsx(la,{hint:b,isNextToLabel:!0}),onSelect:()=>{S(b.systemHint),Bi(b.systemHint,Ri.AtMention,ji({clientThreadId:l}))}}}),v=g.map(b=>{var Ee;return{command:b.gizmo.display.name,title:b.gizmo.display.name,type:Ft.Gizmo,disabled:B,icon:t.jsx(ca,{simple:!0,isFirstParty:((Ee=b.gizmo.tags)==null?void 0:Ee.includes(Yo.FirstParty))===!0,src:b.gizmo.display.profile_picture_url,className:"icon",alt:""}),onSelect:()=>{ae.logEventWithStatsig("Composer GPT Selected","chatgpt_web_composer_gpt_selected",{gizmo:b.gizmo.id}),F(b)}}}).filter(b=>!C.some(Ee=>Ee.command===b.command));return[...C,...v]}),[m,k,T,B,F,le,S,l]),D=!1,{data:V,isLoading:H}=dp(),ue=u.useCallback(M=>{var z,ee,g;const X=oe(n);if(ci(X,"@"),M===up){re("/library?tab=prompts");return}if(Le(l,C=>{C.isUsingPromptTemplate=!0}),ae.logEventWithStatsig("chatgpt_web_prompt_used","chatgpt_web_prompt_used",{referer:"at_cmd",hint:(z=M.system_hint)!=null?z:"none",sources:((ee=M.sources)!=null?ee:[]).join(",")}),ui(X,M.prompt),M.system_hint&&(P(M.system_hint),(g=M.sources)!=null&&g.length)){const C=M.sources.map(U=>U.trim()).filter(Rt),v=M.system_hint,j=new Set(C.filter(U=>!rs(U))),se=new Set(C.filter(rs));Le(l,U=>{U.selectedSources=new Map([[v,j]]),U.selectedMCPSources=new Map([[v,se]]),U.hasModifiedSources=!0})}},[n,re,P,l]),Q=u.useMemo(()=>[],[H,D,V==null?void 0:V.prompts,ue]);return t.jsx(gp,{gptsAndAppsSlashCommands$:fe,modelSlashCommands$:G,libraryPromptSlashCommands:Q,slashCommands:L,systemHints:pe!=null?pe:[],composerController:n,clientThreadId:l,layoutMode:i})}function fp(e){"use forget";const s=qt.c(29),{clientThreadId:n,modelSupportedImageMimeTypes:l,openFileDialog:i,historyDisabled:r,isDisabled:m,highlightTooltip:a,disabledReason:c,currentModelName:d,isLoadingConnectors:f,connectorConfig:A,onSelectConnector:P,showLabel:w,showUpsell:y,hideBorder:T,isSmall:B,showMenuForNoAuth:F,visualTreatment:k}=e,Y=Fi(),{gdriveStatus:re,o365Status:ie}=Di(),{isUnauthenticated:Z}=Ht(),me=r?"text-white":a?"text-brand-blue-800":"",x=!y&&(re!=="false"||ie!=="false"||Y),{loggedOutAttachPlusIcon:W}=Jo(),q=Z&&!W?oa:Du;let S;s[0]!==me?(S=de("icon",me),s[0]=me,s[1]=S):S=s[1];let L;s[2]!==q||s[3]!==S?(L=t.jsx(q,{"aria-label":"",className:S}),s[2]=q,s[3]=S,s[4]=L):L=s[4];const G=L,pe=l.length>0;let le;s[5]!==n||s[6]!==A||s[7]!==d||s[8]!==c||s[9]!==T||s[10]!==a||s[11]!==G||s[12]!==m||s[13]!==f||s[14]!==B||s[15]!==Z||s[16]!==l||s[17]!==pe||s[18]!==P||s[19]!==i||s[20]!==x||s[21]!==w||s[22]!==F||s[23]!==y||s[24]!==k?(le=x?t.jsx(Nu,{clientThreadId:n,icon:G,showLabel:Z&&w,modelSupportedImageMimeTypes:l,isLoadingConnectors:f,connectorConfig:A,onSelectConnector:P,openFileDialog:i,isDisabled:m,highlightTooltip:a,disabledReason:c,currentModelName:d}):t.jsx(fm,{isSmall:B,hideBorder:T,clientThreadId:n,openFileDialog:i,showLabel:w,showUpsell:y,icon:G,isDisabled:m,highlightTooltip:a,disabledReason:c,currentModelName:d,visualTreatment:k,showMenuForNoAuth:F,modelSupportsImages:pe}),s[5]=n,s[6]=A,s[7]=d,s[8]=c,s[9]=T,s[10]=a,s[11]=G,s[12]=m,s[13]=f,s[14]=B,s[15]=Z,s[16]=l,s[17]=pe,s[18]=P,s[19]=i,s[20]=x,s[21]=w,s[22]=F,s[23]=y,s[24]=k,s[25]=le):le=s[25];const fe=le;let D;return s[26]!==fe||s[27]!==a?(D=t.jsx(Lu,{showBackground:a,className:"bg-brand-blue-800/20",children:fe}),s[26]=fe,s[27]=a,s[28]=D):D=s[28],D}const Sp=It(()=>Wt(()=>import("./nwkahx754oj8hp36.js"),__vite__mapDeps([8,1,2,3,4,5,9])).then(e=>e.GithubOnboardingModal)),xp=()=>null,bp=3e3,yp=()=>{};function Ip({onCreateNewCompletion:e,onContinueGenerating:s,account:n,currentModelId:l,currentModelConfig:i,disableDraftPersistence:r=!1,areModelsLoading:m,clientThreadId:a,isNewThread:c,isCompletionInProgress:d,disabled:f=!1,disabledReason:A,canPause:P=!1,canContinue:w=!1,isInteractableSharedThread:y,headerClassName:T,hideHeader:B,onlyAllowImageUploads:F,layoutMode:k,modelsData:Y,availableSystemHints:re,isSnorlaxEnabledForGizmo:ie,gizmoId:Z,hydratedConversationModeWithGizmoOverridePayload:me}){"use forget";var zn,$n,Yn,Jn,Kn,Qn,Xn,Zn;Mo.markStart("PromptTextarea"),Mo.markRendered("PromptTextarea");const x=_e(),[W,q]=Yl(),S=Uo();Uu(S),Ou();const L=Ot(),G=n==null?void 0:n.isTeam(),pe=n==null?void 0:n.isEnterprisey(),le=n==null?void 0:n.isBusiness(),fe=n==null?void 0:n.isEdu(),D=Qs(x),V=to(),H=$e(),ue=Go(),Q=qo(),M=Hu.useStore(),X=wt(o=>o.files.map(p=>p.fileId).filter(p=>p!=null)),z=!!(G||pe||le||fe),[ee,g,C,v,j,se]=Qe(a,o=>{var p,_,N,J,K;return[ve.getCurrentLeafId(o),ve.getRequestId(o),ve.findAsyncTaskMetadataNode(o),(N=(_=(p=ve.lastUserMessage(o))==null?void 0:p.metadata)==null?void 0:_.system_hints)==null?void 0:N.includes(R.Agent),!!(o!=null&&o.interruptionInProgress)&&!!((K=(J=ve.getCurrentNode(o))==null?void 0:J.message.metadata)!=null&&K.n7jupd_message),o==null?void 0:o.startedWithByoMcp]}),U=Qe(a,ve.getSteeringAsyncTaskId),Me=!!U,Je=Iu({clientThreadId:a,isKaur1br5Client:V}),b=u.useMemo(()=>Me?[]:re,[Me,re]),{gizmoEditorData:Ee,mode:cs,getGizmoId:$t}=Ni(),ga=Li(),ks=Ui(),ha=Oi(),Re=zo(a),at=!!Hi(),fa=Wu.useIsEnabled(a),Ms=!!st(),E=Io(),$=u.useMemo(()=>{var o;return(o=E&&(b==null?void 0:b.find(p=>p.systemHint===E)))!=null?o:null},[b,E]),ye=Ii(),Yt=Vo(),Jt=aa(),{exitPreview:Kt,isOpen:Qt,isInPreview:Xt}=qu(),Zt=E===R.Agent||($==null?void 0:$.systemHint)===R.Agent,en=V&&Zt&&Be(x,"3269508448"),{agentSessionModeNuxModal:Sa}=Gu({isAgentHintActive:Zt,isAgentSessionModeDropdownEnabled:en});Vu(S);const sn=u.useCallback(()=>{Jt==="show"&&_s(x,({onClose:o})=>t.jsx(ra,{clientThreadId:a,onClose:o,source:"composer_system_hint"}))},[Jt,x,a]),rt=u.useCallback(o=>{o!==null&&(Wi(o)?Yt(o,{analyticsMetadata:{clientThreadId:a}}):ye(o,{analyticsMetadata:{clientThreadId:a}}),o===R.Agent&&sn())},[ye,a,sn,Yt]),xa=ta(),ba=Ue(Xe.hasSeenAgentModeAnnouncementBanner),[it,us]=tt(o=>[qi(o),nt(o)]),ya=Gi(x),Aa=Vi(x),Pa=Se(()=>!zi()&&!no()),tn=$i(x).getLayer("3081064739"),Fe=!Aa&&!it&&Pa&&tn.get("composer-plus-menu",!1),nn=oo.useStore(),on=oo.useState(({locked:o})=>o),_a=Yi(),an=Ji(),{connectionInstanceData:rn,isLoading:Ca}=Ki({skip:!_a}),{selectedSources:Ze,selectedMCPSources:we,addSource:lt}=zu(a);u.useEffect(()=>{const o=W.get("add_source");o&&E&&(lt(o),W.delete("add_source"),q(W))},[E,lt,W,q]);const{eligible:ln,isLoading:cn}=Ue(Xe.hasSeenTatertotNux);u.useEffect(()=>{E===R.Tatertot&&Be(x,"1586944302")&&ln&&!cn&&_s(x,$u)},[E,ln,cn,x]);const un=Yu(x);Qi({skip:!un,productSku:ao.PROMPT_TEXT_AREA});const{platformConnectors:ct}=Xi(un&&((zn=we==null?void 0:we.size)!=null?zn:0)>0,ao.PROMPT_TEXT_AREA),{allAutoConnectors:wa}=Zi({getDisabledAutoConnectors:!1});el({platformConnectors:ct,enabled:wa.length>0&&z});const dn=u.useMemo(()=>Array.from(we!=null?we:[]).map(o=>ct.get(o)).filter(o=>o!==void 0),[we,ct]),ut=u.useRef(0),dt=be(x,"3396794266").get("restore_prompt_on_stop",!1),Es=u.useRef(null),[ge,es,Oe,ds]=me,Ta=Ju(),mt=Ku(a),ka=u.useCallback(()=>{Qt&&Xt&&Kt()},[Kt,Qt,Xt]),ss=ro(i,ge,E),ms=sl(),Ma=ms!=null,vs=tl(x).flags,Bs=vs==null?void 0:vs.includes(nl.NoAuthEnableFileUploads),ps=b==null||b.length>0,gs=ol(),Ea=u.useMemo(()=>{var o;return(o=b==null?void 0:b.filter(p=>gs.has(p.systemHint)))!=null?o:[]},[b,gs]),pt=u.useCallback(()=>{ye(null,{analyticsMetadata:{clientThreadId:a}})},[ye,a]),mn=al(),ts=Pp(Y),js=u.useCallback((o,p)=>{ae.logEventWithStatsig("Model Switcher Model Changed","chatgpt_model_switcher_model_changed",{from:l,to:o}),rl(x,o)||(Be(x,"1333611684")?il(x).mutate({modelSlug:o}):ll(x,o)),mn({clientThreadId:a,modelId:o,location:p}),io(a)},[l,mn,x,a]),pn=u.useCallback(o=>{cl()&&(o==null||o.preventDefault()),js(ts!=null?ts:"","remove non-default model")},[js,ts]),Rs=Qu(l,($n=$==null?void 0:$.systemHint)!=null?$n:null),va=!f&&(ss!==As.None||m)&&(D||Bs),Te=ul(i,ge),Fs=dl(i,ge),He=wt(o=>cs==="magic"?o.files.filter(p=>p.gizmoId!=null):o.files.filter(p=>p.gizmoId==null),$o),[gt]=u.useState(()=>Xu()),Ba=Zu(),gn=He.length>0||Ba,hn=wt(ml.hasUploadInProgress),ja=ed(o=>o.selectedApps),Ra=hd(),Fa=sd(a),Da=u.useMemo(()=>Zs(()=>im(i,Vl(S))),[i,S]),ht=Se(Da),Ds=Se(()=>lo(S)),fn=!Ds,Ns=!ht&&!hn&&(fn||gn),{composerThinkingEffort$:Na}=pl(S),Sn=(ss===As.Multimodal?gl:hl)-He.length,xn=Sn<=0,La=($==null?void 0:$.systemHint)===R.Research,Ua=Be(x,"3544641259"),{selectedRepos:ft}=td(a),bn=(La||Rs)&&Ua&&(Ze==null?void 0:Ze.size)===0&&(we==null?void 0:we.size)===0,yn=(Yn=C==null?void 0:C.message.metadata)==null?void 0:Yn.async_task_id,Ie=nd(o=>yn?o.tasks[yn]:null),Ls=(Ie==null?void 0:Ie.status)===od.RUNNING&&!mt,An=(Kn=ad((Jn=Ys(a))!=null?Jn:a))==null?void 0:Kn.value,Oa=An===co.STREAMING,Pn=An===co.REALTIME,Us=d&&P||Oa||Pn||Ls,Os=Ns&&!f&&!Ms&&(!Us||mt)&&!bn,{targetedContent:Hs,setTargetedContent:Is}=rd(),I=Hs!=null&&Hs.isFocusedViewContent&&!ha?void 0:Hs,hs=fl(x);u.useEffect(()=>{!I||hs.composer.autofocusDisabled$()||requestAnimationFrame(()=>requestAnimationFrame(()=>{Ge(oe(S))}))},[I,hs,S]);const{getUpsellLabelType:Ha,getUpsellShowsAttach:Ia}=id(),_n=Jo(),{isSingleLine:We,plusButtonAddsFiles:Wa,loggedOutAttachLabel:qa,loggedOutHideToolButtons:Cn,fullyCollapsedToolMenu:Ga,showSlashHint:Va,showSelectedModelInComposer:za,showModelsInPlusMenu:$a}=_n,St=Ga&&!Fe,Ya=$a&&!Fe,Ja=ps&&D&&(!G||!Ca)&&!uo(E)&&!We,fs=Se(ld(S).isWhisperActive$);u.useCallback(()=>{q(o=>(o.delete("share_prompt"),o))},[q]),u.useCallback(o=>{if(Le(a,p=>{p.isUsingPromptTemplate=!0}),Js(oe(S),o.prompt),o.system_hint){const p=o.system_hint;if(ye(p),o.sources){const _=o.sources.map(K=>K.trim()).filter(Rt),N=new Set(_.filter(K=>!rs(K))),J=new Set(_.filter(rs));Le(a,K=>{K.selectedSources=new Map([[p,N]]),K.selectedMCPSources=new Map([[p,J]]),K.hasModifiedSources=!0})}}},[a,S,ye]),yp(x,W.get("share_prompt")),u.useEffect(()=>{if(!(L!=null&&L.id))return;const o=Eo.getAndReset(L.id,Re);o&&Js(oe(S),o.inputText)},[L==null?void 0:L.id,Re,S]),u.useEffect(()=>{var p;const o=(p=W.get("prompt"))!=null?p:"";lo(S)&&o.length>0&&Js(oe(S),o)},[S,W]);const xt=u.useCallback(()=>{E!==R.Slurm&&E!=null&&!(b!=null&&b.some(o=>o.systemHint===R.Slurm))||($==null&&ye(R.Slurm),Le(a,o=>{var _,N;const p=(N=(_=o.selectedSources)==null?void 0:_.get(R.Slurm))!=null?N:new Set;o.selectedSources==null&&(o.selectedSources=new Map),o.selectedSources.set(R.Slurm,new Set([...p,Sl.GITHUB_CONNECTOR]))}))},[E,$,a,ye,b]);u.useEffect(()=>{if(W.has("github_onboarding")){const o=W.get("github_onboarding");let p=ys.ConfigureRepos;o&&[ys.ConfigureRepos,ys.SyncRepos,ys.IndexRepos].includes(o)&&(p=o),an&&p!==ys.ConfigureRepos?xt():_s(x,Sp,{initialState:p,onFinishFlow:xt}),q(_=>(_.delete("github_onboarding"),_))}},[W,q,x,E,$,a,ye,b,xt,an]),u.useEffect(()=>{const o=xl(W),p=E!=null?E:o[0],_=p===R.Slurm,N=p===R.Research;if(!_&&!N)return;const J=W.getAll("sources");if(!J.length)return;const K=W.get("redirect_source"),De=J.map(ce=>ce.trim()).filter(Rt),Pe=new Set(De.filter(ce=>!rs(ce))),te=new Set(De.filter(rs));Le(a,ce=>{ce.selectedSources=new Map([[p,Pe]]),ce.selectedMCPSources=new Map([[p,te]]),ce.hasModifiedSources=!0}),q(ce=>(ce.delete("sources"),ce)),K==="suggested_ca_prompts"&&ae.logEventWithStatsig("chatgpt_contextual_answers_connector_activated","chatgpt_contextual_answers_connector_activated",{source:"suggested_ca_prompts"})},[a,lt,W,ye,q,E]);const ke=bl(i,ge),bt=Se(yl(x,a)),{handleFileAccepted:wn}=Sm(H,ro(i,ge,E),Te,"mouse",$t,ke==null?void 0:ke.attachments,bt),Ka=u.useCallback((o,p)=>{const _=Ke(x);return _.keepSheetOpen$.set(!1),_.isSheetOpen$.set(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{Ge(oe(S))})}),wn(o,p)},[S,wn,x]),Tn=Se(Ke(x).keepSheetOpen$);u.useEffect(()=>{if(!Tn)return;const o=new AbortController,p=document.getElementById("upload-camera"),_=[];function N(){for(const Pe of _)Pe();o.abort(),_.length=0}function J(Pe){var ce;if(Pe.target instanceof HTMLInputElement&&((ce=Pe.target.files)==null?void 0:ce.length)===0)return;const te=Ke(x);yo(()=>{te.keepSheetOpen$.set(!1),te.isSheetOpen$.set(!1),N()})}function K(){const Pe=Ke(x);yo(()=>{Pe.keepSheetOpen$.set(!1),Pe.isSheetOpen$.set(!1),N()})}p&&_.push(mo(p,{change:J,cancel:K}));const De=document.getElementById("upload-photos");return De&&_.push(mo(De,{change:J,cancel:K})),N},[Tn,x]);const Ae=!f&&!xn&&va&&ms==null&&!Me,{getInputProps:Qa,open:kn}=hm(ne({disabled:!Ae,noClick:!0,onFileDialogCancel:()=>{Ke(x).keepSheetOpen$.set(!1)},onDropAccepted:Ka,onDropRejected:o=>{xm(o,H,ue,ss),Ke(x).keepSheetOpen$.set(!1)},multiple:!0,maxSize:Pl,maxFiles:Sn},Al(!D||F?Te:Fs))),qe=u.useCallback(()=>{Ae&&(ae.logEventWithStatsig("Open File Viewer","chatgpt_web_file_viewer_opened",{intent:ss.toString()}),kn())},[Ae,kn,ss]),Mn=_l(gt),En=u.useCallback(()=>{Cl(oe(S)),Mn.clearMessages(),vo(S).resetData();for(const o of He)bs.remove(Q,o.tempId,"none");cd.markAllAsSent()},[S,Mn,He,Q]),Xa=u.useMemo(()=>{if(us)return ud;if(it)return dd;if(to())return md},[us,it]),vn=Se(()=>us&&ya&&po.sidebarUrlTrayOpen$());pd();const Za=wl(),{systemHints:yt}=Tl(),Bn=Mt((o,p)=>{var ce;if(o.preventDefault(),f||!Ns&&!p||!ge||j)return;const _=go(oe(S).state.doc),N=_.content;Ss==="streaming"&&(ae.logEventWithStatsig("chatgpt_web_conversation_stream_interrupted","chatgpt_web_conversation_stream_interrupted",{interrupted_message_length:N.length}),Tt.count(kt.DEFAULT,"chatgpt_web_conversation_stream_interrupted",[])),Tt.count(kt.DEFAULT,"chatgpt_web_conversation_completion_sent",[]);const{content:J,attachments:K}=gd(Q,N,i,ge,E),De=ho(nn).some(xe=>xe===R.Slurm||xe===R.Research);Le(a,xe=>{xe.hasModifiedSources=!1,xe.hasModifiedGithubRepos=!1,xe.startedWithByoMcp===void 0&&De&&(xe.startedWithByoMcp=dn.some(Pt=>Pt.status==="ONLY_ME"))}),Ta(),ka();const Pe=Bo.getState().attachedTempTextdocs;dt?Es.current={content:_.content,files:He.map(xe=>ne({},xe)),attachedTempTextdocs:Object.fromEntries(Object.entries(Pe).map(([xe,Pt])=>[xe,ne({},Pt)])),systemHintType:E!=null?E:null,selectedSources:Ze?[...Ze]:void 0,selectedMCPSources:we?[...we]:void 0}:Es.current=null;const te=l===kl?Ml(Na):void 0;e(ne({clientThreadId:a,ctx:x,sourceEvent:o,attachments:K,content:J,contentToSend:_,conversationMode:ge,hasSelectedApps:Ra,isMessageFollowupsEnabled:fa,selectedApps:ja,desktopOrigin:Xa,shouldCollectSidebarContext:vn,desktopSidebarContext:po.context$(),selectedGizmoTag:Oe,selectedRepos:{selectedAllRepos:ft.selectedAllRepos,selectedRepos:ft.selectedRepos?[...ft.selectedRepos]:null},selectedSources:Ze,selectedMCPConnectors:dn,startedWithByoMcp:se===!0,systemHints:ho(nn),allSystemHints:yt!=null?yt:[],isN7jupdActive:Rs,isForceAllowCustomMcpModeEnabled:Za,thinkingEffort:te},vo(S).getData(_.content))),(ce=I==null?void 0:I.onCreateCompletion)==null||ce.call(I,{serverThreadId:Re,currentLeafId:ee}),(I==null?void 0:I.shouldPersistAcrossMessages)!==!0&&Is(void 0),fo.hideThreadHeader();for(const xe of He)xe.status===El.Ready&&M.addFile(xe);En(),xa&&E===jt&&ba.markAsViewed()}),er=o=>{Is(o.targetedReply),o.targetedReply&&ae.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:Re,sourceMessageId:o.messageId})},{maybeSetWaitingForRealtimeOnAbort:jn,isWatingForRealtimeStatusChange:sr}=fd(a),At=u.useCallback((o,p="other")=>{jn(),Sd(o,void 0,{clientInitiated:!0,reason:p,isLastTurnAgent:v,hasAgentSystemHint:E===jt})},[jn,v,E]),Rn=u.useCallback(()=>{var o;(o=I==null?void 0:I.onCleared)==null||o.call(I,{serverThreadId:Re,currentLeafId:ee}),Is(void 0),Ge(oe(S))},[ee,Re,I,Is,S]),Ws=vl(i==null?void 0:i.tags,ge==null?void 0:ge.kind),{autocompletions$:tr,shouldShowAutocomplete$:qs}=Qo(S),nr=u.useCallback(()=>qs()&&c,[qs,c]),Fn=Mt(o=>xd(o,{toaster:ue,canSubmit:Os,isTextContentTooLong:ht,requestCompletion:Bn})),or=Ls||Pn,Dn=Mt(o=>bd(o,{canAbortCompletion:P&&d&&!or,clientThreadId:a,isAutocompletionActive:nr,clearAutocompletions:()=>tr.set([]),abortCompletion:()=>At(a,"escape_key"),isEmpty:Ds,hasTargetedContent:I!=null,clearTargetedContent:Rn,hasSystemHint:$!=null,removeSystemHint:pt,hasSelectedTarget:Oe!=null,removeSelectedTarget:()=>ds(null),hasNonDefaultModel:za&&l!==ts,removeNonDefaultModel:pn}));u.useEffect(()=>{if(!Os)return;Be(x,"4178431533")||yd(!0).then(p=>{Ad.startEnforcement(p),Pd.startEnforcement(p)})},[Os,x]),u.useEffect(()=>Bl(oe(S),{Enter:Fn,Escape:Dn}),[S,Fn,Dn]);const ar=o=>{Me||em({filePickerStore:Q,event:o.nativeEvent,intl:H,toaster:ue,clientThreadId:a,conversationMode:ge,currentModelConfig:i,getEditorGizmoId:$t,modelSupportedImageMimeTypes:Te,activeSystemHintType:E,ctx:x,contextScopes:bt})},rr=jl(a,gt,Te,ke==null?void 0:ke.attachments),ir=u.useCallback((o,p)=>{o.preventDefault(),At(a,p),ae.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:Ys(a),currentLeafId:ve.getCurrentNode(So(a)).message.id,eventSource:"mouse"});const _=Es.current;dt&&_&&(Js(oe(S),_.content),bs.restoreFiles(Q,_.files),Bo.setState({attachedTempTextdocs:_.attachedTempTextdocs}),_.systemHintType&&(ye(_.systemHintType),Le(a,N=>{var J,K;_.selectedSources&&(N.selectedSources=(J=N.selectedSources)!=null?J:new Map,N.selectedSources.set(_.systemHintType,new Set(_.selectedSources))),_.selectedMCPSources&&(N.selectedMCPSources=(K=N.selectedMCPSources)!=null?K:new Map,N.selectedMCPSources.set(_.systemHintType,new Set(_.selectedMCPSources)))})),Es.current=null),_d()},[a,At,S,Q,ye,dt]),Nn=u.useCallback(()=>{Eo.set(L==null?void 0:L.id,Re,Cd(S))},[Re,L==null?void 0:L.id,S]),Ln=Ee!=null;u.useEffect(()=>{Ln||hs.composer.autofocusDisabled$()||Ge(oe(S))},[S,Ln,hs]);const Un=Ks(He);u.useEffect(()=>{var p;if(Te.length>0)for(const _ of Un.current)wd((p=_.fileSpec)==null?void 0:p.mimeType,Fs)||bs.remove(Q,_.tempId,"none");else bs.reset(Q)},[l,Q,Fs,Te.length,Un]),u.useEffect(()=>{(!Ws&&Oe||at)&&ds(null)},[Ws,Oe,at,ds]);const lr=be(x,"4031588851"),On=be(x,"3637408529"),cr=On.get("is_in_composer_text_exp",!1),ur=On.get("composer_text","MESSAGE_CHATGPT"),dr=lr.get("composer_text","MESSAGE_CHATGPT"),mr=cr?ur:dr,Hn=Se(()=>Td(Xs(x,a)).fullscreenWidgetPlaceholder$(H)),[Gs,pr]=(()=>{const o=A?kd(A):void 0;if(o)return[o.placeholder,o.isLastingDisabledStyle];if(y)return[he.placeholderWithName,!1];if((I==null?void 0:I.placeholderTextOverride)!=null)return[I.placeholderTextOverride,!1];if((i==null?void 0:i.id)===Rl)return[he.n7jupdSystemHintPlaceholder,!1];if($){if(uo($.systemHint))return Us?[he.n7jupdActivePlaceholder,!1]:[he.n7jupdSystemHintPlaceholder,!1];switch($.systemHint){case R.Search:return[he.searchPlaceholder,!1];case R.Think:return[he.thinkPlaceholder,!1];case R.Slurm:return[he.connectorPlaceholder,!1];case R.ApiTool:return[he.apiToolPlaceholder,!1];case R.Research:return[he.researchPlaceholder,!1];case R.Canvas:return[he.canvasPlaceholder,!1];case R.Picture:return[he.picturePlaceholder,!1];case R.PictureV2:return[he.pictureV2Placeholder,!1];case R.Tatertot:return[he.tatertotPlaceholder,!1]}}switch(mr){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[he.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[he.placeholderAskNameAnythingVariant,!1];default:return[he.placeholderWithName,!1]}})(),gr=(()=>{var o,p;return ie?c?H.formatMessage(Md.newChatInProject,{projectName:(o=es==null?void 0:es.gizmo.display.name)!=null?o:"this project"}):Gs?H.formatMessage(Gs,{name:"ChatGPT"}):"​":Hn||(Gs?H.formatMessage(Gs,{name:Ee!=null?cs==="magic"?Fl:Ee.name||"GPT":(p=es==null?void 0:es.gizmo.display.name)!=null?p:"ChatGPT"}):"​")})();u.useEffect(()=>xo(()=>Ao(S),()=>{ut.current=performance.now(),zl.getState().isThreadHeaderVisible&&fo.hideThreadHeader(),lm(a)&&cm(a)}));const{shouldHighlight$:hr}=Ed(S),Vs=Se(()=>hr()),{connectorConfig:ns,isLoading:fr}=Dl(),{onSelectConnector:zs}=vd({connectorConfig:ns,modelSupportedImageMimeTypes:Te,modelAcceptedMimeTypes:Fs,attachmentsProductFeature:ke==null?void 0:ke.attachments,onOauthRedirect:Nn});Bd(ns,zs);let In=null;const Wn=Ia(),Sr=D||Wn||Bs,{showRecentFilesDropdown:xr}=jd(x,!0),os=ss===As.None&&!m?Et.ModelNotSupported:xn?Et.HasReachedMaxFiles:ms!=null?Et.RateLimitReached:void 0,br=t.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:t.jsx(fp,{clientThreadId:a,modelSupportedImageMimeTypes:Te,openFileDialog:qe,historyDisabled:ks,highlightTooltip:Vs,isLoadingConnectors:fr,connectorConfig:ns,onSelectConnector:zs,showLabel:Ha()==="all"&&(Qs(x)||qa),showUpsell:Wn&&!Bs,showMenuForNoAuth:Bs,isDisabled:!Ae||fs,disabledReason:os,currentModelName:(Qn=i==null?void 0:i.title)!=null?Qn:"",visualTreatment:D?"composer-btn":"legacy"})},"file-upload-button");u.useEffect(()=>Nl(x).addAction({key:"uploadFile",action:qe,actionMessageDescriptor:na(x,H,!Ae,os,i==null?void 0:i.title),group:Fd.Chat,keyboardBinding:Rd}),[x,i,os,H,Ae,qe]);const yr=be(x,"853191128"),Ar=!D&&Be(x,"3259514411")&&yr.get("is_tatertot_enabled",!1),qn=Te.length>0;if(We&&!Me){const p=!Fe&&ps&&((Xn=b==null?void 0:b.length)!=null?Xn:0)>5,_=Array.from(ns.values()).some(te=>te.access_token!=null),N=Fe&&tn.get("no-explicit-add-from-social",!1),J=D&&Ae&&Fe&&!N&&_?t.jsx(Ne.Group,{children:t.jsx(jo,{includeAction:!0,shortName:!0,connectorConfig:ns,onConnectorClick:zs})},"connect-apps"):null,K=[St&&D&&(ps||J)?t.jsxs(sm,{layoutMode:k,children:[t.jsx(Ne.Group,{children:t.jsx(vt,{systemHints:b,activeConnectorSystemHintTypes:gs,selectedHintType:E,onSelectHintType:rt})}),J]},"tools-menu"):null,Ya?t.jsx(tm,{layoutMode:k,selectedModelId:l!=null?l:"",onSelectModelId:te=>{js(te,"plus menu")}},"models-menu"):null].filter(te=>te!=null),De=b&&(p?b.slice(0,4):b),Pe=[t.jsxs(Ne.Group,{className:"content-sheet:content-sheet-inset-section",children:[t.jsx(Dd,{openFileDialog:qe,modelSupportsImages:qn,mode:Fe?"sheet":void 0,showMenuForNoAuth:!1,isDisabled:!Ae,disabledReason:os,currentModelName:i==null?void 0:i.title,rateLimitInfo:ms}),D&&t.jsxs(t.Fragment,{children:[Ae&&qn&&t.jsx(Nd,{modelSupportedImageMimeTypes:Te}),!Fe&&Ae&&t.jsx(jo,{includeAction:!0,shortName:!0,connectorConfig:ns,onConnectorClick:zs}),xr&&t.jsx(Ld,{attachedFileIds:X,onAttachLibraryFile:te=>bs.attachLibraryFile(Q,te)}),t.jsx(Ud,{}),t.jsx(cp,{modelSupportedImageMimeTypes:Te})]})]},"add-files"),(!St||!D)&&ps?t.jsxs(Ne.Group,{children:[t.jsx(vt,{systemHints:De,activeConnectorSystemHintTypes:gs,selectedHintType:E,onSelectHintType:rt}),p&&t.jsxs(Od,{layoutMode:k,children:[t.jsx(Ne.Group,{children:t.jsx(vt,{systemHints:b==null?void 0:b.slice(4),activeConnectorSystemHintTypes:gs,selectedHintType:E,onSelectHintType:rt})}),J]})]},"system-hints"):null,(!St||!D)&&J&&(!p||!ps||Fe)?J:null,K.length>0?t.jsx(Ne.Group,{children:K},"submenus"):null,D?null:t.jsx(Hd,{},"upsell"),Va?t.jsx(Ne.Group,{children:t.jsx("div",{className:"text-token-text-tertiary p-2 text-center text-sm",children:H.formatMessage({id:"composer.plusMenu.typeSlashForQuickAccess",defaultMessage:"Type '/' for quick access"})})},"slash-hint"):null].filter(te=>te!=null);In=Wa?t.jsx(Ro,{disabled:f,clientThreadId:a,rateLimitPopup:ms,highlightTooltip:Vs,label:D?H.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):H.formatMessage({id:"composer.plusMenu.label.loggedOut.photosOnly",defaultMessage:"Add photos"}),children:t.jsx(Id,{onClick:qe,disabled:fs})}):t.jsx(Wd,{mode:Fe?"sheet":"dropdown",onCloseAutoFocus:te=>{hs.composer.autofocusDisabled$()||(te.preventDefault(),Ge(oe(S)))},items:Pe,fileUploadRateLimited:Ma,children:t.jsx(Ro,{disabled:f,clientThreadId:a,rateLimitPopup:null,highlightTooltip:Vs,label:D?H.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):H.formatMessage({id:"composer.plusMenu.label.loggedOut",defaultMessage:"Add photos and more"}),secondaryLabel:t.jsx("kbd",{className:"bg-token-bg-tertiary -me-1 inline-grid aspect-square w-4 items-center justify-center rounded-sm text-[11px]",children:t.jsx("span",{children:"/"})}),children:t.jsx(qd,{onDoubleClick:Ae?qe:void 0,onPointerDown:te=>{if(no())return;const ce=Gd(x);ce.isKeyboardOpen()&&(te.preventDefault(),ce.closeKeyboard(()=>{Ke(x).isSheetOpen$.set(!0)}))},disabled:fs})})})}const[Pr,Gn]=u.useState(!1),_r=pr||sr?"disabled":"default",Cr=!Os,wr=Xd({promptDisabledReason:A,hasPendingFiles:hn,hasTextContent:fn,isTextContentTooLong:ht,hasAsyncTaskPending:Fa,noSourceSelectedDr:!bn,isDeepResearchTaskStreaming:Ls,isThreadHardBlocked:Ms}),Ss=Us?"streaming":Cr?"disabled":"idle",xs=u.useRef(null),as=u.useRef(null),Tr=Be(x,"222560275")||l&&!l.startsWith("o1")&&!l.startsWith("o3");u.useEffect(()=>{const o=()=>{xs.current!=null&&bo.addAction("composer_state_disabled",{threadId:Ys(a),disabledReason:xs.current})};if(Ns&&Ss==="disabled"){let p="unknown";f?p=A!=null?A:"component_disabled_unknown":d?p="completion_in_progress":Ms&&(p="thread_hard_blocked"),xs.current!==p&&(as.current&&clearTimeout(as.current),as.current=setTimeout(o,bp)),xs.current=p}else xs.current=null;return()=>{as.current&&(clearTimeout(as.current),as.current=null)}},[a,Ns,Ss,f,A,d,Ms]);const Vn=[I!=null&&I.label?{type:I.type,value:I.label,onRemoveRegion:Rn}:null,Oe!=null?{type:"mention",value:Oe.gizmo.display.name,icon:t.jsx(ca,{isFirstParty:!!((Zn=Oe.gizmo.tags)!=null&&Zn.includes(Yo.FirstParty)),src:Oe.gizmo.display.profile_picture_url,className:"icon"}),onRemoveRegion:()=>{ds(null),Ge(oe(S))}}:null].filter(o=>o!=null);U&&Ie&&Ie.taskId===U&&Vn.push({type:"text",value:Ie.title,hideQuotes:!0,onRemoveRegion:()=>io(a)});const kr=u.useMemo(()=>Zs(()=>c&&($==null?void 0:$.systemHint)!==R.Research&&($==null?void 0:$.systemHint)!==R.ApiTool&&!Rs&&qs()),[c,$,Rs,qs]),Mr=o=>{if(o.preventDefault(),o.stopPropagation(),ut.current>0){const p=performance.now()-ut.current;Tt.hist(kt.DEFAULT,"final_user_input_to_submit_ms",[],p)}Ss==="streaming"&&(!mt||Ds)?Ls?Gn(!0):ir(o,Ds?"stop_button":"stop_button_with_prompt"):Bn(o)};u.useEffect(()=>{const o=Ys(a),p=n==null?void 0:n.normalizedAccountUserId;if(!p||r||us||ks)return;const _=Ll(N=>{if(Ul(N.doc))Ol(o);else{const J=go(N.doc).content;Hl(o,J,p)}},1e3);return xo(()=>Ao(S),_)},[n,a,S,r,us,ks,Re]),u.useEffect(()=>{setTimeout(()=>{bo.addFirstTiming("composer.ttfi")},0)},[]);const Er=t.jsx(np,{canUseInlineTagging:Ws,isDisabled:f,clientThreadId:a,currentLeafId:ee,currentRequestId:g,canContinue:w,composerController:S,isNewThread:c,onContinueGenerating:o=>{var p;return s({event:o,conversationMode:(p=So(a))==null?void 0:p.mode,systemHints:E?[E]:[]})},onResetState:En,openFileDialog:qe,conversationMode:ge}),vr=!Us&&ge!=null&&Tr&&Vd.includes(ge.kind)&&t.jsx(zd,{clientThreadId:a,onTargetedReply:er}),Br=t.jsx(nm,{composerController:S,parsedDocumentHandler:rr}),jr=!B&&t.jsx(Gm,{className:T}),Rr=t.jsx($d,{modelSupportedImageMimeTypes:Te,uploadType:As.Multimodal,attachmentsProductFeature:ke==null?void 0:ke.attachments,contextScopes:bt}),Fr=Be(x,"3127600850"),Dr=[!We&&Sr?br:null,!D&&!We&&!Cn?t.jsx(om,{account:n,clientBootstrapFlags:vs,features:ga,currentModelConfig:i,isDisabled:fs,clientThreadId:a,composerController:S,gizmoId:Z}):Ja?t.jsx(am,{activeSystemHintType:E,systemHints:b,composerController:S,clientThreadId:a,disabled:fs}):null,!D&&!We&&!Cn&&Ar?t.jsx(rm,{composerController:S,clientThreadId:a}):null].filter(o=>o!=null);return t.jsxs(Yd.Provider,{value:gt,children:[t.jsxs("div",{className:de("pointer-events-auto relative z-1 flex h-[var(--composer-container-height,100%)] max-w-full flex-[var(--composer-container-flex,1)] flex-col"),onPaste:ar,children:[t.jsx(Jd,{onOauthRedirect:Nn}),Fr&&t.jsx(xp,{}),jr,Ie&&Pr&&t.jsx(Kd,{taskId:Ie.taskId,clientThreadId:a,onClose:()=>Gn(!1)}),t.jsx(Qd,{hasFiles:gn,pendingFiles:He,isUploadDisabled:!Ae,clientThreadId:a,highlightUploadTooltip:Vs,disableReason:wr,uploadButtonDisabledReason:os,currentModelConfig:i,conversationMode:ge,state:Ss,inputState:_r,gizmoId:Z,includeSidebarContextTray:vn,isTemporaryChat:ks,placeholder:gr,composerController:S,onSubmit:Mr,replyRegions:Vn,leadingAction:In,legacyFooterActions:Dr,activeSystemHint:$,activeConnectorSystemHints:Ea,shouldShowAgentSessionModeDropdown:en,hideSystemHint:on||!D&&!We,isSystemHintLocked:on,onRemoveSystemHint:pt,onRemoveModel:pn,contextualAnswerUserConnectionData:rn,fileInput:t.jsx("input",ne({},Qa())),expanded:We?void 0:!0,expandOnMultilineInput:We,layoutMode:k,agentSessionModeNuxModal:Sa,isAgentSessionModeDropdownDisabled:Je}),t.jsx(hp,{systemHints:b!=null?b:[],availableSystemHints:b!=null?b:[],composerController:S,clientThreadId:a,layoutMode:k,composerLayer:_n,canUseInlineTagging:Ws,isFileUploadEnabled:Ae,fileUploadDisabledReason:os,currentModelConfig:i!=null?i:null,openFileDialog:qe,connectionInstanceData:rn,setActiveSystemHintType:ye,defaultModelId:ts,selectModelId:js,gizmoId:Z!=null?Z:null,hasGizmoFeatureRateLimit:at,setSelectedGizmoTag:ds}),!1,E!==Il&&t.jsx(Zd,{canShowAutocomplete$:kr,layoutMode:k,composerController:S,clientThreadId:a})]}),Br,Er,vr,Rr,E&&b&&t.jsx(Ap,{availableSystemHints:b,systemHintType:E,onRemoveSystemHint:pt})]})}const Ap=({availableSystemHints:e,systemHintType:s,onRemoveSystemHint:n})=>{const l=e!=null&&!ql(s)&&e.every(d=>d.systemHint!==s),{externalModelsLoading:i,fullModelsLoading:r}=Gl(),{isBlocked:m}=ia(s),a=_e(),c=!Qs(a);return u.useEffect(()=>{i||r||(l||m)&&!c&&n()},[l,m,c,n,s,i,r]),null};function Pp(e){"use forget";var s,n;return(n=(s=Wl(e))==null?void 0:s.id)!=null?n:null}export{Hp as D,Op as M,Ip as P,Wm as S,Up as T,Gm as a,Cm as b,Lp as c,Np as d,jm as u};
//# sourceMappingURL=da0anzdj3bll2tbv.js.map

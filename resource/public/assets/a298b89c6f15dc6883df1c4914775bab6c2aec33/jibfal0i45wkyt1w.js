import{i as S,t as s,a9 as h,cI as g,l0 as n}from"./ewse8exzafeu10ji.js";import{g as m,C as l}from"./i49tjgjhqtxc86vg.js";import{g as f}from"./n75kuy1cx6f5mogg.js";const T="3950229590",k="enabled_custom_checkout_for_plus",O="enabled_custom_checkout_for_go",d="enabled_custom_checkout_for_pro",U="enabled_custom_checkout_for_team",N="enabled_custom_checkout_for_quorum",K="is_checkout_redesign",I="enable_flush_statsig_on_checkout",A="checkoutRedesignExposureLogged",E="chatgpt_web_checkout_navigate_to_checkout",H="chatgpt_web_checkout_prepare_checkout_session";function i(a,{shouldLogExposure:_=!0}={}){return h(a,T,{disableExposureLog:!_})}function G({ctx:a,shouldLogExposure:_=!0}){return i(a,{shouldLogExposure:_}).get(K,!1)}function L(a){switch(a){case n.PLUS:return k;case n.GO:return O;case n.PRO:return d;case n.SELF_SERVE_BUSINESS:return U;case n.QUORUM:return N;default:return null}}function b(a,_){const c=L(_);return c==null?"redirect":i(a).get(c,!1)?"custom":"redirect"}function B(){const a=f(),_=S();async function c(e=1e3){const t=g(_);await Promise.race([t.flush(),new Promise(o=>setTimeout(o,e))])}async function u(e,t){return e.checkout_ui_mode=(t==null?void 0:t.fromiOSWebview)===!0?"redirect":b(_,e.plan_name),s(_,{eventName:H,metadata:{ui_mode:e.checkout_ui_mode}}),await l.getCheckoutLink(e,{skipSentinelCheckout:t==null?void 0:t.skipSentinelCheckout,fromiOSWebview:t==null?void 0:t.fromiOSWebview})}async function r(e){const t=i(_).get(I,!1);if("tag"in e)switch(s(_,{eventName:E,metadata:{tag:e.tag}}),t&&await c(),e.tag){case"hosted_checkout_session":case"redirect_to_portal":{window.location.href=e.url;break}case"custom_checkout_session":{const o=e.processor_entity,C=e.checkout_session_id;await a({pathname:m(o,C),search:"",hash:""},{state:{[A]:!0}});break}}else if(e.url)s(_,{eventName:E,metadata:{tag:"missing_tag"}}),t&&await c(),window.location.href=e.url;else throw new Error("Received invalid response from /checkout")}return{prepareCheckoutSession:u,navigateToCheckout:r}}export{A as C,G as g,B as u};
//# sourceMappingURL=jibfal0i45wkyt1w.js.map

var K=Object.defineProperty,Q=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var B=(r,t,l)=>t in r?K(r,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[t]=l,c=(r,t)=>{for(var l in t||(t={}))ee.call(t,l)&&B(r,l,t[l]);if(D)for(var l of D(t))te.call(t,l)&&B(r,l,t[l]);return r},b=(r,t)=>Q(r,Y(t));import{b as q,r as v,j as e,M as i,d as oe,c as z}from"./n75kuy1cx6f5mogg.js";import{bZ as ae,bw as re,c1 as se,c2 as ne,a2 as le}from"./ny10lj7zpuz89fvf.js";import{f as ce,oR as ie,i6 as de,i as ue,j as me,oS as he,C as pe,oT as S,I as fe,s as k,ho as ge,B as Ce,_ as xe,e as U,oU as Me,k as be}from"./ewse8exzafeu10ji.js";import{u as je}from"./dbz6g0t5bht84999.js";import{u as Te}from"./j2ui4c2m3nj8pqst.js";const F=1024*1024*4,_=()=>{"use forget";const r=z.c(1);let t;return r[0]===Symbol.for("react.memo_cache_sentinel")?(t=e.jsx("span",{className:"text-token-text-tertiary font-normal",children:e.jsx(i,c({},a.optionalText))}),r[0]=t):t=r[0],t},ve=r=>{"use forget";const t=z.c(15),{previewUrl:l,isDragActive:p}=r,s=q(),h=xe();if(!l||p){const m=p?"border-green-600 bg-green-600/30 text-green-600":"border-token-border-heavy text-token-text-tertiary";let C;t[0]!==m?(C=U("rounded-xl border border-dashed p-4",m),t[0]=m,t[1]=C):C=t[1];let T;t[2]===Symbol.for("react.memo_cache_sentinel")?(T=e.jsx(le,{className:"h-6 w-6"}),t[2]=T):T=t[2];let M;return t[3]!==C?(M=e.jsx("span",{className:C,children:T}),t[3]=C,t[4]=M):M=t[4],M}const f=h&&"bg-white";let u;t[5]!==f?(u=U("bg-token-bg-tertiary overflow-hidden rounded-xl border",f),t[5]=f,t[6]=u):u=t[6];let x;t[7]!==s?(x=s.formatMessage(a.iconPreviewAlt),t[7]=s,t[8]=x):x=t[8];let g;t[9]!==l||t[10]!==x?(g=e.jsx("img",{src:l,alt:x,className:"h-14 w-14 object-cover"}),t[9]=l,t[10]=x,t[11]=g):g=t[11];let j;return t[12]!==u||t[13]!==g?(j=e.jsx("span",{className:u,children:g}),t[12]=u,t[13]=g,t[14]=j):j=t[14],j},Se=r=>new Promise((t,l)=>{const p=new FileReader;p.onloadend=()=>t(p.result),p.onerror=()=>l(),p.readAsDataURL(r)}),Oe=({onClose:r})=>{"use forget";const t=ce(),{mutateAsync:l,isPending:p}=ie(de.CONNECTOR_SETTING),s=q(),[h,f]=v.useState(!1),[u,x]=v.useState("OAUTH"),[g,j]=v.useState(!1),m=je({defaultValues:{name:"",url:"",description:"",oauthClientId:"",oauthClientSecret:""},onSubmit:async({value:o})=>{var P,A,L;const n=C?await Se(C):null;let E=[],O=null;if(u==="OAUTH")try{const d=await Me(o.url.trim());if(E=[d],y){const I=o.oauthClientId.trim(),R=o.oauthClientSecret.trim();if(R.length!==0&&I.length===0){t.danger(a.clientIdRequired);return}I.length!==0&&(O={client_id:I,client_secret:R,scopes:(P=d.base_scopes)!=null?P:[]})}}catch(d){t.danger(a.oauthConfigError,{error:d});return}try{const d=await l({name:o.name.trim(),mcp_url:o.url.trim(),description:o.description.trim(),logo_url:n,supported_auth:E,oauth_client_params:O,authTypeOverride:u});if(!d.implementsRetrievable&&!((A=d.connector)!=null&&A.supports_full_actions)){w(!0);return}r((L=d.connector)==null?void 0:L.id)}catch(d){d instanceof be&&d.status===409?t.danger(a.duplicateName):t.danger(a.createConnectorError,{error:d});return}},validators:{onSubmit:({value:o})=>{const n={};return o.name.trim()||(n.name=s.formatMessage({id:"vtyh9X",defaultMessage:"Name is required"})),o.url.trim()?o.url.trim().match(/^https?:\/\//)||(n.url=s.formatMessage({id:"7hn6Jq",defaultMessage:"URL is invalid"})):n.url=s.formatMessage({id:"7WV2q4",defaultMessage:"URL is required"}),{fields:n}}}}),[C,T]=v.useState(null),[M,G]=v.useState(null),[N,w]=v.useState(!1),H=ue(),y=me(H,"3832963721"),V=he(),W=o=>{if(M&&URL.revokeObjectURL(M),o.size>F){t.danger(a.iconTooLarge);return}T(o);const n=URL.createObjectURL(o);G(n)},{getRootProps:X,getInputProps:Z,isDragActive:$}=Te({accept:{"image/*":[]},multiple:!1,noKeyboard:!0,noClick:!0,maxSize:F,onDropAccepted:o=>{o.length>0&&W(o[0])},onDropRejected:()=>{t.danger(a.iconInvalid)}}),J=o=>{o.preventDefault(),g&&(f(!0),m.handleSubmit())};return e.jsx(pe,{testId:"modal-create-custom-connector",title:e.jsx("span",{className:"flex items-center gap-1",children:e.jsx(i,b(c({},a.createCustomConnectorModalTitle),{values:{betaBadge:e.jsx(ne,{})}}))}),type:"success",isOpen:!0,onClose:()=>r(),showCloseButton:!0,size:"custom",className:"max-w-[448px]",children:e.jsxs("form",{onSubmit:J,className:"flex flex-col gap-4",children:[e.jsxs("label",b(c({},X({className:"flex cursor-pointer items-center gap-2.5"})),{children:[e.jsx("input",c({},Z())),e.jsx(ve,{previewUrl:M,isDragActive:$}),e.jsxs("span",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-medium",children:e.jsx(i,b(c({},a.iconTitle),{values:{optionalText:e.jsx(_,{})}}))}),e.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.jsx(i,c({},a.iconDescription))})]})]})),e.jsx(m.Field,{name:"name",children:o=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:"custom-connector-name",className:"mb-1 block text-sm font-medium",children:e.jsx(i,c({},a.nameTitle))}),e.jsx(S,{name:"custom-connector-name",value:o.state.value,onChange:n=>{o.handleChange(n.target.value),h&&f(!1)},ariaLabel:s.formatMessage(a.nameTitle),placeholder:s.formatMessage(a.namePlaceholder),error:h?o.state.meta.errors[0]:void 0})]})}),e.jsx(m.Field,{name:"description",children:o=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:"custom-connector-description",className:"mb-1 block text-sm font-medium",children:e.jsx(i,b(c({},a.descriptionTitle),{values:{optionalText:e.jsx(_,{})}}))}),e.jsx(fe,{name:"custom-connector-description",value:o.state.value,onChange:n=>o.handleChange(n.target.value),ariaLabel:s.formatMessage(a.descriptionTitle,{optionalText:s.formatMessage(a.optionalText)}),placeholder:s.formatMessage(a.descriptionPlaceholder)})]})}),e.jsx(m.Field,{name:"url",children:o=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:"custom-connector-url",className:"mb-1 block text-sm font-medium",children:e.jsx(i,c({},a.urlTitle))}),e.jsx(S,{name:"custom-connector-url",value:o.state.value,onChange:n=>{o.handleChange(n.target.value),h&&f(!1),N&&w(!1)},ariaLabel:s.formatMessage(a.urlTitle),placeholder:s.formatMessage(a.urlPlaceholder),error:N?e.jsx("span",{children:e.jsx(i,b(c({},V?a.developerModeConformanceError:a.conformanceError),{values:{link:n=>e.jsx(k,{href:"https://platform.openai.com/docs/mcp",openNewTab:!0,children:n})}}))}):h?o.state.meta.errors[0]:void 0})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"custom-connector-auth",className:"mb-1 block text-sm font-medium",children:e.jsx(i,c({},a.authTypeTitle))}),e.jsx(ae,{options:[{label:s.formatMessage(a.oauthOption),value:"OAUTH"},{label:s.formatMessage(a.noAuthOption),value:"NONE"}],value:u,onValueChange:o=>x(o),triggerId:"custom-connector-auth",triggerClassName:"w-full justify-between border-token-border-medium"})]}),u==="OAUTH"&&y&&e.jsxs(e.Fragment,{children:[e.jsx(m.Field,{name:"oauthClientId",children:o=>e.jsx(S,{name:"custom-connector-client-id",value:o.state.value,onChange:n=>{o.handleChange(n.target.value),h&&f(!1)},ariaLabel:s.formatMessage(a.clientIdTitle),placeholder:s.formatMessage(a.oauthClientIdPlaceholder),error:h?o.state.meta.errors[0]:void 0,autoComplete:"off"})}),e.jsx(m.Field,{name:"oauthClientSecret",children:o=>e.jsx(S,{name:"custom-connector-client-secret",type:"password",value:o.state.value,onChange:n=>{o.handleChange(n.target.value),h&&f(!1)},ariaLabel:s.formatMessage(a.clientSecretTitle),placeholder:s.formatMessage(a.oauthClientSecretPlaceholder),error:h?o.state.meta.errors[0]:void 0,autoComplete:"off"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"border-token-border-status-warning bg-token-bg-status-warning text-token-text-status-warning flex items-center gap-2 rounded-t-2xl border border-b-0 px-4 py-3 text-sm font-medium",children:[e.jsx(ge,{className:"h-6 w-6"}),e.jsx("span",{children:e.jsx(i,b(c({},a.customConnectorBanner),{values:{link:o=>e.jsx(k,{href:"http://platform.openai.com/docs/mcp#risks-and-safety",openNewTab:!0,className:"inline",children:o},"custom-connector-banner-link")}}))})]}),e.jsxs("label",{htmlFor:"trust-checkbox",className:"flex items-center gap-3 rounded-b-2xl border border-gray-200 bg-white px-4 py-4 text-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(re,{id:"trust-checkbox",onChange:()=>j(o=>!o),disabled:p}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:e.jsx(i,c({},a.customConnectorTrustTitle))}),e.jsx("p",{className:"text-token-text-tertiary text-sm",children:e.jsx(i,c({},a.customConnectorTrustSubtitle))})]})]})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs(k,{href:"http://platform.openai.com/docs/mcp",openNewTab:!0,className:"text-token-text-tertiary text-sm",children:[e.jsx(se,{className:"me-1.5 inline h-4.5 w-4.5"}),e.jsx(i,c({},a.readTheGuideLink))]}),e.jsx(m.Subscribe,{selector:o=>[o.isSubmitting],children:([o])=>e.jsx(Ce,{type:"submit",loading:o,disabled:!g,children:e.jsx(i,c({},a.createButton))})})]})]})})},a=oe({createCustomConnectorModalTitle:{id:"createCustomConnectorModal.title",defaultMessage:"New Connector {betaBadge}"},iconTitle:{id:"createCustomConnectorModal.iconTitle",defaultMessage:"Icon {optionalText}"},iconDescription:{id:"createCustomConnectorModal.iconDescription",defaultMessage:"Minimum size: 128 x 128 px"},nameTitle:{id:"createCustomConnectorModal.nameTitle",defaultMessage:"Name"},urlTitle:{id:"createCustomConnectorModal.urlTitle",defaultMessage:"MCP Server URL"},descriptionTitle:{id:"createCustomConnectorModal.descriptionTitle",defaultMessage:"Description {optionalText}"},optionalText:{id:"createCustomConnectorModal.optionalText",defaultMessage:"(optional)"},readTheGuideLink:{id:"createCustomConnectorModal.readTheGuideLink",defaultMessage:"Read the guide"},createButton:{id:"createCustomConnectorModal.createButton",defaultMessage:"Create"},iconPreviewAlt:{id:"createCustomConnectorModal.iconPreviewAlt",defaultMessage:"Icon preview"},namePlaceholder:{id:"createCustomConnectorModal.namePlaceholder",defaultMessage:"Custom Tool"},urlPlaceholder:{id:"createCustomConnectorModal.urlPlaceholder",defaultMessage:"https://example.com/sse"},descriptionPlaceholder:{id:"createCustomConnectorModal.descriptionPlaceholder",defaultMessage:"Explain what it does in a few words"},iconTooLarge:{id:"createCustomConnectorModal.iconTooLarge",defaultMessage:"Icon is too large"},iconInvalid:{id:"createCustomConnectorModal.iconInvalid",defaultMessage:"Invalid icon"},authTypeTitle:{id:"createCustomConnectorModal.authTypeTitle",defaultMessage:"Authentication"},oauthOption:{id:"createCustomConnectorModal.oauthOption",defaultMessage:"OAuth"},noAuthOption:{id:"createCustomConnectorModal.noAuthOption",defaultMessage:"No authentication"},oauthConfigError:{id:"createCustomConnectorModal.oauthConfigError",defaultMessage:"Error fetching OAuth configuration"},customConnectorBanner:{id:"createCustomConnectorModal.customConnectorBanner",defaultMessage:"Beta intended for developer use only. <link>Learn more</link>"},customConnectorTrustTitle:{id:"createCustomConnectorModal.customConnectorTrustTitle",defaultMessage:"I trust this application"},customConnectorTrustSubtitle:{id:"createCustomConnectorModal.customConnectorTrustSubtitle",defaultMessage:"Custom connectors are not verified by OpenAI. Malicious developers may attempt to steal your data."},conformanceError:{id:"createCustomConnectorModal.conformanceError",defaultMessage:"This MCP server doesn't implement <link>our specification</link>"},developerModeConformanceError:{id:"createCustomConnectorModal.developerModeConformanceError",defaultMessage:"This MCP server doesn't implement <link>our specification</link>. Enable Developer Mode in Advanced Connector Settings to create custom connectors that support arbitrary tool calls"},createConnectorError:{id:"createCustomConnectorModal.createConnectorError",defaultMessage:"Error creating connector"},duplicateName:{id:"createCustomConnectorModal.duplicateName",defaultMessage:"Connector name already exists"},clientIdTitle:{id:"createCustomConnectorModal.clientIdTitle",defaultMessage:"OAuth client ID"},oauthClientIdPlaceholder:{id:"createCustomConnectorModal.oauthClientIdPlaceholder",defaultMessage:"Client ID (Optional)"},clientSecretTitle:{id:"createCustomConnectorModal.clientSecretTitle",defaultMessage:"OAuth client secret"},oauthClientSecretPlaceholder:{id:"createCustomConnectorModal.oauthClientSecretPlaceholder",defaultMessage:"Client Secret (Optional)"},clientIdRequired:{id:"createCustomConnectorModal.clientIdRequired",defaultMessage:"Enter a client ID or remove the client secret"}});export{Oe as CreateCustomConnectorModal,ve as IconPreview,F as MAX_ICON_SIZE,_ as OptionalText,a as messages};
//# sourceMappingURL=gazad2f1iv107ru8.js.map

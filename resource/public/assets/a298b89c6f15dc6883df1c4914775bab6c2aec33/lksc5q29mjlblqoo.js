import{r as ge,ae as fe,j as i,c as pe}from"./n75kuy1cx6f5mogg.js";import{eX as Se,bJ as F,i as Ce,r as he,gz as xe,hD as ze,bL as Pe,gS as ye,gf as be,bK as j,j as _,ax as Ae,ce as Ie,eW as je,f$ as Ge,eQ as Ne,hX as we,N as Me,U as ke,a3 as B,aR as P,nh as ve}from"./ewse8exzafeu10ji.js";import{aU as We,aV as Ee,X as Le,aW as Re,aX as Ue,aY as Oe,aZ as Te,a_ as Fe,a$ as _e,b0 as Be}from"./ny10lj7zpuz89fvf.js";import{P as He}from"./da0anzdj3bll2tbv.js";function Je({clientThreadId:o,currentModelId:n,disableDraftPersistence:u=!1,isNewThread:d,isProjectThread:g=!1,onRequestCompletion:f,onContinueGenerating:p,headerClassName:S,hideHeader:C,onlyAllowImageUploads:e,layoutMode:h="bottom"}){var E,L;const{modelsData:a,externalModelsLoading:c}=Se(),[t,G,y,H,X,Q,I,$]=F(o,s=>{var R,U,O,T;const z=P.getCurrentNode(s);return[((R=z.message.clientMetadata)==null?void 0:R.errType)!=null&&z.message.clientMetadata.errType!=="info",ve(P.getCurrentNode(s).message),s==null?void 0:s.mode,!!(s!=null&&s.continuingFromSharedPostId),(s==null?void 0:s.continuingFromSharedProjectConversationId)!=null,P.getIsNewConversation(s),(T=(O=(U=P.lastUserMessage(s))==null?void 0:U.metadata)==null?void 0:O.system_hints)==null?void 0:T.includes(B.Agent),s==null?void 0:s.startedWithByoMcp]}),b=Ce(),l=he(b),D=xe(),x=We({clientThreadId:o}),{isOpen:K,onClose:J}=Ee({type:"just-hit-rate-limit"}),V=ge.useMemo(()=>x?!1:!t&&G,[t,G,x]),Y=x,Z=ze(o),q=F(o,P.hasRecentPIMWarning),m=Pe(Z).data,ee=ye(),A=(()=>{var z;return q?"pimBlock":((z=m==null?void 0:m.gizmo.tags)==null?void 0:z.includes(be.WorkspaceDisabled))&&!ee?"workspaceDisallowsGizmo":(a==null?void 0:a.models.size)===0?"noModelsAvailable":(y==null?void 0:y.kind)===j.GizmoTest&&y.gizmo_id==null?"noTestGizmoId":null})(),se=fe(),N=Le(),oe=se.action==="moderate",te=_(b,"1860647109"),w=Re(o),[r]=w,{systemHints:ae}=Ae(),ne=Ie.useState(({locked:s})=>s),re=je(),M=(E=m==null?void 0:m.gizmo.id)!=null?E:re,k=Ge(M),ie=Ne(),v=we(a==null?void 0:a.models,n),le=!_(b,"3084799213"),ce=Q||(I!=null?I:!1)||le,me=!ne&&(r==null||(r==null?void 0:r.kind)===j.PrimaryAssistant||(r==null?void 0:r.kind)===j.GizmoInteraction&&k),ue=!!Me(ke.DeveloperMode).data,W=Xe(me,ae,v,r,ie,ce,ue,(L=l==null?void 0:l.isWorkspaceAccount())!=null?L:!1,$),de=!Ue(b);return i.jsxs(i.Fragment,{children:[i.jsx(Oe,{availableSystemHints:W,composerController:D,clientThreadId:o,currentModelId:n,isCompletionInProgress:x,expireConduit:de}),i.jsx("div",{className:"flex justify-center empty:hidden",children:N&&oe&&te?i.jsx(Te,{}):null}),K?i.jsx(Fe,{onClose:J}):null,g&&i.jsx(_e,{clientThreadId:o,accountUserId:l==null?void 0:l.normalizedAccountUserId}),null,i.jsx(He,{clientThreadId:o,disableDraftPersistence:u,onCreateNewCompletion:f,onContinueGenerating:p,currentModelId:n,account:l,currentModelConfig:v,areModelsLoading:c,isNewThread:d,isCompletionInProgress:x,className:"w-full",canContinue:V,disabled:!!A,disabledReason:A!=null?A:void 0,canPause:Y,isInteractableSharedThread:N||H||X,headerClassName:S,hideHeader:C,onlyAllowImageUploads:e,layoutMode:h,modelsData:a,availableSystemHints:W,isSnorlaxEnabledForGizmo:k,gizmoId:M,hydratedConversationModeWithGizmoOverridePayload:w},o)]})}function Xe(o,n,u,d,g,f,p,S,C){"use forget";var a;const e=pe.c(10);let h;e:{if(!o){let t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],e[0]=t):t=e[0],h=t;break e}let c;e[1]!==f||e[2]!==d||e[3]!==u||e[4]!==p||e[5]!==g||e[6]!==S||e[7]!==C||e[8]!==n?(c=(a=n==null?void 0:n.filter(t=>Be({systemHint:t,modelConfig:u,conversationMode:d,isTemporaryChat:g,isDeveloperMode:p,isWorkspaceTenant:S,startedWithByoMcp:C})))==null?void 0:a.filter(t=>t.systemHint!==B.Agent?!0:f),e[1]=f,e[2]=d,e[3]=u,e[4]=p,e[5]=g,e[6]=S,e[7]=C,e[8]=n,e[9]=c):c=e[9],h=c}return h}export{Je as P};
//# sourceMappingURL=lksc5q29mjlblqoo.js.map

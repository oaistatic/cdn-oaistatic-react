const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/iqa4joq6fhdyyn1v.js","assets/n75kuy1cx6f5mogg.js","assets/ewse8exzafeu10ji.js","assets/root-l2v84m1w.css","assets/efc6pm86205um7c5.js","assets/frf4c35l48b0bjrb.js","assets/ny10lj7zpuz89fvf.js","assets/conversation-small-hotcas67.css","assets/lt9kme5w6dg8d0tp.js","assets/fv7cavklu2b0jong.js"])))=>i.map(i=>d[i]);
var ss=Object.freeze,ns=Object.defineProperty,tt=Object.defineProperties;var nt=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var as=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable;var ts=(t,s,a)=>s in t?ns(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,E=(t,s)=>{for(var a in s||(s={}))as.call(s,a)&&ts(t,a,s[a]);if(ke)for(var a of ke(s))os.call(s,a)&&ts(t,a,s[a]);return t},G=(t,s)=>tt(t,nt(s));var is=(t,s)=>{var a={};for(var n in t)as.call(t,n)&&s.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&ke)for(var n of ke(t))s.indexOf(n)<0&&os.call(t,n)&&(a[n]=t[n]);return a};var ls=(t,s)=>ss(ns(t,"raw",{value:ss(s||t.slice())}));import{b as I,j as e,d as Se,M as m,r as h,u as Te,a as _e,c as V,m as Re,f as je,A as vs,D as at}from"./n75kuy1cx6f5mogg.js";import{i as ot,a as it,c as lt}from"./6tgqoqudeah698zo.js";import{vc as rt,vd as ct,ve as dt,vf as rs,gh as ye,vg as ut,vh as mt,vi as ft,vj as pt,bW as Ge,bX as Le,bv as Pe,ck as Be,a2 as Ms,vk as gt,ng as xt,f$ as ht,lP as bt,rk as _t,vl as jt,db as yt,dF as Ct,E as ws,bV as Ee,vm as vt,vn as cs,dS as Mt,dU as ds,dR as wt,nV as me,vo as us,vp as Nt,vq as kt,vr as St,ne as Tt,M as Pt}from"./ny10lj7zpuz89fvf.js";import{pO as De,E as K,rN as xe,B as D,s as Et,i as se,hE as It,j as Ns,tX as Ot,ri as re,fR as ks,i6 as fe,sj as Ft,rv as Ss,q_ as At,f as z,m as Ue,rk as Q,R as ee,P as X,ea as Ts,nx as Ps,r as Ce,rw as Dt,tY as Rt,pP as Gt,ec as Es,ee as Is,kN as Lt,tZ as Bt,ex as B,fC as We,t_ as Ut,n as ze,C as Y,I as Wt,T as Os,fA as Fs,id as zt,kL as qt,ie as Ht,ii as Kt,ig as Vt,ih as Yt,ef as As,ik as Qt,fD as W,t8 as qe,pU as Ds,e as Z,ej as Ie,ek as Oe,fS as Xt,t$ as Zt,iV as ve,lV as te,ta as Me,nu as $t,fG as Rs,u0 as Jt,ho as he,lU as He,is as en,lX as sn,F as tn,ij as nn,a2 as an,k as on,pX as ln,bq as rn,pn as cn,dv as dn,pf as un,io as mn,r4 as fn,pg as pn}from"./ewse8exzafeu10ji.js";import{u as gn,l as xn}from"./cj802l28id0sdlgx.js";import{n as Gs,l as hn,o as bn}from"./drhq0hehfy1vqd5j.js";import{c as _n}from"./jfylj2lx3vqh7vyo.js";import{C as ne,a as Ls,b as Bs,u as Us,R as Ws,A as jn,g as yn,c as Cn,d as vn,e as Mn,f as wn,M as Nn,D as le,G as kn,S as Sn,h as pe,t as Ke}from"./fqnin05eui3vqsou.js";import{S as Ve}from"./e4gkml19dri6z85l.js";import{s as Tn}from"./gmmcfvs186kwwp97.js";import{d as ms}from"./l1ka89a9nbqv3utj.js";import{C as Pn}from"./exkj92rxpmk1vztp.js";import{S as En}from"./m6ic61btmczsc56b.js";import{S as zs}from"./cdqx8asnvs3pkwil.js";import{T as H}from"./e0z6030ycsi62lhu.js";import{A as In}from"./j3zgnwb11nmn5ark.js";import{T as On}from"./em5q5yhbyv41ft0j.js";import{a as Fn,g as fs}from"./drh7tuvrf4xnl7bz.js";import{c as qs}from"./ff22qitacijlmqi9.js";import"./3mp3j06lb1q5ttzm.js";import"./gy07ow2dyy5du4ny.js";import"./h2dwuj1m5ps9l7uv.js";import"./j2ui4c2m3nj8pqst.js";import"./lksc5q29mjlblqoo.js";import"./da0anzdj3bll2tbv.js";import"./mzj5jqjjpo006z7a.js";import"./nnb0v70g00lhjclz.js";import"./fh2tsu8ocsi22jc3.js";import"./jaupzjmp9wknd4io.js";import"./jtxj1xvdu5i7mvdh.js";import"./d65yyyom1modmtdi.js";import"./kj8rd4pu8k32z2dy.js";import"./n81diue0m3az0e3g.js";import"./ca7esdp3innmhgb2.js";import"./eblhjx87s4n4864h.js";import"./ga8p3rr9o0mc72h0.js";import"./nv2ovts2l1gnogj0.js";import"./ltq3thvd9yhrdk52.js";import"./kvd65smf2xr8kpw2.js";import"./ip2ajhdcto4s03df.js";import"./neqgr1r8uemp4194.js";import"./gmo3awvgctzzwbrq.js";import"./gowyl4x2bs7hfi4a.js";const An=qs("Search16Regular","16",["M9.3 10.02a4.5 4.5 0 1 1 .7-.7l3.85 3.83a.5.5 0 0 1-.7.7L9.3 10.02ZM10 6.5a3.5 3.5 0 1 0-7 0 3.5 3.5 0 0 0 7 0Z"]),Dn=qs("SettingsCogMultiple20Filled","20",["M8 2c-.37 0-.73.04-1.08.1a.5.5 0 0 0-.4.4l-.26 1.36c-.05.25-.3.4-.54.31l-1.3-.45a.5.5 0 0 0-.55.14A5.5 5.5 0 0 0 2.8 5.74c-.07.2-.01.4.14.54l1.05.9c.19.17.19.47 0 .63l-1.05.91a.5.5 0 0 0-.14.54c.23.7.6 1.34 1.08 1.88.14.15.35.2.54.14l1.3-.45c.25-.08.5.06.55.31l.27 1.36c.03.2.19.35.39.4a5.52 5.52 0 0 0 2.17 0 .5.5 0 0 0 .4-.4l.25-1.36c.05-.25.3-.4.55-.31l1.3.45c.19.06.4 0 .54-.14a5.5 5.5 0 0 0 1.08-1.89.5.5 0 0 0-.14-.53l-1.04-.9a.42.42 0 0 1 0-.63l1.04-.9a.5.5 0 0 0 .14-.54 5.5 5.5 0 0 0-1.08-1.89.5.5 0 0 0-.54-.14l-1.3.45a.42.42 0 0 1-.55-.31L9.48 2.5a.5.5 0 0 0-.4-.4C8.75 2.05 8.39 2 8 2ZM6.5 7.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm4.66 4.95a.46.46 0 0 1 .53-.15l.8.27c.26.1.54-.07.6-.34l.15-.83c.04-.2.2-.36.4-.38a3.55 3.55 0 0 1 .72 0c.2.02.35.18.4.38l.15.83c.06.27.34.43.6.34l.8-.27c.19-.07.4-.02.52.15.14.2.27.4.36.62.09.19.03.4-.13.53l-.64.56c-.2.18-.2.5 0 .68l.64.56c.16.13.22.34.13.53-.1.22-.22.43-.36.62a.46.46 0 0 1-.52.15l-.8-.27a.45.45 0 0 0-.6.34l-.16.83c-.04.2-.19.36-.4.38a3.55 3.55 0 0 1-.71 0 .46.46 0 0 1-.4-.38l-.16-.83a.45.45 0 0 0-.6-.34l-.8.27c-.18.07-.4.02-.52-.15a3.5 3.5 0 0 1-.36-.62.46.46 0 0 1 .13-.53l.64-.56c.21-.18.21-.5 0-.68l-.64-.56a.46.46 0 0 1-.13-.53c.1-.22.22-.43.36-.62ZM15 14.5a1 1 0 1 0-2 0 1 1 0 0 0 2 0Z"]);function Rn({workspaceId:t,connector:s,roles:a,onDisable:n,onClose:o}){var f,g,x;const i=I(),l=!!((f=a==null?void 0:a.data)!=null&&f.length)&&a.data.length>1,{data:r,isLoading:c}=Gs({workspaceId:t,connectorId:s.id,enabled:l}),d=(x=(g=r==null?void 0:r.roles_with_permissions)==null?void 0:g.filter(p=>p.connector_permissions.includes(De.UseConnector)).length)!=null?x:0,u=d>1;return e.jsx(rt,{open:!0,onOpenChange:p=>{p||o()},children:e.jsxs(ct,{children:[e.jsx(dt,{className:"border-token-border-medium radix-state-open:animate-show bg-token-bg-scrim fixed inset-0"}),c?e.jsx(rs,{className:"bg-token-main-surface-primary radix-state-open:animate-alertShow fixed start-1/2 top-1/2 flex max-h-[85vh] w-[90vw] max-w-lg -translate-x-1/2 -translate-y-1/2 flex-col gap-2 rounded-2xl shadow-2xl focus:outline-hidden",onEscapeKeyDown:p=>p.preventDefault(),children:e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx(K,{})})}):e.jsxs(rs,{className:"bg-token-main-surface-primary radix-state-open:animate-alertShow fixed start-1/2 top-1/2 flex max-h-[85vh] w-[90vw] max-w-lg -translate-x-1/2 -translate-y-1/2 flex-col gap-2 rounded-2xl shadow-2xl focus:outline-hidden",onEscapeKeyDown:p=>p.preventDefault(),children:[e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx(ye,{connector:s,size:"large",className:"flex h-12 w-12 items-center justify-center rounded-xl border-[0.5px] shadow-sm"})}),e.jsx(ut,{className:"p-6 pt-3 pb-2 text-center text-lg font-semibold md:p-6 md:pb-2",children:i.formatMessage(ge.disableConnectorTitle,{connectorName:xe(s.name,i)})}),e.jsxs("div",{className:"flex flex-col gap-4 p-6 pt-0 md:p-6 md:pt-0",children:[e.jsx(mt,{className:"text-center text-base",children:u?i.formatMessage(ge.disableConnectorRbacDescription,{connectorName:xe(s.name,i),count:d}):i.formatMessage(ge.disableConnectorDescription,{connectorName:xe(s.name,i)})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(ft,{asChild:!0,children:e.jsx(D,{color:"secondary",onClick:o,className:"w-full",children:e.jsx(m,E({},ge.cancel))})}),e.jsx(pt,{asChild:!0,children:e.jsx(D,{color:"danger",onClick:n,className:"w-full",children:e.jsx(m,E({},ge.disable))})})]})]})]})]})})}const ge=Se({disableConnectorTitle:{id:"NVjYkV",defaultMessage:"Disable {connectorName}?"},disableConnectorDescription:{id:"5JmIk1",defaultMessage:"To use {connectorName} with ChatGPT, all workspace members will need to reconnect their accounts."},disableConnectorRbacDescription:{id:"8yzta8",defaultMessage:"{connectorName} is currently enabled for {count, plural, one {# role} other {# roles}}. If you disconnect it, these roles will lose access to this connector."},cancel:{id:"N+FA7P",defaultMessage:"Cancel"},disable:{id:"wMyWcp",defaultMessage:"Disable"}}),Gn=({worksWith:t})=>{const s=I();return e.jsx("span",{className:"bg-token-bg-tertiary text-token-text-secondary mx-1.5 rounded-md px-1.5 py-0.5 text-xs",children:xn(t,s)})},Ln=()=>e.jsx("span",{className:"text-token-text-secondary mx-1.5 rounded-full border px-1.5 py-0.5 text-[9px] uppercase",children:e.jsx(m,E({},T.customConnectorBadge))}),Ye=({icon:t,label:s,isCustom:a,worksWith:n,description:o,trailingContent:i,infoText:l})=>e.jsxs(xt,{className:"border-token-border-default items-center border-b last:border-b-0",children:[t,e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsxs("div",{className:"text-token-text-primary text-md flex items-center font-medium",children:[s,a?e.jsx(Ln,{}):n==null?void 0:n.map(r=>e.jsx(Gn,{worksWith:r},r))]}),e.jsxs("div",{className:"text-token-text-secondary mt-0.5 flex items-center gap-1 truncate text-sm",children:[o&&e.jsx("span",{className:"truncate",children:o}),l&&e.jsx(Os,{label:l,children:e.jsx(Fs,{className:"h-4 w-4"})})]})]}),i]}),Fe=({icon:t,label:s,worksWith:a,description:n,infoText:o,enabled:i,onChange:l,isLoading:r,isCustom:c,onDelete:d,onManageRoles:u})=>{const f=d||u?e.jsxs(B.Root,{children:[e.jsx(B.BasicTrigger,{asChild:!0,children:e.jsx(D,{color:"secondary",size:"small",children:e.jsx(m,E({},T.manageConnector))})}),e.jsx(B.Portal,{children:e.jsxs(B.Content,{size:"small",align:"end",children:[u&&e.jsxs(B.Item,{onClick:u,color:"default",children:[e.jsx(gt,{className:"icon"}),e.jsx(m,E({},T.manageConnectorRoles))]}),d&&e.jsxs(B.Item,{onClick:d,color:"danger",children:[e.jsx(Pe,{className:"icon"}),e.jsx(m,E({},T.deleteConnector))]})]})})]}):null;return e.jsx(Ye,{icon:t,label:s,worksWith:a,description:n,infoText:o,isCustom:c,trailingContent:r?e.jsx(K,{}):e.jsxs("div",{className:"flex items-center gap-5",children:[f,e.jsx(ze,{checked:i,onCheckedChange:l,"aria-label":s,size:"normal"})]})})},Hs=(t,s)=>t.description?t.description:t.owners.length>0?s.formatMessage(T.createdByDefault):null,Ks=(t,s)=>t.created_at&&t.base_url?"".concat(t.base_url,"\n").concat(s.formatMessage(T.createdAt,{createdAt:new Date(t.created_at).toLocaleString(s.locale,{dateStyle:"medium",timeStyle:"short"})})):t.created_at?s.formatMessage(T.createdAt,{createdAt:new Date(t.created_at).toLocaleString(s.locale,{dateStyle:"medium",timeStyle:"short"})}):t.base_url,Bn=({workspaceId:t,connector:s,onPublish:a,onDelete:n,isPublished:o,roles:i})=>{var b;const l=z(),r=I(),[c,d]=h.useState(!1),[u,f]=h.useState(!1),g=((b=i==null?void 0:i.data)==null?void 0:b.length)&&i.data.length>1,x=async()=>{d(!0);try{await a().then(()=>{g&&f(!0)})}catch(M){l.danger(T.publishConnectorFailed,{toastId:"allowed_connectors_section"})}finally{d(!1)}},p=e.jsxs(B.Root,{children:[e.jsx(B.BasicTrigger,{children:e.jsx(We,{})}),e.jsx(B.Portal,{children:e.jsx(B.Content,{size:"small",align:"end",children:e.jsxs(B.Item,{onClick:n,color:"danger",children:[e.jsx(Pe,{className:"icon"}),e.jsx(m,E({},T.deleteConnector))]})})})]});return e.jsxs(e.Fragment,{children:[u&&e.jsx(we,{workspaceId:t,connector:s,onClose:()=>f(!1)}),e.jsx(Ye,{icon:e.jsx(ye,{connector:s,size:"small",className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm"}),label:xe(s.name,r),description:Hs(s,r),infoText:Ks(s,r),trailingContent:e.jsxs(e.Fragment,{children:[c||!o?e.jsx(D,{color:"secondary",size:"small",onClick:x,loading:c,children:e.jsx(m,E({},T.publishConnector))}):e.jsxs(D,{color:"secondary",size:"small",disabled:!0,children:[e.jsx(Be,{className:"me-1 h-4 w-4"}),e.jsx(m,E({},T.publishedConnector))]}),p]})})]})},Un=({onCreate:t})=>{const s=I();return e.jsx("button",{onClick:t,children:e.jsx(Ye,{icon:e.jsx("span",{className:"border-token-border-heavy h-fit rounded-xl border border-dashed p-2",children:e.jsx(Ms,{className:"icon-lg"})}),label:s.formatMessage(T.createConnector),description:s.formatMessage(T.createConnectorDescription)})})},Wn=({connector:t,loggingParams:s,onDelete:a,workspaceId:n,roles:o})=>{var S;const i=I(),l=z(),r=Te(),c=se(),d=Ce(c),{enabled:u,isLoading:f}=Dt(t.id,fe.ADMIN_SETTING,"workspace_settings"),g=gn(t),x=t.owners.length>0,[p,b]=h.useState(!1),[M,_]=h.useState(!1),w=((S=o==null?void 0:o.data)==null?void 0:S.length)&&o.data.length>1,v=re(),C=h.useMemo(()=>Object.values(Ss).find(({access:F,sync:A})=>F===t.id||A===t.id),[t.id]),k=h.useMemo(()=>C?[C.access,C.sync]:[t.id],[t.id,C]),P=h.useMemo(()=>C&&t.id===C.sync&&C.access!==t.id?G(E({},t),{id:C.access}):t,[t,C]),{variables:O,mutate:j}=_e({mutationFn:async F=>{await Promise.all(k.map(A=>ee.safePost("/accounts/{account_id}/connectors/{connector_id}/workspace_permissions",{parameters:{path:{account_id:n,connector_id:A}},requestBody:{enabled:F}})))},onSuccess:(F,A)=>{X.logEventWithStatsig("Connectors Workspace Connector Permission Updated","chatgpt_connectors_workspace_connector_permission_updated",G(E({},s),{enabled:A?"enabled":"disabled"})),A&&w&&v&&_(!0)},onSettled:()=>{r.invalidateQueries({queryKey:Rt(d==null?void 0:d.normalizedAccountUserId,"workspace_settings"),refetchType:"all"}),r.invalidateQueries({queryKey:Gt(n),refetchType:"all"});const F=Es[Is.GITHUB_CONNECTOR];t.id===F&&!O&&r.invalidateQueries({queryKey:["workspace-settings",n]})},onError:()=>{l.danger(T.featureSettingsUpdateFailed,{toastId:"allowed_connectors_section"})}});return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{icon:e.jsx(ye,{connector:t,size:"small",className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm"}),label:xe(t.name,i),description:Hs(t,i),infoText:x?Ks(t,i):void 0,worksWith:t.id===Lt?g:void 0,enabled:O!=null?O:!!u,onChange:F=>{F?j(!0):b(!0)},isLoading:f,isCustom:x,onDelete:x?a:void 0,onManageRoles:w&&u&&v?()=>_(!0):void 0}),M&&e.jsx(we,{workspaceId:n,connector:P,onClose:()=>_(!1)}),p&&e.jsx(Rn,{workspaceId:n,connector:P,roles:o,onClose:()=>b(!1),onDisable:()=>{j(!1),b(!1)}})]})},zn=({loggingParams:t,workspaceId:s,roles:a})=>{var b;const n=I(),o=z(),i=Te(),{data:l,isLoading:r}=Ue(s),c=!!(l!=null&&l.beta_settings[Q.CONTEXT_CONNECTOR_GDRIVE]),[d,u]=h.useState(!1),f=((b=a==null?void 0:a.data)==null?void 0:b.length)&&a.data.length>1,g=re(),{variables:x,mutate:p}=_e({mutationFn:M=>ee.safePost("/accounts/{account_id}/beta_features",{parameters:{path:{account_id:s}},requestBody:{feature:Q.CONTEXT_CONNECTOR_GDRIVE,value:M}}),onSuccess:(M,_)=>{X.logEventWithStatsig("Connectors Workspace Connector Permission Updated","chatgpt_connectors_workspace_connector_permission_updated",G(E({},t),{enabled:_?"enabled":"disabled"})),_&&f&&g&&u(!0)},onSettled:()=>{i.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{o.danger(T.featureSettingsUpdateFailed,{toastId:"allowed_connectors_section"})}});return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{icon:e.jsx("span",{className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(Ts,{className:"h-6 w-6"})}),label:n.formatMessage(T.gdriveFileUploadLabel),worksWith:["fileUploads"],description:n.formatMessage(T.gdriveFileUploadDescription),enabled:x!=null?x:!!c,onChange:p,isLoading:r,onManageRoles:f&&c&&g?()=>u(!0):void 0}),d&&e.jsx(we,{workspaceId:s,connector:{id:Q.CONTEXT_CONNECTOR_GDRIVE,name:"Google Drive"},onClose:()=>u(!1)})]})},qn=({loggingParams:t,workspaceId:s,roles:a})=>{var b;const n=I(),o=z(),i=Te(),{data:l,isLoading:r}=Ue(s),c=!!(l!=null&&l.beta_settings[Q.CONTEXT_CONNECTOR_O365_BUSINESS]),[d,u]=h.useState(!1),f=((b=a==null?void 0:a.data)==null?void 0:b.length)&&a.data.length>1,g=re(),{variables:x,mutate:p}=_e({mutationFn:M=>ee.safePost("/accounts/{account_id}/beta_features",{parameters:{path:{account_id:s}},requestBody:{feature:Q.CONTEXT_CONNECTOR_O365_BUSINESS,value:M}}),onSuccess:(M,_)=>{X.logEventWithStatsig("Connectors Workspace Connector Permission Updated","chatgpt_connectors_workspace_connector_permission_updated",G(E({},t),{enabled:_?"enabled":"disabled"})),_&&f&&g&&u(!0)},onSettled:()=>{i.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{o.danger(T.featureSettingsUpdateFailed,{toastId:"allowed_connectors_section"})}});return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{icon:e.jsx("span",{className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(Ps,{className:"h-6 w-6"})}),label:n.formatMessage(T.sharepointFileUploadLabel),worksWith:["fileUploads"],description:n.formatMessage(T.sharepointFileUploadDescription),enabled:x!=null?x:!!c,onChange:p,isLoading:r,onManageRoles:f&&c&&g?()=>u(!0):void 0}),d&&e.jsx(we,{workspaceId:s,connector:{id:Q.CONTEXT_CONNECTOR_O365_BUSINESS,name:"Sharepoint"},onClose:()=>u(!1)})]})},Hn=({loggingParams:t,workspaceId:s,roles:a})=>{var p;const n=I(),o=z(),i=Te(),{data:l}=Ue(s),r=!!(l!=null&&l.beta_settings[Q.CONTEXT_CONNECTOR_O365_PERSONAL]),[c,d]=h.useState(!1),u=((p=a==null?void 0:a.data)==null?void 0:p.length)&&a.data.length>1,f=re(),{variables:g,mutate:x}=_e({mutationFn:b=>ee.safePost("/accounts/{account_id}/beta_features",{parameters:{path:{account_id:s}},requestBody:{feature:Q.CONTEXT_CONNECTOR_O365_PERSONAL,value:b}}),onSuccess:(b,M)=>{X.logEventWithStatsig("Connectors Workspace Connector Permission Updated","chatgpt_connectors_workspace_connector_permission_updated",G(E({},t),{enabled:M?"enabled":"disabled"})),M&&u&&f&&d(!0)},onSettled:()=>{i.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{o.danger(T.featureSettingsUpdateFailed,{toastId:"allowed_connectors_section"})}});return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{icon:e.jsx("span",{className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(Ps,{className:"h-6 w-6"})}),label:n.formatMessage(T.onedrivePersonalFileUploadLabel),worksWith:["fileUploads"],description:n.formatMessage(T.onedrivePersonalFileUploadDescription),enabled:g!=null?g:!!r,onChange:x,onManageRoles:u&&r&&f?()=>d(!0):void 0}),c&&e.jsx(we,{workspaceId:s,connector:{id:Q.CONTEXT_CONNECTOR_O365_PERSONAL,name:"OneDrive"},onClose:()=>d(!1)})]})},Vs=()=>e.jsx(m,G(E({},T.connectorsSubtitle),{values:{link:t=>e.jsx(Et,{href:"https://help.openai.com/en/collections/12923329-connected-apps",openNewTab:!0,children:t},"allowed-connectors-subtitle-link")}})),Kn=()=>e.jsxs("div",{children:[e.jsx(Ge,{children:e.jsx(m,E({},T.connectorsTitle))}),e.jsx(Le,{className:"text-token-text-secondary",children:e.jsx(Vs,{})})]});function Vn({workspaceId:t,isQuorumBetaUser:s=!1}){const a=I(),n=se(),o=It(),l=!Ns(n,"3927245414")||o,{enabled:r,availableConnectors:c}=Ot({purpose:"workspace_settings"}),d=re(),{data:u}=hn({workspaceId:t,enabled:d}),{platformConnectors:f,isLoading:g,refetch:x}=ks(!0,fe.ADMIN_SETTING,"workspace_settings"),{showWorkspaceSettings:p}=Ft(),b=h.useMemo(()=>Array.from(f.values()).filter(j=>j.connector_type==="MCP"||c.some(S=>S.id===j.id)),[f,c]),M=h.useMemo(()=>{const j=b.filter(y=>y.connector_type!=="MCP"||y.status!=="ONLY_ME").map(y=>({type:"platform",ownerCount:y.owners.length,name:y.name,connector:y})),S={type:"gdrive_file_upload",ownerCount:0,name:a.formatMessage(T.gdriveFileUploadLabel)},F={type:"sharepoint_file_upload",ownerCount:0,name:a.formatMessage(T.sharepointFileUploadLabel)},A={type:"onedrive_personal_file_upload",ownerCount:0,name:a.formatMessage(T.onedrivePersonalFileUploadLabel)};return[...j,...p?[S,F,A]:[]].sort((y,N)=>N.ownerCount-y.ownerCount||y.name.localeCompare(N.name))},[b,a,p]),[_,w]=h.useState([]),v=h.useMemo(()=>b.filter(j=>j.connector_type==="MCP"&&(j.status==="ONLY_ME"||_.includes(j.id))),[b,_]),C=h.useMemo(()=>Object.values(Ss).map(({sync:j})=>j),[]),k=async j=>{w(S=>[...S,j]),await Ut(j,t),await x()},P=r&&!!M.length;if(g)return e.jsx(K,{});if(!r)return null;const O=async j=>{await Bt(j),x()};return e.jsx(_n,{items:[...P?[{key:"workspace",label:a.formatMessage(T.workspaceTabLabel),children:e.jsx(e.Fragment,{children:M.map(j=>j.type==="gdrive_file_upload"?e.jsx(zn,{loggingParams:{name:j.name,type:j.type},workspaceId:t,roles:u},j.type):j.type==="sharepoint_file_upload"?e.jsx(qn,{loggingParams:{name:j.name,type:j.type},workspaceId:t,roles:u},j.type):j.type==="onedrive_personal_file_upload"?e.jsx(Hn,{loggingParams:{name:j.name,type:j.type},workspaceId:t,roles:u},j.type):!C.some(S=>S===j.connector.id)&&e.jsx(Wn,{connector:j.connector,loggingParams:{name:j.connector.name,type:j.connector.connector_type},workspaceId:t,onDelete:()=>O(j.connector.id),roles:u},j.connector.id))})}]:[],{key:"my",label:a.formatMessage(T.myTabLabel),children:e.jsxs(e.Fragment,{children:[v.map(j=>e.jsx(Bn,{workspaceId:t,roles:u,connector:j,onPublish:()=>k(j.id),onDelete:()=>O(j.id),isPublished:_.includes(j.id)},j.id)),!l&&v.length===0&&e.jsx("div",{className:"text-token-text-secondary mt-3 text-sm",children:e.jsx(m,E({},T.myConnectorsDeveloperModeHint))}),l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsx(Un,{onCreate:()=>{window.location.hash="".concat(At,"?create-connector=true")}}),!1]})]})}]})}const we=({workspaceId:t,connector:s,onClose:a})=>{var M;const n=I(),[o,i]=h.useState(""),{data:l,isLoading:r}=Gs({workspaceId:t,connectorId:s.id}),c=re(),d=h.useMemo(()=>{var _;return(_=l==null?void 0:l.roles_with_permissions)==null?void 0:_.map(w=>{var v,C,k,P;return G(E({},w),{displayText:w.role.predefined_role?n.formatMessage(T.rolesModalWorkspaceDefaultRole):w.role.name,searchText:w.role.predefined_role?[n.formatMessage(T.rolesModalWorkspaceDefaultRole).toLowerCase(),n.formatMessage(T.rolesModalWorkspaceDefaultRoleBadge).toLowerCase(),(C=(v=w.role.description)==null?void 0:v.toLowerCase())!=null?C:""].join(" "):[w.role.name.toLowerCase(),(P=(k=w.role.description)==null?void 0:k.toLowerCase())!=null?P:""].join(" ")})})},[l,n]),u=h.useMemo(()=>d==null?void 0:d.sort((_,w)=>_.role.predefined_role?-1:w.role.predefined_role?1:_.displayText.localeCompare(w.displayText)),[d]),f=h.useMemo(()=>{const _=u!=null?u:[],w=o.trim().toLowerCase();return w?_.filter(v=>v.searchText.includes(w)):_},[u,o]),{updateConnectorRolePermission:g}=bn({workspaceId:t,connectorId:s.id}),[x,p]=h.useState(()=>new Set),b=(_,w)=>{p(v=>new Set(v).add(_)),g({roleId:_,permissions:w?[De.UseConnector]:[]}).finally(()=>{p(v=>{const C=new Set(v);return C.delete(_),C})})};return e.jsx(Y,{testId:"modal-roles-access",title:n.formatMessage({id:"TIsQZ6",defaultMessage:"Who can access {name}?"},{name:(M=s.name)!=null?M:"this connector"}),isOpen:c,onClose:a,showCloseButton:!0,size:"custom",className:"max-w-[640px]",children:e.jsx("div",{className:"flex max-h-[80vh] flex-col gap-4",children:r?e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx(K,{})}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{children:e.jsx(Wt,{name:"search",value:o,onChange:_=>i(_.target.value),placeholder:n.formatMessage({id:"hhmvjo",defaultMessage:"Search by name or keyword"}),ariaLabel:n.formatMessage({id:"RS8Uk8",defaultMessage:"Search roles"})})}),e.jsx("div",{className:"bg-token-main-surface flex-1 overflow-y-auto",children:f.length===0?e.jsx("div",{className:"text-token-text-tertiary px-4 py-10 text-center text-sm",children:e.jsx(m,{id:"bO3hZ+",defaultMessage:"No matching roles."})}):f.map(_=>{const w=_.connector_permissions.includes(De.UseConnector),v=x.has(_.role.id);return e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 py-3",children:[e.jsxs("div",{className:"flex flex-col",children:[_.role.predefined_role?e.jsxs("div",{className:"truncate text-sm font-medium",children:[n.formatMessage(T.rolesModalWorkspaceDefaultRole),e.jsx("span",{className:"bg-token-bg-tertiary text-token-text-secondary mx-1.5 rounded-md px-1.5 py-0.5 text-xs",children:e.jsx(m,E({},T.rolesModalWorkspaceDefaultRoleBadge))})]}):e.jsx("div",{className:"truncate text-sm font-medium",children:_.role.name}),_.role.description&&e.jsx("div",{className:"text-token-text-tertiary mt-0.5 text-xs",children:_.role.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v?e.jsx(K,{className:"h-4 w-4"}):null,e.jsx(ze,{checked:w,onCheckedChange:C=>b(_.role.id,C),disabled:v,"aria-label":n.formatMessage({id:"8ejEtk",defaultMessage:"Enable {name}"},{name:_.role.name})})]})]},_.role.id)})})]})})})},T=Se({connectorsTitle:{id:"8ZP+KV",defaultMessage:"Connectors"},connectorsSubtitle:{id:"8WR/V3",defaultMessage:"Manage which apps users in this workspace can connect to. <link>Learn more</link>"},featureSettingsUpdateFailed:{id:"allowedConnectorsSection.adminPermissionsUpdateFailed",defaultMessage:"Failed to update permissions for connector"},gdriveFileUploadLabel:{id:"allowedConnectorsSection.gdriveFileUploadLabel",defaultMessage:"Google Drive"},gdriveFileUploadDescription:{id:"allowedConnectorsSection.gdriveFileUploadDescription",defaultMessage:"Upload Google Drive files in messages sent to ChatGPT."},sharepointFileUploadLabel:{id:"allowedConnectorsSection.sharepointFileUploadLabel",defaultMessage:"Microsoft OneDrive (work/school)"},sharepointFileUploadDescription:{id:"allowedConnectorsSection.sharepointFileUploadDescription",defaultMessage:"Upload SharePoint and OneDrive for Business files in messages sent to ChatGPT."},onedrivePersonalFileUploadLabel:{id:"allowedConnectorsSection.onedrivePersonalFileUploadLabel",defaultMessage:"Microsoft OneDrive (personal)"},onedrivePersonalFileUploadDescription:{id:"allowedConnectorsSection.onedrivePersonalFileUploadDescription",defaultMessage:"Upload personal OneDrive files in messages sent to ChatGPT."},workspaceTabLabel:{id:"b8IYtR",defaultMessage:"Workspace"},myTabLabel:{id:"C2YTBV",defaultMessage:"My connectors"},createdByDefault:{id:"c1BULn",defaultMessage:"Created by your workspace's admin"},customConnectorBadge:{id:"q4oGB6",defaultMessage:"Custom"},publishedConnector:{id:"5gTvjk",defaultMessage:"Published"},publishConnector:{id:"HtDEy8",defaultMessage:"Publish to workspace"},publishConnectorFailed:{id:"iTXiK2",defaultMessage:"Failed to publish connector"},deleteConnector:{id:"DJDhnI",defaultMessage:"Delete"},createdAt:{id:"vQx/QC",defaultMessage:"Created {createdAt}"},manageConnector:{id:"ejE2jG",defaultMessage:"Manage"},manageConnectorRoles:{id:"yMishD",defaultMessage:"Access control"},createConnector:{id:"nrxInz",defaultMessage:"Create a connector"},createConnectorDescription:{id:"+sWVSA",defaultMessage:"Connect ChatGPT to your favorite tools"},myConnectorsDeveloperModeHint:{id:"xHDCCN",defaultMessage:"Enable developer mode to create a connector. Connectors you create will appear here and can be published to workspace."},rolesModalWorkspaceDefaultRole:{id:"uft0cC",defaultMessage:"Workspace"},rolesModalWorkspaceDefaultRoleBadge:{id:"VEokx9",defaultMessage:"Default"}}),ae={id:"connectors.shared.controlBullet",defaultMessage:"You’re in control: Disable access anytime to instantly revoke permissions and delete indexed data.",description:"Bullet point explaining control over revoking access for a synced connector."},Yn={type:"github",icon:Qt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.github.displayName",defaultMessage:"GitHub",description:"Name of Github, a product."},taglineMessage:{id:"connectors.github.tagline",defaultMessage:"Sync repositories and commits.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Github repositories and commits."},modal:{toastId:"github_connection_setup_modal",testId:"modal-github-basic-info",props:ne.github,copy:{title:{id:"connectors.github.modal.title",defaultMessage:"Enable GitHub sync for ChatGPT",description:"Title for the GitHub linking modal"},description:{id:"connectors.github.modal.description",defaultMessage:"By enabling ChatGPT to access your GitHub repositories, you empower your organization with more tailored answers based on your codebase. Once enabled, members of your organization can connect their GitHub accounts to ChatGPT.",description:"Description for the GitHub linking modal for admins"},bulletPoints:[{id:"connectors.github.modal.bullet.0",defaultMessage:"Continuous sync: Your repositories are indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining that if the user enables access, their repositories will be synced to ChatGPT on an ongoing basis."},{id:"connectors.github.modal.bullet.1",defaultMessage:"Privacy first: ChatGPT adheres to GitHub permissions, ensuring users access only what they can view on GitHub.",description:"Bullet point explaining that GitHub permissions are enforced when repositories sync with ChatGPT."},ae]}},additionalRequestPayload:{organization_name:null}},Qn={type:"sharepoint",icon:As,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.sharepoint.displayName",defaultMessage:"SharePoint",description:"Name of Sharepoint, a product."},taglineMessage:{id:"connectors.sharepoint.tagline",defaultMessage:"Sync documents and files from your SharePoint and OneDrive.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Sharepoint documents and files."},modal:{toastId:"sharepoint_connection_setup_modal",testId:"modal-sharepoint-basic-info",props:ne.sharepoint,copy:{title:{id:"connectors.sharepoint.modal.title",defaultMessage:"Enable SharePoint sync for ChatGPT",description:"Title for the SharePoint linking modal"},description:{id:"connectors.sharepoint.modal.description",defaultMessage:"By enabling ChatGPT to access your SharePoint, you empower your organization with more tailored answers based on your files and sites. Once enabled, members of your organization can connect their SharePoint accounts to ChatGPT.",description:"Description for the SharePoint linking modal for admins"},bulletPoints:[{id:"connectors.sharepoint.modal.bullet.0",defaultMessage:"Continuous sync: Your SharePoint content is indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for SharePoint"},{id:"connectors.sharepoint.modal.bullet.1",defaultMessage:"Privacy first: ChatGPT adheres to SharePoint permissions, ensuring users access only what they can view in Microsoft 365.",description:"Bullet point explaining SharePoint permissions are enforced"},ae]}}},Xn={type:"dropbox",icon:Yt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.dropbox.displayName",defaultMessage:"Dropbox",description:"Name of Dropbox, a product."},taglineMessage:{id:"connectors.dropbox.tagline",defaultMessage:"Sync files and folders stored in Dropbox.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Dropbox files and folders."},modal:{toastId:"dropbox_connection_setup_modal",testId:"modal-dropbox-basic-info",props:ne.dropbox,copy:{title:{id:"connectors.dropbox.modal.title",defaultMessage:"Enable Dropbox sync for ChatGPT",description:"Title for the Dropbox linking modal"},description:{id:"connectors.dropbox.modal.description",defaultMessage:"Connecting Dropbox lets ChatGPT answer questions with the latest documents your team stores in shared folders. Once enabled, members of your organization can link their Dropbox accounts to ChatGPT.",description:"Description for the Dropbox linking modal for admins"},bulletPoints:[{id:"connectors.dropbox.modal.bullet.0",defaultMessage:"Continuous sync: Your Dropbox content is indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for Dropbox"},{id:"connectors.dropbox.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT respects Dropbox sharing permissions, ensuring users can only view content they’re authorized to access.",description:"Bullet point explaining Dropbox permissions are enforced"},ae]}}},Zn={type:"box",icon:Vt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.box.displayName",defaultMessage:"Box",description:"Name of Box, a product."},taglineMessage:{id:"connectors.box.tagline",defaultMessage:"Sync files and folders stored in Box.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Box files and folders."},modal:{toastId:"box_connection_setup_modal",testId:"modal-box-basic-info",props:ne.box,copy:{title:{id:"connectors.box.modal.title",defaultMessage:"Enable Box sync for ChatGPT",description:"Title for the Box linking modal"},description:{id:"connectors.box.modal.description",defaultMessage:"Connecting Box helps ChatGPT provide answers grounded in the files and folders your company stores in Box. Once enabled, members of your organization can link their Box accounts to ChatGPT.",description:"Description for the Box linking modal for admins"},bulletPoints:[{id:"connectors.box.modal.bullet.0",defaultMessage:"Continuous sync: Your Box content is indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for Box"},{id:"connectors.box.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT honors Box collaboration permissions, ensuring users can only view content they’re authorized to access.",description:"Bullet point explaining Box permissions are enforced"},ae]}}},$n={type:"linear",icon:Kt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.linear.displayName",defaultMessage:"Linear",description:"Name of Linear, a product."},taglineMessage:{id:"connectors.linear.tagline",defaultMessage:"Sync issues, cycles, and projects from Linear.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Linear issues and projects."},modal:{toastId:"linear_connection_setup_modal",testId:"modal-linear-basic-info",props:ne.linear,copy:{title:{id:"connectors.linear.modal.title",defaultMessage:"Enable Linear sync for ChatGPT",description:"Title for the Linear linking modal"},description:{id:"connectors.linear.modal.description",defaultMessage:"Connecting Linear lets ChatGPT surface updates from your team's issues, cycles, and projects. Once enabled, members of your organization can link their Linear accounts to ChatGPT.",description:"Description for the Linear linking modal for admins"},bulletPoints:[{id:"connectors.linear.modal.bullet.0",defaultMessage:"Continuous sync: Your Linear issues are indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for Linear"},{id:"connectors.linear.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT respects Linear workspace permissions, ensuring users can only view content they’re authorized to access.",description:"Bullet point explaining Linear permissions are enforced"},ae]}}},Jn={type:"intercom",icon:Ht,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.intercom.displayName",defaultMessage:"Intercom",description:"Name of Intercom, a product."},taglineMessage:{id:"connectors.intercom.tagline",defaultMessage:"Sync conversations and articles from Intercom.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Intercom conversations and help center articles."},modal:{toastId:"intercom_connection_setup_modal",testId:"modal-intercom-basic-info",props:ne.intercom,copy:{title:{id:"connectors.intercom.modal.title",defaultMessage:"Enable Intercom sync for ChatGPT",description:"Title for the Intercom linking modal shown to admins."},description:{id:"connectors.intercom.modal.description",defaultMessage:"Connecting Intercom lets ChatGPT surface the latest conversations and help center content from your support team. Once enabled, members of your organization can link their Intercom accounts to ChatGPT.",description:"Description for the Intercom linking modal explaining the benefit of syncing Intercom with ChatGPT."},bulletPoints:[{id:"connectors.intercom.modal.bullet.0",defaultMessage:"Continuous sync: Your Intercom inboxes and articles are indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining that Intercom content will continue to sync into ChatGPT after enabling the connector."},{id:"connectors.intercom.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT respects Intercom workspace permissions so teammates only see conversations they are allowed to access.",description:"Bullet point explaining that ChatGPT enforces Intercom permissions when responding with synced content."},ae]}}},ea={type:"confluence",icon:qt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.confluence.displayName",defaultMessage:"Confluence",description:"Name of Confluence, a product."},taglineMessage:{id:"connectors.confluence.tagline",defaultMessage:"Sync pages and articles from Confluence.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Confluence pages and articles."},modal:{toastId:"confluence_connection_setup_modal",testId:"modal-confluence-basic-info",props:ne.confluence,copy:{title:{id:"connectors.confluence.modal.title",defaultMessage:"Enable Confluence sync for ChatGPT",description:"Title for the confluence linking modal"},description:{id:"connectors.confluence.modal.description",defaultMessage:"Connecting Confluence lets ChatGPT surface updates from your team's pages and articles. Once enabled, members of your organization can link their Confluence accounts to ChatGPT.",description:"Description for the Confluence linking modal for admins"},bulletPoints:[{id:"connectors.confluence.modal.bullet.0",defaultMessage:"Continuous sync: Your Confluence issues are indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for Confluence"},{id:"connectors.confluence.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT respects Confluence page permissions, ensuring users can only view content they’re authorized to access.",description:"Bullet point explaining Confluence permissions are enforced"},ae]}}},sa={type:"notion",icon:zt,hideForTeamPlan:!0,displayNameMessage:{id:"connectors.notion.displayName",defaultMessage:"Notion",description:"Name of Notion, a product."},taglineMessage:{id:"connectors.notion.tagline",defaultMessage:"Sync pages and databases from Notion.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Notion pages and databases."},modal:{toastId:"notion_connection_setup_modal",testId:"modal-notion-basic-info",props:ne.notion,copy:{title:{id:"connectors.notion.modal.title",defaultMessage:"Enable Notion sync for ChatGPT",description:"Title for the Notion linking modal"},description:{id:"connectors.notion.modal.description",defaultMessage:"Connecting Notion lets ChatGPT surface updates from your team's pages and databases. Once enabled, members of your organization can link their Notion accounts to ChatGPT.",description:"Description for the Notion linking modal for admins"},bulletPoints:[{id:"connectors.notion.modal.bullet.0",defaultMessage:"Continuous sync: Your Notion content is indexed, stored, and kept up to date in ChatGPT.",description:"Bullet point explaining ongoing sync for Notion"},{id:"connectors.notion.modal.bullet.1",defaultMessage:"Permission-aware: ChatGPT respects Notion page permissions, ensuring users can only view content they’re authorized to access.",description:"Bullet point explaining Notion permissions are enforced"},ae]}}},oe={github:Yn,sharepoint:Qn,dropbox:Xn,box:Zn,linear:$n,intercom:Jn,confluence:ea,notion:sa},ta=["github","sharepoint","dropbox","box","linear","confluence","notion","intercom"],na=ta.map(t=>oe[t]),ps="--fake-local-id";function ce(t){function s({accountId:n,onClose:o,onSuccess:i}){const l=I(),r=z(),[c,d]=h.useState(!1),u=h.useCallback(async()=>{d(!0);const f=t.type==="github"?{connection_config_id:ps,knowledge_connector_type:t.type,organization_name:null}:{connection_config_id:ps,knowledge_connector_type:t.type};try{await W.admin_create_connection_instance(n,f),await(i==null?void 0:i()),o()}catch(g){r.danger(l.formatMessage({id:"aqpeYE",defaultMessage:"Something went wrong. Please try again."}),{toastId:t.modal.toastId,loggingTitle:"Failed to create connection",loggingDescription:"Failed to create connection"})}finally{d(!1)}},[n,l,o,i,r]);return e.jsxs(Y,G(E({},t.modal.props),{onClose:o,testId:t.modal.testId,children:[e.jsxs("div",{className:"px-6 pt-4 pb-10",children:[e.jsx("div",{className:"text-xl font-medium",children:e.jsx(m,E({},t.modal.copy.title))}),e.jsx("div",{className:"text-md text-token-text-secondary mt-3",children:e.jsx(m,E({},t.modal.copy.description))}),e.jsx("div",{className:"mt-6 text-lg font-medium",children:e.jsx(m,{id:"edoz9r",defaultMessage:"What to expect"})}),e.jsx("ul",{className:"text-md text-token-text-secondary ms-6 mt-4",children:t.modal.copy.bulletPoints.map((f,g,x)=>e.jsx("li",{className:g<x.length-1?"mb-2 list-disc":"list-disc",children:e.jsx(m,E({},f))},g))})]}),e.jsx(qe,{primaryButton:e.jsx(D,{color:"primary",onClick:u,loading:c,children:e.jsx(m,{id:"y+cVaH",defaultMessage:"Enable"})})})]}))}function a({onClose:n,onSuccess:o}){const i=se(),l=Ce(i);return l?e.jsx(s,{accountId:l.id,onClose:n,onSuccess:o}):null}return{Controller:a,Modal:s}}const aa=ce(oe.box),oa=aa.Controller,ia=ce(oe.dropbox),la=ia.Controller,ra=ce(oe.github),ca=ra.Controller,J=Se({fileSingular:{id:"TKyiaj",defaultMessage:"file"},filesPlural:{id:"krAMi5",defaultMessage:"files"},domainSingular:{id:"ExZP9r",defaultMessage:"domain"},domainsPlural:{id:"PmkQD7",defaultMessage:"domains"}});function gs(t,s){return t==="google_drive_dwd"||t==="google_drive_oauth"?{objectTypeSingular:s.formatMessage(J.fileSingular),objectTypePlural:s.formatMessage(J.filesPlural),externalLinkableUnitSingular:s.formatMessage(J.domainSingular),externalLinkableUnitPlural:s.formatMessage(J.domainsPlural)}:t==="slack"?{objectTypeSingular:s.formatMessage({id:"Y22i2G",defaultMessage:"channel"}),objectTypePlural:s.formatMessage({id:"UXSOIk",defaultMessage:"channels"}),externalLinkableUnitSingular:s.formatMessage({id:"yyIyWp",defaultMessage:"workspace"}),externalLinkableUnitPlural:s.formatMessage({id:"LuznzN",defaultMessage:"workspaces"})}:{objectTypeSingular:s.formatMessage(J.fileSingular),objectTypePlural:s.formatMessage(J.filesPlural),externalLinkableUnitSingular:s.formatMessage(J.domainSingular),externalLinkableUnitPlural:s.formatMessage(J.domainsPlural)}}const da=ce(oe.sharepoint),Ys=da.Controller;function ua(t){"use forget";const s=V.c(35),{connector:a,onClose:n,onDeployToTeam:o,onSelfService:i,isDeploying:l}=t,[r,c]=h.useState("deploy-to-team");let d;s[0]!==o||s[1]!==i||s[2]!==r?(d=async()=>{if(r==="deploy-to-team"){await o();return}r==="self-service"&&await(i==null?void 0:i())},s[0]=o,s[1]=i,s[2]=r,s[3]=d):d=s[3];const u=d;let f;s[4]!==a?(f=e.jsx(ye,{connector:a,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),s[4]=a,s[5]=f):f=s[5];let g;s[6]===Symbol.for("react.memo_cache_sentinel")?(g=e.jsx(m,{id:"I2bLgK",defaultMessage:"Enable Sync"}),s[6]=g):g=s[6];let x;s[7]!==n||s[8]!==f?(x=e.jsx(Ds,{onClose:n,connectorIcon:f,title:g}),s[7]=n,s[8]=f,s[9]=x):x=s[9];let p;s[10]===Symbol.for("react.memo_cache_sentinel")?(p=A=>c(A),s[10]=p):p=s[10];let b,M,_;s[11]===Symbol.for("react.memo_cache_sentinel")?(b=e.jsx("span",{className:"rounded-md bg-[#E6F0FF] px-2 py-[2px] text-xs font-medium text-[#1A59F8]",children:e.jsx(m,{id:"DUoTTX",defaultMessage:"~2 mins"})}),M=e.jsx(m,{id:"G1jItk",defaultMessage:"Deploy to your team"}),_=e.jsx(m,{id:"H8LFv6",defaultMessage:"Enable your whole team to use SharePoint right away without additional setup."}),s[11]=b,s[12]=M,s[13]=_):(b=s[11],M=s[12],_=s[13]);let w;s[14]!==l?(w=e.jsx(xs,{value:"deploy-to-team",disabled:l,badge:b,title:M,description:_,showDivider:!1}),s[14]=l,s[15]=w):w=s[15];let v,C;s[16]===Symbol.for("react.memo_cache_sentinel")?(v=e.jsx(m,{id:"wJjAyl",defaultMessage:"Self-service set up"}),C=e.jsx(m,{id:"S98LA7",defaultMessage:"Enable each team member to authenticate individually."}),s[16]=v,s[17]=C):(v=s[16],C=s[17]);let k;s[18]!==l?(k=e.jsx(xs,{value:"self-service",disabled:l,title:v,description:C,showDivider:!0}),s[18]=l,s[19]=k):k=s[19];let P;s[20]!==r||s[21]!==k||s[22]!==w?(P=e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"border-token-border-default bg-token-bg-primary overflow-hidden rounded-2xl border",children:e.jsxs(ht,{value:r,onValueChange:p,className:"flex flex-col",children:[w,k]})})}),s[20]=r,s[21]=k,s[22]=w,s[23]=P):P=s[23];let O;s[24]===Symbol.for("react.memo_cache_sentinel")?(O=e.jsx(m,{id:"XGnWba",defaultMessage:"Continue"}),s[24]=O):O=s[24];let j;s[25]!==u||s[26]!==l?(j=e.jsx("div",{className:"pt-6",children:e.jsx(D,{className:"w-full",size:"large",onClick:u,disabled:l,loading:l,children:O})}),s[25]=u,s[26]=l,s[27]=j):j=s[27];let S;s[28]!==P||s[29]!==j||s[30]!==x?(S=e.jsxs("div",{className:"px-6 pt-4 pb-6",children:[x,P,j]}),s[28]=P,s[29]=j,s[30]=x,s[31]=S):S=s[31];let F;return s[32]!==n||s[33]!==S?(F=e.jsx(Y,G(E({},Ls),{className:"max-w-[420px]",title:void 0,onClose:n,testId:"modal-sharepoint-enable-sync",children:S})),s[32]=n,s[33]=S,s[34]=F):F=s[34],F}function xs({value:t,title:s,description:a,badge:n,disabled:o,showDivider:i}){return e.jsxs("label",{className:Z("flex items-start justify-between gap-3 p-4",i&&"border-token-border-default border-t",o?"cursor-not-allowed opacity-60":"cursor-pointer"),children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-base font-medium",children:[s,n]}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:a})]}),e.jsx(bt,{value:t,disabled:o,className:"border-token-border-default mt-1 inline-flex h-5 w-5 shrink-0 items-center justify-center rounded-full border p-0 leading-none data-[state=checked]:border-black data-[state=checked]:bg-black dark:data-[state=checked]:border-white dark:data-[state=checked]:bg-white",children:e.jsx(_t,{className:"flex h-full w-full items-center justify-center",children:e.jsx("span",{className:"h-2 w-2 rounded-full bg-white dark:bg-black"})})})]})}const ma=Ie(()=>Oe(()=>import("./iqa4joq6fhdyyn1v.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(t=>t.RedirectContent)),fa=Ie(()=>Oe(()=>import("./fv7cavklu2b0jong.js"),__vite__mapDeps([9,1,2,3])).then(t=>t.LimitItemsFilePickerModal));function Qs(t,s=!1){"use no forget";const a=I(),n=z(),{platformConnectors:o,isLoading:i}=ks(!0,fe.ADMIN_SETTING,"workspace_settings",!0),l=se(),r=Ce(l),c=r==null?void 0:r.id,[d,u]=h.useState(!1),[f,g]=h.useState(!1),[x,p]=h.useState(!1),[b,M]=h.useState(!1),[_,w]=h.useState(),v=h.useMemo(()=>{if(!(o!=null&&o.size))return;const L=Es[Is.SHAREPOINT_ADMIN_CONNECTOR];return o.get(L)},[o]),C=h.useCallback(()=>{n.danger(a.formatMessage({id:"kAaIRU",defaultMessage:"Unable to load the SharePoint OAuth connector."}))},[a,n]),k=h.useCallback(()=>{n.danger(a.formatMessage({id:"hBGDy6",defaultMessage:"Something went wrong while loading your workspace. Please refresh and try again."}))},[a,n]),P=h.useCallback(async(L,R)=>{try{const q=await W.admin_create_connection_instance(L,{connection_config_id:"--fake-local-id",knowledge_connector_type:"sharepoint_admin",link_id:R});w(q.connection_config.connection_config_id)}catch(q){M(!1),n.danger(a.formatMessage({id:"qoasLN",defaultMessage:"We couldn't enable SharePoint sync. Please try again in a moment."}))}},[a,n]),O=h.useCallback(()=>{if(!v){C();return}u(!1),g(!0)},[v,C]),j=h.useCallback(()=>{if(!v){C();return}u(!1),p(!0)},[v,C]),S=h.useCallback(()=>{u(!1),g(!1),p(!1),w(void 0),M(!1),t==null||t()},[t]),F=h.useCallback(L=>{if(!v){C(),S();return}if(!c){k(),S();return}if(!L){n.danger(a.formatMessage({id:"n5mSXA",defaultMessage:"We couldn't complete SharePoint setup. Please try again."})),S();return}M(!0),P(c,L)},[c,P,S,v,a,k,C,n]),A=h.useCallback(()=>{b||(g(!1),u(!0))},[b]),y=h.useCallback(()=>{if(!v){C();return}if(!c){k();return}s?(u(!1),g(!0),p(!1)):(u(!0),g(!1),p(!1))},[c,v,s,k,C]),N=h.useMemo(()=>!v||!c?null:e.jsxs(e.Fragment,{children:[d?e.jsx(ua,{connector:v,onClose:S,onDeployToTeam:O,onSelfService:j,isDeploying:b}):null,_?e.jsx(fa,{connectionId:_,isOpen:!0,onClose:async L=>{if(L)try{await W.admin_activate_connection_instance(c,_),n.success(a.formatMessage({id:"y5DD0Z",defaultMessage:"Connection successfully activated."}))}catch(R){n.danger(a.formatMessage({id:"aqpeYE",defaultMessage:"Something went wrong. Please try again."}),{toastId:"review_and_activate_modal",loggingTitle:"Failed to activate connection",loggingDescription:"Failed to activate connection"})}S()}}):f?e.jsx(Y,{testId:"modal-sharepoint-admin-oauth",type:"success",isOpen:!0,onClose:()=>{b||(s?S():A())},size:"custom",className:"max-w-[400px]",shouldIgnoreClickOutside:b,children:e.jsx(pa,{connector:v,onBack:()=>{s?S():A()},onSuccess:F,isCreatingConnection:b})}):null,x?e.jsx(Ys,{onSuccess:t,onClose:()=>{p(!1),S()}}):null]}),[v,c,d,S,O,j,b,_,f,A,F,x,t,n,a,s]);return{open:y,isLoading:i||b,canStart:!!(v&&c&&!b),modals:N,sharepointConnector:v}}function pa({connector:t,onBack:s,onSuccess:a,isCreatingConnection:n}){"use forget";const o=I(),i=z(),l=jt(),{refetch:r}=Xt({productSku:fe.CONNECTOR_SETTING}),[c,d]=h.useState(!1),u=yt(),f=h.useCallback(async()=>{var x;d(!0);try{Tn("popup");const p=l(t),b=await Zt({connector:t,redirectAfter:p!=null?p:void 0,toaster:i,openPopup:!0,intl:o,productSku:fe.CONNECTOR_SETTING});if(b&&b.success===!1)throw new Error((x=b.errorType)!=null?x:"sharepoint_admin_oauth_failed");if(!(b!=null&&b.linkId))throw new Error("sharepoint_admin_link_not_found");await r(),a(b.linkId)}catch(p){i.danger(o.formatMessage({id:"Gr0hUA",defaultMessage:"Encountered an error connecting your account. Please try again later."}))}finally{d(!1)}},[t,o,l,a,r,i]),g=h.useCallback(()=>{n||s()},[n,s]);return n?e.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 text-center",children:[e.jsx(As,{className:"icon-lg"}),e.jsx(K,{})]}):e.jsx(ma,{connector:t,onClose:g,isConnecting:c,onContinue:f,showExternalIcon:!0,productSku:fe.CONNECTOR_SETTING,additionalMessageThatDoesNotContainLegalClaims:u&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx(m,{id:"NUEe9u",defaultMessage:"You must be a SharePoint admin and log in with {email} to connect SharePoint",values:{email:e.jsx("b",{children:u})}})}),e.jsx("p",{children:e.jsx(ve,{href:"https://help.openai.com/en/articles/12143177-sharepoint-connectors-on-chatgpt",className:"underline",children:e.jsx(m,{id:"FGq3R0",defaultMessage:"Use a different email address?"})})})]})})}function ga(t){"use forget";const s=V.c(11),{refetchConnectionInstances:a,eligibleToCreateNewSharepointAdminConnection:n}=t,o=te(),i=Qs(a,!0),[l,r]=h.useState(!1);if(o||i.isLoading&&!i.modals)return null;let c;s[0]!==n||s[1]!==i.canStart||s[2]!==i.sharepointConnector?(c=n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full px-4",children:e.jsx("div",{className:"border-token-border-medium w-full border-t"})}),e.jsx("div",{className:"flex w-full flex-col gap-2 p-4",children:e.jsxs(D,{color:"secondary",disabled:!i.canStart||!i.sharepointConnector,onClick:()=>r(!0),children:[e.jsx(Ve,{className:"icon me-2 text-[#007AFF]"}),e.jsx(m,{id:"+MUAER",defaultMessage:"Deploy to team"})]})})]}),s[0]=n,s[1]=i.canStart,s[2]=i.sharepointConnector,s[3]=c):c=s[3];let d;s[4]!==i||s[5]!==l?(d=l&&i.sharepointConnector&&e.jsx(xa,{connector:i.sharepointConnector,onClose:()=>r(!1),onContinue:()=>{r(!1),i.open()}}),s[4]=i,s[5]=l,s[6]=d):d=s[6];let u;return s[7]!==i.modals||s[8]!==c||s[9]!==d?(u=e.jsxs(e.Fragment,{children:[c,d,i.modals]}),s[7]=i.modals,s[8]=c,s[9]=d,s[10]=u):u=s[10],u}function xa(t){"use forget";const s=V.c(17),{connector:a,onClose:n,onContinue:o}=t;let i;s[0]!==a?(i=e.jsx(ye,{connector:a,className:"rounded-xl border-[0.5px] p-2 shadow-sm",size:"medium"}),s[0]=a,s[1]=i):i=s[1];let l;s[2]===Symbol.for("react.memo_cache_sentinel")?(l=e.jsx(m,{id:"WK+BNs",defaultMessage:"Deploy to team"}),s[2]=l):l=s[2];let r;s[3]!==n||s[4]!==i?(r=e.jsx(Ds,{onClose:n,connectorIcon:i,title:l}),s[3]=n,s[4]=i,s[5]=r):r=s[5];let c;s[6]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("p",{className:"text-token-text-secondary mt-6 text-center text-sm",children:e.jsx(m,{id:"H8LFv6",defaultMessage:"Enable your whole team to use SharePoint right away without additional setup."})}),s[6]=c):c=s[6];let d;s[7]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsx("p",{className:"bg-token-interactive-bg-accent-muted-context mt-6 rounded-xl p-4 text-center text-sm text-[#0285FF]",children:e.jsx(m,{id:"oyE66v",defaultMessage:"This will replace any individually synced SharePoint connections"})}),s[7]=d):d=s[7];let u;s[8]===Symbol.for("react.memo_cache_sentinel")?(u=e.jsx(m,{id:"fHtzNL",defaultMessage:"Continue"}),s[8]=u):u=s[8];let f;s[9]!==o?(f=e.jsx("div",{className:"pt-6",children:e.jsx(D,{className:"w-full",size:"large",onClick:o,children:u})}),s[9]=o,s[10]=f):f=s[10];let g;s[11]!==r||s[12]!==f?(g=e.jsxs("div",{className:"px-6 pt-4 pb-6",children:[r,c,d,f]}),s[11]=r,s[12]=f,s[13]=g):g=s[13];let x;return s[14]!==n||s[15]!==g?(x=e.jsx(Y,G(E({},Ls),{className:"max-w-[420px]",title:void 0,onClose:n,testId:"modal-sharepoint-enable-sync",children:g})),s[14]=n,s[15]=g,s[16]=x):x=s[16],x}const ha=Ie(()=>Oe(()=>import("./fv7cavklu2b0jong.js"),__vite__mapDeps([9,1,2,3])).then(t=>t.LimitItemsFilePickerModal));function be({label:t,value:s}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-medium w-full border-t"}),e.jsxs("div",{className:"flex w-full flex-row justify-between py-2",children:[e.jsx("span",{className:"text-token-text-primary",children:t}),e.jsx("span",{className:"text-token-text-secondary",children:s})]})]})}function ba({connection:t,adminUserConnectionState:s}){var o;const a=s&&s.user_connection_details.activation_status!=="inactive"&&s.user_connection_details.auth_status!=="not_connected",n=t.connection_config.knowledge_connector_type;if(!n)return null;if(n==="google_drive_oauth")return e.jsx(_a,{connectionConfig:t.connection_config,connectionStatus:t.connection_status,isAdminConnected:a});if(n==="slack")return e.jsx(ya,{connectionConfig:t.connection_config,connectionStatus:t.connection_status,isAdminConnected:a});{const i=["google_drive_dwd","sharepoint_admin"].includes((o=t.connection_config.knowledge_connector_type)!=null?o:"");return e.jsx(ja,{isAdminManaged:i})}}function _a({connectionConfig:t,connectionStatus:s,isAdminConnected:a}){const n=I(),o=s==="activating"||s==="partially_activated"||s==="active";return e.jsxs("div",{className:"px-4",children:[o&&a!=null&&!a&&e.jsx(Xs,{connectionConfig:t}),e.jsx(be,{label:n.formatMessage({id:"bVi1Vt",defaultMessage:"Connection type"}),value:n.formatMessage({id:"DSWj22",defaultMessage:"Self-service"})}),!!t.domain_name&&e.jsx(be,{label:n.formatMessage({id:"DtrjbM",defaultMessage:"Domain name"}),value:t.domain_name})]})}function ja(t){"use forget";const s=V.c(8),{isAdminManaged:a}=t,n=I();let o;s[0]!==n?(o=n.formatMessage({id:"bVi1Vt",defaultMessage:"Connection type"}),s[0]=n,s[1]=o):o=s[1];let i;s[2]!==n||s[3]!==a?(i=a?n.formatMessage({id:"voo3FC",defaultMessage:"Admin-managed"}):n.formatMessage({id:"DSWj22",defaultMessage:"Self-service"}),s[2]=n,s[3]=a,s[4]=i):i=s[4];let l;return s[5]!==o||s[6]!==i?(l=e.jsx("div",{className:"px-4",children:e.jsx(be,{label:o,value:i})}),s[5]=o,s[6]=i,s[7]=l):l=s[7],l}function ya({connectionConfig:t,connectionStatus:s,isAdminConnected:a}){const n=I();return e.jsxs("div",{className:"px-4",children:[s==="activating"&&a!=null&&!a&&e.jsx(Xs,{connectionConfig:t}),e.jsx(be,{label:n.formatMessage({id:"JXKtnI",defaultMessage:"Slack domain"}),value:t.team_domain}),e.jsx(be,{label:n.formatMessage({id:"a1Cjhf",defaultMessage:"Team ID"}),value:t.team_id})]})}function Xs({connectionConfig:t}){const s=$t(),{data:a,isLoading:n,refetch:o}=je({queryKey:["user_connection_status"],queryFn:W.user_connection_status,enabled:s}),{refetch:i}=Rs({skip:!0}),l=()=>{o(),i()},r=a==null?void 0:a.connection_statuses.some(d=>d.user_connection_details.connection_instance_id===t.connection_config_id&&d.user_connection_details.auth_status==="user_connected");if(n||r)return null;const c=({isLoading:d,disabled:u,onClick:f})=>e.jsx(D,{color:"primary",loading:d,disabled:u,onClick:f,children:e.jsx(m,{id:"9ZiK24",defaultMessage:"Connect"})});return e.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.2,duration:.5},className:"bg-token-hint-bg dark:bg-token-main-surface-tertiary mb-2 flex flex-col gap-2 rounded-xl p-4",children:[e.jsxs("div",{className:"flex flex-row items-start gap-4",children:[e.jsx(Fs,{className:"icon-lg"}),e.jsx("span",{className:"text-sm",children:e.jsx(m,{id:"gdALIj",defaultMessage:"This connection will not finish activating until a user connects."})})]}),e.jsx(Jt,{connectionId:t.connection_config_id,connectorType:t.knowledge_connector_type,renderButton:c,location:"admin_settings",refetch:l})]})}function Ca({accountId:t,connectionId:s,refetch:a}){"use forget";const[n,o]=h.useState(!1),i=te(),[l,r]=h.useState(!1),c=z(),d=I(),u=async g=>{if(o(!1),g){r(!0);try{await W.admin_activate_connection_instance(t,s),await a(),c.success(d.formatMessage({id:"y5DD0Z",defaultMessage:"Connection successfully activated."}))}catch(x){c.danger(d.formatMessage({id:"aqpeYE",defaultMessage:"Something went wrong. Please try again."}),{toastId:"review_and_activate_modal",loggingTitle:"Failed to activate connection",loggingDescription:"Failed to activate connection"})}finally{r(!1)}}},f=e.jsx(D,{color:"primary",loading:l,disabled:i,onClick:()=>o(!0),children:e.jsx(m,{id:"K+P5ds",defaultMessage:"Continue setup"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.2,duration:.5},className:"bg-token-hint-bg dark:bg-token-main-surface-tertiary mb-2 flex flex-col gap-2 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm",children:e.jsx(m,{id:"5NajtY",defaultMessage:"Select files to sync to complete setup"})}),i?e.jsx(Me,{children:f}):f]}),n&&e.jsx(ha,{connectionId:s,onClose:u,isOpen:!0})]})}function Zs({isOpen:t,onClose:s,connectionId:a,accountId:n,isPostActivation:o,footerContent:i,primaryButton:l,secondaryButton:r}){const c=I(),{data:d,isLoading:u,error:f,refetch:g}=je({queryKey:["slack_channel_type_scopes",a],queryFn:()=>W.admin_connection_list_item_scopes(n,a,"channel_type")});let x,p;return d==null||d.object_selections.forEach(({object_handle:b,selection:M})=>{b==="public"?x=M==="include":b==="private"&&(p=M==="include")}),e.jsxs(Y,G(E({testId:"modal-slack-channel-scope"},Bs),{isOpen:t,onClose:s,children:[e.jsxs("div",{className:"flex flex-col gap-4 px-6 pt-4 pb-10",children:[e.jsx("p",{className:"text-token-text-primary",children:e.jsx(m,{id:"Ot9UkQ",defaultMessage:"Control which types of channels should be synced."})}),!o&&e.jsxs("div",{className:"bg-token-main-surface-secondary text-token-text-primary flex w-full flex-row items-center gap-4 rounded-xl p-4",children:[e.jsx(he,{className:"icon-lg"}),e.jsx("span",{className:"text-sm",children:e.jsx(m,{id:"qByMz2",defaultMessage:"You will not be able to modify the sync policy once the connection starts syncing data."})})]}),f&&e.jsxs("div",{className:"my-2 flex flex-row items-center gap-2 rounded-lg bg-red-500 p-2 text-white",children:[e.jsx(he,{className:"icon inline"}),e.jsx(m,{id:"F9HsRh",defaultMessage:"Something went wrong."}),e.jsx("button",{onClick:()=>g(),className:"underline",children:e.jsx(m,{id:"y/IEAC",defaultMessage:"Try again"})})]}),u?e.jsx(He,{lines:4}):e.jsxs(e.Fragment,{children:[x!=null&&e.jsx(hs,{connectionId:a,accountId:n,slackChannelScope:"public",title:c.formatMessage({id:"CXSVXf",defaultMessage:"Public channels"}),refetch:g,value:x,isPostActivation:o}),p!=null&&e.jsx(hs,{connectionId:a,accountId:n,slackChannelScope:"private",title:c.formatMessage({id:"5XrboJ",defaultMessage:"Private channels"}),refetch:g,value:p,isPostActivation:o})]})]}),e.jsx(qe,{footerContent:i,primaryButton:l,secondaryButton:r})]}))}function hs({connectionId:t,accountId:s,slackChannelScope:a,title:n,refetch:o,value:i,isPostActivation:l}){const r=z(),c=I(),[d,u]=h.useState(!1),f=async g=>{if(!d){u(!0);try{g?await W.admin_connection_unblock_items(s,t,"channel_type",[a]):await W.admin_connection_block_items(s,t,"channel_type",[a]),o()}catch(x){r.danger(c.formatMessage({id:"7QF5n6",defaultMessage:"Failed to update policy. Please try again later."}),{toastId:"slack_channel_scope_modal",loggingTitle:"Failed to update policy",loggingDescription:"Failed to update policy"})}finally{u(!1)}}};return l?e.jsxs("div",{className:"group border-token-border-medium flex w-full flex-row items-center gap-4 rounded-xl border px-8 py-4",children:[i?e.jsx(en,{className:"icon-lg"}):e.jsx(En,{className:"icon-lg"}),e.jsx("p",{className:"flex-1",children:n})]}):e.jsxs("div",{className:"group border-token-border-medium flex w-full flex-row items-center gap-4 rounded-xl border px-8 py-4",children:[e.jsx(ze,{checked:i,disabled:d,"aria-label":n,onCheckedChange:f}),e.jsx("p",{children:n}),d&&e.jsx(K,{})]})}const va=Ie(()=>Oe(()=>import("./fv7cavklu2b0jong.js"),__vite__mapDeps([9,1,2,3])).then(t=>t.LimitItemsFilePickerModal));function de({label:t,onClick:s,disabled:a}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full px-4",children:e.jsx("div",{className:"border-token-border-medium w-full border-t"})}),e.jsxs("div",{className:Z("flew-row flex items-center gap-4 px-4 py-2",a&&"cursor-not-allowed opacity-50",!a&&s&&"cursor-pointer"),onClick:a?void 0:s,children:[e.jsx("p",{className:"flex-1",children:t}),s&&e.jsx(Ct,{className:"icon text-token-text-secondary"})]})]})}function Ma({accountId:t,connectionId:s,refetch:a}){const[n,o]=h.useState(!1),i=te(),[l,r]=h.useState(!1),{triggerLocation:c}=Us(),d=e.jsx(D,{color:"primary",disabled:i,icon:zs,onClick:()=>o(!0),loading:l,children:e.jsx(m,{id:"S6paZh",defaultMessage:"Finish connecting"})}),u=async()=>{r(!0),await W.admin_activate_connection_instance(t,s),X.logEventWithStatsig("Contextual Answers Admin Connection Activated","chatgpt_contextual_answers_admin_connection_activated",{triggerLocation:c,connectorType:"google_drive_oauth",connectionId:s,adminQuickstart:!0}),a(),r(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full px-4",children:e.jsx("div",{className:"border-token-border-medium w-full border-t"})}),e.jsx("div",{className:"flex w-full flex-col gap-2 p-4",children:i?e.jsx(Me,{children:d}):d}),n&&e.jsx(sn,{connectionId:s,location:"admin_connection_quickstart_row",isAdminFlow:!0,isAdminQuickstartFlow:!0,onClose:()=>o(!1),onSuccess:u,accountId:t})]})}function wa({accountId:t,connectionId:s,refetch:a}){const[n,o]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClick:()=>o(!0),label:e.jsx(m,{id:"wM9lvD",defaultMessage:"Configure credentials"})}),n&&e.jsx(Cn,{onClose:()=>o(!1),onNext:()=>{a(),o(!1)},accountId:t,connectionId:s})]})}function Na({accountId:t,connectionId:s,isPostActivation:a}){const[n,o]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClick:()=>o(!0),label:e.jsx(m,{id:"lTeSGb",defaultMessage:"Sync policy"})}),n&&e.jsx(Zs,{isOpen:!0,onClose:()=>o(!1),accountId:t,connectionId:s,isPostActivation:a})]})}function ka({accountId:t,connectionId:s,isPostActivation:a}){const[n,o]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClick:()=>o(!0),label:e.jsx(m,{id:"AgDWHl",defaultMessage:"User drives"})}),n&&e.jsx(vn,{isOpen:!0,isPostActivation:a,onClose:()=>o(!1),accountId:t,connectionId:s})]})}function Sa({accountId:t,connectionId:s}){const[a,n]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClick:()=>n(!0),label:e.jsx(m,{id:"gsRcYT",defaultMessage:"Shared drives"})}),a&&e.jsx(Mn,{isOpen:!0,onClose:()=>n(!1),accountId:t,connectionId:s})]})}function Ta({accountId:t,connectionId:s,objectType:a,disabled:n}){const[o,i]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(de,{disabled:n,onClick:()=>i(!0),label:e.jsx(m,{id:"tisZLQ",defaultMessage:"Block items"})}),o&&e.jsx(Pn,{isOpen:!0,onClose:()=>i(!1),accountId:t,connectionId:s,objectType:a})]})}function Pa(t){"use forget";const s=V.c(11),{connectionId:a,disabled:n,onSuccess:o}=t,[i,l]=h.useState(!1);let r,c;s[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>l(!0),c=e.jsx(m,{id:"hxmHts",defaultMessage:"Limit items"}),s[0]=r,s[1]=c):(r=s[0],c=s[1]);let d;s[2]!==n?(d=e.jsx(de,{disabled:n,onClick:r,label:c}),s[2]=n,s[3]=d):d=s[3];let u;s[4]!==a||s[5]!==i||s[6]!==o?(u=i&&e.jsx(va,{isOpen:!0,onClose:g=>{l(!1),g&&(o==null||o())},connectionId:a}),s[4]=a,s[5]=i,s[6]=o,s[7]=u):u=s[7];let f;return s[8]!==d||s[9]!==u?(f=e.jsxs(e.Fragment,{children:[d,u]}),s[8]=d,s[9]=u,s[10]=f):f=s[10],f}function Ea({accountId:t,connection:s,disabled:a}){const[n,o]=h.useState(!1),i=re();return!s.connection_config.knowledge_connector_type||i?null:e.jsxs(e.Fragment,{children:[e.jsx(de,{disabled:a,onClick:()=>o(!0),label:e.jsx(m,{id:"9iRaQo",defaultMessage:"User access"})}),n&&e.jsx(jn,{connectorType:s.connection_config.knowledge_connector_type,fallbackEstimatedMaxNumUsers:yn(s.connection_config),onClose:()=>o(!1),accountId:t,connectionId:s.connection_config.connection_config_id})]})}function Ia({accountId:t,connectionId:s,connectorType:a,connectionDisplayInfo:n,onActivate:o,activationBlockingError:i}){const[l,r]=h.useState(!1),c=te(),d=e.jsx(D,{color:i?"secondary":"primary",disabled:!!i||c,icon:zs,onClick:()=>r(!0),children:e.jsx(m,{id:"tVDCWM",defaultMessage:"Review and finish setup"})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full px-4",children:e.jsx("div",{className:"border-token-border-medium w-full border-t"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2 p-4",children:[i&&e.jsx("p",{className:"text-token-text-secondary text-sm",children:i}),c?e.jsx(Me,{children:d}):d]}),l&&e.jsx(Ws,{isOpen:!0,onClose:()=>r(!1),accountId:t,connectionId:s,connectionDisplayInfo:n,onActivate:o,connectorType:a})]})}const Oa=({open:t,onOpenChange:s,deleteConnection:a,isDeleting:n,connectionDisplayInfo:o})=>{const i=I();return e.jsx(Y,{testId:"modal-delete-connection",isOpen:t,onClose:()=>s(!1),shouldIgnoreClickOutside:!0,title:i.formatMessage({id:"oXdl2Z",defaultMessage:"Confirm deletion"}),type:"danger",icon:he,primaryButton:e.jsx(D,{color:"danger",onClick:a,disabled:n,loading:n,children:e.jsx(m,{id:"knS5PY",defaultMessage:"Delete"})}),secondaryButton:e.jsx(D,{color:"secondary",disabled:n,onClick:()=>{s(!1)},children:e.jsx(m,{id:"KnPHlG",defaultMessage:"Cancel"})}),children:e.jsxs("ul",{className:"px-4",children:[e.jsx("li",{className:"mb-2 list-disc ps-2",children:e.jsx(m,{id:"BvnNwE",defaultMessage:"You are about to delete the connection {connection_name}.",values:{connection_name:e.jsx(wn,{connectionDisplayInfo:o})}})}),e.jsx("li",{className:"mb-2 list-disc ps-2",children:e.jsx(m,{id:"0m+fk7",defaultMessage:"Deleting this connection will stop syncing and delete synced data."})}),e.jsx("li",{className:"mb-2 list-disc ps-2 font-bold",children:e.jsx(m,{id:"a86dO+",defaultMessage:"This action cannot be undone."})})]})})},Fa=({open:t,onOpenChange:s,defaultName:a,accountId:n,connectionId:o,refetch:i})=>{const l=I(),[r,c]=h.useState(a),[d,u]=h.useState(!1),f=h.useId(),g=z(),x=h.useCallback(()=>{u(!0),W.admin_edit_name_connection_instance(n,o,{name:r}).then(()=>{g.success(l.formatMessage({id:"pepxEP",defaultMessage:"Connection updated successfully."})),i(),s(!1)}).catch(()=>{g.danger(l.formatMessage({id:"aqpeYE",defaultMessage:"Something went wrong. Please try again."}),{toastId:"rename_modal",loggingTitle:"Failed to rename connection",loggingDescription:"Failed to rename connection"})}).finally(()=>{u(!1)})},[n,o,l,r,s,i,g]);return e.jsx(Y,{testId:"modal-rename",isOpen:t,onClose:()=>s(!1),shouldIgnoreClickOutside:!0,title:l.formatMessage({id:"mmCJWI",defaultMessage:"Rename"}),type:"success",icon:ws,primaryButton:e.jsx(D,{onClick:()=>x(),loading:d,children:e.jsx(m,{id:"LebexD",defaultMessage:"Rename"})}),secondaryButton:e.jsx(D,{color:"secondary",onClick:()=>{s(!1)},children:e.jsx(m,{id:"KnPHlG",defaultMessage:"Cancel"})}),children:e.jsxs("form",{onSubmit:p=>{p.preventDefault(),x()},className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:f,className:"text-token-text-secondary text-base font-medium",children:e.jsx(m,{id:"Gk2g3Q",defaultMessage:"Connection name"})}),e.jsx("input",{type:"text",value:r,onChange:p=>c(p.target.value),id:f,className:"border-token-border-default bg-token-main-surface-primary text-token-text-primary rounded-lg border border-solid"}),e.jsx("button",{type:"submit",className:"display-none"})]})})};function $s({accountId:t,adminUserConnectionState:s,connectedKnowledgeSource:a,connection:n,connectorName:o,onCreateAnotherInstance:i,refetchConnectionInstances:l,showIcon:r=!1,sharepointAdminConnectorEnabled:c=!1,eligibleToCreateNewSharepointAdminConnection:d=!1}){var _;const[u,f]=h.useState(!1),g=I();let x;const p=n.connection_config.knowledge_connector_type;if(p)p==="slack"?x="synced_channel":x="synced_object";else return null;let b;n.connection_config.knowledge_connector_type==="sharepoint"&&c?b=e.jsx(ga,{refetchConnectionInstances:l,eligibleToCreateNewSharepointAdminConnection:d}):n.connection_status!=="draft"||p==="sharepoint_admin"||(p==="google_drive_oauth"&&!n.connection_config.domain_name?b=e.jsx(Ma,{accountId:t,connectionId:n.connection_config.connection_config_id,refetch:l}):b=e.jsx(Ia,{connectorType:p,connectionId:n.connection_config.connection_config_id,accountId:t,connectionDisplayInfo:n.display_info,onActivate:l,activationBlockingError:Ra(n,g)}));const M=["google_drive_dwd","google_drive_oauth","slack"].includes(p);return e.jsxs(Re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"group bg-token-main-surface-secondary w-full rounded-xl pb-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 p-4 pb-6",children:[r&&n.display_info.icon_url&&e.jsx("div",{className:"bg-token-bg-primary h-fit rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx("div",{className:"h-[28px] w-[28px]",children:e.jsx("img",{src:(_=n.display_info.icon_url)!=null?_:"",alt:"",className:"icon-xl self-center"})})}),e.jsxs("div",{className:"w-full shrink overflow-hidden",children:[e.jsx("div",{className:"text-token-text-primary overflow-hidden font-medium text-ellipsis whitespace-nowrap",children:e.jsx(Os,{label:o!=null?o:n.display_info.display_name,side:"top",align:"center",children:o!=null?o:n.display_info.display_name})}),e.jsx("div",{children:e.jsx(Aa,{connectionDisplayName:n.display_info.display_name,connectionStatus:n.connection_status})})]}),e.jsx(Da,{accountId:t,className:Z("hover:bg-token-main-surface-secondary-selected h-8 w-8",u?"bg-token-main-surface-secondary-selected":"bg-transparent"),connectedKnowledgeSource:a,connectionDisplayInfo:n.display_info,connectionId:n.connection_config.connection_config_id,isOpen:u,onCreateAnotherInstance:i,refetch:l,setIsOpen:f})]}),p==="sharepoint_admin"&&n.connection_status==="draft"&&e.jsx("div",{className:"px-4",children:e.jsx(Ca,{connectionId:n.connection_config.connection_config_id,accountId:t,refetch:l})}),e.jsx(ba,{connection:n,adminUserConnectionState:s}),["google_drive_oauth","google_drive_dwd"].includes(p)&&e.jsx(Ea,{connection:n,accountId:t}),p==="google_drive_dwd"&&e.jsxs(e.Fragment,{children:[e.jsx(wa,{connectionId:n.connection_config.connection_config_id,accountId:t,refetch:l}),e.jsx(ka,{connectionId:n.connection_config.connection_config_id,accountId:t,isPostActivation:n.connection_status!=="draft"}),e.jsx(Sa,{connectionId:n.connection_config.connection_config_id,accountId:t})]}),p==="slack"&&e.jsx(Na,{connectionId:n.connection_config.connection_config_id,accountId:t,isPostActivation:n.connection_status!=="draft"}),p==="sharepoint_admin"&&n.connection_status!=="draft"&&e.jsx(Pa,{connectionId:n.connection_config.connection_config_id}),x!=null&&M&&e.jsx(Ta,{connectionId:n.connection_config.connection_config_id,accountId:t,objectType:x}),b]})}const Aa=({connectionDisplayName:t,connectionStatus:s})=>{switch(s){case"active":case"partially_activated":case"activating":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"icon-sm text-token-text-secondary"}),e.jsx("span",{className:"text-token-text-secondary ms-0.5 text-sm",children:e.jsx(m,{id:"3aMZRu",defaultMessage:"Configured • {connectionDisplayName}",values:{connectionDisplayName:t}})})]});case"draft":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"icon-sm text-token-text-secondary"}),e.jsx("span",{className:"text-token-text-secondary ms-0.5 text-sm",children:e.jsx(m,{id:"rEztVG",defaultMessage:"Draft • {connectionDisplayName}",values:{connectionDisplayName:t}})})]});case"deleting":case"deleted":return null}};function Da({accountId:t,className:s,connectionDisplayInfo:a,connectionId:n,connectedKnowledgeSource:o,isOpen:i,onCreateAnotherInstance:l,refetch:r,setIsOpen:c}){const d=te(),u=z(),f=I(),[g,x]=h.useState(!1),[p,b]=h.useState(!1),[M,_]=h.useState(!1),w=async()=>{if(!M){_(!0);try{await W.admin_delete_connection_instance(t,n),u.success(f.formatMessage({id:"zM0Z9u",defaultMessage:"Connection deleted."}))}catch(C){u.danger(f.formatMessage({id:"3lBGk2",defaultMessage:"Failed to delete this connection. Please try again later."}),{toastId:"connection_instance_menu",loggingTitle:"Failed to delete connection",loggingDescription:"Failed to delete connection"})}finally{r(),_(!1),b(!1)}}},v=e.jsx(B.Item,{icon:Ms,onSelect:()=>l==null?void 0:l(),disabled:!l,children:e.jsx(m,{id:"NLydA/",defaultMessage:"Connect another {connectedKnowledgeSource}",values:{connectedKnowledgeSource:o}})});return e.jsxs(e.Fragment,{children:[e.jsxs(B.Root,{open:i,onOpenChange:c,children:[e.jsx(B.Trigger,{className:s,children:e.jsx(We,{className:"icon-lg"})}),e.jsx(B.Portal,{children:e.jsxs(B.Content,{size:"medium",children:[e.jsx(B.Item,{icon:ws,onSelect:()=>ms(x)(!0),disabled:M||p,children:e.jsx(m,{id:"XSQcFy",defaultMessage:"Rename connection"})}),l?v:d?e.jsx(Me,{children:v}):null,e.jsx(B.Item,{icon:M||p?K:Pe,onSelect:()=>ms(b)(!0),color:"danger",disabled:M||p,children:e.jsx(m,{id:"EAIYOb",defaultMessage:"Delete connection"})}),!1]})})]}),e.jsx(Fa,{open:g,onOpenChange:x,defaultName:a.display_name,connectionId:n,accountId:t,refetch:r}),e.jsx(Oa,{open:p,onOpenChange:b,deleteConnection:w,isDeleting:M,connectionDisplayInfo:a})]})}function Ra(t,s){if(t.connection_config.knowledge_connector_type==="google_drive_dwd"){if(!t.connection_config.admin_email_address||!t.connection_config.service_account_credential_id)return s.formatMessage({id:"BfNdzb",defaultMessage:"Credential configuration is incomplete"})}else if(t.connection_config.knowledge_connector_type==="google_drive_oauth"&&!t.connection_config.domain_name)return s.formatMessage({id:"PxrodU",defaultMessage:"Google Workspace domain must be set"})}const Ga=ce(oe.intercom),La=Ga.Controller,Ba=ce(oe.linear),Ua=Ba.Controller,Wa=ce(oe.notion),za=Wa.Controller;function qa({onClose:t}){const[s,a]=h.useState(),n=se(),o=Ce(n);return o?s?e.jsx(Ka,{accountId:o.id,connection:s,onClose:t}):e.jsx(Ha,{accountId:o.id,onClose:t,setConnection:a}):null}function Ha({onClose:t,setConnection:s,accountId:a}){var M,_,w,v;const n=I(),o=z(),{triggerLocation:i}=Us(),[l,r]=h.useState({teamDomain:"app"});h.useEffect(()=>{X.logEventWithStatsig("Contextual Answers Admin Create Connection Step","chatgpt_contextual_answers_admin_create_connection_step",{connectorType:"slack",stepName:"basic_info",triggerLocation:i})},[i]);const[c,d]=h.useState(!1),u=h.useCallback(()=>{!(l.teamDomain&&l.teamId)||!a||(d(!0),W.admin_create_connection_instance(a,{connection_config_id:"--fake-local-id",knowledge_connector_type:"slack",team_id:l.teamId,team_domain:l.teamDomain},l.connectionName).then(C=>{s(C)}).catch(()=>{o.danger(n.formatMessage({id:"aqpeYE",defaultMessage:"Something went wrong. Please try again."}),{toastId:"slack_connection_setup_modal",loggingTitle:"Failed to create connection",loggingDescription:"Failed to create connection"})}).finally(()=>{d(!1)}))},[a,l.connectionName,l.teamDomain,l.teamId,n,s,o]),f=!!((M=l.connectionName)!=null&&M.length)&&l.connectionName.length>128,g=!!(l.teamDomain&&l.teamId&&!f),x=h.useId(),p=h.useId(),b=h.useId();return e.jsxs(Y,G(E({},Bs),{onClose:t,testId:"modal-slack-basic-info",children:[e.jsxs("form",{onSubmit:C=>{C.preventDefault(),g&&u()},className:"flex flex-col gap-4 px-6 pt-4 pb-6",children:[e.jsxs("div",{className:"mb-2 flex flex-col gap-2",children:[e.jsx("label",{htmlFor:x,className:"text-token-text-secondary text-base font-medium",children:e.jsx(m,{id:"e2yF8/",defaultMessage:"Connection display name"})}),e.jsx("input",{type:"text",value:(_=l.connectionName)!=null?_:"",onChange:C=>r(k=>G(E({},k),{connectionName:C.target.value})),placeholder:n.formatMessage({id:"0gZ+BA",defaultMessage:"(optional)"}),id:x,className:"border-token-border-default bg-token-main-surface-primary text-token-text-primary rounded-lg border border-solid"}),f?e.jsx("p",{className:"text-red-500",children:e.jsx(m,{id:"vT7EGU",defaultMessage:"Name is too long."})}):null]}),e.jsxs("div",{className:"mb-2 flex flex-col gap-2",children:[e.jsx("label",{htmlFor:p,className:"text-token-text-secondary text-base font-medium",children:e.jsx(m,{id:"hEnKIS",defaultMessage:"Slack workspace domain"})}),e.jsxs("p",{children:[e.jsx("input",{type:"text",value:(w=l.teamDomain)!=null?w:"",onChange:C=>r(k=>G(E({},k),{teamDomain:C.target.value})),id:p,className:"border-token-border-default bg-token-main-surface-primary text-token-text-primary rounded-lg border border-solid"}),e.jsx("span",{className:"text-token-text-secondary ms-1 font-medium",children:".slack.com"})]})]}),e.jsxs("div",{className:"mb-2 flex flex-col gap-2",children:[e.jsx("label",{htmlFor:b,className:"text-token-text-secondary text-base font-medium",children:e.jsx(m,{id:"azUOrk",defaultMessage:"Slack workspace ID"})}),e.jsx("input",{type:"text",value:(v=l.teamId)!=null?v:"",onChange:C=>r(k=>G(E({},k),{teamId:C.target.value})),placeholder:n.formatMessage({id:"vUK9Kc",defaultMessage:"T0000000000"}),id:b,className:"border-token-border-default bg-token-main-surface-primary text-token-text-primary rounded-lg border border-solid"})]}),e.jsx("button",{type:"submit",className:"display-none"})]}),e.jsx(qe,{primaryButton:e.jsx(D,{color:"primary",disabled:!g,onClick:u,loading:c,children:e.jsx(m,{id:"lZthRm",defaultMessage:"Save Draft and Continue"})})})]}))}function Ka({connection:t,accountId:s,onClose:a}){return e.jsx(Nn,{onClose:a,steps:[{connectorType:"slack",name:"slack_channel_scope",fn:({goForward:n,goBackward:o,close:i,stepNumber:l,totalSteps:r})=>e.jsx(Zs,{isOpen:!0,isPostActivation:!1,onClose:()=>i==null?void 0:i(),accountId:s,connectionId:t.connection_config.connection_config_id,primaryButton:n&&e.jsx(D,{color:"primary",onClick:n,children:e.jsx(m,{id:"z5fExR",defaultMessage:"Next"})}),secondaryButton:o&&e.jsx(D,{color:"secondary",onClick:o,children:e.jsx(m,{id:"xJnONr",defaultMessage:"Back"})}),footerContent:e.jsx("span",{className:"text-token-text-secondary flex-1 align-middle font-medium",children:e.jsx(m,{id:"Wp0nVY",defaultMessage:"Step {stepNum} of {totalSteps}",values:{stepNum:l+1,totalSteps:r}})})})},{connectorType:"slack",name:"review_and_activate",fn:({goBackward:n,close:o,stepNumber:i,totalSteps:l})=>e.jsx(Ws,{isOpen:!0,onClose:()=>o==null?void 0:o(),accountId:s,connectorType:"slack",connectionId:t.connection_config.connection_config_id,connectionDisplayInfo:t.display_info,secondaryButton:n&&e.jsx(D,{color:"secondary",onClick:n,children:e.jsx(m,{id:"xJnONr",defaultMessage:"Back"})}),footerContent:e.jsx("span",{className:"text-token-text-secondary flex-1 align-middle font-medium",children:e.jsx(m,{id:"Wp0nVY",defaultMessage:"Step {stepNum} of {totalSteps}",values:{stepNum:i+1,totalSteps:l}})})})}]})}var Cs;const Va=tn.div(Cs||(Cs=ls(["w-full border-b-1 border-token-border-light"]))),Ya={type:"slack",icon:nn,nameMessage:{id:"connectors.slack.displayName",defaultMessage:"Slack",description:"Name of a product."},taglineMessage:{id:"connectors.slack.tagline",defaultMessage:"Connect messages and channels.",description:"Tagline explaining that this feature allows ChatGPT to sync data from Slack messages and channels."},modalKey:"slack"},bs=[Ya,...na.map(t=>({type:t.type,icon:t.icon,nameMessage:t.displayNameMessage,taglineMessage:t.taglineMessage,hideForTeamPlan:t.hideForTeamPlan,modalKey:t.type}))];async function Qa(t){const[s,a]=await Promise.all([W.admin_list_knowledge_connectors(t),W.admin_list_connection_instances(t)]),n=new Map;return s.knowledge_conectors.forEach(o=>{var i;return n.set(o.connector_details.knowledge_connector_type,{displayInfo:o.display_info,availability:o.connector_details.availability,connections:[],limits:(i=o.connector_details.limits)!=null?i:{max_instances:3}})}),a.connection_instances.forEach(o=>{var l;if(!o.connection_config.knowledge_connector_type)return;const i=(l=n.get(o.connection_config.knowledge_connector_type))==null?void 0:l.connections;i!=null?i.push(o):n.set(o.connection_config.knowledge_connector_type,{displayInfo:o.display_info,availability:"unavailable",limits:le,connections:[o]})}),n}function Ae(t){return!(t.connection_status==="deleted"||t.connection_status==="deleting")}function Xa(){"use no forget";const t=I(),s=se(),a=Ce(s),[n,o]=h.useState(null),i=an(s,"4243523004"),l=i.get("enabledConnectors",[]);h.useEffect(()=>{X.logEventWithStatsig("Contextual Answers Admin Page Visited","chatgpt_contextual_answers_admin_page_visited")},[]);const{data:r,isLoading:c,error:d,refetch:u}=je({queryKey:["admin:knowledge_connectors_with_connections",a==null?void 0:a.id],queryFn:async()=>{if(!a)throw new Error("No current account");return await Qa(a.id)},enabled:!!a}),{refetch:f,connectionInstanceData:g}=Rs(),x=async()=>await Promise.all([u(),f()]),p=h.useMemo(()=>a!=null&&a.isTeam()?bs.filter(y=>!y.hideForTeamPlan):bs,[a]),{combinedGoogleDriveConnections:b,googleDriveUnavailableConnections:M,eitherGoogleDriveConnectorEnabled:_,googleDriveLimits:w,isGoogleDriveDwdEnabled:v,someGoogleDriveConnectorEnabledButNoneAreLinked:C}=h.useMemo(()=>{var Xe,Ze,$e,Je,es;const y=r==null?void 0:r.get("google_drive_oauth"),N=r==null?void 0:r.get("google_drive_dwd"),L=(Xe=y==null?void 0:y.connections.filter(Ae))!=null?Xe:[],R=(Ze=N==null?void 0:N.connections.filter(Ae))!=null?Ze:[],q=[];(y==null?void 0:y.availability)==="available"&&q.push(...L),(N==null?void 0:N.availability)==="available"&&q.push(...R);const ie=[];(y==null?void 0:y.availability)!=="available"&&ie.push(...L),(N==null?void 0:N.availability)!=="available"&&ie.push(...R);const ue=(Je=($e=y==null?void 0:y.limits)!=null?$e:N==null?void 0:N.limits)!=null?Je:le,$=(y==null?void 0:y.availability)==="available"||(N==null?void 0:N.availability)==="available",Ne=((es=ue==null?void 0:ue.max_instances)!=null?es:le.max_instances)!==0,st=$&&q.length===0&&Ne;return{combinedGoogleDriveConnections:q,googleDriveUnavailableConnections:ie,eitherGoogleDriveConnectorEnabled:$,googleDriveLimits:ue,isGoogleDriveDwdEnabled:(N==null?void 0:N.availability)==="available",someGoogleDriveConnectorEnabledButNoneAreLinked:st}},[r]),{connectorStates:k,unavailableConnections:P}=h.useMemo(()=>{const y=new Map;p.forEach(R=>{y.set(R.type,{config:R,availability:"unavailable",connections:[],limits:le})});const N=[...M];return r==null||r.forEach((R,q)=>{var Ne;if(q==="google_drive_oauth"||q==="google_drive_dwd")return;const ie=R.connections.filter(Ae),ue=q==="sharepoint_admin"?"sharepoint":q,$=y.get(ue);$?($.availability=R.availability,$.connections=$.connections.concat(ie),$.limits=(Ne=R.limits)!=null?Ne:le,R.availability!=="available"&&N.push(...ie)):R.availability!=="available"&&N.push(...ie)}),{connectorStates:p.map(R=>y.get(R.type)),unavailableConnections:N}},[r,M,p]),O=i.get("enabled",!1)&&l.includes("sharepoint_admin_connector"),j=te(),S=[];C&&S.push("google_drive"),k.forEach(y=>{var N,L;y.availability==="available"&&y.connections.length===0&&((L=(N=y.limits)==null?void 0:N.max_instances)!=null?L:le.max_instances)!==0&&S.push(y.config.modalKey)});const F=y=>{o(y)},A=()=>{o(null),x()};return a!=null&&a.id?e.jsxs(Ee,{className:"gap-4",children:[e.jsx(Js,{showDescription:b.length>0}),d&&e.jsxs("div",{className:"my-2 flex flex-row items-center gap-2 rounded-lg bg-red-500 p-2 text-white",children:[e.jsx(he,{className:"icon inline"}),d instanceof on&&d.code==="unsupported_data_residency"?e.jsx(m,{id:"IqeMXI",defaultMessage:"Synced connectors are not currently supported for your data residency region."}):e.jsx(m,{id:"zNCx93",defaultMessage:"Failed to get connection instances. Please refresh to try again."})]}),j&&e.jsxs("div",{className:"my-2 flex flex-row items-center gap-2 rounded-lg bg-red-500 p-2 text-white",children:[e.jsx(he,{className:"icon inline"}),e.jsx(m,{id:"hnTY+Z",defaultMessage:"Our systems are experiencing high load. Some operations may be temporarily unavailable."})]}),c&&e.jsx(K,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"border-token-border-light divide-y-[1px] overflow-hidden rounded-xl border-[1px]",children:[C&&e.jsx(Za,{shouldShowForehead:!c&&!b.length,handleOpenModal:F}),k.map((y,N)=>{var L,R;return y.availability!=="available"||y.connections.length>0||((R=(L=y.limits)==null?void 0:L.max_instances)!=null?R:le.max_instances)===0?null:y.config.type==="sharepoint"&&O?e.jsx(Ja,{connectorType:y.config.type,connectorName:t.formatMessage(y.config.nameMessage),description:t.formatMessage(y.config.taglineMessage),Icon:y.config.icon,refetchConnectionInstances:x,closeOtherModals:()=>o(null)},"cta-".concat(N,"-").concat(y.config.type)):e.jsx(Qe,{connectorType:y.config.type,connectorName:t.formatMessage(y.config.nameMessage),description:t.formatMessage(y.config.taglineMessage),Icon:y.config.icon,onClickConnect:()=>F(y.config.modalKey)},"cta-".concat(N,"-").concat(y.config.type))})]}),(()=>{const y=[];return _&&b.length>0&&y.push(e.jsx(_s,{adminUserConnectionStatus:g==null?void 0:g.connection_statuses,accountId:a.id,connectorName:t.formatMessage({id:"oDI3Mt",defaultMessage:"Google Drive"}),connectorType:"google_drive",limits:w,onClickConnect:()=>F("google_drive"),refetchConnectionInstances:x,connectionInstancesLoading:c,connectionInstances:b,singularNounConnectedObjectName:gs("google_drive_oauth",t).externalLinkableUnitSingular},"connected-google-drive")),k.forEach(N=>{N.availability==="available"&&N.connections.length>0&&y.push(e.jsx(_s,{accountId:a.id,connectorType:N.config.type,connectorName:t.formatMessage(N.config.nameMessage),limits:N.limits,onClickConnect:()=>F(N.config.modalKey),connectionInstancesLoading:c,connectionInstances:N.connections,adminUserConnectionStatus:g==null?void 0:g.connection_statuses,refetchConnectionInstances:x,singularNounConnectedObjectName:gs(N.config.type,t).externalLinkableUnitSingular,sharepointAdminConnectorEnabled:O},"connected-".concat(N.config.type)))}),y.length===0?null:e.jsx("div",{className:Z("mt-4 grid grid-cols-1 gap-4",y.length>1&&"lg:grid-cols-2"),children:y})})()]}),P.length>0&&e.jsx(to,{accountId:a.id,connectionInstancesLoading:c,connectionInstances:P,refetchConnectionInstances:x}),n==="google_drive"&&e.jsx(kn,{isDwdEnabled:v,onClose:A,triggerLocation:"admin_settings"}),n==="slack"&&e.jsx(qa,{onClose:A}),n==="github"&&e.jsx(ca,{onClose:A}),n==="sharepoint"&&e.jsx(Ys,{onClose:A}),n==="dropbox"&&e.jsx(la,{onClose:A}),n==="box"&&e.jsx(oa,{onClose:A}),n==="linear"&&e.jsx(Ua,{onClose:A}),n==="notion"&&e.jsx(za,{onClose:A}),n==="intercom"&&e.jsx(La,{onClose:A})]}):null}function Za(t){"use forget";const s=V.c(16),{shouldShowForehead:a,handleOpenModal:n}=t,o=I();let i;s[0]!==a?(i=a&&e.jsx("div",{className:"px-4 py-3 text-[13px] text-[#007AFF]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"icon"}),e.jsx(m,{id:"woNVMz",defaultMessage:"Syncing is required to use Google Drive in chat. {learnMore}",values:{learnMore:e.jsx(ve,{href:pe,className:"underline",onClick:$a,children:e.jsx(m,{id:"WGpoE2",defaultMessage:"Learn more"})},"learnMore")}})]})}),s[0]=a,s[1]=i):i=s[1];const l=a?"border-token-border-light overflow-hidden rounded-t-xl border-t-[1px]":void 0;let r;s[2]!==o?(r=o.formatMessage({id:"oDI3Mt",defaultMessage:"Google Drive"}),s[2]=o,s[3]=r):r=s[3];let c;s[4]!==o?(c=o.formatMessage({id:"xlgXB9",defaultMessage:"Sync Docs, Sheets, Slides and other files"}),s[4]=o,s[5]=c):c=s[5];let d;s[6]!==n?(d=()=>n("google_drive"),s[6]=n,s[7]=d):d=s[7];let u;s[8]!==l||s[9]!==r||s[10]!==c||s[11]!==d?(u=e.jsx(Qe,{className:l,connectorName:r,connectorType:"google_drive",description:c,Icon:Ts,onClickConnect:d}),s[8]=l,s[9]=r,s[10]=c,s[11]=d,s[12]=u):u=s[12];let f;return s[13]!==i||s[14]!==u?(f=e.jsxs("div",{className:"bg-token-interactive-bg-accent-inactive",children:[i,u]}),s[13]=i,s[14]=u,s[15]=f):f=s[15],f}function $a(){return Ke({link:pe,location:"admin_settings_header"})}function Ja(t){"use forget";var u;const s=V.c(14);let a,n,o;s[0]!==t?(u=t,{refetchConnectionInstances:o,closeOtherModals:n}=u,a=is(u,["refetchConnectionInstances","closeOtherModals"]),s[0]=t,s[1]=a,s[2]=n,s[3]=o):(a=s[1],n=s[2],o=s[3]);const i=Qs(o);let l;s[4]!==n||s[5]!==i?(l=i.canStart?()=>{n(),i.open()}:void 0,s[4]=n,s[5]=i,s[6]=l):l=s[6];const r=i.isLoading||!i.canStart;let c;s[7]!==a||s[8]!==l||s[9]!==r?(c=e.jsx(Qe,G(E({},a),{onClickConnect:l,ctaIsLoading:r})),s[7]=a,s[8]=l,s[9]=r,s[10]=c):c=s[10];let d;return s[11]!==i.modals||s[12]!==c?(d=e.jsxs(e.Fragment,{children:[c,i.modals]}),s[11]=i.modals,s[12]=c,s[13]=d):d=s[13],d}function _s(t){"use forget";const s=V.c(24),{accountId:a,adminUserConnectionStatus:n,className:o,connectionInstances:i,connectionInstancesLoading:l,connectorName:r,connectorType:c,limits:d,onClickConnect:u,refetchConnectionInstances:f,singularNounConnectedObjectName:g,sharepointAdminConnectorEnabled:x}=t,p=x===void 0?!1:x,b=te(),M=i!=null&&!b&&(d.max_instances===Sn||i.length<d.max_instances);let _;s[0]!==i||s[1]!==c||s[2]!==p?(_=c==="sharepoint"&&p&&!(i!=null&&i.some(so)),s[0]=i,s[1]=c,s[2]=p,s[3]=_):_=s[3];const w=_;let v;s[4]!==c||s[5]!==u?(v=()=>{X.logEventWithStatsig("Contextual Answers Admin Create Connection Button Clicked","chatgpt_contextual_answers_admin_create_connection_button_clicked",{connectorType:c}),u==null||u()},s[4]=c,s[5]=u,s[6]=v):v=s[6];const C=v;let k;s[7]!==o?(k=Z("bg-token-bg-primary mt-2 flex w-full flex-col gap-4",o),s[7]=o,s[8]=k):k=s[8];let P;s[9]!==a||s[10]!==n||s[11]!==M||s[12]!==i||s[13]!==l||s[14]!==r||s[15]!==w||s[16]!==C||s[17]!==f||s[18]!==p||s[19]!==g?(P=l?e.jsx(He,{lines:2}):i!=null&&i.length?e.jsx(vs,{children:e.jsxs("div",{className:"grid w-full gap-4",style:{gridTemplateColumns:"repeat(auto-fit, minmax(360px, 1fr))"},children:[i.filter(eo).map(j=>e.jsx($s,{accountId:a,adminUserConnectionState:n==null?void 0:n.find(S=>S.user_connection_details.connection_instance_id===j.connection_config.connection_config_id),connectedKnowledgeSource:g,connection:j,connectorName:r,onCreateAnotherInstance:M?C:void 0,refetchConnectionInstances:f,showIcon:!0,sharepointAdminConnectorEnabled:p,eligibleToCreateNewSharepointAdminConnection:w},j.connection_config.connection_config_id)),i.length===1&&e.jsx("div",{},"grid-spacer")]})}):null,s[9]=a,s[10]=n,s[11]=M,s[12]=i,s[13]=l,s[14]=r,s[15]=w,s[16]=C,s[17]=f,s[18]=p,s[19]=g,s[20]=P):P=s[20];let O;return s[21]!==k||s[22]!==P?(O=e.jsx("div",{className:k,children:P}),s[21]=k,s[22]=P,s[23]=O):O=s[23],O}function eo(t){return!["deleted","deleting"].includes(t.connection_status)}function so(t){return t.connection_config.knowledge_connector_type==="sharepoint_admin"}function Qe(t){"use forget";const s=V.c(32),{badge:a,className:n,connectorName:o,connectorType:i,description:l,Icon:r,onClickConnect:c,ctaIsLoading:d}=t,u=d===void 0?!1:d,f=te();let g;s[0]!==i||s[1]!==c?(g=()=>{X.logEventWithStatsig("Contextual Answers Admin Create Connection Button Clicked","chatgpt_contextual_answers_admin_create_connection_button_clicked",{connectorType:i}),c==null||c()},s[0]=i,s[1]=c,s[2]=g):g=s[2];const x=g,p=!c||u;let b;s[3]===Symbol.for("react.memo_cache_sentinel")?(b=e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"icon text-[#007AFF]"}),e.jsx(m,{id:"FSQUDq",defaultMessage:"Enable Sync"})]}),s[3]=b):b=s[3];let M;s[4]!==u||s[5]!==x||s[6]!==p?(M=e.jsx(D,{className:"text-nowrap",color:"secondary",onClick:x,disabled:p,loading:u,children:b}),s[4]=u,s[5]=x,s[6]=p,s[7]=M):M=s[7];const _=M;let w;s[8]!==n?(w=Z("bg-token-bg-primary flex w-full flex-col gap-4","p-5",n),s[8]=n,s[9]=w):w=s[9];let v;s[10]!==r?(v=e.jsx("div",{className:"h-fit rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(r,{className:"icon-lg shrink-0"})}),s[10]=r,s[11]=v):v=s[11];let C;s[12]!==o?(C=e.jsx("p",{className:"text-primary",children:o}),s[12]=o,s[13]=C):C=s[13];let k;s[14]!==a||s[15]!==C?(k=e.jsxs("div",{className:"flex items-center gap-1",children:[C,a]}),s[14]=a,s[15]=C,s[16]=k):k=s[16];let P;s[17]!==l?(P=e.jsx("p",{className:"text-token-text-secondary text-sm",children:l}),s[17]=l,s[18]=P):P=s[18];let O;s[19]!==P||s[20]!==k?(O=e.jsxs("div",{className:"flex min-w-[240px] flex-1 flex-col gap-0.5",children:[k,P]}),s[19]=P,s[20]=k,s[21]=O):O=s[21];let j;s[22]!==_||s[23]!==f?(j=e.jsx("div",{className:"flex shrink-0 items-center",children:f?e.jsx(Me,{children:_}):_}),s[22]=_,s[23]=f,s[24]=j):j=s[24];let S;s[25]!==O||s[26]!==j||s[27]!==v?(S=e.jsxs("div",{className:"flex w-full flex-row flex-wrap items-center gap-4",children:[v,O,j]}),s[25]=O,s[26]=j,s[27]=v,s[28]=S):S=s[28];let F;return s[29]!==S||s[30]!==w?(F=e.jsx("div",{className:w,children:S}),s[29]=S,s[30]=w,s[31]=F):F=s[31],F}function to({accountId:t,connectionInstances:s,connectionInstancesLoading:a,refetchConnectionInstances:n}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-full flex-col gap-4",children:a?e.jsx(He,{lines:2}):s!=null&&s.length?e.jsx(vs,{children:e.jsxs("div",{className:"grid w-full gap-4",style:{gridTemplateColumns:"repeat(auto-fit, minmax(360px, 1fr))"},children:[s.map(o=>e.jsx($s,{connection:o,showIcon:!0,accountId:t,refetchConnectionInstances:n},o.connection_config.connection_config_id)),s.length===1&&e.jsx("div",{},"grid-spacer")]})}):null}),e.jsx(Va,{})]})}function Js(t){"use forget";const s=V.c(12),{badge:a,showDescription:n}=t,o=n===void 0?!0:n,i=I();let l;s[0]!==i?(l=i.formatMessage({id:"PzngEC",defaultMessage:"Synced connectors"}),s[0]=i,s[1]=l):l=s[1];let r;s[2]!==l?(r=e.jsx("span",{children:l}),s[2]=l,s[3]=r):r=s[3];let c;s[4]!==a||s[5]!==r?(c=e.jsxs(Ge,{className:"flex flex-row items-center gap-2",children:[r,a]}),s[4]=a,s[5]=r,s[6]=c):c=s[6];let d;s[7]!==o?(d=o&&e.jsx(Le,{className:"text-token-text-secondary",children:e.jsx(m,{id:"Y9lNjg",defaultMessage:"ChatGPT syncs, indexes, and stores your organization's content for higher quality, up-to-date answers. {learnMore}",values:{learnMore:e.jsx(ve,{href:pe,className:"underline",onClick:no,children:e.jsx(m,{id:"WGpoE2",defaultMessage:"Learn more"})},"learnMore")}})}),s[7]=o,s[8]=d):d=s[8];let u;return s[9]!==c||s[10]!==d?(u=e.jsxs("div",{children:[c,d]}),s[9]=c,s[10]=d,s[11]=u):u=s[11],u}function no(){return Ke({link:pe,location:"admin_settings_header"})}function ao({feedbackMetadata:t,currentWorkspaceId:s,onClose:a,onFeedbackActionTaken:n}){const o=I(),{data:i,refetch:l,isLoading:r}=je({queryKey:["adminGetCaMessageFeedback",s,t.feedback_id],queryFn:()=>ee.safeGet("/ca/admin/feedback/{feedback_id}",{parameters:{path:{feedback_id:t.feedback_id},query:{account_id:s}}})}),c=z(),d=_e({mutationFn:f=>f.operation==="delete"?ee.safeDelete("/ca/admin/feedback/{feedback_id}",{parameters:{path:{feedback_id:f.feedbackId},query:{account_id:f.workspaceId}}}):ee.safePost("/ca/admin/feedback/{feedback_id}/approve",{parameters:{path:{feedback_id:f.feedbackId},query:{account_id:f.workspaceId,with_sources:f.withSources}}}),onSuccess:(f,g)=>{n(),a(),c.success(g.operation==="approve"?o.formatMessage(U.feedbackApproved):o.formatMessage(U.feedbackDeleted))},onError:(f,g)=>{l(),c.warning(g.operation==="approve"?o.formatMessage(U.errorApprovingFeedback):o.formatMessage(U.errorDeletingFeedback))}}),u=h.useMemo(()=>{const f=t.review_status==="unreviewed",g=t.review_status==="unreviewed";let x;switch(t.review_status){case"approved_with_sources":case"approved_without_sources_data_expired":{x=o.formatMessage(U.actionMessageNoActionsAvailable);break}case"approved_without_sources_data_available":{x=o.formatMessage(U.actionMessageApprovedWithoutSources);break}case"deleted":{x=o.formatMessage(U.actionMessageFeedbackDeleted);break}}const p={workspaceId:s,feedbackId:t.feedback_id,withSources:!0};return e.jsxs("div",{className:"bg-token-main-surface-secondary sticky bottom-0 flex w-full flex-col gap-2 rounded-lg p-4",children:[!!x&&e.jsx("div",{children:e.jsx("p",{children:x})}),e.jsxs("div",{className:"flex flex-row gap-2",children:[f&&e.jsx(D,{color:"primary",icon:Be,onClick:()=>d.mutate(G(E({},p),{operation:"approve"})),loading:d.isPending,children:e.jsx(m,{id:"Zq8YOH",defaultMessage:"Approve Feedback"})}),g&&e.jsx(D,{color:"danger-outline",icon:Pe,onClick:()=>d.mutate(G(E({},p),{operation:"delete"})),loading:d.isPending,children:e.jsx(m,{id:"qeIjD9",defaultMessage:"Delete Feedback"})})]})]})},[t.review_status,t.feedback_id,d,s,o]);return e.jsx(oo,{actionBar:u,onClose:a,isLoading:r,feedbackData:i,feedbackMetadata:t})}function oo({actionBar:t=null,onClose:s=()=>{},isLoading:a=!1,isDebugView:n=!1,feedbackData:o,feedbackMetadata:i}){var r;const l=I();return e.jsx(Y,{testId:"modal-admin-feedback",size:"custom",className:"max-w-lg overflow-y-auto text-base",isOpen:!0,icon:vt,onClose:s,showCloseButton:!0,type:"success",title:l.formatMessage(U.modalTitle),children:e.jsx("div",{className:"flex flex-col",children:o&&!a?e.jsxs(e.Fragment,{children:[e.jsx(io,{feedbackData:o,feedbackMetadata:i,isDebugView:n}),e.jsx(cs,{className:"my-4"}),e.jsx(ro,{fileRefs:o.file_references}),e.jsx(cs,{className:"my-4"}),e.jsx(co,{retrievalMessages:o.retrieval_messages,userDisplayName:(r=i.submitter_display_name)!=null?r:i.submitter_email,isDebugView:n}),t]}):e.jsx(ln,{lines:8})})})}function io({feedbackMetadata:t,feedbackData:s,isDebugView:a=!1}){var l;const n=I(),o=t.submitter_display_name&&t.submitter_email?n.formatMessage(U.userDisplayName,{displayName:t.submitter_display_name,email:t.submitter_email}):t.submitter_id,i=h.useMemo(()=>s.sources_feedback?Object.entries(s.sources_feedback).map(([r,c])=>{var f,g,x,p;if(!c.rating&&!(c.tags&&c.tags.length>0))return null;const d=(f=s.file_references.find(b=>b.document_id===r))==null?void 0:f.title,u=c.tags&&c.tags.length===1&&c.tags[0]===Fn;return e.jsxs("li",{className:"flex flex-col p-1 text-sm break-words",children:[e.jsxs("div",{className:"mb-1 flex flex-row items-center gap-2",children:[c.rating==="thumbsUp"?e.jsx(Mt,{className:"icon-sm"}):c.rating==="thumbsDown"?e.jsx(ds,{className:"icon-sm"}):null,e.jsx("a",{href:(g=c.url)!=null?g:void 0,className:"text-sm font-semibold",children:(x=d!=null?d:c.url)!=null?x:r})]}),e.jsx("div",{className:"flex flex-row flex-wrap gap-1",children:u?e.jsx("span",{className:"italic",children:e.jsx(m,{id:"yNGc6H",defaultMessage:"This source should have been used."})}):(p=c.tags)==null?void 0:p.map(b=>e.jsx("div",{className:"border-token-border-default text-token-text-secondary rounded-lg border px-3 py-1 text-xs",children:fs(b,n)},b))})]},r)}).filter(r=>!!r):[],[s.file_references,s.sources_feedback,n]);return e.jsxs("div",{children:[!a&&e.jsx("div",{className:"mb-2",children:e.jsx(et,{reviewStatus:t.review_status})}),e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[s.rating==="thumbsUp"?e.jsx(wt,{className:"icon-xl m-2"}):e.jsx(ds,{className:"icon-xl m-2"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:o}),t.submitted_at&&e.jsx("p",{className:"text-token-text-secondary text-xs",children:new Date(t.submitted_at).toLocaleString()})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-1",children:(l=s.tags)==null?void 0:l.map(r=>e.jsx("div",{className:"border-token-border-default text-token-text-secondary rounded-lg border px-3 py-1 text-sm",children:fs(r,n)},r))}),e.jsxs("div",{className:"mb-2",children:[e.jsx(me,{className:"mb-1",children:e.jsx(m,{id:"VrPx6x",defaultMessage:"Feedback"})}),e.jsx("p",{className:"rounded-sm border p-2 text-sm break-words",children:s.text?s.text:e.jsx("span",{className:"italic",children:e.jsx(m,{id:"pEEJ/8",defaultMessage:"No written feedback was provided."})})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx(me,{className:"mb-1",children:e.jsx(m,{id:"LUg6Vl",defaultMessage:"Additional Sources"})}),e.jsx("p",{className:"rounded-sm border p-2 text-sm break-words",children:s.additional_sources?s.additional_sources:e.jsx("span",{className:"italic",children:e.jsx(m,{id:"u24Zo5",defaultMessage:"No additional sources were provided."})})})]}),i.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx(me,{className:"mb-1",children:e.jsx(m,{id:"lNSdNZ",defaultMessage:"Sources Feedback"})}),e.jsx("ul",{className:"flex flex-col gap-1",children:i})]})]})}const lo=["citation","context_stuff","search_result"];function js(t){return Array.from(t.map(s=>{var a,n,o;return Nt({id:s.document_id,cloud_doc_url:(a=s.external_url)!=null?a:void 0,name:(n=s.title)!=null?n:"",extra:{cloud_doc_url:(o=s.external_url)!=null?o:void 0}})}).filter(s=>!!s))}function ro({fileRefs:t}){const[s,a]=h.useMemo(()=>{const n=new Map,o=new Map;return t.forEach(i=>{lo.includes(i.reference_source)&&i.external_url&&!n.has(i.document_id)?n.set(i.document_id,i):i.reference_source==="user_feedback"&&i.external_url&&!o.has(i.document_id)&&o.set(i.document_id,i)}),[js(Array.from(n.values())),js(Array.from(o.values()))]},[t]);return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(me,{className:"mb-2",children:e.jsx(m,{id:"FB4YIA",defaultMessage:"Sources In Conversation"})}),s.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-secondary mb-2 text-xs",children:e.jsx(m,{id:"iTNNoN",defaultMessage:"These sources were considered or cited in the conversation. Snapshots of these sources will be included with the feedback if you choose to approve the feedback."})}),e.jsx("div",{className:"flex flex-col gap-1",children:s.map(n=>e.jsx(us,{compact:!0,citationMetadata:n},n.url))})]}):e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(m,{id:"Q+DKpB",defaultMessage:"No synced sources were considered or cited in the conversation, however there may be other sources present such as user uploaded files. If you choose to approve this feedback, only the snippets of those files that ChatGPT looked at will be shared with this feedback."})})]}),a.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx(me,{className:"mb-2",children:e.jsx(m,{id:"SCwQnr",defaultMessage:"Sources From Feedback"})}),e.jsx("p",{className:"text-token-text-secondary mb-2 text-xs",children:e.jsx(m,{id:"Rr+4KZ",defaultMessage:"The feedback submitter mentioned these documents in their feedback. Snapshots of these documents will be included with the feedback if you choose to approve the feedback with sources and the user had access to them."})}),e.jsx("div",{className:"flex flex-col gap-1",children:a.map(n=>e.jsx(us,{compact:!0,citationMetadata:n},n.url))})]})]})}function co({retrievalMessages:t,userDisplayName:s,isDebugView:a=!1}){return e.jsxs("div",{className:"mb-8",children:[e.jsx(me,{className:"mb-4",children:e.jsx(m,{id:"pOb00r",defaultMessage:"Conversation"})}),t.map(n=>e.jsx(uo,{message:n,userDisplayName:s,isDebugView:a},n.id))]})}function uo({message:t,userDisplayName:s,isDebugView:a=!1}){var o,i,l,r,c,d;const n=I();switch(t.type){case"visible_text":{if(t.author==="unknown")return null;const u={id:t.id,author:{role:t.author},clientMetadata:{canRetry:!1},metadata:{citations:(o=t.citations)!=null?o:[],attachments:(i=t.attachments)!=null?i:[],content_references:t.content_refs?t.content_refs:((l=t.citations)!=null?l:[]).map(f=>{var x,p,b;return((x=f.metadata)==null?void 0:x.type)!=="file"?null:{start_idx:f.start_ix,end_idx:f.end_ix,refs:[],matched_text:t.text.slice(f.start_ix,f.end_ix),type:"file",source:f.metadata.source,name:f.metadata.name,id:f.metadata.id,cloud_doc_url:(b=f.metadata.cloud_doc_url)!=null?b:(p=f.metadata.extra)==null?void 0:p.cloud_doc_url}}).filter(f=>!!f)},content:{content_type:rn.Text,parts:[t.text]}};return e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:Z("text-token-text-secondary mb-1 text-xs",t.author==="user"?"pe-4 text-end":"text-start"),children:t.author==="assistant"?n.formatMessage(U.authorChatGPT):t.author==="user"?s!=null?s:n.formatMessage(U.authorUser):t.author}),e.jsx(On,{id:t.id,messages:[u],attachments:(r=u.metadata)==null?void 0:r.attachments,citations:(c=u.metadata)==null?void 0:c.citations,contentReferences:(d=u.metadata)==null?void 0:d.content_references,parts:[t.text],displayParts:cn({isUserTurn:t.author==="user",parts:[t.text]}),isActivelyStreaming:!1,isCompletionInProgress:!1,isFinalUserTurn:!1,hasActiveRequest:!1,clientThreadId:"--fake-thread-id--",isUserTurn:t.author==="user",turnIndex:0,isFeedbackEnabled:!1})]})}case"query":return e.jsxs("div",{className:"text-token-text-primary my-2 text-xs",children:[e.jsx(An,{className:"me-2"}),a?e.jsx(m,{id:"AVzRit",defaultMessage:"ChatGPT performed a search: {query}",values:{query:t.query}}):e.jsx(m,{id:"bJ9BXd",defaultMessage:"ChatGPT performed a search."})]});case"result":return a?e.jsx(mo,{message:t}):null;case"fetch":return a?e.jsxs("div",{className:"text-token-text-primary my-2 text-xs",children:[e.jsx(kt,{className:"me-2"}),e.jsx(m,{id:"uH5X47",defaultMessage:"Read file: {fileName}",values:{fileName:t.content.content_type==="tether_quote"?t.content.title:"unknown"}})]}):null;case"generic_file_search_tool":return a?e.jsxs("div",{className:"text-token-text-primary my-2 text-xs",children:[e.jsx(Dn,{className:"me-2"}),e.jsx(m,{id:"pJmg4S",defaultMessage:"Tool message with command: {command}.",values:{command:t.command}})]}):null;case"system":case void 0:return null}}function mo({message:t}){const[s,a]=h.useState(!1);return t.type!=="result"?null:e.jsxs("div",{className:"text-token-text-primary mt-2 mb-4 text-xs",children:[e.jsxs("div",{onClick:()=>a(n=>!n),className:"flex flex-row",children:[e.jsx(In,{checked:s,className:"flex-0"}),e.jsx("div",{className:"flex-1",children:e.jsx(m,{id:"94EEkt",defaultMessage:"Found {numResults} results.",values:{numResults:t.result.chunks.length}})})]}),s&&e.jsxs("div",{className:"mt-2",children:[t.result.chunks.map(n=>e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"text-token-text-primary mb-1 text-sm font-bold",children:e.jsx(m,{id:"zyGUoc",defaultMessage:"Result {number}: {title}",values:{number:n.result_num,title:n.title}})}),e.jsx("h4",{className:"text-token-text-secondary mb-1 text-xs",children:n.document_id}),e.jsx("pre",{className:"max-h-[200px] max-w-full overflow-auto p-2 text-wrap",children:n.contents})]},n.result_num)),e.jsxs("div",{className:"p-2 text-center",onClick:()=>a(!1),children:[e.jsx("p",{className:"text-token-text-secondary mb-1 font-bold",children:e.jsx(m,{id:"8UUzYt",defaultMessage:"Collapse Results"})}),e.jsx("hr",{className:""})]})]})]})}function et({reviewStatus:t,onClick:s,disabled:a}){let n;const o=I();switch(t){case"unreviewed":n=o.formatMessage(U.reviewStatusUnreviewed);break;case"approved_with_sources":n=o.formatMessage(U.reviewStatusApprovedWithSouces);break;case"approved_without_sources_data_available":case"approved_without_sources_data_expired":n=o.formatMessage(U.reviewStatusApprovedWithoutSources);break;case"deleted":n=o.formatMessage(U.reviewStatusDeleted);break}return e.jsx("button",{className:Z("text-token-text-primary rounded-2xl px-3 py-1 text-sm",t==="unreviewed"&&"bg-[#e2c541] dark:bg-[#EA8444]"),onClick:s,disabled:!!a||!s,children:n})}const U=Se({modalTitle:{id:"zufVun",defaultMessage:"Review Feedback"},feedbackApproved:{id:"DS+YGt",defaultMessage:"Feedback approved."},feedbackDeleted:{id:"Rz/tmW",defaultMessage:"Feedback deleted."},errorApprovingFeedback:{id:"UVsTlf",defaultMessage:"Encountered an error approving this feedback. Please refresh and try again."},errorDeletingFeedback:{id:"cI6gt9",defaultMessage:"Encountered an error deleting this feedback. Please refresh and try again."},actionMessageFeedbackCreating:{id:"urBely",defaultMessage:"You can't take actions on this feedback yet because it's still being processed. Once it's done processing, it will be available for review."},actionMessageNoActionsAvailable:{id:"JGNhjT",defaultMessage:"This feedback has been reviewed."},actionMessageApprovedWithoutSources:{id:"68PAfK",defaultMessage:"This feedback has already been approved without sources, but you can re-approve it with sources."},actionMessageFeedbackDeleted:{id:"Kel9lE",defaultMessage:"This feedback has been deleted."},labelIncludeSources:{id:"8UlZM0",defaultMessage:"Include Sources"},authorChatGPT:{id:"7Fo5p2",defaultMessage:"ChatGPT"},authorUser:{id:"TpT0hg",defaultMessage:"User"},userDisplayName:{id:"3OKTcX",defaultMessage:"{displayName} ({email})"},reviewStatusUnreviewed:{id:"FEHKZj",defaultMessage:"Needs Review"},reviewStatusCreating:{id:"7lVVU7",defaultMessage:"Preparing for Review"},reviewStatusApprovedWithSouces:{id:"kpZ41g",defaultMessage:"Approved With Sources"},reviewStatusApprovedWithoutSources:{id:"Y0lc+p",defaultMessage:"Approved Without Sources"},reviewStatusDeleted:{id:"gKoYhr",defaultMessage:"Deleted"}});function fo({currentWorkspaceId:t}){const{data:s,refetch:a,isLoading:n}=je({queryKey:["adminListCaMessageFeedback",t],queryFn:()=>ee.safeGet("/ca/admin/feedback",{parameters:{query:{account_id:t}}})}),[o,i]=h.useState();return e.jsxs(Ee,{className:"mb-8",children:[e.jsx(Ge,{children:e.jsx(m,{id:"r4Y3mj",defaultMessage:"Review Feedback"})}),e.jsx(Le,{className:"text-token-text-secondary",children:e.jsx(m,{id:"mqh7NS",defaultMessage:"Review feedback your workspace users have submitted. Feedback is not shared with OpenAI until you approve it."})}),s&&!n?e.jsx(po,{feedbackList:s.feedback,setSelectedFeedback:i}):e.jsx(K,{}),o&&e.jsx(ao,{feedbackMetadata:o,currentWorkspaceId:t,onClose:()=>i(void 0),onFeedbackActionTaken:()=>a()})]})}function ys(t){switch(t){case"unreviewed":return 1;case"approved_with_sources":return 2;case"approved_without_sources_data_available":return 3;case"approved_without_sources_data_expired":return 4;case"deleted":return 5}}function po({feedbackList:t,setSelectedFeedback:s}){const a=h.useMemo(()=>[...t].sort((n,o)=>{const i=ys(n.review_status)-ys(o.review_status);return i!==0?i:n.submitted_at>o.submitted_at?-1:n.submitted_at<o.submitted_at?1:0}),[t]);return e.jsxs(H.Root,{size:"normal",children:[e.jsxs(H.Header,{children:[e.jsx(H.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(m,{id:"KcGNl2",defaultMessage:"Review Status"})}),e.jsx(H.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:e.jsx(m,{id:"joba0B",defaultMessage:"Submitted By"})}),e.jsx(H.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:e.jsx(m,{id:"yl1cCR",defaultMessage:"Submitted At"})})]}),e.jsx(H.Body,{children:a.length===0?e.jsx(H.Row,{children:e.jsx(H.Cell,{children:e.jsx(m,{id:"AYwCJD",defaultMessage:"No feedback yet."})})}):a.map(n=>{const o=n.review_status==="deleted",i=o?void 0:()=>s(n);return e.jsxs(H.Row,{className:Z("my-2",o?"bg-token-main-surface-tertiary":"hover:bg-token-main-surface-secondary hover:cursor-pointer"),onClick:i,children:[e.jsx(H.Cell,{className:"truncate",children:e.jsx(et,{reviewStatus:n.review_status,onClick:i,disabled:o})}),e.jsx(H.Cell,{className:"truncate",children:e.jsx("span",{children:n.submitter_display_name&&n.submitter_email?e.jsx(m,{id:"3OKTcX",defaultMessage:"{displayName} ({email})",values:{displayName:n.submitter_display_name,email:n.submitter_email}}):e.jsx("code",{children:n.submitter_id.split("__")[0]})})}),e.jsx(H.Cell,{className:"truncate",children:e.jsx("span",{children:new Date(n.submitted_at).toLocaleString()})})]},n.feedback_id)})})]})}function go(){const t=I(),s=dn(),a=un(),n=ot(),o=mn();se();const i=!1,l=se(),r=Ns(l,"2509278897"),{isComingSoon:c}=fn(),d=n||c;return e.jsxs(e.Fragment,{children:[e.jsx(it,{title:t.formatMessage({id:"q9azuh",defaultMessage:"Connectors"}),subtitle:d?void 0:e.jsx(Vs,{})}),e.jsxs(lt,{skipLegacyWorkspaceCheck:!0,children:[o?e.jsxs(St,{children:[e.jsx(m,{id:"9menCz",defaultMessage:"Connectors may allow end users to share data, which could include protected health information (PHI), with third parties. You should ensure that your use of connectors complies with your obligations under HIPAA. "}),e.jsx(ve,{href:"https://help.openai.com/en/articles/11509118-admin-controls-security-and-compliance-in-connectors-enterprise-edu-and-team#h_f11dede080",className:"ms-1 underline",children:e.jsx(m,{id:"f0WqA2",defaultMessage:"Learn more about Connectors."})})]}):null,e.jsxs(Tt,{className:"mt-6 gap-12",children:[n?e.jsxs(e.Fragment,{children:[e.jsx(Xa,{}),s!=null&&a===pn.ALPHA&&e.jsx(fo,{currentWorkspaceId:s.id})]}):c?e.jsx(xo,{}):null,s!=null&&r&&e.jsxs(Ee,{children:[d&&e.jsx(Kn,{}),e.jsx(Vn,{workspaceId:s.id,isQuorumBetaUser:i})]})]})]})]})}function xo(){return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{children:e.jsx(Js,{badge:e.jsx("div",{children:e.jsx("span",{className:"text-token-text-secondary rounded-xl border px-2 py-1 text-[8px] font-bold uppercase",children:e.jsx(m,{id:"IrfQIu",defaultMessage:"Coming soon"})})})})}),e.jsxs("div",{className:"bg-token-main-surface-tertiary text-token-text-secondary flex flex-row gap-2 rounded-xl p-4",children:[e.jsx(Pt,{className:"icon"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs font-bold",children:e.jsx(m,{id:"ES5xU+",defaultMessage:"When will this feature be available?"})}),e.jsxs("p",{className:"text-xs",children:[e.jsx(m,{id:"FYrNXO",defaultMessage:"Internal knowledge will be rolled out incrementally to ChatGPT Business workspaces over the next few weeks. We will notify you in ChatGPT when your workspace is eligible."})," ",e.jsx(ve,{href:pe,className:"underline",onClick:()=>Ke({link:pe,location:"admin_settings_coming_soon_widget"}),children:e.jsx(m,{id:"WGpoE2",defaultMessage:"Learn more"})})]})]})]})]})}const li=at(function(){return e.jsx(go,{})});export{li as default};
//# sourceMappingURL=iolqvj6ly0pzm583.js.map

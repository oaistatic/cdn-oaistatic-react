var X=Object.defineProperty,$=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var T=(a,t,s)=>t in a?X(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,c=(a,t)=>{for(var s in t||(t={}))K.call(t,s)&&T(a,s,t[s]);if(L)for(var s of L(t))V.call(t,s)&&T(a,s,t[s]);return a},w=(a,t)=>$(a,F(t));import{b as S,d as G,j as e,r as h,M as W,u as ee,a as ae}from"./n75kuy1cx6f5mogg.js";import{pz as te,pA as se,e as re,f1 as oe,e5 as I,f as Q,aF as z,d9 as R,mf as b,C as le,I as ce,pH as ne,pI as ie,jT as de,pJ as pe,lq as ue,gY as me,R as fe,dG as xe,iA as ke,iB as he}from"./ewse8exzafeu10ji.js";import{bu as ve,fC as Me,aR as je}from"./ny10lj7zpuz89fvf.js";import{u as be}from"./j2ui4c2m3nj8pqst.js";function ge({onFileChange:a,className:t,message:s,mimeTypes:f}){const v=S(),n=s!=null?s:v.formatMessage(O.helpText),i=A=>{if(A.length>0){const N=A[0];f&&f.includes(N.type)&&a(N)}},{open:g,getRootProps:M,getInputProps:y,isDragActive:m}=be(c({disabled:!1,noClick:!0,onDropAccepted:i,onDropRejected:()=>null,multiple:!1,maxSize:se},te(f)));return e.jsxs("div",w(c({className:re("flex flex-col content-center justify-center gap-3 rounded-xl border border-dashed px-6 py-16 text-center",m?"border-green-600 bg-green-600/10":"border-token-border-medium",t)},M()),{children:[e.jsx("input",c({},y())),e.jsx("div",{className:"text-center dark:text-white",children:e.jsx("div",{className:"inline-block",children:e.jsx(ve,{})})}),e.jsx("div",{className:"text-center text-sm",children:n}),e.jsx("div",{className:"cursor-pointer text-center text-sm font-bold text-green-600",onClick:()=>{g()},children:v.formatMessage(O.openFilePicker)})]}))}const O=G({helpText:{id:"FileUploadBox.helpText",defaultMessage:"Drop file here to upload"},openFilePicker:{id:"FileUploadBox.openFilePicker",defaultMessage:"Browse files"}}),q=192;function we(a){const t=ee(),s=S(),f=Q();return ae({mutationFn:({name:v,profilePictureId:n,profilePictureUrl:i})=>fe.safePatch("/accounts/{account_id}",{parameters:{path:{account_id:a}},requestBody:{name:v,profile_picture_id:n!=null?n:"",profile_picture_url:i!=null?i:""}}).catch(g=>{f.danger(s.formatMessage(p.saveError,{error:g.message}),{toastId:"workspace_appearance_modal",loggingTitle:p.saveError.defaultMessage,loggingDescription:"Failed to save workspace appearance"})}),onSuccess:()=>{t.invalidateQueries(me())}})}function We({workspace:a}){var D,E;const[t,s]=h.useState((D=a==null?void 0:a.name)!=null?D:""),[f,v]=h.useState(!1);!f&&a&&(v(!0),t==""&&s((E=a==null?void 0:a.name)!=null?E:""));const[n,i]=h.useState(a.profilePictureUrl),[g,M]=h.useState(a.profilePictureId),y=oe(I.WorkspaceAppearance),m=S(),A=Q(),N=()=>R.closeModal(I.WorkspaceAppearance),[o,x]=h.useState(void 0);async function J(u){const j=await ie(u,q),_=de(j);x({tempId:_,file:j,status:b.Uploading,progress:1,fileId:null,cdnUrl:null}),pe(_,j,m,A,ue.ProfilePicture,{onFileCreated(k,d,l){x(r=>r!=="initial"&&(r==null?void 0:r.tempId)===k&&r.status===b.Uploading?w(c({},r),{progress:10,fileId:d,cdnUrl:l}):r)},onFileUploadProgress(k,d){x(l=>l!=="initial"&&(l==null?void 0:l.tempId)===k&&l.status===b.Uploading?w(c({},l),{progress:d}):l)},onFileUploaded(k,d,l){x(r=>r!=="initial"&&r&&r.cdnUrl&&r.tempId===k?(ke(r.fileId).then(B=>{B.status===he.Success&&(M(r.fileId),i(B.download_url))}),w(c({},r),{status:b.Ready,progress:100,fileSpec:c({name:r.file.name,id:r.fileId,size:r.file.size},l!=null?l:{})})):r)},onError(k){x(d=>{if(d!=="initial"&&(d==null?void 0:d.tempId)===k){M(void 0),i(void 0),C(null);return}return d})}})}const P=we(a.id),Y=e.jsx(z.Button,{color:"primary",disabled:o!=="initial"&&o!==void 0&&o.status!==b.Ready||o!=="initial"&&o!==void 0&&o.status===b.Ready&&!n||P.isPending||t.trim().length===0,onClick:async()=>{P.mutate({name:t,profilePictureId:g,profilePictureUrl:n}),R.closeModal(I.WorkspaceAppearance)},title:m.formatMessage(p.modalSubmit)}),Z=e.jsx(z.Button,{onClick:()=>{x(void 0),M(a.profilePictureId),i(a.profilePictureUrl),R.closeModal(I.WorkspaceAppearance)},title:m.formatMessage(p.modalCancel)}),[U,C]=h.useState(null);h.useEffect(()=>{if(o!=="initial"&&o!=null&&U==null){const u=new FileReader;u.addEventListener("load",()=>{const j=u.result;typeof j=="string"&&C(j)}),u.readAsDataURL(o.file)}},[o,U]);const H=()=>{M(null),i(null),x(void 0),C(null)};return e.jsxs(le,{testId:"modal-workspace-appearance",isOpen:y,onClose:N,showCloseButton:!0,primaryButton:Y,secondaryButton:Z,type:"danger",title:m.formatMessage(p.modalTitle),children:[e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-name",className:"text-token-text-primary block pb-1 font-semibold",children:e.jsx(W,c({},p.workspaceName))}),e.jsx("p",{className:"font-base text-token-text-secondary text-sm",children:e.jsx(W,c({},p.workspaceNameDescription))})]}),e.jsx("div",{className:"mb-4",children:e.jsx(ce,{ariaLabel:!1,type:"text",name:"workspace-name",value:t,onChange:u=>s(u.target.value),maxLength:64})}),e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-avatar",className:"text-token-text-primary block pb-1 font-semibold",children:e.jsx(W,c({},p.workspaceAvatar))}),e.jsx("p",{className:"font-base text-token-text-secondary text-sm",children:m.formatMessage(p.workspaceAvatarDescription,{size:q})})]}),e.jsxs("div",{className:"mb-4 flex-wrap text-center",children:[n?e.jsxs("div",{className:"relative mb-3 inline-flex",children:[e.jsx("img",{src:n,alt:"",referrerPolicy:"no-referrer",className:"block h-24 w-24 rounded-full object-cover object-center"}),e.jsx("div",{className:"absolute -end-1 -top-1",children:e.jsx(Ae,{onClick:H})})]}):o!=null&&o!=="initial"&&U?e.jsx("div",{className:"flex flex-col justify-center text-center",children:e.jsxs("div",{className:"relative mb-3 text-center",children:[e.jsx("img",{src:URL.createObjectURL(o.file),alt:"",referrerPolicy:"no-referrer",className:"block h-24 w-24 rounded-full object-cover object-center"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsx(Me,{percentage:o.progress,className:"h-6 w-6"})})]})}):e.jsx(ge,{onFileChange:u=>{J(u)},mimeTypes:ne}),e.jsx(je,{className:"mt-3",children:m.formatMessage(p.propagationWarning)})]})]})}function Ae({onClick:a}){return e.jsx("div",{className:"flex h-6 w-6 cursor-pointer flex-row flex-wrap content-center justify-center rounded-full border-2 border-white bg-black text-white",onClick:a,children:e.jsx(xe,{className:"h-3 w-3"})})}const p=G({modalTitle:{id:"workspaceAppearanceModal.title",defaultMessage:"Workspace appearance"},modalSubmit:{id:"workspaceAppearanceModal.submit",defaultMessage:"Save"},modalCancel:{id:"workspaceAppearanceModal.cancel",defaultMessage:"Cancel"},modalReset:{id:"workspaceAppearanceModal.reset",defaultMessage:"Reset"},workspaceName:{id:"workspaceAppearanceModal.workspaceName",defaultMessage:"Workspace name"},workspaceNameDescription:{id:"workspaceAppearanceModal.workspaceNameDescription",defaultMessage:"Update the name of the workspace."},workspaceAvatar:{id:"workspaceAppearanceModal.workspaceAvatar",defaultMessage:"Workspace image"},workspaceAvatarDescription:{id:"workspaceAppearanceModal.workspaceAvatarDescription",defaultMessage:"Upload a JPEG or PNG workspace image for your team. (Minimum {size}Ã—{size}px recommended.)"},propagationWarning:{id:"workspaceAppearanceModal.propagationWarning",defaultMessage:"Changes to the workspace name and image may take some time to take effect."},saveError:{id:"workspaceAppearanceModal.saveError",defaultMessage:"Failed to save workspace appearance"}});export{ge as F,We as W,p as m,we as u};
//# sourceMappingURL=n81diue0m3az0e3g.js.map

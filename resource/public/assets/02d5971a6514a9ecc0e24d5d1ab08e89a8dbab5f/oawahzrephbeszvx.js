import{aw as _,bR as l,gf as d,gg as g,cw as C,b as u,g as E,f3 as i,bq as k,gh as r}from"./i3bl95k8z8nuf4dv.js";import{d as m}from"./msupklk377u8vx8o.js";class S{static async getCheckoutLink(t,o,a){if(a==null||a.billing_details==null){const n=new Error("chatgpt_payload_undefined_in_checkout_link");throw _.addError(n,{callLocation:o}),l.logEvent("chatgpt_payload_undefined_in_checkout_link",null,{callLocation:o}),n}let e=Promise.resolve(void 0);t?.includes(d)&&(e=g("chatgpt_checkout").catch(n=>{_.addError(n)}));const c=C(null,null,null,await e);return await u.safePost("/payments/checkout",{requestBody:a,additionalHeaders:c})}static async fetchExistingCheckoutSession(t,o){return await u.safeGet("/payments/checkout/{processor_entity}/{checkout_session_id}",{parameters:{path:{processor_entity:t,checkout_session_id:o}}})}}const T="3950229590",f="enabled_custom_checkout_for_plus",w="enabled_custom_checkout_for_pro",N="enabled_custom_checkout_for_team",h="chatgpt_web_checkout_navigate_to_checkout",O="chatgpt_web_checkout_prepare_checkout_session";function b(s){switch(s){case r.PLUS:return f;case r.PRO:return w;case r.TEAM:return N;default:return null}}function p(s,t){const o=b(t);return o==null?"redirect":k(s,T).get(o,!1)?"custom":"redirect"}function A(){const s=m(),t=E();async function o(e,c,n){return e.checkout_ui_mode=p(t,e.plan_name),i(t,{eventName:O,metadata:{ui_mode:e.checkout_ui_mode}}),await S.getCheckoutLink(n,c,e)}async function a(e){if("tag"in e)switch(i(t,{eventName:h,metadata:{tag:e.tag}}),e.tag){case"hosted_checkout_session":case"redirect_to_portal":{window.location.href=e.url;break}case"custom_checkout_session":{const c=e.processor_entity,n=e.checkout_session_id;await s({pathname:`/checkout/${c}/${n}`,search:"",hash:""});break}}else if(e.url)i(t,{eventName:h,metadata:{tag:"missing_tag"}}),window.location.href=e.url;else throw new Error("Received invalid response from /checkout")}return{prepareCheckoutSession:o,navigateToCheckout:a}}export{A as u};
//# sourceMappingURL=oawahzrephbeszvx.js.map

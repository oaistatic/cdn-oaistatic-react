import{r,j as e,f as Se,M as a,g as _e}from"./msupklk377u8vx8o.js";import{c5 as Me,c4 as je,bQ as $,ax as S,gH as De,b as Q,en as ee,m as Le,bo as we,H as Ne,k as W,cP as Ie,bI as G,l as Pe,c as K,an as E,bR as A,f as J}from"./i3bl95k8z8nuf4dv.js";import{jM as Ee,U as z,be as Ae,bf as Re,M as Te,hx as Ue,ag as He,dS as Be,dT as Fe,dR as qe,G as X,ff as ze}from"./idf4u2jy0wx0pvap.js";import{i as Ve}from"./nr2o0yx4ps6bt6je.js";const Ze=t=>r.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8.75868 3H8.7587H15.2413H15.2413C16.0463 2.99999 16.7106 2.99998 17.2518 3.0442C17.8139 3.09012 18.3306 3.18868 18.816 3.43598C19.5686 3.81947 20.1805 4.43139 20.564 5.18404C20.8113 5.66938 20.9099 6.18608 20.9558 6.74818C21 7.28937 21 7.95372 21 8.75868V15.2413C21 16.0463 21 16.7106 20.9558 17.2518C20.9099 17.8139 20.8113 18.3306 20.564 18.816C20.1805 19.5686 19.5686 20.1805 18.816 20.564C18.3306 20.8113 17.8139 20.9099 17.2518 20.9558C16.7106 21 16.0463 21 15.2413 21H8.75868C7.95372 21 7.28937 21 6.74818 20.9558C6.18608 20.9099 5.66938 20.8113 5.18404 20.564C4.43139 20.1805 3.81947 19.5686 3.43598 18.816C3.18868 18.3306 3.09012 17.8139 3.0442 17.2518C2.99998 16.7106 2.99999 16.0463 3 15.2413V15.2413V8.75868V8.75866C2.99999 7.95371 2.99998 7.28936 3.0442 6.74818C3.09012 6.18608 3.18868 5.66938 3.43598 5.18404C3.81947 4.43139 4.43139 3.81947 5.18404 3.43598C5.66938 3.18868 6.18608 3.09012 6.74818 3.0442C7.28936 2.99998 7.95373 2.99999 8.75868 3ZM16.5678 9.32549C16.8856 8.87383 16.7772 8.25003 16.3255 7.93219C15.8738 7.61436 15.25 7.72285 14.9322 8.17451L10.9004 13.9039L9.23994 12.0773C8.86843 11.6687 8.23599 11.6386 7.82733 12.0101C7.41867 12.3816 7.38855 13.014 7.76006 13.4227L10.2601 16.1727C10.4642 16.3973 10.7593 16.517 11.0623 16.4981C11.3652 16.4792 11.6431 16.3237 11.8178 16.0755L16.5678 9.32549Z",fill:"currentColor"})),Oe=t=>r.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8.7587 3H15.2413C16.0463 2.99999 16.7106 2.99998 17.2518 3.04419C17.8139 3.09012 18.3306 3.18868 18.816 3.43597C19.5686 3.81947 20.1805 4.43139 20.564 5.18404C20.8113 5.66937 20.9099 6.18608 20.9558 6.74817C21 7.28936 21 7.95372 21 8.75868V15.2413C21 16.0463 21 16.7106 20.9558 17.2518C20.9099 17.8139 20.8113 18.3306 20.564 18.816C20.1805 19.5686 19.5686 20.1805 18.816 20.564C18.3306 20.8113 17.8139 20.9099 17.2518 20.9558C16.7106 21 16.0463 21 15.2413 21H8.75868C7.95372 21 7.28936 21 6.74817 20.9558C6.18608 20.9099 5.66937 20.8113 5.18404 20.564C4.43139 20.1805 3.81947 19.5686 3.43597 18.816C3.18868 18.3306 3.09012 17.8139 3.04419 17.2518C2.99998 16.7106 2.99999 16.0463 3 15.2413V8.7587C2.99999 7.95373 2.99998 7.28937 3.04419 6.74817C3.09012 6.18608 3.18868 5.66937 3.43597 5.18404C3.81947 4.43139 4.43139 3.81947 5.18404 3.43597C5.66937 3.18868 6.18608 3.09012 6.74817 3.04419C7.28937 2.99998 7.95373 2.99999 8.7587 3ZM6.91104 5.03755C6.47262 5.07337 6.24842 5.1383 6.09202 5.21799C5.7157 5.40973 5.40973 5.7157 5.21799 6.09202C5.1383 6.24842 5.07337 6.47262 5.03755 6.91104C5.00078 7.36113 5 7.94342 5 8.8V15.2C5 16.0566 5.00078 16.6389 5.03755 17.089C5.07337 17.5274 5.1383 17.7516 5.21799 17.908C5.40973 18.2843 5.7157 18.5903 6.09202 18.782C6.24842 18.8617 6.47262 18.9266 6.91104 18.9624C7.36113 18.9992 7.94342 19 8.8 19H15.2C16.0566 19 16.6389 18.9992 17.089 18.9624C17.5274 18.9266 17.7516 18.8617 17.908 18.782C18.2843 18.5903 18.5903 18.2843 18.782 17.908C18.8617 17.7516 18.9266 17.5274 18.9624 17.089C18.9992 16.6389 19 16.0566 19 15.2V8.8C19 7.94342 18.9992 7.36113 18.9624 6.91104C18.9266 6.47262 18.8617 6.24842 18.782 6.09202C18.5903 5.7157 18.2843 5.40973 17.908 5.21799C17.7516 5.1383 17.5274 5.07337 17.089 5.03755C16.6389 5.00078 16.0566 5 15.2 5H8.8C7.94342 5 7.36113 5.00078 6.91104 5.03755Z",fill:"currentColor"})),Ye=()=>Me((t,d)=>({title:void 0,highlightedMessageId:void 0,initiallyHighlightedMessageId:void 0,currentNodeId:void 0,shareLinkId:void 0,shareLinkUrl:void 0,isPublic:!1,isDeleted:!1,isAnonymous:!0,isDiscoverable:!1,canDisableDiscoverability:!1,linkAlreadyExisted:!1,linkAlreadyPublic:!1,linkError:void 0,moderationState:void 0})),V=r.createContext(),f=t=>je(r.useContext(V),t),$e=()=>f(t=>t.shareLinkId),We=()=>f(t=>t.shareLinkUrl),Ge=()=>f(t=>t.currentNodeId),Ke=()=>f(t=>t.linkAlreadyPublic),Je=()=>f(t=>t.isDiscoverable),Xe=()=>f(t=>t.canDisableDiscoverability);function Qe(t){return t.metadata?.aggregate_result?.messages?.some(Ve)===!0}function et(t){const d=t.content;return("parts"in d?d.parts.join(""):"").includes("sandbox:")}function tt(t){return Qe(t)||et(t)}const g=_e({moderationBlocked:{id:"sharingModal.moderationBlocked",defaultMessage:"This shared link has been disabled by moderation."},confirmDeleteLink:{id:"sharingModal.confirmDeleteLink",defaultMessage:"Are you sure you want to delete the share link?"},advancedDataAnalysisSupportDisclaimer:{id:"sharingModal.advancedDataAnalysisSupportDisclaimer",defaultMessage:"Recipients wonâ€™t be able to view Advanced Data Analysis images or download files."},copying:{id:"thread.sharingModal.copying",defaultMessage:"Copying..."},failedToCopyLink:{id:"thread.sharingModal.failedToCopyLink",defaultMessage:"Failed to copy link to clipboard"},failedToDeleteSharedLink:{id:"thread.sharingModal.failedToDeleteSharedLink",defaultMessage:"Failed to delete shared link"},plusProjectDescription:{id:"sharingModal.plusProjectDescription",defaultMessage:"Your name, uploaded files, custom instructions, and any messages you add after sharing stay private."},enterpriseProjectDescription:{id:"sharingModal.enterpriseProjectDescription",defaultMessage:"Any messages you add after sharing will be visible to members of your workspace. Project files and custom instructions wonâ€™t be accessible via the shared link."}});function ut({serverThreadId:t}){const d=Ee(t),c=$(t)!=null?S.getCurrentNode($(t)).message.id:d?.current_node,[x]=r.useState(()=>Ye()),_=!De()&&c,[b,L]=r.useState(!0),w=r.useRef(!1);return r.useEffect(()=>{_&&(w.current||(w.current=!0,Q.safePost("/share/create",{requestBody:{current_node_id:c,conversation_id:t,is_anonymous:!0}}).then(i=>{x.setState({shareLinkId:i.share_id,shareLinkUrl:i.share_url,isPublic:i.is_public,isDeleted:!i.is_visible,title:i.title,highlightedMessageId:i.highlighted_message_id??void 0,initiallyHighlightedMessageId:i.highlighted_message_id??void 0,currentNodeId:i.current_node_id,linkAlreadyExisted:i.already_exists,linkAlreadyPublic:i.is_public,isAnonymous:i.is_anonymous,isDiscoverable:i.is_discoverable,canDisableDiscoverability:i.can_disable_discoverability,moderationState:i.moderation_state??void 0})}).catch(i=>{const o=ee(i);o?x.setState({linkError:o}):z.closeSharingModal()}).finally(()=>{L(!1)})))},[_]),e.jsx(V.Provider,{value:x,children:e.jsx(it,{serverThreadId:t,isLoading:b})})}function q(t){return t.has_been_auto_blocked===!0||t.has_been_auto_moderated===!0||t.has_been_blocked===!0}const st="https://help.openai.com/en/articles/7925741-chatgpt-shared-links-faq",at="https://help.openai.com/en/articles/8474715-chatgpt-enterprise-shared-links-faq";function it({serverThreadId:t,isLoading:d}){const c=Se(),[x,D]=r.useState(!1),[_,b]=r.useState(!1),[L,w]=r.useState(!1),i=Le(),o=r.useContext(V),m=$e(),p=We(),te=Ge(),y=Ke(),N=Je(),se=Xe(),Z=f(s=>s.linkError),M=f(s=>s.moderationState),ae=M!=null&&q(M),j=Ae(Re.isBusinessWorkspace),[R,ie,ne,re,oe]=we(t,s=>[S.getCurrentNode(s),S.hasUserContextPrompt(s),S.hasModelEditableContext(s),S.findNode(s,n=>tt(n.message))!=null,S.getGizmoId(s)]),le=R?.message.id,T=Te(oe),[de,O]=r.useState(!1),{layer:ce}=Ne("1547743984"),ue=ce.get("show_copylink_state_if_no_updates",!1),Y=ie||ne;if(d)return e.jsx(W,{isOpen:!0,testId:"modal-sharing",onClose:Ie,size:"custom",className:"max-w-[550px]",type:"success",showCloseButton:!0,children:e.jsx("div",{className:"flex h-full items-center justify-center py-4",children:e.jsx(G,{className:"icon-md text-token-text-secondary"})})});const he=async(s,n,u)=>{const{highlightedMessageId:B,title:C,isDeleted:v,isAnonymous:F}=o.getState();try{X(n,i,u)}catch{i.danger(c.formatMessage(g.failedToCopyLink)),D(!1);return}if(L){try{X(n,i,u)}catch{i.danger(c.formatMessage(g.failedToCopyLink));return}b(!0),setTimeout(()=>{b(!1)},1500);return}D(!0);try{const{moderation_state:h,is_discoverable:P,can_disable_discoverability:ve}=await J.updateShareLink({share_id:s,highlighted_message_id:B,title:C??void 0,is_public:!v,is_visible:!v,is_anonymous:F,current_node_id:R?.message.id});if(q(h)){o.setState({moderationState:h});return}o.setState({isPublic:!0,moderationState:h,isDiscoverable:P??void 0,canDisableDiscoverability:ve}),b(!0),setTimeout(()=>{b(!1)},1500)}catch(h){const P=ee(h);P&&o.setState({linkError:P})}finally{D(!1)}w(!0)},ge=async()=>{O(!0);const{highlightedMessageId:s,title:n,isDeleted:u,isAnonymous:B}=o.getState();if(m)try{const{moderation_state:C,is_discoverable:v,can_disable_discoverability:F}=await J.updateShareLink({share_id:m,highlighted_message_id:s,title:n??void 0,is_public:!u,is_visible:!u,is_anonymous:B,is_discoverable:!N,current_node_id:R?.message.id});if(q(C)){o.setState({moderationState:C});return}o.setState({isDiscoverable:v??void 0,canDisableDiscoverability:F,moderationState:C});const h=v?"Share Public Chat: Discoverability Enabled":"Share Public Chat: Discoverability Disabled";E.logEvent(h,{shareLinkId:m}),A.logEvent("chatgpt_conversation_share_link_discoverability_toggled",v?"enabled":"disabled")}catch{i.danger("Failed to update this chat's discoverability")}finally{O(!1)}},me=async()=>{await Q.safeDelete("/share/{shared_conversation_id}",{parameters:{path:{shared_conversation_id:o.getState().shareLinkId}}}).catch(s=>{i.danger(c.formatMessage(g.failedToDeleteSharedLink))}).then(()=>{z.closeSharingModal()})},l=L||j&&y||y&&te===le&&ue;function fe(){z.closeSharingModal()}const xe=()=>{let s,n;return j?(s=e.jsx(a,{id:"IR+p6G",defaultMessage:"Share link to chat"}),n=T?c.formatMessage(g.enterpriseProjectDescription):e.jsx(a,{id:"ZKoPTp",defaultMessage:"Any messages you add after sharing will be visible to members of your workspace."}),l&&(s=e.jsx(a,{id:"AX5quN",defaultMessage:"Link created"}),n=e.jsx(a,{id:"OmpNr/",defaultMessage:"A link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})),{modalTitle:s,modalDescription:n}):(l?y?(s=e.jsx(a,{id:"DD6oDE",defaultMessage:"Public link updated"}),n=e.jsx(a,{id:"sJl/nl",defaultMessage:"The public link to your chat has been updated. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})):(s=e.jsx(a,{id:"7xzg3Y",defaultMessage:"Public link created"}),n=e.jsx(a,{id:"LZ5EAo",defaultMessage:"A public link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})):y?(s=e.jsx(a,{id:"FyIlHR",defaultMessage:"Update public link to chat"}),n=T?c.formatMessage(g.plusProjectDescription):Y?e.jsx(a,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(a,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})):(s=e.jsx(a,{id:"xgkjrq",defaultMessage:"Share public link to chat"}),n=T?c.formatMessage(g.plusProjectDescription):Y?e.jsx(a,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(a,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})),{modalTitle:s,modalDescription:n})},pe=()=>x?e.jsx(a,{...g.copying}):_?e.jsx(a,{id:"zMndTF",defaultMessage:"Copied"}):l?e.jsx(a,{id:"F+gzqW",defaultMessage:"Copy link"}):y?e.jsx(a,{id:"SviHx3",defaultMessage:"Update link"}):e.jsx(a,{id:"Ns/mpl",defaultMessage:"Create link"}),{modalTitle:be,modalDescription:ye}=xe(),U=pe(),ke=e.jsx(Pe.Button,{onClick:s=>he(m,p,s),color:"primary",disabled:x||_||m==null||p==null||Z!=null||ae,className:"ms-4 me-0 mt-0 rounded-full px-4 py-1 text-base font-bold sm:py-3",loading:x,icon:l?Ue:He,"data-testid":U.props.defaultMessage==="Create link"?"create-link-shared-chat-button":U.props.defaultMessage==="Copied"?"copied-shared-chat-button":void 0,children:U});let I=Z;I==null&&(M?.has_been_auto_blocked||M?.has_been_auto_moderated||M?.has_been_blocked)&&(I=e.jsx(a,{...g.moderationBlocked}));const Ce=l?p:window.location.origin+"/share/â€¦",H=o.getState().title??"My ChatGPT conversation",k=!N||se;return e.jsxs(W,{isOpen:!0,testId:"modal-sharing",onClose:()=>{fe()},size:"custom",className:"max-w-[550px]",type:"success",title:be,showCloseButton:!0,children:[I!=null&&e.jsx("div",{className:"mb-4 rounded-md bg-red-500 p-4 text-white",children:I}),e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"text-token-text-secondary mb-6",children:e.jsxs("span",{children:[ye," ",!l&&e.jsx("a",{href:j?at:st,className:"text-token-text-secondary hover:text-token-text-tertiary inline-flex items-center gap-2 underline",target:"_blank",rel:"noreferrer",children:e.jsx(a,{id:"TKNIin",defaultMessage:"Learn more"})})]})})}),!l&&e.jsx(nt,{shouldShowCodeInterpreterDisclaimer:re}),l&&!j&&e.jsx("div",{className:"mb-7",onClick:k?ge:void 0,role:"checkbox","aria-checked":N,"aria-disabled":!k,tabIndex:0,children:e.jsxs("label",{className:K("flex items-start",{"cursor-pointer":k}),children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:de?e.jsx(G,{className:"icon-md text-token-text-secondary"}):N?e.jsx(Ze,{className:k?"text-token-text-primary":"text-token-text-secondary"}):e.jsx(Oe,{})}),e.jsxs("div",{className:"ms-2 leading-tight",children:[e.jsx("div",{className:k?"text-token-text-primary":"text-token-text-secondary",children:e.jsx(a,{id:"Ll7cH+",defaultMessage:"Make this chat discoverable"})}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:k?e.jsx(a,{id:"0Qtyx3",defaultMessage:"Allows it to be shown in web searches"}):e.jsx(a,{id:"NZCrSB",defaultMessage:"<deleteLink>Delete the link</deleteLink> to turn off chat discoverability",values:{deleteLink:s=>e.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),window.confirm(c.formatMessage(g.confirmDeleteLink))&&me()},className:"underline",children:s})}})})]})]})}),e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-primary text-token-text-secondary has-focus-visible:border-token-border-xheavy mb-2 flex items-center justify-between rounded-full border p-1.5 last:mb-2 sm:p-2",children:[e.jsxs("div",{className:"relative ms-1 grow",children:[e.jsx("input",{type:"text",readOnly:!0,value:Ce,disabled:!l,className:K("bg-token-main-surface-primary w-full rounded-xl border-0 px-2 py-1 text-lg focus:ring-0 sm:py-2.5",l?"text-token-text-primary":"text-token-text-tertiary")}),e.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute end-0 top-0 bottom-0 w-12 bg-linear-to-l"})]}),ke]}),y&&!l&&e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"text-token-text-tertiary mb-3 text-sm",children:e.jsx(a,{id:"A9Jgr5",defaultMessage:"A past version of this chat has already been shared. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:s=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"hover:text-token-text-quaternary underline",children:s})}})})}),!j&&l&&p&&e.jsxs("div",{className:"mt-6 flex justify-center space-x-14",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.linkedin.com/shareArticle?url=${encodeURIComponent(p)}&text=${encodeURIComponent(H)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{E.logEvent("Share Public Chat: LinkedIn Social Clicked",{shareLinkId:m}),A.logEvent("chatgpt_conversation_share_link_social_clicked","linkedin")},children:e.jsx(Be,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"YtW6Uh",defaultMessage:"LinkedIn"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.reddit.com/submit?url=${encodeURIComponent(p)}&title=${encodeURIComponent(H)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{E.logEvent("Share Public Chat: Reddit Social Clicked",{shareLinkId:m}),A.logEvent("chatgpt_conversation_share_link_social_clicked","reddit")},children:e.jsx(Fe,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"VLrIK1",defaultMessage:"Reddit"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(p)}&text=${encodeURIComponent(H)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{E.logEvent("Share Public Chat: X Social Clicked",{shareLinkId:m}),A.logEvent("chatgpt_conversation_share_link_social_clicked","x")},children:e.jsx(qe,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"CgECe/",defaultMessage:"X"})})]})]})]})}const nt=({shouldShowCodeInterpreterDisclaimer:t})=>e.jsx(e.Fragment,{children:t&&e.jsx(rt,{icon:ze,children:e.jsx(a,{id:"iEl3pV",defaultMessage:"Images and files in this chat won't be shown in the public link."})})}),rt=({children:t,icon:d})=>e.jsxs("div",{className:"bg-token-main-surface-secondary text-token-text-secondary mb-4 flex items-center justify-between rounded-2xl p-4 last:mb-0",children:[t,d!=null&&e.jsx(d,{className:"icon-sm mt-1 shrink-0"})]});export{st as SHARED_LINKS_HELP_URL,ut as default};
//# sourceMappingURL=luzh85lulgzzmlqd.js.map

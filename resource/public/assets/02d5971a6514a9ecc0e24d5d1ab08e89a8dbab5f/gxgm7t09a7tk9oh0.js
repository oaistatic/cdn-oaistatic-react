import{r as z,f as _,j as n,g as q}from"./msupklk377u8vx8o.js";import{g as G,d_ as P,ar as $,d$ as B,c as x,bI as H,dq as k,by as V}from"./i3bl95k8z8nuf4dv.js";import{dO as W,fo as N,fp as D,fq as O,fr as J,fs as K,ft as Q,fl as X,fu as Y,fv as Z}from"./idf4u2jy0wx0pvap.js";function ee({asset:s,contextConnectorSourceUrl:g,isSingle:a,isUserTurn:m,className:l}){const i=G(),o=P(i).flags,[r,u]=z.useState(!1),{isUnauthenticated:e}=$(),t=o?.includes(B.NoAuthEnableFileUploads),w=W(s.asset_pointer),d=N.useState(E=>N.selectFile(E,w)),h=D(d?.file??null,d?.file.name,d?.fileId??void 0,d?.gizmoId,d?.contextConnectorInfo,!0),M=e&&d&&t,{gizmoEditorData:F}=O(),p=J(),C=K(m),v=_(),{data:U,isLoading:R,error:b}=Q({asset:s,gizmoId:F?.id,getServerUrl:!M}),{url:j,width:f,height:I}=h&&t?{width:s.width,height:s.height,url:h}:U??{},y=R||!r,A=f&&I?{Landscape:f>I,Portrait:f<I}:void 0,c=["overflow-hidden rounded-lg"];if(a&&(c.push("w-full h-full"),A?.Landscape?c.push("max-w-96 max-h-64"):A?.Portrait?c.push("max-h-96 max-w-64"):c.push("max-w-64 max-h-64")),l&&c.unshift(l),C)return null;let L;return j!=null&&(L=n.jsx(X,{alt:v.formatMessage(S.imageAltText),className:x("max-w-full",!a&&"aspect-square","object-cover object-center",c),src:j,width:f,height:I,onLoad:()=>u(!0)}),p||(L=n.jsx(Y,{src:j,alt:v.formatMessage(S.imageAltText),contextConnectorSourceUrl:g,className:x(c),children:L}))),n.jsx("div",{className:x(c),children:n.jsx("div",{className:x("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!a&&"aspect-square"),children:j!=null?L:n.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${f} / ${I}`,width:f},title:y?v.formatMessage(S.loadingImage):v.formatMessage(S.errorLoadingImage),children:y?n.jsx(H,{}):b?n.jsx(k,{className:"icon-sm"}):null})})})}const S=q({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function T({assets:s,attachments:g,isUserTurn:a=!0,clientThreadId:m}){const l=s.length===1,{containerClassname:i,imageClassnames:o}=T.computeClassnames(s.length);return n.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[n.jsx("div",{className:x("flex flex-row items-center justify-end gap-1",i),children:s.map((r,u)=>{const e=g?.find(t=>t.id&&r.asset_pointer.includes(t.id));return n.jsx(ee,{asset:r,isSingle:l,isUserTurn:a,contextConnectorSourceUrl:e?.context_connector_info?.source_url,className:o[u]},u)})}),n.jsx(Z,{featureType:V.ATTACHMENT,isUserTurn:a,clientThreadId:m})]})}T.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let g=s>=4?"flex-wrap":"";const a=Array(s),m=e=>{a.fill(e)},l=e=>{g+=` ${e}`},i=(e,t)=>{a[e]=x(a[e],t)},o=s<=4&&s%2===0?2:3,r=Math.ceil(s/o),u=s%o!==0;o===2?(m("h-32 w-32"),l("max-w-72")):r<=2?(m("h-24 w-24 sm:h-32 sm:w-32"),l("max-w-80 sm:max-w-100")):(m("h-16 w-16"),l("max-w-52"));for(let e=0;e<s;e++){const t=Math.floor(e/o),w=e%o,d=Math.min(s-t*o,o),h=t===0,M=t===r-1,F=t===r-2,p=w===0,C=w===d-1;h&&p&&i(e,"rounded-ss-2xl"),h&&C&&i(e,"rounded-se-2xl"),M&&p&&i(e,"rounded-es-2xl"),M&&C&&i(e,"rounded-ee-sm"),u&&p&&F&&i(e,"rounded-es-2xl")}return{containerClassname:g,imageClassnames:a}};export{T as TextMessageImageGroup};
//# sourceMappingURL=gxgm7t09a7tk9oh0.js.map

import{r as f,j as p,f as T}from"./msupklk377u8vx8o.js";import{be as d,bG as g,bH as l,bj as M,bY as C}from"./i3bl95k8z8nuf4dv.js";import{CoTChunks as x}from"./itgdzgk5z1u7l0jj.js";import{C as u}from"./ohwrmnkvkdb4hdjp.js";import"./onklb7txlsriyspd.js";import"./idf4u2jy0wx0pvap.js";import"./exki82npk7hw7g59.js";import"./hgzals0lml4o26vg.js";import"./hwl3hzno2kq7obfl.js";import"./hmii3551qscelikg.js";import"./i3xeaua08fnq6vw7.js";import"./b2dyy1jg95n5gtr8.js";import"./gc51ish3otzvnj1w.js";import"./ojiial81qrlp15mq.js";import"./ojrw0o0rizu55rz7.js";import"./ev39bkx1q3tpviat.js";import"./mxye9dnv7ug9w78j.js";import"./mmjudc45gj99bpja.js";import"./hykg4shppjdez6do.js";import"./bl75917ayi16sr8y.js";import"./gvsp7fy7hloerc2p.js";import"./b8sq4gagi5vun041.js";import"./k0gfwt82z96kzlbw.js";import"./etqfvs5ggajp1a11.js";import"./nr2o0yx4ps6bt6je.js";import"./iot0cxie20e0du89.js";import"./nxqfgrk9atl9s5yp.js";const _=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),o=t%60;return`${n}m ${o}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},k=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},y=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:_(e,n)}):d(t)?.metadata?.finished_text??"",E=(e,t,n=!1)=>{const o=[];let s={type:u.Thought,thought:{summary:"",content:""}};const i=()=>{s.thought.content.trim()&&(o.push(s),s={type:u.Thought,thought:{summary:s.thought.summary,content:""}})},a=e.split(/( {2}\n)|(\n\n)/).filter(m=>m!=null&&m.trim());if(!n&&a.length<2)return o;let c=!1;for(let m=0;m<a.length;m++){const r=a[m].trim();if(r.toLowerCase()==="none"){g.count(l.COT_SUMMARIZER,"num_none_chunks");continue}const h=r.match(/^\*\*(.*)\*\*$/);if(h)i(),s.thought.summary=h[1]??"";else if(r){if(r.startsWith("```")){if(c){s.thought.content+=s.thought.content?`
${r}`:r,i(),c=!1;continue}i(),c=!0}s.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!c&&i(),s.thought.content+=s.thought.content?`
${r}`:r}}return s?.thought.content.trim()&&o.push(s),n&&t&&o.push({type:u.Recap,content:t}),o},R=(e,t,n)=>{const o=!n,s=f.useMemo(()=>E(e,t,o),[e,t,o]);return f.useEffect(()=>{o&&g.hist(l.COT_SUMMARIZER,"num_cot_chunks",void 0,s.length)},[o]),s},I=({isStreaming:e,finishedText:t,summaryText:n})=>{const o=R(n,t,e);return p.jsx(x,{isStreaming:e,chunks:o})},j=8,N=`

`,ot=({messages:e,isStreaming:t})=>{const n=T(),{value:o}=M("1214379119"),s=k(e);let i="";return e.forEach(a=>{const c=C(a);i+=i?N+c:c}),o&&!t&&!i&&s<j?null:p.jsx(I,{finishedText:y(n,e,s),summaryText:i,isStreaming:t})};export{I as LegacyCoT,ot as LegacyCoTMessage};
//# sourceMappingURL=hjl8i43v977zmrf7.js.map

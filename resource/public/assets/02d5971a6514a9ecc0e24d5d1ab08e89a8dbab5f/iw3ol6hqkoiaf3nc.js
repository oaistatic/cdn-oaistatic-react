import{f,r as d,n as N,j as e,M as l}from"./msupklk377u8vx8o.js";import{I as w,f as S,h as k,L as M}from"./idf4u2jy0wx0pvap.js";import{I as P}from"./hykg4shppjdez6do.js";import{W as R}from"./mxye9dnv7ug9w78j.js";import{c as u}from"./i3bl95k8z8nuf4dv.js";function C({repository:a,isSelected:r,className:s}){const o=f(),i=a.visibility==="private"?o.formatMessage({id:"wham.repositorySection.private",defaultMessage:"Private"}):o.formatMessage({id:"wham.repositorySection.public",defaultMessage:"Public"});return e.jsxs("div",{className:u("flex items-center justify-between gap-2",s),children:[e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-token-text-primary text-start text-sm font-medium",children:a.name}),e.jsx("div",{className:"text-token-text-secondary text-start text-sm leading-tight font-normal",children:[a.language,i].filter(Boolean).map((m,n)=>e.jsx("span",{className:"after:mx-1 after:content-['\\u00b7'] last:after:content-[none]",children:m},n))})]})}),r&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(k,{className:"icon-sm"})})]})}function E({repository:a,isSelected:r,onClick:s}){return e.jsx("button",{className:u("group flex w-full items-center justify-between gap-2 rounded-md","hover:bg-token-bg-secondary cursor-pointer p-3"),onClick:s,type:"button",children:e.jsx(C,{repository:a,isSelected:r,className:"w-full"})})}function c(){return e.jsx("div",{className:"flex w-full items-center justify-between gap-2 rounded-md",children:e.jsx(M,{className:"h-14 w-full"})})}const x=10;function B({selectedRepository:a,onSelect:r,installationId:s}){const o=f(),[i,m]=d.useState(""),{data:n,isLoading:p,fetchNextPage:h,hasNextPage:g,isFetchingNextPage:j,error:y}=N({queryKey:["repositories",s],enabled:!!s,initialPageParam:1,queryFn:({pageParam:t})=>R.getRepositoriesByInstallationId(s??0,t,x),getNextPageParam:(t,b)=>{if(!((t?.repositories??[]).length<x))return b.length+1}}),v=d.useMemo(()=>n?.pages.flatMap(t=>t.repositories??[])??[],[n]).filter(t=>t.name.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(l,{id:"wham.createEnvironments.repository",defaultMessage:"Repository"})}),e.jsx("div",{className:"flex justify-between",children:e.jsx(w,{color:"search",iconPosition:"left",icon:S,className:"text-token-text-tertiary flex h-8 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:i,onChange:t=>m(t.target.value),placeholder:o.formatMessage({id:"wham.repositorySection.searchPlaceholder",defaultMessage:"Search"}),ariaLabel:o.formatMessage({id:"wham.repositorySection.searchAria",defaultMessage:"Search"})})}),e.jsxs("div",{className:"border-token-border-heavy bg-token-bg-primary flex flex-col gap-2 rounded-lg border p-3",children:[e.jsx("div",{className:"flex h-56 flex-col overflow-y-auto",children:!s||p?e.jsxs("div",{className:"flex h-full flex-col gap-2",children:[e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{})]}):y?e.jsx("div",{className:"text-token-text-primary flex h-full items-center justify-center text-sm",children:e.jsx(l,{id:"wham.createEnvironments.repositorySection.error",defaultMessage:"Failed to load repositories. Please ensure you have connected your GitHub account."})}):e.jsxs(e.Fragment,{children:[v.map(t=>e.jsxs("div",{children:[e.jsx(E,{repository:t,isSelected:a===t.id,onClick:()=>r(t.id,t.repository_full_name,t.name)}),e.jsx("div",{className:"border-token-border-light border-t"})]},t.id)),e.jsx(P,{isFetchingNextPage:j,hasNextPage:g??!1,fetchNextPage:h,bgColor:"dark:bg-token-bg-secondary"})]})}),s&&e.jsx("p",{className:"text-token-text-secondary px-3 pt-3 text-start text-xs leading-none",children:s?e.jsx(l,{id:"wham.createEnvironments.repositorySection.noRepositories",defaultMessage:"Missing a repo? <link>Configure repository access</link>.",values:{link:t=>e.jsx("a",{href:`https://github.com/apps/chatgpt-connector/installations/${s}`,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}):e.jsx(l,{id:"wham.createEnvironments.repositorySection.selectAccount",defaultMessage:"Select an account to connect to"})})]})]})}export{B as R,C as a};
//# sourceMappingURL=iw3ol6hqkoiaf3nc.js.map

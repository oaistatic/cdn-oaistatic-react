const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/n13nvk04odhrhh2o.js","assets/n1tvutderx19k1zs.js","assets/ks5ol9qk63xet9qo.js","assets/n26mv7rx7nquqst2.js","assets/root-osq5e7fb.css","assets/fc1eebwzn89ijxnz.js","assets/pceg3mlzf8dzw9ob.js","assets/conversation-small-nranh1cg.css","assets/hexva2s1lo90zidg.js","assets/nraolmtygmvq3wcf.js","assets/hg2pcqdl92ment5e.js","assets/kodyf94rms2l778g.js","assets/ecp3vwsjvu9v61q0.js","assets/l59jhu2ho2y7wq08.js","assets/etz0vru3wekxgbsx.js","assets/cws9w0h2sqbkm9c3.js","assets/gp6b3ci8c7knuiru.js","assets/nm1vjlqul5lsrmth.js","assets/bei4zk14rknuqpj2.js","assets/mhlu8822bwdiwyx5.js","assets/k8endz57efgul1h9.js","assets/g3thgzalsd22yws1.js","assets/jn3882p1fc3q2h7l.js","assets/liyw83hamg3z3z3c.js","assets/lc7h8twjzp5pbqrh.js","assets/eq1uzpsa50yc9zw1.js","assets/drca3a4828l8onhl.js","assets/jfxozbrcnsxchwcx.js","assets/bh4mls0z1fu8erky.js","assets/l499zjc9lgyu7lf2.js","assets/ehy41eo5ftegu0ec.js","assets/n43edvoxt2r1qpaw.js","assets/falq4gxco1cs0pxp.js"])))=>i.map(i=>d[i]);
import{bI as V,t as ge,gS as fe,aj as xe,d as w,n as pe,U as K,ap as he,bY as H,a1 as _e,a2 as ye,a3 as je,a4 as Ee,s as te,r as be,ai as z,P as ae,c3 as ve,bo as ne,gT as W,ex as Se,ey as Ne,bU as Te,ec as Ce,eu as Ae,eb as ke,av as re,D as we,a as Y,c7 as Ie,gU as De,bs as S,bt as N,bg as Me,eQ as Re}from"./n26mv7rx7nquqst2.js";import{r as p,c as Q,j as s,M as v,aw as B,au as D,a as Oe}from"./n1tvutderx19k1zs.js";import{jt as oe,hW as ie,ju as Pe,jv as U,jw as Le,ds as Fe,dt as Ue,jx as Be,jy as Ve,c4 as ze,jz as He,jA as Je,cr as We,jB as $,jC as Ke,jD as Qe,jE as Ye,cp as $e,jF as X,jG as ce,ht as Xe,jH as qe,jI as Ze,jJ as Ge,jK as es,aG as ss,aF as ts,ag as as,F as ns,e5 as rs,jL as os,jM as is,jN as cs,jO as ls,cD as i,iO as ds,jP as ms,jQ as us,jR as gs,jS as fs,dU as xs,gy as ps,jT as hs,fB as _s}from"./pceg3mlzf8dzw9ob.js";import{b as ys,a as js}from"./hexva2s1lo90zidg.js";import{u as Es}from"./nraolmtygmvq3wcf.js";import{N as bs}from"./hg2pcqdl92ment5e.js";import{h as vs}from"./kodyf94rms2l778g.js";function Ss(e,a,t){const n=oe(r=>!!(e&&r.tasks[e])),{openThreadSidebar:o}=V(),{clearAllSystemHintModeTriggers:c}=ys(),m=ie("caterpillar"),l=Pe(t,e);p.useEffect(()=>{if(n||!e||!a)return;const{async_task_created_at:r,async_task_prompt:f,async_task_title:g}=a.metadata??{};if(!r||!f||!g)return;const x={originalConversationId:ge(t)??t,taskId:e,title:g,prompt:f,createdAt:r,updatedAt:r,status:U.UNDETERMINED};Le.setTask(e,x),c()},[n,e,a,t,o,m,l,c])}const Ns={div:e=>{const{node:a,children:t,...n}=e;return s.jsx("div",{...n,className:"text-red-500",children:t})},p:e=>{const{node:a,children:t,...n}=e;return s.jsx("p",{...n,className:"text-pretty text-start text-sm leading-6 text-token-text-primary",children:t})},a:e=>{const{node:a,children:t,...n}=e;return s.jsx("a",{...n,className:"text-pretty !font-medium leading-6 !text-token-text-primary",children:t})}},Ts=1e3*60*2,Cs=15;function le({onClick:e,statusMessage:a,showSources:t,includeMargin:n,sources:o,progressBar:c}){return s.jsx("button",{onClick:e,className:"flex w-4/5 max-w-[416px] cursor-pointer items-start justify-start gap-[18px] rounded-2xl border border-black/10 bg-token-main-surface-primary px-5 py-4 shadow hover:bg-token-main-surface-secondary dark:border-white/10",children:s.jsxs("div",{className:"flex w-full flex-col gap-3",children:[s.jsxs("div",{className:"flex h-12 flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between",children:[s.jsx("div",{className:w("w-full flex-1 truncate text-start text-base font-medium leading-7 text-token-text-primary md:w-0",n&&"mr-[30px]"),children:a}),t&&o]}),s.jsx("div",{className:"flex w-full items-center justify-start gap-4 self-stretch pb-2",children:c})]})})}function As({toggleSidebar:e,openSidebar:a,startTime:t}){const n=Q(),[o,c]=p.useState(!1),m=Be();return p.useEffect(()=>{if(!t)return;const l=Date.now()-t,r=Ts-l;if(r>0){const f=setTimeout(()=>{c(!0),a()},r);return()=>clearTimeout(f)}else c(!0),a()},[t,a]),s.jsx(le,{onClick:e,statusMessage:o?n.formatMessage({id:"T2SbxC",defaultMessage:"Waiting…"}):s.jsx("div",{className:"text-pretty text-sm text-token-text-primary",children:m.startingMessage}),progressBar:s.jsx(Ve,{className:"h-2 w-full"}),showSources:!1})}function ks(e,a,t){const n=e.formatMessage({id:"Bs+OcV",defaultMessage:"Thinking…"});if(a.length<2)return t?.initial??n;const o=a[a.length-2];if(o.type==="summary")return o.title;if(o.type==="search")return o.query;if(o?.type==="websiteOpen")return s.jsx(ze,{componentOverrides:Ns,children:o.active_row_text})}function ws({task:e,clientThreadId:a,caterpillarRows:t,messageWithTaskMetadata:n,totalSources:o,handleToggleCaterpillarSidebar:c}){const m=Q(),l=ks(m,t,n.metadata?.async_task_status_messages),r=(e?.expectedDurationMinutes??Cs)*60*1e3,f=Fe(t[0]?.created_at?t[0].created_at*1e3:Date.now(),r),g=t[0]&&t[0].created_at?f:0;p.useEffect(()=>{fe(a,xe.STREAMING)},[a]);const{openThreadSidebar:u}=V(),x=p.useCallback(()=>{u({type:"caterpillar",caterpillarId:e.taskId,initialTab:"activity",clientThreadId:a})},[u,e.taskId,a]);return t.length===0?s.jsx(As,{toggleSidebar:()=>c("activity"),openSidebar:x,startTime:new Date(e.createdAt).getTime()}):s.jsx(le,{onClick:()=>c("activity"),statusMessage:l,showSources:!0,includeMargin:o>0,sources:o===0?s.jsx("div",{className:"text-pretty text-sm text-token-text-tertiary",children:s.jsx(v,{id:"zfwUjs",defaultMessage:"Looking for sources…"})}):s.jsxs("button",{onClick:h=>{h.stopPropagation(),c("sources")},className:"flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff] hover:text-[#0285ff]/80",children:[s.jsx("div",{className:"relative",children:s.jsx(B,{initial:!1,children:s.jsx(D.span,{initial:{opacity:0,rotateX:-90,translateY:20},animate:{opacity:1,rotateX:0,translateY:0},exit:{opacity:0,rotateX:90,translateY:-20},transition:{duration:.35},className:"absolute left-0 md:right-0",children:o},o)})}),s.jsx("div",{className:w("md:pr-0",o>0&&"pl-2",o>9&&"pl-[14px]",o>99&&"pl-[22px]"),children:o>1?s.jsx(v,{id:"zN+MuO",defaultMessage:" sources"}):s.jsx(v,{id:"dMowmJ",defaultMessage:" source"})})]}),progressBar:s.jsx("div",{className:"flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px] bg-token-main-surface-tertiary",children:s.jsx(Ue,{percentage:g,barClassName:"bg-token-text-primary",backgroundClassName:"bg-token-main-surface-tertiary"})})})}function J({message:e,handleToggleCaterpillarSidebar:a}){return s.jsx("div",{className:"border-token-border-primary mb-4 flex w-full flex-col gap-6 border-b-2 pb-6 pt-3",children:s.jsx("button",{onClick:a,className:"flex w-full text-start text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:e})})}function Is({messages:e,clientThreadId:a}){const t=e.find(o=>o.message.metadata?.b1de6e2_s&&o.message.metadata?.async_task_id)?.message,n=t?.metadata?.async_task_id;return!t||!n?null:s.jsx(Ds,{clientThreadId:a,payloadTaskId:n,messageWithTaskMetadata:t})}function Ds({payloadTaskId:e,messageWithTaskMetadata:a,clientThreadId:t}){Ss(e,a,t);const n=oe(u=>e?u.tasks[e]:null),o=Q(),c=n?.status,m=p.useMemo(()=>n?.rows?n.rows:[],[n?.rows]),{toggleThreadSidebar:l}=V(),{totalSources:r}=p.useMemo(()=>{if(!m)return{uniqueSources:[],totalSources:0};const u=He(m),x=u.reduce((h,y)=>h+y.count,0);return{uniqueSources:u,totalSources:x}},[m]),f=ie("caterpillar"),g=p.useCallback(u=>{e&&l({type:"caterpillar",caterpillarId:e,initialTab:u,clientThreadId:t},f)},[l,e,f,t]);return Je(e),!n||!c||n.status===U.UNDETERMINED?null:n.status===U.COMPLETED?s.jsx(J,{message:s.jsxs(s.Fragment,{children:[a.metadata?.async_task_status_messages?.completed_with_time??a.metadata?.async_task_status_messages?.completed_no_time??s.jsx(v,{id:"4d0xZc",defaultMessage:"Completed"}),r===0?s.jsx(v,{id:"VggF2B",defaultMessage:" · 0 sources"}):r===1?s.jsx(v,{id:"zkkdKV",defaultMessage:" · 1 source"}):s.jsx(v,{id:"qcKt3q",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:r}})]}),handleToggleCaterpillarSidebar:()=>g("activity")}):n.status===U.FAILED?s.jsx(J,{message:a.metadata?.async_task_status_messages?.error??o.formatMessage({id:"at6zk8",defaultMessage:"Failed to think"}),handleToggleCaterpillarSidebar:()=>g("activity")}):n.status===U.CANCELLED?s.jsx(J,{message:a.metadata?.async_task_status_messages?.cancelled??o.formatMessage({id:"u1rIr5",defaultMessage:"Task Cancelled"}),handleToggleCaterpillarSidebar:()=>g("activity")}):s.jsx(ws,{task:n,clientThreadId:t,caterpillarRows:m,messageWithTaskMetadata:a,totalSources:r,handleToggleCaterpillarSidebar:g})}function Ms(e,a,t){const n=a.elements.length;if(n===0)return;const o=Object.entries(e).reduce((c,[m,l])=>Array.isArray(l)?l.length>0?c+1:c:l!==""?c+1:c,0);ae.logEventWithStatsig("dynamic-form-submission","chatgpt_dyanmic_form_submission",{...ve({clientThreadId:t}),totalItems:n.toString(),completedItems:o.toString(),ratio:(o/n).toString()})}function Rs(e,a){let t="";return a.elements.forEach(n=>{const o=n.scope.split("/").pop(),c=o&&e[o],m=c?Array.isArray(c)?c.join(", "):c:"Any",l=n.label??o;t+=`${l}: ${m}
`}),t}function Os({messages:e,clientThreadId:a,isLastMessage:t}){const n=e.find(E=>E.message.author.role===pe.Assistant),o=e.find(E=>E.message.metadata?.json_form),c=o?.message.metadata?.json_form,[m,l]=p.useState({}),[r,f]=p.useState(),[g,u]=p.useState(),x=K(a,E=>E?.modelId??We),h=js(),y=Es({clientThreadId:a});p.useEffect(()=>{c&&(f(c.json_form_ui),u(c.json_form_data))},[c]);const j=p.useCallback(()=>{if(l({}),r){const E={...r,elements:r.elements.filter(L=>L.scope!=="#/properties/AdditionalInfo")};f(E)}g&&(delete g.properties.AdditionalInfo,u(g))},[l,f,u,r,g]),T=p.useCallback(()=>{if(r){const E={...r,elements:[...r.elements,{type:"Control",scope:"#/properties/AdditionalInfo",label:"Additional Info",placeholder:"Any other details..."}]};f(E)}if(g){const E={...g.properties,AdditionalInfo:{type:"string"}};u({...g,properties:E})}},[f,u,r,g]),I=r?.elements.some(E=>E.scope.endsWith("#/properties/AdditionalInfo")),A=he.getThreadCurrentLeafId(a),C=o?.nodeId!==A;if(!o||!g||!r)return n?.message.status==="in_progress"&&t?s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx($,{className:"h-[26px] w-full"}),s.jsx($,{className:"h-[26px] w-3/4"}),s.jsx(Ke,{})]}):null;if(C)return null;const P=async()=>{const E=Rs(m,r);Ms(m,r,a),_e(a,L=>{ye.appendMessage(L,je(E))}),y({model:x,completionType:Ee.Next,parentNodeId:te.getCurrentLeafId(be(a)),metadata:{},completionMetadata:{systemHints:[...h],conversationMode:{kind:z.PrimaryAssistant}},turnTracker:new $e})};return s.jsxs(Qe,{children:[s.jsx(Ps,{formData:m,dataSchema:g,uiSchema:r,setData:l,readOnly:C}),s.jsxs("div",{className:"flex w-full justify-between",children:[I?s.jsx("div",{}):s.jsx(H,{disabled:C,onClick:T,color:"secondary",className:"text-token-text-secondary",children:s.jsx(v,{id:"Sen69P",defaultMessage:"Add a detail"})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(H,{disabled:C,onClick:j,color:"secondary",className:"text-token-text-secondary",children:s.jsx(v,{id:"Uqo7UD",defaultMessage:"Reset"})}),s.jsx(H,{disabled:C,onClick:P,children:s.jsx(v,{id:"FVou++",defaultMessage:"Start"})})]})]})]})}function Ps({dataSchema:e,uiSchema:a,setData:t,readOnly:n,formData:o}){return s.jsx("div",{children:s.jsx(Ye,{formData:o,readOnly:n,schema:e,uiSchema:a,onChange:c=>t(c)})})}const Ls=2e3,de=.4,Fs=.45,Us=.2,Bs=.1,Vs=.25;var R=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(R||{});function jt({conversationMessages:e,icon:a,status:t,text:n,estimatedToolDurationMs:o,animationLoopDurationMs:c=Ls,shouldPersistAfterFinished:m=!1}){const[l,r]=p.useState(t===0?0:t===1&&!m?7:1),[f,g]=p.useState(0);p.useEffect(()=>{t===2?r(8):t===3?r(9):t===4?r(10):t===1?r(l===2?3:7):t===0&&l===10&&(r(2),g(x=>x+1))},[t]);const u=Js(l);return p.useEffect(()=>{const x=e[0].message.id;if(u)return X.addDelayedRenderingMessage(x),()=>{X.removeDelayedRenderingMessage(x)}},[u]),ce(()=>{O(l)&&g(x=>x+1)},c),l===7&&!m?null:s.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[s.jsx(zs,{icon:a,status:t,uiState:l,estimatedToolDurationMs:o,animationLoopCounter:f,shouldPersistAfterFinished:m,onFillProgressBarAnimationComplete:()=>r(4),onFinishAnimationComplete:()=>{r(5),setTimeout(()=>{r(m?7:6)},Bs*1e3)},onHideAnimationComplete:()=>r(7)}),s.jsx(Hs,{text:n,uiState:l,animationLoopCounter:f,onEnterAnimationComplete:()=>r(2)})]})}const q=50;function zs({icon:e,status:a,uiState:t,estimatedToolDurationMs:n,animationLoopCounter:o,shouldPersistAfterFinished:c,onFillProgressBarAnimationComplete:m,onFinishAnimationComplete:l,onHideAnimationComplete:r}){const[f,g]=p.useState(0);ce(()=>{O(t)?g(A=>A+q):t===10&&g(0)},q);let u,x,h;O(t)||t===10?(u="running",x=s.jsx(e,{animationLoopCounter:o}),h="bg-transparent"):t===4||t===5||t===7&&c?(u="finished",x=s.jsx(qe,{}),h="bg-brand-purple"):a===2?(u="error",x=s.jsx(Ze,{}),h="bg-orange-500"):a===3&&(u="stopped",x=s.jsx(Ge,{}),h="bg-gray-300");let y={opacity:0,scale:0,rotate:-180,x:0},j={type:"spring",bounce:.3,duration:Fs},T={opacity:0,scale:.6,rotate:0,x:0};t===0?(y={opacity:0,scale:.5,rotate:-180,x:-8},j={type:"spring",bounce:.3,duration:de}):t===1?y=!1:t===5&&(T={opacity:0,scale:0,rotate:0,x:0},j={type:"spring",bounce:.3,duration:Vs});const I=es(f,n);return s.jsx("div",{className:"relative h-5 w-5 shrink-0",children:s.jsx(B,{onExitComplete:()=>{t===6&&r()},children:u!=null&&s.jsxs(D.div,{className:w("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",h),initial:y,animate:{opacity:1,scale:1,rotate:0,x:0},exit:T,transition:j,onAnimationComplete:()=>{t===4&&l()},children:[x,(O(t)||t===10)&&s.jsx(Xe,{percentage:t===3?100:I,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:t===3?`${(100-I)/100*Us}s`:void 0,transitionTimingFunction:t===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{t===3&&m()}})]},u)})})}function Hs({text:e,uiState:a,animationLoopCounter:t,onEnterAnimationComplete:n}){const[o,c]=p.useState(e);p.useEffect(()=>{a===2&&c(e)},[t]),p.useEffect(()=>{O(a)||c(e)},[a,e]);let m={opacity:0,x:0,y:15},l={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};a===0?(m={opacity:0,x:-8,y:0},l={type:"spring",bounce:.3,duration:de,delay:.15}):a===1&&(m=!1);const r=o??void 0;return s.jsx("div",{className:w("relative h-5 w-full leading-5",a===8||a===9?"text-token-text-tertiary":"text-token-text-secondary"),children:s.jsx(B,{children:r!=null&&s.jsx(D.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:m,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:l,onAnimationComplete:()=>{a===0&&n()},children:r},r.toString())})})}function O(e){return e===0||e===2||e===3}function Js(e){return O(e)||e===4||e===5||e===6||e===10}const Z=ne.div`group left-0 top-0 mr-1.5 overflow-hidden mt-1 text-start`,Ws=({highlightedCommand:e,status:a,children:t,showWorkUserSetting:n=!1,hideOnlyIfNotInteractedWith:o=!1,defaultExpanded:c=!1,onOpenAnalytics:m,onClick:l,...r},f)=>{const g=t!=null||l!=null,[u]=p.useState(n),[x,h]=p.useState(n||c),[y,j]=p.useState(!1),T=a===R.Finished||a===R.Error,I=o?u?!1:!y:!1,A=a===R.Running&&"loading-shimmer";return T&&I?null:g?s.jsxs(s.Fragment,{children:[s.jsx(G,{ref:f,$canShowWork:!0,...r,children:s.jsx(B,{children:s.jsx(Z,{children:s.jsx(D.button,{onClick:C=>{x||m?.(),h(P=>!P),j(!0),l?.(C)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:w(A),children:s.jsxs("div",{className:"flex items-center justify-start gap-1",children:[s.jsx("span",{className:"text-start",children:e}),!l&&(x?s.jsx(ss,{className:"icon-md"}):s.jsx(ts,{className:"icon-md"}))]})},e?.toString())})})}),s.jsx(B,{children:x&&t&&s.jsx(D.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t})})]}):s.jsx(G,{ref:f,$canShowWork:!1,...r,children:s.jsx(Z,{className:w(A),children:e})})},G=ne.span`block first:mt-0 relative
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,Ks=p.forwardRef(Ws),Qs=3,Ys=.1,ee=[0,.26,.4];function $s({nextMessage:e,isLastMessage:a,isRequestActive:t,isLastTurnInConversation:n,clientThreadId:o,turnIndex:c}){let m=a||!e||e&&!W(e.message);const l=p.useRef(!1),r=Oe(),f=K(o,te.getGizmoId);p.useEffect(()=>{e&&W(e.message)&&!l.current&&(l.current=!0,as(r,f))},[e,r,f]);const g=Se(e?.message),u=Ne(e?.message);e?.message.id&&vs(e?.message.id);const x=[];if(u?.[0]?.type==="navigation"&&e&&x.push(s.jsx(Xs,{clientThreadId:o,turnIndex:c,nextMessage:e,isRequestActive:t,isLastTurnInConversation:n,navigationCitation:u[0]},"fast-nav")),m){const h=Te(g.slice(0,Qs).map(j=>j.entries[0].url)),y=t?s.jsxs("div",{className:"flex items-center gap-1",children:[h.map((j,T)=>s.jsx(D.div,{className:w("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:T===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:Ys,delay:ee[Math.min(T,ee.length-1)]},children:s.jsx("div",{className:w("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:s.jsx(ns,{url:j,size:32,minSize:16,className:"icon-md rounded-full"})})},j)),s.jsx(v,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):s.jsx(v,{id:"fssXGM",defaultMessage:"Error while searching"});x.push(s.jsx(Ks,{highlightedCommand:y,status:t?R.Running:R.Error},"search-gpt-query"))}return x.length?s.jsx(s.Fragment,{children:x}):null}const Xs=({clientThreadId:e,turnIndex:a,nextMessage:t,isRequestActive:n,isLastTurnInConversation:o,navigationCitation:c})=>{const{scrollToHeader:m}=Ce("searchSources")??{},l=Ae(),r=ke()&&l?.type==="searchSources",{openThreadSidebar:f}=V(),{value:g}=re("756982148");return p.useEffect(()=>{we.addFirstTiming("render.fastNavigation")},[]),p.useEffect(()=>{r&&f({type:"searchSources",scrollToHeader:m,clientThreadId:e,turnIndex:a,messageId:t?.message.id??""})},[]),p.useEffect(()=>{const u=t.message,x=u.metadata?.search_source,h=c.domains.map(y=>y.url);rs.logEvent(Y.searchToolRequestTimeToFastNav,e,u.id,{search_source:x,urls:h},()=>{x===Ie.InstantQuery&&os.logEvent(Y.searchToolPageLoadTimeToFastNav,{message_id:u.id,urls:h,search_source:x})})},[e,t,c]),n&&o&&g?s.jsx(D.div,{initial:{opacity:n?0:1,height:n?0:"auto"},animate:{opacity:1,height:"auto"},children:s.jsx(se,{clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:c})}):s.jsx(se,{clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:c})},se=({clientThreadId:e,turnIndex:a,nextMessage:t,navigationCitation:n})=>{const{toggleThreadSidebar:o}=V(),{value:c}=re("756982148"),m=p.useMemo(()=>({clientThreadId:e,turnIndex:a,messageId:t?.message.id}),[e,a,t?.message.id]),l=p.useCallback((g,u)=>{o({type:"searchSources",scrollToHeader:u,clientThreadId:e,turnIndex:a,messageId:t?.message.id??""})},[o,e,a,t?.message.id]),r=p.useRef(new Set),f=p.useCallback((g,u,x,h)=>{if(m&&m.messageId&&De(m.messageId)){const y=is(x,m,h),j=`${g}-${JSON.stringify(y)}`;(!r.current.has(j)||!cs(g,h))&&(r.current.add(j),ae.logEventWithStatsig(g,u,y))}},[m]);return c?s.jsx(bs,{navigation:n,onShowSearchResults:l,trackContentReferenceEvent:f}):s.jsx(ls,{tldr:{type:"tldr",display_title:n.domains[0].title,url:n.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[n.domains[0].domain],refs:[]},trackContentReferenceEvent:f})},qs=S(()=>N(()=>import("./n13nvk04odhrhh2o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Zs=S(()=>N(()=>import("./l59jhu2ho2y7wq08.js"),__vite__mapDeps([13,1,3,4,14]))),Gs=S(()=>N(()=>import("./cws9w0h2sqbkm9c3.js"),__vite__mapDeps([15,1,3,4,6,7]))),et=S(()=>N(()=>import("./gp6b3ci8c7knuiru.js"),__vite__mapDeps([16,1,3,4,6,7,8])).then(e=>e.TextMessageEditor)),st=S(()=>N(()=>import("./nm1vjlqul5lsrmth.js"),__vite__mapDeps([17,1,3,4,18,6,7,19,2,5,8,9,10,11,12]))),tt=S(async()=>()=>null),at=S(()=>N(()=>import("./k8endz57efgul1h9.js"),__vite__mapDeps([20,1,3,4,6,7,8,9,10,11,12]))),nt=S(()=>N(()=>import("./g3thgzalsd22yws1.js"),__vite__mapDeps([21,1,3,4,6,7,8,9,10,11,12])).then(e=>e.BrowsingMessage)),rt=S(()=>N(()=>import("./jn3882p1fc3q2h7l.js"),__vite__mapDeps([22,1,3,4,6,7])).then(e=>e.SearchResultMessage)),ot=S(()=>N(()=>import("./liyw83hamg3z3z3c.js"),__vite__mapDeps([23,1,3,4,6,7,8,9,10,11,12])).then(e=>e.JITPluginMessage)),it=S(()=>N(()=>import("./lc7h8twjzp5pbqrh.js"),__vite__mapDeps([24,3,1,4,6,7,8,9,10,11,12])).then(e=>e.DataAnalysisMessage)),ct=S(()=>N(()=>import("./eq1uzpsa50yc9zw1.js"),__vite__mapDeps([25,1,3,4,6,7,26,27,8,9,10,11,12]))),lt=S(()=>N(()=>import("./bh4mls0z1fu8erky.js"),__vite__mapDeps([28,1,6,3,4,7,29,30,31,32])).then(e=>e.JawboneMessage));function Et(e){switch(e.type){case i.Text:case i.Debug:return[e.message];case i.MultiText:case i.Browsing:case i.CodeInterpreter:case i.JITPlugin:case i.RetrievalBrowsing:case i.ParallelBrowsing:case i.Dalle:case i.t2uay3k:case i.GizmoEditor:case i.SearchResult:case i.a8km123:case i.f959b8c:case i.b1de6e2_c:case i.b1de6e2_s:case i.b1de6e2_d:case i.is_loading_message:case i.Canmore:case i.SonicCanvas:case i.de1d73e:case i.SearchGPTQuery:case i.l1p9k3u:case i.oiw209h:case i.c12k321:return e.messages;default:throw new Error("Bad")}}function bt({groupedMessagesToRender:e,allGroupedMessages:a,clientThreadId:t,isEditing:n,isUserTurn:o,isCompletionRequestInProgress:c,isFeedbackEnabled:m,isFinalTurn:l,turnIndex:r,hasActiveRequest:f,showEditButton:g=!1,handleEnterEdit:u,handleExitEdit:x,onChangeItemInView:h,onRequestMoreCompletions:y,onRequestCompletion:j,shouldGrowContainer:T=!0}){const{showDebugConversationTurns:I}=ds(),[A]=K(t,d=>[d?.mode]),C=Me(t),P=ms(),E=a.some(d=>us.includes(d.type)),L=e.map((d,_)=>{const k=_===a.length-1;switch(d.type){case i.Text:case i.MultiText:{const b=e[_-1],M=b?.type,F=b&&"messages"in b?b.messages:void 0;if(d.type===i.Text){const me=d?.message&&!W(d.message.message),ue=n?s.jsx(et,{message:d.message,clientThreadId:t,onChangeItemInView:h,onRequestCompletion:j,onRequestMoreCompletions:y,onExitEdit:x,disabled:f}):E&&me?null:s.jsx(ps,{className:"min-h-8",message:d.message,isFeedbackEnabled:m,isCompletionInProgress:k&&c,turnIndex:r,clientThreadId:t,showEditButton:g,onEnterEdit:u,isUserTurn:o,onRequestMoreCompletions:y,prevGroupedMessageType:M,prevGroupedMessages:F});return s.jsxs(p.Fragment,{children:[ue,s.jsx(hs,{isUserTurn:o,message:d.message.message})]},"group-"+d.message.nodeId)}else return d.type===i.MultiText?s.jsx(Gs,{clientThreadId:t,messages:d.messages,isCompletionInProgress:k&&c,isFeedbackEnabled:m,onRequestMoreCompletions:y,prevGroupedMessageType:M,prevGroupedMessages:F},"multitext-"+(d.messages[0]?.nodeId??_)):d.type}case i.Browsing:case i.RetrievalBrowsing:{const b=A!=null&&[z.GizmoInteraction,z.GizmoMagicCreate,z.GizmoTest].includes(A.kind),M=C?xs(C):!1;return s.jsx(nt,{messages:d.messages,isRequestActive:f,isLastMessageInTurn:k,isUsingGizmo:b,isUsingSnorlax:M,isRetrieval:d.type===i.RetrievalBrowsing},"browsing-"+(d.messages[0]?.nodeId??_))}case i.SearchGPTQuery:{const b=a.slice(_+1).find(({type:F})=>F===i.Text||F===i.SonicCanvas),M=b?.type===i.Text?b.message:b?.type===i.SonicCanvas?b.messages[0]:void 0;return s.jsx($s,{clientThreadId:t,turnIndex:r,isRequestActive:f,isLastMessage:k,isLastTurnInConversation:l,nextMessage:M},"searchquery-"+(d.messages[0]?.nodeId??_))}case i.a8km123:return s.jsx(ct,{messages:d.messages,isStreaming:k&&c,isLastMessage:k,clientThreadId:t,currentGroupedMessageIndex:_,turnIndex:r},"sum-"+(d.messages[0]?.nodeId??_));case i.f959b8c:return null;case i.is_loading_message:return k&&c?s.jsx(fs,{},"loading-message-"+_):null;case i.c12k321:return null;case i.l1p9k3u:return null;case i.b1de6e2_c:return s.jsx(Os,{messages:d.messages,clientThreadId:t,isLastMessage:k},"b1de6e2-"+(d.messages[0]?.nodeId??_));case i.b1de6e2_s:return s.jsx(Is,{messages:d.messages,clientThreadId:t},"b1de6e2_s-"+(d.messages[0]?.nodeId??_));case i.b1de6e2_d:return null;case i.de1d73e:if(P){const b=_+1<a.length?a[_+1]:void 0;return s.jsx(lt,{clientThreadId:t,currentGroupedMessage:d,nextMessage:b&&b.type===i.Text?b.message:void 0,isLastMessage:k,isRequestActive:f},"jawbone-"+(d.messages[0]?.nodeId??_))}else return null;case i.ParallelBrowsing:return s.jsx(at,{messages:d.messages},"parallel-"+(d.messages[0]?.nodeId??_));case i.CodeInterpreter:return s.jsx(it,{messages:d.messages,isRequestActive:f,clientThreadId:t},"ada-"+(d.messages[0]?.nodeId??_));case i.JITPlugin:return s.jsx(ot,{messages:d.messages,clientThreadId:t,isLastTurnInConversation:l,onRequestCompletion:j},"jit-"+(d.messages[0]?.nodeId??_));case i.Dalle:case i.t2uay3k:return s.jsx(st,{messages:d.messages,clientThreadId:t},"dalle-"+(d.messages[0]?.nodeId??_));case i.GizmoEditor:return s.jsx(qs,{messages:d.messages},"gizmo-editor-"+(d.messages[0]?.nodeId??_));case i.oiw209h:return s.jsx(tt,{messages:d.messages,clientThreadId:t},"oiw209h-"+(d.messages[0]?.nodeId??_));case i.Canmore:return s.jsx(gs,{messages:d.messages,allGroupedMessages:e,isFinalTurn:l,isRequestActive:f,clientThreadId:t},"canmore-"+(d.messages[0]?.nodeId??_));case i.SonicCanvas:return!1;case i.Debug:return I?s.jsx(Zs,{message:d.message},"debug-"+d.message.nodeId):null;case i.SearchResult:return s.jsx(rt,{messages:d.messages},"search-result-"+(d.messages[0]?.nodeId??_))}});return s.jsx(mt,{shouldGrowContainer:T,children:L})}function dt(){return s.jsx(_s,{type:"danger",children:s.jsx(v,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."})})}function mt({children:e,shouldGrowContainer:a}){return s.jsx("div",{className:w({"flex max-w-full flex-col":!0,"flex-grow":a}),children:s.jsx(Re,{name:"GroupedMessages",fallback:dt,children:e})})}export{bt as C,R as T,Ks as a,jt as b,Et as g};
//# sourceMappingURL=da0lloekhn03bypm.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ktb7k5hcb3th55ru.js","assets/n1tvutderx19k1zs.js","assets/pceg3mlzf8dzw9ob.js","assets/n26mv7rx7nquqst2.js","assets/root-osq5e7fb.css","assets/conversation-small-nranh1cg.css","assets/czm7x3bbeu35eu9w.js","assets/d3y72ugnrmac5z1v.js","assets/nanps14kkgvsrszm.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/pevkepdko1ob7sgk.js"])))=>i.map(i=>d[i]);
import{c as N,u as re,r as i,j as e,au as O,M as u,e as ie,aw as G}from"./n1tvutderx19k1zs.js";import{bo as V,ag as $,S as I,P as M,a as F,d as T,gY as le,b_ as oe,j as R,bs as ce,bt as ue,B as de,aE as me,a0 as fe,O as ge,d$ as pe,N as xe,aw as Y,dm as he,al as ye,b9 as z,gZ as je,br as ve,Y as be,Z as ke,g0 as Me,ab as we,bY as L,bq as K,c4 as Se,bX as Ce,bI as Te}from"./n26mv7rx7nquqst2.js";import{k8 as P,k9 as Ne,ka as _e,kb as W,U as Q,H as Pe,kc as Ie,kd as Fe,bC as Ae,ge as Ee,ke as Ue,gb as Le,o as Oe,br as Re,kf as C,bX as X,kg as Be,kh as B,ki as De,kj as We,kk as qe,kl as q,km as He,kn as Ge,ko as Ve,B as Z,bE as $e,kp as Ye,jt as ze,kq as Ke,kr as Qe,jx as Xe,jz as Ze,ks as Je,kt as es,ku as ss}from"./pceg3mlzf8dzw9ob.js";import{U as J,i as ts}from"./kodyf94rms2l778g.js";function as({showFreeTrialLoadingPayment:s,handleGetPaymentLink:t}){const r=N(),a=()=>{s||(P(!0),t())},o=g=>{g.stopPropagation(),Ne(!0),_e(!0)},{data:n,isLoading:d,isSuccess:c}=re({queryKey:["claimedReferralInvite"],queryFn:()=>$.getClaimedReferralInvite(),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1,refetchOnReconnect:!1}),f=n?.invite_code,[p,m]=i.useState(!1);if(i.useEffect(()=>{f&&!p&&c&&(m(!0),I.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),M.logEvent(F.chatgptReferralShowClaimedSidebartMenuPromo))},[f,m,p,c]),!f||d||!c)return null;const l=f.invite_metadata.invite_data,h=l?.referral_trial_duration_months?l?.referral_trial_duration_months>1?r.formatMessage(A.monthsOfBenefit,{referralTrialDurationMonths:l?.referral_trial_duration_months}):r.formatMessage(A.daysOfBenefit,{referralTrialDurationDays:l?.referral_trial_duration_days}):null;return e.jsx(O.div,{className:T("relative",{"cursor-progress opacity-50":s}),layout:"position",initial:{y:-10,opacity:1},animate:{y:0,opacity:1,transition:{duration:.1,ease:"easeIn"}},children:e.jsxs(ns,{className:T(s&&"opacity-75"),onClick:a,children:[e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-3",children:[e.jsx(le,{className:"icon-sm shrink-0"}),e.jsx(u,{...A.freeTrialCta,values:{duration:h}})]}),!s&&e.jsx(oe,{onClick:o,className:"icon-md shrink-0 rounded-full p-0.5 text-token-text-tertiary opacity-50 transition-colors duration-200 hover:bg-[#0077FF] hover:text-red-500 group-hover:opacity-100"}),e.jsx("span",{className:"absolute top-11 h-0 w-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]"})]})})}const ns=V.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,A=R({freeTrialCta:{id:"PaymentMenuItems.freeTrialCta",defaultMessage:"Get {duration}!"},monthsOfBenefit:{id:"FreeTrialMenuItem.monthsOfBenefit",defaultMessage:"{referralTrialDurationMonths, plural, one {one month free} other {# months free}}"},daysOfBenefit:{id:"FreeTrialMenuItem.daysOfBenefit",defaultMessage:"{referralTrialDurationDays, plural, one {one day free} other {# days free}}"}}),rs=ce(()=>ue(()=>import("./ktb7k5hcb3th55ru.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));function is(){const s=N(),t=de(),r=me(),{isLoading:a,data:o}=fe(),n=ge(o),d=n?.hasPaidSubscription()??!1,c=n?.hasClaimedFreeTrial()??!1,f=i.useMemo(()=>n?.subscriptionAnalyticsParams,[n]),p=pe(),m=async()=>{P(!0),M.logEvent(F.accountPayPaymentCheckoutClicked,f);try{const b=await $.getCheckoutLink(r,"PaymentMenuItems");window.location.href=b.url}catch{t.warning(s.formatMessage(y.paymentErrorWarning),{hasCloseButton:!0}),P(!1)}finally{}},l=()=>{g||(P(!0),m())},h=W(b=>b.didCloseFreeTrial),g=W(b=>b.showFreeTrialLoadingPayment),j=!h&&c,w=n?.wasPaidCustomer()??!1;let x=n?.isWorkspaceAccount()??!1;const v=n?.hasPaidSubscription()??!1,S=n?.isPlus()??!1,_=o&&xe(o),{layer:ee}=Y("2670443078");let D=S;!x&&!S&&_&&ee.get("is_gating_fix_enabled",!1)&&(D=_,x=!0);const se=!a&&!x,te=ie(),ae=()=>{M.logEvent(F.accountPayClickSidebarAccountPay,f),Ae(te,"Sidebar account payment menu item")};var ne=n?.isTeam()??!1;return e.jsxs(e.Fragment,{children:[!d&&j&&e.jsx(as,{showFreeTrialLoadingPayment:g,handleGetPaymentLink:m}),ne?e.jsx(ls,{currentWorkspace:n}):null,se&&e.jsx(J,{onClick:j?l:ae,className:T("rounded-lg",p?"":"m-0 px-2"),children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(os,{wasPaidCustomer:w,showFreeTrialLoadingPayment:g,hasPlusSubscription:D,hasPaidSubscription:v})})})})]})}const ls=({currentWorkspace:s})=>e.jsxs(e.Fragment,{children:[e.jsx(J,{onClick:()=>{Q.openModal(Pe.InviteUsersToWorkspace),M.logEvent(F.accountMemberInviteButton,{location:"payment-menu-click"}),I.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"payment-menu-click",text:"AddTeammatesWithInfo",step:"OpenModal"})},className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full border border-token-border-light",children:e.jsx(Ie,{className:"icon-sm shrink-0"})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(u,{...y.addTeammates})}),e.jsx("span",{className:"line-clamp-1 text-xs text-token-text-tertiary",children:e.jsx(u,{...y.addTeammatesUpsell})})]})})]})})})}),s!=null?e.jsx(rs,{workspace:s}):null]}),os=({wasPaidCustomer:s,showFreeTrialLoadingPayment:t,hasPlusSubscription:r,hasPaidSubscription:a})=>t?e.jsx(he,{className:"icon-sm shrink-0"}):a&&!r?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full border border-token-border-light",children:e.jsx(Fe,{className:"icon-sm"})}),e.jsx("div",{className:"flex flex-col",children:s?e.jsx(u,{...y.renewPlus}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:r?e.jsx(u,{...y.viewPlans}):!a&&e.jsx(u,{...y.upgradePlan})}),e.jsx("span",{className:"line-clamp-1 text-xs text-token-text-tertiary",children:r?e.jsx(u,{...y.upgradeToProOrTeamUpsell}):!a&&e.jsx(u,{...y.upgradeToPlusUpsell})})]})})]}),y=R({upgradePlan:{id:"PaymentMenuItems.upgradePlan",defaultMessage:"Upgrade plan"},createATeamWorkspace:{id:"PaymentMenuItems.createATeamWorkspace",defaultMessage:"Add Team workspace"},viewPlans:{id:"PaymentMenuItems.viewPlans",defaultMessage:"View plans"},upgradeToTeamUpsell:{id:"PaymentMenuItems.upgradeToTeamUpsell",defaultMessage:"Collaborate on a Team plan"},upgradeToProOrTeamUpsell:{id:"PaymentMenuItems.upgradeToProOrTeamUpsell",defaultMessage:"Unlimited access, team features, and more"},upgradeToPlusUpsell:{id:"PaymentMenuItems.upgradeToPlusUpsell.0",defaultMessage:"More access to the best models"},renewPlus:{id:"PaymentMenuItems.renewPlus",defaultMessage:"Renew Plus"},inviteReferral:{id:"PaymentMenuItems.inviteReferral",defaultMessage:"Refer a friend"},addTeammates:{id:"PaymentMenuItems.addTeammates.0",defaultMessage:"Add teammates"},addTeammatesUpsell:{id:"PaymentMenuItems.addTeammatesUpsell.0",defaultMessage:"Invite coworkers to ChatGPT"},inviteMembers:{id:"PaymentMenuItems.inviteMembers.0",defaultMessage:"Invite members"},paymentErrorWarning:{id:"PaymentMenuItems.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}});function _s({navHeader:s,children:t,className:r}){const a=N(),o=i.useRef(null),n=ye(),{isUnauthenticated:d}=z(),{layer:c}=Y("1578749296"),f=c.get("is_sticky_toggle_off",!1);return i.useEffect(()=>{f&&Q.toggleDesktopNavCollapsed()},[f]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"draggable relative h-full w-full flex-1 items-start border-white/20",children:[e.jsx(je,{asChild:!0,children:e.jsx("h2",{children:e.jsx(u,{...k.chatHistoryLabel})})}),e.jsxs("nav",{className:T("flex h-full w-full flex-col px-3",r),"aria-label":a.formatMessage(k.chatHistoryLabel),children:[s,e.jsx(ds,{ref:o,$disableScroll:n&&!d,children:t}),e.jsx(ve,{children:e.jsx(cs,{})})]})]})})}function cs(){const[s]=i.useState(()=>{const n=be.getCookie(ke.Workspace);return typeof n=="string"&&n!==Me}),t=we(),r=t?.data==null,{isUnauthenticated:a}=z(),{openSettings:o}=Ee();return s&&r||!t?null:a?e.jsx(us,{}):e.jsxs("div",{className:T("flex flex-col py-2 empty:hidden dark:border-white/20"),children:[e.jsx(Ue,{}),e.jsx(is,{}),e.jsx("div",{className:"flex w-full items-center md:hidden",children:e.jsx("div",{className:"max-w-[100%] grow",children:e.jsx(ts,{onClickSettings:()=>o()})})})]})}const us=()=>{const s=Le(),t=Oe(),r=Re(k.unauthSignupCta),a=()=>{t({authType:"login",callback:c=>{M.logLogInButtonClicked({location:"Sidebar bottom unit",provider:c}),I.logEvent("chatgpt_sidebar_login_button_clicked")}})},o=()=>{t({authType:"signup",callback:c=>{M.logSignUpButtonClicked({location:"Sidebar bottom unit",provider:c}),I.logEvent("chatgpt_sidebar_signup_button_clicked")}})},n=e.jsx(L,{as:"button",size:"medium",color:s?"secondary":"primary","data-testid":"signup-button",onClick:o,children:e.jsx(u,{...r})},"signup-button"),d=e.jsx(L,{as:"button",size:"medium",color:s?"primary":"secondary","data-testid":"login-button",onClick:a,children:e.jsx(u,{...k.unauthLoginCta})},"login-button");return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"mb-4 mt-2",children:[e.jsx("p",{className:"mb-1 text-sm font-semibold text-token-text-primary",children:e.jsx(u,{...s?k.logInOrSignUp:k.signUpOrLogIn})}),e.jsx("p",{className:"text-sm text-token-text-secondary",children:e.jsx(u,{id:"4qlPtW",defaultMessage:"Get smarter responses, upload files and images, and more."})})]}),e.jsx("div",{className:"flex flex-row items-start gap-2",children:s?[d,n]:[n,d]})]})},ds=V.div`flex-col flex-1 transition-opacity duration-500 relative -mr-2 pr-2
  ${({$disableScroll:s})=>s?"overflow-y-hidden opacity-20 pointer-events-none":"overflow-y-auto"}`,k=R({chatHistoryLabel:{id:"NavigationContent.chatHistoryLabel",defaultMessage:"Chat history"},closeSidebar:{id:"NavigationContent.closeSidebar",defaultMessage:"Close sidebar"},signInToChat:{id:"NavigationContent.signInToChat",defaultMessage:"Sign in to ChatGPT"},signUpOrLogIn:{id:"NavigationContent.signUpOrLogIn",defaultMessage:"Sign up or log in"},logInOrSignUp:{id:"NavigationContent.logInOrSignUp",defaultMessage:"Log in or sign up"},unauthSignupCta:{id:"NavigationContent.unauthSignupCta",defaultMessage:"Sign up"},unauthLoginCta:{id:"NavigationContent.unauthLoginCta",defaultMessage:"Log in"}});function ms({children:s}){return e.jsx("div",{className:"h-full w-full bg-token-main-surface-primary px-[22px] py-4",children:s})}function fs(){return e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx(C,{className:"h-full w-full !rounded-full"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(C,{}),e.jsx(C,{}),e.jsx(C,{}),e.jsx(C,{})]})]})}function E({icon:s,message:t,iconClassName:r}){return e.jsx("div",{className:"loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",children:e.jsx(B,{fillIcon:!1,icon:s,className:r,children:e.jsx("div",{className:"mt-[.5px] flex h-10",children:t})})})}const gs=({finalRow:s})=>{const t=N();return e.jsx(G,{children:e.jsx(O.div,{layout:!0,transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-start justify-start gap-4",children:s.type==="search"?e.jsx(E,{icon:e.jsx(X,{className:"relative h-5 w-5 text-token-text-primary opacity-50"}),message:t.formatMessage({id:"f9wsyE",defaultMessage:"Searching…"})}):s.type==="summary"?e.jsx(E,{icon:e.jsx(K,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"bSPYmC",defaultMessage:"Thinking…"})}):e.jsx(E,{icon:e.jsx(Be,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"8L6BBp",defaultMessage:"Reading…"})})})})},ps=({children:s,showIcon:t})=>e.jsxs("div",{className:"flex items-start gap-2 text-wrap text-start",children:[e.jsx("div",{className:"mt-[1px] inline-flex h-5 w-5 shrink-0 items-center justify-end gap-2.5 pt-[3px]",children:t&&e.jsx(X,{className:"relative h-5 w-5 text-token-text-primary"})}),s]}),xs=({row:s,showIcon:t})=>{const r=s.query;return r?e.jsx(ps,{showIcon:t,children:e.jsx("div",{className:"flex text-base text-token-text-primary",children:r})}):null};function U({children:s}){return e.jsx(O.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},children:s})}const hs=({previousRow:s,currentRow:t})=>e.jsx("div",{className:"flex flex-col items-start justify-start gap-4",children:t.type==="search"?e.jsx(U,{children:e.jsx(xs,{row:t,showIcon:!s||s.type!=="search"})},`search_${t.id}`):t.type==="summary"?e.jsx(U,{children:e.jsx(De,{row:t,showIcon:!s||s.type!=="summary"})},`summary_${t.id}`):t.type==="websiteOpen"?e.jsx(U,{children:e.jsx(We,{website:t})},`website_${t.id}`):null}),ys=120,js=1e3*60*2;function H(s){s?.scrollIntoView({block:"center",behavior:"smooth"})}function vs({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Z,{type:"error",title:s.failureMessage,content:s.failureBannerContentMessage})})}function bs({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Z,{title:s.cancelledMessage,content:""})})}function ks({interruptPrompt:s,setInterruptPrompt:t,handleInterruptCaterpillar:r}){const a=N();return e.jsxs("div",{className:"flex w-full flex-col justify-center gap-4 p-4",children:[e.jsx($e,{ariaLabel:a.formatMessage({id:"aYWRtV",defaultMessage:"Press enter to interrupt task"}),name:"interrupt-caterpillar-prompt",value:s,onChange:o=>t(o.target.value),color:"search",onPressEnter:r}),e.jsx(L,{onClick:r,children:e.jsx(u,{id:"h73FdF",defaultMessage:"Interrupt task"})})]})}function Ms({sourcesCount:s,taskInfo:t}){const a=Ye(t.originalConversationId).find(n=>n.message.metadata?.b1de6e2_s&&n.message.metadata?.async_task_id===t.taskId)?.message,o=i.useMemo(()=>a?.metadata?.async_task_status_messages?.completed_no_time?e.jsxs(e.Fragment,{children:[a.metadata?.async_task_status_messages?.completed_with_time??a?.metadata?.async_task_status_messages?.completed_no_time,e.jsx(u,{id:"zxfmo/",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:s}})]}):e.jsx(u,{id:"YG7a0T",defaultMessage:"Completed · {sourcesCount} sources",values:{sourcesCount:s}}),[s,a]);return!t.updatedAt&&!a?.metadata?.async_task_status_messages?.completed?null:e.jsx(B,{icon:e.jsx(Ce,{className:"text-token-text-secondary"}),fillIcon:!1,children:e.jsx("div",{className:"text-token-text-tertiary",children:o})})}function ws({taskInfo:s,caterpillarStatusMessageTexts:t,sourcesCount:r,caterpillarHeaderRef:a}){const[o,n]=i.useState(""),[d,c]=i.useState(!1),f=Se("caterpillar-interrupts"),p=i.useRef(!1),m=i.useRef(null),l=i.useMemo(()=>(p.current=!!m.current&&qe(m.current,ys),s.rows??[]),[s.rows]);i.useEffect(()=>{if(l.length===0){const x=new Date(s.createdAt).getTime(),v=Date.now()-x,S=js-v;if(S>0){const _=setTimeout(()=>{c(!0)},S);return()=>clearTimeout(_)}else c(!0)}else c(!1)},[l,s.createdAt]),i.useEffect(()=>{p.current&&H(m.current)},[l]),i.useEffect(()=>{q(s)||H(m.current)},[]);const h=He({taskId:s.taskId,prompt:o}),g=q(s)||Ge(s),j=i.useCallback(async()=>{await h.mutateAsync(),n("")},[h,n]),w=i.useMemo(()=>l.length?g?l:l.slice(0,l.length-1):l,[l,g]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{ref:a},"task-header"),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"text-base font-medium",children:s.title}),l.length?e.jsxs(G,{initial:!1,children:[w.map((x,v)=>e.jsx(hs,{previousRow:v>0?l[v-1]:null,currentRow:x},x.id)),!g&&e.jsx(gs,{finalRow:l[l.length-1]})]}):d?e.jsx(B,{fillIcon:!1,icon:e.jsx(K,{className:"inline-flex h-5 w-5 items-center justify-center text-token-text-primary"}),children:t.waitingInQueueMessage}):e.jsx(fs,{}),Ve(s)&&f&&e.jsx(ks,{interruptPrompt:o,setInterruptPrompt:n,handleInterruptCaterpillar:j}),s.status==="failed"?e.jsx(vs,{caterpillarStatusMessageTexts:t}):s.status==="cancelled"?e.jsx(bs,{caterpillarStatusMessageTexts:t}):s.status==="completed"?e.jsx(Ms,{caterpillarStatusMessageTexts:t,taskInfo:s,sourcesCount:r}):null]}),e.jsx("div",{ref:m},"task-footer")]})}function Ps({taskId:s,setWidth:t=void 0,initialTab:r}){const a=ze(g=>Ke.getTask(s,g)),{closeThreadSidebar:o}=Te(),n=Qe(),[d,c]=i.useState(r),f=Xe(),p=i.useRef(null),m=!1;i.useEffect(()=>{c(r)},[r]),i.useEffect(()=>{},[a?.taskId,a?.status,m]),i.useEffect(()=>{},[a?.taskId,a?.status,d]),i.useEffect(()=>{},[t,a,m]);const{uniqueSources:l,totalSources:h}=i.useMemo(()=>{if(!a?.rows)return{uniqueSources:[],totalSources:0};const g=Ze(a.rows),j=g.reduce((w,x)=>w+x.count,0);return{uniqueSources:g,totalSources:j}},[a?.rows]);return e.jsx(Je,{handleClose:()=>o({}),leading:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(es,{activeTab:d,setActiveTab:c,showAuxTab:m,sourcesCount:h,caterpillarHeaderRef:p})}),trailing:n&&e.jsx("div",{className:"bg-token-main-surface-primary py-2 text-center text-xs text-token-text-secondary keyboard-open:hidden",children:n}),children:a&&e.jsxs(ms,{children:[!1,d==="activity"&&e.jsx(ws,{taskInfo:a,caterpillarStatusMessageTexts:f,sourcesCount:h,caterpillarHeaderRef:p}),d==="sources"&&e.jsx(ss,{taskInfo:a,sources:l,caterpillarHeaderRef:p})]})})}export{Ps as C,_s as N,is as P,us as U};
//# sourceMappingURL=fws03tm73d9qjm3m.js.map

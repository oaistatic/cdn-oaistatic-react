const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/nco63z16utqrw1ij.js","assets/n1tvutderx19k1zs.js","assets/l87s7oyr110u25y7.js","assets/n26mv7rx7nquqst2.js","assets/root-osq5e7fb.css","assets/pceg3mlzf8dzw9ob.js","assets/conversation-small-nranh1cg.css","assets/o3h1v0olwo66q80n.js","assets/ktb7k5hcb3th55ru.js","assets/czm7x3bbeu35eu9w.js","assets/d3y72ugnrmac5z1v.js","assets/nanps14kkgvsrszm.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/pevkepdko1ob7sgk.js"])))=>i.map(i=>d[i]);
import{ao as Lt,ai as _n,bK as Nn,aq as Dn,n as Fn,M as On,L as ze,C as Ve,P as A,a as F,av as Ln,a5 as Wn,cm as st,aE as Wt,c5 as Bn,hc as at,hd as Hn,he as we,hf as Un,hg as Bt,hh as Ne,hi as De,hj as $n,hk as Kn,hl as qn,hm as zn,hn as Vn,ho as Gn,gD as Qn,cV as Yn,d as _,as as Jn,dj as Xn,d$ as ne,gt as Zn,H as es,bs as ot,bt as rt,b9 as he,s as ie,r as me,ap as Fe,t as ts,ag as ns,aR as ss,a4 as as,a0 as ve,Q as os,U as Ht,eF as rs,bo as xe,O as Te,B as is,bU as ls,dL as cs,dJ as us,bW as j,dm as Ge,bX as ds,eU as ms,bJ as Z,dl as Ut,S as Ce,dC as $t,j as Kt,aw as Ie,N as ps,dq as fs,er as gs,bg as hs,aG as vs,bY as Qe,dr as Oe,al as xs}from"./n26mv7rx7nquqst2.js";import{r as p,j as r,M as T,l as Q,m as Ss,R as ee,L as bs,a as ws,c as V,e as it}from"./n1tvutderx19k1zs.js";import{af as qt,ae as lt,cF as ys,B as Ms,gW as ct,gX as ut,ms as Cs,bb as Y,aP as R,mt as zt,aI as bt,aJ as se,aK as je,aU as Is,bj as ks,bk as Es,aX as Ts,aY as Vt,aZ as ke,a_ as ae,ba as js,bl as P,mu as D,bm as As,a$ as Ps,b0 as Rs,b1 as _s,b3 as Gt,b2 as Ns,aM as Ds,b7 as Fs,b8 as Os,bc as Ls,bd as Ws,mv as Bs,mw as Hs,mx as Us,my as $s,bf as wt,mz as Qt,bg as Ks,b9 as qs,bi as zs,mA as Vs,mB as Gs,mC as Qs,mD as Yt,mE as Ys,mF as Js,mG as Le,mH as Xs,iP as Zs,mI as ea,mJ as Jt,mK as ta,iO as na,mL as sa,mM as aa,mN as oa,mO as ra,w as ia,a6 as la,dA as ca,O as dt,hx as ua,mP as da,o as Xt,cf as Ae,lM as mt,f3 as Zt,cQ as ma,U as z,cR as yt,gp as pa,ah as fa,mQ as pt,mR as en,mS as tn,mT as nn,mU as ga,bW as ha,aH as sn,H as an,kc as on,lL as rn,mV as ln,mW as cn,fy as va,mX as xa,bC as un,f4 as Sa,ge as ba,A as ft,P as wa,fD as dn,mY as ya,kd as Ma,mZ as Ca,cA as gt,eN as mn,gc as Ia,hd as ka,dp as Ea,m_ as Ta,gd as ja,m$ as Aa,hn as We,aa as Mt,ab as pn,n0 as Pa,eM as Ct,dP as Ra,gb as _a,br as Na}from"./pceg3mlzf8dzw9ob.js";import{c as Da,T as Fa}from"./hexva2s1lo90zidg.js";import{t as Oa,u as La}from"./nraolmtygmvq3wcf.js";import{P as oe,a as le,D as Wa,b as Ba,T as Ye,p as Ha,M as Ua,k as Je,c as It,S as $a,E as Ka,d as qa,e as za,g as Va,i as Ga,n as Qa}from"./ecp3vwsjvu9v61q0.js";const fn=qt.DesktopBrowserExtensionAnnouncement,gn=qt.DesktopBrowserExtensionReactiveAnnouncement,Ya=5,ht="https://chromewebstore.google.com/detail/searchgpt/ejcfepkfckglbgocfkanmcdngdijcgld";function Ja({announcementKey:e=fn,onClose:t}){p.useEffect(()=>{A.logEventWithStatsig(F.chatgptBrowserExtensionAnnouncementShown,"chatgpt_browser_extension_announcement_shown")},[]);const{markAsViewed:n}=lt(e),s=p.useCallback(()=>{n(),A.logEventWithStatsig(F.chatgptBrowserExtensionAnnouncementClosed,"chatgpt_browser_extension_announcement_closed"),t&&t()},[n,t]),a=p.useCallback(()=>{A.logEventWithStatsig(F.chatgptBrowserExtensionAnnouncementCTAClicked,"chatgpt_browser_extension_announcement_cta_clicked"),n(),t&&t()},[n,t]);return r.jsx(Xa,{downloadUrl:ht,announcementKey:e,handleCTAClicked:a,handleClose:s})}function si({onClose:e}){return Ja({announcementKey:gn,onClose:e})}function Xa({downloadUrl:e,announcementKey:t,handleCTAClicked:n,handleClose:s}){const a=()=>{n(),window.open(e)},o=r.jsxs("div",{className:"flex-grow",children:[r.jsx("div",{className:"mb-0.5 font-semibold",children:r.jsx(T,{id:"uAZwaE",defaultMessage:"Use ChatGPT for every search"})}),r.jsx("span",{className:"text-token-text-secondary",children:r.jsx(T,{id:"+wTq4L",defaultMessage:"Download the Chrome extension to switch your default search engine to ChatGPT, and get instant answers from trusted sources with every search."})})]});return r.jsx(Ms,{onPrimaryCtaClick:a,primaryCtaText:r.jsx(T,{id:"x9mKG0",defaultMessage:"Get Extension"}),onDismiss:()=>s(t),content:o})}function hn(e){const{value:t}=Ln("2634628831"),n=Wn(()=>document.documentElement.dataset.searchExtension==="1"),s=ct(e.clientThreadId),a=ut(s,st.Search),i=!Wt()?.includes(Bn.SearchToolHoldout),{userIsInSearchHoldoutWithWebDisabled:l}=Da();return at()&&!n&&a&&i&&!l&&t}function ai(e){const t=hn(e),n=Za(),s=lt(fn);return s.eligible&&!s.isLoading&&t&&n&&!Lt(e.clientThreadId)&&e.conversationMode?.kind===_n.PrimaryAssistant}function oi(e){const t=hn(e),n=Nn(e.clientThreadId),s=Dn(e.clientThreadId,n),a=ys(s,c=>c.role===Fn.User);var o=!1;const i=a?.messages[0]?.message;if(i?.content.content_type===On.Text){const c=i?.content.parts[0]?.toLowerCase();c&&(o=c.includes("chrome extension")||c.includes("default search"))}const l=lt(gn);return l.eligible&&!l.isLoading&&t&&o}function ri(e){const t=ze.getItem(Ve.SearchSettings)??{};t.hasSearchedMinTimes||(t.searchMessageIds||(t.searchMessageIds=[]),t.searchMessageIds.includes(e)||(t.searchMessageIds.push(e),t.searchMessageIds.length>=Ya&&(t.hasSearchedMinTimes=!0,delete t.searchMessageIds),ze.setItem(Ve.SearchSettings,t)))}function Za(){return(ze.getItem(Ve.SearchSettings)??{}).hasSearchedMinTimes===!0}const vn={...Ss},eo=vn.useInsertionEffect,to=eo||(e=>e());function xn(e){const t=p.useRef(()=>{});return to(()=>{t.current=e}),p.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}var Xe=typeof document<"u"?p.useLayoutEffect:p.useEffect;let kt=!1,no=0;const Et=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+no++;function so(){const[e,t]=p.useState(()=>kt?Et():void 0);return Xe(()=>{e==null&&t(Et())},[]),p.useEffect(()=>{kt=!0},[]),e}const ao=vn.useId,oo=ao||so;function ro(){const e=new Map;return{emit(t,n){var s;(s=e.get(t))==null||s.forEach(a=>a(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var s;e.set(t,((s=e.get(t))==null?void 0:s.filter(a=>a!==n))||[])}}}const io=p.createContext(null),lo=p.createContext(null),co=()=>{var e;return((e=p.useContext(io))==null?void 0:e.id)||null},uo=()=>p.useContext(lo),mo="data-floating-ui-focusable";function po(e){const{open:t=!1,onOpenChange:n,elements:s}=e,a=oo(),o=p.useRef({}),[i]=p.useState(()=>ro()),l=co()!=null,[c,m]=p.useState(s.reference),f=xn((d,g,v)=>{o.current.openEvent=d?g:void 0,i.emit("openchange",{open:d,event:g,reason:v,nested:l}),n?.(d,g,v)}),h=p.useMemo(()=>({setPositionReference:m}),[]),u=p.useMemo(()=>({reference:c||s.reference||null,floating:s.floating||null,domReference:s.reference}),[c,s.reference,s.floating]);return p.useMemo(()=>({dataRef:o,open:t,onOpenChange:f,elements:u,events:i,floatingId:a,refs:h}),[t,f,u,i,a,h])}function fo(e){e===void 0&&(e={});const{nodeId:t}=e,n=po({...e,elements:{reference:null,floating:null,...e.elements}}),s=e.rootContext||n,a=s.elements,[o,i]=p.useState(null),[l,c]=p.useState(null),f=a?.reference||o,h=p.useRef(null),u=uo();Xe(()=>{f&&(h.current=f)},[f]);const d=Hn({...e,elements:{...a,...l&&{reference:l}}}),g=p.useCallback(S=>{const M=we(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),contextElement:S}:S;c(M),d.refs.setReference(M)},[d.refs]),v=p.useCallback(S=>{(we(S)||S===null)&&(h.current=S,i(S)),(we(d.refs.reference.current)||d.refs.reference.current===null||S!==null&&!we(S))&&d.refs.setReference(S)},[d.refs]),x=p.useMemo(()=>({...d.refs,setReference:v,setPositionReference:g,domReference:h}),[d.refs,v,g]),w=p.useMemo(()=>({...d.elements,domReference:f}),[d.elements,f]),b=p.useMemo(()=>({...d,...s,refs:x,elements:w,nodeId:t}),[d,x,w,t,s]);return Xe(()=>{s.dataRef.current.floatingContext=b;const S=u?.nodesRef.current.find(M=>M.id===t);S&&(S.context=b)}),p.useMemo(()=>({...d,context:b,refs:x,elements:w}),[d,x,w,b])}const Tt="active",jt="selected";function Be(e,t,n){const s=new Map,a=n==="item";let o=e;if(a&&e){const{[Tt]:i,[jt]:l,...c}=e;o=c}return{...n==="floating"&&{tabIndex:-1,[mo]:""},...o,...t.map(i=>{const l=i?i[n]:null;return typeof l=="function"?e?l(e):null:l}).concat(e).reduce((i,l)=>(l&&Object.entries(l).forEach(c=>{let[m,f]=c;if(!(a&&[Tt,jt].includes(m)))if(m.indexOf("on")===0){if(s.has(m)||s.set(m,[]),typeof f=="function"){var h;(h=s.get(m))==null||h.push(f),i[m]=function(){for(var u,d=arguments.length,g=new Array(d),v=0;v<d;v++)g[v]=arguments[v];return(u=s.get(m))==null?void 0:u.map(x=>x(...g)).find(x=>x!==void 0)}}}else i[m]=f}),i),{})}}function go(e){e===void 0&&(e=[]);const t=e.map(l=>l?.reference),n=e.map(l=>l?.floating),s=e.map(l=>l?.item),a=p.useCallback(l=>Be(l,e,"reference"),t),o=p.useCallback(l=>Be(l,e,"floating"),n),i=p.useCallback(l=>Be(l,e,"item"),s);return p.useMemo(()=>({getReferenceProps:a,getFloatingProps:o,getItemProps:i}),[a,o,i])}function At(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const ho=e=>({name:"inner",options:e,async fn(t){const{listRef:n,overflowRef:s,onFallbackChange:a,offset:o=0,index:i=0,minItemsVisible:l=4,referenceOverflowThreshold:c=0,scrollRef:m,...f}=Un(e,t),{rects:h,elements:{floating:u}}=t,d=n.current[i],g=m?.current||u,v=u.clientTop||g.clientTop,x=u.clientTop!==0,w=g.clientTop!==0,b=u===g;if(!d)return{};const S={...t,...await Bt(-d.offsetTop-u.clientTop-h.reference.height/2-d.offsetHeight/2-o).fn(t)},M=await Ne(At(S,g.scrollHeight+v+u.clientTop),f),I=await Ne(S,{...f,elementContext:"reference"}),k=De(0,M.top),N=S.y+k,C=$n(De(0,g.scrollHeight+(x&&b||w?v*2:0)-k-De(0,M.bottom)));if(g.style.maxHeight=C+"px",g.scrollTop=k,a){const E=g.scrollHeight>g.offsetHeight&&g.offsetHeight<d.offsetHeight*l-1||I.top>=-c||I.bottom>=-c;Q.flushSync(()=>a(E))}return s&&(s.current=await Ne(At({...S,y:N},g.offsetHeight+v+u.clientTop),f)),{y:N}}});function vo(e,t){const{open:n,elements:s}=e,{enabled:a=!0,overflowRef:o,scrollRef:i,onChange:l}=t,c=xn(l),m=p.useRef(!1),f=p.useRef(null),h=p.useRef(null);p.useEffect(()=>{if(!a)return;function d(v){if(v.ctrlKey||!g||o.current==null)return;const x=v.deltaY,w=o.current.top>=-.5,b=o.current.bottom>=-.5,S=g.scrollHeight-g.clientHeight,M=x<0?-1:1,I=x<0?"max":"min";g.scrollHeight<=g.clientHeight||(!w&&x>0||!b&&x<0?(v.preventDefault(),Q.flushSync(()=>{c(k=>k+Math[I](x,S*M))})):/firefox/i.test(Cs())&&(g.scrollTop+=x))}const g=i?.current||s.floating;if(n&&g)return g.addEventListener("wheel",d),requestAnimationFrame(()=>{f.current=g.scrollTop,o.current!=null&&(h.current={...o.current})}),()=>{f.current=null,h.current=null,g.removeEventListener("wheel",d)}},[a,n,s.floating,o,i,c]);const u=p.useMemo(()=>({onKeyDown(){m.current=!0},onWheel(){m.current=!1},onPointerMove(){m.current=!1},onScroll(){const d=i?.current||s.floating;if(!(!o.current||!d||!m.current)){if(f.current!==null){const g=d.scrollTop-f.current;(o.current.bottom<-.5&&g<-1||o.current.top<-.5&&g>1)&&Q.flushSync(()=>c(v=>v+g))}requestAnimationFrame(()=>{f.current=d.scrollTop})}}}),[s.floating,c,o,i]);return p.useMemo(()=>a?{floating:u}:{},[a,u])}let ce=p.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});ce.displayName="FloatingContext";let vt=p.createContext(null);vt.displayName="PlacementContext";function xo(e){return p.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function So(){return p.useContext(ce).setReference}function bo(){return p.useContext(ce).getReferenceProps}function wo(){let{getFloatingProps:e,slot:t}=p.useContext(ce);return p.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":t.anchor}),[e,t])}function yo(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=p.useContext(vt),n=p.useMemo(()=>e,[JSON.stringify(e,(a,o)=>{var i;return(i=o?.outerHTML)!=null?i:o})]);Y(()=>{t?.(n??null)},[t,n]);let s=p.useContext(ce);return p.useMemo(()=>[s.setFloating,e?s.styles:{}],[s.setFloating,e,s.styles])}let Pt=4;function Mo({children:e,enabled:t=!0}){let[n,s]=p.useState(null),[a,o]=p.useState(0),i=p.useRef(null),[l,c]=p.useState(null);Co(l);let m=t&&n!==null&&l!==null,{to:f="bottom",gap:h=0,offset:u=0,padding:d=0,inner:g}=Io(n,l),[v,x="center"]=f.split(" ");Y(()=>{m&&o(0)},[m]);let{refs:w,floatingStyles:b,context:S}=fo({open:m,placement:v==="selection"?x==="center"?"bottom":`bottom-${x}`:x==="center"?`${v}`:`${v}-${x}`,strategy:"absolute",transform:!1,middleware:[Bt({mainAxis:v==="selection"?0:h,crossAxis:u}),Kn({padding:d}),v!=="selection"&&qn({padding:d}),v==="selection"&&g?ho({...g,padding:d,overflowRef:i,offset:a,minItemsVisible:Pt,referenceOverflowThreshold:d,onFallbackChange(O){var L,re;if(!O)return;let J=S.elements.floating;if(!J)return;let Se=parseFloat(getComputedStyle(J).scrollPaddingBottom)||0,ue=Math.min(Pt,J.childElementCount),y=0,de=0;for(let H of(re=(L=S.elements.floating)==null?void 0:L.childNodes)!=null?re:[])if(H instanceof HTMLElement){let K=H.offsetTop,be=K+H.clientHeight+Se,_e=J.scrollTop,St=_e+J.clientHeight;if(K>=_e&&be<=St)ue--;else{de=Math.max(0,Math.min(be,St)-Math.max(K,_e)),y=H.clientHeight;break}}ue>=1&&o(H=>{let K=y*ue-de+Se;return H>=K?H:K})}}):null,zn({padding:d,apply({availableWidth:O,availableHeight:L,elements:re}){Object.assign(re.floating.style,{overflow:"auto",maxWidth:`${O}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${L}px)`})}})].filter(Boolean),whileElementsMounted:Vn}),[M=v,I=x]=S.placement.split("-");v==="selection"&&(M="selection");let k=p.useMemo(()=>({anchor:[M,I].filter(Boolean).join(" ")}),[M,I]),N=vo(S,{overflowRef:i,onChange:o}),{getReferenceProps:C,getFloatingProps:E}=go([N]),B=R(O=>{c(O),w.setFloating(O)});return p.createElement(vt.Provider,{value:s},p.createElement(ce.Provider,{value:{setFloating:B,setReference:w.setReference,styles:b,getReferenceProps:C,getFloatingProps:E,slot:k}},e))}function Co(e){Y(()=>{if(!e)return;let t=new MutationObserver(()=>{let n=window.getComputedStyle(e).maxHeight,s=parseFloat(n);if(isNaN(s))return;let a=parseInt(n);isNaN(a)||s!==a&&(e.style.maxHeight=`${Math.ceil(s)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function Io(e,t){var n,s,a;let o=He((n=e?.gap)!=null?n:"var(--anchor-gap, 0)",t),i=He((s=e?.offset)!=null?s:"var(--anchor-offset, 0)",t),l=He((a=e?.padding)!=null?a:"var(--anchor-padding, 0)",t);return{...e,gap:o,offset:i,padding:l}}function He(e,t,n=void 0){let s=zt(),a=R((c,m)=>{if(c==null)return[n,null];if(typeof c=="number")return[c,null];if(typeof c=="string"){if(!m)return[n,null];let f=Rt(c,m);return[f,h=>{let u=Sn(c);{let d=u.map(g=>window.getComputedStyle(m).getPropertyValue(g));s.requestAnimationFrame(function g(){s.nextFrame(g);let v=!1;for(let[w,b]of u.entries()){let S=window.getComputedStyle(m).getPropertyValue(b);if(d[w]!==S){d[w]=S,v=!0;break}}if(!v)return;let x=Rt(c,m);f!==x&&(h(x),f=x)})}return s.dispose}]}return[n,null]}),o=p.useMemo(()=>a(e,t)[0],[e,t]),[i=o,l]=p.useState();return Y(()=>{let[c,m]=a(e,t);if(l(c),!!m)return m(l)},[e,t]),i}function Sn(e){let t=/var\((.*)\)/.exec(e);if(t){let n=t[1].indexOf(",");if(n===-1)return[t[1]];let s=t[1].slice(0,n).trim(),a=t[1].slice(n+1).trim();return a?[s,...Sn(a)]:[s]}return[]}function Rt(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let s=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),s}var ko=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ko||{}),Eo=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Eo||{}),To=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(To||{});function Ue(e,t=n=>n){let n=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,s=Xs(t(e.items.slice()),o=>o.dataRef.current.domRef.current),a=n?s.indexOf(n):null;return a===-1&&(a=null),{items:s,activeItemIndex:a}}let jo={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var n,s,a,o,i;if(e.menuState===1)return e;let l={...e,searchQuery:"",activationTrigger:(n=t.trigger)!=null?n:1,__demoMode:!1};if(t.focus===D.Nothing)return{...l,activeItemIndex:null};if(t.focus===D.Specific)return{...l,activeItemIndex:e.items.findIndex(f=>f.id===t.id)};if(t.focus===D.Previous){let f=e.activeItemIndex;if(f!==null){let h=e.items[f].dataRef.current.domRef,u=Le(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:d=>d.id,resolveDisabled:d=>d.dataRef.current.disabled});if(u!==null){let d=e.items[u].dataRef.current.domRef;if(((s=h.current)==null?void 0:s.previousElementSibling)===d.current||((a=d.current)==null?void 0:a.previousElementSibling)===null)return{...l,activeItemIndex:u}}}}else if(t.focus===D.Next){let f=e.activeItemIndex;if(f!==null){let h=e.items[f].dataRef.current.domRef,u=Le(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:d=>d.id,resolveDisabled:d=>d.dataRef.current.disabled});if(u!==null){let d=e.items[u].dataRef.current.domRef;if(((o=h.current)==null?void 0:o.nextElementSibling)===d.current||((i=d.current)==null?void 0:i.nextElementSibling)===null)return{...l,activeItemIndex:u}}}}let c=Ue(e),m=Le(t,{resolveItems:()=>c.items,resolveActiveIndex:()=>c.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});return{...l,...c,activeItemIndex:m}},3:(e,t)=>{let n=e.searchQuery!==""?0:1,s=e.searchQuery+t.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find(i=>{var l;return((l=i.dataRef.current.textValue)==null?void 0:l.startsWith(s))&&!i.dataRef.current.disabled}),o=a?e.items.indexOf(a):-1;return o===-1||o===e.activeItemIndex?{...e,searchQuery:s}:{...e,searchQuery:s,activeItemIndex:o,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let n=Ue(e,s=>[...s,{id:t.id,dataRef:t.dataRef}]);return{...e,...n}},6:(e,t)=>{let n=Ue(e,s=>{let a=s.findIndex(o=>o.id===t.id);return a!==-1&&s.splice(a,1),s});return{...e,...n,activationTrigger:1}},7:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},8:(e,t)=>e.itemsElement===t.element?e:{...e,itemsElement:t.element}},xt=p.createContext(null);xt.displayName="MenuContext";function Pe(e){let t=p.useContext(xt);if(t===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Pe),n}return t}function Ao(e,t){return Vt(t.type,jo,e,t)}let Po=p.Fragment;function Ro(e,t){let{__demoMode:n=!1,...s}=e,a=p.useReducer(Ao,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:o,itemsElement:i,buttonElement:l},c]=a,m=je(t);Is(o===0,[l,i],(d,g)=>{c({type:1}),ks(g,Es.Loose)||(d.preventDefault(),l?.focus())});let f=R(()=>{c({type:1})}),h=p.useMemo(()=>({open:o===0,close:f}),[o,f]),u={ref:m};return ee.createElement(Mo,null,ee.createElement(xt.Provider,{value:a},ee.createElement(Ts,{value:Vt(o,{0:ke.Open,1:ke.Closed})},ae({ourProps:u,theirProps:s,slot:h,defaultTag:Po,name:"Menu"}))))}let _o="button";function No(e,t){var n;let s=p.useId(),{id:a=`headlessui-menu-button-${s}`,disabled:o=!1,autoFocus:i=!1,...l}=e,[c,m]=Pe("Menu.Button"),f=bo(),h=js(),u=je(t,So(),R(C=>m({type:7,element:C}))),d=R(C=>{switch(C.key){case P.Space:case P.Enter:case P.ArrowDown:C.preventDefault(),C.stopPropagation(),Q.flushSync(()=>m({type:0})),m({type:2,focus:D.First});break;case P.ArrowUp:C.preventDefault(),C.stopPropagation(),Q.flushSync(()=>m({type:0})),m({type:2,focus:D.Last});break}}),g=R(C=>{switch(C.key){case P.Space:C.preventDefault();break}}),v=R(C=>{var E;if(As(C.currentTarget))return C.preventDefault();o||(c.menuState===0?(Q.flushSync(()=>m({type:1})),(E=c.buttonElement)==null||E.focus({preventScroll:!0})):(C.preventDefault(),m({type:0})))}),{isFocusVisible:x,focusProps:w}=Ps({autoFocus:i}),{isHovered:b,hoverProps:S}=Rs({isDisabled:o}),{pressed:M,pressProps:I}=_s({disabled:o}),k=p.useMemo(()=>({open:c.menuState===0,active:M||c.menuState===0,disabled:o,hover:b,focus:x,autofocus:i}),[c,b,x,M,o,i]),N=Gt(f(),{ref:u,id:a,type:Ns(e,c.buttonElement),"aria-haspopup":"menu","aria-controls":(n=c.itemsElement)==null?void 0:n.id,"aria-expanded":c.menuState===0,disabled:o||void 0,autoFocus:i,onKeyDown:d,onKeyUp:g,onClick:v},w,S,I);return ae({mergeRefs:h,ourProps:N,theirProps:l,slot:k,defaultTag:_o,name:"Menu.Button"})}let Do="div",Fo=bt.RenderStrategy|bt.Static;function Oo(e,t){var n,s;let a=p.useId(),{id:o=`headlessui-menu-items-${a}`,anchor:i,portal:l=!1,modal:c=!0,transition:m=!1,...f}=e,h=xo(i),[u,d]=Pe("Menu.Items"),[g,v]=yo(h),x=wo(),[w,b]=p.useState(null),S=je(t,h?g:null,R(y=>d({type:8,element:y})),b),M=Ds(u.itemsElement);h&&(l=!0);let I=Fs(),[k,N]=Os(m,w,I!==null?(I&ke.Open)===ke.Open:u.menuState===0);Ls(k,u.buttonElement,()=>{d({type:1})});let C=u.__demoMode?!1:c&&u.menuState===0;Ws(C,M);let E=u.__demoMode?!1:c&&u.menuState===0;Bs(E,{allowed:p.useCallback(()=>[u.buttonElement,u.itemsElement],[u.buttonElement,u.itemsElement])});let B=u.menuState!==0,O=Hs(B,u.buttonElement)?!1:k;p.useEffect(()=>{let y=u.itemsElement;y&&u.menuState===0&&y!==M?.activeElement&&y.focus({preventScroll:!0})},[u.menuState,u.itemsElement,M]),Us(u.menuState===0,{container:u.itemsElement,accept(y){return y.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:y.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(y){y.setAttribute("role","none")}});let L=zt(),re=R(y=>{var de,H,K;switch(L.dispose(),y.key){case P.Space:if(u.searchQuery!=="")return y.preventDefault(),y.stopPropagation(),d({type:3,value:y.key});case P.Enter:if(y.preventDefault(),y.stopPropagation(),d({type:1}),u.activeItemIndex!==null){let{dataRef:be}=u.items[u.activeItemIndex];(H=(de=be.current)==null?void 0:de.domRef.current)==null||H.click()}Qt(u.buttonElement);break;case P.ArrowDown:return y.preventDefault(),y.stopPropagation(),d({type:2,focus:D.Next});case P.ArrowUp:return y.preventDefault(),y.stopPropagation(),d({type:2,focus:D.Previous});case P.Home:case P.PageUp:return y.preventDefault(),y.stopPropagation(),d({type:2,focus:D.First});case P.End:case P.PageDown:return y.preventDefault(),y.stopPropagation(),d({type:2,focus:D.Last});case P.Escape:y.preventDefault(),y.stopPropagation(),Q.flushSync(()=>d({type:1})),(K=u.buttonElement)==null||K.focus({preventScroll:!0});break;case P.Tab:y.preventDefault(),y.stopPropagation(),Q.flushSync(()=>d({type:1})),$s(u.buttonElement,y.shiftKey?wt.Previous:wt.Next);break;default:y.key.length===1&&(d({type:3,value:y.key}),L.setTimeout(()=>d({type:4}),350));break}}),J=R(y=>{switch(y.key){case P.Space:y.preventDefault();break}}),Se=p.useMemo(()=>({open:u.menuState===0}),[u.menuState]),ue=Gt(h?x():{},{"aria-activedescendant":u.activeItemIndex===null||(n=u.items[u.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(s=u.buttonElement)==null?void 0:s.id,id:o,onKeyDown:re,onKeyUp:J,role:"menu",tabIndex:u.menuState===0?0:void 0,ref:S,style:{...f.style,...v,"--button-width":Ks(u.buttonElement,!0).width},...qs(N)});return ee.createElement(zs,{enabled:l?e.static||k:!1},ae({ourProps:ue,theirProps:f,slot:Se,defaultTag:Do,features:Fo,visible:O,name:"Menu.Items"}))}let Lo=p.Fragment;function Wo(e,t){let n=p.useId(),{id:s=`headlessui-menu-item-${n}`,disabled:a=!1,...o}=e,[i,l]=Pe("Menu.Item"),c=i.activeItemIndex!==null?i.items[i.activeItemIndex].id===s:!1,m=p.useRef(null),f=je(t,m);Y(()=>{if(!i.__demoMode&&i.menuState===0&&c&&i.activationTrigger!==0)return Vs().requestAnimationFrame(()=>{var E,B;(B=(E=m.current)==null?void 0:E.scrollIntoView)==null||B.call(E,{block:"nearest"})})},[i.__demoMode,m,c,i.menuState,i.activationTrigger,i.activeItemIndex]);let h=Gs(m),u=p.useRef({disabled:a,domRef:m,get textValue(){return h()}});Y(()=>{u.current.disabled=a},[u,a]),Y(()=>(l({type:5,id:s,dataRef:u}),()=>l({type:6,id:s})),[u,s]);let d=R(()=>{l({type:1})}),g=R(E=>{if(a)return E.preventDefault();l({type:1}),Qt(i.buttonElement)}),v=R(()=>{if(a)return l({type:2,focus:D.Nothing});l({type:2,focus:D.Specific,id:s})}),x=Qs(),w=R(E=>{x.update(E),!a&&(c||l({type:2,focus:D.Specific,id:s,trigger:0}))}),b=R(E=>{x.wasMoved(E)&&(a||c||l({type:2,focus:D.Specific,id:s,trigger:0}))}),S=R(E=>{x.wasMoved(E)&&(a||c&&l({type:2,focus:D.Nothing}))}),[M,I]=Yt(),[k,N]=Ys(),C=p.useMemo(()=>({active:c,focus:c,disabled:a,close:d}),[c,a,d]);return ee.createElement(I,null,ee.createElement(N,null,ae({ourProps:{id:s,ref:f,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-labelledby":M,"aria-describedby":k,disabled:void 0,onClick:g,onFocus:v,onPointerEnter:w,onMouseEnter:w,onPointerMove:b,onMouseMove:b,onPointerLeave:S,onMouseLeave:S},theirProps:o,slot:C,defaultTag:Lo,name:"Menu.Item"})))}let Bo="div";function Ho(e,t){let[n,s]=Yt();return ee.createElement(s,null,ae({ourProps:{ref:t,"aria-labelledby":n,role:"group"},theirProps:e,slot:{},defaultTag:Bo,name:"Menu.Section"}))}let Uo="header";function $o(e,t){let n=p.useId(),{id:s=`headlessui-menu-heading-${n}`,...a}=e,o=Js();Y(()=>o.register(s),[s,o.register]);let i={id:s,ref:t,role:"presentation",...o.props};return ae({ourProps:i,theirProps:a,slot:{},defaultTag:Uo,name:"Menu.Heading"})}let Ko="div";function qo(e,t){return ae({ourProps:{ref:t,role:"separator"},theirProps:e,slot:{},defaultTag:Ko,name:"Menu.Separator"})}let zo=se(Ro),Vo=se(No),Go=se(Oo),Qo=se(Wo),Yo=se(Ho),Jo=se($o),Xo=se(qo),fe=Object.assign(zo,{Button:Vo,Items:Go,Item:Qo,Section:Yo,Heading:Jo,Separator:Xo});function Zo({show:e,appear:t,children:n}){return r.jsx(Zs,{as:p.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",show:e,appear:t,children:n})}const bn=new oe("transactionEventPlugin"),Ze="prosemirrorDispatchTransaction";function _t(e,t){const{eventTarget:n}=bn.getState(e.state);return n.addEventListener(Ze,t),()=>{n.removeEventListener(Ze,t)}}function er(e){return new le({key:bn,state:{init(){return{eventTarget:e}},apply(t,n){return n}}})}const ye=new oe("customKeymapPlugin");function tr(e,t){e.dispatch(e.state.tr.setMeta(ye,{handlers:t}))}function nr(e={handlers:{}}){return new le({key:ye,state:{init(){return{...e}},apply(t,n){const s=t.getMeta(ye);return s?{...n,...s}:n}},props:{handleKeyDown(t,n){const a=ye.getState(t.state).handlers[n.key];return a?a(n):!1}}})}const X=new oe("menuSelectorPlugin");function Nt(e){e.dispatch(e.state.tr.setMeta(X,{active:!1,onMenuAction:void 0}))}function ii(e,t){e.dispatch(e.state.tr.setMeta(X,{active:!0,onMenuAction:t}))}function sr(e={submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}){return new le({key:X,state:{init(){return{...e,active:!1}},apply(t,n){const s=t.getMeta(X);return s?{...n,...s}:n}},props:{handleKeyDown(t,n){const s=X.getState(t.state);return s.active?s.submitKeys.includes(n.key)?(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),Nt(t),s.onMenuAction?.("submit")??!0):s.cancelKeys.includes(n.key)?(n.preventDefault(),s.onMenuAction?.("cancel"),Nt(t),!0):n.key==="ArrowUp"?(n.preventDefault(),s.onMenuAction?.("up"),!0):n.key==="ArrowDown"?(n.preventDefault(),s.onMenuAction?.("down"),!0):s.checkStrictMatchKeys.includes(n.key)&&s.onMenuAction?.("checkMatch")?(n.preventDefault(),!0):!1:!1},handleDOMEvents:{blur:t=>{X.getState(t.state).onMenuAction?.("cancel")}}}})}const pe=new oe("placeholderPlugin");function ar(e){return new le({key:pe,state:{init(){return{placeholder:e}},apply(t,n){return t.getMeta(pe)?{placeholder:t.getMeta(pe).placeholder}:n}},props:{decorations(t){const{doc:n}=t;if(n.childCount===1&&n.firstChild?.isTextblock&&n.firstChild.content.size===0){const a=[],{placeholder:o}=pe.getState(t);return t.doc.descendants((i,l)=>{const c=Wa.node(l,l+i.nodeSize,{class:"placeholder","data-placeholder":o});a.push(c)}),Ba.create(n,a)}}}})}const ge="command_token",or={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:e=>["span",{"data-mention-id":e.attrs.id,"data-mention-hint":e.attrs.hint,class:"hint-pill"},e.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:e=>{const t=e.getAttribute("data-mention-id"),n=e.getAttribute("data-mention-hint");return{id:t,hint:n}}}]};function wn(e,t){if(e.depth===0)return;const n=e.nodeBefore?.text?.match(/(?:^|\s)(\/(\w*))$/);if(n?.[1].length!==void 0){const s=e.pos-n[1].length,a=e.pos,o=s===t?.from;return{range:{from:s,to:a},queryText:n[2],isDismissed:o}}}const et=new oe("systemHintPlugin");function yn(e,t){return e.setMeta(et,t),e}function li(e){const n=e.state.selection.$from,s=wn(n,void 0);e.dispatch(yn(e.state.tr,{...Ee(),dismissedRange:s?.range}))}function Ee(){return{queryText:"",active:!1,range:void 0,dismissedRange:void 0}}function rr(e,t,n,s,a){const o=e.state.tr;yn(o,Ee());const i=n+" ",l=e.state.schema.nodes[ge].create({id:t,hint:i},e.state.schema.text(i));if(a===s){const c=o.doc.resolve(s).nodeAfter;if(c?.isText){const m=c?.textContent.match(new RegExp(`^(?:${n}) ?`));m&&(a=s+m[0].length)}}o.replaceWith(s,a,l),o.doc.descendants((c,m)=>{c.type.name===ge&&c!==l&&(s===1&&m===s+l.nodeSize||m===1&&s===m+c.nodeSize?o.delete(m,m+c.nodeSize):o.insertText(c.textContent,m,m+c.nodeSize))}),e.dispatch(o)}function ir(e){const t=e.state.tr;t.doc.descendants((n,s)=>{if(n.type.name===ge){const a=s+n.nodeSize;s===1&&t.doc.resolve(a).nodeAfter==null?t.delete(s,a):t.insertText(n.textContent,s,s+n.nodeSize)}}),t.steps.length>0&&e.dispatch(t)}function Dt(e){const{active:t,range:n,queryText:s,onHintMatch:a}=e;if(a)return a(!t||!n?void 0:{text:s,range:n})}function lr(e){const t=[];return e.descendants(n=>{n.type.name===ge&&typeof n.attrs?.id=="string"&&t.push(n.attrs.id)}),t}function cr(){return new le({key:et,state:{init(){return Ee()},apply(e,t,n,s){const a=e.getMeta(et),o={...Ee(),...t,...a},i=e.selection;if(i.from!==i.to||s.doc.eq(n.doc))return Dt(o),o;const l=i.$from,c=wn(l,t.dismissedRange);return o.active=!!c&&!c.isDismissed,c&&(o.queryText=c.queryText,o.range=c.range,c.isDismissed&&(c.queryText===""&&t.queryText!==""?o.dismissedRange=void 0:o.dismissedRange=c.range)),Dt(o),o}}})}class Mn extends ea{constructor(t){super(),this.view=t}_usedDictation=!1;get usedDictation(){return this._usedDictation}set usedDictation(t){this._usedDictation=t}get element(){return this.view.dom}get document(){return this.view.dom.ownerDocument}isEmpty(){return this.view.state.doc.textContent.trim().length===0}trimLeadingText(t){const s=this.view.state.tr;let a=0;return s.doc.descendants((o,i)=>{if(o.isText&&o.text){if(typeof t=="string"&&o.text.startsWith(t))a=t.length;else if(t instanceof RegExp){const l=o.text.match(t);l?.index===0&&(a=l[0].length)}if(a){const l=o.text.substring(a).trimStart();a=o.text.length-l.length,s.delete(i,i+a)}}return!o.isLeaf}),a>0?(this.view.dispatch(s),!0):!1}replaceAll(t,n){const a=this.view.state.tr,o=[];a.doc.descendants((i,l)=>{!i.isText||i.text===void 0||o.push({node:i,pos:l})}),o.reverse(),o.forEach(({node:i,pos:l})=>{!i.isText||i.text===void 0||i.text.includes(t)&&a.insertText(i.text.replaceAll(t,n),l,l+i.text.length)}),this.view.dispatch(a)}appendText(t){this.view.dispatch(this.view.state.tr.insertText(t))}delete(t,n){this.view.dispatch(this.view.state.tr.delete(t,n))}focus(){this.view.hasFocus()||(this.view.focus(),this.view.dispatch(this.view.state.tr.setSelection(Ye.atEnd(this.view.state.doc)).scrollIntoView()))}setText(t){const{tr:n,schema:s}=this.view.state,a=t?s.nodes.paragraph.create(null,s.text(t)):s.nodes.paragraph.create();this.view.dispatch(n.replaceWith(0,this.view.state.doc.content.size,a)),this.view.hasFocus()&&this.view.dispatch(this.view.state.tr.setSelection(Ye.atEnd(this.view.state.doc)))}getContentLength(){return this.view.state.doc.content.size}getCurrentText(){return this.view.state.doc.textContent}hasMultipleLines(){let t=0;return this.view.state.doc.descendants(n=>{n.isBlock&&t++}),t>1}getContentToSend(){return Ha(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(t){this.view.dispatch(this.view.state.tr.setMeta(pe,{placeholder:t}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}isMenuSelectorActive(){return X.getState(this.view.state).active}registerKeyHandlers(t){tr(this.view,t)}acceptLegacyKeydown(){return!1}subscribe(t,n){if(t==="change"){const s=()=>n(void 0);return _t(this.view,s)}return this.view.dom?.addEventListener(t,n,{capture:!0}),()=>{this.view.dom?.removeEventListener(t,n,{capture:!0})}}useState(t){return p.useSyncExternalStore(n=>_t(this.view,n),()=>t(this),()=>t(this))}getSystemHints(){const t=lr(this.view.state.tr.doc)[0];return t?[t]:[]}addSystemHint(t,n,s=1,a=1){rr(this.view,t,n,s,a)}removeSystemHints(){ir(this.view)}canShowAutocompletion(){return!this.isMenuSelectorActive()&&!this.getSystemHints().length}}const ur=500;class W{constructor(t,n){this.items=t,this.eventCount=n}popEvent(t,n){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let a,o;n&&(a=this.remapping(s,this.items.length),o=a.maps.length);let i=t.tr,l,c,m=[],f=[];return this.items.forEach((h,u)=>{if(!h.step){a||(a=this.remapping(s,u+1),o=a.maps.length),o--,f.push(h);return}if(a){f.push(new U(h.map));let d=h.step.map(a.slice(o)),g;d&&i.maybeStep(d).doc&&(g=i.mapping.maps[i.mapping.maps.length-1],m.push(new U(g,void 0,void 0,m.length+f.length))),o--,g&&a.appendMap(g,o)}else i.maybeStep(h.step);if(h.selection)return l=a?h.selection.map(a.slice(o)):h.selection,c=new W(this.items.slice(0,s).append(f.reverse().concat(m)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:i,selection:l}}addTransform(t,n,s,a){let o=[],i=this.eventCount,l=this.items,c=!a&&l.length?l.get(l.length-1):null;for(let f=0;f<t.steps.length;f++){let h=t.steps[f].invert(t.docs[f]),u=new U(t.mapping.maps[f],h,n),d;(d=c&&c.merge(u))&&(u=d,f?o.pop():l=l.slice(0,l.length-1)),o.push(u),n&&(i++,n=void 0),a||(c=u)}let m=i-s.depth;return m>mr&&(l=dr(l,m),i-=m),new W(l.append(o),i)}remapping(t,n){let s=new Ua;return this.items.forEach((a,o)=>{let i=a.mirrorOffset!=null&&o-a.mirrorOffset>=t?s.maps.length-a.mirrorOffset:void 0;s.appendMap(a.map,i)},t,n),s}addMaps(t){return this.eventCount==0?this:new W(this.items.append(t.map(n=>new U(n))),this.eventCount)}rebased(t,n){if(!this.eventCount)return this;let s=[],a=Math.max(0,this.items.length-n),o=t.mapping,i=t.steps.length,l=this.eventCount;this.items.forEach(u=>{u.selection&&l--},a);let c=n;this.items.forEach(u=>{let d=o.getMirror(--c);if(d==null)return;i=Math.min(i,d);let g=o.maps[d];if(u.step){let v=t.steps[d].invert(t.docs[d]),x=u.selection&&u.selection.map(o.slice(c+1,d));x&&l++,s.push(new U(g,v,x))}else s.push(new U(g))},a);let m=[];for(let u=n;u<i;u++)m.push(new U(o.maps[u]));let f=this.items.slice(0,a).append(m).append(s),h=new W(f,l);return h.emptyItemCount()>ur&&(h=h.compress(this.items.length-s.length)),h}emptyItemCount(){let t=0;return this.items.forEach(n=>{n.step||t++}),t}compress(t=this.items.length){let n=this.remapping(0,t),s=n.maps.length,a=[],o=0;return this.items.forEach((i,l)=>{if(l>=t)a.push(i),i.selection&&o++;else if(i.step){let c=i.step.map(n.slice(s)),m=c&&c.getMap();if(s--,m&&n.appendMap(m,s),c){let f=i.selection&&i.selection.map(n.slice(s));f&&o++;let h=new U(m.invert(),c,f),u,d=a.length-1;(u=a.length&&a[d].merge(h))?a[d]=u:a.push(h)}}else i.map&&s--},this.items.length,0),new W(Jt.from(a.reverse()),o)}}W.empty=new W(Jt.empty,0);function dr(e,t){let n;return e.forEach((s,a)=>{if(s.selection&&t--==0)return n=a,!1}),e.slice(n)}class U{constructor(t,n,s,a){this.map=t,this.step=n,this.selection=s,this.mirrorOffset=a}merge(t){if(this.step&&t.step&&!t.selection){let n=t.step.merge(this.step);if(n)return new U(n.getMap().invert(),n,this.selection)}}}class G{constructor(t,n,s,a,o){this.done=t,this.undone=n,this.prevRanges=s,this.prevTime=a,this.prevComposition=o}}const mr=20;function pr(e,t,n,s){let a=n.getMeta(te),o;if(a)return a.historyState;n.getMeta(hr)&&(e=new G(e.done,e.undone,null,0,-1));let i=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(i&&i.getMeta(te))return i.getMeta(te).redo?new G(e.done.addTransform(n,void 0,s,Me(t)),e.undone,Ft(n.mapping.maps),e.prevTime,e.prevComposition):new G(e.done,e.undone.addTransform(n,void 0,s,Me(t)),null,e.prevTime,e.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),c=e.prevTime==0||!i&&e.prevComposition!=l&&(e.prevTime<(n.time||0)-s.newGroupDelay||!fr(n,e.prevRanges)),m=i?$e(e.prevRanges,n.mapping):Ft(n.mapping.maps);return new G(e.done.addTransform(n,c?t.selection.getBookmark():void 0,s,Me(t)),W.empty,m,n.time,l??e.prevComposition)}else return(o=n.getMeta("rebased"))?new G(e.done.rebased(n,o),e.undone.rebased(n,o),$e(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new G(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),$e(e.prevRanges,n.mapping),e.prevTime,e.prevComposition)}function fr(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((s,a)=>{for(let o=0;o<t.length;o+=2)s<=t[o+1]&&a>=t[o]&&(n=!0)}),n}function Ft(e){let t=[];for(let n=e.length-1;n>=0&&t.length==0;n--)e[n].forEach((s,a,o,i)=>t.push(o,i));return t}function $e(e,t){if(!e)return null;let n=[];for(let s=0;s<e.length;s+=2){let a=t.map(e[s],1),o=t.map(e[s+1],-1);a<=o&&n.push(a,o)}return n}function gr(e,t,n){let s=Me(t),a=te.get(t).spec.config,o=(n?e.undone:e.done).popEvent(t,s);if(!o)return null;let i=o.selection.resolve(o.transform.doc),l=(n?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),a,s),c=new G(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(i).setMeta(te,{redo:n,historyState:c})}let Ke=!1,Ot=null;function Me(e){let t=e.plugins;if(Ot!=t){Ke=!1,Ot=t;for(let n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){Ke=!0;break}}return Ke}const te=new oe("history"),hr=new oe("closeHistory");function vr(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new le({key:te,state:{init(){return new G(W.empty,W.empty,null,0,-1)},apply(t,n,s){return pr(n,s,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,n){let s=n.inputType,a=s=="historyUndo"?In:s=="historyRedo"?tt:null;return a?(n.preventDefault(),a(t.state,t.dispatch)):!1}}}})}function Cn(e,t){return(n,s)=>{let a=te.getState(n);if(!a||(e?a.undone:a.done).eventCount==0)return!1;if(s){let o=gr(a,n,e);o&&s(t?o.scrollIntoView():o)}return!0}}const In=Cn(!1,!0),tt=Cn(!0,!0);function xr(){return Je({"Shift-Enter":(e,t)=>It(e,t),Enter:(e,t)=>window.innerWidth>Gn[Qn.Medium]||Yn?!1:It(e,t)})}const Sr=["p",0],br=["br"],wr=new $a({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM(){return Sr}},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return br}},[ge]:or,doc:{content:"block+"}},marks:{}});function yr(){const e=new EventTarget,t=new Ka(null,{state:qa.create({schema:wr,plugins:[vr(),sr(),ar(""),cr(),xr(),Je({"Mod-z":In,"Mod-y":tt,"Mod-Shift-z":tt}),nr(),Je(za),er(e),Va()]}),dispatchTransaction(n){const s=t.state.apply(n);t.updateState(s),n.docChanged&&e.dispatchEvent(new Event(Ze))},handlePaste(n,s){const a=s.clipboardData?.getData("text/plain");return a===void 0?!1:(s.defaultPrevented||Ga(n,a),!0)},clipboardTextSerializer(n){return Qa(n.content).content}});return t}function Mr(){try{return navigator.userAgent.toLocaleLowerCase().includes("firefox")}catch{return!1}}function Cr(){try{const e=navigator.userAgent.toLocaleLowerCase();return e.includes("safari")&&!e.includes("chrome")&&!e.includes("firefox")}catch{return!1}}const Ir=[_([ta["prosemirror-parent"],"text-token-text-primary","max-h-[25dvh]","max-h-52","overflow-auto",Mr()?"firefox":"default-browser"])],nt=p.createContext(null),kr=({children:e,clientThreadId:t})=>{const n=p.useContext(nt),s=p.useMemo(()=>n??new Mn(yr()),[n,t]);return r.jsx(nt.Provider,{value:s,children:e})},ci=()=>es(p.useContext(nt)),ui=({composerController:e,placeholder:t})=>{const n=p.useContext(Jn),s=p.useRef(null),a=p.useRef(null),{isMobileOS:o}=Xn(),i=ne(),l=p.useRef(!1);return p.useEffect(()=>{if(l.current)return;if(!(e instanceof Mn))throw new Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);l.current=!0;const c=a.current;if(c!=null){const{value:m,selectionStart:f,selectionEnd:h}=c;e.view.dispatch(e.view.state.tr.insertText(m)),e.view.dispatch(e.view.state.tr.setSelection(Ye.create(e.view.state.doc,f+1,h+1))),c.style.display="none",c.value=""}s.current.appendChild(e.view.dom),e.view.dom.id=Fa,e.view.dom.dataset.virtualkeyboard="true",Oa(e.view.dom),!Zn()&&!Cr()&&requestAnimationFrame(()=>{e.view.focus()})},[e]),p.useEffect(()=>{e.setPlaceholder(t)},[t,e]),p.useEffect(()=>{e.logPageMount()},[]),r.jsxs("div",{ref:s,className:_(Ir),children:[r.jsx("textarea",{className:"block h-10 w-full resize-none border-0 bg-transparent px-0 py-2 text-token-text-primary placeholder:text-token-text-secondary",autoFocus:!i&&!o,placeholder:t,ref:a,"data-virtualkeyboard":!0}),r.jsx("script",{nonce:n.cspScriptNonce,suppressHydrationWarning:!0,children:"window.__oai_logHTML?window.__oai_logHTML():window.__oai_SSR_HTML=window.__oai_SSR_HTML||Date.now();requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI||Date.now()}))"})]})},Er=ot(()=>rt(()=>import("./nco63z16utqrw1ij.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>e.CAFeedbackModal));function Tr({clientThreadId:e,currentModelId:t,defaultModelId:n,onThreadCreated:s,preRequestCompletion:a}){const o=na(),{isUnauthenticated:i}=he(),l=p.useCallback(x=>{const b=ie.getTree(me(e)).getLeafFromNode(x);Fe.setThreadCurrentLeafId(e,b.id)},[e]),c=sa(t),[m,f]=p.useState(),h=p.useCallback(({nodeId:x,messageId:w,rating:b})=>{const S=ts(e);A.logEvent(F.thumbRating,{id:w,threadId:S,rating:b,model:t});const M=ie.getTree(me(e)),I=M.getNodeByIdOrMessageId(x);if(S!==void 0&&!c&&ns.submitMessageFeedback({message_id:w,conversation_id:S,rating:b}),Fe.updateTree(e,k=>{k.updateNodeMetadata(x,{rating:b})}),c){f(r.jsx(Er,{citations:I.message.metadata?.citations??[],rating:b,conversationId:S??"",messageId:w,onSubmit:()=>{f(void 0)},onCancel:()=>f(void 0),conversationTree:M,nodeId:x},`${x}-${b}`));return}},[e,t,c]),u=La({clientThreadId:e,onCreate:s}),d=p.useCallback(()=>{const x=Fe.getThreadCurrentLeafId(e);if(x==null)return;const b=ie.getTree(me(e)).getBranchFromLeaf(x);ss.abortRequests(b.map(S=>S.id))},[e]),g=p.useCallback(async({prependMessages:x,appendMessages:w,cancelActiveRequests:b,completionMetadata:S,eventMetadata:M,extraStreamParams:I,promptId:k,requestedModelId:N,turnTracker:C,profiler:E,type:B,useDefaultModel:O})=>{aa(),oa.reset(),b&&d();let L=t;N?L=N:O&&(L=n),a?.(e,k),await u({model:L,completionType:B,parentNodeId:k,metadata:M,completionMetadata:S,extraStreamParams:{forceParagen:o.forceParagen,forceParagenModel:o.forceParagenModel.value,forceRateLimit:o.forceRateLimit,resetRateLimits:o.resetRateLimits,disableSystemContentToggling:o.rebaseSystemMessageContent?!0:void 0,forceUseSearch:o.forceUseSearch??I?.forceUseSearch,paragenStreamType:o.paragenStreamType,paragenCotSummaryDisplay:o.paragenCotSummaryDisplay},prependMessages:x,appendMessages:w,turnTracker:C,profiler:E}),i&&ra.incrementUserMessageCount()},[d,e,t,o,n,i,a,u]),v=p.useCallback((x,w,b,S="none",M)=>{const k=ie.getTree(me(e)).getParentPromptNode(x).id;g({type:as.Variant,promptId:k,eventMetadata:w,cancelActiveRequests:!1,useDefaultModel:M,completionMetadata:{variantPurpose:S,conversationMode:me(e)?.mode},turnTracker:b})},[e,g]);return{caModal:m,onRequestCompletion:g,onRequestMoreCompletions:v,onChangeItemInView:l,onChangeRating:h,cancelRequests:d}}function kn(){return{caModal:null,clientThreadId:"",isLoggedInUser:!1,focusedObject:null,currentModelId:"",isModelLoaded:!1,isEmbeddedInFocusedView:!1,isInstalledApp:!1,isCompanionWindow:!1,conversationLeafId:"",onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},onChangeItemInView:()=>{throw new Error("onChangeItemInView not implemented")},onChangeRating:()=>{throw new Error("onChangeRating not implemented")},onRequestMoreCompletions:()=>{throw new Error("onRequestMoreCompletions not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const En=p.createContext(kn());function Tn(){try{return p.useContext(En)}catch{return kn()}}function di({children:e,clientThreadId:t,setClientThreadId:n,routeType:s,prefetchSearch:a,preRequestCompletion:o}){const{createNewThread:i,onThreadCreated:l,resetThread:c}=ia({clientThreadId:t,setClientThreadId:n}),{data:m}=ve(),{data:f}=os(),h=la(m,f),[u,d]=Ht(t,O=>[ie.getCurrentLeafId(O),O?.modelId]),g=ca(),v=h.id,x=d??v,w=rs(),b=dt(),S=ua(),{isUnauthenticated:M}=he(),I=!M,{caModal:k,onRequestCompletion:N,onChangeItemInView:C,onChangeRating:E,onRequestMoreCompletions:B}=Tr({clientThreadId:t,currentModelId:x,defaultModelId:h.id,onThreadCreated:l,preRequestCompletion:o});return r.jsx(En.Provider,{value:{caModal:k,clientThreadId:t,currentModelId:x,isModelLoaded:!!d,isEmbeddedInFocusedView:g,isInstalledApp:b,isLoggedInUser:I,isCompanionWindow:w,focusedObject:S,conversationLeafId:u,onNewThread:i,onRequestCompletion:N,onChangeItemInView:C,onChangeRating:E,onRequestMoreCompletions:B,resetThread:c,prefetchSearch:a,routeType:s},children:r.jsx(da,{children:r.jsx(kr,{clientThreadId:t,children:e})})})}function q({onClick:e,href:t,target:n,children:s,disabled:a,icon:o,testId:i}){const l=ne();return r.jsx(fe.Item,{disabled:a,children:({active:c})=>r.jsxs(Re,{onClick:e,href:t,target:n,className:_({"bg-token-sidebar-surface-secondary":c,"hover:bg-token-sidebar-surface-secondary":!c&&!a&&!l,"hover:bg-token-main-surface-secondary":!c&&!a&&l}),"data-testid":i,children:[o&&r.jsx(o,{className:"icon-md"}),s]})})}function jr({to:e,children:t,icon:n}){return r.jsx(fe.Item,{children:({active:s})=>r.jsx(bs,{to:e,children:r.jsxs(Re,{$as:"span",className:_(s?"bg-token-sidebar-surface-secondary":"cursor-pointer"),children:[n&&r.jsx(n,{className:"icon-md"}),t]})})})}xe.a`p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer`;const Re=xe.a`flex gap-2 rounded p-2.5 text-sm cursor-pointer focus:ring-0 hover:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center`,mi=xe(Re)`border dark:border-white/20 min-h-0 hover:bg-gray-500/10 h-10 rounded-lg border-[rgba(0,0,0,0.1)]`,qe=xe.div`h-px bg-token-border-light my-1.5`,pi=xe(Re)`${e=>e.$active?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary"} screen-arch:px-2 screen-arch:py-1.5 screen-arch:min-h-[47px]`,Ar=ot(()=>rt(()=>import("./ktb7k5hcb3th55ru.js"),__vite__mapDeps([8,1,5,3,4,6,9,10,11,12,13,14])));function fi({onClickSettings:e}){const t=ne();return r.jsxs(fe,{as:"div",className:_(!t&&"group relative"),children:[r.jsx(Nr,{}),r.jsx(Zo,{children:r.jsx(fe.Items,{className:_("popover absolute bottom-full z-50 mb-1 overflow-hidden rounded-lg border border-token-border-light bg-token-main-surface-primary p-1.5 shadow-lg outline-none",t&&"left-3 max-h-[calc(100svh-var(--sidebar-footer-height)-var(--sidebar-header-height)-12px)] w-[var(--screen-sidebar-popover-min-width)] overflow-y-auto",!t&&"left-0 w-full"),children:r.jsx(_r,{onClickSettings:e})})})]})}function jn({currentAccount:e}){const t=!e.isEnterprisey(),n=V(),s=Ae(),a=it();return s?r.jsxs("div",{className:"flex items-center justify-between gap-2 py-2 pl-5 pr-4",children:[s?.email&&r.jsx("div",{className:"text-sm text-token-text-secondary",children:s?.email}),t&&r.jsx(Z,{label:n.formatMessage($.addWorkspaceTooltip),side:"right",children:r.jsx("button",{onClick:()=>un(a,"profile menu"),children:r.jsx(Sa,{className:"icon-sm text-token-text-primary"})})})]}):null}function Pr({currentAccount:e}){return r.jsxs(r.Fragment,{children:[r.jsx(jn,{currentAccount:e}),r.jsx("div",{className:"flex h-11 w-full items-center justify-start gap-3 px-3 py-1 text-sm",children:r.jsx(Pn,{workspace:e,isLoading:!1,currentWorkspaceId:e.id,showCheck:!1})})]})}function An({menuItemComponent:e}){const t=Xt(),n=ws(),{data:s}=ve(),a=Te(s),[o,i]=p.useState(!1),l=Ae(),c=V(),m=is();if(!a||!s)return null;const f=a.isWorkspaceAccount(),h=s.accountItems.length>1,u=s.accountItems,d=ls([u.find(v=>v.isPersonalAccount()),...u.filter(v=>!v.isPersonalAccount())]);if(d.sort((v,x)=>v.isPersonalAccount()?1:x.isPersonalAccount()?-1:0),!h)return f?r.jsx(Pr,{currentAccount:a}):l?.email&&r.jsx("div",{className:"ml-3 mr-2 py-2 text-sm text-token-text-secondary",children:l?.email});const g=d.map(v=>r.jsx(e,{disabled:v.isDeactivated(),onClick:()=>{if(v.isDeactivated()||v.id===a?.id)return;i(!0);const{willRedirect:x}=cs(n,v.id,t,c,m);x||us()},className:"radix-disabled:pointer-events-auto radix-disabled:hover:bg-transparent",children:v.isDeactivated()?r.jsx(Rr,{workspace:v,isLoading:o}):r.jsx(Pn,{workspace:v,isLoading:o,currentWorkspaceId:a?.id})},v.id));return r.jsxs(r.Fragment,{children:[r.jsx(jn,{currentAccount:a}),r.jsx(j.Separator,{}),g]})}function Pn({workspace:e,isLoading:t,currentWorkspaceId:n,showCheck:s=!0}){const a=e.canAccessWithCurrentSession,o=!t&&s&&e.id===n;return r.jsxs("div",{children:[r.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[r.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:r.jsx(mt,{iconSize:"small",workspace:e,className:_({"flex-shrink-0":!0})})}),r.jsx("div",{className:"line-clamp-1 text-token-text-primary",children:Zt(V(),e)}),t&&r.jsx(Ge,{}),o&&r.jsx("span",{className:"text-token-text-primary",children:r.jsx(ds,{className:"icon-sm"})}),!a&&r.jsx("span",{className:"text-token-text-primary",children:r.jsx(ms,{className:"icon-sm"})})]}),!a&&r.jsx("div",{className:"rowDivClassName",children:r.jsx("small",{className:"text-token-text-secondary",children:r.jsx(T,{...e.ssoConnectionName?$.authenticateWithSSOToAccessWorkspace:$.authenticateWithoutSSOToAccessWorkspace})})})]})}function Rr({workspace:e,isLoading:t}){const n=V(),s=e.isOwnerOfAccount(),[a,o]=p.useState(!1),i=ma(e.id),l=e.mustGetSubscriptionBillingCurrency("DeactivatedWorkspaceMenuItem");return p.useEffect(()=>{i!=null&&a&&(z.setPurchaseWorkspaceData({minimumSeats:Math.max(i,yt),billingDetails:{currency:l},existingAccount:e}),o(!1))},[i,a,e,l]),r.jsxs(r.Fragment,{children:[r.jsxs(Z,{className:"flex w-full flex-1 items-center gap-2.5",label:n.formatMessage($.disabledWorkspaceTooltip),sideOffset:20,side:"right",children:[r.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:r.jsx(pa,{className:"icon-sm flex-shrink-0 opacity-30"})}),r.jsx("div",{className:"truncate opacity-30",children:Zt(n,e)})]}),t&&r.jsx(Ge,{}),!t&&r.jsxs(j.Root,{children:[r.jsx(j.Trigger,{className:"rounded text-center hover:bg-token-main-surface-secondary",children:r.jsx(fa,{className:"icon-sm m-1"})}),r.jsx(j.Portal,{children:r.jsxs(j.Content,{children:[s&&r.jsx(r.Fragment,{children:r.jsx(j.Item,{onClick:()=>{i==null?o(!0):z.setPurchaseWorkspaceData({minimumSeats:Math.max(i,yt),billingDetails:{currency:l},existingAccount:e})},children:a?r.jsx(Ge,{}):r.jsx(T,{id:"navigation.reactivateWorkspace",defaultMessage:"Reactivate workspace"})})}),r.jsx(j.Item,{onClick:()=>{z.setLeaveWorkspaceData(e)},children:r.jsx(T,{id:"navigation.leaveWorkspace",defaultMessage:"Leave workspace"})})]})})]})]})}function _r({onClickSettings:e}){const t=Ae(),{data:n}=ve(),s=Te(n),a=Ut(),{clientThreadId:o}=Tn(),{isDesktopAppAvailable:i,isSidekickAvailable:l}=pt(),c=Fr(o??"none"),{openModal:m}=en(),f=ne();var h=s?.isTeam()??!1;if(!s||!n)return null;const u=s.isWorkspaceAccount(),d=!a;return r.jsxs("nav",{children:[r.jsx(An,{menuItemComponent:q}),t?.email&&r.jsx(qe,{}),u?r.jsx(nn,{menuItemComponent:q,routedMenuItemComponent:jr}):r.jsx(tn,{menuItemComponent:q}),d&&r.jsx(q,{href:ga(),target:"_blank",onClick:()=>{A.logEvent(F.clickFaqLink)},icon:ha,children:r.jsx(T,{...$.helpAndFaq})}),r.jsx(q,{onClick:e,icon:sn,testId:"accounts-settings-button",children:r.jsx(T,{...$.settings})}),h&&r.jsxs(r.Fragment,{children:[r.jsx(q,{onClick:()=>{z.openModal(an.InviteUsersToWorkspace),A.logEvent(F.accountMemberInviteButton,{location:"dropdown-menu-click"}),Ce.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:on,children:r.jsx(T,{...$.addTeammatesButton})}),r.jsx(Ar,{workspace:s})]}),(i||c)&&r.jsx(qe,{}),i&&r.jsx(Dr,{openDownloadModal:m,isSidekickAvailable:l}),c&&r.jsx(Or,{}),!f&&r.jsxs(r.Fragment,{children:[r.jsx(qe,{}),r.jsx(q,{onClick:()=>{A.logEvent(F.clickLogOut,{eventSource:"mouse"}),A.logLogOutButtonClicked({location:"account_switcher_menu"}),$t()},icon:rn,children:r.jsx(T,{...$.logOut})})]})]})}function Nr(){return Ae()?r.jsx(Lr,{}):null}function Dr({openDownloadModal:e,isSidekickAvailable:t}){return r.jsx("span",{children:r.jsx(q,{icon:ln,onClick:()=>{A.logEvent(F.accountMenuClickDownloadApp),e()},children:r.jsx(T,{...t?$.downloadMacosApp:$.downloadWindowsApp})})})}const Fr=e=>{const t=ct(e),n=ut(t,st.Search),s=dt();return n&&at()&&!s},Or=()=>r.jsx("span",{children:r.jsx(q,{icon:cn,onClick:()=>{window.open(ht),A.logEventWithStatsig(F.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:r.jsx(T,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function Lr(){const{data:e}=ve(),t=Te(e),n=va(),s=xa(),a=ne(),o=V();if(!t||!e)return null;const i=t.isWorkspaceAccount(),l=e.accountItems.length>1;return r.jsxs(fe.Button,{className:_("flex w-full max-w-[100%] items-center gap-2 rounded-lg text-sm group-ui-open:bg-token-sidebar-surface-secondary",a&&"px-2 py-1.5 hover:bg-token-main-surface-secondary",!a&&"p-2 hover:bg-token-sidebar-surface-secondary"),"data-testid":"accounts-profile-button","aria-label":o.formatMessage({id:"VYC5Ys",defaultMessage:"Open profile menu for user {userName} in workspace: {workspaceName}"},{userName:s,workspaceName:n}),children:[r.jsx("div",{className:"flex-shrink-0",style:{viewTransitionName:"var(--vt-profile-avatar-sidebar)"},children:r.jsx(mt,{iconSize:"gizmo"})}),r.jsxs("div",{className:"relative -top-px grow -space-y-px truncate text-start text-token-text-primary",children:[r.jsx("div",{dir:"auto",children:s}),i||l?r.jsx("div",{className:"truncate text-xs text-token-text-secondary",dir:"auto",children:n}):null]})]})}const $=Kt({helpAndFaq:{id:"navigation.helpAndFaq",defaultMessage:"Help & FAQ"},settings:{id:"navigation.settings",defaultMessage:"Settings"},logOut:{id:"navigation.logOut",defaultMessage:"Log out"},accountSwitcherTitle:{id:"navigation.accountSwitcherTitle",defaultMessage:"Workspaces"},defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace"},addWorkspaceTooltip:{id:"navigation.addWorkspaceTooltip",defaultMessage:"Create a Team workspace"},disabledWorkspaceTooltip:{id:"navigation.disabledWorkspaceTooltip",defaultMessage:"This workspace has been deactivated"},downloadMacosApp:{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"},downloadWindowsApp:{id:"navigation.downloadWindowsApp",defaultMessage:"Download the Windows app"},authenticateWithSSOToAccessWorkspace:{id:"CV7pdM",defaultMessage:"Authenticate with SSO to access this workspace"},authenticateWithoutSSOToAccessWorkspace:{id:"zfCWFh",defaultMessage:"Authenticate without SSO to access this workspace"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}}),Wr=ot(()=>rt(()=>import("./ktb7k5hcb3th55ru.js"),__vite__mapDeps([8,1,5,3,4,6,9,10,11,12,13,14])));function gi({showShareButton:e,showProfileDropdown:t,clientThreadId:n}){const s=gs(n),a=V(),{layer:o}=Ie("1547743984"),i=hs(n),{isUnauthenticated:l}=he(),c=!l,m=Ia(i),{onNewThread:f}=Tn(),u=Ht(n,ie.getThreadTitleSource)===vs.NewChat&&Lt(n),d=o.get("show_share_button_text",!1),g=a.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),v=ne(),x=()=>z.openSharingModal(s),w=ka(i),b=a.formatMessage({id:"1VkJAg",defaultMessage:"New chat"}),S=Wt(),M=Ea();return r.jsxs(r.Fragment,{children:[r.jsx(Ta,{}),m&&u&&r.jsx(ja,{layout:"wide",clientThreadId:n}),S?.includes("caterpillar")&&r.jsx(Aa,{}),e&&s&&r.jsx(r.Fragment,{children:d?r.jsx(Qe,{onClick:x,icon:We,label:g,"data-testid":"share-chat-button",color:"secondary",className:_(v&&"hidden @lg/thread:inline-flex","text-token-text-primary"),style:{viewTransitionName:"var(--vt_share_chat_wide_button)"},children:g}):r.jsx(Z,{label:a.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:r.jsx(gt,{"data-testid":"share-chat-button",onClick:()=>z.openSharingModal(s),icon:We,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),v&&e&&s&&r.jsx(Z,{className:_("hidden @lg/thread:!hidden md:inline-flex"),label:g,children:r.jsx(Mt,{style:{viewTransitionName:"var(--vt_share_chat_compact_button)"},className:Oe.sidebarIcon,onClick:x,icon:r.jsx(We,{}),label:g})}),v&&!w&&c&&r.jsx(Z,{className:_("@lg/thread:hidden sidebar-open-and-pinned:hidden",M&&"popover"),label:b,children:r.jsx("div",{className:Oe.sidebarIconContainer,children:r.jsx(Mt,{className:Oe.sidebarIcon,icon:r.jsx(pn,{}),onClick:()=>f(),label:b,style:{viewTransitionName:"var(--vt-new-chat-button-compact)"}})})}),u&&i&&w&&r.jsx(r.Fragment,{children:r.jsx(Pa,{gizmoId:i})}),t&&r.jsx(Hr,{clientThreadId:n})]})}function Br({to:e,children:t,icon:n}){const s=it();return r.jsx(j.Item,{icon:n,onSelect:()=>s(e),children:t})}function Hr({clientThreadId:e}){const{isUnauthenticated:t}=he();return Ct.markStart("LoginOrProfileMenu"),Ct.markRendered("LoginOrProfileMenu"),t?r.jsx(Qr,{}):r.jsx(Ur,{clientThreadId:e})}function Ur({clientThreadId:e}){const{data:t}=ve(),n=Te(t),s=n?.isPlus()??!1,a=n?.isWorkspaceAccount()??!1,{openSettings:o}=ba(),{isDesktopAppAvailable:i}=pt(),l=qr(e??"none"),{openModal:c}=en(),m=ne(),f=ft(I=>!I.isDesktopNavCollapsed),{layer:h}=Ie("2888142241"),u=V();var d=n?.isTeam()??!1;const g=t&&ps(t),{layer:v}=Ie("2670443078"),{useStore:x}=wa(),w=x(I=>m&&I.isSidebarOpen);if(!n||!t)return null;const b=t.accountItems.length>1;let S=!1;!a&&!s&&g&&v.get("is_gating_fix_enabled",!1)&&(S=g);const M=!a&&!S&&h.get("is_upgrade_in_settings",!1);return r.jsxs(fs,{contentClassName:_(m&&"max-w-[256px] min-w-[256px] w-[256px]"),triggerButton:r.jsx("button",{onClick:()=>{A.logEvent(F.accountOpenProfileMenu),Ce.logEvent("chatgpt_account_open_profile_menu")},"aria-label":u.formatMessage({id:"wz2MQV",defaultMessage:"Open Profile Menu"}),"data-testid":"profile-button",style:{"--legacy-sidebar-offset":f?"260px":""},className:_("flex h-10 w-10 items-center justify-center rounded-full hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary focus-visible:outline-0",m&&"[display:var(--account-settings-move-display,flex)]",m&&!w&&"[--account-settings-move-display:none] sm:[--account-settings-move-display:flex]",m&&w&&"[--account-settings-move-display:none]"),children:r.jsx(mt,{iconSize:"medium"})}),children:[b&&r.jsx(An,{menuItemComponent:j.Item}),b?r.jsx(j.Separator,{}):null,a?r.jsx(nn,{menuItemComponent:j.Item,routedMenuItemComponent:Br}):r.jsx(tn,{menuItemComponent:j.Item}),r.jsx(j.Item,{icon:sn,onClick:()=>o(),"data-testid":"settings-menu-item",children:r.jsx(T,{defaultMessage:"Settings",id:"navigation.settings.0"})}),r.jsx(j.Separator,{}),d&&r.jsxs(r.Fragment,{children:[r.jsx(j.Item,{"data-testid":"settings-menu-item-invite-teammates",onClick:()=>{z.openModal(an.InviteUsersToWorkspace),A.logEvent(F.accountMemberInviteButton,{eventSource:"mouse",location:"profile_drop_down"}),Ce.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:on,children:r.jsx(T,{...Rn.addTeammatesButton})}),r.jsx(Wr,{workspace:n})]}),i&&r.jsx(Kr,{openDownloadModal:c}),M&&r.jsx(Vr,{currentAccount:n}),l&&r.jsx(zr,{}),!m&&r.jsxs(r.Fragment,{children:[(M||i||l)&&r.jsx(j.Separator,{}),r.jsx(j.Item,{onClick:()=>{A.logEvent(F.clickLogOut,{eventSource:"mouse"}),A.logLogOutButtonClicked({location:"profile_drop_down"}),$t()},"data-testid":"log-out-menu-item",icon:rn,children:r.jsx(T,{defaultMessage:"Log out",id:"navigation.logOut.0"})})]})]})}function $r({onClick:e,className:t,testId:n}){const s=V(),a=xs(),o=a?s.formatMessage({id:"yqd/J5",defaultMessage:"Clear chat"}):s.formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return r.jsx(Z,{sideOffset:4,label:o,className:_("flex",t),children:r.jsx(gt,{onClick:()=>{z.closePopoverNavSidebar(),e()},icon:a?Ra:pn,"aria-label":o,"data-testid":n})})}function hi({clientThreadId:e,hideNewChat:t=!1}){const[n]=ft(o=>[o.activeStageSidebar]),s=dn(),a=ya({clientThreadId:e,location:"Navigation actions"});return!s&&!n?null:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Gr,{}),!t&&r.jsx($r,{onClick:a})]})}function Kr({openDownloadModal:e}){const{isSidekickAvailable:t}=pt();return r.jsx("span",{children:r.jsx(j.Item,{icon:ln,onClick:()=>{e(),A.logEvent(F.accountMenuClickDownloadApp)},children:t?r.jsx(T,{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"}):r.jsx(T,{id:"navigation.downloadWindowsApp",defaultMessage:"Download the Windows app"})})})}const qr=e=>{const t=ct(e),n=ut(t,st.Search),s=dt();return n&&at()&&!s},zr=()=>r.jsx("span",{children:r.jsx(j.Item,{icon:cn,onClick:()=>{window.open(ht),A.logEventWithStatsig(F.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:r.jsx(T,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function Vr({currentAccount:e}){const t=it(),n=e?.hasPaidSubscription(),s=e?.isPlus(),a=e?.isWorkspacePlan(),o=e?.data.subscriptionStatus.planType;if(n&&!s&&!a)return null;const i=()=>{Ce.logEvent("chatgpt_upgrade_in_settings_menu_clicked",null,{current_plan_type:o??"unknown"}),A.logEvent(F.upgradeInSettingsMenuClicked,{planType:o??"unknown"}),un(t,"Upper right settings menu")};return r.jsx(j.Item,{icon:Ma,onClick:i,children:r.jsx(T,{id:"navigation.upgradePlan",defaultMessage:"Upgrade Plan"})})}function Gr(){const e=V(),[t]=ft(i=>[i.activeStageSidebar]),n=dn(),s=Ut(),{isUnauthenticated:a}=he(),o=Ca();return!t&&!n||!s||a?null:r.jsx(Z,{label:e.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:r.jsx(gt,{"aria-label":e.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:z.toggleNavSidebar,icon:o?Yr:mn})})}function Qr(){const e=Xt(),t=_a(),n=Na(Rn.signUpCta),{layer:s}=Ie("3637408529"),a=s.get("is_desktop_primary_auth_button_on_right",!1),o=()=>{e({authType:"login",callback:f=>{A.logLogInButtonClicked({location:"Chat header",provider:f})}})},i=()=>{e({authType:"signup",callback:f=>{A.logSignUpButtonClicked({location:"Chat header",provider:f})}})},l=r.jsx(Qe,{onClick:o,color:t?"primary":"secondary","data-testid":"login-button",className:_(!t&&"screen-arch:hidden md:screen-arch:flex"),children:r.jsx(T,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),c=r.jsx(Qe,{color:t?"secondary":"primary",onClick:i,"data-testid":"signup-button",className:_(t&&"screen-arch:hidden md:screen-arch:flex"),children:r.jsx(T,{...n})},"signup"),m=t?[l,c]:[c,l];return r.jsx("div",{className:"flex items-center justify-center gap-2",children:a?m.reverse():m})}function Yr(){return r.jsxs("div",{className:"relative will-change-transform",children:[r.jsx(mn,{}),r.jsx("div",{className:"absolute right-[-3px] top-0 h-3 w-3 rounded-full border-2 border-token-main-surface-primary bg-blue-selection"})]})}const Rn=Kt({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});export{kr as C,Gr as E,Hr as L,Mo as M,$r as N,Ur as P,yo as R,si as S,pi as U,di as a,wo as b,Tr as c,Zo as d,mi as e,En as f,Re as g,ri as h,fi as i,hi as j,gi as k,Ja as l,ai as m,oi as n,Mn as o,ii as p,Nt as q,li as r,yn as s,ui as t,Tn as u,ci as v,xo as x,So as y};
//# sourceMappingURL=kodyf94rms2l778g.js.map

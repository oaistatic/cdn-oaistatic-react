import{j as e,r as d,c as K,M as L}from"./n1tvutderx19k1zs.js";import{d as r,U as V,q as F,o as U,bI as G,aw as Y,av as Z,t as Q,P as R,a as z,bY as W,aj as J}from"./n26mv7rx7nquqst2.js";import{dp as X,dq as ee,c4 as A,dr as se,ds as te,dt as ae}from"./pceg3mlzf8dzw9ob.js";import{a as _,T as g}from"./da0lloekhn03bypm.js";import{S as ne}from"./drca3a4828l8onhl.js";import{B as re}from"./jfxozbrcnsxchwcx.js";import"./hexva2s1lo90zidg.js";import"./nraolmtygmvq3wcf.js";import"./hg2pcqdl92ment5e.js";import"./kodyf94rms2l778g.js";import"./ecp3vwsjvu9v61q0.js";function B({title:t,content:s,buttons:n,time:a,icon:i,size:l="default",progressBar:p,disabled:c=!1,onClick:u}){const j="border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",h=l==="small"?`w-full sm:w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${c?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",b=u?"cursor-pointer":"",o=l==="small"?"text-[15px]":"";return e.jsxs("div",{className:r("inline-flex flex-col items-start justify-start rounded-2xl border",j,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",h,b,o),onClick:u,style:l==="small"&&!c?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:r("flex flex-col items-start justify-start self-stretch",l!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:r("inline-flex items-start justify-start self-stretch",l!=="small"&&"gap-2"),children:[e.jsx("div",{className:r("shrink grow basis-0 font-medium leading-normal",c?"text-token-text-secondary":"text-token-text-primary"),children:t}),e.jsx("div",{className:"relative h-6 w-6"}),!c&&(i||e.jsx(ne,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:r("flex w-full flex-col items-start justify-start",l==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:r("inline-flex w-full items-start justify-start self-stretch rounded",l==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:r("w-full font-normal leading-relaxed",c?"text-token-text-tertiary":"text-token-text-secondary"),children:s})})})]}),p?e.jsxs("div",{className:r("mb-2 inline-flex items-center justify-between self-stretch",n?.length&&"mt-[-10px]"),children:[p,n]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[a&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:a}),e.jsx("div",{className:"flex gap-2",children:n})]})]})}const le=/\*\*(.*?)(?:\*\*|\n|$)/g,O=t=>{let s=null,n;for(;(n=le.exec(t))!=null;)s=n[1].trim();return s},k={strong:t=>{const{node:s,children:n,...a}=t;return e.jsx("strong",{...a,className:r(a.className,"font-semibold text-token-text-primary"),children:n})},p:t=>{const{node:s,children:n,...a}=t;return e.jsx("p",{...a,className:r(a.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:n})}};function ie({message:t,isExpandable:s}){const a=t?.create_time?new Date(t.create_time*1e3):Date.now(),i=te(+a,48e4);return e.jsx(ae,{percentage:i,className:r("mr-4",s?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-i)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function oe({isExpandable:t,handleOpenSidebarSummarizer:s,summarizationHeadline:n,latestTitle:a,message:i}){return e.jsx("div",{className:"pb-2",children:e.jsx(B,{buttons:[e.jsx(W,{onClick:s,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(L,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:n,time:null,icon:e.jsx("div",{className:""}),content:`${a}...`,size:"small",progressBar:e.jsx(ie,{message:i,isExpandable:t})})})}function ce({handleOpenSidebarSummarizer:t,summarizationHeadline:s,message:n}){return e.jsx("div",{className:"pb-2",children:e.jsx(B,{buttons:[],title:s,time:null,content:n?.metadata?.finished_text??"",size:"small",disabled:!0,onClick:t})})}const me=(t,s)=>{if(s<=1)return t.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(s<3)return t.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(s<4)return t.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(s>=60){const n=Math.floor(s/60),a=s%60;return`${n}m ${a}s`}return t.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:s})},de=(t,s)=>{if(s.length>1){let n=0;for(const{message:a}of s)n+=a.metadata?.finished_duration_sec??0;return t.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:me(t,n)})}else return F(s)?.message?.metadata?.finished_text??""};function Me({messages:t,isStreaming:s,isLastMessage:n,clientThreadId:a,currentGroupedMessageIndex:i,turnIndex:l}){const[p,c]=d.useState(""),[u,j]=d.useState(!1),h=V(a,f=>f?.async_status===J.STREAMING),b=K(),o=F(t)?.message,x=h||s||o?.status==="in_progress",C=o?.id,w=de(b,t),v=o?.metadata?.initial_text,T=o?.metadata?.summarization_headline,m=t.map(({message:f})=>U(f)).join(`

`),{toggleThreadSidebar:E}=G(),I=X(),{layer:D}=Y("3711177917"),$=D.get("is_summarizer_default_expanded",!1),q=D.get("is_inline_summarizer_enabled",!1),{value:H}=Z("1330965306"),N=d.useCallback(()=>{E({type:"summarizer",clientThreadId:a,currentGroupedMessageIndex:i,turnIndex:l})},[E,a,i,l]);d.useEffect(()=>{const f=O(m);f?c(f):v!=null&&c(v)},[m,v]),d.useEffect(()=>{m.length>0&&j(!0)},[m]);const P=Q(a),y=d.useMemo(()=>({client_thread_id:a,message_id:C,conversationId:P}),[a,C,P]);d.useEffect(()=>{u&&R.logEvent(z.receivedA8KM123Message,y)},[u]);const M=d.useCallback(()=>{R.logEvent(z.openedA8KM123Message,{...y,isStreaming:s})},[y,s]);if(o?.metadata?.model_slug==="o1-pro")return h&&n||s?e.jsx(oe,{isExpandable:u,handleOpenSidebarSummarizer:N,summarizationHeadline:T??null,latestTitle:p,message:o}):e.jsx(ce,{handleOpenSidebarSummarizer:N,summarizationHeadline:T??null,message:o});const S=x?p:O(w)??w;return I?e.jsx(ee,{alignAgainstAnchor:"start",sideOffset:4,className:"!p-0",triggerButton:e.jsx(_,{status:x?g.Running:g.Finished,highlightedCommand:S,onOpenAnalytics:M}),children:m?e.jsx(re,{mode:x?"bottom":"top",followButtonClassName:"hidden",scrollViewClassName:"max-h-96",children:e.jsx(A,{componentOverrides:k,className:"not-prose px-4 py-2 leading-6",children:m})}):e.jsx("div",{className:"py-10",children:e.jsx(se,{isCompletionRequestInProgress:x})})}):q?e.jsx(_,{status:x?g.Running:g.Finished,highlightedCommand:S,onOpenAnalytics:M,defaultExpanded:$,children:m?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(A,{componentOverrides:H?{...k,strong:()=>null}:k,className:"not-prose leading-6",children:m})}):null}):e.jsx(_,{status:x?g.Running:g.Finished,highlightedCommand:S,onOpenAnalytics:M,onClick:N})}export{k as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,Me as default};
//# sourceMappingURL=eq1uzpsa50yc9zw1.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js17fzn94dbgtvs6.js","assets/n1tvutderx19k1zs.js","assets/pceg3mlzf8dzw9ob.js","assets/n26mv7rx7nquqst2.js","assets/root-osq5e7fb.css","assets/conversation-small-nranh1cg.css","assets/luscs3xv1j9ybwi2.js","assets/kodyf94rms2l778g.js","assets/hexva2s1lo90zidg.js","assets/nraolmtygmvq3wcf.js","assets/ecp3vwsjvu9v61q0.js","assets/zs3gwhpec3gpzbzg.js","assets/lt8myo97bxkt0gi4.js","assets/egjj718ybwa4lzxd.js","assets/fws03tm73d9qjm3m.js","assets/gbcm5ghq9ddzv4er.js","assets/lext96yr69whvjai.js","assets/c4i2f9idniedoes1.js","assets/emkltp3nfqgzlomm.js"])))=>i.map(i=>d[i]);
import{bo as w,gs as _,d$ as F,aL as U,d as R,br as W,dm as E,bY as $,j as Q,bs as J,bt as V,b9 as A,dZ as X,a5 as q,bJ as K,e3 as Y,er as Z,ab as ee,bg as se,al as te}from"./n26mv7rx7nquqst2.js";import{R as ae,a as re,r as t,j as e,M as k,c as ne}from"./n1tvutderx19k1zs.js";import{eG as oe,eH as ie,cC as ce,eI as le,eJ as de,eK as ue,eL as me,eM as l,dU as fe,ag as be,d0 as O,ao as xe,a9 as Se,N as ge,cA as ye,U as z,eN as he,eO as pe,eP as H,eQ as ve}from"./pceg3mlzf8dzw9ob.js";import{D as je,G as Ce,S as Ie}from"./luscs3xv1j9ybwi2.js";import{u as Ne,H as De}from"./mjvbh49zpuokaqb8.js";import{N as Ee}from"./kodyf94rms2l778g.js";const T=Q({unableToLoadHistory:{id:"history.unableToLoad",defaultMessage:"Unable to load history"},retryButton:{id:"history.retryButton",defaultMessage:"Retry"}});function ke({activeId:s,hideOverflowMenu:r}){const n=re(),[o,i]=t.useState(!1),[d,y]=t.useState(0),b=_(),h=F(),p={},[v,u]=t.useState(!1),c=oe(),L=ie(),{conversations:j,hasNextPage:C,fetchNextPage:N,isLoading:m,isFetchingNextPage:M,isError:D}=ce(p),x=t.useRef(null),P=t.useCallback(a=>{m||a==null||(x.current?.disconnect(),x.current=new IntersectionObserver(B=>{B[0].isIntersecting&&C&&N()}),x.current.observe(a))},[m,C,N]);t.useEffect(()=>()=>{x.current?.disconnect()},[]),t.useMemo(()=>{U.publish({kind:"refreshHistory",conversations:j})},[j]);const I=j;t.useEffect(()=>{const a=le(de(),Date.now());b(()=>{y(d+1)},a+1e3)},[d,b]);const f=I.length===0;t.useEffect(()=>{f||ue({namespace:me.ChatPageLoad})?.logTiming("render_history_items")},[f]),l.markStart("History",l.NS_SIDEBAR),m||l.markRendered("History",l.NS_SIDEBAR);const G=Ne(I,d),S=c!=null&&c.kind==="conversation"&&c.gizmoId!=null&&fe(c.gizmoId),g=t.useRef(0);return e.jsxs(He,{$centered:m||D||f,$screenArch:h,onDragOver:a=>{a.preventDefault(),S&&u(!0)},onDrop:a=>{a.preventDefault(),S&&(g.current=0,u(!1),L({newGizmoId:null,conversation:c.conversation,previousGizmoId:c.gizmoId??null}))},onDragEnter:a=>{a.preventDefault(),S&&(g.current+=1)},onDragLeave:a=>{a.preventDefault(),S&&(g.current-=1,g.current===0&&u(!1))},className:R(v&&"opacity-50"),children:[f&&m&&e.jsx(W,{children:e.jsx(E,{className:"m-auto"})}),f&&D&&e.jsxs("div",{className:"p-3 text-center italic text-token-text-tertiary",children:[e.jsx(k,{...T.unableToLoadHistory}),!o&&e.jsx("div",{className:"mt-1",children:e.jsx($,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{i(!0),be(n)},children:e.jsx(k,{...T.retryButton})})})]}),!m&&!f&&e.jsx("div",{children:e.jsx(De,{activeId:s,bucketedItems:G,hasNextPage:C,items:I,infiniteScrollTriggerElementRef:P,hideOverflowMenu:r})}),M&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(E,{})})]})}const ze=ae.memo(ke),He=w.div`flex flex-col gap-2 text-token-text-primary text-sm
${({$centered:s,$screenArch:r})=>[s&&"h-full justify-center items-center empty:hidden",!r&&"mt-5 pb-2"]}`;function Te({currentGizmoId:s}){const r=O(),{data:{gizmos:n}={}}=xe();let o=n;return r&&(o=n?.filter(i=>!Se(i.resource))),l.markStart("GizmoSidebarList",l.NS_SIDEBAR),o!==void 0&&l.markRendered("GizmoSidebarList",l.NS_SIDEBAR),e.jsxs(e.Fragment,{children:[e.jsx(je,{isNewConversation:!0}),e.jsx(Ce,{gizmo:o??[],currentGizmoId:s,maxToShowOnLoad:7})]})}const Re=J(()=>V(()=>import("./js17fzn94dbgtvs6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18])).then(s=>s.FannyPackAction));function Ae({clientThreadId:s}){const r=Z(s),n=ee(),{isUnauthenticated:o}=A(),i=se(s),d=te(),y=O(),[b,h]=t.useState(!1),p=t.useCallback(u=>u===H.Snorlax?b:!1,[b]),v=t.useCallback((u,c)=>{u===H.Snorlax&&h(c)},[]);return e.jsx(ve,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:v},children:e.jsxs("div",{className:"group/sidebar",children:[n&&e.jsx(Te,{currentGizmoId:i}),null,y&&e.jsx("div",{className:"pl-2 text-sm screen-arch:pl-1",children:e.jsx(Ie,{currentGizmoId:i})}),null,!o&&e.jsx(ze,{activeId:d?void 0:r})]})})}function we({clientThreadId:s}){const{isUnauthenticated:r}=A();return r?null:e.jsx(Ae,{clientThreadId:s})}function _e({className:s,onNewThread:r}){const n=ne(),o=X(),i=q(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:d}=ge();return e.jsxs("div",{className:R("flex",i?.visible&&i.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[e.jsx(K,{sideOffset:4,label:n.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),className:"flex",side:"right",children:e.jsx(ye,{className:"no-draggable","aria-label":n.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),onClick:()=>{Y(o)?z.toggleNavSidebar():z.togglePopoverNavSidebar()},icon:he,mobileIcon:pe,"data-testid":"close-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[d&&e.jsx(Re,{}),e.jsx(Ee,{onClick:r,testId:"create-new-chat-button"})]})]})}export{we as C,Te as G,ze as H,_e as S};
//# sourceMappingURL=mv4siddtw65ibanc.js.map

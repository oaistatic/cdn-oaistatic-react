import{e0 as q,aB as V,lG as J,R as O,lH as Z,lI as Q,lJ as ee,lK as j,kU as te,dZ as A,kV as ne,fo as se,lL as oe,lM as ae,lN as P,lO as re,lP as ie,lQ as ce,lR as le,lS as ue,lT as pe,aC as b,lU as de,lV as w,lW as B,lX as fe,lY as _e,lZ as me,aG as he,ah as ge}from"./fztttvm3qzdvif1h.js";import{c6 as E,e as d,aa as ke,ab as xe,B as Ce,aj as ye,I as L,dG as ve,J as Se,c as be,ad as Ee,s as v,N as S,b0 as W,aI as we,ds as Le,eE as Me,aL as Re,fk as I,h6 as Ne}from"./ccccre6vnqbb7l94.js";import{r as k,i as De,j as l,M as R,R as M}from"./ci5tkrccytan34lo.js";import{u as Te,e as Ue,d as Fe}from"./grqqoygx78z5w4fx.js";import{r as Oe}from"./mncmjhre2pa3zjgy.js";import{u as H}from"./hapan2fx2czn21gi.js";import{k as N}from"./pc2givv05uuq8g6l.js";function je({closeModal:t,url:e,onAction:n,onActionAborted:r}){const s=k.useRef(!1),a=De(),{clientThreadId:i}=Te(),c={...E({clientThreadId:i}),url:e,link_type:"text",section:"safe-link-modal"};k.useEffect(()=>{d.logEventWithStatsig("Safe Link Warning Modal Shown","chatgpt_safe_link_warning_modal_shown")},[]);const u=async()=>{s.current=!0;try{await navigator.clipboard.writeText(e),d.logEventWithStatsig("Safe Link Warning Modal Copy Clicked","chatgpt_safe_link_warning_modal_copy_clicked"),d.logEventWithStatsig("link_action","link_action",{...c,action:"copy"})}catch(x){ye.addError(x)}n?.("copy"),t()},h=()=>{s.current=!0,d.logEventWithStatsig("Safe Link Warning Modal Open Clicked","chatgpt_safe_link_warning_modal_open_clicked"),d.logEventWithStatsig("link_action","link_action",{...c,action:"click"}),n?.("open"),t()},f=()=>{s.current||(d.logEventWithStatsig("Safe Link Warning Modal Canceled","chatgpt_safe_link_warning_modal_canceled"),r?.()),s.current=!1,t()};let g="",m=e,p="";try{m=new URL(e).hostname;const _=e.indexOf(m);_!==-1&&(g=e.substring(0,_),p=e.substring(_+m.length))}catch{}return l.jsxs(ke,{testId:"modal-safe-link-warning",isOpen:!0,hideSeparator:!0,onClose:f,showCloseButton:!0,type:"warning",title:l.jsx("div",{className:"flex items-center gap-2",children:a.formatMessage({id:"KXMlta",defaultMessage:"This link isn't verified"})}),primaryButton:l.jsx(Ce,{as:"link",openNewTab:!0,rel:"noopener noreferer",color:"primary",onClick:h,to:e,children:a.formatMessage({id:"gMzmDW",defaultMessage:"Open link"})}),secondaryButton:l.jsx(xe.Button,{title:a.formatMessage({id:"YGLt71",defaultMessage:"Copy link"}),color:"secondary",onClick:u}),children:[l.jsxs("p",{className:"text-token-text-secondary -mt-4 mb-6 text-sm text-pretty sm:-mt-7",children:[l.jsx(R,{defaultMessage:"Make sure you trust this link before proceeding. If you don't recognize the URL, don't open the link to access the site.",id:"safe-link-warning-modal-description"}),l.jsx("a",{className:"can-hover:hover:text-token-link-hover ps-1 underline underline-offset-1",href:"https://help.openai.com/en/articles/10984597-chatgpt-generated-links",target:"_blank",rel:"noopener noreferrer",children:l.jsx(R,{id:"xNvPsR",defaultMessage:"Learn more"})})]}),l.jsxs("div",{className:"mb-2 text-sm break-all",children:[l.jsx("span",{className:"text-token-text-secondary",children:g}),l.jsx("span",{className:"text-token-text-primary font-medium",children:m}),l.jsx("span",{className:"text-token-text-secondary",children:p})]})]})}const D={},T={},U={};function F(t,e){return`${t}::${e}`}function Ae({node:t,onClick:e,children:n,clientThreadId:r,messageId:s,href:a,disableSafeURLs:i,...o}){let c=e;const u=t?.properties?.href,h=q(),f=k.useContext(V),g=L(),m=ve(r),p=J(m,a,f?.useSafeUrls&&!i),x=Se(g,"387775177"),_=!i&&p===void 0&&x.get("enable-copy-and-open",!1);return s!=null&&typeof u=="string"&&u.includes("/bing/redirect")&&(D[s]||(d.logEvent("Browsing Show Bing Link",{id:s,content:u}),D[s]=!0),c=C=>{T[s]||(d.logEvent("Browsing Click Bing Link",{id:s,content:u}),T[s]=!0),e?.(C)}),c=C=>{const y=""+u;if(s&&!U[F(s,y)]){const $=p||_?"URL Clicked Allowed":"URL Clicked Blocked";d.logEvent($,{id:s,content:y}),U[F(s,y)]=!0}e?.(C),_&&a&&Ee(g,je,{url:a})},l.jsx(l.Fragment,{children:l.jsx("a",{onClick:c,...o,className:be(o.className,_&&"cursor-pointer"),href:p,rel:h?"noopener noreferrer":"noopener",children:n})})}const ct="w";function Pe({messageId:t,clientThreadId:e,text:n,children:r,...s}){const i=`${window.location.origin}?q=${encodeURIComponent(n)}`,o=Ue(),c=k.useCallback(async u=>{u.preventDefault(),v.count(S.DEFAULT,"instant_follow_up_anchor_clicked"),d.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:e,messageId:t}),o(u,{text:n,type:O.Reply},[],0)},[e,t,n,o]);return l.jsx(Ae,{...s,href:i,disableSafeURLs:!0,clientThreadId:e,messageId:t,className:"cursor-pointer",onClick:c,children:r})}const lt=M.memo(Pe),Be={},We=[];function G(t){const e=t||Be;return function(n,r){Z(n,"element",function(s,a){const i=Array.isArray(s.properties.className)?s.properties.className:We,o=i.includes("language-math"),c=i.includes("math-display"),u=i.includes("math-inline");let h=c;if(!o&&!c&&!u)return;let f=a[a.length-1],g=s;if(s.tagName==="code"&&o&&f&&f.type==="element"&&f.tagName==="pre"&&(g=f,f=a[a.length-2],h=!0),!f)return;const m=Q(g,{whitespace:"pre"});let p;try{p=N.renderToString(m,{...e,displayMode:h,throwOnError:!0})}catch(_){const C=_,y=C.name.toLowerCase();r.message("Could not render math with KaTeX",{ancestors:[...a,s],cause:C,place:s.position,ruleId:y,source:"rehype-katex"}),y==="parseerror"?p=N.renderToString(m,{...e,displayMode:h,strict:"ignore",throwOnError:!1}):p=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(e.errorColor||"#cc0000"),title:String(_)},children:[{type:"text",value:m}]}]}typeof p=="string"&&(p=ee(p).children);const x=f.children.indexOf(g);return f.children.splice(x,1,...p),j})}}const ut="f",pt="dr",K=(t,e,n=!1)=>{const r=k.useRef(!1);k.useEffect(()=>{r.current||(r.current=!0,v.count(S.DEFAULT,"clickable_follow_up_text_shown"),n&&v.count(S.DEFAULT,"clickable_follow_up_deep_research_text_shown"),d.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...E({clientThreadId:t,messageId:e})}))},[t,e,n])},Y=({messageId:t,clientThreadId:e,text:n})=>{const r=H(e),s=te(),a=A(e);K(e,t,!1);const i=k.useCallback(o=>{o.preventDefault(),v.count(S.DEFAULT,"clickable_follow_up_text_clicked"),d.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",E({clientThreadId:e,messageId:t})),r({sourceEvent:o,promptMessage:Le(n.toLowerCase(),{suggestion_type:O.Reply}),completionMetadata:{systemHints:[...s],conversationMode:a??{kind:we.PrimaryAssistant}}})},[e,a,t,s,r,n]);return l.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:i,children:n})},Ie=({messageId:t,clientThreadId:e,text:n})=>{const r=L();return W(r,"2723331665")?l.jsx(Y,{messageId:t,clientThreadId:e,text:n}):l.jsx("span",{children:n})},dt=M.memo(Ie),He=({messageId:t,clientThreadId:e,text:n})=>{const r=Fe(),{setThreadSystemHintMode:s}=ne(),a=!!Me(),i=H(e),o=A(e);K(e,t,!0);const c=k.useCallback(u=>{u.preventDefault(),v.count(S.DEFAULT,"clickable_follow_up_text_clicked"),v.count(S.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),d.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",E({clientThreadId:e,messageId:t}));const h={clientThreadId:e};s(Re.Research,!0,h),r.focus(),r.setText(n)},[e,t,n,r,s,o,i]);return a?l.jsx(Y,{messageId:t,clientThreadId:e,text:n}):l.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[l.jsx(se,{className:"me-1 inline-block h-[18px] w-[18px]"}),n]})},Ge=({messageId:t,clientThreadId:e,text:n})=>{const r=L();return W(r,"2723331665")?l.jsx(He,{messageId:t,clientThreadId:e,text:n}):l.jsx("span",{children:n})},ft=M.memo(Ge),_t=t=>(t.startsWith(de),t);function Ke(){return t=>{b(t,"list",e=>{for(const n of e.children)n.spread=!0})}}function mt(t){return e=>{b(e,n=>{Object.defineProperties(n,{markdownSource:{get(){return t.slice(this.position.start.offset,this.position.end.offset)}}})})}}const z=[re,ie,Ke,[ce,{singleDollarTextMath:!1}],le,ue,Oe,pe,Ye,Xe];function Ye(){return t=>{b(t,"textDirective",e=>{e.name!==I&&(e.type="text",e.value=`:${e.name}`)})}}const ze=/\u200b/g;function Xe(){return t=>{b(t,"text",e=>{e.value=e.value.replace(ze,"")})}}function $e(){return t=>{const e=t.position?.end.offset;b(t,"element",(n,r)=>{const{position:s}=n;if(!s)return;const{start:a,end:i}=s,o=a.offset,c=i.offset;n.properties??={},o!=null&&(n.properties["data-start"]=o),c!=null&&(n.properties["data-end"]=c,e===c&&(n.properties["data-is-last-node"]=""),r===t.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const ht=[G,$e,oe,[ae,{target:"_new",rel:"noopener noreferrer"}],P],qe=[[G,{output:"mathml"}],P];function Ve(t,e){const n=Ne(t,e);return X(n,e)}function X(t,e){const n=w().use(B).use(z).use([[Qe,e??[]]]).use(fe,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:Je}}),r=w().use(_e).use(qe).use(me),s=n.runSync(n.parse(t)),a=n.stringify(s),i=r.stringify(r.runSync(s));return{"text/plain":a,"text/html":i}}const Je=(t,e,n,r)=>{const s=n.createTracker(r),a=n.enter("link"),i=n.enter("label");let o=s.move("[");return o+=s.move(n.containerPhrasing(t,{before:o,after:"](",...s.current()})),o+=s.move("]("),i(),o+=s.move(t.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Ze)),t.title&&(o+=s.move(" "+JSON.stringify(t.title))),o+=s.move(")"),a(),o};function Ze(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function Qe(t){return e=>{const n={},r=(s,a)=>{switch(a.type){case"grouped_webpages":{const i=[];for(const o of a.items)if(o.url&&o.title){let c=n[o.url];c||(c=n[o.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:o.url,title:o.title}),i.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:o.attribution??ge(o.url)}]})}return i.length===0?[]:[{type:"text",value:"("},...i.flatMap((o,c,u)=>c<u.length-1?[o,{type:"text",value:", "}]:[o]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"tldr":case"navigation":case"stock":case"calculator":case"code_execution":case"forecast":case"businesses_map":case"video":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"image_inline":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(a.alt){const i=w().use(B).use(z).parse(a.alt);if(s.type!=="textDirective")return i.children;const o=i.children[0];if(o.type==="paragraph")return o.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};b(e,he,(s,a,i)=>{if(i==null||a==null)return;const o=et(s,t),c=o?r(s,o)??[s]:[];return i.children.splice(a,1,...c),[j,a+c.length]}),e.children.push(...Object.values(n))}}function et(t,e){if(t.name===I){const n=t.attributes?.index;if(n)return e[parseInt(n,10)]}}const gt=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:X,messageTextToClipboardContent:Ve},Symbol.toStringTag,{value:"Module"}));export{ut as C,ct as I,Ae as M,z as R,ht as a,X as b,lt as c,dt as d,pt as e,ft as f,gt as g,Ve as m,mt as r,_t as u};
//# sourceMappingURL=i3g2qaat3974kagr.js.map

import{r as c,d as R,j as e,i as I,a5 as g,a6 as S}from"./ci5tkrccytan34lo.js";import{dG as k,M as b,aZ as D,y as V,aa as Q,c as _,cw as L,B as $}from"./ccccre6vnqbb7l94.js";import{W}from"./nyeubqfi5ppvzgdr.js";import{ki as q,kj as z,f6 as G,eL as Z,kk as H,e8 as p,kl as J,bQ as K,dg as X,km as A,fP as y,fM as j,kn as Y,ko as ee,d$ as te,kp as se}from"./fztttvm3qzdvif1h.js";import{u as ne,g as ae}from"./mqoto3158npkmhoy.js";import{D as C}from"./oml5zn7j0ve4e9qm.js";import{u as oe}from"./c3qdbvltukttdt17.js";import{r as ie}from"./jppil0z87oklini1.js";import"./obtq7sfq52r3quc0.js";import"./5euj4p5b6ntfs0ir.js";import"./73ej9l1128bvbut8.js";import"./k09abscj5rdhtj24.js";import"./kl37blrmp2daqno8.js";import"./musjw8fjkljbblfz.js";import"./bb4l02lm4p1hlo2s.js";import"./ln3t6yic0tgf7gor.js";import"./n3gqzrf59q8s0sfz.js";import"./fir5zg2hzjs7mluo.js";const re=t=>c.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 15.8333V17.1667C4 18.4553 5.04467 19.5 6.33333 19.5C6.70152 19.5 7 19.2015 7 18.8333V14.1667C7 13.7985 6.70152 13.5 6.33333 13.5C5.04467 13.5 4 14.5447 4 15.8333ZM2 12.5C2 6.97715 6.47715 2.5 12 2.5C17.5228 2.5 22 6.97715 22 12.5V17.1667C22 19.5599 20.0599 21.5 17.6667 21.5C16.1939 21.5 15 20.3061 15 18.8333V14.1667C15 12.6939 16.1939 11.5 17.6667 11.5C18.523 11.5 19.3214 11.7484 19.9936 12.1771C19.8242 7.90854 16.3101 4.5 12 4.5C7.68986 4.5 4.17583 7.90854 4.0064 12.1771C4.6786 11.7484 5.47696 11.5 6.33333 11.5C7.80609 11.5 9 12.6939 9 14.1667V18.8333C9 20.3061 7.80609 21.5 6.33333 21.5C3.9401 21.5 2 19.5599 2 17.1667V12.5ZM20 15.8333C20 14.5447 18.9553 13.5 17.6667 13.5C17.2985 13.5 17 13.7985 17 14.1667V18.8333C17 19.2015 17.2985 19.5 17.6667 19.5C18.9553 19.5 20 18.4553 20 17.1667V15.8333Z",fill:"currentColor"}));var w,N;function ce(){if(N)return w;N=1;var t=ie(),s=q(),n=t(function(o,i,r){return o+(r?" ":"")+s(i)});return w=n,w}var le=ce();const de=R(le);function ue({conversationId:t}){const s=k(t),n=b.getCurrentNode(D(t))?.id,o=z();return G()?e.jsx(f,{conversationId:s??t,parentMessageId:n,status:o}):null}function f(t){const s=t?.status?.modes,[n,o]=c.useState(!1),[i,r]=c.useState(),d=c.useCallback(a=>{r(a),o(!0)},[]),l=I(),u=c.useCallback(()=>o(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(Z,{contentAlign:"center",triggerButton:e.jsx(f.Trigger,{}),children:s?s.map(a=>c.createElement(f.Item,{...t,key:a.display_name,voiceStatusMode:a,onShowModal:d})):e.jsx("div",{role:"progressbar","aria-valuetext":l.formatMessage({defaultMessage:"Loading voice modes",id:"voiceModeButton.loadingModes"}),"aria-busy":"true","aria-live":"assertive","aria-valuemin":0,"aria-valuemax":100,children:e.jsx(V,{"aria-hidden":"true",className:"my-4 min-w-full"})})}),e.jsx(f.Modal,{conversationId:t.conversationId,disabledModeMetadata:i,isOpen:n,onClose:u})]})}f.Modal=function(s){const n=s.disabledModeMetadata?.buttons??[],o=oe({buttons:n,conversationId:s.conversationId,onClick:s.onClose}),i=e.jsx(H,{children:s.disabledModeMetadata?.description_markdown});return e.jsx(Q,{testId:"modal-voice-mode",title:s.disabledModeMetadata?.title,description:i,isOpen:s.isOpen,onClose:s.onClose,type:"success",primaryButton:o.primary,secondaryButton:o.secondary})};f.Trigger=c.forwardRef(function(s,n){const o=p(i=>i.voiceMode);return e.jsxs(J,{ref:n,...s,children:[de(o)??e.jsx(V,{}),e.jsx(K,{className:"icon-md text-token-text-tertiary"})]})});f.Item=function({conversationId:s,parentMessageId:n,voiceStatusMode:o,onShowModal:i}){const{disabled_mode_metadata:r,mode:d}=o,{startVoiceMode:l}=ne(),u=k(s),a=c.useCallback(async()=>{r?i(r.disabled_message):l(ae({serverThreadId:u,parentMessageId:n,isAdvancedMode:d==="advanced"&&!r,eventSource:"voice_mode_picker",clientThreadId:s,gizmoId:b.getGizmoId(D(s))}))},[s,r,d,i,n,u,l]);return e.jsx(X.Item,{onClick:a,children:e.jsxs("div",{children:[o.display_name,e.jsx("div",{className:"text-token-text-tertiary text-xs",children:o.description})]})})};function Ue({conversationId:t}){const s=p(n=>n.voiceSessionId);return e.jsx("div",{className:"relative h-full",children:e.jsx(g.div,{className:"border-s-token-sidebar-surface-secondary bg-token-main-surface-secondary absolute hidden h-full max-w-[500px] overflow-y-hidden rounded-xl border-s pt-4 shadow-inner md:block",initial:{opacity:0,x:520,width:"0px"},animate:{opacity:1,x:0,width:"500px",left:"-520px"},exit:{opacity:0,x:520,width:"0px",left:"0px"},transition:{type:"tween"},children:e.jsx(S,{children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(ue,{conversationId:t})}),e.jsxs("div",{className:"p-4 py-2 text-sm",children:[e.jsx(x,{name:"Voice Session ID",text:s??"n/a"}),e.jsx(me,{conversationId:t})]}),e.jsxs("div",{className:"flex h-full w-full flex-col flex-nowrap gap-4",children:[e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-col flex-nowrap gap-4",children:[e.jsx(xe,{}),e.jsx(fe,{})]})}),e.jsx(pe,{})]})]})})})})}function me({conversationId:t}){const s=k(t),n=s&&D(s),o=b.getTree(n),r=p(m=>m.server.messages.findLast(v=>v.type===A.ConversationUpdate))?.payload.parent_message_id,d=r?o.findNode(m=>m.message.author.role==="assistant"&&L.isMultimodalTextMessage(m.message),r):void 0,{model_definition_slug:l,model_definition_virtual_model_id:u}=d?.message.metadata?.__internal??{},a=[l,u].filter(Boolean).join(", ")??"pending model response";return e.jsx(x,{name:"Model ID",text:a,allowWrap:!0})}function xe(){const[t,s]=c.useState("timestamp"),[n,o]=c.useState("asc"),i=p(a=>a.server.messages.filter(m=>m.type===A.Performance)),r=i[i.length-1],d=c.useCallback(a=>a>=1e3?`${(a/1e3).toFixed(2)}s`:`${a.toFixed(1)}ms`,[]),l=c.useMemo(()=>r?[...r.payload.metrics].sort((a,m)=>{const v=t==="name"?a.name.localeCompare(m.name):a.ms-m.ms;return n==="asc"?v:-v}):[],[r,t,n]);if(!r)return null;const u=a=>{a===t?o(n==="asc"?"desc":"asc"):(s(a),o("asc"))};return e.jsx(O,{title:"Performance",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(M,{text:"Metric"}),t==="name"?n==="asc"?e.jsx(y,{}):e.jsx(j,{}):null]}),e.jsxs("div",{className:"flex cursor-pointer flex-row items-center",onClick:()=>u("timestamp"),children:[e.jsx(M,{text:"Timestamp"}),t==="timestamp"?n==="asc"?e.jsx(y,{}):e.jsx(j,{}):null]}),l.map(a=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:a.name},a.name),e.jsx("span",{className:"bg-token-main-surface-tertiary line-clamp-1 rounded-lg p-0.5 px-1 font-mono text-xs",children:d(a.ms)},a.name+a.ms)]}))]})})}function pe(){const t=p(s=>s.server.messages);return e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-token-text-secondary px-4 py-2 text-lg font-semibold",children:"Messages"}),e.jsx("div",{className:"grow overflow-hidden",children:e.jsx(W,{children:e.jsx(g.ul,{className:"pointer-events-none flex w-full flex-col gap-4 pt-4 pb-24",initial:"initial",animate:"animate",exit:"exit",variants:B,transition:{delayChildren:.25,staggerChildren:.05},children:t.map((s,n)=>e.jsx(he,{index:n,message:s},n))})})})]})}function fe(){const t=p(l=>l.server.connectionState),s=p(l=>l.dev.room),[n,o]=c.useState("Unknown"),i=s?.localParticipant,r=s?.numParticipants??"Unknown",d=s?.activeSpeakers??[];return c.useEffect(()=>{if(i){const l=u=>{o(u)};return i.on("connectionQualityChanged",l),()=>{i.off("connectionQualityChanged",l)}}},[i]),e.jsxs(O,{title:"Room",open:!1,children:[e.jsx(x,{name:"Connection Quality",text:String(n)}),e.jsx(x,{name:"Connection State",text:String(t)}),e.jsx(x,{name:"Participants",text:r}),e.jsx(x,{name:"Speakers",text:d.length}),e.jsx(ve,{})]})}function ve(){const t=p(m=>m.dev.room),[s,n]=c.useState(null),[o,i]=c.useState(null),[r,d]=c.useState(null),l=t?.getActiveDevice("audioinput"),u=t?.getActiveDevice("audiooutput"),a=t?.getActiveDevice("videoinput");return c.useEffect(()=>{async function m(){const v=await C.getLocalDevices("audioinput"),T=await C.getLocalDevices("audiooutput"),U=await C.getLocalDevices("videoinput"),P=v.find(h=>h.deviceId===l),E=T.find(h=>h.deviceId===u),F=U.find(h=>h.deviceId===a);n(P?.label??"Unknown"),i(E?.label??"Unknown"),d(F?.label??null)}m()},[l,u,a]),e.jsxs(e.Fragment,{children:[e.jsx(M,{text:"Devices"}),r?e.jsx(x,{icon:Y,name:"Video Input",text:r}):null,e.jsx(x,{icon:ee,name:"Audio Input",text:s??"Unknown"}),e.jsx(x,{icon:re,name:"Audio Output",text:o??"Unknown"})]})}function O({title:t,titleClassName:s,children:n,open:o}){const[i,r]=c.useState(o??!0);return e.jsxs("div",{children:[e.jsxs("h3",{className:_("text-token-text-secondary flex cursor-pointer items-center py-2 text-lg font-semibold",s),onClick:()=>r(!i),children:[e.jsx("span",{children:t}),e.jsx("span",{className:"ms-2",children:i?e.jsx(j,{className:"h-4 w-4"}):e.jsx(y,{className:"h-4 w-4"})})]}),e.jsx(S,{initial:!1,children:i&&e.jsx(g.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{height:"auto",opacity:1},collapsed:{height:0,opacity:0}},transition:{duration:.3,ease:"easeInOut"},layout:!0,children:n},"content")})]})}function M({text:t}){return e.jsx("h4",{className:"py-2 text-sm font-semibold",children:t})}function x(t){return e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:[e.jsx("span",{className:"opacity-85",children:t.icon?e.jsx(t.icon,{className:"h-[0.75rem] w-[0.75rem]"}):e.jsxs("span",{className:"text-sm",children:[t.name,":"]})}),t.content??e.jsx("span",{className:_(["bg-token-main-surface-tertiary rounded-lg p-0.5 px-1 font-mono text-xs",!t.allowWrap&&"line-clamp-1"]),children:t.text})]})}function he({index:t,message:s}){const[n,o]=c.useState(!1),i=I();let r=null;switch(s.source){case"remote":r=se;break;case"local":r=te;break}return e.jsx(g.div,{className:"border-token-main-surface-tertiary w-full border-t p-4",variants:B,children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex w-full flex-col gap-2 rounded-lg",children:[e.jsxs("div",{className:"text-token-text-secondary font-mono text-[0.65rem] font-semibold",children:[e.jsxs("div",{className:"flex w-full flex-row flex-nowrap items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-1",children:[e.jsx(r,{className:"text-token-text-secondary h-3 w-3"}),e.jsx("span",{children:` | ${t+1} | ${i.formatDate(s.timestamp,{hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:2})}`})]}),e.jsx("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:e.jsx($,{className:"rounded-full p-0.5",color:"ghost",size:"small",onClick:()=>o(d=>!d),children:e.jsx(j,{className:`transform transition-transform ${n?"rotate-180":""}`})})})]}),e.jsx("div",{className:"mt-1 text-xs font-bold",children:s.type})]}),e.jsx(S,{children:n?e.jsx(g.pre,{initial:{opacity:0,transform:"blur(4px)"},animate:{opacity:1,transform:"blur(0px)"},exit:{opacity:0,transform:"blur(4px)"},className:"bg-token-main-surface-tertiary text-token-text-secondary overflow-x-auto rounded-md p-2 text-xs",children:JSON.stringify(s.payload,null,2)}):null})]})})}const B={hidden:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100}};export{Ue as VoiceModeDevPanel};
//# sourceMappingURL=cacceojgfemgw9w8.js.map

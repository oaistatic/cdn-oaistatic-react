const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/css344zwo5xlyys1.js","assets/ci5tkrccytan34lo.js","assets/cv69cmtnvv37bhap.js","assets/ccccre6vnqbb7l94.js","assets/root-ggl0dfwq.css","assets/gzz9k4ytlh5imu91.js","assets/nfzhp6ikcabvhfvv.js","assets/fztttvm3qzdvif1h.js","assets/conversation-small-dfayqh3x.css"])))=>i.map(i=>d[i]);
import{c as R,i as V,r as _,a as Ye,j as t,M as v,l as lt,u as Je,v as Ts,f as be,L as Yt,a5 as Jt,a6 as Fs,R as Gs,e as St}from"./ci5tkrccytan34lo.js";import{e as Es,c9 as ne,oH as De,es as Zt,eC as Ds,bK as Qe,cb as oe,cc as ae,ev as As,ew as Ut,ex as Os,eq as ce,dg as S,ey as Ls,eA as Us,eB as ut,eb as yt,eE as Rs,eN as Ze,eP as et,cN as Bs,eH as Hs,eI as qs,mQ as $s,o9 as Ks,og as Vs,ee as Ws,m0 as ke,k8 as Qs,et as Xs,on as mt,oI as Ys,bf as Js,oh as ft,oJ as Zs,ef as en,oK as Rt,em as tn,eh as ct,oi as sn,o7 as nn,oL as on,oM as tt,oN as an,oO as rn,oP as ln,eg as cn,kF as dn,oQ as un,oR as es,oS as Ke,M as Ct,oT as Bt,oU as mn,oV as Mt,oW as ts,oX as Nt,hf as fn,hg as xn,oY as gn,oZ as hn,o_ as ss,o$ as pn,p0 as jn,p1 as ns,p2 as vn,fK as bn,p3 as Sn,ke as os,d as yn,p4 as Cn,iM as Mn,p5 as Ht,p6 as Nn,p7 as wn,p8 as as,p9 as _n,pa as xt,N as wt,J as st,m3 as kn,pb as is,bD as Xe,pc as rs,pd as In,ai as Ie,eG as zn,pe as Pn,pf as Tn,pg as Fn,ep as nt,fe as Gn,m1 as En,ph as ls,m4 as _t,pi as Dn,eL as Ae,pj as cs,pk as An,pl as On,eK as gt,pm as Ln,pn as Ve,cL as Un,nL as Rn,bS as ds,b4 as pe,U as de,po as us,d0 as Bn,iG as Hn,pp as ms,pq as qn,cw as $n,pr as Kn,ps as Vn,pt as Wn,pu as Qn,pv as fs,eQ as xs,oq as Xn,hH as gs,bu as hs,bL as Yn,ad as Jn,kQ as ps,fU as Zn,hF as eo,ip as to,pw as so,b3 as js,l_ as no,px as oo,py as ao,pz as io,mR as ro,o as lo,a2 as co,O as uo,pA as mo,pB as fo,oG as xo,lo as go,pC as ho,pD as po,pE as jo,pF as vo,pG as bo,d4 as So,pH as yo,cu as Co,bY as Mo,pI as No,mI as ot,hc as vs,pJ as wo,pK as _o,pL as ko,pM as Io,pN as zo,pO as Po,pP as qt,mb as To,pQ as Fo,mG as Go,mH as Eo,k0 as $t,ht as Do,bo as Ao,pR as Oo,jn as Lo,pS as Uo}from"./fztttvm3qzdvif1h.js";import{O as ze,_ as Pe,I as ge,ac as Oe,ap as Ro,c as U,ce as Kt,B as je,aa as Le,z as kt,aM as Bo,F as Te,bW as bs,hk as Ho,ab as We,aJ as ht,bV as qo,dv as It,e as Y,aQ as $o,dL as Ko,dB as Vo,a6 as Ss,ad as at,y as ys,L as pt,df as Wo,dG as zt,bd as Qo,fd as Xo,gv as Yo,K as Ge,ae as Pt,cX as Ee,as as Jo,c9 as Se,gi as Zo,at as it,dk as ea,b0 as jt,bi as ta,b as Tt,aP as sa,aC as na,bh as oa,aK as Ft,d as aa,ds as ia,bj as ra,bK as la,aR as vt,M as Vt}from"./ccccre6vnqbb7l94.js";import{G as Gt}from"./j3zg44ruze86crbd.js";import{u as Et,e as ca}from"./grqqoygx78z5w4fx.js";import{g as da,D as bt,P as ua,b as ma}from"./a1fl09gjys8m3drr.js";import{u as fa}from"./eykh2s3cx0s4wv4b.js";import{T as xa,g as ga,u as ha}from"./musjw8fjkljbblfz.js";import{u as pa}from"./hapan2fx2czn21gi.js";const Cs=ze(()=>Pe(()=>import("./css344zwo5xlyys1.js"),__vite__mapDeps([0,1])).then(s=>s.DirectorySyncResourceManagedIndication));function ja(s,e){return s.type===ce.USER?s.user_id===e.user_id:s.type===ce.GROUP?s.group_id===e.group_id:s.type===e.type}function va(s){"use forget";const e=R.c(74),{gizmo:n,publishedGizmo:o,onClose:r}=s,a=ge(),i=V(),d=Oe(),c=Ro(),l=Es(),{name:u}=ne(),f=u?oe:ae,h=De();let g;e[0]!==n.sharing?.subjects?(g=n.sharing?.subjects??[],e[0]=n.sharing?.subjects,e[1]=g):g=e[1];const[m,p]=_.useState(g),[j,x]=_.useState(!1);let b;e[2]!==n.sharing?.subjects||e[3]!==m?(b=()=>!Kt(n.sharing?.subjects,m),e[2]=n.sharing?.subjects,e[3]=m,e[4]=b):b=e[4];const y=b,w=Ye(),C=Zt(n);let M;e[5]!==m?(M=function(E){m.find(X=>ja(X,E))||p([...m,E])},e[5]=m,e[6]=M):M=e[6];const k=M;let N;e[7]!==c?(N=function(E,X,he){return E.type===ce.USER&&E.user_id.indexOf("__")===-1?{...E,user_id:E.user_id+"__"+c?.getWorkspaceId()}:E},e[7]=c,e[8]=N):N=e[8];const T=N;let I;e[9]!==j||e[10]!==m||e[11]!==r||e[12]!==w||e[13]!==h||e[14]!==T?(I=async function(E){if(j)return;x(!0);const X=m.map(T);await h.mutateAsync({id:E,update:{sharing:{recipient:Qe.Private,subjects:X}}}),x(!1),r(),w.invalidateQueries({queryKey:["gizmos"]}),w.refetchQueries({queryKey:["gizmos","discovery"]}),w.refetchQueries({queryKey:["gizmo",{gizmoId:E}]}),w.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:E}]}),w.invalidateQueries({queryKey:["workspace"]})},e[9]=j,e[10]=m,e[11]=r,e[12]=w,e[13]=h,e[14]=T,e[15]=I):I=e[15];const G=I;let B;e[16]!==o||e[17]!==l?.id?(B=!o||Ma(o.gizmo.author.user_id.split("__")[0],l?.id),e[16]=o,e[17]=l?.id,e[18]=B):B=e[18];const z=B;let J;e[19]!==o.gizmo.id||e[20]!==G?(J=()=>G(o.gizmo.id),e[19]=o.gizmo.id,e[20]=G,e[21]=J):J=e[21];const W=C.length>0||!Ds(Qe.Private,n.sharingTargets);let A;e[22]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(v,{id:"BEKjVh",defaultMessage:"Save"}),e[22]=A):A=e[22];let H;e[23]!==j||e[24]!==J||e[25]!==W?(H=t.jsx(je,{onClick:J,loading:j,disabled:W,children:A}),e[23]=j,e[24]=J,e[25]=W,e[26]=H):H=e[26];let Z;e[27]!==y?(Z=y()&&t.jsx("div",{className:"text-token-text-secondary absolute start-6 bottom-8 text-sm",children:t.jsx(v,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),e[27]=y,e[28]=Z):Z=e[28];let F;e[29]!==a||e[30]!==i||e[31]!==o||e[32]!==d?(F=o&&t.jsx(je,{color:"secondary",onClick:P=>Rs(a,o,d,P,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:t.jsx(v,{id:"bbhdTf",defaultMessage:"Copy link"})}),e[29]=a,e[30]=i,e[31]=o,e[32]=d,e[33]=F):F=e[33];let O;e[34]!==Z||e[35]!==F?(O=t.jsxs(t.Fragment,{children:[Z,F]}),e[34]=Z,e[35]=F,e[36]=O):O=e[36];let $;e[37]!==f.projectShareTitle||e[38]!==i?($=i.formatMessage(f.projectShareTitle),e[37]=f.projectShareTitle,e[38]=i,e[39]=$):$=e[39];let q;e[40]!==k?(q=P=>k(P),e[40]=k,e[41]=q):q=e[41];let L;e[42]!==o||e[43]!==q?(L=t.jsx(Sa,{onAdd:q,publishedGizmo:o}),e[42]=o,e[43]=q,e[44]=L):L=e[44];let ee;e[45]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("h3",{className:"text-base font-semibold",children:t.jsx(v,{id:"bNQXcV",defaultMessage:"Share with..."})}),e[45]=ee):ee=e[45];let K;e[46]!==z||e[47]!==o.gizmo.author||e[48]!==l?(K=t.jsx("div",{className:"shrink-0 grow-0 self-start",children:z?t.jsx(As,{user:l,size:"gizmoConversation",roundedStyle:"rounded-full"}):t.jsx(Ut,{name:o.gizmo.author.display_name??"User",initialsCount:2,size:"gizmoConversation"})}),e[46]=z,e[47]=o.gizmo.author,e[48]=l,e[49]=K):K=e[49];let Q;e[50]!==z||e[51]!==o.gizmo.author||e[52]!==l?.email||e[53]!==l?.name?(Q=t.jsx("div",{className:"grow text-base font-semibold",children:z?t.jsxs("div",{className:"flex flex-col",children:[t.jsx(v,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:l?.name}}),t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:l?.email})]}):t.jsx(v,{id:"FBF0QC",defaultMessage:"{userName} (owner)",values:{userName:o.gizmo.author.display_name}})}),e[50]=z,e[51]=o.gizmo.author,e[52]=l?.email,e[53]=l?.name,e[54]=Q):Q=e[54];let ue;e[55]!==K||e[56]!==Q?(ue=t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[K,Q]}),e[55]=K,e[56]=Q,e[57]=ue):ue=e[57];let ie;e[58]!==m?(ie=m.map((P,E)=>Os(P)&&t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[t.jsx(Ut,{name:P.type===ce.GROUP?P.group_name:`${P.user_name} ${P.user_email}`,initialsCount:P.type===ce.USER?2:1,size:"gizmoConversation",className:U("shrink-0 grow-0",P.type===ce.USER&&"self-start")}),t.jsxs("div",{className:"flex grow flex-col",children:[t.jsxs("span",{className:"flex flex-row",children:[t.jsx("span",{className:"me-2 text-base font-semibold",children:P.type===ce.GROUP?P.group_name:P.user_name}),P.type===ce.GROUP&&P.is_scim_managed&&t.jsx(Cs,{})]}),P.type===ce.USER&&t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:P.user_email})]}),t.jsxs(S.Root,{children:[t.jsxs(S.Trigger,{className:"text-token-text-secondary text-base whitespace-nowrap",children:[t.jsx(v,{...Ms(P.capabilities)}),t.jsx(Ls,{className:"icon-md"})]}),t.jsx(S.Portal,{children:t.jsxs(S.Content,{className:"max-w-[320px]",children:[[Us,ut].map((X,he)=>t.jsx(ba,{capabilities:X,selected:Kt(X,P.capabilities),onClick:()=>{p(m.map(fe=>fe===P?{...fe,capabilities:X}:fe))}},he)),t.jsx(S.Separator,{className:"my-2"}),t.jsx(S.Item,{onClick:()=>p(m.filter(X=>X!==P)),color:"danger",icon:yt,children:t.jsx(v,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},E)),e[58]=m,e[59]=ie):ie=e[59];let me;e[60]!==ue||e[61]!==ie?(me=t.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[ue,ie]}),e[60]=ue,e[61]=ie,e[62]=me):me=e[62];let ve;e[63]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx("hr",{className:"border-token-border-medium"}),e[63]=ve):ve=e[63];let re;e[64]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"GkuPg+",defaultMessage:"Project conversations are private regardless of these settings."})}),e[64]=re):re=e[64];let te;e[65]!==L||e[66]!==me?(te=t.jsxs("div",{className:"flex flex-col space-y-4",children:[L,ee,me,ve,re]}),e[65]=L,e[66]=me,e[67]=te):te=e[67];let le;return e[68]!==r||e[69]!==H||e[70]!==O||e[71]!==$||e[72]!==te?(le=t.jsx(Le,{testId:"modal-share-project",type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:r,primaryButton:H,secondaryButton:O,title:$,showCloseButton:!0,children:te}),e[68]=r,e[69]=H,e[70]=O,e[71]=$,e[72]=te,e[73]=le):le=e[73],le}function Ms(s){return s.can_write?lt({id:"vsUknl",defaultMessage:"Can edit"}):s.can_view_config?lt({id:"4ceJzB",defaultMessage:"Can chat"}):lt({id:"x2E8ET",defaultMessage:"Unknown"})}function ba(s){"use forget";const e=R.c(20),{capabilities:n,selected:o,onClick:r}=s;let a=null;n.can_write?a=Ze:n.can_view_config&&(a=et);let i;e[0]!==n.can_write?(i=n.can_write?t.jsx(v,{id:"r5Iods",defaultMessage:"Chat, edit files & instructions, and duplicate"}):t.jsx(v,{id:"bIM51p",defaultMessage:"Chat, view files & instructions, and duplicate"}),e[0]=n.can_write,e[1]=i):i=e[1];const d=i,c=a;let l;e[2]!==n?(l=Ms(n),e[2]=n,e[3]=l):l=e[3];let u;e[4]!==l?(u=t.jsx("span",{className:"mb-0.5 text-base leading-tight",children:t.jsx(v,{...l})}),e[4]=l,e[5]=u):u=e[5];let f;e[6]!==d?(f=t.jsx("span",{className:"text-token-text-secondary text-xs",children:d}),e[6]=d,e[7]=f):f=e[7];let h;e[8]!==u||e[9]!==f?(h=t.jsxs("div",{className:"me-1 flex grow flex-col",children:[u,f]}),e[8]=u,e[9]=f,e[10]=h):h=e[10];const g=!o&&"invisible";let m;e[11]!==g?(m=U("icon-lg shrink-0",g),e[11]=g,e[12]=m):m=e[12];let p;e[13]!==m?(p=t.jsx(Bs,{className:m}),e[13]=m,e[14]=p):p=e[14];let j;return e[15]!==a||e[16]!==r||e[17]!==h||e[18]!==p?(j=t.jsxs(S.Item,{className:"flex h-auto flex-row items-center px-3 py-3",onClick:r,icon:c,children:[h,p]}),e[15]=a,e[16]=r,e[17]=h,e[18]=p,e[19]=j):j=e[19],j}function Sa(s){"use forget";const e=R.c(19),{onAdd:n,publishedGizmo:o}=s,r=V(),a=kt(),[i,d]=_.useState(""),c=Hs(a?.id,0,i,5),l=a?.data?.name??"your workspace",u=c.data?.items.filter(k=>k.account_user_id!==o?.gizmo.author.user_id),f=a?.id;let h;e[0]!==i||e[1]!==f?(h=[f,"groups","filtered",i],e[0]=i,e[1]=f,e[2]=h):h=e[2];let g;e[3]!==a||e[4]!==i?(g=a?()=>Bo.getWorkspaceGroups(a.id,{query:i,orderby:"@score"}):void 0,e[3]=a,e[4]=i,e[5]=g):g=e[5];const m=i.trim()!==""&&a!=null&&!!a.getWorkspaceId();let p;e[6]!==h||e[7]!==g||e[8]!==m?(p={queryKey:h,queryFn:g,enabled:m},e[6]=h,e[7]=g,e[8]=m,e[9]=p):p=e[9];const{data:j}=Je(p);let x;e[10]!==n?(x=function(N,T,I){n({type:ce.GROUP,group_id:N,group_name:T,capabilities:{...ut},is_scim_managed:I}),d("")},e[10]=n,e[11]=x):x=e[11];const b=x;let y;e[12]!==a||e[13]!==n?(y=function(N,T,I){a&&(n({type:ce.USER,user_id:N,user_name:T,user_email:I,capabilities:{...ut}}),d(""))},e[12]=a,e[13]=n,e[14]=y):y=e[14];const w=y;let C;e[15]!==a||e[16]!==r||e[17]!==l?(C=a?.isEnterprisey()?r.formatMessage({id:"72/DBb",defaultMessage:"Add people and groups from {workspaceName}"},{workspaceName:l}):r.formatMessage({id:"xF0Ixa",defaultMessage:"Add people from {workspaceName}"},{workspaceName:l}),e[15]=a,e[16]=r,e[17]=l,e[18]=C):C=e[18];const M=C;return t.jsx("div",{className:"flex w-full flex-row space-x-3",children:t.jsx(qs,{label:M,name:"share-with-input",inputValue:i,onInputChange:d,suggestions:[...u?.map(k=>{const{id:N,account_user_id:T,name:I,email:G}=k;return{id:N,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>w(T,I??"Unknown User",G??""),children:t.jsx(ya,{name:I??"Unknown User",email:G??""})}})??[],...j?.items.slice(0,5).map(k=>{const{id:N,name:T,is_scim_managed:I,num_members:G}=k;return{id:N,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>b(N,T,I??!1),children:t.jsx(Ca,{name:T,isScimManaged:I??!1,numMembers:G})}})??[]]})})}function ya({name:s,email:e}){return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-full font-semibold",children:s}),t.jsx("span",{className:"text-token-text-secondary text-sm",children:e})]})}function Ca(s){"use forget";const e=R.c(12),{name:n,isScimManaged:o,numMembers:r}=s;let a;e[0]!==n?(a=t.jsx("span",{className:"me-2 font-semibold",children:n}),e[0]=n,e[1]=a):a=e[1];let i;e[2]!==o?(i=o&&t.jsx(Cs,{}),e[2]=o,e[3]=i):i=e[3];let d;e[4]!==a||e[5]!==i?(d=t.jsxs("span",{className:"flex flex-row",children:[a,i]}),e[4]=a,e[5]=i,e[6]=d):d=e[6];let c;e[7]!==r?(c=t.jsx("span",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:r}})}),e[7]=r,e[8]=c):c=e[8];let l;return e[9]!==d||e[10]!==c?(l=t.jsxs("span",{className:"flex flex-col",children:[d,c]}),e[9]=d,e[10]=c,e[11]=l):l=e[11],l}function Ma(s,e){return s===void 0||e===void 0?!1:s.split("__")[0]===e.split("__")[0]}const Ns=Te.div`text-sm text-red-500`,Na=Te.textarea`w-full overflow-y-auto overflow-x-clip rounded-lg border px-3 py-2 focus:ring-2 focus:ring-token-text-primary border-token-border-medium bg-token-main-surface-primary`,Be=20;function ws({onClose:s,gizmo:e}){const n=V(),[o,r]=_.useState(e?.gizmo?.instructions||""),{name:a}=ne(),i=a?oe:ae,d=De(),c=Oe(),l=[];o?.length>mt&&l.push(n.formatMessage(i.instructionsTooLong,{length:mt}));const u=j=>{r(j.target.value)},f=()=>{s()},h=async()=>{try{await d.mutateAsync({update:{instructions:o??""},id:e.gizmo.id}),s()}catch(j){const x=It(j);c.danger(x??"Error",{duration:2})}},g=t.jsx(We.Button,{title:n.formatMessage(i.save),color:"primary",onClick:h,loading:d.isPending,disabled:l.length>0}),m=t.jsx(We.Button,{title:n.formatMessage(i.cancel),color:"secondary",onClick:f,disabled:d.isPending}),p=ke(e);return t.jsx(Le,{testId:"modal-project-custom-instructions",className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!d.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:t.jsx("div",{className:"h-8",children:n.formatMessage(i.editCustomInstructionsTitle)}),onClose:()=>{d.isPending||s()},children:t.jsxs("div",{className:"flex h-full flex-col px-6 pt-0 pb-7",children:[t.jsx("div",{className:"text-sm font-medium",children:n.formatMessage(p?i.editCustomInstructionsSubtitle:i.readOnlyCustomInstructionsTitle)}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:n.formatMessage(p?i.editCustomInstructionsDescription:i.readOnlyCustomInstructionsDescription)}),t.jsx(Na,{autoFocus:!0,placeholder:n.formatMessage(i.projectInstructionsPlaceholder),className:"bg-token-main-surface-primary mt-4 mb-1 min-h-24 w-full grow resize-none rounded-md",onChange:u,value:o,disabled:d.isPending||!p}),l.map(j=>t.jsx(Ns,{className:"mt-1",children:j},j)),p&&t.jsx(We.Actions,{primaryButton:g,secondaryButton:m})]})})}function wa({gizmoId:s,gizmoName:e,canEdit:n,gizmoEditorData:o,openFileDialog:r,pendingFiles:a,setVersion:i,pendingFileUpsertMutationsRef:d,currentModelConfig:c}){const l=o?.files?.reduce((x,b)=>x+(b.file_size_tokens??0),0)??0,u=o?.contextStuffingBudget;let f;u&&(f=l/u,l>0&&f<.01&&(f=.01));const h=o?.files??[],g=Array.from(a.current.values()).filter(x=>h.every(b=>b.file_id!==x.fileId)),m=g.filter(x=>c!=null&&ft(c,x.file.type,x.file.name)===ht.CodeInterpreter),p=h.filter(x=>c!=null&&x.type!=null&&ft(c,x.type,x.name)===ht.CodeInterpreter),j=[...m.map(x=>x.tempId),...p.map(x=>x.file_id)];return t.jsx(Zs,{gizmoId:s,gizmoName:e,canEdit:n,pendingFiles:g,pendingFileUpsertMutationsRef:d,files:h,modelCapacityUsed:f,interpreterOnlyFileIds:j,onAddFiles:r,removePendingFile:x=>{a.current.delete(x),i(b=>b+1)}})}const _a=_.forwardRef(function({gizmo:e,showInstructions:n=!0},o){const r=V(),{name:a}=ne(),i=a?oe:ae,[d,c]=_.useState(!1),l=De(),u=$s(e),f=Zt(u),{data:h}=bs(),g=h?.models.get(Ho)??(h&&Ks(h.models.values(),W=>W.tags.includes(qo.GPT_4o))),m=Oe(),[p,j]=_.useState(0),x=_.useRef(new Map),b=_.useRef([]),y=Vs(g,void 0),w=W=>{W.some(({errors:A})=>A.length!==1||A[0]?.code!==Rt.TooManyFiles)?m.danger(r.formatMessage(i.unknownError),{duration:2}):m.danger(r.formatMessage(i.dragTooManyFilesError,{MAX_FILES_PER_PROJECT:Be}),{duration:2})},C=async W=>{Y.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const A=u.id;W.length>0&&await Promise.all(W.map(H=>{const Z=tn(H);x.current.set(Z,{tempId:Z,gizmoId:A,file:H,status:ct.Uploading,progress:1,fileId:null,cdnUrl:null}),sn(Z,H,r,m,{kind:$o.Gizmo,gizmoId:A},{onFileUploaded:async(F,O,$,q)=>{const L=x.current.get(F);L?.fileId&&L?.fileId&&(b.current.push({id:e.gizmo.id,mutationId:Ts(),update:K=>{if(!L.fileId)return K;const Q=[...K.files??[],{file_id:L.fileId,name:L.file.name,size:L.file.size,type:q?.mimeType??nn(L.file),last_modified:L.file.lastModified,file_size_tokens:q?.fileTokenSize}];return{...K,files:Q}},onSuccess:()=>{x.current.delete(F),j(K=>K+1)}}),on(e.gizmo.id)({gizmoId:e.gizmo.id,upsertProjectMutation:l,pendingFileUpsertMutationsRef:b}))},onFileCreated:(F,O,$)=>{x.current.set(F,{tempId:F,gizmoId:A,file:H,status:ct.Uploading,progress:1,...x.current.get(F),fileId:O,cdnUrl:$}),j(q=>q+1)},onFileUploadProgress:(F,O)=>{const $=x.current.get(F);$?.status===ct.Uploading&&x.current.set(F,{...$,progress:O>95?95:O}),j(q=>q+1)},onError:F=>{x.current.delete(F),j(O=>O+1)}},{usesRetrievalIndex:g!=null&&ft(g,H.type,H.name)===ht.Retrieval})}))},M=Ws(y),k=da(M),N=x.current.size+u.files.length,T=ke(e),{open:I,getInputProps:G,getRootProps:B,isDragAccept:z,isDragReject:J}=fa({noClick:!0,noDragEventsBubbling:!0,onDropAccepted:C,onDropRejected:w,multiple:!0,maxSize:en,maxFiles:Be-N,validator:()=>N>=Be?{code:Rt.TooManyFiles,message:"Too many files"}:null,...M});return _.useImperativeHandle(o,()=>({openFileDialog:I})),t.jsxs("div",{...B({className:"h-full px-6"}),children:[t.jsx("input",{...G()}),n&&t.jsxs(Qs,{children:[t.jsx("button",{className:"w-full",onClick:()=>c(!0),children:t.jsx("div",{className:"border-token-border-default w-full rounded-lg border text-start text-sm",children:u?.instructions?.length?t.jsx("div",{className:"mx-4 my-3 line-clamp-4",children:u.instructions}):t.jsxs("div",{className:"text-token-text-secondary flex h-full w-full items-center px-4 py-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(v,{...i.addCustomInstructions})}),t.jsx(Ze,{className:"icon-sm"})]})})}),f.includes(Xs.GizmoInstructionsTooLong)?t.jsx(Ns,{className:"mt-1",children:t.jsx(v,{...i.instructionsTooLong,values:{length:mt}})}):null]}),d&&t.jsx(ws,{gizmo:e,onClose:()=>{c(!1)}}),t.jsx(wa,{gizmoId:e.gizmo.id,gizmoName:e.gizmo.display.name,canEdit:T,gizmoEditorData:u,openFileDialog:I,pendingFiles:x,pendingFileUpsertMutationsRef:b,setVersion:j,currentModelConfig:g}),z&&t.jsxs(bt,{children:[t.jsx(Ys,{}),t.jsx("h3",{children:t.jsx(v,{...i.dragInstructions})}),t.jsx("h4",{className:"w-2/3 text-center",children:k.length>0?k.join(", "):t.jsx(v,{...i.dragAllAccepted})})]}),J&&t.jsxs(bt,{children:[t.jsx(Js,{className:"icon-2xl"}),t.jsx("h3",{children:t.jsx(v,{...i.dragTooManyFiles})}),t.jsx("h4",{className:"w-2/3 text-center",children:t.jsx(v,{...i.dragTooManyFilesDescription,values:{MAX_FILES_PER_PROJECT:Be}})})]})]})});function ka({gizmo:s,onClose:e}){const n=_.useRef(null),o=_.useCallback(()=>{n.current?.openFileDialog()},[n]),r=ke(s),{name:a}=ne(),i=a?oe:ae;return t.jsx(t.Fragment,{children:t.jsx(Le,{testId:"modal-project-files",className:"min-h-72 max-w-[820px]",isOpen:!0,showCloseButton:!0,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",onClose:()=>{e()},children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx(We.TitleBar,{$hasSeparator:!1,children:t.jsxs("div",{className:"flex w-full items-center gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Ko,{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(v,{...i.projectFilesModalTitle})})}),r&&t.jsx(je,{color:"secondary",onClick:o,children:t.jsx(v,{...i.addFilesButtonLabel})}),t.jsx(Vo,{asChild:!0,className:"sm:mt-0",children:t.jsx(Ss,{onClick:e})})]})}),t.jsx("div",{className:"h-[50dvh] grow overflow-y-auto pt-0",children:t.jsx(_a,{ref:n,gizmo:s,showInstructions:!1})})]})})})}function Ia({gizmo:s}){return t.jsx("div",{className:"mt-6 grid grid-cols-2 items-start",children:s?t.jsxs(t.Fragment,{children:[t.jsx(za,{gizmo:s,className:"rounded-[20px_0px_0px_20px] [border-width:1px_0.5px_1px_1px]"}),t.jsx(Ta,{gizmo:s,className:"rounded-[0px_20px_20px_0px] [border-width:1px_1px_1px_0.5px]"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{}),t.jsx(Wt,{})]})})}function Dt({className:s,header:e,context:n,contextClassName:o="",icon:r,modal:a,onClick:i,disabled:d=!1,isModalOpen:c=!1}){return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:i,disabled:d,className:U("group/snorlax-control-tile border-token-border-light bg-token-bg-primary hover:bg-token-bg-tertiary active:bg-token-bg-tertiary relative h-full rounded-2xl border disabled:pointer-events-none disabled:opacity-50",s),children:t.jsxs("div",{className:"relative mx-5 my-4 flex items-center justify-between gap-3 overflow-hidden",children:[t.jsxs("div",{className:"w-full grow text-start",children:[t.jsx("div",{className:"text-sm font-medium",children:e}),t.jsx("div",{className:U("text-token-text-secondary text-xs",o),children:n})]}),r]})}),c&&a]})}function Wt(){return t.jsx(Dt,{disabled:!0,header:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-48 rounded-full"}),context:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-32 rounded-full"})})}function za({className:s,gizmo:e}){const{files:n}=e,o=!n.length,r=tt(e),[a,i]=_.useState(!1),{name:d}=ne(),c=d?oe:ae,l=a&&t.jsx(ka,{gizmo:e,onClose:()=>{i(!1)}}),u=()=>i(!0);let f,h,g;const m=ke(e);if(o)f=t.jsx(v,{...m?c.addFilesButtonLabel:c.viewFilesButtonLabel}),h=t.jsx(v,{...m?c.filesControlDescription:c.noFilesReadOnlyDescription}),g=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-bg-tertiary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),m?t.jsx(cn,{className:"icon-md h-5 w-5",style:{color:r}}):t.jsx(dn,{className:"icon-md h-5 w-5",style:{color:r}})]});else{const j=n.slice(0,3);f=t.jsx(v,{...c.projectFilesModalTitle}),h=t.jsx(v,{...c.filesCount,values:{count:n.length}}),g=t.jsx("div",{className:"relative flex h-10 w-20 shrink-0 items-center justify-center rounded-full",children:j.toReversed().map((x,b)=>t.jsx(Pa,{file:x,index:b,gizmoId:e.gizmo.id},x.id))})}return t.jsx(Dt,{className:s,isModalOpen:a,modal:l,onClick:u,header:f,context:h,icon:g,disabled:o&&!m})}function Pa({file:s,index:e,gizmoId:n}){const o=s.name,a=an(o)&&s.file_id!=null&&t.jsx(rn,{fileName:o,fileId:s.file_id,gizmoId:n,className:"rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]"});return t.jsx("div",{className:"border-token-bg-primary group-hover/snorlax-control-tile:border-token-bg-tertiary absolute end-0 top-0 h-10 w-10 overflow-hidden rounded-xl border-2",style:{transform:`translateX(${e*-20}px)`},children:a||t.jsx(ln,{className:"h-9 w-9 shrink-0 rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]",filename:s.name,contextConnectorInfo:void 0})})}function Ta({gizmo:s,className:e}){const{instructions:n}=s.gizmo,o=!n.length,r=tt(s),[a,i]=_.useState(!1),{name:d}=ne(),c=d?oe:ae,l=a&&t.jsx(ws,{gizmo:s,onClose:()=>{i(!1)}}),u=()=>i(!0);let f,h,g,m;const p=ke(s);return o?(f=t.jsx(v,{...p?c.customInstructionsTitle:c.customInstructionsReadOnlyTitle}),h=t.jsx(v,{...p?c.customInstructionsDescription:c.customInstructionsReadOnlyDescription}),g=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-main-surface-secondary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),t.jsx(Ze,{className:"icon-md h-5 w-5",style:{color:r}})]})):(f=t.jsx(v,{...c.editCustomInstructionsTitle}),m="overflow-hidden text-ellipsis whitespace-nowrap",h=n),t.jsx(Dt,{className:e,isModalOpen:a,modal:l,onClick:u,header:f,context:h,icon:g,contextClassName:m,disabled:o&&!p})}const Fa=()=>t.jsx("div",{className:"ms-1 mt-3 h-10",children:t.jsx("div",{className:"bg-token-tertiary my-[15px] h-[10px] w-48 rounded-full"})}),Qt=new Map;function Ga(s){const e=Qt.get(s);if(e)return e;const n=yn(Ea,2e3,{trailing:!0});return Qt.set(s,n),n}async function Ea({gizmoId:s,upsertProjectMutation:e,toaster:n}){const o=Nn,r=Ht(o.getState(),"theme",s);try{r!==void 0&&await e.mutateAsync({id:s,update:{theme:r??void 0}}),Ht(o.getState(),"theme",s)===r&&wn(s,"theme")}catch(a){const i=It(a);n.warning(i??"Error",{duration:2})}}function Da({gizmoId:s,theme:e,upsertProjectMutation:n,toaster:o}){Sn(s,"theme",e),Ga(s)({gizmoId:s,upsertProjectMutation:n,toaster:o})}function Aa(s){"use forget";const e=R.c(15),{gizmo:n}=s,o=tt(n),r=De(),[a,i]=_.useState(!1),d=Oe();let c;e[0]!==o||e[1]!==n||e[2]!==d||e[3]!==r?(c=m=>{m!==o&&(Y.logEventWithStatsig("Projects: Theme Change","chatgpt_web_projects_theme_change",{theme:m??"default"}),Da({gizmoId:n.gizmo.id,theme:m,upsertProjectMutation:r,toaster:d}))},e[0]=o,e[1]=n,e[2]=d,e[3]=r,e[4]=c):c=e[4];const l=c;let u;e[5]===Symbol.for("react.memo_cache_sentinel")?(u=m=>i(m),e[5]=u):u=e[5];let f;e[6]!==o?(f=t.jsx(ss,{currentTheme:o}),e[6]=o,e[7]=f):f=e[7];let h;e[8]!==o||e[9]!==l?(h=t.jsx(vn,{currentTheme:o,onSelect:l}),e[8]=o,e[9]=l,e[10]=h):h=e[10];let g;return e[11]!==a||e[12]!==f||e[13]!==h?(g=t.jsx(bn,{open:a,sideOffset:4,alignOffset:7,side:"bottom",alignAgainstAnchor:"start",size:"none",modal:!0,onOpenChange:u,triggerButton:f,children:h}),e[11]=a,e[12]=f,e[13]=h,e[14]=g):g=e[14],g}function Oa(s){"use forget";const e=R.c(2),{gizmo:n}=s;let o;return e[0]!==n?(o=t.jsx("div",{className:"mb-8 inline-flex gap-2 self-center",children:n?t.jsxs("div",{className:"text-page-header inline-block px-4 text-center",children:[n?t.jsx(Aa,{gizmo:n}):t.jsx(ss,{disabled:!0,currentTheme:null}),t.jsxs("a",{href:"#edit-title",role:"button",className:"group hover:text-token-text-secondary relative ms-2 text-balance",onClick:La,children:[n.gizmo.display.name,t.jsx(pn,{})]})]}):t.jsx(Fa,{})}),e[0]=n,e[1]=o):o=e[1],o}function La(s){s.preventDefault(),Nt.setShowProjectSettingsModal(!0)}function Ua(s){"use forget";const e=R.c(2),{children:n}=s;let o;return e[0]!==n?(o=t.jsx("div",{className:"group relative flex flex-col gap-1 p-4",children:t.jsx("div",{className:"flex items-center gap-4",children:n})}),e[0]=n,e[1]=o):o=e[1],o}function Ra(s){"use forget";const e=R.c(23),{conversation:n,gizmo:o}=s,r=pt(n.id,Ba)??n.title,[a,i]=_.useState(!1);let d,c;e[0]!==n.id?(d=()=>Wo(as,{editTitleInMainScreen:x=>{const{serverThreadId:b}=x;b===n.id&&i(!0)}}),c=[n.id],e[0]=n.id,e[1]=d,e[2]=c):(d=e[1],c=e[2]),_.useEffect(d,c);const{snippet:l}=n;let u;e[3]!==n||e[4]!==r||e[5]!==a?(u=a?t.jsx(Cn,{conversationId:n.id,historyConversationResponse:n,onClose:()=>{i(!1)}}):t.jsx("div",{className:"text-sm font-medium",children:r}),e[3]=n,e[4]=r,e[5]=a,e[6]=u):u=e[6];let f;e[7]!==l?(f=l&&t.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:l}),e[7]=l,e[8]=f):f=e[8];let h;e[9]!==u||e[10]!==f?(h=t.jsxs("div",{className:"can-hover:group-hover:me-5 grow overflow-hidden",children:[u,f]}),e[9]=u,e[10]=f,e[11]=h):h=e[11];let g;e[12]!==n||e[13]!==a?(g=!a&&t.jsx(Ha,{conversation:n}),e[12]=n,e[13]=a,e[14]=g):g=e[14];let m;e[15]!==h||e[16]!==g?(m=t.jsxs(Ua,{children:[h,g]}),e[15]=h,e[16]=g,e[17]=m):m=e[17];const p=m;let j;return e[18]!==p||e[19]!==n.id||e[20]!==o||e[21]!==a?(j=a?p:t.jsx(Yt,{to:Mn(n.id,o),draggable:!1,children:p}),e[18]=p,e[19]=n.id,e[20]=o,e[21]=a,e[22]=j):j=e[22],j}function Ba(s){return s?.title}function Ha(s){"use forget";const e=R.c(10),{conversation:n}=s,[o,r]=_.useState(!1),a=o?"flex":"can-hover:group-hover:flex hidden";let i;e[0]!==a?(i=U("absolute end-0 top-0 bottom-0 items-center gap-1.5 pe-4",a),e[0]=a,e[1]=i):i=e[1];let d;e[2]!==n?(d=u=>{r(u),u&&Y.logEvent("Conversation History Item Open Menu",{conversationId:n.id})},e[2]=n,e[3]=d):d=e[3];let c;e[4]!==n||e[5]!==d?(c=t.jsx(_n,{conversation:n,onOpenChange:d,inMainScreen:!0,isActiveConversation:!1}),e[4]=n,e[5]=d,e[6]=c):c=e[6];let l;return e[7]!==i||e[8]!==c?(l=t.jsx("div",{className:i,onClick:qa,children:c}),e[7]=i,e[8]=c,e[9]=l):l=e[9],l}function qa(s){s.preventDefault()}function $a(s){"use forget";const e=R.c(19),{gizmo:n}=s;jn(n.gizmo.id);const{items:o,hasNextPage:r,fetchNextPage:a,isLoading:i,isFetching:d,isFetchingNextPage:c}=ns(n.gizmo.id),l=_.useRef(null);let u;e[0]!==r||e[1]!==d||e[2]!==i||e[3]!==a?(u=b=>{i||b==null||(l.current?.disconnect(),l.current=new IntersectionObserver(y=>{y[0].isIntersecting&&r&&!d&&a()}),l.current.observe(b))},e[0]=r,e[1]=d,e[2]=i,e[3]=a,e[4]=u):u=e[4];const f=u;let h,g;e[5]===Symbol.for("react.memo_cache_sentinel")?(h=()=>()=>{l.current?.disconnect()},g=[],e[5]=h,e[6]=g):(h=e[5],g=e[6]),_.useEffect(h,g);const m=o.length;let p;e[7]!==m||e[8]!==n||e[9]!==r||e[10]!==f||e[11]!==i||e[12]!==o?(p=m||i?t.jsx(Va,{gizmo:n,items:o??[],hasNextPage:r,infiniteScrollTriggerElementRef:f}):t.jsx(Ka,{}),e[7]=m,e[8]=n,e[9]=r,e[10]=f,e[11]=i,e[12]=o,e[13]=p):p=e[13];let j;e[14]!==c?(j=c&&t.jsx("div",{className:"m-4 mb-5 flex justify-center",children:t.jsx(ys,{})}),e[14]=c,e[15]=j):j=e[15];let x;return e[16]!==p||e[17]!==j?(x=t.jsxs("div",{className:"mt-6 mb-14 contain-inline-size",children:[p,j]}),e[16]=p,e[17]=j,e[18]=x):x=e[18],x}function Ka(){"use forget";const s=R.c(3),{name:e}=ne(),n=e?oe:ae;let o;s[0]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(os,{className:"icon-lg text-token-interactive-icon-tertiary-default mb-2"}),s[0]=o):o=s[0];let r;return s[1]!==n.emptyChatsInProjectTitle?(r=t.jsxs("div",{className:"mt-8 flex flex-col items-center font-medium",children:[o,t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{...n.emptyChatsInProjectTitle})})]}),s[1]=n.emptyChatsInProjectTitle,s[2]=r):r=s[2],r}function Va(s){"use forget";const e=R.c(14),{gizmo:n,items:o,hasNextPage:r,infiniteScrollTriggerElementRef:a}=s,i=o.length;let d;if(e[0]!==i||e[1]!==n||e[2]!==r||e[3]!==a||e[4]!==o){let l;e[6]!==i||e[7]!==n||e[8]!==r||e[9]!==a||e[10]!==o.length?(l=(u,f)=>{const h=r&&f===o.length-3?a:void 0;return t.jsx("li",{ref:h,className:U("hover:bg-token-bg-tertiary first:rounded-t-lg last:rounded-b-lg",f!==i-1&&"border-token-border-xlight border-b"),children:t.jsx(Ra,{conversation:u,gizmo:n})},u.id)},e[6]=i,e[7]=n,e[8]=r,e[9]=a,e[10]=o.length,e[11]=l):l=e[11],d=o.map(l),e[0]=i,e[1]=n,e[2]=r,e[3]=a,e[4]=o,e[5]=d}else d=e[5];let c;return e[12]!==d?(c=t.jsx(t.Fragment,{children:t.jsx("ol",{children:d})}),e[12]=d,e[13]=c):c=e[13],c}function At(s,e){"use forget";const n=R.c(14),o=un(),r=ge(),a=be(),i=es(),d=Ke.useStore(),c=o?.kind==="conversation"&&o.gizmoId!==e;let l;n[0]!==a||n[1]!==d||n[2]!==i?(l=async function(p){const{conversation:j,newGizmoId:x,previousGizmoId:b}=p;d.expandProject(x),await i({newGizmoId:x,conversation:j,previousGizmoId:b}),a(`/g/${x}/project`)},n[0]=a,n[1]=d,n[2]=i,n[3]=l):l=n[3];const u=l;let f;n[4]!==u||n[5]!==c||n[6]!==r||n[7]!==o||n[8]!==e||n[9]!==s?(f=()=>{if(!c)return;const{conversation:m,gizmoId:p}=o;if(e)return u({conversation:m,newGizmoId:e,previousGizmoId:p});at(r,j=>{const{closeModal:x}=j;return t.jsx(Mt,{onClose:x,onSuccess:b=>{if(!b)return;const y=u({conversation:m,newGizmoId:b,previousGizmoId:p});return Y.logEventWithStatsig("Projects: Create Open","chatgpt_web_projects_create_open",{source:s}),y}})})},n[4]=u,n[5]=c,n[6]=r,n[7]=o,n[8]=e,n[9]=s,n[10]=f):f=n[10];const h=f;let g;return n[11]!==c||n[12]!==h?(g={canDropConversation:c,onDropConversation:h},n[11]=c,n[12]=h,n[13]=g):g=n[13],g}function Wa(s){"use forget";const e=R.c(46),{clientThreadId:n,gizmoId:o,currentModelId:r,onRequestCompletion:a}=s,i=V(),{name:d}=ne(),c=d?oe:ae,{data:l}=Ct(o),u=Bt(Ja),f=Bt(Ya),{onDropConversation:h,canDropConversation:g}=At(void 0,o),[m,p]=_.useState(!1);let j;e[0]!==g?(j=z=>{z.preventDefault(),g&&p(!0)},e[0]=g,e[1]=j):j=e[1];let x;e[2]!==g||e[3]!==h?(x=z=>{z.preventDefault(),g&&(p(!1),h())},e[2]=g,e[3]=h,e[4]=x):x=e[4];let b,y;e[5]!==g?(b=z=>{z.preventDefault(),g&&p(!0)},y=z=>{z.preventDefault(),g&&p(!1)},e[5]=g,e[6]=b,e[7]=y):(b=e[6],y=e[7]);let w;e[8]!==l?(w=t.jsx(Oa,{gizmo:l}),e[8]=l,e[9]=w):w=e[9];let C;e[10]!==n||e[11]!==r||e[12]!==l||e[13]!==a?(C=l?t.jsx(ua,{clientThreadId:n,isNewThread:!0,currentModelId:r,onContinueGenerating:z=>a(xn(z)),onRequestCompletion:async z=>a(await fn(z)),hideHeader:!0}):t.jsx("div",{className:"bg-token-tertiary h-24 w-full rounded-3xl"}),e[10]=n,e[11]=r,e[12]=l,e[13]=a,e[14]=C):C=e[14];let M,k;e[15]!==l?(M=t.jsx(Ia,{gizmo:l}),k=l&&t.jsx($a,{gizmo:l}),e[15]=l,e[16]=M,e[17]=k):(M=e[16],k=e[17]);let N;e[18]!==l||e[19]!==o||e[20]!==f?(N=l&&f&&t.jsx(va,{gizmo:mn(l),publishedGizmo:l,onClose:Xa},o),e[18]=l,e[19]=o,e[20]=f,e[21]=N):N=e[21];let T;e[22]!==c||e[23]!==l||e[24]!==o||e[25]!==i||e[26]!==u?(T=u&&t.jsx(Mt,{submitButtonTitle:i.formatMessage(c.projectSettingsSubmitButton),gizmo:l,onClose:Qa},o),e[22]=c,e[23]=l,e[24]=o,e[25]=i,e[26]=u,e[27]=T):T=e[27];let I;e[28]!==c||e[29]!==l?.gizmo||e[30]!==m?(I=m&&t.jsxs(bt,{children:[t.jsx(ts,{className:"h-12 w-12",style:{color:"#3C46FF"}}),t.jsx("h3",{className:"text-center",children:t.jsx(v,{...c.addConversationToNamedSnorlax,values:{projectName:l?.gizmo.display.name??"project"}})}),t.jsx("h4",{className:"text-center",children:t.jsx(v,{...c.moveConversation})})]}),e[28]=c,e[29]=l?.gizmo,e[30]=m,e[31]=I):I=e[31];let G;e[32]!==T||e[33]!==I||e[34]!==w||e[35]!==C||e[36]!==M||e[37]!==k||e[38]!==N?(G=t.jsx(gn,{verticalPadding:"none",horizontalPadding:"standard",overflowY:"auto",fullHeight:!0,children:t.jsxs(hn,{column:!0,shouldRemoveGap:!0,className:"min-w-[min(90cqw,640px)]",children:[w,C,M,k,N,T,I]})}),e[32]=T,e[33]=I,e[34]=w,e[35]=C,e[36]=M,e[37]=k,e[38]=N,e[39]=G):G=e[39];let B;return e[40]!==j||e[41]!==G||e[42]!==x||e[43]!==b||e[44]!==y?(B=t.jsx("div",{onDragOver:j,onDrop:x,onDragEnter:b,onDragLeave:y,className:"flex max-h-full min-h-full flex-col md:pt-[calc(var(--header-height)+20px)]",children:G}),e[40]=j,e[41]=G,e[42]=x,e[43]=b,e[44]=y,e[45]=B):B=e[45],B}function Qa(){Nt.setShowProjectSettingsModal(!1)}function Xa(){Nt.setShowShareModal(!1)}function Ya(s){return s.showShareModal}function Ja(s){return s.showProjectSettingsModal}const Za=Object.freeze(Object.defineProperty({__proto__:null,SnorlaxSplashScreen:Wa,useProjectsDragDrop:At},Symbol.toStringTag,{value:"Module"})),ei=ze(()=>Pe(()=>import("./cv69cmtnvv37bhap.js"),__vite__mapDeps([2,1,3,4,5])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>t.jsx(Ot,{color:s})}),ti={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function si(s){"use forget";const e=R.c(21),{color:n,folderState:o,gizmoId:r,sidebarSnorlaxFolderStore:a}=s,i=V(),[d,c]=_.useState(!1),{name:l}=ne(),u=l?oe:ae;let f;e[0]!==u.hideChatsForProjectTooltip||e[1]!==u.showChatsForProjectTooltip||e[2]!==o||e[3]!==i?(f=o==="open"?i.formatMessage(u.hideChatsForProjectTooltip):i.formatMessage(u.showChatsForProjectTooltip),e[0]=u.hideChatsForProjectTooltip,e[1]=u.showChatsForProjectTooltip,e[2]=o,e[3]=i,e[4]=f):f=e[4];let h;e[5]!==o||e[6]!==r||e[7]!==a?(h=y=>{y.preventDefault(),o==="open"?a.collapseProject(r):a.expandProject(r)},e[5]=o,e[6]=r,e[7]=a,e[8]=h):h=e[8];let g,m;e[9]===Symbol.for("react.memo_cache_sentinel")?(g=()=>{c(!0)},m=()=>{c(!1)},e[9]=g,e[10]=m):(g=e[9],m=e[10]);const p=o==="open";let j;e[11]!==n||e[12]!==d||e[13]!==p?(j=t.jsx(ei,{isOpen:p,isHovered:d,color:n}),e[11]=n,e[12]=d,e[13]=p,e[14]=j):j=e[14];let x;e[15]!==h||e[16]!==j?(x=t.jsx("button",{className:"icon-md",onClick:h,onMouseEnter:g,onMouseLeave:m,children:j}),e[15]=h,e[16]=j,e[17]=x):x=e[17];let b;return e[18]!==f||e[19]!==x?(b=t.jsx(Ie,{label:f,triggerAs:null,children:x}),e[18]=f,e[19]=x,e[20]=b):b=e[20],b}function Ot(s){"use forget";const e=R.c(2),{color:n}=s;let o;return e[0]!==n?(o=t.jsx(xt,{className:"icon-md",style:{color:n}}),e[0]=n,e[1]=o):o=e[1],o}function nr(s){"use forget";const e=R.c(88),{gizmo:n,historyDisabled:o,flair:r,onClick:a,isActive:i,hideOverflowMenu:d}=s,c=d===void 0?!1:d,l=ge(),{clientThreadId:u}=Et(),f=zt(u),h=be(),g=V(),m=n.gizmo.id,p=Ke.useStore();let j;e[0]!==m?(j=D=>Ke.selectFolderState(D,m),e[0]=m,e[1]=j):j=e[1];const x=Ke.useState(j);let b;e[2]!==n.gizmo.tags?(b=n.gizmo.tags?.includes(wt.FirstParty),e[2]=n.gizmo.tags,e[3]=b):b=e[3];const y=!!b,{items:w,hasNextPage:C}=ns(n.gizmo.id);let M;e[4]!==w?(M=w===void 0?[]:w,e[4]=w,e[5]=M):M=e[5];const k=M,N=st(m),T=tt(n),I=i&&(!N||!(x==="open"&&f)),G=_.useRef(x);let B,z;e[6]!==x?(B=()=>{G.current=x},z=[x],e[6]=x,e[7]=B,e[8]=z):(B=e[7],z=e[8]),_.useEffect(B,z);let J,W;e[9]!==m||e[10]!==i||e[11]!==f||e[12]!==p?(J=()=>{G.current!=="open"&&i&&f&&p.expandProject(m)},W=[i,f,p,m],e[9]=m,e[10]=i,e[11]=f,e[12]=p,e[13]=J,e[14]=W):(J=e[13],W=e[14]),_.useEffect(J,W);let A;if(n!=null)A=n.gizmo.display.name||kn;else if(o){let D;e[15]!==g?(D=g.formatMessage(is.clearChat),e[15]=g,e[16]=D):D=e[16],A=D}else A=Pn;const[H,Z]=_.useState();let F;e[17]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{Z(void 0)},e[17]=F):F=e[17];let O;e[18]!==n?(O=[n],e[18]=n,e[19]=O):O=e[19],_.useEffect(F,O);const $=De(),[q,L]=_.useState(!1),[ee,K]=_.useState(!1),{canDropConversation:Q,onDropConversation:ue}=At("sidebar_row_button",m);let ie;e[20]!==l||e[21]!==n.gizmo.id||e[22]!==i||e[23]!==q||e[24]!==A||e[25]!==h||e[26]!==H||e[27]!==$?(ie=q?t.jsx(Tn,{initialValue:A,onCommit:async D=>{Z(D),L(!1);const{resource:Fe}=await $.mutateAsync({update:{name:D},id:n.gizmo.id});Fe&&i&&h(Xe(l,Fe),{replace:!0})},onCancel:()=>{L(!1)}}):H??A,e[20]=l,e[21]=n.gizmo.id,e[22]=i,e[23]=q,e[24]=A,e[25]=h,e[26]=H,e[27]=$,e[28]=ie):ie=e[28];const me=ie,ve=ee&&"[&>*]:pointer-events-none";let re;e[29]!==ve?(re=U(ve),e[29]=ve,e[30]=re):re=e[30];let te;e[31]!==Q||e[32]!==ue?(te=D=>{Q&&(D.preventDefault(),D.stopPropagation(),K(!1),ue())},e[31]=Q,e[32]=ue,e[33]=te):te=e[33];let le;e[34]!==Q||e[35]!==N?(le=D=>{Q&&D.target===D.currentTarget&&N&&(D.preventDefault(),K(!0))},e[34]=Q,e[35]=N,e[36]=le):le=e[36];let P;e[37]===Symbol.for("react.memo_cache_sentinel")?(P=D=>{D.target===D.currentTarget&&K(!1)},e[37]=P):P=e[37];let E;e[38]!==l||e[39]!==n?(E=Xe(l,n),e[38]=l,e[39]=n,e[40]=E):E=e[40];let X;e[41]===Symbol.for("react.memo_cache_sentinel")?(X=()=>{L(!0)},e[41]=X):X=e[41];let he;e[42]!==n.gizmo.id||e[43]!==a?(he=D=>{const Fe=n?.gizmo.id??"primary";Y.logNewChatButtonClicked({location:"Sidebar gizmo list",gizmo_id:Fe}),Y.logEvent("Sidebar Click Gizmo",{gizmo_id:Fe}),a?.(D)},e[42]=n.gizmo.id,e[43]=a,e[44]=he):he=e[44];let fe;e[45]!==T||e[46]!==x||e[47]!==m||e[48]!==n.gizmo.display||e[49]!==y||e[50]!==N||e[51]!==p||e[52]!==k?(fe=N&&k.length>0?t.jsx(si,{color:T,folderState:x,gizmoId:m,sidebarSnorlaxFolderStore:p}):N?t.jsx(Ot,{color:T}):t.jsx(Gt,{simple:!0,isFirstParty:y,src:n?.gizmo.display.profile_picture_url,className:"icon-md",alt:""}),e[45]=T,e[46]=x,e[47]=m,e[48]=n.gizmo.display,e[49]=y,e[50]=N,e[51]=p,e[52]=k,e[53]=fe):fe=e[53];let ye;e[54]!==r?(ye=r===rs.Workspace&&t.jsx(ni,{}),e[54]=r,e[55]=ye):ye=e[55];let Ce;e[56]!==r||e[57]!==n||e[58]!==c||e[59]!==i||e[60]!==N||e[61]!==ee?(Ce=!c&&!ee&&(N?t.jsx(ai,{gizmoResource:n,isActive:i}):t.jsx(oi,{gizmoResource:n,flair:r})),e[56]=r,e[57]=n,e[58]=c,e[59]=i,e[60]=N,e[61]=ee,e[62]=Ce):Ce=e[62];let Me;e[63]!==me||e[64]!==I||e[65]!==ee||e[66]!==re||e[67]!==te||e[68]!==le||e[69]!==E||e[70]!==he||e[71]!==fe||e[72]!==ye||e[73]!==Ce?(Me=t.jsx(Fn,{className:re,highlighted:ee,onDrop:te,onDragEnter:le,onDragLeave:P,to:E,onDoubleClick:X,onClick:he,active:I,icon:fe,label:me,trailing:ye,highlightTrailing:Ce}),e[63]=me,e[64]=I,e[65]=ee,e[66]=re,e[67]=te,e[68]=le,e[69]=E,e[70]=he,e[71]=fe,e[72]=ye,e[73]=Ce,e[74]=Me):Me=e[74];let Ne;e[75]!==x||e[76]!==n||e[77]!==C||e[78]!==N||e[79]!==f||e[80]!==I||e[81]!==k?(Ne=N&&x==="open"&&k.length>0&&t.jsx(Jt.div,{initial:"closed",animate:"open",exit:"closed",variants:ti,className:"overflow-hidden",children:t.jsx(In,{gizmoResource:n,serverThreadId:f,isOnProjectPage:I,conversations:k,hasNextPage:C})},"nested-conversations"),e[75]=x,e[76]=n,e[77]=C,e[78]=N,e[79]=f,e[80]=I,e[81]=k,e[82]=Ne):Ne=e[82];let we;e[83]!==Ne?(we=t.jsx(Fs,{initial:!1,children:Ne}),e[83]=Ne,e[84]=we):we=e[84];let Re;return e[85]!==Me||e[86]!==we?(Re=t.jsxs(t.Fragment,{children:[Me,we]}),e[85]=Me,e[86]=we,e[87]=Re):Re=e[87],Re}const ni=()=>{const s=V(),e=kt(),n=e?.name?s.formatMessage({id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"},{workspace_name:e.name??"Your Workspace"}):s.formatMessage({id:"gizmo.workspaceRecommended.noWorkplaceName",defaultMessage:"Recommended at your workplace"});return t.jsx(Ie,{side:"right",label:n,children:t.jsx(zn,{className:"icon-md",alt:n})})},_s=ze(()=>Pe(()=>import("./nfzhp6ikcabvhfvv.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),oi=s=>{"use forget";const e=R.c(10),{gizmoResource:n,flair:o}=s,r=Ye();let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(ls,{onMouseOver:ii,icon:_t}),e[0]=a):a=e[0];let i;e[1]!==o||e[2]!==n||e[3]!==r?(i=o===rs.Recent&&t.jsx(S.Item,{onClick:()=>{nt.updateGizmoSidebar(r,Gn,n.gizmo.id,"keep","sidebar")},children:t.jsx(v,{...is.keepInSidebar})}),e[1]=o,e[2]=n,e[3]=r,e[4]=i):i=e[4];let d;e[5]!==n?(d=t.jsx(_s,{gizmoResource:n,location:"sidebar"}),e[5]=n,e[6]=d):d=e[6];let c;return e[7]!==i||e[8]!==d?(c=t.jsxs(Ae,{triggerButton:a,contentAlign:"start",sideOffset:-5,alignOffset:-17,size:"auto",children:[i,d]}),e[7]=i,e[8]=d,e[9]=c):c=e[9],c},ai=s=>{"use forget";const e=R.c(11),{gizmoResource:n,isActive:o}=s,r=ge(),a=be(),{name:i}=ne(),d=i?oe:ae;if(!En(n))return null;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(ls,{icon:_t}),e[0]=c):c=e[0];let l;e[1]!==r||e[2]!==n||e[3]!==o||e[4]!==a?(l=h=>{h.preventDefault();const g=function(p){p(),o&&a("/")};at(r,m=>{const{closeModal:p}=m;return t.jsx(Dn,{gizmoId:n.gizmo.id,onError:void 0,onSuccess:()=>g(p),onClose:()=>{p()}})})},e[1]=r,e[2]=n,e[3]=o,e[4]=a,e[5]=l):l=e[5];let u;e[6]!==d.deleteProjectDropdownButton?(u=t.jsx(v,{...d.deleteProjectDropdownButton}),e[6]=d.deleteProjectDropdownButton,e[7]=u):u=e[7];let f;return e[8]!==l||e[9]!==u?(f=t.jsx(t.Fragment,{children:t.jsx(Ae,{triggerButton:c,contentAlign:"start",sideOffset:-4,alignOffset:-16,size:"auto",children:t.jsx(S.Item,{color:"danger",onClick:l,icon:yt,children:u})})}),e[8]=l,e[9]=u,e[10]=f):f=e[10],f};function ii(){return _s.prefetch()}function ri(s){const e=V(),{name:n}=ne(),o=n?oe:ae,r=Ye(),a=ge(),i=Qo(a).checkGate("3728943795")&&!s.inSidebarFlyout,d=be(),[c,l]=_.useState(!1),{snorlaxes:u,hasNextPage:f,fetchNextPage:h,isLoading:g,isFetchingNextPage:m,isError:p}=cs(),x=(s.inSidebarFlyout?u.slice(An):u).filter(({gizmo:C})=>C.gizmo.id!==s.currentGizmoId),b=x.length===0,y=_.useRef(null),w=_.useCallback(C=>{g||C==null||(y.current?.disconnect(),y.current=new IntersectionObserver(M=>{M[0].isIntersecting&&f&&h()}),y.current.observe(C))},[g,f,h]);return _.useEffect(()=>()=>{y.current?.disconnect()},[]),t.jsxs("div",{ref:b&&!p?w:void 0,children:[b&&g&&t.jsxs(Xo,{children:[t.jsx(S.Shimmer,{}),t.jsx(S.Shimmer,{})]}),b&&p&&t.jsxs("div",{className:"text-token-text-tertiary p-3 text-center italic",children:[e.formatMessage(o.unableToLoadHistory),!c&&t.jsx("div",{className:"mt-1",children:t.jsx(je,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{l(!0),On(r)},children:e.formatMessage(o.retryLoadingHistory)})})]}),i&&t.jsx(t.Fragment,{children:t.jsx(S.Item,{icon:ts,label:t.jsx(v,{...o.newProjectHeaderButton}),onSelect:()=>{at(a,({closeModal:C})=>t.jsx(Mt,{onClose:()=>C(),onSuccess:async M=>{M&&(await s.onUpdateConversationGizmo(M),d(`/g/${M}/project`))}}))}})}),!g&&!b&&x.map(({gizmo:C},M)=>{const k=M===x.length-1?w:void 0;return t.jsxs(t.Fragment,{children:[i&&M===0&&t.jsx(S.Separator,{}),t.jsx(S.LinkItem,{to:C!=null?Xe(a,C):"/",icon:t.jsx(Ot,{color:C.gizmo.display.theme}),label:C.gizmo.display.name,onClick:()=>{s.inSidebarFlyout||s.onUpdateConversationGizmo(C.gizmo.id)},ref:k},C.gizmo.id)]})}),m&&t.jsxs(t.Fragment,{children:[t.jsx(S.Shimmer,{}),t.jsx(S.Shimmer,{})]})]})}const Xt=Gs.memo(ri);function li({resource:s,grayedOut:e,className:n}){const o=s.gizmo.vanity_metrics?.num_conversations_str;return t.jsxs("div",{className:U("flex w-full grow items-center gap-4 overflow-hidden",n),children:[t.jsx(Gt,{isFirstParty:!!s.gizmo.tags?.includes(wt.FirstParty),src:s.gizmo.display.profile_picture_url??void 0,className:U("h-12 w-12 shrink-0",e&&"grayscale group-hover:grayscale-0")}),t.jsxs("div",{className:"overflow-hidden break-words text-ellipsis",children:[t.jsx("span",{className:"line-clamp-2 text-sm leading-tight font-semibold",children:s.gizmo.display.name}),t.jsx("span",{className:"line-clamp-3 text-xs",children:s.gizmo.display.description}),t.jsxs("div",{className:"text-token-text-tertiary mt-1 flex items-center gap-1 pe-1 text-xs text-ellipsis whitespace-nowrap",children:[t.jsx(gt,{gizmo:s,className:"text-xs",hideLink:!0}),o&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-[8px]",children:"•"}),t.jsx(os,{className:"h-3 w-3"}),o]})]})]})]})}const ci=ze(()=>Pe(()=>Promise.resolve().then(()=>Za),void 0).then(s=>s.SnorlaxSplashScreen)),or=({clientThreadId:s,currentModelId:e,onRequestCompletion:n,gizmoId:o})=>{const{data:r}=Ct(o),a=st(o),i=Yo();return r==null?null:a?t.jsx(ci,{clientThreadId:s,gizmoId:o,currentModelId:e,onRequestCompletion:n}):t.jsx(ks,{gizmo:r,showStarterPrompts:!0,disableStarterPrompts:i})};function ks({gizmo:s,hideOwner:e=!1,children:n,className:o,avatarClassName:r,showStarterPrompts:a=!1,disableStarterPrompts:i=!1}){return s==null?null:t.jsx(t.Fragment,{children:t.jsxs("div",{className:U("text-token-text-primary flex h-full flex-col items-center justify-center","screen-arch:min-h-[calc(100dvh-var(--thread-leading-height)-var(--thread-trailing-height)-12px)]",o),children:[t.jsx(di,{gizmo:s,avatarClassName:r}),t.jsx(mi,{gizmo:s,hideOwner:e,showStarterPrompts:a,disableStarterPrompts:i}),n]})})}function di({gizmo:s,avatarClassName:e}){const n=!!(s!=null&&Ln(s)&&s?.gizmo.tags?.includes(wt.FirstParty));return t.jsx("div",{className:"relative",children:t.jsx(Gt,{isFirstParty:n||!s,src:s!=null&&Ve(s)?s.profilePictureUrl:s?.gizmo.display.profile_picture_url,className:U("mb-3 h-12 w-12",e)})})}function ui({gizmo:s,disabled:e}){const n=ma(s),o=ca(),r=Un();if(n==null||n.length===0)return null;const a=n.slice(0,r?2:4);return t.jsx(xi,{starterPrompts:a,onSelectStarterPrompt:o,disabled:e})}function mi({gizmo:s,hideOwner:e,showStarterPrompts:n,disableStarterPrompts:o}){const r=s!=null&&Ve(s)?s.name:s?.gizmo.display.name,a=s!=null&&Ve(s)?s.description:s?.gizmo.display.description;return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"text-center text-2xl font-semibold",children:r}),!e&&t.jsx("div",{className:"text-token-text-tertiary flex items-center gap-1",children:t.jsx(t.Fragment,{children:s&&Ve(s)?t.jsx(gt,{gizmo:s}):t.jsx(gt,{gizmo:s,socials:s.gizmo.author.display_socials})})}),a&&t.jsx("div",{className:"text-token-text-primary max-w-md text-center text-sm font-normal",children:a}),n&&t.jsx(ui,{gizmo:s,disabled:o})]})}const fi=/\s/;function xi({starterPrompts:s,onSelectStarterPrompt:e,disabled:n,cssMobileDisplayLimit:o,marginOverride:r}){let a=s.map((i,d)=>{let c=i.oneliner??i.title;c===""&&(c=i.body);const l=fi.test(c);return t.jsxs("button",{className:U(o!==void 0&&d>=o&&"max-sm:hidden","border-token-border-default shadow-xxs enabled:hover:bg-token-main-surface-secondary relative flex w-40 flex-col gap-2 rounded-2xl border px-3 pt-3 pb-4 text-start align-top text-[15px] transition disabled:cursor-not-allowed"),disabled:n,onClick:u=>e(u,i,s,d),children:[t.jsx(Rn,{category:i.category}),t.jsx("div",{className:U("line-clamp-3 max-w-full text-balance text-gray-600 dark:text-gray-500",l?"break-word":"break-all"),children:c})]},i.id??d)});if(a.length>2){const i=Math.floor(a.length/2);a=[a.slice(0,i),a.slice(i)].map((d,c)=>t.jsx("div",{className:"flex max-w-3xl flex-wrap items-stretch justify-center gap-4",children:d},c))}return t.jsx("div",{className:U("mx-3 flex max-w-3xl flex-wrap items-stretch justify-center gap-4",r??"mt-12"),children:a})}const gi=ze(()=>Pe(()=>import("./nfzhp6ikcabvhfvv.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),hi=4,rt=Te.div`font-bold mt-6`,pi=s=>Je({queryFn:async()=>nt.getAbout(s),queryKey:["gizmo","about",{gizmoId:s}]}),ji=s=>Je({queryFn:async()=>nt.getCreatorSlice({creatorId:s}),queryKey:["gizmo","creator",{creatorId:s}],enabled:s!=null}),vi=s=>{switch(s.type){case Se.BROWSER:return{title:xe.browsing};case Se.PYTHON:return{title:xe.dataAnalysis};case Se.DALLE:return{title:xe.dalle};case Se.IMAGE_GEN:return{title:xe.imageGen};case Se.MEMORY:return{title:xe.memory,description:xe.memoryDescription};case Se.JIT_PLUGIN:return{title:xe.actions,description:xe.actionsDescription};default:return null}},bi=({tools:s})=>{const e=Pt(),n=e?.includes(Ee.SearchTool)&&!e?.includes(Ee.SearchToolHoldout),o=Bn(s??[],a=>a.type);var r=Jo(o.map(vi).filter(a=>a!=null)??[]);return r.length===0?null:(n&&(r=r.map(a=>a.title===xe.browsing?{title:xe.search}:a)),t.jsxs("div",{className:"flex flex-col",children:[t.jsx(rt,{className:"mb-2",children:t.jsx(v,{id:"gizmo.about.capabilitiesHeader",defaultMessage:"Capabilities"})}),r.map(a=>t.jsxs("div",{className:"flex flex-row items-start gap-2 py-1 text-sm",children:[t.jsx(Hn,{className:"icon-sm mt-0.5 text-green-600"}),t.jsxs("div",{children:[t.jsx(v,{...a.title}),a.description!=null&&t.jsx("div",{className:"text-token-text-tertiary text-xs",children:t.jsx(v,{...a.description})})]})]},a.title.id))]}))},He=Te.div`flex flex-col justify-center items-center gap-2 border-s border-token-border-heavy first:border-0 w-48 mt-4 px-2`,qe=Te.div`flex flex-row items-center gap-1.5 pt-1 text-xl font-semibold text-center leading-none`,$e=Te.div`text-xs text-token-text-tertiary`,Si=({gizmoResource:s})=>t.jsxs(Ae,{contentAlign:"end",sideOffset:4,triggerButton:t.jsx(je,{color:"ghost",icon:_t}),children:[t.jsx(gi,{gizmoResource:s,location:"about_modal"}),t.jsx(us,{gizmoResource:s})]}),yi=({aboutBlock:s})=>{switch(s.type){case"generic_title_subtitle":return t.jsxs(He,{children:[t.jsx(qe,{children:s.title}),t.jsx($e,{children:s.subtitle})]});case"rating":return t.jsxs(He,{children:[t.jsxs(qe,{children:[t.jsx(ms,{className:"icon-sm"}),s.avg]}),t.jsx($e,{children:s.count_str})]});case"category":return s.category_ranking!=null?t.jsxs(He,{children:[t.jsx(qe,{children:t.jsx(v,{id:"gizmo.about.trendingRank",defaultMessage:"#{rank}",values:{rank:s.category_ranking}})}),t.jsx($e,{children:t.jsx(v,{id:"gizmo.about.inCategory",defaultMessage:"in {category} {locale}",values:{category:s.category_str,locale:s.category_locale_str??""}})})]}):t.jsxs(He,{children:[t.jsx(qe,{children:s.category_str}),t.jsx($e,{children:t.jsx(v,{id:"gizmo.about.category",defaultMessage:"Category"})})]})}},Ci=({blocks:s})=>t.jsx("div",{className:"flex justify-center",children:s.map(e=>t.jsx(yi,{aboutBlock:e},e.type))}),Mi=({href:s,onClick:e,children:n})=>t.jsx(Jt.div,{whileTap:{scale:.98},className:"flex",children:t.jsxs(Yt,{to:s,reloadDocument:!0,onClick:e,className:U("group border-token-border-medium bg-token-main-surface-primary hover:bg-token-main-surface-secondary relative ms-2 h-14 min-w-full grow rounded-xl border px-4 focus:outline-hidden"),children:[t.jsx("div",{className:"flex h-full items-center",children:t.jsx("div",{className:"line-clamp-2 text-sm break-all",children:n})}),t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary group-hover:bg-token-main-surface-secondary absolute -start-2 -bottom-px h-3 w-4 border-b",children:t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary h-3 w-2 rounded-ee-full border-e border-b"})}),t.jsx("div",{className:"absolute end-2 top-0 bottom-0 hidden items-center group-hover:flex",children:t.jsx("div",{className:"bg-token-main-surface-primary flex h-8 w-8 items-center justify-center rounded-lg",children:t.jsx(et,{className:"icon-md text-token-text-primary"})})})]})}),Ni=({gizmo:s,onClose:e})=>{const n=Ge("1825130190").value,o=s.gizmo.display.prompt_starters?.slice(0,hi);return o==null||o.length===0||!n?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx(rt,{children:t.jsx(v,{id:"gizmo.about.conversationStartersHeader",defaultMessage:"Conversation Starters"})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-x-1.5 gap-y-2",children:o.map((r,a)=>t.jsx(wi,{gizmo:s,prompt:r,onClick:e},a))})]})};function wi({gizmo:s,prompt:e,onClick:n}){const o=ge(),r=qn(o,s,e);return t.jsx(Mi,{href:r?.toString()??"#",onClick:n,children:e})}const _i=({reviewStats:s})=>Ge("1825130190").value?t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(rt,{children:t.jsx(v,{id:"gizmo.about.ratingsHeader",defaultMessage:"Ratings"})})}),s!=null?[5,4,3,2,1].map(n=>t.jsxs("div",{className:"flex flex-row items-center gap-2 py-1 text-xl font-semibold",children:[t.jsxs("div",{className:"icon-lg relative",children:[t.jsx(ms,{className:"icon-lg text-green-500"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-[11px] text-white",children:n})]}),t.jsx("div",{className:"h-2.5 grow overflow-hidden rounded-full bg-gray-100 dark:bg-gray-700",children:t.jsx("div",{className:"h-full bg-green-500",style:{width:`${(s?.by_rating[n-1]??0)*100}%`}})})]},n)):t.jsx("div",{className:"text-token-text-tertiary text-sm",children:t.jsx(v,{id:"gizmo.about.ratings.notEnoughRatings",defaultMessage:"Not enough ratings yet"})})]}):null,ki=({gizmoId:s,creatorId:e})=>{const n=ds(pe.GPTDetails),o=()=>de.closeModal(pe.GPTDetails);return n?t.jsx(Ii,{gizmoId:s,creatorId:e,onClose:o}):null},Ii=({gizmoId:s,creatorId:e,onClose:n,children:o})=>{const r=Ct(s),a=pi(s),i=ji(e);return _.useEffect(()=>{Y.logEvent("Detail Show Modal",{gizmo_id:s})},[s]),t.jsx(Le,{testId:"modal-gizmo-about",isOpen:!0,onClose:n,type:"success",hideSeparator:!0,showCloseButton:!0,noPadding:!0,className:"flex h-[calc(100vh-25rem)] min-h-[40vh] max-w-xl flex-col",children:t.jsx(zi,{aboutQuery:a,gizmoQuery:r,creatorSliceQuery:i,onClose:n,children:o})})},zi=({aboutQuery:s,gizmoQuery:e,creatorSliceQuery:n,children:o,onClose:r})=>{const a=V();if(s.isLoading||e.isLoading||n.isLoading)return t.jsx("div",{className:"flex h-40 items-center justify-center pb-10",children:t.jsx(ys,{})});const i=s.data?.gizmo,d=n?.data,c=e?.data;if(!i||s.error||e.error||n.error||s.data==null||e.data==null||n.data==null||!c){const l=It(s.error??e.error??n.error)??a.formatMessage({id:"I3v3Oj",defaultMessage:"An error occurred loading this GPT."});return t.jsx("div",{className:"relative flex flex-col gap-2 overflow-hidden px-2 py-4",children:t.jsx("div",{className:"flex flex-col p-4 text-red-500",children:l})})}return t.jsx("div",{className:"flex h-full px-2 py-4",children:t.jsxs("div",{className:"relative flex grow flex-col gap-4 overflow-y-auto px-8 pt-16 pb-20",children:[t.jsx("div",{className:"absolute top-0",children:t.jsxs("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex items-center justify-end bg-linear-to-b to-transparent pb-2",children:[c&&t.jsx(Si,{gizmoResource:c}),t.jsx(Ss,{onClick:r})]})}),t.jsx("div",{className:"absolute bottom-[64px]",children:t.jsx("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex min-h-[64px] items-end bg-linear-to-t to-transparent px-2",children:o})}),t.jsx(ks,{gizmo:c,className:"h-fit!",avatarClassName:"h-20! w-20!"}),t.jsx(Ci,{blocks:s.data.about_blocks}),t.jsx(Ni,{gizmo:c,onClose:r}),t.jsx(bi,{tools:c.tools}),t.jsx(_i,{reviewStats:s.data.review_stats}),d&&t.jsx(Pi,{gizmos:d.items})]})})};function Pi({gizmos:s}){const e=ge();return s.length===0?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(rt,{children:t.jsx(v,{id:"gizmo.about.moreByHeader",defaultMessage:"More by {creatorName}",values:{creatorName:s[0].gizmo.author.display_name}})})}),t.jsx("div",{className:U("no-scrollbar group flex min-h-[104px] items-center space-x-2 overflow-x-auto overflow-y-hidden"),children:s?.map(n=>t.jsx("a",{onClick:()=>{Y.logEvent("Detail Click Gizmo",{gizmo_id:n.gizmo.id})},href:Xe(e,n),className:"bg-token-main-surface-secondary h-fit min-w-fit rounded-xl px-1 py-4 md:px-3 md:py-4 lg:px-3",children:t.jsx(li,{resource:n})},n.gizmo.id))})]})}const ar=s=>t.jsx("div",{className:"flex grow flex-col items-center",children:t.jsxs(je,{color:"primary",className:"h-12 w-full",icon:et,...s,children:[t.jsx(v,{id:"gizmo.about.startChat",defaultMessage:"Start Chat"}),s.children]})}),xe=St({browsing:{id:"gizmo.about.tools.browsing",defaultMessage:"Browsing"},search:{id:"gizmo.about.tools.search",defaultMessage:"Web Search"},dataAnalysis:{id:"gizmo.about.tools.dataAnalysis",defaultMessage:"Code Interpreter & Data Analysis"},dalle:{id:"gizmo.about.tools.dalle",defaultMessage:"DALL·E Images"},imageGen:{id:"gizmo.about.tools.imageGen",defaultMessage:"4o Image Generation"},memory:{id:"gizmo.about.tools.memory",defaultMessage:"Memory"},actions:{id:"gizmo.about.tools.actions",defaultMessage:"Actions"},actionsDescription:{id:"gizmo.about.tools.actionsDescription",defaultMessage:"Retrieves or takes actions outside of ChatGPT"},memoryDescription:{id:"gizmo.about.tools.memoryDescription",defaultMessage:"Learns from previous chats to improve future conversations"}});function Ti(s,e){const{data:n}=bs(),r=$n(s).id,{modelLabel:a}=ga(r,n),i=Kn(),d=ha(s,i,void 0,e);return{modelLabel:a,dropdownSections:d}}function Fi({show:s,clientThreadId:e,gizmoHasCustomActions:n}){const{modelLabel:o,dropdownSections:r}=Ti(e,n);return s?t.jsxs(S.Sub,{onOpenChange:a=>{a&&Y.logEvent("GPTs: Breadcrumb Picker Model Picker Open")},children:[t.jsx(S.SubMenuTrigger,{children:t.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[t.jsx(v,{id:"ilkdMh",defaultMessage:"Model"}),t.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:o})]})}),t.jsx(S.Portal,{children:t.jsx(S.SubContent,{onClick:()=>{Y.logEvent("GPTs: Breadcrumb Picker Model Picker Select")},children:t.jsx(xa,{sections:r})})})]}):null}const Gi=ze(()=>Pe(()=>import("./nfzhp6ikcabvhfvv.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem));function Ei({children:s,clientThreadId:e,gizmoResource:n,showReportModal:o,inMobileHeader:r,showGizmoModelPicker:a}){return t.jsxs(t.Fragment,{children:[t.jsx(Ae,{contentAlign:r?"center":"start",size:"small",triggerButton:s,children:t.jsx(Is,{clientThreadId:e,gizmoResource:n,showReportModal:o,showGizmoModelPicker:a})}),t.jsx(Di,{gizmoResource:n})]})}function Di({gizmoResource:s}){const e=ds(pe.GPTRemoveThirdParty),n=kt(),o=fs(s);return t.jsxs(t.Fragment,{children:[t.jsx(ki,{gizmoId:s.gizmo.id,creatorId:s.gizmo.author.user_id}),t.jsx(oo,{gizmo:s}),o&&t.jsx(ao,{gizmo:s}),o&&t.jsx(io,{gizmo:s}),t.jsx(ro,{gpt:s,isOpen:e,onClose:()=>de.closeModal(pe.GPTRemoveThirdParty),account:n})]})}function Is({clientThreadId:s,gizmoResource:e,showReportModal:n,showGizmoModelPicker:o}){const r=ke(e),a=Vn(e),i=Wn(e.gizmo.id),d=Pt(),c=Qn(e),l=e.gizmo.share_recipient===Qe.Marketplace||e.gizmo.share_recipient===Qe.Link,u=!c&&l,f=Ge("1825130190").value,h=Ge("3645668434").value,g=f&&!c&&fs(e),m=d?.includes(Ee.GizmoSupportEmails)&&!c&&e.gizmo.author.will_receive_support_emails&&g,p=Zo(),j=zt(s),x=xs(Ee.WorkspaceShareLinks),{isUnauthenticated:b}=it(),y=x&&j&&!b,w=be();return t.jsxs(t.Fragment,{children:[t.jsx(Fi,{show:o,clientThreadId:s,gizmoHasCustomActions:Xn(e.tools)}),t.jsx(S.Item,{onClick:()=>{Y.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:e.gizmo.id}),hs(w,`/g/${e.gizmo.short_url}`)},icon:gs,children:t.jsx(v,{...se.newChat})}),t.jsx(S.Item,{onClick:()=>de.openModal(pe.GPTDetails),icon:Yn,children:t.jsx(v,{...se.about})}),e.tools?.find(C=>C.type===Se.JIT_PLUGIN)&&t.jsx(S.Item,{onClick:()=>de.openModal(pe.GPTPrivacySettings),icon:Jn,children:t.jsx(v,{...se.privacySettings})}),r&&t.jsx(S.Item,{onClick:()=>{w(i)},icon:ps,children:t.jsx(v,{...se.customize})}),!r&&a&&h&&t.jsxs(t.Fragment,{children:[t.jsx(S.Item,{onClick:async()=>{w(`/g/${e.gizmo.id}/view`)},icon:Zn,children:t.jsx(v,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),t.jsx(S.Item,{onClick:async()=>{const C=await nt.copyGizmo({gizmoId:e.gizmo.id});C.gizmo.id&&w(`/gpts/editor/${C.gizmo.id}`)},icon:eo,children:t.jsx(v,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),t.jsx(Gi,{gizmoResource:e,location:"conversation_page"}),t.jsx(us,{gizmoResource:e}),m&&t.jsx(S.Item,{onClick:()=>de.openModal(pe.GPTFeedbackEmail),icon:et,children:t.jsx(v,{...se.feedbackEmail})}),g&&t.jsx(S.Item,{onClick:()=>de.openModal(pe.GPTReview),icon:to,children:t.jsx(v,{...se.reviewGPT})}),u&&t.jsx(S.Item,{onClick:n,icon:so,children:t.jsx(v,{...se.report})}),y&&t.jsx(S.Item,{onClick:()=>de.openSharingModal(j),icon:js,children:t.jsx(v,{...se.shareChat})}),p&&t.jsxs(t.Fragment,{children:[t.jsx(S.Separator,{}),t.jsx(S.Item,{color:"danger",onClick:()=>de.openModal(pe.GPTRemoveThirdParty),icon:ea,children:t.jsx(v,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),d?.includes("debug")&&t.jsxs(t.Fragment,{children:[t.jsx(S.Separator,{}),t.jsx(S.Item,{onClick:()=>{w(no(e))},children:"(Internal) See share page"})]})]})}const Ai=({conversation:s,inMainScreen:e=!1,isActiveConversation:n,inChatWindow:o=!1})=>{const r=ge(),a=s.id,i=s.gizmo_id,d=st(i),c=jt(r,"16480203"),l=ta(a),u=xs(Ee.WorkspaceShareLinks),{isUnauthenticated:f}=it(),h=u&&l&&!f&&(!d||c),g=lo(),{name:m}=ne(),p=m?oe:ae,[j,x]=_.useState(!!s.is_do_not_remember),b=V();let y=null;const{snorlaxes:w}=cs();y=w;let C=null;d&&y&&(C=y.find(({gizmo:z})=>z.gizmo.id===i)?.gizmo);const M=es(),k=Ye(),{eligible:N,markAsViewed:T}=co(uo.ArchiveConversationOnboarding),I=Oe(),G=be(),B=async()=>{await Tt.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:s.id}},requestBody:{is_archived:!0}}),go(k,s.gizmo_id),sa.logEvent("chatgpt_conversation_archived"),Y.logEvent("Conversation Archived"),N&&(I.info(b.formatMessage({defaultMessage:"You can view archived chats in Settings",id:"HistoryGizmoItem.archiveChatOnboarding"}),{duration:10,hasCloseButton:!0}),T()),n&&hs(G)};return t.jsxs(t.Fragment,{children:[h&&!o&&t.jsx(S.Item,{onClick:()=>de.openSharingModal(l,"History Item Menu"),icon:js,"data-testid":"share-chat-menu-item",children:t.jsx(v,{...se.shareChat})}),!1,!o&&t.jsx(S.Item,{disabled:!l,onClick:()=>{setTimeout(()=>{l&&as.publish({kind:e?"editTitleInMainScreen":"editTitle",serverThreadId:l})},100)},icon:Ze,children:t.jsx(v,{...se.renameChat})}),g&&y&&y?.length>0&&mo(i)&&l&&t.jsxs(t.Fragment,{children:[d&&t.jsxs(t.Fragment,{children:[y.length>1&&t.jsxs(S.Sub,{children:[t.jsx(S.SubMenuTrigger,{icon:xt,children:t.jsx(v,{...p.moveConversationToSnorlax})}),t.jsx(S.Portal,{children:t.jsx(S.SubContent,{children:t.jsx(Xt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>M({newGizmoId:z,conversation:s,previousGizmoId:i}),currentGizmoId:i})})})]}),t.jsx(S.Item,{onClick:()=>{M({newGizmoId:null,conversation:s,previousGizmoId:i})},icon:fo,children:t.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:t.jsx(v,{...p.removeConversationFromSnorlax,values:{projectName:C?.gizmo.display.name??"project"}})})})]}),!d&&t.jsxs(S.Sub,{children:[t.jsx(S.SubMenuTrigger,{icon:xt,children:b.formatMessage(p.addConversationToSnorlax)}),t.jsx(S.Portal,{children:t.jsx(S.SubContent,{children:t.jsx(Xt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>M({newGizmoId:z,conversation:s,previousGizmoId:i})})})})]})]}),t.jsx(S.Separator,{}),t.jsx(S.Item,{disabled:!l,onClick:()=>{l&&B()},icon:xo,children:t.jsx(v,{...se.archiveChat})}),!1,t.jsx(S.Item,{color:"danger",disabled:!l,onClick:()=>{l&&at(r,ho,{serverThreadId:l,isActiveConversation:n})},icon:yt,"data-testid":"delete-chat-menu-item",children:t.jsx(v,{...se.deleteChat})})]})},zs=({conversation:s,children:e,onOpenChange:n,inMainScreen:o=!1,isActiveConversation:r,inChatWindow:a=!1,...i})=>{const[d,c]=_.useState(!1);return t.jsx(Ae,{...i,open:d,onOpenChange:l=>{c(l),n?.(l)},side:"bottom",contentAlign:a?"end":"start",alignOffset:a?0:-17,sideOffset:a?0:-5,triggerButton:e,size:"auto",children:d&&t.jsx(Ai,{conversation:s,inMainScreen:o,isActiveConversation:r,inChatWindow:a})})},se=St({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}}),ir=Object.freeze(Object.defineProperty({__proto__:null,GizmoConversationOptionsDropdown:zs,GizmoInformationDropdown:Ei,GizmoInformationDropdownItems:Is},Symbol.toStringTag,{value:"Module"})),Ue=na(oa(()=>({feedItems:[],hasUnreadNotifications:!1,isModalOpen:!1}))),Oi=Ue.getState,dt=Ue.setState,Li={getHasUnreadNotifications:(s=Oi())=>s.hasUnreadNotifications},_e={setIsModalOpen:s=>{dt({isModalOpen:s})},setHasUnreadNotifications:s=>{dt({hasUnreadNotifications:s})},bulkLoadFeedItems:s=>{dt(e=>{e.feedItems=s})}};function Ui(){const s=Lt(),e=Ue(Li.getHasUnreadNotifications);return s&&e}function Ps(s,e,n,o){const r=Ui(),a=po();return r||o&&a?s:e}function Lt(){const{layer:s}=Ft("3606233934",{shouldLogExposure:!1});return s.get("enable_notifications_feed")}function rr(){const s=Lt(),e=Ue(n=>n.isModalOpen);return s&&e}function Ri(){const s=Lt(),e=Je({queryKey:["fetch-notifications-feed"],queryFn:async()=>{const n=await Tt.safeGet("/notifications/feed");return _e.bulkLoadFeedItems(n.items),_e.setHasUnreadNotifications(n.has_unreads),n.items},enabled:s});return{isLoading:e.isLoading,isFetching:e.isFetching}}function lr(){const s=V(),e=Ps(No,Mo,!0,!1),n=s.formatMessage({id:"1UHY6w",defaultMessage:"Notifications"});return Ri(),t.jsx(Ie,{label:n,className:"group",children:t.jsx(ot,{icon:e,onClick:()=>_e.setIsModalOpen(!0),"aria-label":n})})}function Bi({item:s,closeModal:e}){const o={announcement:yo}[s.type];let r=null;try{const l=new Date(s.created_at);r=Co({date:l})}catch{}const{clientThreadId:a}=Et(),i=pa(a),d=be(),c=l=>{if(s.action?.type==="show_conversation")e(),d(s.action.conversation_id);else if(s.action?.type==="new_conversation"){const u=s.action;u.prefilled_message&&(i({sourceEvent:l,promptMessage:ia(u.prefilled_message),requestedModelId:u.model_slug??void 0}),e())}};return t.jsxs("button",{className:"border-token-border-default flex w-full items-center justify-start gap-3 overflow-hidden border-t py-4 first-of-type:border-none",onClick:c,disabled:!s.action,children:[t.jsx("div",{className:"relative",children:o&&t.jsx(o,{className:"icon-md"})}),t.jsxs("div",{className:"flex h-5 shrink grow basis-0 items-center justify-between",children:[t.jsx("div",{className:"text-token-text-primary text-sm leading-tight font-normal",children:s.message}),t.jsx("div",{className:"flex items-center justify-start gap-1",children:t.jsx("div",{className:"text-token-text-tertiary text-sm leading-tight font-normal",children:r??""})})]})]})}function cr(){const{feedItems:s,isModalOpen:e}=Ue();_.useEffect(()=>{e&&(_e.setHasUnreadNotifications(!1),Tt.safePost("/notifications/feed/read",{authOption:aa.SendIfAvailable}))},[e]);const n=V(),o=be(),{value:r}=Ge("3325813340"),a=new Date,i=jo(s,c=>{const l=new Date(c.created_at);if(vo(l))return"today";const u=bo(a,l);return u<=7?"last_7_days":u<=30?"last_30_days":"more_than_30_days"}),d=c=>{switch(c){case"today":return n.formatMessage({id:"zlkA39",defaultMessage:"Today"});case"last_7_days":return n.formatMessage({id:"FW89A4",defaultMessage:"Last 7 days"});case"last_30_days":return n.formatMessage({id:"2s3h/P",defaultMessage:"Last 30 days"});case"more_than_30_days":return n.formatMessage({id:"yArZiR",defaultMessage:"More than 30 days"})}};return t.jsx(Le,{testId:"modal-notifications-feed",isOpen:e,onClose:()=>{_e.setIsModalOpen(!1)},type:"success",size:"custom",className:"max-w-3xl",children:t.jsxs("div",{className:"flex flex-col gap-y-10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold",children:n.formatMessage({id:"kWt8Cx",defaultMessage:"Notifications"})}),r&&t.jsx(So,{icon:t.jsx(ps,{className:"icon-lg"}),onClick:()=>{o("/#settings/Notifications")},label:n.formatMessage({id:"mZVh0S",defaultMessage:"Notifications settings"})})]}),Object.entries(i).map(([c,l])=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:d(c)}),l.map(u=>t.jsx(Bi,{item:u,closeModal:()=>_e.setIsModalOpen(!1)},u.id))]},c))]})})}function dr({showShareButton:s,showProfileDropdown:e,clientThreadId:n}){const o=ge(),r=zt(n),a=V(),{layer:i}=Ft("1547743984");jt(o,"1288877412"),jt(o,"3204157926");const[d,c,l,u]=pt(n,M=>[Vt.hasUserMessage(M),Vt.getGizmoId(M),Uo(M),M?.is_do_not_remember??null]),f=ra(n),{prefetchSearchPromises:h}=Et(),g=h!=null,m=i.get("show_share_button_text",!1),p=a.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),j=()=>de.openSharingModal(r),x=st(c),b=Pt();la();const{isUnauthenticated:y}=it(),w=pt(n,M=>M),C=_.useMemo(()=>n==null?null:{id:n,title:w?.title??"",create_time:null,update_time:null,conversation_template_id:null,async_status:w?.async_status??null,gizmo_id:c??null,snippet:null,is_do_not_remember:u},[c,n,w?.title,w?.async_status,u]);return t.jsxs(t.Fragment,{children:[t.jsx(ko,{}),vt(o)?t.jsx(Io,{}):null,!1,!y&&!c&&f&&!g&&!d&&t.jsxs(t.Fragment,{children:[!1,t.jsx(zo,{clientThreadId:n})]}),vt(o)&&b?.includes("caterpillar")&&t.jsx(Po,{}),null,s&&r&&t.jsx(t.Fragment,{children:m?t.jsx(je,{onClick:j,icon:qt,label:p,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{viewTransitionName:"var(--vt_share_chat_wide_button)"},children:p}):t.jsx(Ie,{label:a.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:t.jsx(ot,{"data-testid":"share-chat-button",onClick:j,icon:qt,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),r!=null&&C!=null&&!y?t.jsx(zs,{conversation:C,inMainScreen:!0,isActiveConversation:!0,inChatWindow:!0,children:t.jsx(To,{"aria-label":a.formatMessage({id:"9Mk/E3",defaultMessage:"Open conversation options"}),"data-testid":"conversation-options-button"})}):c&&x?t.jsx(t.Fragment,{children:t.jsx(Fo,{gizmoId:c})}):null,e&&t.jsx(Hi,{clientThreadId:n})]})}function Hi({clientThreadId:s}){const e=ge();return $t.markStart("LoginOrProfileMenu"),$t.markRendered("LoginOrProfileMenu"),t.jsxs(t.Fragment,{children:[!vt(e)&&t.jsx(Ki,{}),t.jsx(Do,{clientThreadId:s})]})}function qi({onClick:s,className:e,testId:n}){const r=V().formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return t.jsx(Ie,{label:r,className:U("flex",e),children:t.jsx(ot,{onClick:a=>_o(a,s),icon:gs,"aria-label":r,"data-testid":n,as:"link"})})}function ur({clientThreadId:s,hideNewChat:e=!1}){const n=vs(),o=wo({clientThreadId:s,location:"Navigation actions"});return n?null:t.jsxs("div",{className:"flex items-center",children:[t.jsx($i,{}),!e&&t.jsx(qi,{onClick:o})]})}function $i(){const s=V(),e=vs(),{isUnauthenticated:n}=it(),o=Ps(Eo,Go,!0,!0);return n||e?null:t.jsx(Ie,{label:s.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:t.jsx(ot,{"aria-label":s.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:()=>{de.setSidebarOpen(!0)},icon:o})})}function Ki(){const s=Ao(),e=Oo(),n=Lo(Vi.signUpCta),{layer:o}=Ft("3637408529"),r=o.get("is_desktop_primary_auth_button_on_right",!1),a=()=>{s({authType:"login",callback:u=>{Y.logLogInButtonClicked({location:"Chat header",provider:u})}})},i=()=>{s({authType:"signup",callback:u=>{Y.logSignUpButtonClicked({location:"Chat header",provider:u})}})},d=t.jsx(je,{onClick:a,color:e?"primary":"secondary","data-testid":"login-button",className:U(!e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),c=t.jsx(je,{color:e?"secondary":"primary",onClick:i,"data-testid":"signup-button",className:U(e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{...n})},"signup"),l=e?[d,c]:[c,d];return t.jsx("div",{className:"flex items-center justify-center gap-2",children:r?l.reverse():l})}const Vi=St({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"}});export{dr as C,$i as E,Ii as G,Hi as L,ur as N,Xt as S,ar as a,cr as b,ks as c,li as d,Ps as e,Ti as f,or as g,Ki as h,nr as i,At as j,Lt as k,lr as l,qi as m,ir as n,rr as u};
//# sourceMappingURL=h1rqozkinxrlxfws.js.map

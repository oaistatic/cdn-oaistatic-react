import{ac as q,ap as Q,bf as V,ai as Z,y as z,B as G,c as y,fe as X}from"./ccccre6vnqbb7l94.js";import{j as e,M as i,r as C,f as K,p as Y,a as $,i as J,o as ee,b as se,ac as ne,a9 as te}from"./ci5tkrccytan34lo.js";import{b5 as ae,dD as re,ea as n,iX as ie,ai as oe,fd as le,d2 as me}from"./fztttvm3qzdvif1h.js";import{b as ce}from"./o6tnov12l4y47p1a.js";import{I as de}from"./n8xzbxiejwlahre8.js";import{u as ue}from"./c5osa63br74ggouv.js";import{E as v}from"./ehrzh1a1v2qy6etb.js";import{i as he,W as P}from"./t7vnx1cc2uzzkq81.js";import{W as pe}from"./g8e8o1dzfmoj72zp.js";import"./k4lih7nb4umlxxxc.js";import"./m3p85h1r7wwh3ar4.js";import"./h1rqozkinxrlxfws.js";import"./j3zg44ruze86crbd.js";import"./grqqoygx78z5w4fx.js";import"./hapan2fx2czn21gi.js";import"./kzhevji8i57j71hk.js";import"./h2gd34k3oh53zw7p.js";import"./a1fl09gjys8m3drr.js";import"./bgu7mt464bd85qmz.js";import"./ln3t6yic0tgf7gor.js";import"./bb4l02lm4p1hlo2s.js";import"./o5dcel4w1cacawdo.js";import"./eykh2s3cx0s4wv4b.js";import"./nplnc7nfjbqgwb50.js";import"./d6qfcfpf3ythcmx2.js";import"./hnwyihljdxrug66f.js";import"./musjw8fjkljbblfz.js";import"./j4mjggthdqynoz2x.js";import"./kwkjmzn9zjnazhqf.js";import"./j6dzpp4h0n6rdhxr.js";function fe(){return e.jsx("div",{className:"border-token-border-heavy flex items-center border-b",children:e.jsx("div",{className:"py-2 text-xl leading-7 font-medium",children:e.jsx(i,{id:"wham.environmentsHeader.message",defaultMessage:"Environments"})})})}const xe=t=>C.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},C.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.9641 3.21478C14.0613 1.73426 16.2208 1.58242 17.5144 2.89485L21.1357 6.56907C22.43 7.88224 22.2461 10.041 20.7483 11.1162L18.5962 12.6612C18.1472 12.9836 17.5219 12.8809 17.1996 12.4318C16.8773 11.9827 16.98 11.3574 17.429 11.035L19.5811 9.49004C20.0804 9.13162 20.1417 8.41204 19.7103 7.97432L16.0889 4.3001C15.6577 3.86263 14.9379 3.91324 14.5722 4.40675L12.8119 6.78196C12.4828 7.22606 11.856 7.31924 11.4119 6.99009C10.9679 6.66093 10.8747 6.03409 11.2038 5.59L12.9641 3.21478ZM3.29391 3.2763C3.68474 2.88543 4.3184 2.88543 4.70923 3.2763L20.7218 19.2905C21.1126 19.6814 21.1126 20.3151 20.7218 20.706C20.331 21.0968 19.6973 21.0968 19.3065 20.706L16.011 17.4101V17.5545C16.011 18.847 15.1841 19.9944 13.9581 20.4031L13.4979 20.5565C12.419 20.9162 11.2296 20.6354 10.4255 19.8312L8.00472 17.4101L3.70845 21.7068C3.31762 22.0977 2.68395 22.0977 2.29312 21.7068C1.90229 21.316 1.90229 20.6822 2.29312 20.2914L6.58939 15.9947L4.16863 13.5737C3.3645 12.7695 3.08371 11.5799 3.44333 10.5009L3.59672 10.0407C4.00539 8.8146 5.1527 7.98758 6.44501 7.98758H6.58939L3.29391 4.69177C2.90308 4.30089 2.90308 3.66717 3.29391 3.2763ZM8.59096 9.98935H6.44501C6.01424 9.98935 5.6318 10.265 5.49558 10.6737L5.34219 11.134C5.22231 11.4936 5.31591 11.8901 5.58395 12.1582L8.71187 15.2864L8.71289 15.2875L11.8408 18.4157C12.1088 18.6838 12.5053 18.7774 12.8649 18.6575L13.3251 18.5041C13.7338 18.3678 14.0094 17.9854 14.0094 17.5545V15.4084L8.59096 9.98935Z",fill:"currentColor"})),ge=25;function ve({isPinned:t,onToggle:c,intl:u,isCreator:l}){return e.jsx(n.Cell,{className:"content-center pe-1!",children:e.jsx(oe,{side:"bottom",align:"center",className:"block w-full",alignOffset:0,label:l?t?e.jsx(i,{id:"wham.environmentsList.unpin",defaultMessage:"Unpin environment for everyone in your workspace"}):e.jsx(i,{id:"wham.environmentsList.pin",defaultMessage:"Pin environment to the top for everyone in your workspace"}):e.jsx(i,{id:"wham.environmentsList.pin.notCreator",defaultMessage:"You can only pin and unpin environments you created."}),children:e.jsxs("button",{disabled:!l,onClick:c,className:y("group/cell relative flex h-10 w-full items-center px-4 group-hover/row:opacity-100",!t&&"opacity-0",t&&!l&&"opacity-50"),"aria-label":t?u.formatMessage({id:"wham.environmentsList.unpinEnvironment",defaultMessage:"Unpin environment"}):u.formatMessage({id:"wham.environmentsList.pinEnvironment",defaultMessage:"Pin environment"}),children:[t&&e.jsx(xe,{className:"icon-md absolute opacity-0 group-hover/cell:opacity-100"}),e.jsx(le,{className:y(t?"icon-md absolute opacity-100 group-hover/cell:opacity-0":"icon-md absolute")})]})})})}function Ce(){const t=K(),[c,u]=Y(),l=$(),o=J(),S=q(),p=Q(),w=!!p?.isWorkspaceAccount(),j=ue(),[f,k]=C.useState(c.get("search")??""),{data:H,isLoading:_,error:D,fetchNextPage:T,hasNextPage:L,isFetchingNextPage:R}=ee({queryKey:["wham","environments","with-creators"],initialPageParam:null,queryFn:({pageParam:s})=>P.getEnvironmentWithCreators(ge,s),getNextPageParam:s=>s.cursor??null}),{mutate:F}=se({mutationFn:({environmentId:s,isPinned:a})=>(l.setQueryData(["wham","environments","with-creators"],r=>r&&V(r,m=>{for(const g of m.pages)for(const d of g.items)if(d.id===s){d.is_pinned=!d.is_pinned;break}})),l.setQueryData(["wham","environments"],r=>r&&r.map(m=>m.id===s?{...m,is_pinned:a}:m)),P.updateEnvironment(s,{is_pinned:a})),onSettled:()=>{he(l)},onError:()=>{S.danger(o.formatMessage({id:"wham.environmentsList.failedToPinEnvironment",defaultMessage:"Failed to pin environment"}))}}),{isConnected:I,isLoading:W}=ce(Z.GITHUB_CONNECTOR,"github","/codex/settings/environments","CODEX");if(_)return e.jsx("div",{className:"flex h-full items-center justify-center pt-5",children:e.jsx(z,{})});const M=H?.pages.flatMap(s=>s.items)??[],x=f.trim().toLowerCase(),O=M.filter(s=>s.label.toLowerCase().includes(x)),N=s=>{const a=s.toLowerCase();return a===x?0:a.startsWith(x)?1:2},b=O.slice().sort((s,a)=>{if(s.is_pinned!==a.is_pinned)return s.is_pinned?-1:1;const r=N(s.label)-N(a.label);return r!==0?r:s.label.localeCompare(a.label)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row justify-between pb-4",children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx(ae,{name:"search-environments",color:"search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",value:f,onChange:s=>{const a=s.target.value;k(a),a?u({search:a},{replace:!0}):u({},{replace:!0})},placeholder:o.formatMessage({id:"wham.environmentsList.searchEnvironmentsPlaceholder",defaultMessage:"Search environments"}),ariaLabel:o.formatMessage({id:"wham.environmentsList.searchEnvironmentsAria",defaultMessage:"Search environments"})})}),e.jsx(G,{onClick:()=>t("/codex/settings/environment/create"),disabled:W||!I,color:"primary",icon:re,className:"h-8",children:e.jsx("span",{className:"hidden md:inline",children:e.jsx(i,{id:"wham.environmentsList.createEnvironment",defaultMessage:"Create environment"})})})]}),D?e.jsx(v,{title:o.formatMessage({id:"wham.environmentsList.error",defaultMessage:"Failed to load environments"}),description:o.formatMessage({id:"wham.environmentsList.errorDescription",defaultMessage:"Please try refreshing the page, if that does not work, please contact support."})}):M.length===0?e.jsx(v,{title:o.formatMessage({id:"wham.environmentsList.noEnvironments",defaultMessage:"No environments"}),description:o.formatMessage({id:"wham.environmentsList.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})}):e.jsxs(e.Fragment,{children:[e.jsxs(n.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{className:"ps-2 text-sm",children:e.jsx(i,{id:"wham.environmentsList.name",defaultMessage:"Name"})}),e.jsx(n.HeaderCell,{className:"text-sm",children:e.jsx(i,{id:"wham.environmentsList.repo",defaultMessage:"Repo"})}),e.jsx(n.HeaderCell,{className:"text-sm",children:e.jsx(i,{id:"wham.environmentsList.numberOfTasks",defaultMessage:"Number of tasks"})}),j&&e.jsx(n.HeaderCell,{className:"text-sm",children:e.jsx(i,{id:"wham.environmentsList.sharing",defaultMessage:"Sharing"})}),e.jsx(n.HeaderCell,{className:"text-sm",children:e.jsx(i,{id:"wham.environmentsList.creator",defaultMessage:"Creator"})}),e.jsx(n.HeaderCell,{className:"text-sm",children:e.jsx(i,{id:"wham.environmentsList.createdAt",defaultMessage:"Created at"})}),w&&e.jsx(n.HeaderCell,{}),e.jsx(n.HeaderCell,{})]}),e.jsx(n.Body,{children:b.length===0&&!L?e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:100,children:e.jsx(v,{title:o.formatMessage({id:"wham.environmentsList.search.noEnvironments",defaultMessage:"No matches for {search}"},{search:f}),description:o.formatMessage({id:"wham.environmentsList.search.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})})})}):b.map(({id:s,label:a,is_pinned:r,repos:m,repo_map:g,creator:d,created_at:E,task_count:A,share_settings:B})=>{const U=!!p?.authUserId&&d.id.includes(p?.authUserId);return e.jsxs(n.Row,{className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm hover:cursor-pointer",onClick:()=>t(`/codex/settings/environment/${s}`),children:[e.jsx(n.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:a}),e.jsx(n.Cell,{divClassName:"flex h-14 items-center",children:m.map(h=>e.jsx("div",{children:g?.[h]?.repository_full_name??h},h))}),e.jsx(n.Cell,{divClassName:"flex h-14 items-center",children:A}),j&&e.jsx(n.Cell,{divClassName:"flex h-14 items-center",children:we(o,B)}),e.jsx(n.Cell,{divClassName:"flex h-14 items-center",children:d.email}),e.jsx(n.Cell,{divClassName:"flex h-14 items-center",children:E?e.jsx(ne,{value:new Date(E*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(i,{id:"wham.environmentsList.na",defaultMessage:"N/A"})}),w&&e.jsx(ve,{isPinned:r,isCreator:U,onToggle:h=>{h.stopPropagation(),F({environmentId:s,isPinned:!!r})},intl:o})]},s)})})]}),e.jsx(de,{isFetchingNextPage:R,hasNextPage:L??!1,fetchNextPage:T})]})]})})}function we(t,c){switch(c){case"public":return t.formatMessage({id:"wham.environmentsList.public",defaultMessage:"Public"});case"private":return t.formatMessage({id:"wham.environmentsList.private",defaultMessage:"Private"});case"workspace":return t.formatMessage({id:"wham.environmentsList.workspace",defaultMessage:"Workspace"});default:ie.assertNever(c)}}function je(){const{eligible:t}=me();return t?e.jsx(te,{to:"/codex/onboarding"}):e.jsx(pe,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-4 ps-4 pe-4 md:pe-12",children:[e.jsx(fe,{}),e.jsx(Ce,{})]})})}const $e=()=>[{title:"Codex"}],Je=X(function(){return e.jsx(je,{})});export{Je as default,$e as meta};
//# sourceMappingURL=dhf6s6pbopvuwc9g.js.map

import{fe as g,ac as S,dl as h,dm as f,b as R}from"./ccccre6vnqbb7l94.js";import{C as E,f as b,r as n,j as C}from"./ci5tkrccytan34lo.js";import{a as O}from"./itdwpc2q0aiung3v.js";const d="chatgpt://oauth_complete";async function T(u,a,s,r){const e=await R.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:u},query:{code:a,redirect_uri:s,...r!=null?{state:r}:{}}}});return{...e,redirect_path:O(e.redirect_path).toString()}}const L=g(function(){const{pluginId:a,code:s,state:r,error:e,errorDesc:o}=E(),c=b(),l=n.useRef(!1);n.useEffect(()=>{if(l.current===!0)return;l.current=!0;async function m(){const _=`https://chat.openai.com/aip/${a}/oauth/callback`;try{const t=await T(a,s,_,r);if(t.success)if(t.redirect_path===d)window.location.href=d;else{const i=new URL(h(f.OAUTH_SUCCESS,t.redirect_path),location.origin);i.searchParams.set("oauth_success","true"),c(i.pathname+i.search+i.hash)}else c(h(f.CUSTOM_ERROR,t.redirect_path,t.error??t.message))}catch{c({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:a,loginSuccess:"false"}).toString()})}}m()},[a,s,r,c]);const p=S();return n.useEffect(()=>{e&&p.danger(`${e}${o?`: ${o}`:""}`,{duration:5})},[e,o,p]),C.jsx("div",{})});export{L as default};
//# sourceMappingURL=e0rtmpzd9svr75yb.js.map

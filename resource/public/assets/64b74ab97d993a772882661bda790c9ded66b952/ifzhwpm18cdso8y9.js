import{I as f,b0 as y,fe as I,ad as w,e as S,a as C,d4 as P,bJ as _,aI as v}from"./ccccre6vnqbb7l94.js";import{r as p,j as i,C as b}from"./ci5tkrccytan34lo.js";import{m as h}from"./nc6572sivljsjb83.js";import{R}from"./ggy463e7z3oap1z2.js";import{C as T}from"./l6i33f76gjin3h6k.js";import{P as M}from"./fseoyhsh6zihamwk.js";import{P as j,a as W}from"./o5dcel4w1cacawdo.js";import{c as O}from"./kdks7d1354ifd7i8.js";import{u as E,W as F}from"./l6qea03icve18kcf.js";import{c as l}from"./t7vnx1cc2uzzkq81.js";import"./fztttvm3qzdvif1h.js";import"./i3g2qaat3974kagr.js";import"./grqqoygx78z5w4fx.js";import"./hapan2fx2czn21gi.js";import"./kzhevji8i57j71hk.js";import"./h2gd34k3oh53zw7p.js";import"./mncmjhre2pa3zjgy.js";import"./ekl1xxb2hl6h9vpu.js";import"./pc2givv05uuq8g6l.js";import"./i4c1gncd98zmt3g7.js";import"./o6tnov12l4y47p1a.js";import"./k4lih7nb4umlxxxc.js";import"./m3p85h1r7wwh3ar4.js";import"./hnwyihljdxrug66f.js";import"./ew5cyvt4eewrp7bl.js";import"./n8xzbxiejwlahre8.js";import"./dpavouct31i6z8p1.js";import"./ivaufcylsc183gln.js";import"./pbe38tec7dql0sh5.js";import"./ci2m3wbqqcn0abts.js";import"./oqppwvh4icbsp0jr.js";import"./n1daj33n3xqfllpk.js";import"./pcjr7askdf0x3oga.js";import"./ddgfe1sz0ssgqmwj.js";import"./ebbe56r21p4nhezb.js";import"./fk846ir6i1xkpllk.js";import"./jq1xbz38gn4vzp5i.js";import"./d6qfcfpf3ythcmx2.js";import"./91eskp17oms2am6q.js";import"./a1fl09gjys8m3drr.js";import"./bgu7mt464bd85qmz.js";import"./ln3t6yic0tgf7gor.js";import"./bb4l02lm4p1hlo2s.js";import"./j3zg44ruze86crbd.js";import"./eykh2s3cx0s4wv4b.js";import"./nplnc7nfjbqgwb50.js";import"./h1rqozkinxrlxfws.js";import"./musjw8fjkljbblfz.js";import"./bgxcr4w8j7zvelhd.js";import"./j35k0ib6x4x2st6f.js";import"./nbtu70bcxl3kbodi.js";import"./iw5jl8v2yszml7o9.js";import"./csx7nt71oz1r0z6y.js";import"./khkh5m0f7cvgfw6e.js";import"./kl37blrmp2daqno8.js";import"./obtq7sfq52r3quc0.js";import"./b6j7l37g2ond00ny.js";import"./ip3ne85ldg7fv7rs.js";import"./j4mjggthdqynoz2x.js";import"./kwkjmzn9zjnazhqf.js";import"./j6dzpp4h0n6rdhxr.js";import"./ouhw3r04e64ny5cd.js";import"./p1uclklbtvr1kdj7.js";import"./kydr9ghab5t92b8t.js";import"./grb7n11yz9748g22.js";import"./npnw55p1aubemod0.js";import"./dnxknpho0o9oqwh9.js";import"./o4bwxynaykkvfft8.js";import"./newlw2rxdofwj7y4.js";import"./nyeubqfi5ppvzgdr.js";function G(t){if(t.post.attachments[0].kind!=="codex")return{task:void 0,turns:void 0};const r=t.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn}}function A({postWithProfile:t}){const r=l(d=>d.addTurnToTaskMap),{task:e,fetchedTurns:o,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:s}=G(t),m=f(),c=y(m,"2818336692"),{focusedAssistantTurn:u,setFocusedAssistantTurnId:x}=E({taskId:e?.id,task:e,currentDiffTaskTurn:s??null,currentUserTurn:n??null,currentAssistantTurn:a??null});p.useEffect(()=>{Object.values(o?.turn_mapping??{}).forEach(d=>{r(e?.id??"",d.turn)})},[o,r,e]);const g=l(({getTurnsForTask:d})=>e?d(e.id):[]);return!e||!g?null:i.jsx(F,{permissions:"read",taskId:e.id,turnId:a?.id??"",task:e,focusedAssistantTurn:u,pastTurns:g,setFocusedAssistantTurnId:x,canFollowUp:!1,lastTurnWithDiffId:s?.id??"",showForkButton:c})}const se=I(function(){const r=b();return r.kind==="forbidden"?i.jsx(U,{chatPageProps:r.chatPageProps,reason:"workspace"}):i.jsx(z,{loaderData:r})});function z({loaderData:t}){p.useEffect(()=>{S.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:t.postWithProfile.post.id,primary_attachment_type:t.postWithProfile.post.attachments?.[0]?.kind,referrer:t.referrer})},[t]);const{session:r}=C(),e=p.useMemo(()=>{const o=P();return _.initThread({clientThreadId:o,conversationMode:{kind:v.PrimaryAssistant},userId:r?.user?.id,accountId:r?.account?.id}),o},[r?.account?.id,r?.user?.id]);return t.postWithProfile.post.attachments?.[0]?.kind==="deep_research"&&t.postWithProfile.post.attachments[0].tags?.includes("deep_research")?i.jsx(R,{postWithProfile:t.postWithProfile,threadId:e}):t.postWithProfile.post.attachments?.[0]?.kind==="codex"?i.jsx(A,{postWithProfile:t.postWithProfile}):i.jsx(N,{postWithProfile:t.postWithProfile,chatPageProps:t.chatPageProps})}function k(t){return{url:`https://ogimg.chatgpt.com/?postId=${t}`,size:[1200,630]}}function $(t,r){if(!t.attachments||t.attachments.length===0)return{url:h.src};const e=t.attachments[0];switch(e.kind){case"media_generation":{const o=e.encodings?.md?.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,n=e.encodings?.unfurl?.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,a=e.encodings?.thumbnail?.path?{url:e.encodings.thumbnail.path}:void 0,s={url:e.url,size:[e.width,e.height]};return r&&o!=null?o:n??a??s}case"message_slice":return k(t.id);default:return{url:h.src}}}function L(t){const r=t.text?.trim();if(r)return r;const e=t.attachments?.[0];return e?.kind==="media_generation"&&e.title?.trim()?e.title.trim():"Shared Content"}const ie=({data:t})=>{const r=t,e={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const u="Privately Shared Content";return[{title:`ChatGPT - ${u}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:u},{property:"og:type",content:"website"},{property:"og:image",content:h.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:h.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:u}]}const{post:o}=r.postWithProfile,n=r.enforceRenderedOgImg?k(o.id):$(o,r.preferIntrinsicAspectRatioForOgImage),a=L(o),s=o.permalink,m=new Date(o.posted_at*1e3).toISOString();return[{title:`ChatGPT - ${a}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:s},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:m},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function U({chatPageProps:t,reason:r}){const e=f();return p.useEffect(()=>{w(e,j,{reason:r})},[]),i.jsx(T,{...t})}function N({postWithProfile:t,chatPageProps:r}){const[e,o]=p.useState(!1),[n]=p.useState(()=>P());if(t.post.attachments&&t.post.attachments.every(s=>s.kind==="message_slice"||s.kind==="deep_research")){const s=t.post.attachments?.filter(c=>c.kind==="message_slice"||c.kind==="deep_research").flatMap(c=>c.messages??[])??[],{threadResponse:m}=O(s);_.updateThreadFromServer(n,m,{skipIfExisting:!0,continuingFromSharedPostId:t.post.id,forkFromSharedPost:!0})}return i.jsxs(W.Provider,{value:{postWithProfile:t,setIsReportModalOpen:o},children:[e&&i.jsx(M,{post:t.post,onClose:()=>o(!1)}),i.jsx(T,{...r,clientThreadId:n})]})}export{se as default,ie as meta};
//# sourceMappingURL=ifzhwpm18cdso8y9.js.map

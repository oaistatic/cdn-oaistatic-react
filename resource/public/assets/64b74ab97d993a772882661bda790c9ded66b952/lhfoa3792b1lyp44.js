import{r as p,j as f,i as T}from"./ci5tkrccytan34lo.js";import{bR as d,s as g,N as l,K as M,ck as C}from"./ccccre6vnqbb7l94.js";import{CoTChunks as k}from"./o48z9mtuhaskw34o.js";import{C as u}from"./cfn5ikk5ru4oac7u.js";import"./oqppwvh4icbsp0jr.js";import"./fztttvm3qzdvif1h.js";import"./hp7xs1ygys4kmfnn.js";import"./ci2m3wbqqcn0abts.js";import"./hapan2fx2czn21gi.js";import"./kzhevji8i57j71hk.js";import"./ggy463e7z3oap1z2.js";import"./i3g2qaat3974kagr.js";import"./grqqoygx78z5w4fx.js";import"./h2gd34k3oh53zw7p.js";import"./mncmjhre2pa3zjgy.js";import"./ekl1xxb2hl6h9vpu.js";import"./pc2givv05uuq8g6l.js";import"./i4c1gncd98zmt3g7.js";import"./o6tnov12l4y47p1a.js";import"./k4lih7nb4umlxxxc.js";import"./m3p85h1r7wwh3ar4.js";import"./hnwyihljdxrug66f.js";import"./t7vnx1cc2uzzkq81.js";import"./ew5cyvt4eewrp7bl.js";import"./n8xzbxiejwlahre8.js";import"./dpavouct31i6z8p1.js";import"./ivaufcylsc183gln.js";import"./pbe38tec7dql0sh5.js";import"./n1daj33n3xqfllpk.js";import"./pcjr7askdf0x3oga.js";import"./ddgfe1sz0ssgqmwj.js";import"./ebbe56r21p4nhezb.js";import"./fk846ir6i1xkpllk.js";import"./jq1xbz38gn4vzp5i.js";const x=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),s=t%60;return`${n}m ${s}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},_=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},y=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:x(e,n)}):d(t)?.metadata?.finished_text??"",R=(e,t,n=!1)=>{const s=[];let o={type:u.Thought,thought:{summary:"",content:""}};const c=()=>{o.thought.content.trim()&&(s.push(o),o={type:u.Thought,thought:{summary:o.thought.summary,content:""}})},m=e.split(/( {2}\n)|(\n\n)/).filter(i=>i!=null&&i.trim());if(!n&&m.length<2)return s;let a=!1;for(let i=0;i<m.length;i++){const r=m[i].trim();if(r.toLowerCase()==="none"){g.count(l.COT_SUMMARIZER,"num_none_chunks");continue}const h=r.match(/^\*\*(.*)\*\*$/);if(h)c(),o.thought.summary=h[1]??"";else if(r){if(r.startsWith("```")){if(a){o.thought.content+=o.thought.content?`
${r}`:r,c(),a=!1;continue}c(),a=!0}o.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!a&&c(),o.thought.content+=o.thought.content?`
${r}`:r}}return o?.thought.content.trim()&&s.push(o),n&&t&&s.push({type:u.Recap,content:t}),s},E=(e,t,n)=>{const s=!n,o=p.useMemo(()=>R(e,t,s),[e,t,s]);return p.useEffect(()=>{s&&g.hist(l.COT_SUMMARIZER,"num_cot_chunks",void 0,o.length)},[s]),o},I=({isStreaming:e,finishedText:t,summaryText:n,isFinalTurn:s})=>{const o=E(n,t,e);return f.jsx(k,{isStreaming:e,isFinalTurn:s,chunks:o})},N=8,O=`

`,ut=({messages:e,isStreaming:t,isFinalTurn:n})=>{const s=T(),{value:o}=M("1214379119"),c=_(e);let m="";return e.forEach(a=>{const i=C(a);m+=m?O+i:i}),o&&!t&&!m&&c<N?null:f.jsx(I,{finishedText:y(s,e,c),summaryText:m,isStreaming:t,isFinalTurn:n})};export{I as LegacyCoT,ut as LegacyCoTMessage};
//# sourceMappingURL=lhfoa3792b1lyp44.js.map

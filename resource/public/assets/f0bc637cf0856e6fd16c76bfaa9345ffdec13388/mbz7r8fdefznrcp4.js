import{f as T,r as p,j as n,a as U,M as D,e as q,am as G}from"./m60bpb0x3x7rg8fj.js";import{R as J,e as K,B as W,b2 as H,aZ as I,P as F,A as ee,aa as x,cn as ae}from"./lgw4q0e8zlqqfgug.js";import{kh as te,ki as se,kj as i,kk as M,kl as N,km as B,kn as v,eB as re,ko as z,cy as oe,aY as ne,el as le,eG as ce,eM as ie,kp as me,cD as w,kq as ue,eJ as pe}from"./ggjzadbnd3k1vu0k.js";import{u as de}from"./jozqsyj8lvw2y89i.js";import{u as fe}from"./ha73j9iy5pkvdx6y.js";import{a as ge,b as ye}from"./glu06a3y5u0laqff.js";import{u as Se,B as he}from"./jh8srhgrrwf9rrcc.js";import{S as be}from"./mb9azmyuz6lg619u.js";const R="country_code",k="step",C=r=>J.safePost("/accounts/pending_team_workspace",{requestBody:r}),_e=({formData:r,onNext:f})=>{const t=T(),[a,u]=p.useState({role:r.role??"",department:r.department??""}),[l,d]=p.useState({}),g=(e,s)=>{u(y=>({...y,[e]:s})),d(y=>({...y,[e]:""}))},S=p.useMemo(()=>{const e=te.map(s=>({label:t.formatMessage(s.displayValue),value:s.id}));return e.sort((s,y)=>s.label.localeCompare(y.label)),e},[t]),o=p.useMemo(()=>{const e=se.map(s=>({label:t.formatMessage(s.displayValue),value:s.id}));return e.sort((s,y)=>s.label.localeCompare(y.label)),e},[t]),c=p.useMemo(()=>[{formType:"select",label:t.formatMessage(i.roleLabel),name:"role",placeholder:t.formatMessage(i.rolePlaceholder),value:a.role,onChange:e=>g("role",e),error:l.role,required:!0,options:o},{formType:"select",label:t.formatMessage(i.workspaceDepartmentLabel),name:"department",placeholder:t.formatMessage(i.workspaceDepartmentPlaceholder),value:a.department,onChange:e=>g("department",e),error:l.department,required:!0,options:S}],[S,l.department,l.role,a.department,a.role,t,o]),m=()=>{const e={};return c.forEach(s=>{s.required&&!a[s.name]&&(e[s.name]=t.formatMessage(i.fieldRequired,{fieldName:s.label}))}),d(e),Object.values(e).every(s=>!s)};return n.jsx(M,{content:n.jsxs(N,{title:t.formatMessage(i.tellUsAboutWorkStepTitle),subTitle:t.formatMessage(i.tellUsAboutWorkStepSubtitle),children:[n.jsx("div",{className:"flex flex-col gap-6",children:c.map(e=>p.createElement(B,{...e,key:e.name}))}),n.jsx(v,{onClick:async()=>{m()&&await f(a)}})]})})},Te={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"},we=({onNext:r,onPrevious:f,pendingWorkspace:t,initialBillingDetails:a,formData:u})=>{const l=T();K();const d=le(),{annualBillingPlan:g}=re(a.currency),S=Math.floor(100-g.discountedMonthlyCost/g.monthlyCost*100),o=U(),c=new URLSearchParams(t?.query_params??"").get(z)??void 0,{selectedPlan:m,setSelectedPlan:e,numSeats:s,setNumSeats:y,promoData:P,TEAM1DOLLAR_COUPON_IsEligible:h,TEAM_FREE_TRIAL_COUPON_IsEligible:b}=Se({initialSeats:u?.numSeats,initialPromoCoupon:c}),{eligible:E,campaignId:V}=oe(),A=P??(!c&&E?{coupon:V,state:"eligible"}:void 0),j={priceInterval:m,billingDetails:a,numSeats:s,promoData:A},Y=h||b,X=h?i.oneDollarPromoTitle:b?i.freeTrialPromoTitle:i.purchaseStepTitle,L=h?i.oneDollarPromoSubtitle:b?i.freeTrialPromoSubtitle:void 0,Z=ne(isNaN(s)?0:s,d,ce);return n.jsx(M,{onPrevious:f?()=>f({...j}):void 0,content:n.jsxs(N,{title:l.formatMessage(X),subTitle:L&&l.formatMessage(L),children:[n.jsxs("div",{className:"flex flex-col gap-6",children:[n.jsx(ie,{numSeats:s,minSeats:d,setNumSeats:y,classNames:Te,label:n.jsx(D,{...i.seatsCountLabel})}),n.jsxs("div",{className:"flex flex-col gap-1.5",children:[n.jsx(me,{required:!0,children:l.formatMessage(i.planSummaryTitle)}),n.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(Y&&m===w.FLEXIBLE)&&n.jsx(be,{ariaLabel:l.formatMessage(i.planTypeLabel),leftItem:{label:n.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:l.formatMessage(i.annualPlanLabel,{percent:S,span:$=>n.jsx("span",{className:"text-[#10A37F]",children:$})})}),value:w.ANNUAL},rightItem:{label:l.formatMessage(i.monthlyPlanLabel),value:w.FLEXIBLE},value:m,onChange:e}),n.jsx(he,{numSeats:Z,selectedPlan:m,billingDetails:a,totalLabel:i.allPlansTodayTotal,billDate:l.formatMessage(i.today),promoData:A})]})]})]}),n.jsx(v,{onClick:()=>r({...j})}),n.jsx(W,{color:"ghost",onClick:()=>o("/"),children:n.jsx(D,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},Pe=({formData:r,onNext:f,onPrevious:t})=>{const a=T(),[u,l]=p.useState({workspaceName:r.workspaceName??"",companySize:r.companySize??""}),[d,g]=p.useState({}),S=(e,s)=>{l(y=>({...y,[e]:s})),g(y=>({...y,[e]:""}))},o=ue.map(e=>({label:typeof e.displayValue=="string"?e.displayValue:a.formatMessage(e.displayValue),value:e.id})),c=p.useMemo(()=>[{formType:"input",label:a.formatMessage(i.workspaceNameLabel),name:"workspaceName",placeholder:a.formatMessage(i.workspaceNamePlaceholder),value:u.workspaceName,onChange:e=>S("workspaceName",e),error:d.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:a.formatMessage(i.workspaceCompanySizeLabel),name:"companySize",placeholder:a.formatMessage(i.workspaceCompanySizePlaceholder),value:u.companySize,onChange:e=>S("companySize",e),error:d.companySize,required:!1,options:o}],[d.companySize,d.workspaceName,u.companySize,u.workspaceName,a,o]),m=()=>{const e={};return c.forEach(s=>{s.required&&!u[s.name]&&(e[s.name]=a.formatMessage(i.fieldRequired,{fieldName:s.label}))}),g(e),Object.values(e).every(s=>!s)};return n.jsx(M,{onPrevious:t?()=>t({...u}):void 0,content:n.jsxs(N,{title:a.formatMessage(i.workspaceNameStepTitle),subTitle:a.formatMessage(i.workspaceNameStepSubtitle),children:[n.jsx("div",{className:"flex flex-col gap-6",children:c.map(e=>p.createElement(B,{...e,key:e.name}))}),n.jsx(v,{disabled:!u.workspaceName,onClick:async()=>{m()&&await f({...u})}})]})})};var Q=(r=>(r.AboutWork="about-work",r.WorkspaceInfo="workspace-info",r.ConfigurePlan="configure-plan",r))(Q||{});const Ee=ae(Object.values(Q),void 0),Oe=({pendingWorkspace:r})=>{const f=T(),[t,a]=p.useState({workspaceName:r?.workspace_name??void 0,role:r?.role??void 0,department:r?.department??void 0,companySize:r?.company_size??void 0,numSeats:r?.seat_quantity??void 0});fe(new URLSearchParams(r?.query_params??"").get(z)??"");const u=ke({data:t}),l=I(),d=q(),g=new URLSearchParams(d.search).get(R)??new URLSearchParams(r?.query_params??"").get(R)??void 0,S=G(),{country:o,userCountry:c}=ge({initialCountryCode:g}),m=ye({country:o,currentAccount:l,location:"TeamDirectSignUpFlow"}),e=Ee(r?.step_name),{step:s,nextStep:y}=xe({initialStep:e&&_.includes(e)?e:void 0});p.useEffect(()=>{r||(()=>{C({step_name:r?.step_name??_[0],query_params:d.search,user_segment:"v1"})})()},[]),p.useEffect(()=>{const h=d.key,E=new URLSearchParams(window.location.search).get("referrer")||document.referrer;F.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",{...l?.subscriptionAnalyticsParams,referrer:E,initialTab:r?.step_name,currentTab:s,locationKey:h,navigationType:S,initialCountrySelectorCountry:g??o,selectedCountry:m.country??"",selectedCurrency:m.currency??"",userCountry:c??""})},[s]);const P=()=>{switch(s){case"about-work":return n.jsx(_e,{formData:t,onNext:async h=>{const b={...t,...h};a(b),await y(b)}});case"workspace-info":return n.jsx(Pe,{formData:t,onNext:async h=>{const b={...t,...h};a(b),await y(b)}});case"configure-plan":return n.jsx(we,{formData:t,initialBillingDetails:m,onNext:async h=>{await u({...t,...h})},pendingWorkspace:r});default:return null}};return n.jsxs(n.Fragment,{children:[n.jsx("title",{children:f.formatMessage(i.teamSignUpPageTitle)}),P()]})},ke=({data:r})=>{const{prepareCheckoutSession:f,navigateToCheckout:t}=de(),a=H(),u=T(),l=I();return p.useCallback(async({priceInterval:g,billingDetails:S,numSeats:o,promoData:c})=>{try{F.logEvent("Account Pay: Payment Checkout Clicked",{planType:ee.SELF_SERVE_BUSINESS,...l?.subscriptionAnalyticsParams,referrer:document.referrer});const m=await f({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:r.workspaceName??"",price_interval:g,seat_quantity:o},billing_details:S,promo_campaign:g===w.FLEXIBLE?c?.coupon:null,cancel_url:window.location.href});await t(m)}catch(m){x.addError(m),a.warning(u.formatMessage(pe.paymentErrorWarning),{hasCloseButton:!0})}},[l?.subscriptionAnalyticsParams,r.workspaceName,u,t,f,a])},O=(r,f)=>{const t=new URLSearchParams(window.location.search);Object.entries(r).forEach(([u,l])=>{t.set(u,l)});const a=`${window.location.pathname}?${t.toString()}`;f?f(a,{replace:!1}):window.history.replaceState(null,"",a)},_=["configure-plan"],xe=({initialStep:r})=>{const f=U(),t=q(),[a,u]=p.useState(()=>{const o=r??_[0];return O({[k]:o}),o}),l=p.useCallback(o=>{u(o),O({[k]:o},f)},[f]),d=p.useRef(null);p.useEffect(()=>{const c=new URLSearchParams(t.search).get(k);c!==d.current&&c&&_.includes(c)&&c!==a&&l(c),d.current=c},[t.search,l,a]);const g=async o=>{let c=a;const m=_.indexOf(a);m>=0&&m<_.length-1&&(c=_[m+1],l(c));try{await C({workspace_name:o.workspaceName,company_size:o.companySize,department:o.department,role:o.role,step_name:c,query_params:t.search,user_segment:"v1"})}catch(e){x.addError(e)}},S=p.useCallback(async o=>{let c=a;const m=_.indexOf(a);m>0&&(c=_[m-1],l(c));try{await C({workspace_name:o.workspaceName,company_size:o.companySize,department:o.department,role:o.role,step_name:c,query_params:t.search,user_segment:"v1"})}catch(e){x.addError(e)}},[t.search,l,a]);return{step:a,nextStep:g,previousStep:S}};export{Oe as C,k as S,ke as u};
//# sourceMappingURL=mbz7r8fdefznrcp4.js.map

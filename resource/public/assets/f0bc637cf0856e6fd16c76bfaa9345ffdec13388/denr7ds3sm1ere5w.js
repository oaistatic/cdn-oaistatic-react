import{r as S,j as n}from"./m60bpb0x3x7rg8fj.js";import{C as G}from"./nqmrqp6oj37scesd.js";import{D as q,a as J}from"./lfugw8qvvom7caj7.js";import{T as K,a as Q,A as M,u as Y,i as Z,C as $,g as z}from"./pclfr6lyaiirijb5.js";import{C as tt,c as et}from"./cum2m9ppsxjdt1u5.js";import{C as V}from"./5a6x9gba3iwtvxlr.js";import{u as ot,a as rt,b as nt,c as k}from"./koh2m2w2ywhm6pl3.js";import{C as it}from"./jy1u8exw8iz2slve.js";import{b as st,dh as lt,jW as U,jX as at}from"./ggjzadbnd3k1vu0k.js";import{cr as ct}from"./lgw4q0e8zlqqfgug.js";import{u as mt}from"./9q3v44p2xpoi75pn.js";import"./j770ggbjd02m3hqj.js";import"./g5bh4mjh9t2vmm93.js";import"./i4rip6yaxdxd1xd5.js";import"./cyridnrl7jpyirze.js";import"./g4h5bud8allgzrnd.js";import"./n70zh1fo8aekhdb0.js";import"./lf8mxjdfum7t34gh.js";import"./d4l47j95cc16bbv9.js";import"./mlo67gs1ylzshmge.js";import"./h81zqbvh0a7amk0o.js";import"./bk8slwxjkdlmxjxm.js";import"./og0mzunrykkt4tp0.js";import"./lff9oru7r5vtmz06.js";import"./tfkm8dsw7zx8il21.js";import"./rx5cs0ja7c7phupc.js";import"./n5yj38pa2aamrsfp.js";import"./mog17ocsx2bkw4q4.js";import"./evlyokzg1xrjbsou.js";import"./n9mc8ay6b1mvrc8r.js";import"./ns51nblw8ziscsgd.js";import"./g61ghrdmm0y010eo.js";import"./kfjcy5y4cxuymbdf.js";import"./imrl18sy28ygoppx.js";import"./kh89q49991ykwivd.js";import"./kl7c6054usfnqmd4.js";import"./mia7qmdupqoji40k.js";import"./cqdszxwxh9yigbop.js";import"./hs2mcew9gnq8d8k8.js";function dt(t,e){const r=t.doc.lineAt(e.from);return e.from===r.from&&e.to-1===r.to}function ut(t){const e=t.dom.querySelector(".cm-gutters");return e?e.offsetWidth:0}const pt=({onAddComment:t,isSendDisabled:e=!1,isWaitingForCommentResponse:r=!1})=>{const o=ot(),p=rt(),c=nt(),L=S.useCallback(i=>{const{height:m,width:d}=i,s=o();if(!p||!s)return null;const l=p.selection.asSingle();if(l.ranges.length===0)return null;const a=l.ranges[0],{empty:H,to:O}=a;let{head:f}=a;const{platform:R}=st();f=R==="web"?f:O;const g=f===O;let v=f;if(g&&dt(p,a)&&(v-=1),H)return null;const{left:h,top:x,bottom:N}=s.contentDOM.getBoundingClientRect(),{left:w,top:_,bottom:E}=ct(s.coordsAtPos(v,g?-1:1)),C=ut(s);function W(){if(g)return Math.max(w-h+C-d,C);let u=w-h+C;return u+d>c&&(u=-(d-c)),u}function j(u){const b=m*2,y=u.contentHeight-(E-N)>b&&window.innerHeight-E>b,B=E-x+8,I=_-x-m-8;return g&&y||I<0?{top:B,aboveOrBelow:M.BELOW}:{top:I,aboveOrBelow:M.ABOVE}}const A=j(s);return{left:W(),top:A.top,aboveOrBelow:A.aboveOrBelow,toolbarSize:i}},[p,o,c]),D=S.useCallback(()=>o()?.dom??null,[o]);return n.jsx(K,{onAddComment:t,isWaitingForCommentResponse:r,isSendDisabled:e,toolbarType:Q.CODE,getToolbarPosition:L,getEditorDom:D,getSelectionRange:()=>{const i=o();if(!i)return null;const{state:m}=i,d=m.selection.asSingle();if(d.ranges.length===0)return null;const s=d.ranges[0],{from:l,to:a}=s;return l==null||a==null?null:{from:l,to:a,sourceFrom:l,sourceTo:a}}})};function ft({diff:t}){return Y(t?.edits??[]),null}function gt(t,e,r){const o=r?z():0;return t<=1e3-o?t-(e?tt:0):t-(e?et:0)}const ee=({comments:t,currentlyStreamingLineIndex:e,isPreview:r=!1,isWaitingForCommentResponse:o=!1,isSendDisabled:p=!1,readonlyReason:c,isRequestActive:L=!1,language:D,value:i,textdocDiff:m,maxLength:d,onAcceleratorsExpandedChange:s,onAddComment:l,onAcceptComment:a,onDismissComment:H,onBlur:O,onSave:f,onChange:R,onCancelRequest:g,getStableCommentId:v=at,commentsMode:h=V.ENABLED,hideToolbar:x,hideAccelerators:N=!1,onSubmitAccelerator:w,modelCursor:_,codemirrorRef:E})=>{const C=S.useRef(null),W=lt(),[{width:j},A]=mt(),u=S.useRef(null),b=t.length>0,y=u.current,B=gt(j,b,Z(y)??!1),I=k(({commentingOn:T})=>T),F=k(({hoveredCommentId:T})=>T),P=k(({focusedCommentId:T})=>T);S.useEffect(()=>{C.current?.UNSAFE_setValue(i||"")},[i]);const X=j-B;return n.jsx("div",{className:it.code,ref:U(A,u),style:W&&r?{margin:"0 16px"}:{},children:n.jsxs(G,{id:"codemirror",comments:h===V.ALL_HIDDEN?void 0:t,commentingOn:I,currentlyStreamingLineIndex:e,hoveredCommentId:F,focusedCommentId:P,language:D,readonlyReason:c,onChange:R,maxLength:d,value:i,textdocDiff:m,editorRef:U(C,E),width:B,modelCursor:_,isPreview:r,hideLineNumbers:W&&r,onBlur:O,onSave:f,children:[n.jsxs(G.EditorChildren,{children:[!x&&n.jsx(pt,{onAddComment:l,isSendDisabled:p,isWaitingForCommentResponse:o}),h!==V.ALL_HIDDEN&&n.jsx("div",{className:b?"me-4":"",children:n.jsx($,{getStableCommentId:v,availableWidth:X,comments:t,commentsMode:h,onAddComment:l,onAcceptComment:a,onDismissComment:H,isWaitingForCommentResponse:o,isRequestActive:L,disableBlockComments:!0})})]}),n.jsxs(G.ContextChildren,{children:[m&&n.jsx(ft,{diff:m}),!N&&n.jsx(q,{isRequestActive:L,isVisuallyHidden:p||!!c?.isStreamingFromNative||c?.isReadonly&&!c.isStreaming,onSubmit:w,onCancel:g,actions:J,onExpandedChange:s})]})]})})};export{ee as CodeComposer};
//# sourceMappingURL=denr7ds3sm1ere5w.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gcl1qef4z2hj5xrz.js","assets/m60bpb0x3x7rg8fj.js","assets/lgw4q0e8zlqqfgug.js","assets/root-otc54kct.css","assets/ojpxse30gfpsrtan.js","assets/kh7rmh4dpsh5j6sg.js","assets/ggjzadbnd3k1vu0k.js","assets/conversation-small-j0gcsxmz.css","assets/otapjlzlzeu2hee0.js","assets/d03j86wbldy8g9mv.js","assets/rx5cs0ja7c7phupc.js","assets/n5yj38pa2aamrsfp.js","assets/ce5qik0i5ey4td3l.js","assets/cm4crpkiqwgux3nn.js","assets/k3qobvm9nqd0qdgv.js","assets/lqxrayj6ap3vzwmb.js","assets/euq7ybw4dhrsufo2.js","assets/9q3v44p2xpoi75pn.js"])))=>i.map(i=>d[i]);
import{b2 as Fe,R as et,am as Ye,bc as Us,dN as Bs,cd as Ls,dO as Ws,e as R,mG as jt,fb as Ct,f5 as wt,fe as qs,du as Gs,jg as Vs,jf as _t,f9 as zs,lE as Ys,Y as Ce,fc as Ke,aa as Oe,ey as He,q as re,G as ie,m8 as Dt,dS as J,kl as Ks,d2 as $s,cs as tt,P as B,z as N,f as V,fB as Qs,s as we,W as Ft,M as Ht,eH as De,ap as le,kF as Xs,Z as se,jc as Zs,aZ as Js,jb as ea,T as z,fC as st,B as It,ft as Mt,sL as ta,d as Ut,sM as sa,sN as aa,qq as na,dU as Bt,e2 as oa,I as ra,aY as Lt,eK as Wt,c as qt,i as at,o as ia,U as la,bG as ca,bH as da,al as ua,fx as nt,aq as ha,oR as ma,oS as pa,h as ge,j as fe,v as Nt,N as Pt,aA as ye,gi as ga,p as xe,aC as fa,hw as kt,hk as xa,fU as _e,dI as Sa,ds as Gt,fV as ce,nl as ot,hl as Vt,e_ as va,a5 as be,bE as zt,mk as Yt,ca as Kt,sO as ba,au as $t,ab as rt,H as it,kU as ya,eM as Tt,h9 as ja,u as Ca,sP as wa,pS as _a,w as Ma,pm as Na,q4 as Pa,sQ as ka,g as Ta,rU as Ea,iO as Aa,e0 as Ze,bT as Ra,dr as Oa,d0 as Da,e5 as Fa,sR as Ha,fp as Ia,s3 as Ua,lQ as Ba,fz as La,sS as Wa,n6 as qa,sT as Ga,a4 as Va,av as Qt,m as za,kk as Xt,c6 as Ya,b_ as Zt,b$ as Jt,ez as Ka,eA as $a,oo as Qa,dT as lt,k as Xa,eR as Za,eD as Ja,k7 as en,eE as es,sU as tn,r as sn,sV as Et,ar as an,f1 as nn,hp as on,jo as rn,g_ as ln,f2 as cn,iZ as dn,cx as un,an as hn,aD as mn,bb as pn,sW as gn,jh as fn,_ as xn,f3 as Sn,gX as vn}from"./lgw4q0e8zlqqfgug.js";import{f as Y,a as ee,r as d,j as e,M as D,m as Se,e as ts,d as Ie,L as ss,A as bn,c as ct,R as as,b as yn}from"./m60bpb0x3x7rg8fj.js";import{cZ as jn,c_ as Cn,d1 as wn,N as te,d3 as _n,d4 as Mn,d9 as Nn,da as Pn,M as ns,aT as os,q3 as kn,jn as rs,cV as Tn,bo as En,bp as An,bq as Rn,j as dt,iJ as On,jo as Dn,q4 as Fn,q5 as Hn,iI as In,h_ as Un,f6 as Bn,q6 as Ln,q7 as Wn,q8 as Ue,q9 as qn,qa as Gn,a3 as Vn,ae as zn,pp as Yn,cy as Kn,qb as $n,k5 as Qn,qc as At,qd as Xn,qe as Zn,qf as ut,k0 as is,qg as ls,qh as Jn,io as cs,ip as eo,qi as ds,qj as to,qk as so,ql as us,oF as hs,qm as ao,bC as no,a8 as oo,hm as je,ho as oe,hH as ms,dJ as ro,dI as io,dw as lo,qn as co,qo as uo,h0 as ht,qp as ho,mE as mo,cv as ps,mF as po,fE as gs,h8 as Be,qq as go,qr as fo,qs as xo,qt as So,qu as vo,qv as bo,qw as yo,cX as jo,qx as Co,lh as wo,fC as fs,qy as _o,b5 as Mo,h6 as No,qz as Po,qA as ko,fB as To,qB as Eo,bz as Ao,qC as Ro,qD as Oo,b6 as Do,qE as Fo,qF as Ho,qG as Io,qH as Uo,qI as Bo,gZ as Lo,er as Wo,u as qo,qJ as Go,ig as Vo,p as zo,qK as Yo,lj as $e,qL as Ko,z as $o,aO as mt,qM as Qo,k7 as Xo,qN as Zo,kM as Jo,q0 as er,q1 as tr,qO as sr,qP as ar,qQ as nr,qR as or,qS as rr,hK as ir,h4 as lr,qT as cr,qU as dr,i0 as ur,b7 as hr,qV as mr,qW as pr,qX as gr,qY as fr,qZ as xr,q_ as Sr,kX as vr,q$ as br,r0 as yr,r1 as jr,r2 as Cr,r3 as wr,r4 as _r,r5 as Mr,r6 as Nr,r7 as Pr,r8 as kr,r9 as Tr,ra as Er,rb as Ar,rc as Rr,rd as Or,re as Dr}from"./ggjzadbnd3k1vu0k.js";import{u as pt,S as Fr,C as Hr,a as Ir}from"./mlqzrqe1i57m6im6.js";import{F as Ur}from"./l9bupap4fyh5egbo.js";import{a as Br}from"./jobqnbdildqzowzf.js";import{P as Lr}from"./gohr301ka7cpfe4s.js";import{I as Wr}from"./hg4s4237azdb5era.js";import"./kfjcy5y4cxuymbdf.js";import{g as qr}from"./h81zqbvh0a7amk0o.js";import{C as Gr}from"./rx5cs0ja7c7phupc.js";const Vr=({image:s,onClose:t,onRequestCompletion:n,clientThreadId:a,currentModelId:o,post:i,canDelete:c,onOpenReport:r})=>{const l=Y(),u=Fe(),f=ee(),[x,S]=d.useState("default"),h=jn(),m=d.useRef(null),p=d.useRef(h);d.useEffect(()=>{p.current=h},[h]);const v=d.useCallback(()=>Cn(l),[l]),g=d.useCallback(()=>{s&&S("inpaint")},[s]),y=d.useCallback(()=>{S("default"),p.current.clearAllDrawings()},[]),b=d.useCallback(()=>{s&&wn({url:s.url,fileName:v()})},[s,v]),C=d.useCallback(()=>m.current?.getImageData(),[]),_=d.useCallback(async()=>{if(window.confirm(l.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await et.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:i.id}}}),f("/",{replace:!0})}catch{u.danger({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post",description:"Error message for deleting a post"},{toastId:"post_receiver_modal.delete_post_error"})}},[i.id,l,u,f]),P=x==="inpaint"?l.formatMessage({id:"TjVqYb",defaultMessage:"Edit Selection"}):i.text??l.formatMessage({id:"htGxHc",defaultMessage:"Image"}),j=d.useCallback(w=>{w.key==="Escape"&&(t(),w.preventDefault())},[t]);return d.useEffect(()=>(document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)),[j]),e.jsx(Ye.Root,{isOpen:!0,onClose:t,testId:"modal-lightbox-post-share",shouldIgnoreClickOutside:x==="inpaint",children:e.jsx(Ye.Overlay,{children:e.jsxs(Ye.Content,{size:"fullscreen",removePopoverStyling:!0,className:"grid min-h-0 grid-rows-[auto_minmax(0,1fr)] overflow-hidden",children:[e.jsxs("header",{className:"flex h-14 w-full items-center justify-between gap-2 px-2 md:px-4",children:[e.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[e.jsx(te,{icon:Us,onClick:t,"aria-label":l.formatMessage({id:"EYLKSm",defaultMessage:"Close"})}),e.jsx("h2",{className:"line-clamp-1 text-base font-medium",children:P})]}),e.jsx("div",{className:"flex items-center gap-2",children:x==="inpaint"?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"aspect-square",icon:_n,onClick:h.undoDrawing,disabled:!h.canUndoDrawing,"aria-label":l.formatMessage({id:"OmaTPx",defaultMessage:"Undo"})}),e.jsx(te,{className:"aspect-square",icon:Mn,onClick:h.redoDrawing,disabled:!h.canRedoDrawing,"aria-label":l.formatMessage({id:"ZUr4oh",defaultMessage:"Redo"})}),e.jsx(te,{className:"w-auto px-3",onClick:y,children:l.formatMessage({id:"D9xvar",defaultMessage:"Cancel"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"aspect-square",icon:Nn,onClick:g,"aria-label":l.formatMessage({id:"pRGwlp",defaultMessage:"Edit image"})}),e.jsx(te,{className:"aspect-square",icon:Pn,onClick:b,"aria-label":l.formatMessage({id:"9DNHka",defaultMessage:"Download image"})}),e.jsx(te,{className:"aspect-square",icon:ns,onClick:r,"aria-label":l.formatMessage({id:"2gNXdX",defaultMessage:"Report content"})}),c&&e.jsx(te,{className:"aspect-square",icon:os,onClick:_,"aria-label":l.formatMessage({id:"rzlDpj",defaultMessage:"Delete post"})})]})})]}),e.jsxs("div",{className:"grid h-full w-full grid-rows-[1fr_auto] items-center overflow-y-auto overscroll-contain",children:[e.jsx("div",{className:"flex h-full w-full items-center justify-center px-4 pb-4",children:s&&e.jsxs("div",{className:"relative inline-block max-h-full rounded bg-neutral-100",children:[e.jsx("img",{src:s.url,alt:P,className:"h-full max-h-[70vh] w-auto max-w-full rounded object-contain",fetchPriority:"high"}),x==="inpaint"&&e.jsx(kn,{image:s,drawingState:h,drawingCanvasRef:m})]})}),e.jsx("div",{className:"flex w-full justify-center px-4 pb-8",children:e.jsx("div",{className:"w-full max-w-[768px]",children:e.jsx(Wr,{clientThreadId:a,currentModelId:o,onRequestCompletion:n,onClose:t,activeImage:s,currentDrawnShape:h.currentDrawnShape,getImageData:C,onCancelInpaint:y})})})]})]})})})};function Qi({postWithProfile:s,clientThreadId:t,onClose:n}){return s.post.attachments[0]?.kind==="media_generation"?e.jsx(zr,{postWithProfile:s,clientThreadId:t,onClose:n}):s.post.attachments[0]?.kind==="message_slice"?e.jsx(Yr,{postWithProfile:s,onClose:n}):null}function zr({postWithProfile:s,clientThreadId:t,onClose:n}){const a=d.useRef(null),[o,i]=d.useState(!1),c=ee(),{post:r}=s,l=r.attachments[r.attachments.length-1],u={url:l.url,content_type:wt.ImageAssetPointer,asset_pointer:l.asset_pointer??Ct(l.id),width:l.width,height:l.height},f=Y(),x=qs(),S=Gs(t),h=Fe(),m=d.useCallback(j=>x.getState().files.find(w=>w.tempId===j),[x]),p=l.url,v=d.useCallback(async j=>{if(a.current){const w=await a.current,F=w?m(w?.tempId):null;if(F)return F}return a.current=fetch(j).then(w=>w.blob()).then(w=>{const F=new File([w],"image.png",{type:"image/png"}),E=Vs(F);return _t.uploadFile(x,E,F,zs.Multimodal,[F.type],f,h).then(()=>{const I=m(E);return I&&I.status===Ys.Ready&&I.fileId?I:null})}),a.current},[x,f,h,m]),{onRequestCompletion:g,currentModelId:y}=dt(),{isUnauthenticated:b}=Ce(),C=d.useCallback(async j=>{if(!(!j.promptMessage||b))try{const w=await v(p);if(!w||!w.fileId||!w.fileSpec)return;const F=[{content_type:wt.ImageAssetPointer,asset_pointer:Ct(w.fileId),size_bytes:w.fileSpec.size,width:l.width,height:l.height},...j.promptMessage.content.content_type===Ke.MultimodalText||j.promptMessage.content.content_type===Ke.Text?j.promptMessage.content.parts:[]],E={...j,promptMessage:{...j.promptMessage,content:{content_type:Ke.MultimodalText,parts:F}},extraStreamParams:{...j.extraStreamParams??{},continueFromSharedPostId:r.id}};g(E),_t.reset(x)}catch(w){Oe.addError(new Error("post_receiver_handle_request_failed",{cause:w})),h.danger({id:"postReceiverModal.editImageError",defaultMessage:"Failed to edit the image",description:"Error message for editing an image"},{toastId:"post_receiver_modal.edit_image_error"})}},[l.height,l.width,v,g,x,p,b,h,r.id]),_={id:r.id,archived:!1,transformationId:null,url:u.url,assetPointer:u.asset_pointer,thumbnail:null,width:u.width,height:u.height,title:null,conversationId:S,messageId:r.id},P=d.useCallback(()=>{n(),c("/",{replace:!0})},[n,c]);return e.jsxs(e.Fragment,{children:[e.jsx(Vr,{image:_,onClose:P,onRequestCompletion:C,clientThreadId:t,currentModelId:y,post:r,canDelete:!!r.permissions.can_delete,onOpenReport:()=>i(!0)}),o&&e.jsx(xs,{post:r,onClose:()=>i(!1)})]})}function Yr({postWithProfile:s,onClose:t}){const[n,a]=d.useState(!1),{post:o}=s;return e.jsxs("div",{className:"bg-token-bg-primary absolute start-0 end-0 top-0 bottom-0 h-full w-full",children:[e.jsx(Kr,{post:o,setIsReportModalOpen:a,onClose:t}),e.jsx(On,{attachments:o.attachments,variant:"fullscreen"}),n&&e.jsx(xs,{post:o,onClose:()=>a(!1)})]})}function Kr({post:s,setIsReportModalOpen:t,onClose:n,additionalButtons:a}){const o=ee(),i=Y(),c=Fe(),r=d.useCallback(async()=>{if(window.confirm(i.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await et.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:s.id}}}),o("/",{replace:!0})}catch{c.danger({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post",description:"Error message for deleting a post"},{toastId:"post_receiver_modal.delete_post_error"})}},[s.id,i,c,o]);return e.jsx(e.Fragment,{children:e.jsxs(Se.div,{className:"flex h-16 w-full px-2 sm:px-4",...Dn,children:[e.jsx("div",{className:"flex items-center justify-self-start text-start",children:e.jsx(Fn,{onClose:()=>{n(),o("/",{replace:!0})}})}),e.jsx("div",{className:"flex w-full flex-1 flex-col items-center justify-center justify-self-stretch",children:e.jsx(Hn,{areButtonsFullWidth:!0,post:s,setIsReportModalOpen:t})}),e.jsxs("div",{className:"flex items-center justify-self-end text-end",children:[s.permissions.can_delete&&e.jsx(In,{tooltip:i.formatMessage({id:"postReceiverModal.deletePost",defaultMessage:"Delete"}),onClick:r,children:e.jsx(os,{})}),a]})]})})}function xs({post:s,onClose:t}){const n=R(),{data:a}=En(n,jt.Post),o=Y(),i=An(n,o,s.id,jt.Post);if(a==null)return null;const c=`Report ${s.text??"Post"}`;return e.jsx(Rn,{reasons:a.reasons,submitReport:i,title:c,onClose:t,header:a.header,subHeader:a.header_explanation})}function $r(){const s=d.useContext(rs),t=s?.postWithProfile?.post,n=s?.setIsReportModalOpen;return!t||!n?null:e.jsxs("div",{className:"outline-token-border-default mx-4 flex items-center justify-between gap-2.5 rounded-2xl py-1 ps-4 pe-0.5 outline-1 outline-offset-[-1px]",children:[e.jsx("span",{className:"text-token-text-secondary justify-center text-sm leading-tight",children:e.jsx(D,{id:"e2L5bY",defaultMessage:"Content created using ChatGPT"})}),e.jsx(Bs,{size:"default",contentAlign:"end",sideOffset:4,triggerButton:e.jsx(Tn,{className:"rounded-full",label:"",icon:e.jsx(Ws,{className:"icon-sm"})}),children:e.jsx(Ls.Item,{icon:ns,onClick:()=>n(!0),children:e.jsx(D,{id:"jHHbcM",defaultMessage:"Flag content as unsafe"})})})]})}function Qr(){const s=d.useContext(rs),t=s?.postWithProfile?.post,n=s?.setIsReportModalOpen;return!t||!n?null:e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(D,{id:"iRpGVT",defaultMessage:"Content created using ChatGPT. <reportButton>Report</reportButton> if unsafe.",values:{reportButton:a=>e.jsx("button",{className:"text-token-text-primary decoration-token-text-primary underline",onClick:()=>{n(!0)},children:a})}})})}function Xr({projectResource:s}){const t=Y(),n=R(),a=s.gizmo?.id,o=He(a),i=re(ie),c=Dt(),r=ts(),l=(()=>{const g=r.pathname.replace(/\/+$/,"");return/^\/g\/[^/]+\/project$/.test(g)})(),u=s.gizmo?.sharing?.subjects?.length??0,f=s.gizmo.display.name,x=J(()=>Ln(n,s)),S=J(()=>Wn(n,s));if(!(o&&u>0&&!i&&!c&&!l)||s.gizmo.gizmo_type!==Ks.PROJECT)return null;const m=f?t.formatMessage(Qe.openProjectHome,{projectName:f}):t.formatMessage(Qe.openProjectHomeFallback),p=$s(n,s),v=e.jsx(e.Fragment,{children:e.jsx(ss,{to:p,"aria-label":m,className:"hover:bg-token-bg-tertiary focus-visible:outline-token-outline-primary text-token-text-secondary ms-2 inline-flex h-9 w-9 items-center justify-center rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:e.jsx(Bn,{color:x,emoji:S,strict:!0,isSharedProject:!0})})});return e.jsxs("div",{className:"flex items-center max-md:hidden",children:[e.jsx(tt,{label:f??t.formatMessage(Qe.projectNameFallback),children:v}),e.jsx(Un,{className:"icon-sm text-token-text-tertiary","aria-hidden":"true"})]})}const Qe=Ie({openProjectHome:{id:"threadHeader.openProjectHome",defaultMessage:"Open {projectName} project"},openProjectHomeFallback:{id:"threadHeader.openProjectHomeFallback",defaultMessage:"Open project home"},projectNameFallback:{id:"threadHeader.projectNameFallback",defaultMessage:"Project"}}),Rt=Ie({bannerBody:{id:"WAgvN5",defaultMessage:"Unlock extra messages, images & more"},dismissBanner:{id:"+X3EGU",defaultMessage:"Dismiss banner"}}),Zr=7*24*60*60*1e3;function Jr(s,t){const n=Date.parse(s.dismissedAt);return Number.isNaN(n)?!0:Date.now()-n>t}function ei(s){const t=Ft.getItem(Ht.ThreadUpgradeBannerDismissedAt);return t?Jr(t,s):!0}function Ss({isDismissible:s,dismissTtlMs:t=Zr}){const[n,a]=d.useState(!1);return d.useEffect(()=>{if(!s){a(!0);return}a(ei(t))},[t,s]),{isVisible:n,dismiss:()=>{if(!s)return;B.logEventWithStatsig("Thread Upgrade Banner Button Dismissed","chatgpt_thread_upgrade_banner_button_dismissed",{type:"banner"});const i={dismissedAt:new Date().toISOString()};Ft.setItem(Ht.ThreadUpgradeBannerDismissedAt,i),a(!1)}}}function vs({isDismissible:s=!0}){const t=ee(),{isVisible:n,dismiss:a}=Ss({isDismissible:s});if(d.useEffect(()=>{n&&B.logEventWithStatsig("Thread Upgrade Banner Button Shown","chatgpt_thread_upgrade_banner_button_shown",{type:"banner"})},[n]),!n)return null;const o=()=>{B.logEventWithStatsig("Thread Upgrade Banner Button Clicked","chatgpt_thread_upgrade_banner_button_clicked",{type:"banner"}),we(t,"thread_splash_upgrade_banner_cta")};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:o,className:N("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden",s&&"pe-7",!s&&"pe-4"),children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:e.jsx(Ue,{className:"icon-sm","aria-hidden":"true"})}),e.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:e.jsx(D,{...Rt.bannerBody})})]}),e.jsxs("span",{className:N("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:[e.jsx("span",{className:"hidden sm:inline",children:e.jsx(D,{...V.upgradePlan})}),e.jsx("span",{className:"sm:hidden",children:e.jsx(D,{...V.upgrade})}),!s&&e.jsx(Qs,{className:"icon-xs"})]})]}),s&&e.jsxs("button",{type:"button",onClick:i=>{i.stopPropagation(),a()},className:N("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),children:[e.jsx(qn,{className:"icon-xs","aria-hidden":"true"}),e.jsx("span",{className:"sr-only",children:e.jsx(D,{...Rt.dismissBanner})})]})]})}var bs=(s=>(s.GENERIC="generic",s.GENERIC_FREE_TRIAL="generic_free_trial",s.GO="go",s.PLUS="plus",s.BANNER="banner",s))(bs||{});function Le({clientThreadId:s,variant:t}){const n=R(),a=Gn(),{enableThreadHeaderUpgradePill:o}=Vn(),{enableNewSplashUpgradeBanner:i,newUpsellsDismissible:c}=zn(),{isVisible:r}=Ss({isDismissible:c()}),l=De(s),u=le(s,p=>z.hasUserMessage(p)),f=Xs(),x=se(n,"4048646334"),S=f?.call_to_action?.includes(Zs.GET_PLUS),m=a&&(l&&!u)&&o&&!(S&&!x.get("should_show_thread_header_upgrade_pill",!0));return t==="banner"?{shouldShow:m&&r&&i(),newUpsellsDismissible:c}:{shouldShow:m&&!i(),newUpsellsDismissible:()=>!1}}function ti(){const s=R(),t=Js(),{eligible:n}=Yn(),{eligible:a}=Kn(),o=n||a;if(!t)return null;let i="generic";if(o)i="generic_free_trial";else if(ea(s))i="go";else{const r=se(s,"497415788").get("upgrade_pill_type","plus");if(ri(r))i=r;else return null}switch(i){case"generic":return e.jsx(ni,{});case"generic_free_trial":return e.jsx(oi,{});case"plus":return e.jsx(si,{});case"go":return e.jsx(ai,{});case"banner":return null}}function si(){const s=ee(),t=R(),n=()=>{we(s,"thread_header_get_plus_pill")};return e.jsxs(We,{onClick:n,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"plus",children:[e.jsx(Ue,{className:"icon-sm"}),e.jsx(D,{...ii(t)})]})}function ai(){const s=ee(),t=()=>{we(s,"thread_header_get_plus_pill")};return e.jsxs(We,{onClick:t,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"go",children:[e.jsx($n,{className:"icon-sm"}),e.jsx(D,{...V.upgradeToGo})]})}function ni(){const s=ee(),t=()=>{we(s,"thread_header_generic_upgrade_pill_button")};return e.jsxs(We,{onClick:t,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic",children:[e.jsx(Ue,{className:"icon-sm"}),e.jsx(D,{...V.upgrade})]})}function oi(){const s=ee(),t=()=>{we(s,"thread_header_generic_free_trial_upgrade_pill_button")};return e.jsxs(We,{onClick:t,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic_free_trial",children:[e.jsx(Ue,{className:"icon-sm"}),e.jsx(D,{...V.upgradeForFree})]})}function We({children:s,className:t,onClick:n,type:a}){d.useEffect(()=>{B.logEventWithStatsig("Thread Header Upgrade Pill Button Shown","chatgpt_thread_header_upgrade_pill_button_shown",{type:a})},[a]);const o=()=>{B.logEventWithStatsig("Thread Header Upgrade Pill Button Clicked","chatgpt_thread_header_upgrade_pill_button_clicked",{type:a}),n()};return e.jsx("button",{onClick:o,className:N("flex items-center gap-1 rounded-full py-2 ps-2.5 pe-3 text-sm font-medium",t),children:s})}function ri(s){return Object.values(bs).includes(s)}function ii(s){switch(se(s,"497415788").get("plus_upgrade_pill_cta","get_plus")){case"try_plus":return V.tryPlus;case"upgrade_to_plus":return V.upgradeToPlus;case"upgrade_your_plan":return V.upgradeYourPlan;case"upgrade_plan":return V.upgradePlan;case"get_plus":default:return V.getPlus}}function Ot({clientThreadId:s,onClick:t}){d.useEffect(()=>{sa(s)},[s]);const n=Y();return e.jsx(Se.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(cs,{onClick:()=>{aa(s),t()},label:n.formatMessage(Je.moreStarterPrompts)})})}function li({starterPrompt:s,starterPrompts:t,index:n,disabled:a,onSelectStarterPrompt:o}){const i=s.theme??s.title,c=Jn(),{mutate:r}=ta(),l=s.category==="onboarding"?u=>{r({key:Ut.hasUsedConversationalOnboardingStarterPrompt}),c(u,s,t,n)}:u=>o?.(u,s,t,n);return e.jsx(cs,{disabled:a,onClick:l,icon:e.jsx(eo,{category:s.category,useV2Colors:!0}),label:i})}const ci=5,di=3;function ys({starterPrompts:s,onSelectStarterPrompt:t,disabled:n,clientThreadId:a,onExpand:o,mobileLayout:i=!1}){const c=i?di:ci,[r,l]=d.useState(c),[u,f]=d.useState(!1),x=d.useRef(null),S=s.length<=r;d.useEffect(()=>{Mt(s.slice(0,c),a)},[a]),d.useEffect(()=>{if(!u&&!S&&x.current){const m=x.current,p=m.getBoundingClientRect(),v=p.width,g=Array.from(m.children);let y=0;for(let b=0;b<g.length&&g[b].getBoundingClientRect().right-p.left<=v;b++)y++;l(y),f(!0)}},[s,S,u]);const h=()=>{const m=s.slice(r,s.length).map(p=>({...p,isAdditional:!0}));m.length>0&&Mt(m,a),l(s.length),o()};return e.jsxs("div",{"data-testid":"starter-prompt-chips",className:N("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",u&&s.length>0?"opacity-100":"opacity-[0.01]",i?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:N("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",S||i?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:x,children:[s.slice(0,r).map((m,p)=>e.jsx(Se.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(li,{starterPrompt:m,starterPrompts:s,index:p,disabled:n,onSelectStarterPrompt:t})},m.id??p)),i&&s.length>r&&e.jsx(Ot,{clientThreadId:a,onClick:h})]}),!i&&s.length>r&&e.jsx(Ot,{clientThreadId:a,onClick:h})]})}const ui=({clientThreadId:s,currentModelId:t,isModelLoaded:n})=>{const[a,o]=d.useState(!1),i=st(),{prospectiveModelId:c}=is(s),r=n?t:c??"auto",{promptStarters:l,shouldShowStarterPrompts:u,onSelectStarterPrompt:f}=ls({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:r});return e.jsx(Se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:N(u&&!a&&"h-[116px]"),children:u&&l&&e.jsx(ys,{starterPrompts:l,onSelectStarterPrompt:f,disabled:i,clientThreadId:s,onExpand:()=>o(!0),mobileLayout:!0})})},hi=({currentModelId:s,clientThreadId:t,isModelLoaded:n})=>{const{isUnauthenticated:a}=Ce(),o=ut(),[i,c]=d.useState(!1),r=st(),{prospectiveModelId:l}=is(t),u=n?s:l??"auto",{promptStarters:f,shouldShowStarterPrompts:x,onSelectStarterPrompt:S}=ls({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t,limit:8,modelSlug:u}),{shouldShow:h}=Le({clientThreadId:t,variant:"banner"}),m=x&&f;return h&&!m?null:e.jsx(Se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:N("max-w-full max-sm:hidden",!o&&"min-h-[108px]",a&&i||o?"":"h-[70px]"),children:m&&e.jsx(ys,{starterPrompts:f,onSelectStarterPrompt:S,disabled:r,clientThreadId:t,onExpand:()=>c(!0)})})};function js({className:s}){const t=Y(),n=st(),a=Qn(),[o,i]=d.useState(At(a,[],4,2)),c=()=>{i(At(a,o,4,2))};return!a||a.length===0?null:e.jsxs("div",{className:N("flex w-full flex-col gap-y-4",s),children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("div",{className:"text-token-text-secondary text-base leading-7 sm:text-sm",children:t.formatMessage(Je.trySomethingNew)}),e.jsx(It,{type:"button",onClick:c,label:t.formatMessage(Je.shuffleTiles),color:"ghost",size:"medium",icon:Xn})]}),e.jsx("div",{"data-testid":"starter-prompt-tiles",className:"grid grid-cols-2 gap-2 sm:flex sm:flex-row sm:gap-3",children:Array.from({length:4}).map((r,l)=>{const u=o[l];return u?e.jsx("div",{className:"max-sm:short:h-[116px] relative h-[132px] w-full flex-1 sm:h-[144px] sm:basis-0",children:e.jsx(bn,{initial:!1,children:e.jsx(Se.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeOut"},className:"absolute inset-0 h-full w-full",children:e.jsx(Zn,{starterPrompt:u,allPrompts:a,index:l,disabled:n,className:"h-full w-full"})},u.id)})},l):e.jsx("div",{},l)})})]})}const Je=Ie({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"},trySomethingNew:{id:"StarterPromptTiles.trySomethingNew",defaultMessage:"Try something new"},shuffleTiles:{id:"StarterPromptTiles.shuffle",defaultMessage:"Shuffle"}});function mi(s){"use forget";const t=ct.c(21),{clientThreadId:n,headlineOption:a,starterPromptStyle:o,currentModelId:i,isModelLoaded:c,overrideMessage:r}=s,l=us(),u=nt();let f;t[0]!==u?(f=hs(u),t[0]=u,t[1]=f):f=t[1];const x=J(f.shouldShowAutocomplete$);let S;t[2]!==n?(S={shouldBeEnabledForDefaultAssistant:!0,clientThreadId:n},t[2]=n,t[3]=S):S=t[3];const h=ao(S),m=l?"keyboard-open:h-[calc(100%-var(--screen-keyboard-height,0px)-var(--composer-height,100px))] h-full motion-safe:[transition:height_0.3s_var(--easing-common)]":"h-full",p=x?"pointer-events-none opacity-0":"opacity-100";let v;t[4]!==m||t[5]!==p?(v=N("text-token-text-primary mt-[var(--screen-optical-compact-offset-amount)] [display:var(--display-hidden-until-loaded,flex)] w-full shrink flex-col items-center justify-center px-4 transition-opacity sm:hidden",m,p),t[4]=m,t[5]=p,t[6]=v):v=t[6];let g;t[7]!==a||t[8]!==r||t[9]!==o?(g=a==="CHATGPT_LOGO"?e.jsx(Lt,{className:"inline-block h-12 w-12"}):o!=="tiles"?e.jsx(Cs,{headlineOption:a,overrideMessage:r}):null,t[7]=a,t[8]=r,t[9]=o,t[10]=g):g=t[10];let y;t[11]!==n||t[12]!==i||t[13]!==c||t[14]!==h||t[15]!==o?(y=o==="chips"||!h?e.jsx(ui,{isModelLoaded:c,currentModelId:i,clientThreadId:n}):o==="tiles"&&c&&i&&n?e.jsx(js,{}):null,t[11]=n,t[12]=i,t[13]=c,t[14]=h,t[15]=o,t[16]=y):y=t[16];let b;return t[17]!==v||t[18]!==g||t[19]!==y?(b=e.jsxs("div",{className:v,children:[g,y]}),t[17]=v,t[18]=g,t[19]=y,t[20]=b):b=t[20],b}function pi({activeSystemHintType:s,isAnonModeEnabled:t,currentModelId:n}){if(s===ra.Research)return M.deepResearchPlaceholder;const o=oa(s);if(n==="n7jupd"||o)return M.whatCanIDo}function gi(s){"use forget";const t=ct.c(22),{clientThreadId:n,currentModelId:a,isModelLoaded:o}=s,i=R(),{isUnauthenticated:c}=Ce(),r=na();let l;if(t[0]!==i||t[1]!==c){const b=se(i,"4031588851"),C=se(i,"3533083032",{disableExposureLog:!0});l=(c?C:b).get("headline_option","HELP_WITH"),t[0]=i,t[1]=c,t[2]=l}else l=t[2];const u=l;let f;t[3]!==n?(f={shouldBeEnabledForDefaultAssistant:!0,clientThreadId:n},t[3]=n,t[4]=f):f=t[4];const x=ds(f),S=Bt();let h;t[5]!==S||t[6]!==a||t[7]!==r?(h=pi({activeSystemHintType:S,isAnonModeEnabled:r,currentModelId:a}),t[5]=S,t[6]=a,t[7]=r,t[8]=h):h=t[8];const m=h;let p;t[9]!==u||t[10]!==m?(p=e.jsx("div",{className:"mb-7 hidden text-center sm:block",children:u==="CHATGPT_LOGO"?e.jsx(Lt,{className:"inline-block h-12 w-12"}):e.jsx(Cs,{headlineOption:u,overrideMessage:m})}),t[9]=u,t[10]=m,t[11]=p):p=t[11];const v=x;let g;t[12]!==n||t[13]!==a||t[14]!==u||t[15]!==m||t[16]!==o||t[17]!==v?(g=e.jsx(mi,{headlineOption:u,starterPromptStyle:v,clientThreadId:n,isModelLoaded:o,currentModelId:a,overrideMessage:m}),t[12]=n,t[13]=a,t[14]=u,t[15]=m,t[16]=o,t[17]=v,t[18]=g):g=t[18];let y;return t[19]!==p||t[20]!==g?(y=e.jsxs("div",{className:"flex justify-center",children:[p,g]}),t[19]=p,t[20]=g,t[21]=y):y=t[21],y}function fi({headlineOption:s,overrideMessage:t}){"use forget";function n({name:b}){const C=R();return e.jsx(tt,{label:i.formatMessage(M.editNicknameTooltip),delayDuration:300,side:"top",children:e.jsx("button",{onClick:()=>{ye.setAutoHighlightNicknameInput(!0),oo(C)},style:{textDecoration:"none",transition:"color 0.2s"},onMouseEnter:_=>{_.currentTarget.className="text-token-text-secondary"},onMouseLeave:_=>{_.currentTarget.className="text-inherit"},children:b})})}function a(){const b=[],C=[];b.push("READY_WHEN_YOU_ARE","ON_YOUR_MIND","WHAT_ARE_YOU_WORKING_ON","AGENDA_TODAY","SHOULD_WE_BEGIN"),C.push("GOOD_TO_SEE_YOU","DIVE_IN","HOW_CAN_I_HELP",...b);const _=C[Math.floor(Math.random()*C.length)],j=`${b[Math.floor(Math.random()*b.length)]} | ${_}`;ge.setCookie(fe.headlineMessage,j)}function o(){const b=ge.getCookie(fe.GreetingName),_=ge.getCookie(fe.headlineMessage)?.split("|"),P=_?.[0]?.trim(),j=_?.[1]?.trim();return{cookieName:b,isReadyForPersonalized:!!b&&b.length<=l,headline:P,namedHeadline:j}}const i=Y(),c=R(),r=se(c,"1704793646"),l=r.get("name_char_limit",20),[u,f]=d.useState(o),{isUnauthenticated:x}=Ce(),S=ha(),m=ma(!x&&!!S)?.data,p=no(),v=r.get("greeting_web",!1),g=r.get("full_name_llm",!1);d.useEffect(()=>{if(v&&p){if(S&&m){const b=pa(m,S,g);ge.setCookie(fe.GreetingName,b),Nt.count(Pt.MOONSHINE,"splashScreenV2.greeting_cookie_name_set_web")}a()}else ge.deleteCookie(fe.GreetingName),ge.deleteCookie(fe.headlineMessage)},[m,S,v,g,p]),d.useEffect(()=>{const b=()=>{if(v&&p){const{cookieName:C,isReadyForPersonalized:_}=o();f(P=>({...P,cookieName:C,isReadyForPersonalized:_}))}};return window.addEventListener("refreshGreeting",b),()=>window.removeEventListener("refreshGreeting",b)}),d.useEffect(()=>{v&&p&&Nt.count(Pt.MOONSHINE,"splashScreenV2.greeting_shown_web")},[v,p]);let y;return t?y=i.formatMessage(t):u.isReadyForPersonalized&&v?y=e.jsx(e.Fragment,{children:e.jsx(D,{...Xe[u.namedHeadline??s].withName,values:{name:e.jsx(n,{name:u.cookieName??""},"name")}})}):v&&u.headline?y=i.formatMessage(Xe[u.headline].original):y=i.formatMessage(Xe[s].original),y}function Cs(s){"use forget";const t=ct.c(27),{headlineOption:n,overrideMessage:a}=s,o=Wt(),i=d.useRef(null);let c;t[0]!==o?(c={isTempChatVisible:o,titleTranslate:0},t[0]=o,t[1]=c):c=t[1];const[r,l]=d.useState(c);let u,f;t[2]!==o?(u=()=>{l({isTempChatVisible:o,titleTranslate:o?-((i.current?.offsetHeight??0)-40):0})},f=[o],t[2]=o,t[3]=u,t[4]=f):(u=t[3],f=t[4]),qt(u,f);const x=Y(),S=R();let h;t[5]!==S?(h=!at(S)&&(to(ga())||se(S,"2118136551").get("show_chatgpt_h1",!1)),t[5]=S,t[6]=h):h=t[6];const m=h,p=ia(la.DeveloperMode).data,{openSettings:v}=ca();let g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g={viewTransitionName:"var(--vt-splash-screen-headline)"},t[7]=g):g=t[7];let y;t[8]!==n||t[9]!==x||t[10]!==m||t[11]!==p||t[12]!==o||t[13]!==v||t[14]!==a||t[15]!==r.isTempChatVisible||t[16]!==r.titleTranslate?(y=p?e.jsxs("div",{className:N("text-page-header flex flex-col items-center gap-2",r.isTempChatVisible?"invisible opacity-0":"opacity-100"),children:[e.jsx("h1",{className:"text-[28px] leading-[34px] font-normal tracking-[0.38px]",children:e.jsx(D,{...M.developerModeTitle})}),e.jsx("p",{className:"text-token-text-secondary dark:text-token-text-tertiary max-w-md text-center text-base leading-[24px] font-normal tracking-[-0.32px] text-balance",children:e.jsx(D,{...M.developerModeSubtitle,values:{settings:e.jsx(da,{onClick:()=>v(ua.ConnectorsAdvanced),children:e.jsx(D,{...M.settingsLink})})}})})]}):m?e.jsx("h1",{className:"mb-4",children:x.formatMessage(M.chatgpt)}):e.jsx("h1",{className:N("text-page-header inline-flex min-h-10.5 items-baseline whitespace-pre-wrap motion-safe:[transition:0.25s_transform_var(--spring-standard),0.2s_opacity_var(--spring-standard),0.3s_visibility_var(--spring-standard)]",r.isTempChatVisible?"invisible opacity-0":"opacity-100"),"aria-hidden":o,style:{transform:`translateY(${r.titleTranslate}px)`},children:e.jsx("div",{className:"px-1 text-pretty whitespace-pre-wrap",children:e.jsx(fi,{headlineOption:n,overrideMessage:a})})}),t[8]=n,t[9]=x,t[10]=m,t[11]=p,t[12]=o,t[13]=v,t[14]=a,t[15]=r.isTempChatVisible,t[16]=r.titleTranslate,t[17]=y):y=t[17];const b=r.isTempChatVisible?"translate-y-0 opacity-100":"invisible translate-y-10 opacity-0";let C;t[18]!==b?(C=N("absolute bottom-0 motion-safe:[transition:0.25s_transform_var(--spring-standard),0.2s_opacity_var(--spring-standard),0.3s_visibility_var(--spring-standard)]",b),t[18]=b,t[19]=C):C=t[19];const _=!o;let P;t[20]===Symbol.for("react.memo_cache_sentinel")?(P=e.jsx(so,{}),t[20]=P):P=t[20];let j;t[21]!==C||t[22]!==_?(j=e.jsx("div",{className:C,"aria-hidden":_,ref:i,children:P}),t[21]=C,t[22]=_,t[23]=j):j=t[23];let w;return t[24]!==j||t[25]!==y?(w=e.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl leading-9 font-semibold",children:e.jsx("div",{children:e.jsxs("div",{className:"grid-cols-1 items-center justify-end",style:g,children:[y,j]})})}),t[24]=j,t[25]=y,t[26]=w):w=t[26],w}const M=Ie({developerModeTitle:{id:"SplashScreenV2.developerModeTitle",defaultMessage:"Developer mode"},developerModeSubtitle:{id:"SplashScreenV2.developerModeSubtitle",defaultMessage:"Memory is not used for this chat. {settings}"},settingsLink:{id:"SplashScreenV2.settingsLink",defaultMessage:"Settings"},whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whatCanIHelpWithWithName:{id:"SplashScreenV2.whatCanIHelpWith.withName",defaultMessage:"What can I help with, {name}?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},whereShouldWeStartWithName:{id:"SplashScreenV2.whereShouldWeStart.withName",defaultMessage:"Where should we start, {name}?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},askChatgptAnythingWithName:{id:"SplashScreenV2.askChatgptAnything.withName",defaultMessage:"Ask ChatGPT anything, {name}"},shouldWeBegin:{id:"SplashScreenV2.shouldWeBegin",defaultMessage:"Where should we begin?"},goodToSeeYouWithName:{id:"SplashScreenV2.goodToSeeYou.withName",defaultMessage:"Good to see you, {name}."},diveInWithName:{id:"SplashScreenV2.diveInWithName",defaultMessage:"Hey, {name}. Ready to dive in?"},readyWhenYouAre:{id:"SplashScreenV2.readyWhenYouAre",defaultMessage:"Ready when you are."},onYourMind:{id:"SplashScreenV2.onYourMind",defaultMessage:"What's on your mind today?"},whatAreYouWorkingOn:{id:"SplashScreenV2.whatAreYouWorkingOn",defaultMessage:"What are you working on?"},agendaToday:{id:"SplashScreenV2.agendaToday",defaultMessage:"What's on the agenda today?"},deepResearchPlaceholder:{id:"G1v9do",defaultMessage:"What are you researching?"},editNicknameTooltip:{id:"SplashScreenV2.editNicknameTooltip",defaultMessage:"Edit nickname"},howCanIHelp:{id:"SplashScreenV2.howCanIHelp",defaultMessage:"How can I help?"},howCanIHelpWithName:{id:"SplashScreenV2.howCanIHelp.withName",defaultMessage:"How can I help, {name}?"},chatgpt:{id:"SplashScreenV2.chatgpt",defaultMessage:"ChatGPT"},whatCanIDo:{id:"SplashScreenV2.whatCanIDo",defaultMessage:"What can I do for you?"}}),Xe={HELP_WITH:{original:M.whatCanIHelpWith,withName:M.whatCanIHelpWithWithName},WHERE_TO_START:{original:M.whereShouldWeStart,withName:M.whereShouldWeStartWithName},ASK_CHATGPT:{original:M.askChatgptAnything,withName:M.askChatgptAnythingWithName},HOW_CAN_I_HELP:{original:M.howCanIHelp,withName:M.howCanIHelpWithName},GOOD_TO_SEE_YOU:{original:M.goodToSeeYouWithName,withName:M.goodToSeeYouWithName},DIVE_IN:{original:M.diveInWithName,withName:M.diveInWithName},READY_WHEN_YOU_ARE:{original:M.readyWhenYouAre,withName:M.readyWhenYouAre},ON_YOUR_MIND:{original:M.onYourMind,withName:M.onYourMind},WHAT_ARE_YOU_WORKING_ON:{original:M.whatAreYouWorkingOn,withName:M.whatAreYouWorkingOn},AGENDA_TODAY:{original:M.agendaToday,withName:M.agendaToday},SHOULD_WE_BEGIN:{original:M.shouldWeBegin,withName:M.shouldWeBegin},WHAT_CAN_I_DO:{original:M.whatCanIDo,withName:M.whatCanIDo}};function xi(s){const t=z.getConversationTurns(s),n=t.findIndex(o=>o.role===fa.Assistant);if(n===-1)return;const a=t[n];for(let o=0;o<a.messageGroups.length;o++)if(a.messageGroups[o].type===kt.SearchGPTQuery){const c=a.messageGroups.slice(o+1).find(({type:l})=>l===kt.Text);if(c==null)return;const r=xa(c.messages[0]);if(r?.[0]?.type==="navigation")return{turnIndex:n,navigationCitation:r[0],message:c.messages[0]}}}function Si(s,t){if(t==null||s==null)return s;const n=new Set(s.domains.map(a=>a.url));return{...s,domains:[...s.domains,...t.domains.filter(a=>!n.has(a.url))],safe_urls:[...s.safe_urls??[],...t.safe_urls??[]]}}function vi({query:s}){return e.jsx(je,{horizontalPadding:"standard",children:e.jsx(oe,{className:ms({isUserTurn:!0}),children:e.jsx("div",{className:qr(!0),children:e.jsx(ro,{containsImagesOrAttachments:!1,children:e.jsx(io,{text:s})})})})})}function bi({clientThreadId:s,prefetchNavlink:t,clearPrefetchNavlink:n}){const a=d.use(t),o=R(),i=xe(o,"1032814809");d.useEffect(()=>{window.__oai_SSR_NAVLINK&&lo.logEvent("Search Tool Page Load Time To Fast Nav SSR",{server_timing:a?.timing},window.__oai_SSR_NAVLINK)},[]),d.useEffect(()=>{a==null&&n()},[a,n]);const c=d.useMemo(()=>a==null?null:{...a.navlink,domains:a.navlink.domains.map(u=>({...u,subtitle:u.subtitle??u.domain}))},[a]),r=le(s,xi),l=d.useMemo(()=>Si(c,r?.navigationCitation),[r,c]);return a==null||l==null?null:e.jsxs("div",{children:[e.jsx("div",{className:"mt-10",children:e.jsx(je,{horizontalPadding:"standard",children:e.jsxs(oe,{className:ms({isUserTurn:!1}),children:[e.jsx(co,{clientThreadId:s,turnIndex:r?.turnIndex??2,nextMessage:r?.message,navigationCitation:l}),i?e.jsxs("div",{className:"text-token-text-secondary relative -top-2 flex justify-end gap-2 font-mono text-xs",children:[e.jsxs("div",{elementtiming:"navlink",children:["server: ",a.timing,"ms"]}),e.jsx(yi,{})]}):null]})})}),e.jsx(uo,{scriptSrc:"requestAnimationFrame(()=>window.__oai_SSR_NAVLINK=window.__oai_SSR_NAVLINK||performance.now());"})]})}function yi(){const[s,t]=d.useState(null);return d.useEffect(()=>{const n=new PerformanceObserver(a=>{a.getEntries().forEach(o=>{if(o.identifier==="navlink"){const i=o.renderTime;t(c=>c??i)}})});return n.observe({type:"element",buffered:!0}),()=>n.disconnect()},[]),s==null?null:e.jsxs("span",{children:["render: ",s,"ms"]})}function ws(s){const{prefetchNavlink:t,clearPrefetchNavlink:n,clientThreadId:a,pageLoadSearchQuery:o}=s,i=R(),c=ht(i),r=ho(a),l=us(),u=mo(),f=_e(i),x=ie(i),{isOpen:S}=ps(),h=u.store.useContentAreaDimensions(po.Header,g=>g?.height?g.height:void 0);let m=null;h||(m=!c&&S?"max-sm:pb-25":"pb-25",f?m="pb-10":x&&(m="pb-0"));let p=e.jsx(ji,{isNewScrollEnabled:c,...s});const v=pt();return v&&(p=e.jsx(Fr,{clientThreadId:a,children:p})),p=e.jsx(gs,{clientThreadId:a,children:p}),e.jsxs("div",{onCopy:r,className:N("flex flex-col text-sm",ce(i)&&v?"pt-4":"thread-xl:pt-header-height",l&&"keyboard-open:pb-[calc(var(--composer-height,100px)+var(--screen-keyboard-height,0))]",m),style:{paddingBottom:h},children:[o&&e.jsx("div",{children:e.jsx(vi,{query:o})}),t?e.jsx(Sa,{name:"prefetch-navlink",onError:g=>{Oe.addError("Error with prefetch navlink",{error:g}),n()},children:e.jsx(d.Suspense,{fallback:null,children:e.jsx(bi,{clientThreadId:a,prefetchNavlink:t,clearPrefetchNavlink:n})})}):null,e.jsx(Gt,{children:p})]})}function ji({onRequestCompletion:s,clientThreadId:t,scrollContainerRef:n,isNewScrollEnabled:a}){const o=R(),[i,c,r]=le(t,E=>[z.getConversationTurnIds(E),E?.conversationOrigin===Kt.APPLE,E?.scrollToMessageId]),l=ot(),u=Be(),f=Vt(),x=go(),[S]=fo(),h=xo(),[m]=So(),p=va(t);vo({isSharedConversation:l,clientThreadId:t}),d.useEffect(()=>{l&&(be.logEvent("chatgpt_continue_conversation_page_loaded"),B.logEvent("Continue Conversation: Page Loaded"),be.logEvent("chatgpt_conversation_share_page_loaded"),B.logEvent("Share Public Chat: Shared Conversation Loaded"))},[l]);const v=d.useCallback(()=>{a||x({behavior:"smooth"})},[a,x]),[g,y]=re(E=>[_e(E),ie(E)]),b=y||ce(o)&&g,[C,_]=d.useState(!1),P=(C||!1)&&!y,j=d.useRef(null),w=bo(t),F=u&&!f;return e.jsxs(e.Fragment,{children:[F&&e.jsx($r,{}),l&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(D,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),e.jsx("div",{className:"text-token-text-primary mb-5 text-center text-xs font-semibold",children:e.jsx("button",{onClick:()=>{ye.openModal(zt.ReportConversation),be.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),B.logEvent("Share Public Chat: Report Content Clicked",{location:"Dynamic Shared Thread Page"})},children:e.jsx(D,{id:"thread.reportSharedConversation",defaultMessage:"Report conversation"})})})]}),i.map((E,I)=>e.jsx(Hr,{isFinalTurn:I===i.length-1,turnIndex:I,clientThreadId:t,onRequestCompletion:s,currentModelId:p?.id??null,scrollToBottom:a?void 0:v,scrollToMessageId:a?void 0:r,dateHeaderType:w(I),hideUserActions:b},E)),!a&&e.jsxs(e.Fragment,{children:[n?.current&&e.jsx(Yt,{setIsScrolledToEdge:E=>{_(E)},options:{root:n.current,threshold:0,rootMargin:"0%"}},"threadBottomEdgeScrollObserver"),e.jsx("div",{ref:j}),c&&S&&!m&&e.jsx(yo,{className:N("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{be.logEvent("chatgpt_thread_scroll_to_top"),h({behavior:"smooth"})},children:e.jsx(jo,{className:"icon text-token-text-primary"})}),e.jsx(Co,{show:P,className:N("bottom-[calc(var(--composer-overlap-px)+--spacing(6))]"),onClick:()=>{be.logEvent("chatgpt_thread_scroll_to_bottom"),j.current?.scrollIntoView({behavior:"smooth",block:"end"})}})]})]})}const Ci=({clientThreadId:s,isNewThread:t,isGizmoThread:n,isProjectThread:a,isModelLoaded:o,currentModelId:i,onRequestCompletion:c,shouldUseUnifiedComposer:r,onlyAllowImageUploads:l,isWidgetFullScreen:u=!1,layoutMode:f})=>{const[x,S]=d.useState(!1),h=R(),m=nt(),{pageType:p}=wo(),v=p?.type==="landing-page",g=ba(p?.type),y=fs(s).isOdysseyMode,b=$t(h),C=rt(),_=Fe(),P=Y(),j=it(h);_o(m);const w=re(ie),F=ya(h),E=J(Tt.sidebarUrlTrayOpen$),I=J(Tt.context$),K=Bt(),G=w&&F&&E,L=se(h,"1925940714"),{platformConnectors:$}=ja(),ve=Ca(Ut.hasSeenOdysseyConnectorsModal),Me=le(s,O=>z.getConversationTurns(O).some(W=>W.messages.some(T=>T.metadata?.n7jupd_message))),de=ot(),Ne=Be(),U=(de||Ne)&&Me;wa(async()=>{if(!G)return;const O=K?[K]:[],W=typeof performance<"u"?performance.now():Date.now();try{const T=await Wa(I,qa,O,s),q=Math.round((typeof performance<"u"?performance.now():Date.now())-W);return T!=null?B.logEventWithStatsig("kaur1br5: Sidebar context collected","chatgpt_sidebar_context_collected",{duration_ms:q,count:Array.isArray(T)?T.length:1}):B.logEventWithStatsig("kaur1br5: Sidebar context collection failure","chatgpt_sidebar_context_collection_failure",{duration_ms:q,failure_reason:"null"}),T}catch(T){const q=Math.round((typeof performance<"u"?performance.now():Date.now())-W),X=T instanceof Ga;B.logEventWithStatsig("kaur1br5: Sidebar context collection failure","chatgpt_sidebar_context_collection_failure",{duration_ms:q,failure_reason:X?"timeout":"error",...T&&typeof T=="object"&&"message"in T?{error_message:String(T.message)}:T?{error_message:String(T)}:{}});return}},()=>G||!L.get("completion_request_blocking_promise_optimization",!1));const{composerThinkingEffort$:A}=_a(m),ae=async O=>{if(Ta(s)?.isLoading!==!1)return;const W=()=>{const H=Ia(m);Ua(H),Ba(H,O.contentToSend.content),La(H)},T=await Do({...O,clientThreadId:s,thinkingEffort:i===Ea?Aa(A):void 0}),q=T.completionMetadata?.systemHints?.includes(Ze),X=Array.from(O.selectedSources??[]).filter(H=>H!=="web")[0];if(q&&X&&ve.eligible){const H=Ra[X]??X,Te=$.get(H);if(Te){let me=!1;Oa(h,Fo,{connector:Te,onConfirm:()=>{ve.markAsViewed(),me=!0,c(T)},onTurnOffConnectors:()=>{Da(s,Z=>{Z.selectedSources??=new Map,Z.selectedSources.set(K,new Set(["web"])),Z.selectedMCPSources??=new Map,Z.selectedMCPSources.set(K,new Set),Z.mentionedSources=new Set,Fa({selectedSourcesMap:Z.selectedSources,selectedMCPSourcesMap:Z.selectedMCPSources,scope:{userId:j?.authUserId,workspaceId:j?.id}})})},onClose:()=>{me||W()}});return}}w&&Ha()?.triggerProductEvent("messageSent"),qe(T.promptMessage?.metadata?.attachments??[])&&c(T)},qe=d.useCallback(O=>{let W=Na;const T=O.reduce((X,he)=>X+(he.size??0),0);y&&(W=Ma(h,"1504865540").get("max_file_size_mb",25));const q=T<=W*1024*1024;return q||_.danger(P.formatMessage({id:"odyssey.fileTooLarge",defaultMessage:"The attached files are too large. The maximum size is {maxFileSizeMB}MB."},{maxFileSizeMB:W})),q},[h,P,y,_]),gt=d.useCallback(O=>{B.logEvent("Continue Completion"),c(Mo(O))},[c]),Ge=No.useState(O=>O.isReplayEnabled),Q=Pa({clientThreadId:s}),Pe=ka({clientThreadId:s});if(Q)return e.jsx(Po,{safetyLimited:Pe});const ue=e.jsxs(e.Fragment,{children:[e.jsx(ko,{clientThreadId:s}),e.jsxs(je,{verticalMargin:"none",verticalPadding:b?"last-standard":"none",horizontalPadding:w?"none":"standard",children:[u&&e.jsx(To,{sideOffset:4,open:x,alignAgainstAnchor:"center",triggerButton:e.jsx("div",{className:N("absolute start-0 end-0 -top-10 justify-center pb-3 group-hover/thread-bottom-container:flex",x?"flex":"hidden"),children:e.jsx(It,{color:"secondary",size:"small",icon:x?Ao:Ro,className:"shadow-lg",onClick:()=>{S(!x)}})}),size:"none",children:e.jsx("div",{className:"flex h-96 overflow-y-auto",children:e.jsx(Eo,{children:e.jsx(ws,{onRequestCompletion:()=>{},clientThreadId:s,clearPrefetchNavlink:()=>{}})})})}),e.jsx(oe,{children:Ge?e.jsx(Oo,{clientThreadId:s},s):U?null:e.jsx(Lr,{clientThreadId:s,currentModelId:i,isNewThread:t,isProjectThread:a,hideHeader:t,onRequestCompletion:ae,onContinueGenerating:gt,onlyAllowImageUploads:l,layoutMode:f})})]})]}),ke=t&&e.jsx("div",{className:N("[display:var(--display-hidden-until-loaded,block)] md:absolute md:start-0 md:bottom-8 md:w-full"),children:e.jsx(je,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(oe,{children:e.jsx(Br,{className:"block flex-1"})})})});return r?e.jsxs(e.Fragment,{children:[!C&&ke,e.jsx("div",{id:"thread-bottom",children:ue}),C&&ke,t&&!v&&!n&&!g&&!y&&!a&&e.jsx(wi,{clientThreadId:s,currentModelId:i,isModelLoaded:o})]}):ue},wi=({clientThreadId:s,currentModelId:t,isModelLoaded:n})=>{const a=nt(),o=J(hs(a).shouldShowAutocomplete$),i=ut(),c=ds({shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s}),{shouldShow:r,newUpsellsDismissible:l}=Le({clientThreadId:s,variant:"banner"});return e.jsxs("div",{className:N(o&&"hidden"),children:[e.jsx(je,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsxs(oe,{children:[!i&&e.jsxs(e.Fragment,{children:[!1,e.jsx(Ho,{clientThreadId:s})]}),c==="tiles"?n&&t&&s?e.jsx(js,{className:"mt-10 max-sm:hidden"}):null:c==="chips"?e.jsx(hi,{clientThreadId:s,currentModelId:t,isModelLoaded:n}):null,r&&e.jsx("div",{className:"hidden justify-center pt-8 sm:flex",children:e.jsx(vs,{isDismissible:l()})})]})}),i&&e.jsxs("div",{className:"thread-sm:flex mt-5 hidden flex-col gap-2",children:[e.jsx(Io,{}),e.jsx(Uo,{}),e.jsx(Bo,{})]})]})};function _i({className:s,threadHeaderDropdown:t,conversationActions:n,superWidgetTabs:a}){const o=R(),i=Va(),c=ce(o),r=!(i&&!at(o)),l=a??e.jsx(Ir,{textClassName:c?"text-sm":"text-base"});return c?e.jsx(Ni,{className:s,conversationActions:n,threadHeaderDropdown:r&&t,superWidgetTabs:l}):e.jsx(Mi,{className:s,conversationActions:n,threadHeaderDropdown:r&&t,superWidgetTabs:l})}function Mi({className:s,conversationActions:t,threadHeaderDropdown:n,superWidgetTabs:a}){return e.jsxs("div",{className:N("grid w-full grid-cols-[minmax(max-content,1fr)_auto_minmax(0,1fr)] lg:grid-cols-[1fr_auto_1fr]",Lo("default"),s),children:[e.jsx("div",{className:"col-start-1 row-start-1 justify-self-start pe-2",children:n}),e.jsx("div",{className:"col-span-2 col-start-2 row-start-1 me-7 min-w-0 place-self-center [justify-self:end] lg:col-span-1 lg:me-0 lg:min-w-(--thread-content-max-width) lg:flex-1 lg:[justify-self:center]",children:a}),e.jsx("div",{className:"col-start-3 row-start-1 hidden items-center justify-self-end overflow-visible lg:flex",children:t})]})}function Ni({className:s,conversationActions:t,threadHeaderDropdown:n,superWidgetTabs:a}){const o=d.useRef(null),i=d.useRef(null),c=d.useRef(null),r=d.useRef(null);return qt(()=>{const l=o.current,u=i.current,f=c.current,x=r.current;if(!l||!u||!f||!x)return;const S=()=>{const m=l.getBoundingClientRect().width,p=f.getBoundingClientRect().width,v=u.getBoundingClientRect(),g=.5*(m-p),y=v.right>g;f.style.justifySelf=y?"start":"center"},h=new ResizeObserver(S);return h.observe(l,{box:"border-box"}),h.observe(u,{box:"border-box"}),h.observe(f,{box:"border-box"}),S(),()=>{h.disconnect()}},[]),e.jsxs("div",{className:N("h-header-height w-full px-2 sm:grid sm:grid-cols-[minmax(max-content,1fr)_auto_minmax(0,1fr)] sm:px-0",s),ref:o,children:[e.jsx("div",{className:"z-10 col-start-1 row-start-1 hidden self-center justify-self-start pe-2 md:flex",ref:i,children:n}),e.jsx(oe,{className:"col-span-3 col-start-1 row-start-1 w-full",children:e.jsx("div",{className:"w-full",ref:r})}),e.jsx("div",{className:N("no-scrollbar col-start-2 row-start-1 -mb-px h-full w-full min-w-0 overflow-x-auto overflow-y-hidden"),ref:c,children:a}),e.jsx("div",{className:"col-start-3 row-start-1 hidden items-center justify-self-end overflow-visible md:flex",children:t})]})}const Pi=({clientThreadId:s})=>{const t=R(),n=Qt(p=>p.activeStageSidebar),a=Wo(za.WorkspaceShareLinks),{isUnauthenticated:o}=Ce(),i=Wt(),c=Xt(s),r=He(c),l=xe(t,"16480203"),u=qo(),f=Ya(),x=re(_e),S=a&&!o&&!i&&(!r||l)&&!u&&!f&&!(ce(t)&&x),h=!n,m=x;return e.jsx("div",{className:"flex items-center",id:"conversation-header-actions",children:e.jsx(Gr,{showShareButton:S,showProfileDropdown:h,showConversationPrivacyIndicator:m,clientThreadId:s})})},ki=Zt(()=>Jt(()=>import("./gcl1qef4z2hj5xrz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(s=>s.GizmoUsingAsOwnerNotice)),Ti="text-lg",Ei="icon-sm";function Ai({clientThreadId:s,transparentBackground:t,isEmptyState:n}){const a=R(),o=ht(a),i=Xt(s),c=He(i),r=Go(),{data:l}=Ka(i),u=it(a),f=rt(),x=Vt(),[S,h]=re(L=>[_e(L),ie(L)]),m=De(s),p=Qt(L=>L.isConversationScrolledFromTop),v=le(s,z.hasUserMessage)||!m,g=Be(),y=g&&x,b=pt()&&v&&!g,C=!i&&!b&&!h,{shouldShow:_}=Le({clientThreadId:s,variant:"pill"}),P=_&&!y,j=!at(a),w=j&&!v;Dt();const F=e.jsx(gs,{clientThreadId:s,children:e.jsx(Pi,{clientThreadId:s})}),E=S&&!b?{textClassName:Ti,chevronClassName:Ei}:{},I=b?e.jsx(_i,{threadHeaderDropdown:w?null:e.jsx($e,{clientThreadId:s,...E}),conversationActions:F}):h?e.jsx(Ko,{clientThreadId:s}):f&&(c||!i)?w?null:e.jsx($e,{clientThreadId:s}):w?null:e.jsx($e,{clientThreadId:s,...E}),K=(()=>{const L="[box-shadow:var(--sharp-edge-top-shadow)]",$="[box-shadow:var(--sharp-edge-top-shadow-placeholder)]";return S&&ce(a)?"":o?$+" group-data-scroll-from-top/thread:"+L:p?L:$})(),G=J(()=>mt(lt(a,s)).hasPinnedWidget$());return e.jsxs(e.Fragment,{children:[e.jsxs(Vo,{id:"page-header",className:N("pointer-events-none select-none [view-transition-name:var(--vt-page-header)] *:pointer-events-auto motion-safe:transition",!b&&!h&&"max-md:hidden",n&&"absolute start-0 end-0",c&&m&&"sharp-edge-on-scroll-start sticky top-0",C&&"thread-xl:absolute thread-xl:start-0 thread-xl:end-0 thread-xl:shadow-none!",C&&!g&&!G&&"thread-xl:bg-transparent",t&&!g&&!b&&!h&&"bg-transparent",K,p&&P&&"thread-xl:bg-token-main-surface-primary thread-xl:[box-shadow:var(--sharp-edge-top-shadow)]!"),children:[!h&&!b&&e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[l!=null&&u?.isWorkspaceAccount()&&l.gizmo.tags?.includes($a.WorkspaceDisabled)&&e.jsx(ki,{gizmo:l}),e.jsx(zo,{gizmoId:i,clientThreadId:s}),P?e.jsx(ti,{}):null,y&&e.jsx(Qr,{})]}),e.jsxs("div",{className:N("flex",b||h?"w-full":"items-center"),children:[j&&xe(a,"2860321732")&&e.jsx(Ri,{}),l&&e.jsx(Xr,{projectResource:l}),I]}),!b&&!h&&e.jsx("div",{className:"flex items-center",children:F})]}),r&&e.jsx(Yo,{})]})}const Ri=()=>{const{resetThread:s}=dt();return e.jsx(tt,{label:e.jsx(D,{id:"mG13YW",defaultMessage:"New chat"}),contentClassName:"cant-hover:hidden",triggerAs:null,children:e.jsx(ss,{to:"/",className:"hover:bg-token-bg-tertiary group touch:h-10 flex aspect-square h-9 items-center justify-center rounded-[10px]",onClick:t=>{t.metaKey||t.ctrlKey?B.logEventWithStatsig("New Chat Opened In New Tab","chatgpt_new_chat_opened_in_new_tab"):(B.logNewChatButtonClicked({location:"Anon desktop header"}),s(),t.preventDefault())},children:e.jsxs("div",{children:[e.jsx(Qa,{className:"icon-lg -m-1 group-hover:hidden"}),e.jsx($o,{className:"icon not-group-hover:hidden"})]})})})},Oi=Zt(()=>Jt(()=>import("./k3qobvm9nqd0qdgv.js"),__vite__mapDeps([14,1,2,3,15,6,7,16,17])));function Di({clientThreadId:s,isNewScrollEnabled:t,pageLoadSearchQuery:n,messagesVerticalAlign:a,footerRootContainerElementRef:o,threadRootRef:i,scrollContainerRef:c,hideHeader:r,children:l}){const[u]=yn(),f=!!u.get("message"),x=R(),[S,h]=re(g=>[ie(g),_e(g)]),m=ce(x),p=le(s,g=>g?.conversationOrigin===Kt.APPLE),v=J(()=>mt(lt(x,s)).pinnedWidgetHeight$());if(t)return e.jsx(Or,{allowScrollToEnd:!S,allowScrollToTop:!S&&p,clientThreadId:s,initScrolledToEnd:n==null&&!f,threadFooterRef:o,threadRootRef:i,children:l});{const g=e.jsx("div",{className:"relative h-full",style:{"--pip-widget-height":v?`${v}px`:"0px"},children:e.jsxs("div",{className:N("flex h-full flex-col overflow-y-auto",!h&&(v?"pt-(--pip-widget-height)":"thread-xl:pt-(--header-height)"),(h||S)&&m?"thread-sm:[scrollbar-gutter:stable_both-edges] [scrollbar-gutter:stable]":"[scrollbar-gutter:stable_both-edges]"),ref:c,children:[e.jsx(Yt,{setIsScrolledToEdge:y=>{ye.setIsConversationScrolledFromTop(y)},options:{root:c?.current}}),l]})});return n!=null?g:e.jsx(Gt,{children:e.jsxs(d.Suspense,{fallback:null,children:[e.jsx(Dr,{}),g]})})}}const Fi=function({clientThreadId:s,getGizmosCompletionParams:t,hideDisclaimer:n,hideHeader:a,messagesVerticalAlign:o="top",renderEmptyState:i}){"use forget";const c=Xa(),r=R(),l=ut(),u=ht(r),f=rt(),x=Za(),{data:S}=Ja({isGizmo:!!x}),h=en(s),[m,p,v,g,y,b,C]=le(s,k=>[k?.isLoading,z.getCurrentLeafId(k),z.hasUserMessage(k),z.getConversationTurns(k).length,z.isArchived(k),k?.modelId,k?z.getGizmoId(k):x]),_=es(s),{prefetchSearchPromises:P}=dt();d.useEffect(()=>Qo(r,s),[r,s]);const[j]=d.useState(P?.query),[w,F]=d.useState(P?.navlink);d.useEffect(()=>{m||(De(s)?Oe.addTiming("chatgpt.web.chatPage.renderNewConversation"):Oe.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[s,m]);const{setTargetedContent:E}=Xo(),I=c?.includes(tn),K=g>=2,[G,L]=re(k=>[sn(k),ie(k)]),$=ot(),{hash:ve}=ts(),Me=ee(),de=Be(),{isOpen:Ne}=ps();d.useEffect(()=>{$&&ve==="#report"&&(ye.openModal(zt.ReportConversation),Me({hash:""},{replace:!0}))},[ve,$,Me]);const U=!!C,A=De(s)&&!K&&(Et(h)||h?.kind===an.GizmoTest)&&!$&&!de&&P==null&&(!G||U),ae=A&&!v&&P==null&&(!G||U),qe=L&&!v&&!U,Ge=nn(S)?.id,Q=b??Ge??null,Pe=!!b,ue=on.useStore();d.useEffect(()=>{if(Q===rn)return ue.setActiveSystemHint(Ze,{locked:!0,analyticsMetadata:{clientThreadId:s}}),()=>{ue.setActiveSystemHint(null,{locked:!1,ifPrevSystemHint:Ze,analyticsMetadata:{clientThreadId:s}})}},[Q,ue,s]);const ke=ln(S?.models,Q),O=Zo(s,h),W=cn();d.useEffect(()=>{W||E(void 0)},[s,E,W,p]),d.useEffect(()=>{ye.setIsConversationScrolledFromTop(!1)},[s]),d.useEffect(()=>{const k=new URLSearchParams(window.location.search),Ae=k.get("src");if(Ae==="history_search"){k.delete("src");const Re=k.toString(),Is=`${window.location.pathname}${Re?`?${Re}`:""}${window.location.hash}`;window.history.replaceState({},document.title,Is)}_&&Ae==="history_search"&&et.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:_}},requestBody:{touch:!0},intercomEventOnError:"fetch-error:conversation:edit"}).then(()=>{const Re=dn(r);un(Re,C)})},[r,_,C]);const T=d.useCallback(k=>{const Ae={ctx:r,clientThreadId:s,...t?t(k):k};hn(Ae)},[r,s,t]),q=Jo(),X=mn(),he=d.useRef(null);he.current=k=>{A&&!X&&!G&&pn(r,"3253785454").get("should_animate_composer",!1)?er({className:tr["composer-slide"],update:()=>T(k)}):T(k)};const H=d.useCallback(k=>he.current?.(k),[he]);d.useEffect(()=>{q.signalTransitionReady()},[q,s]),sr(s,H),ar(),nr(A);const Te=or({clientThreadId:s,handleRequestCompletion:H,prefetchSearchThreadIdPromise:P?.threadId})&&j==null,me=d.useRef(null);d.useEffect(()=>{!de&&!l&&(document.title=O??"ChatGPT")},[O,de,l]);const Z=He(C),ne=U&&Z,pe=ae&&!i&&U&&gn(r,C),_s=$t(r),Ve=it(r),Ms=Ve&&!Ve.isTeam()&&!Ve.isEnterprisey(),ft=!n&&!_s&&!L&&!pe&&!(G&&!f)&&!(A&&Ms)&&Et(h),Ns=fs(s).isOdysseyMode,xt=d.useRef(null),St=d.useRef(null),vt=rr(k=>k.composerHeight),bt=!A&&!Ne,Ps=pt()&&ce(r)&&!ae,Ee=!ne,ks=A,Ts=d.useCallback(()=>F(void 0),[]),{isSingleLine:yt}=fn(),Es=!xn(),ze=J(()=>mt(lt(r,s)).displayMode$()==="fullscreen"),{shouldShow:As,newUpsellsDismissible:Rs}=Le({clientThreadId:s,variant:"banner"}),Os=A&&!U&&!Es?"center":"bottom",Ds=ir();function Fs(){return e.jsx(Er,{clientThreadId:s,scrollContainerRef:me})}function Hs(){return m||Te?null:ae?pe?e.jsx(Ar,{clientThreadId:s,gizmoId:C,currentModelId:Q,onRequestCompletion:H}):i??e.jsx(e.Fragment,{children:U?e.jsx(Rr,{clientThreadId:s,gizmoId:C,onRequestCompletion:H,currentModelId:Q}):e.jsx(gi,{clientThreadId:s,currentModelId:Q,isModelLoaded:Pe})}):K||j!=null?e.jsx(Di,{clientThreadId:s,isNewScrollEnabled:u,pageLoadSearchQuery:j,messagesVerticalAlign:o,footerRootContainerElementRef:St,threadRootRef:xt,scrollContainerRef:me,hideHeader:a,children:e.jsx(ws,{onRequestCompletion:H,clientThreadId:s,scrollContainerRef:me,pageLoadSearchQuery:j,prefetchNavlink:w,clearPrefetchNavlink:Ts},s)}):null}return e.jsx(lr.Provider,{value:w?"user-query-with-navlink":j?"user-query":null,children:e.jsx(cr,{serverThreadId:_,children:e.jsx(dr,{clientThreadId:s,children:e.jsxs(Sn,{clientThreadId:s,children:[e.jsx(Ii,{clientThreadId:s,conversationTurnsLength:g}),I&&e.jsx(Oi,{}),!de&&!l&&e.jsx(ur,{children:O!=null&&e.jsx("title",{children:O})}),e.jsx(vn.Provider,{value:H,children:e.jsxs(hr,{children:[e.jsx("div",{id:"thread",ref:xt,className:N("group/thread @container/thread h-full w-full",u&&br.threadRoot),children:e.jsxs(Ur,{noKeyboard:!0,clientThreadId:s,currentModelConfig:ke,className:N("composer-parent flex flex-col focus-visible:outline-0",!ne&&"overflow-hidden",pe?"min-h-full":"h-full"),children:[As&&ae&&!pe&&!i&&e.jsx("div",{className:"flex justify-center pt-2 sm:hidden",children:e.jsx(vs,{isDismissible:Rs()})}),!a&&e.jsx(Ai,{transparentBackground:A&&!pe,clientThreadId:s,isEmptyState:ae}),xe(r,"1909635392")&&e.jsx(mr,{clientThreadId:s}),e.jsxs("div",{className:N("relative basis-auto flex-col",bt&&"-mb-(--composer-overlap-px)",bt&&(yt?"[--composer-overlap-px:28px]":"[--composer-overlap-px:55px]"),ne||U||!A?"grow":"shrink",pe?"grid":"flex",!A&&"overflow-hidden",A&&l&&"sm:min-h-[21svh]!",A&&!ne&&!U&&"flex-col justify-end max-sm:grow max-sm:justify-center sm:min-h-[42svh]"),style:{"--composer-height":vt?`${vt}px`:void 0},children:[Ds&&Fs(),Hs(),G&&qe&&e.jsx(pr,{ctx:r}),Ps&&e.jsx(gr,{})]}),e.jsxs("div",{id:"thread-bottom-container",className:N("group/thread-bottom-container relative isolate z-10 w-full basis-auto has-data-has-thread-error:pt-2 has-data-has-thread-error:[box-shadow:var(--sharp-edge-bottom-shadow)] md:border-transparent md:pt-0 dark:border-white/20 md:dark:border-transparent",!A&&!ze&&"content-fade",yt&&"single-line",A&&"min-h-0",!ft&&!L&&!Ns&&"mb-4",U||ne||!A?"":Ee&&A&&"sm:grow",Ee&&"flex flex-col",ze&&"z-60"),ref:St,children:[y?e.jsx(fr,{clientThreadId:s}):e.jsxs(e.Fragment,{children:[(!A||Ee)&&!Ne&&e.jsxs(e.Fragment,{children:[e.jsx(Ci,{isGizmoThread:U,isProjectThread:ne,clientThreadId:s,isNewThread:A,currentModelId:Q,onRequestCompletion:H,shouldUseUnifiedComposer:Ee,isModelLoaded:Pe,layoutMode:Os,isWidgetFullScreen:ze}),f&&A&&xe(r,"537200474")&&e.jsx(xr,{clientThreadId:s})]}),ks&&e.jsx(Sr,{clientThreadId:s,isGizmoThread:U,isNewThread:A,isProjectThread:ne})]}),ft?e.jsx("div",{className:"text-token-text-secondary relative mt-auto flex min-h-8 w-full items-center justify-center p-2 text-center text-xs md:px-[60px]",children:e.jsx(vr,{clientThreadId:s})}):null]})]})}),e.jsx(yr,{clientThreadId:s,isStaticSharedThread:!1,isSharedConversation:$}),e.jsx(jr,{}),e.jsx(Cr,{conversationId:s}),e.jsx(wr,{}),e.jsx(_r,{})]})})]})})})})},Xi=as.memo(Fi);function Hi({clientThreadId:s,conversationTurnsLength:t}){const n=R(),a=es(s),o=xe(n,"733205176");return Mr(a,o),Nr(),Pr(),kr(s),Tr(t,s),null}const Ii=as.memo(Hi);export{Pi as C,Xi as M,Qi as P,ti as T,xs as a,Xr as b,Le as u};
//# sourceMappingURL=haz15z4nq3d0dq7v.js.map

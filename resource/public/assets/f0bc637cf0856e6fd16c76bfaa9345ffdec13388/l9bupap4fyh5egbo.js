import{d as z,f as S,j as e,M as k,r as Z}from"./m60bpb0x3x7rg8fj.js";import{dR as D,dS as q,dT as K,dU as Q,dV as C,dW as V,dX as J,dY as ee}from"./ggjzadbnd3k1vu0k.js";import{P as L,k_ as O,e as T,cd as v,cs as te,pj as se,bF as oe,a_ as $,b2 as W,fe as ae,Y as ie,hW as X,jg as I,f9 as y,jf as _,pk as Y,pl as H,pm as le,i as re,k7 as ne,dU as ce,f7 as de,lB as ue,fy as pe,ka as ge,f8 as B,pn as fe,po as me,pp as Fe}from"./lgw4q0e8zlqqfgug.js";import{u as he}from"./dgb06x9f8z6d0ar9.js";function _e({clientThreadId:s,openFileDialog:t,icon:r,isDisabled:i=!1,isSmall:l=!1,showLabel:n=!1,showUpsell:o=!1,hideBorder:M=!1,highlightTooltip:c=!1,disabledReason:g,currentModelName:b,visualTreatment:F,showMenuForNoAuth:a,modelSupportsImages:h}){const f=S(),u=O(),A=T();i=(i||!!u)&&!o;const x=e.jsxs(q,{disabled:i,$showLabel:n,$hideBorder:M,$isSmall:l,$visualTreatment:F,onClick:p=>{if(p.preventDefault(),a||o){L.logNoAuthAttachButtonClicked({location:a?"No auth file upload":"No auth upsell"});return}t()},"aria-label":K(A,f,i,g,b),children:[r,n&&e.jsx(Q,{})]}),d=e.jsx("div",{className:"flex",children:x});if(a||o){const p=a?e.jsx(V,{openFileDialog:t,showMenuForNoAuth:!0,modelSupportsImages:h}):e.jsx(se,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"}),m=e.jsx(v.BasicTrigger,{asChild:!0,children:d});return e.jsxs(v.Root,{children:[a?e.jsx(C,{clientThreadId:s,rateLimitPopup:u,highlightTooltip:c,disabled:i,children:m}):e.jsx(te,{label:e.jsx(k,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:c||void 0,children:m}),e.jsx(v.Portal,{children:e.jsx(v.Content,{alignOffset:-8,side:"bottom",size:"small",className:"radix-side-bottom:flex-col-reverse flex flex-col",children:p})})]})}return e.jsx(C,{disabled:i,clientThreadId:s,rateLimitPopup:u,highlightTooltip:c,children:d})}function xe({code:s,message:t}){switch(s){case D.FileTooLarge:return N.errorFileTooLarge;case D.TooManyFiles:return L.logEvent("Uploaded Max Files Error"),N.errorTooManyFiles;default:return t}}const N=z({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."}}),R=z({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function Me(s){if(!s.accept||Object.keys(s.accept).length===0)return[];const t=[];return Object.values(s.accept).forEach(r=>t.push(...r)),t.sort()}function ke(s){const{className:t,children:r,clientThreadId:i,currentModelConfig:l,noKeyboard:n}=s,o=S(),M=W(),c=T(),g=re(c),F=$(c).flags?.includes(X.NoAuthEnableFileUploads),a=ne(i),h=ce(),f=de(l,a,h),u=f!==y.None,A=ue(U=>U.files),x=(f===y.Multimodal?Y:H)-A.length,d=x<=0,{getGizmoId:p}=pe(),{handleFileAccepted:m}=Pe(o,f,B(l,a),"drag",p,ge(l,a)?.attachments),j=O(),P=fe(!g&&F?B(l,a):me(l,a)),{getRootProps:w,isDragActive:G}=he({maxFiles:x,disabled:!u||d||j!=null,noClick:!0,noKeyboard:n,onDropAccepted:m,onDropRejected:U=>be(U,o,M,f),multiple:!0,maxSize:Fe,...P}),E=Me(P);return e.jsxs("div",{...w({className:t}),children:[r,G&&e.jsxs(Ae,{children:[e.jsx(ee,{}),e.jsx("h3",{children:e.jsx(k,{...R.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:E.length>0?E.join(", "):e.jsx(k,{...R.dragAllAccepted})})]})]})}function be(s,t,r,i){const{errors:l}=s[0];l.forEach(n=>{const o=xe(n);typeof o=="string"?r.danger(o,{hasCloseButton:!0,loggingTitle:"File upload error",loggingDescription:o,toastId:"file_upload_error"}):r.danger(t.formatMessage(o,{size:le,maxNum:i===y.Multimodal?Y:H}),{hasCloseButton:!0,loggingTitle:o.defaultMessage||"File upload error",loggingDescription:o.defaultMessage||"File upload error",toastId:"file_upload_error"})})}function Pe(s,t,r,i,l,n){const o=T(),M=$(o).flags,c=W(),g=ae(),{isUnauthenticated:b}=ie(),F=M?.includes(X.NoAuthEnableFileUploads),{persistFilesToLibrary:a,doubleWriteFilesToLibrary:h}=J(o,!0);return{handleFileAccepted:Z.useCallback(async(u,A)=>{L.logEvent("Upload File",{client:"web",eventSource:i,intent:t.toString()});const x=l!=null?await l():void 0;u.length>0&&u.forEach(d=>{const p={gizmoId:x,...F&&{isUnauthenticated:b}},m=[g,I(d),d,t,r,s,c,p,n];if(t===y.Retrieval){let j=Promise.resolve(),P=Promise.resolve();a&&(P=_.uploadFile(g,`${I(d)}:lib`,d,t,r,s,c,p,n,void 0,!0,!0)),(h||!a)&&(j=_.uploadFile(...m,void 0,!1,a)),Promise.all([j,P])}else _.uploadFile(...m)})},[i,t,l,g,r,s,c,n,F,b,a,h])}}const Ae=oe.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`;export{Ae as D,ke as F,_e as P,Me as g,be as h,Pe as u};
//# sourceMappingURL=l9bupap4fyh5egbo.js.map

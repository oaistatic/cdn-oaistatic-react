import{B as O,aY as b,z as V,qE as W,e as w,p as L,f3 as z,m7 as F,dr as G,P as B,aM as K,f0 as _,cu as j,ar as Z,cO as q}from"./lgw4q0e8zlqqfgug.js";import{r as i,f as M,j as s,M as $,a as U,O as Q}from"./m60bpb0x3x7rg8fj.js";import{m as l}from"./nc6572sivljsjb83.js";import{R as Y}from"./hy6s1jaxh8po14h5.js";import{ky as J,kz as X,kd as D,iq as x,ir as T,jn as S,kA as tt}from"./ggjzadbnd3k1vu0k.js";import{C as I}from"./j4imjyyfxliz5sk5.js";import{a as et}from"./haz15z4nq3d0dq7v.js";import{a as rt}from"./ni7upx21dt4e31xq.js";import{a as st,T as ot,W as nt,b as at}from"./ccdmd6bzhnx5atrg.js";import{h as v,v as it,x as ct}from"./g7o69yifmkuxfsll.js";import{u as mt}from"./lycvq5rqsik44ye8.js";import"./d4l47j95cc16bbv9.js";import"./mlo67gs1ylzshmge.js";import"./h81zqbvh0a7amk0o.js";import"./ccw262xxu17g34lw.js";import"./hbir13mtq07o9x1a.js";import"./o53bheyqocotqvus.js";import"./l9bupap4fyh5egbo.js";import"./dgb06x9f8z6d0ar9.js";import"./gohr301ka7cpfe4s.js";import"./jobqnbdildqzowzf.js";import"./ls4akj6tri7bc2dz.js";import"./glu06a3y5u0laqff.js";import"./iayy5u2a26jybmdr.js";import"./n5yj38pa2aamrsfp.js";import"./rx5cs0ja7c7phupc.js";import"./dfbgvqz3f2t2gfhn.js";import"./hzuwclo1fy1q03ik.js";import"./hb68k3oakb3tiftg.js";import"./nn6a4342otoakkr2.js";import"./hg4s4237azdb5era.js";import"./mlqzrqe1i57m6im6.js";import"./kfjcy5y4cxuymbdf.js";import"./d6raol4cdcsdp19u.js";import"./n26tu9wxezmtzr3d.js";import"./dmk30rbb7u1k7gl7.js";import"./795byvwofdax2f6d.js";import"./m3hp25w3mcid81ib.js";import"./jii3s2n86nvi5fnj.js";import"./dp7t1jmnbbend843.js";import"./mdsdqbg7dtklqnuw.js";import"./kj109at7ry8iempm.js";import"./jtj7tm19s85de1gz.js";import"./ngdk8aaa28n1ff0n.js";import"./cb9cgv53vja8utnc.js";import"./o7wniqoxhh56wvjg.js";import"./czj65b9i5sztgpdb.js";import"./nyb6qzfj9cwbbq9m.js";import"./ijm2v97qh75qdidh.js";import"./hvkmppraevglbeo3.js";import"./lf8mxjdfum7t34gh.js";import"./gjtxw5aaotq3dyvk.js";import"./9q3v44p2xpoi75pn.js";import"./ll84t6t68j83ysyi.js";import"./tfkm8dsw7zx8il21.js";import"./kkyb18g9gdccsonu.js";import"./fxwiivjy9rf81dg2.js";import"./og0mzunrykkt4tp0.js";import"./lff9oru7r5vtmz06.js";import"./m9elivgqkyz3hcka.js";import"./crheuewn890nts1d.js";import"./df3y7yi36gehsn95.js";const dt=t=>i.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},i.createElement("path",{d:"M14.3008 8.09863C14.6036 8.16081 14.8311 8.42879 14.8311 8.75C14.8311 9.07121 14.6036 9.33919 14.3008 9.40137L14.166 9.41504H13.333C12.9659 9.41491 12.668 9.11719 12.668 8.75C12.668 8.38281 12.9659 8.08509 13.333 8.08496H14.166L14.3008 8.09863Z"}),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.333 1.83496C14.1604 1.83496 14.8309 2.50565 14.8311 3.33301V5C14.8311 5.05831 14.8207 5.11407 14.8066 5.16797H15C16.7479 5.16797 18.1649 6.58517 18.165 8.33301V13.333C18.165 14.6208 17.1208 15.665 15.833 15.665H14.832V16.667C14.8319 17.4944 14.1604 18.165 13.333 18.165H6.66699C5.83959 18.165 5.16814 17.4944 5.16797 16.667V15.665H4.16699C2.87925 15.665 1.83496 14.6208 1.83496 13.333V8.33301C1.83513 6.58517 3.25213 5.16797 5 5.16797H5.19238C5.1783 5.11411 5.16797 5.05827 5.16797 5V3.33301C5.16814 2.50584 5.83888 1.83527 6.66602 1.83496H13.333ZM6.49805 16.667C6.49822 16.7598 6.57413 16.835 6.66699 16.835H13.333C13.4259 16.835 13.5018 16.7598 13.502 16.667V12.332H6.49805V16.667ZM5 6.49805C3.98667 6.49805 3.16521 7.31971 3.16504 8.33301V13.333C3.16504 13.8862 3.61379 14.335 4.16699 14.335H5.16797V12.332H5C4.63284 12.332 4.33513 12.0341 4.33496 11.667C4.33496 11.2997 4.63273 11.002 5 11.002H15L15.1338 11.0156C15.4369 11.0776 15.665 11.3456 15.665 11.667C15.6649 11.9883 15.4368 12.2564 15.1338 12.3184L15 12.332H14.832V14.335H15.833C16.3862 14.335 16.835 13.8862 16.835 13.333V8.33301C16.8348 7.31971 16.0133 6.49805 15 6.49805H5ZM6.66602 3.16504C6.57342 3.16535 6.49822 3.24038 6.49805 3.33301V5C6.49805 5.05831 6.48773 5.11407 6.47363 5.16797H13.5254C13.5113 5.11411 13.501 5.05827 13.501 5V3.33301C13.5008 3.24019 13.4259 3.16504 13.333 3.16504H6.66602Z"})),pt=({title:t})=>{const e=M().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return s.jsxs("div",{className:"flex justify-between print:hidden",children:[s.jsxs("div",{className:"flex flex-col justify-start",children:[s.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:t}),s.jsx("div",{className:"text-token-text-tertiary text-sm",children:s.jsx($,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:o=>s.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:o})}})})]}),s.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[s.jsx(dt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),s.jsx(O,{className:V("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:b,label:e,children:e})]})]})};function lt({postWithProfile:t,title:r,children:e}){return s.jsx(J.Provider,{value:{postId:t.post.id},children:s.jsx(W,{children:s.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:s.jsxs("div",{className:"mx-auto max-w-3xl",children:[s.jsx("div",{className:"px-2 py-6",children:!!r&&s.jsx(pt,{title:r})}),s.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:s.jsxs("div",{className:"p-14 pt-8",children:[s.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:s.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[s.jsx(b,{className:"text-token-text-primary h-8 w-8"}),s.jsx(X,{})]})}),e]})})]})})})})}function ut(t){if(t.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const r=t.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,exampleTaskInfo:r.example_task_info}}function ht({postWithProfile:t}){mt();const r=v(d=>d.addTurnToTaskMap),{task:e,fetchedTurns:o,current_user_turn:n,current_assistant_turn:a,exampleTaskInfo:c}=ut(t),u=w(),h=M(),m=U(),R=D.useCurrentImage()!=null,E=L(u,"2818336692"),[C,g]=i.useState([]),k=i.useCallback(()=>{g([])},[]),{focusedAssistantTurn:p,setFocusedAssistantTurnId:P}=st({taskId:e.id,task:e,currentUserTurn:n??null,currentAssistantTurn:a??null}),y=i.useMemo(()=>it(p),[p]),N=i.useMemo(()=>({comments:C,setComments:g,clearComments:k,readonlyComments:y}),[C,g,k,y]),f=v(({getTurnsForTask:d})=>e?d(e.id):[]),A=i.useMemo(()=>({setFocusedAssistantTurnId:P,focusedAssistantTurn:p,taskId:e?.id,task:e,pastTurns:f,canFollowUp:!1}),[p,e,f,P]);return i.useEffect(()=>{Object.values(o?.turn_mapping??{}).forEach(d=>{r(e?.id??"",d.turn)})},[o,r,e]),ct([{key:"newTask",action:()=>{m("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:h.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:T.Chat,keyboardBinding:[x.Mod,x.Shift,"o"]},{key:"closeTask",action:()=>{m("/codex")},actionMessageDescriptor:h.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:T.Chat,keyboardBinding:[x.Escape],enabled:!R}]),!e||!f?null:s.jsx(S.Provider,{value:{postWithProfile:t,setIsReportModalOpen:()=>{}},children:s.jsx(z,{children:s.jsx(ot,{value:N,children:s.jsx(nt,{value:A,children:s.jsx(at,{permissions:"read",turnId:a?.id??"",showForkButton:E,loadingTurnMapping:!1,isSharedExampleTask:!!c})})})})})}const Me=F(function(){const r=Q();return r.kind==="forbidden"?s.jsx(Ct,{chatPageProps:r.chatPageProps,reason:"workspace"}):s.jsx(gt,{loaderData:r})});function gt({loaderData:t}){i.useEffect(()=>{B.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:t.postWithProfile.post.id,primary_attachment_type:t.postWithProfile.post.attachments?.[0]?.kind,referrer:t.referrer})},[t]);const{session:r}=K(),e=i.useMemo(()=>{const n=_();return j.initThread({clientThreadId:n,conversationMode:{kind:Z.PrimaryAssistant},userId:r?.user?.id,accountId:r?.account?.id}),n},[r?.account?.id,r?.user?.id]),o=t.postWithProfile.post.attachments?.[0];if(o.kind==="deep_research"){const n=o.messages,a=q(n),c=a?.metadata?.async_task_title;return a?s.jsx(lt,{postWithProfile:t.postWithProfile,title:c,children:s.jsx(Y,{messages:n,threadId:e})}):null}return o.kind==="codex"?s.jsx(ht,{postWithProfile:t.postWithProfile}):s.jsx(kt,{postWithProfile:t.postWithProfile,chatPageProps:t.chatPageProps})}function H(t){return{url:`https://ogimg.chatgpt.com/?postId=${t}`,size:[1200,630]}}function ft(t,r){if(!t.attachments||t.attachments.length===0)return{url:l.src};const e=t.attachments[0];switch(e.kind){case"media_generation":{const o=e.encodings?.md?.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,n=e.encodings?.unfurl?.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,a=e.encodings?.thumbnail?.path?{url:e.encodings.thumbnail.path}:void 0,c={url:e.url,size:[e.width,e.height]};return r&&o!=null?o:n??a??c}case"message_slice":return H(t.id);default:return{url:l.src}}}function xt(t){const r=t.text?.trim();if(r)return r;const e=t.attachments?.[0];return e?.kind==="media_generation"&&e.title?.trim()?e.title.trim():"Shared Content"}const Se=({data:t})=>{const r=t,e={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const m="Privately Shared Content";return[{title:`ChatGPT - ${m}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:m},{property:"og:type",content:"website"},{property:"og:image",content:l.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:l.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:m}]}const{post:o}=r.postWithProfile,n=r.enforceRenderedOgImg?H(o.id):ft(o,r.preferIntrinsicAspectRatioForOgImage),a=xt(o),c=o.permalink,u=new Date(o.posted_at*1e3).toISOString();return[{title:`ChatGPT - ${a}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:u},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function Ct({chatPageProps:t,reason:r}){const e=w();return i.useEffect(()=>{G(e,tt,{reason:r})},[]),s.jsx(I,{...t})}function kt({postWithProfile:t,chatPageProps:r}){const[e,o]=i.useState(!1),[n]=i.useState(()=>_()),a=rt(t.post.attachments);if(a){const{threadResponse:c}=a;j.updateThreadFromServer(n,c,{skipIfExisting:!0,continuingFromSharedPostId:t.post.id,forkFromSharedPost:!0})}return s.jsxs(S.Provider,{value:{postWithProfile:t,setIsReportModalOpen:o},children:[e&&s.jsx(et,{post:t.post,onClose:()=>o(!1)}),s.jsx(I,{...r,clientThreadId:n})]})}export{Me as default,Se as meta};
//# sourceMappingURL=o9qv3haozd736h1q.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dfbgvqz3f2t2gfhn.js","assets/m60bpb0x3x7rg8fj.js","assets/lgw4q0e8zlqqfgug.js","assets/root-otc54kct.css","assets/ggjzadbnd3k1vu0k.js","assets/conversation-small-j0gcsxmz.css","assets/hzuwclo1fy1q03ik.js","assets/hb68k3oakb3tiftg.js","assets/nn6a4342otoakkr2.js"])))=>i.map(i=>d[i]);
import{b2 as C,R as b,sX as F,z as Y,aZ as Z,sC as me,y as Ne,S as X,b6 as le,fS as ye,aG as P,cf as Ce,aq as Re,e as ee,dr as ue,sY as _e,C as Ue,am as ce,r3 as Pe,cd as p,dO as E,aN as Ie,cs as ge,B as L,gD as se,p as ke,qv as te,b_ as we,b$ as Ae,a5 as qe,dN as Se,aA as De,m7 as Te}from"./lgw4q0e8zlqqfgug.js";import{u as $,f as M,h as W,i as R,d as y,j as e,a as xe,r as x,M as h,b as Ee}from"./m60bpb0x3x7rg8fj.js";import{bN as he,bw as Be,$ as Fe,rf as z,eb as We,mn as K,rg as Q,i6 as Ve,jP as de,aS as c,jO as ae,aT as He,bD as Oe,X as Le,ek as Ge,rh as $e,i0 as ze}from"./ggjzadbnd3k1vu0k.js";import{m as pe}from"./dj7h5xzns2uq32f9.js";import{G as Ke}from"./1fv6oil4uoc66eui.js";import{T as Qe,a as Je}from"./b2lwi6is3nazvxrr.js";import{a as Xe,c as Ye,u as Ze}from"./lx0y091m5xst5og4.js";import"./hbir13mtq07o9x1a.js";import"./o53bheyqocotqvus.js";import"./l9bupap4fyh5egbo.js";import"./dgb06x9f8z6d0ar9.js";import"./gohr301ka7cpfe4s.js";import"./jobqnbdildqzowzf.js";import"./ls4akj6tri7bc2dz.js";import"./glu06a3y5u0laqff.js";import"./iayy5u2a26jybmdr.js";import"./n5yj38pa2aamrsfp.js";import"./rx5cs0ja7c7phupc.js";import"./dfbgvqz3f2t2gfhn.js";import"./hzuwclo1fy1q03ik.js";import"./hb68k3oakb3tiftg.js";import"./nn6a4342otoakkr2.js";import"./h81zqbvh0a7amk0o.js";import"./jh57htegso1fdrwn.js";import"./kh7rmh4dpsh5j6sg.js";import"./lff9oru7r5vtmz06.js";const A=25;function es(s,t,a){return $({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await b.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:t,limit:A,query:a}}})})}function fe(s,t,a){return $({queryKey:["workspace",s,"invites","requests",t,a],queryFn:()=>b.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:t,limit:A,query:a}}})})}function Me(s){const t=M(),a=C(),n=W();return R({mutationFn:({inviteId:r,role:l,acceptRequest:i})=>b.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:r}},requestBody:{role:l,accept_request:i}}).catch(o=>{throw a.danger(t.formatMessage(N.updateInviteError,{error:o.message}),{loggingTitle:N.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),o}),onSuccess:(r,l)=>{if(l.acceptRequest)n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},i=>{if(!i)return i;const o=i.items.filter(d=>d.id!==l.inviteId),m=Math.max(0,(i.total??0)-1);return{...i,items:o,total:m}});else if(l.role){const i=l.role;n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{if(!o)return o;const m=o.items.map(d=>d.id===l.inviteId?{...d,role:i}:d);return{...o,items:m}})}}})}function je(s){const t=M(),a=C(),n=W();return R({mutationFn:({email:r})=>b.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:r}}).catch(l=>{throw a.danger(t.formatMessage(N.deleteInviteError,{email:r,error:l.message}),{loggingTitle:N.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),l}),onSuccess:(r,{email:l})=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},i=>{if(!i)return i;const o=i.items.filter(d=>d.email_address!==l),m=Math.max(0,(i.total??0)-1);return{...i,items:o,total:m}})}})}function ss(s){const t=M(),a=C(),n=W();return R({mutationFn:()=>b.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(r=>{throw a.danger(t.formatMessage(N.acceptAllInviteRequestsError,{error:r.message}),{loggingTitle:N.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),r}),onSuccess:()=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},r=>r&&{...r,items:[],total:0})}})}function ts(s){const t=M(),a=C(),n=W();return R({mutationFn:({role:r,email:l})=>b.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[l],role:r,resend_emails:!0}}).then(({account_invites:i,errored_emails:o})=>{if(o.length>0)throw new Error(o[0].error);i.length>0&&a.success(t.formatMessage(N.resendInviteSuccess,{email:l}))}).catch(i=>{a.danger(t.formatMessage(N.resendInviteError,{email:l,error:i.message}),{loggingTitle:N.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["workspace",s,"invites"]}),n.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const N=y({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),ne=({userName:s,isScimManaged:t,dotted:a=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(he,{user:{name:s,picture:null},size:"default",dotted:a}),t&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(Be,{width:10,height:10})})]}),as=({children:s,ref:t,...a})=>e.jsx(F.Root,{license:"commercial",sheetRole:"dialog",...a,ref:t,children:s}),ns=({children:s,ref:t,className:a,contentPlacement:n="left",...r})=>e.jsx(F.View,{className:Y("z-1",a),contentPlacement:n,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0,...r,ref:t,children:s}),rs=({className:s,ref:t,...a})=>e.jsx(F.Backdrop,{className:s,...a,ref:t}),is=({children:s,ref:t,className:a,...n})=>e.jsx(F.Content,{className:Y("bg-token-bg-primary box-border shadow-lg",a),...n,ref:t,children:s}),os=F.Portal,T={Root:as,Portal:os,View:ns,Backdrop:rs,Content:is},ls=({workspaceId:s,userId:t})=>$({queryKey:[s,t,"user-roles"],queryFn:async()=>(await b.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s},path:{workspace_id:s,principal_id:t}}})).roles}),cs=({workspaceId:s,userId:t,enabled:a})=>$({enabled:a,queryKey:[s,t,"user-groups"],queryFn:async()=>(await b.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:t}}})).items}),ds=({workspaceId:s,user:t,onClose:a})=>{const n=M(),r=Z(),l=xe(),i=me(),o=r?.isEnterprisey(),{data:m}=ls({workspaceId:s,userId:t.id}),d=x.useMemo(()=>m?.filter(u=>!u.predefined_role),[m]),{data:g}=cs({workspaceId:s,userId:t.account_user_id,enabled:o});return e.jsx(T.Root,{presented:!0,defaultPresented:!0,onPresentedChange:a,children:e.jsx(T.Portal,{children:e.jsxs(T.View,{contentPlacement:"right",children:[e.jsx(T.Backdrop,{}),e.jsxs(T.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsx(Ne,{onClick:a,iconSize:"lg",autoFocus:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(he,{user:{name:t.name??"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:t.name}),e.jsx("div",{children:t.email})]})]}),e.jsx("hr",{className:"my-2.5"}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(H.groups)}),g==null&&e.jsx(X,{}),g?.length===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(H.noGroups)}),g?.map(u=>e.jsx(le,{className:"mx-0",as:"button",onClick:()=>l(`/admin/groups/${u.id}`),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(Ke,{group:u})}),e.jsx("div",{children:u.name})]})})},u.id))]}),e.jsx("hr",{className:"my-2.5"})]}),i&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(H.customRoles)}),d==null&&e.jsx(X,{}),d?.length===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(H.noCustomRoles)}),d?.map(u=>e.jsx(le,{className:"mx-0",as:"button",onClick:()=>l(`/admin/permissions/roles/${u.id}`),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:u.predefined_role?e.jsx(Fe,{className:"icon"}):e.jsx(ye,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:u.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:u.description})]})]})})},u.id))]})]})]})]})})})},H=y({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"}});function re({currentRole:s,onUpdateUserRole:t,disabled:a=!1}){const n=z();return e.jsx(We,{disabled:a,defaultValue:s,onValueChange:r=>{t(r)},triggerClassName:"text-base",options:[{label:n[P.STANDARD],value:P.STANDARD},{label:n[P.ADMIN],value:P.ADMIN},{label:n[P.OWNER],value:P.OWNER}]})}const B=Ce(()=>({confirmModalUserData:null})),G={openModalForUser:s=>{B.setState({confirmModalUserData:s})},closeModal:()=>{B.setState({confirmModalUserData:null})}};function ms({workspaceId:s,filterInputValue:t}){const[a,n]=x.useState(0),r=Re(),[l,i]=x.useState(),o=me(),m=r?.id,d=K(s),g=Q(s),u=d||g,f=ps(),_=Ms(s),V=fs(s),{data:q}=Ve(s,a*de,t);x.useEffect(()=>{n(0)},[t]);const U=x.useCallback(j=>{G.openModalForUser(j)},[]),ve=x.useCallback(()=>{const j=B.getState().confirmModalUserData?.id;j!==void 0&&_.mutate({userId:j}),G.closeModal(),i(void 0)},[_]),be=x.useCallback((j,D)=>{f.mutate({userId:j,value:D,workspaceId:s})},[f,s]);if(q===void 0)return e.jsx(ie,{});const oe=q.items,S=Math.ceil((q.total??0)/de);return a>=S&&S!==0&&n(Math.max(S-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(c.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),u&&e.jsx("col",{className:"w-16"})]}),e.jsxs(c.Header,{children:[e.jsx(c.HeaderCell,{children:e.jsx(h,{...v.name})}),e.jsx(c.HeaderCell,{children:e.jsx("span",{className:d?"ps-3":"",children:e.jsx(h,{...v.accountType})})}),e.jsx(c.HeaderCell,{children:e.jsx(h,{...v.dateAdded})}),u&&e.jsx(c.HeaderCell,{className:"w-16"})]}),e.jsxs(c.Body,{children:[oe.map(j=>e.jsx(xs,{isCurrentUser:m!==void 0&&j.id===m,user:j,currentUserHasAdminRights:u,isCurrentUserOwner:d,onRemoveUserClick:()=>U({id:j.id,name:j.name??"",email:j.email??"",created_time:j.created_time}),onUpdateUserRole:be,onLogoutUser:async D=>{await V.mutateAsync({userId:D})},onClick:o?D=>i(D):void 0},j.id)),oe.length===0&&e.jsx(c.Row,{className:"[&>td]:py-2",children:e.jsx(c.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(h,{...v.noResults})})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:S>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(ae,{currentPage:a,onChangeIndex:n,length:S})})}),l&&e.jsx(ds,{workspaceId:s,user:l,onClose:()=>i(void 0)}),e.jsx(gs,{onDeleteConfirm:ve})]})}function us({onConfirm:s,onClose:t}){const a=M(),[n,r]=x.useState(!1);return e.jsx(Oe,{title:a.formatMessage(v.logoutMemberModalTitle),isOpen:!0,onClose:t,onConfirm:async()=>{try{r(!0),await s()}finally{r(!1)}t()},loading:n,confirmText:a.formatMessage(v.logoutMemberModalConfirm),primaryButtonColor:"danger"})}function gs({onDeleteConfirm:s}){const t=M(),a=B(r=>r.confirmModalUserData!==null),n=B(r=>r.confirmModalUserData===null?{}:{userId:r.confirmModalUserData.id,email:r.confirmModalUserData.email,name:r.confirmModalUserData.name,dateAdded:_e(r.confirmModalUserData.created_time)});return e.jsx(Ue,{testId:"modal-remove-member",isOpen:a,title:t.formatMessage(v.removeMemberModalTitle),onClose:()=>G.closeModal(),type:"success",primaryButton:e.jsx(ce.Button,{title:t.formatMessage(v.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(ce.Button,{title:t.formatMessage(v.removeMemberModalCancel),color:"secondary",onClick:()=>G.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[n.name??n.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(h,{...v.dateJoined,values:{dateAdded:t.formatDate(n.dateAdded,{year:"numeric",month:"long",day:"numeric"})}})})]})})}function xs({user:s,currentUserHasAdminRights:t,isCurrentUserOwner:a,isCurrentUser:n,onRemoveUserClick:r,onUpdateUserRole:l,onLogoutUser:i,onClick:o}){const d=z()[s.role],g=M(),u=s.name??g.formatMessage(v.missingName),f=ee();return e.jsxs(c.Row,{className:Y("[&>td]:py-2"),onClick:o?()=>o?.(s):void 0,children:[e.jsxs(c.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(ne,{userName:u,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[u,n&&e.jsx("span",{className:"ms-1",children:e.jsx(h,{...v.youSpecifier})})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(c.Cell,{children:a?e.jsx(re,{currentRole:s.role,onUpdateUserRole:_=>{l(s.id,_)},disabled:n}):d}),e.jsx(c.Cell,{children:g.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),t&&e.jsx(c.Cell,{children:e.jsx(hs,{userId:s.id,onRemoveUserClick:r,onLogoutUserClick:()=>{ue(f,us,{onConfirm:()=>i(s.id)})},isCurrentUser:n,isScimManaged:s.is_scim_managed})})]})}function hs({isCurrentUser:s,onRemoveUserClick:t,onLogoutUserClick:a,userId:n,isScimManaged:r}){const l=M(),i=Pe(),o=e.jsx(p.Item,{onClick:r?void 0:m=>{m.stopPropagation(),t(n)},color:"danger",icon:e.jsx(He,{}),disabled:r,children:e.jsx(h,{...v.removeMemberModalTitle})});return s?null:e.jsxs(p.Root,{children:[e.jsx(p.Trigger,{className:"-my-2",children:e.jsx(E,{className:"icon-sm"})}),e.jsx(p.Portal,{children:e.jsxs(p.Content,{size:"small",children:[i&&e.jsx(p.Item,{onClick:m=>{m.stopPropagation(),a(n)},icon:e.jsx(Ie,{}),children:e.jsx(h,{...v.logoutMember})}),r?e.jsx(ge,{label:l.formatMessage(pe.managedViaSCIMTooltip),className:"flex",side:"right",children:o}):o]})})]})}function ps(){const s=C();return R({mutationFn:({userId:t,workspaceId:a,value:n})=>b.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:a,user_id:t}},requestBody:{role:n}}).catch(r=>{s.danger(`Unable to update user (${t}) role: ${r.message}`,{toastId:"user_manager_table"})})})}function fs(s){const t=C();return R({mutationFn:({userId:a})=>b.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:a}}}),onError:(a,n)=>{t.danger(`Unable to logout user (${n.userId}) from workspace`,{toastId:"user_manager_table"})},onSuccess:()=>{t.success("User logged out of all sessions",{id:"user_logout_success"})}})}function Ms(s){const t=W(),a=C();return R({mutationFn:({userId:n})=>b.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:n}}}).catch(r=>{a.danger(`Unable to remove user (${n}) from workspace: ${r.message}`,{toastId:"user_manager_table"})}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s]})}})}function ie(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(X,{})})}const v=y({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}});function js({workspaceId:s,filterInputValue:t}){const[a,n]=x.useState(0),{data:r}=fe(s,a*A,t),l=K(s),i=Q(s),o=M(),m=l||i;if(r===void 0)return e.jsx(ie,{});const d=r.items,g=Math.ceil((r.total??0)/A);return a>=g&&g!==0&&n(Math.max(g-1,0)),e.jsxs("div",{children:[e.jsxs(c.Root,{fixed:!0,size:"normal",children:[e.jsxs(c.Header,{children:[e.jsx(c.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(h,{...k.email})}),e.jsx(c.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:m?"ps-3":"",children:e.jsx(h,{...k.role})})}),m&&e.jsx(c.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:o.formatMessage(k.actions)})]}),e.jsxs(c.Body,{children:[d.map(u=>e.jsx(vs,{workspaceId:s,invite:u,isCurrentUserOwner:l,currentUserHasAdminRights:m},u.id)),d.length===0&&e.jsx(c.Row,{children:e.jsx(c.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(h,{...k.noResults})})})})]})]}),g>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ae,{currentPage:a,onChangeIndex:n,length:g})})]})}function vs({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){const r=z(),l=Me(s),i=je(s),o=M();return e.jsxs(c.Row,{className:"[&>td]:py-2",disabled:l.isPending||i.isPending||i.isPending,children:[e.jsx(c.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ne,{userName:t.email_address??"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(c.Cell,{children:a?e.jsx(re,{currentRole:t.role,onUpdateUserRole:m=>{l.mutate({inviteId:t.id,role:m})}}):r[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(c.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{color:"secondary",onClick:()=>l.mutate({inviteId:t.id,acceptRequest:!0}),children:o.formatMessage(k.accept)}),e.jsxs(p.Root,{children:[e.jsx(p.Trigger,{disabled:t.is_scim_managed,children:e.jsx(E,{className:"icon-sm"})}),e.jsx(p.Portal,{children:e.jsx(p.Content,{children:e.jsx(p.Item,{color:"danger",onClick:()=>i.mutate({email:t.email_address??""}),children:o.formatMessage(k.reject)})})})]})]})})})]})}const k=y({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),bs=({workspaceId:s})=>{const t=M(),a=ee(),n=K(s),r=Q(s),l=n||r,i=ss(s),[o,m]=x.useState(""),[d,g]=x.useState(""),u=x.useMemo(()=>se(U=>g(U),300,{leading:!1,trailing:!0}),[]),{data:f}=fe(s,0,d),_=ke(a,"3677330697")??!1,V=f?.total??0,q=V?t.formatMessage(J.acceptAllWithCount,{count:V}):t.formatMessage(J.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(te,{value:o,onChange:U=>{m(U.target.value),u(U.target.value)},placeholder:t.formatMessage(J.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),l&&_&&e.jsx(L,{loading:i.isPending,disabled:(f?.total??0)===0,onClick:()=>i.mutate(),children:q})]}),e.jsx(js,{workspaceId:s,filterInputValue:d})]})},J=y({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}});function Ns({workspaceId:s,filterInputValue:t}){const[a,n]=x.useState(0),r=K(s),l=Q(s),i=r||l,{data:o}=es(s,a*A,t);if(o===void 0)return e.jsx(ie,{});const m=o.items,d=Math.ceil((o.total??0)/A);return a>=d&&d!==0&&n(Math.max(d-1,0)),e.jsxs("div",{children:[e.jsxs(c.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),i&&e.jsx("col",{className:"w-16"})]}),e.jsxs(c.Header,{children:[e.jsx(c.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(h,{...w.email})}),e.jsx(c.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(h,{...w.invitedDate})}),e.jsx(c.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:i?"ps-3":"",children:e.jsx(h,{...w.role})})}),i&&e.jsx(c.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(c.Body,{children:[m.map(g=>e.jsx(ys,{workspaceId:s,invite:g,isCurrentUserOwner:r,currentUserHasAdminRights:i},g.id)),m.length===0&&e.jsx(c.Row,{children:e.jsx(c.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(h,{...w.noResults})})})})]})]}),d>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ae,{currentPage:a,onChangeIndex:n,length:d})})]})}function ys({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){const r=M(),l=z(),i=Me(s),o=je(s),m=ts(s);return e.jsxs(c.Row,{className:"[&>td]:py-2",disabled:i.isPending||o.isPending||o.isSuccess||m.isPending,children:[e.jsx(c.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ne,{userName:t.email_address??"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(c.Cell,{children:r.formatDate(t.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(c.Cell,{children:a?e.jsx(re,{currentRole:t.role,onUpdateUserRole:d=>{i.mutate({inviteId:t.id,role:d})}}):l[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(c.Cell,{children:e.jsx(Cs,{onDeleteUser:()=>{o.mutate({email:t.email_address??""})},onResendInvite:()=>{m.mutate({email:t.email_address??"",role:t.role??""})},disabled:t.is_scim_managed})})})]})}function Cs({onDeleteUser:s,onResendInvite:t,disabled:a}){const n=M();return e.jsx(e.Fragment,{children:a?e.jsx(p.Root,{children:e.jsx(p.Trigger,{disabled:!0,children:e.jsx(ge,{label:n.formatMessage(pe.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(E,{className:"icon-sm"})})})}):e.jsxs(p.Root,{children:[e.jsx(p.Trigger,{children:e.jsx(E,{className:"icon-sm"})}),e.jsx(p.Portal,{children:e.jsxs(p.Content,{children:[e.jsx(p.Item,{onClick:t,children:e.jsx(h,{...w.resendInvite})}),e.jsx(p.Item,{onClick:s,children:e.jsx(h,{...w.revokeInvite})})]})})]})})}const w=y({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),Rs=({workspaceId:s})=>{const t=M(),[a,n]=x.useState(""),[r,l]=x.useState(""),i=x.useMemo(()=>se(o=>l(o),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(te,{value:a,onChange:o=>{n(o.target.value),i(o.target.value)},placeholder:t.formatMessage(_s.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Ns,{workspaceId:s,filterInputValue:r})]})},_s=y({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}}),Us=we(()=>Ae(()=>import("./dfbgvqz3f2t2gfhn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));function Ps({workspaceId:s}){const t=M(),a=Z(),[n,r]=x.useState(""),[l,i]=x.useState(""),o=x.useMemo(()=>se(f=>i(f),300,{leading:!1,trailing:!0}),[]),m=ee();if(!a)return null;const d=a?.isTeam(),g=a.isAdminOfAccount(),u=a.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(te,{value:n,onChange:f=>{r(f.target.value),o(f.target.value)},placeholder:t.formatMessage(O.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(g||u||d)&&e.jsx(L,{onClick:()=>{qe.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),ue(m,({onClose:f})=>e.jsx(Us,{workspace:a,onClose:f}))},icon:Le,children:e.jsx(h,{...O.inviteMemberButton})}),d?e.jsx(Se,{triggerButton:e.jsx(L,{color:"secondary",icon:E}),children:e.jsx(p.Item,{onClick:()=>{a&&De.setLeaveWorkspaceData(a)},children:e.jsx(h,{...O.leaveWorkspace})})}):null]})]}),e.jsx(ms,{workspaceId:s,filterInputValue:l}),e.jsx("p",{className:"text-token-text-secondary mt-4 text-sm",children:e.jsx(h,{...O.memberListUpdateDelayNote})})]})}const O=y({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"},memberListUpdateDelayNote:{id:"adminPage.memberListUpdateDelayNote",defaultMessage:"Note: Although new workspace members can access ChatGPT immediately, it may take up to 24 hours to show them in this list."}}),Is=s=>s==="members"||s==="invites"||s==="requests";function ks({currentWorkspaceId:s}){const t=M(),a=Z(),n=Ge(s)??"?",r=$e(a),l=x.useMemo(()=>[{key:"members",label:t.formatMessage(I.allMembers),children:e.jsx(Ps,{workspaceId:s})},{key:"invites",label:t.formatMessage(I.pendingInvites),children:e.jsx(Rs,{workspaceId:s})},{key:"requests",label:t.formatMessage(I.pendingRequests),children:e.jsx(bs,{workspaceId:s})}],[s,t]),i=xe(),[o]=Ee(),m=o.get("tab"),[d,g]=x.useState(m&&Is(m)?m:l[0].key),u=f=>{g(f),i({pathname:window.location.pathname,search:new URLSearchParams({tab:f}).toString()})};return a?e.jsxs(e.Fragment,{children:[e.jsx(ze,{children:e.jsx("title",{children:t.formatMessage(I.adminBrowserPageTitle)})}),e.jsx(Xe,{title:t.formatMessage(I.adminPageTitle),subtitle:e.jsx(h,{values:{totalMembers:n,planName:r},...I.totalMembers}),tabsHeader:e.jsx(Qe,{items:l,activeTab:d,onTabChange:u})}),e.jsx(Ye,{children:e.jsx(Je,{items:l,activeTab:d})})]}):null}const I=y({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} · {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"}}),at=Te(function(){const t=Ze();return e.jsx(ks,{...t})});export{at as default};
//# sourceMappingURL=kmw6vvdbztx3wnz8.js.map

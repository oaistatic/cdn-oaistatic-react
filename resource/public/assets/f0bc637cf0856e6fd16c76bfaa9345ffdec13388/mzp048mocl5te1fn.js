import{f as xe,j as e,d as ue,u as Ee,b as Ge,r as p,L as he,M as k,e as Ke,am as Je,a as Qe,R as Ze}from"./m60bpb0x3x7rg8fj.js";import{e as Se,b2 as je,A as y,kJ as Ae,z as f,rf as Xe,rg as es,rh as ss,p as ts,P as b,e7 as ae,cs as ye,B as ne,S as Ce,C as Ne,ri as Be,W as as,M as ns,R as os,b0 as Ue,rj as ls,Z as oe,kw as is,rk as rs,jb as cs,aa as Fe,aq as ds,ab as us,rl as ms,bc as ps,ga as gs,_ as fs,rm as hs,p1 as ys,iB as Ps,v as xs,N as _s}from"./lgw4q0e8zlqqfgug.js";import{ah as bs,mb as Le,mc as Oe,bt as De,md as Cs,me as F,mf as de,mg as Ie,mh as Ss,mi as ks,d_ as vs,ak as z,mj as Ms,mk as Ts,ml as ws}from"./ggjzadbnd3k1vu0k.js";import{S as Es}from"./mb9azmyuz6lg619u.js";import{u as We,g as js,h as He,m as ge,a as Ns,b as ve,f as Os,M as ze,P as $e,S as As,c as Ls,d as Is,T as Rs,e as Gs,F as Bs}from"./m40e1ct7so23v704.js";import{u as Ve}from"./jozqsyj8lvw2y89i.js";import{u as qe}from"./fnje4v6gzdtvboh3.js";import{a as Us,b as Fs,M as Ds}from"./glu06a3y5u0laqff.js";function Ws({value:t,onChange:s}){const a=xe();return e.jsx(Es,{value:t,onChange:s,ariaLabel:a.formatMessage(fe.toggleArialabel),leftItem:{ariaLabel:a.formatMessage(fe.togglePersonalArialabel),label:a.formatMessage(fe.togglePersonalLabel),value:"personal"},rightItem:{ariaLabel:a.formatMessage(fe.toggleBusinessArialabel),label:a.formatMessage(fe.toggleBusinessLabel),value:"business"}})}const fe=ue({toggleArialabel:{id:"U4v2Gf",defaultMessage:"Toggle for switching between Personal and Business plans"},togglePersonalArialabel:{id:"6Wikht",defaultMessage:"Toggle for switching to Personal plans"},toggleBusinessArialabel:{id:"uzlEV0",defaultMessage:"Toggle for switching to Business plans"},togglePersonalLabel:{id:"cGDsaD",defaultMessage:"Personal"},toggleBusinessLabel:{id:"sgisa2",defaultMessage:"Business"}}),ce=y.PRO,Ye=()=>Ee({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await os.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")}),Hs=({analyticsParams:t,currentAccount:s,planLoading:a,className:n,onSubmit:i,setPlanLoading:u,billingDetails:r,isWebRedesign:l,autoUpgrade:c=!1,shouldUseComparisonSpacing:h=!1,fromiOSWebview:g=!1})=>{const{data:P,isError:I}=Ye(),x=Se(),{data:v,refetch:C}=Ee(Ue),d=xe(),E=je(),[j]=Ge(),{trackSelectedPixels:m}=qe({key:y.PRO}),O=j.get("checkout_from"),[S,A]=p.useState(!1),[B,D]=p.useState(!1),[M,T]=p.useState(!1),Y=p.useRef(!1),w=s.getLastActiveSubscription(),U=s.isOrWasPaidCustomer(),R=s.hasPaidSubscription(),_=R&&s.isPro(),$=!!v?.email,{prepareCheckoutSession:K,navigateToCheckout:le}=Ve(),{recentlyDowngraded:ie}=We(),{daysUntilPlanChanges:re,isDowngradeScheduled:Z}=js(s,ie),J=bs({isWebRedesign:l}),Q=[],N={...t,planType:ce},X=R&&w.purchase_origin_platform===Ae.MOBILE_IOS,ee=R&&w.purchase_origin_platform===Ae.MOBILE_ANDROID,V=async te=>{if(!$&&!te){T(!0);return}u?.(y.PRO),b.logEvent("Account Pay: Payment Checkout Clicked",N),ae(x,"chatgpt_account_payment_modal_upgrade_button_click",ce);try{const o=await K({plan_name:"chatgptpro",billing_details:r},{fromiOSWebview:g});i?.(),m(),b.logEvent("Account Pay: Navigating to Payment Checkout",{...N,url:o.url??""}),ae(x,"chatgpt_account_payment_modal_navigating_to_checkout",ce,{url:o.url??""}),O==="vza493q"&&as.setItem(ns.CheckoutFrom,O),await le(o)}catch{E.warning(d.formatMessage(ge.paymentErrorWarning),{hasCloseButton:!0})}u?.(null)};p.useEffect(()=>{!c||Y.current||(Y.current=!0,G())},[c]);const me=()=>{b.logEvent("Account Portal: Click iOS Manage Subscription",N)},pe=()=>{b.logEvent("Account Portal: Click Android Manage Subscription",N)};_&&X&&Q.push(e.jsx(he,{to:Xe,target:"_blank",onClick:me,className:f(l?"px-1 font-medium":"px-2","underline"),children:d.formatMessage(Le.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),_&&ee&&Q.push(e.jsx(he,{to:es,target:"_blank",onClick:pe,className:f(l?"px-1 font-medium":"px-2","underline"),children:d.formatMessage(Le.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),U&&Q.push(e.jsx(he,{target:"_blank",to:ss,onClick:He,className:f(l?"px-1 font-medium":"px-2","underline"),children:e.jsx(k,{...ge.billingHelp})},"row-plus-plan-help-link"));const W=function(){A(!S)},H=function(){D(!B)},L=ts(x,"1382475798"),G=async()=>{const te=s.hasPaidSubscription(),o=L&&s.isActiveSubscriptionGratis();te&&!o?(b.logEvent("Account Pay: Payment Checkout Clicked",N),ae(x,"chatgpt_account_payment_modal_upgrade_button_click",ce),D(!0)):await V()},se=I||!P||!P.value?G:()=>{W()};return Ns(M,{plan:N}),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{planType:ce,pricingPlan:J,callToActionButton:e.jsxs("div",{children:[X||ee?e.jsx(ye,{side:"top",sideOffset:20,label:d.formatMessage(zs.switchToMobile),onOpenChange:te=>{te&&(b.logEvent("Account Pay: Show Mobile Subscription Tooltip",N),ae(x,"chatgpt_account_payment_modal_show_mobile_subscription_tooltip",ce))},children:e.jsx(ne,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:d.formatMessage(ve({ctx:x,planType:y.PRO}))})}):Z&&re?e.jsx(ye,{side:"top",sideOffset:20,label:e.jsx(k,{id:"MUQGzU",defaultMessage:"Your subscription will remain active until {date}, when it will change to {nextPlanType}.",values:{date:Os(re,d.locale),nextPlanType:De(s.getNextPlanType()?.toLowerCase()??"")}}),children:e.jsx(ne,{fullWidth:!0,size:"large",color:"primary",disabled:_||a!=null,"data-testid":"select-plan-button-pro-upgrade",className:_||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===y.PRO&&!B?e.jsx(Ce,{}):_?d.formatMessage(J.callToAction.active):d.formatMessage(ve({ctx:x,planType:y.PRO}))})}):e.jsx(ne,{fullWidth:!0,size:"large",color:"primary",disabled:_||a!=null,onClick:se,"data-testid":"select-plan-button-pro-upgrade",className:_||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===y.PRO&&!B?e.jsx(Ce,{}):_?d.formatMessage(J.callToAction.active):d.formatMessage(ve({ctx:x,planType:y.PRO}))}),e.jsx(ze,{isOpen:S,onClose:W,onContinue:V,analyticsParams:N}),B&&e.jsx($e,{isOpen:B,onClose:H,accountId:s.id,initialPlanType:s.planType,updatedPlanType:y.PRO,billingDetails:r})]}),additionalLinks:Q,className:f("bg-token-main-surface-primary",n),billingDetails:r,isWebRedesign:l,shouldUseComparisonSpacing:h}),e.jsx(Ne,{testId:"modal-add-email",isOpen:M,onClose:()=>T(!1),type:"success",className:"max-w-sm",children:e.jsx(Be,{enterEmailTitle:d.formatMessage(ge.addEmailTitle),enterEmailDescription:d.formatMessage(ge.addEmailDescription),onVerified:()=>{C(),T(!1),V(!0)},cancelFlowButton:e.jsx(ne,{className:"w-full rounded-md",color:"secondary",onClick:()=>T(!1),children:e.jsx(k,{...ge.cancelAddEmail})})})})]})},zs=ue({switchToPersonalAccount:{id:"y5FjSF",defaultMessage:"Switch to a personal account to upgrade"},switchToMobile:{id:"gbjsg6",defaultMessage:"It looks like you already have an active mobile subscription. Switch to your mobile app to upgrade"}}),Me=y.ENTERPRISE_CBP,$s=({analyticsParams:t,billingDetails:s,currentAccount:a,planLoading:n,isWebRedesign:i,type:u=F.standard,shouldUseComparisonSpacing:r=!1,className:l})=>{const c=Cs(),h={...t,planType:Me},g=a.isEnterprisey(),P=()=>{b.logEventWithStatsig("Account Pay: Contact sales clicked","chatgpt_account_payment_modal_contact_sales_clicked",h)};return e.jsx(Oe,{paymentsOverrideString:Te.customPricing,billingDetails:s,pricingPlan:c,className:l,planType:Me,isWebRedesign:i,type:u,shouldUseComparisonSpacing:r,callToActionButton:e.jsx(As,{planType:Me,isCurrentPlan:g,disabled:n!=null||g,testId:"select-plan-button-enterprise-contact",onClick:P,as:"a",to:ls,openNewTab:!0,rel:"noopener noreferrer",activeColor:u===F.highlight?"purple":g?"secondary":"primary",children:g?e.jsx(k,{...Te.active}):e.jsx(k,{...Te.contactSales})})})},Te=ue({contactSales:{id:"pricing.enterpriseRedesign.ctaContactSales",defaultMessage:"Contact sales"},active:{id:"pricing.enterpriseRedesign.ctaActive",defaultMessage:"Your current plan"},customPricing:{id:"pricing.enterpriseRedesign.customPricing",defaultMessage:"Custom pricing"}});function Vs(t,s){const a=is(new Date,t);return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(a)}function qs({testId:t,activeColor:s,children:a,...n}){return e.jsx(ne,{fullWidth:!0,size:"large",color:s??"primary","data-testid":t,...n,children:a})}function Ys(t,s){const a=t.planType,n=t.getNextPlanType(),i=t.getDaysUntilPlanChanges(),u=n&&de(n)<de(a);return s?{daysUntilPlanChanges:t.getDaysUntilPlanRenews(),isDowngradeScheduled:!0}:{daysUntilPlanChanges:i,isDowngradeScheduled:u}}function Ks({currentAccount:t,children:s,disableForMobile:a,promoMetadata:n,planType:i,downgradeToGoDisabled:u}){const{recentlyDowngraded:r}=We(),l=xe(),{daysUntilPlanChanges:c,isDowngradeScheduled:h}=Ys(t,r),g=p.useRef(!1),P=n!=null&&"referrer_name"in n,I=Ss(t);return a&&!I?e.jsx(ye,{side:"top",sideOffset:20,label:l.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:v=>{v&&!g.current&&(P&&ks.logMobileSubscriptionTooltipOpen(),g.current=!0)},children:s}):u?e.jsx(ye,{side:"top",labelTextAlign:"left",sideOffset:20,label:l.formatMessage({id:"AccountPaymentModal.primaryCTA.downgradeToGoDisabledTooltip",defaultMessage:"Downgrading to Go is not yet available. To purchase, you must first cancel your current plan."}),children:s}):h&&c?e.jsx(ye,{side:"top",sideOffset:20,label:e.jsx(k,{id:"3UZynm",defaultMessage:"Your subscription will change to {planType} on {date}.",values:{date:Vs(c,l.locale),planType:De(i.toLowerCase())}}),children:s}):e.jsx(e.Fragment,{children:s})}function Js({analyticsParams:t,billingDetails:s,currentAccount:a,planType:n,planLoading:i,setPlanLoading:u,testId:r,onPromoClose:l,activeColor:c,disableForMobile:h=!1,disabled:g,downgradeToGoDisabled:P=!1,inhouseCheckoutExperimentEnabled:I=!1,loading:x=!1,overrideOnClick:v,promoCode:C,promoMetadata:d,autoUpgrade:E=!1,fromiOSWebview:j=!1,pricingPlan:m,children:O,...S}){const{data:A,refetch:B}=Ee(Ue),{trackSelectedPixels:D}=qe({key:n}),M=Se(),{data:{value:T}={}}=Ye(),[Y,w]=p.useState(!1),[U,R]=p.useState(!1),_=p.useRef(null),[$,K]=p.useState(!1),le=p.useRef(!1),ie=p.useRef(new Map),re=je(),Z=xe(),J=a.planType,Q=de(n)<de(J),N=d?.plan_name===Ie(n)&&d?.plan_type_change==="equal",X=oe(M,"3950229590"),{prepareCheckoutSession:ee,navigateToCheckout:V}=Ve(),me=()=>{const H={plan_name:Ie(n),billing_details:s,promo_code:C},L=ie.current.get(JSON.stringify(H));if(L)return b.logEventWithStatsig("Account Pay: Using Prefetched Checkout Session","chatgpt_account_payment_modal_using_prefetched_checkout_session",t),L;b.logEventWithStatsig("Account Pay: Click to Fetch Checkout Session","chatgpt_account_payment_modal_click_to_fetch_checkout_session",t);let G=!1;return I&&(ie.current.clear(),G=X.get("skip_sentinel_checkout",!1)),ee(H,{skipSentinelCheckout:G,fromiOSWebview:j})},pe=async({skipEmailCheck:H})=>{if(!A?.email&&!H){K(!0);return}u(n),b.logEvent("Account Pay: Payment Checkout Clicked",t),ae(M,"chatgpt_account_payment_modal_upgrade_button_click",n),_.current=performance.now();try{const L=await me();let G;_.current&&(G=performance.now()-_.current),b.logEvent("Account Pay: Navigating to Payment Checkout",{...t,url:L.url??"",latency_ms:G});const se={url:String(L.url??"")};G!==void 0&&(se.latency_ms=G.toString()),ae(M,"chatgpt_account_payment_modal_navigating_to_checkout",n,se),await V(L)}catch{re.warning(Z.formatMessage(be.paymentErrorWarning),{hasCloseButton:!0})}u(null)},W=({skipAppStoreSubscriptionInBillingRetryCheck:H=!1,skipEmailCheck:L=!1}={})=>{if(T&&!H)return w(!0);if(v)return v();Q||N?(b.logEvent("Account Pay: Payment Checkout Clicked",t),ae(M,"chatgpt_account_payment_modal_upgrade_button_click",n),R(!0)):(D(),pe({skipEmailCheck:L}))};return p.useEffect(()=>{!E||le.current||(le.current=!0,W())},[E]),e.jsxs(e.Fragment,{children:[e.jsx(Ks,{currentAccount:a,disableForMobile:h,promoMetadata:d,planType:n,downgradeToGoDisabled:P,children:e.jsx(qs,{disabled:g,loading:x,onClick:()=>W(),testId:r,activeColor:c,...S,children:i===n?e.jsx(Ce,{}):O})}),e.jsx(ze,{isOpen:Y,onClose:()=>w(!1),onContinue:()=>W({skipAppStoreSubscriptionInBillingRetryCheck:!0}),analyticsParams:t}),U&&e.jsx($e,{isOpen:U,onClose:()=>R(!1),accountId:a.id,initialPlanType:J,updatedPlanType:n,billingDetails:s,promoMetadata:d,promoCode:C,onPromoClose:l,fullPriceResumeDateString:m.fullPriceResumeDateString}),e.jsx(Ne,{testId:"modal-add-email",isOpen:$,onClose:()=>K(!1),type:"success",className:"max-w-sm",children:e.jsx(Be,{enterEmailTitle:Z.formatMessage(be.addEmailTitle),enterEmailDescription:Z.formatMessage(be.addEmailDescription),onVerified:()=>{B(),K(!1),W({skipEmailCheck:!0})},cancelFlowButton:e.jsx(ne,{className:"w-full rounded-md",color:"secondary",onClick:()=>K(!1),children:e.jsx(k,{...be.cancelAddEmail})})})})]})}const be=ue({paymentErrorWarning:{id:"AccountPaymentModal.primaryCTA.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},addEmailTitle:{id:"AccountPaymentModal.primaryCTA.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.primaryCTA.addEmailDescription",defaultMessage:"You'll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.primaryCTA.cancelAddEmail",defaultMessage:"Cancel"},highDemandDisabledText:{id:"AccountPaymentModal.primaryCTA.highDemandDisabledText",defaultMessage:"Due to high demand, we've temporarily paused upgrades."}}),Re=y.GO,Qs=({analyticsParams:t,billingDetails:s,setPlanLoading:a,isWebRedesign:n,currentAccount:i,planLoading:u,promoMetadata:r,type:l,autoUpgrade:c,fromiOSWebview:h,promoCode:g,onClose:P,shouldUseComparisonSpacing:I=!1,className:x})=>{const v={...t,planType:y.GO},C=xe(),d=vs({isWebRedesign:n}),E=i.hasPaidSubscription(),j=E&&i.isGo(),m=!j&&!u,O=l==="promo"&&r?.plan_type_change==="equal",S=i.getNextPlanType()===y.GO,B=!(m||O)||S,D=E&&de(y.GO)<de(i.planType);let M="primary";(l==="promo"||l==="highlight")&&(M="purple"),E&&l!=="promo"&&(M="secondary");const T=r&&Ls({intl:C,planName:y.GO,pricingPlan:d,promoMetadata:r,currency:s.currency,currentAccount:i}),{activeDiscountMetadata:Y,scheduledAdditionalLink:w}=Is({isWebRedesign:n,currentAccount:i,intl:C,billingDetails:s,pricingPlan:d,promoMetadata:r,columnPlanType:y.GO}),U=[];w&&U.push(w),r||U.push(e.jsx(k,{...we.limitsApplyLink,values:{link:_=>e.jsx(he,{target:"_blank",rel:"noopener noreferrer",to:rs,onClick:He,className:f("underline",n&&"font-medium"),children:_},"row-go-plan-help-link")}},"limits-apply-link"));const R=T??d;return e.jsx(Oe,{className:x,isGoColumn:!0,type:l,planType:Re,activeDiscountMetadata:Y,pricingPlan:R,promoMetadata:r,secondaryCallToActionButton:l==="promo"?e.jsx(ne,{size:"large",color:"secondary",onClick:P,children:e.jsx(k,{...we.notNow})}):null,callToActionButton:e.jsx(Js,{currentAccount:i,analyticsParams:v,billingDetails:s,planLoading:u,promoCode:g,setPlanLoading:a,planType:Re,onPromoClose:P,disabled:B,testId:"select-plan-button-go-upgrade",pricingPlan:R,activeColor:D&&l!=="promo"?"secondary":M,promoMetadata:r,autoUpgrade:c,fromiOSWebview:h,children:l==="promo"&&j?e.jsx(k,{...d.callToAction.promo}):j?e.jsx(k,{...d.callToAction.active}):D?e.jsx(k,{...we.switchToGo}):e.jsx(k,{...d.callToAction.inactive})}),additionalLinks:U,billingDetails:s,isWebRedesign:n,shouldUseComparisonSpacing:I})},we=ue({limitsApplyLink:{id:"GoColumn.limitsApplyLink",defaultMessage:"Only available in certain regions. <link>Limits apply</link>"},switchToGo:{id:"GoColumn.switchToGo",defaultMessage:"Switch to Go"},notNow:{id:"GoColumn.notNow",defaultMessage:"Not Now"}});function Zs({analyticsParams:t,currentAccount:s,planLoading:a,selectedTab:n,setPlanLoading:i,shouldSplitBetweenPersonalAndBusiness:u,billingDetails:r,scrollExperimentVariant:l,onClose:c,isWebRedesign:h,ctx:g,businessComparisonEnabled:P=!1,eligibleComparisonPlans:I,autoUpgradePlanType:x,fromiOSWebview:v,isUnifiedPricingPage:C}){const d=s.hasPaidSubscription(),E=cs(g),j=l==="move_free_to_bottom",m=et(n,P,I,s),O=Xs({selectedTab:n,shouldSplitBetweenPersonalAndBusiness:u,hasPaidSubscription:d,moveFreeToBottom:j,isGoEnabled:E,isTeamAccount:s.isTeam(),isComparisonExperiment:!!P,comparisonPlanName:m});return O.length===0&&Fe.addError(new Error("Account payment modal missing columns")),O.map(S=>{switch(S){case"free":return e.jsx(Bs,{className:f(C&&"w-full"),billingDetails:r,isWebRedesign:h,shouldUseComparisonSpacing:m==="free"},S);case"go":{const A=n==="business"&&m==="go"?F.standard:E&&s.isFree()?F.highlight:F.standard;return e.jsx(Qs,{analyticsParams:t,setPlanLoading:i,className:f(C&&"w-full"),billingDetails:r,isWebRedesign:h,currentAccount:s,planLoading:a,type:A,autoUpgrade:x===y.GO,fromiOSWebview:v,shouldUseComparisonSpacing:m==="go"},S)}case"plus":{const A=n==="business"&&m==="plus"?F.standard:s.isFree()&&!E?F.highlight:F.standard;return e.jsx(Gs,{analyticsParams:t,currentAccount:s,setPlanLoading:i,planLoading:a,className:f(C&&"w-full"),billingDetails:r,onClose:c,isWebRedesign:h,type:A,shouldUseComparisonSpacing:m==="plus",autoUpgrade:x===y.PLUS,fromiOSWebview:v},S)}case"team":return e.jsx(Rs,{analyticsParams:t,billingDetails:r,currentAccount:s,className:f(C&&"w-full"),planLoading:a,isWebRedesign:h,isUnifiedPricingPage:C,type:P===!0?F.highlight:F.standard,shouldUseComparisonSpacing:m!==void 0},S);case"enterprise":return e.jsx($s,{analyticsParams:t,billingDetails:r,currentAccount:s,className:f(C&&"w-full"),planLoading:a,isWebRedesign:h,type:F.standard,shouldUseComparisonSpacing:m==="enterprise"},S);case"pro":return e.jsx(Hs,{analyticsParams:t,currentAccount:s,setPlanLoading:i,className:f(C&&"w-full"),planLoading:a,billingDetails:r,isWebRedesign:h,autoUpgrade:x===y.PRO,fromiOSWebview:v,shouldUseComparisonSpacing:m==="pro"},S)}return null})}function Xs({selectedTab:t,shouldSplitBetweenPersonalAndBusiness:s,hasPaidSubscription:a,moveFreeToBottom:n,isGoEnabled:i,isTeamAccount:u,isComparisonExperiment:r,comparisonPlanName:l}){const c=[];return t==="personal"?(!a&&!n&&c.push("free"),i&&c.push("go"),c.push("plus"),c.push("pro"),n&&c.push("free")):(r&&!u&&l&&c.push(l),c.push("team")),c}function et(t,s,a,n){if(t==="business"&&!(!s||!a)){if(n.isFree())return a.has("free")?"free":void 0;if(n.isGo())return a.has("go")?"go":void 0;if(n.isPlus())return a.has("plus")?"plus":void 0;if(n.isPro())return a.has("pro")?"pro":void 0;if(n.isEnterprisey())return a.has("enterprise")?"enterprise":void 0}}const st=({className:t})=>{const s="relative flex flex-1 flex-col justify-center gap-3 rounded-2xl px-6 pt-6 pb-8 text-sm",a=f("border border-token-border-default","md:min-h-[30rem] md:max-w-96 md:pb-6");return e.jsxs("div",{className:f(s,a,"bg-token-main-surface-primary","w-full",t),role:"status","aria-busy":"true",children:[e.jsxs("div",{className:"mt-2 mb-5 flex items-center justify-between gap-4",children:[e.jsx(z,{className:"h-8 w-15"}),e.jsx(z,{className:"h-5 w-20 rounded-full"})]}),e.jsxs("div",{className:"mb-2 flex items-end gap-4",children:[e.jsx(z,{className:"h-15 w-20"}),e.jsxs("div",{className:"flex w-44 flex-col gap-2",children:[e.jsx(z,{className:"h-5 w-10"}),e.jsx(z,{className:"h-5 w-20"})]})]}),e.jsx(z,{className:"mb-3 h-5 w-2/3"}),e.jsx(z,{className:"mb-5 h-10 w-full rounded-full"}),e.jsx("div",{className:"flex flex-col gap-5",children:Array.from({length:7}).map((i,u)=>e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-center gap-3",children:[e.jsx(z,{className:"h-5 w-5 rounded"}),e.jsx(z,{className:f("h-5",["w-[88%]","w-[92%]","w-[86%]","w-[90%]","w-[84%]","w-[96%]","w-[85%]"][u])})]},u))}),e.jsx("div",{className:"mt-8 flex flex-col gap-1",children:e.jsx(z,{className:"h-3 w-5/6"})})]})};function tt({ctx:t,currentAccount:s,selectedTab:a,isWebRedesign:n,user:i}){const u={comparisonEnabled:!1,eligiblePlans:new Set};if(a!=="business"||!n)return u;const l=i!=null&&hs(i)&&(s.isFree()||s.isPlus()),c=oe(t,"2762630623"),h=l?c.get("variant","control"):"control",g=s.isFree()||s.isGo()||s.isPlus()||s.isPro(),P=oe(t,"4105912492");return(g?P.get("variant","control"):"control")!=="control"?{comparisonEnabled:!0,eligiblePlans:new Set(["free","go","plus","pro"])}:h!=="control"?{comparisonEnabled:!0,eligiblePlans:new Set(["free","plus"])}:u}const at=({defaultTab:t})=>{const a=!fs(),n=Se();return a&&t==="personal"?oe(n,"2675205028").get("scroll_to_plus_variant","control"):null};function gt({currentAccount:t,defaultTab:s="personal",onClose:a,subtitle:n,title:i,isDefaultTabLoading:u=!1}){const[r,l]=p.useState(null),c=Ke(),[h]=Ge(),g=h.get("plan"),P=h.get("from_webview"),I=!t.hasPaidSubscription()&&P==="ios"&&!!g,x=g===y.PLUS||g===y.PRO||g===y.GO?g:null,v=h.get("from_webview")==="ios",C=ds(),d=Je(),E=us(),j=Se(),m=oe(j,"2675205028").get("show_web_redesign",!1),O=at({defaultTab:s});p.useEffect(()=>{const o=performance.now();return()=>{if(o){const q=performance.now()-o;b.logValueEventWithStatsig({segmentEventName:"Account Pay: Account Payment Modal Time Spent",statsigEventName:"chatgpt_web_account_payment_modal_time_spent",value:Math.round(q)})}}},[]);const S=!0,A=p.useMemo(()=>({...t.subscriptionAnalyticsParams,referrer:document.referrer}),[t]),B=Qe(),D=je(),M=p.useCallback(()=>{b.logEvent("Account Pay: Close Account Payment Modal",A),a()},[A,a]);p.useEffect(()=>{const o=localStorage.getItem(`subscriptionUpdateMessage_${t.id}`);if(o){localStorage.removeItem(`subscriptionUpdateMessage_${t.id}`),D.success(o,{hasCloseButton:!0});const q=setTimeout(()=>{M()},5e3);return()=>{clearTimeout(q)}}},[t.id,D,M]);const[T,Y]=p.useState(s),{country:w,setCountry:U,userCountry:R}=Us(),_=nt({currentAccount:t,selectedTab:T}),$=Fs({country:_?w:ys,currentAccount:t,location:"AccountPaymentModal",shouldUsePaidSubscriptionBillingCurrency:T==="personal"}),{comparisonEnabled:K,eligiblePlans:le}=tt({ctx:j,currentAccount:t,selectedTab:T,isWebRedesign:m,user:C});Ms(()=>{const o=c.state?.[Ps],q=c.key;o&&B({hash:c.hash,search:c.search},{replace:!0,state:{}});const ke=new URLSearchParams(window.location.search).get("referrer")??document.referrer;xs.count(_s.DEFAULT,"chatgpt_account_payment_modal_show",[{key:"location",value:o},{key:"locationKey",value:q},{key:"navigationType",value:d},{key:"initialTab",value:s},{key:"initialCountrySelectorCountry",value:w},{key:"selectedCountry",value:$.country??""},{key:"selectedCurrency",value:$.currency??""},{key:"userCountry",value:R??""},{key:"isCountrySelectorEnabled",value:String(_)}]),b.logEventWithStatsig("Account Pay: Account Payment Modal Show","chatgpt_account_payment_modal_show",{...A,initialTab:s,location:o,locationKey:q,navigationType:d,initialCountrySelectorCountry:w,selectedCountry:$.country??"",selectedCurrency:$.currency??"",userCountry:R??"",isCountrySelectorEnabled:_,referrer:ke})});const ie=p.useCallback(o=>{Fe.addAction("chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:w,new_selected_country:o}),b.logEventWithStatsig("Selected country changed in pricing modal","chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:w,new_selected_country:o}),U(o)},[w,U]),re=o=>{Y(o);const _e=new URLSearchParams(window.location.search).get("referrer")??document.referrer;b.logEventWithStatsig("Account Pay: Account Payment Modal Toggle Clicked","chatgpt_account_payment_modal_toggle_clicked",{selectedTab:o,referrer:_e})},Z=136,[J,Q]=p.useState(),N=p.useRef(null);p.useEffect(()=>{const o=()=>{if(N.current){const q=document.documentElement.clientHeight,_e=N.current.getBoundingClientRect().height,ke=q-_e;Q(Math.max(ke,Z))}};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[T]);const X=m&&oe(j,"664995304").get("show_unified_pricing_page",!1),ee=Zs({analyticsParams:A,currentAccount:t,planLoading:r,selectedTab:T,setPlanLoading:l,shouldSplitBetweenPersonalAndBusiness:S,billingDetails:$,scrollExperimentVariant:O,onClose:a,isWebRedesign:m,ctx:j,businessComparisonEnabled:K,eligibleComparisonPlans:le,autoUpgradePlanType:x,fromiOSWebview:v,isUnifiedPricingPage:X}),V=Ze.Children.toArray(ee).length,me=Ts(),pe=ot({defaultTitle:i,showPlusFreeTrialTitle:me&&T==="personal",hasProSubscription:t.isPro()}),W=p.useRef(!1);p.useEffect(()=>{const o=document.getElementById(ms);o?.scrollIntoView&&!W.current&&O==="scroll_to_plus"&&(o.scrollIntoView({behavior:"smooth"}),W.current=!0)},[O]);const H="flex flex-col justify-center gap-4 px-3 py-3 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0",L="flex justify-center gap-6 flex-col md:flex-row px-4",G=f("grid w-full gap-6 px-4","grid-cols-1",V>1&&"md:grid-cols-2",V>2?"lg:grid-cols-3":V>1&&"lg:grid-cols-2","md:justify-items-center","md:mx-auto md:max-w-[1200px]"),se=X?G:m?L:H,te=oe(j,"3432045939").get("hide_on_click_outside_payment_modal",!0);return e.jsxs(Ne,{testId:"modal-account-payment",size:"fullscreen",isOpen:!0,onClose:M,type:"success",className:"flex flex-col",removePopoverStyling:!0,shouldIgnoreClickOutside:!te,children:[e.jsxs("div",{ref:N,className:f(m&&"bg-token-bg-elevated-secondary"),children:[e.jsxs("div",{className:f("relative grid grid-cols-[1fr_auto_1fr] px-6 py-4 md:pt-[4.5rem]",m?"md:pb-6":"md:pb-10"),children:[e.jsx("div",{}),e.jsxs("div",{className:"my-1 flex flex-col items-center justify-center md:mt-0 md:mb-0",children:[e.jsx("h2",{className:"text-page-header",children:e.jsx(k,{...pe})}),n?e.jsx("div",{className:"text-token-text-secondary mt-3 mb-1",children:e.jsx(k,{...n})}):null]}),!v&&e.jsx("button",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-6 md:top-6",onClick:()=>{M()},children:e.jsx(ps,{className:f({"h-5 w-5":!E,"icon-lg":E})})})]}),!v&&t.isPersonalAccount()&&S?e.jsx("div",{className:f("mb-3 flex justify-center",m?"md:mb-6":"md:mb-10"),children:e.jsx("div",{className:"w-[fit-content]",children:e.jsx(Ws,{value:T,onChange:re})})}):null,u?e.jsx("div",{className:se,children:e.jsx(st,{})}):e.jsx("div",{className:se,children:ee})]}),e.jsxs("div",{className:f("relative grid grid-cols-[1fr_auto_1fr]",m&&"bg-token-bg-elevated-secondary"),style:{height:`${J}px`},children:[e.jsx("div",{}),e.jsxs("span",{className:f("text-token-text-secondary mt-8 mb-12 flex flex-col items-center justify-start gap-2 text-sm md:mt-8 md:mb-8",m&&"md:mt-10"),children:[e.jsx(ws,{}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(k,{...Pe.needMoreCapabilities}),e.jsx("div",{children:e.jsx(k,{...Pe.seeChatGptEnterprise,values:{link:o=>e.jsx(he,{target:"_blank",to:gs,onClick:()=>{b.logEventWithStatsig("Account Pay: Click see enterprise link from Modal","chatgpt_account_payment_modal_enterprise_link_clicked")},className:f("mx-1 underline",m&&"font-medium"),children:o})}})})]})]}),e.jsx("span",{"data-testid":"country-selector-in-pricing-modal",className:f({hidden:!_},"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-4 md:bottom-4"),children:e.jsx(Ds,{onChange:ie,value:w})})]}),I&&e.jsx("div",{className:"bg-token-bg-primary absolute inset-0 z-[9999] grid place-items-center dark:bg-[#1B1B1D]","data-testid":"account-payment-modal-loading",children:e.jsx(Ce,{className:"icon-xl text-token-text-primary"})})]})}function nt({currentAccount:t,selectedTab:s}){return!!(!t.hasPaidSubscription()||(t.isPlus()||t.isPro())&&s==="business"||t.isTeam())}function ot({defaultTitle:t,hasProSubscription:s,showPlusFreeTrialTitle:a}){return a?Pe.plusFreeTrialModalTitle:t||(s?Pe.proModalTitle:Pe.modalTitle)}const Pe=ue({modalTitle:{id:"AccountPaymentModal.modalTitle",defaultMessage:"Upgrade your plan"},plusFreeTrialModalTitle:{id:"AccountPaymentModal.plusFreeTrialModalTitle",defaultMessage:"Try Plus free for 1 month"},proModalTitle:{id:"AccountPaymentModal.proModalTitle",defaultMessage:"Choose your plan"},modalFooterCapabilities:{id:"AccountPaymentModal.modalFooterCapabilities",defaultMessage:"Need more capabilities? See <link> ChatGPT Enterprise </link>"},needMoreCapabilities:{id:"SdJWr7",defaultMessage:"Need more capabilities for your business?"},seeChatGptEnterprise:{id:"7C5fuF",defaultMessage:"See<link>ChatGPT Enterprise</link>"},promoNotEligibleMessage:{id:"AccountPaymentModal.promoNotEligibleMessage",defaultMessage:"Thanks for being a susbcriber. Since you already use ChatGPT Plus, you're not eligible for this offer."}});export{gt as A,Qs as G};
//# sourceMappingURL=mzp048mocl5te1fn.js.map

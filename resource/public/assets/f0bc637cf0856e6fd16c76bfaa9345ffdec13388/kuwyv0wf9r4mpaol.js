import{m7 as m,b2 as R,dk as h,dl as d,R as S}from"./lgw4q0e8zlqqfgug.js";import{O as E,a as O,r as n,j as b}from"./m60bpb0x3x7rg8fj.js";import{a as k}from"./bcan8xe3gkb6tcfp.js";const g="chatgpt://oauth_complete";async function T(u,e,s,r){const t=await S.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:u},query:{code:e,redirect_uri:s,...r!=null?{state:r}:{}}}});return{...t,redirect_path:k(t.redirect_path).toString()}}const C=m(function(){const{pluginId:e,code:s,state:r,error:t,errorDesc:c}=E(),i=O(),l=n.useRef(!1);n.useEffect(()=>{if(l.current===!0)return;l.current=!0;async function f(){const _=`https://chat.openai.com/aip/${e}/oauth/callback`;try{const a=await T(e,s,_,r);if(a.success)if(a.redirect_path===g)window.location.href=g;else{const o=new URL(h(d.OAUTH_SUCCESS,a.redirect_path),location.origin);o.searchParams.set("oauth_success","true"),i(o.pathname+o.search+o.hash)}else i(h(d.CUSTOM_ERROR,a.redirect_path,a.error??a.message))}catch{i({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:e,loginSuccess:"false"}).toString()})}}f()},[e,s,r,i]);const p=R();return n.useEffect(()=>{t&&p.danger(`${t}${c?`: ${c}`:""}`,{duration:5,toastId:"oauth_callback: AIPOauth",loggingTitle:t,loggingDescription:c??""})},[t,c,p]),b.jsx("div",{})});export{C as default};
//# sourceMappingURL=kuwyv0wf9r4mpaol.js.map

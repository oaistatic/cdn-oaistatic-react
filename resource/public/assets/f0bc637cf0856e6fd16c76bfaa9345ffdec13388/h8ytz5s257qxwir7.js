import{oG as j,b2 as w,S as y,m7 as b}from"./lgw4q0e8zlqqfgug.js";import{P as M,j as n,ai as C,f as N,a as k,h as A,i as F,M as p}from"./m60bpb0x3x7rg8fj.js";import{dg as P}from"./ggjzadbnd3k1vu0k.js";import{R as W,I as r,S as l}from"./c3xqodlltwxr37q5.js";import{E as R,R as T,g as U}from"./csaymbe7iovkmzi9.js";import{u as D}from"./h2v1am7wrvag4xx7.js";import{c as I,W as O,a as B,d as L}from"./g7o69yifmkuxfsll.js";import{W as $}from"./obyri1de2ezmnazh.js";import"./6yelshmoynjjn7yi.js";import"./l3eiwz8ml3msgzyc.js";import"./czj65b9i5sztgpdb.js";import"./mb9azmyuz6lg619u.js";import"./dp7t1jmnbbend843.js";import"./mlsx3rf8sevtagon.js";import"./ivuooijrkuqmc9p5.js";import"./dmk30rbb7u1k7gl7.js";import"./jykd7v1tpigt9yby.js";import"./jii3s2n86nvi5fnj.js";import"./9q3v44p2xpoi75pn.js";import"./m9elivgqkyz3hcka.js";import"./hv81c3k3l9e69foo.js";import"./jqy1uu6573e00zh8.js";import"./rx5cs0ja7c7phupc.js";import"./n5yj38pa2aamrsfp.js";import"./cb9cgv53vja8utnc.js";import"./lycvq5rqsik44ye8.js";import"./crheuewn890nts1d.js";import"./df3y7yi36gehsn95.js";function q(){const{environmentId:s}=M(),{eligible:i}=P();return i?n.jsx(C,{to:"/codex"}):s?n.jsx(z,{environmentId:s}):n.jsx(j,{})}function z({environmentId:s}){const i=N(),o=w(),g=k(),m=A(),{data:e,isLoading:h,isError:v}=I(s),d=e?.secrets??{},x=D()?"workspace":"private",{mutate:E,isPending:f}=F({mutationFn:t=>O.updateEnvironment(s,t),onSuccess:async t=>{await B(m,s),L(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function _(t){const a=U(t.secrets,d),S=t.envVars.reduce((c,u)=>(c[u.key]=u.value,c),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:S,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return n.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(y,{})}):v?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?n.jsxs(n.Fragment,{children:[n.jsxs(W,{className:"sticky top-0 px-4",children:[n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),n.jsx(l,{}),n.jsx(r,{label:e.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),n.jsx(l,{}),n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),n.jsx(R,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e?.label,description:e?.description??"",share_settings:e?.share_settings??x,machine:e?.machine_id,repositoryId:e?.repos[0],workspaceDirectory:e?.workspace_dir??"",agentNetworkAccess:e?.agent_network_access,setupCommands:e?.setup?Array.isArray(e?.setup)?e.setup.join(`
`):e.setup:"",maintenanceSetupCommands:e?.maintenance_setup?Array.isArray(e?.maintenance_setup)?e.maintenance_setup.join(`
`):e.maintenance_setup:"",envVars:Object.entries(e?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(d).map(t=>({key:t,value:T,isEditing:!1})),autoSetupSettings:e?.auto_setup_settings,cacheSettings:e?.cache_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:_,isPending:f})]}):n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const _e=()=>[{title:"Codex"}],Se=b(function(){return n.jsx(q,{})});export{Se as default,_e as meta};
//# sourceMappingURL=h8ytz5s257qxwir7.js.map

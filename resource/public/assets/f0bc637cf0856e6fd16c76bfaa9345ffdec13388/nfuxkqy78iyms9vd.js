import{c as Q,f as V,j as t,r as p,M as $}from"./m60bpb0x3x7rg8fj.js";import{B as oe,dS as W,fl as g,am as U,cd as M,_ as ae,P as ee,d3 as h,z as re,fS as ne,b2 as le,e as ie,H as ce,iO as J,fm as X,C as de,dj as ue}from"./lgw4q0e8zlqqfgug.js";import{f6 as me,kE as fe,kF as je,df as pe,kG as ge,eo as xe,bB as he,ep as be,kH as ye,kI as Me,kJ as Z}from"./ggjzadbnd3k1vu0k.js";import{S as Pe}from"./ipzjskqkorba38yx.js";import{P as ve,a as Se}from"./4lwv45o141vcwm2h.js";function $e(o){"use forget";const e=Q.c(15),r=V(),{preset:s,onSelectPreset:n}=o;let l;e[0]!==n||e[1]!==s?(l=()=>n(s),e[0]=n,e[1]=s,e[2]=l):l=e[2];let u;e[3]!==s.color||e[4]!==s.emoji?(u=t.jsx(me,{color:s.color,emoji:s.emoji}),e[3]=s.color,e[4]=s.emoji,e[5]=u):u=e[5];let a;e[6]!==r||e[7]!==s.label?(a=r.formatMessage(s.label),e[6]=r,e[7]=s.label,e[8]=a):a=e[8];let i;e[9]!==u||e[10]!==a?(i=t.jsxs("div",{className:"flex gap-1.5",children:[u,a]}),e[9]=u,e[10]=a,e[11]=i):i=e[11];let j;return e[12]!==l||e[13]!==i?(j=t.jsx(oe,{color:"secondary",className:"border-token-border-default hover:bg-token-interactive-bg-secondary-hover active:bg-token-interactive-bg-secondary-press flex items-center justify-center py-2 ps-2.5 pe-3 font-normal select-none",onFocus:Ee,onClick:l,type:"button",children:i}),e[12]=l,e[13]=i,e[14]=j):j=e[14],j}function Ee(o){o.target.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}function Ce(o){"use forget";const e=Q.c(63),{isNewProject:r,isPending:s,onSubmit:n,submitTitle:l,planType:u}=o,a=V();let i;e[0]!==o.emoji$||e[1]!==o.theme$||e[2]!==o.title$||e[3]!==o.validationErrors$?(i=()=>({title$:o.title$??g(""),validationErrors$:o.validationErrors$??g([]),theme$:o.theme$??g(null),emoji$:o.emoji$??g(null),stylePickerOpen$:g(!1),autofilledFromPreset$:g(!1)}),e[0]=o.emoji$,e[1]=o.theme$,e[2]=o.title$,e[3]=o.validationErrors$,e[4]=i):i=e[4];const[j]=p.useState(i),{title$:c,validationErrors$:E,theme$:m,emoji$:x,stylePickerOpen$:G,autofilledFromPreset$:b}=j,y=W(c),P=W(E),S=p.useRef(null),z=W(b);let C;e[5]===Symbol.for("react.memo_cache_sentinel")?(C=[],e[5]=C):C=e[5],p.useEffect(Ne,C);let w;e[6]!==b||e[7]!==x||e[8]!==m||e[9]!==c?(w=F=>{const{color:q,emoji:te,title:se}=F;m.set(q),x.set(te),c.set(se),b.set(!0)},e[6]=b,e[7]=x,e[8]=m,e[9]=c,e[10]=w):w=e[10];const I=w;let d;e[11]!==a?(d=a.formatMessage({id:"A4Fd7M",defaultMessage:"Copenhagen Trip"}),e[11]=a,e[12]=d):d=e[12];let f;e[13]!==c?(f=F=>c.set(F.target.value),e[13]=c,e[14]=f):f=e[14];let v;e[15]!==d||e[16]!==f||e[17]!==y?(v=t.jsx("input",{autoFocus:!0,ref:S,className:"border-token-interactive-border-tertiary-default focus:border-token-interactive-border-focus bg-token-bg-primary col-span-full row-1 w-full resize-none overflow-y-auto rounded-lg border px-2 py-2 ps-9 pe-9 text-sm focus:ring-0",type:"text",name:"projectName",autoComplete:"off",placeholder:d,value:y,onChange:f}),e[15]=d,e[16]=f,e[17]=y,e[18]=v):v=e[18];const D=r?"var(--text-tertiary)":void 0;let N;e[19]!==x||e[20]!==D||e[21]!==m?(N=t.jsx(ve,{emoji$:x,theme$:m,defaultColor:D}),e[19]=x,e[20]=D,e[21]=m,e[22]=N):N=e[22];let O;e[23]!==x||e[24]!==G||e[25]!==N||e[26]!==m?(O=t.jsx(Se,{open$:G,theme$:m,emoji$:x,children:N}),e[23]=x,e[24]=G,e[25]=N,e[26]=m,e[27]=O):O=e[27];let k;e[28]!==z||e[29]!==b||e[30]!==x||e[31]!==a||e[32]!==r||e[33]!==m||e[34]!==y||e[35]!==c?(k=r&&z&&y.trim().length>0&&t.jsx("button",{type:"button","aria-label":a.formatMessage({id:"z/7Lq7",defaultMessage:"Clear project name"}),className:"col-span-full row-1 me-2 self-center justify-self-end rounded-full p-1 hover:opacity-80 focus:outline-hidden",onClick:()=>{c.set(""),x.set(null),m.set(null),b.set(!1),S.current?.focus()},children:t.jsx(Pe,{className:"icon text-token-text-tertiary"})}),e[28]=z,e[29]=b,e[30]=x,e[31]=a,e[32]=r,e[33]=m,e[34]=y,e[35]=c,e[36]=k):k=e[36];let _;e[37]!==k||e[38]!==v||e[39]!==O?(_=t.jsxs("div",{className:"content-sheet-root:contents mb-2 grid grid-cols-[auto_minmax(0,1fr)]",children:[v,O,k]}),e[37]=k,e[38]=v,e[39]=O,e[40]=_):_=e[40];let L;e[41]!==a||e[42]!==r||e[43]!==I||e[44]!==u?(L=r&&t.jsx("ul",{className:"focus-outline-margin-default -ms-4 flex w-[calc(100%+32px)] gap-2 overflow-x-auto ps-4 pe-4 [scrollbar-width:none]","aria-label":a.formatMessage({id:"mStfWq",defaultMessage:"Project presets"}),children:fe(u).map(F=>t.jsx("li",{children:t.jsx($e,{preset:F,onSelectPreset:q=>{I({...q,title:a.formatMessage(q.label)})}})},F.emoji))}),e[41]=a,e[42]=r,e[43]=I,e[44]=u,e[45]=L):L=e[45];let T;e[46]!==r?(T=r&&t.jsxs("aside",{className:"bg-token-bg-tertiary mt-4 flex items-center rounded-xl p-3",children:[t.jsx("div",{className:"me-2 h-6 w-6",children:t.jsx("div",{className:"text-token-text-secondary relative flex h-full items-center justify-center",children:t.jsx(je,{className:"icon"})})}),t.jsx("p",{className:"text-token-text-secondary text-xs text-pretty",children:t.jsx($,{...pe.projectHelperBoxDescription})})]}),e[46]=r,e[47]=T):T=e[47];let A;e[48]!==P?(A=P.map(we),e[48]=P,e[49]=A):A=e[49];let R;e[50]!==_||e[51]!==L||e[52]!==T||e[53]!==A?(R=t.jsxs("div",{className:"flex-1 px-4 pt-1",children:[_,L,T,A]}),e[50]=_,e[51]=L,e[52]=T,e[53]=A,e[54]=R):R=e[54];const H=!y.trim()||P.length>0;let B;e[55]!==s||e[56]!==l||e[57]!==H?(B=t.jsx("div",{className:"flex items-center justify-end px-3 pb-3",children:t.jsx(U.Actions,{primaryButton:t.jsx(U.Button,{title:l,type:"submit",form:"project-modal-form",color:"primary",loading:s,disabled:H})})}),e[55]=s,e[56]=l,e[57]=H,e[58]=B):B=e[58];let K;return e[59]!==n||e[60]!==R||e[61]!==B?(K=t.jsxs("form",{id:"project-modal-form",onSubmit:n,children:[R,B]}),e[59]=n,e[60]=R,e[61]=B,e[62]=K):K=e[62],K}function we(o,e){return t.jsx("div",{className:"mb-4 text-sm text-red-500",children:o},e)}function Ne(){ge()}function Oe({children:o,onCloseAutoFocus:e,...r}){const s=p.useRef(!1),n=p.useRef(!1),l=p.useRef(!1);return t.jsx(M.Content,{...r,onCloseAutoFocus:u=>{const a=s.current,i=n.current,j=l.current;if(s.current=!1,n.current=!1,l.current=!1,j)u.preventDefault();else{if(a||i)return;e&&e(u)}},onEscapeKeyDown:()=>{s.current=!0},onPointerDownOutside:()=>{n.current=!0},onFocusOutside:()=>{l.current=!0},children:o})}const ke=({onCloseAutoFocus:o,children:e,isOpen$:r,isNewProject:s,mode:n="dropdown",displayedMemoryScope$:l=g(h.GLOBAL),memoryScope$:u=g(h.GLOBAL)})=>{const a=!ae(),[i]=p.useState(()=>r??g(!1)),j=W(()=>i()),c=W(()=>l());return t.jsxs(M.Root,{mode:n==="auto"?a?"sheet":"dropdown":n,open:j,open$:r,modal:a,onOpenChange:E=>{i.set(E),E&&ee.logEventWithStatsig("Project Customization: Open","chatgpt_web_project_customization_menu_open",{mode:n})},children:[e,t.jsx(M.Portal,{children:t.jsx(_e,{displayedMemoryScope:c,memoryScope$:u,isNewProject:s,onCloseAutoFocus:o})})]})},_e=({displayedMemoryScope:o=h.GLOBAL,memoryScope$:e=g(h.GLOBAL),isNewProject:r,...s})=>t.jsxs(Oe,{size:"auto",align:"end",alignOffset:-7,loop:!0,...s,children:[t.jsxs(M.Group,{children:[t.jsx(M.Label,{children:t.jsx($,{id:"w7+gZm",defaultMessage:"Memory"})}),t.jsxs(M.RadioGroup,{value:o,className:"flex flex-col",onValueChange:n=>{e.set(n)},children:[t.jsx(Y,{value:h.GLOBAL,disabled:!r,label:t.jsx($,{id:"AA7d3d",defaultMessage:"Default"}),secondary:t.jsx($,{id:"XHfasG",defaultMessage:"Project can access memories from outside chats, and vice versa."})}),t.jsx(Y,{value:h.PROJECT_V2,disabled:!r,label:t.jsx($,{id:"XToOAe",defaultMessage:"Project-only"}),secondary:t.jsx($,{id:"W99WlO",defaultMessage:"Project can only access its own memories. Its memories are hidden from outside chats."})})]})]}),t.jsx(M.Group,{children:t.jsx(M.Label,{children:t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("div",{className:"text-token-text-secondary flex items-center text-xs text-pretty",children:t.jsx($,{id:"FrohSq",defaultMessage:"Note that this setting can't be changed later."})})})})})]}),Le=o=>t.jsx(M.BasicTrigger,{className:re("dropdown-btn"),"data-testid":"composer-plus-btn",...o,children:t.jsx(ne,{className:"icon"})});function Y(o){return t.jsx(M.RadioItem,{trailing:t.jsx(M.RadioItemCheck,{}),...o})}function Ge({submitButtonTitle:o,onClose:e,onSuccess:r,gizmo:s,project:n}){"use forget";const l=V(),u=le(),a=xe(),[i,j]=p.useState(()=>a.isPending),c=!s,E=he(),m=ie(),G=ce(m)?.planType;!c&&!n&&(n=be(m)(s.gizmo.id,a));const[b]=p.useState(()=>g(J(()=>n?.emoji$()??s?.gizmo.display.emoji??null))),[y]=p.useState(()=>g(J(()=>n?.theme$()??s?.gizmo.display.theme??null))),[P]=p.useState(()=>g(J(()=>n?.title$()??s?.gizmo.display.name??""))),[S]=p.useState(()=>{const d=s?.gizmo.memory_scope;let f=d;switch(d){case h.PROJECT_V2:f=h.PROJECT_V2;break;case h.GLOBAL:case h.PROJECT:f=h.GLOBAL;break;default:f=h.UNSET;break}return g(f)}),[z]=p.useState(()=>X(()=>Me(S()))),[C]=p.useState(()=>X(()=>{const d=[];return P().length>Z&&d.push(l.formatMessage({id:"feWA6K",defaultMessage:"Project names cannot be longer than {length} characters."},{length:Z})),d})),w=async()=>{try{j(!0);const d=n?await n.queueUpdate$({emoji:b(),theme:y(),name:P(),opts:{memoryScope:S()}}):await a.mutateAsync({update:D=>({...D,emoji:b()??void 0,theme:y()??void 0,name:P(),memoryScope:S()}),id:s?.gizmo.id??ye}),{id:f,resource:v}=d;j(!1),r&&r(f??v?.gizmo.id),e()}catch(d){const f=ue(d);u.warning(f??l.formatMessage({id:"project-modal.error.create-or-update",defaultMessage:"Error creating or updating project"}),{duration:5,hasCloseButton:!0}),j(!1)}},I=c?l.formatMessage({id:"PoqmRT",defaultMessage:"Create project"}):l.formatMessage({id:"RT8KNi",defaultMessage:"Save"});return t.jsx(de,{testId:"modal-new-project-enhanced",isOpen:!0,hideSeparator:!0,noPadding:!0,headerAccessory:E&&t.jsx(ke,{isNewProject:c,displayedMemoryScope$:z,memoryScope$:S,children:t.jsx(Le,{})}),showCloseButton:!i,type:"success",size:"large",title:c?l.formatMessage({defaultMessage:"Project name",id:"project-modal.title.new-project"}):l.formatMessage({defaultMessage:"Edit project",id:"project-modal.title.edit-project"}),onClose:()=>{i||e()},children:t.jsx(Ce,{emoji$:b,isNewProject:c,isPending:i,onClose:e,onSubmit:d=>{d.preventDefault(),ee.logEventWithStatsig("Projects: Create Submit Enhanced","chatgpt_web_projects_create_submit"),w()},submitTitle:o??I,title$:P,theme$:y,validationErrors$:C,planType:G})})}export{Ge as CreateOrEditProjectModal};
//# sourceMappingURL=nfuxkqy78iyms9vd.js.map

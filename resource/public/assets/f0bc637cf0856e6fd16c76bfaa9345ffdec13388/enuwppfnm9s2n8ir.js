import{dP as qe,tq as Ge,tr as $e,ts as Ke,tt as q,tu as We,qh as ze,tv as U,tw as j,tx as me,ty as Ve,tz as Ye,tA as de,tB as G,tC as $,tD as K,tE as L,pK as ge,fx as Qe,dv as Xe,tF as he,tG as W,tH as Je,tI as Ze,i as et,kO as tt}from"./ggjzadbnd3k1vu0k.js";import{e as nt,eE as rt,P as x,z as st,dr as ot,v as E,N as A,aj as ye,ug as S,uh as z,ui as at,uj as it,uk as ct,ul as be,du as lt,b2 as ut,cs as ft,S as pt,oP as mt,oQ as _e,R as dt,hC as gt,hp as ht,k7 as we,hq as B,ar as yt,as as bt,fx as _t,cT as wt,um as Nt,I as xt,fp as Ct,fs as kt,hF as _,u5 as St,u6 as Et,gO as V,qi as Ne,mr as O,ms as xe,ob as At,un as Lt}from"./lgw4q0e8zlqqfgug.js";import{r as b,j as d,R as I,h as Dt,f as vt,d as Rt,u as Tt}from"./m60bpb0x3x7rg8fj.js";import{r as Ot}from"./m9elivgqkyz3hcka.js";import{r as Pt,a as Ft,b as Mt}from"./ekc4a26ow669vmxe.js";import{k as Y}from"./pc2givv05uuq8g6l.js";const Q={},X={},J={};function Z(e,r){return`${e}::${r}`}function Ut({node:e,onClick:r,children:n,clientThreadId:t,messageId:s,href:i,disableSafeURLs:o,...a}){let c=r;const l=e?.properties?.href,u=b.useContext(qe),f=nt(),w=rt(t),m=Ge(w,i,u?.useSafeUrls&&!o),g=$e(t,s)?.metadata?.__internal?.utm_tags??{},h=Ke(t),C=!o&&m===void 0;return s!=null&&typeof l=="string"&&l.includes("/bing/redirect")&&(Q[s]||(x.logEvent("Browsing Show Bing Link",{id:s,content:l}),Q[s]=!0),c=N=>{X[s]||(x.logEvent("Browsing Click Bing Link",{id:s,content:l}),X[s]=!0),r?.(N)}),c=N=>{const v=""+l;if(s&&!J[Z(s,v)]){const He=m||C?"URL Clicked Allowed":"URL Clicked Blocked";x.logEvent(He,{id:s,content:v}),J[Z(s,v)]=!0}r?.(N),C&&i&&(N.preventDefault(),ot(f,We,{urls:q(i,g,h)}))},d.jsx(d.Fragment,{children:d.jsx("a",{onClick:c,...a,className:st(a.className,C&&"cursor-pointer"),href:m&&q(m,g,h),rel:"noopener",children:n})})}const jt="w";function Bt({messageId:e,clientThreadId:r,text:n,children:t,...s}){const o=`${window.location.origin}?q=${encodeURIComponent(n)}`,a=ze(),c=b.useCallback(async l=>{l.preventDefault(),E.count(A.DEFAULT,"instant_follow_up_anchor_clicked"),x.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:r,messageId:e}),a(l,{text:n,type:ye.Reply},[],0)},[r,e,n,a]);return d.jsx(Ut,{...s,href:o,disableSafeURLs:!0,clientThreadId:r,messageId:e,className:"cursor-pointer",onClick:c,children:t})}const Pr=I.memo(Bt),It=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],ee={}.hasOwnProperty;function Ht(e,r){const n=r||{};function t(s,...i){let o=t.invalid;const a=t.handlers;if(s&&ee.call(s,e)){const c=String(s[e]);o=ee.call(a,c)?a[c]:t.unknown}if(o)return o.call(this,s,...i)}return t.handlers=n.handlers||{},t.invalid=n.invalid,t.unknown=n.unknown,t}const qt=/^>|^->|<!--|-->|--!>|<!-$/g,Gt=[">"],$t=["<",">"];function Kt(e,r,n,t){return t.settings.bogusComments?"<?"+S(e.value,Object.assign({},t.settings.characterReferences,{subset:Gt}))+">":"<!--"+e.value.replace(qt,s)+"-->";function s(i){return S(i,Object.assign({},t.settings.characterReferences,{subset:$t}))}}function Wt(e,r,n,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}const p=ke(1),Ce=ke(-1),zt=[];function ke(e){return r;function r(n,t,s){const i=n?n.children:zt;let o=(t||0)+e,a=i[o];if(!s)for(;a&&U(a);)o+=e,a=i[o];return a}}const Vt={}.hasOwnProperty;function Se(e){return r;function r(n,t,s){return Vt.call(e,n.tagName)&&e[n.tagName](n,t,s)}}const H=Se({body:Qt,caption:R,colgroup:R,dd:en,dt:Zt,head:R,html:Yt,li:Jt,optgroup:tn,option:nn,p:Xt,rp:te,rt:te,tbody:sn,td:ne,tfoot:on,th:ne,thead:rn,tr:an});function R(e,r,n){const t=p(n,r,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&U(t.value.charAt(0)))}function Yt(e,r,n){const t=p(n,r);return!t||t.type!=="comment"}function Qt(e,r,n){const t=p(n,r);return!t||t.type!=="comment"}function Xt(e,r,n){const t=p(n,r);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function Jt(e,r,n){const t=p(n,r);return!t||t.type==="element"&&t.tagName==="li"}function Zt(e,r,n){const t=p(n,r);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function en(e,r,n){const t=p(n,r);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function te(e,r,n){const t=p(n,r);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function tn(e,r,n){const t=p(n,r);return!t||t.type==="element"&&t.tagName==="optgroup"}function nn(e,r,n){const t=p(n,r);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function rn(e,r,n){const t=p(n,r);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function sn(e,r,n){const t=p(n,r);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function on(e,r,n){return!p(n,r)}function an(e,r,n){const t=p(n,r);return!t||t.type==="element"&&t.tagName==="tr"}function ne(e,r,n){const t=p(n,r);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const cn=Se({body:fn,colgroup:pn,head:un,html:ln,tbody:mn});function ln(e){const r=p(e,-1);return!r||r.type!=="comment"}function un(e){const r=new Set;for(const t of e.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(r.has(t.tagName))return!1;r.add(t.tagName)}const n=e.children[0];return!n||n.type==="element"}function fn(e){const r=p(e,-1,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&U(r.value.charAt(0)))&&!(r.type==="element"&&(r.tagName==="meta"||r.tagName==="link"||r.tagName==="script"||r.tagName==="style"||r.tagName==="template"))}function pn(e,r,n){const t=Ce(n,r),s=p(e,-1,!0);return n&&t&&t.type==="element"&&t.tagName==="colgroup"&&H(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function mn(e,r,n){const t=Ce(n,r),s=p(e,-1);return n&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&H(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const D={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function dn(e,r,n,t){const s=t.schema,i=s.space==="svg"?!1:t.settings.omitOptionalTags;let o=s.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(e.tagName.toLowerCase());const a=[];let c;s.space==="html"&&e.tagName==="svg"&&(t.schema=j);const l=gn(t,e.properties),u=t.all(s.space==="html"&&e.tagName==="template"?e.content:e);return t.schema=s,u&&(o=!1),(l||!i||!cn(e,r,n))&&(a.push("<",e.tagName,l?" "+l:""),o&&(s.space==="svg"||t.settings.closeSelfClosing)&&(c=l.charAt(l.length-1),(!t.settings.tightSelfClosing||c==="/"||c&&c!=='"'&&c!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!H(e,r,n))&&a.push("</"+e.tagName+">"),a.join("")}function gn(e,r){const n=[];let t=-1,s;if(r){for(s in r)if(r[s]!==null&&r[s]!==void 0){const i=hn(e,s,r[s]);i&&n.push(i)}}for(;++t<n.length;){const i=e.settings.tightAttributes?n[t].charAt(n[t].length-1):void 0;t!==n.length-1&&i!=='"'&&i!=="'"&&(n[t]+=" ")}return n.join("")}function hn(e,r,n){const t=me(e.schema,r),s=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,i=e.settings.allowDangerousCharacters?0:1;let o=e.quote,a;if(t.overloadedBoolean&&(n===t.attribute||n==="")?n=!0:(t.boolean||t.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const c=S(t.attribute,Object.assign({},e.settings.characterReferences,{subset:D.name[s][i]}));return n===!0||(n=Array.isArray(n)?(t.commaSeparated?Ve:Ye)(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?c:(e.settings.preferUnquoted&&(a=S(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:D.unquoted[s][i]}))),a!==n&&(e.settings.quoteSmart&&z(n,o)>z(n,e.alternative)&&(o=e.alternative),a=o+S(n,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?D.single:D.double)[s][i],attribute:!0}))+o),c+(a&&"="+a))}const yn=["<","&"];function Ee(e,r,n,t){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?e.value:S(e.value,Object.assign({},t.settings.characterReferences,{subset:yn}))}function bn(e,r,n,t){return t.settings.allowDangerousHtml?e.value:Ee(e,r,n,t)}function _n(e,r,n,t){return t.all(e)}const wn=Ht("type",{invalid:Nn,unknown:xn,handlers:{comment:Kt,doctype:Wt,element:dn,raw:bn,root:_n,text:Ee}});function Nn(e){throw new Error("Expected node, not `"+e+"`")}function xn(e){const r=e;throw new Error("Cannot compile unknown node `"+r.type+"`")}const Cn={},kn={},Sn=[];function En(e,r){const n=r||Cn,t=n.quote||'"',s=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:An,all:Ln,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||It,characterReferences:n.characterReferences||kn,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?j:de,quote:t,alternative:s}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function An(e,r,n){return wn(e,r,n,this)}function Ln(e){const r=[],n=e&&e.children||Sn;let t=-1;for(;++t<n.length;)r[t]=this.one(n[t],t,e);return r.join("")}function Dn(e){const r=this,n={...r.data("settings"),...e};r.compiler=t;function t(s){return En(s,n)}}function vn(e){at(e,[/\r?\n|\r/g,Rn])}function Rn(){return{type:"break"}}function Tn(){return function(e){vn(e)}}const re=/[#.]/g;function On(e,r){const n=e||"",t={};let s=0,i,o;for(;s<n.length;){re.lastIndex=s;const a=re.exec(n),c=n.slice(s,a?a.index:n.length);c&&(i?i==="#"?t.id=c:Array.isArray(t.className)?t.className.push(c):t.className=[c]:o=c,s+=c.length),a&&(i=a[0],s++)}return{type:"element",tagName:o||r||"div",properties:t,children:[]}}const Pn=new Set(["button","menu","reset","submit"]),P={}.hasOwnProperty;function Ae(e,r,n){const t=n&&jn(n);function s(i,o,...a){let c=-1,l;if(i==null){l={type:"root",children:[]};const u=o;a.unshift(u)}else if(l=On(i,r),l.tagName=l.tagName.toLowerCase(),t&&P.call(t,l.tagName)&&(l.tagName=t[l.tagName]),Fn(o,l.tagName)){let u;for(u in o)P.call(o,u)&&Mn(e,l.properties,u,o[u])}else a.unshift(o);for(;++c<a.length;)F(l.children,a[c]);return l.type==="element"&&l.tagName==="template"&&(l.content={type:"root",children:l.children},l.children=[]),l}return s}function Fn(e,r){return e==null||typeof e!="object"||Array.isArray(e)?!1:r==="input"||!e.type||typeof e.type!="string"?!0:"children"in e&&Array.isArray(e.children)?!1:r==="button"?Pn.has(e.type.toLowerCase()):!("value"in e)}function Mn(e,r,n,t){const s=me(e,n);let i=-1,o;if(t!=null){if(typeof t=="number"){if(Number.isNaN(t))return;o=t}else typeof t=="boolean"?o=t:typeof t=="string"?s.spaceSeparated?o=G(t):s.commaSeparated?o=$(t):s.commaOrSpaceSeparated?o=G($(t).join(" ")):o=se(s,s.property,t):Array.isArray(t)?o=t.concat():o=s.property==="style"?Un(t):String(t);if(Array.isArray(o)){const a=[];for(;++i<o.length;){const c=se(s,s.property,o[i]);a[i]=c}o=a}if(s.property==="className"&&Array.isArray(r.className)){const a=o;o=r.className.concat(a)}r[s.property]=o}}function F(e,r){let n=-1;if(r!=null)if(typeof r=="string"||typeof r=="number")e.push({type:"text",value:String(r)});else if(Array.isArray(r))for(;++n<r.length;)F(e,r[n]);else if(typeof r=="object"&&"type"in r)r.type==="root"?F(e,r.children):e.push(r);else throw new Error("Expected node, nodes, or string, got `"+r+"`")}function se(e,r,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||K(n)===K(r)))return!0}return n}function Un(e){const r=[];let n;for(n in e)P.call(e,n)&&r.push([n,e[n]].join(": "));return r.join("; ")}function jn(e){const r={};let n=-1;for(;++n<e.length;)r[e[n].toLowerCase()]=e[n];return r}const Bn=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],In=Ae(de,"div"),Hn=Ae(j,"g",Bn),T={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"};function qn(e,r){return Le(e,{})||{type:"root",children:[]}}function Le(e,r){const n=Gn(e,r);return n&&r.afterTransform&&r.afterTransform(e,n),n}function Gn(e,r){switch(e.nodeType){case 1:return zn(e,r);case 3:return Kn(e);case 8:return Wn(e);case 9:return oe(e,r);case 10:return $n();case 11:return oe(e,r);default:return}}function oe(e,r){return{type:"root",children:De(e,r)}}function $n(){return{type:"doctype"}}function Kn(e){return{type:"text",value:e.nodeValue||""}}function Wn(e){return{type:"comment",value:e.nodeValue||""}}function zn(e,r){const n=e.namespaceURI,t=n===T.svg?Hn:In,s=n===T.html?e.tagName.toLowerCase():e.tagName,i=n===T.html&&s==="template"?e.content:e,o=e.getAttributeNames(),a={};let c=-1;for(;++c<o.length;)a[o[c]]=e.getAttribute(o[c])||"";return t(s,a,De(i,r))}function De(e,r){const n=e.childNodes,t=[];let s=-1;for(;++s<n.length;){const i=Le(n[s],r);i!==void 0&&t.push(i)}return t}new DOMParser;function Vn(e,r){const n=Yn(e);return qn(n)}function Yn(e){const r=document.createElement("template");return r.innerHTML=e,r.content}const ae=function(e,r,n){const t=it(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof r=="number"){if(r<0||r===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(r=e.children.indexOf(r),r<0)throw new Error("Expected child node or index");for(;++r<e.children.length;)if(t(e.children[r],r,e))return e.children[r]},ie=/\n/g,ce=/[\t ]+/g,M=L("br"),le=L(rr),Qn=L("p"),ue=L("tr"),Xn=L(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",nr,sr]),ve=L(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function Jn(e,r){const n=r||{},t="children"in e?e.children:[],s=ve(e),i=Oe(e,{whitespace:n.whitespace||"normal"}),o=[];(e.type==="text"||e.type==="comment")&&o.push(...Te(e,{breakBefore:!0,breakAfter:!0}));let a=-1;for(;++a<t.length;)o.push(...Re(t[a],e,{whitespace:i,breakBefore:a?void 0:s,breakAfter:a<t.length-1?M(t[a+1]):s}));const c=[];let l;for(a=-1;++a<o.length;){const u=o[a];typeof u=="number"?l!==void 0&&u>l&&(l=u):u&&(l!==void 0&&l>-1&&c.push(`
`.repeat(l)||" "),l=-1,c.push(u))}return c.join("")}function Re(e,r,n){return e.type==="element"?Zn(e,r,n):e.type==="text"?n.whitespace==="normal"?Te(e,n):er(e):[]}function Zn(e,r,n){const t=Oe(e,n),s=e.children||[];let i=-1,o=[];if(Xn(e))return o;let a,c;for(M(e)||ue(e)&&ae(r,e,ue)?c=`
`:Qn(e)?(a=2,c=2):ve(e)&&(a=1,c=1);++i<s.length;)o=o.concat(Re(s[i],e,{whitespace:t,breakBefore:i?void 0:a,breakAfter:i<s.length-1?M(s[i+1]):c}));return le(e)&&ae(r,e,le)&&o.push("	"),a&&o.unshift(a),c&&o.push(c),o}function Te(e,r){const n=String(e.value),t=[],s=[];let i=0;for(;i<=n.length;){ie.lastIndex=i;const c=ie.exec(n),l=c&&"index"in c?c.index:n.length;t.push(tr(n.slice(i,l).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),i===0?r.breakBefore:!0,l===n.length?r.breakAfter:!0)),i=l+1}let o=-1,a;for(;++o<t.length;)t[o].charCodeAt(t[o].length-1)===8203||o<t.length-1&&t[o+1].charCodeAt(0)===8203?(s.push(t[o]),a=void 0):t[o]?(typeof a=="number"&&s.push(a),s.push(t[o]),a=0):(o===0||o===t.length-1)&&s.push(0);return s}function er(e){return[String(e.value)]}function tr(e,r,n){const t=[];let s=0,i;for(;s<e.length;){ce.lastIndex=s;const o=ce.exec(e);i=o?o.index:e.length,!s&&!i&&o&&!r&&t.push(""),s!==i&&t.push(e.slice(s,i)),s=o?i+o[0].length:i}return s!==i&&!n&&t.push(""),t.join(" ")}function Oe(e,r){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":r.whitespace;case"textarea":return"pre-wrap"}}return r.whitespace}function nr(e){return!!(e.properties||{}).hidden}function rr(e){return e.tagName==="td"||e.tagName==="th"}function sr(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const or={},ar=[];function Pe(e){const r=e||or;return function(n,t){ct(n,"element",function(s,i){const o=Array.isArray(s.properties.className)?s.properties.className:ar,a=o.includes("language-math"),c=o.includes("math-display"),l=o.includes("math-inline");let u=c;if(!a&&!c&&!l)return;let f=i[i.length-1],w=s;if(s.tagName==="code"&&a&&f&&f.type==="element"&&f.tagName==="pre"&&(w=f,f=i[i.length-2],u=!0),!f)return;const m=Jn(w,{whitespace:"pre"});let y;try{y=Y.renderToString(m,{...r,displayMode:u,throwOnError:!0})}catch(h){const C=h,N=C.name.toLowerCase();t.message("Could not render math with KaTeX",{ancestors:[...i,s],cause:C,place:s.position,ruleId:N,source:"rehype-katex"}),N==="parseerror"?y=Y.renderToString(m,{...r,displayMode:u,strict:"ignore",throwOnError:!1}):y=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(r.errorColor||"#cc0000"),title:String(h)},children:[{type:"text",value:m}]}]}typeof y=="string"&&(y=Vn(y).children);const g=f.children.indexOf(w);return f.children.splice(g,1,...y),be})}}const Fe="sandbox:";function ir(e){const r=new URL(e).searchParams.get("se");if(!r)return!1;const n=Date.parse(r);return Number.isNaN(n)?!1:Date.now()>n}function Fr({messageId:e,clientThreadId:r,href:n,...t}){const s=Dt(),[i,o]=b.useState(!1),a=n.substring(Fe.length),c=lt(r),l=vt(),u=ut(),f=b.useCallback(g=>{const h=document.createElement("a");h.href=g,h.click(),o(!1)},[]),w=b.useCallback(g=>{o(!1),u.danger(g,{toastId:"file_download_failed"})},[u]),m=lr(i,e,c,a,w,f).data,y=b.useCallback(async g=>{if(r!==void 0){g.preventDefault();const h=m?.download_url&&ir(m.download_url);(m===void 0||m?.status!=="success"||h)&&s.invalidateQueries({queryKey:Me(e,a)}),m?.status==="success"&&m?.download_url&&!h?f(m.download_url):o(!0)}},[r,m,s,e,a,f]);return d.jsx(ft,{closeOnOutsideClick:!1,label:d.jsxs("span",{className:"flex items-center gap-1",children:[i?l.formatMessage(fe.startingDownload):l.formatMessage(fe.downloadFile),i&&d.jsx(pt,{})]}),side:"top",children:d.jsx("a",{...t,className:"cursor-pointer",onClick:g=>!i&&y(g)})})}async function cr(e,r,n){const t=await dt.safeGet("/conversation/{conversation_id}/interpreter/download",{parameters:{path:{conversation_id:r},query:{message_id:e,sandbox_path:n}}});if(t.status===gt.Success)return t;throw new _e("Could not download file from advanced data analysis","error_code"in t?t.error_code:"unknown_error")}function lr(e,r,n,t,s,i){const o=mt();return Tt({queryKey:Me(r,t),queryFn:()=>cr(r,n,t).then(a=>(a?.status==="success"&&i(a.download_url),a)).catch(a=>{let c=o("default_download_link_error",{fileName:t});throw a instanceof _e&&a.code!=null&&(c=o(a.code)),s?.(c),a}),enabled:!!(e&&r&&n&&t)})}function Me(e,r){return["downloadSandboxLink",e,r]}const fe=Rt({downloadFile:{id:"SandboxDownload.downloadFile",defaultMessage:"Download file"},startingDownload:{id:"SandboxDownload.startingDownload",defaultMessage:"Starting download"}}),ur="f",Mr="dr",Ue=(e,r,n=!1)=>{const t=b.useRef(!1);b.useEffect(()=>{t.current||(t.current=!0,E.count(A.DEFAULT,"clickable_follow_up_text_shown"),n&&E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_shown"),x.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...B({clientThreadId:e,messageId:r})}))},[e,r,n])},je=({messageId:e,clientThreadId:r,text:n})=>{const t=ge(r),s=ht.useStore(),i=we(r);Ue(r,e,!1);const o=b.useCallback(a=>{a.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),x.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",B({clientThreadId:r,messageId:e}));const c=s.getActiveSystemHintType();t({sourceEvent:a,promptMessage:bt(n.toLowerCase(),{suggestion_type:ye.Reply}),completionMetadata:{systemHints:c?[c]:[],conversationMode:i??{kind:yt.PrimaryAssistant}}})},[r,i,e,s,t,n]);return d.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:n})},fr=({messageId:e,clientThreadId:r,text:n})=>d.jsx(je,{messageId:e,clientThreadId:r,text:n}),Ur=I.memo(fr),pr=({messageId:e,clientThreadId:r,text:n})=>{const t=_t(),{setThreadSystemHintMode:s}=wt(),i=!!Nt(),o=ge(r),a=we(r);Ue(r,e,!0);const c=b.useCallback(l=>{l.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),x.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",B({clientThreadId:r,messageId:e}));const u={clientThreadId:r};s(xt.Research,!0,u);{const f=Ct(t);f.focus(),kt(f,n)}},[r,e,n,t,s,a,o]);return i?d.jsx(je,{messageId:e,clientThreadId:r,text:n}):d.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[d.jsx(Qe,{className:"icon me-1 inline-block"}),n]})},mr=({messageId:e,clientThreadId:r,text:n})=>d.jsx(pr,{messageId:e,clientThreadId:r,text:n}),jr=I.memo(mr);function dr(){return e=>{_(e,{tagName:"table"},r=>{const n=r.children.find(s=>k(s,"thead"))?.children.find(s=>k(s,"tr"))?.children.filter(s=>k(s,"th"))??[],t=r.children.find(s=>k(s,"tbody"))?.children.filter(s=>k(s,"tr"))?.map(s=>s.children.filter(i=>k(i,"td")))??[];for(let s=0;s<n.length;s++){const i=n[s];let o=pe(i);for(let c=0;c<t.length;c++)o=Math.max(o,pe(t[c]?.[s]));const a=o>160?"xl":o>100?"lg":o>40?"md":"sm";i.properties["data-col-size"]=a;for(let c=0;c<t.length;c++)t[c]?.[s]&&(t[c][s].properties["data-col-size"]=a)}})}}function k(e,r){return e.type==="element"&&e.tagName===r}function pe(e){let r=0;return e&&_(e,"text",n=>{r+=n.value.length}),r}const gr=new Set([jt,ur]),Br=e=>e.startsWith(Fe)||gr.has(e)?e:Je(e);function hr(){return e=>{_(e,"list",r=>{for(const n of r.children)n.spread=!0})}}function yr(){return(e,r)=>{let n=0;const t=String(r.value);_(e,"containerDirective",s=>{if(s.type==="containerDirective"&&s.name===V){const i=s.position?.start?.offset,o=s.position?.end?.offset;if(i==null||o==null)return;const c=t.slice(i,o).replace(/^:::[^\n]*\n?/,"").replace(/\n?:::\s*$/,""),l=s.data||(s.data={});l.hName=V;const u=n++,f=s.attributes||{};l.hProperties={...f,content:c,index:u}}})}}function Ir(e){return r=>{_(r,n=>{Object.defineProperties(n,{markdownSource:{get(){try{return e.slice(this.position.start.offset,this.position.end.offset)}catch{return""}}}})})}}const Be=[[St,{singleTilde:!1}],Tn,hr,[Pt,{singleDollarTextMath:!1}],Et,yr,Ft,Mt,...W?[W]:[],Ot,br,wr];function br(){return e=>{_(e,"textDirective",r=>{r.name!==Ne&&(r.type="text",r.value=`:${r.name}`)})}}const _r=/\u200b/g;function wr(){return e=>{_(e,"text",r=>{r.value=r.value.replace(_r,"")})}}function Nr(){return e=>{const r=e.position?.end.offset;_(e,"element",(n,t)=>{const{position:s}=n;if(!s)return;const{start:i,end:o}=s,a=i.offset,c=o.offset;n.properties??={},a!=null&&(n.properties["data-start"]=a),c!=null&&(n.properties["data-end"]=c,r===c&&(n.properties["data-is-last-node"]=""),t===e.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const Hr=[Pe,Nr,dr,[Xe,{target:"_new",rel:"noopener noreferrer"}],he],xr=[[Pe,{output:"mathml"}],he];function Cr(e,r){const n=Lt(e,r);return Ie(n,r)}function Ie(e,r){const n=O().use(xe).use(Be).use([[Er,r??[]]]).use(At,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:kr}}),t=O().use(Ze).use(xr).use(Dn),s=n.runSync(n.parse(e)),i=n.stringify(s),o=t.stringify(t.runSync(s));return{"text/plain":i,"text/html":o}}const kr=(e,r,n,t)=>{const s=n.createTracker(t),i=n.enter("link"),o=n.enter("label");let a=s.move("[");return a+=s.move(n.containerPhrasing(e,{before:a,after:"](",...s.current()})),a+=s.move("]("),o(),a+=s.move(e.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Sr)),e.title&&(a+=s.move(" "+JSON.stringify(e.title))),a+=s.move(")"),i(),a};function Sr(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function Er(e){return r=>{const n={},t=(s,i)=>{switch(i.type){case"grouped_webpages":{const o=[];for(const a of i.items)if(a.url&&a.title){let c=n[a.url];c||(c=n[a.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:a.url,title:a.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:a.attribution??tt(a.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((a,c,l)=>c<l.length-1?[a,{type:"text",value:", "}]:[a]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"map":case"tldr":case"navigation":case"stock":case"calculator":case"python":case"container":case"code_execution":case"forecast":case"businesses_map":case"entity_metadata":case"video":case"entity":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"checkout_confirmation":case"image_inline":case"image_group":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(i.alt){const o=O().use(xe).use(Be).parse(i.alt);if(s.type!=="textDirective")return o.children;const a=o.children[0];if(a.type==="paragraph")return a.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};_(r,et,(s,i,o)=>{if(o==null||i==null)return;const a=Ar(s,e),c=a?t(s,a)??[s]:[];return o.children.splice(i,1,...c),[be,i+c.length]}),r.children.push(...Object.values(n))}}function Ar(e,r){if(e.name===Ne){const n=e.attributes?.index;if(n)return r[parseInt(n,10)]}}const qr=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:Ie,messageTextToClipboardContent:Cr},Symbol.toStringTag,{value:"Module"}));export{ur as C,jt as I,Ut as M,Be as R,Fe as S,Dn as a,Hr as b,Fr as c,Pr as d,Ur as e,Mr as f,jr as g,Ir as h,qr as i,Ie as m,Tn as r,Br as u};
//# sourceMappingURL=enuwppfnm9s2n8ir.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/hwcyajhg1pvieq51.js","assets/m60bpb0x3x7rg8fj.js","assets/lgw4q0e8zlqqfgug.js","assets/root-otc54kct.css","assets/ggjzadbnd3k1vu0k.js","assets/conversation-small-j0gcsxmz.css","assets/mdsdqbg7dtklqnuw.js","assets/kj109at7ry8iempm.js","assets/jtj7tm19s85de1gz.js","assets/gjtxw5aaotq3dyvk.js","assets/o7wniqoxhh56wvjg.js","assets/g7o69yifmkuxfsll.js","assets/m9elivgqkyz3hcka.js","assets/czj65b9i5sztgpdb.js","assets/d6raol4cdcsdp19u.js","assets/n26tu9wxezmtzr3d.js","assets/dmk30rbb7u1k7gl7.js","assets/ansi-1f6vhsjh.css","assets/795byvwofdax2f6d.js","assets/m3hp25w3mcid81ib.js","assets/jii3s2n86nvi5fnj.js","assets/dp7t1jmnbbend843.js","assets/hvkmppraevglbeo3.js","assets/kfjcy5y4cxuymbdf.js","assets/lf8mxjdfum7t34gh.js","assets/wham-task-page-content-layout-ico853ag.css","assets/cb9cgv53vja8utnc.js","assets/nyb6qzfj9cwbbq9m.js","assets/ijm2v97qh75qdidh.js"])))=>i.map(i=>d[i]);
import{r as A,f as O,h as $s,i as ds,j as i,M as T,g as Gs,a as hs,A as fs,u as Vs,c as Ks,d as qs}from"./m60bpb0x3x7rg8fj.js";import{e as Ae,p as ge,b2 as ms,B as z,S as lt,cq as zs,cs as xe,k3 as Qs,fx as ps,dS as Bt,lC as gs,pU as Ht,ha as it,bV as Ut,w as Xs,bc as Ys,z as _t,tI as Zs,tJ as Js,cC as xs,cF as en,tK as tn,tL as sn,hn as nn,fS as rn,pT as on,C as an,b_ as cn,b$ as ln,R as un,bb as dn,fe as hn,lB as Qt,lU as fn,f6 as yt,jf as st,jg as mn,f9 as pn,cp as gn,fp as Y,fz as Xt,rZ as xn,fs as Yt,ei as nt,s8 as Cn,fu as vn,fb as wn}from"./lgw4q0e8zlqqfgug.js";import{l4 as bn,ma as Cs,sR as Mn,fA as An,sS as En,dy as vs,ak as yn,sT as Sn,sU as kn,sV as It,iq as Me,ir as ws,pO as jn,iV as Fn,bz as bs,o1 as Bn,kV as _n,om as In,oc as Nn,od as Tn,oe as Dn,o3 as Zt,o5 as Rn,oh as Ln,nA as On,o6 as Pn,ol as Wn,oj as Hn}from"./ggjzadbnd3k1vu0k.js";import{W as Z}from"./cb9cgv53vja8utnc.js";import{W as Nt,h as I,C as Ms,O as Un,S as $n,F as Gn,G as Vn,H as Kn,x as As,P as qn,o as zn,k as Qn,j as Xn,s as Yn,t as Zn,f as Jt,w as es,B as Jn}from"./g7o69yifmkuxfsll.js";import{C as Es,a as Tt,u as er,b as tr,c as sr,S as ts,s as ot}from"./o7wniqoxhh56wvjg.js";import{u as nr}from"./nyb6qzfj9cwbbq9m.js";import{e as rr}from"./ijm2v97qh75qdidh.js";function or(){const t=Ae();return ge(t,"3651421897")}const ys=t=>A.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},A.createElement("path",{d:"M18 4C19.6569 4 21 5.34315 21 7V14.5H21.5L21.6025 14.5049C22.1067 14.5562 22.5 14.9823 22.5 15.5V17C22.5 18.6569 21.1569 20 19.5 20H4.5C2.89489 20 1.58421 18.7394 1.50391 17.1543L1.5 17V15.5L1.50488 15.3975C1.55621 14.8933 1.98232 14.5 2.5 14.5H3V7C3 5.34315 4.34315 4 6 4H18ZM3.5 17L3.50488 17.1025C3.55621 17.6067 3.98232 18 4.5 18H19.5C20.0523 18 20.5 17.5523 20.5 17V16.5H3.5V17ZM6 6C5.44772 6 5 6.44772 5 7V14.5H19V7C19 6.44772 18.5523 6 18 6H6Z",fill:"currentColor"}));function ir({taskId:t,hasMultipleInProgressOrStreamingTurns:e}){const s=O(),n=ms(),o=$s(),[a,r]=A.useState(!1),{mutate:c}=ds({mutationFn:async()=>{r(!0),await Nt.cancelTask(t)},onError:()=>{n.danger(s.formatMessage({id:"wham.whamTaskRow.failedToCancelTask",defaultMessage:"Failed to cancel task"}))},onSuccess:()=>{o.refetchQueries({queryKey:["wham","task",t]}),o.invalidateQueries({queryKey:["wham","tasks"]})}});return i.jsx(z,{color:"primary",type:"button",size:"small",className:e?void 0:"h-9 w-9",icon:a?lt:bn,onClick:()=>(Z.recordCancel("task-details"),c()),disabled:a,"aria-label":s.formatMessage({id:"wham.composer.cancelTask",defaultMessage:"Cancel task"}),"data-testid":"stop-button",children:e&&i.jsx(T,{id:"wham.composer.stopButton.multipleInProgressOrStreamingTurns",defaultMessage:"Stop all"})})}function ar({isSubmitDisabled:t,createTask:e,disabledReason:s}){const n=O(),o=zs(),[a,r]=A.useState(!1);return i.jsxs("div",{className:"flex items-center gap-2",onClick:c=>c.stopPropagation(),children:[i.jsx(xe,{open:o?a:void 0,onOpenChange:r,label:s??n.formatMessage({id:"wham.whamComposer.fasterTitle",defaultMessage:"Fast mode where the agent doesn't edit code"}),children:i.jsx(z,{color:"secondary",type:"button",className:o&&t?"opacity-50":"",disabled:t&&!o,onClick:t?()=>r(!0):()=>(Z.recordComposerAction("ask"),e({runEnvironmentInQaMode:!0})),children:i.jsx(T,{id:"wham.composer.askButton",defaultMessage:"Ask"})})}),i.jsx(xe,{label:s,children:i.jsx(z,{color:"primary",type:"button",className:o&&t?"opacity-50":"",disabled:t&&!o,onClick:t?()=>r(!0):()=>(Z.recordComposerAction("code"),e({runEnvironmentInQaMode:!1})),children:i.jsx(T,{id:"wham.composer.codeItButton",defaultMessage:"Code"})})})]})}function $t(t){const e=O(),s=I(n=>n.getRateLimit()?.resets_after_text);switch(t){case"enabled":return;case"rate-limit":return e.formatMessage({id:"wham.whamComposer.hitRateLimit",defaultMessage:"You have reached your rate limit. It will reset {resetsAfterText}"},{resetsAfterText:s});case"no-environment":return e.formatMessage({id:"wham.whamComposer.noEnvironment",defaultMessage:"No environment selected"});case"no-content":return e.formatMessage({id:"wham.whamComposer.noContent",defaultMessage:"Enter a prompt to continue"});case"no-github-connection":return e.formatMessage({id:"wham.whamComposer.noGitHubConnection",defaultMessage:"No GitHub connection"});case"connect-github-error":return e.formatMessage({id:"wham.whamComposer.connectGitHubError",defaultMessage:"Failed to load environments"});default:Qs(t)}}function Gt({isFollowUp:t,hasComments:e}){const s=I(d=>d.getRateLimit()?.remaining===0),n=I(({environmentId:d})=>d),o=I(({branch:d})=>d),a=ps(),c=!Bt(gs(a))||e,{isConnected:l,error:u}=Ht(Ut.GITHUB_CONNECTOR,"github","/codex",it.CODEX);return s?"rate-limit":!n&&!o&&!t?"no-environment":!t&&!l?"no-github-connection":!t&&u?"connect-github-error":c?"enabled":"no-content"}const cr=4,lr=t=>{switch(t){case 1:return i.jsx(Kn,{"aria-hidden":!0,className:"icon-sm"});case 2:return i.jsx(Vn,{"aria-hidden":!0,className:"icon-sm"});case 3:return i.jsx(Gn,{"aria-hidden":!0,className:"icon-sm"});default:return i.jsx($n,{"aria-hidden":!0,className:"icon-sm"})}};function ur({attempts:t,setAttempts:e}){const s=O(),[n,o]=A.useState(!1),a=A.useRef(null),r=()=>o(!1),c=Ae(),l=Xs(c,"2179180337").value.max_attempts??cr;return i.jsx(dr,{children:i.jsxs(Cs,{open:n,onOpenChange:o,children:[i.jsx(Es,{triggerText:s.formatMessage({id:"wham.attemptsSelector.trigger",defaultMessage:"{count}x"},{count:t}),toolTip:s.formatMessage({id:"wham.attemptsSelector.tooltip",defaultMessage:"Number of simultaneous versions"}),ariaLabel:s.formatMessage({id:"wham.attemptsSelector.ariaLabel",defaultMessage:"Open versions number selector, currently set to {count}x"},{count:t}),Icon:lr(t),truncate:!1}),i.jsx(Ms,{align:"start",isOpen:n,closePopover:r,popoverContentRef:a,children:i.jsx("div",{className:"flex w-50 flex-col rounded-lg p-1.5",children:[...Array(l)].map((u,d)=>i.jsx(Tt,{className:"w-full",onClick:()=>{e(d+1),r()},isSelected:t===d+1,label:s.formatMessage({id:"wham.attemptsSelector.option",defaultMessage:"{count, plural, one {# version} other {# versions}}"},{count:d+1})},d+1))})})]})})}function dr({children:t}){const e=O(),s=Mn(),n=Un(),o=s&&!s.isLoading&&s.eligible&&!n.isLoading&&!!n.data;return i.jsx(An,{side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",show:o,sideOffset:0,className:"w-60",announcementKey:En,title:e.formatMessage({id:"wham.composerBon.nuxTooltip.title",defaultMessage:"Best-of-N"}),description:e.formatMessage({id:"wham.composerBon.nuxTooltip.description",defaultMessage:"Generate multiple solutions so you can pick the best approach."}),onDismiss:s.markAsViewed,children:t})}function hr({comments:t,onClearComments:e}){const s=O();return t.length===0?null:i.jsxs("div",{className:"bg bg-token-bg-secondary mx-1 mt-1 flex items-center gap-2 rounded-t-3xl rounded-b-lg py-0.5 ps-3 pe-0.5 font-semibold text-blue-400",children:[i.jsx(vs,{className:"icon"}),i.jsx("div",{className:"flex-1 text-sm",children:i.jsx(T,{id:"wham.composer.commentCount",defaultMessage:"{count, plural, one {One code comment} other {# code comments}}",values:{count:t.length}})}),i.jsx("button",{className:"text-token-text-secondary flex h-9 w-9 shrink-0 items-center justify-center",onClick:n=>{n.preventDefault(),n.stopPropagation(),e()},"aria-label":s.formatMessage({id:"wham.composer.clearComments",defaultMessage:"Clear comments"}),children:i.jsx(Ys,{className:"icon"})})]})}function Ss({className:t}){return i.jsx(yn,{className:_t("flex w-[8rem] items-center gap-1.5 rounded-full! md:w-[10rem]",t)})}function Q(t){return Array.isArray?Array.isArray(t):Fs(t)==="[object Array]"}function fr(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function mr(t){return t==null?"":fr(t)}function G(t){return typeof t=="string"}function ks(t){return typeof t=="number"}function pr(t){return t===!0||t===!1||gr(t)&&Fs(t)=="[object Boolean]"}function js(t){return typeof t=="object"}function gr(t){return js(t)&&t!==null}function L(t){return t!=null}function St(t){return!t.trim().length}function Fs(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const xr="Incorrect 'index' type",Cr=t=>`Invalid value for key ${t}`,vr=t=>`Pattern length exceeds max of ${t}.`,wr=t=>`Missing ${t} property in key`,br=t=>`Property 'weight' in key '${t}' must be a positive integer`,ss=Object.prototype.hasOwnProperty;class Mr{constructor(e){this._keys=[],this._keyMap={};let s=0;e.forEach(n=>{let o=Bs(n);this._keys.push(o),this._keyMap[o.id]=o,s+=o.weight}),this._keys.forEach(n=>{n.weight/=s})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Bs(t){let e=null,s=null,n=null,o=1,a=null;if(G(t)||Q(t))n=t,e=ns(t),s=Dt(t);else{if(!ss.call(t,"name"))throw new Error(wr("name"));const r=t.name;if(n=r,ss.call(t,"weight")&&(o=t.weight,o<=0))throw new Error(br(r));e=ns(r),s=Dt(r),a=t.getFn}return{path:e,id:s,weight:o,src:n,getFn:a}}function ns(t){return Q(t)?t:t.split(".")}function Dt(t){return Q(t)?t.join("."):t}function Ar(t,e){let s=[],n=!1;const o=(a,r,c)=>{if(L(a))if(!r[c])s.push(a);else{let l=r[c];const u=a[l];if(!L(u))return;if(c===r.length-1&&(G(u)||ks(u)||pr(u)))s.push(mr(u));else if(Q(u)){n=!0;for(let d=0,m=u.length;d<m;d+=1)o(u[d],r,c+1)}else r.length&&o(u,r,c+1)}};return o(t,G(e)?e.split("."):e,0),n?s:s[0]}const Er={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},yr={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Sr={location:0,threshold:.6,distance:100},kr={useExtendedSearch:!1,getFn:Ar,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var x={...yr,...Er,...Sr,...kr};const jr=/[^ ]+/g;function Fr(t=1,e=3){const s=new Map,n=Math.pow(10,e);return{get(o){const a=o.match(jr).length;if(s.has(a))return s.get(a);const r=1/Math.pow(a,.5*t),c=parseFloat(Math.round(r*n)/n);return s.set(a,c),c},clear(){s.clear()}}}class Vt{constructor({getFn:e=x.getFn,fieldNormWeight:s=x.fieldNormWeight}={}){this.norm=Fr(s,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((s,n)=>{this._keysMap[s.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,G(this.docs[0])?this.docs.forEach((e,s)=>{this._addString(e,s)}):this.docs.forEach((e,s)=>{this._addObject(e,s)}),this.norm.clear())}add(e){const s=this.size();G(e)?this._addString(e,s):this._addObject(e,s)}removeAt(e){this.records.splice(e,1);for(let s=e,n=this.size();s<n;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(e,s){return e[this._keysMap[s]]}size(){return this.records.length}_addString(e,s){if(!L(e)||St(e))return;let n={v:e,i:s,n:this.norm.get(e)};this.records.push(n)}_addObject(e,s){let n={i:s,$:{}};this.keys.forEach((o,a)=>{let r=o.getFn?o.getFn(e):this.getFn(e,o.path);if(L(r)){if(Q(r)){let c=[];const l=[{nestedArrIndex:-1,value:r}];for(;l.length;){const{nestedArrIndex:u,value:d}=l.pop();if(L(d))if(G(d)&&!St(d)){let m={v:d,i:u,n:this.norm.get(d)};c.push(m)}else Q(d)&&d.forEach((m,p)=>{l.push({nestedArrIndex:p,value:m})})}n.$[a]=c}else if(G(r)&&!St(r)){let c={v:r,n:this.norm.get(r)};n.$[a]=c}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function _s(t,e,{getFn:s=x.getFn,fieldNormWeight:n=x.fieldNormWeight}={}){const o=new Vt({getFn:s,fieldNormWeight:n});return o.setKeys(t.map(Bs)),o.setSources(e),o.create(),o}function Br(t,{getFn:e=x.getFn,fieldNormWeight:s=x.fieldNormWeight}={}){const{keys:n,records:o}=t,a=new Vt({getFn:e,fieldNormWeight:s});return a.setKeys(n),a.setIndexRecords(o),a}function rt(t,{errors:e=0,currentLocation:s=0,expectedLocation:n=0,distance:o=x.distance,ignoreLocation:a=x.ignoreLocation}={}){const r=e/t.length;if(a)return r;const c=Math.abs(n-s);return o?r+c/o:c?1:r}function _r(t=[],e=x.minMatchCharLength){let s=[],n=-1,o=-1,a=0;for(let r=t.length;a<r;a+=1){let c=t[a];c&&n===-1?n=a:!c&&n!==-1&&(o=a-1,o-n+1>=e&&s.push([n,o]),n=-1)}return t[a-1]&&a-n>=e&&s.push([n,a-1]),s}const ne=32;function Ir(t,e,s,{location:n=x.location,distance:o=x.distance,threshold:a=x.threshold,findAllMatches:r=x.findAllMatches,minMatchCharLength:c=x.minMatchCharLength,includeMatches:l=x.includeMatches,ignoreLocation:u=x.ignoreLocation}={}){if(e.length>ne)throw new Error(vr(ne));const d=e.length,m=t.length,p=Math.max(0,Math.min(n,m));let g=a,f=p;const w=c>1||l,M=w?Array(m):[];let h;for(;(h=t.indexOf(e,f))>-1;){let E=rt(e,{currentLocation:h,expectedLocation:p,distance:o,ignoreLocation:u});if(g=Math.min(E,g),f=h+d,w){let j=0;for(;j<d;)M[h+j]=1,j+=1}}f=-1;let v=[],C=1,S=d+m;const B=1<<d-1;for(let E=0;E<d;E+=1){let j=0,P=S;for(;j<P;)rt(e,{errors:E,currentLocation:p+P,expectedLocation:p,distance:o,ignoreLocation:u})<=g?j=P:S=P,P=Math.floor((S-j)/2+j);S=P;let re=Math.max(1,p-P+1),ve=r?m:Math.min(p+P,m)+d,N=Array(ve+2);N[ve+1]=(1<<E)-1;for(let k=ve;k>=re;k-=1){let V=k-1,Ee=s[t.charAt(V)];if(w&&(M[V]=+!!Ee),N[k]=(N[k+1]<<1|1)&Ee,E&&(N[k]|=(v[k+1]|v[k])<<1|1|v[k+1]),N[k]&B&&(C=rt(e,{errors:E,currentLocation:V,expectedLocation:p,distance:o,ignoreLocation:u}),C<=g)){if(g=C,f=V,f<=p)break;re=Math.max(1,2*p-f)}}if(rt(e,{errors:E+1,currentLocation:p,expectedLocation:p,distance:o,ignoreLocation:u})>g)break;v=N}const y={isMatch:f>=0,score:Math.max(.001,C)};if(w){const E=_r(M,c);E.length?l&&(y.indices=E):y.isMatch=!1}return y}function Nr(t){let e={};for(let s=0,n=t.length;s<n;s+=1){const o=t.charAt(s);e[o]=(e[o]||0)|1<<n-s-1}return e}const at=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class Is{constructor(e,{location:s=x.location,threshold:n=x.threshold,distance:o=x.distance,includeMatches:a=x.includeMatches,findAllMatches:r=x.findAllMatches,minMatchCharLength:c=x.minMatchCharLength,isCaseSensitive:l=x.isCaseSensitive,ignoreDiacritics:u=x.ignoreDiacritics,ignoreLocation:d=x.ignoreLocation}={}){if(this.options={location:s,threshold:n,distance:o,includeMatches:a,findAllMatches:r,minMatchCharLength:c,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:d},e=l?e:e.toLowerCase(),e=u?at(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const m=(g,f)=>{this.chunks.push({pattern:g,alphabet:Nr(g),startIndex:f})},p=this.pattern.length;if(p>ne){let g=0;const f=p%ne,w=p-f;for(;g<w;)m(this.pattern.substr(g,ne),g),g+=ne;if(f){const M=p-ne;m(this.pattern.substr(M),M)}}else m(this.pattern,0)}searchIn(e){const{isCaseSensitive:s,ignoreDiacritics:n,includeMatches:o}=this.options;if(e=s?e:e.toLowerCase(),e=n?at(e):e,this.pattern===e){let w={isMatch:!0,score:0};return o&&(w.indices=[[0,e.length-1]]),w}const{location:a,distance:r,threshold:c,findAllMatches:l,minMatchCharLength:u,ignoreLocation:d}=this.options;let m=[],p=0,g=!1;this.chunks.forEach(({pattern:w,alphabet:M,startIndex:h})=>{const{isMatch:v,score:C,indices:S}=Ir(e,w,M,{location:a+h,distance:r,threshold:c,findAllMatches:l,minMatchCharLength:u,includeMatches:o,ignoreLocation:d});v&&(g=!0),p+=C,v&&S&&(m=[...m,...S])});let f={isMatch:g,score:g?p/this.chunks.length:1};return g&&o&&(f.indices=m),f}}class J{constructor(e){this.pattern=e}static isMultiMatch(e){return rs(e,this.multiRegex)}static isSingleMatch(e){return rs(e,this.singleRegex)}search(){}}function rs(t,e){const s=t.match(e);return s?s[1]:null}class Tr extends J{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const s=e===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Dr extends J{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class Rr extends J{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const s=e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Lr extends J{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const s=!e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Or extends J{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const s=e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class Pr extends J{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const s=!e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Ns extends J{constructor(e,{location:s=x.location,threshold:n=x.threshold,distance:o=x.distance,includeMatches:a=x.includeMatches,findAllMatches:r=x.findAllMatches,minMatchCharLength:c=x.minMatchCharLength,isCaseSensitive:l=x.isCaseSensitive,ignoreDiacritics:u=x.ignoreDiacritics,ignoreLocation:d=x.ignoreLocation}={}){super(e),this._bitapSearch=new Is(e,{location:s,threshold:n,distance:o,includeMatches:a,findAllMatches:r,minMatchCharLength:c,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:d})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ts extends J{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let s=0,n;const o=[],a=this.pattern.length;for(;(n=e.indexOf(this.pattern,s))>-1;)s=n+a,o.push([n,s-1]);const r=!!o.length;return{isMatch:r,score:r?0:1,indices:o}}}const Rt=[Tr,Ts,Rr,Lr,Pr,Or,Dr,Ns],os=Rt.length,Wr=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Hr="|";function Ur(t,e={}){return t.split(Hr).map(s=>{let n=s.trim().split(Wr).filter(a=>a&&!!a.trim()),o=[];for(let a=0,r=n.length;a<r;a+=1){const c=n[a];let l=!1,u=-1;for(;!l&&++u<os;){const d=Rt[u];let m=d.isMultiMatch(c);m&&(o.push(new d(m,e)),l=!0)}if(!l)for(u=-1;++u<os;){const d=Rt[u];let m=d.isSingleMatch(c);if(m){o.push(new d(m,e));break}}}return o})}const $r=new Set([Ns.type,Ts.type]);class Gr{constructor(e,{isCaseSensitive:s=x.isCaseSensitive,ignoreDiacritics:n=x.ignoreDiacritics,includeMatches:o=x.includeMatches,minMatchCharLength:a=x.minMatchCharLength,ignoreLocation:r=x.ignoreLocation,findAllMatches:c=x.findAllMatches,location:l=x.location,threshold:u=x.threshold,distance:d=x.distance}={}){this.query=null,this.options={isCaseSensitive:s,ignoreDiacritics:n,includeMatches:o,minMatchCharLength:a,findAllMatches:c,ignoreLocation:r,location:l,threshold:u,distance:d},e=s?e:e.toLowerCase(),e=n?at(e):e,this.pattern=e,this.query=Ur(this.pattern,this.options)}static condition(e,s){return s.useExtendedSearch}searchIn(e){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:o,ignoreDiacritics:a}=this.options;e=o?e:e.toLowerCase(),e=a?at(e):e;let r=0,c=[],l=0;for(let u=0,d=s.length;u<d;u+=1){const m=s[u];c.length=0,r=0;for(let p=0,g=m.length;p<g;p+=1){const f=m[p],{isMatch:w,indices:M,score:h}=f.search(e);if(w){if(r+=1,l+=h,n){const v=f.constructor.type;$r.has(v)?c=[...c,...M]:c.push(M)}}else{l=0,r=0,c.length=0;break}}if(r){let p={isMatch:!0,score:l/r};return n&&(p.indices=c),p}}return{isMatch:!1,score:1}}}const Lt=[];function Vr(...t){Lt.push(...t)}function Ot(t,e){for(let s=0,n=Lt.length;s<n;s+=1){let o=Lt[s];if(o.condition(t,e))return new o(t,e)}return new Is(t,e)}const ct={AND:"$and",OR:"$or"},Pt={PATH:"$path",PATTERN:"$val"},Wt=t=>!!(t[ct.AND]||t[ct.OR]),Kr=t=>!!t[Pt.PATH],qr=t=>!Q(t)&&js(t)&&!Wt(t),is=t=>({[ct.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Ds(t,e,{auto:s=!0}={}){const n=o=>{let a=Object.keys(o);const r=Kr(o);if(!r&&a.length>1&&!Wt(o))return n(is(o));if(qr(o)){const l=r?o[Pt.PATH]:a[0],u=r?o[Pt.PATTERN]:o[l];if(!G(u))throw new Error(Cr(l));const d={keyId:Dt(l),pattern:u};return s&&(d.searcher=Ot(u,e)),d}let c={children:[],operator:a[0]};return a.forEach(l=>{const u=o[l];Q(u)&&u.forEach(d=>{c.children.push(n(d))})}),c};return Wt(t)||(t=is(t)),n(t)}function zr(t,{ignoreFieldNorm:e=x.ignoreFieldNorm}){t.forEach(s=>{let n=1;s.matches.forEach(({key:o,norm:a,score:r})=>{const c=o?o.weight:null;n*=Math.pow(r===0&&c?Number.EPSILON:r,(c||1)*(e?1:a))}),s.score=n})}function Qr(t,e){const s=t.matches;e.matches=[],L(s)&&s.forEach(n=>{if(!L(n.indices)||!n.indices.length)return;const{indices:o,value:a}=n;let r={indices:o,value:a};n.key&&(r.key=n.key.src),n.idx>-1&&(r.refIndex=n.idx),e.matches.push(r)})}function Xr(t,e){e.score=t.score}function Yr(t,e,{includeMatches:s=x.includeMatches,includeScore:n=x.includeScore}={}){const o=[];return s&&o.push(Qr),n&&o.push(Xr),t.map(a=>{const{idx:r}=a,c={item:e[r],refIndex:r};return o.length&&o.forEach(l=>{l(a,c)}),c})}class Ce{constructor(e,s={},n){this.options={...x,...s},this.options.useExtendedSearch,this._keyStore=new Mr(this.options.keys),this.setCollection(e,n)}setCollection(e,s){if(this._docs=e,s&&!(s instanceof Vt))throw new Error(xr);this._myIndex=s||_s(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){L(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const s=[];for(let n=0,o=this._docs.length;n<o;n+=1){const a=this._docs[n];e(a,n)&&(this.removeAt(n),n-=1,o-=1,s.push(a))}return s}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:s=-1}={}){const{includeMatches:n,includeScore:o,shouldSort:a,sortFn:r,ignoreFieldNorm:c}=this.options;let l=G(e)?G(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return zr(l,{ignoreFieldNorm:c}),a&&l.sort(r),ks(s)&&s>-1&&(l=l.slice(0,s)),Yr(l,this._docs,{includeMatches:n,includeScore:o})}_searchStringList(e){const s=Ot(e,this.options),{records:n}=this._myIndex,o=[];return n.forEach(({v:a,i:r,n:c})=>{if(!L(a))return;const{isMatch:l,score:u,indices:d}=s.searchIn(a);l&&o.push({item:a,idx:r,matches:[{score:u,value:a,norm:c,indices:d}]})}),o}_searchLogical(e){const s=Ds(e,this.options),n=(c,l,u)=>{if(!c.children){const{keyId:m,searcher:p}=c,g=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(l,m),searcher:p});return g&&g.length?[{idx:u,item:l,matches:g}]:[]}const d=[];for(let m=0,p=c.children.length;m<p;m+=1){const g=c.children[m],f=n(g,l,u);if(f.length)d.push(...f);else if(c.operator===ct.AND)return[]}return d},o=this._myIndex.records,a={},r=[];return o.forEach(({$:c,i:l})=>{if(L(c)){let u=n(s,c,l);u.length&&(a[l]||(a[l]={idx:l,item:c,matches:[]},r.push(a[l])),u.forEach(({matches:d})=>{a[l].matches.push(...d)}))}}),r}_searchObjectList(e){const s=Ot(e,this.options),{keys:n,records:o}=this._myIndex,a=[];return o.forEach(({$:r,i:c})=>{if(!L(r))return;let l=[];n.forEach((u,d)=>{l.push(...this._findMatches({key:u,value:r[d],searcher:s}))}),l.length&&a.push({idx:c,item:r,matches:l})}),a}_findMatches({key:e,value:s,searcher:n}){if(!L(s))return[];let o=[];if(Q(s))s.forEach(({v:a,i:r,n:c})=>{if(!L(a))return;const{isMatch:l,score:u,indices:d}=n.searchIn(a);l&&o.push({score:u,key:e,value:a,idx:r,norm:c,indices:d})});else{const{v:a,n:r}=s,{isMatch:c,score:l,indices:u}=n.searchIn(a);c&&o.push({score:l,key:e,value:a,norm:r,indices:u})}return o}}Ce.version="7.1.0";Ce.createIndex=_s;Ce.parseIndex=Br;Ce.config=x;Ce.parseQuery=Ds;Vr(Gr);var kt,as;function Zr(){if(as)return kt;as=1;var t=Zs(),e=Js(),s=sn(),n=xs(),o=en(),a=tn(),r=Math.min;function c(l,u,d){for(var m=d?s:e,p=l[0].length,g=l.length,f=g,w=Array(g),M=1/0,h=[];f--;){var v=l[f];f&&u&&(v=n(v,o(u))),M=r(v.length,M),w[f]=!d&&(u||p>=120&&v.length>=120)?new t(f&&v):void 0}v=l[0];var C=-1,S=w[0];e:for(;++C<p&&h.length<M;){var B=v[C],y=u?u(B):B;if(B=d||B!==0?B:0,!(S?a(S,y):m(h,y,d))){for(f=g;--f;){var E=w[f];if(!(E?a(E,y):m(l[f],y,d)))continue e}S&&S.push(y),h.push(B)}}return h}return kt=c,kt}var jt,cs;function Jr(){if(cs)return jt;cs=1;var t=Sn();function e(s){return t(s)?s:[]}return jt=e,jt}var Ft,ls;function eo(){if(ls)return Ft;ls=1;var t=xs(),e=Zr(),s=kn(),n=Jr(),o=s(function(a){var r=t(a,n);return r.length&&r[0]===a[0]?e(r):[]});return Ft=o,Ft}var to=eo();const so=Gs(to);function no(){const{data:t}=qn(),{data:e,isLoading:s}=zn();return{environments:e??t,fullEnvironmentsLoading:s}}function ro({onCreateEnvironment:t,showBranchSelector:e=!0,filters:s=null}={}){const n=O(),{environmentId:o,setEnvironmentId:a,selectedRepositoryId:r,setSelectedRepositoryId:c}=I(),[l,u]=A.useState(!1),d=A.useRef(null),{environments:m,fullEnvironmentsLoading:p}=no(),g=A.useMemo(()=>s?.repos?m?.filter(h=>so(h.repos,s.repos).length>0):m,[m,s]),f=g?.find(h=>h.id===o),w=A.useCallback(h=>{if(!h)return null;const v=h.repos??Object.keys(h.repo_map??{});if(!v.length)return null;const[C]=v;return C??null},[]);er("environment",l,()=>u(!1)),A.useEffect(()=>{if(p)return;if(o&&!f){a(null),c(null);return}else if(!o&&g?.length){const C=It(g,[B=>!(B.is_pinned??!1),B=>-(B.task_count??0)])[0];a(C.id);const S=w(C);c(S??null);return}const h=w(f);h!=null&&h!==r?c(h):f&&h==null&&r!=null&&c(null)},[p,o,f,g,a,r,c,w]),As([{key:"whamEnvironments",action:()=>u(!0),actionMessageDescriptor:n.formatMessage({id:"wham.keyboardActions.whamEnvironments",defaultMessage:"Environments"}),group:ws.Chat,keyboardBinding:[Me.Mod,"e"]}]);const M=()=>u(!1);return p&&!g?.length?i.jsx("div",{className:"flex items-center gap-3 rounded-full",children:i.jsx(Ss,{})}):i.jsxs("div",{className:"flex items-center gap-2 rounded-full",children:[i.jsxs(Cs,{open:l,onOpenChange:u,children:[i.jsx(Es,{triggerText:f?.label??n.formatMessage({id:"wham.codexEnvironmentPopover.selectEnvironment",defaultMessage:"Select environment"}),toolTip:(f?.label?.length??0)>16?f?.label??"":f?.label||l?"":n.formatMessage({id:"wham.codexEnvironmentPopover.viewAllCodeEnvironments",defaultMessage:"View all code environments"}),ariaLabel:n.formatMessage({id:"wham.codexEnvironmentPopover.viewAll",defaultMessage:"View all code environments"}),Icon:i.jsx(ys,{"aria-hidden":!0,className:"icon-sm"})}),i.jsx(Ms,{align:"start",isOpen:l,closePopover:M,popoverContentRef:d,children:i.jsx(oo,{isLoading:p,environments:g??[],environmentId:o,setEnvironmentId:h=>{a(h);const v=g?.find(S=>S.id===h),C=w(v);c(C??null)},closePopover:M,onCreateEnvironment:t})})]}),f&&e&&i.jsx(tr,{environment:f})]})}function oo({isLoading:t,environments:e,environmentId:s,setEnvironmentId:n,closePopover:o,onCreateEnvironment:a}){const r=O(),c=A.useRef(null),[l,u]=A.useState(""),d=C=>{n(C),o()},m=hs(),p=e.length>0,g=A.useMemo(()=>new Ce(e,{threshold:.4,keys:["label","repos"]}),[e]),f=A.useMemo(()=>{if(!l?.trim()){const[y,E]=jn(e,j=>j.is_pinned);return[...It(y,j=>-(j.task_count??0)),...It(E,j=>-(j.task_count??0))]}const C=l.trim().toLowerCase(),S=g?.search(l).map(y=>y.item)??[],B=y=>{const E=y.toLowerCase();return E===C?0:E.startsWith(C)?1:2};return S.sort((y,E)=>{if(y.is_pinned!==E.is_pinned)return y.is_pinned?-1:1;const j=B(y.label)-B(E.label);return j!==0?j:y.label.localeCompare(E.label)})},[l,g,e]),{hoveredId:w,setHoveredId:M,onKeyDown:h,getItemRef:v}=sr({items:f,keyExtractor:C=>C.id,onSelect:d});return A.useEffect(()=>{c.current?.focus()},[]),i.jsxs("div",{className:"flex max-h-[280px] w-80 flex-col overflow-y-auto rounded-lg md:max-h-[360px]",children:[e.length>4&&i.jsxs("div",{className:"contents",onClick:C=>{C.stopPropagation()},children:[i.jsx(nn,{ref:c,className:"placeholder:text-token-text-tertiary !focus-within:ring-0 my-1.5 w-full border-0 bg-transparent ps-4 outline-none focus:border-0 focus:ring-0 focus:outline-none",inputClassName:"text-sm",type:"text",autoComplete:"off",name:"branch-to-add",value:l,onChange:C=>u(C.target.value),onKeyDown:h,suppressFocus:!0,placeholder:r.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsTooltip",defaultMessage:"Search environmentsâ€¦"}),ariaLabel:r.formatMessage({id:"wham.codexEnvironmentPopover.searchEnvironmentsAria",defaultMessage:"Search environments"})}),i.jsx("div",{className:"bg-token-border-default h-px w-full"})]}),i.jsx("div",{className:"flex flex-col overflow-y-auto p-1.5",children:t?i.jsx("div",{className:"flex w-full items-center justify-center py-2",children:i.jsx(lt,{className:"ms-2"})}):e.length>0?f.length>0?f.map(C=>{const S=s===C.id;return i.jsx(Tt,{as:"button",ref:v(C),onMouseEnter:()=>M(C.id),className:"w-full",truncateLabel:!0,onClick:()=>{d(C.id)},isVirtualHover:w===C.id,isSelected:S,label:C.label},C.id)}):i.jsx("div",{className:"p-5 text-center",children:i.jsx("p",{className:"text-token-text-tertiary text-sm",children:i.jsx(T,{id:"wham.environmentPopover.noMatches",defaultMessage:"No matches found"})})}):i.jsxs("div",{className:"p-2 text-center",children:[i.jsx("p",{className:"text-token-text-primary text-sm",children:i.jsx(T,{id:"wham.environmentPopover.noEnvironments",defaultMessage:"No environments"})}),i.jsx("p",{className:"text-token-text-secondary text-xs",children:i.jsx(T,{id:"wham.environmentPopover.missingEnvironment",defaultMessage:"Codex requires an environment to work"})})]})}),i.jsx("div",{className:"bg-token-border-default h-px w-full"}),i.jsx("div",{className:"bg-token-bg-tertiary px-2 py-1.5",children:i.jsx(Tt,{className:"w-full",noDefaultHoverState:!0,onClick:()=>{!p&&a?a():m("/codex/settings/environments")},isSelected:!1,icon:i.jsx(rn,{className:"icon-sm"}),label:p?r.formatMessage({id:"wham.codexEnvironmentPopover.manageEnvironments",defaultMessage:"Manage environments"}):r.formatMessage({id:"wham.codexEnvironmentPopover.createEnvironment",defaultMessage:"Create environment"})},"environment-action")})]})}function io({onCreateEnvironment:t,showBranchSelector:e,filters:s}={}){const n=O(),{isConnected:o,isLoading:a,openGithubModal:r,error:c,refetch:l}=Ht(Ut.GITHUB_CONNECTOR,"github","/codex",it.CODEX),{enabled:u}=on(it.CODEX);return a?i.jsx(Ss,{className:"h-9"}):c?i.jsx(xe,{label:n.formatMessage({id:"wham.whamComposerEnvironmentsSelector.failedClickToRetry",defaultMessage:"Click to retry"}),children:i.jsx(z,{color:"secondary",type:"button",className:"border-token-border-default flex w-fit items-center gap-1.5 rounded-full! border",onClick:l,children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ys,{"aria-hidden":!0,className:"icon-sm"}),i.jsx(T,{id:"wham.environmentsSelector.retry",defaultMessage:"Failed to load environments"})]})})}):u?i.jsx(i.Fragment,{children:i.jsx("div",{className:"z-0 flex w-full justify-between",children:o?i.jsx("div",{className:"flex gap-4",children:i.jsx(ro,{onCreateEnvironment:t,showBranchSelector:e??!0,filters:s??null})}):i.jsx("div",{className:"flex gap-2",children:i.jsxs(z,{type:"button",color:"secondary",size:"small",onClick:r,children:[i.jsx(ts,{"aria-hidden":!0,className:"icon-sm me-1.5"}),i.jsx(T,{id:"wham.environmentsSelector.connectGithub",defaultMessage:"Connect GitHub"})]})})})}):i.jsx(xe,{label:n.formatMessage({id:"wham.whamComposerEnvironmentsSelector.disabledByWorkspaceAdmin",defaultMessage:"Disabled by workspace admin"}),children:i.jsxs(z,{type:"button",color:"secondary",onClick:r,disabled:!0,children:[i.jsx(ts,{"aria-hidden":!0,className:"icon-sm me-1.5"}),i.jsx(T,{id:"wham.environmentsSelector.connectGithub",defaultMessage:"Connect GitHub"})]})})}function ao(){const t=O(),e=hs(),{setupMfa:s}=nr({redirectUrl:"/codex"});return i.jsx(an,{isOpen:!0,onClose:()=>{},type:"warning",title:t.formatMessage({id:"wham.mfaRequiredModal.title",defaultMessage:"Enable multi-factor authentication to access Codex"}),description:t.formatMessage({id:"wham.mfaRequiredModal.description",defaultMessage:"To continue using Codex, please turn on multi-factor authentication for your account."}),testId:"modal-mfa-required",children:i.jsxs("div",{className:"flex w-full justify-end gap-2",children:[i.jsx(z,{color:"secondary",onClick:()=>{e("/")},children:i.jsx(T,{id:"wham.mfaRequiredModal.backToChatGPT",defaultMessage:"Back to ChatGPT"})}),i.jsx(z,{color:"primary",onClick:()=>{s()},children:i.jsx(T,{id:"wham.mfaRequiredModal.enableMFA",defaultMessage:"Enable MFA"})})]})})}const co=t=>A.createElement("svg",{width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 4.5C5.68355 4.5 5.84354 4.62492 5.88806 4.80299C6.08089 5.57434 6.30775 6.04206 6.63284 6.36716C6.95794 6.69225 7.42566 6.91911 8.19701 7.11194C8.37508 7.15646 8.5 7.31645 8.5 7.5C8.5 7.68355 8.37508 7.84354 8.19701 7.88806C7.42566 8.08089 6.95794 8.30775 6.63284 8.63284C6.30775 8.95794 6.08089 9.42566 5.88806 10.197C5.84354 10.3751 5.68355 10.5 5.5 10.5C5.31645 10.5 5.15646 10.3751 5.11194 10.197C4.91911 9.42566 4.69225 8.95794 4.36716 8.63284C4.04206 8.30775 3.57434 8.08089 2.80299 7.88806C2.62492 7.84354 2.5 7.68355 2.5 7.5C2.5 7.31645 2.62492 7.15646 2.80299 7.11194C3.57434 6.91911 4.04206 6.69225 4.36716 6.36716C4.69225 6.04206 4.91911 5.57434 5.11194 4.80299C5.15646 4.62492 5.31645 4.5 5.5 4.5Z",fill:"currentColor"}),A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 2.5C12.6835 2.5 12.8435 2.62492 12.8881 2.80299C13.0809 3.57434 13.3077 4.04206 13.6328 4.36716C13.9579 4.69225 14.4257 4.91911 15.197 5.11194C15.3751 5.15646 15.5 5.31645 15.5 5.5C15.5 5.68355 15.3751 5.84354 15.197 5.88806C14.4257 6.08089 13.9579 6.30775 13.6328 6.63284C13.3077 6.95794 13.0809 7.42566 12.8881 8.19701C12.8435 8.37508 12.6835 8.5 12.5 8.5C12.3165 8.5 12.1565 8.37508 12.1119 8.19701C11.9191 7.42566 11.6923 6.95794 11.3672 6.63284C11.0421 6.30775 10.5743 6.08089 9.80299 5.88806C9.62492 5.84354 9.5 5.68355 9.5 5.5C9.5 5.31645 9.62492 5.15646 9.80299 5.11194C10.5743 4.91911 11.0421 4.69225 11.3672 4.36716C11.6923 4.04206 11.9191 3.57434 12.1119 2.80299C12.1565 2.62492 12.3165 2.5 12.5 2.5Z",fill:"currentColor"}),A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5 9.5C10.6835 9.5 10.8435 9.62492 10.8881 9.80299C11.0809 10.5743 11.3077 11.0421 11.6328 11.3672C11.9579 11.6923 12.4257 11.9191 13.197 12.1119C13.3751 12.1565 13.5 12.3165 13.5 12.5C13.5 12.6835 13.3751 12.8435 13.197 12.8881C12.4257 13.0809 11.9579 13.3077 11.6328 13.6328C11.3077 13.9579 11.0809 14.4257 10.8881 15.197C10.8435 15.3751 10.6835 15.5 10.5 15.5C10.3165 15.5 10.1565 15.3751 10.1119 15.197C9.91911 14.4257 9.69225 13.9579 9.36716 13.6328C9.04206 13.3077 8.57434 13.0809 7.80299 12.8881C7.62492 12.8435 7.5 12.6835 7.5 12.5C7.5 12.3165 7.62492 12.1565 7.80299 12.1119C8.57434 11.9191 9.04206 11.6923 9.36716 11.3672C9.69225 11.0421 9.91911 10.5743 10.1119 9.80299C10.1565 9.62492 10.3165 9.5 10.5 9.5Z",fill:"currentColor"}));function Ro(t){const{outputDiffs:e}=Rs(t?.output_items);return{filesModified:ot(e,s=>s.files_modified??0),linesAdded:ot(e,s=>s.lines_added??0),linesRemoved:ot(e,s=>s.lines_removed??0)}}function Rs(t){let e=!1;return t?{outputDiffs:t.map(n=>{switch(n.type){case"output_diff":return n;case"pr":return e=!!n.pre_apply_patch,n.output_diff;case"cr":return n.reviewed_diff;default:return null}}).filter(n=>n!=null),hasPreApplyPatch:e}:{outputDiffs:[],hasPreApplyPatch:e}}const lo=cn(()=>ln(()=>import("./hwcyajhg1pvieq51.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28])).then(t=>t.SpeculativeTaskContentModal));function uo({taskId:t,index:e,assistantTurn:s,suggestion:n,disabledReason:o,loading:a}){const{outputDiffs:r}=Rs(s.output_items),c=r[0];return i.jsx(xe,{side:"right",sideOffset:10,label:o,children:i.jsxs("div",{className:"flex w-full items-center gap-1.5 rounded-lg px-2 py-1",children:[i.jsx("span",{className:"self-start pt-[0.125rem]",children:a?i.jsx(lt,{className:"text-token-text-tertiary icon-sm"}):i.jsx(co,{className:"text-token-text-tertiary icon-sm"})}),i.jsx("span",{className:"text-token-text-primary line-clamp-2 flex-1 text-start text-sm leading-snug break-words",children:n.title}),c&&c.lines_added!=null&&c.lines_removed!=null&&i.jsx(Qn,{className:"text-sm",linesAdded:c.lines_added,linesRemoved:c.lines_removed}),i.jsx(ho,{taskId:t,assistantTurn:s,suggestion:n,index:e})]})})}function ho({taskId:t,assistantTurn:e,suggestion:s,index:n}){const[o,a]=A.useState(!1);return i.jsxs("div",{onClick:r=>{r.stopPropagation(),r.preventDefault()},children:[i.jsx(z,{color:"secondary",size:"small",icon:Fn,onClick:r=>{r.stopPropagation(),r.preventDefault(),a(!0)},children:i.jsx(T,{id:"wham.speculativeFollowUpSuggestionRow.preview",defaultMessage:"Preview"})}),i.jsx(lo,{taskId:t,suggestion:s,index:n,assistantTurn:e,isOpen:o,onClose:()=>a(!1)})]})}function fo({taskId:t,turnId:e,followupVisibilityState:s,followUpSuggestions:n,hasComments:o,isSubmitting:a,onSuggestionClick:r,children:c}){const l=O(),[u,d]=A.useState(null),{data:m}=mo({taskId:t,turnId:e}),p=Gt({isFollowUp:!0,hasComments:o});let g=$t(p);p==="no-content"&&(g=void 0);const f=!!m?.length&&t&&e;return A.useEffect(()=>{f&&Z.recordFollowUpsSeen(t,e,n.length)},[f,t,e,n.length]),f?i.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col gap-1.5 rounded-2xl p-2",children:[i.jsx(fs,{initial:!1,children:s==="visible"&&i.jsx("div",{className:"flex flex-col",inert:a,children:m.map(({suggested_task:w,assistant_turn:M},h)=>i.jsx(uo,{index:h,taskId:t,turnId:e,assistantTurn:M,suggestion:w,disabledReason:g,loading:u===h&&a,onClick:()=>{a||(d(h),r(w))}},h))})}),s==="collapsed"&&i.jsxs("button",{type:"button",className:"text-token-text-tertiary enabled:hover:text-token-text-secondary focus:bg-token-bg-secondary flex items-center gap-2 rounded-lg p-2 text-xs font-semibold focus:outline-none","aria-label":l.formatMessage({id:"wham.speculativeFollowUpContainer.showSuggestions",defaultMessage:"Show follow up suggestions"}),onClick:()=>{Z.recordFollowUpsExpanded(t,e)},children:[i.jsx(bs,{className:"icon-sm"}),i.jsx(T,{id:"wham.composer.followup.show",defaultMessage:"Suggestions"},"text")]},"collapsed"),c({isWrappedByContainer:!0})]}):c({isWrappedByContainer:!1})}function mo({taskId:t,turnId:e}){return Vs({queryKey:["wham","speculative-turns",t,e],queryFn:async()=>{const s=await un.safeGet("/wham/tasks/{task_id}/speculative_turns/{task_turn_id}",{parameters:{path:{task_id:t,task_turn_id:e}}}),n=s.speculative_turns;return rr(n,a=>a.assistant_turn.turn_status==="completed")?s.speculative_turns.filter(a=>!a.assistant_turn.discarded):[]},refetchInterval:s=>s&&s.state?.data?.some(o=>o.assistant_turn.turn_status==="pending"||o.assistant_turn.turn_status==="in_progress")?3e4:!1})}function po({taskId:t,turnId:e,isComposerExpanded:s,followUpSuggestions:n,hasComments:o,isSubmitting:a,onSuggestionClick:r,children:c}){const l=Ae(),u=xo(l,s),d=O(),[m,p]=A.useState(null),g=Gt({isFollowUp:!0,hasComments:o});let f=$t(g);g==="no-content"&&(f=void 0);const w=!(u==="hidden"||!n.length)&&t&&e;if(A.useEffect(()=>{w&&Z.recordFollowUpsSeen(t,e,n.length)},[w,t,e,n.length]),w){if(ge(l,"2007094101")&&n.find(M=>!!M.assistantTurnId))return i.jsx(fo,{taskId:t,turnId:e,followupVisibilityState:u,followUpSuggestions:n,hasComments:o,isSubmitting:a,onSuggestionClick:r,children:({isWrappedByContainer:M})=>c({isWrappedByContainer:M})})}else return c({isWrappedByContainer:!1});return i.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col gap-1.5 rounded-2xl p-2",children:[i.jsx(fs,{initial:!1,children:u==="visible"&&i.jsx("div",{className:"flex flex-col",inert:a,children:n.map((M,h)=>i.jsx(go,{index:h,taskId:t,turnId:e,suggestion:M.suggestion,disabledReason:f,loading:m===h&&a,onClick:()=>{a||(p(h),r(M.suggestion))}},h))})}),u==="collapsed"&&i.jsxs("button",{type:"button",className:"text-token-text-tertiary enabled:hover:text-token-text-secondary focus:bg-token-bg-secondary flex items-center gap-2 rounded-lg p-2 text-xs font-semibold focus:outline-none","aria-label":d.formatMessage({id:"wham.followUpContainer.showSuggestions",defaultMessage:"Show follow up suggestions"}),onClick:()=>{Z.recordFollowUpsExpanded(t,e)},children:[i.jsx(bs,{className:"icon-sm"}),i.jsx(T,{id:"wham.composer.followup.show",defaultMessage:"Suggestions"},"text")]},"collapsed"),c({isWrappedByContainer:!0})]})}function go({taskId:t,turnId:e,index:s,suggestion:n,disabledReason:o,loading:a,onClick:r}){return i.jsx(xe,{side:"right",sideOffset:10,label:o,children:i.jsxs("button",{type:"button",disabled:!!o||a,className:"group hover:bg-token-bg-secondary focus:bg-token-bg-secondary -disabled:cursor-pointer flex w-full items-start gap-1.5 rounded-lg px-2 py-1 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>{r(),Z.recordFollowUpsClicked(t,e,s,n.severity)},children:[i.jsx("span",{className:"pt-[0.125rem]",children:a?i.jsx(lt,{className:"text-token-text-tertiary icon-sm"}):i.jsx(vs,{className:"text-token-text-tertiary icon-sm"})}),i.jsx("span",{className:"text-token-text-primary line-clamp-2 text-start text-sm leading-snug break-words",children:n.title})]})})}function xo(t,e){return ge(t,"3485296344")||void 0?e?"collapsed":"visible":"hidden"}function Co(){const t=Ae(),e=I(n=>n.bestOfN);return e??dn(t,"2398649844").get("default_attempts",1)}function Lo(t){"use forget";const e=Ks.c(131),{disableAutoFocus:s,isBigBoxMode:n,disableDuringSubmit:o,expanded:a,followUp:r,onClearComments:c,onSubmit:l,onSuccess:u,onCreateEnvironment:d,attemptIndex:m,ariaLabel:p,environmentSelector:g}=t,f=s===void 0?!1:s,w=n===void 0?!1:n,M=o===void 0?!1:o,h=O(),v=ms(),{refetch:C}=Xn(),{refetch:S}=Yn(r?.taskId),{refetch:B}=Zn(r?.taskId),y=I(ko),E=I(So),j=I(yo),P=I(Eo),[re,ve]=A.useState(!0),[N,ut]=A.useState(!1),k=hn(),V=Qt(Ao),Ee=Qt(yt.hasUploadInProgress),Ls=Co(),Os=I(Mo),[Ps,Ws]=A.useState(1),ee=r?Ps:Ls,dt=r?Ws:Os,K=Ae();let ye;e[0]!==K?(ye=ge(K,"3492040717"),e[0]=K,e[1]=ye):ye=e[1];const te=ye;let Se;e[2]!==K?(Se=ge(K,"879591222")||void 0,e[2]=K,e[3]=Se):Se=e[3];const Hs=Se;let ke;e[4]!==K?(ke=ge(K,"3536244140"),e[4]=K,e[5]=ke):ke=e[5];const je=ke,H=or(),[ht,Kt]=A.useState(!1),b=ps();let Fe;e[6]!==b?(Fe=Bn(b),e[6]=b,e[7]=Fe):Fe=e[7];const oe=Bt(Fe.isWhisperActive$),qt=A.useRef(null),Be=I(bo),ie=Be&&!!r,ft=ie?!1:oe?!0:a;let _e;e[8]!==b?(_e=fn(b),e[8]=b,e[9]=_e):_e=e[9];const mt=_e;let Ie;e[10]!==b?(Ie=gs(b),e[10]=b,e[11]=Ie):Ie=e[11];const pt=Ie;let Ne;e[12]!==mt||e[13]!==ft||e[14]!==pt?(Ne=()=>ft??(!pt()||mt()),e[12]=mt,e[13]=ft,e[14]=pt,e[15]=Ne):Ne=e[15];const X=Bt(Ne),gt=M&&N||ie,W=!!r&&(r.comments.length??0)>0;let Te;e[16]!==k||e[17]!==h||e[18]!==v?(Te=F=>{for(const D of F)st.uploadFile(k,mn(D),D,pn.Codex,[],h,v)},e[16]=k,e[17]=h,e[18]=v,e[19]=Te):Te=e[19];const se=Te;let De;e[20]!==se?(De=function(D){const q=D.target.files;q&&(se(q),D.target.value="")},e[20]=se,e[21]=De):De=e[21];const xt=De;let Re,Le;e[22]!==b||e[23]!==H||e[24]!==se?(Re=()=>{if(!H)return;const F=D=>{const q=D.clipboardData?.items;if(!q)return;const $=[];for(const be of q)if(be.kind==="file"){const tt=be.getAsFile();tt&&tt.type.startsWith("image/")&&$.push(tt)}$.length>0&&(D.preventDefault(),se($))};return gn(Y(b).dom,{paste:F})},Le=[b,H,se],e[22]=b,e[23]=H,e[24]=se,e[25]=Re,e[26]=Le):(Re=e[25],Le=e[26]),A.useEffect(Re,Le);let Oe;e[27]!==k?(Oe=function(){return yt.getReadyFiles(k.getState()).flatMap(wo)},e[27]=k,e[28]=Oe):Oe=e[28];const Ct=Oe;let ae;e[29]!==b?(ae=()=>Xt(Y(b)),e[29]=b,e[30]=ae):ae=e[30];let ce;e[31]!==h?(ce=h.formatMessage({id:"wham.keyboardActions.focusComposer",defaultMessage:"Focus chat"}),e[31]=h,e[32]=ce):ce=e[32];let Pe;e[33]===Symbol.for("react.memo_cache_sentinel")?(Pe=[Me.Shift,Me.Escape],e[33]=Pe):Pe=e[33];let le;e[34]!==r?(le=r?void 0:[[Me.Mod,Me.Shift,"o"]],e[34]=r,e[35]=le):le=e[35];let We;e[36]!==ae||e[37]!==ce||e[38]!==le?(We=[{key:"focusComposer",action:ae,actionMessageDescriptor:ce,group:ws.Chat,keyboardBinding:Pe,altKeyboardBindings:le}],e[36]=ae,e[37]=ce,e[38]=le,e[39]=We):We=e[39],As(We);const vt=!!r;let He;e[40]!==W||e[41]!==vt?(He={isFollowUp:vt,hasComments:W},e[40]=W,e[41]=vt,e[42]=He):He=e[42];const Us=Gt(He),{isConnected:we}=Ht(Ut.GITHUB_CONNECTOR,"github","/codex",it.CODEX),Ue=$t(Us),ue=!!Ue||N&&M||Ee;let de;e[43]!==ee||e[44]!==te||e[45]!==E||e[46]!==b||e[47]!==y||e[48]!==k||e[49]!==r||e[50]!==Ct||e[51]!==W||e[52]!==h||e[53]!==H||e[54]!==l||e[55]!==v?(de=async F=>{const{runEnvironmentInQaMode:D,promptOverride:q}=F===void 0?{runEnvironmentInQaMode:!1}:F,$=q??xn(Y(b).state.doc).content,be=yt.getReadyFiles(k.getState());if(!(!!$.length||W))throw new Error("No content to submit");const zt=H?Ct():[];if(l?.(),st.reset(k),ut(!0),r)return await Nt.createFollowUpTask(r.taskId,r.turnId,$,r.comments,D,te?ee:void 0,zt).catch(_=>{throw q||(Yt(Y(b),$),st.restoreFiles(k,be)),_ instanceof nt&&_.status===429?v.danger(h.formatMessage(us.rateLimit),{id:r.turnId,duration:5,hasCloseButton:!0}):_ instanceof Jt?es(_,r.turnId,h,v):_ instanceof nt&&_.status===403&&_.detail?.toLowerCase().includes("multi-factor authentication")?Kt(!0):v.danger(h.formatMessage({id:"wham.whamComposer.failedToCreateFollowUpTask",defaultMessage:"Failed to create follow-up"}),{id:r.turnId,duration:5,hasCloseButton:!0}),_});{if(E){if(!y)throw new Error("Environment is required for new tasks.")}else throw new Error("Branch is required");ve(!1);const _=crypto.randomUUID();return I.getState().addPendingTaskId(_),Nt.createNewTask(y,E,$,D,te?ee:void 0,zt).catch(R=>{throw I.getState().removePendingTaskId(_),q||(Cn(Y(b).state.doc)?(Yt(Y(b),$),st.restoreFiles(k,be)):(v.danger(h.formatMessage({id:"wham.whamComposer.failedToCreateTaskCopyToClipboard",defaultMessage:"Failed to create task. Previous prompt copied to clipboard."}),{id:_,duration:5,hasCloseButton:!0}),navigator.clipboard.writeText($))),R}).catch(R=>{throw R instanceof nt&&R.status===429?v.danger(h.formatMessage(us.rateLimit),{id:_,duration:5,hasCloseButton:!0}):R instanceof Jt?es(R,_,h,v):R instanceof nt&&R.status===403&&R.detail?.toLowerCase().includes("multi-factor authentication")?Kt(!0):v.danger(h.formatMessage({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task"}),{id:_,duration:5,hasCloseButton:!0}),R}).then(R=>(I.getState().assignPendingTaskToFinalTask(_,R.task.id),I.getState().setRateLimit(R.rate_limit),R))}},e[43]=ee,e[44]=te,e[45]=E,e[46]=b,e[47]=y,e[48]=k,e[49]=r,e[50]=Ct,e[51]=W,e[52]=h,e[53]=H,e[54]=l,e[55]=v,e[56]=de):de=e[56];let he;e[57]!==j||e[58]!==b||e[59]!==r||e[60]!==u||e[61]!==S||e[62]!==C||e[63]!==B||e[64]!==P?(he=F=>{P(!0),j(F.task.id,F.turn),F.user_turn&&j(F.task.id,F.user_turn),u?.(F),setTimeout(()=>{Xt(Y(b))},0),C(),r&&(S(),B())},e[57]=j,e[58]=b,e[59]=r,e[60]=u,e[61]=S,e[62]=C,e[63]=B,e[64]=P,e[65]=he):he=e[65];let $e;e[66]===Symbol.for("react.memo_cache_sentinel")?($e=()=>{ut(!1)},e[66]=$e):$e=e[66];let Ge;e[67]!==de||e[68]!==he?(Ge={mutationFn:de,onSuccess:he,onSettled:$e},e[67]=de,e[68]=he,e[69]=Ge):Ge=e[69];const{mutate:U,isPending:Ve}=ds(Ge);let Ke;e[70]!==U||e[71]!==ue?(Ke=F=>ue?!1:F.metaKey?(U({runEnvironmentInQaMode:!1}),!0):F.altKey?(U({runEnvironmentInQaMode:!0}),!0):!1,e[70]=U,e[71]=ue,e[72]=Ke):Ke=e[72];const qe=_n(Ke);let ze,Qe;e[73]!==b||e[74]!==qe?(ze=()=>vn(Y(b),{Enter:qe}),Qe=[b,qe],e[73]=b,e[74]=qe,e[75]=ze,e[76]=Qe):(ze=e[75],Qe=e[76]),A.useEffect(ze,Qe);let Xe;e[77]!==r?(Xe=ot(r?[r.turnStatus,...r.siblingTurnStatuses]:[],vo),e[77]=r,e[78]=Xe):Xe=e[78];const Ye=Xe,Ze=!!r&&Hs&&Ye>0,wt=!Ze&&(je?!oe:!0),bt=(r?.siblingTurnStatuses?.length??0)>1;let Je;e[79]!==m||e[80]!==bt||e[81]!==h?(Je=bt&&m?h.formatMessage({id:"wham.whamComposer.followUpOnTurn",defaultMessage:"Follow-up on version {version}"},{version:m}):h.formatMessage({id:"wham.whamComposer.requestChangesOrAskAQuestion",defaultMessage:"Request changes or ask a question"}),e[79]=m,e[80]=bt,e[81]=h,e[82]=Je):Je=e[82];const Mt=Je,At=r?.taskId,Et=r?.turnId;let fe;e[83]!==r?.followUpSuggestions?(fe=r?.followUpSuggestions??[],e[83]=r?.followUpSuggestions,e[84]=fe):fe=e[84];let me;e[85]!==U?(me=F=>{U({runEnvironmentInQaMode:!1,promptOverride:F.body})},e[85]=U,e[86]=me):me=e[86];let pe;e[87]!==p||e[88]!==ee||e[89]!==te||e[90]!==b||e[91]!==gt||e[92]!==U||e[93]!==f||e[94]!==Ue||e[95]!==g||e[96]!==r||e[97]!==Mt||e[98]!==W||e[99]!==Be||e[100]!==Ye||e[101]!==h||e[102]!==w||e[103]!==Ve||e[104]!==X||e[105]!==re||e[106]!==we||e[107]!==H||e[108]!==ue||e[109]!==N||e[110]!==oe||e[111]!==c||e[112]!==d||e[113]!==xt||e[114]!==V||e[115]!==dt||e[116]!==ht||e[117]!==ie||e[118]!==Ze||e[119]!==wt||e[120]!==je?(pe=F=>{const{isWrappedByContainer:D}=F;return i.jsxs("div",{className:"contents",inert:gt,children:[i.jsxs(In,{expanded:X,canCollapseWithInput:!Ve&&D,isTemporaryChat:!1,shouldUseTightRadius:D,onSubmit:()=>{Ve||U({runEnvironmentInQaMode:!1})},composerController:b,ariaLabel:p??h.formatMessage({id:"wham.whamComposer.ariaLabel",defaultMessage:"Codex composer"}),children:[i.jsx(Nn,{children:oe?i.jsx("div",{className:_t("flex max-w-full min-w-0 flex-1 items-center",w&&X&&"min-h-30"),children:i.jsx(Tn,{composerController:b,className:"h-14"})}):i.jsx(Dn,{composerController:b,disableAutoFocus:f||Be,textareaMaxHeightClassName:_t(w&&X&&"min-h-30",r?"max-h-[max(10rem,min(calc(100dvh-29rem),10rem))]":"max-h-[max(10rem,min(calc(100dvh-29rem),50dvh))]"),placeholder:r?Mt:re?h.formatMessage({id:"wham.whamComposer.describeACodingTask",defaultMessage:"Describe a task"}):h.formatMessage({id:"wham.whamComposer.describeAnotherCodingTask",defaultMessage:"Describe another task"})})}),we&&H&&V.length>0&&i.jsx(Zt,{children:i.jsx(Rn,{files:V,selectedApps:[],activeSystemHintType:void 0,disableEditButton:!0,forceSmallView:!0,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),we&&H&&i.jsx(Ln,{children:i.jsxs(i.Fragment,{children:[i.jsx("input",{ref:qt,type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:xt}),i.jsx("button",{type:"button",className:"composer-btn","aria-label":h.formatMessage({id:"wham.whamComposer.attachImage",defaultMessage:"Attach image"}),onClick:()=>qt.current?.click(),children:i.jsx(On,{className:"icon"})})]})}),W&&i.jsx(Zt,{children:i.jsx(hr,{comments:r.comments,onClearComments:c})}),!oe&&i.jsx(Pn,{children:i.jsxs("div",{className:"flex gap-2",children:[!r&&(g??i.jsx(io,{onCreateEnvironment:d})),te&&we&&i.jsx(ur,{attempts:ee,setAttempts:dt})]})}),i.jsxs(Wn,{children:[!ie&&i.jsxs("div",{className:"flex",children:[je&&i.jsx("div",{inert:N,children:i.jsx(Hn,{composerController:b,composerType:"codex"})}),wt&&i.jsx(ar,{isSubmitDisabled:ue,createTask:U,disabledReason:Ue}),Ze&&i.jsx(ir,{taskId:r.taskId,hasMultipleInProgressOrStreamingTurns:Ye>1})]}),ie&&i.jsx(Jn,{})]})]}),ht&&i.jsx(ao,{})]})},e[87]=p,e[88]=ee,e[89]=te,e[90]=b,e[91]=gt,e[92]=U,e[93]=f,e[94]=Ue,e[95]=g,e[96]=r,e[97]=Mt,e[98]=W,e[99]=Be,e[100]=Ye,e[101]=h,e[102]=w,e[103]=Ve,e[104]=X,e[105]=re,e[106]=we,e[107]=H,e[108]=ue,e[109]=N,e[110]=oe,e[111]=c,e[112]=d,e[113]=xt,e[114]=V,e[115]=dt,e[116]=ht,e[117]=ie,e[118]=Ze,e[119]=wt,e[120]=je,e[121]=pe):pe=e[121];let et;return e[122]!==W||e[123]!==X||e[124]!==N||e[125]!==At||e[126]!==Et||e[127]!==fe||e[128]!==me||e[129]!==pe?(et=i.jsx(po,{taskId:At,turnId:Et,isComposerExpanded:X,followUpSuggestions:fe,hasComments:W,isSubmitting:N,onSuggestionClick:me,children:pe}),e[122]=W,e[123]=X,e[124]=N,e[125]=At,e[126]=Et,e[127]=fe,e[128]=me,e[129]=pe,e[130]=et):et=e[130],et}function vo(t){return t==="pending"||t==="in_progress"?1:0}function wo(t){const e=t.fileSpec;return e&&"width"in e&&"height"in e&&t.fileId?[{type:"image_asset_pointer",asset_pointer:wn(t.fileId),width:e.width,height:e.height,size_bytes:e.size}]:[]}function bo(t){return t.getRateLimit()?.remaining===0}function Mo(t){return t.setBestOfN}function Ao(t){return t.files}function Eo(t){return t.setHasSubmittedTaskInSession}function yo(t){const{addTurnToTaskMap:e}=t;return e}function So(t){const{branch:e}=t;return e}function ko(t){const{environmentId:e}=t;return e}const us=qs({rateLimit:{id:"wham.whamComposer.failedToCreateTaskRateLimit",defaultMessage:"Codex is busy right now. Please try again later."}});export{Ss as S,Lo as W,ys as a,Ro as b,Rs as g,or as u};
//# sourceMappingURL=ngdk8aaa28n1ff0n.js.map

import{m7 as g,aa as e,oz as x}from"./lgw4q0e8zlqqfgug.js";import{O as D,j as E,r as p,Y as h}from"./m60bpb0x3x7rg8fj.js";import{bu as f}from"./ggjzadbnd3k1vu0k.js";const l=async a=>{await h.signOut({callbackUrl:a}),x()},i=(a,o)=>{l(a).then(()=>e.addTiming("chatgpt.web.logout.shouldClearIndexedDB")).catch(t=>{e.addError(new Error("Failed to logout",{cause:t}))})};function B({federatedLogoutUri:a}){const{isFannyPackInitializerEnabled:o}=f();return p.useEffect(()=>{const t=a??window.location.origin;window&&window.indexedDB&&o&&typeof window.indexedDB.databases=="function"?(e.addAction("chatgpt.web.logout.clearIndexedDB"),(async()=>{const u=(await window.indexedDB.databases()).map(n=>new Promise((r,w)=>{if(n.name){const d=window.indexedDB.deleteDatabase(n.name);d.onsuccess=()=>r(),d.onerror=m=>{e.addError(new Error(`Delete IndexedDB failed for database ${n.name}, ${m}`)),w()},d.onblocked=()=>{e.addError(new Error(`Delete IndexedDB blocked for database ${n.name}`)),r()}}else e.addError(new Error(`Invalid database name ${n.name}`)),r()}));await Promise.all(u)})().then(()=>{e.addTiming("chatgpt.web.logout.clearedIndexedDB"),i(t)}).catch(c=>{e.addError(new Error("Failed to clear IndexedDB",{cause:c})),i(t)})):l(a??window.location.origin).catch(s=>e.addError(new Error("Failed to logout",{cause:s})))},[o,a]),null}const k=g(function(){const o=D();return E.jsx(B,{...o})});export{k as default};
//# sourceMappingURL=nroeq5xpajhcqqui.js.map

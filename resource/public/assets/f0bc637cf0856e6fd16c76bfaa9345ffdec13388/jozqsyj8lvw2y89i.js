import{e as S,Z as C,e7 as s,a$ as m,kh as _}from"./lgw4q0e8zlqqfgug.js";import{C as l}from"./l0p6qq8f8it6pgl9.js";import{a as f}from"./m60bpb0x3x7rg8fj.js";function g(a,t){return`/checkout/${a}/${t}`}const E="3950229590",k="enabled_custom_checkout_for_plus",T="enabled_custom_checkout_for_go",O="enabled_custom_checkout_for_pro",U="enabled_custom_checkout_for_team",d="enabled_custom_checkout_for_quorum",N="enable_flush_statsig_on_checkout",r="chatgpt_web_checkout_navigate_to_checkout",w="chatgpt_web_checkout_prepare_checkout_session";function b(a){switch(a){case _.PLUS:return k;case _.GO:return T;case _.PRO:return O;case _.SELF_SERVE_BUSINESS:return U;case _.QUORUM:return d;default:return null}}function A(a,t){const c=b(t);return c==null?"redirect":C(a,E).get(c,!1)?"custom":"redirect"}function v(){const a=f(),t=S();async function c(e=1e3){const o=m(t);await Promise.race([o.flush(),new Promise(n=>setTimeout(n,e))])}async function i(e,o){return e.checkout_ui_mode=o?.fromiOSWebview===!0?"redirect":A(t,e.plan_name),s(t,{eventName:w,metadata:{ui_mode:e.checkout_ui_mode}}),await l.getCheckoutLink(e,{skipSentinelCheckout:o?.skipSentinelCheckout,fromiOSWebview:o?.fromiOSWebview})}async function u(e){const o=C(t,E).get(N,!1);if("tag"in e)switch(s(t,{eventName:r,metadata:{tag:e.tag}}),o&&await c(),e.tag){case"hosted_checkout_session":case"redirect_to_portal":{window.location.href=e.url;break}case"custom_checkout_session":{const n=e.processor_entity,h=e.checkout_session_id;await a({pathname:g(n,h),search:"",hash:""});break}}else if(e.url)s(t,{eventName:r,metadata:{tag:"missing_tag"}}),o&&await c(),window.location.href=e.url;else throw new Error("Received invalid response from /checkout")}return{prepareCheckoutSession:i,navigateToCheckout:u}}export{v as u};
//# sourceMappingURL=jozqsyj8lvw2y89i.js.map

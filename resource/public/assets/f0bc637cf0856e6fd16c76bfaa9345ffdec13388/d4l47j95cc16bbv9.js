const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/eptdk3wq151cyhej.js","assets/m60bpb0x3x7rg8fj.js","assets/ggjzadbnd3k1vu0k.js","assets/lgw4q0e8zlqqfgug.js","assets/root-otc54kct.css","assets/conversation-small-j0gcsxmz.css","assets/c6t73gem18ckjwfn.js","assets/f4qzy3poopk49rvq.js","assets/mlo67gs1ylzshmge.js","assets/h81zqbvh0a7amk0o.js","assets/eczpje1qnh86sh0a.js","assets/fxwiivjy9rf81dg2.js","assets/795byvwofdax2f6d.js","assets/ltxonioslfmyr00u.js","assets/mr7j3fxti6m51rk7.js","assets/hv81c3k3l9e69foo.js","assets/0obq87aul2xadkgb.js","assets/crheuewn890nts1d.js","assets/kkg7k3irromdz83f.js","assets/lqxrayj6ap3vzwmb.js","assets/cs281ckvaib8kadh.js","assets/hlmib46uuygc9t2f.js","assets/nyxsv40nwpzfd96f.js","assets/oisi2tec4bli0nrw.js","assets/gcsd3mtkow76sdqw.js","assets/hs2mcew9gnq8d8k8.js","assets/g61ghrdmm0y010eo.js","assets/ns51nblw8ziscsgd.js","assets/n97h5f2iamu9maxs.js","assets/fmpjwycidcmvmnfy.js","assets/fs8fskv03fy12s6d.js","assets/ord59db2glk2ok2n.js","assets/jwxf616kyifxarl1.js","assets/pfmeky3hgwt4ozsa.js","assets/mog17ocsx2bkw4q4.js","assets/l8y86l5s35pa16ob.js","assets/df3y7yi36gehsn95.js","assets/g5bh4mjh9t2vmm93.js","assets/j770ggbjd02m3hqj.js","assets/pbl95wx6493wq92j.js","assets/j4gbrzdh1iwlkiif.js","assets/lp550lzjbjov6tk6.js","assets/cot-message-jnujn6j8.css","assets/e7dxong5xbqj7jpq.js","assets/haixfva7lt2zsn6y.js","assets/lulwv2qao6117ron.js"])))=>i.map(i=>d[i]);
import{hr as Rs,ap as ls,e as Ms,e_ as Os,kk as Is,dS as Bs,hw as e,cO as F,o as Vs,U as zs,of as D,b_ as _,P as Ns,ie as Js,og as ms,z as gs,dC as cs,aC as Qs,mC as us,oh as Fs,ar as Q,d5 as Ks,c as Ws,dI as $s,b$ as p,v as Hs,N as Us,fc as Xs,dT as Ys}from"./lgw4q0e8zlqqfgug.js";import{r as T,j as t,M as fs}from"./m60bpb0x3x7rg8fj.js";import{ao as Zs,ap as qs,aq as Gs,ar as se,as as K,at as ee,au as te,av as ae,aw as ne,ax as oe,ay as ie,az as re,aA as le,aB as me,aC as ge,aD as ce,aE as ue,aF as _e,aG as fe,aH as de,aI as xe,aJ as he,aK as pe,aL as ye,aM as _s,aN as ve,aO as be,aP as je}from"./ggjzadbnd3k1vu0k.js";import{T as Se}from"./mlo67gs1ylzshmge.js";import{g as we}from"./h81zqbvh0a7amk0o.js";const Ce=_(()=>p(()=>import("./eptdk3wq151cyhej.js"),__vite__mapDeps([0,1,2,3,4,5]))),Ee=_(()=>p(()=>import("./c6t73gem18ckjwfn.js"),__vite__mapDeps([6,1,3,4]))),Te=_(()=>p(()=>import("./f4qzy3poopk49rvq.js"),__vite__mapDeps([7,1,3,4,8,2,5,9]))),De=_(()=>p(()=>import("./eczpje1qnh86sh0a.js"),__vite__mapDeps([10,1,3,4,11,12,2,5,13,14,15]))),Le=_(async()=>()=>null),Ae=_(async()=>()=>null),Pe=_(async()=>(await p(()=>import("./0obq87aul2xadkgb.js"),__vite__mapDeps([16,3,1,4,13,2,5,17,14,15,18,19,20]))).ImageGenMessage),ke=_(()=>p(()=>import("./hlmib46uuygc9t2f.js"),__vite__mapDeps([21,1,3,4,2,5]))),Re=_(()=>p(()=>import("./ggjzadbnd3k1vu0k.js").then(n=>n.x0),__vite__mapDeps([2,3,1,4,5])).then(n=>n.BrowsingMessage)),Me=_(()=>p(()=>import("./nyxsv40nwpzfd96f.js"),__vite__mapDeps([22,1,3,4,2,5])).then(n=>n.BrowserToolMessage)),Oe=_(()=>p(()=>import("./oisi2tec4bli0nrw.js"),__vite__mapDeps([23,1,3,4,2,5])).then(n=>n.SearchResultMessage)),Ie=_(()=>p(()=>import("./gcsd3mtkow76sdqw.js"),__vite__mapDeps([24,1,3,4,25,2,5,11,12,26,27])).then(n=>n.JITPluginMessage)),Be=_(()=>p(()=>import("./n97h5f2iamu9maxs.js"),__vite__mapDeps([28,3,1,4,29,2,5])).then(n=>n.DataAnalysisMessage)),Ve=_(()=>p(()=>import("./fs8fskv03fy12s6d.js"),__vite__mapDeps([30,1,3,4,2,5,31,9]))),ze=_(()=>p(()=>import("./jwxf616kyifxarl1.js"),__vite__mapDeps([32,1,3,4,33,18,19,2,5,15,20,9,34,35,36,37,38,39,17,14,40,41,42])).then(n=>n.LegacyCoTMessage)),Ne=_(()=>p(()=>import("./pfmeky3hgwt4ozsa.js"),__vite__mapDeps([33,1,3,4,18,19,2,5,15,20,9,34,35,36,37,38,39,17,14,40,41,42])).then(n=>n.CoT)),Je=_(()=>p(()=>import("./e7dxong5xbqj7jpq.js"),__vite__mapDeps([43,1,3,4,2,5,44,45])).then(n=>n.JawboneMessage)),Qe=_(async()=>()=>null);function Fe(n){if(n.some(m=>m.type===e.SearchGPTQuery)){const f=n.filter(g=>g.type===D).flatMap(g=>g.groups),o=f.flatMap(g=>g.messages.map(r=>r.metadata?.search_turns_count)).findLast(g=>g!=null);return o!=null?o>1:function(){const r=f.filter(y=>y.type===e.StructuredThoughts),d=f.filter(y=>y.type===e.CoTSearchTool),c=(()=>{function y(x){return x.type===e.StructuredThoughts&&x.messages.flatMap(u=>u.content).some(u=>u.content_type===Xs.StructuredThoughts&&u.thoughts.length>0)}let b=!1;for(const x of f)if(x.type===e.CoTSearchTool)b=!0;else if(y(x)&&b)return!0;return!1})();return r.length>1||d.length>1||c}()}return!0}function Ke(n,m){return n.type===D?F(n.groups)?.messages[0].metadata?.is_visually_hidden_reasoning_group&&m===0:!1}function Ge({groupedMessagesToRender:n,allMessages:m,allGroupedMessages:f,clientThreadId:o,isUserTurn:g,isCompletionRequestInProgress:r,isFeedbackEnabled:d,isFinalTurn:c,isFinalUserTurn:y,isFinalAssistantTurn:b,turnIndex:x,hasActiveRequest:u,onRequestCompletion:O,shouldGrowContainer:P=!0,isParagen:W=!1,renderingView:ds="chat",isAgentTurn:k=!1,isKAUR1BR5:xs=!1,query:hs=null,wasInterrupted:ps=!1,superWidgetImages:ys=null,lastAgentMetadataNode:$,hideSearchGPTQuery:H=!1}){const{showDebugConversationTurns:U}=Rs(),[L]=ls(o,s=>[s?.mode]),X=Ms(),Y=Os(o),Z=Is(o),vs=Zs(),bs=qs(),q=Bs(()=>be(Ys(X,o)).pinnedChatSDKId$()),js=f.some(s=>s.type===e.Browsing||s.type===e.RetrievalBrowsing||s.type===e.SearchGPTQuery||s.type===e.n7jupd)||H,Ss=ls(o,s=>{for(let a=m.length-1;a>=0;a--){const l=m[a],v=s?.tree.getNodeIfExists(l.id)?.message,w=v?je(v):void 0;if(w)return Object.assign({clientThreadId:o,messageId:m[a].id},w)}}),ws=Gs(()=>Hs.count(Us.DEFAULT,"conversation_turn_grouped_messages.attempted_render_missing_type_f959b8c")),I=F(m),Cs=Vs(zs.DeveloperMode),G=se({clientThreadId:o,conversationMode:L}),Es=T.useCallback(({sourceEvent:s,requestedModelId:a,appendMessages:l,extraStreamParams:v,isReasoningSkipped:w,isAgentTurn:S})=>{I&&G({sourceEvent:s,nodeId:I.id,requestedModelId:a,appendMessages:l,extraStreamParams:v,isReasoningSkipped:w,isAgentTurn:S})},[I,G]),Ts=K(n,s=>s.type!==e.Debug),B=n.map((s,a)=>{const l=k?a===Ts:a===f.length-1,v=Fe(n),w=Ke(s,a),S=a===f.length-1?void 0:f[a+1],Ls=S?.type===D?S.groups.at(-1):S,V=a===0?void 0:n[a-1],z=V?.type!==D?V:void 0,ns=z?.type,os=z?.messages,As=m?.filter(i=>i.metadata?.python_citation||i.metadata?.container_citation);if(s.type===D){const i=s.groups[0].messages[0];return!v||w?null:t.jsx(Ne,{isStreaming:c&&l&&r,latestError:Ss,isFinalAssistantTurn:b,messageGroups:s.groups,nextMessageGroup:Ls,prevMessageGroup:z,isAutoswitchOptOutEnabled:!!i.metadata?.classifier_response,handleSkipClick:h=>{Ns.logEventWithStatsig("chatgpt_web_autoswitch_reasoning_skip_clicked","chatgpt_web_autoswitch_reasoning_skip_clicked",{conversationId:o,messageId:s.groups[0].messages[0].id}),Y&&Es({sourceEvent:h,requestedModelId:Y.id,isReasoningSkipped:!0,isAgentTurn:k})},isAgentTurn:k,isKAUR1BR5:xs,wasInterrupted:ps,lastAgentMetadataNode:$},"cot-"+i.id)}const Ps=s&&!Js(s.messages[0]),ks=js&&Ps,C=[];if(ks||C.push(t.jsx(Se,{className:"min-h-8",message:s.messages[0],isFeedbackEnabled:d,isFinalUserTurn:y,isCompletionInProgress:l&&r,hasActiveRequest:u,turnIndex:x,clientThreadId:o,isUserTurn:g,prevGroupedMessageType:ns,prevGroupedMessages:os,citableMessages:As,superWidgetImages:ys},"text-message-"+s.messages[0].id)),U&&C.push(t.jsx(Qe,{clientThreadId:o,message:s.messages[0]},"message-debug-"+s.messages[0].id)),s.type===e.Text&&s.messages[0].metadata?.[ms]){const i=s.messages[0].metadata[ms];return t.jsxs(T.Fragment,{children:[t.jsx(ee,{browserContextMetadata:i,className:gs(we(!0),"mb-1","block")}),C]},"group-"+s.messages[0].id)}switch(s.type){case e.Text:case e.MultiText:if(s.type===e.Text){const i=s.messages[0]?.metadata,h=typeof i?.source=="string"&&i?.source==="dream_followup";return t.jsxs(T.Fragment,{children:[h&&V&&t.jsxs("div",{className:"mx-auto mt-8 mb-6 flex w-full items-center justify-center",children:[t.jsx("div",{className:"h-px flex-1 bg-gray-200 dark:bg-gray-700","aria-hidden":"true"}),t.jsx("p",{className:"mx-3 shrink text-[14px] whitespace-nowrap text-gray-500",children:t.jsx(fs,{id:"threadLayout.proactiveAssistantFollowupDivider",defaultMessage:"Follow-up question"})}),t.jsx("div",{className:"h-px flex-1 bg-gray-200 dark:bg-gray-700","aria-hidden":"true"})]},"proactive-divider-"+s.messages[0].id),C,k&&t.jsx(ue,{currentGroupedMessage:s,isLastMessage:l,isLastTurnInConversation:c,clientThreadId:o,turnIndex:x,lastAgentMetadataNode:$}),t.jsx(_e,{isUserTurn:g,message:s.messages[0]}),t.jsx(fe,{isUserTurn:g,message:s.messages[0],clientThreadId:o})]},"group-"+s.messages[0].id)}else return s.type===e.MultiText?t.jsx(Te,{clientThreadId:o,messages:s.messages,isCompletionInProgress:l&&r,isFeedbackEnabled:d,hasActiveRequest:u,prevGroupedMessageType:ns,prevGroupedMessages:os},"multitext-"+(s.messages[0]?.id??a)):s.type;case e.PIMBlock:{const i=F(m);return L&&i?t.jsx(ce,{isFinalTurn:c,hasActiveRequest:u,conversationMode:L,clientThreadId:o,justification:i.metadata?.pim_justification,flaggedMessageId:i.metadata?.pim_message_id,children:C}):null}case e.n7jupd_n:return t.jsx(ge,{});case e.Browsing:case e.RetrievalBrowsing:{const i=L!=null&&[Q.GizmoInteraction,Q.GizmoMagicCreate,Q.GizmoTest].includes(L.kind),h=Z?Ks(Z):!1;return t.jsx(Re,{messages:s.messages,isRequestActive:u,isLastMessageInTurn:l,isUsingGizmo:i,isUsingSnorlax:h,isRetrieval:s.type===e.RetrievalBrowsing},"browsing-"+(s.messages[0]?.id??a))}case e.kaur1br5:return t.jsx(Me,{messages:s.messages,isRequestActive:u,isLastMessageInTurn:l,clientThreadId:o},"kaur1br5-tool-"+(s.messages[0]?.id??a));case e.SearchGPTQuery:{if(H||n.some(j=>j.type===D)&&v)return null;const h=n.slice(a+1).findLast(j=>j.type===e.Text||j.type===e.CoTSearchTool),E=m.findLast(j=>us(j).length>0),is=new Set,rs=[];for(const j of m){const N=Fs(j);if(N&&N.length>0)for(const J of N)is.has(J)||(is.add(J),rs.push(J))}return t.jsx(me,{clientThreadId:o,turnIndex:x,isRequestActive:u,isLastMessage:l,isLastTurnInConversation:c,nextMessage:h?.messages[0],query:hs,searchResultGroups:us(E),searchModelQueries:rs},"searchquery-"+(s.messages[0]?.id??a))}case e.StructuredThoughts:return null;case e.ReasoningRecap:return null;case e.n7jupd:return null;case e.n7jupd_native_api_tool:case e.n7jupd_a:case e.n7jupd_x:return null;case e.a8km123:{if(!s.messages.every(h=>!h.metadata?.reasoning_status)){const h=K(m,E=>E.author.role===Qs.Assistant&&E.recipient==="all");return t.jsx(ze,{clientThreadId:o,turnIndex:x,isStreaming:(l||h<a)&&r,isFinalAssistantTurn:b,messages:s.messages},"sum-"+(s.messages[0]?.id??a))}return t.jsx(Ve,{messages:s.messages,isStreaming:l&&r,isCompletionRequestInProgress:r,hasActiveRequest:u,isLastMessage:l,isFinalTurn:c,isFeedbackEnabled:d,clientThreadId:o,currentGroupedMessageIndex:a,turnIndex:x},"sum-"+(s.messages[0]?.id??a))}case e.f959b8c:return ws(),null;case e.is_loading_message:if(l&&r){const i=s.messages[0],h=cs(i);return t.jsx(le,{text:h},"loading-message-"+a)}else return null;case e.b47u8ra0_t:{const i=s.messages[0],h="Reference Browser Memories?",E=cs(i);return t.jsx(re,{title:h,description:E,settingsTab:i.metadata?.b47u8ra0_t??"general",clientThreadId:o,parentMessageId:i.id},"b47u8ra0_t-"+a)}case e.c12k321:return null;case e.l1p9k3u:return null;case e.b1de6e2_c:return t.jsx(ie,{messages:s.messages,clientThreadId:o,isLastMessage:l},"b1de6e2-"+(s.messages[0]?.id??a));case e.b1de6e2_s:return t.jsx(oe,{messages:s.messages,clientThreadId:o},"b1de6e2_s-"+(s.messages[0]?.id??a));case e.b1de6e2_d:return null;case e.b1de6e2_rm:return t.jsx(ne,{messages:s.messages,clientThreadId:o,renderingView:ds,children:C},"b1de6e2_rm-"+(s.messages[0]?.id??a));case e.de1d73e:if(vs){const i=a+1<f.length?f[a+1]:void 0;return t.jsx(Je,{clientThreadId:o,currentGroupedMessage:s,nextMessage:i&&i.type===e.Text?i.messages[0]:void 0,isLastMessage:l,isRequestActive:u},"jawbone-"+(s.messages[0]?.id??a))}else return null;case e.ParallelBrowsing:return t.jsx(ke,{messages:s.messages},"parallel-"+(s.messages[0]?.id??a));case e.CodeInterpreter:return t.jsx(Be,{messages:s.messages,isRequestActive:u,clientThreadId:o},"ada-"+(s.messages[0]?.id??a));case e.JITPlugin:return bs&&q&&s.messages.find(i=>i.id===q)?null:t.jsx(Ie,{messages:s.messages,nextMessage:S?.type===e.JITPlugin?S.messages[0]:void 0,clientThreadId:o,isLastTurnInConversation:c,isLastMessageInTurn:l,allowInspectingArguments:Cs.data===!0,onRequestCompletion:O},"jit-"+(s.messages[0]?.id??a));case e.t2uay3k:return t.jsx(Pe,{messages:s.messages,clientThreadId:o,isParagen:W,isLastTurnInConversation:c},"t2uay3k-"+(s.messages[0]?.id??a));case e.Dalle:return t.jsx(De,{messages:s.messages,clientThreadId:o,disableClickThru:W},"dalle-"+(s.messages[0]?.id??a));case e.GizmoEditor:return t.jsx(Ce,{messages:s.messages},"gizmo-editor-"+(s.messages[0]?.id??a));case e.oiw209h:return t.jsx(Le,{messages:s.messages,clientThreadId:o},"oiw209h-"+(s.messages[0]?.id??a));case e.n7jupd_p:return t.jsx(ae,{});case e.Canmore:return t.jsx(te,{messages:s.messages,allTurnMessages:m,isFinalTurn:c,isRequestActive:u,clientThreadId:o,isUserTurn:g},"canmore-"+(s.messages[0]?.id??a));case e.Container:case e.Oboe:return null;case e.Croquette:return null;case e.Debug:return U?t.jsx(Ee,{message:s.messages[0]},"debug-"+s.messages[0].id):null;case e.SearchResult:return t.jsx(Oe,{messages:s.messages},"search-result-"+(s.messages[0]?.id??a));case e.Mochi:return null;case e.CoTSearchTool:return null;case e.SuperWidget:return null;case e.n7jupd_image_gen:return null;case e.e1ld0dvz:return null;case e.Glaux:return t.jsx(Ae,{messages:s.messages,isLastMessage:l},"glaux-"+s.messages[0].id)}}),Ds=ye(),{wordFadeType:A,animationDurationMs:ss}=de(),R=T.useRef([]),es=T.useRef(void 0),ts=T.useRef(null),M=!g&&c&&r,as=m[0]?.id;return Ws(()=>{if(A!=="indexed"||!M)return;const s=ts.current;if(!s)return;es.current!==as&&(es.current=as,R.current=[]);const a=s.getAnimations({subtree:!0}).filter(l=>l.animationName===_s["fade-in"]);if(a.length!==0){const l=He({now:performance.now(),previousStartTimes:R.current,groupCount:a.length});R.current=l;for(let v=0;v<a.length;v++)a[v].startTime=l[v]}else R.current=[]},[B,A,M]),t.jsx("div",{className:gs({"flex max-w-full flex-col":!0,[_s.root]:A==="indexed"&&M,grow:P}),style:A==="indexed"?{"--duration":`${ss}ms`}:void 0,ref:ts,children:t.jsx($s,{name:"GroupedMessages",fallback:We,children:g?B:t.jsxs(xe,{isDisabled:!M||A!=="delay",defaultAnimationDurationPerSegmentMs:ss,children:[he(X)&&c&&t.jsx(pe,{isStreaming:r,debug:Ds}),B]},m[0]?.id)})})}function We({error:n}){return t.jsxs(ve,{type:"danger",children:[t.jsx(fs,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."}),!1]})}function $e(n,m,f){if(n.length<2||m<=0)return 0;const o=m/Math.log(2);n=[...n].sort((d,c)=>d-c);let g=0,r=0;for(let d=n.length-1;d>0;--d){const c=Math.exp(-(f-n[d])/o);if(g>0&&c/g<.01)break;const y=n[d]-n[d-1];g+=c,r+=c*y}return g===0?0:g/r}function He({now:n,previousStartTimes:m,groupCount:f,initialRate:o=50,halfLife:g=1}){const r=m.slice(0,K(m,x=>x<=n)+1),d=r.length<2?o/1e3:Math.max(.01,$e(r,g*1e3,n)),c=f-r.length;let y=r[r.length-1]??0,b=1;for(let x=0;x<c;x++){const u=d*1e3*b;c<u?b*=.8:c>u&&(b*=1.5);const O=1/(d*b),P=Math.max(n,y+O);r.push(P),y=P}return r}export{Ge as C};
//# sourceMappingURL=d4l47j95cc16bbv9.js.map

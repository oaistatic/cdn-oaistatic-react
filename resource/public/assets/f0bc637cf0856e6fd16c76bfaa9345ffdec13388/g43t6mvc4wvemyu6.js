import{g as tt,r as F,j as Ie}from"./m60bpb0x3x7rg8fj.js";import{V as nt,A as Re,a as ae,C as Ce,b as x,B as ot,E as _e,c as it,S as pe,u as rt}from"./hf4p7t05oigpiihm.js";import{aa as Ee}from"./lgw4q0e8zlqqfgug.js";import{sA as st,sB as lt}from"./ggjzadbnd3k1vu0k.js";import{w as at,p as Le,c as q,s as O,a as C,h as ke,e as k,t as ue,b as K,m as Te,d as He,f as I,g as Ne,i as ut,j as ct,k as ft,l as Ue,n as ce,o as ht,r as Ge,q as dt,u as gt,v as yt}from"./hp08qw6yu0x90xkd.js";function mt(e){return e.innerRadius}function pt(e){return e.outerRadius}function Et(e){return e.startAngle}function Tt(e){return e.endAngle}function vt(e){return e&&e.padAngle}function wt(e,t,o,n,i,a,c,r){var s=o-e,l=n-t,u=c-i,g=r-a,h=g*s-u*l;if(!(h*h<k))return h=(u*(t-a)-g*(e-i))/h,[e+h*s,t+h*l]}function re(e,t,o,n,i,a,c){var r=e-o,s=t-n,l=(c?a:-a)/K(r*r+s*s),u=l*s,g=-l*r,h=e+u,f=t+g,d=o+u,m=n+g,y=(h+d)/2,p=(f+m)/2,T=d-h,w=m-f,b=T*T+w*w,S=i-a,R=h*m-d*f,_=(w<0?-1:1)*K(ut(0,S*S*b-R*R)),P=(R*w-T*_)/b,H=(-R*T-w*_)/b,B=(R*w+T*_)/b,M=(-R*T+w*_)/b,L=P-y,E=H-p,v=B-y,Y=M-p;return L*L+E*E>v*v+Y*Y&&(P=B,H=M),{cx:P,cy:H,x01:-u,y01:-g,x11:P*(i/S-1),y11:H*(i/S-1)}}function bt(){var e=mt,t=pt,o=C(0),n=null,i=Et,a=Tt,c=vt,r=null,s=at(l);function l(){var u,g,h=+e.apply(this,arguments),f=+t.apply(this,arguments),d=i.apply(this,arguments)-ke,m=a.apply(this,arguments)-ke,y=He(m-d),p=m>d;if(r||(r=u=s()),f<h&&(g=f,f=h,h=g),!(f>k))r.moveTo(0,0);else if(y>ue-k)r.moveTo(f*q(d),f*O(d)),r.arc(0,0,f,d,m,!p),h>k&&(r.moveTo(h*q(m),h*O(m)),r.arc(0,0,h,m,d,p));else{var T=d,w=m,b=d,S=m,R=y,_=y,P=c.apply(this,arguments)/2,H=P>k&&(n?+n.apply(this,arguments):K(h*h+f*f)),B=Te(He(f-h)/2,+o.apply(this,arguments)),M=B,L=B,E,v;if(H>k){var Y=Ne(H/h*O(P)),j=Ne(H/f*O(P));(R-=Y*2)>k?(Y*=p?1:-1,b+=Y,S-=Y):(R=0,b=S=(d+m)/2),(_-=j*2)>k?(j*=p?1:-1,T+=j,w-=j):(_=0,T=w=(d+m)/2)}var N=f*q(T),D=f*O(T),$=h*q(S),W=h*O(S);if(B>k){var X=f*q(w),ie=f*O(w),fe=h*q(b),he=h*O(b),z;if(y<Le)if(z=wt(N,D,fe,he,X,ie,$,W)){var de=N-z[0],ge=D-z[1],ye=X-z[0],me=ie-z[1],Pe=1/O(ct((de*ye+ge*me)/(K(de*de+ge*ge)*K(ye*ye+me*me)))/2),Me=K(z[0]*z[0]+z[1]*z[1]);M=Te(B,(h-Me)/(Pe-1)),L=Te(B,(f-Me)/(Pe+1))}else M=L=0}_>k?L>k?(E=re(fe,he,N,D,f,L,p),v=re(X,ie,$,W,f,L,p),r.moveTo(E.cx+E.x01,E.cy+E.y01),L<B?r.arc(E.cx,E.cy,L,I(E.y01,E.x01),I(v.y01,v.x01),!p):(r.arc(E.cx,E.cy,L,I(E.y01,E.x01),I(E.y11,E.x11),!p),r.arc(0,0,f,I(E.cy+E.y11,E.cx+E.x11),I(v.cy+v.y11,v.cx+v.x11),!p),r.arc(v.cx,v.cy,L,I(v.y11,v.x11),I(v.y01,v.x01),!p))):(r.moveTo(N,D),r.arc(0,0,f,T,w,!p)):r.moveTo(N,D),!(h>k)||!(R>k)?r.lineTo($,W):M>k?(E=re($,W,X,ie,h,-M,p),v=re(N,D,fe,he,h,-M,p),r.lineTo(E.cx+E.x01,E.cy+E.y01),M<B?r.arc(E.cx,E.cy,M,I(E.y01,E.x01),I(v.y01,v.x01),!p):(r.arc(E.cx,E.cy,M,I(E.y01,E.x01),I(E.y11,E.x11),!p),r.arc(0,0,h,I(E.cy+E.y11,E.cx+E.x11),I(v.cy+v.y11,v.cx+v.x11),p),r.arc(v.cx,v.cy,M,I(v.y11,v.x11),I(v.y01,v.x01),!p))):r.arc(0,0,h,S,b,p)}if(r.closePath(),u)return r=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,g=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Le/2;return[q(g)*u,O(g)*u]},l.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:C(+u),l):e},l.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:C(+u),l):t},l.cornerRadius=function(u){return arguments.length?(o=typeof u=="function"?u:C(+u),l):o},l.padRadius=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:C(+u),l):n},l.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:C(+u),l):i},l.endAngle=function(u){return arguments.length?(a=typeof u=="function"?u:C(+u),l):a},l.padAngle=function(u){return arguments.length?(c=typeof u=="function"?u:C(+u),l):c},l.context=function(u){return arguments.length?(r=u??null,l):r},l}function St(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function At(e){return e}function Rt(){var e=At,t=St,o=null,n=C(0),i=C(ue),a=C(0);function c(r){var s,l=(r=ft(r)).length,u,g,h=0,f=new Array(l),d=new Array(l),m=+n.apply(this,arguments),y=Math.min(ue,Math.max(-ue,i.apply(this,arguments)-m)),p,T=Math.min(Math.abs(y)/l,a.apply(this,arguments)),w=T*(y<0?-1:1),b;for(s=0;s<l;++s)(b=d[f[s]=s]=+e(r[s],s,r))>0&&(h+=b);for(t!=null?f.sort(function(S,R){return t(d[S],d[R])}):o!=null&&f.sort(function(S,R){return o(r[S],r[R])}),s=0,g=h?(y-l*w)/h:0;s<l;++s,m=p)u=f[s],b=d[u],p=m+(b>0?b*g:0)+w,d[u]={data:r[u],index:s,value:b,startAngle:m,endAngle:p,padAngle:T};return d}return c.value=function(r){return arguments.length?(e=typeof r=="function"?r:C(+r),c):e},c.sortValues=function(r){return arguments.length?(t=r,o=null,c):t},c.sort=function(r){return arguments.length?(o=r,t=null,c):o},c.startAngle=function(r){return arguments.length?(n=typeof r=="function"?r:C(+r),c):n},c.endAngle=function(r){return arguments.length?(i=typeof r=="function"?r:C(+r),c):i},c.padAngle=function(r){return arguments.length?(a=typeof r=="function"?r:C(+r),c):a},c}function je(e,t){let o,n;for(const i of e)i!=null&&(o===void 0?i>=i&&(o=n=i):(o>i&&(o=i),n<i&&(n=i)));return[o,n]}function xt(e,t){let o=0;for(let n of e)(n=+n)&&(o+=n);return o}var ve,Be;function Pt(){if(Be)return ve;Be=1;var e=st(),t=lt(),o=t(function(n,i,a,c){e(n,i,a,c)});return ve=o,ve}var Mt=Pt();const It=tt(Mt);function Ct(e){switch(e){case"title":case"ctrTitle":return"titleStyle";case"body":case void 0:case"obj":case"content":case"subTitle":case"":return"bodyStyle";default:return"otherStyle"}}const A=1/9525;function _t(e){return e.xEmu!==0||e.yEmu!==0||e.widthEmu!==0||e.heightEmu!==0}const Xe=(e,...t)=>It({},e,...t,(o,n)=>o||n);function Lt(e,t,o){const i=Ct(e.placeholderType),a=o.useLayoutId,c=t.layouts.find(d=>d.id===a),r=e.placeholderIndex??0,s=e.textStyle??{anchor:ae.ANCHOR_TYPE_UNSPECIFIED,vertical:nt.VERTICAL_TYPE_UNSPECIFIED,bold:!1,italic:!1,color:void 0,fontSize:1350,fill:void 0,alignment:Re.ALIGNMENT_TYPE_UNSPECIFIED,underline:"none",bottomInset:0,leftInset:0,rightInset:0,topInset:0},l=e.levelsStyles[0]?.textStyle;let u,g,h;const f=c?.elements.find(d=>d.placeholderType===e.placeholderType&&(d.placeholderIndex??0)===r);if(f?.textStyle&&(u=f.textStyle),f?.levelsStyles){const m=f.levelsStyles[0];m&&(g=m.textStyle)}if(c?.parentLayoutId!==a){const d=t.layouts.find(m=>m.type==="master");if(i==="titleStyle"&&d?.titleLevelStyles){const y=d.titleLevelStyles[0];y&&(h=y.textStyle)}else if(i==="bodyStyle"&&d?.bodyLevelStyles){const y=d.bodyLevelStyles[0];y&&(h=y.textStyle)}else if(i==="otherStyle"&&d?.otherLevelStyles){const y=d.otherLevelStyles[0];y&&(h=y.textStyle)}}return Xe(s,l,u,g,h)}function V(e,t,o){return Math.min(Math.max(e,t),o)}function we(e){const t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function be(e){return e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055}function kt(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return{r:o,g:n,b:i}}function Ye(e,t,o){e/=255,t/=255,o/=255;const n=Math.max(e,t,o),i=Math.min(e,t,o);let a=0,c=0;const r=(n+i)/2;if(n!==i){const s=n-i;switch(c=r>.5?s/(2-n-i):s/(n+i),n){case e:a=(t-o)/s+(t<o?6:0);break;case t:a=(o-e)/s+2;break;case o:a=(e-t)/s+4;break}a/=6}return{h:a,s:c,l:r}}function De(e,t,o){let n,i,a;if(t===0)n=i=a=o;else{const c=(l,u,g)=>(g<0&&(g+=1),g>1&&(g-=1),g<.16666666666666666?l+(u-l)*6*g:g<.5?u:g<.6666666666666666?l+(u-l)*(.6666666666666666-g)*6:l),r=o<.5?o*(1+t):o+t-o*t,s=2*o-r;n=c(s,r,e+1/3),i=c(s,r,e),a=c(s,r,e-1/3)}return[Math.round(n*255),Math.round(i*255),Math.round(a*255)]}function Ht(e,t){if(!e)return"rgba(0,0,0,1)";const o=e.type===Ce.COLOR_TYPE_RGB?`#${e.value}`:e.type===Ce.COLOR_TYPE_SCHEME&&t.colorMap[e.value]||"#000000";let{r:n,g:i,b:a}=kt(o),c=1;const r=e.transform;if(r){if(r.alpha&&(c=V(r.alpha/1e5,0,1)),r.satMod){const s=Ye(n,i,a);s.s=V(s.s*(r.satMod/1e5),0,1),[n,i,a]=De(s.h,s.s,s.l)}if(r.lumMod||r.lumOff){const s=Ye(n,i,a);r.lumMod&&(s.l*=r.lumMod/1e5),r.lumOff&&(s.l+=r.lumOff/1e5),s.l=V(s.l,0,1),[n,i,a]=De(s.h,s.s,s.l)}if(r.tint){const s=r.tint/1e5;n=we(n),i=we(i),a=we(a),n=n*s+1*(1-s),i=i*s+1*(1-s),a=a*s+1*(1-s),n=Math.round(be(n)*255),i=Math.round(be(i)*255),a=Math.round(be(a)*255)}r.shade&&(n*=1-r.shade/1e5,i*=1-r.shade/1e5,a*=1-r.shade/1e5)}return n=V(Math.round(n),0,255),i=V(Math.round(i),0,255),a=V(Math.round(a),0,255),`rgba(${n},${i},${a},${c})`}function ee(e,t,o){return e?Ht(e,t)??o??"transparent":o??"transparent"}function Nt(e){for(var t=e.length/6|0,o=new Array(t),n=0;n<t;)o[n]="#"+e.slice(n*6,++n*6);return o}const Bt=Nt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function oe(e,t,o){const n=o.useLayoutId;if(e.bbox&&_t(e.bbox)&&t){const{xEmu:i,yEmu:a,widthEmu:c,heightEmu:r}=e.bbox;return{x:(i??0)*A,y:(a??0)*A,width:(c??0)*A,height:(r??0)*A}}if(e.placeholderIndex!==void 0){const i=e.placeholderIndex??0,a=t.layouts.find(r=>r.id===n),c=a?.elements.find(r=>(r.placeholderIndex??0)===i);if(c?.bbox){const{xEmu:r,yEmu:s,widthEmu:l,heightEmu:u}=c.bbox;return{x:(r??0)*A,y:(s??0)*A,width:(l??0)*A,height:(u??0)*A}}if(a?.parentLayoutId!==n){const s=t.layouts.find(l=>l.type==="master")?.elements.find(l=>(l.placeholderIndex??0)===i);if(s?.bbox){const{xEmu:l,yEmu:u,widthEmu:g,heightEmu:h}=s.bbox;return{x:(l??0)*A,y:(u??0)*A,width:(g??0)*A,height:(h??0)*A}}}}return{x:0,y:0,width:0,height:0}}const se=18,Se=1,Oe=.1*96,$e=.05*96;function qe(e){return e/100*(96/72)}function Ze(e,t,o,n,i,a){if(!e.paragraphs)return;let{x:c,y:r,width:s,height:l}=oe(e,o,i);c+=Oe,r+=$e,s-=Oe*2,l-=$e*2;const u=Lt(e,o,i);function g(y,p,T,w,b,S){p.length!==0&&(y.push({segments:p.slice(),widthPx:T,heightPx:w,align:b,maxPx:S}),p.length=0)}const h=[];for(const y of e.paragraphs){const p=y.textStyle,T=[];let w=0,b="left",S=0;for(const _ of y.runs){const P=Xe({},_.textStyle,p,u),H=P?.fontSize?qe(P.fontSize):se*(96/72),M=`${P?.bold?"bold ":""}${P?.italic?"italic ":""}${H}px Calibri, Carlito, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;t.font=M;const L=ee(P?.fill?.color,n);b=P?.alignment===Re.ALIGNMENT_TYPE_CENTER?"center":P?.alignment===Re.ALIGNMENT_TYPE_RIGHT?"right":"left",S=Math.max(S,H);const E=_.text.split(`
`);for(let v=0;v<E.length;v++){const Y=E[v];if(!Y)continue;const j=Y.split(/\s+/);for(let N=0;N<j.length;N++){const D=j[N];if(!D)continue;let $=D;t.font=M;let W=t.measureText($).width;if(w+W>s&&T.length){const X=S||se*1.3333333333333333;g(h,T,w,X*Se,b,X),w=0,S=0}else T.length&&($=" "+D,W=t.measureText($).width);T.push({text:$,widthPx:W,font:M,fill:L,px:H,run:_}),w+=W,S=Math.max(S,H)}if(v<E.length-1){const N=S||se*1.3333333333333333;g(h,T,w,N*Se,b,N),w=0,S=0}}}const R=S||se*(96/72);g(h,T,w,R*Se,b,R)}if(!h.length)return;const f=u?.anchor??ae.ANCHOR_TYPE_TOP,d=h.reduce((y,p)=>y+p.heightPx,0);let m=f===ae.ANCHOR_TYPE_BOTTOM?r+(l-d):f===ae.ANCHOR_TYPE_MIDDLE?r+(l-d)/2:r;m=Math.max(m,r),t.textBaseline="top";for(const y of h){let p=y.align==="center"?c+(s-y.widthPx)/2:y.align==="right"?c+s-y.widthPx:c;for(const T of y.segments){t.font=T.font,t.fillStyle=T.fill;const w=y.maxPx-T.px;a&&T.run?.hyperlink?.uri&&a.push({x:p,y:m+(y.maxPx-T.px),width:T.widthPx,height:T.px,url:T.run.hyperlink.uri}),t.fillText(T.text,p,m+w),p+=T.widthPx}m+=y.heightPx}}function Ve(e,t,o){if(e.measureText(t).width<=o)return t;const n="…";let i=0,a=t.length;for(;i<a;){const c=Math.ceil((i+a)/2);e.measureText(t.slice(0,c)+n).width<=o?i=c:a=c-1}return t.slice(0,i)+n}const G="Segoe UI, Helvetica, Arial, sans-serif",Ke=10,Yt=11,U=10,te="#666",We=Bt,Je=.6,Z={top:32,right:16,bottom:40,left:48},ze=16,Dt=ht({decimal:".",thousands:",",grouping:[3],currency:["","$"],percent:" %"});function Ot(e,t,o,n){const i=oe(e,o,n),a=qt(e.chartReference,o);a&&Qe(t,a,i)}function hn(e,t,o,n={}){Qe(e,t,o,n)}function $t(e){return{x:e.x+Z.left,y:e.y+Z.top,width:e.width-Z.left-Z.right,height:e.height-Z.top-Z.bottom}}function Qe(e,t,o,n={}){e.save(),t.title&&t.title.trim()&&(e.font=`bold ${ze}px ${G}`,e.fillStyle=te,e.textAlign="center",e.textBaseline="top",e.fillText(t.title.trim(),o.x+o.width/2,o.y+(Z.top-ze)/2));let i=$t(o);if((t.type===x.CHART_TYPE_BAR||t.type===x.CHART_TYPE_BAR_3D)&&t.barDirection===ot.BAR_DIRECTION_BAR){const r=t.categories.length>0?t.categories:t.series[0]?.categories??[];i=Jt(e,i,r,t.yAxis);const s=Zt(t,i);Kt(e,t,s,i),n.skipLegend||Fe(e,t,o),Vt(e,t,s),e.restore();return}const c=Wt(t,i);switch(zt(t.type)||Ft(e,t,c,i),n.skipLegend||Fe(e,t,o),t.type){case x.CHART_TYPE_BAR:case x.CHART_TYPE_BAR_3D:Ut(e,t,c);break;case x.CHART_TYPE_LINE:case x.CHART_TYPE_LINE_3D:Gt(e,t,c);break;case x.CHART_TYPE_AREA:case x.CHART_TYPE_AREA_3D:jt(e,t,c);break;case x.CHART_TYPE_PIE:case x.CHART_TYPE_PIE_3D:case x.CHART_TYPE_DOUGHNUT:Xt(e,t,i);break}e.restore()}function xe(e){return typeof e.bandwidth=="function"}function Wt(e,t){const o=e.categories.length>0?e.categories:e.series[0]?.categories??[],n=e.series.flatMap(l=>l.values),i=je(n),[a,c]=i[0]===void 0?[0,0]:i,r=e.type===x.CHART_TYPE_LINE||e.type===x.CHART_TYPE_LINE_3D?dt().domain(o).range([t.x,t.x+t.width]).padding(.5):ce().domain(o).range([t.x,t.x+t.width]).paddingInner(Je),s=Ue().domain([Math.min(0,a),c]).nice().range([t.y+t.height,t.y]);return{x:r,y:s}}function J(e,t){if(t!==void 0){if(xe(e)){const o=e(t);return o!==void 0?o+e.bandwidth()/2:void 0}return e(t)}}function zt(e){return e===x.CHART_TYPE_PIE||e===x.CHART_TYPE_PIE_3D||e===x.CHART_TYPE_DOUGHNUT}function Ft(e,t,o,n){const{x:i,y:a}=o,c=t.categories.length>0?t.categories:t.series[0]?.categories??[];e.save(),e.font=`${Ke}px ${G}`,e.fillStyle=te,e.strokeStyle=te,e.lineWidth=1;const{color:r,fontSize:s}=ne(t.xAxis),l=a(0);e.beginPath(),e.moveTo(n.x,l),e.lineTo(n.x+n.width,l),e.stroke(),e.strokeStyle=r,e.lineWidth=1,e.font=`${s}px ${G}`,e.textAlign="center",e.textBaseline="top",e.fillStyle=r,c.forEach(h=>{const f=J(i,h);if(f===void 0)return;e.beginPath(),e.moveTo(f,l),e.lineTo(f,l+4),e.stroke();const d=xe(i)?i.step():n.width/Math.max(1,c.length);e.fillText(Ve(e,h,d),f,l+6)});const{color:u,fontSize:g}=ne(t.yAxis);e.textAlign="right",e.textBaseline="middle",e.fillStyle=u,a.ticks(5).forEach(h=>{const f=a(h);e.strokeStyle=u,e.beginPath(),e.moveTo(n.x,f),e.lineTo(n.x+n.width,f),e.stroke(),e.strokeStyle=u,e.beginPath(),e.moveTo(n.x-4,f),e.lineTo(n.x,f),e.stroke(),e.font=`${g}px ${G}`,e.fillText(gt("~s")(h),n.x-6,f)}),e.restore()}function Fe(e,t,o){if(t.series.length===0)return;e.save(),e.font=`${Yt}px ${G}`;const n=t.series.map(u=>u.name||"Series"),i=n.map(u=>e.measureText(u).width),a=Math.max(...i,0),c=U+6+a+16,r=n.length*(U+4)+16-4,s=o.x+o.width-c,l=o.y+8;e.fillStyle="transparent",e.strokeStyle="transparent",e.lineWidth=1,e.beginPath(),e.rect(s,l,c,r),e.fill(),e.stroke(),t.series.forEach((u,g)=>{const h=u.name||"Series",f=l+8+g*(U+4)+U/2,d=Q(u,g);d&&(e.fillStyle=d),e.beginPath(),e.rect(s+8,f-U/2,U,U),e.fill(),e.strokeStyle="#000",e.stroke(),e.fillStyle=te,e.textAlign="left",e.textBaseline="middle",e.fillText(h,s+8+U+6,f)}),e.restore()}function Q(e,t){return e.fill?.color?.value?`#${e.fill.color.value}`:We[t%We.length]}function ne(e){const t=e?.line?.fill?.color?.value?`#${e.line.fill.color.value}`:te,o=e?.textStyle?.fontSize?qe(e.textStyle.fontSize):Ke;return{color:t,fontSize:o}}function Ut(e,t,o){if(!xe(o.x))return;const n=o.x,i=o.y,a=t.categories.length>0?t.categories:t.series[0]?.categories??[],c=t.series.length,r=ce().domain(Ge(c)).range([0,n.bandwidth()]).padding(.05);a.forEach((s,l)=>{const u=n(s);u!==void 0&&t.series.forEach((g,h)=>{const f=g.values[l]??0,d=u+(r(h)??0),m=i(Math.max(0,f)),y=Math.abs(i(f)-i(0)),p=Q(g,h);p&&(e.fillStyle=p),e.beginPath(),e.rect(d,m,r.bandwidth(),y),e.fill()})})}function Gt(e,t,o){const n=o.x,i=o.y,a=t.categories.length>0?t.categories:t.series[0]?.categories??[];t.series.forEach((c,r)=>{const s=Q(c,r);s&&(e.strokeStyle=s),e.lineWidth=2,e.beginPath(),c.values.forEach((l,u)=>{const g=J(n,a[u]),h=i(l);g!==void 0&&(u===0?e.moveTo(g,h):e.lineTo(g,h))}),e.stroke(),e.fillStyle=e.strokeStyle,c.values.forEach((l,u)=>{const g=J(n,a[u]),h=i(l);g!==void 0&&(e.beginPath(),e.arc(g,h,3,0,Math.PI*2),e.fill())})})}function jt(e,t,o){const n=o.x,i=o.y,a=t.categories.length>0?t.categories:t.series[0]?.categories??[];t.series.forEach((c,r)=>{const s=Q(c,r),l=(()=>{if(!s)return;const h=yt(s);return h?(h.opacity=.35,h.formatRgb()):s})();l&&(e.fillStyle=l),s&&(e.strokeStyle=s),e.lineWidth=1,e.beginPath(),c.values.forEach((h,f)=>{const d=J(n,a[f]),m=i(h);d!==void 0&&(f===0?e.moveTo(d,m):e.lineTo(d,m))});const u=J(n,a[a.length-1]),g=J(n,a[0]);u===void 0||g===void 0||(e.lineTo(u,i(0)),e.lineTo(g,i(0)),e.closePath(),e.fill(),e.stroke())})}function Xt(e,t,o){const n=t.series[0];if(!n)return;const i=n.values;if(xt(i)===0)return;const c=o.x+o.width/2,r=o.y+o.height/2,s=Math.min(o.width,o.height)/2,l=bt().innerRadius(t.type===x.CHART_TYPE_DOUGHNUT?s*.55:0).outerRadius(s).context(e),u=Rt().sort(null);e.save(),e.translate(c,r),u(i).forEach((g,h)=>{const f=Q(n,h);f&&(e.fillStyle=f),e.beginPath(),l(g),e.fill(),e.strokeStyle="#fff",e.lineWidth=1,e.stroke()}),e.restore()}function qt(e,t){const o=e?.id;return o?t.charts.find(n=>n.id===o)??null:null}function Zt(e,t){const o=e.categories.length>0?e.categories:e.series[0]?.categories??[],[n,i]=je(e.series.flatMap(g=>g.values)),a=e.yAxis?.min,c=e.yAxis?.max,r=a!==void 0?a:Math.min(0,n),s=c!==void 0?c:i,l=Ue().domain([r,s]).range([t.x,t.x+t.width]);(a===void 0||c===void 0)&&l.nice();const u=ce().domain([...o].reverse()).range([t.y,t.y+t.height]).paddingInner(Je);return{x:l,y:u}}function Vt(e,t,o){const{x:n,y:i}=o,[a,c]=n.domain(),r=a&&a>0?a:c&&c<0?c:0,s=t.categories.length?t.categories:t.series[0]?.categories??[],l=t.series.length,u=ce().domain(Ge(l)).range([0,i.bandwidth()]).padding(.05);s.forEach((g,h)=>{const f=i(g);f!==void 0&&t.series.forEach((d,m)=>{const y=d.values[h]??0,p=f+(u(m)??0),T=n(Math.min(r,y)),w=n(Math.max(r,y)),b=Math.abs(w-T),S=Q(d,m);S&&(e.fillStyle=S),e.fillRect(T,p,b,u.bandwidth())})})}function Kt(e,t,o,n,i=!0){const{x:a,y:c}=o,r=t.categories.length>0?t.categories:t.series[0]?.categories??[];e.save(),e.lineWidth=1;const{color:s,fontSize:l}=ne(t.yAxis);e.font=`${l}px ${G}`,e.fillStyle=s,e.strokeStyle=s,e.textAlign="right",e.textBaseline="middle";const u=Math.min(140,Math.max(0,n.x-10));r.forEach(m=>{const y=(c(m)??0)+c.bandwidth()/2;e.beginPath(),e.moveTo(n.x-4,y),e.lineTo(n.x,y),e.stroke();const p=Ve(e,m,u);e.fillText(p,n.x-6,y)});const{color:g,fontSize:h}=ne(t.xAxis);e.font=`${h}px ${G}`,e.fillStyle=g,e.strokeStyle=g,e.textAlign="center",e.textBaseline="top";const f=n.y+n.height;e.beginPath(),e.moveTo(n.x,f),e.lineTo(n.x+n.width,f),e.stroke();const d=Dt.format(".2~f");a.ticks(5).forEach(m=>{const y=a(m);e.beginPath(),e.moveTo(y,f),e.lineTo(y,f+4),e.stroke(),i&&(e.save(),e.beginPath(),e.moveTo(y,n.y),e.lineTo(y,f),e.stroke(),e.restore()),e.fillText(d(m),y,f+6)}),e.restore()}function Jt(e,t,o,n,i=180,a=100){const{fontSize:c}=ne(n);e.save(),e.font=`${c}px ${G}`;const r=Math.max(...o.map(u=>e.measureText(u).width));e.restore();const s=Math.min(i,r+a);if(s<=t.x)return t;const l=s-t.x;return{x:t.x+l,y:t.y,width:Math.max(0,t.width-l),height:t.height}}function Qt(e,t,o,n,i){if(!e.table||!e.bbox)return;const a=e.table.columnWidths.reduce((f,d)=>f+d,0),c=e.table.rows.reduce((f,d)=>f+(d.heightEmu>0?d.heightEmu:0),0),r=e.table.rows.filter(f=>f.heightEmu===0).length,s=r>0?Math.max((e.bbox.heightEmu-c)/r,1):0,l=c+r*s;if(a===0||l===0)return;const u=e.bbox.widthEmu/a,g=e.bbox.heightEmu/l;let h=e.bbox.yEmu;for(const f of e.table.rows){const m=(f.heightEmu===0?s:f.heightEmu)*g;let y=e.bbox.xEmu;for(let p=0;p<f.cells.length;p++){const T=f.cells[p],w=e.table.columnWidths[p],b=w?w*u:0,S={bbox:{xEmu:y,yEmu:h,widthEmu:b,heightEmu:m},paragraphs:T?.paragraphs,textStyle:T?.textStyle,levelsStyles:T?.levelsStyles},R=T?.fill,_=R?.color?.value?`#${R.color.value}`:"transparent";t.fillStyle=_,t.fillRect(y*A,h*A,b*A,m*A),Ze(S,t,o,n,i),t.strokeStyle="#cccccc",t.strokeRect(y*A,h*A,b*A,m*A),y+=b}h+=m}}const Ae=new Map;let le=null;function en(e,t,o){if(/\bwidth\s*=|\bheight\s*=/.test(e))return new Blob([e],{type:"image/svg+xml"});const n=e.replace(/<svg\b([^>]*)>/,`<svg$1 width="${t}" height="${o}">`);return new Blob([n],{type:"image/svg+xml"})}async function et(e){if(!e.image)throw new Error("no image on element");const t=`${e.image.data.byteLength}_${e.image.contentType}`,o=Ae.get(t);if(!o)if(e.image.contentType==="image/svg+xml"){const n=Math.round((e.bbox?.widthEmu??1)*A),i=Math.round((e.bbox?.heightEmu??1)*A),a=window.devicePixelRatio||1,c=en(new TextDecoder().decode(e.image.data),n,i),r=URL.createObjectURL(c),s=new Image;s.src=r,await s.decode();const l=createImageBitmap(s,{resizeWidth:n*a,resizeHeight:i*a});return URL.revokeObjectURL(r),Ae.set(t,l),l}else{const n=new Blob([e.image.data],{type:e.image.contentType}),i=createImageBitmap(n);return Ae.set(t,i),i}return o}async function tn(e,t,o,n){if(!e.image)return;const{x:i,y:a,width:c,height:r}=oe(e,o,n),s=await et(e);if(!s)return;let l=0,u=0,g=s.width,h=s.height;const f=e.image.mask;if(f){const d=p=>p/1e5,m=s.width,y=s.height;l+=d(f.cropLeft)*m,u+=d(f.cropTop)*y,g-=(d(f.cropLeft)+d(f.cropRight))*m,h-=(d(f.cropTop)+d(f.cropBottom))*y}t.drawImage(s,l,u,g,h,i,a,c,r)}function nn(e){if(le)return le;if(!e)return{colorMap:{},lineStyleMap:{},effectMap:{}};const t={};if(e.colorScheme){for(const i of e.colorScheme.colors)i.color&&(t[i.name]=i.color.lastColor?`#${i.color.lastColor}`:`#${i.color.value}`);t.lt1&&(t.bg1=t.lt1),t.lt2&&(t.bg2=t.lt2)}const o={};for(const[i,a]of e.lineStyleList.entries())o[i+1]=a;const n={};for(const[i,a]of e.effectStyleList.entries())n[i+1]=a;return le={colorMap:t,lineStyleMap:o,effectMap:n},le}function on(e,t,o){let n=e.background;if(n?.fill?.color)return ee(n.fill.color,o);if(n||(n=t.layouts.find(i=>i.id===e.useLayoutId)?.background),n?.ref?.index){const i=n.ref.index-1001,c=t.theme?.backgroundFillStyleList[i]?.color;if(c){const r={...c,value:n.ref.schemeColor};return ee(r,o)}}return o.colorMap.bg1}async function rn(e,t,o,n){const i=nn(t.theme),a=e.widthEmu*A,c=e.heightEmu*A;o.save();const r=on(e,t,i);o.fillStyle=r??"transparent",o.fillRect(0,0,a,c);const s=[...e.elements].sort((l,u)=>l.zIndex-u.zIndex);await Promise.all(s.filter(l=>l.image).map(l=>et(l)));for(const l of s)if(l.image&&await tn(l,o,t,e),l.type===_e.ELEMENT_TYPE_CHART_REFERENCE&&Ot(l,o,t,e),l.type===_e.ELEMENT_TYPE_TABLE&&Qt(l,o,t,i,e),l.shape&&sn(l,o,t,e,i),l.paragraphs&&l.paragraphs.length>0&&Ze(l,o,t,i,e,n),n&&l.hyperlink){const{x:u,y:g,width:h,height:f}=oe(l,t,e);n.push({x:u,y:g,width:h,height:f,url:l.hyperlink.uri,action:l.hyperlink.action})}o.restore()}function sn(e,t,o,n,i){if(!e.shape)return;const{fill:a,line:c,geometry:r}=e.shape,{x:s,y:l,width:u,height:g}=oe(e,o,n);let h=c?.widthEmu?c.widthEmu*A:0;if(t.save(),t.fillStyle=ee(a?.color,i)??"transparent",e.lineReference){const f=i.lineStyleMap[e.lineReference.index];t.strokeStyle="solid",h||=f?.widthEmu?f.widthEmu*A:h}switch(e.effectReference&&i.effectMap[e.effectReference.index]?.effects.forEach(d=>{if(d.type===it.EFFECT_TYPE_OUTER_SHADOW){const m=d.shadow?.color?ee(d.shadow.color,i):"transparent";t.shadowColor=m??"transparent",t.shadowBlur=d.shadow?.blurRadius?d.shadow.blurRadius*A:0,t.shadowOffsetX=d.shadow?.distance?d.shadow.distance*A:0,t.shadowOffsetY=d.shadow?.distance?d.shadow.distance*A:0}}),t.beginPath(),r){case pe.SHAPE_GEOMETRY_RECT:case pe.SHAPE_GEOMETRY_ROUND_RECT:{g===0?(t.moveTo(s,l),t.lineTo(s+u,l)):u===0?(t.moveTo(s,l),t.lineTo(s,l+g)):t.rect(s,l,u,g);break}case pe.SHAPE_GEOMETRY_ELLIPSE:{const f=u/2,d=g/2;t.ellipse(s+f,l+d,f,d,0,0,Math.PI*2);break}default:t.restore();return}t.fill(),t.restore(),t.strokeStyle=h&&c?.fill?.color?.value?`#${c.fill.color.value}`:"transparent",t.lineWidth=h,h&&t.stroke(),t.restore()}function dn({startIndex:e,walnutId:t,onExit:o}){const{presentationMap:n}=rt(),i=n[t],{presentation:a}=i,[c,r]=F.useState(e),s=F.useRef(null),l=F.useRef(null);F.useEffect(()=>{const d=l.current;if(!d)return;d.requestFullscreen?.().catch(y=>{Ee.addError(y)});const m=()=>{document.fullscreenElement||o()};return document.addEventListener("fullscreenchange",m),()=>{document.removeEventListener("fullscreenchange",m),document.fullscreenElement&&document.exitFullscreen().catch(y=>{Ee.addError(y)})}},[o]);const u=a?a.slides[c]:void 0;F.useEffect(()=>{if(!a||!u||!s.current)return;const d=s.current.getContext("2d");if(!d)return;const m=u.widthEmu*A,y=u.heightEmu*A,p=window.devicePixelRatio||1;s.current.width=m*p,s.current.height=y*p,d.resetTransform(),d.scale(p,p),rn(u,a,d)},[u,a]);const g=F.useCallback(()=>{a&&r(d=>Math.min(d+1,a.slides.length-1))},[a]),h=F.useCallback(()=>r(d=>Math.max(d-1,0)),[]),f=F.useCallback(d=>{switch(d.key){case"ArrowRight":case"ArrowDown":case" ":case"Enter":g();break;case"ArrowLeft":case"ArrowUp":h();break;case"Escape":document.fullscreenElement?document.exitFullscreen().catch(m=>{Ee.addError(m)}):o();break}},[g,h,o]);return F.useEffect(()=>(window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)),[f]),Ie.jsx("div",{ref:l,className:"fixed inset-0 flex items-center justify-center p-6",onClick:g,children:Ie.jsx("canvas",{ref:s,className:"max-h-full max-w-full bg-white"})})}export{A as E,dn as S,hn as a,Nt as c,rn as d,oe as g};
//# sourceMappingURL=g43t6mvc4wvemyu6.js.map

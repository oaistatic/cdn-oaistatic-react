import{j as e,f as S,M as w,g as ne,r as C,m as _}from"./m60bpb0x3x7rg8fj.js";import{m as z,i as oe,d as le,b as de,T as re}from"./cum2m9ppsxjdt1u5.js";import{kc as ce,dm as ie,da as G,fw as me,eX as V,jM as xe,lP as fe,c as ue,dh as Y,dl as he,lQ as pe,lR as be,lS as ge,N as je}from"./ggjzadbnd3k1vu0k.js";import{u as ve,c as ye,D as ke}from"./5a6x9gba3iwtvxlr.js";import{_ as Z,z as j,cd as v,cs as k,B as J,qw as Ne,eE as Me,cO as Ce,ld as K,dK as we}from"./lgw4q0e8zlqqfgug.js";import{S as Se}from"./bpw2xzqmlm1jo09m.js";import{t as Ee}from"./fna9z31n721lpf9f.js";import{C as Q,T as Te}from"./ib61luj52j5qoibx.js";import{g as Be}from"./btagl6w1gub4aw61.js";import"./ns51nblw8ziscsgd.js";import"./jy1u8exw8iz2slve.js";import"./9q3v44p2xpoi75pn.js";import"./g61ghrdmm0y010eo.js";import"./kfjcy5y4cxuymbdf.js";import"./imrl18sy28ygoppx.js";import"./kh89q49991ykwivd.js";import"./kl7c6054usfnqmd4.js";import"./mia7qmdupqoji40k.js";import"./cqdszxwxh9yigbop.js";function De({textdocVersion:l,clientThreadId:n}){const{handleCopy:d,copyLabel:m}=ve({textdocVersion:l,clientThreadId:n}),r=!Z();return e.jsx(ce,{onCopy:d,className:"px-1.5 py-1",iconClassName:j("icon-md",!r&&"hidden"),iconOnly:r,buttonText:r?void 0:m})}function Le({textdocVersion:l,isDisabled:n=!1}){const d=S(),{handleFileDownload:m,handleBlobDownload:r,isLoading:h,downloadCopyLabel:f,isDocument:a}=ye(l);return n||=h||!l||l.type===ie.LOADING,a?e.jsxs(v.Root,{open:!h&&!n?void 0:!1,children:[e.jsx(v.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:f,children:e.jsx(G,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{align:"end",children:[e.jsx(v.Item,{onClick:t=>{t.preventDefault(),m("pdf")},children:d.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(v.Item,{onClick:t=>{t.preventDefault(),m("docx")},children:d.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(v.Item,{onClick:t=>{t.preventDefault(),m("md")},children:d.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:f,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:r,children:e.jsx(G,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:r,children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function Ae({onClick:l}){const n=S();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:l,children:[e.jsx(k,{label:e.jsx(w,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(me,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Re({onClick:l,disabled:n,isCodePreviewable:d}){const r=S().formatMessage(d?z.previewCode:z.runCode);return n?e.jsx(J,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(k,{label:e.jsx(w,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(V,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:r})]})}):e.jsxs(J,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:l,disabled:!1,children:[e.jsx(k,{label:e.jsx(w,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(V,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:r})]})}var L,X;function Fe(){if(X)return L;X=1;var l=fe(),n=xe(),d=Ne(),m=parseFloat,r=Math.min,h=Math.random;function f(a,t,c){if(c&&typeof c!="boolean"&&n(a,t,c)&&(t=c=void 0),c===void 0&&(typeof t=="boolean"?(c=t,t=void 0):typeof a=="boolean"&&(c=a,a=void 0)),a===void 0&&t===void 0?(a=0,t=1):(a=d(a),t===void 0?(t=a,a=0):t=d(t)),a>t){var s=a;a=t,t=s}if(c||a%1||t%1){var u=h();return r(a+u*(t-a+m("1e-"+((u+"").length-1))),t)}return l(a,t)}return L=f,L}var He=Fe();const We=ne(He),qe=({isCanvasHovered:l=!1,onClick:n})=>{const d=S();return e.jsx(k,{label:d.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(je,{color:l?"primary":"secondary",icon:Se,onClick:n})})},_e=({textdocId:l,clientThreadId:n,name:d,tag:m,icon:r,iconSelected:h,marginBottom:f,size:a="large",height:t=a==="large"?"22rem":"10rem",minHeight:c,isCanvasOpen:s=!1,isDisabled:u=!1,isFocused:p=!1,isInferring:E=!1,isInlinePreview:o=!1,isStreaming:b=!1,isUserMessage:g=!1,onClick:N,onPreview:T,children:B})=>{const D=C.useRef(null),[y,A]=C.useState(!1),[$]=C.useState(()=>We(100,180,!1)),R=ue(l),U=Me(n),x=Ce(R?.versions),i=Y(),M=!i,I=R==null&&U===void 0,P=x==null||b,F=!!x&&oe(x.type,x.content),O=!!x&&le(x.type),ee=F||O,H=p&&s?h??r:r,te=H?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!p&&!y}),children:H}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(K,{lines:1,size:"base",width:100,widthVariance:0})}),W=x?.type&&he(x.type)?de(x.type):void 0,q=!d||E?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:$},children:e.jsx(K,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":i}),children:d}),i&&W&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",W]})]}),ae=()=>{!D.current||u||(pe.logButtonClick(be.MESSAGE_ATTACHMENT,{type:m}),ge(D.current),N?.())},se=Z();return e.jsxs(_.div,{role:M?"button":void 0,id:Be(l),initial:{opacity:b?0:1,scale:b?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:i?0:.72},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",i?"overflow-visible":"overflow-hidden",u?"cursor-default":M?"cursor-pointer":"cursor-text",{"select-none":M,"border-token-text-tertiary font-medium dark:border-gray-600":p&&s,"font-regular":!p,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!o,"rounded-3xl":!s&&o,"max-w-full":!g&&(s||!o),"max-w-[var(--user-chat-width,70%)]":g&&(s||!o),[se?"w-full":`${Ee.tableContainer} rounded-none`]:!g&&!s&&o,"w-[var(--user-chat-width,70%)]":g&&!s&&o,"w-full pt-1 pb-3 sm:max-w-none":o&&i}),onMouseEnter:()=>!u&&A(!0),onMouseLeave:()=>A(!1),onClick:()=>M?ae():void 0,ref:D,style:{marginBottom:f,height:o&&!s?t:void 0,minHeight:o&&!s?c:void 0,width:a==="small"?"300px":void 0},children:[!(i&&o)&&e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!y&&!p,"border-token-border-heavy":y&&!p,"text-token-text-primary text-sm font-medium":!s&&y&&o,"py-2":s||!o,"py-3":!i&&!s&&o,"text-token-text-secondary text-sm font-medium":!s&&!y&&o,"pt-0 pb-2 sm:px-6":i}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":s||!o,"gap-3.5":!s&&o}),children:[!i&&te,q]}),s?e.jsx(_.span,{animate:b?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:b&&e.jsx(re,{gap:1,padding:0})}):e.jsx(qe,{isCanvasHovered:y,onClick:N})]}),i&&o&&!u?e.jsx("div",{className:"thread-xl:-top-[var(--header-height)] sticky top-0 z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:j("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:q}),e.jsx("div",{className:"flex items-center justify-end",children:I&&!s?e.jsxs("span",{className:"bg-token-surface-tertiary/40 text-token-text-tertiary inline-flex items-center px-2.5 py-0.5 text-xs font-normal",children:[e.jsx(we,{className:"me-1 h-3 w-3 shrink-0"}),e.jsx(w,{id:"m8Uz8Y",defaultMessage:"Canvas is not supported in shared conversations"})]}):i&&!s?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(De,{textdocVersion:x??null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ae,{onClick:N})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Le,{isDisabled:P,textdocVersion:x??null})}),ee&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Re,{isCodePreviewable:F,disabled:b,onClick:T})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&B,o&&!s&&!i&&e.jsx(Q,{size:a,position:"bottom"}),o&&a==="small"&&!s&&!i&&e.jsx(Q,{size:a,position:"right"})]})]})},ot=({textdocId:l,clientThreadId:n,name:d,tag:m,icon:r,iconSelected:h,isCanvasOpen:f=!1,isFetching:a=!1,isFocused:t=!1,isInlinePreview:c=!1,isStreaming:s=!1,isUserMessage:u=!1,onClick:p,onPreview:E})=>{const[o,b]=C.useState(!1),g=Y(),N=B=>{b(B>0)},T=c&&!f?16:12;return e.jsx(_e,{textdocId:l,name:d,tag:m,icon:r,height:g?"auto":void 0,iconSelected:h,marginBottom:T,isCanvasOpen:f,isFocused:t,isInlinePreview:c,isStreaming:s,isUserMessage:u,onClick:p,onPreview:E,clientThreadId:n,children:c&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":o,"border-transparent":!o}),children:a&&!(g&&s)?e.jsx(ke,{numLines:20}):!!l&&e.jsx(Te,{disableScroll:g,onScroll:N,textdocId:l,clientThreadId:n})})})};export{ot as CanvasMessageAttachment,_e as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=ohsrg49ceoqe70po.js.map

import{j as e,r as l,M as m,n as w,a as S}from"./m60bpb0x3x7rg8fj.js";import{b2 as _,dN as k,cd as h,dO as y,S as A,z as x,dL as M,ho as J}from"./lgw4q0e8zlqqfgug.js";import{aT as j,lB as E,lC as u,i8 as D,lD as I,lE as R,lF as F,bw as P,lG as T,cl as L,cm as H,cn as q,bz as z,cq as B,ik as V,fH as O,fI as Z,j_ as G}from"./ggjzadbnd3k1vu0k.js";function K({automation:s,updateForceShowActions:t,onClickEdit:n,onClickDelete:o}){return s.next_run_times.length===0?e.jsx(Q,{onClickDelete:o}):e.jsx(U,{automation:s,updateForceShowActions:t,onClickEdit:n,onClickDelete:o})}function Q({onClickDelete:s}){return e.jsx("div",{children:e.jsx(v,{onClick:s,children:e.jsx(j,{className:"icon"})})})}function U({automation:s,updateForceShowActions:t,onClickEdit:n,onClickDelete:o}){const r=_(),[a,i]=l.useState(s.is_enabled);l.useEffect(()=>i(s.is_enabled),[s.is_enabled]);const{mutate:d}=E({automation_id:s.id,onError:c=>{r.danger(c?u.messages.enableFailure:u.messages.pauseFailure,{toastId:"toggle_automation_status"}),i(!c)}});return e.jsxs("div",{className:"flex",children:[e.jsx(v,{onClick:n,children:e.jsx(D,{className:"icon"})}),e.jsxs(k,{size:"auto",contentAlign:"end",sideOffset:4,triggerButton:e.jsx("button",{className:"hover:bg-token-main-surface-secondary rounded-md p-2",children:e.jsx(y,{className:"icon"})}),onOpenChange:c=>{t(c)},children:[e.jsx(h.Item,{label:a?e.jsx(m,{...u.messages.pause}):e.jsx(m,{...u.messages.resume}),icon:a?e.jsx(I,{className:"icon"}):e.jsx(R,{className:"icon"}),onClick:()=>{i(!a),d({is_enabled:!a})}}),e.jsx(h.Item,{color:"danger",label:e.jsx(m,{...u.messages.delete}),icon:e.jsx(j,{className:"icon"}),onClick:o})]})]})}function v({children:s,...t}){return e.jsx("button",{className:"hover:bg-token-main-surface-secondary rounded-md p-2",...t,children:s})}function W({automation:s}){return s.next_run_times.length===0?s.last_run_time?e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(F,{dateString:s.last_run_time})}):null:s.schedule_components?e.jsx(X,{automation:s}):null}function X({automation:s}){return e.jsxs("div",{className:"text-token-text-secondary flex items-center gap-1 text-sm",children:[Y(s)&&e.jsx(P,{className:"icon-sm"}),e.jsx(T,{item:s,useShortForm:!0})]})}function Y(s){return s.schedule_components?.frequency!=="once"}const $=s=>l.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...s},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 2.08496C14.3713 2.08496 17.915 5.62867 17.915 10C17.915 14.3713 14.3713 17.915 10 17.915C5.62867 17.915 2.08496 14.3713 2.08496 10C2.08496 5.62867 5.62867 2.08496 10 2.08496ZM7.91699 7.29199C7.57181 7.29199 7.29199 7.57181 7.29199 7.91699V12.083C7.29199 12.4282 7.57181 12.708 7.91699 12.708H8.75C9.09518 12.708 9.375 12.4282 9.375 12.083V7.91699C9.375 7.57181 9.09518 7.29199 8.75 7.29199H7.91699ZM11.25 7.29199C10.9049 7.29204 10.625 7.57184 10.625 7.91699V12.083C10.625 12.4282 10.9049 12.708 11.25 12.708H12.083C12.4282 12.708 12.708 12.4282 12.708 12.083V7.91699C12.708 7.57181 12.4282 7.29199 12.083 7.29199H11.25Z"}));function ee({filter:s}){const{isLoading:t,isFetchingNextPage:n,hasNextPage:o,fetchNextPage:r}=w({queryKey:["automations",s],queryFn:async({pageParam:a})=>{const i=await H.getAutomations(a,s);return q.initJawbonesFromServerData(i.items,i.cursor,s),i},initialPageParam:L.getCursor(s),getNextPageParam:a=>a.cursor??void 0});return t||n?e.jsx(A,{}):o?e.jsxs("button",{className:"flex cursor-pointer items-center gap-1",onClick:()=>{r()},children:[e.jsx(z,{className:"icon text-token-text-secondary"}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(m,{...B.seeMore})})]}):null}function se({icon:s,title:t,onClickTitle:n,details:o,actions:r,showActions:a}){return e.jsxs("div",{className:"flex items-center gap-1.5",children:[s,e.jsx("div",{className:x("me-6 flex-1 py-4 text-sm",n&&"cursor-pointer"),onClick:n,children:t}),e.jsx("div",{children:a?r:o})]})}function te({label:s,activeIndex:t}){return e.jsx("div",{className:x("border-token-border-default mx-4 border-b pb-4 text-base font-medium",t===0&&"border-transparent"),children:s})}function ne({automation:s}){return s.is_enabled?s.target_time_utc?e.jsx(G,{className:"icon text-token-text-secondary"}):e.jsx(J,{className:"icon text-token-text-tertiary"}):e.jsx($,{className:"icon text-token-text-tertiary"})}function oe({automation:s,filter:t,index:n,activeIndex:o}){const r=S(),[a,i]=l.useState(!1),d=l.useCallback(C=>{i(C)},[]),c=n===o,b=n+1===o,[N,f]=l.useState(!1),[p,g]=l.useState(!1);return e.jsxs("div",{className:x("rounded-2xl",c&&"dark:bg-token-main-surface-secondary bg-[#f4f4f4]"),children:[e.jsx("div",{className:x("border-token-border-default mx-4 border-b",c&&"border-transparent",b&&"border-transparent"),children:e.jsx(se,{icon:e.jsx(ne,{automation:s}),title:e.jsx("span",{className:x(t==="scheduled"?"text-token-text-primary":"text-token-text-secondary"),children:s.title}),onClickTitle:()=>{s.conversation_id&&r(M(s.conversation_id))},details:e.jsx(W,{automation:s}),actions:e.jsx(K,{automation:s,updateForceShowActions:d,onClickEdit:()=>f(!0),onClickDelete:()=>g(!0)}),showActions:c||a})}),p&&e.jsx(V,{item:s,onClose:()=>g(!1),onConfirm:()=>g(!1)}),N&&e.jsx(O,{initialScheduleComponents:s.schedule_components,nextRunTimes:s.next_run_times,children:e.jsx(Z,{item:s,source:"tasks",onClose:()=>f(!1)})})]})}function le({label:s,filter:t,automations:n,isActiveSection:o}){const[r,a]=l.useState(void 0);l.useEffect(()=>{o||a(void 0)},[o]);const i=l.useMemo(()=>t==="scheduled"?ae(n):n,[n,t]);return e.jsxs("div",{children:[e.jsx(te,{label:s,activeIndex:r}),e.jsxs("div",{className:"flex flex-col",children:[i.map((d,c)=>e.jsx("div",{onMouseEnter:()=>a(c),onMouseLeave:()=>a(void 0),children:e.jsx(oe,{automation:d,filter:t,activeIndex:o?r:void 0,index:c})},d.id)),e.jsx("div",{className:"p-4",children:e.jsx(ee,{filter:t})})]})]})}function ae(s){return[...s].sort((t,n)=>{const o=t.next_run_times&&t.next_run_times.length?new Date(t.next_run_times[0]).getTime():NaN,r=n.next_run_times&&n.next_run_times.length?new Date(n.next_run_times[0]).getTime():NaN;return!isNaN(o)&&!isNaN(r)?o-r:isNaN(o)?1:-1})}const de={};export{K as A,ne as J,se as T,W as a,le as b,de as c};
//# sourceMappingURL=g0mpgdwzucibnk0j.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/locv700giubjykli.js","assets/ls1hkjm4csy89kc5.js","assets/jfjoua4700kji9z3.js","assets/root-g83krhyb.css","assets/nir4oygjafgvf7ja.js","assets/dw0yxoy181y81cxz.js","assets/hj6jep7mk4776vwc.js","assets/conversation-small-hvit8l60.css","assets/jwvoc0dcchpyfzdw.js","assets/d3y72ugnrmac5z1v.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/fbs9v8bh3wllita3.js"])))=>i.map(i=>d[i]);
import{j as e,M as p,h as ms,r as m,a8 as T,R as Y,d as J,f as xe,e as L,a9 as ee,u as xs}from"./ls1hkjm4csy89kc5.js";import{iL as Le,iB as Fe,iD as fs,o as fe,cZ as Ee,iM as Oe,a5 as I,e$ as se,af as hs,dc as y,iz as he,p3 as ps,p1 as me,p4 as gs,jm as js,ct as bs,cu as vs,p5 as Ss,bk as Ae,aI as ys,f2 as ws,f3 as Ns,R as Cs,aM as ks,cC as Ms,p6 as Re,p7 as Is,p8 as Ts,p9 as _s,pa as ne,pb as Be,pc as ze,ow as Ue,i0 as Ps,pd as ce,I as Ls,ki as Fs,h_ as Es,kp as Os,G as As,kf as Rs,c_ as Bs,e6 as zs,z as Us,pe as Q,dV as Ds,pf as Gs,pg as Hs,iI as Ws,gf as Vs,ph as $s,bH as re,pi as qs,e8 as De,aY as Xs,aX as Ks,pj as Qs,iq as Ys,pk as ae,n as Ge,et as Zs,pl as Js,pm as et,pn as oe,i1 as st,hZ as tt,po as de,pp as at,pq as nt,pr as it,ps as rt,be as ot,ip as ye,pt as lt,pu as ct,pv as dt,a$ as ut,b0 as mt,iJ as xt,iK as ft,pw as ie,px as ht,py as pt,pz as we,pA as He,aG as gt,id as jt,iy as bt,b9 as vt,iv as St,pB as yt,pC as wt,pD as q,pE as Nt,gA as Ct,bK as kt,n5 as Mt,pF as It,pG as pe,pH as Tt,pI as _t,pJ as Pt,pK as Lt,pL as Ft,pM as Et,pN as Ne,pO as Ot,pP as At,pQ as We,B as Ve,aH as Rt,j3 as Bt,pR as zt,iZ as Ut,j4 as Dt,pS as Gt,pT as Ht,pU as $e,pV as Wt,pW as Vt,pX as $t,fR as qt,pY as Xt,pZ as Kt,ef as Qt,p_ as Yt}from"./hj6jep7mk4776vwc.js";import{l as D,P as _,fe as qe,aj as ge,F as Xe,u as Zt,cH as U,dT as Jt,a as C,cQ as ea,cS as sa,cT as ta,cV as aa,ds as na,d_ as ia,d$ as ra,aG as Ke,cr as R,bF as oa,cq as Qe,fO as la,cW as ca,di as da,m as ua,aL as je,J as ma,b9 as xa,co as Ye,cp as Ze,I as Je,aW as fa,e0 as Ce,ea as ha,dD as z,dk as pa,am as Z,ag as es,bX as ss,ae as ts,ha as ga,cL as ja,V as ba,b5 as va,e7 as Sa,aR as ya,ff as wa,aA as be,cX as Na,hb as Ca,C as ka,h as Ma,gm as Ia,bZ as as,cP as Ta,cG as _a,fS as ns,g7 as B,fN as Pa}from"./jfjoua4700kji9z3.js";import{f as ve,g as is,h as La,i as Fa,j as Ea}from"./ht69l5cqsqb2usac.js";import{G as rs}from"./ltik0hzezyevzkdj.js";import{e as Oa}from"./jl416oerpm5p44nd.js";import{W as ke}from"./nh14du86kynnf5fc.js";import{P as Aa}from"./dt7ksh4fvumz5f8p.js";function Un({onClick:s,className:t,...a}){return e.jsx(ps,{onClick:s,className:C(t,"grow overflow-hidden"),...a})}function Dn({onNewChatButtonClick:s}){const{isUnauthenticated:t,isLoading:a}=D();return a||!t?null:e.jsx(ve,{className:"me-3",onClick:()=>{_.logNewChatButtonClicked({location:"Mobile header"}),s()}})}function Gn({onNewChatButtonClick:s,clientThreadId:t}){const{isUnauthenticated:a,isLoading:n}=D(),r=Le(),i=qe(t),l=Fe(i),o=ge(t,Xe.getIsNewConversation),u=Zt(),d=o&&u&&l;if(n)return null;if(a)return r?e.jsx(Ba,{}):e.jsx(Ra,{});const c=e.jsx(ve,{onClick:()=>{_.logNewChatButtonClicked({location:"Mobile header"}),s()}});return d?e.jsx(fs,{layout:"compact",clientThreadId:t}):c}function Ra(){const s=fe(),t=Ee(Se.signUpButtonText);return e.jsx(U,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"signup",callback:a=>{_.logSignUpButtonClicked({location:"Mobile Chat Stage Header",provider:a})}})},children:e.jsx(p,{...t})})}function Ba(){const s=fe();return e.jsx(U,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"login",callback:t=>{_.logLogInButtonClicked({location:"Mobile Chat Stage Header",provider:t})}})},"data-testid":"mobile-login-button",children:e.jsx(p,{...Jt.logInButtonText})})}function za({onClick:s}){const t=is(gs,me,!0,!0);return e.jsxs("button",{type:"button",className:"hover:text-token-text-primary inline-flex rounded-md focus:ring-2 focus:ring-white focus:outline-hidden focus:ring-inset active:opacity-50",onClick:s,"data-testid":"open-sidebar-button",children:[e.jsx("span",{className:"sr-only",children:e.jsx(p,{...Se.openSidebar})}),e.jsx(t,{className:"icon-lg text-token-text-secondary mx-2"})]})}const Ua=({rightContentExpanded:s,onOpenSidebar:t,children:a,showNavSidebar:n,leftContent:r,rightContent:i,bottomContent:l})=>{const o=ms(),u=o.pathname+o.search+o.hash;m.useEffect(()=>{Oe(window)||I.toggleNavCollapsed(!0)},[u]);const d=se(c=>c.isConversationScrolledFromTop);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:C("draggable h-header-height bg-token-main-surface-primary sticky top-0 z-10 flex items-center justify-center border-transparent ps-0 md:hidden",d?"[box-shadow:var(--sharp-edge-top-shadow)]":"[box-shadow:var(--sharp-edge-top-shadow-placeholder)]"),children:[(n||r)&&e.jsxs("div",{className:"no-draggable absolute start-0 top-0 bottom-0 ms-3 inline-flex items-center justify-center",children:[n&&e.jsx(za,{onClick:t}),r]}),e.jsx("div",{className:"no-draggable",children:a}),i&&e.jsx("div",{className:C("no-draggable absolute end-0 top-0 bottom-0 me-3 inline-flex items-center justify-center",s&&"start-10"),children:i})]}),l&&e.jsx("div",{className:"no-draggable bg-token-main-surface-primary flex w-full items-center justify-center md:hidden",children:l})]})};function Da({isPopoverOnDesktop:s=!1,children:t}){const a=hs();y.markStart("StageNavigationSidebar"),y.markRendered("StageNavigationSidebar");const n=!a||s;return e.jsxs(e.Fragment,{children:[n?e.jsx(Ha,{children:t}):null,a&&!n&&e.jsx(Ga,{children:t})]})}const os={type:"spring",bounce:.12,duration:.64},Me={...os,duration:.4},Ga=({style:s,children:t})=>{const a=m.useRef(null),n=m.useRef(void 0);return n.current===void 0&&(n.current=Oe(window)),n.current&&y.trackNamespace(y.NS_SIDEBAR),e.jsx(T.div,{className:C("bg-token-sidebar-surface-primary z-21 shrink-0 overflow-x-hidden [view-transition-name:var(--sidebar-slideover)] max-md:w-0!"),ref:a,initial:{width:0},transition:os,animate:{width:260},exit:{width:0},style:s,children:e.jsx("div",{className:"h-full w-[var(--sidebar-width)]",children:e.jsx("div",{className:"flex h-full min-h-0 flex-col",children:t})})})},Ha=({style:s,children:t})=>{const a=he(),n=se(i=>i.temporaryDisableHoverSidebar),r=Y.useRef(null);return e.jsx(ea,{open:!0,onOpenChange:i=>{i||I.toggleNavCollapsed(!0)},children:e.jsxs(sa,{forceMount:!0,children:[!a&&e.jsx(ta,{asChild:!0,className:"fixed inset-0 z-10 bg-gray-50/50 dark:bg-black/50",children:e.jsx(T.div,{transition:Me,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})}),e.jsx(aa,{asChild:!0,className:"bg-token-sidebar-surface-primary top-banner-visible:bottom-0 top-banner-visible:top-(--top-banner-height,0px) top-banner-visible:h-auto fixed start-0 top-0 z-50 h-full w-[var(--sidebar-width)] max-w-xs border-e border-gray-200 shadow-[0_0_64px_0_rgba(0,0,0,0.07)] [view-transition-name:var(--sidebar-popover)] focus:outline-hidden dark:border-gray-800",onMouseLeave:a&&!n?()=>{r.current=window.setTimeout(()=>{I.toggleNavCollapsed(!0,"hover")},200)}:void 0,onMouseEnter:a&&!n?()=>{r.current&&window.clearTimeout(r.current)}:void 0,onOpenAutoFocus:a&&!n?i=>{i.preventDefault()}:void 0,children:e.jsxs(T.div,{transition:Me,initial:{translateX:"-100%"},animate:{translateX:"0"},exit:{translateX:"-100%"},style:s,children:[e.jsx(na,{asChild:!0,children:e.jsxs(ia,{children:[e.jsx(p,{...Se.sidebarTitle}),e.jsx(ra,{})]})}),t]})})]})})},Se=J({sidebarTitle:{id:"navigation.sidebarTitle",defaultMessage:"Sidebar"},closeSidebar:{id:"navigation.closeSidebar",defaultMessage:"Close sidebar"},openSidebar:{id:"navigation.openSidebar",defaultMessage:"Open sidebar"},signUpButtonText:{id:"navigation.signUpButtonText",defaultMessage:"Sign up"}}),Ie=3;function Wa({product:s,descriptionCitation:t,clientThreadId:a,messageId:n,contentReferenceStartIndex:r,productIndex:i,analyticsMetadata:l}){const{value:o}=Ke("573184874"),[u,d]=m.useState(void 0),c=m.useRef([]),x=u?.product.offers??s.offers??[];for(const h of x)c.current.some(N=>N.merchant_name===h.merchant_name)||c.current.push(h);const[f,g]=m.useState(!1);m.useEffect(()=>g(!1),[s]);const j=js(l),v=bs.useStore(),{numReviews:S,rating:b,ratingGroupedCitation:w}=m.useMemo(()=>{const h=u?.product??s;return{numReviews:h.num_reviews,rating:h.rating,ratingGroupedCitation:h.rating_grouped_citation}},[s,u]);return e.jsxs("div",{className:"bg-token-bg-primary flex h-full flex-col",children:[e.jsx(Va,{product:s,onImageClick:h=>{v.setCurrentImage({image:{url:h,content_url:h,thumbnail_url:h,title:s.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:vs.ProductDetails,analyticsMetadata:l,contentReferenceStartIndex:r,productIndex:i})}}),e.jsxs("div",{className:"border-token-border-light flex flex-col border-t px-6 py-4",children:[e.jsx("div",{className:"text-token-text-primary text-xl font-semibold",children:s.title}),S&&S>0&&e.jsxs("div",{className:"flex flex-col gap-1 pt-1",children:[e.jsxs("div",{className:"text-token-text-secondary flex flex-row items-center gap-1 text-sm text-nowrap text-ellipsis",children:[e.jsx(Ss,{rating:b??0}),e.jsx(p,{id:"Tj10jZ",defaultMessage:"{rating} ({num_reviews})",values:{rating:(b??0).toFixed(1),num_reviews:new Intl.NumberFormat().format(S)}}),e.jsx(R,{label:e.jsx(p,{id:"zngDZ6",defaultMessage:"Ratings and pricing are sourced from third parties which may update over time"}),children:e.jsx(Ae,{className:"h-4 w-4"})})]}),w&&e.jsx(ke,{webpageItem:w,trackContentReferenceEvent:j,analyticsMetadata:{...l,section:"products",section_location:"sidebar"},isLastHovered:!0,noMarginStart:!0})]}),s.description&&e.jsxs("div",{className:"pt-3 text-sm",children:[s.description,t&&e.jsx(ke,{webpageItem:t,trackContentReferenceEvent:j,analyticsMetadata:{section:"products",section_location:"sidebar"}})]})]}),e.jsx(ys,{title:e.jsx(p,{id:"ITQW8G",defaultMessage:"Purchasing Options"}),children:e.jsxs("div",{className:"-mx-3 flex flex-col",children:[c.current.slice(0,f?c.current.length:Ie).map((h,N)=>e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx($a,{offer:h,onClick:()=>{_.logEventWithStatsig("Product Offer Clicked","product_offer_clicked",{...oa(l),content_reference_start_index:r,product_index:i,offer_index:N,product_id:s.id,offer_url:h.url,checkout_url:h.checkout_url}),window.open(h.checkout_url||h.url,"_blank")}},h.url)},h.url)),c.current.length>Ie&&e.jsxs(U,{className:"w-fit px-3",size:"small",color:"ghost",onClick:()=>g(!f),children:[f?e.jsx(p,{id:"Gl3oLS",defaultMessage:"See less"}):e.jsx(p,{id:"f9tOaY",defaultMessage:"See more"}),f?e.jsx(ws,{}):e.jsx(Ns,{})]})]})}),o&&e.jsx(Aa,{clientThreadId:a,messageId:n,product:s,trackContentReferenceEvent:j,onProductEntityUpdated:h=>{d(h)}})]})}function Va({product:s,onImageClick:t}){const[a,n]=m.useState(0),r=m.useRef(null);if(m.useEffect(()=>{n(0),r.current&&(r.current.scrollLeft=0)},[s]),!s.image_urls)return null;const i=s.image_urls;return e.jsxs("div",{className:"flex flex-col",children:[i[a]&&e.jsx(T.div,{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",drag:"x",dragConstraints:{left:0,right:0},dragElastic:0,onDragEnd:(l,{offset:o,velocity:u})=>{const d=Math.abs(o.x)*u.x,c=1e3;d<-c?a<i.length-1&&n(a+1):d>c&&a>0&&n(a-1)},onClick:()=>t(i[a]),children:e.jsx("img",{className:"m-0 aspect-square w-full object-contain mix-blend-darken",src:i[a],alt:s.title,draggable:!1})}),i.length>1&&e.jsx("div",{ref:r,className:"no-scrollbar flex flex-row gap-2.5 overflow-x-scroll px-6 py-3",children:i.map((l,o)=>e.jsx("div",{className:C("flex-none cursor-pointer overflow-hidden rounded-md border-2 p-0.5",a===o?"border-token-text-primary":"border-transparent"),onMouseEnter:()=>n(o),onClick:()=>t(l),children:e.jsx("div",{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",children:e.jsx("img",{className:"h-10 w-10 rounded-xs object-cover mix-blend-darken",src:l,alt:s.title})})},`${o}-${l}`))})]})}function $a({offer:s,onClick:t}){const a=s.price_details,n=a?.base&&a.shipping&&a.tax&&a.total,r=a?.display_price==="total_price"||n,i=a?.display_price==="total_price";let l=null;n&&a?l=e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{children:e.jsx(p,{id:"offer.breakdown.base",defaultMessage:"Base price: {amount}",values:{amount:a.base}})}),e.jsx("div",{children:e.jsx(p,{id:"offer.breakdown.shipping",defaultMessage:"Shipping: {amount}",values:{amount:a.shipping}})}),e.jsx("div",{children:e.jsx(p,{id:"offer.breakdown.tax",defaultMessage:"Tax: {amount}",values:{amount:a.tax}})})]}):i&&(l=e.jsx(p,{id:"ur3//V",defaultMessage:"Prices shown include estimated tax and shipping."}));const o=!!s.checkout_url;return e.jsxs("div",{className:C("flex cursor-pointer flex-col rounded-xl p-3","hover:bg-token-bg-tertiary"),onClick:t,children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 text-sm font-semibold",children:[e.jsx(Cs,{className:"h-5 w-5 rounded-full",url:s.url,size:128,minSize:16,fallback:e.jsx(ks,{className:"text-token-text-tertiary"})}),e.jsx("div",{className:"min-w-0 flex-1 truncate",children:s.merchant_name}),r&&l?e.jsx(R,{label:l,children:e.jsxs("span",{className:"flex items-baseline",children:[e.jsx(Ae,{className:"text-token-text-secondary h-3 w-3"}),e.jsx("span",{children:s.price})]})}):e.jsx("span",{children:s.price}),e.jsx(U,{className:"w-fit min-w-20 truncate",size:"small",color:o?"primary":"secondary",children:o?e.jsx(p,{id:"LlDx51",defaultMessage:"Buy now"}):e.jsx(p,{id:"sTpOJt",defaultMessage:"Buy"})})]}),e.jsx("div",{className:"text-token-text-secondary pt-2.5 text-xs",children:s.product_name}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:s.details})]})}function qa({clientThreadId:s,type:t="sidebar"}){const{closeThreadSidebar:a}=Qe(),{clientThreadId:n,messageId:r,turnIndex:i,contentReferenceStartIndex:l,productIndex:o}=la("product")??{},u=ge(n,j=>j),d=m.useMemo(()=>({clientThreadId:s,messageId:r,turnIndex:i}),[s,r,i]);if(n!==s||l===void 0||o===void 0||!r)return null;const{product:c,descriptionCitation:x}=Ms({thread:u,messageId:r,contentReferenceStartIndex:l,productIndex:o});if(!c)return null;const f=`${r}-${l}-${o}`,g=e.jsx(Wa,{product:c,descriptionCitation:x,clientThreadId:s,messageId:r,contentReferenceStartIndex:l,productIndex:o,analyticsMetadata:d});switch(t){case"sidebar":return e.jsx(Re,{handleClose:a,children:e.jsx("div",{className:"mt-[calc(var(--threadFlyOut-leading-height,57px)*-1)] h-[100vh]",children:g})},f);case"modal":return e.jsxs(ca,{testId:"modal-chat-screen-product-flyout",className:"relative max-w-md",size:"custom",type:"success",noPadding:!0,title:c.title,visuallyHiddenHeader:!0,isOpen:!0,onClose:a,children:[g,e.jsx(da,{className:"absolute end-2.5 top-2.5 z-10",onClick:a})]},f)}}function Te({isNewConversation:s}){const t=Is(),{value:a}=Ke("2113934735");return y.markStart("OperatorSidebarListItem",y.NS_SIDEBAR),a?a&&y.markRendered("OperatorSidebarListItem",y.NS_SIDEBAR):y.cancelRender("OperatorSidebarListItem",y.NS_SIDEBAR),e.jsxs(e.Fragment,{children:[e.jsx(Xa,{isNewConversation:s}),null,null,a?e.jsx(Ts,{}):null,t?e.jsx(_s,{}):null]})}const Xa=({isNewConversation:s})=>{const[t,a]=m.useState(!1),n=ua(),r=xe(),i=L(),l=je();let o;return l==null?null:(o=Ue,e.jsx("div",{className:"bg-token-sidebar-surface-primary pt-0",children:e.jsx(R,{side:"right",label:i.formatMessage(ne.newChat),className:"flex w-full items-center",children:e.jsx("div",{className:"flex-1 transition-transform duration-100 active:scale-[0.98]",onPointerEnter:u=>{u.pointerType!=="touch"&&a(!0)},onPointerLeave:u=>{u.pointerType!=="touch"&&a(!1)},children:e.jsx(Be,{loggingGizmoId:"primary",href:"/",isHovered:t,onClick:u=>{!ma(n)&&!s?(u.preventDefault(),ze(r)):xa.publish({kind:"newChatRequested"})},icon:e.jsx(rs,{isFirstParty:!0,className:"h-6 w-6"}),isMenuOpen:!1,label:o,hoverRightIcon:null})})})}))},Ka=Ye(()=>Ze(()=>import("./locv700giubjykli.js"),__vite__mapDeps([0,1,2,3,4])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>e.jsx(ls,{color:s})}),Qa={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function Ya({color:s,folderState:t,gizmoId:a,sidebarSnorlaxFolderStore:n}){const r=L(),[i,l]=m.useState(!1);return e.jsx(R,{side:"top",sideOffset:4,delayDuration:600,label:t==="open"?r.formatMessage(re.hideChatsForProjectTooltip):r.formatMessage(re.showChatsForProjectTooltip),children:e.jsx("button",{onClick:o=>{o.preventDefault(),t==="open"?n.collapseProject(a):n.expandProject(a)},className:"text-token-text-secondary hover:bg-token-sidebar-surface-tertiary -m-0.5 flex rounded-xl p-0.5",onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"text-token-text-primary relative flex h-full items-center justify-center",children:e.jsx(Ka,{isOpen:t==="open",isHovered:i,color:s})})})})})}function ls({color:s}){return e.jsx("div",{className:"text-token-text-primary flex h-6 w-6 shrink-0 items-center justify-center",children:e.jsx(Ps,{className:"h-3/4 w-3/4",style:{color:s}})})}function le({gizmo:s,historyDisabled:t,section:a,onClick:n,isActive:r,hideOverflowMenu:i=!1,elementRef:l}){const{clientThreadId:o}=Oa(),u=Je(o),d=L(),[c,x]=m.useState(!1),[f,g]=m.useState(!1),j=s.gizmo.id,v=ce.useStore(),S=ce.useState(M=>ce.selectFolderState(M,j)),b=fa(),w=!!s.gizmo.tags?.includes(Ls.FirstParty),h=Fs(),N=Es(),{items:F=[],hasNextPage:V}=Os(s.gizmo.id),k=As(j),G=Rs(s),P=Bs();let $=!1;r&&k&&!(S==="open"&&u)&&($=!0),m.useEffect(()=>{S!=="open"&&r&&u&&v.expandProject(j)},[r,u,v,j]);let H;if(s!=null)H=s.gizmo.display.name||zs;else{if(b==null)return null;t?H=d.formatMessage(ne.clearChat):H=Ue}const te=h!=null&&h.kind==="conversation"&&(h.gizmoId==null||h.gizmoId!=j);return e.jsxs(e.Fragment,{children:[e.jsx(T.div,{onMouseEnter:P?()=>{g(!0)}:void 0,onMouseLeave:()=>{g(!1)},onDrop:M=>{M.preventDefault(),te&&(N({newGizmoId:j,conversation:h.conversation,previousGizmoId:h.gizmoId??null}),g(!1))},onDragOver:M=>{M.preventDefault(),te&&g(!0)},onDragLeave:()=>{g(!1)},children:e.jsx(Be,{loggingGizmoId:s?.gizmo.id??"primary",href:Us(s),onClick:n,showActiveIndicator:$,isHovered:f,icon:k&&F.length>0?e.jsx(Ya,{color:G,folderState:S,gizmoId:j,sidebarSnorlaxFolderStore:v}):k?e.jsx(ls,{color:G}):e.jsx(rs,{isFirstParty:w,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:c,label:H,rightIcon:a===Q.Workspace&&e.jsx(R,{side:"right",label:d.formatMessage(_e.workspaceRecommended,{workspace_name:b?.name??"Your Workspace"}),children:e.jsx(Ds,{className:"icon-md text-token-text-secondary",alt:d.formatMessage(_e.workspaceRecommended,{workspace_name:b?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(f||c)&&!i&&(k?e.jsx("div",{className:"text-token-text-tertiary",onClick:M=>{M.preventDefault()},children:e.jsx(Gs,{gizmo:s,isOpen:c,setIsOpen:x})}):e.jsx("div",{className:"text-token-text-tertiary",onClick:M=>{M.preventDefault()},children:e.jsx(Hs,{gizmo:s,isOpen:c,setIsOpen:x,section:a})})),!k&&!i&&e.jsx(R,{side:"right",label:d.formatMessage(t?ne.clearChat:ne.newChat),className:"flex items-center",children:e.jsx("button",{className:c?"text-token-text-tertiary":"text-token-text-secondary hover:text-token-text-primary invisible group-hover:visible",children:t?e.jsx(Ws,{className:"icon-md"}):e.jsx(Vs,{className:"icon-md"})})})]}),elementRef:l})}),e.jsx(ee,{initial:!1,children:k&&S==="open"&&F.length>0&&e.jsx(T.div,{initial:"closed",animate:"open",exit:"closed",variants:Qa,className:"overflow-hidden",children:e.jsx($s,{gizmoResource:s,serverThreadId:u,isOnProjectPage:$,conversations:F,hasNextPage:V})},"nested-conversations")})]})}const _e=J({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Za=2;function Ja({gizmos:s,maxToShowOnLoad:t=4,showAllSidebarItems:a}){const n=Ys(s,f=>f.flair.kind),r=[...(n[ae.Workspace]?.map(({resource:f})=>({gizmo:f,section:Q.Workspace}))??[]).slice(0,3),...n[ae.FirstParty]?.map(({resource:f})=>({gizmo:f,section:Q.Keep}))??[],...n[ae.SidebarKeep]?.map(({resource:f})=>({gizmo:f,section:Q.Keep}))??[]],i=n[ae.Recent]??[],o=(a?i:i.slice(0,Za)).map(({resource:f})=>({gizmo:f,section:Q.Recents})),u=r.length;let d=[];d=[...r,...o],a||(d.length>t&&u>t?d=d.slice(0,u):d.length>t&&(d=d.slice(0,t)));const x=s.length>d.length;return{listItems:d,itemsLeft:s.length-d.length,needsToCollapseItems:x,total:s.length}}function en({gizmo:s,currentGizmoId:t,maxToShowOnLoad:a,hideOverflowMenu:n=!1}){const r=se(d=>!qs.isGptListCollapsed(d)),{listItems:i,needsToCollapseItems:l,itemsLeft:o}=Ja({gizmos:s,maxToShowOnLoad:a,showAllSidebarItems:r});function u(d,c){return e.jsx(le,{gizmo:d,isActive:d.gizmo.id===t,section:c,hideOverflowMenu:n},d.gizmo.id)}return e.jsxs("div",{children:[i.map(({gizmo:d,section:c},x)=>e.jsxs(m.Fragment,{children:[x>1&&c!==i[x-1].section&&e.jsx("div",{className:"bg-token-border-default my-2 ms-2 h-px w-7"}),u(d,c)]},x)),l?e.jsxs("button",{onClick:I.toggleGptListCollapsed,className:"text-token-text-primary hover:bg-token-sidebar-surface-secondary flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm",children:[e.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center",children:e.jsx(De,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsx(p,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Xs,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:o}}),e.jsx(Ks,{className:"icon-xs"})]})})]}):null,e.jsx(Qs,{})]})}function sn({currentGizmoId:s}){const t=Ge(),a=je(),{data:{gizmos:n}={}}=Zs();let r=n;t&&(r=n?.filter(o=>!Js(o.resource))),y.markStart("GizmoSidebarList",y.NS_SIDEBAR),r!==void 0&&y.markRendered("GizmoSidebarList",y.NS_SIDEBAR);const i=Ce("2152104812","hide_gpts_if_none",!1),l=Ce("2152104812","hide_default_gpts",!1);return a?i&&n?.length===0?!l&&e.jsx(Te,{isNewConversation:!0}):e.jsxs(e.Fragment,{children:[!l&&e.jsx(Te,{isNewConversation:!0}),e.jsx(en,{gizmo:r??[],currentGizmoId:s,maxToShowOnLoad:7})]}):null}function tn({currentGizmoId:s,onClick:t}){const{isSidebarFlyoutOpen:a,onSidebarFlyoutOpenChange:n}=et(),r=a(oe.Snorlax);return e.jsx("div",{className:"group flex w-full items-center justify-start",children:e.jsx(ha,{onOpenChange:i=>n(oe.Snorlax,i),side:"right",sideOffset:4,open:r,contentAlign:"end",triggerButton:e.jsxs("button",{className:C("tracking-condensed text-token-text-secondary hover:bg-token-sidebar-surface-secondary screen-arch:py-[7px] screen-arch:text-body can-hover:hover:screen-arch:bg-token-main-surface-secondary flex flex-1 items-center gap-2.5 rounded-lg px-2 py-1.5 text-sm ease-[var(--spring-bounce)] select-none focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",r&&"bg-token-main-surface-secondary"),onClick:t,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"text-token-text-primary relative flex h-full items-center justify-center",children:e.jsx(De,{className:"icon-md text-token-sidebar-icon font-semibold"})})}),e.jsx("span",{className:"text-start",children:e.jsx(p,{...re.seeMoreProjectItems})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(z,{children:e.jsx(st,{currentGizmoId:s,inSidebarFlyout:!0,customListItem:le})})})})})}function an({snorlaxes:s,currentGizmoId:t}){return e.jsx(e.Fragment,{children:s.map(a=>e.jsx(le,{gizmo:a.gizmo,isActive:a.gizmo.gizmo.id===t},a.gizmo.gizmo.id))})}function nn({currentGizmoId:s,includeRevisedSidebarIa:t}){const a=L(),{snorlaxes:n,data:r,isLoading:i,isError:l,refetch:o,hasNextPage:u}=tt(),d=n.slice(0,de),c=m.useRef(!1),[x,f]=m.useState(!0),g=m.useCallback(function(F){F&&f(!1),o()},[o,f]),j=(n??[]).length===0,v=l||r===void 0&&!i&&c.current;y.markStart("SnorlaxSidebarList",y.NS_SIDEBAR),r!=null&&!i&&y.markRendered("SnorlaxSidebarList",y.NS_SIDEBAR),r===void 0&&!i&&!c.current&&(c.current=!0,g(!1));const b=n?.find(N=>N.gizmo.gizmo.id===s),w=d.some(N=>N.gizmo.gizmo.id===s),h=n&&(n?.length>(!s||w?de:de+1)||u);return e.jsxs(e.Fragment,{children:[v&&e.jsx(at,{showRetry:x,refetch:g}),!v&&e.jsx(nt,{id:"snorlax-heading",condensed:t,header:e.jsxs(z,{children:[a.formatMessage(re.projectsHeading),!j&&e.jsx(it,{})]}),isLastInGroup:!0,ulClassName:"screen-arch:mb-3",children:!i&&e.jsxs(e.Fragment,{children:[e.jsx(an,{snorlaxes:d,currentGizmoId:s}),b&&!w&&e.jsx(le,{gizmo:b.gizmo,isActive:!0}),h&&e.jsx(tn,{currentGizmoId:s}),!i&&j&&e.jsx(rt,{})]})})]})}function rn({clientThreadId:s}){const t=Je(s),{isUnauthenticated:a}=D(),n=qe(s),r=es(),i=Ge(),[l,o]=m.useState(!1),u=m.useCallback(c=>c===oe.Snorlax?l:!1,[l]),d=m.useCallback((c,x)=>{c===oe.Snorlax&&o(x)},[]);return e.jsx(dt,{value:{isSidebarFlyoutOpen:u,onSidebarFlyoutOpenChange:d},children:e.jsxs("div",{id:"sidebar",className:"group/sidebar",children:[!a&&e.jsx(sn,{currentGizmoId:n}),e.jsx(ut,{}),i&&e.jsx(nn,{currentGizmoId:n}),null,!a&&e.jsx(mt,{activeId:r?void 0:t})]})})}function Hn({clientThreadId:s}){const{isUnauthenticated:t}=D();return t?null:e.jsx(rn,{clientThreadId:s})}function on({className:s,onNewThread:t}){const a=L(),n=pa(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:r}=ot(),i=is(ft,xt,!0,!0),l=La(),o=se(x=>x.isSidebarLocked),u=he(),d=a.formatMessage({id:"Q6nsOM",defaultMessage:"Close sidebar"}),c=a.formatMessage({id:"FIsqAC",defaultMessage:"Lock sidebar open"});return e.jsxs("div",{id:"sidebar-header",className:C("flex",n?.visible&&n.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[o||!u?e.jsx(R,{sideOffset:4,label:d,className:"flex",side:"right",children:e.jsx(ye,{className:"no-draggable","aria-label":d,onClick:()=>{I.toggleNavCollapsed(void 0,"button_click"),u&&I.setTemporaryDisableHoverSidebar()},icon:i,mobileIcon:me,"data-testid":"close-sidebar-button"})}):e.jsx(R,{sideOffset:4,label:c,className:"flex",side:"right",children:e.jsx(ye,{className:"no-draggable","aria-label":c,onClick:()=>{Z.logEvent("chatgpt_web_sidebar_locked"),I.setIsSidebarLocked(!0),I.setTemporaryDisableHoverSidebar()},icon:lt,mobileIcon:me,"data-testid":"lock-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[l&&e.jsx(Fa,{}),r&&e.jsx(ct,{}),e.jsx(ve,{onClick:t,testId:"create-new-chat-button"})]})]})}function ln({showFreeTrialLoadingPayment:s,handleGetPaymentLink:t}){const a=L(),n=()=>{s||(ie(!0),t())},r=g=>{g.stopPropagation(),ht(!0),pt(!0)},{data:i,isLoading:l,isSuccess:o}=xs({queryKey:["claimedReferralInvite"],queryFn:()=>ts.getClaimedReferralInvite(),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1,refetchOnReconnect:!1}),u=i?.invite_code,[d,c]=m.useState(!1);if(m.useEffect(()=>{u&&!d&&o&&(c(!0),Z.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),_.logEvent("Referral: Show Claimed Sidebar Menu Promo"))},[u,c,d,o]),!u||l||!o)return null;const x=u.invite_metadata.invite_data,f=x?.referral_trial_duration_months?x?.referral_trial_duration_months>1?a.formatMessage(ue.monthsOfBenefit,{referralTrialDurationMonths:x?.referral_trial_duration_months}):a.formatMessage(ue.daysOfBenefit,{referralTrialDurationDays:x?.referral_trial_duration_days}):null;return e.jsx(T.div,{className:C("relative",{"cursor-progress opacity-50":s}),layout:"position",initial:{y:-10,opacity:1},animate:{y:0,opacity:1,transition:{duration:.1,ease:"easeIn"}},children:e.jsxs(cn,{className:C(s&&"opacity-75"),onClick:n,children:[e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-3",children:[e.jsx(ga,{className:"icon-sm shrink-0"}),e.jsx(p,{...ue.freeTrialCta,values:{duration:f}})]}),!s&&e.jsx(ja,{onClick:r,className:"icon-md text-token-text-tertiary shrink-0 rounded-full p-0.5 opacity-50 transition-colors duration-200 group-hover:opacity-100 hover:bg-[#0077FF] hover:text-red-500"}),e.jsx("span",{className:"absolute top-11 h-0 w-0 border-s-8 border-e-8 border-t-8 border-s-transparent border-e-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]"})]})})}const cn=ss.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,ue=J({freeTrialCta:{id:"PaymentMenuItems.freeTrialCta",defaultMessage:"Get {duration}!"},monthsOfBenefit:{id:"FreeTrialMenuItem.monthsOfBenefit",defaultMessage:"{referralTrialDurationMonths, plural, one {one month free} other {# months free}}"},daysOfBenefit:{id:"FreeTrialMenuItem.daysOfBenefit",defaultMessage:"{referralTrialDurationDays, plural, one {one day free} other {# days free}}"}}),dn=Ye(()=>Ze(()=>import("./dw0yxoy181y81cxz.js"),__vite__mapDeps([5,1,6,2,3,7,8,9,10,11,12])));function un(){const s=L(),t=ba(),a=va(),{isLoading:n,data:r}=Sa(),i=ya(r),l=i?.hasPaidSubscription()??!1,o=i?.hasClaimedFreeTrial()??!1,u=m.useMemo(()=>i?.subscriptionAnalyticsParams,[i]),d=async()=>{ie(!0),_.logEvent("Account Pay: Payment Checkout Clicked",u);try{const P=await ts.getCheckoutLink(a,"PaymentMenuItems");window.location.href=P.url}catch{t.warning(s.formatMessage(A.paymentErrorWarning),{hasCloseButton:!0}),ie(!1)}finally{}},c=()=>{f||(ie(!0),d())},x=we(P=>P.didCloseFreeTrial),f=we(P=>P.showFreeTrialLoadingPayment),g=!x&&o,j=i?.wasPaidCustomer()??!1;let v=i?.isWorkspaceAccount()??!1;const S=i?.hasPaidSubscription()??!1,b=i?.isPlus()??!1,w=r&&wa(r),{layer:h}=be("2670443078");let N=b;!v&&!b&&w&&h.get("is_gating_fix_enabled",!1)&&(N=w,v=!0);const F=!n&&!v,V=xe(),k=()=>{_.logEvent("Account Pay: Click Sidebar Account Pay",u),vt(V,"Sidebar account payment menu item")};let G=i?.isTeam()??!1;return e.jsxs(e.Fragment,{children:[!l&&g&&e.jsx(ln,{showFreeTrialLoadingPayment:f,handleGetPaymentLink:d}),G&&e.jsx(mn,{currentWorkspace:i}),F&&e.jsx(He,{onClick:g?c:k,className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(xn,{wasPaidCustomer:j,showFreeTrialLoadingPayment:f,hasPlusSubscription:N,hasPaidSubscription:S})})})})]})}const mn=({currentWorkspace:s})=>e.jsxs(e.Fragment,{children:[e.jsx(He,{onClick:()=>{I.openModal(gt.InviteUsersToWorkspace),_.logEvent("Account: Invite Member Button Clicked",{location:"payment-menu-click"}),Z.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"payment-menu-click",text:"AddTeammatesWithInfo",step:"OpenModal"})},className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-label":"",className:"border-token-border-default flex h-7 w-7 items-center justify-center rounded-full border",children:e.jsx(jt,{className:"icon-sm shrink-0"})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(p,{...A.addTeammates})}),e.jsx("span",{className:"text-token-text-tertiary line-clamp-1 text-xs",children:e.jsx(p,{...A.addTeammatesUpsell})})]})})]})})})}),s!=null&&e.jsx(dn,{workspace:s})]}),xn=({wasPaidCustomer:s,showFreeTrialLoadingPayment:t,hasPlusSubscription:a,hasPaidSubscription:n})=>t?e.jsx(Na,{className:"icon-sm shrink-0"}):n&&!a?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"border-token-border-default flex h-7 w-7 shrink-0 items-center justify-center rounded-full border",children:e.jsx(bt,{className:"icon-sm"})}),e.jsx("div",{className:"flex flex-col",children:s?e.jsx(p,{...A.renewPlus}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a?e.jsx(p,{...A.viewPlans}):!n&&e.jsx(p,{...A.upgradePlan})}),e.jsx("span",{className:"text-token-text-tertiary line-clamp-1 text-xs",children:a?e.jsx(p,{...A.upgradeToProOrTeamUpsell}):!n&&e.jsx(p,{...A.upgradeToPlusUpsell})})]})})]}),A=J({upgradePlan:{id:"PaymentMenuItems.upgradePlan",defaultMessage:"Upgrade plan"},viewPlans:{id:"PaymentMenuItems.viewPlans",defaultMessage:"View plans"},upgradeToTeamUpsell:{id:"PaymentMenuItems.upgradeToTeamUpsell",defaultMessage:"Collaborate on a Team plan"},upgradeToProOrTeamUpsell:{id:"PaymentMenuItems.upgradeToProOrTeamUpsell",defaultMessage:"Unlimited access, team features, and more"},upgradeToPlusUpsell:{id:"PaymentMenuItems.upgradeToPlusUpsell.0",defaultMessage:"More access to the best models"},renewPlus:{id:"PaymentMenuItems.renewPlus",defaultMessage:"Renew Plus"},inviteReferral:{id:"PaymentMenuItems.inviteReferral",defaultMessage:"Refer a friend"},addTeammates:{id:"PaymentMenuItems.addTeammates.0",defaultMessage:"Add teammates"},addTeammatesUpsell:{id:"PaymentMenuItems.addTeammatesUpsell.0",defaultMessage:"Invite coworkers to ChatGPT"},paymentErrorWarning:{id:"PaymentMenuItems.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}});function Wn({navHeader:s,children:t,className:a}){const n=L(),r=m.useRef(null),i=es(),l=Fe(),o=i&&!l,{isUnauthenticated:u}=D(),{layer:d}=be("1578749296"),c=d.get("is_sticky_toggle_off",!1);return m.useEffect(()=>{c&&I.toggleNavCollapsed()},[c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"draggable relative h-full w-full flex-1 items-start border-white/20",children:[e.jsx(Ca,{asChild:!0,children:e.jsx("h2",{children:e.jsx(p,{...W.chatHistoryLabel})})}),e.jsxs("nav",{className:C("flex h-full w-full flex-col ps-3",a),"aria-label":n.formatMessage(W.chatHistoryLabel),children:[s,e.jsx(hn,{ref:r,$disableScroll:o&&!u,children:t}),e.jsx(z,{children:e.jsx("div",{className:"pe-3",children:e.jsx(fn,{})})})]})]})})}function fn(){const[s]=m.useState(()=>{const i=ka.getCookie(Ma.Workspace);return typeof i=="string"&&i!==Ia}),t=je(),{isUnauthenticated:a}=D(),{openSettings:n}=St(),r=yt();return s&&!t||!t?null:a?e.jsx(cs,{}):e.jsxs("div",{className:C("flex flex-col py-2 empty:hidden dark:border-white/20"),children:[e.jsx(wt,{}),e.jsx(un,{}),r&&e.jsx("div",{className:"flex w-full items-center md:hidden",children:e.jsx("div",{className:"max-w-[100%] grow",children:e.jsx(Ea,{onClickSettings:()=>n()})})})]})}const cs=()=>{const s=Le(),t=fe(),a=Ee(W.unauthSignupCta),n=()=>{t({authType:"login",callback:o=>{_.logLogInButtonClicked({location:"Sidebar bottom unit",provider:o}),Z.logEvent("chatgpt_sidebar_login_button_clicked")}})},r=()=>{t({authType:"signup",callback:o=>{_.logSignUpButtonClicked({location:"Sidebar bottom unit",provider:o}),Z.logEvent("chatgpt_sidebar_signup_button_clicked")}})},i=e.jsx(U,{as:"button",size:"medium",color:s?"secondary":"primary","data-testid":"signup-button",onClick:r,children:e.jsx(p,{...a})},"signup-button"),l=e.jsx(U,{as:"button",size:"medium",color:s?"primary":"secondary","data-testid":"login-button",onClick:n,children:e.jsx(p,{...W.unauthLoginCta})},"login-button");return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsx("p",{className:"text-token-text-primary mb-1 text-sm font-semibold",children:e.jsx(p,{...s?W.logInOrSignUp:W.signUpOrLogIn})}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(p,{id:"tr+zlt",defaultMessage:"Get smarter responses, upload files and images, and save your conversations."})})]}),e.jsx("div",{className:"flex flex-row items-start gap-2",children:s?[l,i]:[i,l]})]})},hn=ss.div`flex-col flex-1 transition-opacity duration-500 relative pe-3
  ${({$disableScroll:s})=>s?"overflow-y-hidden opacity-20 pointer-events-none":"overflow-y-auto"}`,W=J({chatHistoryLabel:{id:"NavigationContent.chatHistoryLabel",defaultMessage:"Chat history"},closeSidebar:{id:"NavigationContent.closeSidebar",defaultMessage:"Close sidebar"},signInToChat:{id:"NavigationContent.signInToChat",defaultMessage:"Sign in to ChatGPT"},signUpOrLogIn:{id:"NavigationContent.signUpOrLogIn",defaultMessage:"Sign up or log in"},logInOrSignUp:{id:"NavigationContent.logInOrSignUp",defaultMessage:"Log in or sign up for free"},unauthSignupCta:{id:"NavigationContent.unauthSignupCta",defaultMessage:"Sign up"},unauthLoginCta:{id:"NavigationContent.unauthLoginCta",defaultMessage:"Log in"}}),pn=()=>{const s=xe();return e.jsxs("div",{className:"flex h-full flex-col gap-2 p-3",children:[e.jsx(on,{className:"h-header-height xs:pe-3 flex items-center",onNewThread:()=>{ze(s)}}),e.jsx(gn,{}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(cs,{})})]})},ds="border border-token-border-xlight bg-token-sidebar-surface-secondary";function O({className:s,width:t}){return e.jsx("div",{className:C("h-2.5 grow rounded-sm",ds,s),style:{maxWidth:t+"px"}})}function gn(){const s=e.jsx("div",{className:C("h-4 w-4 shrink-0 grow-0 rounded-full",ds)});return e.jsxs("div",{className:"mt-2 flex w-full grow flex-col gap-4 overflow-hidden px-2",style:{maskImage:"linear-gradient(to bottom, black 50%, transparent 100%)",WebkitMaskImage:"linear-gradient(to bottom, black 50%, transparent 100%)"},children:[e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:80})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:120})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:100})]}),e.jsx("div",{className:"mt-5 flex flex-row items-center justify-start gap-3",children:e.jsx(O,{width:150})}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:50})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:100})]}),e.jsxs("div",{className:"mb-5 flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:80})]}),[120,180,160,100,90,190,140,120,180,170,100,120,180,150].map((t,a)=>e.jsx("div",{className:"flex flex-row items-center justify-start py-1",children:e.jsx(O,{width:t})},a))]})}function jn({children:s}){return e.jsx("div",{className:"bg-token-main-surface-primary h-full w-full px-[22px] py-4",children:s})}function bn(){return e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx(q,{className:"h-full w-full rounded-full!"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(q,{}),e.jsx(q,{}),e.jsx(q,{}),e.jsx(q,{})]})]})}function X({icon:s,message:t,iconClassName:a}){return e.jsx("div",{className:"loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",children:e.jsx(pe,{fillIcon:!1,icon:s,className:a,children:e.jsx("div",{className:"mt-[.5px] flex h-10",children:t})})})}const vn=({finalRow:s})=>{const t=L(),a=s.type==="fileOpen"?Nt[s.iconType]??Ct:null;return e.jsx(ee,{children:e.jsx(T.div,{layout:!0,transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-start justify-start gap-4",children:s.type==="search"?e.jsx(X,{icon:e.jsx(kt,{className:"text-token-text-primary relative h-5 w-5 opacity-50"}),message:t.formatMessage({id:"f9wsyE",defaultMessage:"Searching…"})}):s.type==="websiteOpen"?e.jsx(X,{icon:e.jsx(Mt,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"8L6BBp",defaultMessage:"Reading…"})}):s.type==="fileOpen"?e.jsx(X,{icon:e.jsx(a,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"h5M4/O",defaultMessage:"Reading file…"})}):s.type==="pythonAnalysis"?e.jsx(X,{icon:e.jsx(It,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"jZ7gNw",defaultMessage:"Analyzing…"})}):e.jsx(X,{icon:e.jsx(as,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"bSPYmC",defaultMessage:"Thinking…"})})})})};function K({children:s}){return e.jsx(T.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:s})}const Sn=({previousRow:s,currentRow:t})=>e.jsx("div",{className:"flex flex-col items-start justify-start gap-4",children:t.type==="search"?e.jsx(K,{children:e.jsx(Tt,{row:t,showIcon:!s||s.type!=="search"})},`search_${t.id}`):t.type==="summary"?e.jsx(K,{children:e.jsx(_t,{row:t,showIcon:!s||s.type!=="summary"})},`summary_${t.id}`):t.type==="websiteOpen"?e.jsx(K,{children:e.jsx(Pt,{website:t})},`website_${t.id}`):t.type==="fileOpen"?e.jsx(K,{children:e.jsx(Lt,{row:t})},`file_${t.id}`):t.type==="pythonAnalysis"?e.jsx(K,{children:e.jsx(Ft,{row:t})},`python_${t.id}`):null}),yn=120,wn=1e3*60*2;function Pe(s){s?.scrollIntoView({block:"center",behavior:"smooth"})}function Nn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Ve,{type:"error",title:s.failureMessage,content:s.failureBannerContentMessage})})}function Cn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(Ve,{title:s.cancelledMessage,content:""})})}function kn({interruptPrompt:s,setInterruptPrompt:t,handleInterruptCaterpillar:a}){const n=L();return e.jsxs("div",{className:"flex w-full flex-col justify-center gap-4 p-4",children:[e.jsx(Rt,{ariaLabel:n.formatMessage({id:"aYWRtV",defaultMessage:"Press enter to interrupt task"}),name:"interrupt-caterpillar-prompt",value:s,onChange:r=>t(r.target.value),color:"search",onPressEnter:a}),e.jsx(U,{onClick:a,children:e.jsx(p,{id:"h73FdF",defaultMessage:"Interrupt task"})})]})}function Mn({sourcesCount:s,taskInfo:t}){const a=ge(t.originalConversationId,r=>Xe.findNode(r,i=>i.message.metadata?.b1de6e2_s===!0&&i.message.metadata?.async_task_id===t.taskId)?.message.metadata?.async_task_status_messages),n=m.useMemo(()=>a?.completed_no_time?e.jsxs(e.Fragment,{children:[a?.completed_with_time??a?.completed_no_time,e.jsx(p,{id:"zxfmo/",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:s}})]}):e.jsx(p,{id:"YG7a0T",defaultMessage:"Completed · {sourcesCount} sources",values:{sourcesCount:s}}),[s,a]);return!t.updatedAt&&!a?.completed?null:e.jsx(pe,{icon:e.jsx(_a,{className:"text-token-text-secondary"}),fillIcon:!1,children:e.jsx("div",{className:"text-token-text-tertiary",children:n})})}function In({taskInfo:s,caterpillarStatusMessageTexts:t,sourcesCount:a,caterpillarHeaderRef:n}){const[r,i]=m.useState(""),[l,o]=m.useState(!1),u=Ta("caterpillar-interrupts"),d=m.useRef(!1),c=m.useRef(null),x=m.useMemo(()=>(d.current=!!c.current&&Et(c.current,yn),s.rows??[]),[s.rows]);m.useEffect(()=>{if(x.length===0){const S=new Date(s.createdAt).getTime(),b=Date.now()-S,w=wn-b;if(w>0){const h=setTimeout(()=>{o(!0)},w);return()=>clearTimeout(h)}else o(!0)}else o(!1)},[x,s.createdAt]),m.useEffect(()=>{d.current&&Pe(c.current)},[x]),m.useEffect(()=>{Ne(s)||setTimeout(()=>{c.current&&Pe(c.current)},100)},[]);const f=Ot({taskId:s.taskId,prompt:r}),g=Ne(s)||At(s),j=m.useCallback(async()=>{await f.mutateAsync(),i("")},[f,i]),v=m.useMemo(()=>x.length?g?x:x.slice(0,x.length-1):x,[x,g]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{ref:n},"task-header"),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"text-base font-medium",children:s.title}),x.length?e.jsxs(ee,{initial:!1,children:[v.map((S,b)=>e.jsx(Sn,{previousRow:b>0?x[b-1]:null,currentRow:S},S.id)),!g&&e.jsx(vn,{finalRow:x[x.length-1]})]}):l?e.jsx(pe,{fillIcon:!1,icon:e.jsx(as,{className:"text-token-text-primary inline-flex h-5 w-5 items-center justify-center"}),children:t.waitingInQueueMessage}):e.jsx(bn,{}),We(s)&&u&&e.jsx(kn,{interruptPrompt:r,setInterruptPrompt:i,handleInterruptCaterpillar:j}),s.status==="failed"?e.jsx(Nn,{caterpillarStatusMessageTexts:t}):s.status==="cancelled"?e.jsx(Cn,{caterpillarStatusMessageTexts:t}):s.status==="completed"?e.jsx(Mn,{caterpillarStatusMessageTexts:t,taskInfo:s,sourcesCount:a}):null]}),e.jsx("div",{ref:c},"task-footer")]})}function Tn({taskId:s,setWidth:t=void 0,initialTab:a}){const n=Bt(f=>zt.getTask(s,f)),{closeThreadSidebar:r}=Qe(),[i,l]=m.useState(a),o=Ut(),u=m.useRef(null),d=!1;m.useEffect(()=>{l(a)},[a]),m.useEffect(()=>{},[n?.taskId,n?.status,d]),m.useEffect(()=>{},[n?.taskId,n?.status,i]),m.useEffect(()=>{},[t,n,d]);const{uniqueSources:c,totalSources:x}=m.useMemo(()=>{if(!n?.rows)return{uniqueSources:[],totalSources:0};const f=Dt(n.rows),g=f.reduce((j,v)=>j+v.count,0);return{uniqueSources:f,totalSources:g}},[n?.rows]);return e.jsx(Re,{handleClose:r,leading:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Gt,{activeTab:i,setActiveTab:l,showAuxTab:d,sourcesCount:x,caterpillarHeaderRef:u})}),children:n&&e.jsxs(jn,{children:[!1,i==="activity"&&e.jsx(In,{taskInfo:n,caterpillarStatusMessageTexts:o,sourcesCount:x,caterpillarHeaderRef:u}),i==="sources"&&e.jsx(Ht,{taskIsPending:We(n),finalMessage:n.finalMessage,sources:c,caterpillarHeaderRef:u})]})})}function _n({isExpanded:s,children:t}){const a=m.useRef(null),[n,r]=m.useState("400px"),i=Y.isValidElement(t)?Y.cloneElement(t,{setWidth:r}):t;return e.jsx(ee,{children:e.jsx(T.div,{className:"bg-token-sidebar-surface-primary relative z-1 shrink-0 overflow-x-hidden max-lg:w-0!",ref:a,initial:!1,animate:{width:s?n:0,transition:{type:"spring",bounce:.12,duration:.3}},onAnimationStart:()=>{a.current&&(a.current.style.visibility="visible")},onAnimationComplete:()=>{a.current&&(s||(a.current.style.visibility="hidden"))},children:e.jsx("div",{className:C("absolute h-full",!s&&"pointer-events-none"),style:{width:n},children:e.jsx("div",{className:"flex h-full flex-col",children:i})})})})}const Vn=({setWidth:s,clientThreadId:t})=>{const a=ns(),n=$e();return a?e.jsxs(e.Fragment,{children:[B(a,"searchSources")&&e.jsx(Wt,{clientThreadId:t}),B(a,"retrievalResults")&&e.jsx(Vt,{clientThreadId:t}),n&&B(a,"summarizer")&&e.jsx($t,{clientThreadId:t}),B(a,"caterpillar")&&e.jsx(Tn,{taskId:a.caterpillarId,initialTab:a.initialTab,setWidth:s}),B(a,"product")&&e.jsx(qa,{clientThreadId:t})]}):null};function us({children:s,hideNavigation:t=!1,mobileHeaderContent:a,mobileHeaderRightContentExpanded:n,mobileHeaderLeftContent:r,mobileHeaderRightContent:i,mobileHeaderBottomContent:l,renderNavSidebar:o,threadFlyout:u,forceOpenDesktopSidebar:d=!1}){const{isUnauthenticated:c}=D(),[x,f,g,j]=se(E=>[E.activeStageSidebar,E.activeSidebar,E.isSidebarLocked,E.temporaryDisableHoverSidebar]),v=he(),S=Pa(),b=ns(),w=qt(),h=[];let N=null;Y.Children.forEach(s,E=>{Y.isValidElement(E)&&(E.type===us.Sidebars?N=E:h.push(E))});const{layer:F}=be("3737571708"),V=F.get("sidebar_type","slick"),k=(!c||V==="heavy")&&!t&&o!=null,G=!t&&(k||c),P=$e(),$=b?B(b,"summarizer")&&P:!1,H=b?!B(b,"summarizer"):!1,te=S&&($||H),M=k&&(d||!w);return e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsx(z,{children:e.jsx(Xt,{})}),e.jsxs("div",{className:C("relative flex h-full w-full flex-1 overflow-hidden transition-colors",f!=="popover-nav"&&"z-0"),children:[e.jsxs("div",{className:"relative flex h-full w-full flex-row overflow-hidden",children:[e.jsx(ee,{initial:!1,children:M&&e.jsx(Da,{isPopoverOnDesktop:x||v&&!g,children:c?e.jsx(pn,{}):o()})}),e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col overflow-hidden",children:[G&&e.jsxs(z,{children:[e.jsx(Kt,{}),e.jsx(Ua,{rightContentExpanded:n,onOpenSidebar:()=>I.toggleNavCollapsed(),showNavSidebar:k,leftContent:r,rightContent:i,bottomContent:l,children:a})]}),e.jsx("main",{className:"transition-width relative h-full w-full flex-1 overflow-auto",id:"main","z-index":"-1",children:h})]})]}),e.jsx(z,{children:e.jsx(_n,{isExpanded:te,children:u})}),N]}),e.jsx(z,{children:e.jsx(Qt,{useManuallyControlledVisibility:!0})}),v&&w&&!j&&e.jsx(Yt,{})]})}function Pn({children:s}){return e.jsx(e.Fragment,{children:s})}us.Sidebars=Pn;export{Hn as C,Vn as F,sn as G,Wn as N,us as S,Dn as a,Gn as b,on as c,nn as d,Un as e};
//# sourceMappingURL=mbpp0embmbt5iptr.js.map

import{u as p,g as d}from"./bjo64t20o3wf7ixl.js";import{eG as f,dN as l,D as m}from"./jfjoua4700kji9z3.js";import{r as n}from"./ls1hkjm4csy89kc5.js";function g(e){const r=n.useRef(void 0);n.useEffect(()=>{if(!(f()&&l||!navigator.permissions))return navigator.permissions.query({name:"microphone"}).then(o=>{r.current=o,o.onchange=()=>{e(o.state==="granted")}}).catch(()=>{}),()=>{r.current&&(r.current.onchange=null)}},[e])}const y=()=>{const[e,r]=n.useState(!1),[i,o]=n.useState(!1),[c,a]=n.useState(),u=n.useCallback(s=>{r(s)},[]);g(u);const t=p(),h=n.useCallback(async()=>i?e:t().then(s=>(r(s),s)).finally(()=>{o(!0)}),[t,i,e]);return n.useEffect(()=>{e&&D().then(s=>{a(s)})},[e]),{requestMicrophonePermissions:h,userDeclinedMicrophonePermissions:i&&!e,microphoneAvailable:e,microphoneLabel:c}},D=async()=>{try{return(await d("audioinput"))?.label??""}catch(e){return m.addError("Failed to fetch default media device",{error:e}),"Error accessing microphone devices"}};export{y as u};
//# sourceMappingURL=b6m424ytdgqoc0cg.js.map

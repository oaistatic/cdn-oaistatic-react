const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/c2hf8ltof6re6a1m.js","assets/ls1hkjm4csy89kc5.js","assets/jfjoua4700kji9z3.js","assets/root-g83krhyb.css","assets/f06euqb6n9n90ph6.js","assets/hj6jep7mk4776vwc.js","assets/conversation-small-hvit8l60.css","assets/ku2v3k21go7flov6.js","assets/d5p4hcq0p8tkk0hi.js","assets/lffgvq8meznwnms4.js","assets/jv41l9bnged4ycs1.js","assets/maaa59io6z1tsugr.js","assets/bjo64t20o3wf7ixl.js","assets/iwazw5q362siufqb.js","assets/b9iv65ef6it0bnl8.js","assets/h1em0bjkpkjv8ykw.js","assets/gstsldttv6qa02ku.js","assets/kmym47afujuunb5s.js","assets/b6m424ytdgqoc0cg.js"])))=>i.map(i=>d[i]);
import{en as O,I as kA,P as le,l as ue,dW as de,eG as me,dN as ge,hc as fe,F as nA,E as hA,dU as he,dF as pe,cW as Ce,cH as Ee,a as iA,cX as SA,cr as JA,bL as be,cp as _A,co as ve,hd as ke}from"./jfjoua4700kji9z3.js";import{r as o,g as Se,k as Be,f as XA,e as Y,j as l,a8 as D,a9 as q}from"./ls1hkjm4csy89kc5.js";import{h8 as sA,gN as cA,qb as lA,qc as LA,e$ as Ie,h7 as y,o as Me,bk as WA,b9 as xA,y as we,mK as ye,d8 as BA,h9 as xe,qd as IA,qe as MA,qf as Qe,qg as F}from"./hj6jep7mk4776vwc.js";import{a as Ve,$ as Te,C as Re,_ as x,y as je,W as H,O as PA,N as De,S as eA,I as UA,R as Ze,Y as Oe,F as Ye,x as Ne,b as wA,u as qA,g as pA,c as Fe,d as Ge,s as Je,B as HA,e as _e,f as Xe,h as Le,G as We,n as Pe,i as Ue,v as qe,j as He,X as QA,k as Ke,l as ze,V as $e,m as At,o as et}from"./ku2v3k21go7flov6.js";import{e as VA,R as tt,a as G,M as ot,C as TA,b as J,c as CA,d as EA,T as nt,f as KA,h as it,L as bA,E as st}from"./bjo64t20o3wf7ixl.js";import{S as at}from"./kmym47afujuunb5s.js";import{u as rt}from"./b6m424ytdgqoc0cg.js";import{M as ct}from"./iwazw5q362siufqb.js";function lt(){const A=sA(),e=Ve(),t=o.useCallback(()=>{cA.debug("disconnected from room"),lA(A)},[A]),n=o.useCallback(c=>{e.danger("Something went wrong"),cA.error("an error occurred within the room",c);const a=VA(A.getState());O.voiceMode.error({...a,error:c.message}),A.setState(s=>{s.metrics.livekitConnectSuccessTime||(s.metrics.livekitConnectFailTime=new Date)}),lA(A)},[e,A]),i=o.useCallback(c=>{e.danger("Something went wrong"),cA.error("an encryption error occurred within the room",c);const a=VA(A.getState());O.voiceMode.error({encryptionError:c.message,eventSource:"voice-session",...a}),A.setState(s=>{s.metrics.livekitConnectSuccessTime||(s.metrics.livekitConnectFailTime=new Date)}),lA(A)},[e,A]);return{onDisconnected:t,onError:n,onEncryptionError:i}}function zA(A){var e,t,n="";if(typeof A=="string"||typeof A=="number")n+=A;else if(typeof A=="object")if(Array.isArray(A)){var i=A.length;for(e=0;e<i;e++)A[e]&&(t=zA(A[e]))&&(n&&(n+=" "),n+=t)}else for(t in A)A[t]&&(n&&(n+=" "),n+=t);return n}function ut(){for(var A,e,t=0,n="",i=arguments.length;t<i;t++)(A=arguments[t])&&(e=zA(A))&&(n&&(n+=" "),n+=e);return n}function dt(...A){return(...e)=>{for(const t of A)if(typeof t=="function")try{t(...e)}catch(n){console.error(n)}}}function $A(...A){const e={...A[0]};for(let t=1;t<A.length;t++){const n=A[t];for(const i in n){const c=e[i],a=n[i];typeof c=="function"&&typeof a=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=dt(c,a):(i==="className"||i==="UNSAFE_className")&&typeof c=="string"&&typeof a=="string"?e[i]=ut(c,a):e[i]=a!==void 0?a:c}}return e}const mt={connect:!0,audio:!1,video:!1};function gt(A){const{token:e,serverUrl:t,options:n,room:i,connectOptions:c,connect:a,audio:s,video:r,screen:u,onConnected:g,onDisconnected:d,onError:f,onMediaDeviceFailure:C,onEncryptionError:E,simulateParticipants:m,...p}={...mt,...A};n&&i&&x.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[h,k]=o.useState();o.useEffect(()=>{k(i??new tt(n))},[i]);const I=o.useMemo(()=>{const{className:S}=je();return $A(p,{className:S})},[p]);return o.useEffect(()=>{if(!h)return;const S=()=>{const B=h.localParticipant;x.debug("trying to publish local tracks"),Promise.all([B.setMicrophoneEnabled(!!s,typeof s!="boolean"?s:void 0),B.setCameraEnabled(!!r,typeof r!="boolean"?r:void 0),B.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(w=>{x.warn(w),f?.(w)})},M=B=>{const w=ot.getFailure(B);C?.(w)},v=B=>{E?.(B)};return h.on(G.SignalConnected,S).on(G.MediaDevicesError,M).on(G.EncryptionError,v),()=>{h.off(G.SignalConnected,S).off(G.MediaDevicesError,M).off(G.EncryptionError,v)}},[h,s,r,u,f,E,C]),o.useEffect(()=>{if(h){if(m){h.simulateParticipants({participants:{count:m},publish:{audio:!0,useRealTracks:!0}});return}if(!e){x.debug("no token yet");return}if(!t){x.warn("no livekit url provided"),f?.(Error("no livekit url provided"));return}a?(x.debug("connecting"),h.connect(t,e,c).catch(S=>{x.warn(S),f?.(S)})):(x.debug("disconnecting because connect is false"),h.disconnect())}},[a,e,JSON.stringify(c),h,f,t,m]),o.useEffect(()=>{if(!h)return;const S=M=>{switch(M){case TA.Disconnected:d&&d();break;case TA.Connected:g&&g();break}};return h.on(G.ConnectionStateChanged,S),()=>{h.off(G.ConnectionStateChanged,S)}},[e,g,d,h]),o.useEffect(()=>{if(h)return()=>{x.info("disconnecting on onmount"),h.disconnect()}},[h]),{room:h,htmlProps:I}}const ft=o.forwardRef(function(A,e){const{room:t,htmlProps:n}=gt(A);return o.createElement("div",{ref:e,...n},t&&o.createElement(Te.Provider,{value:t},o.createElement(Re.Provider,{value:A.featureFlags},A.children)))});function ht(A){return A!==void 0}function pt(...A){return $A(...A.filter(ht))}function Ae(A,e={}){const[t,n]=o.useState(Ze(A)),[i,c]=o.useState(t?.isMuted),[a,s]=o.useState(t?.isSubscribed),[r,u]=o.useState(t?.track),[g,d]=o.useState("landscape"),f=o.useRef(),{className:C,trackObserver:E}=o.useMemo(()=>Oe(A),[A.participant.sid??A.participant.identity,A.source,Ye(A)&&A.publication.trackSid]);return o.useEffect(()=>{const m=E.subscribe(p=>{x.debug("update track",p),n(p),c(p?.isMuted),s(p?.isSubscribed),u(p?.track)});return()=>m?.unsubscribe()},[E]),o.useEffect(()=>{var m,p;return r&&(f.current&&r.detach(f.current),(m=e.element)!=null&&m.current&&!(PA(A.participant)&&r?.kind==="audio")&&r.attach(e.element.current)),f.current=(p=e.element)==null?void 0:p.current,()=>{f.current&&r?.detach(f.current)}},[r,e.element]),o.useEffect(()=>{var m,p;if(typeof((m=t?.dimensions)==null?void 0:m.width)=="number"&&typeof((p=t?.dimensions)==null?void 0:p.height)=="number"){const h=t.dimensions.width>t.dimensions.height?"landscape":"portrait";d(h)}},[t]),{publication:t,isMuted:i,isSubscribed:a,track:r,elementProps:pt(e.props,{className:C,"data-lk-local-participant":A.participant.isLocal,"data-lk-source":t?.source,...t?.kind==="video"&&{"data-lk-orientation":g}})}}var Ct="Expected a function",RA=NaN,Et="[object Symbol]",bt=/^\s+|\s+$/g,vt=/^[-+]0x[0-9a-f]+$/i,kt=/^0b[01]+$/i,St=/^0o[0-7]+$/i,Bt=parseInt,It=typeof eA=="object"&&eA&&eA.Object===Object&&eA,Mt=typeof self=="object"&&self&&self.Object===Object&&self,wt=It||Mt||Function("return this")(),yt=Object.prototype,xt=yt.toString,Qt=Math.max,Vt=Math.min,uA=function(){return wt.Date.now()};function Tt(A,e,t){var n,i,c,a,s,r,u=0,g=!1,d=!1,f=!0;if(typeof A!="function")throw new TypeError(Ct);e=jA(e)||0,vA(t)&&(g=!!t.leading,d="maxWait"in t,c=d?Qt(jA(t.maxWait)||0,e):c,f="trailing"in t?!!t.trailing:f);function C(v){var B=n,w=i;return n=i=void 0,u=v,a=A.apply(w,B),a}function E(v){return u=v,s=setTimeout(h,e),g?C(v):a}function m(v){var B=v-r,w=v-u,R=e-B;return d?Vt(R,c-w):R}function p(v){var B=v-r,w=v-u;return r===void 0||B>=e||B<0||d&&w>=c}function h(){var v=uA();if(p(v))return k(v);s=setTimeout(h,m(v))}function k(v){return s=void 0,f&&n?C(v):(n=i=void 0,a)}function I(){s!==void 0&&clearTimeout(s),u=0,n=r=i=s=void 0}function S(){return s===void 0?a:k(uA())}function M(){var v=uA(),B=p(v);if(n=arguments,i=this,r=v,B){if(s===void 0)return E(r);if(d)return s=setTimeout(h,e),C(r)}return s===void 0&&(s=setTimeout(h,e)),a}return M.cancel=I,M.flush=S,M}function vA(A){var e=typeof A;return!!A&&(e=="object"||e=="function")}function Rt(A){return!!A&&typeof A=="object"}function jt(A){return typeof A=="symbol"||Rt(A)&&xt.call(A)==Et}function jA(A){if(typeof A=="number")return A;if(jt(A))return RA;if(vA(A)){var e=typeof A.valueOf=="function"?A.valueOf():A;A=vA(e)?e+"":e}if(typeof A!="string")return A===0?A:+A;A=A.replace(bt,"");var t=kt.test(A);return t||St.test(A)?Bt(A.slice(2),t?2:8):vt.test(A)?RA:+A}var Dt=Tt;const DA=Ne(Dt);function Zt(A){const e=o.useRef(A);e.current=A,o.useEffect(()=>()=>{e.current()},[])}function Ot(A,e=500,t){const n=o.useRef();Zt(()=>{n.current&&n.current.cancel()});const i=o.useMemo(()=>{const c=DA(A,e,t),a=(...s)=>c(...s);return a.cancel=()=>{c.cancel()},a.isPending=()=>!!n.current,a.flush=()=>c.flush(),a},[A,e,t]);return o.useEffect(()=>{n.current=DA(A,e,t)},[A,e,t]),i}function Yt(A,e,t){const n=(u,g)=>u===g,i=A instanceof Function?A():A,[c,a]=o.useState(i),s=o.useRef(i),r=Ot(a,e,t);return n(s.current,i)||(r(i),s.current=i),[c,r]}function Nt({threshold:A=0,root:e=null,rootMargin:t="0%",freezeOnceVisible:n=!1,initialIsIntersecting:i=!1,onChange:c}={}){var a;const[s,r]=o.useState(null),[u,g]=o.useState(()=>({isIntersecting:i,entry:void 0})),d=o.useRef();d.current=c;const f=((a=u.entry)==null?void 0:a.isIntersecting)&&n;o.useEffect(()=>{if(!s||!("IntersectionObserver"in window)||f)return;let m;const p=new IntersectionObserver(h=>{const k=Array.isArray(p.thresholds)?p.thresholds:[p.thresholds];h.forEach(I=>{const S=I.isIntersecting&&k.some(M=>I.intersectionRatio>=M);g({isIntersecting:S,entry:I}),d.current&&d.current(S,I),S&&n&&m&&(m(),m=void 0)})},{threshold:A,root:e,rootMargin:t});return p.observe(s),()=>{p.disconnect()}},[s,JSON.stringify(A),e,t,f,n]);const C=o.useRef(null);o.useEffect(()=>{var m;!s&&(m=u.entry)!=null&&m.target&&!n&&!f&&C.current!==u.entry.target&&(C.current=u.entry.target,g({isIntersecting:i,entry:void 0}))},[s,u.entry,n,f,i]);const E=[r,!!u.isIntersecting,u.entry];return E.ref=E[0],E.isIntersecting=E[1],E.entry=E[2],E}const ee=o.forwardRef(function({onTrackClick:A,onClick:e,onSubscriptionStatusChanged:t,trackRef:n,manageSubscription:i,...c},a){const s=UA(n),r=o.useRef(null);o.useImperativeHandle(a,()=>r.current);const u=Nt({root:r.current}),[g]=Yt(u,3e3);o.useEffect(()=>{i&&s.publication instanceof CA&&g?.isIntersecting===!1&&u?.isIntersecting===!1&&s.publication.setSubscribed(!1)},[g,s,i]),o.useEffect(()=>{i&&s.publication instanceof CA&&u?.isIntersecting===!0&&s.publication.setSubscribed(!0)},[u,s,i]);const{elementProps:d,publication:f,isSubscribed:C}=Ae(s,{element:r,props:c});o.useEffect(()=>{t?.(!!C)},[C,t]);const E=m=>{e?.(m),A?.({participant:s?.participant,track:f})};return o.createElement("video",{ref:r,...d,muted:!0,onClick:E})}),Ft=o.forwardRef(function({trackRef:A,onSubscriptionStatusChanged:e,volume:t,muted:n,...i},c){const a=UA(A),s=o.useRef(null);o.useImperativeHandle(c,()=>s.current);const{elementProps:r,isSubscribed:u,track:g,publication:d}=Ae(a,{element:s,props:i});return o.useEffect(()=>{e?.(!!u)},[u,e]),o.useEffect(()=>{g===void 0||t===void 0||(g instanceof EA?g.setVolume(t):x.warn("Volume can only be set on remote audio tracks."))},[t,g]),o.useEffect(()=>{d===void 0||n===void 0||(d instanceof CA?d.setEnabled(!n):x.warn("Can only call setEnabled on remote track publications."))},[n,d,g]),o.createElement("audio",{ref:s,...r})});function Gt({volume:A,muted:e}){const t=H([J.Source.Microphone,J.Source.ScreenShareAudio,J.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(n=>!PA(n.participant)&&n.publication.kind===J.Kind.Audio);return o.createElement("div",{style:{display:"none"}},t.map(n=>o.createElement(Ft,{key:De(n),trackRef:n,volume:A,muted:e})))}function te({conversationId:A}){const{shouldDelayDisconnect:e,delayDisconnect:t,immediateDisconnect:n}=wA({refetchLater:!0}),{toggleMute:i}=LA(),c=kA(A),a=sA();return o.useCallback(async()=>{O.voiceSessionEndedByUser.click(),a.setState(u=>{u.metrics.sessionEndTime=new Date}),Ie.setState({voiceFeedbackThread:c,lastVoiceSessionEndTime:new Date});const{voiceMode:s,metrics:r}=a.getState();if(s==="advanced"){const u=g=>g.length>0?g.reduce((d,f)=>d+f,0)/g.length:void 0;le.logEvent("Voice Session End Summary",{session_create_time:r.sessionCreateTime?.toISOString(),get_status_sent_time:r.getStatusSentTime?.toISOString(),get_status_success_time:r.getStatusSuccessTime?.toISOString(),get_status_failed_time:r.getStatusFailedTime?.toISOString(),get_token_sent_time:r.getTokenSentTime?.toISOString(),get_token_success_time:r.getTokenSuccessTime?.toISOString(),get_token_failed_time:r.getTokenFailedTime?.toISOString(),conversation_start_success_time:r.conversationStartSuccessTime?.toISOString(),conversation_start_fail_time:r.conversationStartFailTime?.toISOString(),livekit_connect_time:r.livekitConnectTime?.toISOString(),livekit_connect_success_time:r.livekitConnectSuccessTime?.toISOString(),livekit_connect_fail_time:r.livekitConnectFailTime?.toISOString(),session_connected_time:r.sessionConnectedTime?.toISOString(),session_end_time:r.sessionEndTime?.toISOString(),avg_total_latency_ms:u(r.totalLatencyMs),avg_rtt_ms:u(r.currentRttMs),num_of_turns_speaking:r.numSpeaking,num_of_turns_thinking:r.numThinking,num_of_turns_listening:r.numListening})}e?(await i(),t()):n()},[t,n,c,e,i,a])}var Jt={webm:"data:video/webm;base64,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",mp4:"data:video/mp4;base64,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"};const{webm:_t,mp4:Xt}=Jt,dA=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,mA=()=>"wakeLock"in navigator;class Lt{constructor(){if(this.enabled=!1,mA()){this._wakeLock=null;const e=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",e),document.addEventListener("fullscreenchange",e)}else dA()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",_t),this._addSourceToVideo(this.noSleepVideo,"mp4",Xt),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(e,t,n){var i=document.createElement("source");i.src=n,i.type=`video/${t}`,e.appendChild(i)}get isEnabled(){return this.enabled}enable(){return mA()?navigator.wakeLock.request("screen").then(e=>{this._wakeLock=e,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(e=>{throw this.enabled=!1,console.error(`${e.name}, ${e.message}`),e}):dA()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(t=>(this.enabled=!0,t)).catch(t=>{throw this.enabled=!1,t})}disable(){mA()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):dA()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}}var Wt=Lt;const Pt=Se(Wt),ZA="mode",Ut="voice",qt=()=>{const[A,e]=Be(),t=A.get(ZA),n=sA(),i=y(g=>g.isVoiceModeActive),{isUnauthenticated:c}=ue(),a=Me(),s=de(),r=!c,u=XA();o.useEffect(()=>{t===Ut&&!i&&(e(g=>(g.delete(ZA),g)),s?u("/update-app"):r?n.setState({isVoiceModeActive:!0}):a({authType:"login",callbackUrl:window.location.href}))},[r,s,t,u,a,e,i,n])},Ht=A=>o.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...A},o.createElement("path",{d:"M7.5 8.91422V10.5C7.5 12.9853 9.51472 15 12 15C12.4787 15 12.9399 14.9253 13.3726 14.7868L14.5285 15.9427C13.7599 16.3004 12.9031 16.5 11.9999 16.5C9.28338 16.5 6.98608 14.6939 6.24825 12.2148C6.09071 11.6854 5.53389 11.384 5.00455 11.5415C4.47521 11.6991 4.17381 12.2559 4.33134 12.7852C5.22277 15.7805 7.82091 18.0418 11 18.4381V19.5H9.5C8.94772 19.5 8.5 19.9477 8.5 20.5C8.5 21.0523 8.94772 21.5 9.5 21.5H14.5C15.0523 21.5 15.5 21.0523 15.5 20.5C15.5 19.9477 15.0523 19.5 14.5 19.5H13V18.4381C14.086 18.3027 15.1043 17.9496 16.0098 17.424L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L7.5 8.91422Z",fill:"currentColor"}),o.createElement("path",{d:"M17.3874 13.1448L18.8601 14.6174C19.202 14.0488 19.4753 13.4343 19.6685 12.7852C19.826 12.2559 19.5246 11.6991 18.9953 11.5415C18.466 11.384 17.9091 11.6854 17.7516 12.2148C17.6557 12.537 17.5335 12.8478 17.3874 13.1448Z",fill:"currentColor"}),o.createElement("path",{d:"M8.46182 4.21918L16.2436 12.001C16.4096 11.5315 16.5 11.0263 16.5 10.5V7C16.5 4.51472 14.4853 2.5 12 2.5C10.5644 2.5 9.28577 3.17227 8.46182 4.21918Z",fill:"currentColor"})),Kt=A=>o.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...A},o.createElement("path",{d:"M7.50002 7C7.50002 4.51472 9.51474 2.5 12 2.5C14.4853 2.5 16.5 4.51472 16.5 7V10.5C16.5 12.9853 14.4853 15 12 15C9.51474 15 7.50002 12.9853 7.50002 10.5V7Z",fill:"currentColor"}),o.createElement("path",{d:"M18.9953 11.5415C19.5246 11.6991 19.826 12.2559 19.6685 12.7852C18.7771 15.7804 16.179 18.0417 13 18.4381V19.5H14.5C15.0523 19.5 15.5 19.9477 15.5 20.5C15.5 21.0523 15.0523 21.5 14.5 21.5H9.50002C8.94773 21.5 8.50002 21.0523 8.50002 20.5C8.50002 19.9477 8.94773 19.5 9.50002 19.5H11V18.4381C7.82093 18.0418 5.22279 15.7805 4.33136 12.7852C4.17382 12.2559 4.47522 11.6991 5.00456 11.5415C5.5339 11.384 6.09073 11.6854 6.24827 12.2148C6.98609 14.6939 9.28339 16.5 11.9999 16.5C14.7165 16.5 17.0138 14.6939 17.7516 12.2148C17.9091 11.6854 18.466 11.384 18.9953 11.5415Z",fill:"currentColor"})),zt=A=>o.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...A},o.createElement("path",{d:"M16.2413 3H7.7587C6.95374 2.99999 6.28937 2.99998 5.74818 3.04419C5.18608 3.09012 4.66937 3.18868 4.18404 3.43598C3.43139 3.81947 2.81947 4.43139 2.43598 5.18404C2.18868 5.66937 2.09012 6.18608 2.04419 6.74818C1.99998 7.28937 1.99999 7.95372 2 8.75869V15.2413C1.99999 16.0463 1.99998 16.7106 2.04419 17.2518C2.09012 17.8139 2.18868 18.3306 2.43598 18.816C2.81947 19.5686 3.43139 20.1805 4.18404 20.564C4.66937 20.8113 5.18608 20.9099 5.74818 20.9558C6.28936 21 6.95372 21 7.75868 21H16.2413C17.0463 21 17.7106 21 18.2518 20.9558C18.8139 20.9099 19.3306 20.8113 19.816 20.564C20.5686 20.1805 21.1805 19.5686 21.564 18.816C21.8113 18.3306 21.9099 17.8139 21.9558 17.2518C22 16.7106 22 16.0463 22 15.2413V8.75868C22 7.95372 22 7.28936 21.9558 6.74818C21.9099 6.18608 21.8113 5.66937 21.564 5.18404C21.1805 4.43139 20.5686 3.81947 19.816 3.43598C19.3306 3.18868 18.8139 3.09012 18.2518 3.04419C17.7106 2.99998 17.0463 2.99999 16.2413 3ZM6.5 9.5C10.366 9.5 13.5 12.634 13.5 16.5C13.5 17.0523 13.0523 17.5 12.5 17.5C11.9477 17.5 11.5 17.0523 11.5 16.5C11.5 13.7386 9.26142 11.5 6.5 11.5C5.94772 11.5 5.5 11.0523 5.5 10.5C5.5 9.94772 5.94772 9.5 6.5 9.5ZM6.5 13.5C8.15685 13.5 9.5 14.8431 9.5 16.5C9.5 17.0523 9.05229 17.5 8.5 17.5C7.94772 17.5 7.5 17.0523 7.5 16.5C7.5 15.9477 7.05229 15.5 6.5 15.5C5.94772 15.5 5.5 15.0523 5.5 14.5C5.5 13.9477 5.94772 13.5 6.5 13.5Z",fill:"currentColor"})),$t=A=>o.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...A},o.createElement("path",{d:"M7.7587 4.5C6.95374 4.49999 6.28937 4.49998 5.74818 4.54419C5.18608 4.59012 4.66937 4.68868 4.18404 4.93598C3.43139 5.31947 2.81947 5.93139 2.43598 6.68404C2.18868 7.16937 2.09012 7.68608 2.04419 8.24818C1.99998 8.78937 1.99999 9.45372 2 10.2587V13.7413C1.99999 14.5463 1.99998 15.2106 2.04419 15.7518C2.09012 16.3139 2.18868 16.8306 2.43598 17.316C2.81947 18.0686 3.43139 18.6805 4.18404 19.064C4.66937 19.3113 5.18608 19.4099 5.74818 19.4558C6.28938 19.5 6.95375 19.5 7.75873 19.5H10.7413C11.5463 19.5 12.2106 19.5 12.7518 19.4558C13.3139 19.4099 13.8306 19.3113 14.316 19.064C15.0686 18.6805 15.6805 18.0686 16.064 17.316C16.3113 16.8306 16.4099 16.3139 16.4558 15.7518C16.5 15.2106 16.5 14.5463 16.5 13.7413V10.2587C16.5 9.45375 16.5 8.78938 16.4558 8.24818C16.4099 7.68608 16.3113 7.16937 16.064 6.68404C15.6805 5.93139 15.0686 5.31947 14.316 4.93598C13.8306 4.68868 13.3139 4.59012 12.7518 4.54419C12.2106 4.49998 11.5463 4.49999 10.7413 4.5H7.7587Z",fill:"currentColor"}),o.createElement("path",{d:"M23 7.8312C23 6.55258 21.5028 5.86019 20.5285 6.68829L18.5285 8.38829C18.1932 8.67329 18 9.09115 18 9.5312V14.4688C18 14.9088 18.1932 15.3267 18.5285 15.6117L20.5285 17.3117C21.5028 18.1398 23 17.4474 23 16.1688V7.8312Z",fill:"currentColor"})),oe="inline-flex items-center bg-transparent text-token-text-secondary hover:text-token-text-primary",Ao=({message:A,onClick:e,type:t})=>{const n=Y(),i=me()&&ge;if(!A)return null;switch(t){case"microphone_denied":return i?l.jsxs("a",{href:"ms-settings:privacy-microphone",className:oe,children:[A,l.jsx(WA,{className:"icon-sm ms-1"})]}):l.jsx(OA,{onClick:e,message:A});case"connection_quality":return l.jsxs("div",{className:"inline-flex items-center",children:[A,l.jsx("button",{onClick:e,className:"ms-1",children:l.jsx("strong",{children:n.formatMessage(ne.retry)})})]});case"normal":return l.jsx(OA,{onClick:e,message:A})}},OA=({message:A,onClick:e})=>{const t=Y();return l.jsxs("button",{onClick:e,className:oe,"aria-label":t.formatMessage(ne.openInfoModal),children:[A,l.jsx(WA,{className:"icon-sm ms-1"})]})},ne={openInfoModal:{id:"hintMessage.openInfoModal",defaultMessage:"Open info modal",description:"Open info modal about voice mode usage"},retry:{id:"hintMessage.retry",defaultMessage:"Retry",description:"Retry text next to lost connection message"}};function eo(A){const{button:e,conversationId:t,onClick:n}=A,i=kA(t),{startVoiceMode:c}=qA(),a=XA(),s=o.useCallback(()=>{switch(e.action){case"new_chat":{we("/"),c(pA({serverThreadId:void 0,isAdvancedMode:!0,eventSource:`modal_${e.action}`,parentMessageId:void 0,clientThreadId:he(),gizmoId:void 0}));break}case"switch_to_standard":i&&c(pA({serverThreadId:i,isAdvancedMode:!1,eventSource:`modal_${e.action}`,parentMessageId:void 0,clientThreadId:i,gizmoId:nA.getGizmoId(hA(t))}));break;case"upgrade_to_plus":xA(a,"Voice Mode Upgrade To Plus Modal");break;case"upgrade_to_pro":xA(a,"Voice Mode Upgrade To Pro Modal");break}n?.()},[e.action,t,a,n,i,c]);return l.jsx(pe.Button,{onClick:s,title:e.title,color:A.color})}const to={primary:"primary",secondary:"secondary",tertiary:"ghost"};function oo({buttons:A,conversationId:e,onClick:t}){let n,i,c;const a=o.useCallback(s=>()=>{s==="upgrade_to_plus"?O.upsell.upgradeToPlus():s==="upgrade_to_pro"&&O.upsell.upgradeToPro(),t()},[t]);return!A||A.length===0?{primary:void 0,secondary:void 0,tertiary:void 0}:(A.forEach(s=>{if(!fe.includes(s.action))return;const u=l.jsx(eo,{button:s,conversationId:e,onClick:a(s.action),color:to[s.style]});switch(s.style){case"primary":n=u;break;case"secondary":i=u;break;case"tertiary":c=u;break}}),{primary:n,secondary:i,tertiary:c})}function no({conversationId:A,isOpen:e,onClose:t,buttons:n,title:i,description_markdown:c}){const a=oo({buttons:n,conversationId:A,onClick:t}),s=l.jsx(ct,{className:"markdown text-token-text-secondary mb-6",urlTransform:r=>r,children:c});return l.jsx(Ce,{testId:"modal-voice-rate-limit",title:i,isOpen:e,onClose:t,size:"custom",className:"max-w-[550px]",type:"warning",showCloseButton:!0,children:l.jsxs("div",{className:"w-full",children:[s,l.jsxs("div",{className:"flex flex-row justify-end gap-6",children:[a.primary,a.secondary,a.tertiary]})]})})}function io({conversationId:A}){const e=Y(),t=sA(),n=te({conversationId:A}),i=y(b=>b.server.usage),c=y(b=>b.server.voiceConnectionQuality),a=b=>b===KA.Lost,s=ye(),{voiceName:r}=BA(),[u,g]=o.useState(!1),d=y(b=>b.server.toolUpdate),[f,C]=o.useState(!1),[E,m]=o.useState(!0),[p,h]=o.useState(null),[k,I]=o.useState(null),[S,M]=o.useState(null),v=o.useRef(!1),{prospectiveModelId:B}=xe(A),w=kA(A),{startVoiceMode:R,stopVoiceMode:z,isVoiceModeActive:Q}=qA(),$=y(b=>b.server.connectionState),{requestMicrophonePermissions:W,userDeclinedMicrophonePermissions:V,microphoneAvailable:N,microphoneLabel:aA}=rt();o.useEffect(()=>{W()},[W]),o.useEffect(()=>{Q&&V&&(g(!1),M(null),h(e.formatMessage(gA.hint)),I({title:e.formatMessage(gA.title),description_markdown:e.formatMessage(gA.description_markdown),buttons:[]}))},[e,Q,V]),o.useEffect(()=>{if(N&&!$&&!v.current){v.current=!0,h(null),I(null);const b=hA(A),Z=pA({serverThreadId:w,parentMessageId:nA.getCurrentNode(b)?.id,isAdvancedMode:!0,eventSource:"composer_speech_button",clientThreadId:A,gizmoId:nA.getGizmoId(b)});O.voiceSessionStarted.click({voice:r}),Z.requested_default_model=B??void 0,R(Z)}},[A,$,N,w,R,r,B]);const{reaching_limit_disclosure:_,exceed_limit_message:j}=i?.rate_limit_message??{},X=s?.modes.find(b=>b.mode===s?.default_voice_mode),T=X?.disclosure_message,P=a(c)?"Lost connection.":_?.hint??j?.title??T?.hint??null;o.useEffect(()=>{X&&!V&&h(X.disclosure_message?.hint??null)},[X,V]),o.useEffect(()=>{const b=d?.text;let Z,AA,L;return b&&(m(!1),Z=setTimeout(()=>{C(!0),AA=setTimeout(()=>{C(!1),L=setTimeout(()=>{m(!0),t.setState(ce=>{ce.server.toolUpdate=null})},750)},3e3)},750)),()=>{clearTimeout(Z),clearTimeout(AA),clearTimeout(L)}},[d,t]),o.useEffect(()=>{if(!V){if(P&&h(P),j&&Q){z();const b={title:j.title,description_markdown:j.description_markdown,buttons:j.buttons};u?M(b):(I(b),g(!0));const Z=j.buttons.some(L=>L.action==="upgrade_to_plus"),AA=j.buttons.some(L=>L.action==="upgrade_to_pro");O.rateLimitReached.success({upgrade_to_plus:Z,upgrade_to_pro:AA})}else if(!k){const b=_??T;b&&I({title:b.title,description_markdown:b.message_markdown,buttons:b.buttons})}}},[T,j,P,u,Q,k,_,z,V]);const rA=o.useCallback(()=>{S&&(I(S),M(null)),g(!0)},[S]),se=o.useCallback(()=>{g(!1)},[]),ae=y(b=>b.voiceMode),re=async()=>{try{h(null),await R({conversation_id:w,eventSource:"lost_connection_hint_message",voice_mode:ae,voice:r,clientThreadId:A,gizmo_id:nA.getGizmoId(hA(A))})}catch(b){const Z=b instanceof Error?b.message:String(b);O.voiceMode.error({error:Z,eventSource:"lost_connection_hint_message"})}};let U;return V?U="microphone_denied":a(c)?U="connection_quality":U="normal",l.jsxs("div",{className:"flex w-full flex-col items-center",children:[l.jsxs("div",{className:"text-token-text-secondary relative mb-6 flex min-h-5 w-full items-center justify-center text-xs",children:[d?.text&&l.jsx(D.div,{initial:{opacity:0},animate:{opacity:f?1:0},transition:{duration:.5},style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center"},children:l.jsxs("div",{className:"flex items-center",children:[d?.text&&l.jsx(at,{className:"icon-sm me-1"}),d?.text]})}),l.jsx(D.div,{initial:{opacity:0},animate:{opacity:E?1:0},transition:{duration:.5},style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:d?.text?"none":"auto",cursor:d?.text?"default":"pointer"},children:l.jsx("div",{className:"flex items-center",children:l.jsx(Ao,{type:U,message:p,onClick:U==="connection_quality"?re:rA})})})]}),l.jsxs("div",{className:iA("flex flex-row items-center gap-6","rounded-full px-3 py-1","transition-width duration-200 ease-in-out"),children:[l.jsx(YA,{capability:"video",children:l.jsx(so,{})}),l.jsx(ao,{hideTooltip:V,microphoneLabel:aA,isMicrophoneEnabled:N}),l.jsx(YA,{capability:"screenshare",children:l.jsx(ro,{})}),l.jsx(yA,{onClick:n})]}),l.jsx(no,{conversationId:A,isOpen:u,onClose:se,title:k?.title,description_markdown:k?.description_markdown,buttons:k?.buttons??[]})]})}function YA({children:A,capability:e}){return Fe()[e]?A:null}function so(){const{isVideoEnabled:A,isStartingVideo:e,toggleVideo:t}=IA(),n=Y();let i=null;e?i=SA:i=$t;const c=A?"bg-gray-900 hover:bg-gray-800 active:bg-gray-700":"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",a=A?"text-token-main-surface-primary":"text-token-main-surface-primary-inverse",s=n.formatMessage({id:"SRVwhB",defaultMessage:"Toggle video"});return l.jsx(K,{"aria-label":s,onClick:()=>t("ControlButton"),disabled:e,icon:i,className:c,iconColor:a})}function ao({hideTooltip:A,microphoneLabel:e,isMicrophoneEnabled:t}){const{isMuting:n,toggleMute:i}=LA(),c=Y(),{disconnectPending:a}=wA(),s=!!y(C=>C.dev.room?.localParticipant.isMicrophoneEnabled),r=t&&s,u=r?Kt:Ht,g=r?"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10":"bg-red-500/10 hover:bg-red-500/15 active:bg-red-500/20 dark:bg-red-500/10 dark:hover:bg-red-500/15 dark:active:bg-red-500/20",d=r?"text-token-main-surface-primary-inverse":"text-danger",f=r?c.formatMessage({id:"PJzixV",defaultMessage:"Turn off microphone"}):c.formatMessage({id:"nbbUMb",defaultMessage:"Turn on microphone"});return l.jsx(K,{"aria-label":f,onClick:i,icon:u,disabled:n||a,className:g,iconColor:d,tooltipPrimaryLabel:!A&&e?f:"",tooltipSecondaryLabel:e})}function ro(){const{isScreenshareEnabled:A,isScreenshareStarting:e,toggleScreenShare:t}=MA(),n=Y();let i=null;e?i=SA:i=zt;const c=A?"bg-gray-900 hover:bg-gray-800 active:bg-gray-700":"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",a=A?"text-token-main-surface-primary":"text-token-main-surface-primary-inverse",s=n.formatMessage({id:"ShdqyW",defaultMessage:"Toggle screenshare"});return l.jsx(K,{"aria-label":s,onClick:()=>t("ControlButton"),disabled:e,icon:i,className:c,iconColor:a})}function yA({className:A,onClick:e}){const t=Y(),{disconnectPending:n}=wA(),i="bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",c=t.formatMessage({id:"9Mto0a",defaultMessage:"End"});return l.jsx(K,{disabled:n,onClick:e,icon:n?SA:Qe,iconColor:"text-token-main-surface-primary-inverse",className:A??i,"aria-label":t.formatMessage({id:"7/8k4Y",defaultMessage:"End voice mode"}),tooltipPrimaryLabel:c})}function K(A){const{icon:e,disabled:t,className:n,iconColor:i="text-current",iconSize:c="icon-xl",buttonSize:a="h-16 w-16",tooltipPrimaryLabel:s,tooltipSecondaryLabel:r,...u}=A,[g,d]=o.useState(!1),f=o.useRef(void 0),C=o.useCallback(()=>{const p=window.setTimeout(()=>{d(!0)},nt);f.current=p},[]),E=o.useCallback(()=>{clearTimeout(f.current),d(!1)},[]),m=l.jsx(lo,{className:iA(n,a,"text-token-text-primary hover:text-token-text-secondary overflow-hidden rounded-full border-none p-0.5 transition-colors duration-200 ease-in-out"),disabled:t,...u,children:l.jsx(e,{className:iA(c,i)})});return s?l.jsx(JA,{sideOffset:14,label:s,secondaryLabel:r,contentClassName:"flex flex-col items-center justify-center",className:"flex",open:g,side:"top",children:l.jsx("span",{onPointerEnter:C,onPointerLeave:E,children:m})}):m}const co=o.forwardRef(function(e,t){return l.jsx(Ee,{...e,ref:t})}),lo=D.create(co),gA={hint:{id:"micMessages.hint",defaultMessage:"Enable microphone access in Settings",description:"Hint to the user to manually enable microphone access for voice mode"},title:{id:"micMessages.title",defaultMessage:"Microphone access required",description:"Title for modal that informs the user that microphone access is required for voice mode"},description_markdown:{id:"micMessages.description_markdown",defaultMessage:"To use voice mode, you'll need to enable your microphone and try again.",description:"Description for modal that informs the user that microphone access is required for voice mode"}};function uo({children:A}){const{isVideoEnabled:e}=IA(),{isScreenshareEnabled:t}=MA(),n=e||t;return l.jsx(q,{mode:"wait",children:n?l.jsx("div",{className:"flex h-full w-full flex-nowrap items-center",children:e?l.jsx(mo,{}):l.jsx(go,{})}):l.jsx(D.div,{className:"flex h-full w-full items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:A},"children")})}function mo(){const{isVideoEnabled:A,isStartingVideo:e,toggleVideo:t}=IA(),i=H([J.Source.Camera]).find(a=>a.participant.isLocal),c=A&&!e&&i;return o.useEffect(()=>{const a=i?.publication?.track;if(a){const s=()=>{t("Browser Video Controls")};return a.on("ended",s),()=>{a.off("ended",s)}}},[i,t]),l.jsx(q,{children:c&&l.jsx(ie,{children:l.jsxs("div",{className:"aspect-w-16 aspect-h-9 group relative max-h-[95%] w-fit max-w-[60%] overflow-hidden rounded-3xl shadow-md",children:[l.jsx("div",{className:"absolute end-2 top-2 z-10 opacity-0 transition-opacity group-hover:opacity-90",children:l.jsx(yA,{onClick:()=>t("StopButton"),className:"bg-gray-900/20 backdrop-blur-lg hover:bg-gray-900/30 dark:backdrop-blur-lg"})}),l.jsx(ee,{className:"h-full w-full object-contain",trackRef:i})]})},"camera-renderer")})}function go(){const{isScreenshareEnabled:A,isScreenshareStarting:e,toggleScreenShare:t}=MA(),i=H([J.Source.ScreenShare]).find(a=>a.participant.isLocal),c=A&&!e&&i;return o.useEffect(()=>{const a=i?.publication?.track;if(a){const s=()=>{t("Browser ScreenShare Controls")};return a.on("ended",s),()=>{a.off("ended",s)}}},[i,t]),l.jsx(q,{children:c&&l.jsx(ie,{children:l.jsxs("div",{className:"aspect-w-16 aspect-h-9 group relative max-h-[95%] w-fit max-w-[60%] overflow-hidden rounded-3xl shadow-md",children:[l.jsx("div",{className:"absolute end-2 top-2 z-10 opacity-0 transition-opacity group-hover:opacity-90",children:l.jsx(yA,{onClick:()=>t("StopButton"),className:"bg-gray-900/20 backdrop-blur-lg hover:bg-gray-900/30 dark:backdrop-blur-lg"})}),l.jsx(ee,{className:"h-full w-full object-contain",trackRef:i})]})},"screenshare-renderer")})}function ie({children:A,key:e}){return l.jsx(D.div,{className:"bg-token-main-surface-primary flex h-full w-full flex-col items-center justify-center gap-2",initial:{opacity:0,transform:"blur(12px)",scale:.75},animate:{opacity:1,transform:"blur(0px)",scale:1},exit:{opacity:0,transform:"blur(12px)",scale:.75},transition:{duration:.2},children:A},e)}const tA=(A,e)=>{const[t,n]=o.useState(A===e?performance.now():0),i=o.useRef(e);o.useEffect(()=>{i.current!==e&&A===e&&n(performance.now()),i.current=e},[e,A]);const c=o.useCallback(()=>{n(0)},[]);return[A===e?1:0,t,c]},oA=([A,e,t],n=500)=>{const[i,c]=o.useState(A),a=o.useRef(A),s=o.useRef(void 0),r=o.useCallback((u,g,d)=>{const f=C=>{const E=Math.min((C-u)/n,1),m=g+E*(d-g);c(m),E<1&&(s.current=requestAnimationFrame(f))};s.current=requestAnimationFrame(f)},[n]);return o.useEffect(()=>{if(a.current!==A){a.current=A,s.current&&cancelAnimationFrame(s.current);const u=i,g=A;r(performance.now(),u,g)}},[r,i,A]),[i,e/1e3,t]},NA=A=>{const[e,t]=o.useState({audioData:[0,0,0,0],cumulativeAudioData:[0,0,0,0]}),n=o.useRef([0,0,0,0]),i=o.useRef(void 0),c=o.useRef(performance.now()),{bandMagnitudes:a,cumulativeMagnitude:s}=Ge(A,{bands:3,bins:1,gainMultipliers:[10,1,1]});n.current=[...a,s].flat();const r=o.useCallback(()=>{const u=performance.now(),g=(u-c.current)/1e3;c.current=u;const d=n.current,{audioData:f,cumulativeAudioData:C}=e,E=Je({deltaTimeS:g,audioDataRaw:d,prevAudioData:f,prevCumulativeAudioData:C});t(E)},[e]);return o.useEffect(()=>(i.current||(i.current=window.setInterval(r,HA)),()=>{clearInterval(i.current),i.current=void 0}),[r]),e};function FA({className:A}){return l.jsx(ko,{className:A})}const fo=1.55,ho=1.4,po="audio",Co="shout",Eo="User",bo={bands:4,loPass:0,hiPass:400},GA=[300,300];function vo(){const A=be(),e=y(m=>m.voiceMode==="advanced"),t=H([J.Source.Microphone]),n=t.find(m=>m.publication.trackName===po),i=t.find(m=>m.publication.trackName===Co);let c=QA(i?.publication.audioTrack,bo);c.length===0&&(c=[0,0,0,0]),c.map(m=>m*ho);let a=NA(i?.publication.audioTrack),s=NA(n?.publication.audioTrack);const r=a.audioData.map((m,p)=>{const h=s.audioData[p];return m>0&&h>0?(m+h)/2:m>0?m:h}),u=a.cumulativeAudioData.map((m,p)=>{const h=s.cumulativeAudioData[p];return m>0&&h>0?(m+h)/2:m>0?m:h}),g=y(m=>m.server.remoteState),d=t.find(m=>m.participant.identity===Eo),f=(QA(d,{bands:1,loPass:0,hiPass:400})[0]??0)*fo,{voiceName:C}=BA();return{remoteState:g,userVolume:f,isAdvanced:e,avgMag:r,cumulativeAudio:u,isDarkMode:A,standardBloopVolumes:c,overrideColor:C==="shade"?"ANGSTY_BLACK":void 0}}function ko({className:A}){const{remoteState:e,userVolume:t,isAdvanced:n,avgMag:i,cumulativeAudio:c,isDarkMode:a,standardBloopVolumes:s,overrideColor:r}=vo(),[u,g]=o.useState(GA),{canvasSizeRef:d,handleCanvasSizeUpdate:f}=it(GA),C=o.useRef(void 0),E=o.useCallback(T=>{g([T.width,T.height])},[]),m=o.useRef([0,0,0,0]);o.useEffect(()=>{e===F.Connecting&&(m.current=[0,0,0,0])},[e]);const p=o.useRef(performance.now());o.useEffect(()=>{const T=performance.now();e===F.Speaking&&T-p.current>50&&(p.current=T,m.current=m.current.map((P,rA)=>P+i[rA]))},[e,i]);const[h,k]=oA(tA(F.Listening,e)),[I,S]=oA(tA(F.Speaking,e)),[M,v]=oA(tA(F.Thinking,e)),[B,w]=oA(tA(F.Halted,e)),[R,z]=o.useState(performance.now()/1e3);o.useEffect(()=>{const T=setInterval(()=>{z(performance.now()/1e3)},HA);return()=>clearInterval(T)},[]);const Q=o.useMemo(()=>performance.now()/1e3,[]),[$,W]=o.useState(1e5),V=o.useRef(e);o.useEffect(()=>{e===F.Connecting?W(1e5):V.current===F.Connecting&&W(R),V.current=e},[e,R]);const N=_e({isAdvanced:n,overrideColor:r}),aA=n?i:s,_=h===1||I===1,j=Xe({viewport:u,canvasSize:d.current,shouldMeasurePerf:_,source:"VoiceMode"}),X=Le({shouldCalibrate:_,viewport:u,initialScale:1});return C.current={time:R-Q,micLevel:t,stateListen:h,listenTimestamp:Math.max(k-Q,0),stateThink:M,thinkTimestamp:Math.max(v-Q,0),stateSpeak:I,speakTimestamp:Math.max(S-Q,0),readyTimestamp:$-Q,stateHalt:B,haltTimestamp:Math.max(w-Q,0),touchDownTimestamp:0,touchUpTimestamp:0,stateFailedToConnect:0,failedToConnectTimestamp:0,avgMag:aA,cumulativeAudio:c??m.current,isNewBloop:!0,isAdvancedBloop:n,bloopColorMain:Array.from(N.bloopColorMain),bloopColorLow:Array.from(N.bloopColorLow),bloopColorMid:Array.from(N.bloopColorMid),bloopColorHigh:Array.from(N.bloopColorHigh),isDarkMode:a,screenScaleFactor:window.devicePixelRatio,viewport:u,silenceAmount:0,silenceTimestamp:0,fadeBloopWhileListening:!1},l.jsx(We,{className:iA("flex items-center justify-center",A),variablesRef:C,onViewportUpdate:E,textureImage:Pe,textureName:"uTextureNoise",onGlAvailable:j,onCanvasSizeUpdate:f,scale:X,GLUniformsSetter:Ue,vert:qe,frag:He})}const So=A=>o.createElement("svg",{width:22,height:22,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",...A},o.createElement("path",{d:"M13.9167 2.83333C12.628 2.83333 11.5833 3.878 11.5833 5.16667C11.5833 6.45533 12.628 7.5 13.9167 7.5C15.2053 7.5 16.25 6.45533 16.25 5.16667C16.25 3.878 15.2053 2.83333 13.9167 2.83333ZM9.39702 4C9.91507 1.98723 11.7422 0.5 13.9167 0.5C16.0911 0.5 17.9183 1.98723 18.4363 4H20.3333C20.9777 4 21.5 4.52233 21.5 5.16667C21.5 5.811 20.9777 6.33333 20.3333 6.33333H18.4363C17.9183 8.3461 16.0911 9.83333 13.9167 9.83333C11.7422 9.83333 9.91507 8.3461 9.39702 6.33333H1.66667C1.02233 6.33333 0.5 5.811 0.5 5.16667C0.5 4.52233 1.02233 4 1.66667 4H9.39702ZM8.08333 14.5C6.79467 14.5 5.75 15.5447 5.75 16.8333C5.75 18.122 6.79467 19.1667 8.08333 19.1667C9.372 19.1667 10.4167 18.122 10.4167 16.8333C10.4167 15.5447 9.372 14.5 8.08333 14.5ZM3.56369 15.6667C4.08174 13.6539 5.90885 12.1667 8.08333 12.1667C10.2578 12.1667 12.0849 13.6539 12.603 15.6667H20.3333C20.9777 15.6667 21.5 16.189 21.5 16.8333C21.5 17.4777 20.9777 18 20.3333 18H12.603C12.0849 20.0128 10.2578 21.5 8.08333 21.5C5.90885 21.5 4.08174 20.0128 3.56369 18H1.66667C1.02233 18 0.5 17.4777 0.5 16.8333C0.5 16.189 1.02233 15.6667 1.66667 15.6667H3.56369Z",fill:"currentColor"})),Bo=({conversationId:A})=>{const e=H(),[t,n]=o.useState(!1),[i,c]=o.useState(!1),{voiceName:a}=BA(),s=Y(),r=o.useCallback(()=>{e&&e.length>0&&e.forEach(h=>{const{publication:k}=h;k.audioTrack instanceof bA?(c(k.audioTrack.isMuted),k.audioTrack.mute()):k.audioTrack instanceof EA&&k.audioTrack.setMuted(!0)})},[e]),u=o.useCallback(()=>{e&&e.length>0&&e.forEach(h=>{const{publication:k}=h;k.audioTrack instanceof bA?i||k.audioTrack.unmute():k.audioTrack instanceof EA&&k.audioTrack.setMuted(!1)})},[e,i]),g=o.useCallback(()=>{O.voiceSelectionShown.click({voice:a}),r(),n(!0)},[a,r]),d=()=>{u(),n(!1)},f=Ke(),C=a==="shade",{alreadyTriggered:E}=ze(),m=f&&!C&&!E,p=o.useMemo(()=>l.jsx(K,{onClick:g,icon:So,iconColor:"text-token-text-secondary",className:"h-[40px] w-[40px] bg-transparent hover:bg-black/10 active:bg-black/20 dark:bg-transparent dark:hover:bg-white/5 dark:active:bg-white/10",iconSize:"icon-md"}),[g]);return l.jsxs("div",{className:"relative h-[40px] w-[40px]",children:[m?l.jsx(JA,{label:s.formatMessage({id:"SxYG4e",defaultMessage:"Talk to Monday (ugh)"}),children:p}):p,t&&l.jsx($e,{conversationId:A,onClose:d})]})};class Io extends Worker{constructor(e,t){const n=String(e);super(n.includes("://")&&!n.startsWith(location.origin)?URL.createObjectURL(new Blob([`import("${n}")`],{type:"text/javascript"})):e,t)}}function Mo(A={}){const[e,t]=o.useState(!1),[n,i]=o.useState(!1),[c,a]=o.useState(!1);let s=At().microphoneTrack;const[r,u]=o.useState();A.trackRef&&(s=A.trackRef.publication);const g=o.useCallback(async d=>{if(d){const{KrispNoiseFilter:f,isKrispNoiseFilterSupported:C}=await _A(async()=>{const{KrispNoiseFilter:E,isKrispNoiseFilterSupported:m}=await import("./abe8buezm936ox2e.js");return{KrispNoiseFilter:E,isKrispNoiseFilterSupported:m}},[]);if(!C()){console.warn("Krisp noise filter is not supported in this browser");return}r||u(f(A.filterOptions))}t(f=>(f!==d&&i(!0),d))},[]);return o.useEffect(()=>{var d;if(s&&s.track instanceof bA&&r){const f=s.track.getProcessor();f&&f.name==="livekit-noise-filter"?(i(!0),f.setEnabled(e).finally(()=>{i(!1),a(e)})):!f&&e&&(i(!0),(d=s?.track)==null||d.setProcessor(r).then(()=>r.setEnabled(e)).then(()=>{a(!0)}).catch(C=>{a(!1),console.error(C)}).finally(()=>{i(!1)}))}},[e,s,r]),{setNoiseFilterEnabled:g,isNoiseFilterEnabled:c,isNoiseFilterPending:n,processor:r}}const wo=o.memo(function(){const{setNoiseFilterEnabled:e}=Mo();return o.useEffect(()=>{e(!0)},[e]),null}),yo=new Io(new URL("{{.assetPrefix}}/assets/livekit-client.e2ee.worker-DK0iMXIf.js",import.meta.url),{type:"module"}),xo=o.memo(function({children:e}){const t=o.useRef({keyProvider:new st}).current,[n,i]=o.useState(!1),{token:c,url:a,e2eeKey:s}=y(d=>d.credentials),r=lt(),u=y(d=>d.isVoiceModeActive),g=y(d=>d.audioInputDevice?.deviceId);return o.useEffect(()=>{const d=c&&a&&s;!n&&d?t.keyProvider.setKey(s).then(()=>{i(!0)}):n&&!d&&i(!1)},[c,a,s,n,t]),u?l.jsxs(ft,{...r,connect:!0,token:c??void 0,serverUrl:a??void 0,audio:{deviceId:{ideal:g,exact:g},noiseSuppression:!0,echoCancellation:!0},options:{e2ee:{keyProvider:t.keyProvider,worker:yo}},children:[e,n&&c&&a&&l.jsx(et,{}),n&&c&&a&&l.jsx(Gt,{}),n&&c&&a&&l.jsx(wo,{})]}):null}),Qo=ve(()=>_A(()=>import("./c2hf8ltof6re6a1m.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18])).then(A=>A.VoiceModeDevPanel));function Vo({conversationId:A}){const[e,t]=o.useState(!1),n=y(u=>u.isVoiceModeActive),i=y(u=>u.server.voiceConnectionQuality),c=y(u=>u.screenshare!=null),a=y(u=>u.video!=null),s=Y();qt();const r=te({conversationId:A});return ke(()=>{n&&r()}),o.useEffect(()=>{const u=new Pt;return n?u.enable():u.disable(),()=>{u.disable()}},[n]),l.jsxs(xo,{children:[l.jsx(q,{children:n?l.jsx(D.div,{className:"bg-token-main-surface-primary fixed start-0 top-0 z-50 flex h-full w-full flex-col",initial:"hidden",animate:"visible",exit:"hidden",variants:fA,children:l.jsxs(D.div,{className:"relative h-full w-full",variants:fA,children:[l.jsxs(D.div,{variants:fA,className:"flex h-full w-full flex-col justify-between gap-6",children:[l.jsxs(D.div,{className:"relative mt-6 flex w-full justify-center",children:[l.jsx("div",{className:"flex w-full items-center justify-center",children:(c||a)&&l.jsx(FA,{className:"h-16 w-16"})}),l.jsx("div",{className:"me-4",children:l.jsx(Bo,{conversationId:A})})]}),l.jsxs("div",{className:"flex h-full min-h-0 items-center justify-center",children:[l.jsx(uo,{children:l.jsx(FA,{className:"min-h-bloop min-w-bloop h-max w-max"})}),l.jsx(q,{children:e?l.jsx(Qo,{conversationId:A}):null})]}),l.jsx(D.div,{className:"mb-6 flex justify-center",children:l.jsx(io,{conversationId:A})})]}),!1]})}):null}),i===KA.Poor&&l.jsx("div",{className:"absolute start-1/2 top-6 z-50 -translate-x-1/2 transform",children:l.jsx("div",{className:"border-token-border-default bg-token-main-surface-primary inline-flex flex-col items-center rounded-full border px-6 py-3",children:l.jsx("span",{className:"text-token-text-secondary",children:s.formatMessage({id:"YE2Eng",defaultMessage:"Poor connection"})})})})]})}const fA={hidden:{opacity:0,transform:"blur(4px)"},visible:{transform:"blur(0px)",opacity:1},exit:{opacity:0,transform:"blur(4px)"}},Fo=Object.freeze(Object.defineProperty({__proto__:null,VoiceModeLayout:Vo},Symbol.toStringTag,{value:"Module"}));export{oo as u,Fo as v};
//# sourceMappingURL=melmwugpbxr6j7gy.js.map

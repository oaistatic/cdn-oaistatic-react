import{r as u,g as te,j as e,c as I,au as h,aw as S}from"./cg166fqqcxkeiosv.js";import{eU as R,df as A,u as O,r as V,q as U,di as se,b8 as ne,bR as ae,ai as oe,d as re,bT as ie}from"./mwlpozqwnbys03vp.js";import{W as ue}from"./mwg1bia5luujsxxb.js";import{m0 as ce,m1 as de,aF as le,gT as w,gU as b,m2 as xe,m3 as me,j5 as fe,j6 as pe}from"./d5k5wa3zyqlgc9bk.js";import{u as p,b as ve,V as ge,R as C}from"./injyhirdj1cdrzbe.js";import{u as he}from"./h77k7aj646gmtozx.js";import{u as je,g as be}from"./n2tebdetu1xczkux.js";import{M as Ce}from"./nf72ucyf2v4hrd52.js";import"./lreb9dbp4o4sdhlz.js";import"./mptd6395vqovl9h2.js";import"./lyxz8i5c4a3y7iew.js";import"./mkblidk2favziv5s.js";import"./gjup1pnw4u9rwx39.js";import"./kb4dwh5v3nuso8nd.js";import"./h9b0sydnyfwx9msy.js";import"./oxip50nz1ohggehf.js";import"./f9ed4qokx92gm8gq.js";import"./bcgu844kz5rwd68s.js";import"./h73vs9mo3wx5w4z2.js";import"./noatv9rm421ruoof.js";import"./e1a7vwuqoah2oayi.js";import"./ehrl4h7p8z26p31l.js";const we=t=>u.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 15.8333V17.1667C4 18.4553 5.04467 19.5 6.33333 19.5C6.70152 19.5 7 19.2015 7 18.8333V14.1667C7 13.7985 6.70152 13.5 6.33333 13.5C5.04467 13.5 4 14.5447 4 15.8333ZM2 12.5C2 6.97715 6.47715 2.5 12 2.5C17.5228 2.5 22 6.97715 22 12.5V17.1667C22 19.5599 20.0599 21.5 17.6667 21.5C16.1939 21.5 15 20.3061 15 18.8333V14.1667C15 12.6939 16.1939 11.5 17.6667 11.5C18.523 11.5 19.3214 11.7484 19.9936 12.1771C19.8242 7.90854 16.3101 4.5 12 4.5C7.68986 4.5 4.17583 7.90854 4.0064 12.1771C4.6786 11.7484 5.47696 11.5 6.33333 11.5C7.80609 11.5 9 12.6939 9 14.1667V18.8333C9 20.3061 7.80609 21.5 6.33333 21.5C3.9401 21.5 2 19.5599 2 17.1667V12.5ZM20 15.8333C20 14.5447 18.9553 13.5 17.6667 13.5C17.2985 13.5 17 13.7985 17 14.1667V18.8333C17 19.2015 17.2985 19.5 17.6667 19.5C18.9553 19.5 20 18.4553 20 17.1667V15.8333Z",fill:"currentColor"}));function ye(t,s,n,r){var a=-1,i=t==null?0:t.length;for(r&&i&&(n=t[++a]);++a<i;)n=s(n,t[a],a,t);return n}var Se=ye;function Me(t){return function(s){return t?.[s]}}var ke=Me,Ne=ke,De={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ie=Ne(De),Re=Ie,Ae=Re,Oe=R,Ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ue="\\u0300-\\u036f",Ee="\\ufe20-\\ufe2f",$e="\\u20d0-\\u20ff",Le=Ue+Ee+$e,_e="["+Le+"]",Te=RegExp(_e,"g");function We(t){return t=Oe(t),t&&t.replace(Ve,Ae).replace(Te,"")}var Pe=We,ze=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Be(t){return t.match(ze)||[]}var Ze=Be,Fe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Ge(t){return Fe.test(t)}var He=Ge,E="\\ud800-\\udfff",Qe="\\u0300-\\u036f",Je="\\ufe20-\\ufe2f",Ye="\\u20d0-\\u20ff",qe=Qe+Je+Ye,$="\\u2700-\\u27bf",L="a-z\\xdf-\\xf6\\xf8-\\xff",Ke="\\xac\\xb1\\xd7\\xf7",Xe="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",et="\\u2000-\\u206f",tt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_="A-Z\\xc0-\\xd6\\xd8-\\xde",st="\\ufe0e\\ufe0f",T=Ke+Xe+et+tt,W="['’]",M="["+T+"]",nt="["+qe+"]",P="\\d+",at="["+$+"]",z="["+L+"]",B="[^"+E+T+P+$+L+_+"]",ot="\\ud83c[\\udffb-\\udfff]",rt="(?:"+nt+"|"+ot+")",it="[^"+E+"]",Z="(?:\\ud83c[\\udde6-\\uddff]){2}",F="[\\ud800-\\udbff][\\udc00-\\udfff]",v="["+_+"]",ut="\\u200d",k="(?:"+z+"|"+B+")",ct="(?:"+v+"|"+B+")",N="(?:"+W+"(?:d|ll|m|re|s|t|ve))?",D="(?:"+W+"(?:D|LL|M|RE|S|T|VE))?",G=rt+"?",H="["+st+"]?",dt="(?:"+ut+"(?:"+[it,Z,F].join("|")+")"+H+G+")*",lt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",mt=H+G+dt,ft="(?:"+[at,Z,F].join("|")+")"+mt,pt=RegExp([v+"?"+z+"+"+N+"(?="+[M,v,"$"].join("|")+")",ct+"+"+D+"(?="+[M,v+k,"$"].join("|")+")",v+"?"+k+"+"+N,v+"+"+D,xt,lt,P,ft].join("|"),"g");function vt(t){return t.match(pt)||[]}var gt=vt,ht=Ze,jt=He,bt=R,Ct=gt;function wt(t,s,n){return t=bt(t),s=n?void 0:s,s===void 0?jt(t)?Ct(t):ht(t):t.match(s)||[]}var yt=wt,St=Se,Mt=Pe,kt=yt,Nt="['’]",Dt=RegExp(Nt,"g");function It(t){return function(s){return St(kt(Mt(s).replace(Dt,"")),t,"")}}var Rt=It,At=Rt,Ot=ce,Vt=At(function(t,s,n){return t+(n?" ":"")+Ot(s)}),Ut=Vt;const Et=te(Ut);function $t({conversationId:t}){const s=oe("1426009137")?.value,n=O(t),r=V.getCurrentNode(U(t))?.id,a=ve();return s?e.jsx(f,{conversationId:n??t,parentMessageId:r,status:a}):null}function f(t){const s=t?.status?.modes,[n,r]=u.useState(!1),[a,i]=u.useState(),d=u.useCallback(o=>{i(o),r(!0)},[]),c=I(),l=u.useCallback(()=>r(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(se,{contentAlign:"center",triggerButton:e.jsx(f.Trigger,{}),children:s?s.map(o=>u.createElement(f.Item,{...t,key:o.mode,voiceStatusMode:o,onShowModal:d})):e.jsx("div",{role:"progressbar","aria-valuetext":c.formatMessage({defaultMessage:"Loading voice modes",id:"voiceModeButton.loadingModes"}),"aria-busy":"true","aria-live":"assertive","aria-valuemin":0,"aria-valuemax":100,children:e.jsx(A,{"aria-hidden":"true",className:"my-4 min-w-full"})})}),e.jsx(f.Modal,{conversationId:t.conversationId,disabledModeMetadata:a,isOpen:n,onClose:l})]})}f.Modal=function(s){const n=s.disabledModeMetadata?.buttons??[],r=he({buttons:n,conversationId:s.conversationId,onClick:s.onClose}),a=e.jsx(Ce,{children:s.disabledModeMetadata?.description_markdown});return e.jsx(ne,{title:s.disabledModeMetadata?.title,description:a,isOpen:s.isOpen,onClose:s.onClose,type:"success",primaryButton:r.primary,secondaryButton:r.secondary})};f.Trigger=u.forwardRef(function(s,n){const r=p(a=>a.voiceMode);return e.jsxs(de,{ref:n,...s,children:[Et(r)??e.jsx(A,{}),e.jsx(le,{className:"icon-md text-token-text-tertiary"})]})});f.Item=function({conversationId:s,parentMessageId:n,voiceStatusMode:r,onShowModal:a}){const{disabled_mode_metadata:i,mode:d}=r,{startVoiceMode:c}=je(),l=O(s),o=u.useCallback(async()=>{i?a(i.disabled_message):c(be({serverThreadId:l,parentMessageId:n,isAdvancedMode:d==="advanced"&&!i,eventSource:"voice_mode_picker",clientThreadId:s,gizmoId:V.getGizmoId(U(s))}))},[s,i,d,a,n,l,c]);return e.jsx(ae.Item,{onClick:o,children:e.jsxs("div",{children:[r.display_name,e.jsx("div",{className:"text-xs text-token-text-tertiary",children:r.description})]})})};function ds({conversationId:t}){const s=p(n=>n.voiceSessionId);return e.jsx("div",{className:"relative h-full",children:e.jsx(h.div,{className:"absolute hidden h-full max-w-[500px] overflow-y-hidden rounded-xl border-l border-l-token-sidebar-surface-secondary bg-token-main-surface-secondary pt-4 shadow-inner md:block",initial:{opacity:0,x:520,width:"0px"},animate:{opacity:1,x:0,width:"500px",left:"-520px"},exit:{opacity:0,x:520,width:"0px",left:"0px"},transition:{type:"tween"},children:e.jsx(S,{children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx($t,{conversationId:t})}),e.jsx("div",{className:"p-4 py-2 text-sm",children:e.jsx(m,{name:"Voice Session ID",text:s??"n/a"})}),e.jsxs("div",{className:"flex h-full w-full flex-col flex-nowrap gap-4",children:[e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-col flex-nowrap gap-4",children:[e.jsx(Lt,{}),e.jsx(Tt,{})]})}),e.jsx(_t,{})]})]})})})})}function Lt(){const[t,s]=u.useState("timestamp"),[n,r]=u.useState("asc"),a=p(o=>o.server.messages.filter(x=>x.type===ge.Performance)),i=a[a.length-1],d=u.useCallback(o=>o>=1e3?`${(o/1e3).toFixed(2)}s`:`${o.toFixed(1)}ms`,[]),c=u.useMemo(()=>i?[...i.payload.metrics].sort((o,x)=>{const j=t==="name"?o.name.localeCompare(x.name):o.ms-x.ms;return n==="asc"?j:-j}):[],[i,t,n]);if(!i)return null;const l=o=>{o===t?r(n==="asc"?"desc":"asc"):(s(o),r("asc"))};return e.jsx(Q,{title:"Performance",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(y,{text:"Metric"}),t==="name"?n==="asc"?e.jsx(w,{}):e.jsx(b,{}):null]}),e.jsxs("div",{className:"flex cursor-pointer flex-row items-center",onClick:()=>l("timestamp"),children:[e.jsx(y,{text:"Timestamp"}),t==="timestamp"?n==="asc"?e.jsx(w,{}):e.jsx(b,{}):null]}),c.map(o=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:o.name},o.name),e.jsx("span",{className:"line-clamp-1 rounded-lg bg-token-main-surface-tertiary p-0.5 px-1 font-mono text-xs",children:d(o.ms)},o.name+o.ms)]}))]})})}function _t(){const t=p(s=>s.server.messages);return e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"px-4 py-2 text-lg font-semibold text-token-text-secondary",children:"Messages"}),e.jsx("div",{className:"grow overflow-hidden",children:e.jsx(ue,{children:e.jsx(h.ul,{className:"pointer-events-none flex w-full flex-col gap-4 pb-24 pt-4",initial:"initial",animate:"animate",exit:"exit",variants:J,transition:{delayChildren:.25,staggerChildren:.05},children:t.map((s,n)=>e.jsx(Pt,{index:n,message:s},n))})})})]})}function Tt(){const t=p(c=>c.server.connectionState),s=p(c=>c.dev.room),[n,r]=u.useState("Unknown"),a=s?.localParticipant,i=s?.numParticipants??"Unknown",d=s?.activeSpeakers??[];return u.useEffect(()=>{if(a){const c=l=>{r(l)};return a.on("connectionQualityChanged",c),()=>{a.off("connectionQualityChanged",c)}}},[a]),e.jsxs(Q,{title:"Room",open:!1,children:[e.jsx(m,{name:"Connection Quality",text:String(n)}),e.jsx(m,{name:"Connection State",text:String(t)}),e.jsx(m,{name:"Participants",text:i}),e.jsx(m,{name:"Speakers",text:d.length}),e.jsx(Wt,{})]})}function Wt(){const t=p(x=>x.dev.room),[s,n]=u.useState(null),[r,a]=u.useState(null),[i,d]=u.useState(null),c=t?.getActiveDevice("audioinput"),l=t?.getActiveDevice("audiooutput"),o=t?.getActiveDevice("videoinput");return u.useEffect(()=>{async function x(){const j=await C.getLocalDevices("audioinput"),Y=await C.getLocalDevices("audiooutput"),q=await C.getLocalDevices("videoinput"),K=j.find(g=>g.deviceId===c),X=Y.find(g=>g.deviceId===l),ee=q.find(g=>g.deviceId===o);n(K?.label??"Unknown"),a(X?.label??"Unknown"),d(ee?.label??null)}x()},[c,l,o]),e.jsxs(e.Fragment,{children:[e.jsx(y,{text:"Devices"}),i?e.jsx(m,{icon:xe,name:"Video Input",text:i}):null,e.jsx(m,{icon:me,name:"Audio Input",text:s??"Unknown"}),e.jsx(m,{icon:we,name:"Audio Output",text:r??"Unknown"})]})}function Q({title:t,titleClassName:s,children:n,open:r}){const[a,i]=u.useState(r??!0);return e.jsxs("div",{children:[e.jsxs("h3",{className:re("flex cursor-pointer items-center py-2 text-lg font-semibold text-token-text-secondary",s),onClick:()=>i(!a),children:[e.jsx("span",{children:t}),e.jsx("span",{className:"ml-2",children:a?e.jsx(b,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4"})})]}),e.jsx(S,{initial:!1,children:a&&e.jsx(h.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{height:"auto",opacity:1},collapsed:{height:0,opacity:0}},transition:{duration:.3,ease:"easeInOut"},layout:!0,children:n},"content")})]})}function y({text:t}){return e.jsx("h4",{className:"py-2 text-sm font-semibold",children:t})}function m(t){return e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:[e.jsx("span",{className:"opacity-85",children:t.icon?e.jsx(t.icon,{className:"h-[0.75rem] w-[0.75rem]"}):e.jsxs("span",{className:"text-sm",children:[t.name,":"]})}),t.content??e.jsx("span",{className:"line-clamp-1 rounded-lg bg-token-main-surface-tertiary p-0.5 px-1 font-mono text-xs",children:t.text})]})}function Pt({index:t,message:s}){const[n,r]=u.useState(!1),a=I();let i=null;switch(s.source){case"remote":i=pe;break;case"local":i=fe;break}return e.jsx(h.div,{className:"w-full border-t border-token-main-surface-tertiary p-4",variants:J,children:e.jsxs("div",{className:"flex w-full flex-col gap-2 rounded-lg bg-token-main-surface-secondary",children:[e.jsxs("div",{className:"font-mono text-[0.65rem] font-semibold text-token-text-secondary",children:[e.jsxs("div",{className:"flex w-full flex-row flex-nowrap items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-1",children:[e.jsx(i,{className:"h-3 w-3 text-token-text-secondary"}),e.jsx("span",{children:` | ${t+1} | ${a.formatDate(s.timestamp,{hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:2})}`})]}),e.jsx("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:e.jsx(ie,{className:"rounded-full p-0.5",color:"ghost",size:"small",onClick:()=>r(d=>!d),children:e.jsx(b,{className:`transform transition-transform ${n?"rotate-180":""}`})})})]}),e.jsx("div",{className:"mt-1 text-xs font-bold",children:s.type})]}),e.jsx(S,{children:n?e.jsx(h.pre,{initial:{opacity:0,transform:"blur(4px)"},animate:{opacity:1,transform:"blur(0px)"},exit:{opacity:0,transform:"blur(4px)"},className:"overflow-x-auto rounded-md bg-token-main-surface-tertiary p-2 text-xs text-token-text-secondary",children:JSON.stringify(s.payload,null,2)}):null})]})})}const J={hidden:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100}};export{ds as VoiceModeDevPanel};
//# sourceMappingURL=b8esu4r3x5p3rwsq.js.map

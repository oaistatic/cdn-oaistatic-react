const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/nf72ucyf2v4hrd52.js","assets/cg166fqqcxkeiosv.js","assets/d5k5wa3zyqlgc9bk.js","assets/mwlpozqwnbys03vp.js","assets/root-0muf4psh.css","assets/conversation-small-ga20ijz2.css","assets/kfbcc5advkw7yhwi.js","assets/mxrazhsns80qum0b.js","assets/fhbt0hb4dr6nwu5g.js"])))=>i.map(i=>d[i]);
import{a as je,r as f,v as Re,j as e,M as m,c as be,R as _e}from"./cg166fqqcxkeiosv.js";import{fp as Ee,al as me,r as Se,q,gg as Pe,m as re,M as ke,bm as fe,bn as he,aC as S,aB as De,Q as we,eF as Fe,ab as Le,S as ie,c4 as le,bT as ce,h as xe,T as Ne,a as G,gu as Ae,d as Y,bC as Oe,b9 as He,gv as Ve,gw as Ie,D as Be,bV as Qe,gx as qe,gy as Ge,ad as Ue,gz as ze,n as We}from"./mwlpozqwnbys03vp.js";import{h9 as Ye,h3 as Ke,a5 as de,cn as Ze,ha as F,hb as $e,hc as Je,hd as Xe,he as et,hf as tt,a6 as st,hg as Z,eb as ge,hh as at,cz as K,dB as nt,hi as ot,hj as rt,hk as it,hl as lt,hm as ct,hn as dt,ho as U,hp as z,hq as gt,hr as ut,hs as mt,ht as ft,c2 as ht,hu as xt,hv as pt,hw as yt,hx as Mt,hy as vt,dK as W,hz as Tt}from"./d5k5wa3zyqlgc9bk.js";import{a as Ct,g as jt}from"./mptd6395vqovl9h2.js";function Rt({clientThreadId:t,conversationMode:o}){const c=Ye(t),r=je(),a=Ee(),s=Ct(),{data:d}=Ke(),{data:g}=me(),n=f.useCallback(p=>{if(!p)return[];const u=de(g?.models,p),i=jt({modelConfig:u,systemHints:d??[]}).map(y=>y.systemHint);return Array.from(s).filter(y=>i.includes(y))},[s,g?.models,d]);return({id:p,eventSource:u,requestedModelId:i,systemMessage:y,systemMessageMetadata:T,extraStreamParams:l})=>{const P=Se.getTree(q(t)).getConversationTurns(p,!1),b=P?.[P?.length-1].variantIds?.length===1&&l?.forceUseSearch===void 0,N=Pe(r,a),A=q(t),k=de(N?.models,A?.modelId),D=n(i),{systemHints:_,extraStreamParams:L}=Ze(D);c({id:p,requestedModelId:i,eventSource:u,variantPurpose:b?"comparison_implicit":"none",conversationMode:o??q(t)?.mode,appendMessages:y?[{id:Re(),author:{role:k?.tags.includes("o1")?re.Developer:re.System},content:{content_type:ke.Text,parts:[y]},metadata:{exclude_after_next_user_message:!0,...T}}]:void 0,extraStreamParams:L,systemHints:_})}}const bt=fe(()=>he(()=>import("./nf72ucyf2v4hrd52.js").then(t=>t.F),__vite__mapDeps([0,1,2,3,4,5])));function _t(t){return t.message.metadata?.safety_plugin_status_code===123}function Et(t){return t.message.metadata?.finish_details?.type==="content_filter"}function $(t){if(t===void 0)return{flagSeverity:void 0,shouldHideContent:!1,errCode:void 0,errMessage:void 0};const{errType:o,errCode:c,err:r,disclaimers:a}=t,s=Et(t),d=s&&_t(t),g=a&&a.length>0;return d?{flagSeverity:"warning",shouldHideContent:!0,errCode:S.ContentRegurgitation,errMessage:r}:!g&&s?{flagSeverity:"warning",shouldHideContent:!0,errCode:S.ContentOrTos,errMessage:r}:{flagSeverity:o,shouldHideContent:o==="danger"&&(c===S.ContentPolicy||c===S.ModelIncompatibility),disclaimers:a,errCode:c,errMessage:r}}function St({message:t,clientThreadId:o,id:c,isFeedbackEnabled:r,isUserTurn:a,className:s}){const{errCode:d,errMessage:g,flagSeverity:n}=$(t);switch(d){case S.ContentPolicy:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(wt,{isFeedbackEnabled:r})});case S.ModelIncompatibility:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(m,{...h.modelIncompatibilityMessage})});case S.ContentOrTos:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(kt,{isFeedbackEnabled:r})});case S.ContentRegurgitation:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(Dt,{})});case Je:return e.jsx(Pt,{className:s,id:c,flag:n,clientThreadId:o,isUserTurn:a});case De:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(m,{...h.historyDisabledConversationMissing})});default:return g!==void 0?e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(bt,{rehypePlugins:[[$e,{target:"_new",rel:"noopener noreferrer"}]],className:"markdown prose w-full break-words dark:prose-invert",children:g})}):null}}function Pt({className:t,id:o,flag:c,clientThreadId:r,isUserTurn:a}){const s=Xe(R=>R.isoDate),d=et(s),g=we(r??Fe,R=>R?.mode),n=g&&g.kind!==Le.PrimaryAssistant,x=tt(),{data:p}=me(),u=st(p)?.id,i=Rt({clientThreadId:r}),y=f.useCallback(()=>{ie.logEvent("chatgpt_regenerate_due_to_rate_limit_button_clicked",void 0,{useDefaultModel:"false",...le({clientThreadId:r})}),i({id:o})},[o,i,r]),T=f.useCallback(()=>{ie.logEvent("chatgpt_regenerate_due_to_rate_limit_button_clicked",void 0,{useDefaultModel:"true",...le({clientThreadId:r})}),x({modelId:u,location:"Model switcher menu item"}),i({id:o,requestedModelId:u})},[i,o,u,x,r]);let l;return n?l=s!=null?e.jsx("span",{children:e.jsx(m,{...h.gptUsageCapExceededCustomFeature,values:{link:ue,formattedTime:d}})}):e.jsx(m,{...h.gptUsageCapExceededExpired}):l=s!=null?e.jsx("span",{children:e.jsx(m,{...h.gptUsageCapExceeded,values:{link:ue,formattedTime:d}})}):e.jsx(m,{...h.gptUsageCapExceededExpired}),e.jsx(F,{flag:s!=null?c:void 0,isUserTurn:a,className:t,children:e.jsxs("div",{className:"flex items-center gap-6",children:[l,s==null&&e.jsx(ce,{color:"secondary",className:"flex-shrink-0",onClick:y,children:e.jsx(m,{...h.buttonTryAgain})}),s!=null&&!n&&e.jsx(ce,{color:"secondary",className:"flex-shrink-0",onClick:T,children:e.jsx(m,{...h.buttonUseDefaultModel})})]})})}const ue=t=>e.jsx("a",{href:"https://share.hsforms.com/16d0ZZVM3QZirXnCD_q7u1Q4sk30",target:"_blank",rel:"noreferrer",className:"underline",children:t});function kt({isFeedbackEnabled:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{...h.contentOrTosViolationNoFeedback,values:{contentPolicyLink:pe,termsLink:Ft}})}),e.jsx("div",{children:t&&e.jsx(m,{...h.contentPolicyFeedback})})]})}function Dt(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold",children:e.jsx(m,{...h.contentRegurgitationViolation})}),e.jsx("div",{children:e.jsx(m,{...h.readModelSpec,values:{modelSpecLink:Lt}})})]})}function wt({isFeedbackEnabled:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{...h.contentPolicyViolationNoFeedback,values:{contentPolicyLink:pe}})}),e.jsx("div",{children:t&&e.jsx(m,{...h.contentPolicyFeedback})})]})}const pe=t=>e.jsx(Z,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:t}),Ft=t=>e.jsx(Z,{target:"_blank",href:"https://openai.com/policies/terms-of-use",rel:"noreferrer",children:t}),Lt=t=>e.jsx(Z,{target:"_blank",href:"https://cdn.openai.com/spec/model-spec-2024-05-08.html",rel:"noreferrer",children:t}),h=xe({contentPolicyFeedback:{id:"TextMessageDisplay.contentPolicyFeedback",defaultMessage:"Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolation:{id:"TextMessageDisplay.contentPolicyViolation.2",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolationNoFeedback:{id:"TextMessageDisplay.contentPolicyViolationNoFeedback",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>."},modelIncompatibilityMessage:{id:"cyOWhN",defaultMessage:"Your request was flagged as potentially violating our usage policy. Please try again with a different prompt."},contentOrTosViolation:{id:"TextMessageDisplay.contentOrTosViolation.2",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentOrTosViolationNoFeedback:{id:"TextMessageDisplay.contentOrTosViolationNoFeedback",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>."},contentRegurgitationViolation:{id:"kAMQnd",defaultMessage:"ChatGPT isn't designed to provide this type of content."},readModelSpec:{id:"fQ0JYv",defaultMessage:"Read the <modelSpecLink>Model Spec</modelSpecLink> for more on how ChatGPT handles creators' content."},historyDisabledConversationMissing:{id:"TextMessageDisplay.historyDisabledConversationMissing",defaultMessage:"Sorry, conversations created when Chat History is off expire after 6 hours of inactivity. Please start a new conversation to continue using ChatGPT."},somethingWentWrong:{id:"TextMessageDisplay.somethingWentWrong",defaultMessage:"Something went wrong."},gptUsageCapExceeded:{id:"TextMessageDisplay.gptUsageCapExceeded",defaultMessage:"You've reached the current usage cap for GPT-4. You can continue with the default model now, or try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededCustomFeature:{id:"TextMessageDisplay.gptUsageCapExceededCustomFeature",defaultMessage:"You've reached the current usage cap for GPT-4, please try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededExpired:{id:"TextMessageDisplay.gptUsageCapExceededExpired",defaultMessage:"You previously reached your usage cap for GPT-4, but you can now try sending your message again"},buttonUseDefaultModel:{id:"TextMessageDisplay.buttonUseDefaultModel",defaultMessage:"Use default model"},buttonTryAgain:{id:"TextMessageDisplay.buttonTryAgain",defaultMessage:"Try again"}}),Nt=fe(()=>he(()=>import("./kfbcc5advkw7yhwi.js"),__vite__mapDeps([6,1,3,4,2,5,7,8])).then(t=>t.TextMessageImageGroup));function ye({attachments:t,citations:o,contentReferences:c,className:r,clientThreadId:a,displayParts:s,isCompletionInProgress:d,id:g,isActivelyStreaming:n,isUserTurn:x,turnIndex:p,isFeedbackEnabled:u,messages:i,parts:y,prevGroupedMessageType:T,prevGroupedMessages:l,showEditButton:R,onEnterEdit:P,size:I="medium"}){const b=i.length>1,{flagSeverity:N,shouldHideContent:A}=$(b?void 0:i[0]),k=y.some(j=>j!==""),D=!k&&i[0].message.metadata?.content_references?.length===0,_=i[0].message.metadata?.targeted_reply_label??i[0].message.metadata?.targeted_reply,L=i[0].message.metadata?.targeted_reply_image;return f.useEffect(()=>{const j=i[0].message;if(j.author.metadata?.real_author===`tool:${Ne.SEARCHGPT}`&&k){const w=j.metadata?.search_source;ge.logEvent(G.searchToolRequestTimeToFirstTextToken,a,j.id,{search_source:w},()=>{w===Ae.InstantQuery&&at.logEvent(G.searchToolPageLoadTimeToFirstTextToken,{message_id:j.id,search_source:w})})}},[a,k,i]),f.useEffect(()=>{if(!D)switch(T){case K.Browsing:ge.logEvent(G.browsingTimeToFirstTextToken,a,i[0].message.id);break}},[D,i,a,T]),e.jsxs("div",{"data-message-author-role":i[0].message.author.role,"data-message-id":i[0].message.id,dir:"auto",className:Y(r,"text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words text-start [.text-message+&]:mt-5"),"data-message-model-slug":i[0].message.metadata?.model_slug,children:[_&&e.jsxs("div",{className:"mb-1 ml-6 mt-1 flex items-center gap-1.5 text-sm font-normal text-token-text-tertiary sm:ml-7 lg:ml-8",children:[L?e.jsx("img",{className:"h-6 rounded border border-token-border-light object-contain",src:L,alt:_}):e.jsx(nt,{className:"icon-md shrink-0"}),e.jsx("p",{className:"mr-2 line-clamp-3",children:_})]}),x&&e.jsx(ot,{messages:i}),!1,e.jsx(rt,{messages:i}),e.jsx(At,{parts:y,attachments:t,isUserTurn:x,isCompletionInProgress:d,turnIndex:p,displayParts:s,isActivelyStreaming:n,shouldHideContent:A&&!u,showEditButton:R,onEnterEdit:P,clientThreadId:a,id:g,isEmpty:D,prevGroupedMessageType:T,prevGroupedMessages:l,flagSeverity:N,messages:i,citations:o,contentReferences:c,size:I}),e.jsx(St,{message:b?void 0:i[0],id:g,isFeedbackEnabled:u,clientThreadId:a,isUserTurn:x}),e.jsx(it,{isUserTurn:x,message:b?void 0:i[0]}),!x&&!n&&l&&T===K.SearchResult&&e.jsx(lt,{messages:l})]})}function At({clientThreadId:t,id:o,displayParts:c,turnIndex:r,isActivelyStreaming:a,shouldHideContent:s,showEditButton:d=!1,onEnterEdit:g,isEmpty:n,prevGroupedMessageType:x,prevGroupedMessages:p,messages:u,citations:i,contentReferences:y,size:T,isUserTurn:l,parts:R,attachments:P}){const I=be(),b=f.useRef(!1),N=ct(c),A=u[0].message.metadata?.serialization_metadata,k=u[0].message.metadata?.image_results?.length??0,D=f.useMemo(()=>({clientThreadId:t,messageId:o,turnIndex:r}),[t,o,r]),{toggleThreadSidebar:_}=Oe(),L=f.useCallback((M,C)=>{_({type:"searchSources",scrollToHeader:C,clientThreadId:t,turnIndex:r,messageId:o})},[t,r,o,_]),j=e.jsx(gt,{parts:R,attachments:P,isUserTurn:l,clientThreadId:t},"files-and-tables"),w=!!(P?.length||c.some(M=>M.type==="images")),Me=dt();function J(M,C,v){const H=x===K.CodeInterpreter?p?.map(E=>E.message):void 0,{text:ee,contentReferences:te}=ut(C,i,y);let se=te;Me&&(se=te.filter(E=>E.type!=="attribution"));let{processedText:V,displayedContentReferences:ae}=Ve(ee,se,a?void 0:H,!1,a);V.includes(Ie)&&!b.current&&(b.current=!0,Be.addError(new Error("Failed replaceTextWithDirectives"),{text:V,displayedContentReferences:ae}));const ne=u[0].message,oe=ne.metadata?.message_locale,ve=u.find(E=>E.message.id===o),Te=mt(ve?.message),Ce=!V&&Qe("630821311")?"result-thinking":ft()?"":"result-streaming";let Q=e.jsx(ht,{clientThreadId:t,componentOverrides:Te?xt:null,messageId:o,size:T,className:Y(a&&Ce),children:V===""?"&#8203;":V});if(oe!=null){const E=qe(oe);E!=null&&(Q=e.jsx(Ge,{locale:E,children:Q}))}return e.jsx(pt.Provider,{value:{analyticsMetadata:D,message:ne,contentReferences:ae,onShowSearchResults:L,numImageResults:k,isActivelyStreaming:a,useSafeUrls:!0,clientThreadId:t},children:Q},M)}const O=c.map((M,C)=>{if(M.type==="transcription"){const v=s?null:M.text;let H=null;if(l&&s)H=e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})});else if(l&&v!=null)H=v.trim().length===0?e.jsx("span",{className:"italic opacity-30",children:e.jsx(U,{text:I.formatMessage(B.transcriptUnavailable),customSymbolOffsets:void 0})}):e.jsx("span",{className:"italic opacity-65",children:e.jsx(U,{text:`“${v.trim()}”`,customSymbolOffsets:void 0})});else if(!l&&v!=null)return J(C,v);return e.jsx(z,{containsImagesOrAttachments:w,isUserTurn:l,showEditButton:d,onEnterEdit:g,children:H},C)}else if(M.type==="text"){const v=s?null:M.text;return!n&&!s&&!l?J(C,N):n&&a&&!l?e.jsx("div",{className:"result-streaming",children:e.jsx("span",{children:e.jsx("pre",{})})},C):e.jsx(z,{containsImagesOrAttachments:w,isUserTurn:l,showEditButton:d,onEnterEdit:g,children:l&&s?e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})}):v?e.jsx(U,{text:v,customSymbolOffsets:A?.custom_symbol_offsets}):null},C)}else if(M.type==="images"){const v=u[0].message.metadata?.attachments??[];return e.jsx(Nt,{assets:M.imageAssets,attachments:v},C)}else return null}),X=c.findIndex(M=>M.type==="text");if(X!==-1?O.splice(X,0,j):O.push(j),s&&l)O.length=0,O.push(e.jsx(z,{containsImagesOrAttachments:w,isUserTurn:l,onEnterEdit:He,children:e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})})}));else if(s&&!l)return null;return e.jsx("div",{className:Y("flex w-full flex-col gap-1 empty:hidden",l&&"items-end rtl:items-start",!l&&"first:pt-[3px]"),children:O})}const B=xe({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function Ot(t){const{isActivelyStreaming:o,...c}=t,r=Ue(),a=r?.includes("debug")??!1,s=t.messages[t.messages.length-1].message.id,[d,g]=f.useState(yt(t.parts)),n=f.useRef(void 0);return n.current===void 0&&(n.current=r?.includes(ze)??!1?new Mt(t.parts,g,o,void 0,{debug:a}):new vt(t.parts,g,o)),f.useEffect(()=>{n.current!=null&&(n.current.onMessagePartsUpdated(t.parts,o),n.current.isBuffering()&&W.addDelayedRenderingMessage(s))},[t.parts,s,o]),f.useEffect(()=>{n.current!=null&&!n.current.isBuffering()&&W.removeDelayedRenderingMessage(s)},[d,s]),f.useEffect(()=>()=>W.removeDelayedRenderingMessage(s),[s]),f.useEffect(()=>()=>{n.current!=null&&(n.current.destroy(),n.current=void 0)},[]),e.jsx(ye,{...c,displayParts:d,isActivelyStreaming:o||n.current?.isBuffering()})}function Ht({message:t,isCompletionInProgress:o,clientThreadId:c,className:r,isUserTurn:a,turnIndex:s,isFeedbackEnabled:d,prevGroupedMessageType:g,prevGroupedMessages:n,showEditButton:x,onEnterEdit:p}){const u=f.useMemo(()=>"parts"in t.message.content?t.message.content.parts:[We(t.message)],[t]);return e.jsx(Vt,{parts:u,messages:[t],isCompletionInProgress:o,className:r,citations:t.message.metadata?.citations,contentReferences:t.message.metadata?.content_references,attachments:t.message.metadata?.attachments,isUserTurn:a,turnIndex:s,id:t.nodeId,isFeedbackEnabled:d,clientThreadId:c,showEditButton:x,onEnterEdit:p,prevGroupedMessageType:g,prevGroupedMessages:n})}const Gt=_e.memo(Ht);function Vt(t){const o=t.messages.length>1,{flagSeverity:c}=$(o?void 0:t.messages[0]),r=c!=="danger"&&t.isCompletionInProgress,a=!t.parts.some(d=>d!==""),[s]=f.useState(()=>!t.isUserTurn&&(t.isCompletionInProgress||a));return s?e.jsx(Ot,{...t,isActivelyStreaming:r}):e.jsx(ye,{...t,displayParts:Tt({isUserTurn:t.isUserTurn,parts:t.parts}),isActivelyStreaming:r})}export{Vt as T,Gt as a,$ as g,Rt as u};
//# sourceMappingURL=oxip50nz1ohggehf.js.map

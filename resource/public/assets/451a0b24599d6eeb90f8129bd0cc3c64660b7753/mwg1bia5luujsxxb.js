const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lq85l39ncb7bbk2r.js","assets/mwlpozqwnbys03vp.js","assets/cg166fqqcxkeiosv.js","assets/root-0muf4psh.css","assets/d5k5wa3zyqlgc9bk.js","assets/conversation-small-ga20ijz2.css","assets/ctivad43jagv79pz.js","assets/kjwe8l147u1yf45j.js","assets/jn1zlwl4dxqm29c9.js","assets/ehrl4h7p8z26p31l.js","assets/mptd6395vqovl9h2.js","assets/lr1sxgzrfwn4hmj0.js","assets/hqprvq82xcpllir3.js","assets/e9twjvrfqdwmahlj.js","assets/i8wt1ptmzikt53pm.js","assets/lj33efal9jfvd2er.js","assets/mkblidk2favziv5s.js","assets/oyod5vgp8gzuy8hf.js","assets/lreb9dbp4o4sdhlz.js","assets/lyxz8i5c4a3y7iew.js","assets/gjup1pnw4u9rwx39.js","assets/kb4dwh5v3nuso8nd.js","assets/h9b0sydnyfwx9msy.js","assets/oxip50nz1ohggehf.js","assets/f9ed4qokx92gm8gq.js","assets/bcgu844kz5rwd68s.js","assets/iqu8gde2ku6wmxni.js","assets/ox4s3bw4a8ggx7b1.js","assets/jhs75a8aerxa4m06.js","assets/mm1w9emro0qr3jgd.js","assets/3qaegw5tahuvxmqt.js","assets/oq5ot6nfr5izuy8j.js","assets/fp5201qqxy0uxbvb.js","assets/haa7pfckskryd1v7.js","assets/e1m5yy2rip1joy56.js","assets/gnony0vwtktparkr.js","assets/kv6ufg5o3s8p0dme.js","assets/kov0p7sh15118kx7.js","assets/ghzr670qk954gg66.js","assets/hbkh5m4c0oyunrjp.js","assets/b6iduacvey2p0jpw.js","assets/c5ozu2lnsaapixq1.js","assets/g75jzuc5fpvczlaa.js","assets/i5sbs75z4926uz0k.js","assets/hb7gvbmguhj1ye9u.js","assets/b2w5qfsxz967tcnb.js","assets/dkp00zb3hwwe24vq.js","assets/oj0ucoamns6j4jmq.js","assets/ln63rgwwibfqw7gf.js","assets/c5woaev38snpnqhe.js","assets/bax7wwydwcy7lfek.js","assets/m89x2zftpo6hrypr.js","assets/gixulyvulprvzjjt.js","assets/bolv0mms7la475nq.js","assets/lfwlfzjv3fidhbtf.js","assets/e1a7vwuqoah2oayi.js","assets/noatv9rm421ruoof.js","assets/fhbt0hb4dr6nwu5g.js","assets/k167qwis51wxn1ax.js","assets/gy64pge8qevmvg7e.js","assets/mhpmg60veo22qlan.js","assets/mbyycxtvfh128296.js","assets/ksh6u1fgnod0ruxn.js","assets/ko2h19alw3jscyph.js","assets/iubmh1vqpjspa2fg.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/jy3dt8r0gwwixm3r.js","assets/bk3oz68r6jpv53p0.js","assets/lgp60tfx6r8qdftv.js"])))=>i.map(i=>d[i]);
import{al as mt,cO as an,du as oo,Q as oe,r as Q,a4 as tr,B as ao,fN as sr,cP as nr,aj as ro,q as qe,C as Je,ce as Ks,bB as io,D as Js,H as kt,L as Bt,ab as Le,bi as _e,dU as nt,af as tl,c3 as sl,di as lo,P as q,a as U,bR as Z,df as nl,bm as Ve,bn as $e,bc as ot,hD as ha,b4 as at,hE as ol,d as D,hF as al,S as ke,h as ht,c0 as qs,a5 as cs,I as co,c6 as pa,c2 as ds,ai as je,bl as uo,bk as rn,bT as Gt,V as Tt,hG as or,aF as ga,e as rl,j as il,a0 as Ft,$ as Hn,bb as Wn,ao as Pe,bD as mo,dm as Qs,ap as Ot,m as st,ag as ll,eB as ho,u as us,eF as fa,cr as cl,cp as dl,bS as ul,dh as ar,gm as ml,J as ln,gs as hl,ad as rr,de as pl,eE as gl,hH as fl,gn as po,ej as xl,ge as Sl,gf as vl,bw as bl,gF as yl,hI as wl,c1 as go,bV as jl,hJ as Cl,cN as Ml,eY as Tl,fp as kl,aK as _l,aE as Vs,bA as ir,fQ as Al,fP as fo,hK as xo,gD as So,c4 as as,E as lr,aC as xa,bP as Nl,N as ms,ez as cr,Y as Dt,d6 as dr,bf as El,hL as Rl,bx as Pl,e7 as qn,fy as Il,o as ls,aD as Hl,e8 as Xs,b9 as Hs,O as ur,U as Dl,bX as Bl,fO as Fl,eP as Ll,M as Ol,bC as Ul,bW as zl,dQ as Gl,gA as Wl,hM as ql,bz as Vl,aL as $l}from"./mwlpozqwnbys03vp.js";import{r as i,h as vo,c as Ce,j as e,L as Vn,M as I,d as cn,R as bo,au as se,b5 as Yl,aw as hs,a as mr,z as Kl,v as Jl,b6 as Ql,b2 as Xl,a$ as Sa}from"./cg166fqqcxkeiosv.js";import{u as Zl}from"./lreb9dbp4o4sdhlz.js";import{gb as hr,oa as ec,ob as tc,a6 as yo,ed as K,h8 as Zs,oc as Dn,h6 as sc,a7 as dn,cA as wo,hM as $s,e2 as ps,od as jo,m as _t,jN as nc,bR as $n,an as oc,o as va,ab as ac,at as rc,fB as ic,au as lc,aF as Co,cf as un,jl as Mo,gq as cc,h5 as dc,i as uc,oe as St,bB as mc,bJ as pr,cI as To,of as Yn,og as Bn,oh as hc,oi as Ds,oj as pc,gV as gc,eS as We,mf as fc,m1 as ba,gU as xc,eT as Sc,ok as vc,iR as Bs,ol as bc,z as ko,d8 as yc,u as wc,om as jc,fV as Cc,cx as _o,x as Mc,on as Tc,hV as kc,oo as _c,op as Ac,oq as mn,or as Nc,os as Ec,ae as ut,ot as en,i4 as Ao,c2 as Rc,jv as gr,ou as No,f3 as Lt,ov as fr,ow as xr,e_ as Ie,ox as Ge,gY as Sr,oy as Pc,lq as vr,lt as br,gs as Ic,B as Eo,g4 as Hc,lp as Dc,af as dt,oz as yr,e4 as Bc,oA as Fc,oB as Ut,kG as wr,oC as V,oD as jr,oE as Cr,oF as Lc,oG as Oc,oH as Uc,oI as zc,oJ as Gc,oK as Wc,oL as qc,gp as Vc,oM as $c,oN as Yc,oO as Kc,oP as Jc,oQ as Qc,oR as Xc,oS as Zc,oT as ed,oU as td,oV as sd,oW as nd,oX as od,oY as ad,oZ as rd,o_ as id,o$ as ld,p0 as cd,p1 as Mr,a5 as rs,p2 as Tr,kT as kr,p3 as tn,E as dd,O as ud,fX as md,gX as Ro,fe as _r,p4 as hd,p5 as pd,dY as zt,p6 as gd,cG as Ar,p7 as Nr,p8 as fd,p9 as xd,J as Sd,dB as Er,pa as vd,ah as bd,pb as yd,cd as Po,ce as Rr,dw as wd,dx as Pr,pc as jd,dT as ya,ck as Fs,ch as Cd,jw as Md,lF as wa,pd as Td,pe as kd,pf as _d,hB as Ir,pg as Ad,ph as Nd,hC as Hr,jg as Io,e5 as Ed,cg as Rd,pi as Pd,iX as Id,lL as Hd,iY as Dd,iZ as Bd,pj as Fd,ci as Ys,i8 as Ld,pk as Od,pl as Ud,pm as zd,pn as Gd,U as sn,po as Ht,hf as Wd,f6 as qd,dm as Vd,pp as $d,pq as Yd,jd as Kd,gZ as Jd,mD as Qd,pr as Xd,g$ as Zd,h0 as eu,ps as tu,pt as su,pu as nu,pv as ou,pw as au,px as ru,di as iu,i$ as lu,gO as cu,dS as du,nh as uu,mG as mu,py as hu,pz as pu,pA as Kn,pB as gu,cn as fu,f1 as Dr,pC as xu,pD as Su,pE as Br,jI as Ho,f4 as nn,h9 as vu,hc as bu,hd as yu,i3 as wu,pF as Jn,d as Fr,pG as ja,pH as ju,pI as Cu,nG as Mu,e$ as Tu,pJ as ku,lA as Lr,f0 as _u,pK as Au,pL as Nu,fR as Eu,pM as Ru,pN as Pu,pO as Iu,pP as Hu,pQ as Du,lN as Bu,pR as Fu,pS as Ls,fF as Or,pT as Lu,dX as Ou,pU as Ur,pV as Uu,id as on,pW as Qn,pX as zu,pY as Gu,pZ as Os,p_ as Wu,cB as qu,cC as Vu,bI as zr,cU as Gr,gH as Wr,gJ as qr,d6 as $u,p$ as Yu,j7 as Ku,q0 as Ju,q1 as Qu,q2 as Xu,q3 as Vr,q4 as Zu,q5 as em,q6 as tm,cc as sm,dh as nm,ic as om,q7 as am,q8 as rm,go as Fn,gG as im,gI as lm,h_ as cm,q9 as dm,qa as um,qb as mm,qc as hm,qd as pm,qe as gm,qf as fm,qg as xm,qh as Sm,dl as vm,qi as bm,qj as ym,qk as wm,lx as jm,ly as Cm,lw as Mm,ql as Tm,i6 as km,qm as _m,hD as Am,hF as Nm,H as Em,gE as Rm,j5 as Pm,j6 as Im,nx as Hm,hR as Dm,hE as Bm,n3 as Fm,cW as Lm,cV as Om,cY as Um,qn as zm,hG as Ca,fW as Gm,cJ as Wm,cK as qm,iL as Vm,mB as $m,hJ as Ym,qo as Km,ag as Jm}from"./d5k5wa3zyqlgc9bk.js";import{a as $r,d as Qm,c as Xm}from"./lyxz8i5c4a3y7iew.js";import{d as Yr,b as hn,e as Zm,a as Kr,t as Xn,c as Jr,f as Qr,u as Do,h as pn,T as eh,i as th,j as Ma,k as sh,s as nh,l as oh,P as ah}from"./mptd6395vqovl9h2.js";import{S as rh,u as gn,G as ih,L as lh,a as ch}from"./mkblidk2favziv5s.js";import{u as dh,j as uh,i as mh,S as hh,k as ph,l as gh,m as fh,n as Bo,s as xh,o as Sh,p as Us,q as vh,r as bh,t as fn,C as Xr}from"./gjup1pnw4u9rwx39.js";import{B as yh}from"./h9b0sydnyfwx9msy.js";import{u as wh,g as jh}from"./oxip50nz1ohggehf.js";import{C as Zn,g as Ch}from"./f9ed4qokx92gm8gq.js";const Ln="m",Mh=2e3;function Th(t){const{clientThreadId:s,handleRequestCompletion:o}=t,n=i.useRef(!1),a=i.useRef(null),{isLoading:r,data:l}=mt(),{isLoading:c,data:d}=an(),p=d&&oo(d),m=oe(s,Q.hasUserMessage),u=tr(d),[h,x]=vo(),g=ao(),b=i.useCallback(async({content:T,attachments:B},M,S)=>{const k=hr(),F=B.length>0?{attachments:B}:{};F.system_hints=M.systemHints,Object.keys(k).length>0&&(F.__internal={search_settings:k}),$r(s),o({promptMessage:sr(T,F),requestedModelId:S,eventSource:"url",completionMetadata:M})},[s,o]),j=nr(()=>window.location.pathname)??null,v=ec();let w=!r&&!c&&j!=null;const[C,A]=i.useState(!0);return i.useEffect(()=>{if(!C||n.current)return;const T=ro(qe(s)?.mode);if(!w||T==null)return;if(!_h(j)||kh(j)&&v===void 0||Je(s)!=null){A(!1);return}const B=(()=>{try{return Object.fromEntries(new URLSearchParams(location.hash.slice(1)).entries())}catch{return{}}})(),M={...Object.fromEntries(h),...B},{[Dn]:S,[Ln]:k,[sc]:F}=M,N=(typeof S=="string"?S:null)??(typeof k=="string"?k:null);if(!N||!N.trim()){A(!1);return}else a.current=Date.now();const E=tc(F);n.current=!0;let f=yo(l);if(E.has(K.Search)&&!Zs(f,Ks.Search)&&l)for(const _ of l.models.values())Zs(_,Ks.Search)&&(f=_);const R=F?.includes(K.Search);(t.prefetchSearchPromise??Promise.resolve(null)).then(_=>{x(H=>{const L=new URLSearchParams(H);return L.delete(Dn),L.delete(Ln),L.append("model",f.id),L}),b({content:N,attachments:[]},{conversationMode:T,source:"instant-query",systemHints:F?Array.from(E):void 0,prefetchIds:_!=null?[_]:void 0,searchSource:R?io.URL_SEARCH_HINT:void 0},f?.id),_!=null&&Js.addFirstTiming("createCompletion.prefetchSearch")})},[r,c,w,j,l,p,u,b,C,s,v,g,t.prefetchSearchPromise,h,x]),C&&(t.prefetchSearchPromise!=null||h.has(Dn)||h.has(Ln)?!0:a.current?m||Date.now()-a.current>Mh?(a.current=null,A(!1),!1):!0:!1)}function kh(t){return Zr(t)}function Zr(t){return t==null?!1:/^\/g\/[\w-]+$/.test(t)}function _h(t){return t==null?!1:t==="/"||Zr(t)}function ei(t){const{currentModelId:s}=dh(),o=dn(t),[n,a]=oe(t,u=>[Q.hasUserMessage(u),Q.getGizmoId(u)]),r=kt(),l=wo(s),c=Bt(t)&&!n&&($s(o)||o?.kind===Le.GizmoTest),d=ps(a);return{showEmptyState:c,canUseNewHomepage:c&&d||c&&!a&&!l&&!r}}const Ta=_e.button`max-w-28 xs:max-w-40 sm:max-w-60 md:max-w-none group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$shimmer:t})=>t?"loading-shimmer":""} ${({$isScreenArch:t})=>t?"text-md px-1":"px-1 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function Ah({conversation:t,gizmoResource:s,elementRef:o}){const a=oe(t.id,r=>r?.title??null)??t.title;return e.jsx(Vn,{to:rc(t.id,s),children:e.jsx(Z.Item,{onSelect:()=>{q.logEvent(U.projectsBreadcrumbPickerPickConversation)},icon:ic,children:e.jsx("div",{ref:o,children:a})},t.id)})}function Nh({gizmoId:t,clientThreadId:s,inMobileHeader:o,modelLabel:n,modelPickerContent:a}){const r=Ce(),c=!jo(t),{data:d}=_t(t),{items:p,hasNextPage:m,fetchNextPage:u,isLoading:h,isFetchingNextPage:x}=nc(t),g=i.useRef(null),b=i.useCallback(N=>{h||N==null||(g.current?.disconnect(),g.current=new IntersectionObserver(E=>{E[0].isIntersecting&&m&&u()}),g.current.observe(N))},[h,m,u]);i.useEffect(()=>()=>{g.current?.disconnect()},[]);const[j,v,w]=oe(s,N=>[N?.isLoading,N?.title??null,Q.getThreadTitleSource(N)]),C=nt(),{showEmptyState:A}=ei(s),T=r.formatMessage($n.newChatTitle),{resolvedTitle:B,isTypingEffect:M}=oc(s,v,!0);if(!d||A)return null;const S=B==null&&(Bt(s)||w===tl.NewChat),k=j?e.jsx(e.Fragment,{}):e.jsxs(Ta,{$isScreenArch:C,$shimmer:S,children:[e.jsxs("div",{className:"truncate",children:[M?e.jsx(lc,{text:B??""}):B??T,c&&e.jsx("span",{className:"relative bottom-[1px] mx-1 inline-block rounded-md bg-token-main-surface-secondary px-1 text-xs leading-4 text-token-text-secondary",children:n})]}),e.jsx(Co,{className:"icon-md text-token-text-tertiary"})]}),F=d.gizmo.display.name;return e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden whitespace-nowrap px-2 py-1.5",children:[e.jsx(Ta,{$isScreenArch:C,children:e.jsx(Vn,{className:"truncate",to:va(d),children:F})}),e.jsxs(e.Fragment,{children:[e.jsx(sl,{className:"icon-md text-token-text-tertiary"}),e.jsxs(lo,{contentAlign:o?"center":"start",size:"small",onOpenChange:N=>{N&&q.logEvent(U.projectsBreadcrumbPickerOpen)},triggerButton:k,contentClassName:"max-h-[50dvh] overflow-y-scroll",children:[c&&e.jsxs(Z.Sub,{onOpenChange:N=>{N&&q.logEvent(U.projectsBreadcrumbPickerModelPickerOpen)},children:[e.jsx(Z.SubMenuTrigger,{children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[e.jsx(I,{id:"ilkdMh",defaultMessage:"Model"}),e.jsx("span",{className:"text-xs font-medium text-token-text-secondary",children:n})]})}),e.jsx(Z.Portal,{children:e.jsx(Z.SubContent,{onClick:()=>{q.logEvent(U.projectsBreadcrumbPickerModelPickerSelect)},children:a})})]}),e.jsx(Vn,{to:va(d),children:e.jsx(Z.Item,{onSelect:()=>{q.logEvent(U.projectsBreadcrumbPickerPickNewChat)},icon:ac,children:e.jsx(I,{...$n.newChatProjectDropdownItem,values:{name:`"${d.gizmo.display.name}"`}})},"new-chat")}),p.filter(N=>N.id!==s).map((N,E)=>{const f=m&&E===p.length-4?b:void 0;return e.jsx(Ah,{elementRef:f,conversation:N,gizmoResource:d},N.id)}),x&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(nl,{})})]})]})]})}const Eh=Ve(()=>$e(()=>import("./lq85l39ncb7bbk2r.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.ThreadHeaderGizmoDropdown)),Rh=Ve(()=>$e(()=>import("./kjwe8l147u1yf45j.js"),__vite__mapDeps([7,2,4,1,3,5,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25])).then(t=>t.ConversationHeaderMenuItems));function Ph({clientThreadId:t}){const s=Ce(),o=kt(),n=oe(t,Q.getIsNewConversation),a=cn(),[,r]=vo(),l=()=>{!n&&!o?a({pathname:"/",search:new URLSearchParams({[Bs]:"true"}).toString()}):r(c=>(c.get(Bs)==="true"?c.delete(Bs):c.set(Bs,"true"),c),{replace:n,state:bc()})};return e.jsx(Z.Item,{size:"large",className:"!pr-3",onClick:l,icon:pc,children:e.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-1 items-center gap-3",children:e.jsx(I,{...Uo.temporaryChat})}),e.jsx(gc,{enabled:o,label:s.formatMessage({defaultMessage:"Temporary",id:"temporaryChatToggleLabel"}),testId:"temporary-chat-toggle"})]})})}function Ih(t){return t.title?t.title:t.shortLabel}function Fo(t,s){let o=t;if(t===ha.AUTO){const r=s?.categories.filter(({defaultModel:l})=>l!==ha.AUTO);r?.length===1&&(o=r[0].defaultModel)}const n=s?.categories.find(({defaultModel:r})=>r===o);if(n){const{categoryId:r}=n,l=Ih(n);return{selectedCategory:r,modelLabel:l,omitPrefix:!!n.title}}const a=s?.groups.find(({modelIds:r})=>r.includes(o));if(a){const{group:r,shortLabel:l}=a;return{selectedCategory:r,modelLabel:l}}return{selectedCategory:null,modelLabel:null}}function Hh({modelLabel:t}){return e.jsx("span",{className:"overflow-x-clip text-ellipsis text-token-text-secondary",children:t})}function Dh({clientThreadId:t,inMobileHeader:s}){const{isLoading:o,data:n}=mt(),a=al(),l=un(t).id,c=Mo();We.markStart("ThreadModelSelector");const{modelLabel:d,omitPrefix:p}=Fo(l,n),m=Lo(t,c),u=Ce(),{isUnauthenticated:h}=at(),x=!h&&!a;d&&We.markRendered("ThreadModelSelector");const g=nt(),b=e.jsxs("div",{className:D(g?"overflow-x-hidden text-ellipsis":"text-token-text-secondary"),children:[p?null:`${fc} `,x?e.jsx("span",{className:"text-token-text-secondary",children:d}):h&&d?e.jsx(Hh,{modelLabel:d}):null]});return m.length?o?null:e.jsx(lo,{sideOffset:8,size:"large",triggerButton:e.jsxs(ba,{$isScreenArch:g,style:{viewTransitionName:"var(--vt-thread-model-switcher)"},"aria-label":d?u.formatMessage({id:"JrtGPQ",defaultMessage:"Model selector, current model is {modelLabel}"},{modelLabel:d}):"",children:[b,g?e.jsx(xc,{className:"icon-md text-token-text-tertiary"}):e.jsx(Co,{className:"icon-md text-token-text-tertiary"})]}),onOpenChange:j=>{q.logEvent(U.toggleModelSwitcher,{isOpen:j}),ke.logEvent("toggle_model_switcher",null,{isOpen:String(j)})},contentAlign:s?"center":"start",testId:"model-switcher-dropdown",children:e.jsx(Oo,{sections:m})}):e.jsx(ba,{className:"cursor-default",children:b})}function Bh({category:t,modelSwitcherDenialsBySlug:s,currentGizmoId:o,currentModelId:n,testId:a}){const{defaultModel:r,label:l,description:c,isBeta:d,isAlpha:p}=t,m=Sc(o??"");return e.jsx(Yn,{value:r,currentModelId:n,modelSwitcherDenialsBySlug:s,renderName:u=>e.jsx(eo,{name:l,description:c,isDisabled:u,isBeta:d,isAlpha:p}),isSelected:(!o||m)&&n===r,testId:a},r)}function Lo(t,s,o=!1){const n=un(t),a=n.id,r=ot(t),{data:l}=mt(),{data:c}=an(),d=cc(r),p=c&&oo(c),m=Je(t),u=dc({clientThreadId:t}),h=Ce(),x=!m,{isUnauthenticated:g}=at(),b=uc(),j=s.find(({categoryId:L})=>L===St.ALPHA),v=s.find(({categoryId:L})=>L===St.DATA_CAMPAIGNS),w=s.find(({categoryId:L})=>L===St.EXPERIMENTS),C=s.find(({categoryId:L})=>L===St.MAINLINE),A=!!j?.options?.length,T=!!v?.options?.length,B=!!w?.options?.length,M=!!C?.options?.length,S=cn(),k=i.useCallback(()=>{q.logEvent(U.accountPayOpenPaymentFromModelPicker,{content:"gizmo-button"}),mc(S,"Thread header dropdown")},[S]),F=()=>{ke.logEvent("chatgpt_model_switcher_plus_upgrade_button_clicked"),q.logEvent(U.modelSwitcherPlusUpgradeButtonClicked),g?b({shouldOpenPaymentModalOnAuth:!0,callback:L=>{q.logSignUpButtonClicked({location:"Model switcher GPT-4 upsell",provider:L})}}):k()},N=[],[E,f]=i.useState(!1),R=e.jsxs(e.Fragment,{children:[o&&e.jsx(ol,{setIsScrolledToEdge:f}),e.jsxs("div",{className:D("mb-1 flex items-center justify-between px-5 pt-2",{"sticky top-0 z-10 bg-token-main-surface-primary py-2":o},{"[box-shadow:--sharp-edge-top-shadow]":o&&E},{"[box-shadow:--sharp-edge-top-shadow-placeholder]":o&&!E}),children:[e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(I,{id:"ilkdMh",defaultMessage:"Model"})}),e.jsx("a",{href:"https://help.openai.com/en/articles/7864572-what-is-the-chatgpt-model-selector",target:"_blank",rel:"noreferrer",children:e.jsx(pr,{className:"icon-md h-5 w-5 pl-0.5 text-token-text-tertiary"})})]},"header")]});if(g){const L={id:"modelSection",content:[]};L.content.push(e.jsx(To,{location:"model-switcher",statsig_login_event:"chatgpt_modelswitcher_login_button_clicked",statsig_signup_event:"chatgpt_modelswitcher_signup_button_clicked"},"noAuthUpsell")),N.push(L)}else if(!p&&!r){const L={id:"modelSection",content:[]};L.content.push(e.jsx(Yn,{value:"",currentModelId:a,onClick:F,modelSwitcherDenialsBySlug:u,isUpgradeUpsell:!0,renderName:z=>e.jsx(eo,{icon:vc,isDisabled:z,name:h.formatMessage({id:"mzDzkX",defaultMessage:"ChatGPT Plus"}),description:h.formatMessage({id:"bqTHri",defaultMessage:"Our smartest model & more"})}),isSelected:!1,showNewChatHint:!1},"plusUpgrade")),L.content.push(e.jsx(Yn,{value:Bn.AUTO,currentModelId:a,modelSwitcherDenialsBySlug:u,renderName:z=>e.jsx(eo,{icon:hc,name:h.formatMessage({id:"U9E7Rx",defaultMessage:"ChatGPT"}),description:h.formatMessage({id:"n96qML",defaultMessage:"Great for everyday tasks"}),isDisabled:z}),isSelected:!r&&a===Bn.AUTO,showNewChatHint:!0},Bn.AUTO)),N.push(L)}else{const L={id:"modelSection",content:[]};l?.categories.length&&L.content.push(R);const z=new Map;l?.categories.forEach(Y=>{const P=e.jsx(Bh,{category:Y,currentGizmoId:r,currentModelId:a,modelSwitcherDenialsBySlug:u,testId:`model-switcher-${Y.defaultModel}`},Y.categoryId);Y.subcategory?(z.has(Y.subcategory)||z.set(Y.subcategory,[]),z.get(Y.subcategory)?.push(P)):L.content.push(P)}),z.forEach((Y,P)=>{const re=l?.categories.find(ie=>ie.subcategory===P&&ie.defaultModel===n.id);L.content.push(e.jsxs(Z.Sub,{children:[e.jsx(Z.SubMenuTrigger,{"data-testid":P==="More models"?"more-models-submenu":void 0,children:e.jsxs("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:[P,!!re&&e.jsx("div",{className:"truncate text-token-text-tertiary",children:re.label})]})}),e.jsx(Z.Portal,{children:e.jsx(Z.SubContent,{className:"min-w-72",children:Y})})]},P))}),N.push(L)}const _={id:"otherOptionsSection",content:[]},{selectedCategory:H}=Fo(a,l);return x&&(A&&_.content.push(e.jsx(Ds,{isSelected:H===St.ALPHA,currentModel:n,option:j,modelSwitcherDenialsBySlug:u,displayInFull_INTERNAL_USE_ONLY:!0},j.value)),T&&_.content.push(e.jsx(Ds,{isSelected:H===St.DATA_CAMPAIGNS,currentModel:n,option:v,modelSwitcherDenialsBySlug:u,displayInFull_INTERNAL_USE_ONLY:!0},v.value)),B&&_.content.push(e.jsx(Ds,{currentModel:n,isSelected:H===St.EXPERIMENTS,option:w,modelSwitcherDenialsBySlug:u,displayInFull_INTERNAL_USE_ONLY:!0},w.value)),M&&_.content.push(e.jsx(Ds,{isSelected:H===St.MAINLINE,currentModel:n,option:C,modelSwitcherDenialsBySlug:u,displayInFull_INTERNAL_USE_ONLY:!0},C.value))),_.content.length&&N.push(_),!g&&!r&&!d&&N.push({id:"temporaryChatSection",content:[e.jsx(Ph,{clientThreadId:t},"tempChat")]}),N}function Fh(){const t=Ce();return e.jsx("div",{className:"border-token-text-quartenary items-center rounded-full border px-1 py-0.5 text-[8px] font-semibold uppercase leading-3 text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary",children:t.formatMessage(Uo.beta)})}function Lh(){const t=Ce();return e.jsx("div",{className:"border-token-text-quartenary items-center rounded-full border px-1 py-0.5 text-[8px] font-semibold uppercase leading-3 text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary",children:t.formatMessage(Uo.alpha)})}function eo({isDisabled:t,name:s,icon:o,description:n,extra:a,isBeta:r=!1,isAlpha:l=!1}){let c=s;return r&&(c=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(Fh,{})]})),l&&(c=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(Lh,{})]})),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsx("span",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-token-main-surface-secondary",children:e.jsx(o,{className:"h-4 w-4 text-token-text-primary"})}),e.jsxs("div",{children:[c,e.jsxs("div",{className:D(!t&&"text-token-text-secondary","text-xs"),children:[n,a]})]})]})}function Oo({sections:t}){return e.jsx(e.Fragment,{children:t.map((s,o)=>e.jsxs(bo.Fragment,{children:[o!==0?e.jsx(Z.Separator,{}):null,s.content]},s.id))})}function Oh({clientThreadId:t,inMobileHeader:s=!1}){const o=ot(t),n=ps(o),a=jo(o),{showEmptyState:r}=ei(t),{data:l}=_t(o),{data:c}=mt(),p=un(t).id,{modelLabel:m}=Fo(p,c),u=Mo(),h=Lo(t,u,a),x=e.jsx(Dh,{clientThreadId:t,inMobileHeader:s});return o==null?a?e.jsx(Rh,{clientThreadId:t}):x:n?r&&l&&!a?x:e.jsx(Nh,{modelLabel:m??"",modelPickerContent:e.jsx(Oo,{sections:h}),gizmoId:o,clientThreadId:t,inMobileHeader:s}):e.jsx(Eh,{clientThreadId:t,gizmoId:o,inMobileHeader:s})}const Uo=ht({alpha:{id:"o5FsPB",defaultMessage:"Alpha"},beta:{id:"XZwFET",defaultMessage:"Beta"},gpt35ShortExplainer:{defaultMessage:"Great for everyday tasks",id:"ModelSwitcher.gpt35ShortExplainer"},modelTunerSmartSelectionTitle:{id:"czjW8I",defaultMessage:"Dynamic"},modelTunerSmartSelectionExplainer:{id:"gp/YH1",defaultMessage:"Optimized for speed and intelligence"},gpt4ShortExplainer:{defaultMessage:"With DALL·E, browsing and analysis",id:"ModelSwitcher.gpt4ShortExplainer"},gpt4ShortExplainerWithoutBrowse:{defaultMessage:"With DALL·E and analysis",id:"ModelSwitcher.gpt4ShortExplainerWithoutBrowse"},gpt4UpsellExplainer:{id:"ModelSwitcher.gpt4Upsell",defaultMessage:"Our smartest and most capable model. Includes DALL·E, browsing and more."},userUpgrade:{id:"ModelSwithcer.upgradeButton",defaultMessage:"Upgrade to Plus"},userUpgradeSignup:{id:"ModelSwitcher.signupUpgradeButton",defaultMessage:"Sign up for ChatGPT Plus"},temporaryChat:{id:"ModelSwitcher.temporaryChat",defaultMessage:"Temporary chat"},shareChat:{id:"ModelSwitcher.shareChat",defaultMessage:"Share chat"}}),Uh=Ve(()=>$e(()=>import("./iqu8gde2ku6wmxni.js"),__vite__mapDeps([26,2,1,3,27,28,4,5,29,30,31,32,33,20,10,18,21,34,35,36,9,37,38,39,40,16,6,41,15,17,42])).then(t=>t.GizmoUsingAsOwnerNotice)),zh=({clientThreadId:t})=>{const s=ko(h=>h.activeStageSidebar),o=Je(t),n=yc(qs.WorkspaceShareLinks),{isUnauthenticated:a}=at(),r=kt(),l=ot(t),c=ps(l),d=wc(),p=n&&o&&!a&&!r&&!c&&!d,m=nt(),u=!s&&!(!a&&m);return e.jsx("div",{className:D(!m&&"gap-2",m&&"@lg/screen-composer:gap-1","flex items-center pr-1 leading-[0]"),children:e.jsx(uh,{showShareButton:p,showProfileDropdown:u,clientThreadId:t})})};function Gh({clientThreadId:t,gizmoId:s}){const o=jc(),{data:n}=_t(s),a=cs();return e.jsxs(e.Fragment,{children:[e.jsxs(Cc,{className:"max-md:hidden",children:[e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[n!=null&&a?.isWorkspaceAccount()&&n.gizmo.tags?.includes(_o.WorkspaceDisabled)&&e.jsx(Uh,{gizmo:n}),e.jsx(Mc,{gizmoId:s,clientThreadId:t})]}),e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[e.jsx(mh,{clientThreadId:t}),e.jsx(Oh,{clientThreadId:t})]}),e.jsx(zh,{clientThreadId:t})]}),o&&e.jsx(Tc,{})]})}function ti({clientThreadId:t}){const s=ot(t),o=co(),n=nt();return o||n?null:e.jsx(Gh,{gizmoId:s,clientThreadId:t})}const ka=_e.div`m-8 flex flex-col items-center`;function _a(t){return e.jsx(se.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function Wh({clientThreadId:t}){const o=oe(t,a=>a?.promptGptRating)?.gizmoId,{data:n}=_t(o);return o==null||n==null||!kc(n)?null:e.jsx(qh,{gizmoId:o})}function qh({gizmoId:t}){const[s,o]=i.useState(!1),[n,a]=i.useState(!1),r=_c(t),l=async d=>{o(!0),setTimeout(()=>{a(!0)},5e3),q.logEvent(U.submitInlineRating,{gizmo_id:t,rating:d}),await r.mutateAsync({rating:d})},c=async()=>{a(!0),q.logEvent(U.dismissInlineRating,{gizmo_id:t}),await r.mutateAsync({})};return i.useEffect(()=>{n||q.logEvent(U.showInlineRating,{gizmo_id:t})},[n,t]),n?null:s?e.jsx(ka,{children:e.jsxs(_a,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(I,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(pa,{onClick:()=>{a(!0)}})]})}),e.jsx("div",{className:"text-xs text-token-text-tertiary",children:e.jsx(I,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(ka,{children:e.jsxs(_a,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(I,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(pa,{onClick:c})]}),e.jsx(Ac,{rating:void 0,onRating:l})]})})}const si=new Map([[K.Think,{hover:[U.composerThinkButtonHovered,"composer_think_button_hovered"],enable:[U.composerThinkButtonEnabled,"composer_think_button_enabled"],disable:[U.composerThinkButtonDisabled,"composer_think_button_disabled"]}],[K.Research,{hover:[U.composerResearchButtonHovered,"composer_research_button_hovered"],enable:[U.composerResearchButtonEnabled,"composer_research_button_enabled"],disable:[U.composerResearchButtonDisabled,"composer_research_button_disabled"]}]]);function ni({systemHint:t,logo:s,highlightTooltip:o,isPinnedActive:n=!1,isDisabled:a=!1,composerController:r,analyticsMetadata:l,onClick:c,showLabel:d=!1}){const{name:p,systemHint:m}=t,u=m,{setThreadSystemHintMode:h,clearAllSystemHintModeTriggers:x}=hn(),g=Yr(u),b=!!t.composerBarButtonInfo?.upsell,j=Zm.useStore(),[v,w]=i.useState(!1),{value:C}=je("2454940646"),A=Yl(),T=a||n,B=Kr(),M=[K.Search,K.Think].includes(u);i.useEffect(()=>{a&&B.has(u)&&h(u,!1,l)},[a,u,l,h,B,M]);const S=!a&&(g||o),k=e.jsxs("button",{className:D("flex h-9 min-w-8 items-center justify-center rounded-full border border-token-border-light p-2 text-[13px] font-medium radix-state-open:bg-black/10",{"transition-all duration-75":v},{"text-token-text-secondary":!g&&!o&&!n},{"bg-blue-250 text-blue-1000 dark:bg-[#2A4A6D] dark:text-[#48AAFF]":!!S||n,"can-hover:hover:bg-[#BDDCF4] dark:hover:bg-[#1A416A]":S&&!n||n,"can-hover:hover:bg-token-main-surface-secondary dark:can-hover:hover:bg-gray-700":!n&&!S},{"focus-visible:outline-black can-hover:hover:bg-black/10 dark:focus-visible:outline-white":!S&&!n},{"opacity-30":a&&!n,"opacity-50":n}),"aria-pressed":g,"aria-label":p,disabled:T,onTransitionEnd:()=>w(!1),onClick:F=>{if(F.stopPropagation(),F.preventDefault(),b&&u!==K.Search)return;w(!0);let N=!0;C&&M&&(j.getState().persistedSystemHints.has(K.Search)||j.getState().persistedSystemHints.has(K.Think))&&(N=!1),N&&x(),h(u,!g,l),g||(r.removeSystemHints(),r.focus());const{enable:E,disable:f}=si.get(u)??{},[R,_]=(g?f:E)??[];R&&_&&q.logEventWithStatsig(R,_,l),c?.(F)},children:[s,d&&e.jsx("div",{className:"whitespace-nowrap pl-1 pr-1 [display:--force-hide-label]",children:p}),e.jsx(hs,{children:!d&&g&&e.jsx(se.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:A?0:.15},children:e.jsx("div",{className:"whitespace-nowrap pl-1 pr-2 [display:--force-hide-label]",children:p})})})]});return b?e.jsx(uo,{children:e.jsx(lo,{triggerButton:k,sideOffset:0,alignOffset:0,children:e.jsx(To,{location:u,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"})})}):k}function Vh({composerController:t,systemHint:s,highlightTooltip:o,composerBarButtonInfo:n,isDisabled:a,clientThreadId:r,showLabel:l,isPinnedActive:c,currentModelName:d,disabledReason:p}){const m=Yr(s.systemHint),u={clientThreadId:r};return e.jsx(Kh,{composerBarButtonInfo:n,highlightTooltip:o,isThreadInSystemHintMode:m,isDisabled:a,isPinnedActive:c,analyticsMetadata:u,systemHint:s.systemHint,currentModelName:d,disabledReason:p,children:e.jsx(ni,{highlightTooltip:o,isDisabled:a,isPinnedActive:c,systemHint:s,logo:e.jsx(mn,{svgString:s.logo,className:"h-[18px] w-[18px]"}),composerController:t,analyticsMetadata:u,showLabel:l})})}function $h(t){const s=No(),o=ut(t);return!o.isLoading&&o.eligible&&!s}const Yh={p:t=>{const{node:s,children:o,...n}=t;return e.jsx("p",{...n,className:"text-start !text-sm !leading-6 text-white",children:o})},a:t=>{const{node:s,children:o,...n}=t;return e.jsx("a",{...n,className:"!text-sm !leading-6 !text-white !underline",children:o})}};function Kh({children:t,highlightTooltip:s,isThreadInSystemHintMode:o,isDisabled:n,isPinnedActive:a,systemHint:r,composerBarButtonInfo:l,analyticsMetadata:c,currentModelName:d,disabledReason:p}){const m=Nc(),u=Ec(),h=$h(l.announcementKey)&&!m&&!o&&!u,x=ut(l.announcementKey),g=Ce();return h?e.jsx(Ao,{announcementKey:l.announcementKey,side:"bottom",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:l.nuxTitle,onDismiss:x.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(Rc,{componentOverrides:Yh,children:l.nuxDescription}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(ds,{sideOffset:0,label:n?p===en.HasAttachedFiles?g.formatMessage({id:"z7E1Px",defaultMessage:"Reason disabled for attachments"}):p===en.DeepResearchHighLoad?g.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):l.disabledText:a?g.formatMessage({id:"gFCsls",defaultMessage:"You've selected a thinking model {modelName}"},{modelName:`(${d})`}):l.tooltipText,side:"bottom",open:s||void 0,onOpenChange:b=>{if(b){const{hover:j}=si.get(r)??{},[v,w]=j??[];v&&w&&q.logEventWithStatsig(v,w,c)}},children:t})})}function Aa({logo:t,onClick:s,showLabel:o,label:n,showRemoveIcon:a=!1}){return e.jsxs("button",{type:"button",className:"flex h-9 items-center gap-2 overflow-hidden rounded-full border border-token-border-light bg-blue-250 px-2 text-blue-1000 focus-visible:outline-black can-hover:hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A] dark:focus-visible:outline-white","aria-label":o?void 0:n,onClick:s,children:[e.jsxs("div",{className:"flex h-full items-center justify-center text-[13px] font-semibold",children:[t,o&&e.jsx("div",{className:"pl-1 [display:--force-hide-label]",children:n})]}),a&&e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(gr,{className:"h-[16px] w-[16px] text-blue-1000 dark:text-[#48AAFF]"})})]})}const zs={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},Jh=({suggestions:t,onSelectingSuggestedReply:s})=>e.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:t.slice(0,2).map((o,n)=>e.jsx(se.div,{initial:zs.initial,animate:zs.animate,transition:{delay:(n-1)*zs.transition.delay},exit:zs.exit,children:e.jsx(Gt,{as:"button",color:"secondary",size:"small",onClick:()=>{s(o,t,n)},className:"group whitespace-nowrap md:whitespace-normal",children:e.jsx(Xh,{suggestion:o})},n)},n))});function Qh({suggestions:t,onSelectingSuggestedReply:s,clientThreadId:o}){const n=t?.length>0;i.useEffect(()=>{n&&Lt(t,o)},[n,o]);const{isUnauthenticated:a}=at();return n?t.every(fr)?e.jsxs(se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[a&&e.jsx(rn,{className:"mb-6 h-12 w-12 sm:hidden"}),e.jsx(rh,{starterPrompts:t,onSelectStarterPrompt:s})]}):t.every(xr)?e.jsx(Jh,{suggestions:t,onSelectingSuggestedReply:s}):null:null}function Xh({suggestion:t}){return xr(t)?e.jsx(e.Fragment,{children:t.text}):fr(t)?e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[t.title&&e.jsx("div",{className:"truncate font-semibold",children:t.title}),e.jsx("div",{className:D("truncate font-normal",t.title?"opacity-50":""),children:t.body})]}):null}function Zh(){const{store:t}=Ie(),s=t.useSharedProps();return s?e.jsx(ep,{...s}):null}function ep({clientThreadId:t,suggestions:s}){const o=gn();return s===void 0||s.length===0?null:e.jsx("div",{children:e.jsx(tp,{children:e.jsx("div",{className:"grow",children:s!==void 0&&e.jsx(Qh,{suggestions:s,onSelectingSuggestedReply:o,clientThreadId:t})})})})}const tp=_e.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,oi=({className:t,children:s})=>e.jsx(se.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function sp({canContinue:t,onContinueGenerating:s}){const o=i.useCallback(()=>{s(),Xn()},[s]);let n=null;return t&&(n=e.jsx(op,{onHandleContinueGenerating:o})),n&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:n})}function np({className:t}){return e.jsx(Sr,{className:D("-rotate-180",t)})}const op=({onHandleContinueGenerating:t})=>e.jsx(oi,{children:e.jsx(Gt,{as:"button",color:"secondary",onClick:t,className:"whitespace-nowrap py-2",icon:np,size:"small",children:e.jsx(I,{...Ge.continueGenerating})})}),ap=({clientThreadId:t})=>{const s=or(),o=oe(t,Q.getRequestId),n=Tt(o);i.useEffect(()=>{n&&ga.dismissBanner()},[n]);const a=s?.is_dismissible?()=>ga.dismissBanner():void 0;return e.jsx(hs,{children:s&&e.jsx(se.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(Pc,{clientThreadId:t,rateLimitInfo:s,onDismiss:a})})})};function rp(t){const s=oe(t,Q.getRequestId),o=Tt(s),n=or();return!o&&n!=null}const to=window.sessionStorage,so=rl(il(()=>({memoryFullBannerDismissed:!!to?.getItem(Ft.MemoryFullBannerDismissed)}))),ai={dismissBanner(){so.setState(t=>{t.memoryFullBannerDismissed=!0}),to?.setItem(Ft.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){so.setState(t=>{t.memoryFullBannerDismissed=!1}),to?.removeItem(Ft.MemoryFullBannerDismissed)}};function ip(t){const s=ot(t),o=vr(),{data:n}=br(s,!1,o),a=n!=null,r=a&&n.memoryFullPct>=100,[l,c]=i.useState(!1);i.useEffect(()=>{!r&&a&&(c(!0),ai.clearDismissedBanner())},[r,a]);const d=so(p=>p.memoryFullBannerDismissed);return r&&l&&!d}function lp(){const t=Ce(),{openSettings:s}=Ic();return e.jsx(se.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Eo,{title:t.formatMessage(Gs.memoryFullTitle),content:t.formatMessage(Gs.memoryFullTooltip,Gs.memoryFullTooltip.values),primaryCtaText:t.formatMessage(Gs.memoryManageButton),onPrimaryCtaClick:()=>s(Hc.Personalization),onDismiss:()=>ai.dismissBanner()})})}const Gs=ht({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:Dc,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),zo=dt.hasSeenMemoryInSearch;function cp(){const t=cn();i.useEffect(()=>{q.logEventWithStatsig(U.chatgptMemoryInSearchAnnouncementShown,"chatgpt_memory_in_search_announcement_shown")},[]);const{markAsViewed:s}=ut(zo),o=i.useCallback(()=>{q.logEventWithStatsig(U.chatgptMemoryInSearchAnnouncementClosed,"chatgpt_memory_in_search_announcement_closed"),s()},[s]),n=i.useCallback(()=>{q.logEventWithStatsig(U.chatgptMemoryInSearchAnnouncementCTAClicked,"chatgpt_memory_in_search_announcement_cta_clicked"),t("#settings/Personalization"),s()},[s,t]);return e.jsx(Eo,{onPrimaryCtaClick:n,primaryCtaText:e.jsx(I,{id:"8MwdJw",defaultMessage:"Settings"}),onDismiss:o,content:e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"mb-0.5 font-semibold",children:e.jsx(I,{id:"Sdp8JT",defaultMessage:"Search, now with memory"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(I,{id:"a4czFu",defaultMessage:"ChatGPT can now use memories to shape searches it sends to search providers, to give you more relevant answers. You can turn this off at any time in settings. {learnMoreLink}",values:{learnMoreLink:e.jsx("a",{href:"https://help.openai.com/en/articles/9237897-chatgpt-search",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(I,{id:"JMsjZT",defaultMessage:"Learn more"})},"learn-more-link")}})})]})})}function ri(){const t=ut(zo),{userIsInSearchHoldoutWithWebDisabled:s}=Jr();return t.eligible&&!t.isLoading&&!s}function dp(){const{markAsViewed:t,eligible:s}=ut(zo);return s?t:void 0}const up=()=>{const{shouldShowSkipButton:t}=yr();return t?e.jsx(oi,{className:"flex justify-center",children:e.jsx(Gt,{as:"button",color:"secondary",onClick:()=>Bc.skipParagen(),children:e.jsx(I,{...mp.skip})})}):null},mp=ht({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),hp=Ve(()=>$e(()=>import("./i5sbs75z4926uz0k.js"),__vite__mapDeps([43,2,4,1,3,5,44,45,46])).then(t=>t.JawboneNotificationsBanner)),ii=i.memo(function({className:s}){const{store:o}=Ie(),n=o.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:D(s??"absolute bottom-full left-0 right-0",Cr.PromptTextareaHeader),children:e.jsx(Fc,{shouldRender:n,contentArea:Ut.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(li,{}),e.jsx(ci,{})]})})})});function li(){const{store:t}=Ie(),s=t.useSharedProps(r=>r?.clientThreadId),o=t.useContentAreaId(Ut.HeaderTop),n=wr();let a;switch(o){case V.ProjectConversationTaskNoFileAccess:a=e.jsx(xp,{});break;case V.AdvancedVoiceOnMobileAnnouncement:a=e.jsx(qc,{clientThreadId:s});break;case V.S09KM1:a=null;break;case V.ParagenControls:a=e.jsx(up,{});break;case V.ItemActions:a=e.jsx(Zh,{});break;case V.BannerSignup:a=e.jsx(fp,{});break;case V.BannerTermsDisclaimer:a=e.jsx(Sp,{});break;case V.PromptTextareaAction:a=e.jsx(vp,{});break;case V.BannersRateLimit:a=e.jsx(bp,{});break;case V.BannerSidekickAnnouncement:a=e.jsx(Wc,{});break;case V.SearchBrowserExtensionAnnouncement:a=e.jsx(ph,{});break;case V.MemoryInSearchAnnouncement:a=e.jsx(cp,{});break;case V.MoonshineAnnouncement:a=e.jsx(Gc,{});break;case V.CustomizeChatGPTAnnouncement:a=e.jsx(zc,{});break;case V.SearchBrowserExtensionReactiveAnnouncement:a=e.jsx(hh,{});break;case V.BannerMemoryFull:a=e.jsx(lp,{});break;case V.Box:a=e.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case V.JawboneAnnouncement:n?a=e.jsx(hp,{}):a=null;break;case V.JawboneMaxActiveAnnouncement:n?a=e.jsx(Uc,{}):a=null;break;case V.PromoRedemptionAnnouncement:a=e.jsx(Oc,{});break;case V.OperatorAnnouncement:a=e.jsx(Lc,{});break;default:a=null;break}return a}function ci(){const{store:t}=Ie(),s=t.useContentAreaId(Ut.HeaderBottom);let o;switch(s){case jr.DallePromptControls:o=e.jsx(gp,{});break;default:o=null;break}return o}const pp=Ve(()=>$e(()=>import("./oj0ucoamns6j4jmq.js"),__vite__mapDeps([47,2,1,3,4,5,10,48])).then(t=>t.default));function gp(){const{store:t}=Ie(),s=t.useSharedProps(o=>o?.composerController);return s?e.jsx(pp,{composerController:s}):null}function fp(){const{store:t}=Ie(),s=t.useSharedProps(a=>a?.clientThreadId),o=Vc(),n=$c();return s?o?e.jsx(Yc,{threadId:s,showSignUp:n}):e.jsx(Kc,{threadId:s,showLogin:n}):null}function xp(){return i.useEffect(()=>()=>{Hn.getItem(Ft.TasksHasSeenProjectDisclaimerBanner)||Hn.setItem(Ft.TasksHasSeenProjectDisclaimerBanner,!0)},[]),e.jsx(Eo,{icon:e.jsx(pr,{}),title:e.jsx(I,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:e.jsx(I,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{Hn.setItem(Ft.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Sp(){const{store:t}=Ie(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(Jc,{threadId:s}):null}function vp(){const{store:t}=Ie(),s=t.useSharedProps();return s?e.jsx(sp,{...s}):null}function bp(){const{store:t}=Ie(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(ap,{clientThreadId:s}):null}const yp=5,wp=i.memo(function(s){return jp(s),Cp(s),Mp(),null});function jp(t){const{store:s}=Ie(),o=s.useSetSharedProps();Wn(()=>{o(t)},[t,o])}function Cp(t){const{clientThreadId:s,canContinue:o}=t,{store:n}=Ie(),a=i.useRef({top:n.useContentAreaApi(Ut.HeaderTop),bottom:n.useContentAreaApi(Ut.HeaderBottom)}).current,r=_p(t),l=Qc(s),{shouldShowBannerSignup:c,shouldShowBannerTermsDisclaimer:d}=Ap(s),p=rp(s),m=Xc(t),u=gh(t),h=ri(),x=No(),g=Zc(),b=fh(t),j=ip(s),v=ed(),w=td(t),C=sd(s),A=nd(s),T=od(),B=ad(),M=oe(s,k=>k?.modelId),S=dn(s);Wn(()=>{M&&S?.kind===Le.GizmoInteraction&&S.gizmo&&cd(M,S.gizmo)?a.top.set(V.ProjectConversationTaskNoFileAccess):w.eligible?a.top.set(V.AdvancedVoiceOnMobileAnnouncement):v?a.top.set(V.ParagenControls):d?a.top.set(V.BannerTermsDisclaimer):p?a.top.set(V.BannersRateLimit):C?a.top.set(V.JawboneAnnouncement):A?a.top.set(V.JawboneMaxActiveAnnouncement):m.eligible?a.top.set(V.BannerSidekickAnnouncement):h?a.top.set(V.MemoryInSearchAnnouncement):x?a.top.set(V.MoonshineAnnouncement):g?a.top.set(V.CustomizeChatGPTAnnouncement):u?a.top.set(V.SearchBrowserExtensionAnnouncement):b?a.top.set(V.SearchBrowserExtensionReactiveAnnouncement):T?a.top.set(V.PromoRedemptionAnnouncement):B()?a.top.set(V.OperatorAnnouncement):r?a.top.set(V.ItemActions):o?a.top.set(V.PromptTextareaAction):c?a.top.set(V.BannerSignup):j?a.top.set(V.BannerMemoryFull):a.top.set(null)},[a,r,o,d,c,p,m,j,v,w]),Wn(()=>{l&&a.bottom.set(jr.DallePromptControls)},[a,l])}function Mp(){const{store:t}=Ie();i.useEffect(()=>()=>{t.reset()},[t])}function Tp(t){const s=Mr(),o=mo(t),n=Q.getTree(qe(t)).getLastValidNode(o)?.message?.id;return s?.messageId===n?s.suggestions:[]}function kp(t){return Tp(t).length>0}function _p(t){const{value:s}=Pe("1887864177"),o=rd(t.clientThreadId),n=kp(t.clientThreadId);return t.isDisabled||s?!1:t.isNewThread||o||n}function Ap(t){const{isUnauthenticated:s}=at(),o=mo(t),{layer:n}=Qs("3637408529"),{layer:a}=Ot("3637408529"),r=a.get("no_auth_banner_signup_rate_limit",yp),l=n.get("should_show_no_auth_signup_banner",!0),c=id(g=>g.bannerDisclaimerClientThreadId),d=ld(),p={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!t)return p;const m=Q.getTree(qe(t)),u=m.countMessagesByAuthor(st.User),h=m.getNodeByIdOrMessageId(o),x=h?.message?.author.role===st.Assistant&&ll(h.message);return p.shouldShowBannerTermsDisclaimer=x&&s&&u===1&&!d&&(c==null||c===t),p.shouldShowBannerSignup=l&&x&&s&&u>0&&u%r===0,p}const Np=({disabled:t,clientThreadId:s})=>{We.markStart("ComposerModelSelectorButton",We.NS_COMPOSER);const o={clientThreadId:s},n=Mo(),a=Lo(s,n,!0),{isLoading:r,data:l}=mt(),c=oe(s,x=>x?.modelId),d=rs(l?.models,c);if(r||!d)return null;const m=l?.categories.find(x=>x.defaultModel===d.id)?.shortLabel??d.title;We.markRendered("ComposerModelSelectorButton",We.NS_COMPOSER);function u(){q.logEventWithStatsig(U.composerSystemHintButtonHovered,"composer_model_selector_button_hovered",o)}function h(){q.logEventWithStatsig(U.composerSystemHintButtonClicked,"composer_model_selector_button_clicked",o)}return e.jsx(Ep,{disabled:t,modelLabel:m,onHover:u,onOpen:h,children:e.jsx(Oo,{sections:a})})},Ep=({disabled:t,children:s,modelLabel:o,onHover:n,onOpen:a})=>{const r=Ce(),[l,c]=i.useState(!1);return e.jsxs(Z.Root,{open:l,onOpenChange:d=>{c(d),d&&a?.()},children:[e.jsx(Rp,{disabled:!!t,children:e.jsx(ho,{className:D(Tr.toolsButton,"flex h-8 min-w-8 items-center justify-center gap-1 rounded-lg p-1 px-2 text-sm font-semibold text-token-text-secondary hover:bg-black/10 focus-visible:outline-black disabled:opacity-30 radix-state-open:bg-black/10 dark:focus-visible:outline-white"),"aria-label":r.formatMessage({id:"njhg2P",defaultMessage:"Choose a model"}),disabled:t,onPointerOver:n,onClick:d=>{d.preventDefault()},onFocusCapture:d=>{d.stopPropagation()},children:o})}),e.jsx(Z.Portal,{children:e.jsx(Z.Content,{alignOffset:-16,onCloseAutoFocus:d=>{d.preventDefault()},className:"[--radix-popper-available-height:40dvh]",removeVerticalPadding:!0,addBottomGradient:!0,children:e.jsx("div",{className:"flex flex-col",children:s})})})]})},Rp=({disabled:t,children:s})=>e.jsx(ds,{side:"right",sideOffset:0,label:t?e.jsx(I,{id:"WU1XH1",defaultMessage:"Model selector unavailable"}):e.jsx(I,{id:"7bVJwH",defaultMessage:"Choose a model"}),children:s});function Pp({composerController:t,isDisabled:s,disabledReason:o,highlightTooltip:n,isPinnedActive:a,clientThreadId:r,showLabel:l,currentModelName:c}){const d=Qr(),p=Ce(),m=i.useMemo(()=>({clientThreadId:r}),[r]),u=i.useCallback(()=>{q.logEventWithStatsig(U.composerSearchButtonClicked,"composer_search_button_clicked",m),d&&t.trimLeadingText(/^search\b/i)},[m,t,d]),h=i.useMemo(()=>({systemHint:K.Search,description:p.formatMessage({id:"m/oaZE",defaultMessage:"Find on the web"}),logo:"",requiredFeatures:["search"],requiredModels:[],requiredConversationModes:[Le.PrimaryAssistant],name:p.formatMessage({id:"TbHx8d",defaultMessage:"Search"})}),[p]);return e.jsx(Hp,{highlightTooltip:n,analyticsMetadata:m,isThreadUsingSearchMode:d,isDisabled:s||a,disabledReason:o,currentModelName:c,children:e.jsx(ni,{highlightTooltip:n,isDisabled:s||a,isPinnedActive:a,systemHint:h,logo:e.jsx(kr,{className:"h-[18px] w-[18px]"}),composerController:t,analyticsMetadata:m,onClick:u,showLabel:l})})}function Ip(){const t=ri(),s=No(),o=ut(dt.hasSeenComposerSearchButtonTooltip);return!o.isLoading&&o.eligible&&!t&&!s}function Hp({children:t,highlightTooltip:s,analyticsMetadata:o,isThreadUsingSearchMode:n,isDisabled:a,disabledReason:r,currentModelName:l}){const c=Ip()&&!n,d=ut(dt.hasSeenComposerSearchButtonTooltip);return c?e.jsx(Ao,{announcementKey:dt.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(I,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:d.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(I,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(dd,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(I,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(ds,{sideOffset:0,label:a?r===tn.ModelNotSupported?e.jsx(I,{id:"GZemJe",defaultMessage:"Search disabled for {modelName}",values:{modelName:`${l}`}}):r===tn.HasAttachedFiles?e.jsx(I,{id:"Wd1fc2",defaultMessage:"Search disabled for attachments"}):e.jsx(I,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(I,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"bottom",open:s||void 0,onOpenChange:p=>{p&&q.logEventWithStatsig(U.composerSearchButtonHovered,"composer_search_button_hovered",o)},children:t})})}function Dp({composerController:t,clientThreadId:s}){const o=us(s),n=Do(),{setThreadSystemHintMode:a,clearAllSystemHintModeTriggers:r}=hn(),{value:l}=Pe("1416952492"),{value:c}=je("1325692000"),d=pn(s).filter(S=>S.systemHint!==K.Think&&(S.systemHint!==K.Research||!l)&&!S.composerBarButtonInfo?.upsell),[p,m]=i.useState([]),[u,h]=i.useState(void 0),[x,g]=i.useState(0);i.useEffect(()=>{m(u?d.filter(S=>S.name.toLocaleLowerCase().startsWith(u.text.toLocaleLowerCase())||S.systemHint.toLocaleLowerCase().startsWith(u.text.toLocaleLowerCase())):[])},[u]),i.useEffect(()=>{t.view.dispatch(xh(t.view.state.tr,{onHintMatch(S){h(k=>ar(k,S)?k:S)}}))},[t]);const b=!d.length||!p.length||!u;i.useEffect(()=>{b&&g(0)},[b]);const j=p.length,v=i.useCallback(S=>{g(k=>(S(k)%j+j)%j)},[j]),w=p[x],C=({hintToSave:S=w,expectPerfectMatch:k})=>{if(!u||!w||k&&S.name.toLowerCase()!==u.text.toLowerCase())return!1;q.logEvent(U.systemHintSelected,{system_hint:S.systemHint,conversation_id:o??fa});const F=u.range.from===1?S.name:u.text+S.name.slice(u.text.length),N={clientThreadId:s};Us(t.view),n.size>0&&r();const E=!!S.composerBarButtonInfo,f=S.systemHint===K.Search;return c||E||f?(a(S.systemHint,!0,N,f?io.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),u.range&&t.delete(u.range.from,u.range.to),t.removeSystemHints(),!0):(t.addSystemHint(S.systemHint,F,u.range.from,u.range.to),!0)},A=i.useRef(C);A.current=C;const T=i.useRef(v);T.current=v;const B=i.useRef(u);B.current=u;const M=t.view;return i.useEffect(()=>(b||Sh(M,S=>{if(S==="up")T.current(k=>k-1);else if(S==="down")T.current(k=>k+1);else if(S==="cancel")Us(M),vh(M);else{if(S==="submit")return Us(M),A.current({expectPerfectMatch:!1});if(S==="checkMatch")return A.current({expectPerfectMatch:!0})}}),()=>Us(M)),[b,M]),i.useEffect(()=>{b||q.logEvent(U.systemHintListOpened,{conversation_id:o??fa})},[b]),b?null:e.jsx(cl,{className:"max-w-60",onMouseDown:S=>{S.preventDefault()},children:p.map((S,k)=>e.jsx("div",{onMouseOver:()=>g(k),onClick:()=>{C({hintToSave:S,expectPerfectMatch:!1}),t.focus()},children:e.jsx(dl,{autoFocus:!1,className:"rounded-lg px-1 py-2",$spoofHovered:k===x,children:e.jsx(di,{title:S.name,description:S.description,logo:S.logo})})},S.systemHint))})}function di({title:t,description:s,logo:o,checked:n}){return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-2 pl-1.5 pr-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:e.jsx(mn,{svgString:o,className:"icon-lg text-token-text-secondary"})}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary",children:t}),!!s&&e.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary",children:s})]}),n&&e.jsx(ul,{className:D("icon-md text-token-text-primary",{"group-hover:hidden":!n})})]})}function Bp({composerController:t,clientThreadId:s}){return t instanceof Bo?e.jsx(Dp,{composerController:t,clientThreadId:s}):null}function Fp({children:t,className:s,showBackground:o}){return e.jsxs("div",{className:"relative",children:[t,o&&e.jsx(se.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:D("pointer-events-none absolute bottom-0 top-0 h-9 w-9 rounded-full",s)})]})}function Na({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,getInputProps:r,openFileDialog:l,onOauthRedirect:c,historyDisabled:d,isNested:p,isDisabled:m,highlightTooltip:u,disabledReason:h,currentModelName:x,showLabel:g,showUpsell:b}){const j=ud(),{gdriveStatus:v,o365Status:w}=md(),C="h-[18px] w-[18px]",A=d?"text-white":u?"text-brand-blue-800":"",T=b?e.jsx(Ro,{"aria-label":"",className:D(C,A)}):e.jsx(_r,{"aria-label":"",className:D(C,A)}),M=(v!=="false"||w!=="false"||j)&&!b?e.jsx(hd,{clientThreadId:t,icon:T,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,onOauthRedirect:c,uploadType:s,openFileDialog:l,isNested:p,getInputProps:r,isDisabled:m,highlightTooltip:u,disabledReason:h,currentModelName:x}):e.jsx(pd,{clientThreadId:t,uploadType:s,openFileDialog:l,getInputProps:r,showLabel:g,showUpsell:b,icon:T,isDisabled:m,highlightTooltip:u,disabledReason:h,currentModelName:x});return p?M:e.jsx("div",{className:"relative",children:e.jsx(Fp,{showBackground:u,className:"bg-brand-blue-800/20",children:M})})}function Lp({suggestions:t,composerController:s,onSelect:o,onChange:n}){const a=gn(),r=i.useCallback((m,u,h)=>{o?.(m,u,h),a(m,u,h)},[o,a]),[l,c]=i.useState(-1),[d,p]=i.useState(!1);return i.useEffect(()=>{const m=u=>{if(!u.isComposing)if(u.key==="ArrowDown"){const h=l===t.length-1?0:l+1;c(h),n?.(h,!0,t[h])}else if(u.key==="ArrowUp"){u.preventDefault();const h=l<=0?t.length-1:l-1;c(h),n?.(h,!0,t[h])}else u.key==="Enter"&&!u.shiftKey&&t[l]&&r(t[l],t,l)};return s.subscribe("keydown",m)},[t,l,n,r,s]),i.useEffect(()=>s.subscribe("blur",()=>{c(-1),n?.(-1,!1)}),[s,n]),i.useEffect(()=>{if(!d){const m=()=>{p(!0),window.removeEventListener("mousemove",m)};return window.addEventListener("mousemove",m),()=>{window.removeEventListener("mousemove",m)}}},[d]),i.useEffect(()=>{c(-1),n?.(-1,!1),p(!1)},[t,n]),e.jsx(se.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:t.map((m,u)=>e.jsxs(se.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:u*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[u>0&&e.jsx("div",{className:D("h-[1px] opacity-60 max-lg:hidden",l===u||l===u-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),e.jsxs("button",{className:D("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",l===u?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:h=>{h.preventDefault(),r(m,t,u)},onMouseDown:h=>{h.preventDefault()},onMouseEnter:()=>{d&&(c(u),n?.(u,!1,m))},onMouseLeave:()=>{c(-1),n?.(-1,!1,m)},children:[m.icon?e.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:m.icon}):null,e.jsx("span",{className:"whitespace-pre-wrap",children:m.autocompletionChunks&&m.autocompletionChunks.length>0?e.jsx(e.Fragment,{children:m.autocompletionChunks.map((h,x)=>e.jsx("span",{className:D(h.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:h.text},x))}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:D(m.type===zt.Starter||m.type===zt.Trending?"text-token-text-secondary":"text-token-text-tertiary"),children:m.title}),e.jsx("span",{className:"text-token-text-primary",children:m.body})]})})]}),u>0&&e.jsx("div",{className:D("h-[1px] opacity-60 lg:hidden",l===u||l===u-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},m.id??u))})}function Op(t,s){t=t.toLocaleLowerCase();const o=s;s=s.toLocaleLowerCase();const n=[];let a=0;for(let c=0;c<s.length&&(a<t.length&&t[a]===s[c]&&(n.push(c),a++),a!==t.length);c++);const r=[];let l=0;if(n.forEach(c=>{if(c>l){const d=o.slice(l,c);d&&r.push({text:d,isMatched:!1})}r.push({text:o[c],isMatched:!0}),l=c+1}),l<s.length){const c=o.slice(l);c&&r.push({text:c,isMatched:!1})}return Up(r)}function Up(t){if(t.length===0)return t;let s=[t[0]];for(let n=1;n<t.length;n++){const a=s[s.length-1],r=t[n];a.isMatched===r.isMatched?a.text+=r.text:s.push(r)}const o=s.filter(n=>n.isMatched).reduce((n,a)=>n+a.text.trim().length,0);return s.length<=4&&o>=2?s:[{text:s.map(n=>n.text).join(""),isMatched:!1}]}const zp=i.forwardRef(function({type:s,placeholder:o,replyRegions:n,state:a,renderFiles:r,leftSideActions:l,topRightAction:c,onSubmit:d,setIsComposerOverflowing:p,inputState:m,currentLeafId:u,composerController:h,clientThreadId:x,gizmoId:g,disableReason:b,controlsDisabled:j,setControlsDisabled:v},w){const C=nt(),A=gd();i.useState(void 0);let T=null;const{isLoading:B}=A;B||(T=A.modelId);const M=i.useRef(null),[S,k]=i.useState(300);i.useEffect(()=>{M.current&&k(M.current.offsetWidth)},[]),i.useEffect(()=>{B||ml()||h.focus()},[T,h,B]);const{value:F}=je("3780975974"),{getShowUpsellReason:N}=Ar(),E=F||N(),f=H=>{Yp({target:H.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||h.focus()},R=i.useCallback(()=>h instanceof Nr?e.jsx(Gp,{composerController:h,currentLeafId:u,placeholder:o,inputState:m}):e.jsx(bh,{composerController:h,placeholder:o}),[h,u,o,m]),_=i.useCallback(()=>e.jsx(fd,{inputState:m,state:a,onSubmit:d,composerController:h,clientThreadId:x,gizmoId:g,disableReason:b}),[m,a,d,h,x,g,b]);return e.jsxs("div",{id:"composer-background",ref:w,className:D("flex w-full cursor-text flex-col rounded-3xl border border-token-border-light px-3 py-1 duration-150 ease-in-out contain-inline-size motion-safe:transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] dark:border-none dark:shadow-none",s!=="temporary"&&"shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)] has-[:focus]:shadow-[0_2px_12px_0px_rgba(0,0,0,0.04),_0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)]",C&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",C&&s!=="temporary"&&"bg-token-composer-surface",!C&&s!=="temporary"&&"bg-token-main-surface-primary dark:bg-[#303030]",s==="temporary"&&"dark bg-[#303030]"),onClick:f,style:{viewTransitionName:"var(--vt-composer)"},children:[e.jsx(hs,{initial:!1,children:n.length>0&&e.jsx(se.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx(Wp,{replyRegions:n})})}),e.jsxs(e.Fragment,{children:[r,e.jsxs("div",{className:"flex min-h-[44px] items-start pl-1",ref:M,children:[e.jsx("div",{className:"min-w-0 max-w-full flex-1",children:R()}),e.jsx("div",{className:"w-[32px] pt-1",children:c})]}),e.jsxs("div",{className:"mb-2 mt-1 flex items-center justify-between sm:mt-5",ref:H=>{if(!E||!("ResizeObserver"in window))return;let L=new AbortController,z=window.innerWidth;const Y=xd({axis:"width",debounce:!0,target:H,onChange:()=>{if(!H)return;H.scrollWidth>H.clientWidth?p?.(!0):Math.abs(z-window.innerWidth)>40&&(p?.(!1),z=window.innerWidth)}});return()=>{Y?.(),L.abort()}},children:[e.jsx("div",{className:"flex gap-x-1.5 text-token-text-primary",children:l}),e.jsx("div",{className:"flex gap-x-1.5",children:_()})]})]})]})});function Gp({composerController:t,currentLeafId:s,placeholder:o,inputState:n}){const a=i.useContext(ln);return e.jsxs(e.Fragment,{children:[e.jsx(Sd,{id:eh,autoFocus:!0,tabIndex:0,"data-id":s,dir:"auto",ref:r=>{if(!(t instanceof Nr))throw new Error("Expected TextAreaComposerController");r!=null&&(t.textArea=r,t.logPageMount())},rows:1,placeholder:o,disabled:n!=="default",className:D("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",n==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),e.jsx("script",{nonce:a.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function Wp({replyRegions:t}){return e.jsx("div",{className:"-mx-2 flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:t.map((s,o)=>{switch(s.type){case"text":return e.jsx(qp,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"object":return e.jsx(Vp,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"mention":case"system_hint":return e.jsx($p,{value:s.value,icon:s.icon,onRemoveRegion:s.onRemoveRegion},o)}})})}function qp({value:t,onRemoveRegion:s}){return e.jsxs(Wo,{className:"text-token-text-secondary",children:[e.jsx(qo,{children:e.jsx(Er,{className:"icon-lg-heavy"})}),e.jsx(Vo,{children:`“${t}”`}),e.jsx(Go,{onClick:s})]})}function Vp({value:t,onRemoveRegion:s}){return e.jsxs(Wo,{className:"text-blue-selection",children:[e.jsx(qo,{children:e.jsx(Er,{className:"icon-lg-heavy"})}),e.jsx(Vo,{className:"font-semibold",children:t}),e.jsx(Go,{onClick:s})]})}function $p({value:t,icon:s,onRemoveRegion:o}){return e.jsxs(Wo,{children:[e.jsx(qo,{className:"mt-0",children:s}),e.jsx(Vo,{className:"font-semibold text-token-text-primary",children:t}),e.jsx(Go,{onClick:o})]})}function Go({onClick:t}){return e.jsx("button",{onClick:t,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:e.jsx(gr,{className:"icon-lg"})})}const Wo=_e.div`bg-token-main-surface-secondary dark:bg-token-main-surface-tertiary flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,qo=_e.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,Vo=_e.span`flex-1 line-clamp-3 py-0.5`;function Yp({target:t,rootId:s,additonalInteractiveIds:o}){let n=t;for(;n&&n!=null;){if(n.tagName==="BUTTON"||n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable||o.includes(n.id))return!0;if(n.id===s)return!1;n=n.parentElement}return!1}function ui(t){const s=Do(),o=t.useState(a=>a.getSystemHints()[0]);return s.size?s.values().next().value:o}function mi(t,s){const{clearAllSystemHintModeTriggers:o,setThreadSystemHintMode:n}=hn(),{value:a}=je("1325692000");return i.useCallback(({hint:r,enable:l})=>{o();const c=!!r.composerBarButtonInfo;l?c||a?(n(r.systemHint,!0,{clientThreadId:s}),t.removeSystemHints()):(t.addSystemHint(r.systemHint,r.name),setTimeout(()=>{t.focus()},0)):t.removeSystemHints()},[o,t,n,s,a])}const Ea=({composerController:t,disabled:s,clientThreadId:o,isComposerV2Mode:n,uploadButtons:a,showLabel:r,showUpsell:l})=>{const{value:c}=je("1325692000"),d=pn(o).filter(v=>v.systemHint===K.Research&&(n||c)?!0:!v.composerBarButtonInfo&&v.systemHint!==K.Search),p=ui(t),{value:m}=je("3780975974"),u=mi(t,o),[h,x]=i.useState(!1);if(i.useEffect(()=>{const v=Math.random(),w=setInterval(()=>{const C=new Date,A=C.getHours()+C.getMinutes()/60+C.getSeconds()/3600,T=Math.abs((6+A)%12-6)/6;x(Math.pow(T,15)>v)},1e3);return()=>clearInterval(w)},[]),!(t instanceof Bo)||d.length===0&&!n)return null;const g={clientThreadId:o};function b(){q.logEventWithStatsig(U.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",g)}function j(){q.logEventWithStatsig(U.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",g)}return e.jsx(Kp,{systemHints:d,selectedHint:p,showJack:m?!1:h,disabled:s,isComposerV2Mode:n,onHover:b,onOpen:j,onSelect:u,uploadButtons:a,showLabel:r,showUpsell:l})},Kp=({systemHints:t,selectedHint:s,showJack:o,disabled:n,isComposerV2Mode:a,onHover:r,onOpen:l,onSelect:c,uploadButtons:d,showLabel:p,showUpsell:m})=>{const u=Ce(),[h,x]=i.useState(!1),g=t.find(T=>T.systemHint==="contextual_answers")?.name,{value:b}=je("3780975974"),j=t.length>0,v=!1;if(!hl())return null;const C=m?e.jsx(To,{location:"tools",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"}):e.jsxs(e.Fragment,{children:[j&&e.jsxs(e.Fragment,{children:[v,t.map(T=>e.jsx(Z.Item,{className:D(!a&&"px-1 py-2",a&&"mx-0 rounded-xl p-1.5 px-2 py-2.5"),onClick:()=>c?.({hint:T,enable:T.systemHint!==s}),children:a?e.jsx(vd,{title:T.name,description:T.description,icon:T.logo,checked:T.systemHint===s}):e.jsx(di,{title:T.name,description:T.description,logo:T.logo,checked:T.systemHint===s})},T.systemHint))]}),j&&d&&e.jsx(Z.Separator,{className:"mx-2 my-1",noMargin:!0}),d]}),A=m&&p?e.jsx(Ro,{"aria-label":"",className:"pointer-events-none h-[18px] w-[18px]"}):e.jsx(_r,{"aria-label":"",className:"pointer-events-none h-5 w-5"});return e.jsxs(Z.Root,{open:h,onOpenChange:T=>{x(T),T&&l?.()},children:[e.jsx(Jp,{disabled:!!n,contextualAnswersHintNameIfPresent:g,children:e.jsxs(ho,{className:D(Tr.toolsButton,"flex h-9 min-w-9 items-center justify-center rounded-full border border-token-border-light p-1 text-xs font-semibold text-token-text-secondary focus-visible:outline-black disabled:opacity-30 radix-state-open:bg-black/10 can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700"),"data-opened":Ra(h),"data-jack":Ra(!!o),"aria-label":a?u.formatMessage({id:"9xVxsA",defaultMessage:"Upload files and more"}):u.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:n,onPointerOver:r,onClick:T=>{T.preventDefault()},onFocusCapture:T=>{T.stopPropagation()},children:[a?A:b?e.jsx(bd,{className:"pointer-events-none h-5 w-5"}):e.jsx(yd,{className:"pointer-events-none h-5 w-5"}),m&&p&&e.jsx("span",{className:"whitespace-nowrap pr-2 text-[13px] font-semibold [display:--force-hide-label]",children:u.formatMessage({id:"AlZBxR",defaultMessage:"Tools"})})]})}),e.jsx(Z.Portal,{children:e.jsx(Z.Content,{alignOffset:-16,className:D(a&&"flex flex-col justify-start gap-2",a&&!m&&"p-1.5"),onCloseAutoFocus:T=>{T.preventDefault()},removeVerticalPadding:a||m,children:C})})]})},Jp=({disabled:t,children:s,contextualAnswersHintNameIfPresent:o})=>{const n=ut(dt.hasSeenComposerSystemHintButtonTooltip),a=ut(dt.hasSeenCaSystemHint),r=!t&&!n.isLoading&&n.eligible,l=!t&&!n.isLoading&&o&&!a.isLoading&&a.eligible,c=r?{announcementKey:dt.hasSeenComposerSystemHintButtonTooltip,title:e.jsx(I,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:n.markAsViewed,description:e.jsx(I,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."})}:l?{announcementKey:dt.hasSeenCaSystemHint,title:e.jsx(I,{id:"uaC1JM",defaultMessage:"Not finding internal information?"}),onDismiss:a.markAsViewed,description:e.jsx(I,{id:"TL/S+W",defaultMessage:"If ChatGPT didn't search your files automatically, type {hintName} or select it from the menu.",values:{hintName:e.jsx("span",{className:"whitespace-nowrap font-bold",children:'"/'+o+'"'})}})}:void 0;return c?e.jsx(Ao,{show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",...c,children:s}):e.jsx(ds,{side:"top",sideOffset:0,label:t?e.jsx(I,{id:"uw9x80",defaultMessage:"Tools unavailable"}):e.jsx(I,{id:"mrYNGk",defaultMessage:"View tools"}),children:s})};function Ra(t){return t?"":null}const Qp=1,Xp=3e3;function Zp({files:t,className:s}){const o=go(),n=Rr(),a=au();return e.jsxs("div",{className:s,children:[a.map(r=>e.jsx(ru,{textdocId:r.tempTextdocId,userCreatedTextdoc:r},r.tempTextdocId)),t.map(r=>e.jsx(iu,{borderRadius:"2xl",useV2Style:!0,width:o?"normal":"wide",onRemoveFileClick:()=>Ys.remove(n,r.tempId,"none"),file:r.file,fileId:r.fileId??void 0,contextConnectorInfo:r.contextConnectorInfo,loadingPercentage:r.status===lu.Uploading?r.progress:void 0},r.tempId))]})}const Pa="search-button",Ia="active-hint-tag";function eg({onAbortCompletion:t,onCreateNewCompletion:s,onContinueGenerating:o,currentModelId:n,clientThreadId:a,isNewThread:r,isCompletionInProgress:l,className:c,disabled:d=!1,disabledReason:p,canPause:m=!1,canContinue:u=!1,suggestions:h,isInteractableSharedThread:x,composerContainerRef:g,autocompletions:b,requiresFileUpload:j,onComposerInput:v,onComposerChange:w,onAutocompleteSelect:C,headerClassName:A,hideHeader:T,setComposerBarElement:B,onTaggingDropdownOpen:M,onTaggingDropdownClose:S}){We.markStart("PromptTextarea"),We.markRendered("PromptTextarea");const k=i.useRef(null),F=cu(k,B),{data:N}=an(),{data:E}=mt(),f=fn(),R=Po(),_=tr(N),H=_?.isFree(),{isUnauthenticated:L}=at(),z=Ce(),Y=ao(),P=Rr(),[re,ie]=oe(a,y=>[Q.getCurrentLeafId(y),Q.getRequestId(y)]),[Ae]=vo(),ne=cn(),{gizmoEditorData:xe,mode:Me,getGizmoId:fe}=wd(),Se=rr(),Oe=pl(),Ne=kt(),ve=Pr(),he=us(a),Te=!!gl(),Qe=!!fl(),Ue=!!po(),[le,ze]=i.useState({}),{setThreadSystemHintMode:G,clearSystemHintModeTrigger:W,getSystemHintModeTrigger:ce}=hn(),$=Kr(),X=$.has(K.Search),de=$.has(K.Think),pe=pn(a),Xe=pe.length>0,be=$.size===1&&$.values().next().value,Ye=be&&be!==K.Search&&be!==K.Think,Ee=pe.find(y=>y.systemHint===be),[He,ye]=i.useState(!1),[ee,Ze]=i.useState(!1),gs=nt(),Wt=i.useRef(!1),fs=null,ue=rs(E?.models,n);let te=dn(a),pt=te&&"gizmo"in te?te.gizmo:void 0;const At=ps(pt?.gizmo.id),Re=dp(),xn=jd(),xs=jo(pt?.gizmo.id),[we,Nt]=i.useState(null);we!==null&&(te={gizmo:we,gizmo_id:we.gizmo.id,kind:Le.GizmoInteraction},pt=we);const gt=ya(ue,te),Sn=xl(),qt=!d&&gt!==Fs.None&&!L,ft=Cd(ue,te),Vt=Md(ue,te);let De=wa(y=>y.files);const[$t]=i.useState(()=>Td());Me==="magic"?De=De.filter(y=>y.gizmoId!=null):De=De.filter(y=>y.gizmoId==null);const Ss=kd(),rt=De.length>0||Ss,Yt=wa(du.hasUploadInProgress),Et=_d(a),Rt=f.useState(y=>{const J=th(y);return typeof ue?.maxTokens=="number"&&J>ue.maxTokens}),Kt=f.useState(y=>!y.isEmpty()),et=!Rt&&!Yt&&(Kt||rt);Ir(De.length>0||Yt||Kt);const vs=(gt===Fs.Multimodal?Ad:Nd)-De.length,vt=vs<=0,tt=et&&!d&&!l&&!Ue,[bt,Jt]=i.useState(!1),{value:bs,isLoading:vn}=je("3780975974"),{value:bn}=je("759329447"),{value:ys}=je("2223246572"),{value:Be}=je("1325692000"),ws=n??yo(E).id,yt=rs(E?.models,ws),Qt=Zs(yt,Ks.Search),{value:js}=Pe("2603280534"),{userIsInSearchHoldoutWithWebDisabled:yn}=Jr(),Cs=!d&&(!pt||At&&js)&&Se?.includes(qs.SearchTool)&&!Se?.includes(qs.SearchToolHoldout)&&!yn&&(Se?.includes(qs.BrowsingAvailable)||!_?.isEnterprisey())&&(!Be||!Ye),{value:wn}=Pe("1416952492"),{value:Xt}=Pe("4239853523"),Zt=Cs&&Qt,{targetedContent:Ms,setTargetedContent:Pt}=Hr(),Fe=Ms?.isFocusedViewContent&&!ve?void 0:Ms,{rebaseSystemMessageContent:Ts}=Io(),jn=te?.kind===Le.PrimaryAssistant||te?.kind===Le.GizmoInteraction&&At,Cn=pe.find(y=>y.systemHint===K.Think),{getUpsellLabelType:ks,getUpsellShowsAttach:Mn,getShowUpsellReason:O}=Ar(),ge=bs&&Cn&&fs==null&&te?.kind===Le.PrimaryAssistant&&(bn||Be)&&(!Be||!Ye),it=te?.kind===Le.PrimaryAssistant&&!Ne&&!Be&&!Xt,wt=Xe&&jn,[Yo,vi]=i.useState(!1),bi=!H&&wt&&!ys,[es,yi]=i.useState(!1);i.useEffect(()=>{if(!R?.id)return;const y=Ma.getAndReset(R?.id,he);y&&f.setText(y.inputText)},[R?.id,he,f]),i.useEffect(()=>{const y=Ae.get("prompt")??"";f.getCurrentText().length===0&&y.length>0&&f.setText(y)},[f,Ae]),i.useEffect(()=>{bt!==tt&&(Jt(tt),tt&&Sl(!0).then(y=>{Ed.startEnforcement(y),vl.startEnforcement(y)}))},[tt,bt,te?.kind,Se]);const Tn=Rd(ue,te),{handleFileAccepted:wi}=Pd(z,ya(ue,te),ft,"mouse",fe,Tn?.attachments),{getInputProps:ji,open:Ci}=Id({disabled:d||!qt||vt,noClick:!0,onDropAccepted:wi,onDropRejected:y=>Hd(y,z,Y,gt),multiple:!0,maxSize:Dd,maxFiles:vs,...Bd(Vt)}),Ko=bl($t),{value:Mi}=je("1988730211"),Jo=i.useCallback(()=>{f.eraseContent(),Ko.clearMessages(),f.resize(Qp),f.usedDictation=!1,Fd();for(const y of De)Ys.remove(P,y.tempId,"none");Ld.markAllAsSent()},[f,Ko,De,P]),_s=async(y,J)=>{if(y?.preventDefault(),d||!et&&!J||!te||qe(a)?.isLoading!==!1)return;ye(!0),Re?.(),xn?.();const ae=f.getContentToSend(),me=nh(ae.content),Ke=new uu(mu.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:os,attachments:Ps}=Qm(P,me,ue,te),ca=[],Pn=[];Ts&&Pn.push(Cl(Ts));const In={...te};"gizmo"in In&&delete In.gizmo;let Is=f.getSystemHints();$.size>0&&(Is=Array.from($));const da=ce(K.Search),Xi=X?da??io.CONVERSATION_COMPOSER_WEB_ICON:void 0,ua=hu(),ma=hr(),Zi=f.usedDictation;let lt={content:os,eventSource:y?"mouse":"keyboard",completionMetadata:{suggestions:h,conversationMode:In,systemHints:Is,searchSource:Xi},messageMetadata:{...Ps.length>0&&{attachments:Ps},...we&&{gizmo_id:we?.gizmo.id},...le,...Is.length>0&&{system_hints:Is},...!!ae.metadata&&{serialization_metadata:ae.metadata},...ua.length>0&&{canvas:{user_created_textdocs:ua.map(ct=>({user_created_temp_textdoc_id:ct.tempTextdocId,type:ct.type,title:ct.title,content:ct.content,create_source:ct.create_source,remix_shared_textdoc_id:ct.remixSharedTextdocId}))}},...Object.keys(ma).length>0&&{__internal:{search_settings:ma}},dictation:Zi},prependMessages:ca.length>0?ca:void 0,appendMessages:Pn.length>0?Pn:void 0,profiler:Ke};if(lt=pu(lt),Mi&&lt.completionMetadata.systemHints){let ct=!1;lt.completionMetadata.systemHints=lt.completionMetadata.systemHints.filter(el=>el===K.Search?(ct=!0,!1):!0),ct&&(lt.extraStreamParams={forceUseSearch:!0})}Fe?.createNewCompletionParams&&(lt=await Fe.createNewCompletionParams(lt)),Ke.logTiming("request_params_ready"),await s(lt),Fe?.onCreateCompletion?.({serverThreadId:he,currentLeafId:re}),Fe?.shouldPersistAcrossMessages!==!0&&Pt(void 0),sn.hideThreadHeader(),Jo(),ye(!1),Ke.logTiming("prompt_submitted"),h!==void 0&&(ke.logEvent("chatgpt_prompt_ignore_suggestions"),q.logEvent(U.promptIgnoreSuggestions)),X&&da&&W(K.Search)},Ti=i.useRef(_s);i.useEffect(()=>{Ti.current=_s});const ki=y=>{Pt(y.targetedReply),y.targetedReply&&(f.focus(),q.logEvent(U.targetedReplyButtonClicked,{conversationId:he,sourceMessageId:y.messageId}))},Qo=i.useCallback(()=>{Fe?.onCleared?.({serverThreadId:he,currentLeafId:re}),Pt(void 0),f.focus()},[re,he,Fe,Pt,f]),Xo={Enter:{validator:y=>{const J=y.isComposing||y.keyCode===229;return!(ee&&Wt.current)&&(y.metaKey||(Oe||Ml)&&!y.shiftKey&&!J)},handler:y=>{if(!tt){Rt&&Y.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}y.preventDefault(),_s()}},Escape:{validator:y=>!y.isComposing,handler:y=>{m&&l&&(t("",ie),q.logEvent(U.pauseCompletion,{threadId:Je(a),currentLeafId:Q.getMessageId(qe(a)),eventSource:"keyboard"})),y.target.value===""&&Qo()}}},ts=i.useRef(Xo);ts.current=Xo;const As=Od(yt?.tags,te?.kind),[kn,Ns]=i.useState(!1),[_n,Zo]=i.useState(!1),ss=As&&kn&&!At,ea=f.isReady();i.useEffect(()=>f.subscribe("keydown",y=>{f.acceptLegacyKeydown()&&ts.current[y.key]?.validator(y)&&ts.current[y.key].handler(y);const ae=f.getCurrentText();if(y.key==="@"){const me=f.getSelectionStart(),Ke=ae.substring(0,me);(!Ke||/\s$/.test(Ke)||me===0)&&setTimeout(()=>Ns(!0),10)}else kn&&Ns(!1);if(y.key==="Escape"&&(Nt(null),Ze(!1)),Zt&&!X){let me;y.key==="Backspace"?me=ae.substring(0,ae.length-1):me=ae+y.key,/^search\s?$/i.test(me)?Zo(!0):_n&&Zo(!1)}X&&y.key==="Escape"&&G(K.Search,!1,{clientThreadId:a})}),[f,ea,kn,_n,Zt,$,X,G,a]),i.useEffect(()=>{const y=Object.fromEntries(Object.keys(ts.current).map(J=>[J,me=>{const Ke=ts.current[J];if(!Ke||f.acceptLegacyKeydown())return!1;const{validator:os,handler:Ps}=Ke;return os(me)?(Ps(me),!0):!1}]));f.registerKeyHandlers(y)},[f,ea]),i.useEffect(()=>f.subscribe("paste",y=>{Ud({filePickerStore:P,event:y,intl:z,toaster:Y,clientThreadId:a,conversationMode:te,currentModelConfig:ue,getEditorGizmoId:fe,modelSupportedImageMimeTypes:ft})}),[z,a,te,ue,fe,ft,f,Y,P]);const _i=y=>{Te||Nt(y),f.trimLeadingText("@"),Xn(),Ns(!1)},Ai=zd(a,$t,ft,Tn?.attachments),Ni=i.useCallback(y=>{y?.preventDefault(),t("",ie),q.logEvent(U.pauseCompletion,{threadId:Je(a),currentLeafId:Q.getMessageId(qe(a)),eventSource:"mouse"}),Xn()},[t,a,ie]),ta=i.useCallback(()=>{Ma.set(R?.id,he,f.getCurrentText())},[he,R?.id,f]);i.useEffect(()=>{xe||!He&&!yl()&&f.focus()},[He,f]),i.useEffect(()=>{if(ft.length>0)for(const J of De)sh(J.fileSpec?.mimeType,Vt)||Ys.remove(P,J.tempId,"none");else Ys.reset(P)},[n,P]),i.useEffect(()=>{(!As&&we||Te)&&Nt(null)},[As,we,Te]);const{layer:Ei}=Ot("4031588851"),{layer:sa}=Ot("3637408529"),Ri=sa.get("is_in_composer_text_exp",!1),Pi=sa.get("composer_text","MESSAGE_CHATGPT"),Ii=Ei.get("composer_text","MESSAGE_CHATGPT"),Hi=Ri?Pi:Ii,[Es,Di]=(()=>{switch(p){case"workspaceDisallowsGizmo":return[Ge.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[Ge.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[Ge.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Ge.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Ge.loading,!0];case"noTestGizmoId":return[Ge.noTestGizmoId,!0];default:{if(x)return[Ge.placeholderWithName,!1];if(Fe?.placeholderTextOverride!=null)return[Fe.placeholderTextOverride,!1];switch(Hi){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Ge.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Ge.placeholderAskNameAnythingVariant,!1];default:return[Ge.placeholderWithName,!1]}}}})(),Bi=At?r?z.formatMessage($n.newChatInProject):Es?z.formatMessage(Es,{name:"ChatGPT"}):"​":Es?z.formatMessage(Es,{name:xe!=null?Me==="magic"?Gd:xe.name||"GPT":pt?.gizmo.display.name??"ChatGPT"}):"​";i.useEffect(()=>f.subscribe("input",()=>{ko.getState().isThreadHeaderVisible&&sn.hideThreadHeader(),Ze(!0)}),[f]),i.useEffect(()=>{if(v)return f.subscribe("input",()=>{v?.()})},[f,v]),i.useEffect(()=>{if(w)return f.subscribe("change",()=>{w?.()})},[f,w]),i.useEffect(()=>f.subscribe("focus",()=>{Ze(!0)}),[f]),i.useEffect(()=>{Be&&be&&Ye&&!pe.some(({systemHint:y})=>y===be)&&!L&&G(be,!1,{clientThreadId:a})},[a,G,be,Ye,pe,L,Be]);const na=bs||vn||O(),oa={clientThreadId:a,uploadType:gt,modelAcceptedMimeTypes:Vt,modelSupportedImageMimeTypes:ft,attachmentsProductFeature:Tn?.attachments,getInputProps:ji,openFileDialog:Ci,historyDisabled:Ne,onOauthRedirect:ta,highlightTooltip:j&&!rt},An=pe.some(({systemHint:y,requiredModels:J})=>y===K.Think&&J.some(ae=>{const me=rs(E?.models,ae);return me?me.product_features.attachments:!1})),jt=[],aa=!d&&!vt&&(qt||Sn!=null)&&!X&&(!de||An),Nn=Mn(),ra=Nn||!L;!Xt&&ra?jt.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:e.jsx(Na,{...oa,showLabel:ks()==="all",showUpsell:Nn,isDisabled:!aa||es,disabledReason:gt===Fs.None?Ht.ModelNotSupported:de?Ht.ThinkModeInUse:X?Ht.SearchModeInUse:void 0,currentModelName:ue?.title??""})},"file-upload-button")):jt.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-hint-action)"},children:e.jsx(Ea,{composerController:f,clientThreadId:a,disabled:!ra,showLabel:ks()==="all",showUpsell:Nn,isComposerV2Mode:!0,uploadButtons:e.jsx(Na,{...oa,isDisabled:!aa,isNested:!0,disabledReason:gt===Fs.None?Ht.ModelNotSupported:de?Ht.ThinkModeInUse:X?Ht.SearchModeInUse:void 0,currentModelName:ue?.title??""})})},"system-hint-button"));const xt=[];Ee&&Ye&&Be&&xt.push(e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${Ee}-action)`},children:e.jsx(Aa,{logo:e.jsx(mn,{svgString:Ee.logo,className:"h-[18px] w-[18px] text-blue-1000 dark:text-[#48AAFF]"}),label:Ee.name,showRemoveIcon:!0,onClick:()=>{G(Ee.systemHint,!1,{clientThreadId:a})},showLabel:na})},Ia)),Cs&&xt.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-search-action)"},children:e.jsx(Pp,{composerController:f,highlightTooltip:_n,clientThreadId:a,isDisabled:!Zt||rt||es,disabledReason:Qt?rt?tn.HasAttachedFiles:void 0:tn.ModelNotSupported,showLabel:!Yo,currentModelName:ue?.title??""})},Pa)),pe.forEach(y=>{const J=y.systemHint===K.Think,ae=y.systemHint===K.Research;if(J&&!ge||y.systemHint===K.Search&&Cs||ae&&!it)return;const Ke=J&&(Qe||!An&&rt)||ae&&wn;if(y.composerBarButtonInfo){const os=ue?.tags.includes("reasoning")||ue?.id.includes("o1")||ue?.id.includes("o3");xt.push(e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${y.systemHint}-action)`},children:e.jsx(Vh,{composerController:f,systemHint:y,composerBarButtonInfo:y.composerBarButtonInfo,clientThreadId:a,isDisabled:!wt||Ke||es,isPinnedActive:os&&J,showLabel:na,currentModelName:ue?.title??"",disabledReason:J&&!An&&rt?en.HasAttachedFiles:ae&&wn?en.DeepResearchHighLoad:void 0})},`system-hint-${y.systemHint}`))}}),xs&&xt.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-model-selector)"},children:e.jsx(Np,{clientThreadId:a})},"model-selector-button")),bi&&!O()&&!Xt&&xt.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-hint-action)"},children:e.jsx(Ea,{composerController:f,clientThreadId:a,disabled:!wt||es})},"system-hint-button"));const Fi=Wd(!1),En=E?.defaultModelSlug;if(!Be||n===En)jt.push(...xt);else if(Be&&ue&&En&&E?.categories){const y=E.categories.find(J=>J.defaultModel===ue.id);if(y){jt.push(e.jsx(Aa,{showLabel:!0,logo:null,label:y.shortLabel,onClick:()=>Fi({location:"PromptTextArea",modelId:En}),showRemoveIcon:!0}));const J=xt.find(me=>me.key===Pa);Qt&&J?jt.push(J):$.has(K.Search)&&G(K.Search,!1,{clientThreadId:a}),$.has(K.Think)&&G(K.Think,!1,{clientThreadId:a});const ae=xt.find(me=>me.key===Ia);jt.push(ae)}}const Li=rt&&e.jsxs(e.Fragment,{children:[Me==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(I,{...Ge.gizmoKnowledgeWarning})}),e.jsx(Zp,{files:De,className:"-ml-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),Oi=Di?"disabled":"default",Ui=l&&m,zi=wl(),Gi=!tt||He||zi,Wi=oh(Yt,Kt,Rt,Et),Rs=Ui?"streaming":Gi?"disabled":"idle",ns=i.useRef(null),It=i.useRef(null),qi=n&&(n.startsWith("o1")||n.startsWith("o3"));i.useEffect(()=>{const y=()=>{ns.current!=null&&Js.addAction("composer_state_disabled",{threadId:Je(a),disabledReason:ns.current})};if(et&&Rs==="disabled"){let J="unknown";d?J=p??"component_disabled_unknown":l?J="completion_in_progress":Ue?J="thread_hard_blocked":He&&(J="starting_new_completion_request"),ns.current!==J&&(It.current&&clearTimeout(It.current),It.current=setTimeout(y,Xp)),ns.current=J}else ns.current=null;return()=>{It.current&&(clearTimeout(It.current),It.current=null)}},[a,et,Rs,d,p,l,Ue,He]);const Rn=[];if(Fe?.label&&Rn.push({type:Fe.type,value:Fe.label,onRemoveRegion:Qo}),we!==null){const y=!!we.gizmo.tags?.includes(_o.FirstParty);Rn.push({type:"mention",value:we.gizmo.display.name,icon:e.jsx(qd,{isFirstParty:y,src:we.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{Nt(null),f.focus()}})}i.useEffect(()=>{(!b||b.length===0||!ee)&&(Wt.current=!1)},[b,ee]);const Vi=(y,J,ae)=>{Wt.current=y>=0,J&&f.setText(ae?`${ae.title}${ae.body}`:"")},ia=ee&&b&&b.length>0&&!ss&&!f.hasMultipleLines()&&f.canShowAutocompletion();i.useEffect(()=>{ss?M?.():S?.()},[ss,M,S]);const la=Rs==="streaming"?Ni:_s,$i=Zs(yt,Ks.Canvas),{value:Yi}=je("61299031"),Ki=go(),Ji=Vd(),Qi=$i&&Yi&&!Ji&&!Ss&&!Ki;return i.useEffect(()=>{},[fs,f]),e.jsxs($d.Provider,{value:$t,children:[e.jsx(Yd,{onOauthRedirect:ta,children:e.jsx("form",{className:c,onSubmit:la,children:e.jsxs("div",{className:"relative z-[1] flex h-full max-w-full flex-1 flex-col",children:[!T&&!gs&&e.jsx(ii,{className:A}),e.jsxs("div",{ref:g,className:"group relative z-[1] flex w-full items-center",style:{"--force-hide-label":Yo?"none":"block"},children:[r&&Ae.has("from_template_row")&&e.jsx("button",{type:"button",onClick:()=>{ne("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(Kd,{className:"icon-lg"})}),e.jsxs(Jd,{open:ss||wt||xs,children:[e.jsx(Qd,{className:"w-full",children:e.jsx(zp,{type:Ne?"temporary":"default",ref:F,replyRegions:Rn,placeholder:Bi,inputState:Oi,setIsComposerOverflowing:vi,composerController:f,leftSideActions:jt,topRightAction:Qi&&e.jsx(Xd,{composerRef:k,composerController:f,clientThreadId:a}),state:Rs,onSubmit:la,renderFiles:Li,currentLeafId:re,clientThreadId:a,gizmoId:pt?.gizmo.id,disableReason:Wi,modelId:ws,controlsDisabled:es,setControlsDisabled:yi})}),e.jsx(Zd,{children:e.jsxs(eu,{side:"bottom",align:"start",sideOffset:12,onOpenAutoFocus:y=>{jl("2713687629")&&y.preventDefault()},children:[ss&&e.jsx(tu,{onClick:y=>_i(y),onClose:()=>{Ns(!1),f.focus()}}),wt&&e.jsx(Bp,{composerController:f,clientThreadId:a})]})})]}),ia&&e.jsx("div",{className:"absolute left-0 z-[-1] box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",children:e.jsx(Lp,{suggestions:b,composerController:f,onSelect:C,onChange:Vi})})]}),e.jsx(su,{composerController:f,parsedDocumentHandler:Ai})]})})}),e.jsx(wp,{canUseInlineTagging:As,isDisabled:d,clientThreadId:a,currentLeafId:re,currentRequestId:ie,canContinue:u,composerController:f,setPromptInputMetadata:ze,suggestions:h,isNewThread:r,onCreateNewCompletion:s,onContinueGenerating:o,onResetState:Jo,conversationMode:te,isShowingAutocomplete:!!ia}),te!=null&&!qi&&nu.includes(te.kind)&&e.jsx(ou,{clientThreadId:a,onTargetedReply:ki})]})}function tg(t,s){const o=s==null&&t.message?.author.role===st.User&&t.message.status==="in_progress",n=t.metadata?.err!=null&&t.metadata?.errCode!==xa.ContentPolicy,a=t.metadata?.errCode===xa.ModelIncompatibility;return t.metadata?.canRetry===!1||a?!1:o||n}function sg(t){return e.jsx(Xr,{clientThreadId:t.clientThreadId,children:e.jsx(ng,{...t})})}function ng({clientThreadId:t,isNewThread:s,currentModelId:o,showPromptStarters:n,noWrap:a,onRequestCompletion:r,composerContainerRef:l}){const d=fn(),p=i.useContext(ln),m=xo(p),u=co(),h=So(),x=oe(t,b=>tg(Q.getCurrentNode(b),null));if(Br(d),!h&&x)return e.jsx(og,{clientThreadId:t});const g=e.jsx(e.Fragment,{children:e.jsx(hi,{composerContainerRef:l,clientThreadId:t,currentModelId:o,isNewThread:s,showPromptStarters:n,onRequestCompletion:r})});return a?g:e.jsxs(e.Fragment,{children:[e.jsx(Wh,{clientThreadId:t}),e.jsx(Ho,{clientThreadId:t,isStaticSharedThread:u,verticalPadding:m?"last-standard":"none",horizontalPadding:"standard",children:e.jsx(nn,{children:g})})]})}function og({clientThreadId:t}){const s=vu(t),o=oe(t,r=>Q.getCurrentNode(r).metadata?.errCode===bu),n=yu(r=>r.isoDate),a=mo(t);return o&&n!=null&&n!==""?null:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 text-center text-xs","data-has-thread-error":!0,children:e.jsx(I,{...Ha.errorGeneratingResponse})}),e.jsx("div",{className:"flex items-center md:mb-4",children:e.jsx(Gt,{as:"button",color:"primary",onClick:()=>{ke.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,as({clientThreadId:t})),s({id:a,conversationMode:qe(t)?.mode})},className:"m-auto",icon:Sr,"data-testid":"regenerate-thread-error-button",children:e.jsx(I,{...Ha.regenerateResponse})})})]})}function hi({clientThreadId:t,currentModelId:s,isNewThread:o,onRequestCompletion:n,showPromptStarters:a,composerContainerRef:r,autocompletions:l,requiresFileUpload:c,onComposerInput:d,onComposerChange:p,onAutocompleteSelect:m,headerClassName:u,hideHeader:h,onTaggingDropdownClose:x,onTaggingDropdownOpen:g}){const{data:b}=mt(),[j,v,w,C,A,T,B,M,S]=oe(t,$=>{const X=Q.getCurrentLeafId($);return[X,Q.getRequestId($),$?.isLoading,$?.async_status===lr.STREAMING,Q.isMessageTurnEnded($),$?.tree.getHasErrorFromNode(X)??!1,$?.tree.isMessageIncomplete(X)??!1,$?.mode,$?.continuingFromSharedConversationId!=null]}),k=cs(),F=Kn(),{isUnauthenticated:N}=at(),E=Tt(v),f=Tl({clientThreadId:t}),R=!N,_=kl(),{isOpen:H,onClose:L}=gu({type:"just-hit-rate-limit"}),{value:z}=je("1988730211"),Y=Do(),P=i.useCallback(()=>{q.logEvent(U.continueCompletion);const $=Array.from(Y),{systemHints:X,extraStreamParams:de}=z?fu($):{systemHints:$,extraStreamParams:{}};n({completionType:_l.Continue,extraStreamParams:de,completionMetadata:{conversationMode:qe(t)?.mode,systemHints:X}})},[Y,z,n,t]),re=mr(),ie=i.useCallback(async($,X)=>Xm({clientThreadId:t,currentRequestId:X,isHistoryAndTrainingDisabled:_,queryClient:re}),[t,_,re]),ne=i.useCallback(async({content:$,eventSource:X,extraStreamParams:de,completionMetadata:pe,messageMetadata:Xe,prependMessages:be,appendMessages:Ye,profiler:Ee,requestedModelId:He})=>{let ye;Vs(t,ee=>{ir.appendMessage(ee,sr($,Xe,ye))}),$r(t),await n({eventSource:X,completionMetadata:pe,extraStreamParams:de,prependMessages:be,appendMessages:Ye,profiler:Ee,...He?{requestedModelId:He}:{}})},[t,n,null,k?.normalizedAccountUserId]),xe=!A&&(E||C),Me=i.useMemo(()=>xe?!1:!T&&B,[T,B,xe]),fe=xe,Se=ot(t),Oe=_t(Se).data,{promptStarters:Ne,isSuccess:ve}=Dr(o&&!w,t,4),he=Mr(),Te=(()=>{if(he?.messageId===Q.getTree(qe(t)).getLastValidNode(j)?.message?.id)return he?.suggestions;if(a&&!w&&ve&&!R)return Ne})(),Qe=Al(),Ue=Oe?.gizmo.tags?.includes(_o.WorkspaceDisabled)&&!Qe?"workspaceDisallowsGizmo":b?.models.size===0?"noModelsAvailable":F.displayingSideBySideFeedback&&F.unskippable?"feedbackRequired":M?.kind===Le.GizmoTest&&M.gizmo_id==null?"noTestGizmoId":null,le=je("15117983")?.value,ze=Kl(),G=fo(),W=ze.action==="moderate",{value:ce}=Pe("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center empty:hidden",children:G&&W&&ce?e.jsx(xu,{}):null}),H?e.jsx(Su,{onClose:L}):null,le&&M&&M.kind===Le.PrimaryAssistant&&M.plugin_ids&&M.plugin_ids.length>0?e.jsx(ag,{}):e.jsx(eg,{composerContainerRef:r,clientThreadId:t,onCreateNewCompletion:ne,onAbortCompletion:ie,onContinueGenerating:P,currentModelId:s,isNewThread:o,isCompletionInProgress:f,className:"w-full",canContinue:Me,suggestions:Te??[],disabled:!!Ue,disabledReason:Ue??void 0,canPause:fe,isInteractableSharedThread:S,autocompletions:l,requiresFileUpload:c,onComposerInput:d,onComposerChange:p,onAutocompleteSelect:m,headerClassName:u,hideHeader:h,onTaggingDropdownClose:x,onTaggingDropdownOpen:g},t)]})}function ag(){return e.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[e.jsx("span",{className:"text-token-text-primary",children:e.jsx(I,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(I,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),e.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[e.jsx(I,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),e.jsx("span",{className:"ml-2",children:e.jsx(I,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Ha=ht({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),pi=i.memo(function(){return e.jsxs("div",{className:`mb-2 flex flex-col gap-2 empty:hidden ${Cr.PromptTextareaHeader}`,children:[e.jsx(li,{}),e.jsx(ci,{})]})}),uf=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:pi},Symbol.toStringTag,{value:"Module"}));function rg(t){const{value:s}=je("2223246572"),o=pn(t),n=i.useMemo(()=>o.filter(a=>a.suggestedPrompt).sort((a,r)=>(a.suggestedPrompt?.sortOrder??0)-(r.suggestedPrompt?.sortOrder??0)).map(a=>({id:a.systemHint,label:a.suggestedPrompt?.title??"",description:a.suggestedPrompt?.subtitle??"",icon:e.jsx(mn,{svgString:a.logo,className:"h-[22px] w-[22px]",color:a.suggestedPrompt?.theme??""}),systemHint:a})),[o]);return{replaceStarterPromptsWithToolChips:s,toolChips:n}}const Da=Ve(()=>$e(()=>import("./c5woaev38snpnqhe.js"),__vite__mapDeps([49,2,4,1,3,5,36,9,10,45,50,51,18,19,16,20,21,22,23,24,25])).then(t=>t.SnorlaxSplashScreen)),On=4;function ig(){const{layer:t}=Qs("4031588851"),s=t.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),o=Po();return!!o&&o.created*1e3>=new Date(s).getTime()}const Un=t=>`${t.title}${t.body}`.toLocaleLowerCase();function lg(t){const s=ot(t.clientThreadId),o=ps(s);return e.jsx(Xr,{clientThreadId:t.clientThreadId,children:o&&s&&Da?e.jsx(Da,{clientThreadId:t.clientThreadId,gizmoId:s,currentModelId:t.currentModelId,onRequestCompletion:t.onRequestCompletion}):e.jsx(mg,{...t})})}function cg({children:t}){const{store:s}=Ie(),[o,n]=i.useState(!1),a=fn();i.useEffect(()=>a.subscribe("focus",()=>{n(!0)}),[a]),i.useEffect(()=>a.subscribe("blur",()=>{n(!1)}),[a]);const l=!!s.useSharedProps()?.isShowingAutocomplete;return t(l&&o)}function dg({isSendBlocked:t,clientThreadId:s,headlineOption:o,shouldShowStarterPrompts:n,promptChips:a,onSelectStarterPrompt:r,starterPromptExpanded:l,setStarterPromptExpanded:c,replaceStarterPromptsWithToolChips:d,toolChips:p,onSelectToolChip:m,selectedHint:u}){const h=cr();return e.jsx(cg,{children:x=>e.jsxs(se.div,{initial:{opacity:0},animate:{opacity:x?0:1},exit:{opacity:0},transition:{duration:.1},className:D("justify-center",x?"pointer-events-none":"","mt-[var(--screen-optical-compact-offset-amount)] h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary [display:var(--display-hidden-until-loaded,flex)]",h?"@lg/thread:hidden":"lg:hidden"),children:[o==="CHATGPT_LOGO"?e.jsx(rn,{className:"inline-block h-12 w-12"}):e.jsx(gi,{headlineOption:o}),e.jsxs(se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:D(!l&&!d&&"h-[116px]"),children:[n&&e.jsx(fi,{starterPrompts:a,onSelectStarterPrompt:r,disabled:t,clientThreadId:s,onExpand:()=>c(!0),mobileLayout:!0}),d&&e.jsx(xi,{toolChips:p,onSelectToolChip:m,disabled:t,mobileLayout:!0,selectedHint:u})]})]})})}function ug(t){const s=Pe("1468311859").value,o=Pe("3664702598").value,{layer:n}=Ot("4031588851"),a=ig(),r=s,l=o&&a;let c="HARDCODED";if(t){const d=n.get("search_autocomplete_mode","");r&&d&&(c=d)}else l&&(c=n.get("autocomplete_mode","HARDCODED"));return c}function mg({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,chatgptHomepageDisclaimer:a}){const r=fn(),l=Bt(t),c=po(),[d,p]=i.useState([]),m=i.useCallback(G=>{p(W=>{const ce=typeof G=="function"?G(W):G;return ar(ce,W)?W:ce})},[]),{trendingSuggestions:u,fetchTrendingSuggestions:h}=fg(On),x=i.useRef(!1),{isUnauthenticated:g}=at(),b=Nl(),[j,v]=i.useState(!1),w=Qr(),C=nt();Br(r);const A=Pe("589604007").value,{layer:T}=Qs("4031588851"),{layer:B}=Qs("3533083032"),{replaceStarterPromptsWithToolChips:M,toolChips:S}=rg(t),k=mi(r,t),F=ui(r),{prospectiveModelId:N,isLastUsedModelLoading:E}=wu(t),f=o?s:N??"auto",R=!E,{promptStarters:_,isSuccess:H}=Dr(l&&R,t,8,A,!0,f),L=b&&!!d.find(G=>!!G.requires_file_upload),z=i.useCallback(G=>{const W=r.getCurrentText();return W&&Un(G).startsWith(W.toLocaleLowerCase())},[r]),Y=i.useCallback(G=>{const W=r.getCurrentText(),ce=G.title+G.body;return z(G)?{...G,title:W,body:ce.slice(W.length)}:{...G,title:ce,body:""}},[r,z]),P=i.useCallback((G=!1)=>{m(W=>!W.some(z)&&W.length>0?[]:G?W:W.map(Y))},[z,Y,m]),re=(G,W,ce)=>{const $=G.title;m([]),r.focus(),r.setText($),requestAnimationFrame(()=>{const X=(_?.filter(de=>de.theme===G.theme)??[]).map(de=>{const pe=Dt(de.oneliner),Xe=pe.startsWith(de.title);return{...de,title:Xe?`${de.title} `:"",body:Xe?de.body:pe,autocompletionChunks:Op($,pe),type:zt.Autocomplete}});m(X),X.length>0&&Lt(X,t),Tu(G,ce,t)})};i.useEffect(()=>{const G=d.some(W=>W.theme===Jn.Search);w&&r.getCurrentText()===""?u.length>0?m(u):h():G&&!w&&m(W=>W.filter(ce=>ce.theme!==Jn.Search))},[d,w,u,h,r,m]),i.useEffect(()=>{w&&r.getCurrentText()===""&&u.length>0&&Lt(u,t)},[w,r,u,t]);const ie=_?.reduce((G,W)=>(W.theme&&!G[W.theme]&&(G[W.theme]=W),G),{}),Ae=[];if(ie)for(const G in ie)G!=="For you"&&Ae.push(ie[G]);const ne=Ae&&Ae.length>0,xe=!!(H&&ne&&o&&!M);We.markStart("StarterPromptChips",We.NS_COMPOSER),xe&&We.markRendered("StarterPromptChips",We.NS_COMPOSER);const Me=On-d.filter(z).length,fe=ug(w),Se=g?B.get("headline_option","HELP_WITH"):T.get("headline_option","HELP_WITH"),Oe=T.get("autocomplete_min_char",4),Ne=T.get("autocomplete_fetch_interval",200),ve=i.useRef(null),he=i.useCallback(Fr(async G=>{const W=r.getCurrentText();if(!W||W.length<Oe||W.length>80||r.hasMultipleLines()){m([]);return}if(!x.current&&!(ve.current&&ve.current.length>Oe&&W.startsWith(ve.current)))try{const ce=await ms.generateAutocompletions(W,G,w);if(ce.completions.length===0){ve.current=W;return}const $=ce.completions.map(X=>({id:Jl(),type:zt.Autocomplete,title:X.slice(0,W.length),body:X.slice(W.length),oneliner:X,prompt:X,source:fe})).filter(z).map(Y);m(X=>{const de=X.filter(z),pe=$.filter(Xe=>{const be=Un(Xe);return!de.some(Ye=>{const Ee=Un(Ye);if(be===Ee)return!0;const He=/[\p{P}\p{S}]$/u,ye=be.replace(He,""),ee=Ee.replace(He,"");return ye===Ee||be===ee||ye===ee})}).slice(0,On-de.length);return[...de,...pe]}),$.length>0&&Lt($,t)}catch{}},fe==="BING"?150:Ne),[r,fe,Y,Ne]),Te=i.useCallback(()=>{P(),Me>0&&he(Me)},[he,P,Me]);i.useEffect(()=>{x.current&&m([])},[x,m]);const Qe=i.useMemo(()=>fe==="HARDCODED"?P:Te,[fe,Te,P]),Ue=i.useCallback(()=>{r instanceof Bo&&P(!0),r.getCurrentText().indexOf(`
`)>0&&m([])},[r,m,P]),le=i.useCallback((G,W,ce)=>{W.forEach($=>{$.id===G.id&&($.userInput=r.getCurrentText())}),m([W[ce]])},[r,m]),ze=cr();return e.jsx(e.Fragment,{children:e.jsx(hs,{children:e.jsx("div",{className:D("h-full w-full",ze?"@lg/thread:py-[18px]":"lg:py-[18px]"),children:e.jsx(Ho,{isStaticSharedThread:!1,verticalPadding:"none",horizontalPadding:"standard",clientThreadId:t,fullHeight:!0,children:e.jsxs(ja,{className:"relative",children:[e.jsx("div",{className:D("mb-7 hidden text-center",ze?"@lg/thread:block":"lg:block"),children:Se==="CHATGPT_LOGO"?e.jsx(rn,{className:"inline-block h-12 w-12"}):e.jsx(gi,{headlineOption:Se})}),e.jsx(dg,{headlineOption:Se,shouldShowStarterPrompts:xe,promptChips:Ae,onSelectStarterPrompt:re,starterPromptExpanded:j,setStarterPromptExpanded:v,isSendBlocked:c,clientThreadId:t,replaceStarterPromptsWithToolChips:M,toolChips:S,onSelectToolChip:k,selectedHint:F}),e.jsx("div",{className:D(ze?"@lg/thread:absolute @lg/thread:bottom-8 @lg/thread:left-0 @lg/thread:w-full":"[display:var(--display-hidden-until-loaded,block)] lg:absolute lg:bottom-8 lg:left-0 lg:w-full"),children:e.jsx(ja,{className:"relative @lg/thread:pb-0",children:C?e.jsx(pi,{}):e.jsx(ii,{className:"block"})})}),e.jsx("div",{className:"w-full",children:e.jsx(hi,{clientThreadId:t,isNewThread:l,currentModelId:s,onRequestCompletion:n,showPromptStarters:!1,autocompletions:d,requiresFileUpload:L,onComposerInput:Qe,onComposerChange:Ue,onAutocompleteSelect:le,onTaggingDropdownClose:()=>{x.current=!1},onTaggingDropdownOpen:()=>{x.current=!0},hideHeader:!0})}),e.jsxs(se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:D("hidden",ze?"@lg/thread:block":"lg:block",a&&g&&j?"":!M&&"h-[70px]"),children:[xe&&e.jsx(fi,{starterPrompts:Ae,onSelectStarterPrompt:re,disabled:c,clientThreadId:t,onExpand:()=>v(!0)}),M&&e.jsx(xi,{toolChips:S,onSelectToolChip:k,disabled:c,selectedHint:F})]}),a&&e.jsx("div",{className:D("w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",ze?"@lg/thread:absolute @lg/thread:bottom-0 @lg/thread:left-0":"lg:absolute lg:bottom-0 lg:left-0"),children:e.jsx("div",{className:D("min-h-4"),children:a})})]})})})})})}function gi({headlineOption:t}){const o=Ce().formatMessage(xg[t]||is.whatCanIHelpWith);return e.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:e.jsx("h1",{style:{viewTransitionName:"var(--vt-splash-screen-headline)"},children:o})})}function hg({starterPrompt:t,starterPrompts:s,index:o,disabled:n,onSelectStarterPrompt:a}){const r=t.theme??t.title,l=gn(),{mutate:c}=ku(),d=t.category==="onboarding"?()=>{c({key:dt.hasUsedConversationalOnboardingStarterPrompt}),l(t,s,o)}:()=>a(t,s,o);return e.jsx(Lr,{disabled:n,onClick:d,icon:e.jsx(_u,{category:t.category,useV2Colors:!0}),label:r})}function Ba({clientThreadId:t,onClick:s}){i.useEffect(()=>{Au(t)},[t]);const o=Ce();return e.jsx(se.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(Lr,{onClick:()=>{Nu(t),s()},label:o.formatMessage(is.moreStarterPrompts)})})}const pg=5,gg=3;function fi({starterPrompts:t,onSelectStarterPrompt:s,disabled:o,clientThreadId:n,onExpand:a,mobileLayout:r=!1}){const l=r?gg:pg,[c,d]=i.useState(l),[p,m]=i.useState(!1),u=i.useRef(null),h=t.length<=c;i.useEffect(()=>{Lt(t.slice(0,l),n)},[n]),i.useEffect(()=>{if(!p&&!h&&u.current){const g=u.current,b=g.getBoundingClientRect(),j=b.width,v=Array.from(g.children);let w=0;for(let C=0;C<v.length&&v[C].getBoundingClientRect().right-b.left<=j;C++)w++;d(w),m(!0)}},[t,h,p]);const x=()=>{const g=t.slice(c,t.length).map(b=>({...b,isAdditional:!0}));g.length>0&&Lt(g,n),d(t.length),a()};return e.jsxs("div",{className:D("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",p&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:D("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",h||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:u,children:[t.slice(0,c).map((g,b)=>e.jsx(se.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(hg,{starterPrompt:g,starterPrompts:t,index:b,disabled:o,onSelectStarterPrompt:s})},g.id??b)),r&&t.length>c&&e.jsx(Ba,{clientThreadId:n,onClick:x})]}),!r&&t.length>c&&e.jsx(Ba,{clientThreadId:n,onClick:x})]})}function xi({toolChips:t,onSelectToolChip:s,disabled:o,mobileLayout:n=!1,selectedHint:a}){return e.jsx("div",{className:D("mt-5 gap-x-2 transition-opacity xl:gap-x-2.5",t.length>0?"opacity-100":"opacity-[0.01]",{"flex flex-wrap justify-center":!n}),children:e.jsx("ul",{className:D("relative overflow-hidden py-2 sm:gap-y-2",{"grid grid-cols-2 justify-items-center gap-4":n},{"flex flex-wrap justify-start gap-x-[60px] gap-y-4":!n}),children:t.map(({id:r,label:l,description:c,icon:d,systemHint:p},m)=>e.jsx(se.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(ju,{label:l,description:c,icon:d,onClick:()=>{p&&s({hint:p,enable:p.systemHint!==a})},disabled:o})},r??m))})})}const fg=t=>{const[s,o]=i.useState([]),n=i.useCallback(async()=>{const r=(await ms.generateTrendingSuggestions(t)).suggestions.map((l,c)=>({type:zt.Trending,title:Fa(l),body:"",icon:e.jsx(Cu,{}),prompt:Fa(l),id:`search-trending-${c}`,theme:Jn.Search}));o(r)},[t]);return{trendingSuggestions:s,fetchTrendingSuggestions:n}};function Fa(t){return t.split(" ").map(Mu).join(" ")}const is=ht({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),xg={HELP_WITH:is.whatCanIHelpWith,WHERE_TO_START:is.whereShouldWeStart,ASK_CHATGPT:is.askChatgptAnything};function Sg({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,showChatgptHomepage:a,chatgptHomepageDisclaimer:r}){const l=kt();let c=e.jsx(lh,{}),d;return l?(d=e.jsx(vg,{}),c=e.jsx(rn,{className:"mb-6 h-12 w-12 brand:hidden"})):t!=null?(d=a?e.jsx(lg,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,chatgptHomepageDisclaimer:r}):e.jsx(ch,{clientThreadId:t}),c=null):d=e.jsx(bg,{}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[c,d]})}function vg({gizmo:t}){const s=Ru(),o=t?Pu(t.tools):!1,n=cs();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:[e.jsx(Iu,{id:"temporary-chat-checkbox",name:"temporary-chat-checkbox",checked:!0}),e.jsx(I,{...Mt.temporaryChat})]}),e.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[e.jsx(I,{...n?.isWorkspaceAccount()?s?Mt.temporaryChatBizMemoryAvailable:Mt.temporaryChatBizMemoryUnavailable:s?Mt.temporaryChatDescriptionMemoryAvailable:Mt.temporaryChatDescriptionMemoryUnavailable}),o&&e.jsx("div",{className:"mt-3",children:e.jsx(I,{...Mt.temporaryChatDescriptionGptActions,values:{link:a=>e.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:a})}})})]})]})}function bg(){return e.jsx("div",{className:"mb-5 text-2xl font-semibold",children:e.jsx(I,{...Mt.howCanIHelpYouToday})})}function yg({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,showChatgptHomepage:a,chatgptHomepageDisclaimer:r}){const l=ot(t),c=dr(),d=po(),{data:p}=_t(l),m=Eu(),u=nr(()=>navigator.windowControlsOverlay);return(c!=null||l!=null)&&p==null?null:e.jsxs("div",{className:"relative h-full",children:[e.jsx("div",{className:u?.visible?D("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",m?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:e.jsx(ti,{clientThreadId:t})}),p!=null?e.jsx(ih,{gizmo:p,showStarterPrompts:!0,disableStarterPrompts:d}):e.jsx(Sg,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,showChatgptHomepage:a,chatgptHomepageDisclaimer:r})]})}const Mt=ht({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}});function wg({modelSlug:t,animateModelLabelOnRender:s,isDropdownOpen:o,isRegenerateEnabled:n,isHovered:a,animateShortLabel:r}){const{data:l}=mt(),[c,d]=i.useState("initial");i.useEffect(()=>{if(s){const h=setTimeout(()=>d("show"),500),x=setTimeout(()=>d("initial"),2e3);return()=>{clearTimeout(h),clearTimeout(x)}}d("initial")},[s]);const{shorterLabel:p}=l?.categories.find(({defaultModel:h})=>h===t)??{},m={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},u=o?"visible":a?"show":c;return e.jsxs(se.div,{initial:"initial",animate:u,className:"flex items-center pb-0",children:[e.jsx(Or,{className:"icon-md"}),(n||r)&&e.jsx(se.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:m,transition:{type:"tween",duration:.18},children:p}),n&&e.jsx(Co,{className:"icon-sm"})]})}function no(t,s){const{modelSwitcherDeny:o,subscriptionLevel:n}=t;return!!o&&o.reason===El.RATE_LIMIT&&n===Rl.PLUS&&!s}const Ws="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function jg({className:t,clientThreadId:s,message:o,onModelSelect:n,onDropdownChange:a,canRegenerateResponse:r}){const[l,c]=i.useState(null),[d,p]=i.useState(!1),[m,u]=i.useState(!1),h=ot(s),x=Hu({clientThreadId:s,message:o}),g=o.message.metadata?.model_slug,b=o.message.id,{modelOptions:j,modelSlug:v,animateModelLabelOnRender:w,messageModelEnabledTools:C}=x,A=Du(o.message),T=C.includes(K.Search),B=i.useMemo(()=>j.find(f=>f.value===g),[j,g]),M=i.useRef(null),{data:S=null}=an(),k=S&&oo(S),F=f=>{f||setTimeout(()=>{M.current&&M.current.blur()},10)};if(i.useEffect(()=>{F(d)},[d]),oe(s,Lu))return null;const E=r&&j.some(f=>no(f,k));return h?null:e.jsxs(Z.Root,{onOpenChange:f=>{r&&(p(f),a(f),F(f)),f&&q.logEvent(U.conversationOpenMessageModelSelector,{has_get_plus_button:E,is_new_regen_dropdown:!0})},children:[r?e.jsx(Mg,{label:e.jsx(I,{id:"wDs5sz",defaultMessage:"Switch model"}),children:e.jsx(ho,{ref:M,className:D("cursor-pointer",t),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:e.jsx(wg,{modelSlug:v,animateModelLabelOnRender:w,isDropdownOpen:d,isRegenerateEnabled:r,isHovered:m})})}):null,r&&e.jsx(Z.Portal,{children:e.jsxs(Z.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[e.jsx(Z.Item,{disabled:!0,className:"pb-0 pt-2",children:e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(I,{id:"bFLh5u",defaultMessage:"Switch model"})})}),e.jsx(Cg,{clientThreadId:s,messageId:b,onModelSelect:n,messageModelSlug:g,modelOptions:j,setHoveredOption:c,hoveredOption:l,retryOption:B,lastResponseUsedSearch:A,modelSupportsSearch:T,doesUserHaveAnyAccountsWithPlusFeatures:k})]})})]})}function Cg({clientThreadId:t,messageId:s,modelOptions:o,messageModelSlug:n,onModelSelect:a,setHoveredOption:r,hoveredOption:l,retryOption:c,lastResponseUsedSearch:d,modelSupportsSearch:p,doesUserHaveAnyAccountsWithPlusFeatures:m}){const u=Ce(),[h,x]=i.useMemo(()=>Bu(o,v=>v.subcategory),[o]),g=i.useMemo(()=>{const v=new Map;return h.forEach(w=>{const C=w.subcategory;C&&(v.has(C)||v.set(C,[]),v.get(C)?.push(w))}),v},[h]),b=D("icon-sm","order-10 ml-auto text-token-text-tertiary icon-md"),j=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:u.formatMessage(zn.search),icon:e.jsx(kr,{className:b}),condition:p&&!d,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:u.formatMessage(zn.nosearch),icon:e.jsx(Fu,{className:b}),condition:p&&d,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return e.jsxs(e.Fragment,{children:[x.map(v=>{const{value:w,...C}=v;return e.jsx(Ls,{value:w,onSelect:()=>{ke.logEvent("chatgpt_regenerate_switch_model_button_clicked",w,{requestedModelId:w,...as({clientThreadId:t,messageId:s})}),a({requestedModelId:w})},includeRegenerate:!1,onMouseEnter:()=>r(w),onMouseLeave:()=>r(null),isHovered:l===w,messageModelSlug:n,includeCheck:!1,shouldShowUpsell:no(v,m),className:Ws,...C,icon:e.jsx("span",{className:b})},w)}),[...g.entries()].map(([v,w])=>e.jsxs(Z.Sub,{children:[e.jsx(Z.SubMenuTrigger,{children:e.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:v})}),e.jsx(Z.Portal,{children:e.jsx(Z.SubContent,{className:"min-w-fit",children:w.map(C=>{const{value:A,...T}=C;return e.jsx(Ls,{value:A,onSelect:()=>{ke.logEvent("chatgpt_regenerate_switch_model_button_clicked",A,{requestedModelId:A,...as({clientThreadId:t,messageId:s})}),a({requestedModelId:A})},includeRegenerate:!1,onMouseEnter:()=>r(A),onMouseLeave:()=>r(null),isHovered:l===A,messageModelSlug:n,includeCheck:!1,className:Ws,...T,icon:null,shouldShowUpsell:no(C,m)},v+"-"+A)})})})]},v)),!!c&&e.jsxs(e.Fragment,{children:[e.jsx(Z.Separator,{}),e.jsx(Ls,{onSelect:()=>{ke.logEvent("chatgpt_regenerate_try_again_button_clicked",c.value,{requestedModelId:c.value,...as({clientThreadId:t,messageId:s})}),a({requestedModelId:c.value})},includeRegenerate:!0,onMouseEnter:()=>r(c.value),onMouseLeave:()=>r(null),messageModelSlug:n,includeCheck:!1,className:Ws,...c,label:u.formatMessage(zn.tryAgain),subtitle:c.label,icon:e.jsx(Or,{className:b})},c.value),j.filter(v=>v.condition).map(v=>e.jsx(Ls,{onSelect:()=>{ke.logEvent(v.eventName,c.value,{requestedModelId:c.value,...as({clientThreadId:t,messageId:s})}),a({requestedModelId:c.value,extraStreamParams:v.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>r(v.key),onMouseLeave:()=>r(null),isHovered:l===v.key,messageModelSlug:n,includeCheck:!1,className:Ws,...c,label:v.label,subtitle:"",icon:v.icon},v.key))]})]})}function Mg({children:t,label:s}){return e.jsx(ds,{label:s,sideOffset:0,children:t})}const zn=ht({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Tg=i.memo(jg);function kg({followups:t}){const s=gn();return e.jsxs("div",{children:[e.jsx("div",{className:"mb-1 font-semibold",children:e.jsx(I,{id:"3UFIQc",defaultMessage:"Follow up"})}),e.jsx("div",{children:t.slice(0,4).map((o,n)=>e.jsx(se.div,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:n*.03},exit:{opacity:0,translateY:4},children:e.jsx(_g,{followUp:o,onSelectingSuggestedReply:s})},n))})]})}function _g({followUp:t,onSelectingSuggestedReply:s}){return e.jsxs("button",{className:"-ml-3 flex w-full items-start gap-1 rounded-lg py-2.5 hover:bg-token-main-surface-secondary",onClick:()=>s(t,[],0),children:[e.jsx("div",{className:"pl-2 opacity-30",children:e.jsx(Ro,{className:"h-6 w-6"})}),e.jsx("div",{className:"gap-0.5 pr-2 text-left",children:Ou(t)})]})}const La=Ve(()=>$e(()=>import("./d5k5wa3zyqlgc9bk.js").then(t=>t.sw),__vite__mapDeps([4,1,2,3,5])).then(t=>t.MemoryActionResult));function Oa(t,s,o){ur.updateTree(t,n=>{n.updateNodeMetadata(s,{inlineComparisonRating:o})})}const Ua=({messages:t})=>{for(const{message:{metadata:s}}of t){const{augmented_paragen_prompt_label:o}=s??{};if(o)return o}};function Ag(t){const s=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),o=i.useRef({left:null,right:null});return t.stubSideBySideFeedback?e.jsx(Si,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o,...t}):e.jsx(Ng,{...t,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o})}function Ng(t){const{clientThreadId:s,variantIds:o,variantsInStreamInfo:n,turnIndex:a,firstVisibleTokenTimestampsRef:r}=t;if(o.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const l=$o(),c=So(),d=Pl(),[p,m]=i.useMemo(()=>Ur(o.join(""))()<.5?[0,1]:[1,0],[o[0],o[1]]),u=p<m?"left":"right",h=u==="left"?"right":"left",x=o[p],g=o[m],[b,j]=oe(s,k=>[Dt(k).tree.getLeafFromNode(x).id,Dt(k).tree.getLeafFromNode(g).id]),v=Dt(qn(s,a,b)),w=Dt(qn(s,a,j)),C=u==="left"?v:w,A=u==="left"?w:v,T=n.display_treatment==="unskippable",B=l?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";i.useEffect(()=>(Kn.setState({displayingSideBySideFeedback:!0,unskippable:T}),()=>{Kn.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[T]),Uu();const M=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});i.useEffect(()=>Il(Hl,{requestCompletion:()=>{const k=Je(s),N=Q.getTree(qe(s)).getParentPromptNode(b),E=[v,w].map((_,H)=>({messageId:_.messages[_.messages.length-1].message.id,loadFirstTokenTime:H===0?r.current.left:r.current.right,loadEndTime:ls(_.messages)?.completionSampleFinishTime})),f={},R=N.metadata?.variantsInStreamInfo==null&&N.message.metadata?.paragen_variants_info!=null;for(const _ of E)f[_.messageId]=R?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:_.loadFirstTokenTime,load_end_time:_.loadEndTime};$a({params:{conversation_id:k,displayed_message_ids:E.map(_=>_.messageId),message_metadatas:f,rating:"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:l?2:1,user_prompt_message_id:N.message.id}})}}),[v,w,b,s,t.conversationTurnMountTime,B,h,C?.messages,A?.messages,d,l,r]);const S=k=>{const F=Q.getTree(qe(s)),N=F.getLeafFromNode(k);ur.setThreadCurrentLeafId(s,N.id);const E=k===x,f=E===(u==="left");C.messages.length>0&&Oa(s,C.messages[C.messages.length-1].nodeId,f?"original":"new"),A.messages.length>0&&Oa(s,A.messages[A.messages.length-1].nodeId,f?"original":"new");const R=Je(s),_=[v,w].map((P,re)=>({messageId:P.messages[P.messages.length-1].message.id,loadFirstTokenTime:re===0?r.current.left:r.current.right,loadEndTime:ls(P.messages)?.completionSampleFinishTime})),H=E?_[0].messageId:_[1].messageId,L=F.getParentPromptNode(b),z={},Y=L.metadata?.variantsInStreamInfo==null&&L.message.metadata?.paragen_variants_info!=null;for(const P of _)z[P.messageId]=Y?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:P.loadFirstTokenTime,load_end_time:P.loadEndTime};$a({params:{conversation_id:R,displayed_message_ids:_.map(P=>P.messageId),message_metadatas:z,rating:"selected",selected_message_id:H,source_timestamp:Date.now(),ui_variant:l?2:1,user_prompt_message_id:L.message.id}})};return e.jsx(Si,{...t,setPreferredFeedback:S,leftVariantId:x,rightVariantId:g,leftTurn:v,rightTurn:w,hasActiveRequest:c,originalTurn:C,visibilityStateRef:M})}function Si({setPreferredFeedback:t,leftVariantId:s,rightVariantId:o,leftTurn:n,rightTurn:a,hasActiveRequest:r,originalTurn:l,visibilityStateRef:c,...d}){const{defaultParagenLabel:p,shouldShowParagenLabels:m=!1}=yr(),u=n&&Ua(n)||p,h=a&&Ua(a)||p,x=i.useMemo(()=>n?.messages??[],[n?.messages]),g=i.useMemo(()=>a?.messages??[],[a?.messages]),{avatarClassName:b,firstVisibleTokenTimestampsRef:j}=d,v=i.useMemo(()=>on(x),[x]),w=i.useMemo(()=>on(g),[g]),C=vr(),A=Tt(n?Xs.getRequestIdFromConversationTurn(n):""),T=Tt(a?Xs.getRequestIdFromConversationTurn(a):""),B=n?.role===st.User,M=a?.role===st.User,S=i.useRef(null),k=i.useRef(null),F=i.useRef(null),N=!!d.stubSideBySideFeedback,E=!!d.stubSideBySideFeedback;!N&&j.current.left==null&&(j.current.left=Date.now()),!E&&j.current.right==null&&(j.current.right=Date.now()),i.useEffect(()=>{if(S.current&&k.current&&F.current){const L=Array(11).fill(0).map((Y,P)=>P/10),z=new IntersectionObserver(Y=>Y.forEach(P=>{P.target===k.current?(c.current.left_visibility_initial==null&&(c.current.left_visibility_initial=P.intersectionRatio),c.current.left_visibility_max=Math.max(c.current.left_visibility_max??0,P.intersectionRatio)):P.target===F.current&&(c.current.right_visibility_initial==null&&(c.current.right_visibility_initial=P.intersectionRatio),c.current.right_visibility_max=Math.max(c.current.right_visibility_max??0,P.intersectionRatio))}),{root:S.current,threshold:L});return z.observe(k.current),z.observe(F.current),()=>z.disconnect()}},[c]);const{data:f}=br(void 0,!1,C),R=$o(),_=e.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:e.jsx(I,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),H=nt();return e.jsxs("div",{className:"relative flex flex-col",children:[e.jsxs("div",{className:D("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",H&&"top-[var(--thread-leading-height)] pt-3",!H&&"top-[-1px]",R&&!H?"md:top-header-height":H?"":"md:static"),"data-testid":"paragen-feedback-title",children:[e.jsx(I,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),R?_:null]}),R?null:_,e.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:S,children:e.jsx("div",{className:D(!H&&"min-w-fit"),children:e.jsxs("div",{className:D("mx-auto flex max-w-6xl items-start",R&&!H&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!R&&!H&&"gap-4 sm:gap-6",R&&H&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",H&&!R&&"gap-4 sm:gap-6"),children:[e.jsxs(za,{horizontalScrollContainerRef:S,rootElementRef:k,onClick:()=>{t(s)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:N,children:[e.jsxs(qa,{children:[e.jsx(Qn,{messages:x,isUserTurn:B,avatarClassName:b}),e.jsx(Wa,{children:m?e.jsx("span",{className:"font-bold text-token-text-primary",children:u}):e.jsx(I,{...Ya.responseNumber,values:{responseIndex:1}})})]}),R&&N?e.jsx(Ga,{}):e.jsxs(e.Fragment,{children:[f!=null&&!B&&e.jsx(La,{clientThreadId:d.clientThreadId,messages:x,isParagen:!0}),e.jsx(Zn,{...d,allMessages:x,groupedMessagesToRender:v,allGroupedMessages:v,isEditing:!1,isUserTurn:B,isCompletionRequestInProgress:A,hasActiveRequest:r,handleEnterEdit:Hs,handleExitEdit:Hs,shouldGrowContainer:!1}),e.jsx(Va,{clientThreadId:d.clientThreadId,conversationTurnMountTime:d.conversationTurnMountTime,turn:n,originalTurn:l})]})]}),e.jsxs(za,{horizontalScrollContainerRef:S,rootElementRef:F,onClick:()=>{t(o)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:E,children:[e.jsxs(qa,{children:[e.jsx(Qn,{messages:g,isUserTurn:M,avatarClassName:b}),e.jsx(Wa,{children:m?e.jsx("span",{className:"font-bold text-token-text-primary",children:h}):e.jsx(I,{...Ya.responseNumber,values:{responseIndex:2}})})]}),R&&E?e.jsx(Ga,{}):e.jsxs(e.Fragment,{children:[f!=null&&!M&&e.jsx(La,{clientThreadId:d.clientThreadId,messages:g,isParagen:!0}),e.jsx(Zn,{...d,allMessages:g,groupedMessagesToRender:w,allGroupedMessages:w,isEditing:!1,isUserTurn:M,isCompletionRequestInProgress:T,hasActiveRequest:r,handleEnterEdit:Hs,handleExitEdit:Hs,shouldGrowContainer:!1}),e.jsx(Va,{clientThreadId:d.clientThreadId,conversationTurnMountTime:d.conversationTurnMountTime,turn:a,originalTurn:l})]})]})]})})})]})}function za({horizontalScrollContainerRef:t,rootElementRef:s,onClick:o,children:n,hasActiveRequest:a,isWaitingOnFirstUserVisibleToken:r}){const l=$o(),c=nt(),{scrollX:d}=Ql({layoutEffect:!1,container:t,target:s}),p=zu(),m=Gu(),u=i.useRef(null),h=i.useRef(null),x=i.useRef(null),[g,b]=i.useState(!1),[j,v]=i.useState(!1),[w,C]=i.useState(!1),[A,T]=i.useState(0);i.useEffect(()=>{if(!l)return;const E=new IntersectionObserver(f=>{for(const R of f)R.target===u.current?b(R.isIntersecting):R.target===x.current?C(R.isIntersecting):R.target===h.current&&v(R.isIntersecting)},{root:p?.current,rootMargin:c?`0px 0px -${A}px 0px`:void 0});return u.current&&h.current&&x.current&&(E.observe(u.current),E.observe(h.current),E.observe(x.current)),()=>{E.disconnect()}},[A,l,c,p]);const B=!w&&(j||g),M=Xl(d,E=>B?-1*E:0),S=Sa(0);i.useEffect(()=>{if(!l)return;const E=new ResizeObserver(f=>{Os(f.length===1,"entryList.length === 1");const R=f[0];Os(R.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),S.set(R.contentBoxSize[0].inlineSize)});return s.current&&E.observe(s.current),()=>{E.disconnect()}},[l,S,s]);const k=Sa(0);i.useEffect(()=>{if(!l)return;const E=new ResizeObserver(f=>{Os(f.length===1,"entryList.length === 1");const R=f[0];Os(R.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),k.set(R.contentBoxSize[0].blockSize+16),T(R.contentBoxSize[0].blockSize)});return m.current&&E.observe(m.current),()=>{E.disconnect()}},[l,k,m]);const F=e.jsx(Gt,{className:l?"px-5":"mt-4 self-start",onClick:o,"data-testid":"paragen-prefer-response-button",children:e.jsx(I,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),N=r;return e.jsxs("div",{"data-paragen-root":!0,className:D("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",c&&l&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!c&&l&&"px-10",l?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[e.jsx("div",{className:D("absolute left-0 right-0 top-48 h-px","invisible"),ref:u}),e.jsx("div",{className:D("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:h}),e.jsx("div",{className:D("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:x}),n,l?e.jsx("div",{className:"flex-1"}):null,l?e.jsx("div",{className:"mt-4 min-h-10",children:N?null:e.jsx(se.div,{style:{translateX:M,width:S,bottom:k},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:D({fixed:B,"z-20 flex w-full justify-center":!0}),children:F})}):a?null:F]})}function Ga(){return e.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[e.jsx(Ct,{className:"h-4 w-[75%]"}),e.jsx(Ct,{className:"h-4 w-[50%]"}),e.jsx(Ct,{className:"h-4 w-[80%]"}),e.jsx(Ct,{className:"h-4 w-[55%]"}),e.jsx(Ct,{className:"h-4 w-[66%]"}),e.jsx(Ct,{className:"h-4 w-[64%]"}),e.jsx(Ct,{className:"h-4 w-[48%]"})]})}function $o(){const{layer:t}=Ot("3119715334");return t.get("should-enable-hojicha",!1)}const Wa=_e.div`text-sm text-token-text-secondary font-semibold`,qa=_e.div`flex gap-4 items-center mb-1`,Ct=_e.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function Va({clientThreadId:t,conversationTurnMountTime:s,turn:o,originalTurn:n}){const a=Io();if(!a.showParagenMetadata||!a.showDebugConversationTurns&&!a.forceParagen||o==null)return null;let r=o===n?"ORIGINAL":"NEW";const l=o.messages[o.messages.length-1],c=l?.message?.metadata?.__internal;if(c){const{model_id:u,model_definition_slug:h,model_definition_virtual_model_id:x,alternative_model_selection_rule:g,augmented_paragen_prompt_group_id:b,augmented_paragen_prompt_id:j,augmented_paragen_prompt:v}=c;u&&(r+=`
Model ID: ${u}`),h&&(r+=`
Model Slug: ${h}`),x&&(r+=`
Virtual Model ID: ${x}`),g&&(r+=`
Alternative Model Rule: ${g}`),b&&(r+=`
Prompt Group ID: ${b}`),j&&(r+=`
Prompt ID: ${j}`),v&&(r+=`
Prompt: ${v}`)}r+=`
Message ID: ${l.message.id}`;const p=Q.getTree(qe(t)).getParentPromptNode(o.variantIds[0]),m=p.metadata?.variantsInStreamInfo==null&&p.message.metadata?.paragen_variants_info!=null;return r+=`
User prompt message ID: ${p.message.id}`,r+=`
Is Persisted Paragen? ${m}`,r+=`
Completion Sample Finish Time: ${m?`${s} (persisted)`:ls(o.messages)?.completionSampleFinishTime}`,e.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:r})}async function $a({params:t}){await ms.submitParagenSelectionV2(t)}const Ya=ht({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}});function Eg({handleShowRetrievalResults:t,clientThreadId:s,turnIndex:o,responseComplete:n=!1}){const[a,r]=oe(s,m=>[Q.getTurnContentReferences(m,o),ro(m?.conversationTurns[o]?.messages??[])]),l=i.useMemo(()=>({turnIndex:o,clientThreadId:s,responseComplete:n}),[s,n,o]),c=i.useRef(!1);i.useEffect(()=>{c.current||(c.current=!0,q.logEvent(U.fileSourcesFooterShown,l))},[l]);const d=i.useCallback(()=>{q.logEvent(U.fileSourcesFooterClicked,l),t()},[t,l]),p=i.useMemo(()=>{const m=new Set,u=[];function h(g){!g||m.has(g)||(m.add(g),u.push(g))}if(a.forEach(g=>{g.type==="file"?h(g.cloud_doc_url??g.extra?.cloud_doc_url):g.type==="file_navlist"&&g.items.forEach(b=>{h(b.cloud_doc_url)})}),n){for(const g of r)if(Wu(g.message)){const b=qu(g.message.content.result),j=g.message.metadata?.cloud_doc_urls??[],v=b.chunks;for(let w=0;w<v.length;w++){const C=v[w];if(!C.documentId)continue;if(w<j.length){h(j[w]);continue}const A=C.documentId.endsWith("--google")?C.documentId.split("--")[1]:void 0,T=C.metadata.cloud_doc_url??(A?`https://drive.google.com/file/d/${A}`:void 0);h(T?.toString())}break}}const x=[];for(let g=0;g<u.length;g++){const b=u[g],j=Vu(b);if(j&&x.push(j.Icon),x.length>=3)break}return x},[r,a,n]);return e.jsxs(e.Fragment,{children:[e.jsx(se.div,{className:"absolute h-[60px]",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("button",{className:D("not-prose group/footnote mb-2 mt-3 flex w-fit items-center gap-1.5 rounded-xl border border-token-border-light bg-token-main-surface-primary py-2 hover:bg-token-main-surface-secondary","pl-3 pr-2.5"),onClick:d,children:[e.jsx("div",{className:"flex items-center gap-0.5 text-sm font-medium",children:e.jsx(I,{id:"/48IOP",defaultMessage:"Sources"})}),p.length>0&&e.jsx("div",{className:"flex flex-row-reverse gap-1",children:p.reverse().map((m,u)=>e.jsx(se.div,{className:D("flex items-center overflow-hidden rounded-full border-token-main-surface-primary bg-token-main-surface-primary","group-hover/footnote:border-token-main-surface-secondary","relative"),initial:{opacity:0},animate:{opacity:1},children:e.jsx(m,{className:"icon-md"})},u))})]})}),e.jsx("div",{className:"h-[60px]"})]})}const Ka=[1,2,3,4,10,20,30],Rg=.5;function Pg({clientThreadId:t}){const s=zr(Gr.isBusinessWorkspace),o=i.useRef(!1),n=us(t),a=oe(t,S=>S?.mode),{isUnauthenticated:r}=at(),l=i.useMemo(()=>{if(!n)return-1;const S=Ur(n);return S()>Rg?-1:Ka[Math.floor(S()*Ka.length)]},[n]),c=Dl(t),d=c[c.length-1],p=i.useMemo(()=>Xs.getRequestIdFromConversationTurn(d),[d]),m=Tt(p),[u,h]=i.useState(null),[x,g]=i.useState(!1),[b,j]=i.useState(!1),[v,w]=i.useState(!1),C=S=>{const k=ls(c)?.messages[0]?.message.id;h(S),B(k,S)},A=c.filter(S=>S.role===st.Assistant).length,T=d?.role===st.Assistant,B=i.useMemo(()=>Fr((S,k)=>{n&&S&&ms.submitConversationRating({conversation_id:n,message_id:S,rating:k,shown_at_assistant_turn:l}),q.logEvent(U.conversationRatingSubmitted,{rating:k,showAtAssistantTurn:l,conversationId:n}),g(!0),setTimeout(()=>{j(!0)},1500)},2e3),[n,l]),M=A!==l||m||!T||!!s||a?.kind!==Le.PrimaryAssistant||v||r;return i.useEffect(()=>{!M&&!o.current&&(q.logEvent(U.conversationRatingShown,{showAtAssistantTurn:l,conversationId:n}),o.current=!0)},[M]),v||M?null:e.jsxs("div",{className:"mx-auto",children:[e.jsx(hs,{children:x&&!b&&e.jsx(se.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Ja,{$padded:!0,children:e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(I,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!x&&e.jsx(se.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:e.jsxs(Ja,{$padded:!1,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[e.jsx(I,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(Gn,{$selected:u==="thumbsUp",onClick:()=>C("thumbsUp"),children:e.jsx(Wr,{className:"icon-md"})}),e.jsx(Gn,{$selected:u==="thumbsDown",onClick:()=>C("thumbsDown"),children:e.jsx(qr,{className:"icon-md"})})]})]}),e.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),e.jsx(Gn,{className:"p-3",$selected:!1,onClick:()=>w(!0),children:e.jsx(Bl,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const Gn=_e.button`
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,Ja=_e.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,Ig=Ve(()=>$e(()=>import("./gixulyvulprvzjjt.js"),__vite__mapDeps([52,2,1,3,23,4,5,10,53])));function Hg({clientThreadId:t,canShowInlineMessageFeedback:s,messageForRating:o,allGroupedMessages:n,currentModelId:a}){let r=null;const l=oe(t,u=>{const h=Q.getConversationTurns(u);let x=0;for(let g=h.length-1;g>=0;g--){const b=h[g];if(b.messages.some(j=>j.message.metadata?.is_indepth_feedback))return!0;if(b.messages.some(j=>j.message.author.role===st.Assistant)&&x++,x>=3)break}return!1}),c=us(t),d=ko(u=>u.voiceFeedbackThread),p=c===d,{voiceName:m}=$u();return l?null:(p&&c?(Fl.feedbackShown.success({voice:m}),r=e.jsx("div",{className:"text-center",children:e.jsx(Yu,{serverThreadId:c})})):o.rating&&s?r=e.jsx(Ig,{clientThreadId:t,conversationMessage:o,allGroupedMessages:n,currentModelId:a}):r=e.jsx("div",{className:"text-center",children:e.jsx(Pg,{clientThreadId:t})}),e.jsx("div",{className:"mt-3 w-full empty:hidden",children:r}))}const Dg=Ve(()=>$e(()=>import("./lfwlfzjv3fidhbtf.js"),__vite__mapDeps([54,2,1,3,55,56,23,4,5,10,57,58,59])).then(t=>t.VoicePlayButton)),Bg=Ve(()=>$e(()=>import("./mhpmg60veo22qlan.js"),__vite__mapDeps([60,2,4,1,3,5,61,62])).then(t=>t.AutomationSourceHeader)),Qa=80,Fg=16,Xa={minHeight:`calc(100dvh - ${Vr}px - ${Sm}px - 100px)`};function Lg(t){const{turnIndex:s,isFinalTurn:o,clientThreadId:n,onChangeRating:a,currentModelId:r,avatarClassName:l,showAvatar:c,scrollToMessageId:d,dateHeaderType:p}=t,m=Ce(),u=Po();cs()?.normalizedAccountUserId;const h=!!u&&Ll(u),x=co(),g=zr(Gr.isBusinessWorkspace),b=ao(),{value:j}=Pe("2848981774"),{value:v}=Pe("1456513860"),w=c??!v,C=null,A=j&&C==null,{value:T}=Pe("1887864177"),B=Je(n),M=Dt(qn(n,s)),{messages:S,variantIds:k,variantsInStreamInfo:F}=M,N=on(S),E=Ku(),f=ls(S);let R=f;for(const O of N){const ge=Ch(O);if(ge.some(it=>E.has(it.message.id))){R=ge[ge.length-1];break}}const _=f!==R,H=S.slice(0,R?S.indexOf(R)+1:0),L=!1,z=go(),[Y,P]=i.useState(!1),[re,ie]=i.useState(!1),Ae=k.findIndex(O=>H.some(ge=>ge.nodeId===O)),ne=M.role===st.User,xe=kt(),Me=ot(n),fe=_t(M.gizmoId??Me)?.data,Se=wo(r),Oe=Ju(r),Ne=nt(),ve=i.useContext(ln),he=xo(ve),[Te,Qe,Ue,le,ze,G]=oe(n,O=>{const ge=O?.tree!=null&&k.some(it=>{const wt=O.tree.getLeafFromNode(it);return O.tree.getHasErrorFromNode(wt.id)});return[O?.async_status===lr.STREAMING,Q.isMessageTurnEnded(O),ge,vm(ro(O?.mode),fe?.gizmo.id),O?.continuingFromSharedConversationId!=null,null]});let W="default";const ce=H.some(O=>O.message.content.content_type===Ol.MultimodalText),{layer:$}=Ot("1547743984"),X=B&&z&&$.get("show_share_button_inline",!1),de=null,{isUnauthenticated:pe}=at(),[Xe,be]=i.useState(!1),[Ye,Ee]=i.useState(!1),He=M.messages.map(O=>O.message.id),ye=i.useRef(null),ee=S[S.length-1],Ze=ee.rating,gs=(d?.length??0)>2&&d!=="finalAgentTurn"&&o&&A,Wt=()=>{H.length===1&&(q.logEvent(U.editPrompt,{id:H[0].message.id,threadId:Je(n)}),ke.logEvent("chatgpt_edit_prompt"),P(!0))},fs=i.useCallback(()=>{P(!1)},[]),ue=i.useCallback(O=>{Qu(n,s,b,O)},[n,s,b]),te=O=>{a({nodeId:ee.nodeId,messageId:ee.message.id,rating:O}),q.logEvent(O==="thumbsDown"?U.messageFeedbackThumbsDownClicked:U.messageFeedbackThumbsUpClicked,{id:ee.message.id,threadId:Je(n),model:r,rating:O}),ie(!0)},[pt]=i.useState(()=>Date.now()),At=i.useMemo(()=>Xs.getRequestIdFromConversationTurn(M),[M]),Re=Tt(At)&&!Qe,xn=So(),xs=on(H),we=i.useRef(!1),Nt=Xu(n,f);i.useEffect(()=>{if(we.current||d===void 0||!A||!ye.current){d==="finalAgentTurn"&&o&&we.current&&Vs(n,O=>{O.scrollToMessageId=void 0});return}(He.includes(d)||d==="finalAgentTurn"&&o)&&(we.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(ye.current)if(d==="finalAgentTurn"&&o)ye.current.scrollIntoView({behavior:"instant",block:"end"}),Vs(n,O=>{O.scrollToMessageId=void 0});else{const O=ye.current.offsetHeight;let ge;O>Qa?ge=Qa-O:ge=0,ye.current.style.scrollMarginTop=`${ge+Fg+Vr}px`,ye.current.scrollIntoView({behavior:"smooth"})}})}))},[d,ye.current]);const{showDebugConversationTurns:gt}=Io(),Sn=Zu(n,f),qt=wh({clientThreadId:n,conversationMode:le}),ft=i.useCallback(({requestedModelId:O,systemMessage:ge,extraStreamParams:it})=>{qt({id:ee.nodeId,requestedModelId:O,systemMessage:ge,extraStreamParams:it})},[ee,qt]),Vt=!x&&!ze&&!xe&&!ne,De=em(),$t=R?.message.author.role===st.Assistant?R.message:null,Ss=R?.message.metadata?.system_hints?.includes(K.Research);tm({isCompletionRequestInProgress:Re,isUserTurn:ne,message:$t});const{isOpen:rt}=sm(),Yt=wr(),Et=nm(le),Rt=!De&&!Et&&Vt&&o&&F?.num_variants_in_stream===2&&!ee.inlineComparisonRating&&!Ue,Kt=om(M),et=Rt,vs=Rt&&!Kt,vt=!_&&!ne&&!x&&!ze&&!Et&&!Te&&!Re&&!rt&&C==null,tt=vt&&(!g||Oe||h)&&!Et&&!pe&&!xe&&!f?.message.metadata?.b1de6e2_s,bt=!x&&!((Re||Te)&&o)&&k.length>1&&!Y&&!et&&C==null;let Jt=!1;if(ne&&H.length===1){const{shouldHideContent:O}=jh(H[0]);O&&(Jt=!0)}const bs=ne&&!Et&&!x&&!ce&&H.length===1&&!Jt&&!Y&&!pe&&C==null&&!Ss,vn=i.useCallback(O=>{Vs(n,ge=>{const it=Q.getTree(ge).getLeafFromNode(k[O]);ir.setCurrentLeafId(ge,it.id)}),q.logEvent(U.changeNode,{intent:"toggle_between"})},[n,k]),bn=am(M,H,gt),{toggleThreadSidebar:ys}=Ul(),Be=i.useMemo(()=>M.messages.length?M.messages[M.messages.length-1].nodeId:void 0,[M.messages]),ws=i.useCallback(()=>{Be&&ys({type:"retrievalResults",clientThreadId:n,turnIndex:s,messageId:Be})},[Be,ys,n,s]),{value:yt}=Pe("2912660649"),Qt=i.useMemo(()=>yt&&rm(M,Se,!!Me),[yt,Se,Me,M]);if(!bn&&!et)return gs?e.jsx("div",{style:Xa}):null;const js=o&&!Re&&R?.message.metadata?.followup_prompts?R.message.metadata.followup_prompts.map(O=>({text:O,type:zt.Reply})):[],yn=T&&js.length>0,Xt=H.some(({message:O})=>zl.getAssetPointers(O).length>0)?null:e.jsx(Tg,{className:"h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",clientThreadId:n,message:ee,onModelSelect:ft,onDropdownChange:be,canRegenerateResponse:Sn}),Zt=!ne&&!Jt&&(!o||!Re)?e.jsx(bm,{onClick:ue}):null,Ms=!ne&&(!o||!Re)&&(ee.disclaimers??[]).length===0&&ee.nodeId?e.jsx(Dg,{conversationId:n,message:ee,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,Pt=!ne&&ee&&(!o||!Re)?e.jsx(ym,{message:ee,isFinalTurn:o,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,Fe=Nt&&e.jsx(wm,{turn:M}),Ts=tt&&!Re?e.jsxs("div",{className:"flex",children:[Ze!=="thumbsDown"&&e.jsx(Fn,{onClick:()=>te("thumbsUp"),disabled:Ze==="thumbsUp",icon:Ze==="thumbsUp"?im:Wr,label:m.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${ee.nodeId}`),Ze!=="thumbsUp"&&e.jsx(Fn,{onClick:()=>te("thumbsDown"),disabled:Ze==="thumbsDown",icon:Ze==="thumbsDown"?lm:qr,label:m.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${ee.nodeId}`)]}):null,jn=X&&e.jsx(Fn,{onClick:()=>{sn.openSharingModal(B)},label:m.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:cm});function Cn(O){return Ne?O:e.jsx(Ho,{clientThreadId:n,isStaticSharedThread:x,verticalPadding:W,horizontalPadding:et?"none":he||w?"standard":"expanded",children:O})}const ks=!et;function Mn(O){return Ne?O:e.jsx(nn,{children:O})}return e.jsxs(e.Fragment,{children:[e.jsx(dm,{dateHeaderType:p,turn:M}),e.jsxs("article",{className:D("w-full text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",d==="finalAgentTurn"&&A?"opacity-0":""),style:gs?Xa:void 0,ref:ye,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":o,onMouseEnter:()=>Ee(!0),onMouseLeave:()=>Ee(!1),children:[e.jsx(um,{role:M.role}),Cn(e.jsx(e.Fragment,{children:et?e.jsx(Ag,{isFeedbackEnabled:tt,variantIds:k,variantsInStreamInfo:F,conversationTurnMountTime:pt,stubSideBySideFeedback:vs,...t}):Mn(e.jsxs(e.Fragment,{children:[L,!ne&&!L&&w&&e.jsx(Ug,{children:e.jsx(Qn,{messages:H,isUserTurn:ne,avatarClassName:l,gizmo:fe})}),e.jsx("div",{className:D("group/conversation-turn relative flex w-full min-w-0 flex-col",!ne&&mm,ks&&"@xs/thread:px-0 @sm/thread:px-1.5 @md/thread:px-4"),children:e.jsx("div",{className:"flex-col gap-1 md:gap-3",children:e.jsxs(e.Fragment,{children:[null,!ne&&!x&&e.jsx(hm,{messages:H,clientThreadId:n,gizmoId:fe?.gizmo.id}),Yt&&!ne&&e.jsx(Bg,{clientThreadId:n,messages:H}),e.jsx(Zn,{allMessages:S,groupedMessagesToRender:xs,allGroupedMessages:N,...t,isEditing:Y,isUserTurn:ne,isCompletionRequestInProgress:Re,isFeedbackEnabled:tt,isFinalTurn:o,hasActiveRequest:xn,showEditButton:bs,handleEnterEdit:Wt,handleExitEdit:fs}),Se&&!yt&&e.jsx("div",{className:"mb-4",children:e.jsx(pm,{messages:H})}),Qt&&e.jsx(Eg,{handleShowRetrievalResults:ws,clientThreadId:n,turnIndex:s,responseComplete:!(Re||Te)}),(vt||bt)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:D("mb-2 flex gap-3 empty:hidden",ne?"mr-1 flex-row-reverse":"-ml-2"),children:e.jsx(gm,{alwaysShow:o,showInline:o||bt,isHovered:Ye||Xe,pagination:bt&&e.jsx(fm,{showInline:o||bt,currentPage:Ae,onChangeIndex:vn,length:k.length,className:D("self-center",k.length>1?"visible":"!invisible")}),actions:vt&&e.jsxs(e.Fragment,{children:[Ms,Zt,Ts,Fe,Pt,jn,de,Xt]})})}),vt&&!Re?e.jsx("div",{className:"pr-2 lg:pr-0",children:e.jsx(xm,{message:ee,isFinalTurn:o})}):null,o&&!Re&&e.jsxs(e.Fragment,{children:[e.jsx(Hg,{canShowInlineMessageFeedback:re,clientThreadId:n,messageForRating:ee,allGroupedMessages:N,currentModelId:r}),yn&&e.jsx(kg,{followups:js})]})]})]})})})]}))}))]})]})}const Og=bo.memo(Lg),Ug=_e.div`flex-shrink-0 flex flex-col relative items-end`;function zg({onChangeRating:t,onRequestCompletion:s,clientThreadId:o,hideHeader:n}){const[a,r,l,c,d]=oe(o,_=>[_?.mode,Q.getConversationTurns(_).length,Q.getThreadData(_).isArchived,_?.conversationOrigin===Gl.APPLE,_?.scrollToMessageId]),p=Ie(),m=fo(),u=jm(),[h]=Cm(),x=Mm(),[g]=Tm(),b=cs(),j=un(o),v=p.store.useContentAreaDimensions(Ut.Header,_=>_?.height?_.height:void 0),w=p.store.useIsHeaderContentAreaPopulated(),C=km(j.id),A=a?.kind===Le.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":C,T=_m(),[B,M]=i.useState(0),[S,k]=i.useState(!1);i.useEffect(()=>{m&&(B===0?M(r):!S&&r>B&&(k(!0),ke.logEvent("chatgpt_continue_conversation_first_message_sent"),q.logEvent(U.continueConversationFirstMessageSent)))},[r,B,S,m]),i.useEffect(()=>{m&&(ke.logEvent("chatgpt_continue_conversation_page_loaded"),q.logEvent(U.continueConversationPageLoaded),ke.logEvent("chatgpt_conversation_share_page_loaded"),q.logEvent(U.sharedConversationPageLoaded))},[m]);const F=i.useCallback(()=>{u({behavior:"smooth"})},[u]),N=Am(o),E=T&&!l,f=Nm(o),R=(_,H,L,z)=>[...new Array(H-_).keys()].map(Y=>{const P=Y+_;return e.jsx(Og,{isFinalTurn:L(P),turnIndex:P,clientThreadId:o,onChangeRating:t,onRequestCompletion:s,currentModelId:j.id,avatarClassName:A,scrollToBottom:F,scrollToMessageId:z,dateHeaderType:f(P),showAvatar:void 0},P)});return e.jsxs("div",{onCopy:N,className:D("flex flex-col text-sm",E&&"pb-[120px]",v||E?null:"md:pb-9"),style:{paddingBottom:E?void 0:v},children:[!n&&b?.data&&e.jsx(ti,{clientThreadId:o}),m&&e.jsxs(e.Fragment,{children:[e.jsx(nn,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(I,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),r-B===0&&e.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:e.jsx("button",{onClick:()=>{sn.openModal(Em.ReportConversation),ke.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),q.logEvent(U.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:e.jsx(I,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),R(0,B,_=>_===B-1,d),e.jsx(nn,{children:e.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(Rm,{className:"icon-xs mr-2"}),e.jsx(I,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),R(B,r,_=>_===r-1,d)]}),!m&&R(0,r,_=>_===r-1,d),c&&h&&!g&&e.jsx(Za,{className:D("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{ke.logEvent("chatgpt_thread_scroll_to_top"),x({behavior:"smooth"})},children:e.jsx(Pm,{className:"icon-md text-token-text-primary"})}),!h&&e.jsx(Za,{className:D(v?null:"bottom-5",E?w?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:T?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":v},onClick:()=>{ke.logEvent("chatgpt_thread_scroll_to_bottom"),u({behavior:"smooth"})},children:e.jsx(Im,{className:"icon-md text-token-text-primary"})})]})}const Za=_e.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,Gg=60,Wg=({children:t,scrollViewClassName:s,scrollAnchorTopOffset:o=0})=>{const n=i.useRef(null);return e.jsx("div",{className:"h-full",ref:n,children:e.jsx(uo,{children:e.jsx(yh,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:s,scroller:()=>qg(n,o)?0:1/0,children:t})})})},qg=(t,s)=>{const o=Vg(t.current);if(o==null)return!1;const n=o>s,a=o<s-Gg;return!n&&!a};function Vg(t){if(!t)return null;const s=t.querySelector('[data-scroll-anchor="true"]');if(!s)return null;const o=s.getBoundingClientRect().top,n=t.getBoundingClientRect().top;return o-n}const $g=Ve(()=>$e(()=>import("./ko2h19alw3jscyph.js"),__vite__mapDeps([63,1,2,3,4,5,14,64,65,66,67,57,68])).then(t=>t.OpenDebugSidebarButton)),Yg=Ve(()=>$e(()=>import("./lgp60tfx6r8qdftv.js"),__vite__mapDeps([69,2,4,1,3,5]))),er=ht({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function Kg({clientThreadId:t}){const s=mr(),o=us(t),n=oe(t,Q.getGizmoId),a=async()=>{o&&(await ms.patchConversation(o,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",t]}),$l.setState(r=>{const l=r.threads[o];l!=null&&(l.initialThreadData.isArchived=!1)}),Jm(s,n))};return e.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:e.jsx(I,{...er.archivedConversationDescription})}),e.jsx("div",{children:e.jsx(Gt,{disabled:!o,onClick:a,icon:$m,children:e.jsx(I,{...er.unarchiveButton})})})]})}const Jg=function({clientThreadId:t,preRequestCompletion:s,hideHeader:o,hideMessages:n,hideFooter:a,hideToolsOverlay:r,messagesVerticalAlign:l="top",prependThreadChildren:c,renderEmptyState:d,prefetchSearch:p}){const m=rr(),{data:u}=mt(),h=dn(t),x=dr(),[g,b,j,v,w,C,A]=oe(t,le=>[le?.isLoading,Q.getCurrentLeafId(le),Q.hasUserMessage(le),le?.conversationTurns.length??0,Q.getThreadData(le).isArchived,le?.modelId,le?Q.getGizmoId(le):x]);Wl(t),i.useEffect(()=>{g||(Bt(t)?Js.addTiming("chatgpt.web.chatPage.renderNewConversation"):Js.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,g]);const{setTargetedContent:T}=Hr(),B=m?.includes(ql),{value:M}=Pe("2848981774"),S=Hm(),F=M&&null==null,N=v>=2;Ir(N);const E=Bt(t)&&!N&&$s(h),f=Bt(t)&&!j&&($s(h)||h?.kind===Le.GizmoTest),_=yo(u).id,H=C??_,L=!!C,z=wo(H),Y=rs(u?.models,H),P=Dm(t,h),re=Pr();Bm(v,t),i.useEffect(()=>{re||T(void 0)},[t,T,re,b]);const ie=Zl({clientThreadId:t,preRequestCompletion:s}),{caModal:Ae,onChangeRating:ne}=Fm({clientThreadId:t,currentModelId:H}),xe=Th({clientThreadId:t,handleRequestCompletion:ie,prefetchSearchPromise:p}),Me=le=>F?e.jsx(uo,{children:e.jsxs(i.Suspense,{fallback:null,children:[e.jsx(Ym,{}),e.jsx("div",{className:"flex h-full flex-col overflow-y-auto",children:le})]})}):e.jsx(Wg,{scrollAnchorTopOffset:o?0:Km,children:l==="bottom"?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1"}),le]}):le});i.useEffect(()=>{document.title=P??"ChatGPT"},[P]);const fe=kt(),Se=i.useContext(ln),Oe=xo(Se),Ne=Oe,ve=f&&!d&&!A&&!z&&!fe,he=fo(),Te=i.useRef(null),Qe=i.useRef(null),Ue=i.useMemo(()=>({threadContentScrollContainerElementRef:Te,footerRootContainerElementRef:Qe}),[]);return e.jsxs(ah,{clientThreadId:t,children:[B&&e.jsx(Yg,{}),e.jsx(Lm,{children:P!=null&&e.jsx("title",{children:P})}),e.jsx(Vl.Provider,{value:ie,children:e.jsxs(Om,{children:[e.jsxs(Um,{noKeyboard:!0,clientThreadId:t,currentModelConfig:Y,className:D("composer-parent flex flex-col focus-visible:outline-0",ve?"h-[calc(100%-2rem)]":"h-full"),children:[!n&&e.jsx(zm,{value:Ue,children:e.jsx(Qg,{ref:Te,className:Oe?"pb-[0.75rem]":"pb-[1.5rem]",children:!g&&!xe?f?d??e.jsx(yg,{clientThreadId:t,currentModelId:H,isModelLoaded:L,onRequestCompletion:ie,showChatgptHomepage:ve,chatgptHomepageDisclaimer:Ne?null:ve&&e.jsx(Ca,{clientThreadId:t})}):N?Me(e.jsxs(e.Fragment,{children:[c,e.jsx(zg,{onChangeRating:ne,onRequestCompletion:ie,clientThreadId:t,hideHeader:o},t)]})):null:null})}),e.jsx(Xg,{ref:Qe,children:w?e.jsx(Kg,{clientThreadId:t}):e.jsxs("div",{children:[!ve&&e.jsx(sg,{clientThreadId:t,isNewThread:E,showPromptStarters:E||!j,currentModelId:H,onRequestCompletion:ie}),!a&&!Ne&&e.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:$s(h)&&!ve&&e.jsx("div",{className:"min-h-4",children:e.jsx(Ca,{clientThreadId:t})})})]})})]}),!r&&!Oe&&e.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[S?e.jsxs(e.Fragment,{children:[e.jsx($g,{}),!1]}):null,e.jsx(Gm,{})]}),Ae,e.jsx(Wm,{clientThreadId:t,isStaticSharedThread:!1,isDynamicSharedThread:he}),e.jsx(qm,{}),e.jsx(Vm,{conversationId:t,isActiveWindow:!0})]})})]})},mf=bo.memo(Jg),Qg=_e.div`grow flex-1 overflow-hidden @container/thread translate-y-[2rem] -mt-[2rem]`,Xg=_e.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full isolate has-[[data-has-thread-error]]:[box-shadow:var(--sharp-edge-bottom-shadow)] has-[[data-has-thread-error]]:pt-2`;export{Og as C,yg as E,mf as M,hi as P,lg as S,Oh as T,Wg as W,ti as a,Th as b,sg as c,zh as d,uf as e,ei as u};
//# sourceMappingURL=mwg1bia5luujsxxb.js.map

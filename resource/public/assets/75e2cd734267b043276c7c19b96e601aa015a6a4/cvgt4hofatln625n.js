import{bT as _,d as b,b7 as we,b8 as Te,R as W,h as K,gM as S,d5 as N,bW as xe,bR as P,dg as ee,D as Pe,O as Me,en as Ce,C as ae,a6 as be,gN as V,gn as Ne,go as Z,c2 as _e,c3 as Oe,e_ as Ae}from"./mnkup87aq6tfilq5.js";import{r as p,c as O,j as e,M as i,a as F,d as Ge,f as Re,b as ie}from"./l6lryjpkt8rv0lpy.js";import{fg as d,fi as se,bG as ye,gV as De,bK as k,M as te,bX as Ee,fk as he,a3 as Le,iA as Ie,a4 as ze,ak as We,gC as Fe,j7 as Be,fZ as He,j8 as qe,j9 as Ue,fn as fe,c_ as Ve,fh as y}from"./dvllb5fed1b4y7k1.js";import{a as Ke,b as Ye}from"./glr3hsgqk2atsgja.js";import{S as Qe}from"./f72oi2o5t19pjunq.js";import{g as je}from"./lurgjwdeumqr5obb.js";import{S as Je}from"./bec9qm8zi6ffweg0.js";import{G as $e}from"./hli3paxjs6c9ftyy.js";import{S as Ze}from"./brsuolmb6a4xak52.js";import{A as Xe}from"./mtfnwb571mbq6ji5.js";import{V as es}from"./d3y72ugnrmac5z1v.js";import{R as ss}from"./o0ruvxo2l2807vcb.js";import{a as ts,b as as,c as is,d as ns,e as rs,f as ls,A as os}from"./egl69jgfgzdafo9i.js";import{u as cs,b as ds}from"./ev481f9ncaaw0s6x.js";import"./d0ynpcmhn5mxx54e.js";import"./lpa0sb8hkyi7pmml.js";import"./4wfwbvmzqu7tbfmg.js";import"./1e3kywkhcjn5spyo.js";import"./cbms2jcglp4b707f.js";import"./jnjzqafy9dn7o7ce.js";import"./iwy57t47eybf2a2a.js";import"./il55y7bc33l80dn8.js";import"./hjvhqy8z9mtcdx24.js";import"./oprcb0x0apbum2rw.js";import"./g9c9v7rwqsjun8by.js";import"./jvbzf1d67o78h9n2.js";import"./eivflkxhgemu4u0k.js";import"./knwgusg2qgb1dca0.js";import"./khfeyjk7s03xesjl.js";import"./llh8t5ckv1lpc2n1.js";import"./h30lmxihx79lh0e9.js";import"./k0r4nt4e0ngxvcib.js";import"./pc32gvx0zuzynmfl.js";import"./b389eodcyywjf70s.js";import"./h4yt26kg7q4972c8.js";import"./e0sg4zczsdh89yb1.js";import"./mc77hi6aghwo7h20.js";import"./nha7i667i9vx96u4.js";import"./ouo7t9nb3e24niv7.js";import"./oftd8yvle59zqu13.js";function ps({value:t,title:s,valueClassName:a,onChange:n,emptyMessage:r}){const[l,c]=p.useState(!1),[x,m]=p.useState(""),u=O(),T=p.useRef(null),g=()=>{if(x!==""){const h=x.trim();n([...t,h]),c(!1),m("")}};return e.jsxs(d.Root,{className:"w-auto",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:s}),e.jsx(d.HeaderCell,{})]}),e.jsxs(d.Body,{children:[t.map((h,f)=>e.jsxs(d.Row,{children:[e.jsx(d.Cell,{className:a,children:h}),e.jsx(d.Cell,{textAlign:"right",children:e.jsx(_,{type:"button",onClick:()=>{n(t.filter((A,C)=>C!==f))},children:e.jsx(se,{className:"icon-sm"})})})]},f)),r&&t.length===0?e.jsx(d.Row,{children:e.jsx(d.Cell,{colSpan:2,className:"text-center text-sm italic",children:r})}):null,e.jsxs(d.Row,{children:[e.jsxs("div",{className:b("mt-2 flex flex-row gap-2 p-1",!l&&"hidden"),children:[e.jsx(ye,{ariaLabel:u.formatMessage({id:"CgP6Du",defaultMessage:"Add new domain"}),className:"w-80",name:"newDomain",value:x,onChange:h=>{m(h.target.value)},ref:T,onPressEnter:g,placeholder:"example.com"}),e.jsx(_,{className:"grow-0",onClick:g,children:e.jsx(i,{id:"svRVol",defaultMessage:"Add"})})]}),!l&&e.jsxs(_,{type:"button",onClick:()=>{c(!0),setTimeout(()=>{T.current?.focus()},0)},className:"mt-2",children:[e.jsx(De,{className:"icon-sm inline-block"}),e.jsx(i,{id:"J5y3+M",defaultMessage:"Add new domain"})]})]})]})]})}const ms=t=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 6C3 4.34315 4.34315 3 6 3H18C19.6569 3 21 4.34315 21 6V7.11526C21 7.96049 20.6434 8.76651 20.018 9.33508L15.8273 13.1448C15.6189 13.3343 15.5 13.603 15.5 13.8847V19.882C15.5 21.3687 13.9354 22.3357 12.6056 21.6708L9.60557 20.1708C8.92801 19.832 8.5 19.1395 8.5 18.382V13.8847C8.5 13.603 8.38115 13.3343 8.17267 13.1448L3.98198 9.33508C3.35656 8.76651 3 7.96049 3 7.11526V6ZM6 5C5.44772 5 5 5.44772 5 6V7.11526C5 7.397 5.11885 7.66568 5.32733 7.8552L9.51802 11.6649C10.1434 12.2335 10.5 13.0395 10.5 13.8847V18.382L13.5 19.882V13.8847C13.5 13.0395 13.8566 12.2335 14.482 11.6649L18.6727 7.8552C18.8811 7.66568 19 7.39701 19 7.11526V6C19 5.44772 18.5523 5 18 5H6Z",fill:"currentColor"}));function us({isOpen:t,onClose:s,account:a,gpt:n}){const r=O(),[l,c]=p.useState(!1),[x,m]=p.useState(""),[u,T]=p.useState(!0);return e.jsxs(we,{size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:Te,type:"success",title:r.formatMessage(I.deleteModalTitle),children:[e.jsx("p",{className:"mb-4 text-token-text-primary",children:e.jsx(i,{...I.deleteModalPrompt,values:{gptName:n.gizmo.display.name}})}),!u&&e.jsx("p",{className:"text-red-500",children:e.jsx(i,{...I.invalidEmail})}),e.jsx(ye,{ariaLabel:r.formatMessage({id:"x4A5l2",defaultMessage:"Email"}),className:b("px-3 py-2",u?"":"border-red-500"),name:"email",type:"email",value:x,placeholder:"Email",onChange:g=>{m(g.target.value)}}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(_,{color:"secondary",onClick:()=>{s(!1),c(!1),T(!0)},loading:l,children:e.jsx(i,{...I.cancelButtonText})}),e.jsx(_,{color:"primary",loading:l,onClick:()=>{c(!0),T(!0),x==""||!es.test(x)?(T(!1),c(!1)):W.safePost("/accounts/{account_id}/gpts/{gizmo_id}/owner",{parameters:{path:{account_id:a.id,gizmo_id:n.gizmo.id}},requestBody:{email:x}}).then(()=>{s(!0),c(!1),T(!0)},()=>{T(!1),c(!1)})},children:e.jsx(i,{...I.deleteButtonText})})]})]})}const I=K({deleteModalTitle:{id:"changeOwnerModal.changeModalTitle",defaultMessage:"Change Owner"},deleteModalPrompt:{id:"changeOwnerModal.changeModalPrompt",defaultMessage:"New owner of {gptName}"},cancelButtonText:{id:"changeOwnerModal.cancelButtonText",defaultMessage:"Cancel"},deleteButtonText:{id:"changeOwnerModal.changeOwnerButtonText",defaultMessage:"Change owner"},invalidEmail:{id:"changeOwnerModal.invalidEmail",defaultMessage:"Email is invalid or does not belong to a member in this workspace"}});function gs({isOpen:t,onClose:s,account:a,gpt:n}){const r=O(),[l,c]=p.useState(!1);return e.jsxs(we,{size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:Te,type:"success",title:r.formatMessage(U.deleteModalTitle),children:[e.jsx("p",{className:"mb-4 text-token-text-primary",children:e.jsx(i,{...U.deleteModalPrompt,values:{gptName:n.gizmo.display.name}})}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(_,{color:"secondary",onClick:()=>{s(!1)},loading:l,children:e.jsx(i,{...U.cancelButtonText})}),e.jsx(_,{color:"danger",loading:l,onClick:()=>{c(!0),W.safeDelete("/accounts/{account_id}/gpts/{gizmo_id}",{parameters:{path:{account_id:a.id,gizmo_id:n.gizmo.id}}}).finally(()=>{s(!0),c(!1)})},children:e.jsx(i,{...U.deleteButtonText})})]})]})}const U=K({deleteModalTitle:{id:"deleteGPTModal.accessModalTitle",defaultMessage:"Delete GPT"},deleteModalPrompt:{id:"deleteGPTModal.accessModalPrompt",defaultMessage:"Are you sure you would like to delete {gptName}? This action can not be undone."},cancelButtonText:{id:"deleteGPTModal.cancelButtonText",defaultMessage:"Cancel"},deleteButtonText:{id:"deleteGPTModal.deleteButtonText",defaultMessage:"Delete"}}),z=10;function xs({account:t,gpt:s,thirdParty:a=!1}){const n=F(),[r,l]=p.useState(!1),[c,x]=p.useState(!1),[m,u]=p.useState(!1),[T,g]=p.useState(!1),h=Ge(),f=new Date(a?s.gizmo.workspace_approval_date??"":s.gizmo.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),A=new Date(s.gizmo.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),C=s.tools.filter(v=>v.type===N.JIT_PLUGIN).map(v=>v.type===N.JIT_PLUGIN?v.metadata.domain:"");let D="";return C.length===0?D="":C.length===1?D=C[0]:D=`${C.length} domains`,e.jsxs(e.Fragment,{children:[e.jsxs(d.Row,{children:[e.jsx(d.Cell,{className:"min-w-[180px] max-w-[240px] whitespace-break-spaces py-2 pr-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:e.jsx($e,{src:s.gizmo.display.profile_picture_url,isFirstParty:s.gizmo.tags?.includes(ze.FirstParty)??!1,alt:s.gizmo.display.name,className:"h-10 w-10"})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-semibold text-token-text-primary",children:s.gizmo.display.name})})]})}),e.jsx(d.Cell,{className:"w-full min-w-[80px] max-w-[120px] p-2 text-sm text-token-text-secondary",children:e.jsx("span",{className:"block overflow-hidden text-ellipsis whitespace-nowrap",children:s.gizmo.author.display_name})}),e.jsx(d.Cell,{className:"min-w-[120px] max-w-[200px] whitespace-break-spaces p-2 text-sm text-token-text-secondary",children:D}),!a&&e.jsx(d.Cell,{className:"whitespace-nowrap p-2 text-sm text-token-text-secondary",children:e.jsx(ks,{gizmo:s,account:t})}),!a&&e.jsx(d.Cell,{className:"whitespace-nowrap p-2 text-sm text-token-text-secondary",children:s.gizmo.vanity_metrics?.num_conversations_str??0}),e.jsx(d.Cell,{className:"whitespace-nowrap p-2 text-sm text-token-text-secondary",children:f}),e.jsx(d.Cell,{className:"whitespace-nowrap p-2 text-sm text-token-text-secondary",children:A}),e.jsx(d.Cell,{className:"p-2",children:e.jsxs(P.Root,{children:[e.jsx(P.Trigger,{children:e.jsx(We,{className:"icon-sm"})}),e.jsx(P.Portal,{children:a?e.jsx(P.Content,{children:e.jsx(P.Item,{onClick:()=>{g(!0)},color:"danger",icon:se,children:e.jsx(i,{...o.removeFromWorkspace})})}):e.jsxs(P.Content,{children:[e.jsx(P.Item,{onClick:()=>{l(s)},icon:Je,children:e.jsx(i,{...o.changeAccess})}),e.jsx(P.Item,{onClick:()=>{u(!0)},icon:Fe,children:e.jsx(i,{...o.changeOwner})}),e.jsx(P.Item,{onClick:()=>{x(!0)},icon:se,color:"danger",children:e.jsx(i,{...o.deleteGPT})})]})})]})})]}),r&&e.jsx(Ze,{publishedGizmo:r,gizmo:Be(r),promoteGizmo:async()=>{},onClose:()=>{l(!1)},showActionsModal:()=>{},appealGizmo:async()=>{h(He(r.gizmo.id))},setAppealState:()=>{},shareOnly:!0,updateGizmo:()=>{},workspaceOwner:!0}),e.jsx(us,{isOpen:m,gpt:s,account:t,onClose:v=>{u(!1),v&&n.invalidateQueries({queryKey:["workspace",t.id,S.WORKSPACE]})}}),e.jsx(gs,{isOpen:c,gpt:s,account:t,onClose:v=>{x(!1),v&&n.invalidateQueries({queryKey:["workspace",t.id,S.WORKSPACE]})}}),e.jsx(ss,{isOpen:T,gpt:s,account:t,onClose:v=>{g(!1),v&&n.invalidateQueries({queryKey:["workspace",t.id,S.THIRD_PARTY]})}})]})}function hs(t,s,a){return t.sort((n,r)=>{let l,c;if(s==="created_at")l=new Date(n.gizmo.created_at).getTime(),c=new Date(r.gizmo.created_at).getTime();else if(s==="updated_at")l=new Date(n.gizmo.updated_at).getTime(),c=new Date(r.gizmo.updated_at).getTime();else if(s==="workspace_approval_date")l=new Date(n.gizmo.workspace_approval_date??"").getTime(),c=new Date(r.gizmo.workspace_approval_date??"").getTime();else if(s==="vanity_metrics.num_conversations_str")l=n.gizmo.vanity_metrics?.num_conversations??0,c=r.gizmo.vanity_metrics?.num_conversations??0;else throw new Error(`Invalid field: ${s}`);if(a==="asc")return l-c;if(a==="desc")return c-l;throw new Error(`Invalid direction: ${a}`)})}function fs(t){switch(t){case k.User:case k.Group:return k.Private;case k.WorkspaceLink:return k.Workspace;default:return t}}function js(t,s){return t.filter(a=>{const n=a.tools.some(c=>c.type===N.MEMORY?!1:s.tools[c.type]),r=fs(a.gizmo.share_recipient),l=s.share_recipient[r];return n||l})}function ws(t,s){const a=s.toLowerCase();return t.filter(n=>{const r=n.gizmo.author.display_name&&n.gizmo.author.display_name.toLowerCase(),l=n.gizmo.display.name.toLowerCase();return r&&r.includes(a)||l.includes(a)})}function Ts({account:t,showThirdParty:s}){const[a,n]=p.useState(S.WORKSPACE),{data:r,fetchNextPage:l,hasNextPage:c,isError:x,isFetchingNextPage:m}=ys(t.id,a),u=O(),[T,g]=p.useState(!1),h=r?.pages.flatMap(j=>j.items)??[];p.useEffect(()=>{!x&&!m&&c&&l()},[m,c,x,l]);const f=c,A=p.useRef(null),[C,D]=p.useState(""),[v,ne]=p.useState(!1),[E,ke]=p.useState("updated_at"),[B,re]=p.useState("desc"),Y=B==="asc"?qe:Ue,le={tools:{[N.BROWSER]:!1,[N.PYTHON]:!1,[N.JIT_PLUGIN]:!1,[N.RETRIEVAL]:!1,[N.DALLE]:!1,[N.CANVAS]:!1},share_recipient:{[k.Private]:!1,[k.Workspace]:!1,[k.Link]:!1,[k.Marketplace]:!1}},[L,oe]=p.useState(le),[Q,H]=p.useState(0),ve=F();p.useEffect(()=>{v&&A.current&&A.current.focus()},[v]);function ce(j,G){const{id:R,checked:Se}=j.currentTarget,ge={...L};ge[G][R]=Se,oe(ge),H(0)}function J(j){const G=E,R=B;E===j?re(B==="asc"?"desc":"asc"):(ke(j),re("desc")),Pe.addAction("workspace_gpt_table_sorting",{column:j,previousSort:G,previousDirection:R,newDirection:G===E?R==="asc"?"desc":"asc":"desc"})}let de=0,pe=0;const $=Object.values(L.tools).filter(Boolean).length+Object.values(L.share_recipient).filter(Boolean).length;let M=[],me=0;const q=r===void 0,ue=!q&&h.length>0;return q||(me=Math.min(h.length,z),pe=Math.ceil(h.length/z),f?M=h:M=hs(h,E,B),C!==""&&(M=ws(M,C)),$>0&&(M=js(M,L)),de=Math.ceil(M.length/z),M=M.slice(Q*z,(Q+1)*z)),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between border-b border-token-border-light",children:[e.jsxs("div",{className:"flex space-x-4 pt-2",children:[e.jsx("a",{className:b("text-l pb-4 font-semibold",a===S.WORKSPACE?"border-b border-token-text-secondary text-token-text-primary":"cursor-pointer text-token-text-tertiary"),onClick:()=>{n(S.WORKSPACE)},children:e.jsx(i,{...o.workspaceTab})}),s&&e.jsx("a",{className:b("text-l pb-4 font-semibold",a===S.THIRD_PARTY?"border-b border-token-text-secondary text-token-text-primary":"cursor-pointer text-token-text-tertiary"),onClick:()=>{n(S.THIRD_PARTY)},children:e.jsx(i,{...o.thirdPartyTab})})]}),!q&&e.jsxs("div",{className:"flex items-center space-x-4 pb-2",children:[$>0&&e.jsxs("div",{className:"mx-0 flex items-center space-x-1",onClick:()=>{oe(le)},children:[e.jsx("span",{children:$}),e.jsx(xe,{className:"icon-md cursor-pointer"})]}),e.jsxs(P.Root,{children:[e.jsx(P.Trigger,{children:e.jsx(ms,{className:"icon-md"})}),e.jsx(P.Portal,{children:e.jsx(P.Content,{className:"rounded-lg px-2 text-sm",children:e.jsxs("div",{className:"w-64 space-y-2 p-2 font-normal text-token-text-primary",children:[e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(i,{...o.capabilitiesTitle})}),Object.entries(L.tools).map(([j,G])=>e.jsx(te,{id:j,checked:G,label:je(t,j),onChange:R=>{ce(R,"tools")}},j))]}),e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(i,{...o.whoHasAccessTitle})}),Object.entries(L.share_recipient).map(([j,G])=>e.jsx(te,{id:j,checked:G,label:je(t,j),onChange:R=>{ce(R,"share_recipient")}},j))]})]})})})]}),e.jsx("div",{className:"cursor-pointer",onClick:()=>{ne(!0)},children:e.jsx(Ee,{className:"icon-md"})}),e.jsx("input",{type:"text",ref:A,placeholder:u.formatMessage(o.filterByNameOrBuilderPlaceholder),className:b("border-none bg-token-main-surface-primary px-0 transition-width duration-300 ease-in-out focus:ring-0",v?"w-64":"w-0"),value:C,onChange:()=>{H(0),D(A.current?.value??"")}}),e.jsx("div",{className:b("cursor-pointer",v?"":"hidden"),onClick:()=>{ne(!1),D(""),H(0)},children:e.jsx(xe,{className:"icon-sm"})}),s&&e.jsx(_,{color:"secondary",onClick:()=>{g(!0)},icon:he,children:e.jsx(i,{...o.approveAGPTButton})})]})]}),q?e.jsx("div",{className:"mt-8 flex items-center justify-center",children:e.jsx(ee,{})}):e.jsxs("div",{style:{height:me*85+75},className:"mb-8",children:[M.length>0?e.jsxs(d.Root,{size:"normal",className:"w-full min-w-full overflow-hidden overflow-x-auto bg-token-main-surface-primary sm:rounded-lg",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"py-2 pr-4 text-left text-xs text-token-text-secondary",children:e.jsx(i,{...o.nameCellTitle})}),e.jsx(d.HeaderCell,{className:"px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsx(i,{...o.builderCellTitle})}),e.jsx(d.HeaderCell,{className:"px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsx(i,{...o.customActionsCellTitle})}),a==S.WORKSPACE&&e.jsx(d.HeaderCell,{className:"px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsx(i,{...o.whoHasAccessTitle})}),a==S.WORKSPACE&&e.jsx(d.HeaderCell,{className:"cursor-pointer px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{f||J("vanity_metrics.num_conversations_str")},children:[e.jsx("span",{children:e.jsx(i,{...o.chatsCellTitle})}),E==="vanity_metrics.num_conversations_str"&&e.jsx(Y,{className:b("icon-sm",f&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"cursor-pointer px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{f||J("created_at")},children:[e.jsx("span",{children:a==S.WORKSPACE?e.jsx(i,{...o.createdCellTitle}):e.jsx(i,{...o.approvedCellTitle})}),E==="created_at"&&e.jsx(Y,{className:b("icon-sm",f&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"cursor-pointer px-4 py-2 text-left text-xs text-token-text-secondary",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{f||J("updated_at")},children:[e.jsx("span",{children:e.jsx(i,{...o.updatedCellTitle})}),E==="updated_at"&&e.jsx(Y,{className:b("icon-sm",f&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"w-16"})]}),e.jsx(d.Body,{children:M.map(j=>e.jsx(xs,{account:t,gpt:j,thirdParty:a==S.THIRD_PARTY},j.gizmo.id))})]}):e.jsxs("div",{className:"flex h-full w-full flex-col items-center gap-4 py-16",children:[e.jsx(Le,{className:"h-12 w-12 text-gray-400"}),e.jsx("p",{className:"text-token-text-secondary",children:a==S.THIRD_PARTY?ue?e.jsx(i,{...o.noWorkspaceApprovedGPTsFound}):e.jsx(i,{...o.noWorkspaceApprovedGPTs}):ue?e.jsx(i,{...o.noWorkspaceGPTsFound}):e.jsx(i,{...o.noWorkspaceGPTs})}),a==S.THIRD_PARTY&&e.jsx(_,{color:"secondary",onClick:()=>{g(!0)},icon:he,children:e.jsx(i,{...o.approveAGPTButton})})]}),f&&e.jsxs("div",{className:"my-4 flex w-full items-center justify-center gap-4 text-token-text-tertiary",children:[e.jsx(ee,{}),e.jsx(i,{...o.stillLoadingData})]}),pe>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Ie,{currentPage:Q,onChangeIndex:H,length:Math.max(de,1)})})]}),e.jsx(Xe,{isOpen:T,onClose:()=>{g(!1),ve.invalidateQueries({queryKey:["workspace",t.id,S.THIRD_PARTY]})},account:t})]})}function ys(t,s){return Re({queryKey:["workspace",t,"gizmos",s],queryFn:({pageParam:a})=>Me.getWorkspaceGPTs(t,s,a),initialPageParam:"",getNextPageParam:a=>a.cursor})}function ks({gizmo:t,account:s}){const a=O(),n={[k.Private]:a.formatMessage(o.shareRecipientTitlePrivate),[k.User]:a.formatMessage(o.shareRecipientTitlePrivate),[k.Group]:a.formatMessage(o.shareRecipientTitlePrivate),[k.Link]:a.formatMessage(o.shareRecipientTitleLink),[k.Marketplace]:a.formatMessage(o.shareRecipientTitlePublic),[k.Workspace]:s.data.name,[k.WorkspaceLink]:s.data.name};if(["private","user","group"].includes(t.gizmo.sharing.recipient)){const{users:r,groups:l}=vs(t);return r===0&&l===0?e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(i,{...o.shareRecipientTitlePrivate})}):r>0&&l>0?e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{id:"fQ+tJG",defaultMessage:"Shared with {users} and {groups}",values:{users:a.formatMessage(o.userCount,{numUsers:r}),groups:a.formatMessage(o.groupCount,{numGroups:l})}})]}):r>0?e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{...o.userCount,values:{numUsers:r}})]}):e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{...o.groupCount,values:{numGroups:l}})]})}return e.jsx("span",{children:n[t.gizmo.share_recipient]})}function vs(t){if(t.gizmo.sharing.subjects){const s=t.gizmo.sharing.subjects.filter(n=>n.type===fe.USER).length,a=t.gizmo.sharing.subjects.filter(n=>n.type===fe.GROUP).length;return{users:s,groups:a}}return{users:0,groups:0}}const o=K({stillLoadingData:{id:"workspaceSettings.stillLoadingData",defaultMessage:"Don't see what you're looking for? Some GPTs are still loading..."},noWorkspaceGPTs:{id:"workspaceSettings.noWorkspaceGPTs",defaultMessage:"This workspace does not have any GPTs"},noWorkspaceGPTsFound:{id:"workspaceSettings.noWorkspaceGPTsFound",defaultMessage:"No workspace GPTs found"},noWorkspaceApprovedGPTs:{id:"workspaceSettings.noWorkspaceApprovedGPTs",defaultMessage:"You havent approved any third-party GPTs"},noWorkspaceApprovedGPTsFound:{id:"workspaceSettings.noWorkspaceApprovedGPTsFound",defaultMessage:"No approved third-party GPTs found"},workspaceTab:{id:"workspaceSettings.workspaceTab",defaultMessage:"Workspace"},thirdPartyTab:{id:"workspaceSettings.thirdPartyTab",defaultMessage:"Third-party"},capabilitiesTitle:{id:"workspaceSettings.capabilitiesTitle",defaultMessage:"Capabilities"},whoHasAccessTitle:{id:"workspaceSettings.whoHasAccessTitle",defaultMessage:"Who has access"},filterByNameOrBuilderPlaceholder:{id:"workspaceSettings.filterByNameOrBuilderPlaceholder",defaultMessage:"Filter by name or builder..."},nameCellTitle:{id:"workspaceSettings.nameCellTitle",defaultMessage:"Name"},builderCellTitle:{id:"workspaceSettings.builderCellTitle",defaultMessage:"Builder"},customActionsCellTitle:{id:"workspaceSettings.customActionsCellTitle",defaultMessage:"Custom Actions"},chatsCellTitle:{id:"workspaceSettings.chatsCellTitle",defaultMessage:"Chats"},createdCellTitle:{id:"workspaceSettings.createdCellTitle",defaultMessage:"Created"},updatedCellTitle:{id:"workspaceSettings.updatedCellTitle",defaultMessage:"Updated"},approvedCellTitle:{id:"workspaceSettings.approvedCellTitle",defaultMessage:"Approved"},approveAGPTButton:{id:"workspaceSettings.approveAGPTButton",defaultMessage:"Approve a GPT"},shareRecipientTitlePrivate:{id:"vyjlzc",defaultMessage:"Invite only"},shareRecipientTitleLink:{id:"workspaceSettings.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettings.shareRecipientTitlePublic",defaultMessage:"Public"},changeAccess:{id:"workspaceSettings.changeAccess",defaultMessage:"Change who has access"},changeOwner:{id:"workspaceSettings.changeOwner",defaultMessage:"Change Owner"},deleteGPT:{id:"workspaceSettings.deleteGPT",defaultMessage:"Delete GPT"},removeFromWorkspace:{id:"workspaceSettings.removeFromWorkspace",defaultMessage:"Remove from workspace"},userCount:{id:"P1xo2B",defaultMessage:"{numUsers, plural, one {# user} other {# users}}"},groupCount:{id:"4zRUED",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"}});function X({title:t,description:s,children:a,upsellEnterprise:n=!1,className:r=""}){return e.jsx(Oe,{label:e.jsx(i,{...w.enterpriseRequiredMessage}),side:"top",sideOffset:4,disabled:!n,className:"max-w-5xl",children:e.jsxs(ns,{className:b(n&&"text-token-text-tertiary","max-w-4xl",r),children:[e.jsxs(rs,{className:"flex items-center gap-3",children:[e.jsx(i,{...t}),n&&e.jsx("span",{className:"rounded-xl bg-token-main-surface-tertiary px-2 pb-0.5 text-sm",children:e.jsx(i,{...w.enterpriseUpsellPill})})]}),s&&e.jsx(ls,{className:"py-2 text-token-text-secondary",children:e.jsx(i,{...s})}),a]})})}function Ss({workspaceId:t,label:s,setting:a,defaultValue:n,values:r,disabled:l=!1}){const c=O(),x=ae(),m=F(),{variables:u,mutate:T}=ie({mutationFn:({setting:g,value:h})=>W.safePost("/accounts/{account_id}/settings/share_settings",{parameters:{path:{account_id:t}},requestBody:{setting:g,value:h}}),onSettled:()=>{m.invalidateQueries({queryKey:["workspace-settings"]}),m.invalidateQueries({queryKey:["workspace"]})},onError:()=>{x.danger(c.formatMessage(w.featureSettingsUpdateFailed))}});return e.jsxs(os,{children:[e.jsx("p",{className:"text-md inline-flex items-center",children:e.jsx(i,{...s})}),e.jsxs(y.Root,{defaultValue:u?.value??n,onValueChange:g=>{T({setting:a,value:g})},disabled:l,children:[e.jsxs(y.Trigger,{className:"text-md focus-visible:border-none",children:[e.jsx(y.Value,{}),e.jsx(y.Icon,{})]}),e.jsx(y.Portal,{children:e.jsx(y.Content,{children:r.map((g,h)=>e.jsx(y.Item,{className:"text-md",value:g.value,children:e.jsx(i,{...g.display})},h))})})]})]})}function Ps({workspaceId:t,value:s,upsellEnterprise:a=!1}){const n=O(),r=ae(),l=F(),{variables:c,mutate:x}=ie({mutationFn:({value:m})=>W.safePost("/accounts/{account_id}/settings/third_party_gpts",{parameters:{path:{account_id:t}},requestBody:{value:m}}),onSettled:()=>{l.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{r.danger(n.formatMessage(w.featureSettingsUpdateFailed))}});return e.jsxs(y.Root,{defaultValue:c?.value??s,onValueChange:m=>{x({value:m})},children:[e.jsxs(y.Trigger,{className:"border border-token-border-light text-base focus-visible:border-token-border-light",children:[e.jsx(y.Value,{}),e.jsx(y.Icon,{})]}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{children:[e.jsx(y.Item,{className:"text-base",value:V.ALLOW_ALL,children:e.jsx(i,{...w.allowAllOption})}),!a&&e.jsx(y.Item,{className:"text-base",value:V.ALLOW_SPECIFIC,children:e.jsx(i,{...w.ownerApprovedOnlyOption})}),e.jsx(y.Item,{className:"text-base",value:V.ALLOW_NONE,children:e.jsx(i,{...w.dontAllowOption})})]})})]})}function Ms({workspaceId:t,data:s}){const a=O(),n=ae(),r=be(),l=F(),[c,x]=p.useState([]),m=ie({mutationFn:({value:f})=>W.safePost("/accounts/{account_id}/settings/allowed_custom_actions_domains",{parameters:{path:{account_id:t}},requestBody:{domains:f}}),onSettled:()=>{l.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{n.danger(a.formatMessage(w.featureSettingsUpdateFailed))}});if(r==null)return null;const u=r.isTeam(),T=e.jsx(X,{title:w.thirdPartyGPTsTitle,description:w.thirdPartyGPTsDescription,className:"border-b border-token-border-light pb-4",children:e.jsx("div",{children:e.jsx(Ps,{workspaceId:t,value:s.allow_third_party_gpts,upsellEnterprise:u})})}),g=e.jsx(X,{title:w.sidebarTitle,children:e.jsx(Ts,{account:r,showThirdParty:!u&&s.allow_third_party_gpts===V.ALLOW_SPECIFIC})}),h=s.allowed_custom_actions_domains!=null||s.beta_settings.workspace_gpt_custom_actions===!1;return e.jsxs(ts,{className:"max-w-5xl",children:[u&&T,u&&r.isOwnerOfAccount()&&g,u&&e.jsx(as,{}),e.jsx(X,{title:w.sharingSettingsTitle,upsellEnterprise:u,children:e.jsxs(is,{children:[e.jsx(Ss,{workspaceId:t,label:w.gptSharingTitle,disabled:u,setting:Ne.GPT_SHARE_SETTINGS,defaultValue:s.share_settings.gpt_share_setting,values:[{display:w.anyOneSelect,value:Z.ANYONE},{display:w.workspaceMembersOnlySelect,value:Z.WORKSPACE_ONLY},{display:w.inviteOnlySelect,value:Z.NO_ONE}]}),e.jsxs("div",{className:"flex flex-col gap-4 py-6",children:[e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(i,{id:"ugI3Yt",defaultMessage:"GPT actions"})}),e.jsx("div",{className:"py-2 text-sm text-token-text-secondary",children:e.jsx(i,{id:"HY2eof",defaultMessage:"GPT actions allow GPTs to call third-party APIs for tasks such as retrieving or modifying data. GPT actions are defined by GPT builders, and you can limit the domains that can be used for GPTs created in your workspace."})}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx(te,{checked:!h,id:"allow-all-domains",onChange:f=>{f.currentTarget.checked?(x(s.allowed_custom_actions_domains),m.mutate({value:null})):m.mutate({value:c??[]})},label:e.jsxs("span",{className:"flex flex-row items-center",children:[e.jsx(i,{id:"WnWoqJ",defaultMessage:"Allow all domains for GPT actions"}),e.jsx(_e,{sideOffset:4,interactive:!0,delayDuration:0,label:e.jsx(i,{id:"KjJtEm",defaultMessage:"Limit the Internet domains that can be used by GPTs created in your workspace. This does not apply to third-party GPTs."}),side:"top",children:e.jsx(Qe,{})})]})}),m.isPending&&e.jsx(ee,{})]}),h&&e.jsx(ps,{value:s.allowed_custom_actions_domains??[],title:a.formatMessage({id:"YetDcq",defaultMessage:"Domains"}),onChange:f=>{m.mutate({value:f})},emptyMessage:a.formatMessage({id:"rFH4IP",defaultMessage:"No domains added. No GPT actions will be allowed."})})]})]})}),!u&&T,!u&&r.isOwnerOfAccount()&&g]})}function Cs({currentWorkspaceId:t}){const{data:s,isLoading:a}=Ce(t),n=O();return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{children:e.jsx("title",{children:n.formatMessage(w.sidebarTitle)})}),e.jsx(Ke,{title:n.formatMessage(w.sidebarTitle)}),e.jsx(Ye,{showSpinner:a,children:s===void 0?null:e.jsx(Ms,{workspaceId:t,data:s})})]})}const w=K({sidebarTitle:{id:"workspaceSettingsOld.sidebarTitle",defaultMessage:"GPTs"},allowAllOption:{id:"workspaceSettingsOld.allowAllOption",defaultMessage:"Allow all"},ownerApprovedOnlyOption:{id:"workspaceSettingsOld.ownerApprovedOnlyOption",defaultMessage:"Owner-approved only"},dontAllowOption:{id:"workspaceSettingsOld.dontAllowOption",defaultMessage:"Don't allow"},retentionPolicyTitle:{id:"workspaceSettingsOld.retentionPolicyTitle",defaultMessage:"Retention policy"},thirdPartyGPTsTitle:{id:"workspaceSettingsOld.thirdPartyGPTsTitle",defaultMessage:"Third-party"},thirdPartyGPTsDescription:{id:"workspaceSettingsOld.thirdPartyGPTsDescription",defaultMessage:"Manage whether members can use GPTs created outside your workspace."},customActionsTooltip:{id:"workspaceSettingsOld.customActionsTooltip",defaultMessage:"Allow GPTs to use third-party services for tasks such as finding flights. Actions are defined by GPT builders."},searchTooltip:{id:"workspaceSettingsOld.searchTooltip",defaultMessage:"Web search allows ChatGPT and GPTs to answer questions on recent topics. When enabled, it may send search queries and general location information to Bing, but this data is not linked to or associated with user accounts."},customActionsOptionTitle:{id:"workspaceSettingsOld.pluginsOptionTitle.0",defaultMessage:"Custom actions"},appearanceTitle:{id:"workspaceSettingsOld.appearanceTitle",defaultMessage:"Appearance"},sharingSettingsTitle:{id:"workspaceSettingsOld.sharingSettingsTitle",defaultMessage:"Sharing"},gptSharingTitle:{id:"workspaceSettingsOld.gptSharingTitle",defaultMessage:"GPTs can be shared with..."},chatSharingTitle:{id:"workspaceSettingsOld.chatSharingTitle",defaultMessage:"Chats can be shared with..."},workspaceMembersOnlySelect:{id:"workspaceSettingsOld.workspaceMembersOnlySelect",defaultMessage:"Workspace members only"},anyOneSelect:{id:"workspaceSettingsOld.anyOneSelect",defaultMessage:"Anyone"},inviteOnlySelect:{id:"workspaceSettingsOld.inviteOnlySelect",defaultMessage:"Invite only"},featureSettingsUpdateFailed:{id:"workspaceSettingsOld.featureSettingsUpdateFailed",defaultMessage:"Failed to update feature setting"},conversationRetention:{id:"workspaceSettingsOld.conversationRetention",defaultMessage:"Chat retention"},retentionInfinite:{id:"workspaceSettingsOld.retentionInfinite",defaultMessage:"Infinite"},retentionNinetyDays:{id:"workspaceSettingsOld.retentionNinetyDays",defaultMessage:"90 days"},retentionOneYear:{id:"workspaceSettingsOld.retentionOneYear",defaultMessage:"1 year"},retentionCustomDays:{id:"workspaceSettingsOld.retentionCustomDays",defaultMessage:"{num} days"},retentionChange:{id:"workspaceSettingsOld.retentionChange",defaultMessage:"Contact your account manager to change this setting."},enterpriseUpsellPill:{id:"workspaceSettingsOld.enterpriseUpsellPill",defaultMessage:"Enterprise"},retentionSettingTooltip:{id:"workspaceSettingsOld.retentionSettingTooltip",defaultMessage:"Contact your account manager to change this setting"},enterpriseRequiredMessage:{id:"workspaceSettingsOld.enterpriseRequiredMessage",defaultMessage:"Only workspaces with the Enterprise plan can change these settings"},shareRecipientTitlePrivate:{id:"workspaceSettingsOld.shareRecipientTitlePrivate",defaultMessage:"Private"},shareRecipientTitleLink:{id:"workspaceSettingsOld.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettingsOld.shareRecipientTitlePublic",defaultMessage:"Public"}}),gt=Ae(function(){const s=cs();return ds(),e.jsx(Cs,{...s})});export{gt as default};
//# sourceMappingURL=cvgt4hofatln625n.js.map

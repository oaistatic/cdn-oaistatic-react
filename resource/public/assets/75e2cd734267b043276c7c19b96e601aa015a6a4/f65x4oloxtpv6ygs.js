const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/d5w1bu22kdzjwxzr.js","assets/l6lryjpkt8rv0lpy.js","assets/dvllb5fed1b4y7k1.js","assets/mnkup87aq6tfilq5.js","assets/root-lwz5toux.css","assets/conversation-small-ga20ijz2.css","assets/llh8t5ckv1lpc2n1.js","assets/4wfwbvmzqu7tbfmg.js","assets/1e3kywkhcjn5spyo.js","assets/cbms2jcglp4b707f.js","assets/jnjzqafy9dn7o7ce.js","assets/hli3paxjs6c9ftyy.js","assets/h30lmxihx79lh0e9.js","assets/k0r4nt4e0ngxvcib.js","assets/pc32gvx0zuzynmfl.js","assets/lpa0sb8hkyi7pmml.js","assets/b389eodcyywjf70s.js","assets/d5dy8hf2mc7pg2ry.js","assets/kr5ujwnfvcgoxrdb.js","assets/isfhv24v7f07hfar.js"])))=>i.map(i=>d[i]);
import{bh as L,gj as F,aF as U,a6 as I,d as B,bk as W,dg as T,bT as Q,h as V,gk as E,bl as $,bm as X,aw as G,dT as Y,cR as q,c2 as Z,dY as J,u as K,ea as ee,I as se}from"./mnkup87aq6tfilq5.js";import{R as te,a as ae,r as a,j as e,M as k,c as ne}from"./l6lryjpkt8rv0lpy.js";import{eT as re,eU as ie,cC as oe,eV as ce,eW as le,eX as u,eY as de,aj as ue,d1 as w,ar as fe,ae as me,P as Se,eZ as xe,cB as be,U as H,e_ as ge,e$ as ye,f0 as he,f1 as z,f2 as ve}from"./dvllb5fed1b4y7k1.js";import{D as R,G as pe,S as je}from"./llh8t5ckv1lpc2n1.js";import{u as Ce,H as Ie}from"./c8arge5d7l8vmb3f.js";import{N as Ne}from"./4wfwbvmzqu7tbfmg.js";const _=V({unableToLoadHistory:{id:"history.unableToLoad",defaultMessage:"Unable to load history"},retryButton:{id:"history.retryButton",defaultMessage:"Retry"}});function De({activeId:s,hideOverflowMenu:o}){const c=ae(),[n,r]=a.useState(!1),[l,d]=a.useState(0),f=F(),[h,S]=a.useState(!1),i=re(),v=ie(),{conversations:p,hasNextPage:j,fetchNextPage:N,isLoading:m,isFetchingNextPage:M,isError:D}=oe({}),x=a.useRef(null),O=a.useCallback(t=>{m||t==null||(x.current?.disconnect(),x.current=new IntersectionObserver(A=>{A[0].isIntersecting&&j&&N()}),x.current.observe(t))},[m,j,N]);a.useEffect(()=>()=>{x.current?.disconnect()},[]),a.useMemo(()=>{U.publish({kind:"refreshHistory",conversations:p})},[p]);const C=p;a.useEffect(()=>{const t=ce(le(),Date.now());f(()=>{d(l+1)},t+1e3)},[l,f]);const b=C.length===0;u.markStart("History",u.NS_SIDEBAR),I()?.data!=null&&!m&&u.markRendered("History",u.NS_SIDEBAR);const P=Ce(C,l),g=i!=null&&i.kind==="conversation"&&i.gizmoId!=null&&de(i.gizmoId),y=a.useRef(0);return e.jsxs(Ee,{$centered:m||D||b,onDragOver:t=>{t.preventDefault(),g&&S(!0)},onDrop:t=>{t.preventDefault(),g&&(y.current=0,S(!1),v({newGizmoId:null,conversation:i.conversation,previousGizmoId:i.gizmoId??null}))},onDragEnter:t=>{t.preventDefault(),g&&(y.current+=1)},onDragLeave:t=>{t.preventDefault(),g&&(y.current-=1,y.current===0&&S(!1))},className:B(h&&"opacity-50"),children:[b&&m&&e.jsx(W,{children:e.jsx(T,{className:"m-auto"})}),b&&D&&e.jsxs("div",{className:"p-3 text-center italic text-token-text-tertiary",children:[e.jsx(k,{..._.unableToLoadHistory}),!n&&e.jsx("div",{className:"mt-1",children:e.jsx(Q,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{r(!0),ue(c)},children:e.jsx(k,{..._.retryButton})})})]}),!m&&!b&&e.jsx("div",{children:e.jsx(Ie,{activeId:s,bucketedItems:P,hasNextPage:j,items:C,infiniteScrollTriggerElementRef:O,hideOverflowMenu:o})}),M&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(T,{})})]})}const Te=te.memo(De),Ee=L.div`flex flex-col gap-2 text-token-text-primary text-sm mt-5 first:mt-0
${({$centered:s})=>[s&&"h-full justify-center items-center empty:hidden"]}`;function ke({currentGizmoId:s}){const o=w(),c=I(),{data:{gizmos:n}={}}=fe();let r=n;o&&(r=n?.filter(f=>!me(f.resource))),u.markStart("GizmoSidebarList",u.NS_SIDEBAR),r!==void 0&&u.markRendered("GizmoSidebarList",u.NS_SIDEBAR);const l=E("2152104812","hide_gpts_if_none",!1),d=E("2152104812","hide_default_gpts",!1);return c?l&&n?.length===0?!d&&e.jsx(R,{isNewConversation:!0}):e.jsxs(e.Fragment,{children:[!d&&e.jsx(R,{isNewConversation:!0}),e.jsx(pe,{gizmo:r??[],currentGizmoId:s,maxToShowOnLoad:7})]}):null}const He=$(()=>X(()=>import("./d5w1bu22kdzjwxzr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19])).then(s=>s.FannyPackAction));function ze({clientThreadId:s}){const o=K(s);I();const{isUnauthenticated:c}=G(),n=ee(s),r=se(),l=w(),[d,f]=a.useState(!1),h=a.useCallback(i=>i===z.Snorlax?d:!1,[d]),S=a.useCallback((i,v)=>{i===z.Snorlax&&f(v)},[]);return e.jsx(ve,{value:{isSidebarFlyoutOpen:h,onSidebarFlyoutOpenChange:S},children:e.jsxs("div",{className:"group/sidebar",children:[!c&&e.jsx(ke,{currentGizmoId:n}),null,l&&e.jsx(je,{currentGizmoId:n}),null,null,!c&&e.jsx(Te,{activeId:r?void 0:o})]})})}function Ae({clientThreadId:s}){const{isUnauthenticated:o}=G();return o?null:e.jsx(ze,{clientThreadId:s})}function Le({className:s,onNewThread:o}){const c=ne(),n=Y(),r=q(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:l}=Se(),d=xe();return e.jsxs("div",{className:B("flex",r?.visible&&r.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[e.jsx(Z,{sideOffset:4,label:c.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),className:"flex",side:"right",children:e.jsx(be,{className:"no-draggable","aria-label":c.formatMessage({id:"e7SzX9",defaultMessage:"Close sidebar"}),onClick:()=>{J(n)?H.toggleNavSidebar():H.togglePopoverNavSidebar()},icon:d?ge:ye,mobileIcon:he,"data-testid":"close-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[l&&e.jsx(He,{}),e.jsx(Ne,{onClick:o,testId:"create-new-chat-button"})]})]})}export{Ae as C,ke as G,Te as H,Le as S};
//# sourceMappingURL=f65x4oloxtpv6ygs.js.map

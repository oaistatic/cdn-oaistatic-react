import{f as _,r as b,j as P,l as a}from"./cs2gapsc2bulabhw.js";import{bk as R,ai as B,gh as N,aa as O,co as I,bb as m,e as p,aJ as A,aG as G,cx as y,e_ as d,cd as j,cP as z,ab as W,a6 as U}from"./eb6xg52mym6rhnsh.js";import{cB as V,cC as J,cj as K,cD as L,cE as Q,cF as X,cG as Y}from"./pduvb49qgyq1mqhk.js";import{I as q}from"./f3ceh929le7g5gef.js";const k=(...e)=>t=>e.some(l=>l(t)),M=({allGroupedMessages:e})=>e.some(t=>t.type===d.Browsing||t.type===d.RetrievalBrowsing||t.type===d.ParallelBrowsing),w=({allGroupedMessages:e})=>e.some(t=>t.type===d.SearchGPTQuery),H=({allGroupedMessages:e})=>e.some(t=>t.type===d.Text&&t.messages[0]?.metadata?.followup_prompts?.length),S=({allGroupedMessages:e})=>e.some(t=>t.type===d.CodeInterpreter);function Z(e){return!e||!e.instructions?"":typeof e.instructions=="string"?e.instructions:e.instructions.filter(t=>typeof t=="string").join("")}const T={"Didn't fully follow instructions":{tag:"Didn't fully follow instructions",label:a({id:"Rdlt9V",defaultMessage:"Didn't fully follow instructions"})}},$=[{match:k(M,w),tag:"Shouldn't have searched the web",label:a({id:"kL047b",defaultMessage:"Shouldn't have searched the web"})},{match:H,tag:"Don't like the followups",label:a({id:"xAFgPE",defaultMessage:"Don’t like the suggested follow ups"})},{match:k(M,w),tag:"Don't like the source it cited",label:a({id:"OWjzGX",defaultMessage:"Don't like the sources it cited"})},{match:S,tag:"Shouldn't have run code",label:a({id:"53w4ay",defaultMessage:"Shouldn't have run code"})},{match:S,tag:"Couldn't handle my file",label:a({id:"EkFTQ5",defaultMessage:"Couldn't handle my file"})},{match:({allGroupedMessages:e})=>e.some(t=>t.type===d.Dalle),tag:"Shouldn't have created an image",label:a({id:"S8FRsr",defaultMessage:"Shouldn't have created an image"})},{match:({allGroupedMessages:e})=>e.some(t=>{if(t.type!==d.Text)return!1;const l=t.messages[0],{content:n}=l;return n.content_type===I.Text&&j(l).match(/^```[\S]+\n/gm)}),tag:"Code was incorrect",label:a({id:"4EBdQk",defaultMessage:"Code was incorrect"})},{match:({systemContent:e})=>Z(e).includes("Personality")??!1,tag:"Too chatty or casual",label:a({id:"ATzJKW",defaultMessage:"Too chatty or casual"})},{match:({isBusinessWorkspace:e})=>e,tag:"File upload not working as expected",label:a({id:"Pv0EgM",defaultMessage:"File upload not working as expected"})},{match:({isBusinessWorkspace:e,hasCaConnection:t})=>e&&t,tag:"Should have triggered Internal knowledge",label:a({id:"DJc0pt",defaultMessage:"Should have triggered Internal knowledge"})},{match:({features:e})=>e.includes(z.Sunshine),tag:"Shouldn't have used Memory",label:a({id:"yfUEiz",defaultMessage:"Shouldn't have used Memory"})},{tag:"Don’t like the personality",label:a({id:"6Yz27f",defaultMessage:"Don’t like the personality"})},{tag:"Don't like the style",label:a({id:"nGxjdj",defaultMessage:"Don't like the style"})},{tag:"Not factually correct",label:a({id:"Ke7JtQ",defaultMessage:"Not factually correct"})},{...T["Didn't fully follow instructions"],match:({isBusinessWorkspace:e})=>!e},{tag:"Refused when it shouldn't have",label:a({id:"2yRS/Q",defaultMessage:"Refused when it shouldn't have"})},{match:({isBusinessWorkspace:e})=>!e,tag:"Being lazy",label:a({id:"14MPmT",defaultMessage:"Being lazy"})},{tag:"Unsafe or problematic",label:a({id:"02pXBl",defaultMessage:"Unsafe or problematic"})},{tag:"Biased",label:a({id:"pK35DW",defaultMessage:"Biased"})},{tag:"Other",label:a({id:"WiIGE+",defaultMessage:"Other"})}],ee=[{tag:"I disagree with the policy",label:a({id:"oKyDLz",defaultMessage:"I disagree with the policy"})},{tag:"This didn't violate the policy",label:a({id:"7fUkVF",defaultMessage:"This didn't violate the policy"})},{tag:"I don't understand the policy",label:a({id:"4Cdp6N",defaultMessage:"I don't understand the policy"})},{tag:"This didn't take the full context",label:a({id:"vnZJDP",defaultMessage:"This didn't take the full context"})}],te=[{tag:"Shouldn't have triggered Internal knowledge",label:a({id:"ILVpD8",defaultMessage:"Shouldn't have triggered Internal knowledge"})},{tag:"I specified what data to use and it was wrong",label:a({id:"ziFYwZ",defaultMessage:"I specified what data to use and it was wrong"})},{tag:"Missing relevant Internal knowledge",label:a({id:"PobbBn",defaultMessage:"Missing relevant Internal knowledge"})},{tag:"Inaccurate information",label:a({id:"HbcEAV",defaultMessage:"Inaccurate information"})},{tag:"Response not relevant or helpful",label:a({id:"k2/tlU",defaultMessage:"Response not relevant or helpful"})},{...T["Didn't fully follow instructions"]},{tag:"I don't like the model tone",label:a({id:"PT9XqK",defaultMessage:"I don't like the model tone"})}];function ae(e,t,l){return t.filter(n=>!n.match||n.match(l)).map(n=>({value:n.tag,label:e.formatMessage(n.label)}))}function se(e){const t=X(e);return t!=null&&(t.errCode===y.ContentPolicy||t.errCode===y.ContentOrTos)}function de({clientThreadId:e,conversationMessage:t,currentModelId:l,allGroupedMessages:n}){const C=_(),F=R()??[],o=t.clientMetadata?.rating,c=B()?.isWorkspacePlan()??!1,u=V(),h=J(),r=b.useMemo(()=>h&&n.some(s=>s.type!==N&&s.messages?.some(K)),[n,h]),g=L()??!1,f=O(e,s=>W.findNode(s,i=>i.message.author.role===U.System&&i.message.content.content_type==="system_content")),v=f?.message.content.content_type===I.SystemContent?f?.message.content:null,D=b.useCallback(s=>{const i=m(e);i&&(s.tags.length===0&&!s.textFeedback||(p.logEvent(s.source==="inline"?"Message Feedback Inline Submitted":"Message Feedback Dialog Submitted",{id:t.id,threadId:i,tags:s.tags,content:s.textFeedback,model:l,rating:o}),A.logEvent(s.source==="inline"?"chatgpt_feedback_inline_submitted":"chatgpt_feedback_dialog_submitted",s.tags?.[0]??null,{id:t.id,threadId:i,tag:s.tags?.[0]??"",content:s.textFeedback??"",model:l,rating:o??"",...g?{isCaTriggered:String(r)}:{}}),o&&(c&&u?Q({rating:Y(o),text:s.textFeedback,tags:s.tags,tag_choices:s.tagChoices},i,t.id):c||G.submitMessageFeedback({message_id:t.id,conversation_id:i,rating:o,text:s.textFeedback,tags:s.tags,tag_choices:s.tagChoices}))))},[e,t.id,l,g,c,r,u,o]),x=()=>{p.logEvent("Message Feedback More Options Clicked",{id:t.id,threadId:m(e),model:l,rating:o})},E=ae(C,se(t)?ee:r?te:$,{allGroupedMessages:n,features:F,currentModelId:l,systemContent:v,isBusinessWorkspace:c,hasCaConnection:g});return o==="thumbsUp"?null:P.jsx(q,{tagOptions:E,onSubmit:D,onMoreClicked:x})}export{de as default};
//# sourceMappingURL=jo7jtgpsehqnlvog.js.map

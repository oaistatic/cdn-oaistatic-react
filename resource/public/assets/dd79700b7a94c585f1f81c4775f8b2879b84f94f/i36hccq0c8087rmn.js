import{r as p,j as f,f as d}from"./cs2gapsc2bulabhw.js";import{bL as T,s as g,N as l,a9 as M,cd as C}from"./eb6xg52mym6rhnsh.js";import{CoTChunks as x}from"./mr6s3so6dp7a57ua.js";import{C as u}from"./fmwxh0ltx5kcz6xh.js";import"./oe3vdo8nwau2d3cp.js";import"./pduvb49qgyq1mqhk.js";import"./od9e6kpswbmmrkkx.js";import"./j0zvljvurep0tkuq.js";import"./do5nmvaddt7ak8xi.js";import"./e95x0gs5di7mq1tw.js";import"./msransmxvuas3w3d.js";import"./ls88si7tay0ysj3s.js";import"./f2cwocui2o4rh90z.js";import"./ggve90in2x9hqouv.js";import"./c4jo9vhmn844acg2.js";import"./iop0mej0v36g33vx.js";import"./pc2givv05uuq8g6l.js";import"./ltl83crjtn7g9n8e.js";import"./fb2gj4fu6zbut62o.js";import"./kmvt5g0oz7ekj3ft.js";import"./ec6jcwftshefgs7y.js";import"./flul5lgejanvmzis.js";import"./kvmheozf1dv1rz41.js";import"./m4uwihyvndo7xd88.js";import"./dijlyyo6bxi7y1gl.js";import"./fm8x6rikk7wmsjrt.js";import"./oeue9sgf06niyskm.js";import"./isvebwen77ppsppm.js";import"./pm0gb7r9jflnjr23.js";import"./mqwhn0zqom5s9tn7.js";import"./h86cr3c8dmjcpsff.js";import"./o0c2m6gntt3um3fq.js";const _=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),s=t%60;return`${n}m ${s}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},k=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},y=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:_(e,n)}):T(t)?.metadata?.finished_text??"",E=(e,t,n=!1)=>{const s=[];let o={type:u.Thought,thought:{summary:"",content:""}};const i=()=>{o.thought.content.trim()&&(s.push(o),o={type:u.Thought,thought:{summary:o.thought.summary,content:""}})},a=e.split(/( {2}\n)|(\n\n)/).filter(c=>c!=null&&c.trim());if(!n&&a.length<2)return s;let m=!1;for(let c=0;c<a.length;c++){const r=a[c].trim();if(r.toLowerCase()==="none"){g.count(l.COT_SUMMARIZER,"num_none_chunks");continue}const h=r.match(/^\*\*(.*)\*\*$/);if(h)i(),o.thought.summary=h[1]??"";else if(r){if(r.startsWith("```")){if(m){o.thought.content+=o.thought.content?`
${r}`:r,i(),m=!1;continue}i(),m=!0}o.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!m&&i(),o.thought.content+=o.thought.content?`
${r}`:r}}return o?.thought.content.trim()&&s.push(o),n&&t&&s.push({type:u.Recap,content:t}),s},R=(e,t,n)=>{const s=!n,o=p.useMemo(()=>E(e,t,s),[e,t,s]);return p.useEffect(()=>{s&&g.hist(l.COT_SUMMARIZER,"num_cot_chunks",void 0,o.length)},[s]),o},I=({isStreaming:e,finishedText:t,summaryText:n})=>{const s=R(n,t,e);return f.jsx(x,{isStreaming:e,chunks:s})},N=8,O=`

`,ct=({messages:e,isStreaming:t})=>{const n=d(),{value:s}=M("1214379119"),o=k(e);let i="";return e.forEach(a=>{const m=C(a);i+=i?O+m:m}),s&&!t&&!i&&o<N?null:f.jsx(I,{finishedText:y(n,e,o),summaryText:i,isStreaming:t})};export{I as LegacyCoT,ct as LegacyCoTMessage};
//# sourceMappingURL=i36hccq0c8087rmn.js.map

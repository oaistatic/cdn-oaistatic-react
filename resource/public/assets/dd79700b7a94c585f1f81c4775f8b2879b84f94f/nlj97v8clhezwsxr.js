const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/f1dlw4u4i5pptbdw.js","assets/cs2gapsc2bulabhw.js","assets/pduvb49qgyq1mqhk.js","assets/eb6xg52mym6rhnsh.js","assets/root-o1pc79my.css","assets/conversation-small-ggtqjiqs.css","assets/kxt6geibw3s8fgif.js","assets/g3jqky7dwq9n9122.js","assets/evvu5p17v4x30nfh.js","assets/ec6jcwftshefgs7y.js","assets/f2cwocui2o4rh90z.js","assets/do5nmvaddt7ak8xi.js","assets/e95x0gs5di7mq1tw.js","assets/ggve90in2x9hqouv.js","assets/epqkr08njby1t19h.js"])))=>i.map(i=>d[i]);
import{g as Qe,f as W,j as e,M as P,r as f,a5 as Y,d as Pn,a6 as Ie,am as Za,p as er,u as Nl,q as Pl,L as Tl,o as Bl,c as Ll,D as Fl}from"./cs2gapsc2bulabhw.js";import{u as dt,e as tr}from"./f2cwocui2o4rh90z.js";import{oD as Ca,kJ as Il,kK as sr,kH as Ct,ac as Xe,e7 as Dl,eJ as Tn,cP as Bn,nB as nr,cQ as ys,dF as Ol,ux as Ln,uy as Fn,uz as Hl,nL as lt,hX as Gt,ky as zt,uA as Cs,nT as xn,eX as Ts,uB as In,uC as Dn,dx as On,oy as Hn,dy as Un,oA as Ul,rN as Wt,i2 as Et,uD as or,uE as mt,kz as ae,lM as Gl,rW as zl,d as ws,kE as Sn,is as Z,fi as Wl,na as _s,hi as Gn,bd as ar,kI as zn,ef as rr,mt as Vl,t5 as ir,uF as ql,bu as Ht,uG as Kl,uH as $l,hZ as Yl,uI as Ql,uJ as Xl,uK as Jl,uL as Zl,uM as ec,pA as dn,uN as wa,uO as tc,uP as sc,X as Re,uQ as nc,uR as oc,sZ as mn,B as Wn,im as lr,io as cr,os as ac,qr as rc,es as ic,uS as lc,iS as cc,iU as uc,kx as be,uT as dc,st as Ut,uU as mc,ms as pc,uV as fc,uW as F,uX as ur,uY as gc,uZ as hc,u_ as xc,u$ as Sc,v0 as bc,v1 as yc,v2 as vc,v3 as Cc,v4 as wc,v5 as _c,v6 as jc,v7 as kc,v8 as Mc,v9 as Rc,va as Ac,vb as Ec,vc as Nc,vd as Pc,ve as Tc,vf as Bc,vg as Lc,bA as Vt,gw as Fc,vh as Ic,vi as Dc,vj as Oc,vk as Hc,nN as gs,H as ke,A as ue,vl as dr,ff as bn,iu as Rt,dU as D,fe as Bs,iK as Vn,mm as Uc,bQ as At,fg as Ls,kG as mr,fh as Fs,vm as Gc,vn as Is,ba as zc,vo as Wc,pg as Vc,z as qn,vp as qc,h8 as vt,e as pr,vq as Kc,vr as $c,nS as yn,kD as Yc,nz as Qc,k2 as Ds,vs as Xc,nb as fr,nd as Jc,vt as Zc,vu as eu,pn as tu,vv as su,vw as nu,gx as ou,c$ as au,G as Os,hw as ru,vx as iu,b5 as lu,eD as cu,eh as gr,vy as qt,vz as Ke,vA as Kn,vB as he,vC as uu,vD as du,vE as ut,vF as mu,j1 as _a,vG as pu,c5 as wt,vH as $n,vI as hr,f6 as fu,sz as Hs,vJ as xr,fj as Sr,kg as Yn,ro as gu,vK as hu,vL as br,rw as xu,vM as Su,sx as Qn,vN as yr,fy as bu,vO as yu,vP as vu,vQ as Cu,fb as wu,vR as _u,eO as ju,vS as ku,vT as Mu,vU as Ru,x as Xn,vV as Au,vW as js,nM as Eu,qY as Nu,E as Jn,aa as Pu,vX as vr,n$ as Tu,vY as Bu,vZ as Lu,v_ as Fu,iF as Le,c4 as Zn,v$ as Iu,w0 as Du,w1 as Ou,iH as ks,kp as Cr,w2 as Hu,w3 as Uu,w4 as Gu,f5 as zu,w5 as wr,nZ as Us,iI as Wu,w6 as Vu,lN as xe,w7 as qu,w8 as Ku,w9 as $u,wa as Yu,wb as _t,wc as _r,wd as Qu,we as Xu,p1 as Ju,wf as Zu,hM as ed,wg as td,wh as sd,wi as nd,wj as od,wk as ad,wl as rd,wm as id,wn as ld,wo as cd,wp as ud,wq as dd,wr as md,ws as pd,wt as fd,wu as gd,wv as hd,ww as xd,wx as Sd,wy as bd,wz as yd,wA as vd,jg as Cd,o4 as jr,iG as De,wB as wd,wC as _d,qK as jd,h as kd,fw as eo,wD as Md,wE as kr,wF as Mr,wG as Rr,wH as Ar,wI as Dt,kL as Rd,wJ as Ad,mF as Er,mE as Nr,wK as Ed,wL as Nd,wM as Pd,wN as Td,wO as Bd,kw as to,jX as Pr,wP as vn,eG as Ld,eH as Fd,wQ as Ms,eI as Tr,eK as Id,wR as Br,eL as Dd,iJ as Od,rU as Lr,wS as Cn,wT as Hd,wU as Ud,en as Gd,wV as zd,fB as Wd,fC as Vd,nu as so,wW as Fr,ea as qd,wX as Kd,wY as $d,wZ as Yd,w_ as ja,w$ as Qd,x0 as Ir,x1 as Xd,x2 as Jd,x3 as Zd,hh as Dr,x4 as Or,x5 as Hr,x6 as em,nR as tm,x7 as wn,x8 as sm,eV as nm,b6 as om,kA as am,cC as rm,x9 as im,ce as lm,xa as cm,se as um,xb as dm,xc as mm,xd as pm,xe as fm,xf as gm,kq as hm,xg as xm,xh as ka,jB as Sm,lg as bm,xi as pn,xj as ym,lS as vm,xk as Cm,xl as wm,xm as _m,lm as jm,xn as km,xo as Mm,cg as Rm,ch as Am,xp as Em,Y as Nm,U as Ma,fd as Pm,cL as Ur,m3 as Tm,m8 as Bm,sb as Lm,xq as Fm,xr as Im,xs as Dm,xt as Om,xu as Hm,eF as Um,xv as Ra,xw as Aa,xx as Ea,l$ as Gm,xy as zm,xz as Wm,xA as Vm,xB as qm,xC as Km,xD as $m,dA as Ym,gE as Qm,o2 as Xm,xE as Jm,gS as Zm,ny as ep,ji as tp,sc as sp,oS as fn,np as gn,xF as np,jh as op}from"./pduvb49qgyq1mqhk.js";import{e as B,hO as Gs,F as no,f as ye,dw as Gr,j as Je,am as ve,dx as Rs,aF as M,dz as oo,hP as Na,gT as ao,aS as Fe,aT as _n,t as zr,B as jt,c as U,ai as Ze,hQ as ap,aa as oe,k as Wr,cW as kt,l as Vr,h7 as ge,aV as Mt,ab as se,hr as rp,cd as ip,hR as qr,aQ as ct,hS as lp,cY as Kr,aE as Ye,a9 as Me,cy as Pa,bV as cp,b0 as up,dO as $r,aw as dp,ba as mp,ay as $e,dV as Yr,O as ro,_ as io,aB as vs,h as Qr,cV as jn,a5 as pp,c$ as fp,aC as Se,c1 as lo,hT as gp,em as Xr,bk as Jr,b6 as hp,q as xp,b as kn,d as Sp,an as Zr,gS as co,hU as ei,gO as Mn,L as Kt,eC as $t,hV as uo,eq as ti,G as si,gA as As,eD as mo,cP as bp,dc as ni,bQ as Yt,d6 as yp,aJ as vp,u as Rn,a6 as oi,cf as Cp,dB as ai,c8 as wp,hW as _p,b4 as jp,aU as Ta,ag as hs,hX as Ba,p as kp,b2 as Mp,ac as ri,cS as Rp,c2 as Ap,bE as Ep,bU as Np,g$ as Pp,ev as Tp,bb as Ot,bd as La,hY as Bp,hZ as Lp,h_ as Fp,c_ as Ip,eN as Dp,s as Op,N as Hp,gi as Up,gj as Gp,fy as zp,h$ as Wp}from"./eb6xg52mym6rhnsh.js";import{e as Vp,b as zs,u as po,P as qp,f as Kp,g as $p,h as Yp}from"./bzo48ft2wb6beuij.js";import{u as Qp}from"./otrhg4fwlde4g25l.js";import{b as Xp}from"./epqkr08njby1t19h.js";import{G as ii}from"./c1w85nn5shpnb9e0.js";import{b as li}from"./kmvt5g0oz7ekj3ft.js";import{d as Jp,e as Zp,c as ef}from"./fb2gj4fu6zbut62o.js";import{F as ci,a as fo,P as go,B as ui,C as ho,g as tf,V as sf,b as nf,T as of}from"./7u88g4wa9fostszz.js";import{e as af,f as rf,h as xs,i as lf,P as cf,j as uf}from"./do5nmvaddt7ak8xi.js";import{u as xo}from"./l9t7qwwrq1pkwdh1.js";import{u as di,a as df,I as mf,R as pf,b as Fa,C as ff,H as Ia,B as gf,F as Da,c as hf,T as xf,S as Sf,d as Oa,e as bf}from"./ec6jcwftshefgs7y.js";import"./h71lg9jejkufcc57.js";function mi({clientThreadId:t,getInputProps:s,openFileDialog:n,uploadType:o,icon:a,isDisabled:i=!1,isSmall:r=!1,showLabel:u=!1,showUpsell:l=!1,hideBorder:c=!1,highlightTooltip:d=!1,disabledReason:m,currentModelName:p,visualTreatment:x}){const h=W(),g=Gs();i=(i||!!g)&&!l;const y=e.jsxs(Il,{disabled:i,$showLabel:u,$hideBorder:c,$isSmall:r,$visualTreatment:x,onClick:j=>{if(j.preventDefault(),l){B.logNoAuthAttachButtonClicked({location:"No auth upsell"});return}B.logEvent("Open File Viewer",{intent:o.toString()}),n()},"aria-label":i?m===Ct.ModelNotSupported?h.formatMessage({id:"pEB4vw",defaultMessage:"Attachments disabled for {modelName}"},{modelName:`${p}`}):m===Ct.ThinkModeInUse?h.formatMessage({id:"NRk4QL",defaultMessage:"Attachments disabled for Reason mode"}):m===Ct.SearchModeInUse?h.formatMessage({id:"YlO80p",defaultMessage:"Attachments disabled for Search mode"}):h.formatMessage({id:"PromptFilePicker.attachFilesUnavailable",defaultMessage:"Attach files is unavailable"}):h.formatMessage({id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"}),children:[a,u&&e.jsx(sr,{})]}),b=e.jsx("input",{disabled:i,...s({className:"hidden"})}),_=e.jsxs("div",{className:"flex",children:[y,b]});return l?e.jsx(Xe,{label:e.jsx(P,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:d||void 0,children:e.jsx(Dl,{triggerButton:_,sideOffset:0,alignOffset:0,children:e.jsx(Tn,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"})})}):e.jsx(ci,{disabled:i,clientThreadId:t,rateLimitPopup:g,highlightTooltip:d,children:_})}function yf({code:t,message:s}){switch(t){case Ca.FileTooLarge:return Ha.errorFileTooLarge;case Ca.TooManyFiles:return B.logEvent("Uploaded Max Files Error"),Ha.errorTooManyFiles;default:return s}}const Ha=Qe({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."},getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"}}),Ua=Qe({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function vf(t){if(!t.accept||Object.keys(t.accept).length===0)return[];const s=[];return Object.values(t.accept).forEach(n=>s.push(...n)),s.sort()}function px(t){const{className:s,children:n,clientThreadId:o,currentModelConfig:a,noKeyboard:i}=t,r=W(),u=Je(),l=Gt(o),c=zt(),d=Cs(a,l,c),m=d!==lt.None,p=xn(E=>E.files),x=(d===lt.Multimodal?Ln:Fn)-p.length,h=x<=0,{getGizmoId:g}=Ts(),{handleFileAccepted:y}=bo(r,d,Dn(a,l),"drag",g,In(a,l)?.attachments),b=Gs(),_=On(Hn(a,l)),{getRootProps:j,isDragActive:R}=xo({maxFiles:x,disabled:!m||h||b!=null,noClick:!0,noKeyboard:i,onDropAccepted:y,onDropRejected:E=>So(E,r,u,d),multiple:!0,maxSize:Un,..._}),k=vf(_);return e.jsxs("div",{...j({className:s}),children:[n,R&&e.jsxs(Cf,{children:[e.jsx(Ul,{}),e.jsx("h3",{children:e.jsx(P,{...Ua.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:k.length>0?k.join(", "):e.jsx(P,{...Ua.dragAllAccepted})})]})]})}function So(t,s,n,o){const{errors:a}=t[0];a.forEach(i=>{const r=yf(i);typeof r=="string"?n.danger(r,{hasCloseButton:!0}):n.danger(s.formatMessage(r,{size:Hl,maxNum:o===lt.Multimodal?Ln:Fn}),{hasCloseButton:!0})})}function bo(t,s,n,o,a,i){const r=ye(),u=Gr(r).flags,l=Je(),c=Bn(),d=nr(),{isUnauthenticated:m}=ve(),p=u?.includes(Rs.NoAuthEnableFileUploads);return{handleFileAccepted:f.useCallback(async(h,g)=>{B.logEvent("Upload File",{client:"web",eventSource:o,intent:s.toString()}),d.fileUploadAccepted();const y=a!=null?await a():void 0;h.length>0&&h.forEach(b=>{ys.uploadFile(c,Ol(b),b,s,n,t,l,{gizmoId:y,...p&&{isUnauthenticated:m}},i)})},[o,s,a,c,d,n,t,l,i,p,m])}}const Cf=no.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`,wf=({clientThreadId:t})=>{"use forget";const s=ye(),{activeSystemHints:n}=Wt(t),o=Et(),a=or(t),i=n.some(x=>x.systemHint===M.Slurm)&&(o.size===0||o.has(M.Slurm)),r=oo(s,"463092697").value,l=!!r?.softmentionEnabled&&i,{connectedTypes:c}=Vp({enabled:l}),{filteredKeywords:d,connectorToKeywordsMap:m,keywordsConnectorMap:p}=f.useMemo(()=>{const x=r?.connectorConfig||{},{keywordSet:h,connectorToKeywordsMap:g,keywordsConnectorMap:y}=Object.entries(x).reduce((b,[_,j])=>{if((j.enabledModels&&a?j.enabledModels.includes(a.id):!0)&&c.has(_)){const k=j?.keywords||[];b.connectorToKeywordsMap[_]=k,k.forEach(E=>{b.keywordSet.add(E),b.keywordsConnectorMap[E]=_})}return b},{keywordSet:new Set,connectorToKeywordsMap:{},keywordsConnectorMap:{}});return{filteredKeywords:l?Array.from(h):[],connectorToKeywordsMap:l?g:{},keywordsConnectorMap:l?y:{}}},[r?.connectorConfig,c,a,l]);return{enabled:l,keywords:d,connectorToKeywordsMap:m,keywordsConnectorMap:p}},_f=({clientThreadId:t,composerController:s})=>{const{addSource:n,deleteSource:o,selectedSources:a}=mt(t),i=Et(),{setThreadSystemHintMode:r}=ae(),{keywords:u,connectorToKeywordsMap:l,keywordsConnectorMap:c}=wf({clientThreadId:t});f.useEffect(()=>{s.resetTrackingKeywords(u)},[s,u]);const d=f.useRef(i);f.useEffect(()=>{const x=d.current;d.current=i,x.has(M.Slurm)&&i.size===0&&s.removeKeywordDecorations(s.getKeywords())},[i,s]);const m=f.useRef(a);f.useEffect(()=>{const x=m.current;if(m.current=a,!x)return;const h=Array.from(x).filter(y=>!(a??new Set).has(y)),g=[];h.forEach(y=>{g.push(...l[y]??[])}),s.removeKeywordDecorations(g)},[s,l,a]);const p=f.useRef([]);f.useEffect(()=>{const x=g=>{if(p.current.length===0&&g.length>0&&i.size===0){const _={clientThreadId:t};r(M.Slurm,!0,_)}const y=g.filter(_=>!p.current.includes(_)),b=p.current.filter(_=>!g.includes(_));y.forEach(_=>n(_)),b.forEach(_=>o(_)),p.current=g},h=()=>s.getKeywords().map(g=>c[g]);return x(Na(h())),s.subscribe("change",()=>{x(Na(h()))})},[n,t,s,o,c,i.size,r])},jf=({clientThreadId:t})=>{const{availableConnectorTypes:s}=kf({clientThreadId:t}),{deleteSource:n}=mt(t),o=f.useRef(s);f.useEffect(()=>{[...o.current].filter(a=>!s.has(a)).forEach(a=>{n(a)}),o.current=s},[s,n])},kf=({clientThreadId:t})=>{"use forget";const{availableConnectors:s}=zs(),{connectorConfigMap:n}=pi({clientThreadId:t}),{availableConnectors:o}=po(),a=Et(),i=f.useRef(new Set);return{availableConnectorTypes:f.useMemo(()=>{const u=new Set(s.map(c=>c.type).filter(c=>c!==ao.MCP_CONNECTOR&&(!n.has(c)||!n.get(c)?.disabled))),l=new Set(o.map(c=>c.type));return a.has(M.Research)?i.current=l:a.has(M.Slurm)&&(i.current=u),i.current},[o,s,a,n])}},pi=({clientThreadId:t})=>{"use forget";const s=ye(),n=or(t),o=W(),a=oo(s,"463092697").value;return{connectorConfigMap:f.useMemo(()=>{const r=a?.connectorConfig||{};return Object.entries(r).reduce((u,[l,c])=>{const d=l,m=c.enabledModels&&n?!c.enabledModels.includes(n.id):!1;return u.set(d,{disabled:m,disabledText:m?o.formatMessage({id:"Fk33UU",defaultMessage:"Switch to {model} model to use beta connectors"},{model:c.enabledModels.join(", ")}):void 0,hasBetaTag:c.beta}),u},new Map)},[n,o,a?.connectorConfig])}},Mf=({clientThreadId:t,currentModelId:s,isCompletionInProgress:n,composerController:o})=>{const a=Gl(),i=Et(),r=o.useState(y=>y.getSystemHint()),u=Fe(t);_f({clientThreadId:t,composerController:o}),jf({clientThreadId:t});const l=f.useMemo(()=>i.size>0?Array.from(i):r?[r]:[],[r,i]),c=f.useRef(n);f.useEffect(()=>{c.current=n},[n]);const d=f.useCallback(y=>{c.current?_n(t,b=>{b.conduitToken=null,b.prepareState=null}):_n(t,b=>{b.conduitToken=y,b.prepareState="success"})},[t]),m=f.useRef(null);m.current=()=>zl(t,s,l,d);const p=f.useCallback(()=>m.current?.(),[]),x=f.useCallback(ws(()=>p(),5e3,{leading:!0,trailing:!0}),[]),h=f.useRef(!1),g=zr();return f.useEffect(()=>{if(g){if(!h.current){h.current=!0;return}p()}},[g,t,s,l,u?.effortMode]),f.useEffect(()=>{x.cancel()},[n,x]),f.useEffect(()=>o.subscribe("change",()=>{n||a&&x()}),[n,o,x,a]),null},Rf=({className:t,children:s})=>e.jsx(Y.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Af({canContinue:t,onContinueGenerating:s}){const n=f.useCallback(a=>{s(a),Sn()},[s]);let o=null;return t&&(o=e.jsx(Nf,{onHandleContinueGenerating:n})),o&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:o})}function Ef({className:t}){return e.jsx(Wl,{className:U("-rotate-180",t)})}const Nf=({onHandleContinueGenerating:t})=>e.jsx(Rf,{children:e.jsx(jt,{as:"button",color:"secondary",onClick:t,className:"py-2 whitespace-nowrap",icon:Ef,size:"small",children:e.jsx(P,{...Z.continueGenerating})})}),fi=({clientThreadId:t,rateLimitInfo:s,onDismiss:n,onInteract:o,onMount:a})=>{const{name:i,title:r,call_to_action:u,description:l}=s,c=Ze(),d=_s(!0),{updateSystemHint:m}=ae(),p=dt(),x=_s(!1),h=ap(),g=oe(t,se.getIsNewConversation),y=c?.planType??"unknown",b=Gn(),_=h&&"block_reason"in h?h.block_reason:null,j="banner_description",R=f.useMemo(()=>({type:i||"unknown",location:j,plan_type:y,is_new_conversation:g,is_hard_block:!!h,hard_block_reason:_??"",call_to_action:u}),[i,j,y,g,h,_,u]),k=Pn(),E=ar(),w=ye(),C=!Wr(w),A=zn(),T=rr(kt.signUpButtonText),L=Vl({clientThreadId:t}),O=Vr(w,"1368081792"),H=V=>{switch(V){case ge.AUTHENTICATE:return{text:A?kt.logInButtonText:T,onClick:()=>{E({authType:A?"login":"signup",callback:z=>{A?B.logLogInButtonClicked({location:`Rate limit banner - ${i}`,provider:z}):B.logSignUpButtonClicked({location:`Rate limit banner - ${i}`,provider:z})}})}};case ge.AUTHENTICATE_SECONDARY:return{text:A?T:kt.logInButtonText,onClick:()=>{E({authType:A?"signup":"login",callback:z=>{A?B.logSignUpButtonClicked({location:`Rate limit banner - ${i}`,provider:z}):B.logLogInButtonClicked({location:`Rate limit banner - ${i}`,provider:z})}})}};case ge.GET_PLUS:return{text:it.getPlusButton,onClick:()=>{B.logRateLimitGetPlusButtonClicked(R),C?E({authType:A?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:z=>{A?B.logLogInButtonClicked({location:"Rate limit banner Get Plus upsell",provider:z}):B.logSignUpButtonClicked({location:"Rate limit banner Get Plus upsell",provider:z})}}):Ht(k,"Prompt textarea rate limit banner")}};case ge.NEW_CHAT:return{text:it.newChatButton,onClick:()=>{d({modelId:"",location:j})}};case ge.PAID_USER_O3_MINI_HIGH:{const z=se.getCurrentLeafId(Fe(t)),J=()=>{B.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:O.get("should_change_model_picker",!0)?"In-context upsell o3-mini-high for Plus banner - Try it button":"In-context upsell o3-mini-high for Plus (no model switch) banner - Try it button",eventProperties:R}),O.get("should_change_model_picker",!0)&&x({modelId:"o4-mini-high",location:"In-context upsell o4-mini-high for Plus banner - Try it button"}),L({sourceEvent:new Event("click"),nodeId:z,requestedModelId:"o4-mini-high"})};return{text:it.tryItButton,onClick:J}}case ge.FREE_USER_O3_MINI_HIGH:return{text:it.getPlusButton,onClick:()=>{B.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Free banner - Get Plus button",eventProperties:R}),Ht(k,"Prompt textarea in-context upsell banner")}};case ge.DEEP_RESEARCH_IN_CONTEXT_UPSELL:{const z=se.findNode(Fe(t),ee=>rp(ee.message)),J=z?ip(z.message):void 0;return{text:it.tryItButton,onClick:()=>{B.logEventWithStatsig("In Context Upsell Banner Deep Research CTA Clicked","chatgpt_in_context_upsell_banner_deep_research_cta_clicked",{location:"In-context upsell deep research - Try it button",eventProperties:R}),m(M.Research,{clientThreadId:t}),p.focus(),p.setText(J??"")}}}case ge.GET_PRO:return{text:it.getProButton,onClick:()=>{B.logRateLimitUpgradePlanButtonClicked({...R,upgrade_plan_tye:"pro"}),C?E({authType:A?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:z=>{A?B.logLogInButtonClicked({location:"Rate limit banner Get Pro upsell",provider:z}):B.logSignUpButtonClicked({location:"Rate limit banner Get Pro upsell",provider:z})}}):Ht(k,"Prompt textarea rate limit banner")}};case ge.TRY_CODEX:return{text:it.tryCodexButton,onClick:()=>{B.logEventWithStatsig("In Context Upsell Banner Codex CTA Clicked","chatgpt_in_context_upsell_banner_codex_cta_clicked",{location:"In-context upsell codex - Try Codex button",eventProperties:R}),k("/codex")}};default:return}};ir(()=>{!O.get("should_change_model_picker",!0)&&R.type==="o3-mini-high-in-context-upsell-plus"&&(R.type="o3-mini-high-in-context-upsell-plus-no-model-switch"),B.logRateLimitBannerShown(R),a?.()});const[S,I]=u??[];let K=I;S===ge.AUTHENTICATE&&b&&(K=ge.AUTHENTICATE_SECONDARY),Mt(w,"2861925050");let N={};return N={primaryAction:H(S),secondaryAction:H(K)},e.jsx(ql,{onDismiss:n,title:r,description:l,actions:N,onInteract:o})},it=Qe({getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"},getProButton:{id:"Pl8/Vk",defaultMessage:"Get Pro"},newChatButton:{id:"7OvnJ5",defaultMessage:"New chat"},tryItButton:{id:"zPDzun",defaultMessage:"Try it"},tryCodexButton:{id:"KcWniZ",defaultMessage:"Try Codex"}}),Pf=({clientThreadId:t,composerController:s})=>{const n=qr(),o=ct(s.store,h=>h.rateLimitBannerFeature),a=lp(),i=n??Tf(o,a),r=oe(t,se.getRequestId),u=oe(t,se.getCurrentLeafId),l=Kr(r),{layer:c}=Ye("1368081792"),d=i?.name?()=>{switch(i.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":Kl(u);break}}:void 0,{value:m}=Me("3612584454");f.useEffect(()=>{l&&!(i?.name==="gpt-4l"&&m)&&(Pa.dismissBanner(),s.setRateLimitBannerFeature(null))},[l,i?.name,m,s]);const p=i?.is_dismissible?()=>{B.logEventWithStatsig("Rate Limit: Dismiss Banner","chatgpt_rate_limit_banner_dismissed",{type:!c.get("should_change_model_picker",!0)&&i?.name==="o3-mini-high-in-context-upsell-plus"?"o3-mini-high-in-context-upsell-plus-no-model-switch":i?.name}),Pa.dismissBanner(),s.setRateLimitBannerFeature(null)}:void 0,x=()=>{switch(i?.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":$l({interactedInPeriod:!0});break}};return e.jsx(Ie,{children:i&&e.jsx(Y.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(fi,{clientThreadId:t,rateLimitInfo:i,onDismiss:p,onInteract:x,onMount:d})})})};function Tf(t,s){const n=s.find(o=>o.name===t);return n?{name:n.name,title:n.title,description:n.description,is_dismissible:!0,call_to_action:n.call_to_action,resets_after:n.resets_after}:null}function Bf(t,s,n,o,a,i,r,u,l,c,d,m){if(l||(t.name==="o3-mini-high-in-context-upsell-free"||t.name==="o3-mini-high-in-context-upsell-plus")&&(s.some(j=>j.model_slug==="o3-mini-high")||n.id==="o3-mini-high")||u&&r&&dn(Date.now(),r)<wa)return!1;const x=o==null||dn(Date.now(),o)>=tc,h=a===c,g=r==null||i==null||dn(Date.now(),r)>=wa||i<sc;if(!(x&&g||h))return!1;switch(t.name){case"deep-research-in-context-upsell":return d("should_show_deep_research_upsell_banner",!1);case"deep-research-in-context-upsell-free":return d("should_show_deep_research_upsell_banner_free",!1);case"o3-mini-high-in-context-upsell-free":return d("should_show_o3_mini_high_upsell_banner_free_user_to_plus",!1);case"o3-mini-high-in-context-upsell-plus":return d("should_show_o3_mini_high_upsell_banner_plus_user",!1);case"codex-in-context-upsell":return m("should_show_codex_upsell_banner",!1);default:return!1}}function Lf(t,s){const n=cp(),o=Yl(t),a=oe(t,se.getRequestId),i=oe(t,se.getCurrentLeafId),r=Kr(a),u=qr(),l=Ql(b=>b.lastSeenInContextUpsellBannerAt),c=Xl(b=>b.inContextUpsellBannerPeriodExposureCount),d=Jl(b=>b.inContextUpsellBannerPeriodStartAt),m=Zl(b=>b.inContextUpsellBannerLastSeenId),p=ec(b=>b.inContextUpsellBannerInteractedInPeriod),{layer:x}=Ye("1368081792"),{layer:h}=Ye("1738106734"),g=ct(s.store,b=>b.rateLimitBannerFeature);let y=!1;switch(u?.name){case null:case void 0:y=g!=null;break;case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":y=Bf(u,n,o,l,m,c,d,p,r,i,x.get,h.get);break;default:y=!0}return!r&&y}const Es="month",gi="year";function Ff(){const t=up(),s=W(),n=Je(),{markAsViewed:o}=Re(nc),{initialBillingDetails:a}=Qp(t,!0),i=f.useMemo(()=>({...t?.subscriptionAnalyticsParams,referrer:document.referrer}),[t]);async function r(){try{await ac(t?.features??[],s,n,a,i)}catch{}}const{shouldShowBanner:u,discountValue:l,discountDuration:c}=oc();if(f.useEffect(()=>{u&&l&&c&&mn.logShowReferrerRedemptionBanner()},[u,l,c]),!u||!l||!c)return null;const d=If(s,a,l,c),m=Df(s,a,l,c),p=e.jsxs("div",{className:"grow",children:[e.jsx("div",{className:"mb-0.5 font-semibold",children:d}),e.jsx("span",{className:"text-token-text-secondary",children:m})]});return e.jsx(Wn,{onPrimaryCtaClick:()=>{o(),mn.logClickReferrerRedeemButton(),r()},primaryCtaText:e.jsx(P,{id:"referrerRedemptionBannerPrimaryCta",defaultMessage:"Get Plus"}),onDismiss:()=>{o(),mn.logCloseReferrerRedemptionBanner()},content:p})}function If(t,s,n,o){const{currencySymbol:a}=lr(cr(),s.currency),i=o?o.period:Es,r=o?o.num_periods:1,u=a.code.defaultMessage?.toString()??$r,l=t.formatNumber(n.value,{style:"currency",currency:u,minimumFractionDigits:0,maximumFractionDigits:2});let c;return i===Es?c=r===1?e.jsx(P,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}}):i===gi&&(c=r===1?e.jsx(P,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}})),c}function Df(t,s,n,o){const{currencySymbol:a}=lr(cr(),s.currency),i=o?o.period:Es,r=o?o.num_periods:1,u=a.code.defaultMessage?.toString()??$r,l=t.formatNumber(n.value,{style:"currency",currency:u,minimumFractionDigits:0,maximumFractionDigits:2});let c;return i===Es?c=r===1?e.jsx(P,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used — claim your free month of Plus."}):e.jsx(P,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:l,num_months:r}}):i===gi&&(c=r===1?e.jsx(P,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:l,num_years:r}})),c}const An=window.sessionStorage,En=dp(mp(()=>({memoryFullBannerDismissed:!!An?.getItem($e.MemoryFullBannerDismissed)}))),hi={dismissBanner(){En.setState(t=>{t.memoryFullBannerDismissed=!0}),An?.setItem($e.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){En.setState(t=>{t.memoryFullBannerDismissed=!1}),An?.removeItem($e.MemoryFullBannerDismissed)}};function Of(t){const s=Yr(t),n=cc(),{data:o}=uc(s,!1,n),a=o!=null,i=a&&o.memoryFullPct>=100,[r,u]=f.useState(!1);f.useEffect(()=>{!i&&a&&(u(!0),hi.clearDismissedBanner())},[i,a]);const l=En(c=>c.memoryFullBannerDismissed);return i&&r&&!l}function Hf(){const t=W(),{openSettings:s}=rc();return e.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Wn,{title:t.formatMessage(Ss.memoryFullTitle),content:t.formatMessage(Ss.memoryFullTooltip,Ss.memoryFullTooltip.values),primaryCtaText:t.formatMessage(Ss.memoryManageButton),onPrimaryCtaClick:()=>s(ic.Personalization),onDismiss:()=>hi.dismissBanner()})})}const Ss=Qe({memoryFullTitle:{id:"i1hV1R",defaultMessage:"ChatGPT's out of space for saved memories"},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"Rs+Att",defaultMessage:"New memories won’t be added until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:lc,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),Uf=ro(()=>io(()=>import("./f1dlw4u4i5pptbdw.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.JawboneNotificationsBanner)),xi=f.memo(function({className:s}){const{store:n}=be(),o=n.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:U(s??"absolute start-0 end-0 bottom-full",mc.PromptTextareaHeader),children:e.jsx(dc,{shouldRender:o,contentArea:Ut.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(Gf,{}),e.jsx(zf,{})]})})})});function Gf(){const{store:t}=be(),s=t.useSharedProps(u=>u?.clientThreadId),n=t.useContentAreaId(Ut.HeaderTop),o=pc(),a=oe(s,u=>u?.modelId),i=fc.useStore();let r;switch(n){case F.ProjectConversationTaskNoFileAccess:r=e.jsx(Kf,{});break;case F.AdvancedVoiceOnMobileAnnouncement:r=e.jsx(Nc,{clientThreadId:s});break;case F.S09KM1:r=null;break;case F.BannerSignup:r=e.jsx(qf,{});break;case F.BannerTermsDisclaimer:r=e.jsx($f,{});break;case F.PromptTextareaAction:r=e.jsx(Yf,{});break;case F.BannersRateLimit:r=e.jsx(Qf,{});break;case F.BannerSidekickAnnouncement:r=e.jsx(Ec,{});break;case F.SearchBrowserExtensionAnnouncement:r=e.jsx(Ac,{});break;case F.MoonshineAnnouncement:r=e.jsx(Rc,{});break;case F.CustomizeChatGPTAnnouncement:r=e.jsx(Mc,{});break;case F.SearchBrowserExtensionReactiveAnnouncement:r=e.jsx(kc,{});break;case F.BannerMemoryFull:r=e.jsx(Hf,{});break;case F.Box:r=e.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case F.JawboneAnnouncement:o?r=e.jsx(Uf,{}):r=null;break;case F.JawboneMaxActiveAnnouncement:o?r=e.jsx(jc,{}):r=null;break;case F.PromoRedemptionAnnouncement:r=e.jsx(qp,{});break;case F.OperatorAnnouncement:r=e.jsx(_c,{});break;case F.BannerPlusUpsell:r=e.jsx(wc,{});break;case F.ContextualAnswersAdminUpsell:r=e.jsx(Cc,{});break;case F.ContextualAnswersUserUpsell:r=e.jsx(vc,{});break;case F.ReferrerRedemptionAvailableAnnouncement:r=e.jsx(Ff,{});break;case F.RefereeRedemptionAvailableAnnouncement:r=e.jsx(yc,{});break;case F.ReferralProgramUpsellAnnouncement:r=e.jsx(bc,{});break;case F.StudentsUpsellAnnouncement:r=e.jsx(Sc,{});break;case F.ModelDeprecationBanner:r=xc(a);break;case F.TeamsContextualAnswersUpsell:r=e.jsx(hc,{});break;case F.KanziConfig:r=!1;break;case F.LanguageUpsellBanner:r=e.jsx(gc,{onDismissSideEffect:()=>{B.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),i.closeBanner()},onPrimaryCtaClickSideEffect:()=>{B.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),i.closeBanner()}});break;default:r=null;break}return r}function zf(){const{store:t}=be(),s=t.useContentAreaId(Ut.HeaderBottom);let n;switch(s){case ur.DallePromptControls:n=e.jsx(Vf,{});break;default:n=null;break}return n}const Wf=ro(()=>io(()=>import("./g3jqky7dwq9n9122.js"),__vite__mapDeps([7,1,2,3,4,5])).then(t=>t.default));function Vf(){const{store:t}=be(),s=t.useSharedProps(n=>n?.composerController);return s?e.jsx(Wf,{composerController:s}):null}function qf(){const{store:t}=be(),s=t.useSharedProps(a=>a?.clientThreadId),n=zn(),o=Tc();return s?n?e.jsx(Bc,{threadId:s,showSignUp:o}):e.jsx(Lc,{threadId:s,showLogin:o}):null}function Kf(){return f.useEffect(()=>()=>{vs.getItem($e.TasksHasSeenProjectDisclaimerBanner)||vs.setItem($e.TasksHasSeenProjectDisclaimerBanner,!0)},[]),e.jsx(Wn,{icon:e.jsx(Vt,{}),title:e.jsx(P,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:e.jsx(P,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{vs.setItem($e.TasksHasSeenProjectDisclaimerBanner,!0)}})}function $f(){const{store:t}=be(),s=t.useSharedProps(n=>n?.clientThreadId);return s?e.jsx(Pc,{threadId:s}):null}function Yf(){const{store:t}=be(),s=t.useSharedProps();return s?e.jsx(Af,{...s}):null}function Qf(){const{store:t}=be(),s=t.useSharedProps(o=>o?.clientThreadId),n=t.useSharedProps(o=>o?.composerController);return!s||!n?null:e.jsx(Pf,{clientThreadId:s,composerController:n})}const Xf="https://persistent.oaistatic.com/image-gen/nux.222e584e.mp4",yo=()=>Oc($e.HasSeenNoAuthImagegenNux,!1,Hc),fx=()=>{const{isUnauthenticated:t}=ve(),s=Fc(),[n]=yo(),o=Xp(),a=ye(),i=Vr(a,"2118136551");return!t||s||n||o?"hide":i.get("should_show_imagegen_nux",!1)?"show":"hide"},gx=({onClose:t})=>{const n=Ic()?"bottom":"center",o=ar(),[a,i]=f.useState(!1),r=ye(),u=oo(r,"2604379743").value,l=typeof u.nux_video_url=="string"?u.nux_video_url:Xf,c=typeof u.nux_image_url=="string"?u.nux_image_url:"",[,d]=yo(),m=()=>{d(!0),vs.setItem($e.HasSeenNoAuthImagegenNux,!0)},p=zn(),{layer:x}=Ye("2118136551"),h=x.get("sign_up_button_has_the_word_free",!0),g=rr(h?Dc.signUpForFreeCta:kt.signUpButtonText),y=e.jsx(jt,{as:"button",size:"large",color:p?"secondary":"primary",onClick:()=>{m(),o({authType:"signup",callback:j=>{B.logSignUpButtonClicked({provider:j,location:"No Auth Imagegen Nux Modal"})}})},fullWidth:!0,children:e.jsx(P,{...g})}),b=e.jsx(jt,{as:"button",size:"large",color:p?"primary":"secondary",fullWidth:!0,onClick:()=>{m(),o({authType:"login",callback:j=>{B.logLogInButtonClicked({provider:j,location:"No Auth Imagegen Nux Modal"})}})},children:e.jsx(P,{...kt.logInButtonText})}),_=()=>{t(),m(),B.logEventWithStatsig("chatgpt_no_auth_imagegen_nux_modal_dismissed","chatgpt_no_auth_imagegen_nux_modal_dismissed")};return f.useEffect(()=>{B.logEventWithStatsig("chatgpt_no_auth_imagegen_nux_modal_shown","chatgpt_no_auth_imagegen_nux_modal_shown")},[]),e.jsxs(Qr,{testId:"modal-no-auth-imagegen-nux",isOpen:!0,noPadding:!0,onClose:_,showCloseButton:!1,size:"custom",type:"success",className:"max-w-lg",position:n,children:[e.jsxs("div",{className:"relative aspect-3/2 w-full",children:[!a&&e.jsx("img",{src:c,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom transition-opacity duration-300"}),e.jsx("video",{src:l,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"h-full w-full object-cover object-bottom",onLoadedData:()=>i(!0)}),e.jsx("div",{className:"absolute end-4 top-4",children:e.jsx(jn,{onClick:_})})]}),e.jsxs("div",{className:"flex flex-col gap-2 px-8 pt-6 pb-8 text-center",children:[e.jsx("div",{className:"text-xl font-medium",children:e.jsx(P,{id:"OxVK72",defaultMessage:"Bring your ideas to life with images"})}),e.jsx("div",{className:"text-token-text-secondary w-full",children:e.jsx(P,{id:"bVWvdX",defaultMessage:"Create a free account to make illustrations, charts, comics, and more."})}),e.jsx("div",{className:"mt-4 mb-2 flex w-full flex-col gap-3",children:p?[b,y]:[y,b]}),e.jsx(jt,{color:"ghost",className:"text-token-text-secondary font-semibold underline hover:bg-transparent",onClick:_,children:e.jsx(P,{...kt.stayLoggedOut})})]})]})},Jf="https://persistent.oaistatic.com/image-gen/nux.222e584e.mp4",Zf="https://help.openai.com/en/articles/8932459",hx=()=>{const{isLoading:t,eligible:s}=Re(ue.hasSeenShibaHomeNux),{isUnauthenticated:n}=ve(),[o]=yo(),i=Ze()?.isQuorum(),{value:r}=Me("2781425969");return n||!r||o||i?"hide":t?"loading":s?"show":"hide"};function vo(t){return[{title:t.formatMessage({id:"er580q",defaultMessage:"Create an image of a magazine cover of cute animals with headlines and text"}),body:"",type:ke.Autocomplete,prompt:t.formatMessage({id:"SKZKBN",defaultMessage:"Create an image of a photorealistic magazine cover for 'CUTE ANIMALS,' featuring three impossibly cute and stylishly accessorized pets, with realistic, catchy headlines and teaser text"}),theme:gs.Image},{title:t.formatMessage({id:"ukPFbH",defaultMessage:"Create an image for a garden-themed birthday party invitation"}),body:"",type:ke.Autocomplete,prompt:t.formatMessage({id:"uYg5kL",defaultMessage:"Create an image of a colorful invitation for a garden-themed birthday party, including whimsical typography"}),theme:gs.Image},{title:t.formatMessage({id:"mMiJxP",defaultMessage:"Create an image of an astronaut with an inflatable duck on Mars"}),body:"",type:ke.Autocomplete,prompt:t.formatMessage({id:"5nFWh4",defaultMessage:"Create a photorealistic image of an international astronaut on Mars, wearing a giant duck inflatable toy around its waist"}),theme:gs.Image},{title:t.formatMessage({id:"+T7POI",defaultMessage:"Create an image of a tutorial for cooking pasta"}),body:"",type:ke.Autocomplete,prompt:t.formatMessage({id:"9N2bJ0",defaultMessage:"Create an image of a comic-book style tutorial for cooking pasta"}),theme:gs.Image}]}const xx=({onClose:t,clientThreadId:s})=>{const{markAsViewed:n}=Re(ue.hasSeenShibaHomeNux),o=dt(),a=Pn(),i=pp("2604379743").config.value,r=typeof i.nux_video_url=="string"?i.nux_video_url:Jf,u=typeof i.nux_image_url=="string"?i.nux_image_url:"",[l,c]=f.useState(!1),d=dr(o,s),{activeSystemHints:m}=Wt(s),p=m.find(b=>b.systemHint===M.PictureV2);f.useEffect(()=>{B.logEventWithStatsig("chatgpt_imagegen_nux_modal_shown","chatgpt_imagegen_nux_modal_shown")},[]);const x=W(),h=vo(x),g=()=>{n(),t(),B.logEventWithStatsig("chatgpt_imagegen_nux_modal_dismissed","chatgpt_imagegen_nux_modal_dismissed")},y=()=>{n(),t(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{p&&d({hint:p,enable:!0}),o.focus()})}),o.setAutocompletions(h)};return e.jsx(e.Fragment,{children:e.jsxs(Qr,{testId:"modal-imagegen-nux",isOpen:!0,noPadding:!0,onClose:fp,shouldIgnoreClickOutside:!0,showCloseButton:!1,size:"custom",type:"success",className:"max-w-lg",children:[e.jsxs("div",{className:"relative aspect-3/2 w-full",children:[!l&&e.jsx("img",{src:u,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom transition-opacity duration-300"}),e.jsx("video",{src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"h-full w-full object-cover object-bottom",onLoadedData:()=>c(!0)})]}),e.jsxs("div",{className:"flex flex-col gap-2 px-8 pt-6 pb-6 text-center",children:[e.jsx("div",{className:"text-xl font-medium",children:e.jsx(P,{id:"KgZP2O",defaultMessage:"Image creation just got better"})}),e.jsx("div",{className:"text-token-text-secondary w-full",children:e.jsx(P,{id:"/oguus",defaultMessage:"ChatGPT now thinks a little longer to make more accurate and detailed images. <link>Learn more</link>",values:{link:b=>e.jsx("a",{href:Zf,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 no-underline",children:b})}})}),e.jsx("div",{className:"mt-2 w-full text-xs text-[#8F8F8F] dark:text-[#C4C4C4]",children:e.jsx(P,{id:"6pIXUv",defaultMessage:"You must have permission to edit images you upload, including consent from any people in them."})}),e.jsxs("div",{className:"mt-4 flex w-full gap-3",children:[e.jsx(jt,{color:"secondary",onClick:g,className:"flex-1",children:e.jsx(P,{id:"6nf9tD",defaultMessage:"Not now"})}),e.jsx(jt,{color:"primary",onClick:()=>{y(),a("/?model=gpt-4o"),B.logEventWithStatsig("chatgpt_imagegen_nux_modal_continued","chatgpt_imagegen_nux_modal_continued")},className:"flex-1",children:e.jsx(P,{id:"ms5BU0",defaultMessage:"Try it"})})]})]})]})})};function eg({suggestions:t,composerController:s,onSelect:n,onChange:o}){const a=tr(),i=f.useCallback((p,x,h,g)=>{n?.(x,h,g),a(p,x,h,g)},[n,a]),[r,u]=f.useState(()=>t.length>0),[l,c]=f.useState(-1),[d,m]=f.useState(!1);return f.useEffect(()=>{const p=x=>{if(!x.isComposing)if(x.key==="ArrowDown"){const h=l===t.length-1?0:l+1;c(h),o?.(h,!0,t[h])}else if(x.key==="ArrowUp"){x.preventDefault();const h=l<=0?t.length-1:l-1;c(h),o?.(h,!0,t[h])}else x.key==="Enter"&&!x.shiftKey&&t[l]&&i(x,t[l],t,l)};return s.subscribe("keydown",p)},[t,l,o,i,s]),f.useEffect(()=>s.subscribe("blur",()=>{c(-1),u(!1),o?.(-1,!1)}),[s,o]),f.useEffect(()=>s.subscribe("focus",()=>u(!0)),[s]),f.useEffect(()=>{if(!d){const p=()=>{m(!0),window.removeEventListener("mousemove",p)};return window.addEventListener("mousemove",p),()=>{window.removeEventListener("mousemove",p)}}},[d]),f.useEffect(()=>{c(-1),o?.(-1,!1),m(!1)},[t,o]),e.jsx(Y.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:U("w-full flex-col p-2.5 max-lg:flex-col-reverse",r?"flex":"hidden"),children:t.map((p,x)=>e.jsxs(Y.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:x*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[x>0&&e.jsx("div",{className:U("h-[1px] opacity-60 max-lg:hidden",l===x||l===x-1?"bg-token-main-surface-secondary mx-2":"bg-token-border-default")}),e.jsxs("button",{className:U("flex w-full cursor-pointer items-center justify-start rounded-lg px-2.5 py-3 text-start whitespace-pre-wrap",l===x?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:h=>{h.preventDefault(),i(h,p,t,x)},onMouseDown:h=>{h.preventDefault()},onMouseEnter:()=>{d&&(c(x),o?.(x,!1,p))},onMouseLeave:()=>{c(-1),o?.(-1,!1,p)},children:[p.icon?e.jsx("span",{className:"text-token-text-secondary me-2 h-[18px] w-[18px] flex-none",children:p.icon}):null,e.jsx("span",{className:"text-sm whitespace-pre-wrap",children:p.autocompletionChunks&&p.autocompletionChunks.length>0?e.jsx(e.Fragment,{children:p.autocompletionChunks.map((h,g)=>e.jsx("span",{className:U(h.className??(h.isMatched?"text-token-text-tertiary":"text-token-text-primary")),children:h.text},g))}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:U(p.type===ke.Starter||p.type===ke.Trending?"text-token-text-secondary":"text-token-text-tertiary"),children:p.title}),e.jsx("span",{className:"text-token-text-primary",children:p.body})]})})]}),x>0&&e.jsx("div",{className:U("h-[1px] opacity-60 lg:hidden",l===x||l===x-1?"bg-token-main-surface-secondary mx-2":"bg-token-border-default")})]},p.id??x))})}function tg(t,s){t=t.toLocaleLowerCase();const n=s;s=s.toLocaleLowerCase();const o=[];let a=0;for(let u=0;u<s.length&&(a<t.length&&t[a]===s[u]&&(o.push(u),a++),a!==t.length);u++);const i=[];let r=0;if(o.forEach(u=>{if(u>r){const l=n.slice(r,u);l&&i.push({text:l,isMatched:!1})}i.push({text:n[u],isMatched:!0}),r=u+1}),r<s.length){const u=n.slice(r);u&&i.push({text:u,isMatched:!1})}return sg(i)}function sg(t){if(t.length===0)return t;const s=[t[0]];for(let o=1;o<t.length;o++){const a=s[s.length-1],i=t[o];a.isMatched===i.isMatched?a.text+=i.text:s.push(i)}const n=s.filter(o=>o.isMatched).reduce((o,a)=>o+a.text.trim().length,0);return s.length<=4&&n>=2?s:[{text:s.map(o=>o.text).join(""),isMatched:!1}]}const Qt=({pressed:t,disabled:s,icon:n,label:o,ariaLabel:a,animatedLabel:i,showLabel:r,onClick:u,splitButtonDropdownContent:l,showSplitButton:c=!0,dropdownContent:d,dataTestid:m,splitSecondaryButton:p,tooltip:x,as:h="popover"})=>{const[g,y]=f.useState(!1),[b,_]=f.useState(!1),j=Za(),R=!s&&t,k=o&&e.jsx("div",{className:U("[display:var(--force-hide-label)] ps-1 pe-1 whitespace-nowrap"),children:o}),E=e.jsxs("button",{className:U("flex h-full min-w-8 items-center justify-center p-2",{"pe-1.5":!!l}),"data-testid":m,"aria-pressed":t,"aria-label":a,disabled:s,onTransitionEnd:()=>_(!1),onClick:I=>{d||(_(!0),u(I))},children:[n,!i&&r?k:null,i&&e.jsx(Ie,{initial:!1,children:r&&e.jsx(Y.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:j?0:.15},children:k})})]}),w=x?x(E):E,C=g?e.jsx(Uc,{className:"h-[18px] w-[18px]"}):e.jsx(At,{className:"h-[18px] w-[18px]"}),T=j?Rt:{opacity:{delay:.1},default:{type:"tween",duration:.15,ease:"easeInOut"}},L=l||d?h==="popover"?e.jsx(Ls,{children:e.jsx(mr,{className:"p-0",$as:Fs,side:"bottom",align:"start",collisionPadding:10,sideOffset:8,children:d??l})}):e.jsx(D.Portal,{children:e.jsx(D.Content,{children:d??l})}):null,O=h==="popover"?e.jsx(bn,{asChild:!0,children:w}):e.jsx(D.Trigger,{asChild:!0,children:w}),H=h==="popover"?e.jsx(bn,{asChild:!0,children:e.jsx("button",{className:"border-token-border-default border-s p-2",style:{borderColor:R?"#0285FF0D":void 0},disabled:s,children:C})}):e.jsx(Y.div,{initial:{width:0,opacity:0,padding:0},animate:{width:"auto",opacity:1,padding:"0.5rem"},exit:{width:0,opacity:0,padding:0,borderLeft:"unset"},transition:T,style:{overflow:"hidden",border:"unset",borderLeft:"solid 1px",borderColor:R?"#0285FF0D":"var(--border-default)"},children:e.jsx(D.Trigger,{asChild:!0,children:e.jsx("button",{style:{padding:0,backgroundColor:"transparent",height:"100%",borderRadius:"unset",color:R?"var(--interactive-label-accent-default)":void 0},disabled:s,children:C})})}),S=e.jsxs("div",{className:U("radix-state-open:bg-black/10 inline-flex h-9 rounded-full border text-[13px] font-medium",{"duration-75 motion-safe:transition-all":b,"text-token-text-secondary":!t,"text-token-interactive-label-accent-default can-hover:hover:bg-[#BDDCF4] dark:can-hover:hover:bg-[#1A416A] bg-token-composer-blue-bg border-transparent dark:bg-[#2A4A6D] dark:text-[#48AAFF]":!!R,"border-token-border-default can-hover:hover:bg-token-main-surface-secondary focus-visible:outline-black dark:focus-visible:outline-white":!R,"opacity-30":s}),children:[d?O:w,e.jsx(Ie,{children:!d&&l&&c?H:null}),p]});return l||d?h==="popover"?e.jsxs(Bs,{onOpenChange:I=>y(I),children:[e.jsx(Vn,{asChild:!0,children:S}),L]}):e.jsxs(D.Root,{onOpenChange:I=>y(I),children:[S,L]}):S},Ns=M.PictureV2,ng=["o1","o3-mini","o3-mini-high","o1-pro","gpt-4.5","gpt-4-5"];function og({clientThreadId:t,composerController:s,currentModelConfig:n,currentModelConfigLoading:o,disableIfNoAccess:a}){const i=ye(),[r]=er(),u=Ze()?.planType,l=Gc(),c=oe(t,R=>Wc({ctx:i,clientThreadId:t,threadState:R,searchParams:r,planType:u,isModelSticky:!!l})),d=Gt(t),m=d==null||d?.kind===Se.PrimaryAssistant,{isUnauthenticated:p}=ve(),x=!p,h=n?.enabledTools?.includes(lo.ImageGen),g=gp(),y=!!g,b=h&&!o&&c&&!ng.includes(c),_=x&&!0&&m;return!Xr(M.PictureV2)||!(_&&(b||a))?null:e.jsx("div",{"data-testid":"system-hint-picture_v2",style:{viewTransitionName:`var(--vt-composer-${Ns}-action)`},children:e.jsx(ag,{clientThreadId:t,composerController:s,disabled:!!a&&!b||y,imageGenFeatureBlock:g})},`system-hint-${Ns}`)}function ag({clientThreadId:t,composerController:s,disabled:n,imageGenFeatureBlock:o}){const i=Is(s)===Ns,r=W(),u=vo(r),l=Si(r),c=r.formatMessage({id:"av47h4",defaultMessage:"Visualize anything"}),{clearAllSystemHintModeTriggers:d}=ae(),m=g=>{g.stopPropagation(),g.preventDefault(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{d(),i?s.removeSystemHints():s.addSystemHint(Ns,l),s.focus()})}),s.setAutocompletions(u),i?B.logEventWithStatsig("Composer Create Image Button Disabled","composer_create_image_button_disabled",{clientThreadId:t}):B.logEventWithStatsig("Composer Create Image Button Enabled","composer_create_image_button_enabled",{clientThreadId:t})},p=e.jsx(Qt,{pressed:i,icon:e.jsx(zc,{className:"h-[18px] w-[18px]"}),label:l,ariaLabel:l,animatedLabel:!0,showLabel:!0,onClick:m,disabled:!!n,dataTestid:"composer-button-create-image"}),x=o?.title??c,h=o?.description??void 0;return e.jsx(Xe,{className:"inline-block",label:x,secondaryLabel:h,side:"bottom",onOpenChange:g=>{g&&B.logEventWithStatsig("Composer Create Image Button Hovered","composer_create_image_button_hovered",{clientThreadId:t})},children:p})}function Si(t){return t.formatMessage({id:"rh3NHv",defaultMessage:"Create image"})}async function rg(t=8,s=null){const n=await kn.safeGet("/prompt_library/",{parameters:{query:{limit:t,use_v2:!0,model_slug:s}},authOption:Sp.SendIfAvailable});return Zr.addFirstTiming("load.promptStarters"),n}function ig(t=8,s=null){return Pl({queryKey:["promptStarters",t,s],queryFn:()=>rg(t,s)})}function Ga(t){return(Vc(t)?t.promptStarters:t.gizmo.display.prompt_starters)?.map(s=>({type:ke.Starter,title:"",body:s,prompt:s}))}const lg=()=>{const t=ye(),s=hp(t),n=pr(),o=Kc($c),a=Wr(t),i=a?s.getLayer("4031588851"):s.getLayer("3533083032"),r=a?s.getLayer("4031588851",{disableExposureLog:!0}):s.getLayer("3533083032",{disableExposureLog:!0});return a?n==null?!1:Date.now()/1e3-n.created<r.get("new-user-age-seconds",14*24*60*60)&&i.get("web-enable-for-new-users",!1):o<r.get("new-user-message-count",20)&&i.get("web-enable-for-new-users",!1)},bi=({clientThreadId:t,limit:s,shouldBeEnabledForDefaultAssistant:n,isModelLoaded:o,modelSlug:a})=>{const i=dt(),r=Jr(),u=W(),{clearAllSystemHintModeTriggers:l}=ae(),c=oe(t,A=>A?.mode),d=qn(c?.kind===Se.GizmoInteraction?c.gizmo_id:void 0).data,{gizmoEditorData:m,mode:p}=Ts(),x=lg(),h=qc(c),g=Ze(),y=x&&n&&!h&&!g?.isEnterprisey(),{data:b,isSuccess:_}=Nl({...ig(s,a),enabled:y});if(r==null)return{promptStarters:[],isLoading:!0,isSuccess:!1};if(p==="test"&&m)return{promptStarters:Ga(m)??[],isLoading:!1,isSuccess:!0};if(d!=null)return{promptStarters:Ga(d),isLoading:!1,isSuccess:!0};if(!y)return{promptStarters:[],isLoading:!1,isSuccess:!0};const j=b?.items.map(A=>({type:ke.Starter,id:A.id,title:A.title,body:A.description,prompt:A.prompt,category:A.category,oneliner:A.oneliner,theme:A.theme,requires_file_upload:A.requires_file_upload}))??[],R=(A,T,L,O)=>{if(T.type===ke.Starter&&T.category==="dalle"){requestAnimationFrame(()=>{l(),i.addSystemHint(M.PictureV2,Si(u)),i.focus()}),i.setAutocompletions(vo(u));return}const H=T.title;i.setAutocompletions([]),i.focus(),i.setText(H),requestAnimationFrame(()=>{const S=j.filter(I=>I.theme===T.theme).map(I=>{const K=xp(I.oneliner),N=K.startsWith(I.title);return{...I,title:N?`${I.title} `:"",body:N?I.body:K,autocompletionChunks:tg(H,K),type:ke.Autocomplete}});i.setAutocompletions(S),S.length>0&&yn(S,t),Yc(T,O,t)})},k=j?.reduce((A,T)=>(T.theme&&!A[T.theme]&&(A[T.theme]=T),A),{}),E=[];if(k)for(const A in k)A!=="For you"&&E.push(k[A]);const w=E.length>0,C=!!(_&&w&&o);return vt.markStart("StarterPromptChips",vt.NS_COMPOSER),C&&vt.markRendered("StarterPromptChips",vt.NS_COMPOSER),{onSelectStarterPrompt:R,shouldShowStarterPrompts:C,promptStarters:E}};function za({clientThreadId:t,onClick:s}){f.useEffect(()=>{Zc(t)},[t]);const n=W();return e.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(fr,{onClick:()=>{eu(t),s()},label:n.formatMessage(pg.moreStarterPrompts)})})}function cg({starterPrompt:t,starterPrompts:s,index:n,disabled:o,onSelectStarterPrompt:a}){const i=t.theme??t.title,r=tr(),{mutate:u}=Xc(),l=t.category==="onboarding"?c=>{u({key:ue.hasUsedConversationalOnboardingStarterPrompt}),r(c,t,s,n)}:c=>a?.(c,t,s,n);return e.jsx(fr,{disabled:o,onClick:l,icon:e.jsx(Jc,{category:t.category,useV2Colors:!0}),label:i})}const ug=5,dg=3;function yi({starterPrompts:t,onSelectStarterPrompt:s,disabled:n,clientThreadId:o,onExpand:a,mobileLayout:i=!1}){const r=i?dg:ug,[u,l]=f.useState(r),[c,d]=f.useState(!1),m=f.useRef(null),p=t.length<=u;f.useEffect(()=>{yn(t.slice(0,r),o)},[o]),f.useEffect(()=>{if(!c&&!p&&m.current){const h=m.current,g=h.getBoundingClientRect(),y=g.width,b=Array.from(h.children);let _=0;for(let j=0;j<b.length&&b[j].getBoundingClientRect().right-g.left<=y;j++)_++;l(_),d(!0)}},[t,p,c]);const x=()=>{const h=t.slice(u,t.length).map(g=>({...g,isAdditional:!0}));h.length>0&&yn(h,o),l(t.length),a()};return e.jsxs("div",{"data-testid":"starter-prompt-chips",className:U("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",c&&t.length>0?"opacity-100":"opacity-[0.01]",i?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:U("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",p||i?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:m,children:[t.slice(0,u).map((h,g)=>e.jsx(Y.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(cg,{starterPrompt:h,starterPrompts:t,index:g,disabled:n,onSelectStarterPrompt:s})},h.id??g)),i&&t.length>u&&e.jsx(za,{clientThreadId:o,onClick:x})]}),!i&&t.length>u&&e.jsx(za,{clientThreadId:o,onClick:x})]})}const Sx=({clientThreadId:t,currentModelId:s,isModelLoaded:n})=>{const[o,a]=f.useState(!1),i=co(),{prospectiveModelId:r}=Ds(t),u=n?s:r??"auto",{promptStarters:l,shouldShowStarterPrompts:c,onSelectStarterPrompt:d}=bi({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t,limit:8,modelSlug:u});return e.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:U(!o&&"h-[116px]"),children:c&&l&&e.jsx(yi,{starterPrompts:l,onSelectStarterPrompt:d,disabled:i,clientThreadId:t,onExpand:()=>a(!0),mobileLayout:!0})})},mg=({currentModelId:t,clientThreadId:s,isModelLoaded:n})=>{const{isUnauthenticated:o}=ve(),[a,i]=f.useState(!1),r=Qc(),u=co(),{prospectiveModelId:l}=Ds(s),c=n?t:l??"auto",{promptStarters:d,shouldShowStarterPrompts:m,onSelectStarterPrompt:p}=bi({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:c});return e.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:U("hidden min-h-[108px] max-w-full",r?"@lg/thread:block":"lg:block",o&&a?"":"h-[70px]"),children:m&&d&&e.jsx(yi,{starterPrompts:d,onSelectStarterPrompt:p,disabled:u,clientThreadId:s,onExpand:()=>i(!0)})})},pg=Qe({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Wa=no.div`m-8 flex flex-col items-center`;function Va(t){return e.jsx(Y.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function fg({clientThreadId:t}){const n=oe(t,a=>a?.promptGptRating)?.gizmoId,{data:o}=qn(n);return n==null||o==null||!tu(o)?null:e.jsx(gg,{gizmoId:n})}function gg({gizmoId:t}){const[s,n]=f.useState(!1),[o,a]=f.useState(!1),i=su(t),r=async l=>{n(!0),setTimeout(()=>{a(!0)},5e3),B.logEvent("Submit Inline Rating",{gizmo_id:t,rating:l}),await i.mutateAsync({rating:l})},u=async()=>{a(!0),B.logEvent("Dismiss Inline Rating",{gizmo_id:t}),await i.mutateAsync({})};return f.useEffect(()=>{o||B.logEvent("Show Inline Rating",{gizmo_id:t})},[o,t]),o?null:s?e.jsx(Wa,{children:e.jsxs(Va,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"border-token-border-heavy rounded-lg border p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(jn,{onClick:()=>{a(!0)}})]})}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(P,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(Wa,{children:e.jsxs(Va,{className:"border-token-border-heavy flex flex-col items-center gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(jn,{onClick:u})]}),e.jsx(nu,{rating:void 0,onRating:r})]})})}const vi=no.div`group flex h-10 items-center gap-2 rounded-lg px-2 hover:bg-token-main-surface-secondary text-sm text-token-text-primary`;function hg(){const{data:t,isLoading:s}=ru({cutId:"recent",limit:8}),{data:n,isLoading:o}=iu();return{isLoading:s||o,recent:t,pinned:n}}function xg({query:t,onSelectGizmo:s,selectedIdx:n},o){const a=ou(),i=f.useRef([]),{isLoading:r,recent:u,pinned:l}=hg();f.useImperativeHandle(o,()=>({handleEnterOnIndex:m=>{if(!d[m])return m<c.length?c[m].resource:"create"},getResultsLength:()=>c.length+1,scrollToItem:m=>{const p=i.current[m];p&&p.scrollIntoView({behavior:"instant",block:"nearest"})}}));let c=[];if(r)return e.jsx("div",{className:"absolute end-4 top-0 flex h-full items-center justify-center",children:e.jsx(Kt,{})});u&&c.push(...u.pages.flatMap(m=>m.list.items).map(m=>({resource:m.resource,from:"recent"}))),l&&c.push(...l.items.map(m=>({resource:m,from:"pinned"}))),c=au(c,m=>m.resource.gizmo.id);const d=c.map(m=>m.resource.gizmo.tags?.includes(Os.WorkspaceDisabled));return t&&t!==""&&(c=c.filter(m=>(m.resource.gizmo.display.name.toLowerCase()+m.resource.gizmo.display.description?.toLowerCase()+m.resource.gizmo.author.display_name?.toLowerCase()).includes(t?.toLowerCase()))),e.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[c.map((m,p)=>e.jsx("div",{ref:x=>{i.current[p]=x},tabIndex:p,onClick:()=>{d[p]||s(m.resource)},children:e.jsx(vg,{gizmoResource:m.resource,from:m.from,showDescription:a,isSelected:n===p,grayedOut:d[p]})},m.resource.gizmo.id)),e.jsx("div",{ref:m=>{i.current[c.length]=m},tabIndex:c.length,onClick:()=>{s("create")},children:e.jsx(bg,{isSelected:n===c.length})},"create")]})}const Sg=f.forwardRef(xg),bg=({isSelected:t})=>e.jsx(vi,{className:t?"bg-token-main-surface-secondary":"",children:e.jsxs(Tl,{to:"/gpts/editor",target:"_blank",className:"flex flex-row space-x-2 font-semibold",children:[e.jsx("span",{className:"self-center",children:e.jsx(gr,{className:"icon-sm"})}),e.jsx("span",{children:e.jsx(P,{...Ci.dropdownCreateLabel})})]})}),yg=({onClick:t,onClose:s})=>{const[n,o]=f.useState(null),a=f.useRef(null),i=f.useRef(null),[r,u]=f.useState(0),l=W(),c=d=>{B.logEvent("Mentions Click Gizmo",{gizmo_id:d==="create"?"create":d.gizmo.id}),d!=="create"&&t(d)};return e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:l.formatMessage(Ci.searchPlaceholder),ref:a,onKeyDown:d=>{if(d.nativeEvent.isComposing)return;const m=i.current?.getResultsLength()??0;if((d.key==="Escape"||d.key==="Backspace"&&!n)&&(d.preventDefault(),s()),d.key==="Enter"||d.key==="Tab"){d.preventDefault();const p=i.current?.handleEnterOnIndex(r);if(!p)return;p==="create"?(window.open("/gpts/editor","_blank"),s()):c(p)}if(d.key==="ArrowDown"&&r<m-1){d.preventDefault();const p=r+1;i.current?.scrollToItem(p),u(p)}if(d.key==="ArrowUp"&&r>0){d.preventDefault();const p=r-1;i.current?.scrollToItem(p),u(p)}},onChange:d=>{o(d.target.value),u(0)},className:"bg-token-main-surface-primary w-full border-0 p-2 text-sm focus:outline-hidden"}),e.jsx(Sg,{ref:i,query:n,selectedIdx:r,onSelectGizmo:c})]})},qa=({onClick:t,onClose:s})=>{const n=ei(),o=!!n;return ir(()=>{B.logEvent("Mentions Opened",{gizmo_selector_disabled:o})}),o?e.jsx(fi,{clientThreadId:Mn,rateLimitInfo:n}):e.jsx("div",{onBlur:a=>{a.currentTarget.contains(a.relatedTarget)||s()},className:"popover border-token-border-default bg-token-main-surface-primary rounded-2xl border p-2 shadow-lg",children:e.jsx(yg,{onClick:t,onClose:s})})};function vg({gizmoResource:t,from:s,showDescription:n,isSelected:o,grayedOut:a}){const i=!!t.gizmo.tags?.includes(Os.FirstParty);return e.jsxs(vi,{className:U(o?"bg-token-main-surface-secondary":"",a&&"opacity-50"),children:[e.jsx(ii,{isFirstParty:i,src:t.gizmo.display.profile_picture_url,className:U("icon-xl h-7 w-7 shrink-0",a&&"grayscale group-hover:grayscale-0")}),e.jsxs("div",{className:"flex h-fit grow flex-row justify-between space-x-2 overflow-hidden text-ellipsis whitespace-nowrap",children:[e.jsxs("div",{className:"flex flex-row space-x-2",children:[e.jsx("span",{className:"shrink-0 truncate font-semibold",children:t.gizmo.display.name}),n&&e.jsx("span",{className:"text-token-text-tertiary grow truncate text-sm sm:max-w-xs lg:max-w-md",children:t.gizmo.display.description})]}),e.jsx("span",{className:"shrink-0 self-center",children:s==="recent"?e.jsx(lu,{className:"icon-sm"}):e.jsx(cu,{className:"icon-sm"})})]})]})}const Ci=Qe({talkingTo:{id:"TaggingDropdown.talkingTo",defaultMessage:"Talking to"},dropdownCreateLabel:{id:"TaggingDropdown.dropdownCreateLabel",defaultMessage:"Create a GPT"},searchPlaceholder:{id:"TaggingDropdown.searchPlaceholder",defaultMessage:"Search recent and pinned GPTs"}});function Cg({systemHint:t,label:s,logo:n,isDisabled:o=!1,composerController:a,analyticsMetadata:i,onClick:r,showLabel:u=!1,splitButtonDropdownContent:l,showSplitButton:c,dropdownContent:d,dataTestid:m,tooltip:p,as:x}){const{name:h,systemHint:g}=t,y=g,{setThreadSystemHintMode:b,clearAllSystemHintModeTriggers:_}=ae(),j=qt(y),R=!!t.composerBarButtonInfo?.upsell,k=Ke.useStore(),E=zt(),w=[M.Search,M.Think].includes(y);f.useEffect(()=>{o&&E.has(y)&&b(y,!1,i)},[o,y,i,b,E,w]);const C=f.useCallback(L=>{L.stopPropagation(),L.preventDefault();let O=!0;w&&(k.getState().persistedSystemHints.has(M.Search)||k.getState().persistedSystemHints.has(M.Think))&&(O=!1),O&&_(),b(y,!j,i),j||(a.removeSystemHints(),a.focus()),Kn(y,j?he.Disable:he.Enable,i.clientThreadId),r?.(L)},[i,_,a,y,w,j,r,b,k]),A=R?e.jsx("div",{className:"py-2",children:e.jsx(Tn,{location:y,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0})}):null;return e.jsx(Qt,{pressed:j,disabled:o,icon:n,label:s,ariaLabel:h,animatedLabel:!u,showLabel:u||j,onClick:C,dropdownContent:d??A,splitButtonDropdownContent:l,showSplitButton:c,dataTestid:m,tooltip:p,as:x})}function wg({composerController:t,systemHint:s,composerBarButtonInfo:n,isDisabled:o,clientThreadId:a,showLabel:i,labelOverride:r,disabledReason:u,rateLimitProgress:l,dropdownContent:c,splitButtonDropdownContent:d,showSplitButton:m,logoOverride:p,dataTestid:x,tooltipPosition:h,disableNuxMarkdown:g,as:y}){const b={clientThreadId:a},_=j=>e.jsx(_g,{composerBarButtonInfo:n,isDisabled:o,analyticsMetadata:b,systemHint:s.systemHint,disabledReason:u,rateLimitProgress:l,tooltipPosition:h,disableNuxMarkdown:g,children:j});return e.jsx(Cg,{isDisabled:o,systemHint:s,label:r??s.name,logo:p??e.jsx($t,{svgString:s.logo,className:"h-[18px] w-[18px]"}),composerController:t,analyticsMetadata:b,showLabel:i,dropdownContent:c,splitButtonDropdownContent:d,showSplitButton:m,dataTestid:x,tooltip:_,as:y})}function _g({children:t,isDisabled:s,systemHint:n,composerBarButtonInfo:o,analyticsMetadata:a,disabledReason:i,rateLimitProgress:r,tooltipPosition:u="bottom",disableNuxMarkdown:l}){const c=uu(o.announcementKey,n),d=du({composerBarButtonInfo:o,children:t,disableMarkDown:l}),m=W();let p=null;return r&&r.remaining?p=e.jsx(wi,{remaining:r.remaining,reset_date:r.reset_after,text:o.tooltipText}):o.tooltipText&&(p=e.jsx(Co,{text:o.tooltipText})),c?d:e.jsx("div",{children:e.jsx(Xe,{label:s?i===ut.HasAttachedFiles?m.formatMessage({id:"hhxO6y",defaultMessage:"Reason disabled for attachments"}):i===ut.DeepResearchHighLoad?m.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):i===ut.RateLimitReached?o.rateLimitReachedText:o.disabledText:p,side:u,onOpenChange:x=>{x&&Kn(n,he.Hover,a.clientThreadId)},children:t})})}const Co=({text:t})=>e.jsx("span",{children:t}),wi=({remaining:t,reset_date:s,text:n})=>{const{locale:o}=W(),a=mu(s,o);return e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"text-token-text-tertiary block text-xs font-semibold",children:e.jsx(P,{id:"PromptTextarea.systemHintTooltip.remaining",defaultMessage:"{remaining} available until {resetDate}",values:{remaining:t,resetDate:a}})}),e.jsx(Co,{text:n})]})};function jg({children:t,isDisabled:s,disabledReason:n,logEvent:o}){const a=W(),i=uo(),r=ti(d=>d.bySystemHint(M.Research)),u=a.formatMessage({id:"SpX/tG",defaultMessage:"Get a detailed report"});let l=null;r&&r.remaining?l=e.jsx(wi,{remaining:r.remaining,reset_date:r.reset_after,text:u}):l=e.jsx(Co,{text:u});const c=n===ut.DeepResearchHighLoad?a.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):n===ut.RateLimitReached&&i?a.formatMessage({id:"T3aUKM",defaultMessage:"More available {time}"},{time:i.resets_after_text}):void 0;return e.jsx(Xe,{className:"inline-block",label:s?c:l,side:"bottom",onOpenChange:d=>{d&&o(he.Hover)},children:t})}const kg=({items:t,searchTerm:s,setSearchTerm:n,selectedItems:o,searchPlaceholder:a,handleSelectItem:i,showSelectAllRepos:r,loading:u,endReposRef:l})=>{const c=pu(),d=r&&o?.includes("$all_accessible_repos");return e.jsx(Y.div,{variants:c,initial:"initial",animate:"animate",exit:"exit",className:"relative",children:e.jsxs("div",{className:"border-token-border-default bg-token-main-surface-primary flex max-h-60 w-full flex-col gap-2 overflow-y-auto rounded-lg border p-4",children:[e.jsx("input",{type:"text",value:s,onChange:m=>n(m.target.value),placeholder:a,className:"text-token-text-primary bg-token-main-surface-primary border-token-border-default w-full rounded-sm border-1 px-2 py-1 text-sm focus:ring-0 focus:ring-offset-0 focus:outline-hidden"}),t?.map(m=>{const p=o?.includes(m.name);return e.jsx(wt,{onClick:()=>{i(m)},isSelected:p,label:m.name,subtitle:m.description??void 0,className:"mx-0! w-full",selectedIconClassName:"color:black dark:color-gray"},m.name)}),u&&e.jsxs("div",{className:"text-token-text-secondary flex items-center justify-center gap-2 text-xs",children:[e.jsx(Kt,{}),e.jsx(P,{id:"M1WgQ2",defaultMessage:"Searching..."})]}),r&&e.jsx(wt,{onClick:()=>{i({name:"$all_accessible_repos"})},className:"mx-0! w-full",isSelected:d,label:e.jsx(P,{id:"pJnTxe",defaultMessage:"All Repositories"}),subtitle:e.jsx(P,{id:"EhTGqu",defaultMessage:"Select all repositories accessible to ChatGPT"}),selectedIconClassName:"color:black"},"select-all-repos"),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-primary border-token-border-default mt-2 mb-2 border-b"}),e.jsx(wt,{onClick:()=>{window.open(si,"_blank")},isSelected:!1,isActive:!1,label:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(P,{id:"ICVOEb",defaultMessage:"Configure Repositories"})}),subtitle:e.jsx(P,{id:"GXUcp/",defaultMessage:"Configure which repositories ChatGPT can access"}),className:"mx-0! w-full",infoIcon:e.jsx(Vt,{className:"icon-sm"}),infoLink:"https://help.openai.com/en/articles/11145903-chatgpt-connectors "},"configure-repos")]}),e.jsx("div",{className:"border-token-border-default my-2 border-t",ref:l}),e.jsx("div",{className:"text-token-text-secondary justify-center text-center text-xs",children:e.jsx(P,{id:"5A9QzP",defaultMessage:"Not seeing your repositories? {helpLink}.",values:{helpLink:e.jsx(e.Fragment,{children:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(P,{id:"sVuhcw",defaultMessage:"Learn more"})})})}})})]})})},Mg=({items:t,searchTerm:s,setSearchTerm:n,selectedItems:o,searchPlaceholder:a,handleSelectItem:i,showSelectAllRepos:r,loading:u,endReposRef:l})=>{const c=f.useRef(null),d=r&&o?.includes("$all_accessible_repos");return f.useEffect(()=>{requestAnimationFrame(()=>{c.current?.focus()})},[]),e.jsxs(e.Fragment,{children:[e.jsx(D.InputItem,{selectAllOnFocus:!0,ref:c,value:s,onChange:m=>n(m.target.value),placeholder:a}),t?.map(m=>{const p=o?.includes(m.name);return e.jsx(D.Item,{onClick:x=>{x.preventDefault(),i(m),p&&!s&&Ka(x.currentTarget)},secondary:m.description,trailing:p&&_a,children:m.name},m.name)}),u&&e.jsx("div",{className:"text-token-text-tertiary mx-1.5 px-2 py-2.5 text-sm",role:"alert","aria-busy":"true",children:e.jsx(P,{id:"M1WgQ2",defaultMessage:"Searching..."})}),r&&e.jsx(D.Item,{onClick:m=>{m.preventDefault(),i({name:"$all_accessible_repos"}),d&&!s&&Ka(m.currentTarget)},secondary:e.jsx(P,{id:"EhTGqu",defaultMessage:"Select all repositories accessible to ChatGPT"}),trailing:d&&_a,children:e.jsx(P,{id:"pJnTxe",defaultMessage:"All Repositories"})}),(r||t.length>0)&&e.jsx(D.Separator,{}),e.jsx(D.Item,{onClick:()=>{window.open(si,"_blank")},secondary:e.jsx(P,{id:"GXUcp/",defaultMessage:"Configure which repositories ChatGPT can access"}),trailing:e.jsx(Vt,{className:"icon-sm"}),children:e.jsx(P,{id:"ICVOEb",defaultMessage:"Configure Repositories"})}),e.jsx("div",{className:"text-token-text-tertiary mx-1.5 justify-center px-2.5 py-2 text-center text-xs",ref:l,children:e.jsx(P,{id:"4Z21ID",defaultMessage:"Not seeing a repository? {helpLink}",values:{helpLink:e.jsx(e.Fragment,{children:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(P,{id:"sVuhcw",defaultMessage:"Learn more"})})})}})})]})};function Ka(t){const s=t.closest("[role=menuitem]");if(!s)return;let n=s.nextElementSibling;for(;n&&n.getAttribute("role")!=="menuitem";)n=n.nextElementSibling;if(!n)for(n=s.previousElementSibling;n&&n.getAttribute("role")!=="menuitem";)n=n.previousElementSibling;n instanceof HTMLElement&&n.focus()}function Rg(t,s){const[n,o]=f.useState(t),a=f.useRef(ws(i=>o(i),s));return f.useEffect(()=>(a.current=ws(i=>{o(i)},s),()=>{a.current?.cancel()}),[s]),f.useEffect(()=>{a.current?.(t)},[t]),n}const $a=({searchTerm:t,setSearchTerm:s,selectedRepos:n,handleSelectRepo:o,linkId:a,asSubmenu:i})=>{const r=Je(),u=W(),l=ye(),c=Rg(t,300),{data:d,isFetching:m,isFetchingNextPage:p,isError:x,fetchNextPage:h,hasNextPage:g}=Bl({queryKey:["github-repos",c,a],queryFn:async({pageParam:w=null})=>c.length===0?{repos:[],next_token:null}:Mt(l,"1524828339")?await kn.safePost("/aip/connectors/github/search_repos",{requestBody:{query:c,limit:20,next_token:w,link_id:a}}):await kn.safePost("/aip/connectors/github/search_repos_v2",{requestBody:{query:c,limit:2,next_token:w,link_id:a}}),getNextPageParam:w=>w.next_token??void 0,initialPageParam:null,retry:1}),y=f.useRef(null),b=1,_=f.useRef(0);f.useEffect(()=>{if(!g||p)return;const w=y.current,C=new IntersectionObserver(A=>{A[0].isIntersecting&&_.current<b&&h()},{threshold:1});return w&&C.observe(w),()=>{w&&C.unobserve(w)}},[g,p,h]),f.useEffect(()=>{_.current=0},[c]),f.useEffect(()=>{x?(_.current+=1,_.current===1&&r.danger("Request error fetching Github repositories. Try disconnecting and connecting GitHub again.")):!p&&!x&&(_.current=0)},[x,p,r]);let j=d&&c?d.pages.flatMap(w=>w.repos).flatMap(w=>w.repository_full_name):[];j=Array.from(new Set([...j,...n.selectedRepos??[]]));const R=w=>{o(w.name)},k=i?Mg:kg,E=e.jsx(k,{items:j?.map(w=>({name:w}))??[],searchTerm:t,setSearchTerm:s,selectedItems:[...n.selectedRepos??[],...n.selectedAllRepos?["$all_accessible_repos"]:[]],searchPlaceholder:u.formatMessage({id:"lEa/MK",defaultMessage:"Add a repository…"}),handleSelectItem:R,showSelectAllRepos:!1,loading:m||p,endReposRef:y});return i?E:e.jsx("div",{children:E})};function Ag({clientThreadId:t,repoSelectorOpen:s,linkId:n,triggerButton:o,setRepoSelectorOpen:a,asSubmenu:i}){const{selectedRepos:r,setSelectedRepos:u}=$n(t),{deleteSource:l,addSource:c}=mt(t),[d,m]=f.useState(""),p=f.useRef(null),x=h=>{let g=[],y=!1;h==="$all_accessible_repos"?(y=!r?.selectedAllRepos,u({selectedRepos:[],selectedAllRepos:y})):r?.selectedRepos?.includes(h)?(g=r.selectedRepos?.filter(b=>b!==h),u({selectedRepos:g,selectedAllRepos:!1})):(g=[...r?.selectedRepos??[],h],u({selectedRepos:g,selectedAllRepos:!1})),y||g.length>0?c(As.GITHUB_CONNECTOR):i||l(As.GITHUB_CONNECTOR)};if(i){if(!n)return null;const h=hr(r);return e.jsxs(D.Sub,{open:h?s:!0,onOpenChange:g=>{h&&a(g)},children:[e.jsx(D.SubMenuTrigger,{className:"ps-4",icon:fu,children:o}),e.jsx(D.Portal,{children:e.jsx(D.SubContent,{children:e.jsx($a,{asSubmenu:i,searchTerm:d,setSearchTerm:m,selectedRepos:{selectedRepos:r.selectedRepos?[...r.selectedRepos]:[],selectedAllRepos:r.selectedAllRepos},handleSelectRepo:x,linkId:n})})})]})}return e.jsx(Bs,{open:s,onOpenChange:h=>{a(h),h||m("")},children:e.jsxs(Vn,{children:[o,n&&e.jsx(Ls,{children:e.jsx(Fs,{side:"bottom",align:"start",ref:p,children:e.jsx($a,{asSubmenu:i,searchTerm:d,setSearchTerm:m,selectedRepos:{selectedRepos:r.selectedRepos?[...r.selectedRepos]:[],selectedAllRepos:r.selectedAllRepos},handleSelectRepo:x,linkId:n})})})]})})}const Eg=30,Ng=25,hn=6,Pg=t=>(t.sort((s,n)=>s.connected&&!n.connected?-1:!s.connected&&n.connected?1:s.type==="web"&&n.type!=="web"?-1:s.type!=="web"&&n.type==="web"?1:s.name.localeCompare(n.name)),t),_i=t=>Bg[t.user_connection_details.connection_type]??t.connection_display_info.display_name,ji=t=>`${_i(t)} || ${t.connection_display_info.display_name}`,wo=({isLoading:t=!1,clientThreadId:s,enabledConnectors:n,includeWebSearch:o=!0,includeSyncConnectors:a=!1,connectorConfigMap:i,fetchValidLinksOnly:r})=>{"use forget";const u=W(),{selectedSources:l,selectedMCPSources:c,toggleSource:d}=mt(s),{connectorLinks:m,isLoading:p}=Jp({fetchValidLinksOnly:r}),{connectionInstanceData:x,refetch:h,isLoading:g}=Hs({skip:!a}),y=f.useMemo(()=>[...x?.connection_statuses??[]].sort(xr),[x]),{connectedRows:b,disconnectedRows:_}=f.useMemo(()=>{const k=[];o&&k.push({connected:!0,type:"web",name:"web",element:e.jsx(D.CheckboxItem,{icon:Sr,checked:l?.has("web"),onCheckedChange:()=>{d("web")},toggleSize:"x-small",children:u.formatMessage(Ps.webSearch)})}),a&&y.forEach(C=>{k.push({connected:C.user_connection_details.auth_status!=="not_connected"&&C.user_connection_details.activation_status!=="inactive",type:"sync",name:ji(C),element:e.jsx(Fg,{connection:C,isSelectedInSource:l?.has(C.user_connection_details.connection_type)??!1,toggleSource:d,location:"user_dropdown",refetch:h,disabled:i?.get("sync_connector")?.disabled,disabledText:i?.get("sync_connector")?.disabledText},C.user_connection_details.connection_instance_id)})}),l&&n.forEach(C=>{const T=!!m.get(C.id)?.[0];C.type===ao.MCP_CONNECTOR?k.push({connected:T,type:"access",name:C.name,element:e.jsx(Lg,{connector:C,connectorLinks:m,selectedMCPSources:c,toggleSource:d})}):k.push({connected:T,type:"access",name:C.name,element:e.jsx(Tg,{connector:C,connectorLink:m.get(C.id)?.[0],isSelectedInSource:l.has(C.type)??!1,toggleSource:d,clientThreadId:s,disabled:i?.get(C.type)?.disabled,disabledText:i?.get(C.type)?.disabledText,hasBetaTag:i?.get(C.type)?.hasBetaTag})})}),Pg(k);const[E,w]=k.reduce(([C,A],T)=>T.connected?[[...C,T],A]:[C,[...A,T]],[[],[]]);return{connectedRows:E,disconnectedRows:w}},[s,i,m,n,a,o,u,h,l,y,d,c]);if(!s||!l)return null;if(g||p||t)return e.jsx("div",{className:"w-50 px-4",children:e.jsx(li,{lines:5,size:"lg",widthVariance:0,width:100})});const j=hn-b.length,R=b.length>hn;return e.jsxs("div",{className:"w-70",children:[e.jsx("div",{className:U(R&&"border-token-border-secondary mb-1.5 border-b","overflow-y-auto"),style:R?{maxHeight:`calc(2.25rem * ${hn+.5})`}:void 0,children:b.map(({element:k})=>e.jsx(e.Fragment,{children:k}))}),_.length>0&&j>0&&e.jsx(e.Fragment,{children:_.slice(0,j).map(({element:k})=>e.jsx(e.Fragment,{children:k}))}),e.jsx(D.Item,{icon:Yn,onSelect:()=>{window.location.hash="#settings/ConnectorSettings"},children:u.formatMessage(Ps.connectApps)})]})},Ya=({isLoading:t=!1,clientThreadId:s,enabledConnectors:n,trigger:o,includeWebSearch:a,includeSyncConnectors:i=!1,connectorConfigMap:r,fetchValidLinksOnly:u})=>{const{deleteSource:l}=mt(s);return e.jsxs(D.Root,{"data-testid":"sources-pill",onOpenChange:c=>{c||(hr(Su(Fe(s)))||l(As.GITHUB_CONNECTOR),Fe(s)?.selectedSources?.size===0&&_n(s,p=>{p.selectedSources=void 0}))},children:[o,e.jsx(D.Portal,{children:e.jsx(D.Content,{alignOffset:-8,size:"auto",children:e.jsx(wo,{isLoading:t,clientThreadId:s,enabledConnectors:n,includeWebSearch:a,includeSyncConnectors:i,connectorConfigMap:r,fetchValidLinksOnly:u})})})]})},bs=3,Qa=t=>{"use forget";const s=Ll.c(30),{clientThreadId:n,includeSyncConnectors:o,includeWebSearch:a}=t,{selectedSources:i}=mt(n),{availableConnectors:r}=$p(),u=!o;let l;s[0]!==u?(l={skip:u},s[0]=u,s[1]=l):l=s[1];const{connectionInstanceData:c}=Hs(l);let d;s[2]!==a||s[3]!==i?(d=a&&i?.has("web")?e.jsx(Sr,{className:"icon-md"}):void 0,s[2]=a,s[3]=i,s[4]=d):d=s[4];const m=d;let p;s[5]!==i?(p=i??[],s[5]=i,s[6]=p):p=s[6];let x;if(s[7]!==r||s[8]!==c?.connection_statuses||s[9]!==o||s[10]!==i||s[11]!==p){const C=[...p].filter(Ig).map(T=>{const L=r.find(O=>O.type===T);return L?{name:L.name,icon:e.jsx(Qn,{connector:L,size:"xsmall"})}:null}).filter(Dg),A=o?Array.from(new Map((c?.connection_statuses??[]).filter(T=>["activated","partially_activated"].includes(T.user_connection_details.activation_status)&&i?.has(T.user_connection_details.connection_type)).map(Og)).values()):[];x=[...C,...A],x.sort(Hg),s[7]=r,s[8]=c?.connection_statuses,s[9]=o,s[10]=i,s[11]=p,s[12]=x}else x=s[12];let h;s[13]!==m?(h=m?[m]:[],s[13]=m,s[14]=h):h=s[14];let g;s[15]!==x?(g=x.map(Ug),s[15]=x,s[16]=g):g=s[16];let y;s[17]!==h||s[18]!==g?(y=[...h,...g],s[17]=h,s[18]=g,s[19]=y):y=s[19];const b=y;let _;s[20]!==b?(_=b.length>bs?[...b.slice(0,bs-1),e.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:b.length-bs+1},"more")]:b,s[20]=b,s[21]=_):_=s[21];const j=_;let R;s[22]!==j?(R=j.length>0?e.jsx("div",{className:"flex items-center gap-1",children:j.map(Gg)}):e.jsx(yr,{className:"icon-md"}),s[22]=j,s[23]=R):R=s[23];let k;s[24]!==j.length?(k=j.length<bs&&e.jsx("span",{"data-label":!0,className:"ms-1.5",children:j.length===0?e.jsx(P,{id:"UjEzZf",defaultMessage:"Add sources"}):e.jsx(P,{id:"DhW8Wx",defaultMessage:"Sources"})}),s[24]=j.length,s[25]=k):k=s[25];let E;s[26]===Symbol.for("react.memo_cache_sentinel")?(E=e.jsx(At,{className:"icon-sm ms-1.5 @max-[521px]/thread:ms-1"}),s[26]=E):E=s[26];let w;return s[27]!==k||s[28]!==R?(w=e.jsx(D.BasicTrigger,{asChild:!0,children:e.jsxs(fo,{as:"button",spacing:"compact",children:[R,k,E]})}),s[27]=k,s[28]=R,s[29]=w):w=s[29],w},Tg=({connector:t,clientThreadId:s,connectorLink:n,isSelectedInSource:o,toggleSource:a,disabled:i=!1,disabledText:r="",hasBetaTag:u=!1})=>{const l=W(),{selectedRepos:c}=$n(s),[d,m]=f.useState(!1),p=f.useMemo(()=>{if(c?.selectedRepos?.length&&c?.selectedRepos?.length>=1){const k=c.selectedRepos;let E=k[0];if(E.length>Eg){const C=(Ng-3)/2;E=E.slice(0,Math.floor(C))+"..."+E.slice(Math.floor(-11))}const w=k.length-1;return w>0?`${E} +${w}`:E}},[c.selectedRepos]);if(t.type===ao.MCP_CONNECTOR)return null;const x=!!n,h=o&&x,g=t.type===As.GITHUB_CONNECTOR&&x&&h,y=Kp[t.type]?.title,b=y?l.formatMessage(y):t.name,_=e.jsx(Qn,{connector:t,size:"xsmall"}),j=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:b}),u&&e.jsx(bu,{})]}),R=x?e.jsx(D.CheckboxItem,{disabled:i,label:j,icon:_,checked:h,onCheckedChange:()=>{a(t.type)},toggleSize:"x-small"}):e.jsx(D.Item,{onSelect:()=>{window.location.hash=`#settings/ConnectorSettings?connector=${t.id}&add-connector-link=true`},label:j,icon:_,trailing:e.jsx("div",{className:"text-token-text-tertiary",children:l.formatMessage(Ps.connect)})});return e.jsxs(e.Fragment,{children:[i&&r?e.jsx(Xe,{label:r,side:"right",align:"center",contentClassName:"w-50",children:R}):R,g&&e.jsx(Ag,{asSubmenu:!0,clientThreadId:s,setRepoSelectorOpen:m,repoSelectorOpen:d,linkId:n?.id,triggerButton:p??l.formatMessage({id:"sDCihQ",defaultMessage:"Repositories"})},t.type)]})},Bg={github_sync_connector:"GitHub",gdrive_sync_connector:"Google Drive",notion_sync_connector:"Notion",slack_sync_connector:"Slack",merge_file_storage_sync_connector:"Merge File Storage"},Lg=({connector:t,connectorLinks:s,selectedMCPSources:n,toggleSource:o})=>{const a=W(),r=!!s.get(t.id)?.[0],u=n.has(t.id)&&r,l=t.name,c=e.jsx(Qn,{connector:t,size:"medium"});return e.jsx(e.Fragment,{children:r?e.jsx(D.CheckboxItem,{icon:c,checked:u,onCheckedChange:()=>{o(t.id)},toggleSize:"x-small",children:l}):e.jsx(D.Item,{onSelect:()=>{window.location.hash=`#settings/ConnectorSettings?connector=${t.id}&add-connector-link=true`},icon:c,trailing:e.jsx("div",{className:"text-token-text-tertiary",children:a.formatMessage(Ps.connect)}),children:l})})},Fg=({connection:t,refetch:s,location:n,isSelectedInSource:o,toggleSource:a,disabled:i=!1,disabledText:r=""})=>{const u=W(),[l,c]=f.useState(!1),[d,m]=f.useState(),p=()=>{a(t.user_connection_details.connection_type)},x=t.user_connection_details.connection_instance_id,h=Je(),g=gu(),y=t.user_connection_details.knowledge_connector_type,b=y==="google_drive_oauth",_=f.useCallback(async()=>{try{c(!0),await hu({connectorType:y,connectionId:x,location:n,intl:u})}catch(H){H instanceof Error?h.danger(H.message):h.danger(u.formatMessage({id:"FNXFnS",defaultMessage:"Encountered an error connecting your account. Please try again later."}))}finally{c(!1),s?.()}},[x,y,u,n,s,h]),[j,R]=f.useState(!1),k=()=>b?R(!0):_(),E=t.user_connection_details.activation_status==="inactive"&&t.user_connection_details.auth_status==="not_connected",w=["activating","partially_activated"].includes(t.user_connection_details.activation_status),C=E&&!g||w,A=e.jsx("img",{src:t.connection_display_info.icon_url??"",alt:t.connection_display_info.display_name,className:"icon-md"}),T=H=>{if(H.stopPropagation(),H.preventDefault(),E){k();return}if(w){m(t);return}},L={key:t.connection_display_info.display_name,disabled:i,icon:A,contentClassName:"flex-1 overflow-hidden",label:_i(t),secondary:e.jsx("div",{className:"truncate",children:t.connection_display_info.display_name})};let O=null;switch(t.user_connection_details.activation_status){case"activated":O=e.jsx(D.CheckboxItem,{...L,checked:o,onCheckedChange:p,toggleSize:"x-small"});break;case"partially_activated":O=e.jsx(D.CheckboxItem,{...L,checked:o,onCheckedChange:p,trailing:e.jsxs("div",{className:"group-radix-disabled:opacity-50 flex items-center gap-1.5",children:[e.jsx(Cu,{connection:t,ignoreLabel:!0}),e.jsx(wu,{enabled:o,"aria-hidden":!0,size:"x-small"})]})});break;case"activating":O=e.jsx(D.Item,{...L,style:{cursor:C?void 0:"default"},onSelect:T,trailing:e.jsx("div",{className:"group-radix-disabled:opacity-50",children:e.jsx(vu,{connection:t})})});break;case"inactive":O=e.jsx(D.Item,{...L,style:{cursor:C?void 0:"default"},onSelect:T,trailing:e.jsx("div",{className:"group-radix-disabled:opacity-50",children:l?e.jsx(Kt,{className:"icon-md"}):e.jsx(yu,{connection:t,refetch:s,location:"user_dropdown"})})});break}return e.jsxs(e.Fragment,{children:[d&&e.jsx(br,{connection:d,onClose:()=>m(void 0)}),j&&e.jsx(xu,{isAdminFlow:!1,onClose:()=>R(!1),connectionId:x,location:n,onSuccess:s}),i&&r?e.jsx(Xe,{label:r,side:"right",align:"center",contentClassName:"w-50",children:O}):O]})},Ps=Qe({allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"}});function Ig(t){return t!=="web"}function Dg(t){return!!t}function Og(t){return[t.user_connection_details.connection_type,{name:ji(t),icon:e.jsx("img",{src:t.connection_display_info.icon_url??"",alt:t.connection_display_info.display_name,className:"icon-md"})}]}function Hg(t,s){return t.name.localeCompare(s.name)}function Ug(t){return t.icon}function Gg(t,s){return e.jsx("div",{className:"flex h-[18px] w-[18px] shrink-0 items-center justify-center",children:t},s)}function zg({clientThreadId:t,gizmoId:s,showLabel:n=!1,isDisabled:o}){const a=_u(t,s),i=dt(),r=qt(M.Research),{setThreadSystemHintMode:u,clearAllSystemHintModeTriggers:l}=ae(),c=!!uo(),{value:d}=Me("1416952492"),m=d?ut.DeepResearchHighLoad:c?ut.RateLimitReached:void 0;return a?e.jsx("div",{"data-testid":"system-hint-research",style:{viewTransitionName:`var(--vt-composer-${M.Research}-action)`},children:e.jsx(Wg,{composerController:i,isThreadInSystemHintMode:r,setThreadSystemHintMode:u,clearAllSystemHintModeTriggers:l,clientThreadId:t,showLabel:n,isDisabled:o||!!m,disabledReason:m})},`system-hint-${M.Research}`):null}function Wg({composerController:t,isThreadInSystemHintMode:s,setThreadSystemHintMode:n,clearAllSystemHintModeTriggers:o,clientThreadId:a,showLabel:i=!1,isDisabled:r=!1,disabledReason:u}){const l=W(),c={clientThreadId:a},d=l.formatMessage({id:"ORxecl",defaultMessage:"Deep research"}),m=b=>{b===he.Hover?B.logEventWithStatsig("Composer Research Button Hovered","composer_research_button_hovered",c):b===he.Enable?B.logEventWithStatsig("Composer Research Button Enabled","composer_research_button_enabled",c):b===he.Disable&&B.logEventWithStatsig("Composer Research Button Disabled","composer_research_button_disabled",c)},p=b=>{b.stopPropagation(),b.preventDefault(),o(),n(M.Research,!s,c),s||(t.removeSystemHints(),t.focus()),m(s?he.Disable:he.Enable)},x=Me("3544641259")?.value,{availableConnectors:h,isLoading:g}=po(),y=b=>e.jsx(jg,{disabledReason:u,isDisabled:r,logEvent:m,children:b});return e.jsx(Qt,{pressed:s,disabled:r,icon:e.jsx(ju,{className:"h-[18px] w-[18px]"}),label:d,animatedLabel:!i,showLabel:i||s,onClick:p,ariaLabel:d,dataTestid:"composer-button-deep-research",splitButtonDropdownContent:x?e.jsx(wo,{isLoading:g,clientThreadId:a,enabledConnectors:h,includeSyncConnectors:!1,includeWebSearch:!0,fetchValidLinksOnly:!0}):void 0,showSplitButton:s&&x,tooltip:y,as:x?"dropdown":"popover"})}function Vg({clientThreadId:t,gizmoId:s,composerController:n,isDisabled:o}){return ku({clientThreadId:t,gizmoId:s})?e.jsx("div",{"data-testid":"system-hint-reason",style:{viewTransitionName:`var(--vt-composer-${M.Think}-action)`},children:e.jsx(qg,{clientThreadId:t,composerController:n,isDisabled:o})},`system-hint-${M.Think}`):null}function qg({clientThreadId:t,composerController:s,isDisabled:n}){const o=W(),a=!!mo();n=n||a;const i=o.formatMessage({id:"T+qu+0",defaultMessage:"Reason"}),{setThreadSystemHintMode:r,clearAllSystemHintModeTriggers:u}=ae(),l=qt(M.Think),c=Ke.useStore(),d=zt(),{isUnauthenticated:m}=ve();f.useEffect(()=>{n&&d.has(M.Think)&&r(M.Think,!1,{clientThreadId:t})},[n,d,r,t]);const p=g=>{if(g.stopPropagation(),g.preventDefault(),m)return;let y=!0;c.getState().persistedSystemHints.has(M.Search)&&(y=!1),y&&u(),r(M.Think,!l,{clientThreadId:t}),l||(s.removeSystemHints(),s.focus()),l?B.logEventWithStatsig("Composer Think Button Disabled","composer_think_button_disabled",{clientThreadId:t}):B.logEventWithStatsig("Composer Think Button Enabled","composer_think_button_enabled",{clientThreadId:t})},x=m?e.jsx(Tn,{location:M.Think,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0}):void 0,h=e.jsx(Qt,{pressed:l,disabled:n,icon:e.jsx(Ru,{className:"h-[18px] w-[18px]"}),label:i,ariaLabel:i,animatedLabel:!0,showLabel:!0,onClick:p,dropdownContent:x,dataTestid:"composer-button-reason"});return e.jsx(Mu,{isDisabled:n,clientThreadId:t,children:h})}const Kg=["o1","o1-pro","gpt-4"];function $g({account:t,clientBootstrapFlags:s,features:n,clientThreadId:o,currentModelConfig:a,composerController:i,isDisabled:r,gizmoId:u,hasFiles:l}){const{prospectiveModelId:c}=Ds(o),d=Gt(o),m=Xn(u),{userIsInSearchHoldoutWithWebDisabled:p}=Au(),x=a?.enabledTools?.includes(lo.Search),h=d==null||d?.kind===Se.PrimaryAssistant||d?.kind===Se.GizmoInteraction&&m,{isUnauthenticated:g}=ve(),y=Xr(M.Search);return x===!1||g&&s?.includes(Rs.AnonSearchHoldout)||!g&&(t==null||t.isFree())&&(s?.includes(Rs.FreeSearchHoldout)||p)||!y||!g&&(t==null||t.isEnterprisey())&&!n?.includes(bp.BrowsingAvailable)||!h?null:e.jsx("div",{"data-testid":"system-hint-search",style:{viewTransitionName:`var(--vt-composer-${M.Search}-action)`},children:e.jsx(Yg,{clientThreadId:o,composerController:i,modelSupportsSearch:x??(g||t?.isFree()||!!c&&!Kg.includes(c)),isDisabled:r,disabledReason:x?l?js.HasAttachedFiles:void 0:js.ModelNotSupported,currentModelName:a?.title??""})},`system-hint-${M.Search}`)}function Yg({clientThreadId:t,composerController:s,isDisabled:n,disabledReason:o,currentModelName:a,modelSupportsSearch:i}){const r=W(),u=Eu(),l=r.formatMessage({id:"TbHx8d",defaultMessage:"Search"}),{setThreadSystemHintMode:c,clearAllSystemHintModeTriggers:d}=ae(),m=Ke.useStore(),p=zt();n=n||!i,f.useEffect(()=>{n&&p.has(M.Search)&&c(M.Search,!1,{clientThreadId:t})},[n,p,c,t]);const x=h=>{h.stopPropagation(),h.preventDefault();let g=!0;m.getState().persistedSystemHints.has(M.Think)&&(g=!1),g&&d(),c(M.Search,!u,{clientThreadId:t}),u||(s.removeSystemHints(),s.focus()),B.logEventWithStatsig("Composer Search Button Clicked","composer_search_button_clicked",{clientThreadId:t}),u&&s.trimLeadingText(/^search\b/i)};return e.jsx(Xg,{analyticsMetadata:{clientThreadId:t},isThreadUsingSearchMode:u,isDisabled:n,disabledReason:o,currentModelName:a,children:e.jsx(Qt,{pressed:u,disabled:n??!1,icon:e.jsx(Nu,{className:"h-[18px] w-[18px]"}),label:l,ariaLabel:l,animatedLabel:!0,showLabel:!0,onClick:x,dataTestid:"composer-button-search"})})}function Qg(){const t=vr(),s=Re(ue.hasSeenComposerSearchButtonTooltip);return!s.isLoading&&s.eligible&&!t}function Xg({children:t,analyticsMetadata:s,isThreadUsingSearchMode:n,isDisabled:o,disabledReason:a,currentModelName:i}){const r=Qg()&&!n,u=Re(ue.hasSeenComposerSearchButtonTooltip);return r?e.jsx(Jn,{announcementKey:ue.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(P,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:u.markAsViewed,sideOffset:0,className:"xs:max-w-sm! max-w-2xs!",description:e.jsx(P,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(Pu,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(P,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(Xe,{className:"inline-block",label:o?a===js.ModelNotSupported?e.jsx(P,{id:"GZemJe",defaultMessage:"Search disabled for {modelName}",values:{modelName:`${i}`}}):a===js.HasAttachedFiles?e.jsx(P,{id:"ssHAbn",defaultMessage:"Remove attachments to search"}):e.jsx(P,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(P,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"bottom",onOpenChange:l=>{l&&B.logEventWithStatsig("Composer Search Button Hovered","composer_search_button_hovered",s)},children:t})})}const Jg=1;function Zg({value:t=Jg,size:s,onStateChange:n}){return e.jsx("div",{className:"relative flex h-full w-full flex-col items-center justify-center",children:e.jsxs(Y.div,{animate:{translateY:t>1&&s==="small"?-1:0},onAnimationStart:()=>n?.("animating"),onAnimationComplete:()=>n?.("idle"),className:U("relative",s==="small"?"h-5 w-5":"h-8 w-8"),children:[e.jsx(Y.div,{style:{transformOrigin:"50% 100%",translateY:s==="large"?3:0},animate:{scale:t>1&&s==="small"?.85:1},className:"absolute start-0 top-0",children:e.jsx(Tu,{"aria-label":"",className:U(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(Y.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>1?1:.9,opacity:t>1?1:0},style:{translateY:s==="large"?-1:0},className:"absolute start-0 top-0",children:e.jsx(Bu,{"aria-label":"",className:U(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(Y.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>2?1:.9,opacity:t>2?1:0},style:{translateY:s==="large"?-1:0},className:"absolute start-0 top-0",children:e.jsx(Lu,{"aria-label":"",className:U(s==="small"?"h-5 w-5":"h-8 w-8")})})]})})}function eh(t){const{reasoningLevelTypes:s,reasoningLevelType:n}=t,{ReasoningLevels:o}=s;let a=1;return n===o.medium.type?a=2:n===o.high.type&&(a=3),e.jsx("div",{className:U("relative flex h-5 w-5 items-center justify-center"),children:e.jsx(Zg,{size:"small",value:a})})}const th=({isManualModelSelection:t,animatedLabel:s,reasoningLevelTypes:n,reasoningLevelType:o,modelName:a,onResetReasoningLevel:i,onReasoningLevelChanged:r,type:u})=>{const[l,c]=f.useState(!1),d=Za(),{reasoningLevel:m}=Fu({reasoningLevelTypes:n,reasoningLevelType:o}),p=o!=="low"||t||!1,x=Le(g=>g.isVisuallyOverflowing),h=x;return e.jsxs("div",{className:U("radix-state-open:bg-black/10 inline-flex h-9 rounded-full border text-[13px] font-medium",p?"text-token-interactive-label-accent-default can-hover:hover:bg-[#BDDCF4] dark:can-hover:hover:bg-[#1A416A] bg-token-composer-blue-bg border-transparent dark:bg-[#2A4A6D] dark:text-[#48AAFF]":"border-token-border-default text-token-text-secondary can-hover:hover:bg-token-main-surface-secondary focus-visible:outline-black dark:focus-visible:outline-white",l&&"duration-75 motion-safe:transition-all"),children:[e.jsxs("div",{className:"flex h-full min-w-8 items-center justify-center p-2","aria-pressed":p,onTransitionEnd:()=>c(!1),onClick:g=>{u==="think"&&!t&&!x&&(g.stopPropagation(),g.preventDefault(),r(o==="low"?"medium":"low"))},children:[e.jsx(eh,{reasoningLevelTypes:n,reasoningLevelType:o}),s&&e.jsx(Ie,{initial:!1,children:e.jsx(Y.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:d?0:.15},children:e.jsx("div",{className:U("ps-1 pe-1 whitespace-nowrap",h&&!t&&"hidden"),children:t?a:m?.shortLabel})})}),!t&&u==="auto"&&!p&&!h&&e.jsx(At,{"aria-label":"",className:"h-[18px] w-[18px] opacity-50"})]}),p&&!x&&(t||u!=="think")?e.jsx("div",{className:"border-token-border-default mt-[1px] border-s p-2",style:{borderColor:p?"#0285FF28":void 0},onClick:g=>{g.stopPropagation(),g.preventDefault(),i()},children:e.jsx(ni,{"aria-label":"",className:"h-[16px] w-[16px]"})}):u==="think"?e.jsx("div",{className:U("border-token-border-default border-s p-2",h&&"hidden"),style:{borderColor:p?"#0285FF28":void 0},children:e.jsx(At,{className:"h-[18px] w-[18px]"})}):null]})},sh=({clientThreadId:t,currentModelId:s,onModelSelection:n,closePopover:o,setIsModelPickerOpen:a,ref:i})=>{const r=W(),{data:u}=Yt(),{mode:l}=Zn(),c=Iu({clientThreadId:t}),{hasInternalModels:d}=Du(),x=Ou(h=>h.query).toLowerCase().trim().length>0;return e.jsxs(Y.div,{initial:{clipPath:"inset(0 100% 0 0)",opacity:0},animate:{clipPath:"inset(0 0% 0 0)",opacity:1},exit:{clipPath:"inset(0 100% 0 0)",opacity:0},transition:ks,className:"flex flex-col",ref:i,children:[l!=="model-picker-only"&&e.jsxs("div",{className:"border-token-border-xlight bg-token-main-surface-primary dark:bg-token-main-surface-secondary sticky start-0 top-0 z-10 flex w-full flex-row items-center justify-center overflow-clip border-b p-3",children:[e.jsx("button",{onClick:()=>{a(!1)},id:"reasoning-level-popover-model-list-back-button",className:"hover:bg-token-main-surface-tertiary flex items-center rounded-md p-1",children:e.jsx(Cr,{className:"text-token-text-secondary h-5 w-5"})}),e.jsx("div",{className:"flex-auto text-center text-sm font-medium",children:r.formatMessage({id:"j6WEI7",defaultMessage:"Choose a model"})}),e.jsx("div",{className:"w-5"})]}),e.jsx("div",{className:U("flex w-full flex-col pb-2"),children:x?e.jsx(Hu,{currentModelId:s,onModelSelection:n,closePopover:o,rootRef:i}):e.jsxs(e.Fragment,{children:[u?.categories?.map(h=>{const g=h?.defaultModel;return e.jsx(Uu,{model:h,modelSwitcherDenialsBySlug:c,isSelected:g===s,onClick:()=>{n(g),o()}},g)}),d&&e.jsxs(e.Fragment,{children:[e.jsx(Gu,{modelsData:u,clientThreadId:t,triggerButton:e.jsx(wt,{className:"relative mt-1 border-transparent",children:e.jsxs("div",{className:"mb-1 flex items-center px-1",children:[e.jsx("div",{className:"text-sm",children:r.formatMessage({id:"ZDpo4I",defaultMessage:"Internal Models"})}),e.jsx(zu,{className:"icon-md text-token-text-tertiary absolute end-1 w-7"})]})}),onModelItemClick:h=>{h&&(n(h),o())}}),e.jsx(wr,{})]})]})})]})},nh={modelPickerOpen:{maxHeight:375,width:320},modelPickerClosed:{maxHeight:245,width:320},vanguardModelPickerClosed:{maxHeight:320,width:264}},oh=({clientThreadId:t,reasoningLevelTypes:s,reasoningLevelType:n,onReasoningLevelChanged:o,isManualModelSelection:a,currentModelId:i,onModelSelection:r,resetReasoningLevel:u})=>{const{layoutMode:l,closePopover:c,mode:d}=Zn(),m=!Us(),[p,x]=f.useState(!!(a||d==="model-picker-only")),h=f.useRef(null),g=f.useRef(null);return f.useEffect(()=>{p?(h.current?.scrollTo({top:-1e3,behavior:"instant"}),document.getElementById("reasoning-level-popover-model-list-back-button")?.focus()):document.getElementById("reasoning-level-popover-juice-list-model-picker-button")?.focus()},[a,p]),e.jsxs(Y.div,{className:U("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 245px)] flex flex-1 origin-center snap-y snap-proximity scroll-pt-[30px] overflow-y-auto overscroll-contain scroll-smooth [scrollbar-gutter:stable]",m&&!p&&"pt-4",l==="bottom"&&"flex-col-reverse"),animate:p?"modelPickerOpen":"modelPickerClosed",transition:Wu,variants:nh,ref:h,children:[!p&&d!=="model-picker-only"&&e.jsx(Vu,{clientThreadId:t,reasoningLevelTypes:s,reasoningLevelType:n,onReasoningLevelChanged:o,resetReasoningLevel:u,shouldShowModelPicker:m,setIsModelPickerOpen:x,isModelPickerOpen:p,showAccountPaymentModal:Ht}),e.jsx(Ie,{children:p&&m&&e.jsx(sh,{clientThreadId:t,setIsModelPickerOpen:x,ref:g,currentModelId:i,onModelSelection:r,closePopover:c})})]})},ah=({clientThreadId:t,layoutMode:s,currentModel:n,category:o,type:a,...i})=>{const{data:r}=Yt(),l=Le(C=>C.threads[t]?.modelSelection)?.type===xe.SPECIFIC,c=Le(C=>C.setThreadModelSelection),d=Us(),m=Pn(),p=f.useMemo(()=>{const C=n?.id??"";return qu(C)?"low":Ku(C)?"medium":$u(C)?"high":"low"},[n?.id]),x=Yu(),h=_s(),g=f.useCallback(C=>{_t(t,c,{type:xe.EFFORT_MODE,effortMode:_r[C]}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const A=Qu(C,r?.categories.map(T=>T.defaultModel)??[]);A&&(d&&C==="high"?Ht(m,"Model picker upsell"):h({location:"PromptTextarea",modelId:A}))})})},[t,h,m,d,r,c]),y=C=>{const A=n?.id??"";C&&(B.logEvent("Model Switcher Model Changed",{from:A,to:C,source:"popover"}),vp.logEvent("chatgpt_model_switcher_model_changed",C,{from:A,to:C,source:"popover"}),h({modelId:C,location:"Model switcher menu item"}),Zu({type:xe.SPECIFIC,modelSlug:C}),_t(t,c,{type:xe.SPECIFIC,modelSlug:C}))},b=!Xu(n?.id??""),_=l||b,R=(o?.label&&o?.label?.length<10?o?.label:o?.shortLabel)??n?.title??"",k=n?.id??"",E=()=>{g("low")},w=f.useCallback(()=>{const{reasoningLevelList:C}=x,T=(C.findIndex(L=>L.type===p)+1)%C.length;g(C[T].type)},[g,p,x]);return f.useEffect(()=>yp(Ju,{cycleReasoningLevel:w}),[w]),e.jsxs(go,{layoutMode:s,...i,children:[e.jsx(ui,{children:e.jsx(th,{isManualModelSelection:_,modelName:R,animatedLabel:!0,reasoningLevelTypes:x,reasoningLevelType:p,onResetReasoningLevel:E,onReasoningLevelChanged:g,type:a})}),e.jsx(ho,{align:"start",children:e.jsx(oh,{clientThreadId:t,reasoningLevelTypes:x,reasoningLevelType:p,onReasoningLevelChanged:g,modelName:R,isManualModelSelection:_,currentModelId:k,onModelSelection:y,resetReasoningLevel:E})})]})},rh=5,ih=f.memo(function(s){return lh(s),ch(s),uh(),null});function lh(t){const{store:s}=be(),n=s.useSetSharedProps();Rn(()=>{n(t)},[t,n])}function ch(t){const{clientThreadId:s,canContinue:n}=t,{store:o}=be(),a=f.useRef({top:o.useContentAreaApi(Ut.HeaderTop),bottom:o.useContentAreaApi(Ut.HeaderBottom)}).current,i=ed(s),{shouldShowBannerSignup:r,shouldShowBannerTermsDisclaimer:u}=dh(s),l=Lf(s,t.composerController),c=td(t),d=sd(t),m=vr(),p=nd(),x=od(t),h=Of(s),g=ad(t),y=rd(s),b=id(s),_=Yp(),{eligible:j}=Re(ld),R=cd(),k=ud(),E=dd(),w=md(),C=pd(s),A=fd(s),T=gd(),L=hd(s),O=xd(s),H=Sd(s),S=oe(s,N=>N?.modelId),I=Gt(s),K=Et();Rn(()=>{S&&I?.kind===Se.GizmoInteraction&&I.gizmo&&bd(S,I.gizmo)?a.top.set(F.ProjectConversationTaskNoFileAccess):g.eligible?a.top.set(F.AdvancedVoiceOnMobileAnnouncement):u?a.top.set(F.BannerTermsDisclaimer):l?a.top.set(F.BannersRateLimit):T?a.top.set(F.BannerPlusUpsell):L?a.top.set(F.ContextualAnswersAdminUpsell):O?a.top.set(F.ContextualAnswersUserUpsell):y?a.top.set(F.JawboneAnnouncement):b?a.top.set(F.JawboneMaxActiveAnnouncement):c.eligible?a.top.set(F.BannerSidekickAnnouncement):m?a.top.set(F.MoonshineAnnouncement):p?a.top.set(F.CustomizeChatGPTAnnouncement):d?a.top.set(F.SearchBrowserExtensionAnnouncement):x?a.top.set(F.SearchBrowserExtensionReactiveAnnouncement):_?a.top.set(F.PromoRedemptionAnnouncement):j?a.top.set(F.OperatorAnnouncement):E?a.top.set(F.ReferralProgramUpsellAnnouncement):n?a.top.set(F.PromptTextareaAction):r?a.top.set(F.BannerSignup):h?a.top.set(F.BannerMemoryFull):R?a.top.set(F.ReferrerRedemptionAvailableAnnouncement):k?a.top.set(F.RefereeRedemptionAvailableAnnouncement):w?a.top.set(F.StudentsUpsellAnnouncement):C?a.top.set(F.ModelDeprecationBanner):A?a.top.set(F.TeamsContextualAnswersUpsell):H?a.top.set(F.LanguageUpsellBanner):a.top.set(null)},[a,K,n,u,r,l,c,h,g]),Rn(()=>{i&&a.bottom.set(ur.DallePromptControls)},[a,i])}function uh(){const{store:t}=be();f.useEffect(()=>()=>{t.reset()},[t])}function dh(t){const{isUnauthenticated:s}=ve(),{layer:n}=Ye("3637408529",{shouldLogExposure:!1}),{layer:o}=Ye("3637408529"),a=o.get("no_auth_banner_signup_rate_limit",rh),i=n.get("should_show_no_auth_signup_banner",!0),r=yd(m=>m.bannerDisclaimerClientThreadId),u=vd(),l={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[c,d]=oe(t,m=>[se.getConversationTurns(m).filter(p=>p.role===oi.User).length,mh(se.getCurrentNode(m)?.message)]);return t&&(l.shouldShowBannerTermsDisclaimer=d&&s&&c===1&&!u&&(r==null||r===t),l.shouldShowBannerSignup=i&&d&&s&&c>0&&c%a===0),l}function mh(t){return t?.author.role===oi.Assistant&&Cp(t)}const ki=t=>{const s=[];s.push({category:null,systemHints:t.filter(n=>!n.category)});for(const n of _p)s.push({category:n,systemHints:t.filter(o=>o.category===n)});return s};function Mi({composerController:t,clientThreadId:s,onHintSelected:n}){const o=ai(s),[a]=oe(s,S=>[S?.modelId]),{data:i}=Yt(),r=a??Cd(void 0).id,u=jr(i?.models,r),{configurationMenuType:l}=De(),{setThreadSystemHintMode:c,clearAllSystemHintModeTriggers:d}=ae(),{viewableSystemHints:m,persistedSystemHints:p}=Ke.useState(({availableHints:S,persistedSystemHints:I})=>({viewableSystemHints:S,persistedSystemHints:I})),[x,h]=f.useState([]),[g,y]=f.useState(void 0),[b,_]=f.useState(0);f.useEffect(()=>{if(!g)h([]);else{const S=g.text.toLocaleLowerCase(),I=m.filter(N=>{const V=N.name.toLocaleLowerCase().startsWith(S),z=N.systemHint.toLocaleLowerCase().startsWith(S);let J=!1;return N.regexMatches&&N.regexMatches.length>0&&(J=N.regexMatches.some(ee=>ee.replace(/[\^\$\(\)]/g,"").toLocaleLowerCase().startsWith(S))),V||z||J}).filter(N=>N.requiredFeatures.every(V=>u?.enabledTools?.includes(V))),K=ki(I).map(N=>N.systemHints).flat();h(K)}},[g]),f.useEffect(()=>{t.view.dispatch(af(t.view.state.tr,{onHintMatch(S){y(I=>wp(I,S)?I:S)}}))},[t]);const j=!m.length||!x.length||!g;f.useEffect(()=>{_(0)},[j]);const R=x.length,k=f.useCallback(S=>{_(I=>(S(I)%R+R)%R)},[R]),E=f.useCallback(()=>{_(-1)},[]),w=x[b],C=f.useCallback(()=>{g?.range&&t.delete(g.range.from,g.range.to)},[g,t]),A=({hintToSave:S=w,expectPerfectMatch:I})=>{if(!g||!w||I&&S.name.toLowerCase()!==g.text.toLowerCase())return!1;B.logEvent("System Hint Selected",{system_hint:S.systemHint,conversation_id:o??Mn});const K=g.range.from===1?S.name:g.text+S.name.slice(g.text.length),N={clientThreadId:s};xs(t.view),p.size>0&&d();const V=!!S.composerBarButtonInfo,z=S.systemHint===M.Search;return V||z||l!=="none"?(c(S.systemHint,!0,N,z?wd.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),C(),t.removeSystemHints(),!0):(t.addSystemHint(S.systemHint,K,g.range.from,g.range.to),!0)},T=f.useRef(A);T.current=A;const L=f.useRef(k);L.current=k;const O=f.useRef(g);O.current=g;const H=t.view;return f.useEffect(()=>(j||rf(H,S=>{if(S==="up")L.current(I=>I-1);else if(S==="down")L.current(I=>I+1);else if(S==="cancel")xs(H),lf(H);else if(S==="submit")if(n)C(),n(w.systemHint);else return xs(H),T.current({expectPerfectMatch:!1});else if(S==="checkMatch")return T.current({expectPerfectMatch:!0})}),()=>xs(H)),[j,H,w,n,C]),f.useEffect(()=>{j||B.logEvent("System Hint List Opened",{conversation_id:o??Mn})},[j]),{suggestorClosed:j,systemHintSuggestions:x,hintMatch:g,selectedIndex:b,resetSelectedIndex:E,setSelectedIndex:_,saveHint:A}}function ph({composerController:t,clientThreadId:s}){const{selectedIndex:n,systemHintSuggestions:o,suggestorClosed:a,setSelectedIndex:i,saveHint:r}=Mi({composerController:t,clientThreadId:s});return a?null:e.jsx(_d,{className:"max-w-60",onMouseDown:u=>{u.preventDefault()},children:o.map((u,l)=>e.jsx(jd,{as:"div",autoFocus:!1,className:"rounded-lg px-1 py-2",highlighted:l===n,onMouseOver:()=>i(l),onClick:()=>{r({hintToSave:u,expectPerfectMatch:!1}),t.focus()},children:e.jsx(Ri,{title:u.name,description:u.description,logo:u.logo})},u.systemHint))})}function Ri({title:t,description:s,logo:n,checked:o,badge:a}){const i=W();return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-2 ps-1.5 pe-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:e.jsx($t,{svgString:n,className:"icon-lg text-token-text-secondary"})}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsxs("p",{className:"text-token-text-primary text-sm leading-tight font-normal",children:[t,a&&e.jsx("span",{className:"ms-2 rounded-full bg-blue-400 px-2 py-0.5 text-xs text-white","aria-label":i.formatMessage({id:"I75WNJ",defaultMessage:"Create image updated"}),children:e.jsx(P,{id:"uUmZQi",defaultMessage:"Updated"})})]}),!!s&&e.jsx("p",{className:"text-token-text-secondary text-[13px] leading-[18px] font-normal",children:s})]}),o&&e.jsx(kd,{className:U("icon-md text-token-text-primary",{"group-hover:hidden":!o})})]})}function Xa({composerController:t,clientThreadId:s}){return t instanceof cf?e.jsx(ph,{composerController:t,clientThreadId:s}):null}function Ai({children:t,className:s,showBackground:n,showGlowingBorder:o}){return e.jsxs("div",{className:U("relative",o&&"overflow-clip rounded-full p-0.5"),children:[t,o&&e.jsx("div",{className:"border-glowing-gradient"}),n&&e.jsx(Y.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:U("pointer-events-none absolute inset-0 rounded-full",s)})]})}const fh=({connectors:t,handleOauthRedirect:s,handleConnectorClick:n,isConnectorConfigLoading:o,desktopConnectors:a,modelSupportedImageMimeTypes:i,showMenuForNoAuth:r,handleLocalFileUploadClick:u})=>{const[l,c]=f.useState("main"),d=l!=="main",m=W(),p=f.useRef(null),x=eo();return f.useEffect(()=>{d?document.getElementById("vanguard-file-picker-popover-submenu-back-button")?.focus():p.current&&p.current.focus()},[d]),e.jsx("div",{className:U("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 215px)] flex flex-1 snap-y snap-proximity flex-col overflow-y-auto scroll-smooth py-2 [scrollbar-gutter:stable] focus-visible:rounded-[inherit] focus-visible:-outline-offset-1"),ref:p,tabIndex:0,children:e.jsxs(Ie,{mode:"wait",children:[e.jsx(Y.div,{className:"flex flex-col",transition:x?Rt:ks,children:l==="main"&&e.jsx(gh,{connectors:t,setActiveMenu:c,isConnectorConfigLoading:o,desktopConnectors:a,modelSupportedImageMimeTypes:i,showMenuForNoAuth:r,handleLocalFileUploadClick:u})},"main"),d&&e.jsxs(Y.div,{initial:{clipPath:"inset(0 100% 0 0)",opacity:0},animate:{clipPath:"inset(0 0% 0 0)",opacity:1},transition:x?Rt:ks,className:"flex flex-col",children:[e.jsxs("div",{className:"border-token-border-xlight bg-token-main-surface-primary dark:bg-token-main-surface-secondary sticky start-0 top-0 z-10 flex w-full flex-row items-center justify-center overflow-clip border-b px-3 py-3",children:[e.jsx("button",{onClick:()=>c("main"),id:"vanguard-file-picker-popover-submenu-back-button",className:"hover:bg-token-main-surface-tertiary flex items-center rounded-md p-1",children:e.jsx(Cr,{className:"text-token-text-secondary h-5 w-5","aria-label":""})}),e.jsx("div",{className:"flex-auto text-center text-sm font-medium",children:m.formatMessage({id:"LlLQYj",defaultMessage:"Back"})}),e.jsx("div",{className:"w-5"})]}),e.jsx("div",{className:"flex w-full flex-col py-2",children:l==="connect-apps"&&e.jsx(Md,{connectorEntries:t,onConnectorClick:n,onOauthRedirect:s})})]},l)]})})};function gh({connectors:t,setActiveMenu:s,isConnectorConfigLoading:n,desktopConnectors:o,modelSupportedImageMimeTypes:a,showMenuForNoAuth:i,handleLocalFileUploadClick:r}){const u=W();return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(wt,{label:u.formatMessage(hh.addFromApps),icon:Yn,isSubMenuTrigger:!0,onClick:()=>s("connect-apps")},"add-from-apps-trigger"),n&&e.jsx(wt,{icon:e.jsx(Kt,{className:"text-token-text-secondary"})}),(t.length>0||n)&&e.jsx(wr,{}),o.map(l=>e.jsx(kr,{entry:l,visualTreatment:"vanguard"},l.key)),e.jsx(Mr,{modelSupportedImageMimeTypes:a}),e.jsx(Rr,{handleLocalFileUploadClick:r,showMenuForNoAuth:i})]})}const hh=Qe({addFromApps:{id:"ContextConnectorPicker.addFromApps",defaultMessage:"Add from apps"}}),xh=({layoutMode:t,triggerButton:s,restoreFocus:n,...o})=>e.jsxs(go,{layoutMode:t,restoreFocus:n,children:[s,e.jsx(ho,{align:"start",children:e.jsx(fh,{...o})})]});function Sh(){const{connectorConfig:t}=Ar(),s=to(),[,n]=Er(Nr([...t.values()],a=>!!a.access_token),a=>!!a.access_token);return{unconnectedConnectors:s?[]:n}}function Ei({clientThreadId:t,icon:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:a,onOauthRedirect:i,uploadType:r,getInputProps:u,openFileDialog:l,isDisabled:c=!1,highlightTooltip:d=!1,showLabel:m,isSmall:p=!1,hideBorder:x=!1,disabledReason:h,currentModelName:g,visualTreatment:y="vanguard",showMenuForNoAuth:b=!1,showGlowingBorder:_=!1,layoutMode:j="centered",restoreFocus:R}){const k=jp().locale,E=W(),w=Je(),C=Bn(),A=Gs(),{connectorConfig:T,isLoading:L}=Ar(),O=Re(ue.ContextConnectors),{getGizmoId:H}=Ts(),{value:S}=Me("58345806"),{configurationMenuType:I}=De(),K=I!=="none",N=S&&y==="vanguard",[V,z]=f.useState();f.useEffect(()=>{H?H().then(G=>z(G)):z(void 0)},[H]);const J=f.useRef(null),[ee,te]=f.useState(!1),Ae=f.useRef(!1),Oe=f.useCallback(()=>{const G=J.current?.files;Array.from(G??[]).forEach(_e=>Dt.uploadFile(C,_e,o,E,w,a))},[C,o,E,w,a]),[He,Ee]=f.useState(null),pt=f.useCallback(()=>Ee(null),[Ee]),et=f.useCallback((G,_e)=>Dt.uploadPickedFile(C,G,_e,o,n,a,V,E,w),[C,o,n,a,V,E,w]),{openMenu:Ue,confirmMenuOpened:Ce}=Rd();f.useEffect(()=>{Ue&&(te(!0),Ce())},[Ue,Ce,te]);const ie=f.useCallback(G=>{Dt.doContextConnectorOauthRedirect(location.pathname+location.search+location.hash,G,i,Ta.Picker),i()},[i]),tt=f.useCallback(G=>{Dt.uploadPickedFile(C,G,hs.GDRIVE,o,n,a,V,E,w)},[C,o,n,a,V,E,w]),Ge=f.useCallback(async G=>{const{access_token:_e}=G;if(!_e){ie(G);return}switch(Dt.logAttemptIfAccessTokenIsExpired(G,Ta.Picker),G.type){case hs.GDRIVE:Ad(k,G.type,_e,We=>We.forEach(tt));break;case hs.O365_PERSONAL:case hs.O365_BUSINESS:Ee(G.type);break}},[tt,ie,Ee,k]),le=()=>{B.logEvent("Open File Viewer",{intent:r.toString()}),l()},ft=G=>{if(!G&&Ae.current&&!L)le();else if(G&&Pe&&!L&&!b){le();return}te(G),G&&(O.eligible&&O.markAsViewed(),B.logEventWithStatsig("Composer: Open Context Connector Picker","chatgpt_composer_open_context_connector_picker"),Ae.current=!0,setTimeout(()=>{Ae.current=!1},250))},[ne]=Er(Nr([...T.values()],G=>!!G.access_token),G=>!!G.access_token);bh(ne,Ge);const{unconnectedConnectors:st}=Sh(),{desktopConnectors:ze}=Ed(o),Ne=[...ne,...st],Pe=!Ne.length&&!ze.length,we=e.jsxs(e.Fragment,{children:[Ne.length>0&&e.jsx(Nd,{connectorEntries:Ne,onConnectorClick:Ge,onOauthRedirect:ie}),L&&e.jsx(D.Item,{icon:e.jsx(Kt,{className:"text-token-text-secondary"})}),ze.map(G=>e.jsx(kr,{entry:G},G.key)),e.jsx(Mr,{modelSupportedImageMimeTypes:o}),e.jsx(Rr,{handleLocalFileUploadClick:le,showMenuForNoAuth:b})]}),X=c||A!=null,Te=f.useRef(!1);let de;K?de=e.jsx(ci,{clientThreadId:t,rateLimitPopup:A,highlightTooltip:d,disabled:X,disabledReason:h,currentModelName:g,children:e.jsxs(D.BasicTrigger,{className:"composer-btn",disabled:X,id:"upload-file-btn","aria-label":tf(E,X,h,g),children:[s,m&&e.jsx(sr,{})]})}):N?de=e.jsx(sf,{clientThreadId:t,icon:s,isDisabled:X,highlightTooltip:d,showLabel:m,hideBorder:x,isSmall:p,disabledReason:h,currentModelName:g,visualTreatment:y,isLoading:L,handleLocalFileUploadClick:le,noAvailableConnectors:Pe,showMenuForNoAuth:b,announcement:O,rateLimit:A}):de=e.jsx(nf,{clientThreadId:t,icon:s,setOpen:ft,open:ee,isDisabled:X,highlightTooltip:d,showLabel:m,hideBorder:x,isSmall:p,disabledReason:h,currentModelName:g,visualTreatment:y,showGlowingBorder:_,rateLimit:A});const Nt=N?e.jsx(xh,{layoutMode:j,triggerButton:de,connectors:Ne,handleOauthRedirect:ie,handleConnectorClick:Ge,isConnectorConfigLoading:L,desktopConnectors:ze,modelSupportedImageMimeTypes:o,showMenuForNoAuth:b,handleLocalFileUploadClick:le,restoreFocus:R}):e.jsxs(D.Root,{open:ee,onOpenChange:ft,children:[de,e.jsx(D.Portal,{children:e.jsx(D.Content,{alignOffset:-8,onEscapeKeyDown:()=>{Te.current=!0},side:K?"bottom":"top",size:"small",onCloseAutoFocus:G=>{Te.current||G.preventDefault()},className:"radix-side-bottom:flex-col-reverse flex flex-col",children:we})})]});return e.jsxs("div",{className:"flex flex-col",children:[e.jsx(Pd,{type:He,onClose:pt,uploadPickedFile:et}),e.jsx("input",{onChange:Oe,...u({className:"hidden"})}),Nt,e.jsx(Td,{hasConnectors:!L&&!Pe})]})}function bh(t,s){const{connector:n,clearParam:o}=Bd(),a=t.find(i=>i.type===n&&!!i.access_token);f.useEffect(()=>{a&&(s(a),o())},[a,s,o])}function yh({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:a,getInputProps:i,openFileDialog:r,onOauthRedirect:u,historyDisabled:l,isDisabled:c,highlightTooltip:d,disabledReason:m,currentModelName:p,showLabel:x,showUpsell:h,hideBorder:g,isSmall:y,showMenuForNoAuth:b,visualTreatment:_,showGlowingBorder:j}){const R=to(),{gdriveStatus:k,o365Status:E}=Pr(),{isUnauthenticated:w}=ve(),C=l?"text-white":d?"text-brand-blue-800":"",A=!h&&(b||k!=="false"||E!=="false"||R),T=w?vn:gr,L=e.jsx(T,{"aria-label":"",className:U("icon-md",C)}),O=A?e.jsx(Ei,{showGlowingBorder:j,hideBorder:g,isSmall:y,clientThreadId:t,icon:L,showLabel:w&&x,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:a,onOauthRedirect:u,uploadType:s,openFileDialog:r,getInputProps:i,isDisabled:c,highlightTooltip:d,disabledReason:m,currentModelName:p,showMenuForNoAuth:b,visualTreatment:_}):e.jsx(mi,{isSmall:y,hideBorder:g,clientThreadId:t,uploadType:s,openFileDialog:r,getInputProps:i,showLabel:x,showUpsell:h,icon:L,isDisabled:c,highlightTooltip:d,disabledReason:m,currentModelName:p,visualTreatment:_});return e.jsx(Ai,{showBackground:d,showGlowingBorder:j,className:"bg-brand-blue-800/20",children:O})}const vh=f.forwardRef(function({type:s,placeholder:n,replyRegions:o,state:a,renderFiles:i,leftSideActions:r,topRightAction:u,onSubmit:l,setIsComposerOverflowing:c,inputState:d,composerController:m,clientThreadId:p,gizmoId:x,disableReason:h,matchaData:g},y){const b=Ld();let _=null;const{isLoading:j}=b;j||(_=b.modelId),f.useEffect(()=>{j||Fd()||m.focus()},[_,m,j]);const{state:R,shouldShowResearchText:k}=Ms(p),E=f.useCallback(()=>e.jsx(Tr,{useStartButtonText:R==="clarify"||!1,inputState:d,state:a,onSubmit:l,composerController:m,clientThreadId:p,gizmoId:x,disableReason:h}),[d,a,l,m,p,x,h,g,R]),{whisperControls:w,waveContainerRef:C}=di({composerController:m,renderInComposer:E,composerType:"legacy"}),{controlsDisabled:A,waveformData:T,waveWidth:L}=ct(m.store),O=H=>{Ch({target:H.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||m.focus()};return e.jsx(Id,{id:"composer-background",ref:y,className:U("border-token-border-default flex w-full cursor-text flex-col overflow-clip rounded-t-3xl border-t duration-150 ease-in-out contain-inline-size motion-safe:transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow,bottom] dark:border-none dark:shadow-none",s!=="temporary"&&"shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)] has-focus:shadow-[0_2px_12px_0px_rgba(0,0,0,0.04),0_9px_9px_0px_rgba(0,0,0,0.01),0_2px_5px_0px_rgba(0,0,0,0.06)]",s!=="temporary"&&"bg-token-main-surface-primary dark:bg-[#303030]",s==="temporary"&&"dark bg-[#303030]","rounded-b-3xl border-b"),onClick:O,style:{viewTransitionName:"var(--vt-composer)"},children:e.jsxs("div",{className:"px-3 py-1",children:[e.jsx(Ie,{initial:!1,children:o.length>0&&e.jsx(Y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx("div",{className:"-mx-2",children:e.jsx(Br,{replyRegions:o})})})}),e.jsxs(e.Fragment,{children:[i,e.jsx(Ie,{initial:!1,children:e.jsx(df,{enabled:k,composerController:m,visualTreatment:"legacy",children:e.jsxs("div",{id:"composer-waveform-container",className:"flex min-h-[44px] items-start ps-1",ref:C,children:[e.jsx("div",{className:"max-w-full min-w-0 flex-1",children:A?T?e.jsx(Dd,{waveform:T,containerWidth:L,scaleFactor:10,initialValue:mf}):null:e.jsx(pf,{composerController:m,placeholder:n})}),e.jsx("div",{className:"w-[32px] pt-1",children:u})]})})}),e.jsxs("div",{className:"mt-1 mb-2 flex items-center justify-between sm:mt-5",ref:H=>{if(!("ResizeObserver"in window))return;const S=new AbortController;let I=window.innerWidth;const K=Od({axis:"width",debounce:!0,target:H,onChange:()=>{if(!H)return;H.scrollWidth>H.clientWidth?c?.(!0):Math.abs(I-window.innerWidth)>40&&(c?.(!1),I=window.innerWidth)}});return()=>{K?.(),S.abort()}},children:[e.jsx("div",{className:"text-token-text-primary flex gap-x-1.5",id:"composer-left-actions",children:r}),e.jsx("div",{className:"flex gap-x-1.5",id:"composer-voice-controls",children:w})]})]})]})})});function Ch({target:t,rootId:s,additonalInteractiveIds:n}){let o=t;for(;o&&o!=null;){if(o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="TEXTAREA"||o.isContentEditable||n.includes(o.id))return!0;if(o.id===s)return!1;o=o.parentElement}return!1}const wh=["o3-mini","o3-mini-high","o1-pro"],_h=[M.Search,M.Research],jh=5,kh=({composerController:t,clientThreadId:s,hideThinkButton:n,disableIfNoAccess:o,disabled:a,hasFiles:i})=>{const{prospectiveModelId:r}=Ds(s),{systemHints:u,activeSystemHints:l,isLoading:c}=Wt(s),d=ti(N=>N.bySystemHint(M.Research)),m=mo(),p=uo(),{value:x}=Me("1416952492"),h=Le(N=>N.isVisuallyOverflowing),{showLegacyReasoningSlider:g,hideSearchInSystemHintOverflow:y,hideReasonInSystemHintOverflow:b,configurationMenuType:_}=De(),j=Ze()?.isFree(),R=_!=="none",k=l.filter(N=>R&&(j||N.systemHint!==M.Think)||y&&N.systemHint===M.Search||b&&N.systemHint===M.Think?!0:h&&g?N.systemHint!==M.Think&&!N.composerBarButtonInfo&&!_h.includes(N.systemHint):!N.composerBarButtonInfo&&N.systemHint!==M.Search&&N.systemHint!==M.PictureV2&&(!n||N.systemHint!==M.Think));if(R&&j&&!k.find(N=>N.systemHint===M.Think)){const N=u.find(V=>V.systemHint===M.Think);N&&k.push(N)}const E=Is(t),w=dr(t,s),{clearAllSystemHintModeTriggers:C}=ae(),A=r&&wh.includes(r),T=k.length===0&&!c||A;if(!o&&T)return null;const L={clientThreadId:s};function O(){B.logEventWithStatsig("Composer System Hint Button Hovered","composer_system_hint_button_hovered",L)}function H(){B.logEventWithStatsig("Composer System Hint Button Clicked","composer_system_hint_button_clicked",L)}const S=N=>{switch(N){case M.Research:return!!p;case M.Think:return!!m;default:return!1}},I=()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.focus()})})},K=R?Ah:Mh;return e.jsx(K,{systemHints:k,selectedHint:E??void 0,disabled:a,onHover:O,onOpen:H,onSelect:w,clientThreadId:s,isDeepResearchHighLoad:x,getFeatureRateLimitIndicator:N=>{switch(N){case M.Research:return Eh(d);case M.Think:return m?e.jsx(Vt,{"aria-label":"",className:"icon-md text-token-text-secondary h-5 w-5"}):null;default:return null}},hasFeatureRateLimit:S,setRateLimitBannerFeature:N=>{switch(N){case M.Research:case M.Think:S(N)?(C(),t.setRateLimitBannerFeature(N===M.Research?Ba.DEEP_RESEARCH:Ba.REASON)):t.setRateLimitBannerFeature(null);break;default:t.setRateLimitBannerFeature(null);break}},restoreFocus:I,hasFiles:i})},Mh=({systemHints:t,selectedHint:s,disabled:n,onHover:o,onOpen:a,onSelect:i,isDeepResearchHighLoad:r,hasFeatureRateLimit:u,restoreFocus:l})=>{const c=W(),[d,m]=f.useState(!1),p=f.useRef(!1);f.useEffect(()=>{if(!d)return()=>{requestAnimationFrame(()=>{p.current=!1})}},[d]);const x=f.useRef(!1),h=t.length===0?e.jsxs("div",{className:"mx-2 flex min-h-[40px] flex-col justify-center gap-2",children:[e.jsx("div",{className:"loading-results-shimmer bg-token-bg-tertiary h-9 w-[180px] rounded-md"}),e.jsx("div",{className:"loading-results-shimmer bg-token-bg-tertiary h-9 w-[180px] rounded-md"})]}):e.jsx(e.Fragment,{children:t.map(g=>e.jsx(D.Item,{className:"px-1 py-2",onClick:()=>{const y=g.systemHint!==s;u(g.systemHint)||(p.current=!0,i?.({hint:g,enable:y}))},disabled:g.systemHint===M.Research?r:void 0,children:e.jsx(Ri,{title:g.name,description:g.description,logo:g.logo,checked:g.systemHint===s,badge:g.systemHint===M.PictureV2})},g.systemHint))});return e.jsxs(D.Root,{open:d,onOpenChange:g=>{m(g),g?a?.():requestAnimationFrame(()=>{requestAnimationFrame(()=>{p.current&&l()})})},children:[e.jsx(Ni,{disabled:!!n,children:e.jsx(Lr,{className:"border-token-border-default text-token-text-secondary radix-state-open:bg-black/10 can-hover:hover:bg-tertiary flex h-9 min-w-9 items-center justify-center rounded-full border p-1 text-xs font-semibold focus-visible:outline-black disabled:opacity-30 dark:focus-visible:outline-white","data-opened":Cn(d),"aria-label":c.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),id:"system-hint-button",disabled:n,onPointerOver:o,onClick:g=>{g.preventDefault()},onFocusCapture:g=>{g.stopPropagation()},children:e.jsx(Gd,{className:"pointer-events-none h-5 w-5"})})}),e.jsx(D.Portal,{children:e.jsx(D.Content,{size:"auto",alignOffset:-16,onEscapeKeyDown:()=>{x.current=!0},onCloseAutoFocus:g=>{if(!x.current||p.current){g.preventDefault();return}document.querySelector("#system-hint-button")?.focus()},children:h})})]})},Rh=[M.Slurm],Ah=({systemHints:t,selectedHint:s,disabled:n,onHover:o,onOpen:a,onSelect:i,clientThreadId:r,getFeatureRateLimitIndicator:u,isDeepResearchHighLoad:l,hasFeatureRateLimit:c,setRateLimitBannerFeature:d,restoreFocus:m,hasFiles:p})=>{const x=W(),[h,g]=f.useState(!1),{configurationMenuType:y}=De(),b=y==="config_icon"||y==="skills_icon",j=(y==="settings_icon"||y==="skills_icon")&&s==null,R=b?Hd:Ud,k=f.useRef(!1);f.useEffect(()=>{if(!h)return()=>{requestAnimationFrame(()=>{k.current=!1})}},[h]);const E=f.useRef(!1);return e.jsxs(D.Root,{open:h,onOpenChange:w=>{g(w),w?a?.():requestAnimationFrame(()=>{requestAnimationFrame(()=>{k.current&&m()})})},children:[e.jsx(Ni,{disabled:!!n,newToolsConfigMenu:y,skip:j,children:e.jsxs(Lr,{className:"composer-btn","data-opened":Cn(h),"data-pill":Cn(j),"aria-label":b?x.formatMessage({id:"RiMXTh",defaultMessage:"Use a skill"}):x.formatMessage({id:"mJYhKI",defaultMessage:"Choose tool"}),id:"system-hint-button",disabled:n,onPointerOver:o,onClick:w=>{w.preventDefault()},onFocusCapture:w=>{w.stopPropagation()},children:[e.jsx(R,{"aria-label":"",className:"icon-md"}),j&&e.jsx("span",{className:"ms-1.5 me-0.5",children:b?e.jsx(P,{id:"5+Ls1e",defaultMessage:"Skills"}):e.jsx(P,{id:"mNL7WC",defaultMessage:"Tools"})})]})}),e.jsx(D.Portal,{children:e.jsx(D.Content,{size:"auto",alignOffset:-8,onEscapeKeyDown:()=>{E.current=!0},onCloseAutoFocus:w=>{if(!E.current||k.current){w.preventDefault();return}document.querySelector("#system-hint-button")?.focus()},children:e.jsxs(D.RadioGroup,{value:s,onValueChange:w=>{const C=t.find(A=>A.systemHint===w);C&&(Kn(C.systemHint,C.systemHint===s?he.Disable:he.Enable,r),s===w?i?.({hint:C,enable:!1}):c(C.systemHint)||(k.current=!0,i?.({hint:C,enable:!0}),d(C.systemHint)))},children:[!j&&e.jsx(D.Label,{children:b?e.jsx(P,{id:"m/042P",defaultMessage:"Skills"}):e.jsx(P,{id:"KSn3Jr",defaultMessage:"Tools"})}),t.length===0?e.jsxs(e.Fragment,{children:[e.jsx(D.Shimmer,{}),e.jsx(D.Shimmer,{}),e.jsx(D.Shimmer,{})]}):e.jsx(e.Fragment,{children:t.map(w=>{const C=w.actionLabel??w.name,A=u(w.systemHint),T=w.systemHint===M.Research&&l,L=w.systemHint===M.Search&&p,O=T||L,H=T?e.jsx(P,{id:"composer.skills.unavailable",defaultMessage:"Temporarily unavailable"}):L?e.jsx(P,{id:"composer.search.skill.disabled.for.attachments",defaultMessage:"Remove attachments to search"}):void 0,S=Rh.includes(w.systemHint),I=w.systemHint===s;return e.jsxs(D.RadioItem,{value:w.systemHint,disabled:O,color:I?"selected":"default",icon:e.jsx($t,{svgString:w.logo,"aria-label":"",className:"icon-md"}),trailing:!T&&!I&&A?e.jsx("span",{className:"text-token-text-secondary",children:A}):e.jsx(D.RadioItemCheck,{}),secondary:H,children:[C,S&&e.jsx("span",{className:"bg-token-interactive-bg-accent-default text-token-interactive-label-accent-default rounded-lg px-1.5 text-[0.625rem] leading-[1.6] font-semibold uppercase",children:e.jsx(P,{id:"composer.skills.new",defaultMessage:"New"})})]},w.systemHint)})})]})})})]})},Ni=({disabled:t,children:s,newToolsConfigMenu:n,skip:o})=>{const a=n!=null,i=n==="config_icon"||n==="skills_icon",r=Re(ue.hasSeenComposerSystemHintButtonTooltip),l=!t&&!r.isLoading&&r.eligible?{announcementKey:ue.hasSeenComposerSystemHintButtonTooltip,title:a&&i?e.jsx(P,{id:"H819Oo",defaultMessage:"ChatGPT skills, all in one place"}):e.jsx(P,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:r.markAsViewed,description:e.jsx(P,{id:"Kgb5fv",defaultMessage:"Create an image, research report, and more."})}:void 0;if(o)return s;if(l)return e.jsx(Jn,{show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",sideOffset:0,className:"xs:max-w-sm! max-w-2xs!",...l,children:s});let c;return t?c=i?e.jsx(P,{id:"R3rcdg",defaultMessage:"Skills unavailable"}):e.jsx(P,{id:"uw9x80",defaultMessage:"Tools unavailable"}):a?c=i?e.jsx(P,{id:"SiU5Ib",defaultMessage:"Choose skill"}):e.jsx(P,{id:"Yr1zf1",defaultMessage:"Choose tool"}):c=e.jsx(P,{id:"mrYNGk",defaultMessage:"View tools"}),e.jsx(Xe,{side:"bottom",label:c,children:s})};function Eh(t){return!t||t.remaining>jh?null:t.remaining===0?e.jsx(Vt,{"aria-label":"",className:"icon-md text-token-text-secondary h-5 w-5"}):e.jsx(P,{id:"m6JsYD",defaultMessage:"{remaining} left",values:{remaining:t.remaining}})}const Pi=({clientThreadId:t})=>{const s=kp(),{setThreadSystemHintMode:n}=ae(),o=s?.location.search;f.useEffect(()=>{if(new URLSearchParams(window.location.search).get("enable-internal-knowledge")==="true"&&document){n(M.ContextualAnswers,!0,{clientThreadId:t});const i=new URLSearchParams(window.location.search);i.delete("enable-internal-knowledge");const r=i.toString();window.history.replaceState({},document.title,`${window.location.pathname}${r?`?${r}`:""}`)}},[o,t,n])},Nh=({composerController:t,systemHint:s,clientThreadId:n,connectionStatuses:o})=>{const a=Gn(),i=s.systemHint,r=qt(i);Pi({clientThreadId:n});const{enabled:u,availableConnectors:l,isLoading:c}=zs();if(!s.composerBarButtonInfo)return null;const d=o.some(m=>m.user_connection_details.activation_status==="partially_activated"||m.user_connection_details.activation_status==="activated");return e.jsx(wg,{composerController:t,systemHint:s,composerBarButtonInfo:s.composerBarButtonInfo,clientThreadId:n,isDisabled:!1,showLabel:a,dropdownContent:!d&&!u?e.jsx(Nn,{}):void 0,splitButtonDropdownContent:u?e.jsx(wo,{isLoading:c,clientThreadId:n,enabledConnectors:l,includeSyncConnectors:!0,includeWebSearch:!1}):d&&r?e.jsx(Nn,{}):void 0,dataTestid:zd,tooltipPosition:"top",disableNuxMarkdown:!0,as:u?"dropdown":"popover"})},Nn=()=>{const[t,s]=f.useState(),{connectionInstanceData:n,isLoading:o}=Hs(),a=f.useMemo(()=>[...n?.connection_statuses??[]].sort(xr),[n]),i=a.some(r=>r.user_connection_details.activation_status==="activating"||r.user_connection_details.activation_status==="partially_activated"||r.user_connection_details.activation_status==="inactive"&&r.user_connection_details.auth_status==="user_connected");return f.useEffect(()=>{B.logEventWithStatsig("Contextual Answers User Composer Dropdown Shown","chatgpt_contextual_answers_user_composer_dropdown_shown")},[]),o?e.jsx("div",{className:"w-full max-w-[calc(100vw-1.5rem)] min-w-[calc(100vw-1.5rem)] p-3 md:min-w-[22rem]",children:e.jsx(li,{lines:4,size:"lg"})}):e.jsxs(Ie,{children:[t&&e.jsx(br,{connection:t,onClose:()=>s(void 0)}),e.jsxs("div",{className:"w-full max-w-[calc(100vw-1.5rem)] min-w-[calc(100vw-1.5rem)] px-1 py-3 md:min-w-[22rem]",children:[a.map(r=>{const u=r.user_connection_details.activation_status,l=u==="partially_activated"||u==="activating";return e.jsx("div",{className:U("__menu-item",r.user_connection_details.activation_status==="activating"?"grayscale":void 0,l?"":"cursor-default"),onClick:c=>{l&&s(r),c.stopPropagation()},children:e.jsx(Wd,{title:r.connection_display_info.display_name,icon:e.jsx("img",{src:r.connection_display_info.icon_url??"",alt:r.connection_display_info.display_name,className:"icon-md"}),statusIndicator:e.jsx(Vd,{connection:r,location:"user_dropdown"})})},r.user_connection_details.connection_instance_id)}),e.jsx("div",{className:"__menu-item",onClick:r=>{window.location.hash="#settings/ConnectorSettings",r.stopPropagation()},children:e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-4 text-start",children:[e.jsx(Yn,{className:"icon-md"}),e.jsx("p",{className:"text-token-text-primary flex-1 text-sm font-medium",children:i?e.jsx(P,{id:"EqgQdy",defaultMessage:"See syncing state"}):e.jsx(P,{id:"05N3nu",defaultMessage:"Manage connectors"})})]})})]})]})};function Ph({systemHints:t,composerController:s,clientThreadId:n}){const{configurationMenuType:o}=De(),a=o!=="none",i=Is(s),r=t.find(({systemHint:c})=>c===i),{isUnauthenticated:u}=ve(),{setThreadSystemHintMode:l}=ae();return f.useEffect(()=>{o!=="none"&&i&&!t.some(({systemHint:c})=>c===i)&&!u&&l(i,!1,{clientThreadId:n})},[n,l,i,t,u,o]),r?e.jsxs("div",{"data-testid":"active-system-hint-pill",className:so("[view-transition-name:var(--vt-composer-active-system-hint-pill)",a&&"flex items-center gap-1.5 ps-0.5"),children:[e.jsx("div",{"data-separator":!0,className:"bg-token-border-default h-[13px] w-px"}),e.jsx(Th,{activeSystemHint:r,onClick:()=>{l(r.systemHint,!1,{clientThreadId:n})}})]},"active-hint-tag"):null}function Th({activeSystemHint:t,onClick:s}){const n=W(),{configurationMenuType:o}=De(),a=o!=="none";return e.jsxs(fo,{as:a?"button":"div",role:a?void 0:"button",tabIndex:a?void 0:0,onClick:s,spacing:"compact",isSelected:!0,isLegacyStyle:!0,borderVisible:!0,children:[e.jsx($t,{svgString:t.logo,className:a?"icon-md":"icon-md text-token-interactive-label-accent-default flex-1","aria-label":""}),e.jsx("span",{"data-label":!0,className:"mx-1.5",children:t.shortLabel??t.name}),a&&e.jsx(ni,{"aria-label":"",className:"icon-smaller -ms-0.5 mt-px @max-[521px]/thread:ms-1"}),!a&&e.jsx(Fr,{"data-remove-think-button":!0,className:"-me-1","aria-label":n.formatMessage({id:"HW9RTL",defaultMessage:"Disable {systemHintName}"},{systemHintName:t.name})})]})}function Bh({systemHints:t,composerController:s,clientThreadId:n,connectionStatuses:o}){Pi({clientThreadId:n});const{configurationMenuType:a}=De(),i=a!=="none",r=Is(s),u=t.find(({systemHint:b})=>b===r),{availableConnectors:l,isLoading:c,enabled:d}=po(),{availableConnectors:m,enabled:p,isLoading:x}=zs(),{connectorConfigMap:h}=pi({clientThreadId:n});if(!i||!u)return null;const g=r===M.Research,y=!1;return d&&(g||y)?e.jsx(Ya,{isLoading:c,clientThreadId:n,enabledConnectors:l,fetchValidLinksOnly:g||y,trigger:e.jsx(Qa,{clientThreadId:n,includeSyncConnectors:!1,includeWebSearch:!0})}):r===M.Slurm&&(o&&o.length>0||p&&m.length>0)?e.jsx(Ya,{clientThreadId:n,isLoading:x,enabledConnectors:m,includeWebSearch:!1,includeSyncConnectors:!0,connectorConfigMap:h,trigger:e.jsx(Qa,{clientThreadId:n,includeSyncConnectors:!0,includeWebSearch:!1})}):r===M.ContextualAnswers?e.jsx("div",{"data-testid":"sources-pill",className:so("[view-transition-name:var(--vt-composer-sources-pill)",i&&"flex items-center gap-1.5 ps-0.5"),children:e.jsx(Lh,{dropdownContent:e.jsx(Nn,{}),as:"popover"})},"sources-tag"):null}function Lh({dropdownContent:t,as:s}){const n=e.jsxs(fo,{as:"button",spacing:"compact",children:[e.jsx(yr,{className:"icon-md mx-1","aria-label":""}),e.jsx("span",{"data-label":!0,children:e.jsx(P,{id:"DhW8Wx",defaultMessage:"Sources"})}),e.jsx("div",{className:"me-0.5 flex items-center",children:e.jsx(At,{className:"pointer-events-auto! h-4 w-4"})})]}),o=s==="popover"?e.jsx(Ls,{children:e.jsx(mr,{className:"p-0",$as:Fs,side:"bottom",align:"start",collisionPadding:10,sideOffset:8,children:t})}):e.jsx(D.Portal,{children:e.jsx(D.Content,{children:t})});return s==="popover"?e.jsxs(Bs,{children:[e.jsx(bn,{asChild:!0,children:n}),o]}):e.jsxs(D.Root,{children:[e.jsx(D.Trigger,{asChild:!0,children:n}),o]})}function Fh({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:a,getInputProps:i,openFileDialog:r,onOauthRedirect:u,historyDisabled:l,isDisabled:c,highlightTooltip:d,disabledReason:m,currentModelName:p,showLabel:x,showUpsell:h,hideBorder:g,isSmall:y,visualTreatment:b,layoutMode:_,restoreFocus:j}){const R=to(),{gdriveStatus:k,o365Status:E}=Pr(),w="h-[20px] w-[20px]",C=l?"text-white":d?"text-brand-blue-800":"",A=h?e.jsx(vn,{"aria-label":"",className:U(w,C)}):e.jsx(vn,{"aria-label":"",className:U(w,C)}),T=(k!=="false"||E!=="false"||R||b==="vanguard")&&!h,L=zr(),O=b==="vanguard"&&!L,H=T?e.jsx(Ei,{hideBorder:g,isSmall:y,clientThreadId:t,icon:A,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:a,onOauthRedirect:u,uploadType:s,openFileDialog:r,getInputProps:i,isDisabled:O?!1:c,highlightTooltip:d,disabledReason:m,currentModelName:p,visualTreatment:b,layoutMode:_,restoreFocus:j}):e.jsx(mi,{isSmall:y,hideBorder:g,clientThreadId:t,uploadType:s,openFileDialog:r,getInputProps:i,showLabel:x,showUpsell:h,icon:A,isDisabled:c,highlightTooltip:d,disabledReason:m,currentModelName:p});return e.jsx("div",{className:"relative",children:e.jsx(Ai,{showBackground:d,className:"bg-brand-blue-800/20",children:H})})}const Ih=({clientThreadId:t,currentModel:s,uploadType:n,modelSupportedImageMimeTypes:o,modelAcceptedMimeTypes:a,modelProductFeatures:i,getEditorGizmoId:r,onOauthRedirect:u,disabledReason:l,isTemporaryChat:c,isDisabled:d,highlightTooltip:m,showLabel:p,showUpsell:x,numRemainingFiles:h,visualTreatment:g,layoutMode:y,restoreFocus:b})=>{const _=W(),j=Je(),{handleFileAccepted:R}=bo(_,n,o,"mouse",r,i?.attachments),{getInputProps:k,open:E}=xo({disabled:d,noClick:!0,onDropAccepted:R,onDropRejected:w=>So(w,_,j,n),multiple:!0,maxSize:Un,maxFiles:h,...On(a)});return e.jsx(Fh,{isSmall:!0,hideBorder:!0,isDisabled:d,highlightTooltip:m,onOauthRedirect:u,visualTreatment:g,attachmentsProductFeature:i?.attachments,clientThreadId:t,uploadType:n,modelAcceptedMimeTypes:a,modelSupportedImageMimeTypes:o,getInputProps:k,openFileDialog:E,historyDisabled:c,showLabel:p,showUpsell:x,disabledReason:l,currentModelName:s?.title??"",layoutMode:y,restoreFocus:b})};function Dh(){const s=Et().has(M.Research),n=!1,o=ye(),a=Mt(o,"3544641259");return(s||n)&&a}function Oh(){const t=eo(),o={initial:{opacity:0,y:"-28px",rotate:45},animate:{opacity:1,y:0,rotate:45,transition:t?Rt:{opacity:{delay:.4},default:Fa}},exit:{opacity:0,y:"-28px",rotate:45,transition:t?Rt:{opacity:{delay:0},default:Fa}}};return e.jsx(Y.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",className:"border-token-border-xlight bg-token-main-surface-primary absolute start-1/2 top-full mt-[11px] h-2 w-2 -translate-x-1/2 transform rounded-se-[1px] rounded-es-[1px] border-s border-t dark:bg-[#303030]"})}const Hh=({activeSystemHint:t,showHints:s,showContextChevron:n,onRemoveHint:o,lockSystemHint:a})=>{const i=W(),{popoverTriggerRef:r}=Zn(),u=()=>{requestAnimationFrame(()=>{r.current?.focus()})};if(t){const{logo:l,name:c}=t;return e.jsxs("div",{className:U("relative flex items-center justify-center",!a&&"-me-1"),children:[e.jsx($t,{className:"icon-md text-token-interactive-label-accent-default flex-1",svgString:l}),!a&&e.jsx(Fr,{"data-remove-hint-button":!0,onClick:d=>{d.stopPropagation(),d.preventDefault(),o(),u()},"aria-label":i.formatMessage({id:"YQ7uOV",defaultMessage:"Remove {tool} from selection"},{tool:c})}),n&&e.jsx(Oh,{})]})}return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-token-border-default ms-0.5 h-[16px] w-[1px]"}),e.jsx("div",{className:"text-token-text-tertiary hover:text-token-text-primary me-0.5 flex items-center",children:e.jsx(At,{className:"text-token-text-tertiary hover:text-token-text-primary pointer-events-auto! h-4 w-4"})})]}):e.jsx(qd,{"aria-label":i.formatMessage({id:"xosz07",defaultMessage:"View all tools"}),className:"text-token-text-secondary h-5 w-5"})},Uh={source:{id:"SystemHintCategory.Sources",defaultMessage:"Sources",description:"Label on system hint menu for hints that act as data sources"},tool:{id:"SystemHintCategory.Tools",defaultMessage:"Tools",description:"Label on system hint menu for hints that act as tools"}},Gh=({children:t,clientThreadId:s,layoutMode:n,lockSystemHint:o,composerController:a,onChangeSystemHint:i,systemHints:r,activeSystemHintType:u,recentSystemHintTypes:l,showHints:c,reasonItem:d=!1,gizmoId:m,isInReasonMode:p,type:x,...h})=>{const g=Dh(),y=eo(),b=W(),_=r.find(({systemHint:N})=>u===N),j=Ze(),R=l.map(N=>N===M.PictureV2&&!r.find(({systemHint:V})=>N===V)?r.find(({systemHint:V})=>V===M.Picture):r.find(({systemHint:V})=>N===V)).filter(N=>!!N),[k,E]=f.useState(null),w=(N,V)=>{V?E(N):i(N)},{selectedIndex:C,systemHintSuggestions:A,suggestorClosed:T,resetSelectedIndex:L}=Mi({composerController:a,clientThreadId:s,onHintSelected:i}),O=T?r:A,H=[],S=ki(O);let I=0;for(const N of S){const V=N.systemHints;V.length!==0&&(H.push({...N.category?{message:Uh[N.category]}:{},systemHints:V,indexOffset:I}),I=V.length)}const K=()=>{a.setReasonMode(!p),p?B.logEventWithStatsig("Composer Think Button Disabled","composer_think_button_disabled",{clientThreadId:s}):B.logEventWithStatsig("Composer Think Button Enabled","composer_think_button_enabled",{clientThreadId:s})};return e.jsxs("div",{className:U("flex items-center rounded-full",c&&"me-1 border",u!==void 0?"border-transparent":x==="toolpile_icon"?"border-token-border-default":"border-token-border-xlight"),children:[!_&&c&&e.jsx(Kd,{onChangeSystemHint:w,systemHints:R}),e.jsxs(go,{layoutMode:n,forceOpen:!T,...h,children:[t?e.jsx(ui,{children:t}):e.jsx(of,{transition:y?Rt:ks,shape:u?"rectangle":"round",spacing:"compact",isSelected:u!==void 0,"aria-label":b.formatMessage({id:"NLd5mV",defaultMessage:"Open tool menu"}),className:U(c&&"-mx-0.5",o&&"cursor-default!",x==="config_icon"&&"min-w-9",x==="toolpile_icon"&&"min-h-9"),onClick:N=>{if(o){N.stopPropagation(),N.preventDefault();return}},tooltipLabel:!u&&b.formatMessage({id:"xgQfBi",defaultMessage:"View all tools"}),disableHover:c&&!_||o,isLegacyStyle:x==="config_icon"||x==="toolpile_icon"&&!!u,borderVisible:x==="config_icon"||x==="toolpile_icon"&&!!u,children:e.jsx(Hh,{activeSystemHint:_,showHints:c,showContextChevron:g||!1,onRemoveHint:()=>i(null),lockSystemHint:o})}),e.jsx(ho,{onMouseDown:N=>{N.preventDefault()},align:"end",children:e.jsx($d,{onChangeSystemHint:w,systemHintCategories:H,activeSystemHint:u,activeIndex:C,resetActiveIndex:L,reasonItem:d,gizmoId:m,clientThreadId:s,handleToggleReasonItem:K,isInReasonMode:p})})]}),!j||j.planType===Mp.FREE&&e.jsx(Yd,{open:!!k,onOpenChange:()=>E(null),systemHint:k})]})},Ja="gpt-4o",zh=({clientThreadId:t,composerController:s,pendingFiles:n,isUploadDisabled:o,highlightUploadTooltip:a,hasFiles:i,conversationMode:r,placeholder:u,isTemporaryChat:l,layoutMode:c,state:d,inputState:m,disableReason:p,gizmoId:x,currentModel:h,replyRegions:g,uploadButtonDisabledReason:y,keepExpanded:b=!1,getEditorGizmoId:_,onOauthRedirect:j,onSubmit:R,visualTreatment:k,legacyFooterActions:E,legacySuggestionsPopoverContent:w,isNewThread:C=!1,isInReasonMode:A,modelSupportedSystemHints:T,contextualAnswerUserConnectionData:L,shouldUseBigComposer:O})=>{const{data:H}=Yt(),[S,I]=ja(!1),{updateSystemHint:K}=ae(),{configurationMenuType:N}=De(),V=N!=="none";Us();const z=Ke.useState(({persistedSystemHints:$})=>$);Qd(t,k==="vanguard");const J=Array.from(z)[0],ee=Ke.useState(({recentHints:$})=>$),{state:te}=Ms(t),Ae=_s(!1),Oe=Le($=>$.threads[t]?.modelSelection),He=Oe?.type===xe.SPECIFIC,Ee=Le($=>$.setThreadModelSelection),pt=k==="vanguard"&&h?.id!==Ja&&!He&&!S();Ir(f.useCallback(()=>{pt&&(Ae({location:"PromptTextarea",modelId:Ja}),_t(t,Ee,{type:xe.EFFORT_MODE,effortMode:_r.low}))},[pt,Ae,t,Ee]));const{setIsOpen:et}=Xd(),Ue=$=>{I(!0),K($,{clientThreadId:t}),$===M.Research?et(!0):et(!1),$&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.focus()})})},Ce=!1,ie=te==="clarify"||Ce,tt=f.useCallback($=>e.jsx(Tr,{isSmall:k==="vanguard",inputState:m,state:d,onSubmit:R,composerController:s,clientThreadId:t,gizmoId:x,disableReason:p,useStartButtonText:ie,disableTooltip:$}),[m,d,R,s,t,x,p,ie,k]),Ge=$=>{S()&&($.preventDefault(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.focus()})}))},le=Jd({inputState:m,state:d,composerController:s,clientThreadId:t}),{whisperControls:ft}=di({composerController:s,renderInComposer:tt,composerType:k,composerRightButtonType:le,layoutMode:c}),[ne=null,st,ze]=f.useMemo(()=>[In(h,r),Dn(h,r),Hn(h,r)],[h,r]);Wt(t);const Ne=Ke.useState(({availableHints:$})=>$),Pe=Ke.useState(({locked:$})=>$),we=f.useMemo(()=>Oe?.type===xe.EFFORT_MODE?Zd[Oe.effortMode]:"low",[Oe]),[X,Te]=ja(we);f.useEffect(()=>{Te(we)},[we,Te]),Re(ue.ModelPickerMoved);const de=Xn(x);te!=="disabled"||Ce||(r?.kind,Se.GizmoInteraction);const{pageType:Nt}=Dr(),G=Or($=>$.selectedApps),_e=Hr()&&G.length>0,We=i||_e,Ws=b||!!J||g&&g.length>0||We||Ne.length<3;Cs(h,r,z);const gt=qt(M.ContextualAnswers)&&!!C,{shouldShowResearchText:Xt}=Ms(t),nt=em(),Jt=tm({exposed:gt})==="bigbox",Zt=nt&&Xt||Jt&&gt;return e.jsxs(ff,{isBigBoxModeActive:Zt,isTemporaryChat:l,placeholder:u,visualTreatment:k,composerController:s,isExpandedByDefault:Ws,onSubmit:R,shouldUseBigComposer:O,children:[g&&g.length>0&&e.jsx(Ia,{children:e.jsx(Br,{replyRegions:g})}),We&&e.jsx(Ia,{children:e.jsx(wn,{files:n,fullBleed:!0,selectedApps:G,className:so("no-scrollbar -ms-1.5 flex flex-nowrap gap-2 overflow-x-auto",k==="composer-btn"?"horizontal-scroll-fade-mask py-1.5 ps-2 pe-4 [--edge-fade-distance:1rem]":"p-1.5")})}),[E?.map(($,es)=>e.jsx(gf,{children:$},`legacy-footer-action-${es}`))??[],(V&&e.jsx(Da,{children:e.jsx(Ph,{clientThreadId:t,composerController:s,systemHints:T})},"active-hint-tag"))??[],e.jsx(Da,{children:e.jsx(Bh,{clientThreadId:t,composerController:s,systemHints:T,connectionStatuses:L?.connection_statuses})},"sources-tag"),e.jsx(hf,{children:w},"legacy-suggestions-popover")],k==="vanguard"&&e.jsx(xf,{children:e.jsx(Gh,{activeSystemHintType:J,lockSystemHint:Nt.type==="landing-page"||Pe,systemHints:Ne,clientThreadId:t,composerController:s,onChangeSystemHint:Ue,layoutMode:c,recentSystemHintTypes:ee,showHints:!C,isInReasonMode:A,restoreFocus:Ge})},"system-hint-popover"),e.jsx(Sf,{children:ft}),nt&&Xt?e.jsx(Oa,{children:e.jsx(bf,{composerController:s,visualTreatment:"vanguard"})}):Jt&&gt?e.jsx(Oa,{children:e.jsx(sm,{composerController:s,visualTreatment:"vanguard"})}):null]})},Wh=ro(()=>io(()=>import("./evvu5p17v4x30nfh.js"),__vite__mapDeps([8,1,2,3,4,5,9,10,11,12,13,14])).then(t=>t.ImageGenComposer)),Vh=1,qh=3e3,Kh=()=>null;function $h({onCreateNewCompletion:t,onContinueGenerating:s,account:n,currentModelId:o,currentModelConfig:a,disableDraftPersistence:i=!1,modelCategories:r,areModelsLoading:u,clientThreadId:l,isNewThread:c,isCompletionInProgress:d,className:m,disabled:p=!1,disabledReason:x,canPause:h=!1,canContinue:g=!1,isInteractableSharedThread:y,onComposerInput:b,onComposerChange:_,onAutocompleteSelect:j,headerClassName:R,hideHeader:k,onTaggingDropdownOpen:E,onTaggingDropdownClose:w,onlyAllowImageUploads:C,shouldUseBigComposer:A}){vt.markStart("PromptTextarea"),vt.markRendered("PromptTextarea");const T=f.useContext(ri),L=Rp(T),O=ye(),H=f.useRef(null),S=dt(),I=nr(),K=Ap(I.showUploadSuggestion$),N=pr(),V=n?.isTeam(),{isUnauthenticated:z}=ve(),J=W(),ee=Je(),te=Bn(),Ae=Us(),Oe=nm.useStore(),[He,Ee,pt]=oe(l,v=>[se.getCurrentLeafId(v),se.getRequestId(v),se.findNode(v,q=>!!q.message.metadata?.b1de6e2_s)]),[et]=er(),{gizmoEditorData:Ue,mode:Ce,getGizmoId:ie}=Ts(),tt=Jr(),Ge=Gn(),le=Ep(),ft=om(),ne=ai(l),st=!!ei(),ze=!!mo(),Ne=am.useIsEnabled(l),Pe=!!co(),{setThreadSystemHintMode:we}=ae(),X=zt(),{state:Te}=Ms(l),de=X.has(M.Search),Nt=X.has(M.Think),G=Re(ue.ModelPickerMoved),_e=X.has(M.Research),{activeSystemHints:We}=Wt(l),Ws=We.length>0,gt=We.find(v=>v.systemHint===M.ContextualAnswers),Xt=rm(),{connectionInstanceData:nt,isLoading:Jt}=Hs({skip:!Xt}),{selectedSources:Zt,selectedMCPSources:$}=mt(l),es=im(O);Zp({skip:!es});const{platformConnectors:_o}=ef(es&&($?.size??0)>0),Ti=f.useMemo(()=>Array.from($??[]).map(v=>_o.get(v)).filter(v=>v!==void 0),[_o,$]),Vs=f.useRef(0),qs=f.useRef(!1),Bi=r?.find(v=>v.defaultModel===o),Li=Kh();let Q=Gt(l),Ks=Q&&"gizmo"in Q?Q.gizmo:void 0;const Fi=Np(),ot=Ks?.gizmo.id??Fi,Pt=Xn(ot),{name:Ii}=lm(),Di=Ii?Rm:Am,Oi=cm(),jo=um(),[me,ts]=f.useState(null);me!==null&&(Q={gizmo:me,gizmo_id:me.gizmo.id,kind:Se.GizmoInteraction},Ks=me);const Tt=Cs(a,Q,X),Hi=Gs(),ko=Gr(O).flags,ss=ko?.includes(Rs.NoAuthEnableFileUploads),{showLegacyReasoningSlider:at,showReasoningSliderNux:Ui,reasoningSliderType:Gi,hideReasonInSystemHintOverflow:zi,hideSearchInSystemHintOverflow:Wi,configurationMenuType:Mo}=De(),Ro=Mo!=="none",ns=Le(v=>v.setThreadModelSelection),Ao=Le(v=>v.threads[l]?.modelSelection),Eo=Ao?.type===xe.EFFORT_MODE?Ao.effortMode:null,No=!!Eo&&Eo!=="default";Ir(f.useCallback(()=>{No&&_t(l,ns,{type:xe.EFFORT_MODE,effortMode:"default"})},[No,l,ns])),uf({serverThreadId:ne,clientThreadId:l,composerController:S,currentModelId:o,account:n,getIsDisabled:f.useCallback(()=>!1,[]),onReset:()=>{_t(l,ns,{type:xe.EFFORT_MODE,effortMode:"default"})},onInfer:v=>{_t(l,ns,{type:xe.EFFORT_MODE,effortMode:v})},isInferEnabledForModel:a?.enableInfer});const Po=!p&&(Tt!==lt.None||u)&&(!z||ss),Ve=Dn(a,Q),$s=Hn(a,Q);let re=xn(v=>v.files);const[os]=f.useState(()=>dm());Ce==="magic"?re=re.filter(v=>v.gizmoId!=null):re=re.filter(v=>v.gizmoId==null);const To=mm(),pe=re.length>0||To,Bo=xn(qm.hasUploadInProgress),Ys=Or(v=>v.selectedApps),Lo=Hr()&&Ys.length>0,Vi=pe||Lo,qi=pm(l),Qs=S.useState(v=>{const q=fm(v);return typeof a?.maxTokens=="number"&&q>a.maxTokens}),Fo=S.useState(v=>!v.isEmpty()),as=!Qs&&!Bo&&(Fo||pe),Io=(Tt===lt.Multimodal?Ln:Fn)-re.length,Do=Io<=0,Ki=gm(),$i=Me("3544641259")?.value,{selectedRepos:Xs}=$n(l),Oo=Ki&&$i&&Zt?.size===0&&$?.size===0,ht=as&&!p&&!Pe&&(!d||jo)&&!Oo,[Ho,Yi]=f.useState(!1),{targetedContent:Uo,setTargetedContent:rs}=hm(),je=Uo?.isFocusedViewContent&&!ft?void 0:Uo;f.useEffect(()=>{requestAnimationFrame(()=>requestAnimationFrame(()=>S.focus()))},[je]);const Go=Q==null||Q?.kind===Se.PrimaryAssistant||Q?.kind===Se.GizmoInteraction&&Pt,{getUpsellLabelType:Qi,getUpsellShowsAttach:Xi}=xm(),Js=Ws&&Go,[Ji,Zi]=f.useState(!1),el=!z&&Go&&(!V||!Jt),xt=ct(S.store,v=>v.controlsDisabled);f.useEffect(()=>{if(!N?.id)return;const v=ka.getAndReset(N.id,ne);v&&S.setText(v.inputText)},[N?.id,ne,S]),f.useEffect(()=>{const v=et.get("prompt")??"";S.getCurrentText().length===0&&v.length>0&&S.setText(v)},[S,et]),f.useEffect(()=>{Ho!==ht&&(Yi(ht),ht&&Pp(!0).then(v=>{Sm.startEnforcement(v),Tp.startEnforcement(v)}))},[ht,Ho,Q?.kind,tt]);const is=In(a,Q),{handleFileAccepted:zo}=bo(J,Cs(a,Q,X),Ve,"mouse",ie,is?.attachments),tl=f.useCallback((v,q)=>(requestAnimationFrame(()=>{requestAnimationFrame(()=>{S.focus()})}),zo(v,q)),[S,zo]),{getInputProps:sl,open:Zs,inputRef:Wo}=xo({disabled:p||!Po||Do,noClick:!0,onDropAccepted:tl,onDropRejected:v=>So(v,J,ee,Tt),multiple:!0,maxSize:Un,maxFiles:Io,...On(z||C?Ve:$s)}),Vo=ct(os),qo=f.useCallback(()=>{S.eraseContent(),Vo.clearMessages(),S.resize(Vh),S.usedDictation=!1,S.dictationEdited=!1,S.dictationAssetPointer=null,S.dictationAssetTTL=null;for(const v of re)ys.remove(te,v.tempId,"none");bm.markAllAsSent()},[S,Vo,re,te]),Bt=ct(S.store,v=>v.isInReasonMode),Ko=f.useMemo(()=>pn(Bt,S,X)[0],[Bt,S,X]),$o=async(v,q)=>{if(v.preventDefault(),p||!as||!Q)return;const ce=S.getContentToSend(),fe=Km(ce.content),rt=pn(Bt,S,X),{content:cn,attachments:un}=$m(te,fe,a,Q,X);Oi(),t({sourceEvent:v,attachments:un,content:cn,contentToSend:ce,conversationMode:Q,hasSelectedApps:Lo,isAuraSidebar:L,isMessageFollowupsEnabled:Ne,selectedApps:Ys,selectedGizmoTag:me,selectedRepos:{selectedAllRepos:Xs.selectedAllRepos,selectedRepos:Xs.selectedRepos?[...Xs.selectedRepos]:null},selectedSources:Zt,selectedMCPConnectors:Ti,systemHints:rt,usedDictation:S.usedDictation,dictationEdited:S.dictationEdited,dictationAssetPointer:S.dictationAssetPointer,dictationAssetTTL:S.dictationAssetTTL}),je?.onCreateCompletion?.({serverThreadId:ne,currentLeafId:He}),je?.shouldPersistAcrossMessages!==!0&&rs(void 0),Ma.hideThreadHeader();for(const va of re)va.status===Ym.Ready&&Oe.addFile(va);qo()},nl=v=>{rs(v.targetedReply),v.targetedReply&&B.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:ne,sourceMessageId:v.messageId})},{maybeSetWaitingForRealtimeOnAbort:Yo,isWatingForRealtimeStatusChange:ol}=ym(l),en=f.useCallback(v=>{Yo(),vm(v)},[Yo]),Qo=f.useCallback(()=>{je?.onCleared?.({serverThreadId:ne,currentLeafId:He}),rs(void 0),S.focus()},[He,ne,je,rs,S]),Xo={Enter:{validator:v=>{const q=v.isComposing||v.keyCode===229;return!(cs&&qs.current)&&(v.metaKey||(Ge||Ip||Dp())&&!v.shiftKey&&!q)},handler:v=>{if(!ht){Qs&&ee.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}v.preventDefault(),$o(v)}},Escape:{validator:v=>!v.isComposing,handler:v=>{h&&d&&(en(l),B.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:Ot(l),currentLeafId:se.getCurrentNode(Fe(l)).message.id,eventSource:"keyboard"})),v.target.value===""&&Qo()}}},Lt=f.useRef(Xo);Lt.current=Xo;const ls=Cm(a?.tags,Q?.kind),{showTaggingDropdown:tn,isFocused:al,autocompletions:qe,matchaData:rl}=ct(S.store),cs=al&&qe.length>0,St=ls&&tn&&!Pt,Jo=S.isReady();f.useEffect(()=>S.subscribe("keydown",v=>{S.acceptLegacyKeydown()&&Lt.current[v.key].validator(v)&&Lt.current[v.key].handler(v);const ce=S.getCurrentText();if(v.key==="@"){const fe=S.getSelectionStart(),rt=ce.substring(0,fe);(!rt||/\s$/.test(rt)||fe===0)&&setTimeout(()=>S.setShowTaggingDropdown(!0),10)}else tn&&S.setShowTaggingDropdown(!1);v.key==="Escape"&&(ts(null),S.setAutocompletions([])),de&&v.key==="Escape"&&we(M.Search,!1,{clientThreadId:l})}),[S,Jo,tn,X,de,we,l]),f.useEffect(()=>{const v=Object.fromEntries(Object.keys(Lt.current).map(q=>[q,fe=>{const rt=Lt.current[q];if(!rt||S.acceptLegacyKeydown())return!1;const{validator:cn,handler:un}=rt;return cn(fe)?(un(fe),!0):!1}]));S.registerKeyHandlers(v),S.registerFileInput({openFileDialog:Zs,inputRef:Wo})},[S,Zs,Wo,Jo]),f.useEffect(()=>S.subscribe("paste",v=>{wm({filePickerStore:te,event:v,intl:J,toaster:ee,clientThreadId:l,conversationMode:Q,currentModelConfig:a,getEditorGizmoId:ie,modelSupportedImageMimeTypes:Ve,persistedSystemHints:X})}),[J,l,Q,a,ie,Ve,S,ee,te,X]);const Zo=v=>{st||ts(v),S.trimLeadingText("@"),Sn(),S.setShowTaggingDropdown(!1)},il=_m(l,os,Ve,is?.attachments),ll=f.useCallback(v=>{v.preventDefault(),en(l),B.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:Ot(l),currentLeafId:se.getCurrentNode(Fe(l)).message.id,eventSource:"mouse"}),Sn()},[l,en]),us=f.useCallback(()=>{ka.set(N?.id,ne,S.getCurrentText())},[ne,N?.id,S]);f.useEffect(()=>{Ue||jm()||S.focus()},[S]),f.useEffect(()=>{if(Ve.length>0)for(const q of re)km(q.fileSpec?.mimeType,$s)||ys.remove(te,q.tempId,"none");else ys.reset(te)},[o,te]),f.useEffect(()=>{(!ls&&me||st)&&ts(null)},[ls,me,st]),f.useEffect(()=>{ze&&S.setReasonMode(!1)},[ze,S]),f.useEffect(()=>{pe&&X.has(M.Search)&&we(M.Search,!1,{clientThreadId:l})},[pe,l,we,X]);const{layer:cl}=Ye("4031588851"),{layer:ea}=Ye("3637408529"),ul=ea.get("is_in_composer_text_exp",!1),dl=ea.get("composer_text","MESSAGE_CHATGPT"),ml=cl.get("composer_text","MESSAGE_CHATGPT"),pl=ul?dl:ml,[ds,fl]=(()=>{switch(x){case"workspaceDisallowsGizmo":return[Z.disallowedByWorkspacePlaceholder,!0];case"noModelsAvailable":return[Z.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Z.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Z.loading,!0];case"noTestGizmoId":return[Z.noTestGizmoId,!0];default:{if(y)return[Z.placeholderWithName,!1];if(je?.placeholderTextOverride!=null)return[je.placeholderTextOverride,!1];if(Te==="initial"||Te==="recurrent")return[Z.deepResearchPlaceholder,!1];if(Te==="clarify")return[Z.researchSuggestionInitial,!1];if(Ko)switch(Ko){case M.Search:return[Z.searchPlaceholder,!1];case M.Think:return[Z.thinkPlaceholder,!1];case M.Slurm:return[Z.connectorPlaceholder,!1];case M.Research:return[Z.researchPlaceholder,!1];case M.Canvas:return[Z.canvasPlaceholder,!1];case M.Picture:return[Z.picturePlaceholder,!1];case M.PictureV2:return[Z.pictureV2Placeholder,!1];case M.ContextualAnswers:return[Mm.caSuggestionInitial,!1]}switch(pl){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Z.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Z.placeholderAskNameAnythingVariant,!1];default:return[Z.placeholderWithName,!1]}}}})(),sn=Pt?c?J.formatMessage(Di.newChatInProject):ds?J.formatMessage(ds,{name:"ChatGPT"}):"​":ds?J.formatMessage(ds,{name:Ue!=null?Ce==="magic"?Em:Ue.name||"GPT":Ks?.gizmo.display.name??"ChatGPT"}):"​";f.useEffect(()=>S.subscribe("input",()=>{Nm.getState().isThreadHeaderVisible&&Ma.hideThreadHeader()}),[S]),f.useEffect(()=>S.subscribe("input",()=>{Vs.current=performance.now(),b?.()}),[S,b]),f.useEffect(()=>{if(_)return S.subscribe("change",()=>{_()})},[S,_]);const ta=Pm()&&!!qe.find(v=>!!v.requires_file_upload),gl={clientThreadId:l,uploadType:Tt,modelAcceptedMimeTypes:$s,modelSupportedImageMimeTypes:Ve,attachmentsProductFeature:is?.attachments,getInputProps:sl,openFileDialog:Zs,historyDisabled:le,onOauthRedirect:us,highlightTooltip:ta&&!pe},Ft=[],sa=[],na=!p&&!Do&&(Po||Hi!=null),oa=Xi(),hl=!z||oa||ss,aa=Tt===lt.None?Ct.ModelNotSupported:Nt?Ct.ThinkModeInUse:de?Ct.SearchModeInUse:void 0;if(hl){const v=e.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:e.jsx(yh,{...gl,showGlowingBorder:K,showLabel:Qi()==="all",showUpsell:oa&&!ss,showMenuForNoAuth:ss,isDisabled:!na||xt,disabledReason:aa,currentModelName:a?.title??"",visualTreatment:Ro?"composer-btn":"legacy"})},"file-upload-button");Ft.push(v),sa.push(v)}const Be=[],ra=Ur(),ia=Le(v=>v.isVisuallyOverflowing)&&at;let ms="bottom";ra?ms="bottom":c&&(ms="centered"),at&&(Q?.kind!==Se.GizmoInteraction||Pt)&&Be.push(e.jsx("div",{"data-testid":"composer-action-reasoning-level",className:"flex [--pill-color:var(--text-secondary)] [--pill-font-size:13px]",onPointerDown:v=>v.stopPropagation(),children:e.jsx(Jn,{announcementKey:ue.ModelPickerMoved,side:"bottom",show:Ae&&Ui&&!G.isLoading&&G.eligible,onDismiss:G.markAsViewed,theme:"bright",badge:"none",dismissOnOutsideClick:!0,sideOffset:0,title:e.jsx(P,{id:"NGN4SW",defaultMessage:"Set how long ChatGPT should think or pick a different model"}),children:e.jsx(ah,{clientThreadId:l,layoutMode:ms,currentModel:a,category:Bi,type:Gi,mode:Pt?"model-picker-only":"default"})})},"reasoning-level")),Wi||Be.push(e.jsx($g,{account:n,clientBootstrapFlags:ko,features:tt,currentModelConfig:a,hasFiles:pe,isDisabled:xt||pe,clientThreadId:l,composerController:S,gizmoId:ot},"search"));const{value:xl}=Me("1830177352");!at&&!zi&&Be.push(e.jsx(Vg,{clientThreadId:l,gizmoId:ot,composerController:S,isDisabled:xt},"reason")),xl&&Be.push(e.jsx(zg,{clientThreadId:l,gizmoId:ot,showLabel:!0,isDisabled:xt},"deep-research")),ia||Be.push(e.jsx(og,{clientThreadId:l,composerController:S,isDisabled:xt,currentModelConfig:a,currentModelConfigLoading:u,disableIfNoAccess:at},"shiba")),Mt(O,"3240576626");const{enabled:Sl}=zs();if(gt&&!ia&&(nt&&nt.connection_statuses.length>0||Sl)&&Be.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-search-action)"},"data-testid":"composer-action-contextual-answers",children:e.jsx(Nh,{composerController:S,systemHint:gt,clientThreadId:l,connectionStatuses:nt?.connection_statuses??[]})},"contextual-answers")),el&&Be.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-hint-action)"},"data-testid":"composer-action-system-hint-button",children:e.jsx(kh,{composerController:S,clientThreadId:l,disabled:xt,hideThinkButton:at,disableIfNoAccess:at,hasFiles:pe})},"system-hint-button")),Mo==="none"){const v=Be.filter(q=>L?q.key==="search":!0);Ft.push(...v)}else{const v=Be.find(q=>q.key==="system-hint-button");v&&Ft.push(v)}const nn=Mt(O,"2007855518"),la=pt?.message.metadata?.async_task_id,on=Tm(v=>la?v.tasks[la]:null),[bl,ca]=f.useState(!1),an=on?.status===Bm.RUNNING,rn=fl||ol?"disabled":"default",ua=Lm(Ot(l)||l)?.value,yl=ua===La.STREAMING,vl=ua===La.REALTIME,da=d&&h||yl||vl||an&&nn,Cl=Bp(),wl=!ht||Cl,ln=zm(Bo,Fo,Qs,qi,!Oo,an,nn),bt=da?"streaming":wl?"disabled":"idle",It=f.useRef(null),yt=f.useRef(null),{value:_l}=Me("222560275"),jl=_l||o&&!o.startsWith("o1")&&!o.startsWith("o3");f.useEffect(()=>{const v=()=>{It.current!=null&&Zr.addAction("composer_state_disabled",{threadId:Ot(l),disabledReason:It.current})};if(as&&bt==="disabled"){let q="unknown";p?q=x??"component_disabled_unknown":d?q="completion_in_progress":Pe&&(q="thread_hard_blocked"),It.current!==q&&(yt.current&&clearTimeout(yt.current),yt.current=setTimeout(v,qh)),It.current=q}else It.current=null;return()=>{yt.current&&(clearTimeout(yt.current),yt.current=null)}},[l,as,bt,p,x,d,Pe]);const ps=[];if(je?.label&&ps.push({type:je.type,value:je.label,onRemoveRegion:Qo}),me!==null){const v=!!me.gizmo.tags?.includes(Os.FirstParty);ps.push({type:"mention",value:me.gizmo.display.name,icon:e.jsx(ii,{isFirstParty:v,src:me.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{ts(null),S.focus()}})}f.useEffect(()=>{(!qe||qe.length===0||!cs)&&(qs.current=!1)},[qe,cs]);const kl=f.useCallback((v,q,ce)=>{qs.current=v>=0,q&&S.setText(ce?`${ce.title}${ce.body}`:"")},[S]),ma=cs&&qe&&qe.length>0&&!St&&!_e&&!S.hasMultipleLines()&&S.canShowAutocompletion();f.useEffect(()=>{St?E?.():w?.()},[St,E,w]);const fs=v=>{if(v.preventDefault(),v.stopPropagation(),Vs.current>0){const q=performance.now()-Vs.current;Op.hist(Hp.DEFAULT,"final_user_input_to_submit_ms",[],q)}bt==="streaming"&&(!jo||S.isEmpty())?an&&nn?ca(!0):ll(v):$o(v)},Ml=Fm(a,lo.Canvas),Rl=Im(),Al=Ml&&!Rl&&!To&&!ra;f.useEffect(()=>{},[Li,S]),f.useEffect(()=>{const v=Ot(l),q=n?.normalizedAccountUserId;if(!q||i)return;const ce=ws(()=>{const fe=S.getContentToSend().content;fe===""?Lp(v):Fp(v,fe,q)},1e3);return S.subscribe("change",ce)},[n,l,S,i,ne]);const pa=e.jsx(ih,{canUseInlineTagging:ls,isDisabled:p,clientThreadId:l,currentLeafId:He,currentRequestId:Ee,canContinue:g,composerController:S,isNewThread:c,onContinueGenerating:v=>s({event:v,conversationMode:Fe(l)?.mode,systemHints:pn(Bt,S,X)}),onResetState:qo,conversationMode:Q,isShowingAutocomplete:!!ma,shouldUseBigComposer:A}),fa=!da&&Q!=null&&jl&&Dm.includes(Q.kind)&&e.jsx(Om,{clientThreadId:l,onTargetedReply:nl}),ga=ma&&e.jsx("div",{className:"bg-token-main-surface-primary absolute start-0 z-[-1] box-border w-full ps-0 max-lg:bottom-full lg:top-full",children:e.jsx(eg,{suggestions:qe,composerController:S,onSelect:j,onChange:kl})}),ha=e.jsx(Vm,{composerController:S,parsedDocumentHandler:il}),xa=!k&&e.jsx(xi,{className:R}),Sa=e.jsx(Hm,{modelSupportedImageMimeTypes:Ve,uploadType:lt.Multimodal,attachmentsProductFeature:is?.attachments}),El=e.jsxs(e.Fragment,{children:[St&&e.jsx(qa,{onClick:v=>Zo(v),onClose:()=>{S.setShowTaggingDropdown(!1),S.focus()}}),Js&&e.jsx(Xa,{composerController:S,clientThreadId:l})]}),{isImageGenEditor:ba}=Um(),ya=Mt(O,"3760395675");return ba?e.jsxs(Ra.Provider,{value:os,children:[e.jsx(Ea,{onOauthRedirect:us,children:e.jsx(Aa,{defaultOpen:ya,children:e.jsx("form",{id:"prompt",className:m,onSubmit:fs,children:e.jsxs("div",{className:"relative z-1 flex h-full max-w-full flex-1 flex-col",children:[xa,e.jsxs("div",{className:"group relative z-1 flex w-full items-center",style:{"--force-hide-label":Ji?"none":"block"},children:[e.jsxs(Bs,{open:St||Js,children:[e.jsx(Vn,{className:"w-full",children:ba?e.jsx(Wh,{type:le?"temporary":"default",ref:H,placeholder:sn,inputState:rn,composerController:S,leftSideActions:sa,state:bt,onSubmit:fs,renderFiles:pe&&e.jsxs(e.Fragment,{children:[Ce==="magic"&&e.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-secondary m-2 mb-0 rounded-lg p-2 text-xs",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(wn,{files:re,className:"-ms-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:l,gizmoId:ot,disableReason:ln,modelId:o}):e.jsx(vh,{type:le?"temporary":"default",ref:H,replyRegions:ps,placeholder:sn,inputState:rn,setIsComposerOverflowing:Zi,composerController:S,matchaData:rl,leftSideActions:Ft,topRightAction:Al&&e.jsx(Wm,{composerRef:H,composerController:S,clientThreadId:l}),state:bt,onSubmit:fs,renderFiles:Vi&&e.jsxs(e.Fragment,{children:[Ce==="magic"&&e.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-secondary m-2 mb-0 rounded-lg p-2 text-xs",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(wn,{files:re,selectedApps:Ys,className:"-ms-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:l,gizmoId:ot,disableReason:ln,modelId:o})}),e.jsx(Ls,{children:e.jsxs(Fs,{side:"bottom",align:"start",sideOffset:12,onOpenAutoFocus:v=>v.preventDefault(),children:[St&&e.jsx(qa,{onClick:v=>Zo(v),onClose:()=>{S.setShowTaggingDropdown(!1),S.focus()}}),Js&&e.jsx(Xa,{composerController:S,clientThreadId:l})]})})]}),ga]}),ha,Sa]})})})}),pa,fa]}):e.jsx(Ra.Provider,{value:os,children:e.jsxs(Aa,{defaultOpen:ya,children:[e.jsx(Ea,{onOauthRedirect:us,children:e.jsxs("div",{className:U("max-xs:[--force-hide-label:none] relative z-1 flex h-full max-w-full flex-1 flex-col",at&&!Ae&&"[--force-hide-label:none]"),children:[xa,on&&bl&&e.jsx(Gm,{taskId:on.taskId,clientThreadId:l,onClose:()=>ca(!1)}),e.jsx(zh,{visualTreatment:Ro?"composer-btn":"legacy",hasFiles:pe,pendingFiles:re,isUploadDisabled:!na,isNewThread:c,clientThreadId:l,getEditorGizmoId:ie,highlightUploadTooltip:ta&&!pe,disableReason:ln,uploadButtonDisabledReason:aa,currentModel:a,layoutMode:ms,conversationMode:Q,onOauthRedirect:us,state:bt,inputState:rn,gizmoId:ot,isTemporaryChat:le,placeholder:sn,composerController:S,onSubmit:fs,replyRegions:ps,keepExpanded:!0,legacyFooterActions:Ft,legacySuggestionsPopoverContent:El,isInReasonMode:Bt,modelSupportedSystemHints:We,contextualAnswerUserConnectionData:nt,shouldUseBigComposer:A}),ga]})}),ha,pa,fa,Sa]})})}const bx=({clientThreadId:t,isNewThread:s,isGizmoThread:n,isProjectThread:o,isModelLoaded:a,currentModelId:i,onRequestCompletion:r,shouldUseUnifiedComposer:u,shouldUseBigComposer:l,onlyAllowImageUploads:c})=>{const d=dt(),{pageType:m}=Dr(),p=m?.type==="landing-page",x=f.useContext(ri),h=zp(x),g=Ur();Ze(),ep(d);const y=async k=>{if(Fe(t)?.isLoading!==!1)return;const E=await op(k);r(E)},b=f.useCallback(k=>{B.logEvent("Continue Completion"),r(tp(k))},[r]),_=sp.useState(k=>k.isReplayEnabled),j=e.jsxs(e.Fragment,{children:[e.jsx(fg,{clientThreadId:t}),e.jsx(fn,{verticalMargin:"none",verticalPadding:h?"last-standard":"none",horizontalPadding:"standard",children:e.jsx(gn,{children:_?e.jsx(np,{clientThreadId:t},t):e.jsx(Yh,{clientThreadId:t,currentModelId:i,isNewThread:s,hideHeader:s,onRequestCompletion:y,onContinueGenerating:b,onAutocompleteSelect:d.onAutocompleteSelect,onlyAllowImageUploads:c,shouldUseBigComposer:l})})})]}),R=s&&e.jsx("div",{className:U("[display:var(--display-hidden-until-loaded,block)] md:absolute md:start-0 md:bottom-6 md:w-full"),children:e.jsx(fn,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(gn,{children:e.jsx(xi,{className:"block flex-1"})})})});return u?e.jsxs(e.Fragment,{children:[g&&R,e.jsx("div",{id:"thread-bottom",children:j}),!g&&R,s&&!p&&!n&&!0&&!o&&e.jsx(fn,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(gn,{children:e.jsx(mg,{clientThreadId:t,currentModelId:i,isModelLoaded:a})})})]}):j};function Yh({clientThreadId:t,currentModelId:s,disableDraftPersistence:n=!1,isNewThread:o,onRequestCompletion:a,onContinueGenerating:i,onComposerInput:r,onComposerChange:u,onAutocompleteSelect:l,headerClassName:c,hideHeader:d,onTaggingDropdownClose:m,onTaggingDropdownOpen:p,onlyAllowImageUploads:x,shouldUseBigComposer:h}){const{data:g,isLoading:y}=Yt(),[b,_,j,R,k]=oe(t,ee=>{const te=se.getCurrentNode(ee);return[te.message.clientMetadata?.errType!=null&&te.message.clientMetadata.errType!=="info",Wp(se.getCurrentNode(ee).message),ee?.mode,ee?.continuingFromSharedConversationId!=null,!!ee?.continuingFromSharedPostId]}),E=Ze(),w=dt(),C=Up({clientThreadId:t}),{isOpen:A,onClose:T}=Qm({type:"just-hit-rate-limit"}),L=f.useMemo(()=>C?!1:!b&&_,[b,_,C]),O=C,H=Yr(t),S=qn(H).data,I=Gp(),K=S?.gizmo.tags?.includes(Os.WorkspaceDisabled)&&!I?"workspaceDisallowsGizmo":g?.models.size===0?"noModelsAvailable":j?.kind===Se.GizmoTest&&j.gizmo_id==null?"noTestGizmoId":null,N=Fl(),V=Xm(),z=N.action==="moderate",{value:J}=Me("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx(Mf,{composerController:w,clientThreadId:t,currentModelId:s,isCompletionInProgress:C}),e.jsx("div",{className:"flex justify-center empty:hidden",children:V&&z&&J?e.jsx(Jm,{}):null}),A?e.jsx(Zm,{onClose:T}):null,e.jsx($h,{clientThreadId:t,disableDraftPersistence:n,onCreateNewCompletion:a,onContinueGenerating:i,currentModelId:s,account:E,modelCategories:g?.categories,currentModelConfig:jr(g?.models,s),areModelsLoading:y,isNewThread:o,isCompletionInProgress:C,className:"w-full",canContinue:L,disabled:!!K,disabledReason:K??void 0,canPause:O,isInteractableSharedThread:R||k,onComposerInput:r,onComposerChange:u,onAutocompleteSelect:l,headerClassName:c,hideHeader:d,onTaggingDropdownClose:m,onTaggingDropdownOpen:p,onlyAllowImageUploads:x,shouldUseBigComposer:h},t)]})}export{Cf as D,px as F,xx as I,Sx as M,gx as N,Yh as P,bx as T,fx as a,Wh as b,vf as c,Ga as d,vo as g,So as h,hx as u};
//# sourceMappingURL=nlj97v8clhezwsxr.js.map

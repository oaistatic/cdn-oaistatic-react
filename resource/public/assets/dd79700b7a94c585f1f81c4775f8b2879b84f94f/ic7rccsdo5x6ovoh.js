const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jtb083g97bhz26ld.js","assets/cs2gapsc2bulabhw.js","assets/bugk7hk34lc7gpmk.js","assets/eb6xg52mym6rhnsh.js","assets/root-o1pc79my.css","assets/lke98o3quu88wwkl.js","assets/6mewn5riemy4ndrm.js","assets/pduvb49qgyq1mqhk.js","assets/conversation-small-ggtqjiqs.css"])))=>i.map(i=>d[i]);
import{c as L,f as K,r as w,a as Ye,j as t,M as v,l as rt,u as Ze,v as Fs,d as ve,L as Zt,a5 as Qt,a6 as Ps,R as Ts,g as St}from"./cs2gapsc2bulabhw.js";import{e as Gs,ce as se,ow as De,dO as Jt,d_ as Es,bz as We,cg as ne,ch as ae,dR as Ds,dS as Lt,dT as As,dM as le,dU as y,dV as Os,dX as Us,dY as mt,dZ as yt,e0 as Ls,e9 as Qe,eb as Je,h as Rs,e3 as Bs,e4 as Hs,lD as $s,ox as qs,oy as Vs,dx as Ks,ei as ke,jQ as Ws,dP as Xs,oz as ut,oA as Ys,b4 as Zs,oB as ft,oC as Qs,dy as Js,oD as Rt,dF as en,dA as lt,oE as tn,oF as sn,oG as nn,oH as et,oI as an,oJ as on,oK as rn,dz as ln,lJ as cn,oL as dn,oM as es,z as Ct,oN as Bt,oO as mn,oP as Nt,oQ as ts,oR as Mt,jh as un,ji as fn,oS as xn,np as gn,oT as ss,oU as hn,oV as pn,oW as ns,oX as jn,f4 as vn,oY as bn,ep as as,d as Sn,oZ as yn,j7 as Cn,o_ as Ht,o$ as Nn,p0 as Mn,p1 as os,p2 as wn,p3 as xt,p4 as ct,G as wt,x as tt,el as _n,p5 as is,bs as Xe,p6 as rs,p7 as kn,ac as Ie,e2 as In,n_ as zn,p8 as Fn,p9 as Pn,dL as st,eE as Tn,ej as Gn,pa as ls,en as _t,pb as En,e7 as Ae,pc as cs,pd as Dn,pe as An,e6 as gt,pf as On,pg as Ve,cL as Un,nd as Ln,bT as ds,aZ as he,U as ce,ph as ms,c$ as Rn,j1 as Bn,pi as us,pj as Hn,pk as $n,pl as qn,pm as Vn,pn as fs,ec as xs,po as Kn,pp as Wn,hR as gs,bj as hs,bA as Xn,a6 as Yn,kh as ps,eq as Zn,hP as Qn,iM as Jn,pq as ea,aY as js,ee as ta,pr as sa,ps as na,pt as aa,lE as oa,v as ia,X as ra,A as la,pu as ca,pv as da,pw as ma,mn as ua,px as fa,py as xa,fH as ga,pz as ha,pA as pa,d3 as ja,pB as va,cz as ba,bZ as Sa,pC as ya,kd as nt,hD as vs,pD as Ca,pE as Na,pF as Ma,pG as wa,pH as _a,pI as ka,pJ as $t,pK as Ia,pL as za,kb as Fa,kc as Pa,h8 as qt,hC as Ta,bd as Ga,kI as Ea,ef as Da,pM as Aa}from"./pduvb49qgyq1mqhk.js";import{O as ze,_ as Fe,f as xe,j as Oe,ai as Oa,c as U,c8 as Vt,B as pe,h as Ue,b0 as kt,aG as Ua,F as Pe,bQ as La,hp as Ra,i as Ke,aD as ht,bP as Ba,dm as It,e as te,aK as Ha,dG as $a,du as qa,cV as bs,o as at,L as Ss,aa as pt,d6 as Va,dB as zt,b6 as Ka,fc as Wa,gS as Xa,a9 as Ge,bk as Ft,cP as Ee,al as Ya,c3 as Se,gj as Za,am as ot,dc as Qa,aV as jt,bb as Ja,b as Pt,aJ as eo,aw as to,ba as so,aE as Tt,d as no,dj as ao,bc as oo,bE as io,k as vt,ab as Kt}from"./eb6xg52mym6rhnsh.js";import{G as Gt}from"./c1w85nn5shpnb9e0.js";import{d as Et,e as ro}from"./f2cwocui2o4rh90z.js";import{c as lo,D as bt,P as co,d as mo}from"./nlj97v8clhezwsxr.js";import{u as uo}from"./l9t7qwwrq1pkwdh1.js";import{u as fo}from"./do5nmvaddt7ak8xi.js";const ys=ze(()=>Fe(()=>import("./jtb083g97bhz26ld.js"),__vite__mapDeps([0,1])).then(s=>s.DirectorySyncResourceManagedIndication));function xo(s,e){return s.type===le.USER?s.user_id===e.user_id:s.type===le.GROUP?s.group_id===e.group_id:s.type===e.type}function go(s){"use forget";const e=L.c(74),{gizmo:n,publishedGizmo:a,onClose:r}=s,o=xe(),i=K(),d=Oe(),c=Oa(),l=Gs(),{name:m}=se(),f=m?ne:ae,g=De();let h;e[0]!==n.sharing?.subjects?(h=n.sharing?.subjects??[],e[0]=n.sharing?.subjects,e[1]=h):h=e[1];const[u,p]=w.useState(h),[j,x]=w.useState(!1);let b;e[2]!==n.sharing?.subjects||e[3]!==u?(b=()=>!Vt(n.sharing?.subjects,u),e[2]=n.sharing?.subjects,e[3]=u,e[4]=b):b=e[4];const C=b,M=Ye(),S=Jt(n);let N;e[5]!==u?(N=function(E){u.find(Y=>xo(Y,E))||p([...u,E])},e[5]=u,e[6]=N):N=e[6];const k=N;let _;e[7]!==c?(_=function(E,Y,ge){return E.type===le.USER&&E.user_id.indexOf("__")===-1?{...E,user_id:E.user_id+"__"+c?.getWorkspaceId()}:E},e[7]=c,e[8]=_):_=e[8];const P=_;let I;e[9]!==j||e[10]!==u||e[11]!==r||e[12]!==M||e[13]!==g||e[14]!==P?(I=async function(E){if(j)return;x(!0);const Y=u.map(P);await g.mutateAsync({id:E,update:{sharing:{recipient:We.Private,subjects:Y}}}),x(!1),r(),M.invalidateQueries({queryKey:["gizmos"]}),M.refetchQueries({queryKey:["gizmos","discovery"]}),M.refetchQueries({queryKey:["gizmo",{gizmoId:E}]}),M.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:E}]}),M.invalidateQueries({queryKey:["workspace"]})},e[9]=j,e[10]=u,e[11]=r,e[12]=M,e[13]=g,e[14]=P,e[15]=I):I=e[15];const G=I;let R;e[16]!==a||e[17]!==l?.id?(R=!a||bo(a.gizmo.author.user_id.split("__")[0],l?.id),e[16]=a,e[17]=l?.id,e[18]=R):R=e[18];const z=R;let Z;e[19]!==a.gizmo.id||e[20]!==G?(Z=()=>G(a.gizmo.id),e[19]=a.gizmo.id,e[20]=G,e[21]=Z):Z=e[21];const W=S.length>0||!Es(We.Private,n.sharingTargets);let D;e[22]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(v,{id:"BEKjVh",defaultMessage:"Save"}),e[22]=D):D=e[22];let B;e[23]!==j||e[24]!==Z||e[25]!==W?(B=t.jsx(pe,{onClick:Z,loading:j,disabled:W,children:D}),e[23]=j,e[24]=Z,e[25]=W,e[26]=B):B=e[26];let Q;e[27]!==C?(Q=C()&&t.jsx("div",{className:"text-token-text-secondary absolute start-6 bottom-8 text-sm",children:t.jsx(v,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),e[27]=C,e[28]=Q):Q=e[28];let T;e[29]!==o||e[30]!==i||e[31]!==a||e[32]!==d?(T=a&&t.jsx(pe,{color:"secondary",onClick:F=>Ls(o,a,d,F,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:t.jsx(v,{id:"bbhdTf",defaultMessage:"Copy link"})}),e[29]=o,e[30]=i,e[31]=a,e[32]=d,e[33]=T):T=e[33];let A;e[34]!==Q||e[35]!==T?(A=t.jsxs(t.Fragment,{children:[Q,T]}),e[34]=Q,e[35]=T,e[36]=A):A=e[36];let $;e[37]!==f.projectShareTitle||e[38]!==i?($=i.formatMessage(f.projectShareTitle),e[37]=f.projectShareTitle,e[38]=i,e[39]=$):$=e[39];let H;e[40]!==k?(H=F=>k(F),e[40]=k,e[41]=H):H=e[41];let O;e[42]!==a||e[43]!==H?(O=t.jsx(po,{onAdd:H,publishedGizmo:a}),e[42]=a,e[43]=H,e[44]=O):O=e[44];let be;e[45]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx("h3",{className:"text-base font-semibold",children:t.jsx(v,{id:"bNQXcV",defaultMessage:"Share with..."})}),e[45]=be):be=e[45];let q;e[46]!==z||e[47]!==a.gizmo.author||e[48]!==l?(q=t.jsx("div",{className:"shrink-0 grow-0 self-start",children:z?t.jsx(Ds,{user:l,size:"gizmoConversation",roundedStyle:"rounded-full"}):t.jsx(Lt,{name:a.gizmo.author.display_name??"User",initialsCount:2,size:"gizmoConversation"})}),e[46]=z,e[47]=a.gizmo.author,e[48]=l,e[49]=q):q=e[49];let X;e[50]!==z||e[51]!==a.gizmo.author||e[52]!==l?.email||e[53]!==l?.name?(X=t.jsx("div",{className:"grow text-base font-semibold",children:z?t.jsxs("div",{className:"flex flex-col",children:[t.jsx(v,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:l?.name}}),t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:l?.email})]}):t.jsx(v,{id:"FBF0QC",defaultMessage:"{userName} (owner)",values:{userName:a.gizmo.author.display_name}})}),e[50]=z,e[51]=a.gizmo.author,e[52]=l?.email,e[53]=l?.name,e[54]=X):X=e[54];let de;e[55]!==q||e[56]!==X?(de=t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[q,X]}),e[55]=q,e[56]=X,e[57]=de):de=e[57];let oe;e[58]!==u?(oe=u.map((F,E)=>As(F)&&t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[t.jsx(Lt,{name:F.type===le.GROUP?F.group_name:`${F.user_name} ${F.user_email}`,initialsCount:F.type===le.USER?2:1,size:"gizmoConversation",className:U("shrink-0 grow-0",F.type===le.USER&&"self-start")}),t.jsxs("div",{className:"flex grow flex-col",children:[t.jsxs("span",{className:"flex flex-row",children:[t.jsx("span",{className:"me-2 text-base font-semibold",children:F.type===le.GROUP?F.group_name:F.user_name}),F.type===le.GROUP&&F.is_scim_managed&&t.jsx(ys,{})]}),F.type===le.USER&&t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:F.user_email})]}),t.jsxs(y.Root,{children:[t.jsxs(y.Trigger,{className:"text-token-text-secondary text-base whitespace-nowrap",children:[t.jsx(v,{...Cs(F.capabilities)}),t.jsx(Os,{className:"icon-md"})]}),t.jsx(y.Portal,{children:t.jsxs(y.Content,{className:"max-w-[320px]",children:[[Us,mt].map((Y,ge)=>t.jsx(ho,{capabilities:Y,selected:Vt(Y,F.capabilities),onClick:()=>{p(u.map(ue=>ue===F?{...ue,capabilities:Y}:ue))}},ge)),t.jsx(y.Separator,{className:"my-2"}),t.jsx(y.Item,{onClick:()=>p(u.filter(Y=>Y!==F)),color:"danger",icon:yt,children:t.jsx(v,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},E)),e[58]=u,e[59]=oe):oe=e[59];let me;e[60]!==de||e[61]!==oe?(me=t.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[de,oe]}),e[60]=de,e[61]=oe,e[62]=me):me=e[62];let je;e[63]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("hr",{className:"border-token-border-medium"}),e[63]=je):je=e[63];let ie;e[64]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"GkuPg+",defaultMessage:"Project conversations are private regardless of these settings."})}),e[64]=ie):ie=e[64];let J;e[65]!==O||e[66]!==me?(J=t.jsxs("div",{className:"flex flex-col space-y-4",children:[O,be,me,je,ie]}),e[65]=O,e[66]=me,e[67]=J):J=e[67];let re;return e[68]!==r||e[69]!==B||e[70]!==A||e[71]!==$||e[72]!==J?(re=t.jsx(Ue,{testId:"modal-share-project",type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:r,primaryButton:B,secondaryButton:A,title:$,showCloseButton:!0,children:J}),e[68]=r,e[69]=B,e[70]=A,e[71]=$,e[72]=J,e[73]=re):re=e[73],re}function Cs(s){return s.can_write?rt({id:"vsUknl",defaultMessage:"Can edit"}):s.can_view_config?rt({id:"4ceJzB",defaultMessage:"Can chat"}):rt({id:"x2E8ET",defaultMessage:"Unknown"})}function ho(s){"use forget";const e=L.c(20),{capabilities:n,selected:a,onClick:r}=s;let o=null;n.can_write?o=Qe:n.can_view_config&&(o=Je);let i;e[0]!==n.can_write?(i=n.can_write?t.jsx(v,{id:"r5Iods",defaultMessage:"Chat, edit files & instructions, and duplicate"}):t.jsx(v,{id:"bIM51p",defaultMessage:"Chat, view files & instructions, and duplicate"}),e[0]=n.can_write,e[1]=i):i=e[1];const d=i,c=o;let l;e[2]!==n?(l=Cs(n),e[2]=n,e[3]=l):l=e[3];let m;e[4]!==l?(m=t.jsx("span",{className:"mb-0.5 text-base leading-tight",children:t.jsx(v,{...l})}),e[4]=l,e[5]=m):m=e[5];let f;e[6]!==d?(f=t.jsx("span",{className:"text-token-text-secondary text-xs",children:d}),e[6]=d,e[7]=f):f=e[7];let g;e[8]!==m||e[9]!==f?(g=t.jsxs("div",{className:"me-1 flex grow flex-col",children:[m,f]}),e[8]=m,e[9]=f,e[10]=g):g=e[10];const h=!a&&"invisible";let u;e[11]!==h?(u=U("icon-lg shrink-0",h),e[11]=h,e[12]=u):u=e[12];let p;e[13]!==u?(p=t.jsx(Rs,{className:u}),e[13]=u,e[14]=p):p=e[14];let j;return e[15]!==o||e[16]!==r||e[17]!==g||e[18]!==p?(j=t.jsxs(y.Item,{className:"flex h-auto flex-row items-center px-3 py-3",onClick:r,icon:c,children:[g,p]}),e[15]=o,e[16]=r,e[17]=g,e[18]=p,e[19]=j):j=e[19],j}function po(s){"use forget";const e=L.c(19),{onAdd:n,publishedGizmo:a}=s,r=K(),o=kt(),[i,d]=w.useState(""),c=Bs(o?.id,0,i,5),l=o?.data?.name??"your workspace",m=c.data?.items.filter(k=>k.account_user_id!==a?.gizmo.author.user_id),f=o?.id;let g;e[0]!==i||e[1]!==f?(g=[f,"groups","filtered",i],e[0]=i,e[1]=f,e[2]=g):g=e[2];let h;e[3]!==o||e[4]!==i?(h=o?()=>Ua.getWorkspaceGroups(o.id,{query:i,orderby:"@score"}):void 0,e[3]=o,e[4]=i,e[5]=h):h=e[5];const u=i.trim()!==""&&o!=null&&!!o.getWorkspaceId();let p;e[6]!==g||e[7]!==h||e[8]!==u?(p={queryKey:g,queryFn:h,enabled:u},e[6]=g,e[7]=h,e[8]=u,e[9]=p):p=e[9];const{data:j}=Ze(p);let x;e[10]!==n?(x=function(_,P,I){n({type:le.GROUP,group_id:_,group_name:P,capabilities:{...mt},is_scim_managed:I}),d("")},e[10]=n,e[11]=x):x=e[11];const b=x;let C;e[12]!==o||e[13]!==n?(C=function(_,P,I){o&&(n({type:le.USER,user_id:_,user_name:P,user_email:I,capabilities:{...mt}}),d(""))},e[12]=o,e[13]=n,e[14]=C):C=e[14];const M=C;let S;e[15]!==o||e[16]!==r||e[17]!==l?(S=o?.isEnterprisey()?r.formatMessage({id:"72/DBb",defaultMessage:"Add people and groups from {workspaceName}"},{workspaceName:l}):r.formatMessage({id:"xF0Ixa",defaultMessage:"Add people from {workspaceName}"},{workspaceName:l}),e[15]=o,e[16]=r,e[17]=l,e[18]=S):S=e[18];const N=S;return t.jsx("div",{className:"flex w-full flex-row space-x-3",children:t.jsx(Hs,{label:N,name:"share-with-input",inputValue:i,onInputChange:d,suggestions:[...m?.map(k=>{const{id:_,account_user_id:P,name:I,email:G}=k;return{id:_,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>M(P,I??"Unknown User",G??""),children:t.jsx(jo,{name:I??"Unknown User",email:G??""})}})??[],...j?.items.slice(0,5).map(k=>{const{id:_,name:P,is_scim_managed:I,num_members:G}=k;return{id:_,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>b(_,P,I??!1),children:t.jsx(vo,{name:P,isScimManaged:I??!1,numMembers:G})}})??[]]})})}function jo({name:s,email:e}){return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-full font-semibold",children:s}),t.jsx("span",{className:"text-token-text-secondary text-sm",children:e})]})}function vo(s){"use forget";const e=L.c(12),{name:n,isScimManaged:a,numMembers:r}=s;let o;e[0]!==n?(o=t.jsx("span",{className:"me-2 font-semibold",children:n}),e[0]=n,e[1]=o):o=e[1];let i;e[2]!==a?(i=a&&t.jsx(ys,{}),e[2]=a,e[3]=i):i=e[3];let d;e[4]!==o||e[5]!==i?(d=t.jsxs("span",{className:"flex flex-row",children:[o,i]}),e[4]=o,e[5]=i,e[6]=d):d=e[6];let c;e[7]!==r?(c=t.jsx("span",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:r}})}),e[7]=r,e[8]=c):c=e[8];let l;return e[9]!==d||e[10]!==c?(l=t.jsxs("span",{className:"flex flex-col",children:[d,c]}),e[9]=d,e[10]=c,e[11]=l):l=e[11],l}function bo(s,e){return s===void 0||e===void 0?!1:s.split("__")[0]===e.split("__")[0]}const Ns=Pe.div`text-sm text-red-500`,So=Pe.textarea`w-full overflow-y-auto overflow-x-clip rounded-lg border px-3 py-2 focus:ring-2 focus:ring-token-text-primary border-token-border-medium bg-token-main-surface-primary`,Be=20;function Ms({onClose:s,gizmo:e}){const n=K(),[a,r]=w.useState(e?.gizmo?.instructions||""),{name:o}=se(),i=o?ne:ae,d=De(),c=Oe(),l=[];a?.length>ut&&l.push(n.formatMessage(i.instructionsTooLong,{length:ut}));const m=j=>{r(j.target.value)},f=()=>{s()},g=async()=>{try{await d.mutateAsync({update:{instructions:a??""},id:e.gizmo.id}),s()}catch(j){const x=It(j);c.danger(x??"Error",{duration:2})}},h=t.jsx(Ke.Button,{title:n.formatMessage(i.save),color:"primary",onClick:g,loading:d.isPending,disabled:l.length>0}),u=t.jsx(Ke.Button,{title:n.formatMessage(i.cancel),color:"secondary",onClick:f,disabled:d.isPending}),p=ke(e);return t.jsx(Ue,{testId:"modal-project-custom-instructions",className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!d.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:t.jsx("div",{className:"h-8",children:n.formatMessage(i.editCustomInstructionsTitle)}),onClose:()=>{d.isPending||s()},children:t.jsxs("div",{className:"flex h-full flex-col px-6 pt-0 pb-7",children:[t.jsx("div",{className:"text-sm font-medium",children:n.formatMessage(p?i.editCustomInstructionsSubtitle:i.readOnlyCustomInstructionsTitle)}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:n.formatMessage(p?i.editCustomInstructionsDescription:i.readOnlyCustomInstructionsDescription)}),t.jsx(So,{autoFocus:!0,placeholder:n.formatMessage(i.projectInstructionsPlaceholder),className:"bg-token-main-surface-primary mt-4 mb-1 min-h-24 w-full grow resize-none rounded-md",onChange:m,value:a,disabled:d.isPending||!p}),l.map(j=>t.jsx(Ns,{className:"mt-1",children:j},j)),p&&t.jsx(Ke.Actions,{primaryButton:h,secondaryButton:u})]})})}function yo({gizmoId:s,gizmoName:e,canEdit:n,gizmoEditorData:a,openFileDialog:r,pendingFiles:o,setVersion:i,pendingFileUpsertMutationsRef:d,currentModelConfig:c}){const l=a?.files?.reduce((x,b)=>x+(b.file_size_tokens??0),0)??0,m=a?.contextStuffingBudget;let f;m&&(f=l/m,l>0&&f<.01&&(f=.01));const g=a?.files??[],h=Array.from(o.current.values()).filter(x=>g.every(b=>b.file_id!==x.fileId)),u=h.filter(x=>c!=null&&ft(c,x.file.type,x.file.name)===ht.CodeInterpreter),p=g.filter(x=>c!=null&&x.type!=null&&ft(c,x.type,x.name)===ht.CodeInterpreter),j=[...u.map(x=>x.tempId),...p.map(x=>x.file_id)];return t.jsx(Qs,{gizmoId:s,gizmoName:e,canEdit:n,pendingFiles:h,pendingFileUpsertMutationsRef:d,files:g,modelCapacityUsed:f,interpreterOnlyFileIds:j,onAddFiles:r,removePendingFile:x=>{o.current.delete(x),i(b=>b+1)}})}const Co=w.forwardRef(function({gizmo:e,showInstructions:n=!0},a){const r=K(),{name:o}=se(),i=o?ne:ae,[d,c]=w.useState(!1),l=De(),m=$s(e),f=Jt(m),{data:g}=La(),h=g?.models.get(Ra)??(g&&qs(g.models.values(),W=>W.tags.includes(Ba.GPT_4o))),u=Oe(),[p,j]=w.useState(0),x=w.useRef(new Map),b=w.useRef([]),C=Vs(h,void 0),M=W=>{W.some(({errors:D})=>D.length!==1||D[0]?.code!==Rt.TooManyFiles)?u.danger(r.formatMessage(i.unknownError),{duration:2}):u.danger(r.formatMessage(i.dragTooManyFilesError,{MAX_FILES_PER_PROJECT:Be}),{duration:2})},S=async W=>{te.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const D=m.id;W.length>0&&await Promise.all(W.map(B=>{const Q=en(B);x.current.set(Q,{tempId:Q,gizmoId:D,file:B,status:lt.Uploading,progress:1,fileId:null,cdnUrl:null}),tn(Q,B,r,u,{kind:Ha.Gizmo,gizmoId:D},{onFileUploaded:async(T,A,$,H)=>{const O=x.current.get(T);O?.fileId&&O?.fileId&&(b.current.push({id:e.gizmo.id,mutationId:Fs(),update:q=>{if(!O.fileId)return q;const X=[...q.files??[],{file_id:O.fileId,name:O.file.name,size:O.file.size,type:H?.mimeType??sn(O.file),last_modified:O.file.lastModified,file_size_tokens:H?.fileTokenSize}];return{...q,files:X}},onSuccess:()=>{x.current.delete(T),j(q=>q+1)}}),nn(e.gizmo.id)({gizmoId:e.gizmo.id,upsertProjectMutation:l,pendingFileUpsertMutationsRef:b}))},onFileCreated:(T,A,$)=>{x.current.set(T,{tempId:T,gizmoId:D,file:B,status:lt.Uploading,progress:1,...x.current.get(T),fileId:A,cdnUrl:$}),j(H=>H+1)},onFileUploadProgress:(T,A)=>{const $=x.current.get(T);$?.status===lt.Uploading&&x.current.set(T,{...$,progress:A>95?95:A}),j(H=>H+1)},onError:T=>{x.current.delete(T),j(A=>A+1)}},{usesRetrievalIndex:h!=null&&ft(h,B.type,B.name)===ht.Retrieval})}))},N=Ks(C),k=lo(N),_=x.current.size+m.files.length,P=ke(e),{open:I,getInputProps:G,getRootProps:R,isDragAccept:z,isDragReject:Z}=uo({noClick:!0,noDragEventsBubbling:!0,onDropAccepted:S,onDropRejected:M,multiple:!0,maxSize:Js,maxFiles:Be-_,validator:()=>_>=Be?{code:Rt.TooManyFiles,message:"Too many files"}:null,...N});return w.useImperativeHandle(a,()=>({openFileDialog:I})),t.jsxs("div",{...R({className:"h-full px-6"}),children:[t.jsx("input",{...G()}),n&&t.jsxs(Ws,{children:[t.jsx("button",{className:"w-full",onClick:()=>c(!0),children:t.jsx("div",{className:"border-token-border-default w-full rounded-lg border text-start text-sm",children:m?.instructions?.length?t.jsx("div",{className:"mx-4 my-3 line-clamp-4",children:m.instructions}):t.jsxs("div",{className:"text-token-text-secondary flex h-full w-full items-center px-4 py-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(v,{...i.addCustomInstructions})}),t.jsx(Qe,{className:"icon-sm"})]})})}),f.includes(Xs.GizmoInstructionsTooLong)?t.jsx(Ns,{className:"mt-1",children:t.jsx(v,{...i.instructionsTooLong,values:{length:ut}})}):null]}),d&&t.jsx(Ms,{gizmo:e,onClose:()=>{c(!1)}}),t.jsx(yo,{gizmoId:e.gizmo.id,gizmoName:e.gizmo.display.name,canEdit:P,gizmoEditorData:m,openFileDialog:I,pendingFiles:x,pendingFileUpsertMutationsRef:b,setVersion:j,currentModelConfig:h}),z&&t.jsxs(bt,{children:[t.jsx(Ys,{}),t.jsx("h3",{children:t.jsx(v,{...i.dragInstructions})}),t.jsx("h4",{className:"w-2/3 text-center",children:k.length>0?k.join(", "):t.jsx(v,{...i.dragAllAccepted})})]}),Z&&t.jsxs(bt,{children:[t.jsx(Zs,{className:"icon-2xl"}),t.jsx("h3",{children:t.jsx(v,{...i.dragTooManyFiles})}),t.jsx("h4",{className:"w-2/3 text-center",children:t.jsx(v,{...i.dragTooManyFilesDescription,values:{MAX_FILES_PER_PROJECT:Be}})})]})]})});function No({gizmo:s,onClose:e}){const n=w.useRef(null),a=w.useCallback(()=>{n.current?.openFileDialog()},[n]),r=ke(s),{name:o}=se(),i=o?ne:ae;return t.jsx(t.Fragment,{children:t.jsx(Ue,{testId:"modal-project-files",className:"min-h-72 max-w-[820px]",isOpen:!0,showCloseButton:!0,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",onClose:()=>{e()},children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx(Ke.TitleBar,{$hasSeparator:!1,children:t.jsxs("div",{className:"flex w-full items-center gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx($a,{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(v,{...i.projectFilesModalTitle})})}),r&&t.jsx(pe,{color:"secondary",onClick:a,children:t.jsx(v,{...i.addFilesButtonLabel})}),t.jsx(qa,{asChild:!0,className:"sm:mt-0",children:t.jsx(bs,{onClick:e})})]})}),t.jsx("div",{className:"h-[50dvh] grow overflow-y-auto pt-0",children:t.jsx(Co,{ref:n,gizmo:s,showInstructions:!1})})]})})})}function Mo({gizmo:s}){return t.jsx("div",{className:"mt-6 grid grid-cols-2 items-start",children:s?t.jsxs(t.Fragment,{children:[t.jsx(wo,{gizmo:s,className:"rounded-[20px_0px_0px_20px] [border-width:1px_0.5px_1px_1px]"}),t.jsx(ko,{gizmo:s,className:"rounded-[0px_20px_20px_0px] [border-width:1px_1px_1px_0.5px]"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Wt,{}),t.jsx(Wt,{})]})})}function Dt({className:s,header:e,context:n,contextClassName:a="",icon:r,modal:o,onClick:i,disabled:d=!1,isModalOpen:c=!1}){return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:i,disabled:d,className:U("group/snorlax-control-tile border-token-border-light bg-token-bg-primary hover:bg-token-bg-tertiary active:bg-token-bg-tertiary relative h-full rounded-2xl border disabled:pointer-events-none disabled:opacity-50",s),children:t.jsxs("div",{className:"relative mx-5 my-4 flex items-center justify-between gap-3 overflow-hidden",children:[t.jsxs("div",{className:"w-full grow text-start",children:[t.jsx("div",{className:"text-sm font-medium",children:e}),t.jsx("div",{className:U("text-token-text-secondary text-xs",a),children:n})]}),r]})}),c&&o]})}function Wt(){return t.jsx(Dt,{disabled:!0,header:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-48 rounded-full"}),context:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-32 rounded-full"})})}function wo({className:s,gizmo:e}){const{files:n}=e,a=!n.length,r=et(e),[o,i]=w.useState(!1),{name:d}=se(),c=d?ne:ae,l=o&&t.jsx(No,{gizmo:e,onClose:()=>{i(!1)}}),m=()=>i(!0);let f,g,h;const u=ke(e);if(a)f=t.jsx(v,{...u?c.addFilesButtonLabel:c.viewFilesButtonLabel}),g=t.jsx(v,{...u?c.filesControlDescription:c.noFilesReadOnlyDescription}),h=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-bg-tertiary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),u?t.jsx(ln,{className:"icon-md h-5 w-5",style:{color:r}}):t.jsx(cn,{className:"icon-md h-5 w-5",style:{color:r}})]});else{const j=n.slice(0,3);f=t.jsx(v,{...c.projectFilesModalTitle}),g=t.jsx(v,{...c.filesCount,values:{count:n.length}}),h=t.jsx("div",{className:"relative flex h-10 w-20 shrink-0 items-center justify-center rounded-full",children:j.toReversed().map((x,b)=>t.jsx(_o,{file:x,index:b,gizmoId:e.gizmo.id},x.id))})}return t.jsx(Dt,{className:s,isModalOpen:o,modal:l,onClick:m,header:f,context:g,icon:h,disabled:a&&!u})}function _o({file:s,index:e,gizmoId:n}){const a=s.name,o=an(a)&&s.file_id!=null&&t.jsx(on,{fileName:a,fileId:s.file_id,gizmoId:n,className:"rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]"});return t.jsx("div",{className:"border-token-bg-primary group-hover/snorlax-control-tile:border-token-bg-tertiary absolute end-0 top-0 h-10 w-10 overflow-hidden rounded-xl border-2",style:{transform:`translateX(${e*-20}px)`},children:o||t.jsx(rn,{className:"h-9 w-9 shrink-0 rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]",filename:s.name,contextConnectorInfo:void 0})})}function ko({gizmo:s,className:e}){const{instructions:n}=s.gizmo,a=!n.length,r=et(s),[o,i]=w.useState(!1),{name:d}=se(),c=d?ne:ae,l=o&&t.jsx(Ms,{gizmo:s,onClose:()=>{i(!1)}}),m=()=>i(!0);let f,g,h,u;const p=ke(s);return a?(f=t.jsx(v,{...p?c.customInstructionsTitle:c.customInstructionsReadOnlyTitle}),g=t.jsx(v,{...p?c.customInstructionsDescription:c.customInstructionsReadOnlyDescription}),h=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-main-surface-secondary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),t.jsx(Qe,{className:"icon-md h-5 w-5",style:{color:r}})]})):(f=t.jsx(v,{...c.editCustomInstructionsTitle}),u="overflow-hidden text-ellipsis whitespace-nowrap",g=n),t.jsx(Dt,{className:e,isModalOpen:o,modal:l,onClick:m,header:f,context:g,icon:h,contextClassName:u,disabled:a&&!p})}const Io=()=>t.jsx("div",{className:"ms-1 mt-3 h-10",children:t.jsx("div",{className:"bg-token-tertiary my-[15px] h-[10px] w-48 rounded-full"})}),Xt=new Map;function zo(s){const e=Xt.get(s);if(e)return e;const n=Sn(Fo,2e3,{trailing:!0});return Xt.set(s,n),n}async function Fo({gizmoId:s,upsertProjectMutation:e,toaster:n}){const a=Nn,r=Ht(a.getState(),"theme",s);try{r!==void 0&&await e.mutateAsync({id:s,update:{theme:r??void 0}}),Ht(a.getState(),"theme",s)===r&&Mn(s,"theme")}catch(o){const i=It(o);n.warning(i??"Error",{duration:2})}}function Po({gizmoId:s,theme:e,upsertProjectMutation:n,toaster:a}){bn(s,"theme",e),zo(s)({gizmoId:s,upsertProjectMutation:n,toaster:a})}function To(s){"use forget";const e=L.c(15),{gizmo:n}=s,a=et(n),r=De(),[o,i]=w.useState(!1),d=Oe();let c;e[0]!==a||e[1]!==n||e[2]!==d||e[3]!==r?(c=u=>{u!==a&&(te.logEventWithStatsig("Projects: Theme Change","chatgpt_web_projects_theme_change",{theme:u??"default"}),Po({gizmoId:n.gizmo.id,theme:u,upsertProjectMutation:r,toaster:d}))},e[0]=a,e[1]=n,e[2]=d,e[3]=r,e[4]=c):c=e[4];const l=c;let m;e[5]===Symbol.for("react.memo_cache_sentinel")?(m=u=>i(u),e[5]=m):m=e[5];let f;e[6]!==a?(f=t.jsx(ss,{currentTheme:a}),e[6]=a,e[7]=f):f=e[7];let g;e[8]!==a||e[9]!==l?(g=t.jsx(jn,{currentTheme:a,onSelect:l}),e[8]=a,e[9]=l,e[10]=g):g=e[10];let h;return e[11]!==o||e[12]!==f||e[13]!==g?(h=t.jsx(vn,{open:o,sideOffset:4,alignOffset:7,side:"bottom",alignAgainstAnchor:"start",size:"none",modal:!0,onOpenChange:m,triggerButton:f,children:g}),e[11]=o,e[12]=f,e[13]=g,e[14]=h):h=e[14],h}function Go(s){"use forget";const e=L.c(2),{gizmo:n}=s;let a;return e[0]!==n?(a=t.jsx("div",{className:"mb-8 inline-flex gap-2 self-center",children:n?t.jsxs("div",{className:"text-page-header inline-block px-4 text-center",children:[n?t.jsx(To,{gizmo:n}):t.jsx(ss,{disabled:!0,currentTheme:null}),t.jsxs("a",{href:"#edit-title",role:"button",className:"group hover:text-token-text-secondary relative ms-2 text-balance",onClick:Eo,children:[n.gizmo.display.name,t.jsx(hn,{})]})]}):t.jsx(Io,{})}),e[0]=n,e[1]=a):a=e[1],a}function Eo(s){s.preventDefault(),Mt.setShowProjectSettingsModal(!0)}function Do(s){"use forget";const e=L.c(2),{children:n}=s;let a;return e[0]!==n?(a=t.jsx("div",{className:"group relative flex flex-col gap-1 p-4",children:t.jsx("div",{className:"flex items-center gap-4",children:n})}),e[0]=n,e[1]=a):a=e[1],a}function Ao(s){"use forget";const e=L.c(23),{conversation:n,gizmo:a}=s,r=pt(n.id,Oo)??n.title,[o,i]=w.useState(!1);let d,c;e[0]!==n.id?(d=()=>Va(os,{editTitleInMainScreen:x=>{const{serverThreadId:b}=x;b===n.id&&i(!0)}}),c=[n.id],e[0]=n.id,e[1]=d,e[2]=c):(d=e[1],c=e[2]),w.useEffect(d,c);const{snippet:l}=n;let m;e[3]!==n||e[4]!==r||e[5]!==o?(m=o?t.jsx(yn,{conversationId:n.id,historyConversationResponse:n,onClose:()=>{i(!1)}}):t.jsx("div",{className:"text-sm font-medium",children:r}),e[3]=n,e[4]=r,e[5]=o,e[6]=m):m=e[6];let f;e[7]!==l?(f=l&&t.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:l}),e[7]=l,e[8]=f):f=e[8];let g;e[9]!==m||e[10]!==f?(g=t.jsxs("div",{className:"can-hover:group-hover:me-5 grow overflow-hidden",children:[m,f]}),e[9]=m,e[10]=f,e[11]=g):g=e[11];let h;e[12]!==n||e[13]!==o?(h=!o&&t.jsx(Uo,{conversation:n}),e[12]=n,e[13]=o,e[14]=h):h=e[14];let u;e[15]!==g||e[16]!==h?(u=t.jsxs(Do,{children:[g,h]}),e[15]=g,e[16]=h,e[17]=u):u=e[17];const p=u;let j;return e[18]!==p||e[19]!==n.id||e[20]!==a||e[21]!==o?(j=o?p:t.jsx(Zt,{to:Cn(n.id,a),draggable:!1,children:p}),e[18]=p,e[19]=n.id,e[20]=a,e[21]=o,e[22]=j):j=e[22],j}function Oo(s){return s?.title}function Uo(s){"use forget";const e=L.c(10),{conversation:n}=s,[a,r]=w.useState(!1),o=a?"flex":"can-hover:group-hover:flex hidden";let i;e[0]!==o?(i=U("absolute end-0 top-0 bottom-0 items-center gap-1.5 pe-4",o),e[0]=o,e[1]=i):i=e[1];let d;e[2]!==n?(d=m=>{r(m),m&&te.logEvent("Conversation History Item Open Menu",{conversationId:n.id})},e[2]=n,e[3]=d):d=e[3];let c;e[4]!==n||e[5]!==d?(c=t.jsx(wn,{conversation:n,onOpenChange:d,inMainScreen:!0,isActiveConversation:!1}),e[4]=n,e[5]=d,e[6]=c):c=e[6];let l;return e[7]!==i||e[8]!==c?(l=t.jsx("div",{className:i,onClick:Lo,children:c}),e[7]=i,e[8]=c,e[9]=l):l=e[9],l}function Lo(s){s.preventDefault()}function Ro(s){"use forget";const e=L.c(19),{gizmo:n}=s;pn(n.gizmo.id);const{items:a,hasNextPage:r,fetchNextPage:o,isLoading:i,isFetching:d,isFetchingNextPage:c}=ns(n.gizmo.id),l=w.useRef(null);let m;e[0]!==r||e[1]!==d||e[2]!==i||e[3]!==o?(m=b=>{i||b==null||(l.current?.disconnect(),l.current=new IntersectionObserver(C=>{C[0].isIntersecting&&r&&!d&&o()}),l.current.observe(b))},e[0]=r,e[1]=d,e[2]=i,e[3]=o,e[4]=m):m=e[4];const f=m;let g,h;e[5]===Symbol.for("react.memo_cache_sentinel")?(g=()=>()=>{l.current?.disconnect()},h=[],e[5]=g,e[6]=h):(g=e[5],h=e[6]),w.useEffect(g,h);const u=a.length;let p;e[7]!==u||e[8]!==n||e[9]!==r||e[10]!==f||e[11]!==i||e[12]!==a?(p=u||i?t.jsx(Ho,{gizmo:n,items:a??[],hasNextPage:r,infiniteScrollTriggerElementRef:f}):t.jsx(Bo,{}),e[7]=u,e[8]=n,e[9]=r,e[10]=f,e[11]=i,e[12]=a,e[13]=p):p=e[13];let j;e[14]!==c?(j=c&&t.jsx("div",{className:"m-4 mb-5 flex justify-center",children:t.jsx(Ss,{})}),e[14]=c,e[15]=j):j=e[15];let x;return e[16]!==p||e[17]!==j?(x=t.jsxs("div",{className:"mt-6 mb-14 contain-inline-size",children:[p,j]}),e[16]=p,e[17]=j,e[18]=x):x=e[18],x}function Bo(){"use forget";const s=L.c(3),{name:e}=se(),n=e?ne:ae;let a;s[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(as,{className:"icon-lg text-token-interactive-icon-tertiary-default mb-2"}),s[0]=a):a=s[0];let r;return s[1]!==n.emptyChatsInProjectTitle?(r=t.jsxs("div",{className:"mt-8 flex flex-col items-center font-medium",children:[a,t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{...n.emptyChatsInProjectTitle})})]}),s[1]=n.emptyChatsInProjectTitle,s[2]=r):r=s[2],r}function Ho(s){"use forget";const e=L.c(14),{gizmo:n,items:a,hasNextPage:r,infiniteScrollTriggerElementRef:o}=s,i=a.length;let d;if(e[0]!==i||e[1]!==n||e[2]!==r||e[3]!==o||e[4]!==a){let l;e[6]!==i||e[7]!==n||e[8]!==r||e[9]!==o||e[10]!==a.length?(l=(m,f)=>{const g=r&&f===a.length-3?o:void 0;return t.jsx("li",{ref:g,className:U("hover:bg-token-bg-tertiary first:rounded-t-lg last:rounded-b-lg",f!==i-1&&"border-token-border-xlight border-b"),children:t.jsx(Ao,{conversation:m,gizmo:n})},m.id)},e[6]=i,e[7]=n,e[8]=r,e[9]=o,e[10]=a.length,e[11]=l):l=e[11],d=a.map(l),e[0]=i,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=d}else d=e[5];let c;return e[12]!==d?(c=t.jsx(t.Fragment,{children:t.jsx("ol",{children:d})}),e[12]=d,e[13]=c):c=e[13],c}function At(s,e){"use forget";const n=L.c(13),a=dn(),r=xe(),o=ve(),i=es(),d=a?.kind==="conversation"&&a.gizmoId!==e;let c;n[0]!==o||n[1]!==i?(c=async function(u){const{conversation:p,newGizmoId:j,previousGizmoId:x}=u;await i({newGizmoId:j,conversation:p,previousGizmoId:x}),o(`/g/${j}/project`)},n[0]=o,n[1]=i,n[2]=c):c=n[2];const l=c;let m;n[3]!==l||n[4]!==d||n[5]!==r||n[6]!==a||n[7]!==e||n[8]!==s?(m=()=>{if(!d)return;const{conversation:h,gizmoId:u}=a;if(e)return l({conversation:h,newGizmoId:e,previousGizmoId:u});at(r,p=>{const{closeModal:j}=p;return t.jsx(Nt,{onClose:j,onSuccess:x=>{if(!x)return;const b=l({conversation:h,newGizmoId:x,previousGizmoId:u});return te.logEventWithStatsig("Projects: Create Open","chatgpt_web_projects_create_open",{source:s}),b}})})},n[3]=l,n[4]=d,n[5]=r,n[6]=a,n[7]=e,n[8]=s,n[9]=m):m=n[9];const f=m;let g;return n[10]!==d||n[11]!==f?(g={canDropConversation:d,onDropConversation:f},n[10]=d,n[11]=f,n[12]=g):g=n[12],g}function $o(s){"use forget";const e=L.c(46),{clientThreadId:n,gizmoId:a,currentModelId:r,onRequestCompletion:o}=s,i=K(),{name:d}=se(),c=d?ne:ae,{data:l}=Ct(a),m=Bt(Wo),f=Bt(Ko),{onDropConversation:g,canDropConversation:h}=At(void 0,a),[u,p]=w.useState(!1);let j;e[0]!==h?(j=z=>{z.preventDefault(),h&&p(!0)},e[0]=h,e[1]=j):j=e[1];let x;e[2]!==h||e[3]!==g?(x=z=>{z.preventDefault(),h&&(p(!1),g())},e[2]=h,e[3]=g,e[4]=x):x=e[4];let b,C;e[5]!==h?(b=z=>{z.preventDefault(),h&&p(!0)},C=z=>{z.preventDefault(),h&&p(!1)},e[5]=h,e[6]=b,e[7]=C):(b=e[6],C=e[7]);let M;e[8]!==l?(M=t.jsx(Go,{gizmo:l}),e[8]=l,e[9]=M):M=e[9];let S;e[10]!==n||e[11]!==r||e[12]!==l||e[13]!==o?(S=l?t.jsx(co,{clientThreadId:n,isNewThread:!0,currentModelId:r,onContinueGenerating:z=>o(fn(z)),onRequestCompletion:async z=>o(await un(z)),hideHeader:!0}):t.jsx("div",{className:"bg-token-tertiary h-24 w-full rounded-3xl"}),e[10]=n,e[11]=r,e[12]=l,e[13]=o,e[14]=S):S=e[14];let N,k;e[15]!==l?(N=t.jsx(Mo,{gizmo:l}),k=l&&t.jsx(Ro,{gizmo:l}),e[15]=l,e[16]=N,e[17]=k):(N=e[16],k=e[17]);let _;e[18]!==l||e[19]!==a||e[20]!==f?(_=l&&f&&t.jsx(go,{gizmo:mn(l),publishedGizmo:l,onClose:Vo},a),e[18]=l,e[19]=a,e[20]=f,e[21]=_):_=e[21];let P;e[22]!==c||e[23]!==l||e[24]!==a||e[25]!==i||e[26]!==m?(P=m&&t.jsx(Nt,{submitButtonTitle:i.formatMessage(c.projectSettingsSubmitButton),gizmo:l,onClose:qo},a),e[22]=c,e[23]=l,e[24]=a,e[25]=i,e[26]=m,e[27]=P):P=e[27];let I;e[28]!==c||e[29]!==l?.gizmo||e[30]!==u?(I=u&&t.jsxs(bt,{children:[t.jsx(ts,{className:"h-12 w-12",style:{color:"#3C46FF"}}),t.jsx("h3",{className:"text-center",children:t.jsx(v,{...c.addConversationToNamedSnorlax,values:{projectName:l?.gizmo.display.name??"project"}})}),t.jsx("h4",{className:"text-center",children:t.jsx(v,{...c.moveConversation})})]}),e[28]=c,e[29]=l?.gizmo,e[30]=u,e[31]=I):I=e[31];let G;e[32]!==P||e[33]!==I||e[34]!==M||e[35]!==S||e[36]!==N||e[37]!==k||e[38]!==_?(G=t.jsx(xn,{verticalPadding:"none",horizontalPadding:"standard",overflowY:"auto",fullHeight:!0,children:t.jsxs(gn,{column:!0,shouldRemoveGap:!0,className:"min-w-[min(90cqw,640px)]",children:[M,S,N,k,_,P,I]})}),e[32]=P,e[33]=I,e[34]=M,e[35]=S,e[36]=N,e[37]=k,e[38]=_,e[39]=G):G=e[39];let R;return e[40]!==j||e[41]!==G||e[42]!==x||e[43]!==b||e[44]!==C?(R=t.jsx("div",{onDragOver:j,onDrop:x,onDragEnter:b,onDragLeave:C,className:"flex max-h-full min-h-full flex-col md:pt-[calc(var(--header-height)+20px)]",children:G}),e[40]=j,e[41]=G,e[42]=x,e[43]=b,e[44]=C,e[45]=R):R=e[45],R}function qo(){Mt.setShowProjectSettingsModal(!1)}function Vo(){Mt.setShowShareModal(!1)}function Ko(s){return s.showShareModal}function Wo(s){return s.showProjectSettingsModal}const Xo=Object.freeze(Object.defineProperty({__proto__:null,SnorlaxSplashScreen:$o,useProjectsDragDrop:At},Symbol.toStringTag,{value:"Module"})),Yo=ze(()=>Fe(()=>import("./bugk7hk34lc7gpmk.js"),__vite__mapDeps([2,1,3,4,5])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>t.jsx(Ot,{color:s})}),Zo={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function Qo(s){"use forget";const e=L.c(21),{color:n,folderState:a,gizmoId:r,sidebarSnorlaxFolderStore:o}=s,i=K(),[d,c]=w.useState(!1),{name:l}=se(),m=l?ne:ae;let f;e[0]!==m.hideChatsForProjectTooltip||e[1]!==m.showChatsForProjectTooltip||e[2]!==a||e[3]!==i?(f=a==="open"?i.formatMessage(m.hideChatsForProjectTooltip):i.formatMessage(m.showChatsForProjectTooltip),e[0]=m.hideChatsForProjectTooltip,e[1]=m.showChatsForProjectTooltip,e[2]=a,e[3]=i,e[4]=f):f=e[4];let g;e[5]!==a||e[6]!==r||e[7]!==o?(g=C=>{C.preventDefault(),a==="open"?o.collapseProject(r):o.expandProject(r)},e[5]=a,e[6]=r,e[7]=o,e[8]=g):g=e[8];let h,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{c(!0)},u=()=>{c(!1)},e[9]=h,e[10]=u):(h=e[9],u=e[10]);const p=a==="open";let j;e[11]!==n||e[12]!==d||e[13]!==p?(j=t.jsx(Yo,{isOpen:p,isHovered:d,color:n}),e[11]=n,e[12]=d,e[13]=p,e[14]=j):j=e[14];let x;e[15]!==g||e[16]!==j?(x=t.jsx("button",{className:"icon-md",onClick:g,onMouseEnter:h,onMouseLeave:u,children:j}),e[15]=g,e[16]=j,e[17]=x):x=e[17];let b;return e[18]!==f||e[19]!==x?(b=t.jsx(Ie,{label:f,triggerAs:null,children:x}),e[18]=f,e[19]=x,e[20]=b):b=e[20],b}function Ot(s){"use forget";const e=L.c(2),{color:n}=s;let a;return e[0]!==n?(a=t.jsx(xt,{className:"icon-md",style:{color:n}}),e[0]=n,e[1]=a):a=e[1],a}function Yi(s){"use forget";const e=L.c(85),{gizmo:n,historyDisabled:a,flair:r,onClick:o,isActive:i,hideOverflowMenu:d}=s,c=d===void 0?!1:d,l=xe(),{clientThreadId:m}=Et(),f=zt(m),g=ve(),h=K(),u=n.gizmo.id,p=ct.useStore();let j;e[0]!==u?(j=V=>ct.selectFolderState(V,u),e[0]=u,e[1]=j):j=e[1];const x=ct.useState(j);let b;e[2]!==n.gizmo.tags?(b=n.gizmo.tags?.includes(wt.FirstParty),e[2]=n.gizmo.tags,e[3]=b):b=e[3];const C=!!b,{items:M,hasNextPage:S}=ns(n.gizmo.id);let N;e[4]!==M?(N=M===void 0?[]:M,e[4]=M,e[5]=N):N=e[5];const k=N,_=tt(u),P=et(n),I=i&&(!_||!(x==="open"&&f)),G=w.useRef(x);let R,z;e[6]!==x?(R=()=>{G.current=x},z=[x],e[6]=x,e[7]=R,e[8]=z):(R=e[7],z=e[8]),w.useEffect(R,z);let Z,W;e[9]!==u||e[10]!==i||e[11]!==f||e[12]!==p?(Z=()=>{G.current!=="open"&&i&&f&&p.expandProject(u)},W=[i,f,p,u],e[9]=u,e[10]=i,e[11]=f,e[12]=p,e[13]=Z,e[14]=W):(Z=e[13],W=e[14]),w.useEffect(Z,W);let D;if(n!=null)D=n.gizmo.display.name||_n;else if(a){let V;e[15]!==h?(V=h.formatMessage(is.clearChat),e[15]=h,e[16]=V):V=e[16],D=V}else D=zn;const[B,Q]=w.useState();let T;e[17]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{Q(void 0)},e[17]=T):T=e[17];let A;e[18]!==n?(A=[n],e[18]=n,e[19]=A):A=e[19],w.useEffect(T,A);const $=De(),[H,O]=w.useState(!1),[be,q]=w.useState(!1),{canDropConversation:X,onDropConversation:de}=At("sidebar_row_button",u);let oe;e[20]!==l||e[21]!==n.gizmo.id||e[22]!==i||e[23]!==H||e[24]!==D||e[25]!==g||e[26]!==B||e[27]!==$?(oe=H?t.jsx(Fn,{initialValue:D,onCommit:async V=>{Q(V),O(!1);const{resource:Te}=await $.mutateAsync({update:{name:V},id:n.gizmo.id});Te&&i&&g(Xe(l,Te),{replace:!0})},onCancel:()=>{O(!1)}}):B??D,e[20]=l,e[21]=n.gizmo.id,e[22]=i,e[23]=H,e[24]=D,e[25]=g,e[26]=B,e[27]=$,e[28]=oe):oe=e[28];const me=oe,je=be&&"bg-token-bg-tertiary";let ie;e[29]!==je?(ie=U(je),e[29]=je,e[30]=ie):ie=e[30];let J;e[31]!==X||e[32]!==de?(J=V=>{V.preventDefault(),V.stopPropagation(),X&&(q(!1),de())},e[31]=X,e[32]=de,e[33]=J):J=e[33];let re;e[34]!==X?(re=V=>{X&&(V.preventDefault(),q(!0))},e[34]=X,e[35]=re):re=e[35];let F;e[36]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{q(!1)},e[36]=F):F=e[36];let E;e[37]!==l||e[38]!==n?(E=Xe(l,n),e[37]=l,e[38]=n,e[39]=E):E=e[39];let Y;e[40]===Symbol.for("react.memo_cache_sentinel")?(Y=()=>{O(!0)},e[40]=Y):Y=e[40];let ge;e[41]!==n.gizmo.id||e[42]!==o?(ge=V=>{const Te=n?.gizmo.id??"primary";te.logNewChatButtonClicked({location:"Sidebar gizmo list",gizmo_id:Te}),te.logEvent("Sidebar Click Gizmo",{gizmo_id:Te}),o?.(V)},e[41]=n.gizmo.id,e[42]=o,e[43]=ge):ge=e[43];let ue;e[44]!==P||e[45]!==x||e[46]!==u||e[47]!==n.gizmo.display||e[48]!==C||e[49]!==_||e[50]!==p||e[51]!==k?(ue=_&&k.length>0?t.jsx(Qo,{color:P,folderState:x,gizmoId:u,sidebarSnorlaxFolderStore:p}):_?t.jsx(Ot,{color:P}):t.jsx(Gt,{simple:!0,isFirstParty:C,src:n?.gizmo.display.profile_picture_url,className:"icon-md",alt:""}),e[44]=P,e[45]=x,e[46]=u,e[47]=n.gizmo.display,e[48]=C,e[49]=_,e[50]=p,e[51]=k,e[52]=ue):ue=e[52];let ye;e[53]!==r?(ye=r===rs.Workspace&&t.jsx(Jo,{}),e[53]=r,e[54]=ye):ye=e[54];let Ce;e[55]!==r||e[56]!==n||e[57]!==c||e[58]!==i||e[59]!==_?(Ce=!c&&(_?t.jsx(ti,{gizmoResource:n,isActive:i}):t.jsx(ei,{gizmoResource:n,flair:r})),e[55]=r,e[56]=n,e[57]=c,e[58]=i,e[59]=_,e[60]=Ce):Ce=e[60];let Ne;e[61]!==me||e[62]!==I||e[63]!==ie||e[64]!==J||e[65]!==re||e[66]!==E||e[67]!==ge||e[68]!==ue||e[69]!==ye||e[70]!==Ce?(Ne=t.jsx(Pn,{className:ie,onDrop:J,onDragEnter:re,onDragLeave:F,to:E,onDoubleClick:Y,onClick:ge,active:I,icon:ue,label:me,trailing:ye,highlightTrailing:Ce}),e[61]=me,e[62]=I,e[63]=ie,e[64]=J,e[65]=re,e[66]=E,e[67]=ge,e[68]=ue,e[69]=ye,e[70]=Ce,e[71]=Ne):Ne=e[71];let Me;e[72]!==x||e[73]!==n||e[74]!==S||e[75]!==_||e[76]!==f||e[77]!==I||e[78]!==k?(Me=_&&x==="open"&&k.length>0&&t.jsx(Qt.div,{initial:"closed",animate:"open",exit:"closed",variants:Zo,className:"overflow-hidden",children:t.jsx(kn,{gizmoResource:n,serverThreadId:f,isOnProjectPage:I,conversations:k,hasNextPage:S})},"nested-conversations"),e[72]=x,e[73]=n,e[74]=S,e[75]=_,e[76]=f,e[77]=I,e[78]=k,e[79]=Me):Me=e[79];let we;e[80]!==Me?(we=t.jsx(Ps,{initial:!1,children:Me}),e[80]=Me,e[81]=we):we=e[81];let Re;return e[82]!==Ne||e[83]!==we?(Re=t.jsxs(t.Fragment,{children:[Ne,we]}),e[82]=Ne,e[83]=we,e[84]=Re):Re=e[84],Re}const Jo=()=>{const s=K(),e=kt(),n=e?.name?s.formatMessage({id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"},{workspace_name:e.name??"Your Workspace"}):s.formatMessage({id:"gizmo.workspaceRecommended.noWorkplaceName",defaultMessage:"Recommended at your workplace"});return t.jsx(Ie,{side:"right",label:n,children:t.jsx(In,{className:"icon-md",alt:n})})},ws=ze(()=>Fe(()=>import("./6mewn5riemy4ndrm.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),ei=s=>{"use forget";const e=L.c(10),{gizmoResource:n,flair:a}=s,r=Ye();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(ls,{onMouseOver:si,icon:_t}),e[0]=o):o=e[0];let i;e[1]!==a||e[2]!==n||e[3]!==r?(i=a===rs.Recent&&t.jsx(y.Item,{onClick:()=>{st.updateGizmoSidebar(r,Tn,n.gizmo.id,"keep","sidebar")},children:t.jsx(v,{...is.keepInSidebar})}),e[1]=a,e[2]=n,e[3]=r,e[4]=i):i=e[4];let d;e[5]!==n?(d=t.jsx(ws,{gizmoResource:n,location:"sidebar"}),e[5]=n,e[6]=d):d=e[6];let c;return e[7]!==i||e[8]!==d?(c=t.jsxs(Ae,{triggerButton:o,contentAlign:"start",sideOffset:-5,alignOffset:-17,size:"auto",children:[i,d]}),e[7]=i,e[8]=d,e[9]=c):c=e[9],c},ti=s=>{"use forget";const e=L.c(11),{gizmoResource:n,isActive:a}=s,r=xe(),o=ve(),{name:i}=se(),d=i?ne:ae;if(!Gn(n))return null;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(ls,{icon:_t}),e[0]=c):c=e[0];let l;e[1]!==r||e[2]!==n||e[3]!==a||e[4]!==o?(l=g=>{g.preventDefault();const h=function(p){p(),a&&o("/")};at(r,u=>{const{closeModal:p}=u;return t.jsx(En,{gizmoId:n.gizmo.id,onError:void 0,onSuccess:()=>h(p),onClose:()=>{p()}})})},e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=l):l=e[5];let m;e[6]!==d.deleteProjectDropdownButton?(m=t.jsx(v,{...d.deleteProjectDropdownButton}),e[6]=d.deleteProjectDropdownButton,e[7]=m):m=e[7];let f;return e[8]!==l||e[9]!==m?(f=t.jsx(t.Fragment,{children:t.jsx(Ae,{triggerButton:c,contentAlign:"start",sideOffset:-4,alignOffset:-16,size:"auto",children:t.jsx(y.Item,{color:"danger",onClick:l,icon:yt,children:m})})}),e[8]=l,e[9]=m,e[10]=f):f=e[10],f};function si(){return ws.prefetch()}function ni(s){const e=K(),{name:n}=se(),a=n?ne:ae,r=Ye(),o=xe(),i=Ka(o).checkGate("3728943795")&&!s.inSidebarFlyout,d=ve(),[c,l]=w.useState(!1),{snorlaxes:m,hasNextPage:f,fetchNextPage:g,isLoading:h,isFetchingNextPage:u,isError:p}=cs(),x=(s.inSidebarFlyout?m.slice(Dn):m).filter(({gizmo:S})=>S.gizmo.id!==s.currentGizmoId),b=x.length===0,C=w.useRef(null),M=w.useCallback(S=>{h||S==null||(C.current?.disconnect(),C.current=new IntersectionObserver(N=>{N[0].isIntersecting&&f&&g()}),C.current.observe(S))},[h,f,g]);return w.useEffect(()=>()=>{C.current?.disconnect()},[]),t.jsxs("div",{ref:b&&!p?M:void 0,children:[b&&h&&t.jsxs(Wa,{children:[t.jsx(y.Shimmer,{}),t.jsx(y.Shimmer,{})]}),b&&p&&t.jsxs("div",{className:"text-token-text-tertiary p-3 text-center italic",children:[e.formatMessage(a.unableToLoadHistory),!c&&t.jsx("div",{className:"mt-1",children:t.jsx(pe,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{l(!0),An(r)},children:e.formatMessage(a.retryLoadingHistory)})})]}),i&&t.jsx(t.Fragment,{children:t.jsx(y.Item,{icon:ts,label:t.jsx(v,{...a.newProjectHeaderButton}),onSelect:()=>{at(o,({closeModal:S})=>t.jsx(Nt,{onClose:()=>S(),onSuccess:async N=>{N&&(await s.onUpdateConversationGizmo(N),d(`/g/${N}/project`))}}))}})}),!h&&!b&&x.map(({gizmo:S},N)=>{const k=N===x.length-1?M:void 0;return t.jsxs(t.Fragment,{children:[i&&N===0&&t.jsx(y.Separator,{}),t.jsx(y.LinkItem,{to:S!=null?Xe(o,S):"/",icon:t.jsx(Ot,{color:S.gizmo.display.theme}),label:S.gizmo.display.name,onClick:()=>{s.inSidebarFlyout||s.onUpdateConversationGizmo(S.gizmo.id)},ref:k},S.gizmo.id)]})}),u&&t.jsxs(t.Fragment,{children:[t.jsx(y.Shimmer,{}),t.jsx(y.Shimmer,{})]})]})}const Yt=Ts.memo(ni);function ai({resource:s,grayedOut:e,className:n}){const a=s.gizmo.vanity_metrics?.num_conversations_str;return t.jsxs("div",{className:U("flex w-full grow items-center gap-4 overflow-hidden",n),children:[t.jsx(Gt,{isFirstParty:!!s.gizmo.tags?.includes(wt.FirstParty),src:s.gizmo.display.profile_picture_url??void 0,className:U("h-12 w-12 shrink-0",e&&"grayscale group-hover:grayscale-0")}),t.jsxs("div",{className:"overflow-hidden break-words text-ellipsis",children:[t.jsx("span",{className:"line-clamp-2 text-sm leading-tight font-semibold",children:s.gizmo.display.name}),t.jsx("span",{className:"line-clamp-3 text-xs",children:s.gizmo.display.description}),t.jsxs("div",{className:"text-token-text-tertiary mt-1 flex items-center gap-1 pe-1 text-xs text-ellipsis whitespace-nowrap",children:[t.jsx(gt,{gizmo:s,className:"text-xs",hideLink:!0}),a&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-[8px]",children:"•"}),t.jsx(as,{className:"h-3 w-3"}),a]})]})]})]})}const oi=ze(()=>Fe(()=>Promise.resolve().then(()=>Xo),void 0).then(s=>s.SnorlaxSplashScreen)),Zi=({clientThreadId:s,currentModelId:e,onRequestCompletion:n,gizmoId:a})=>{const{data:r}=Ct(a),o=tt(a),i=Xa();return r==null?null:o?t.jsx(oi,{clientThreadId:s,gizmoId:a,currentModelId:e,onRequestCompletion:n}):t.jsx(_s,{gizmo:r,showStarterPrompts:!0,disableStarterPrompts:i})};function _s({gizmo:s,hideOwner:e=!1,children:n,className:a,avatarClassName:r,showStarterPrompts:o=!1,disableStarterPrompts:i=!1}){return s==null?null:t.jsx(t.Fragment,{children:t.jsxs("div",{className:U("text-token-text-primary flex h-full flex-col items-center justify-center","screen-arch:min-h-[calc(100dvh-var(--thread-leading-height)-var(--thread-trailing-height)-12px)]",a),children:[t.jsx(ii,{gizmo:s,avatarClassName:r}),t.jsx(li,{gizmo:s,hideOwner:e,showStarterPrompts:o,disableStarterPrompts:i}),n]})})}function ii({gizmo:s,avatarClassName:e}){const n=!!(s!=null&&On(s)&&s?.gizmo.tags?.includes(wt.FirstParty));return t.jsx("div",{className:"relative",children:t.jsx(Gt,{isFirstParty:n||!s,src:s!=null&&Ve(s)?s.profilePictureUrl:s?.gizmo.display.profile_picture_url,className:U("mb-3 h-12 w-12",e)})})}function ri({gizmo:s,disabled:e}){const n=mo(s),a=ro(),r=Un();if(n==null||n.length===0)return null;const o=n.slice(0,r?2:4);return t.jsx(di,{starterPrompts:o,onSelectStarterPrompt:a,disabled:e})}function li({gizmo:s,hideOwner:e,showStarterPrompts:n,disableStarterPrompts:a}){const r=s!=null&&Ve(s)?s.name:s?.gizmo.display.name,o=s!=null&&Ve(s)?s.description:s?.gizmo.display.description;return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"text-center text-2xl font-semibold",children:r}),!e&&t.jsx("div",{className:"text-token-text-tertiary flex items-center gap-1",children:t.jsx(t.Fragment,{children:s&&Ve(s)?t.jsx(gt,{gizmo:s}):t.jsx(gt,{gizmo:s,socials:s.gizmo.author.display_socials})})}),o&&t.jsx("div",{className:"text-token-text-primary max-w-md text-center text-sm font-normal",children:o}),n&&t.jsx(ri,{gizmo:s,disabled:a})]})}const ci=/\s/;function di({starterPrompts:s,onSelectStarterPrompt:e,disabled:n,cssMobileDisplayLimit:a,marginOverride:r}){let o=s.map((i,d)=>{let c=i.oneliner??i.title;c===""&&(c=i.body);const l=ci.test(c);return t.jsxs("button",{className:U(a!==void 0&&d>=a&&"max-sm:hidden","border-token-border-default shadow-xxs enabled:hover:bg-token-main-surface-secondary relative flex w-40 flex-col gap-2 rounded-2xl border px-3 pt-3 pb-4 text-start align-top text-[15px] transition disabled:cursor-not-allowed"),disabled:n,onClick:m=>e(m,i,s,d),children:[t.jsx(Ln,{category:i.category}),t.jsx("div",{className:U("line-clamp-3 max-w-full text-balance text-gray-600 dark:text-gray-500",l?"break-word":"break-all"),children:c})]},i.id??d)});if(o.length>2){const i=Math.floor(o.length/2);o=[o.slice(0,i),o.slice(i)].map((d,c)=>t.jsx("div",{className:"flex max-w-3xl flex-wrap items-stretch justify-center gap-4",children:d},c))}return t.jsx("div",{className:U("mx-3 flex max-w-3xl flex-wrap items-stretch justify-center gap-4",r??"mt-12"),children:o})}const mi=ze(()=>Fe(()=>import("./6mewn5riemy4ndrm.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),ui=4,it=Pe.div`font-bold mt-6`,fi=s=>Ze({queryFn:async()=>st.getAbout(s),queryKey:["gizmo","about",{gizmoId:s}]}),xi=s=>Ze({queryFn:async()=>st.getCreatorSlice({creatorId:s}),queryKey:["gizmo","creator",{creatorId:s}],enabled:s!=null}),gi=s=>{switch(s.type){case Se.BROWSER:return{title:fe.browsing};case Se.PYTHON:return{title:fe.dataAnalysis};case Se.DALLE:return{title:fe.dalle};case Se.IMAGE_GEN:return{title:fe.imageGen};case Se.MEMORY:return{title:fe.memory,description:fe.memoryDescription};case Se.JIT_PLUGIN:return{title:fe.actions,description:fe.actionsDescription};default:return null}},hi=({tools:s})=>{const e=Ft(),n=e?.includes(Ee.SearchTool)&&!e?.includes(Ee.SearchToolHoldout),a=Rn(s??[],o=>o.type);var r=Ya(a.map(gi).filter(o=>o!=null)??[]);return r.length===0?null:(n&&(r=r.map(o=>o.title===fe.browsing?{title:fe.search}:o)),t.jsxs("div",{className:"flex flex-col",children:[t.jsx(it,{className:"mb-2",children:t.jsx(v,{id:"gizmo.about.capabilitiesHeader",defaultMessage:"Capabilities"})}),r.map(o=>t.jsxs("div",{className:"flex flex-row items-start gap-2 py-1 text-sm",children:[t.jsx(Bn,{className:"icon-sm mt-0.5 text-green-600"}),t.jsxs("div",{children:[t.jsx(v,{...o.title}),o.description!=null&&t.jsx("div",{className:"text-token-text-tertiary text-xs",children:t.jsx(v,{...o.description})})]})]},o.title.id))]}))},He=Pe.div`flex flex-col justify-center items-center gap-2 border-s border-token-border-heavy first:border-0 w-48 mt-4 px-2`,$e=Pe.div`flex flex-row items-center gap-1.5 pt-1 text-xl font-semibold text-center leading-none`,qe=Pe.div`text-xs text-token-text-tertiary`,pi=({gizmoResource:s})=>t.jsxs(Ae,{contentAlign:"end",sideOffset:4,triggerButton:t.jsx(pe,{color:"ghost",icon:_t}),children:[t.jsx(mi,{gizmoResource:s,location:"about_modal"}),t.jsx(ms,{gizmoResource:s})]}),ji=({aboutBlock:s})=>{switch(s.type){case"generic_title_subtitle":return t.jsxs(He,{children:[t.jsx($e,{children:s.title}),t.jsx(qe,{children:s.subtitle})]});case"rating":return t.jsxs(He,{children:[t.jsxs($e,{children:[t.jsx(us,{className:"icon-sm"}),s.avg]}),t.jsx(qe,{children:s.count_str})]});case"category":return s.category_ranking!=null?t.jsxs(He,{children:[t.jsx($e,{children:t.jsx(v,{id:"gizmo.about.trendingRank",defaultMessage:"#{rank}",values:{rank:s.category_ranking}})}),t.jsx(qe,{children:t.jsx(v,{id:"gizmo.about.inCategory",defaultMessage:"in {category} {locale}",values:{category:s.category_str,locale:s.category_locale_str??""}})})]}):t.jsxs(He,{children:[t.jsx($e,{children:s.category_str}),t.jsx(qe,{children:t.jsx(v,{id:"gizmo.about.category",defaultMessage:"Category"})})]})}},vi=({blocks:s})=>t.jsx("div",{className:"flex justify-center",children:s.map(e=>t.jsx(ji,{aboutBlock:e},e.type))}),bi=({href:s,onClick:e,children:n})=>t.jsx(Qt.div,{whileTap:{scale:.98},className:"flex",children:t.jsxs(Zt,{to:s,reloadDocument:!0,onClick:e,className:U("group border-token-border-medium bg-token-main-surface-primary hover:bg-token-main-surface-secondary relative ms-2 h-14 min-w-full grow rounded-xl border px-4 focus:outline-hidden"),children:[t.jsx("div",{className:"flex h-full items-center",children:t.jsx("div",{className:"line-clamp-2 text-sm break-all",children:n})}),t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary group-hover:bg-token-main-surface-secondary absolute -start-2 -bottom-px h-3 w-4 border-b",children:t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary h-3 w-2 rounded-ee-full border-e border-b"})}),t.jsx("div",{className:"absolute end-2 top-0 bottom-0 hidden items-center group-hover:flex",children:t.jsx("div",{className:"bg-token-main-surface-primary flex h-8 w-8 items-center justify-center rounded-lg",children:t.jsx(Je,{className:"icon-md text-token-text-primary"})})})]})}),Si=({gizmo:s,onClose:e})=>{const n=Ge("1825130190").value,a=s.gizmo.display.prompt_starters?.slice(0,ui);return a==null||a.length===0||!n?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx(it,{children:t.jsx(v,{id:"gizmo.about.conversationStartersHeader",defaultMessage:"Conversation Starters"})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-x-1.5 gap-y-2",children:a.map((r,o)=>t.jsx(yi,{gizmo:s,prompt:r,onClick:e},o))})]})};function yi({gizmo:s,prompt:e,onClick:n}){const a=xe(),r=Hn(a,s,e);return t.jsx(bi,{href:r?.toString()??"#",onClick:n,children:e})}const Ci=({reviewStats:s})=>Ge("1825130190").value?t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(it,{children:t.jsx(v,{id:"gizmo.about.ratingsHeader",defaultMessage:"Ratings"})})}),s!=null?[5,4,3,2,1].map(n=>t.jsxs("div",{className:"flex flex-row items-center gap-2 py-1 text-xl font-semibold",children:[t.jsxs("div",{className:"icon-lg relative",children:[t.jsx(us,{className:"icon-lg text-green-500"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-[11px] text-white",children:n})]}),t.jsx("div",{className:"h-2.5 grow overflow-hidden rounded-full bg-gray-100 dark:bg-gray-700",children:t.jsx("div",{className:"h-full bg-green-500",style:{width:`${(s?.by_rating[n-1]??0)*100}%`}})})]},n)):t.jsx("div",{className:"text-token-text-tertiary text-sm",children:t.jsx(v,{id:"gizmo.about.ratings.notEnoughRatings",defaultMessage:"Not enough ratings yet"})})]}):null,Ni=({gizmoId:s,creatorId:e})=>{const n=ds(he.GPTDetails),a=()=>ce.closeModal(he.GPTDetails);return n?t.jsx(Mi,{gizmoId:s,creatorId:e,onClose:a}):null},Mi=({gizmoId:s,creatorId:e,onClose:n,children:a})=>{const r=Ct(s),o=fi(s),i=xi(e);return w.useEffect(()=>{te.logEvent("Detail Show Modal",{gizmo_id:s})},[s]),t.jsx(Ue,{testId:"modal-gizmo-about",isOpen:!0,onClose:n,type:"success",hideSeparator:!0,showCloseButton:!0,noPadding:!0,className:"flex h-[calc(100vh-25rem)] min-h-[40vh] max-w-xl flex-col",children:t.jsx(wi,{aboutQuery:o,gizmoQuery:r,creatorSliceQuery:i,onClose:n,children:a})})},wi=({aboutQuery:s,gizmoQuery:e,creatorSliceQuery:n,children:a,onClose:r})=>{const o=K();if(s.isLoading||e.isLoading||n.isLoading)return t.jsx("div",{className:"flex h-40 items-center justify-center pb-10",children:t.jsx(Ss,{})});const i=s.data?.gizmo,d=n?.data,c=e?.data;if(!i||s.error||e.error||n.error||s.data==null||e.data==null||n.data==null||!c){const l=It(s.error??e.error??n.error)??o.formatMessage({id:"I3v3Oj",defaultMessage:"An error occurred loading this GPT."});return t.jsx("div",{className:"relative flex flex-col gap-2 overflow-hidden px-2 py-4",children:t.jsx("div",{className:"flex flex-col p-4 text-red-500",children:l})})}return t.jsx("div",{className:"flex h-full px-2 py-4",children:t.jsxs("div",{className:"relative flex grow flex-col gap-4 overflow-y-auto px-8 pt-16 pb-20",children:[t.jsx("div",{className:"absolute top-0",children:t.jsxs("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex items-center justify-end bg-linear-to-b to-transparent pb-2",children:[c&&t.jsx(pi,{gizmoResource:c}),t.jsx(bs,{onClick:r})]})}),t.jsx("div",{className:"absolute bottom-[64px]",children:t.jsx("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex min-h-[64px] items-end bg-linear-to-t to-transparent px-2",children:a})}),t.jsx(_s,{gizmo:c,className:"h-fit!",avatarClassName:"h-20! w-20!"}),t.jsx(vi,{blocks:s.data.about_blocks}),t.jsx(Si,{gizmo:c,onClose:r}),t.jsx(hi,{tools:c.tools}),t.jsx(Ci,{reviewStats:s.data.review_stats}),d&&t.jsx(_i,{gizmos:d.items})]})})};function _i({gizmos:s}){const e=xe();return s.length===0?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(it,{children:t.jsx(v,{id:"gizmo.about.moreByHeader",defaultMessage:"More by {creatorName}",values:{creatorName:s[0].gizmo.author.display_name}})})}),t.jsx("div",{className:U("no-scrollbar group flex min-h-[104px] items-center space-x-2 overflow-x-auto overflow-y-hidden"),children:s?.map(n=>t.jsx("a",{onClick:()=>{te.logEvent("Detail Click Gizmo",{gizmo_id:n.gizmo.id})},href:Xe(e,n),className:"bg-token-main-surface-secondary h-fit min-w-fit rounded-xl px-1 py-4 md:px-3 md:py-4 lg:px-3",children:t.jsx(ai,{resource:n})},n.gizmo.id))})]})}const Qi=s=>t.jsx("div",{className:"flex grow flex-col items-center",children:t.jsxs(pe,{color:"primary",className:"h-12 w-full",icon:Je,...s,children:[t.jsx(v,{id:"gizmo.about.startChat",defaultMessage:"Start Chat"}),s.children]})}),fe=St({browsing:{id:"gizmo.about.tools.browsing",defaultMessage:"Browsing"},search:{id:"gizmo.about.tools.search",defaultMessage:"Web Search"},dataAnalysis:{id:"gizmo.about.tools.dataAnalysis",defaultMessage:"Code Interpreter & Data Analysis"},dalle:{id:"gizmo.about.tools.dalle",defaultMessage:"DALL·E Images"},imageGen:{id:"gizmo.about.tools.imageGen",defaultMessage:"4o Image Generation"},memory:{id:"gizmo.about.tools.memory",defaultMessage:"Memory"},actions:{id:"gizmo.about.tools.actions",defaultMessage:"Actions"},actionsDescription:{id:"gizmo.about.tools.actionsDescription",defaultMessage:"Retrieves or takes actions outside of ChatGPT"},memoryDescription:{id:"gizmo.about.tools.memoryDescription",defaultMessage:"Learns from previous chats to improve future conversations"}}),ki=ze(()=>Fe(()=>import("./6mewn5riemy4ndrm.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem));function Ii({children:s,clientThreadId:e,gizmoResource:n,showReportModal:a,inMobileHeader:r,showGizmoModelPicker:o}){return t.jsxs(t.Fragment,{children:[t.jsx(Ae,{contentAlign:r?"center":"start",size:"small",triggerButton:s,children:t.jsx(ks,{clientThreadId:e,gizmoResource:n,showReportModal:a,showGizmoModelPicker:o})}),t.jsx(zi,{gizmoResource:n})]})}function zi({gizmoResource:s}){const e=ds(he.GPTRemoveThirdParty),n=kt(),a=fs(s);return t.jsxs(t.Fragment,{children:[t.jsx(Ni,{gizmoId:s.gizmo.id,creatorId:s.gizmo.author.user_id}),t.jsx(sa,{gizmo:s}),a&&t.jsx(na,{gizmo:s}),a&&t.jsx(aa,{gizmo:s}),t.jsx(oa,{gpt:s,isOpen:e,onClose:()=>ce.closeModal(he.GPTRemoveThirdParty),account:n})]})}function ks({clientThreadId:s,gizmoResource:e,showReportModal:n,showGizmoModelPicker:a}){const r=ke(e),o=$n(e),i=qn(e.gizmo.id),d=Ft(),c=Vn(e),l=e.gizmo.share_recipient===We.Marketplace||e.gizmo.share_recipient===We.Link,m=!c&&l,f=Ge("1825130190").value,g=Ge("3645668434").value,h=f&&!c&&fs(e),u=d?.includes(Ee.GizmoSupportEmails)&&!c&&e.gizmo.author.will_receive_support_emails&&h,p=Za(),j=zt(s),x=xs(Ee.WorkspaceShareLinks),{isUnauthenticated:b}=ot(),C=x&&j&&!b,M=ve();return t.jsxs(t.Fragment,{children:[t.jsx(Kn,{show:a,clientThreadId:s,gizmoHasCustomActions:Wn(e.tools)}),t.jsx(y.Item,{onClick:()=>{te.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:e.gizmo.id}),hs(M,`/g/${e.gizmo.short_url}`)},icon:gs,children:t.jsx(v,{...ee.newChat})}),t.jsx(y.Item,{onClick:()=>ce.openModal(he.GPTDetails),icon:Xn,children:t.jsx(v,{...ee.about})}),e.tools?.find(S=>S.type===Se.JIT_PLUGIN)&&t.jsx(y.Item,{onClick:()=>ce.openModal(he.GPTPrivacySettings),icon:Yn,children:t.jsx(v,{...ee.privacySettings})}),r&&t.jsx(y.Item,{onClick:()=>{M(i)},icon:ps,children:t.jsx(v,{...ee.customize})}),!r&&o&&g&&t.jsxs(t.Fragment,{children:[t.jsx(y.Item,{onClick:async()=>{M(`/g/${e.gizmo.id}/view`)},icon:Zn,children:t.jsx(v,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),t.jsx(y.Item,{onClick:async()=>{const S=await st.copyGizmo({gizmoId:e.gizmo.id});S.gizmo.id&&M(`/gpts/editor/${S.gizmo.id}`)},icon:Qn,children:t.jsx(v,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),t.jsx(ki,{gizmoResource:e,location:"conversation_page"}),t.jsx(ms,{gizmoResource:e}),u&&t.jsx(y.Item,{onClick:()=>ce.openModal(he.GPTFeedbackEmail),icon:Je,children:t.jsx(v,{...ee.feedbackEmail})}),h&&t.jsx(y.Item,{onClick:()=>ce.openModal(he.GPTReview),icon:Jn,children:t.jsx(v,{...ee.reviewGPT})}),m&&t.jsx(y.Item,{onClick:n,icon:ea,children:t.jsx(v,{...ee.report})}),C&&t.jsx(y.Item,{onClick:()=>ce.openSharingModal(j),icon:js,children:t.jsx(v,{...ee.shareChat})}),p&&t.jsxs(t.Fragment,{children:[t.jsx(y.Separator,{}),t.jsx(y.Item,{color:"danger",onClick:()=>ce.openModal(he.GPTRemoveThirdParty),icon:Qa,children:t.jsx(v,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),d?.includes("debug")&&t.jsxs(t.Fragment,{children:[t.jsx(y.Separator,{}),t.jsx(y.Item,{onClick:()=>{M(ta(e))},children:"(Internal) See share page"})]})]})}const Fi=({conversation:s,inMainScreen:e=!1,isActiveConversation:n,inChatWindow:a=!1})=>{const r=xe(),o=s.id,i=s.gizmo_id,d=tt(i),c=jt(r,"16480203"),l=Ja(o),m=xs(Ee.WorkspaceShareLinks),{isUnauthenticated:f}=ot(),g=m&&l&&!f&&(!d||c),h=ia(),{name:u}=se(),p=u?ne:ae,[j,x]=w.useState(!!s.is_do_not_remember),b=K();let C=null;const{snorlaxes:M}=cs();C=M;let S=null;d&&C&&(S=C.find(({gizmo:z})=>z.gizmo.id===i)?.gizmo);const N=es(),k=Ye(),{eligible:_,markAsViewed:P}=ra(la.ArchiveConversationOnboarding),I=Oe(),G=ve(),R=async()=>{await Pt.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:s.id}},requestBody:{is_archived:!0}}),ua(k,s.gizmo_id),eo.logEvent("chatgpt_conversation_archived"),te.logEvent("Conversation Archived"),_&&(I.info(b.formatMessage({defaultMessage:"You can view archived chats in Settings",id:"HistoryGizmoItem.archiveChatOnboarding"}),{duration:10,hasCloseButton:!0}),P()),n&&hs(G)};return t.jsxs(t.Fragment,{children:[g&&!a&&t.jsx(y.Item,{onClick:()=>ce.openSharingModal(l,"History Item Menu"),icon:js,"data-testid":"share-chat-menu-item",children:t.jsx(v,{...ee.shareChat})}),!1,!a&&t.jsx(y.Item,{disabled:!l,onClick:()=>{setTimeout(()=>{l&&os.publish({kind:e?"editTitleInMainScreen":"editTitle",serverThreadId:l})},100)},icon:Qe,children:t.jsx(v,{...ee.renameChat})}),h&&C&&C?.length>0&&ca(i)&&l&&t.jsxs(t.Fragment,{children:[d&&t.jsxs(t.Fragment,{children:[C.length>1&&t.jsxs(y.Sub,{children:[t.jsx(y.SubMenuTrigger,{icon:xt,children:t.jsx(v,{...p.moveConversationToSnorlax})}),t.jsx(y.Portal,{children:t.jsx(y.SubContent,{children:t.jsx(Yt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>N({newGizmoId:z,conversation:s,previousGizmoId:i}),currentGizmoId:i})})})]}),t.jsx(y.Item,{onClick:()=>{N({newGizmoId:null,conversation:s,previousGizmoId:i})},icon:da,children:t.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:t.jsx(v,{...p.removeConversationFromSnorlax,values:{projectName:S?.gizmo.display.name??"project"}})})})]}),!d&&t.jsxs(y.Sub,{children:[t.jsx(y.SubMenuTrigger,{icon:xt,children:b.formatMessage(p.addConversationToSnorlax)}),t.jsx(y.Portal,{children:t.jsx(y.SubContent,{children:t.jsx(Yt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>N({newGizmoId:z,conversation:s,previousGizmoId:i})})})})]})]}),t.jsx(y.Separator,{}),t.jsx(y.Item,{disabled:!l,onClick:()=>{l&&R()},icon:ma,children:t.jsx(v,{...ee.archiveChat})}),!1,t.jsx(y.Item,{color:"danger",disabled:!l,onClick:()=>{l&&at(r,fa,{serverThreadId:l,isActiveConversation:n})},icon:yt,"data-testid":"delete-chat-menu-item",children:t.jsx(v,{...ee.deleteChat})})]})},Is=({conversation:s,children:e,onOpenChange:n,inMainScreen:a=!1,isActiveConversation:r,inChatWindow:o=!1,...i})=>{const[d,c]=w.useState(!1);return t.jsx(Ae,{...i,open:d,onOpenChange:l=>{c(l),n?.(l)},side:"bottom",contentAlign:o?"end":"start",alignOffset:o?0:-17,sideOffset:o?0:-5,triggerButton:e,size:"auto",children:d&&t.jsx(Fi,{conversation:s,inMainScreen:a,isActiveConversation:r,inChatWindow:o})})},ee=St({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}}),Ji=Object.freeze(Object.defineProperty({__proto__:null,GizmoConversationOptionsDropdown:Is,GizmoInformationDropdown:Ii,GizmoInformationDropdownItems:ks},Symbol.toStringTag,{value:"Module"})),Le=to(so(()=>({feedItems:[],hasUnreadNotifications:!1,isModalOpen:!1}))),Pi=Le.getState,dt=Le.setState,Ti={getHasUnreadNotifications:(s=Pi())=>s.hasUnreadNotifications},_e={setIsModalOpen:s=>{dt({isModalOpen:s})},setHasUnreadNotifications:s=>{dt({hasUnreadNotifications:s})},bulkLoadFeedItems:s=>{dt(e=>{e.feedItems=s})}};function Gi(){const s=Ut(),e=Le(Ti.getHasUnreadNotifications);return s&&e}function zs(s,e,n,a){const r=Gi(),o=xa();return r||a&&o?s:e}function Ut(){const{layer:s}=Tt("3606233934",{shouldLogExposure:!1});return s.get("enable_notifications_feed")}function er(){const s=Ut(),e=Le(n=>n.isModalOpen);return s&&e}function Ei(){const s=Ut(),e=Ze({queryKey:["fetch-notifications-feed"],queryFn:async()=>{const n=await Pt.safeGet("/notifications/feed");return _e.bulkLoadFeedItems(n.items),_e.setHasUnreadNotifications(n.has_unreads),n.items},enabled:s});return{isLoading:e.isLoading,isFetching:e.isFetching}}function tr(){const s=K(),e=zs(ya,Sa,!0,!1),n=s.formatMessage({id:"1UHY6w",defaultMessage:"Notifications"});return Ei(),t.jsx(Ie,{label:n,className:"group",children:t.jsx(nt,{icon:e,onClick:()=>_e.setIsModalOpen(!0),"aria-label":n})})}function Di({item:s,closeModal:e}){const a={announcement:va}[s.type];let r=null;try{const l=new Date(s.created_at);r=ba({date:l})}catch{}const{clientThreadId:o}=Et(),i=fo(o),d=ve(),c=l=>{if(s.action?.type==="show_conversation")e(),d(s.action.conversation_id);else if(s.action?.type==="new_conversation"){const m=s.action;m.prefilled_message&&(i({sourceEvent:l,promptMessage:ao(m.prefilled_message),requestedModelId:m.model_slug??void 0}),e())}};return t.jsxs("button",{className:"border-token-border-default flex w-full items-center justify-start gap-3 overflow-hidden border-t py-4 first-of-type:border-none",onClick:c,disabled:!s.action,children:[t.jsx("div",{className:"relative",children:a&&t.jsx(a,{className:"icon-md"})}),t.jsxs("div",{className:"flex h-5 shrink grow basis-0 items-center justify-between",children:[t.jsx("div",{className:"text-token-text-primary text-sm leading-tight font-normal",children:s.message}),t.jsx("div",{className:"flex items-center justify-start gap-1",children:t.jsx("div",{className:"text-token-text-tertiary text-sm leading-tight font-normal",children:r??""})})]})]})}function sr(){const{feedItems:s,isModalOpen:e}=Le();w.useEffect(()=>{e&&(_e.setHasUnreadNotifications(!1),Pt.safePost("/notifications/feed/read",{authOption:no.SendIfAvailable}))},[e]);const n=K(),a=ve(),{value:r}=Ge("3325813340"),o=new Date,i=ga(s,c=>{const l=new Date(c.created_at);if(ha(l))return"today";const m=pa(o,l);return m<=7?"last_7_days":m<=30?"last_30_days":"more_than_30_days"}),d=c=>{switch(c){case"today":return n.formatMessage({id:"zlkA39",defaultMessage:"Today"});case"last_7_days":return n.formatMessage({id:"FW89A4",defaultMessage:"Last 7 days"});case"last_30_days":return n.formatMessage({id:"2s3h/P",defaultMessage:"Last 30 days"});case"more_than_30_days":return n.formatMessage({id:"yArZiR",defaultMessage:"More than 30 days"})}};return t.jsx(Ue,{testId:"modal-notifications-feed",isOpen:e,onClose:()=>{_e.setIsModalOpen(!1)},type:"success",size:"custom",className:"max-w-3xl",children:t.jsxs("div",{className:"flex flex-col gap-y-10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold",children:n.formatMessage({id:"kWt8Cx",defaultMessage:"Notifications"})}),r&&t.jsx(ja,{icon:t.jsx(ps,{className:"icon-lg"}),onClick:()=>{a("/#settings/Notifications")},label:n.formatMessage({id:"mZVh0S",defaultMessage:"Notifications settings"})})]}),Object.entries(i).map(([c,l])=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:d(c)}),l.map(m=>t.jsx(Di,{item:m,closeModal:()=>_e.setIsModalOpen(!1)},m.id))]},c))]})})}function nr({showShareButton:s,showProfileDropdown:e,clientThreadId:n}){const a=xe(),r=zt(n),o=K(),{layer:i}=Tt("1547743984");jt(a,"1288877412"),jt(a,"3204157926");const[d,c,l,m]=pt(n,N=>[Kt.hasUserMessage(N),Kt.getGizmoId(N),Aa(N),N?.is_do_not_remember??null]),f=oo(n),{prefetchSearchPromises:g}=Et(),h=g!=null,u=i.get("show_share_button_text",!1),p=o.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),j=()=>ce.openSharingModal(r),x=tt(c),b=Ft();io();const{isUnauthenticated:C}=ot(),M=pt(n,N=>N),S=w.useMemo(()=>n==null?null:{id:n,title:M?.title??"",create_time:null,update_time:null,conversation_template_id:null,async_status:M?.async_status??null,gizmo_id:c??null,snippet:null,is_do_not_remember:m},[c,n,M?.title,M?.async_status,m]);return t.jsxs(t.Fragment,{children:[t.jsx(Ma,{}),vt(a)?t.jsx(wa,{}):null,!1,!C&&!c&&f&&!h&&!d&&t.jsxs(t.Fragment,{children:[!1,t.jsx(_a,{clientThreadId:n})]}),vt(a)&&b?.includes("caterpillar")&&t.jsx(ka,{}),null,s&&r&&t.jsx(t.Fragment,{children:u?t.jsx(pe,{onClick:j,icon:$t,label:p,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{viewTransitionName:"var(--vt_share_chat_wide_button)"},children:p}):t.jsx(Ie,{label:o.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:t.jsx(nt,{"data-testid":"share-chat-button",onClick:j,icon:$t,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),r!=null&&S!=null&&!C?t.jsx(Is,{conversation:S,inMainScreen:!0,isActiveConversation:!0,inChatWindow:!0,children:t.jsx(Ia,{"aria-label":o.formatMessage({id:"9Mk/E3",defaultMessage:"Open conversation options"}),"data-testid":"conversation-options-button"})}):c&&x?t.jsx(t.Fragment,{children:t.jsx(za,{gizmoId:c})}):null,e&&t.jsx(Ai,{clientThreadId:n})]})}function Ai({clientThreadId:s}){const e=xe();return qt.markStart("LoginOrProfileMenu"),qt.markRendered("LoginOrProfileMenu"),t.jsxs(t.Fragment,{children:[!vt(e)&&t.jsx(Li,{}),t.jsx(Ta,{clientThreadId:s})]})}function Oi({onClick:s,className:e,testId:n}){const r=K().formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return t.jsx(Ie,{label:r,className:U("flex",e),children:t.jsx(nt,{onClick:o=>Na(o,s),icon:gs,"aria-label":r,"data-testid":n,as:"link"})})}function ar({clientThreadId:s,hideNewChat:e=!1}){const n=vs(),a=Ca({clientThreadId:s,location:"Navigation actions"});return n?null:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ui,{}),!e&&t.jsx(Oi,{onClick:a})]})}function Ui(){const s=K(),e=vs(),{isUnauthenticated:n}=ot(),a=zs(Pa,Fa,!0,!0);return n||e?null:t.jsx(Ie,{label:s.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:t.jsx(nt,{"aria-label":s.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:()=>{ce.setSidebarOpen(!0)},icon:a})})}function Li(){const s=Ga(),e=Ea(),n=Da(Ri.signUpCta),{layer:a}=Tt("3637408529"),r=a.get("is_desktop_primary_auth_button_on_right",!1),o=()=>{s({authType:"login",callback:m=>{te.logLogInButtonClicked({location:"Chat header",provider:m})}})},i=()=>{s({authType:"signup",callback:m=>{te.logSignUpButtonClicked({location:"Chat header",provider:m})}})},d=t.jsx(pe,{onClick:o,color:e?"primary":"secondary","data-testid":"login-button",className:U(!e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),c=t.jsx(pe,{color:e?"secondary":"primary",onClick:i,"data-testid":"signup-button",className:U(e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{...n})},"signup"),l=e?[d,c]:[c,d];return t.jsx("div",{className:"flex items-center justify-center gap-2",children:r?l.reverse():l})}const Ri=St({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"}});export{nr as C,Ui as E,Mi as G,Ai as L,ar as N,Yt as S,Qi as a,_s as b,ai as c,sr as d,zs as e,Zi as f,Li as g,Yi as h,At as i,Ut as j,tr as k,Oi as l,Ji as m,er as u};
//# sourceMappingURL=ic7rccsdo5x6ovoh.js.map

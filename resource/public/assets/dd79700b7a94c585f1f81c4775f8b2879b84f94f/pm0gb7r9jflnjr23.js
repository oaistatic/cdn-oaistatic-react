import{j as t,r as u,a5 as N}from"./cs2gapsc2bulabhw.js";import{a7 as P,a8 as D,a9 as J,aa as H,ab as V,ac as Q,ad as X,ae as Y,af as Z}from"./pduvb49qgyq1mqhk.js";import{u as I,c as b,aw as ee,en as te,b9 as ne}from"./eb6xg52mym6rhnsh.js";function fe(e){return P(),null}function xe(e){return P()?null:t.jsx(se,{...e})}function se({webpageRef:e,trackContentReferenceEvent:s,messageId:n,index:i}){const[a,o]=u.useState(null);switch(e.status){case"loading":return null;default:return t.jsx(t.Fragment,{children:e.items.map((d,l)=>{const f=a===l;return t.jsx(ae,{webpageItem:d,trackContentReferenceEvent:s,onMouseEnter:()=>{o(l)},isLastHovered:f,messageId:n,analyticsMetadata:{section:"inline",section_location:"response",section_index:d.section_index},index:i},`${l}-${d.url}-${f}`)})})}}const F={prev:{x:"0%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,pointerEvents:"auto",transition:{duration:.15,ease:"easeOut"}},next:{x:"5%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}}};function ae({webpageItem:e,className:s,trackContentReferenceEvent:n,onMouseEnter:i,isLastHovered:a,messageId:o,analyticsMetadata:d,index:l,noMarginStart:f}){const x=c=>({url:c.url,title:c.title,pub_date:J(c.pub_date),sub_pill_index:c.sub_pill_index,link_type:"pill",...d}),h=e.supporting_websites?.length??0,[v,j]=u.useState(!1),[A,z]=u.useState(!1),r=(v||A)&&a,_=u.useRef(r);r||(_.current=!1);const C=!r||!_.current,k=u.useRef(null),[w,R]=u.useState(null);u.useEffect(()=>{k.current=null,R(null)},[e]),I(()=>{if(k.current){const{offsetWidth:c}=k.current;R(c+1)}},[]),u.useEffect(()=>{a&&(r?D.setHighlightBySource(o,e):D.clearHighlights())},[r,a,o,e]);const m=[e,...e.supporting_websites??[]],[p,B]=u.useState(0),M=c=>{c!==p&&r&&(_.current=r),B(c)},y=m[p]??e,L=g(p-1,m.length),O=g(p+1,m.length),E={url:y.url,title:y.title,pub_date:y.pub_date,sub_pill_index:p};u.useEffect(()=>{r||M(0)},[r]);const T=re(o,l??0,p);u.useEffect(()=>{T||(n("link_action","link_action","webpage",{...x(E),action:"show"}),ce(o,l??0,p))},[T]);const $=()=>{n("link_action","link_action","webpage",{...x(E),action:"click"})},K=c=>{c&&n("link_action","link_action","webpage",{...x(E),action:"hover"}),z(c)},U=t.jsx("span",{ref:k,className:b(!f&&"ms-1","inline-flex max-w-full items-center","relative top-[-0.094rem]","animate-[show_150ms_ease-in]"),style:w?{width:w}:void 0,children:t.jsx(H,{href:y.url,className:b("flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium",r?"bg-token-text-primary! text-token-main-surface-primary!":"text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]!","transition-colors duration-150 ease-in-out",s),style:w?{maxWidth:w}:void 0,onClick:$,onMouseEnter:()=>{i?.(),j(!0)},onMouseLeave:()=>{j(!1)},children:t.jsxs("span",{className:"relative start-0 bottom-0 flex h-full w-full items-center",children:[m.length>2&&t.jsx(W,{variant:"prev",item:m[L],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:C,className:"absolute"},L),t.jsx(W,{variant:"cur",item:m[p],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:C},p),m.length>1&&t.jsx(W,{variant:"next",item:m[O],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:C,className:"absolute"},O)]})})});return t.jsx(ie,{webpageItem:e,isLastHovered:a,open:A,onOpenChange:K,onClick:$,currentItemIndex:p,setCurrentItemIndex:M,children:U})}function W({className:e,variant:s,item:n,numAdditionalSupportingWebsites:i,isActive:a,shouldShowSupportingCount:o,...d}){const l=o&&i>0;return t.jsxs(N.span,{variants:{prev:{x:"0%",opacity:0,transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,transition:{duration:.1,ease:"easeOut"}},next:{x:"10%",opacity:0}},animate:s,initial:s,className:b("flex h-4 w-full items-center justify-between",!l&&"overflow-hidden",e),...d,children:[t.jsx("span",{className:"max-w-full grow truncate overflow-hidden text-center",children:n.attribution??V(n.url)}),l&&t.jsxs("span",{className:b("-me-1 flex h-full items-center rounded-full px-1 text-[#8F8F8F]",a&&"text-token-main-surface-tertiary"),children:["+",i]})]})}function ie({webpageItem:e,onClick:s,open:n,onOpenChange:i,children:a,isLastHovered:o,currentItemIndex:d,setCurrentItemIndex:l,className:f}){const x=te();if(!o)return n&&i?.(!1),a;const h=t.jsx(oe,{webpageItem:e,onClick:s,currentItemIndex:d,setCurrentItemIndex:l});return t.jsx(Q,{label:h,onOpenChange:i,side:"bottom",delayDuration:150,theme:x?"default":"white",align:"start",customPaddingClassName:"p-0",cornerRadius:"xl",customBorderClassName:"border-token-border-default border",contentClassName:"animate-show",className:f,wide:!0,interactive:!0,children:a})}function S({item:e,onClick:s}){if(!e)return null;const n=e.pub_date!=null?new Date(e.pub_date*1e3):null;return t.jsxs(H,{className:"flex flex-col gap-2 p-3",href:e.url,onClick:s,children:[t.jsxs("div",{className:"flex gap-1.5",children:[t.jsx("div",{className:"h-4 w-4 shrink-0 overflow-hidden rounded-full",children:t.jsx(Z,{url:e.url,size:32,minSize:16})}),t.jsx("div",{className:"text-token-text-primary truncate",children:e.attribution??V(e.url)})]}),t.jsx("div",{className:"line-clamp-2 text-sm font-medium",children:e.title}),t.jsxs("div",{className:"text-token-text-secondary line-clamp-2 text-sm",children:[le(n),n&&e.snippet&&" â€” ",e.snippet]})]})}function oe({webpageItem:e,onClick:s,currentItemIndex:n,setCurrentItemIndex:i}){const a=[e,...e.supporting_websites??[]],o=a[n??0],d=n!=null&&`${n+1}/${a.length}`,l=n?a[g(n+1,a.length)]:void 0,f=n?a[g(n-1,a.length)]:void 0,x=()=>{n!=null&&i?.(g(n+1,a.length))},h=()=>{n!=null&&i?.(g(n-1,a.length))};u.useEffect(()=>ne(document,{keydown:j=>{j.key==="ArrowRight"?x():j.key==="ArrowLeft"&&h()}}));const v=b("flex flex-col dark:bg-token-main-surface-secondary");return t.jsxs("span",{className:"text-token-text-primary flex flex-col text-start text-xs font-normal no-underline!",children:[n!=null&&a.length>1&&t.jsxs("div",{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-tertiary flex h-9 items-center justify-between gap-1.5",children:[t.jsxs("div",{className:"text-token-text-secondary mx-1.5 flex gap-1",children:[t.jsx("button",{onClick:h,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(X,{className:"icon-sm m-auto"})}),t.jsx("button",{onClick:x,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(Y,{className:"icon-sm m-auto"})})]}),t.jsx("span",{className:"text-token-text-tertiary mx-3.5",children:d})]}),n!=null&&a.length>1?t.jsxs("div",{className:"flex overflow-hidden",children:[a.length>2&&t.jsx(N.span,{className:b(v,"absolute"),variants:F,animate:"prev",initial:"prev",children:t.jsx(S,{item:f,onClick:s})},g(n-1,a.length)),t.jsx(N.span,{className:v,variants:F,animate:"cur",initial:"cur",children:t.jsx(S,{item:o,onClick:s})},n),a.length>1&&t.jsx(N.span,{className:b(v,"absolute"),variants:F,animate:"next",initial:"next",children:t.jsx(S,{item:l,onClick:s})},g(n+1,a.length))]}):t.jsx("div",{className:v,children:t.jsx(S,{item:o,onClick:s})})]})}function le(e){return e&&e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}function g(e,s){return(e%s+s)%s}const G=ee(()=>({}));function q(e,s,n){return`${e}-${s}-${n}`}function re(e,s,n){return G(i=>i[q(e,s,n)])}function ce(e,s,n){G.setState(i=>({...i,[q(e,s,n)]:1}))}export{ae as W,xe as a,ie as b,fe as c};
//# sourceMappingURL=pm0gb7r9jflnjr23.js.map

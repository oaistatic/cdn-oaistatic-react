import{ds as z,au as X,kQ as Y,H as j,kR as V,kS as $,kT as q,kU as O,ky as J,hX as Q,kV as Z,kW as ee,kX as F,kY as te,kZ as ne,k_ as se,k$ as ae,l0 as re,l1 as oe,av as v,l2 as ie,l3 as S,l4 as I,l5 as ce,l6 as le,l7 as ue,az as pe,ab as de}from"./pduvb49qgyq1mqhk.js";import{c0 as b,e as f,h as fe,i as ge,B as me,an as he,f as P,dB as _e,a8 as ke,c as xe,o as ye,a9 as Ce,s as w,N as E,aV as ve,aC as Se,dj as be,fi as A,h8 as we}from"./eb6xg52mym6rhnsh.js";import{r as k,f as Ee,j as l,M,R as L}from"./cs2gapsc2bulabhw.js";import{d as Le,e as Me}from"./f2cwocui2o4rh90z.js";import{r as Ne}from"./c4jo9vhmn844acg2.js";import{u as Re}from"./do5nmvaddt7ak8xi.js";import{k as N}from"./pc2givv05uuq8g6l.js";function Ue({closeModal:t,url:e,onAction:n,onActionAborted:i}){const s=k.useRef(!1),r=Ee(),{clientThreadId:o}=Le(),c={...b({clientThreadId:o}),url:e,link_type:"text",section:"safe-link-modal"};k.useEffect(()=>{f.logEventWithStatsig("Safe Link Warning Modal Shown","chatgpt_safe_link_warning_modal_shown")},[]);const u=async()=>{s.current=!0;try{await navigator.clipboard.writeText(e),f.logEventWithStatsig("Safe Link Warning Modal Copy Clicked","chatgpt_safe_link_warning_modal_copy_clicked"),f.logEventWithStatsig("link_action","link_action",{...c,action:"copy"})}catch(x){he.addError(x)}n?.("copy"),t()},_=()=>{s.current=!0,f.logEventWithStatsig("Safe Link Warning Modal Open Clicked","chatgpt_safe_link_warning_modal_open_clicked"),f.logEventWithStatsig("link_action","link_action",{...c,action:"click"}),n?.("open"),t()},d=()=>{s.current||(f.logEventWithStatsig("Safe Link Warning Modal Canceled","chatgpt_safe_link_warning_modal_canceled"),i?.()),s.current=!1,t()};let h="",m=e,p="";try{m=new URL(e).hostname;const g=e.indexOf(m);g!==-1&&(h=e.substring(0,g),p=e.substring(g+m.length))}catch{}return l.jsxs(fe,{testId:"modal-safe-link-warning",isOpen:!0,hideSeparator:!0,onClose:d,showCloseButton:!0,type:"warning",title:l.jsx("div",{className:"flex items-center gap-2",children:r.formatMessage({id:"KXMlta",defaultMessage:"This link isn't verified"})}),primaryButton:l.jsx(me,{as:"link",openNewTab:!0,rel:"noopener noreferer",color:"primary",onClick:_,to:e,children:r.formatMessage({id:"gMzmDW",defaultMessage:"Open link"})}),secondaryButton:l.jsx(ge.Button,{title:r.formatMessage({id:"YGLt71",defaultMessage:"Copy link"}),color:"secondary",onClick:u}),children:[l.jsxs("p",{className:"text-token-text-secondary -mt-4 mb-6 text-sm text-pretty sm:-mt-7",children:[l.jsx(M,{defaultMessage:"Make sure you trust this link before proceeding. If you don't recognize the URL, don't open the link to access the site.",id:"safe-link-warning-modal-description"}),l.jsx("a",{className:"can-hover:hover:text-token-link-hover ps-1 underline underline-offset-1",href:"https://help.openai.com/en/articles/10984597-chatgpt-generated-links",target:"_blank",rel:"noopener noreferrer",children:l.jsx(M,{id:"xNvPsR",defaultMessage:"Learn more"})})]}),l.jsxs("div",{className:"mb-2 text-sm break-all",children:[l.jsx("span",{className:"text-token-text-secondary",children:h}),l.jsx("span",{className:"text-token-text-primary font-medium",children:m}),l.jsx("span",{className:"text-token-text-secondary",children:p})]})]})}const R={},U={},D={};function T(t,e){return`${t}::${e}`}function B({node:t,onClick:e,children:n,clientThreadId:i,messageId:s,href:r,disableSafeURLs:o,...a}){let c=e;const u=t?.properties?.href,_=z(),d=k.useContext(X),h=P(),m=_e(i),p=Y(m,r,d?.useSafeUrls&&!o),x=ke(h,"387775177"),g=!o&&p===void 0&&x.get("enable-copy-and-open",!1);return s!=null&&typeof u=="string"&&u.includes("/bing/redirect")&&(R[s]||(f.logEvent("Browsing Show Bing Link",{id:s,content:u}),R[s]=!0),c=y=>{U[s]||(f.logEvent("Browsing Click Bing Link",{id:s,content:u}),U[s]=!0),e?.(y)}),c=y=>{const C=""+u;if(s&&!D[T(s,C)]){const K=p||g?"URL Clicked Allowed":"URL Clicked Blocked";f.logEvent(K,{id:s,content:C}),D[T(s,C)]=!0}e?.(y),g&&r&&ye(h,Ue,{url:r})},l.jsx(l.Fragment,{children:l.jsx("a",{onClick:c,...a,className:xe(a.className,g&&"cursor-pointer"),href:p,rel:_?"noopener noreferrer":"noopener",children:n})})}const at="w";function De({messageId:t,clientThreadId:e,text:n,children:i,...s}){const o=`${window.location.origin}?q=${encodeURIComponent(n)}`,a=Me(),c=k.useCallback(async u=>{u.preventDefault(),w.count(E.DEFAULT,"instant_follow_up_anchor_clicked"),f.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:e,messageId:t}),a(u,{text:n,type:j.Reply},[],0)},[e,t,n,a]);return l.jsx(B,{...s,href:o,disableSafeURLs:!0,clientThreadId:e,messageId:t,className:"cursor-pointer",onClick:c,children:i})}const Te=L.memo(De);function je({messageId:t,clientThreadId:e,text:n,children:i,...s}){const{value:r}=Ce("374768818");return r?l.jsx(Te,{messageId:t,clientThreadId:e,text:n,children:i,...s}):l.jsx(B,{messageId:t,clientThreadId:e,children:i,...s})}const rt=L.memo(je),Oe={},Fe=[];function W(t){const e=t||Oe;return function(n,i){V(n,"element",function(s,r){const o=Array.isArray(s.properties.className)?s.properties.className:Fe,a=o.includes("language-math"),c=o.includes("math-display"),u=o.includes("math-inline");let _=c;if(!a&&!c&&!u)return;let d=r[r.length-1],h=s;if(s.tagName==="code"&&a&&d&&d.type==="element"&&d.tagName==="pre"&&(h=d,d=r[r.length-2],_=!0),!d)return;const m=$(h,{whitespace:"pre"});let p;try{p=N.renderToString(m,{...e,displayMode:_,throwOnError:!0})}catch(g){const y=g,C=y.name.toLowerCase();i.message("Could not render math with KaTeX",{ancestors:[...r,s],cause:y,place:s.position,ruleId:C,source:"rehype-katex"}),C==="parseerror"?p=N.renderToString(m,{...e,displayMode:_,strict:"ignore",throwOnError:!1}):p=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(e.errorColor||"#cc0000"),title:String(g)},children:[{type:"text",value:m}]}]}typeof p=="string"&&(p=q(p).children);const x=d.children.indexOf(h);return d.children.splice(x,1,...p),O})}}const ot="f",Ie=(t,e)=>{const n=k.useRef(!1);k.useEffect(()=>{n.current||(n.current=!0,w.count(E.DEFAULT,"clickable_follow_up_text_shown"),f.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...b({clientThreadId:t,messageId:e})}))},[t,e])},Pe=({messageId:t,clientThreadId:e,text:n})=>{const i=Re(e),s=J(),r=Q(e);Ie(e,t);const o=k.useCallback(a=>{a.preventDefault(),w.count(E.DEFAULT,"clickable_follow_up_text_clicked"),f.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",b({clientThreadId:e,messageId:t})),i({sourceEvent:a,promptMessage:be(n.toLowerCase(),{suggestion_type:j.Reply}),completionMetadata:{systemHints:[...s],conversationMode:r??{kind:Se.PrimaryAssistant}}})},[e,r,t,s,i,n]);return l.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:n})},Ae=({messageId:t,clientThreadId:e,text:n})=>{const i=P();return ve(i,"2723331665")?l.jsx(Pe,{messageId:t,clientThreadId:e,text:n}):l.jsx("span",{children:n})},it=L.memo(Ae),ct=t=>(t.startsWith(ie),t);function Be(){return t=>{v(t,"list",e=>{for(const n of e.children)n.spread=!0})}}function lt(t){return e=>{v(e,n=>{Object.defineProperties(n,{markdownSource:{get(){return t.slice(this.position.start.offset,this.position.end.offset)}}})})}}const G=[te,ne,Be,[se,{singleDollarTextMath:!1}],ae,re,Ne,oe,We,He];function We(){return t=>{v(t,"textDirective",e=>{e.name!==A&&(e.type="text",e.value=`:${e.name}`)})}}const Ge=/\u200b/g;function He(){return t=>{v(t,"text",e=>{e.value=e.value.replace(Ge,"")})}}function Ke(){return t=>{const e=t.position?.end.offset;v(t,"element",(n,i)=>{const{position:s}=n;if(!s)return;const{start:r,end:o}=s,a=r.offset,c=o.offset;n.properties??={},a!=null&&(n.properties["data-start"]=a),c!=null&&(n.properties["data-end"]=c,e===c&&(n.properties["data-is-last-node"]=""),i===t.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const ut=[W,Ke,Z,[ee,{target:"_new",rel:"noopener noreferrer"}],F],ze=[[W,{output:"mathml"}],F];function Xe(t,e){const n=we(t,e);return H(n,e)}function H(t,e){const n=S().use(I).use(G).use([[$e,e??[]]]).use(ce,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:Ye}}),i=S().use(le).use(ze).use(ue),s=n.runSync(n.parse(t)),r=n.stringify(s),o=i.stringify(i.runSync(s));return{"text/plain":r,"text/html":o}}const Ye=(t,e,n,i)=>{const s=n.createTracker(i),r=n.enter("link"),o=n.enter("label");let a=s.move("[");return a+=s.move(n.containerPhrasing(t,{before:a,after:"](",...s.current()})),a+=s.move("]("),o(),a+=s.move(t.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Ve)),t.title&&(a+=s.move(" "+JSON.stringify(t.title))),a+=s.move(")"),r(),a};function Ve(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function $e(t){return e=>{const n={},i=(s,r)=>{switch(r.type){case"grouped_webpages":{const o=[];for(const a of r.items)if(a.url&&a.title){let c=n[a.url];c||(c=n[a.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:a.url,title:a.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:a.attribution??de(a.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((a,c,u)=>c<u.length-1?[a,{type:"text",value:", "}]:[a]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"tldr":case"navigation":case"stock":case"calculator":case"code_execution":case"forecast":case"businesses_map":case"video":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"image_inline":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(r.alt){const o=S().use(I).use(G).parse(r.alt);if(s.type!=="textDirective")return o.children;const a=o.children[0];if(a.type==="paragraph")return a.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};v(e,pe,(s,r,o)=>{if(o==null||r==null)return;const a=qe(s,t),c=a?i(s,a)??[s]:[];return o.children.splice(r,1,...c),[O,r+c.length]}),e.children.push(...Object.values(n))}}function qe(t,e){if(t.name===A){const n=t.attributes?.index;if(n)return e[parseInt(n,10)]}}const pt=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:H,messageTextToClipboardContent:Xe},Symbol.toStringTag,{value:"Module"}));export{ot as C,at as I,B as M,G as R,rt as S,ut as a,H as b,it as c,pt as d,Xe as m,lt as r,ct as u};
//# sourceMappingURL=ls88si7tay0ysj3s.js.map

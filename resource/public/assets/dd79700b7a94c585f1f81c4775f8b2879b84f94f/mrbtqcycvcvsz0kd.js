import{f,aV as y,fd as w,o as S,e as C,cX as P,bD as _,aC as I}from"./eb6xg52mym6rhnsh.js";import{r as c,j as i,C as v}from"./cs2gapsc2bulabhw.js";import{m as h}from"./nc6572sivljsjb83.js";import{R as b}from"./msransmxvuas3w3d.js";import{C as T}from"./oo78njukxzwusnrs.js";import{P as R}from"./hatmfprcm0t26pcx.js";import{P as j,a as M}from"./epqkr08njby1t19h.js";import{c as W}from"./jt4cmjygjv1t1unw.js";import{u as E,W as O}from"./kbstf1piopltknze.js";import{c as l}from"./flul5lgejanvmzis.js";import"./pduvb49qgyq1mqhk.js";import"./ls88si7tay0ysj3s.js";import"./f2cwocui2o4rh90z.js";import"./do5nmvaddt7ak8xi.js";import"./e95x0gs5di7mq1tw.js";import"./ggve90in2x9hqouv.js";import"./c4jo9vhmn844acg2.js";import"./iop0mej0v36g33vx.js";import"./pc2givv05uuq8g6l.js";import"./ltl83crjtn7g9n8e.js";import"./fb2gj4fu6zbut62o.js";import"./kmvt5g0oz7ekj3ft.js";import"./ec6jcwftshefgs7y.js";import"./kvmheozf1dv1rz41.js";import"./m4uwihyvndo7xd88.js";import"./dijlyyo6bxi7y1gl.js";import"./fm8x6rikk7wmsjrt.js";import"./oeue9sgf06niyskm.js";import"./j0zvljvurep0tkuq.js";import"./oe3vdo8nwau2d3cp.js";import"./isvebwen77ppsppm.js";import"./pm0gb7r9jflnjr23.js";import"./mqwhn0zqom5s9tn7.js";import"./h86cr3c8dmjcpsff.js";import"./o0c2m6gntt3um3fq.js";import"./h71lg9jejkufcc57.js";import"./jyst6rnznipaffx7.js";import"./nlj97v8clhezwsxr.js";import"./bzo48ft2wb6beuij.js";import"./otrhg4fwlde4g25l.js";import"./c1w85nn5shpnb9e0.js";import"./7u88g4wa9fostszz.js";import"./codkr9xsn28rihk7.js";import"./l9t7qwwrq1pkwdh1.js";import"./ic7rccsdo5x6ovoh.js";import"./eks5h79t2eeekygs.js";import"./3s6z6so3p651ma5p.js";import"./knjoyspfheg8zfxl.js";import"./jkpqdvui6jfmbala.js";import"./evmyafqvn996a7fd.js";import"./f3ceh929le7g5gef.js";import"./hpoi02g0dgpne8ux.js";import"./kn0lvqy8pfftaqm4.js";import"./m51yqcd3jsaldp76.js";import"./ke1leuxpoxd60g1m.js";import"./dugtojg1blcdqewy.js";import"./lzqtvz4ppmzufktl.js";import"./nlwtx7zdm2am1wmc.js";import"./kla29aasg3zke6fd.js";import"./m6mpdolaukauf1xm.js";import"./dwy8f7y5ary0iziz.js";import"./bexqq0lppc5qpzyo.js";import"./fstrpgl2cuv98v3x.js";import"./fzrn137102spawew.js";import"./f7rvgpv9xzkroj1j.js";import"./hpw4a5uwyazjbwfj.js";function F(t){if(t.post.attachments[0].kind!=="codex")return{task:void 0,turns:void 0};const r=t.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn}}function G({postWithProfile:t}){const r=l(d=>d.addTurnToTaskMap),{task:e,fetchedTurns:o,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:s}=F(t),m=f(),p=y(m,"2818336692"),{focusedAssistantTurn:u,setFocusedAssistantTurnId:x}=E({taskId:e?.id,task:e,currentDiffTaskTurn:s??null,currentUserTurn:n??null,currentAssistantTurn:a??null});c.useEffect(()=>{Object.values(o?.turn_mapping??{}).forEach(d=>{r(e?.id??"",d.turn)})},[o,r,e]);const g=l(({getTurnsForTask:d})=>e?d(e.id):[]);return!e||!g?null:i.jsx(O,{permissions:"read",taskId:e.id,turnId:a?.id??"",task:e,focusedAssistantTurn:u,pastTurns:g,setFocusedAssistantTurnId:x,canFollowUp:!1,lastTurnWithDiffId:s?.id??"",onEscape:()=>{},showForkButton:p})}const te=w(function(){const r=v();return r.kind==="forbidden"?i.jsx(L,{chatPageProps:r.chatPageProps,reason:"workspace"}):i.jsx(A,{loaderData:r})});function A({loaderData:t}){c.useEffect(()=>{C.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:t.postWithProfile.post.id,primary_attachment_type:t.postWithProfile.post.attachments?.[0]?.kind,referrer:t.referrer})},[t]);const r=c.useMemo(()=>{const e=P();return _.initThread(e,{kind:I.PrimaryAssistant}),e},[]);return t.postWithProfile.post.attachments?.[0]?.kind==="deep_research"&&t.postWithProfile.post.attachments[0].tags?.includes("deep_research")?i.jsx(b,{postWithProfile:t.postWithProfile,threadId:r}):t.postWithProfile.post.attachments?.[0]?.kind==="codex"?i.jsx(G,{postWithProfile:t.postWithProfile}):i.jsx(U,{postWithProfile:t.postWithProfile,chatPageProps:t.chatPageProps})}function k(t){return{url:`https://ogimg.chatgpt.com/?postId=${t}`,size:[1200,630]}}function z(t,r){if(!t.attachments||t.attachments.length===0)return{url:h.src};const e=t.attachments[0];switch(e.kind){case"media_generation":{const o=e.encodings?.md?.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,n=e.encodings?.unfurl?.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,a=e.encodings?.thumbnail?.path?{url:e.encodings.thumbnail.path}:void 0,s={url:e.url,size:[e.width,e.height]};return r&&o!=null?o:n??a??s}case"message_slice":return k(t.id);default:return{url:h.src}}}function $(t){const r=t.text?.trim();if(r)return r;const e=t.attachments?.[0];return e?.kind==="media_generation"&&e.title?.trim()?e.title.trim():"Shared Content"}const ee=({data:t})=>{const r=t,e={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const u="Privately Shared Content";return[{title:`ChatGPT - ${u}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:u},{property:"og:type",content:"website"},{property:"og:image",content:h.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:h.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:u}]}const{post:o}=r.postWithProfile,n=r.enforceRenderedOgImg?k(o.id):z(o,r.preferIntrinsicAspectRatioForOgImage),a=$(o),s=o.permalink,m=new Date(o.posted_at*1e3).toISOString();return[{title:`ChatGPT - ${a}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:s},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:m},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function L({chatPageProps:t,reason:r}){const e=f();return c.useEffect(()=>{S(e,j,{reason:r})},[]),i.jsx(T,{...t})}function U({postWithProfile:t,chatPageProps:r}){const[e,o]=c.useState(!1),[n]=c.useState(()=>P());if(t.post.attachments&&t.post.attachments.every(s=>s.kind==="message_slice"||s.kind==="deep_research")){const s=t.post.attachments?.filter(p=>p.kind==="message_slice"||p.kind==="deep_research").flatMap(p=>p.messages??[])??[],{threadResponse:m}=W(s);_.updateThreadFromServer(n,m,{skipIfExisting:!0,continuingFromSharedPostId:t.post.id,forkFromSharedPost:!0})}return i.jsxs(M.Provider,{value:{postWithProfile:t,setIsReportModalOpen:o},children:[e&&i.jsx(R,{post:t.post,onClose:()=>o(!1)}),i.jsx(T,{...r,clientThreadId:n})]})}export{te as default,ee as meta};
//# sourceMappingURL=mrbtqcycvcvsz0kd.js.map

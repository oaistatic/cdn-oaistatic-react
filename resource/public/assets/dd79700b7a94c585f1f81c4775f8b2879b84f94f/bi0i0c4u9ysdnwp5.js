import{j as e,r as d,M as w}from"./cs2gapsc2bulabhw.js";import{c as o,aa as S,bL as C,cd as T,eU as E,e as M,bb as _,B as P,bd as N}from"./eb6xg52mym6rhnsh.js";import{eT as R,eU as A}from"./pduvb49qgyq1mqhk.js";import{S as L}from"./b5gczno5rhzofdsb.js";function B({title:t,content:l,buttons:s,time:a,icon:c,size:n="default",progressBar:f,disabled:m=!1,onClick:x}){const g="bg-token-main-surface-primary border-token-border-default mx-[calc(--spacing(-2)-1px)] -my-[1px] box-content rounded-2xl border bg-clip-padding px-5 py-4 @max-3xl:-top-2 @3xl:-start-3 @3xl:-top-4",h=n==="small"?`w-full flex max-w-[calc(0.8*var(--thread-content-max-width,40rem))] ps-[20px] pt-[13px] pb-[10px] ${m?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",r=x?"cursor-pointer":"",j=n==="small"?"text-[15px]":"";return e.jsxs("div",{className:o("relative inline-flex flex-col items-start justify-start rounded-2xl border",g,h,r,j),onClick:x,children:[e.jsxs("div",{className:o("flex flex-col items-start justify-start self-stretch",n!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:o("inline-flex items-start justify-start self-stretch",n!=="small"&&"gap-2"),children:[e.jsx("div",{className:o("shrink grow basis-0 leading-normal font-medium","text-token-text-secondary hover:text-token-text-primary"),children:t}),e.jsx("div",{className:"relative h-6 w-6"}),!m&&(c||e.jsx(L,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:o("flex w-full flex-col items-start justify-start",n==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:o("inline-flex w-full items-start justify-start self-stretch rounded-sm",n==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:o("w-full leading-relaxed font-normal",m?"text-token-text-tertiary":"text-token-text-secondary"),children:l})})})]}),f?e.jsxs("div",{className:o("mb-2 inline-flex items-center justify-between self-stretch",s?.length&&"mt-[-10px]"),children:[f,s]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[a&&e.jsx("div",{className:"text-token-text-tertiary shrink grow basis-0 text-[15px] leading-normal font-normal",children:a}),e.jsx("div",{className:"flex gap-2",children:s})]})]})}const D=/\*\*(.*?)(?:\*\*|\n|$)/g,F=t=>{let l=null,s;for(;(s=D.exec(t))!=null;)l=s[1].trim();return l};function $({message:t,simulatedDuration:l=8*60*1e3,maxFill:s=100}){t?.metadata?.model_slug!=="o1-pro"&&(l=16*60*1e3);const a=t?.create_time?new Date(t.create_time*1e3):Date.now(),c=R(+a,l);return e.jsx(A,{percentage:Math.min(c,s),className:"me-4 w-full!",backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-secondary rounded-full",transitionDuration:`${(100-c)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function K({messages:t,isStreaming:l,isLastMessage:s,clientThreadId:a,currentGroupedMessageIndex:c,turnIndex:n}){const[f,m]=d.useState(""),[x,g]=d.useState(!1),h=S(a,i=>i?.async_status===N.STREAMING||i?.async_status===N.REALTIME),r=C(t),j=r?.id,b=r?.metadata?.initial_text,k=r?.metadata?.summarization_headline,p=t.map(i=>T(i)).join(`

`),{toggleThreadSidebar:v}=E(),y=d.useCallback(()=>{v({type:"summarizer",clientThreadId:a,currentGroupedMessageIndex:c,turnIndex:n})},[v,a,c,n]);d.useEffect(()=>{const i=F(p);i?m(i):b!=null&&m(b)},[p,b]),d.useEffect(()=>{p.length>0&&g(!0)},[p]),d.useEffect(()=>{x&&M.logEvent("Tool: Received a8km123 message",{client_thread_id:a,message_id:j,conversationId:_(a)})},[x]);const u=h&&s||l;return r?.metadata?.finish_details?.type==="interrupted"||r?.clientMetadata?.err?null:e.jsx("div",{className:"pb-2",children:e.jsx(B,{buttons:u?[e.jsx(P,{onClick:i=>{i.stopPropagation(),y()},color:"secondary",className:"text-token-text-secondary h-[38px]! text-[15px] font-normal",children:e.jsx("div",{className:"px-1",children:e.jsx(w,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")]:[],time:null,title:k,icon:u?e.jsx("div",{className:""}):null,content:u?`${f}...`:r?.metadata?.finished_text??"",size:"small",disabled:!u,onClick:y,progressBar:u?e.jsx($,{message:r}):null})})}export{$ as ProduceProgressBar,K as default};
//# sourceMappingURL=bi0i0c4u9ysdnwp5.js.map

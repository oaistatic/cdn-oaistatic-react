import{f as B,j as s,M as F,c as gs,g as Ve,a5 as Q,r as m,a6 as je,a as ft,b as _e,u as mt,o as an,ao as rn}from"./cs2gapsc2bulabhw.js";import{C as cn,a as ln}from"./nhgg43vfy9ih4vl5.js";import{hX as xs,tt as We,iY as L,iZ as q,lg as Fe,tu as Cs,X as ht,A as $e,dl as ue,aa as dn,i9 as un,tv as fn,dh as mn,qi as zt,qE as hn,dp as pn,tw as gn,tx as xn,ty as vs,dU as Ce,e9 as pt,fk as Cn,n3 as Qt,bQ as vn,ac as me,kd as le,pJ as Xt,fe as yn,ff as bn,fg as Tn,fh as Sn,E as En,tz as qe,fr as wn,a5 as _n,dD as An,li as Mn,cL as ys,tm as D,tA as kn,tB as bs,tC as Yt,tD as jn,tE as Nn,d as In,tF as ct,tG as Rn,tH as Pn,tI as Dn,lx as Ee,tJ as Ln,lf as On,tK as Hn,tL as Bn,kq as Un,tM as qn,c as Fn,tN as $n,tO as Kn,tP as Gn,tQ as Vn,tR as Wn,dm as Be,tS as zn,di as Qn,dj as Xn,dk as Yn,pP as Zt,tT as Zn,tU as Jn,g as eo,tV as to,lS as so,tW as no,jk as oo,tX as Jt,dn as es,tY as ts,tZ as Ue,t_ as ss}from"./pduvb49qgyq1mqhk.js";import{u as Ts}from"./do5nmvaddt7ak8xi.js";import{gS as gt,h as ao,cV as ro,i as lt,dj as Ss,p as io,dG as co,dH as lo,dq as uo,ds as fo,B as Ke,h2 as mo,c$ as ho,aa as dt,ab as Es,a6 as ns,c as te,an as ws,b as $,dB as _s,b0 as po,cP as go,eT as xo,f as xt,aV as Ct,b9 as os,bL as Co,F as he,u as vo,dc as yo,cY as bo,e as To,q as So}from"./eb6xg52mym6rhnsh.js";import{O as Eo,b as fe,d as wo,c as As,g as _o,A as Ao,a as Mo,f as as,C as ve,D as ko}from"./o9jbx8esqeax3dhl.js";import{e as jo}from"./dv3d7908pzpkjndg.js";import{C as No}from"./ekzdsqfpi8dxrf9q.js";import{e as Io,a as Ro,b as Po,g as Do}from"./fi1xw3fnwortmtrb.js";import{C as Ge,e as de,U as rs}from"./pbk0s8tey8blca1e.js";import{a as Lo}from"./jcndegd4nkgfbfly.js";import{S as Oo,D as Ho}from"./xbmjt85q81k7ilbj.js";import{i as Bo}from"./ocr8ihe7mqprglo4.js";import{C as Uo}from"./j0zvljvurep0tkuq.js";import{b as is}from"./kmvt5g0oz7ekj3ft.js";import{a as qo,g as Fo}from"./echjzuil72lr2oll.js";import{N as $o}from"./jy1u8exw8iz2slve.js";import{S as Ko}from"./nlwtx7zdm2am1wmc.js";import{g as rt,S as Go}from"./bk8slwxjkdlmxjxm.js";import{s as it,B as Vo}from"./m6mpdolaukauf1xm.js";import{L as Wo}from"./ic7rccsdo5x6ovoh.js";import{u as zo}from"./f2cwocui2o4rh90z.js";import{u as cs}from"./oe3vdo8nwau2d3cp.js";import{u as ut,f as Qo,n as Xo,g as Yo}from"./abn9sjdb7psxnmu1.js";var Ms=(t=>(t.Close="close",t.Loaded="loaded",t.Streaming="streaming",t.Download="download",t))(Ms||{});const Zo=({isOpen:t,dismissModal:e,closeTextdocEditor:n,textdocVersion:o,clientThreadId:r})=>{const a=B(),i=xs(r),c=Ts(r),g=gt(),l=We(o?.textdocId),d=async h=>{L.logButtonClick(q.SAVE_TO_CHAT_ON_EDITOR_CLOSE),!(o?.versionInt==null||g)&&(c({sourceEvent:h,promptMessage:Ss("",{canvas:{user_created_textdocs:o!=null&&o.status===Cs.ATTACHED_PENDING&&l!=null?[{user_created_temp_textdoc_id:o.textdocId,type:o.type,title:o.title,content:o.content,create_source:l.create_source}]:void 0},open_in_canvas_view:{type:"canvas_textdoc",id:o.textdocId}}),completionMetadata:i?{conversationMode:i}:void 0}),l&&Fe.markAsSent(l.tempTextdocId),e(),n())};return s.jsx(ao,{testId:"modal-confirm-close-editor",isOpen:t,size:"custom",className:"max-w-xl",onClose:e,type:"warning",hideSeparator:!0,title:s.jsx("span",{className:"text-xl",children:s.jsx(F,{id:"jgd5rD",defaultMessage:"Are you sure you want to close?"})}),primaryButton:s.jsx(lt.Button,{title:a.formatMessage({id:"XE+GiU",defaultMessage:"Save to chat"}),color:"primary",onClick:d}),secondaryButton:s.jsx(lt.Button,{title:a.formatMessage({id:"MbWco5",defaultMessage:"Donâ€™t save and close"}),color:"secondary",onClick:()=>{L.logButtonClick(q.CLOSE_WITHOUT_SAVING),l&&Fe.removeTempTextdoc(l.tempTextdocId),e(),n()}}),showCloseButton:!0,closeButton:s.jsx(ro,{onClick:e}),children:s.jsx("div",{className:"text-md text-token-text-secondary -mt-6 pb-2",children:s.jsx(F,{id:"q9rJ+Y",defaultMessage:"Changes will not be saved unless you save this canvas to your chat."})})})},ze="https://persistent.oaistatic.com/canvas/nux-videos/",Jo=`${ze}canvas_writing.mp4`,ea=`${ze}canvas_coding.mp4`,ta=`${ze}canvas_writing_hero.jpg`,sa=`${ze}canvas_coding_hero.jpg`,na="https://help.openai.com/en/articles/9930697-what-is-the-canvas-feature-in-chatgpt-and-how-do-i-use-it",oa=t=>{"use forget";const e=gs.c(27),{onClose:n,title:o,description:r,asset:a,size:i}=t,c=B(),g=a===0,l=i===1?252:218;let d;e[0]!==l?(d={height:l},e[0]=l,e[1]=d):d=e[1];const h=g?ta:sa,b=g?Jo:ea;let f;e[2]!==h||e[3]!==b?(f=s.jsx("video",{muted:!0,loop:!0,autoPlay:!0,playsInline:!0,className:"h-full max-w-none",poster:h,src:b}),e[2]=h,e[3]=b,e[4]=f):f=e[4];let T;e[5]!==d||e[6]!==f?(T=s.jsx("div",{className:"border-token-border-default bg-token-main-surface-secondary text-token-text-secondary relative flex w-full items-center justify-center overflow-hidden border-b",style:d,children:f}),e[5]=d,e[6]=f,e[7]=T):T=e[7];let p;e[8]!==o?(p=s.jsx(co,{className:"text-center text-xl leading-6 font-semibold",children:s.jsx(F,{...o})}),e[8]=o,e[9]=p):p=e[9];let v;e[10]!==r?(v=s.jsx(lo,{className:"text-token-text-secondary text-center text-sm",children:s.jsx(F,{...r})}),e[10]=r,e[11]=v):v=e[11];let u;e[12]!==p||e[13]!==v?(u=s.jsxs("div",{className:"flex flex-col gap-2",children:[p,v]}),e[12]=p,e[13]=v,e[14]=u):u=e[14];let C;e[15]!==c?(C=c.formatMessage(be.button),e[15]=c,e[16]=C):C=e[16];let x;e[17]!==n||e[18]!==C?(x=s.jsx(lt.Button,{onClick:n,title:C,color:"primary"}),e[17]=n,e[18]=C,e[19]=x):x=e[19];let S;e[20]===Symbol.for("react.memo_cache_sentinel")?(S=s.jsxs(dn,{href:na,className:"flex items-center gap-1 font-medium",children:[s.jsx(F,{...be.learnMore}),s.jsx(un,{className:"icon-sm"})]}),e[20]=S):S=e[20];let w;e[21]!==x||e[22]!==u?(w=s.jsxs("div",{className:"flex flex-col items-center gap-4 px-10 py-8",children:[u,x,S]}),e[21]=x,e[22]=u,e[23]=w):w=e[23];let y;return e[24]!==w||e[25]!==T?(y=s.jsxs("div",{className:"flex flex-col items-center focus:outline-hidden",children:[T,w]}),e[24]=w,e[25]=T,e[26]=y):y=e[26],y},aa=t=>{"use forget";const e=gs.c(11),{textdocType:n}=t,{markAsViewed:o}=ht($e.hasDismissedCanvasContextualOnboarding),r=io()?.document.body;let a,i,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={opacity:.75,scale:.9},i={opacity:1,scale:1},c={type:"spring",bounce:.2,duration:.56},e[0]=a,e[1]=i,e[2]=c):(a=e[0],i=e[1],c=e[2]);const g=ue(n)?1:0,l=ue(n)?be.contextualModalTitleCoding:be.contextualModalTitleWriting,d=ue(n)?be.contextualModalDescriptionCoding:be.contextualModalDescriptionWriting;let h;e[3]!==o||e[4]!==g||e[5]!==l||e[6]!==d?(h=s.jsx(Q.div,{initial:a,animate:i,transition:c,className:"popover border-token-border-default bg-token-main-surface-primary fixed end-4 bottom-4 z-50 max-w-sm overflow-hidden rounded-2xl border shadow-xl",children:s.jsx(oa,{onClose:o,asset:g,size:0,title:l,description:d})}),e[3]=o,e[4]=g,e[5]=l,e[6]=d,e[7]=h):h=e[7];let b;return e[8]!==r||e[9]!==h?(b=s.jsx(uo,{open:!0,defaultOpen:!0,modal:!1,children:s.jsx(fo,{container:r,children:h})}),e[8]=r,e[9]=h,e[10]=b):b=e[10],b},be=Ve({contextualModalTitleWriting:{id:"Pi+0RT",defaultMessage:"Draft and refine on the spot"},contextualModalDescriptionWriting:{id:"Jv0f02",defaultMessage:"Make it shorter. Add an emoji. Translate to kindergartener. ChatGPT can do it all, right on the canvas."},contextualModalTitleCoding:{id:"Zi5Ty0",defaultMessage:"Refine and debug on the spot"},contextualModalDescriptionCoding:{id:"XnaO2x",defaultMessage:"Refactor code. Translate to Python. Check for bugs. ChatGPT can do it all, right on the canvas."},button:{id:"7bNl4/",defaultMessage:"Got it"},learnMore:{id:"vs1lx2",defaultMessage:"Learn more about canvas"}}),ra=({isTextdocStreaming:t,isRequestActive:e,value:n,comments:o})=>{const[r,a]=m.useState(!1);return m.useEffect(()=>{t&&r&&(a(!1),Ge.reset())},[n,o]),m.useEffect(()=>{e||(a(!1),Ge.reset())},[e]),[r,a]};function ia({onClickRestore:t,onClickResetLatest:e}){const n=B();return s.jsx(Q.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},transition:{bounce:0,duration:.24},className:"bg-token-main-surface-primary z-30",children:s.jsx(Q.div,{className:"bg-token-main-surface-primary dark:border-token-border-xlight @container w-full items-center border-t border-gray-100 p-6 shadow-[0_-4px_32px_rgba(0,0,0,0.08)] lg:border-s dark:shadow-[0_-4px_32px_rgba(0,0,0,0.12)]",children:s.jsxs("div",{className:"mx-auto flex max-w-[48rem] flex-col flex-wrap justify-center gap-5 @2xl:flex-row @2xl:justify-between",children:[s.jsxs("div",{className:"flex flex-col px-2 text-center @2xl:text-start",children:[s.jsx("span",{className:"text-md text-token-text-primary font-semibold text-wrap",children:n.formatMessage({id:"gt23pb",defaultMessage:"You are viewing a previous version"})}),s.jsx("span",{className:"text-token-text-secondary text-sm text-wrap",children:n.formatMessage({id:"sAlUJn",defaultMessage:"Restore this version to make edits"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[s.jsx(Ke,{as:"button",color:"primary",onClick:t,children:n.formatMessage({id:"+cddAb",defaultMessage:"Restore this version"})}),s.jsx(Ke,{as:"button",color:"secondary",onClick:e,children:n.formatMessage({id:"qCD3eu",defaultMessage:"Back to latest version"})})]})]})})})}const ca={type:"spring",bounce:.2,duration:.56},la=({clientThreadId:t,turn:e})=>{const n=mo();return s.jsxs(Q.div,{className:"absolute start-0 end-0 top-0 z-10 -translate-y-full",children:[s.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"bg-vert-light-gradient dark:from-token-main-surface-primary absolute inset-0 -top-5 dark:bg-linear-to-t dark:to-transparent"}),s.jsx(Q.div,{className:"flex items-center py-2",initial:{opacity:.75,translateX:-50,translateY:"100%"},animate:{opacity:1,translateX:0,translateY:"0"},exit:{opacity:0,filter:"blur(8px)",transition:{delay:.4,duration:.72}},transition:ca,children:s.jsx(Uo,{clientThreadId:t,onRequestCompletion:ho,groupedMessagesToRender:e.messageGroups,allGroupedMessages:e.messageGroups,allMessages:e.messages,isUserTurn:!0,isFinalUserTurn:!1,turnIndex:0,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,isFinalTurn:!1,hasActiveRequest:n})})]},"user-message")},da=({clientThreadId:t})=>{const{lastUserTurn:e,lastAssistantTurn:n}=dt(t,r=>{const a=Es.getConversationTurns(r);let i=null,c=null;for(let g=a.length-1;g>0;g--){const l=a[g];if(!i&&l.role===ns.User?i=l:!c&&l.role===ns.Assistant&&(c=l),i&&c)break}return{lastUserTurn:i,lastAssistantTurn:c}}),o=e&&!n?.messages.some(r=>r.recipient?.startsWith(fn));return s.jsx(je,{initial:!1,children:o&&s.jsx(la,{turn:e,clientThreadId:t})})},ua=({isRequestActive:t=!1,clientThreadId:e,readonlyReason:n,onCancel:o,onSubmit:r,onSubmitAccelerator:a,acceleratorActions:i=[]})=>{const[c,g]=m.useState(!1),[l,d]=m.useState(""),[h,b]=m.useState(!0),f=B(),[T,p]=m.useState(!1),v=mn(),u=x=>{r?.(x,l),d("")},C=x=>{if(x.nativeEvent.isComposing)return;const{metaKey:S,shiftKey:w,key:y}=x;y==="Enter"&&l.trim()&&!(w||S)&&(u(x),x.preventDefault())};return s.jsxs(s.Fragment,{children:[c&&!v&&s.jsx(Eo,{zIndexKey:"acceleratorsOverlay",className:"bg-white/95 dark:bg-black/85"}),s.jsx("div",{className:"relative mb-3 flex items-end justify-center",children:s.jsxs("div",{className:"relative mx-6 max-w-2xl flex-1",children:[s.jsx(da,{clientThreadId:e}),s.jsx("div",{className:"flex flex-auto items-start",children:s.jsx("div",{className:te("dark:bg-token-main-surface-secondary flex min-h-12 flex-auto items-center bg-[#f4f4f4] py-1 ps-6 pe-2",{"rounded-full":h,"rounded-2xl":!h,"bg-transparent":T}),children:s.jsxs("div",{className:"relative flex flex-auto items-center self-stretch",children:[s.jsx(Bo,{placeholder:f.formatMessage({id:"zrUbTJ",defaultMessage:"Ask ChatGPT to edit"}),disabled:t,value:l,className:te("text-token-text-primary placeholder:text-token-text-secondary w-full resize-none border-0 bg-transparent p-0 outline-0 focus:ring-0 focus-visible:ring-0",{"opacity-0":T}),maxRows:4,onChange:({target:{value:x}})=>d(x),onKeyDown:C,onHeightChange:(x,{rowHeight:S})=>b(Math.floor(x/S)<=1)}),l?s.jsx(Q.button,{className:te("dark bg-token-main-surface-primary h-8 w-8 rounded-full text-center disabled:bg-[#D7D7D7]",{"self-end":!h}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:u,children:s.jsx(Oo,{className:"text-token-text-primary h-8 w-8"})}):(i?.length??0)>0&&s.jsx(Ho,{disableHint:!0,isVisuallyHidden:n?.isReadonly&&!n.isStreaming,disableOverlay:!0,isEmbeddedInPromptArea:!0,isRequestActive:t,actions:i,onCancel:o,onExpandedChange:x=>{v||p(x),g(x)},onSubmit:a,right:0,bottom:4})]})})})]})})]})};function fa(t,e){const n=new Set(t.map(c=>c.id)),o=new Set(e.map(c=>c.id)),r=t.filter(c=>!o.has(c.id)).map(c=>({...c,diffStatus:zt.REMOVED})),a=e.filter(c=>!n.has(c.id)).map(c=>({...c,diffStatus:zt.ADDED})),i=t.filter(c=>o.has(c.id));return r.concat(a,i)}const ma=t=>{const{textdocId:e}=t,n=hn(o=>o?.resolveTempTextdocId[e]??e);return m.useMemo(()=>({...t,textdocId:n}),[n,t])};async function ha({textdocId:t,newTitle:e}){e!=null&&await $.safePost("/textdoc/{textdoc_id}/rename",{parameters:{path:{textdoc_id:t}},requestBody:{title:e}}).catch(n=>{ws.addError("renameCanvasTitle Error:",n)})}const pa=({serverThreadId:t,textdocVersion:e,initialTitle:n="Untitled Document",isEditingTitle:o,setIsEditingTitle:r})=>{const a=ft(),{mutateAsync:i}=_e({mutationKey:[t,"textdocs"],mutationFn:ha,onMutate:async({textdocId:u,newTitle:C})=>{await a.cancelQueries({queryKey:[t,"textdocs"]});const x=a.getQueryData([t,"textdocs"]);return a.setQueryData([t,"textdocs"],S=>{if(!S)return S;const w=new Map(S.persistedTextdocVersionById),y=w.get(u);if(y){const I={...y,title:C??""};w.set(u,I)}const M=S.persistedTextdocVersions.map(I=>I.textdocId===u?{...I,title:C??""}:I),j=new Map(S.persistedTextdocById),P=j.get(u);if(P){const I={...P,title:C??""};j.set(u,I)}return{...S,persistedTextdocVersionById:w,persistedTextdocVersions:M,persistedTextdocById:j}}),{previousTextDocData:x}},retry:2,onError:(u,C,x)=>{x?.previousTextDocData&&a.setQueryData([t,"textdocs"],x.previousTextDocData),ws.addError("Error updating title:",u)},onSettled:()=>{a.invalidateQueries({queryKey:[t,"textdocs"]})}}),c=async u=>{e&&await i({textdocId:e.textdocId??"",newTitle:u})},[g,l]=m.useState(n),d=m.useRef(null),h=m.useRef(g),b=m.useRef(!1);m.useEffect(()=>{o&&d.current&&(d.current.focus(),d.current.select())},[o]);const f=u=>{l(u.target.value)},T=()=>{h.current=g},p=async()=>{b.current||await c(g),b.current=!1,r(!1)},v=u=>{(u.key==="Enter"||u.key==="Escape")&&u.preventDefault(),u.key==="Enter"?u.currentTarget.blur():u.key==="Escape"&&(l(h.current),b.current=!0,u.currentTarget.blur())};return s.jsx("input",{className:"w-[300px] rounded-lg border-none px-3 py-2 outline-hidden",ref:d,value:g,onChange:f,onFocus:T,onBlur:p,onKeyDown:v,style:{fontSize:"1.125rem",fontWeight:"bold",boxSizing:"border-box",backgroundColor:"var(--global-states-light-element-hover, rgba(0, 0, 0, 0.05))"}})};function ga(t){const{voiceName:e}=pn(),n=t?()=>xa(t.textdocId,e,Fo()):null,o=`${t?.textdocId}.${t?.versionInt}.${e}`;return qo(n,o)}function xa(t,e,n){return $.safeGet("/textdoc/{textdoc_id}/synthesize",{parameters:{path:{textdoc_id:t},query:{voice:e,format:n}},skipJsonTransform:!0})}const Ca=({textdocVersion:t,isPersisting:e=!1,isTextdocAttachedPending:n,isTextdocStreaming:o,hasDebug:r,shouldShowPlayButton:a=!1,hideRenameButton:i=!1,toggleDebugView:c,isDebugVisible:g,toggleConsoleVisibility:l,isConsoleOpen:d,clientThreadId:h})=>{const b=B();gn(),ga(t);const[f,T]=m.useState(!1),p=t?.title??"",v=_s(h)??"",u=We(t?.textdocId),C=!p||u?.status===xn.INFERRING,x=()=>{T(!0)},[S,w]=m.useState(!1),{container:y,triggerRef:M}=vs({isOpen:S,onClose:()=>w(!1)}),j=[!u&&!i&&!o?s.jsx(Ce.Item,{icon:pt,onClick:x,children:b.formatMessage({id:"z/PT9T",defaultMessage:"Rename"})},"rename"):null,null,a?s.jsx(Ce.Item,{icon:Cn,onClick:l,children:d?b.formatMessage({id:"owGHqE",defaultMessage:"Close console"}):b.formatMessage({id:"GPb4WX",defaultMessage:"Open console"})},"console"):null,null].filter(Boolean);if(j.length===0)return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",children:s.jsx(fe.Title,{className:"@[0px]:hidden @[150px]:block",children:C?s.jsx("div",{className:"w-52",children:s.jsx(is,{lines:1,size:"base",width:100,widthVariance:0})}):p})}),e&&s.jsx(Qt,{size:12,className:"text-token-text-tertiary ps-1"})]});const P=t&&s.jsx(Ce.Portal,{container:y,children:s.jsx(Ce.Content,{onCloseAutoFocus:I=>I.preventDefault(),children:j})});return s.jsx(s.Fragment,{children:f?s.jsx(pa,{serverThreadId:v,textdocVersion:t,initialTitle:p,isEditingTitle:f,setIsEditingTitle:T}):s.jsxs(s.Fragment,{children:[!1,s.jsxs(Ce.Root,{open:S,onOpenChange:w,children:[s.jsxs(Ce.Trigger,{ref:M,className:"hover:bg-token-surface-hover grid grid-cols-[1fr_auto] bg-transparent! pe-2",children:[s.jsx(fe.Title,{className:"max-w-[270px] truncate overflow-hidden",children:C?s.jsx("div",{className:"w-52",children:s.jsx(is,{lines:1,size:"base",width:100,widthVariance:0})}):p}),s.jsx("div",{className:"flex items-center",children:e?s.jsx(Qt,{size:12,className:"text-token-text-tertiary ps-1"}):s.jsx(vn,{className:"icon-md text-token-text-tertiary"},"chevron")})]}),P]})]})})};function va({textdocVersion:t,clientThreadId:e}){const{handleCopy:n,Icon:o,copyLabel:r}=wo({textdocVersion:t,clientThreadId:e});return s.jsx(me,{label:r,children:s.jsx(le,{icon:o,onClick:n})})}const ya=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M21 13.6647C21 14.9442 20.7333 16.0559 20.1996 17C19.666 17.9503 18.8997 18.6863 17.9008 19.208C16.908 19.736 15.7198 20 14.3361 20H12.0372C11.696 20 11.4137 19.8851 11.1902 19.6553C10.9669 19.4317 10.8553 19.1584 10.8553 18.8354C10.8553 18.5124 10.9669 18.2391 11.1902 18.0155C11.4137 17.792 11.696 17.6801 12.0372 17.6801H14.2245C15.18 17.6801 15.9897 17.5032 16.6535 17.1491C17.3237 16.795 17.8325 16.3136 18.1799 15.7049C18.5336 15.0901 18.7105 14.3851 18.7105 13.5901C18.7105 12.8075 18.5336 12.1118 18.1799 11.5031C17.8325 10.8944 17.3237 10.4193 16.6535 10.0776C15.9897 9.73607 15.18 9.56516 14.2245 9.56516H8.64014L5.3268 9.41619L5.70838 8.80125L8.05379 10.7577L10.2316 12.8819C10.331 12.9876 10.4116 13.1056 10.4737 13.236C10.5419 13.3664 10.5761 13.5187 10.5761 13.6926C10.5761 14.0155 10.4705 14.2826 10.2596 14.4938C10.0549 14.705 9.78176 14.8106 9.44056 14.8106C9.13032 14.8106 8.85421 14.6894 8.61223 14.4472L3.36299 9.25782C3.2451 9.1522 3.15513 9.0249 3.09307 8.8758C3.03103 8.72056 3 8.56519 3 8.40995C3 8.24845 3.03103 8.09321 3.09307 7.94411C3.15513 7.78888 3.2451 7.65531 3.36299 7.54342L8.61223 2.35404C8.85421 2.11801 9.13032 2 9.44056 2C9.78176 2 10.0549 2.1056 10.2596 2.31678C10.4705 2.52175 10.5761 2.78572 10.5761 3.1087C10.5761 3.28261 10.5419 3.4379 10.4737 3.57454C10.4116 3.70497 10.331 3.82299 10.2316 3.92857L8.05379 6.0528L5.70838 8.00926L5.3268 7.39445L8.64014 7.24535H14.2245C15.6267 7.24535 16.8335 7.51548 17.8449 8.05587C18.8624 8.59626 19.6412 9.35091 20.1811 10.3199C20.727 11.2826 21 12.3976 21 13.6647Z",fill:"currentColor"})),ba=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M3 13.6647C3 12.3976 3.26992 11.2826 3.80973 10.3199C4.35574 9.35091 5.13444 8.59626 6.14582 8.05587C7.16341 7.51548 8.37334 7.24535 9.77563 7.24535H15.3506L18.6732 7.39445L18.2917 8.00926L15.937 6.0528L13.7684 3.92857C13.6629 3.82299 13.576 3.70497 13.5078 3.57454C13.4457 3.4379 13.4147 3.28261 13.4147 3.1087C13.4147 2.78572 13.517 2.52175 13.7218 2.31678C13.9328 2.1056 14.209 2 14.5501 2C14.8666 2 15.1427 2.11801 15.3785 2.35404L20.637 7.54342C20.7549 7.65531 20.8449 7.78888 20.907 7.94411C20.969 8.09321 21 8.24845 21 8.40995C21 8.56519 20.969 8.72056 20.907 8.8758C20.8449 9.0249 20.7549 9.1522 20.637 9.25782L15.3785 14.4472C15.1427 14.6894 14.8666 14.8106 14.5501 14.8106C14.209 14.8106 13.9328 14.705 13.7218 14.4938C13.517 14.2826 13.4147 14.0155 13.4147 13.6926C13.4147 13.5187 13.4457 13.3664 13.5078 13.236C13.576 13.1056 13.6629 12.9876 13.7684 12.8819L15.937 10.7577L18.2917 8.80125L18.6732 9.41619L15.3506 9.56516H9.77563C8.82007 9.56516 8.00726 9.73607 7.33714 10.0776C6.66702 10.4193 6.15513 10.8944 5.80146 11.5031C5.45399 12.1118 5.28026 12.8075 5.28026 13.5901C5.28026 14.3851 5.45399 15.0901 5.80146 15.7049C6.15513 16.3136 6.66702 16.795 7.33714 17.1491C8.00726 17.5032 8.82007 17.6801 9.77563 17.6801H11.9627C12.3041 17.6801 12.5833 17.792 12.8005 18.0155C13.0238 18.2391 13.1355 18.5124 13.1355 18.8354C13.1355 19.1584 13.0238 19.4317 12.8005 19.6553C12.5833 19.8851 12.3041 20 11.9627 20H9.66399C8.28026 20 7.08895 19.736 6.08999 19.208C5.09722 18.6863 4.33403 17.9503 3.80043 17C3.26681 16.0559 3 14.9442 3 13.6647Z",fill:"currentColor"}));function Ta({disabled:t=!1,isShowingChanges:e,onMouseEnter:n,onClick:o,onEsc:r}){const a=B(),i=m.useRef(null);return m.useEffect(()=>{if(e){const c=g=>{g.key==="Escape"&&(r?.(),i.current&&i.current===document.activeElement&&i.current.blur())};return window.document.addEventListener("keydown",c),()=>{window.document.removeEventListener("keydown",c)}}},[e,r]),s.jsx(me,{label:!t&&a.formatMessage(e?ls.hideChanges:ls.showChanges),children:s.jsx(le,{icon:Ko,ref:i,disabled:t,onClick:o,onMouseEnter:n,className:te("transition-colors enabled:hover:bg-black/5 dark:enabled:hover:bg-white/10",e&&$o)})})}const ls=Ve({showChanges:{id:"3jMGNS",defaultMessage:"Show changes"},hideChanges:{id:"HWiQSk",defaultMessage:"Hide changes"}});function Sa({disabled:t=!1,hasPreviousVersion:e,hasNextVersion:n,hideShowChanges:o,isShowingChanges:r,onHoverPrevious:a,onHoverShowChanges:i,onToggleShowChanges:c,onClickPrevious:g,onClickNext:l}){const d=B();return s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(je,{children:!o&&s.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",bounce:.24,duration:.4},children:s.jsx(Ta,{disabled:t||!e,isShowingChanges:r,onMouseEnter:i,onClick:c,onEsc:c})})}),s.jsx(me,{label:e&&d.formatMessage({id:"PoD5+8",defaultMessage:"Previous version"}),children:s.jsx(le,{disabled:t||!e,icon:ya,onMouseOver:a,onClick:g})}),s.jsx(me,{label:n&&d.formatMessage({id:"PJ8YVJ",defaultMessage:"Next version"}),children:s.jsx(le,{disabled:t||!n,icon:ba,onClick:l})})]})}function Ea(t){for(const e of wa){const n=t.match(e);if(n)return n[0]}return null}const wa=[/AKIA[0-9A-Z]{16}/,/AIza[0-9A-Za-z_-]{35}/,/^(?:ghp_[A-Za-z0-9]{36}|github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}|gho_[A-Za-z0-9]{36}|ghu_[A-Za-z0-9]{36}|ghs_[A-Za-z0-9]{36}|ghr_[A-Za-z0-9]{36})$/,/xox[baprs]-[0-9A-Za-z-]+/,/sk-[A-Za-z0-9]{48}/,/SK[0-9a-fA-F]{32}/,/(sk_live_[0-9a-zA-Z]{24})|(sk_test_[0-9a-zA-Z]{24})/,/-----BEGIN PRIVATE KEY-----/],_a=`${Go}...`;function ye(t){return["canvas","textdoc","share",t]}function Aa({isLoading:t,isPublishedVersionLatest:e,sharedTextdoc:n,textdocVersion:o,title:r}){const{textdocId:a}=o,[i,c]=m.useState(!1),g=Ea(o.content),l=(y,M)=>{y&&wn(y,void 0,M).then(()=>{c(!0),setTimeout(()=>{c(!1)},1500)}).catch(()=>{})},d=ft(),{mutate:h,isPending:b}=_e({scope:{id:a},mutationFn:y=>$.safePost("/textdoc/{textdoc_id}/share",{parameters:{path:{textdoc_id:y}}}).then(M=>qe(M.shared_textdoc)),onSuccess:y=>{d.setQueryData(ye(a),y),l(rt(y.sharedTextdocId))}}),{mutate:f,isSuccess:T}=_e({scope:{id:a},mutationFn:y=>$.safePost("/textdoc/shared/{shared_textdoc_id}/update_to_latest",{parameters:{path:{shared_textdoc_id:y}}}).then(M=>qe(M.shared_textdoc)),onSuccess:y=>{d.setQueryData(ye(a),y)}}),{mutate:p}=_e({scope:{id:a},mutationFn:({sharedTextdocId:y,access:M})=>$.safePost("/textdoc/shared/{shared_textdoc_id}/update_access",{parameters:{path:{shared_textdoc_id:y}},requestBody:{shared_textdoc_access:M}}).then(j=>qe(j.shared_textdoc)),onMutate:({access:y})=>{const M=ye(a),j=d.getQueryData(M);return d.setQueryData(M,j&&{...j,access:y}),{previousAccess:j?.access}},onSuccess:y=>{d.setQueryData(ye(a),y)},onError:(y,M,j)=>{const P=ye(a),I=d.getQueryData(P);d.setQueryData(P,I&&{...I,access:j?.previousAccess})}}),v=m.useRef(null),u=y=>{v.current?.focus(),n?(L.logButtonClick(q.COPY_SHARE_LINK,we(o)),l(rt(n.sharedTextdocId),y)):(L.logButtonClick(q.CREATE_SHARE_LINK,we(o)),h(a))},C=y=>{n&&(L.logButtonClick(y===_n.PUBLIC?q.UPDATE_SHARE_LINK_PUBLIC:q.UPDATE_SHARE_LINK_PRIVATE,we(o)),p({sharedTextdocId:n.sharedTextdocId,access:y}))},x=n?rt(n.sharedTextdocId):void 0,S=()=>{n&&(L.logButtonClick(q.UPDATE_SHARE_LINK_TO_LATEST,we(o)),f(n.sharedTextdocId))},w=g||n?.isAnonifyApiKeyDetected;return s.jsx(Vo,{inputRef:v,isLoading:t,isPublishedVersionLatest:e,sharedObject:n&&{id:n.sharedTextdocId,title:r,access:n.access,versionInt:n.versionInt,isModerationBlocked:n.isModerationBlocked,isAnonifyApiKeyDetected:n.isAnonifyApiKeyDetected},title:r,shareTextPlaceholder:_a,shareUrl:x,isCopySuccessful:i,didPublishUpdates:T,isCreateLinkRequestInProgress:b,handleUpdateLatestSharedVersion:S,handlePrivacyChange:C,handlePrimaryButtonClick:u,maybeRenderWarndingContent:()=>s.jsx(s.Fragment,{children:w&&s.jsx(ka,{})})})}function we(t){return{textdocType:t.type,textdocId:t.textdocId}}function Ma({textdocVersion:t,isDisabled:e,title:n}){const o=po(),r=B(),a=t?.textdocId,i=ht($e.hasSeenCanvasShareButtonNux),{data:c,isLoading:g}=mt({enabled:!!a&&!e,queryKey:ye(a),queryFn:()=>!a||a.startsWith(Mn)?Promise.resolve(null):$.safeGet("/textdoc/{textdoc_id}/share",{parameters:{path:{textdoc_id:a}}}).then(C=>C.shared_textdoc&&qe(C.shared_textdoc))}),[l,d]=m.useState(!1),{triggerRef:h,container:b}=vs({isOpen:l,onClose:()=>d(!1)}),f=o?.isWorkspaceAccount()&&!o?.features.includes(go.WorkspaceShareLinks);if(e||f||!t)return s.jsx(me,{label:f?r.formatMessage(it.workspaceSharingDisabled):r.formatMessage(it.share),children:s.jsx(le,{disabled:!0,icon:Xt})});const T=()=>{L.logButtonClick(q.OPEN_SHARE_MENU,we(t))},p=c?.versionInt===t.versionInt&&c?.title===t.title,v=({className:C})=>s.jsxs("div",{className:"relative h-fit w-fit",children:[s.jsx(Xt,{className:C}),!p&&c&&s.jsx("div",{className:"absolute end-0 top-[1px] flex items-center gap-1.5",children:s.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-blue-400"})})]}),u=s.jsxs(yn,{open:l,onOpenChange:d,children:[s.jsx(me,{label:r.formatMessage(it.share),children:s.jsx(bn,{ref:h,asChild:!0,children:s.jsx(le,{icon:v,onClick:T})})}),s.jsx(je,{children:l&&s.jsx(Tn,{forceMount:!0,container:b,children:s.jsx(Sn,{align:"end",className:"z-50",sideOffset:8,collisionPadding:8,children:s.jsx(Aa,{title:n,sharedTextdoc:c,isLoading:g,isPublishedVersionLatest:p,textdocVersion:t})})})})]});return!i.isLoading&&i.eligible?s.jsx(En,{announcementKey:$e.hasSeenCanvasShareButtonNux,show:!0,side:"bottom",align:"end",theme:"bright",dismissOnOutsideClick:!0,badge:"none",title:s.jsx(F,{id:"oHutKI",defaultMessage:"Share {title}",values:{title:n}}),description:s.jsx(F,{id:"oQuH7b",defaultMessage:"Easily share your content with others â€” your chat stays private."}),onDismiss:i.markAsViewed,sideOffset:0,children:u}):u}function ka(){return s.jsx(An,{type:"danger",className:"w-auto md:p-3",children:s.jsx(F,{id:"8NG6sN",defaultMessage:"There may be an API key in your canvas. If you share the canvas, anyone with the link can see its contents."})})}const ja=({clientThreadId:t,isHistoricalVersion:e,textdocVersion:n,readonlyReason:o,hasDebug:r,isEmbedded:a,isPersisting:i,isShowingChanges:c,hideRunCode:g=!1,hideHistoryActions:l=!1,hideRenameButton:d=!1,onHoverPrevious:h,onHoverShowChanges:b,onToggleShowChanges:f,onClickPrevious:T,onClickNext:p,onClickCodePreview:v,onClose:u,toggleDebugView:C,toggleConsoleVisibility:x,isCodeRunning:S,isTextdocAttachedPending:w,isTextdocStreaming:y,isConsoleOpen:M,isDebugVisible:j})=>{const P=B(),I=ys(),X=We(n?.textdocId),H=n?.title??"",{isCodePreviewable:K,isCodeExecutable:N,hasCanvasCodeExecution:k}=As(n),oe=!g&&(K||N),_=n?.versionInt,O=_!=null&&_>1,G=e,ae=!l,Y=K&&S,V=n==null||X!=null||e||o.isStreaming;return s.jsxs(fe.Header,{className:te("@container",K&&S&&"bg-transparent!"),children:[s.jsx(fe.CloseButton,{onClick:u}),s.jsx("div",{className:"@container flex flex-1 basis-0 items-center gap-1 truncate leading-[0]",children:s.jsx(Ca,{hasDebug:r,isConsoleOpen:M,isDebugVisible:j,toggleConsoleVisibility:x,toggleDebugView:C,isPersisting:i,textdocVersion:n,isTextdocAttachedPending:w,isTextdocStreaming:y,shouldShowPlayButton:oe,hideRenameButton:d,clientThreadId:t})}),s.jsxs("div",{className:"flex min-w-0 basis-auto items-center gap-1.5 leading-[0] select-none",children:[ae&&s.jsx(Sa,{hideShowChanges:Y,disabled:o.isStreaming,hasNextVersion:G,hasPreviousVersion:O,isShowingChanges:c,onHoverPrevious:h,onHoverShowChanges:b,onToggleShowChanges:f,onClickPrevious:T,onClickNext:p}),s.jsx(va,{clientThreadId:t,textdocVersion:n}),s.jsx(Ma,{isDisabled:V,textdocVersion:n,title:H}),oe&&s.jsx(Io,{clientThreadId:t,isCodePreviewable:K,isDisabled:!k||o.isTextdocStreaming&&!S,disabledTooltip:k?void 0:P.formatMessage({id:"NTZRWe",defaultMessage:"Code execution for canvas is disabled for your workspace. Contact your admin to enable."}),onClick:v,isCodeRunning:S,textdocType:n?.type}),!a&&!I&&s.jsx(Wo,{})]})]})},Na=/\s/,Ia=30;function ds(t,e){const n=t.indexOf(e);return n===-1?!1:t.indexOf(e,n+e.length)===-1}function ce(t,e){return Na.test(t[e])}function us(t,e,n=!1){if(e===0||n&&ce(t,e-1))return e;for(;e>0&&ce(t,e-1);)e--;for(;e>0&&!ce(t,e-1);)e--;return ce(t,e)&&e++,e}function fs(t,e,n=!1){if(e===t.length||n&&ce(t,e))return e;for(;e<t.length&&ce(t,e);)e++;for(;e<t.length&&!ce(t,e);)e++;return ce(t,e-1)&&e--,e}function Ra(t,e,n=!0,o=Ia){if(t.start<0||t.end>e.length||t.start>t.end)throw new Error("Invalid commentSourceRange provided.");const r=e.substring(t.start,t.end);let a=t.start,i=t.end;n&&(a=us(e,a,!0),i=fs(e,i,!0));let c=e.substring(a,t.start),g=e.substring(t.end,i),l=`${c}${r}${g}`;if(ds(e,l)&&(o==null||l.length>=o))return{before:c,after:g,allSurrounding:l};let d=a,h=i,b=!0;for(;b&&(o==null||l.length<o);){let f=!1;const T=d>0?us(e,d):d;T<d&&(d=T,f=!0);const p=h<e.length?fs(e,h):h;if(p>h&&(h=p,f=!0),f){const v=e.substring(d,t.start),u=e.substring(t.end,h),C=`${v}${r}${u}`;if(ds(e,C)&&(o==null||C.length>=o))return{before:v,after:u,allSurrounding:C};c=v,g=u,l=C}else b=!1}return{before:c,after:g,allSurrounding:l}}const Ae="# Context",Me="# Instructions";function ke(t,e,n){if(e==null||n==null)return`The user is referring to the entire text of "${t}".`;const o=`
## Selected Text
The user has selected this text in "${t}" in particular:
${e}
`.trim();return n.allSurrounding===e?o:`
${o}

## Surrounding Context
Here is the surrounding context:
${n.allSurrounding}
`.trim()}function ks(t,e){return t==null||e==null?"entire document":t===e.allSurrounding?"selected text":"surrounding context"}function js(t){return`For the update pattern, create a regex which exactly matches the ${t}. Edit just this string in order to fullfill the user's request. NEVER rewrite the entire document. Instead, ALWAYS edit ONLY the ${t}. The only exception to this rule is if the ${t} includes markdown lists or tables. In that case, fully rewrite the document using ".*" as the regex update pattern.`.trim()}function Pa(t,e,n,o){if(!ue(e)&&n&&o){const r=ks(n,o);return`
${Ae}
The user requests that you directly edit the document.

${ke(t,n,o)}

${Me}
Use the update_textdoc tool to make this edit. ${js(r)}`.trim()}return`
${Ae}
The user requests that you directly edit the document.

${ke(t,n,o)}

${Me}
Use the update_textdoc tool to make this edit. You MUST fully rewrite the entire document by using ".*" as the update regex pattern.`.trim()}function Da(t,e,n){return`
${Ae}
The user requests that you add comments about some text.

${ke(t,e,n)}

${Me}
Do not respond to the user's question directly, just leave comments.`.trim()}function La(t,e){return ue(t)?e==="entire document"?` If you choose to update the ${e}, you MUST fully rewrite the ${e} by using ".*" as the update regex pattern.`:` If you choose to update the ${e}, you MUST fully rewrite the entire document by using ".*" as the update regex pattern. When you do so, ONLY modify the ${e} and rewrite other sections exactly as is, except for parts that must change based on this update`:e==="entire document"?"":` If you choose to update the ${e}, follow these instructions: ${js(e)}`}function Oa(t,e,n,o){const r=ks(n,o),a=La(e,r);return`
${Ae}
${ke(t,n,o)}

${Me}
The user would like you perform one of the following actions:
- Update the ${r} via the \`update_textdoc\` tool.${a}
- Explain the selected text via chat, or answer a general question about the selected text (no tool call required).
- Comment on the ${r} with feedback via the \`comment_textdoc\` tool. This should only be used if the user very explicitly asks for feedback, critique, or comments.

Based on the user's request, choose the appropriate action.
`.trim()}function Ha(t,e,n){return`
${Ae}
${ke(t,e,n)}

${Me}
The user would like you to create a new textdoc.
`.trim()}function Ba(t,e,n,o=null,r=null){switch(n){case de.ASK:return Oa(t,e,o,r);case de.CREATE_TEXTDOC:return Ha(t,o,r);case de.EDIT:return Pa(t,e,o,r);case de.COMMENT:return Da(t,o,r)}}function Ua(t){switch(t){case D.ACCELERATOR:case D.CONSOLE:case D.ACCEPT_COMMENT:case D.HIVE_SPEAKER_EDIT:return!0;case D.ASK_CHATGPT:case D.FULL_SCREEN_SUBMIT:return!1}}function qa(t,e){switch(e){case D.ASK_CHATGPT:case D.ACCEPT_COMMENT:case D.FULL_SCREEN_SUBMIT:return t.formatMessage(Fa.askChatGPT);case D.ACCELERATOR:case D.CONSOLE:case D.HIVE_SPEAKER_EDIT:return}}const Ns=(t,e)=>{const n=B(),o=xs(t),r=Ts(t),a=gt();return m.useCallback(async({content:i,sourceRange:c,action:g,userMessageType:l,acceleratorMetadata:d,selectionMetadata:h,sourceEvent:b})=>{if(e?.versionInt==null||a)return;const{textdocId:f,type:T,versionInt:p,content:v}=e;let u,C=null;c&&c.start!==c.end&&(u=v.slice(c.start,c.end),C=Ra(c,v));const x=Ba(f,T,g,u,C),w=xo(x,{exclude_after_next_user_message:!0});r({sourceEvent:b,promptMessage:Ss(i,{canvas:{textdoc_id:f,textdoc_type:T,version:p,textdoc_content_length:v.length,user_message_type:l,accelerator_metadata:d,selection_metadata:h},is_visually_hidden_from_conversation:Ua(l),targeted_reply:u,targeted_reply_label:qa(n,l),open_in_canvas_view:{type:"canvas_textdoc",id:f}}),completionMetadata:o?{conversationMode:o}:void 0,appendMessages:[w]})},[e,a,r,o,n])},Fa=Ve({askChatGPT:{id:"h5ANdM",defaultMessage:"Asked ChatGPT"}}),$a=t=>{const e=xt(),n=Ct(e,"80186230"),o=ys(),{eligible:r,isLoading:a,markAsViewed:i}=ht(t);return{markAsViewed:i,eligible:!o&&r&&n,isLoading:a}};function Ka(){return $a($e.hasDismissedCanvasContextualOnboarding)}function Ga(t){const e=/\[([^\]]+)\]\((https?:\/\/[^\s)]+|www\.[^\s)]+)\)/gi,n=new Set,o=t.matchAll(e);for(const r of o){const a=r[2];try{let i=a;i.startsWith("www.")&&(i="http://"+a),new URL(i),n.add(a)}catch{}}return n}const Va=async({lastVersion:t,textdocId:e,content:n,comments:o})=>{const r=kn(o,n);return(await $.safePost("/textdoc/{textdoc_id}",{parameters:{path:{textdoc_id:e}},requestBody:{version:t,content:n,comments:r}})).version},Wa=()=>{const t=m.useRef([]),e=m.useRef(null),{mutateAsync:n,isPending:o}=_e({mutationKey:["canvas","textdoc","persist"],mutationFn:Va});return[m.useCallback(async(a,i,c)=>{const g=new AbortController,d=(async()=>{const[T]=t.current;try{await T?.promise}catch(p){L.logError("Saving document",p)}if(!g.signal.aborted)try{const p=Math.max(e.current??0,a.versionInt??bs);let v="";try{Yt(i)?v=i():v=i}catch(S){L.logError("Serializing document",S)}let u=[];try{Yt(c)?u=c():u=c}catch(S){L.logError("Adjusting comments",S)}const{textdocId:C}=a;jn({textdocId:C,basedOnVersionInt:p,content:v,comments:u});const x=await n({textdocId:C,lastVersion:p,content:v,comments:u});Nn({textdocId:C,basedOnVersionInt:p,newVersion:x}),e.current=x}catch(p){L.logError("Error saving document",p)}finally{t.current.shift()}})(),h={abort:()=>g.abort(),promise:d},[b,f]=t.current;return f&&(f.abort(),t.current=b?[b]:[]),t.current=b?[b,h]:[h],d},[n]),t,o]},za=3e3,Qa=t=>{const[e,n,o]=Wa(),r=B(),a=m.useRef(null),i=m.useCallback(In(async(l,d,h)=>{if(!ct(l))return e(l,d,h);Fe.replaceTempTextdocContent(l.textdocId,typeof d=="string"?d:d())},za,{leading:!1}),[e]),c=Rn(t);return m.useEffect(()=>{if(!c)return;const l=os(window,{pagehide:()=>i.flush(),beforeunload:h=>{i.flush(),h.returnValue=r.formatMessage({id:"QZrKwi",defaultMessage:"You have a canvas save in progress."})}}),d=os(document,{visibilitychange:()=>i.flush(),keydown:()=>{a.current="keyboard"},mousemove:()=>{a.current!=="mouse"&&i.flush(),a.current="mouse"}});return()=>{a.current=null,d(),l()}},[r,c,i]),m.useEffect(()=>()=>{i.flush()},[t,i]),Pn(async()=>{await i.flush(),await Promise.allSettled(n.current?.map(({promise:l})=>l)??[])}),[m.useCallback((l,d,h)=>{const{textdocId:b}=l;return ct(l)||Dn(b),i(l,d,h)},[i]),i.flush,o||c]};function Xa(t,e,n){const o=ft(),r=n!=null&&e!=null,{data:a,error:i,fetchNextPage:c,hasNextPage:g,isFetching:l}=an(ms(t,e,r)),d=m.useCallback(async()=>{const p=e!=null;await o.prefetchInfiniteQuery(ms(t,e,p))},[o,t,e]);m.useEffect(()=>{const p=e;return()=>{o.removeQueries({queryKey:Is(t,p),exact:!0})}},[o,t,e]);const[h,b,f,T]=m.useMemo(()=>{if(a&&n){const v=a.pages.flatMap(C=>C),u=v.findIndex(C=>"beforeVersion"in n?(C.versionInt??bs)<n.beforeVersion:C.versionInt===n.version);if(u!==-1)return[u===v.length-1,v[u],u>0?v[u-1]:null,u<v.length-1?v[u+1]:null]}const p=a?.pages.flatMap(v=>v)??[];return[!0,null,null,p.length===0?null:p[0]]},[a,n]);return m.useEffect(()=>{!l&&r&&g&&h&&c()},[l,r,g,h,c]),m.useEffect(()=>{!b&&i&&Ee(t)},[b,i,t]),{historicalTextdocVersion:b,nextHistoricalTextdocVersion:f,prefetchHistoricalTextdocVersion:d,previousHistoricalTextdocVersion:T}}function Is(t,e=null){return["textdocHistory",t,e]}function ms(t,e,n=!0){return{queryKey:Is(t,e),queryFn:({pageParam:o})=>Ya(t,o),initialPageParam:e??void 0,getNextPageParam:o=>{const r=Co(o)?.versionInt;if(r&&r>1)return r},enabled:n,staleTime:1/0,retry:2}}async function Ya(t,e){return e===void 0||e<=1?[]:(await $.safeGet("/textdoc/{textdoc_id}/history",{parameters:{path:{textdoc_id:t},query:{before_version:e}}})).previous_doc_states.map(({id:o,version:r,textdoc_type:a,title:i,content:c,updated_at:g,comments:l,metadata:d})=>({textdocId:o,versionInt:r,messageId:null,title:i,type:Hn(a),content:c,status:Cs.COMPLETE,createdAt:On(g),comments:Ln(l,c),metadata:{content_references:d?.content_references}}))}const Za=(t,e,n=1)=>{rn(t.scrollTop,e,{duration:n,ease:"easeInOut",onUpdate:o=>{t.scrollTop=o}})},Ja=he.div`flex w-full grow flex-col gap-1 rounded-xl p-2 pe-5 text-sm`,er=he.input`ms-[-2px] w-auto rounded-none border-none bg-[#E5F3FF] p-0 px-0.5 text-sm font-semibold outline-none focus:outline-none`,tr=he(Q.span)`start border-token-text-tertiary absolute -bottom-0.5 w-full origin-left border-b border-solid`,sr=he(Q.span)`start border-token-text-tertiary absolute -bottom-0.5 w-full border-b border-dashed`,nr={initial:{scaleX:0,opacity:1},animate:{scaleX:1,opacity:0,transition:{scaleX:{duration:.85,ease:[.65,0,.35,1]},opacity:{delay:.85,duration:.1}}}},or={initial:{opacity:0},animate:{opacity:1,transition:{delay:.85,duration:.1}}};he.div`ms-2 rounded-full px-2 py-0.5 text-xs font-medium`;const ar=({speakerId:t,content:e,range:n,filterDecision:o,isEditing:r,isSaving:a,containerRef:i,measuredTextContainerRef:c,isEditingEnabled:g})=>{const l=m.useRef(null),{setSpeakers:d,setEditingSpeaker:h,hoveringSpeakerId:b,setHoveringSpeakerId:f,speakers:T,editingSpeaker:p,enableDebugger:v}=ut.getState(),u=ut(k=>k.currentTime),C=n.max==null?u===n.min:u>=n.min&&u<=n.max;m.useEffect(()=>{if(C&&l.current&&i.current){const k=i.current,oe=l.current,_=k.getBoundingClientRect().top,G=oe.getBoundingClientRect().top-_+k.scrollTop-20;Za(k,G,.3)}},[n.min,n.max,C,i]);const x=T.get(t),S=!!x?.storedName&&x.storedName!==x?.placeholderName||(x?.isEdited??!1),w=x?.name??x?.storedName??x?.placeholderName??"Unidentified Speaker",y=m.useRef(null),M=t===p?.id,j=t===b,[P,I]=m.useState(!1),[X,H]=m.useState(!1);m.useEffect(()=>{y.current&&(!M||!X||(y.current?.focus(),S&&(y.current.value=w)))},[S,M,X,w]),vo(()=>{if(c.current&&y.current){const k=c.current.offsetWidth;y.current.style.width=`${k}px`}},[p?.name]);const K=m.useCallback(()=>{if(!p||!x)return;h(null),H(!1),I(!1),f(null);const k=T.set(t,{...x,name:p.name?p.name:x.placeholderName,isEdited:!!p.name});d(k)},[p,x,h,f,T,t,d]),N=!r||a;return s.jsxs(Ja,{ref:l,className:te(C&&"animate-[hive-log-fadeout_0.3s_1.5s_forwards] bg-blue-500/10",!1,!1),children:[!1,s.jsxs("div",{className:"mb-[1px] flex w-full items-center justify-between",children:[g&&(M?s.jsx(er,{ref:y,disabled:!X,onBlur:K,className:te(!M&&"hidden w-0"),placeholder:x?.isEdited?void 0:x?.placeholderName,value:p?.name,onKeyDown:k=>{k.key==="Enter"&&K()},onChange:k=>h({id:t,name:k.target.value})}):s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("div",{onClick:()=>{N||(h({id:t,name:S?w:""}),H(!0))},onMouseEnter:()=>{N||(f(t),I(!0))},onMouseLeave:()=>{N||(f(null),I(!1))},className:te("relative flex font-semibold transition-colors",{"text-blue-400!":j&&!N},{"cursor-pointer":!N},{"text-token-text-tertiary":!N&&!S}),children:[w,!N&&!S&&s.jsxs(s.Fragment,{children:[s.jsx(tr,{...nr}),s.jsx(sr,{...or,className:te(j&&!N&&"border-blue-400!")})]})]}),P&&!N&&s.jsx(pt,{className:"h-4 w-4 text-blue-400"}),!1]})),s.jsx("div",{className:"text-xs text-[#5D5D5D]",children:Qo(n.min)})]}),s.jsx("div",{className:"flex",children:e})]})},rr=t=>mt({queryKey:["hiveLog",t],queryFn:()=>$.safeGet("/hive/{hive_id}/transcript",{parameters:{path:{hive_id:t}}}),enabled:!!t,select:Xo}),ir=()=>mt({queryKey:["hiveLogPrompts"],queryFn:()=>$.safeGet("/hive/prompts"),enabled:!0}),cr=(t,e)=>$.safePost("/hive/{hive_id}/speakers",{parameters:{path:{hive_id:t}},requestBody:{speakers:e}}),lr=he.div`invisible absolute start-0 top-0 rounded-md border px-0.5 text-sm font-semibold whitespace-pre`,dr=(t,e)=>!e||!t?"":e.isEdited||t.name&&t.name!==e.placeholderName?t.name:e.placeholderName,hs=he(Q.div)`flex items-center gap-2`,ps={initial:{opacity:0,y:-4},animate:{opacity:1,y:0,transition:{duration:.2}},exit:{opacity:0,y:-4,transition:{duration:.2}}},ur="ts",fr=({hiveId:t,clientThreadId:e,ts:n,textdocVersion:o})=>{const r=rr(t),a=ir(),i=B(),[c,g]=m.useState(!1),l=m.useRef(null),d=xt(),h=Ct(d,"2986567482"),{isOpen:b,closeSidebar:f,openSidebar:T,setCurrentTime:p,speakers:v,setSpeakers:u,editingSpeaker:C,enableDebugger:x,setEnableDebugger:S,selectedFilters:w,setSelectedFilters:y}=ut();m.useEffect(()=>{n!==void 0&&(T(),p(n))},[n,T,p]);const M=m.useRef(null),[j,P]=m.useState(!1),I=Ns(e,o);if(r.isLoading||a.isLoading||r.isError||a.isError||!r.data||!a.data)return null;const X=C?v.get(C.id):null,H=Array.from(v.values()).some(({isEdited:_})=>_),K=()=>{const _=new Map(Array.from(v.entries()).map(([O,G])=>[O,{...G,name:void 0,isEdited:!1}]));u(_),g(!1)},N=_=>{if(!a.data.speaker_edits)return;const O=a.data.speaker_edits.replace("{speakers}",JSON.stringify(Array.from(v.entries())));return I({sourceEvent:_,action:de.EDIT,content:O,userMessageType:D.HIVE_SPEAKER_EDIT,selectionMetadata:void 0})},k=async _=>{if(H){P(!0);try{const O=[];Array.from(v.entries()).forEach(([Y,V])=>{!V.isEdited||!V.name||O.push({id:Y,updated_name:V.name})});const G=await cr(t,O);if(!G)throw new Error("Failed to update hive content");const ae=new Map(v);for(const Y of G.updated_speakers){if(!ae.has(Y.id))continue;const V=ae.get(Y.id);V&&ae.set(Y.id,{...V,storedName:Y.updated_name,isEdited:!1})}await N(_),u(ae),g(!1)}catch{}finally{P(!1)}}},oe=r.data.filter(({filterDecision:_})=>!_||w?.includes(_));return s.jsxs("div",{className:te("flex h-full w-full max-w-[360px] min-w-[240px] flex-col border-s border-gray-200",b?"visible":"invisible hidden"),children:[s.jsxs("div",{className:"flex h-14 w-full items-center justify-between border-b border-gray-200 p-4",children:[s.jsxs("div",{className:"text-token-text-secondary group/debug flex items-center gap-1.5 py-2 text-base font-medium",children:[s.jsx(F,{...Se[c?"edit":"transcript"]}),s.jsx(Bn,{children:s.jsx(F,{...Se.researchPreview})}),!1]}),s.jsx("div",{className:"flex h-10 items-center gap-2",children:s.jsx(je,{mode:"wait",children:c?s.jsxs(hs,{...ps,children:[s.jsx(Ke,{onClick:K,color:"secondary",disabled:j,children:s.jsx(F,{...Se.cancelButton})}),s.jsx(Ke,{color:"primary",onClick:k,disabled:!H,loading:j,children:s.jsx(F,{...Se.saveButton})})]},"edit-buttons"):s.jsxs(hs,{...ps,children:[h&&s.jsx(me,{className:"h-10",label:i.formatMessage(Se.editButtonTooltip),children:s.jsx(le,{icon:pt,onClick:()=>g(!0)})}),s.jsx(le,{icon:yo,onClick:()=>f()})]},"non-edit-buttons")})})]}),!1,s.jsxs("div",{ref:l,className:"flex w-full flex-col gap-2 overflow-y-scroll p-2",children:[h&&C&&s.jsx(lr,{ref:M,children:dr(C,X)}),oe.map(_=>s.jsx(ar,{isEditingEnabled:h,measuredTextContainerRef:M,containerRef:l,isEditing:c,isSaving:j,..._},mr(_)))]})]})},mr=t=>{const{speakerId:e,content:n,range:o}=t;return`${e}-${o.min}-${o.max}-${n.slice(0,2)}`},Se=Ve({researchPreview:{id:"HiveLogSidebar.researchPreview",defaultMessage:"Research Preview"},edit:{id:"HiveLogSidebar.edit",defaultMessage:"Edit"},transcript:{id:"HiveLogSidebar.transcript",defaultMessage:"Transcript"},editButtonTooltip:{id:"HiveLogSidebar.editButtonTooltip",defaultMessage:"Edit speakers"},cancelButton:{id:"HiveLogSidebar.cancelButton",defaultMessage:"Cancel"},saveButton:{id:"HiveLogSidebar.saveButton",defaultMessage:"Save"}}),Ur=({isFullScreen:t=!1,isEmbedded:e=!1,hideHeader:n=!1,hideRunCode:o=!1,isReadonlyFromQueryParam:r=!1,hideRenameButton:a=!1,clientThreadId:i,focusedTextdoc:c,onClose:g,isAnimating:l=!1,width:d,hideBottomComposer:h=!1})=>{const b=xt(),{textdocId:f,history:T,showChangesAtVersion:p=null,shouldRunCodeOnOpen:v=!1}=ma(c),u=B(),[C,x,S]=Qa(f),{targetedContent:w}=Un(),y=qn(),[M,j]=m.useState(!1),[P,I]=m.useState(!1),X=Fn(f),H=$n(),K=dt(i,Es.getRequestId),N=bo(K),{data:k,isLoading:oe}=Kn(f,p),[_,O]=m.useState(!1),[G,ae]=m.useState(null),Y=Gn(i),V=m.useRef(null),se=X?.versions??[],pe=se[0]?.versionInt,{historicalTextdocVersion:Ne,nextHistoricalTextdocVersion:Rs,previousHistoricalTextdocVersion:Ps,prefetchHistoricalTextdocVersion:vt}=Xa(f,pe,T),yt=Vn();m.useEffect(()=>{Ge.reset()},[f]);const bt=se.length>0?se[se.length-1]:null,Qe=se.length>1?se[se.length-2]:null,Tt=_s(i),{restoreHistoricalTextdocVersion:Ds,optimisticRestoredTextdocVersion:Ls}=Wn(Tt,bt,Ne),ge=T!=null,A=ge?Ne:bt,Z=p!=null,Te=Ns(i,A),St=l?null:k,Ie=(()=>{if(l||A==null)return[];const E=as(A.comments);return!Z&&Ne!=null?Ne.comments:!Z||k==null?E:k.contentBefore!==k.contentAfter?[]:fa(k.commentsBefore,k.commentsAfter)})(),U=A?.type??Be.LOADING,Xe=zn(),Et=ct(A),re=Qn(A),Ye=Xn(A),wt=Yn(A),Os=wt&&!e,Hs=cs(H),Bs=cs(N);m.useEffect(()=>{!Et&&se.length===0&&Xe!==Zt.NATIVE&&(!H&&Hs.current||!N&&Bs.current||!H&&!N)&&g?.()},[se.length,H,N]);const{content:J,currentlyStreamingLineIndex:_t}=k?.contentBefore!=null&&!ue(U)?{content:k.contentBefore,currentlyStreamingLineIndex:null}:_o(A,Qe),Us=Zn(Tt,Array.from(Ga(J))),[Re,Ze]=ra({value:J,isRequestActive:N,isTextdocStreaming:re,comments:Ie}),At=Jn(A),Mt=Xe===Zt.LAST_TURN||Re||S;m.useEffect(()=>{eo().sendMessage({type:Ms.Streaming,streaming:Mt})},[Mt]);const qs=({getSerializedDocument:E,getAdjustedComments:R})=>{A&&C(A,E,R)},Fs=E=>{if(!A)return;const R=E.doc.toString();C(A,R,E.field(jo,!1)??[])},kt=(E,R,ee,ie,xe)=>{Ze(!0),Te({sourceEvent:E,action:ee,content:R,userMessageType:D.ASK_CHATGPT,sourceRange:ie,selectionMetadata:{selection_type:xe,selection_position_range:ie}})},jt=({id:E})=>{At(E,ts.DISMISS),Ge.reset()},Nt=async(E,R)=>{Ze(!0);const{id:ee,at:ie,content:xe}=R;if(await At(ee,ts.ACCEPT)===!1)return Ze(!1);Te({sourceEvent:E,content:xe,userMessageType:D.ACCEPT_COMMENT,sourceRange:ie,action:de.EDIT,selectionMetadata:{selection_type:rs.SELECTION,selection_position_range:ie}})},Je=(E,R,ee,ie)=>{const{action:xe}=ie;Te({sourceEvent:E,action:xe,content:ee,sourceRange:R,userMessageType:D.ACCELERATOR,acceleratorMetadata:{action:xe,id:ie.id,prompt:ee},selectionMetadata:R!=null?{selection_type:rs.SELECTION,selection_position_range:R}:void 0})},$s=(E,R)=>{Te({sourceEvent:E,action:de.EDIT,content:R,userMessageType:D.FULL_SCREEN_SUBMIT})},Ks=to(),It=E=>Ks?.[E]??E,et=()=>so(i),Gs=()=>{T?Ue(f,T):Ee(f)},W=Ro({streamingSource:Xe,isRestoring:Ls!=null,isRequestActive:N,isTextdocStreaming:re,isReadonlyFromQueryParam:r,isHistoricalVersion:ge,isShowingChanges:Z});let Pe=null;const Rt=l||W.isReadonly||Re,De=gt()||Y||r||Et,Pt=()=>l&&Ie.length>0?ve.ALL_HIDDEN:De?ve.COMMENTS_READONLY:W.isReadonly?W.isStreaming?ve.ENABLED:W.isReadonlyFromQueryParam||W.isShowingChanges||W.isHistoricalVersion?ve.COMMENTS_READONLY:ve.ALL_HIDDEN:ve.ENABLED,Vs=m.useCallback(async E=>{const{suggestion:R}=await $.safePost("/textdoc/{textdoc_id}/autocomplete",{parameters:{path:{textdoc_id:f}},requestBody:{content:E}});return R},[f]),Dt=t||l||r;let tt=[];switch(U){case Be.LOADING:Pe=s.jsx(ko,{});break;case Be.DOCUMENT:Pe=s.jsx(Mo,{value:J,comments:Ie,previousValue:Qe?.content,getAutocompleteSuggestion:Vs,previousComments:as(Qe?.comments),isRewriting:Ye,isAnimatingFromPreview:l,isSendDisabled:De,getStableCommentId:It,diff:St,isRequestActive:N,isDisabled:W.isReadonly||H,isWaitingForCommentResponse:Re,hideAccelerators:Dt,hideToolbar:Rt,hideEditOverlay:l,commentsMode:Pt(),readonlyReason:W,onBlur:x,onSave:x,onChange:qs,onCancelRequest:et,targetedContent:w,onAddComment:kt,onAcceptComment:Nt,onDismissComment:jt,onSubmitAccelerator:Je,onExitShowChanges:Gs,safeUrls:Us,width:d,modelCursor:wt||re&&!Ye?A?.modelCursor:void 0,shouldResetSelection:A?.versionInt===1,metadata:X?.metadata}),tt=Lo;break;default:ue(U)&&(Pe=s.jsx(Ao,{id:"codemirror",getStableCommentId:It,language:Po(U),value:J,comments:Ie,hideAccelerators:Dt,commentsMode:Pt(),hideToolbar:Rt,onSubmitAccelerator:Je,currentlyStreamingLineIndex:_t??null,readonlyReason:W,isRequestActive:N,isSendDisabled:De,isWaitingForCommentResponse:Re,onChange:Fs,onCancelRequest:et,onAddComment:kt,onBlur:x,onSave:x,codemirrorRef:V,onDismissComment:jt,onAcceptComment:Nt,textdocDiff:St??void 0,modelCursor:re&&_t==null?A?.modelCursor:void 0}),tt=No)}const st=m.useRef(null),Le=m.useRef(null),{hasCanvasCodeExecution:nt,isCodeExecutable:Lt,isCodePreviewable:ne}=As(A),Ot=nt&&ne,Ht=nt&&Lt,Ws=no(),Bt=m.useCallback(()=>{!_&&(Ot||Ht)?(O(!0),st.current?.runCode(U,J).finally(()=>O(!1))):(st.current?.stopCode(),O(!1))},[Ot,Ht,_,J,U]),Ut=oo(()=>{Bt()});m.useEffect(()=>{v&&Ut()},[v,Ut]);const{eligible:zs,markAsViewed:Qs}=Ka(),z=A?.versionInt,Xs=z!=null&&z>1,Ys=ge,Oe=Ps?.versionInt,ot=Rs?.versionInt,Zs=()=>{Z?T?Ue(f,T):Ee(f):(L.logButtonClick(q.SHOW_CHANGES,{textdocType:U,textdocId:f,versionInt:z,latestVersionInt:pe}),z&&ss(f,z,T))},Js=()=>{L.logButtonClick(q.HISTORY_PREVIOUS,{textdocType:U,textdocId:f,versionInt:z,latestVersionInt:pe,isShowingChanges:Z}),f&&z&&Xs&&Ue(f,{beforeVersion:z},Z&&Oe!=null?Oe:void 0)},en=()=>{L.logButtonClick(q.HISTORY_NEXT,{textdocType:U,textdocId:f,versionInt:z,latestVersionInt:pe,isShowingChanges:Z}),Ys&&(ot?Ue(f,{version:ot},Z?ot:void 0):Z&&pe?ss(f,pe,null):Ee(f))},tn=Ct(b,"1804926979"),qt=dt(i,Yo(f)),sn=zo(),Ft=We(A?.textdocId),nn=!n&&s.jsx(ja,{hideRunCode:o,clientThreadId:i,isHistoricalVersion:ge,textdocVersion:A,readonlyReason:W,hasDebug:y,isEmbedded:e,isPersisting:S,isShowingChanges:Z,isConsoleOpen:P,isDebugVisible:M,hideHistoryActions:r,hideRenameButton:a,onHoverPrevious:()=>{vt(),Oe&&yt(f,Oe)},onHoverShowChanges:()=>{vt(),z&&yt(f,z)},onToggleShowChanges:Zs,onClickPrevious:Js,onClickNext:en,toggleDebugView:()=>j(E=>!E),toggleConsoleVisibility:()=>{P||To.logEvent("Canvas Open Console Clicked"),I(E=>!E)},onClose:()=>{if(L.logButtonClick(q.CLOSE_TEXTDOC,{textdocType:A?.type}),Qs(),Ft&&!t){const{create_source:E,hasUserEdits:R,tempTextdocId:ee}=Ft;if(R&&E!==es.USER_CREATED_COMPOSER){Gt(!0);return}Fe.removeTempTextdoc(ee),E===es.USER_CREATED_COMPOSER&&sn.appendText(J)}g?.()},onClickCodePreview:Bt,isCodeRunning:_,isTextdocStreaming:re,isTextdocAttachedPending:Jt(A)});let $t=null;const He=!o&&nt&&(Lt||ne),at=Do(U,J);m.useEffect(()=>{He&&(at&&Le.current?.prepareEnvironment(at),ne&&_&&!re&&So(Le.current)?.updateCode(J))},[He,at,re]);const Kt=A?.title??"";He&&($t=s.jsx(cn,{title:Kt,onChangeBackgroundColor:ae,visuallyHidden:!ne||!_,disableNetworkRequests:!Ws,networkAccessDeniedMessage:u.formatMessage({id:"GE4AJf",defaultMessage:"Network requests in canvas are disabled for your workspace. Contact your admin to enable this feature."}),enableTransition:ne&&U!==Be.CODE_HTML,isCodeUpdating:re,ref:Le}));const[on,Gt]=m.useState(!1),Vt=s.jsx(Zo,{isOpen:on,dismissModal:()=>Gt(!1),closeTextdocEditor:()=>{g?.()},textdocVersion:A,clientThreadId:i}),Wt=s.jsxs(s.Fragment,{children:[nn,s.jsx(fe.Content,{scrollToBottomMode:Os?"bottom":"top",shouldScrollToTop:Ye,isLoading:oe,hideChildren:ne&&_,overlay:$t,children:Pe}),He&&s.jsx(ln,{ref:st,sandboxRef:Le,textdocId:f,textdocTitle:Kt,textdocContent:J,isTextdocAttachedPending:Jt(A),highlightLine:E=>V.current?.highlightLine(E),isRequestActive:N,createTextdocTurn:Te,isOpen:P,onOpenChange:I}),s.jsx(je,{children:ge&&!r&&s.jsx(ia,{onClickRestore:Ds,onClickResetLatest:()=>Ee(f)})}),t&&!ge&&!h&&!(_&&ne)&&!De&&s.jsx(ua,{isRequestActive:N,clientThreadId:i,onSubmitAccelerator:Je,onSubmit:$s,onCancel:et,readonlyReason:W,acceleratorActions:tt}),!l&&!e&&zs&&s.jsx(aa,{textdocType:U})]});if(tn&&qt&&A){const R=new URLSearchParams(window.location.search).get(ur),ee=R==null?void 0:parseInt(R);return s.jsxs(s.Fragment,{children:[Vt,s.jsx(fe,{previewBackgroundColor:G,isPreviewingCode:ne&&_,children:s.jsxs("div",{className:"flex h-full",children:[s.jsx("div",{className:"relative flex h-full min-h-0 flex-auto grow flex-col",children:Wt}),s.jsx(fr,{hiveId:qt,clientThreadId:i,textdocVersion:A,ts:ee})]})})]})}return s.jsxs(s.Fragment,{children:[Vt,s.jsx(fe,{previewBackgroundColor:G,isPreviewingCode:ne&&_,children:Wt})]})};export{Ms as C,Ur as T};
//# sourceMappingURL=n28u28v6jphl8y3u.js.map

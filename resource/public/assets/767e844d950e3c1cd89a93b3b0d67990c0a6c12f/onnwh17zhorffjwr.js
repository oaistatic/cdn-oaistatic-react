const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/hyjpdnpt9abd2xlf.js","assets/mw35uwhq4g8r9eam.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/g2euln7v5pbm31qa.js","assets/conversation-small-lq38g8zw.css","assets/gy0y4tth3qg3lagh.js"])))=>i.map(i=>d[i]);
var Me=Object.defineProperty,be=Object.defineProperties;var Ee=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var oe=(a,e,s)=>e in a?Me(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,le=(a,e)=>{for(var s in e||(e={}))ve.call(e,s)&&oe(a,s,e[s]);if(re)for(var s of re(e))we.call(e,s)&&oe(a,s,e[s]);return a},ne=(a,e)=>be(a,Ee(e));import{c as ke,h as Oe,r as de,i as ce,e as je,j as i,M as me,_ as _e}from"./mw35uwhq4g8r9eam.js";import{u as Ne,p as Ce,be as Pe,aV as fe,R as Se,dr as Fe,bq as Le,aA as ue,aB as Ae}from"./d0xa318sl7ywi0za.js";import{eB as Be}from"./g2euln7v5pbm31qa.js";import{h as Ve}from"./o8prkdn1e023m13y.js";import{c as Re,m as o,b as Ie}from"./gy0y4tth3qg3lagh.js";import{I as qe}from"./pbx1h703pubtj7lo.js";import"./l4v2i2dq9gwjak1q.js";const n=je({title:{id:"settingsModal.addEmailOtp.title",defaultMessage:"Add email"},instruction:{id:"settingsModal.addEmailOtp.instruction",defaultMessage:"Enter the 6-digit code we just sent to {email}{lineBreak}to verify your mail."},codePlaceholder:{id:"settingsModal.addEmailOtp.codePlaceholder",defaultMessage:"Enter code"},resendPrompt:{id:"settingsModal.addEmailOtp.resendPrompt",defaultMessage:"Didn't get an email?"},resendLink:{id:"settingsModal.addEmailOtp.resendLink",defaultMessage:"Send again"},backLabel:{id:"settingsModal.addEmailOtp.back",defaultMessage:"Back"},verifyLabel:{id:"settingsModal.addEmailOtp.verify",defaultMessage:"Verify"},logoutWarning:{id:"settingsModal.addEmailOtp.logoutWarning",defaultMessage:"Verifying this email will sign you out on all devices so we can finish updating your account. You'll need to sign back in afterward."}}),We=Pe(()=>_e(()=>import("./hyjpdnpt9abd2xlf.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(a=>a.AddEmailModal));class ge extends Error{constructor(e){super(e),this.name="OtpValidationError"}}const ze=(a,e)=>e.length!==6||Number.isNaN(Number(e))?a.formatMessage(o.verifyOtpFailureInvalidFormat):null,De=(a,e,s)=>{switch(s.status){case 403:throw new Error(a.formatMessage(o.verifyOtpFailureEmailAlreadyLinked,{branch:e?"email":"other",emailValue:e}));case 429:throw new Error(a.formatMessage(o.verifyOtpFailureRateLimited));case 401:case 422:throw new Error(a.formatMessage(o.verifyOtpFailureInvalidOtp));default:return}};function Qe(a){"use forget";const e=ke.c(93),{onClose:s,email:r}=a,t=Oe(),Z=Ne(),ee=Ce(),[d,pe]=de.useState(""),[te,f]=de.useState(null);let u;e[0]!==r||e[1]!==t?(u=async()=>{try{await Re(r)}catch(l){const m=l;throw m instanceof fe&&Ve(t,r,m),new Error(t.formatMessage(o.sendEmailFailure))}},e[0]=r,e[1]=t,e[2]=u):u=e[2];let D,T;e[3]===Symbol.for("react.memo_cache_sentinel")?(D=()=>{f(null)},T=l=>{f(l.message)},e[3]=D,e[4]=T):(D=e[3],T=e[4]);let $;e[5]!==u?($={mutationFn:u,onSuccess:D,onError:T},e[5]=u,e[6]=$):$=e[6];const g=ce($);let p;e[7]!==d||e[8]!==r||e[9]!==t?(p=async()=>{const l=d.trim(),m=ze(t,l);if(m)throw new ge(m);try{await Ie(r,l)}catch(W){const z=W;throw z instanceof fe&&De(t,r,z),new Error(t.formatMessage(o.verifyOtpFailure))}try{const W={requestBody:{revoke_authapi_refresh_tokens:!0}};await Se.safePost("/accounts/logout_all",W)}catch(W){const z=W;throw z instanceof Error?new Error(t.formatMessage(o.verifyOtpFailure)):z}},e[7]=d,e[8]=r,e[9]=t,e[10]=p):p=e[10];let h;e[11]!==t||e[12]!==s||e[13]!==ee?(h=()=>{ee.success(t.formatMessage(o.verifyOtpSuccess)),s(),Fe()},e[11]=t,e[12]=s,e[13]=ee,e[14]=h):h=e[14];let x;e[15]!==t?(x=l=>{if(l instanceof ge){f(l.message);return}l instanceof Error?f(l.message):f(t.formatMessage(o.verifyOtpFailure))},e[15]=t,e[16]=x):x=e[16];let U;e[17]!==p||e[18]!==h||e[19]!==x?(U={mutationFn:p,onSuccess:h,onError:x},e[17]=p,e[18]=h,e[19]=x,e[20]=U):U=e[20];const c=ce(U);let Y;e[21]===Symbol.for("react.memo_cache_sentinel")?(Y=l=>{const m=l.target.value.replace(/\D/g,"").slice(0,6);f(null),pe(m)},e[21]=Y):Y=e[21];const he=Y;let G;e[22]!==Z||e[23]!==s?(G=()=>{s(),Le(Z,We)},e[22]=Z,e[23]=s,e[24]=G):G=e[24];const se=G;let H;e[25]===Symbol.for("react.memo_cache_sentinel")?(H={borderBottom:"1px solid var(--border-default, rgba(13, 13, 13, 0.10))"},e[25]=H):H=e[25];let y;e[26]!==t?(y=t.formatMessage(n.title),e[26]=t,e[27]=y):y=e[27];let M;e[28]!==y?(M=i.jsx("div",{className:"flex flex-col gap-1",children:i.jsx("span",{className:"text-token-text-primary text-[20px] leading-[25px] font-medium tracking-tight",children:y})}),e[28]=y,e[29]=M):M=e[29];let b;e[30]!==t?(b=t.formatMessage({id:"settingsModal.addEmailOtp.close",defaultMessage:"Close add email verification modal"}),e[30]=t,e[31]=b):b=e[31];let J;e[32]===Symbol.for("react.memo_cache_sentinel")?(J=i.jsx(Be,{className:"h-5 w-5"}),e[32]=J):J=e[32];let E;e[33]!==s||e[34]!==b?(E=i.jsx("button",{type:"button",onClick:s,"aria-label":b,className:"text-token-interactive-icon-tertiary-default flex h-5 w-5 items-center justify-center",children:J}),e[33]=s,e[34]=b,e[35]=E):E=e[35];let v;e[36]!==M||e[37]!==E?(v=i.jsx("div",{className:"border-b",style:H,children:i.jsxs("div",{className:"flex w-full items-start justify-between gap-4 px-6 py-6",children:[M,E]})}),e[36]=M,e[37]=E,e[38]=v):v=e[38];let K;e[39]===Symbol.for("react.memo_cache_sentinel")?(K=i.jsx("br",{}),e[39]=K):K=e[39];let w;e[40]!==r?(w=i.jsx("p",{className:"text-token-text-primary text-[14px] leading-5 font-medium",children:i.jsx(me,ne(le({},n.instruction),{values:{email:r,lineBreak:K}}))}),e[40]=r,e[41]=w):w=e[41];let Q;e[42]===Symbol.for("react.memo_cache_sentinel")?(Q=i.jsx("div",{className:"border-token-border-warning bg-token-background-warning text-token-text-warning rounded-lg border px-3 py-2 text-[13px] leading-4",children:i.jsx(me,le({},n.logoutWarning))}),e[42]=Q):Q=e[42];let k;e[43]!==t?(k=t.formatMessage({id:"settingsModal.addEmailOtp.codeAria",defaultMessage:"Verification code"}),e[43]=t,e[44]=k):k=e[44];let O;e[45]!==t?(O=t.formatMessage(n.codePlaceholder),e[45]=t,e[46]=O):O=e[46];const ae=te!=null?te:void 0;let j;e[47]!==d||e[48]!==k||e[49]!==O||e[50]!==ae?(j=i.jsx(qe,{ariaLabel:k,name:"verification_code",type:"text",value:d,onChange:he,placeholder:O,className:"w-[240px]",error:ae,autoComplete:"one-time-code",maxLength:6}),e[47]=d,e[48]=k,e[49]=O,e[50]=ae,e[51]=j):j=e[51];let _;e[52]!==t?(_=t.formatMessage(n.resendPrompt),e[52]=t,e[53]=_):_=e[53];let N;e[54]!==_?(N=i.jsxs("span",{children:[_," "]}),e[54]=_,e[55]=N):N=e[55];let C;e[56]!==g?(C=()=>g.mutate(),e[56]=g,e[57]=C):C=e[57];const xe=g.isPending;let P;e[58]!==t?(P=t.formatMessage(n.resendLink),e[58]=t,e[59]=P):P=e[59];let S;e[60]!==g.isPending||e[61]!==C||e[62]!==P?(S=i.jsx("button",{type:"button",className:"text-token-text-accent hover:underline",onClick:C,disabled:xe,children:P}),e[60]=g.isPending,e[61]=C,e[62]=P,e[63]=S):S=e[63];let F;e[64]!==N||e[65]!==S?(F=i.jsxs("div",{className:"text-light-primary text-[14px] leading-5 font-normal",children:[N,S]}),e[64]=N,e[65]=S,e[66]=F):F=e[66];let L;e[67]!==w||e[68]!==j||e[69]!==F?(L=i.jsxs("div",{className:"flex flex-col gap-4 px-6 py-6",children:[w,Q,j,F]}),e[67]=w,e[68]=j,e[69]=F,e[70]=L):L=e[70];let A;e[71]!==t?(A=t.formatMessage(n.backLabel),e[71]=t,e[72]=A):A=e[72];let B;e[73]!==se||e[74]!==A?(B=i.jsx(ue,{color:"secondary",size:"medium",className:"font-normal",type:"button",onClick:se,children:A}),e[73]=se,e[74]=A,e[75]=B):B=e[75];let V;e[76]!==c?(V=()=>c.mutate(),e[76]=c,e[77]=V):V=e[77];const ye=c.isPending,ie=c.isPending||d.length!==6;let R;e[78]!==t?(R=t.formatMessage(n.verifyLabel),e[78]=t,e[79]=R):R=e[79];let I;e[80]!==V||e[81]!==ie||e[82]!==R||e[83]!==c.isPending?(I=i.jsx(ue,{size:"medium",className:"font-normal",type:"button",onClick:V,loading:ye,disabled:ie,children:R}),e[80]=V,e[81]=ie,e[82]=R,e[83]=c.isPending,e[84]=I):I=e[84];let q;e[85]!==B||e[86]!==I?(q=i.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-6",children:[B,I]}),e[85]=B,e[86]=I,e[87]=q):q=e[87];let X;return e[88]!==s||e[89]!==v||e[90]!==L||e[91]!==q?(X=i.jsxs(Ae,{isOpen:!0,onClose:s,testId:"modal-add-email-otp",showCloseButton:!1,hasSeparator:!1,className:"border-token-border-light bg-token-bg-primary shadow-elevation-03 w-[432px] max-w-full rounded-2xl border",noPadding:!0,modalActionsClassName:"!mt-0",children:[v,L,q]}),e[88]=s,e[89]=v,e[90]=L,e[91]=q,e[92]=X):X=e[92],X}export{Qe as AddEmailOtpModal};
//# sourceMappingURL=onnwh17zhorffjwr.js.map

import{h as E,j as r,M as N,r as O,c as z}from"./mw35uwhq4g8r9eam.js";import{u as P,O as _,pQ as A,oD as H,pR as K,aB as G,aA as X,J as L,fK as q,f7 as V,fJ as W,cF as Y,M as Z,e4 as ee}from"./d0xa318sl7ywi0za.js";import{bx as te,by as se,bz as oe,cl as re,X as ne,aI as Q,aJ as ae}from"./g2euln7v5pbm31qa.js";import{g as ie}from"./fow8bkv2d2ka2w3o.js";import{P as le}from"./h1bi47sw480gxt9x.js";import"./nwl9s9haealsfe5d.js";import"./la79eh1q1qxrfcxi.js";import"./i693kfbch8smq86y.js";import"./gy1lpvuoewmzh42c.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./kbj1b07s2z6vxqkg.js";import"./hu1bt0oauegdhua6.js";import"./oj9zwxa6l3kpv1x2.js";import"./h4yh1661qhhbu5v5.js";import"./ktjtg3fnpomr03qk.js";import"./fkrqr6nqq2852orb.js";import"./exovct07932vem5e.js";import"./pvi9p0c51odp9xiw.js";import"./pe4e1ebqw6qlpge9.js";import"./ejv9rjzfbwh1dn9a.js";import"./ck4rwz4bvjdsyeld.js";function ce({product_id:m,product_title:e,product_url:t,onClose:y}){const u=P(),n=_(u),{data:o}=te(u,A.CommerceProduct),i=E(),a=se(u,i,m,A.CommerceProduct,K.Commerce,{[H.EntityName]:e,[H.EntityUrl]:t});if(o==null)return null;const l="Report ".concat((e==null?void 0:e.length)<=30?e:(e==null?void 0:e.substring(0,27))+"...");return n?r.jsx(oe,{reasons:o.reasons,submitReport:a,title:l,onClose:y,header:o.header,subHeader:o.header_explanation}):r.jsx(G,{testId:"modal-report-reason-selection",title:l,onClose:y,isOpen:!0,showCloseButton:!0,type:"success",primaryButton:r.jsx(X,{color:"primary",onClick:()=>{window.open("https://openai.com/form/report-content","_blank")},children:r.jsx(N,{id:"report.goToForm",defaultMessage:"Go to Form"})}),children:r.jsx("div",{className:"text-sm",children:r.jsx("div",{className:"mb-2",children:r.jsx(N,{id:"report.externalReportFormInstruction",defaultMessage:"Please use this form to report the issue."})})})})}function J({product_id:m,product_title:e,product_url:t,isCheckoutable:y,className:u}){const n=P(),o=E(),[i,a]=O.useState(!1),[l,c]=O.useState(!1);return L(n,"1961970013")&&y?r.jsxs(r.Fragment,{children:[r.jsx(q,{open:i,onOpenChange:d=>{a(d)},side:"bottom",contentAlign:"end",triggerButton:r.jsx(ne,{className:Y("keyboard-focused:focus-ring bg-token-main-surface-primary hover:bg-token-main-surface-secondary! pointer-events-auto me-2 h-8! w-8! rounded-full! opacity-80",u),"aria-label":o.formatMessage({id:"G4IkJB",defaultMessage:"Open product options"}),"data-testid":"product-options-button",icon:W}),size:"auto",children:r.jsx(V.Item,{icon:re,onClick:()=>{c(!0)},children:r.jsx(N,{id:"thread.reportProduct",defaultMessage:"Report"})})}),l&&r.jsx(ce,{product_id:m,product_title:e,product_url:t,onClose:()=>c(!1)})]}):null}function Ee(m){"use forget";const e=z.c(22),{conversation:t,sidebar:y,type:u}=m,{messageId:n,turnIndex:o,contentReferenceStartIndex:i,productIndex:a}=y,l=u===void 0?"sidebar":u,c=Z(t.id,de);let h;e[0]!==t.id||e[1]!==n||e[2]!==o?(h={clientThreadId:t.id,messageId:n,turnIndex:o},e[0]=t.id,e[1]=n,e[2]=o,e[3]=h):h=e[3];const d=h;let p;e[4]!==i||e[5]!==n||e[6]!==a||e[7]!==c?(p=ie({thread:c,messageId:n,contentReferenceStartIndex:i,productIndex:a}),e[4]=i,e[5]=n,e[6]=a,e[7]=c,e[8]=p):p=e[8];const{product:s}=p;if(!s)return null;let j;e[9]!==i||e[10]!==n||e[11]!==a?(j={messageId:n,contentReferenceStartIndex:i,productIndex:a},e[9]=i,e[10]=n,e[11]=a,e[12]=j):j=e[12];let x;e[13]!==t?(x=()=>Q(t),e[13]=t,e[14]=x):x=e[14];let R;return e[15]!==d||e[16]!==t.id||e[17]!==s||e[18]!==j||e[19]!==x||e[20]!==l?(R=r.jsx(U,{product:s,sidebar:j,clientThreadId:t.id,analyticsMetadata:d,handleCloseThreadSidebar:x,type:l}),e[15]=d,e[16]=t.id,e[17]=s,e[18]=j,e[19]=x,e[20]=l,e[21]=R):R=e[21],R}function de(m){return m}function ze(m){"use forget";const e=z.c(16),{conversation:t,sidebar:y,type:u}=m,{messageId:n,product:o,contentReferenceStartIndex:i,productIndex:a}=y,l=u===void 0?"sidebar":u;let c;e[0]!==t.id||e[1]!==n?(c={clientThreadId:t.id,messageId:n,turnIndex:0},e[0]=t.id,e[1]=n,e[2]=c):c=e[2];const h=c;if(!o)return null;let d;e[3]!==i||e[4]!==n||e[5]!==a?(d={messageId:n,contentReferenceStartIndex:i,productIndex:a},e[3]=i,e[4]=n,e[5]=a,e[6]=d):d=e[6];let p;e[7]!==t?(p=()=>Q(t),e[7]=t,e[8]=p):p=e[8];let s;return e[9]!==h||e[10]!==t.id||e[11]!==o||e[12]!==d||e[13]!==p||e[14]!==l?(s=r.jsx(U,{product:o,sidebar:d,clientThreadId:t.id,analyticsMetadata:h,handleCloseThreadSidebar:p,type:l}),e[9]=h,e[10]=t.id,e[11]=o,e[12]=d,e[13]=p,e[14]=l,e[15]=s):s=e[15],s}function U(m){"use forget";var D,$;const e=z.c(47),{product:t,sidebar:y,clientThreadId:u,analyticsMetadata:n,handleCloseThreadSidebar:o,type:i}=m,{messageId:a,contentReferenceStartIndex:l,productIndex:c}=y,h=i===void 0?"sidebar":i,d=P(),p=E(),[s,j]=O.useState(t);let x,R;e[0]!==t?(x=()=>{t&&j(t)},R=[t],e[0]=t,e[1]=x,e[2]=R):(x=e[1],R=e[2]),O.useEffect(x,R);let F;e[3]!==s?(F=s&&s.offers&&s.offers.some(ue),e[3]=s,e[4]=F):F=e[4];const I=F;if(!t)return null;const M="".concat(a,"-").concat(l,"-").concat(c),k=h==="sidebar";let T;e[5]!==n||e[6]!==u||e[7]!==l||e[8]!==a||e[9]!==t||e[10]!==c||e[11]!==k?(T=r.jsx(le,{product:t,setUpdatedProduct:j,clientThreadId:u,messageId:a,contentReferenceStartIndex:l,productIndex:c,analyticsMetadata:n,offsetTopMargin:k}),e[5]=n,e[6]=u,e[7]=l,e[8]=a,e[9]=t,e[10]=c,e[11]=k,e[12]=T):T=e[12];const S=T;let w;e[13]!==d?(w=L(d,"1961970013"),e[13]=d,e[14]=w):w=e[14];const C=w;switch(h){case"sidebar":{let g;e[15]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("div",{className:"flex grow"}),e[15]=g):g=e[15];let f;e[16]!==C||e[17]!==I||e[18]!==t||e[19]!==(s==null?void 0:s.url)?(f=C&&r.jsx(J,{product_id:t.id,product_title:t.title,product_url:(D=s==null?void 0:s.url)!=null?D:t.url,isCheckoutable:I!=null?I:!1}),e[16]=C,e[17]=I,e[18]=t,e[19]=s==null?void 0:s.url,e[20]=f):f=e[20];let b;e[21]!==f?(b=r.jsxs(r.Fragment,{children:[g,f]}),e[21]=f,e[22]=b):b=e[22];let v;e[23]!==p?(v=p.formatMessage({id:"region.sidebar.product",defaultMessage:"Product details"}),e[23]=p,e[24]=v):v=e[24];let B;return e[25]!==o||e[26]!==M||e[27]!==S||e[28]!==b||e[29]!==v?(B=r.jsx(ae,{handleClose:o,showScrollToBottomButton:!0,leading:b,leadingFullBleed:!0,ariaLabel:v,children:S},M),e[25]=o,e[26]=M,e[27]=S,e[28]=b,e[29]=v,e[30]=B):B=e[30],B}case"modal":{let g;e[31]!==C||e[32]!==I||e[33]!==t.id||e[34]!==t.title||e[35]!==t.url||e[36]!==(s==null?void 0:s.url)?(g=C&&r.jsx(J,{product_id:t.id,product_title:t.title,product_url:($=s==null?void 0:s.url)!=null?$:t.url,isCheckoutable:I!=null?I:!1,className:"absolute end-8.5 top-1.5 z-10"}),e[31]=C,e[32]=I,e[33]=t.id,e[34]=t.title,e[35]=t.url,e[36]=s==null?void 0:s.url,e[37]=g):g=e[37];let f;e[38]!==o?(f=r.jsx(ee,{className:"absolute end-2.5 top-2.5 z-10",onClick:o}),e[38]=o,e[39]=f):f=e[39];let b;return e[40]!==o||e[41]!==M||e[42]!==t.title||e[43]!==S||e[44]!==f||e[45]!==g?(b=r.jsxs(G,{testId:"modal-chat-screen-product-flyout",className:"relative max-w-md",size:"custom",type:"success",noPadding:!0,title:t.title,visuallyHiddenHeader:!0,isOpen:!0,onClose:o,rootClassName:"z-0",children:[S,g,f]},M),e[40]=o,e[41]=M,e[42]=t.title,e[43]=S,e[44]=f,e[45]=g,e[46]=b):b=e[46],b}}}function ue(m){return m.checkoutable}export{ze as ChatScreenAgentProductFlyout,Ee as ChatScreenProductFlyout,U as ProductFlyout};
//# sourceMappingURL=m7z1a21pqpuh0vyi.js.map

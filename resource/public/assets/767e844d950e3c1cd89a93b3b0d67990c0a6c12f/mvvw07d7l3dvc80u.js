var z=Object.freeze,K=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var H=(s,t,a)=>t in s?K(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,r=(s,t)=>{for(var a in t||(t={}))ae.call(t,a)&&H(s,a,t[a]);if(V)for(var a of V(t))oe.call(t,a)&&H(s,a,t[a]);return s},u=(s,t)=>te(s,se(t));var J=(s,t)=>z(K(s,"raw",{value:z(t||s.slice())}));import{h as X,r as C,u as re,j as e,M as d,e as ne,F as W}from"./mw35uwhq4g8r9eam.js";import{cv as ie,ez as de,eH as le,eI as I,eA as ue,eJ as Z,eK as G,eL as Q,bf as me,eM as ce,eN as pe,ev as ge,eO as Me}from"./g2euln7v5pbm31qa.js";import{u as fe,p as xe,aB as he,er as ye,eT as B,e7 as Se,pV as U,cB as je}from"./d0xa318sl7ywi0za.js";import{u as be,h as Y,i as Te,T as ee,g as Pe,D as Ne}from"./o9ssrpdrqeds60ju.js";import{B as ve}from"./keveoph4stiufpkl.js";import"./g6gtv3p57f0esi65.js";import"./dbnl40ahcmx1rqbw.js";import"./j723eutw6lfomm01.js";import"./gl4f6lge29au0ljx.js";import"./iio0zgk2sqlxbcjy.js";import"./obpubb7ugisfu36u.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./c340ncgh31fwqkpk.js";import"./of0vtq1gcmd3mc3z.js";import"./ggvjblnzoirafiyl.js";import"./kc32gem4l2t3hnxt.js";import"./5uqv5sdajcdsdc3v.js";import"./kne35xckmmfq3xx6.js";import"./kl0a548ohmz3fby2.js";import"./fe4yarxdk4eko5w6.js";import"./kubdgxu3crk3gqem.js";import"./jc1wlz3ym1r6tf2l.js";import"./dhyn0hpw8j3dzdrv.js";import"./kubovzlwgxdy8km7.js";import"./ffo9fz3385kae4ff.js";import"./tffc42bs0etu9v3l.js";import"./iej0cupg2dqkmejt.js";import"./oq8bsh1t4vyck4xl.js";import"./jds242fqj1w4n5ig.js";import"./fkjhta71fmme40r8.js";import"./icplq4r4g4m9zwmv.js";import"./eq347oxkmgs4si5r.js";import"./og1ftjb0zeoepdz3.js";import"./j29baj0apaw4vezi.js";import"./m3aipoogd94oudzg.js";import"./gb86rk5iguj309wb.js";import"./ee6pijsbu8dfevmi.js";import"./galyil7vygq0i5a6.js";import"./hwa6pbq6i57ntwuh.js";import"./mfq2eda4qxrcz3ws.js";import"./m9dg467qzmmahw21.js";import"./o4syhzyam6fzccjl.js";import"./e9wj7nd5g5h0l9yg.js";import"./o4m46p2hmbpmbw32.js";import"./lrkt6qiveter6omk.js";import"./ft9n9n4a6jtky5jr.js";import"./ht6uzt6gonugd1uu.js";import"./mn4kjdml8rch5m0h.js";import"./ksjc0uotmfxlch1n.js";import"./mdhx8v0rk5lzwfyg.js";import"./f6omfo4phchipc3g.js";import"./nte82mqftpddm52f.js";import"./3xa3aq3nbd1nd678.js";import"./jwvkjd19mng37ttq.js";import"./m2xec4gtk8ypy5ff.js";import"./jcku1nkz6suna4le.js";import"./mbe20fj6m6dgadji.js";import"./o8prkdn1e023m13y.js";import"./pbx1h703pubtj7lo.js";import"./l4v2i2dq9gwjak1q.js";import"./gy0y4tth3qg3lagh.js";import"./ku5gt2a8mwp30g8p.js";import"./eelq57udayslns33.js";var $;const De=je.p($||($=J(["text-base font-semibold mb-3 mt-3"]))),Qt=({onClose:s,initialTeamBillingType:t,initialSeats:a,accountId:m,renewalDate:y,billingDetails:g})=>{const M=fe(),f=X(),S=xe(),[l,o]=C.useState(a),[x,h]=C.useState(!1),[j,b]=C.useState(!1),i=re(),{data:c,isLoading:L,error:w}=ie({ctx:M,countryCode:g.country,currency:g.currency}),P=de(m),N=async({promoCampaign:q}={})=>{b(!0);try{await P.mutateAsync({accountId:m,updatedPriceInterval:void 0,updatedSeats:l,updatedPromoCampaign:q}),q===Q&&await i.invalidateQueries({queryKey:["promoCampaignEligibility",Q]}),b(!1),S.success(f.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),h(!1),s()}catch(Ee){S.warning(f.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{b(!1)}},F=()=>{h(!1),o(a),s()},{promoEligibility:T,seatsPromoContext:p}=be({seatsEntitled:a});if(L||w!=null||!c)return null;const{flexibleBillingPlan:R,annualBillingPlan:O}=le(g.currency,c),v=t===I.FLEXIBLE?R:O,E=Math.max(0,l-a),k=(p==null?void 0:p.type)==="seatsPromo"&&E>=p.seatThresholdGap,A=t===I.FLEXIBLE,D=A&&Y(T),_=A&&Te(T)&&(k||D);return e.jsx(he,{testId:"modal-teams-manage-seats",type:"success",isOpen:!0,onClose:F,size:"custom",noPadding:!0,className:"max-w-2xl",showCloseButton:!0,title:x?f.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):f.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:x?e.jsx(Fe,{numSeats:l,initialSeats:a,handleUpdate:N,isUpdating:j,renewalDate:y,accountId:m,selectedPlanBillingInfo:v,onClose:F,promoEligibility:T}):e.jsx(Ce,{selectedPlan:t,selectedPlanBillingInfo:v,numSeats:l,initialSeats:a,setNumSeats:o,renewalDate:y,setConfirmPage:h,billingDetails:g,promoContext:p,handleUpdate:N,isUpdating:j,promoEligibility:T,seatsPromoDiscountActive:_})})};function Ce({selectedPlan:s,selectedPlanBillingInfo:t,numSeats:a,initialSeats:m,setNumSeats:y,setConfirmPage:g,billingDetails:M,handleUpdate:f,isUpdating:S,renewalDate:l,promoContext:o,promoEligibility:x,seatsPromoDiscountActive:h}){var A;const j=X(),b=Se(),i=b==null?void 0:b.data.subscriptionStatus.discount,c=me(isNaN(a)?0:a,m,ce),L=Math.max(0,a-m),w=(o==null?void 0:o.type)==="seatsPromo"?Math.max(o.seatThresholdGap-L,0):0,P=(o==null?void 0:o.type)==="seatsPromo"&&typeof o.discountPercent=="number"?o.discountPercent:Z,N=h&&!i?Number((c*t.discountedMonthlyCost*(P/100)).toFixed(2)):void 0,F=(o==null?void 0:o.type)==="seatsPromo"&&o.seatThresholdGap>0,T=F&&w===0,p=(A=Pe(x))!=null?A:Ne,R=p===30,O=Y(x),v=C.useMemo(()=>{const D=s===I.ANNUAL?t.discountedMonthlyCost*12:t.monthlyCost;return(c||0)*D},[c,s,t.monthlyCost,t.discountedMonthlyCost]),E=C.useMemo(()=>i?i.discount_type===U.PERCENTAGE?Number((v*(i.amount/100)).toFixed(2)):i.discount_type===U.FIXED?Math.min(v,i.amount):0:0,[i,v]),k=C.useMemo(()=>{if(!i)return null;if(i.discount_type===U.PERCENTAGE)return e.jsx("div",{className:"rounded-lg bg-[#F2FBF4] px-4 py-3 text-sm text-[#24622B]",children:e.jsx(d,u(r({},n.percentDiscountInfo),{values:{percent:i.amount,months:i.duration_num_periods}}))});const D=t.monthlyCost,_=D>0?Math.floor(i.amount/D):0;return _<=0?null:e.jsx("div",{className:"rounded-lg border border-[#C5CEFF] bg-[#ECF0FF] px-4 py-3 text-sm text-[#262B72]",children:i.duration_num_periods===1?e.jsx(d,u(r({},n.fixedDiscountSeatsOneMonth),{values:{seats:_}})):e.jsx(d,u(r({},n.fixedDiscountSeatsManyMonths),{values:{seats:_,months:i.duration_num_periods}}))})},[i,t.monthlyCost]);return e.jsxs("div",{className:"grid grid-flow-row grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-4 p-5",children:[F&&e.jsx("div",{className:"rounded-lg border border-[#C5CEFF] bg-[#ECF0FF] px-4 py-3 text-sm text-[#262B72]",children:T?e.jsx(d,u(r({},n.seatsPromoQualified),{values:{seatCount:o.seatThresholdGap,promotionDuration:p,promotionDurationIsMonth:R?"true":"false",discountPercent:P}})):e.jsx(d,u(r({},n.seatsPromoReminder),{values:{remainingSeats:w,promotionDuration:p,promotionDurationIsMonth:R?"true":"false",discountPercent:P}}))}),e.jsx(pe,{numSeats:a,minSeats:m,setNumSeats:y}),e.jsx(ge,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:s,children:e.jsx(Me,u(r({billingType:s},t),{selectedValue:s}))})]}),e.jsxs("div",{className:"border-token-bg-tertiary bg-token-bg-elevated-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(De,{children:e.jsx(d,r({},G.summaryTitle))}),e.jsx(ve,{numSeats:c,selectedPlan:s,billingDetails:M,totalLabel:G.allPlansTotal,billDate:e.jsx(W,{value:l,year:"numeric",month:"long",day:"numeric"}),extraDiscountAmount:(N!=null?N:0)+(E!=null?E:0),footerNote:k||(h?e.jsx(d,r({},n.promoTaxesFeesDisclaimer)):void 0)}),O&&e.jsx("div",{className:"mt-3",children:e.jsx(ee,{promoEligibility:x,discountPercent:P})}),T?e.jsx(B,{title:j.formatMessage(n.addSeats),disabled:c===m,onClick:()=>f({promoCampaign:Q}),loading:S,className:"w-full rounded-xl",color:"primary"}):e.jsx(B,{title:j.formatMessage(n.continue),disabled:c===m,onClick:()=>g(!0),className:"w-full rounded-xl",color:"primary"})]})]})}function Fe({numSeats:s,initialSeats:t,renewalDate:a,handleUpdate:m,isUpdating:y,accountId:g,selectedPlanBillingInfo:M,onClose:f,promoEligibility:S}){const l=X(),{data:o,isError:x,isLoading:h}=ue(g,s),j=Y(S);if(h)return e.jsx("div",{className:"flex items-center justify-center py-32",children:e.jsx(ye,{})});if(!(x||!o))return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(d,u(r({},n.additionalSeats),{values:{additionalSeats:s-t}}))}),e.jsx("span",{className:"font-semibold",children:e.jsx(d,u(r({},n.additionalSeatsTotal),{values:{currencySign:l.formatMessage(M.currencySign),totalCost:(o.total_amount/100).toFixed(2)}}))})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(d,r({},n.proratedAmountMessage))}),e.jsx("span",{className:"bg-token-bg-secondary text-token-text-secondary mt-4 flex flex-col rounded-2xl p-4 text-sm",children:e.jsx(d,u(r({},n.chargeMessage),{values:{numSeats:s,date:e.jsx(W,{value:a,year:"numeric",month:"long",day:"numeric"})}}))}),j&&e.jsx("div",{className:"mt-4",children:e.jsx(ee,{promoEligibility:S,discountPercent:Z})}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(d,r({},n.subtotal))}),e.jsx("span",{children:e.jsx(d,u(r({},n.subtotalPrice),{values:{currencySign:l.formatMessage(M.currencySign),totalCost:(o.amount_excluding_tax/100).toFixed(2)}}))})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(d,r({},n.tax))}),e.jsx("span",{children:e.jsx(d,u(r({},n.taxAmount),{values:{currencySign:l.formatMessage(M.currencySign),tax:(o.tax_amount/100).toFixed(2)}}))})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(d,r({},n.totalDueToday))}),e.jsx("span",{className:"font-semibold",children:e.jsx(d,u(r({},n.totalDueTodayAmount),{values:{currencySign:l.formatMessage(M.currencySign),totalCost:(o.total_amount/100).toFixed(2)}}))})]}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(B,{title:l.formatMessage(G.cancel),color:"secondary",onClick:f,disabled:y}),e.jsx(B,{title:l.formatMessage(n.addSeats),color:"primary",onClick:m,loading:y})]})]})}const n=ne({continue:{id:"teamsManageSeatsModal.continue",defaultMessage:"Continue"},addSeats:{id:"teamsManageSeatsModal.addSeats",defaultMessage:"Add seats"},tax:{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax"},subtotal:{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal"},proratedAmountMessage:{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle"},chargeMessage:{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}"},additionalSeats:{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional {additionalSeats, plural, one {seat} other {seats}}"},additionalSeatsTotal:{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"{currencySign}{totalCost}"},subtotalPrice:{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}"},taxAmount:{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"{currencySign}{tax}"},totalDueToday:{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today"},totalDueTodayAmount:{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}"},seatsPromoReminder:{id:"teamsManageSeatsModal.seatsPromoReminder",defaultMessage:"Add {remainingSeats, plural, one {# more seat} other {# more seats}} to get {discountPercent}% off your plan for {promotionDurationIsMonth, select, true {1 month} other {{promotionDuration, plural, one {# day} other {# days}}}}."},seatsPromoQualified:{id:"teamsManageSeatsModal.seatsPromoQualified",defaultMessage:"You're all set! Purchasing {seatCount, plural, one {# seat} other {# seats}} gets you {discountPercent}% off your plan for {promotionDurationIsMonth, select, true {1 month} other {{promotionDuration, plural, one {# day} other {# days}}}}."},promoTaxesFeesDisclaimer:{id:"teamsManageSeatsModal.promoTaxesFeesDisclaimer",defaultMessage:"Plus any applicable taxes and fees."},percentDiscountInfo:{id:"teamsManageSeatsModal.percentDiscountInfo",defaultMessage:"{percent}% off entire workspace for {months, plural, one {# month} other {# months}}"},fixedDiscountSeatsOneMonth:{id:"teamsManageSeatsModal.fixedDiscountSeatsOneMonth",defaultMessage:"Up to {seats} {seats, plural, one {seat} other {seats}} free for 1 month"},fixedDiscountSeatsManyMonths:{id:"teamsManageSeatsModal.fixedDiscountSeatsManyMonths",defaultMessage:"Up to {seats} {seats, plural, one {seat} other {seats}} free for {months} months"}});export{Qt as TeamManageSeatsModal};
//# sourceMappingURL=mvvw07d7l3dvc80u.js.map

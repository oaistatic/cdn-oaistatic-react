var wt=Object.defineProperty,St=Object.defineProperties;var Ct=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;var pt=(s,e,i)=>e in s?wt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,B=(s,e)=>{for(var i in e||(e={}))gt.call(e,i)&&pt(s,i,e[i]);if(Ee)for(var i of Ee(e))ht.call(e,i)&&pt(s,i,e[i]);return s},Ne=(s,e)=>St(s,Ct(e));var vt=(s,e)=>{var i={};for(var a in s)gt.call(s,a)&&e.indexOf(a)<0&&(i[a]=s[a]);if(s!=null&&Ee)for(var a of Ee(s))e.indexOf(a)<0&&ht.call(s,a)&&(i[a]=s[a]);return i};import{c as O,h as L,j as t,M as T,r as qe,e as At,R as Pe,a as Et,d as $t,y as Dt,a9 as Ft}from"./mw35uwhq4g8r9eam.js";import{P as Rt,u as Tt,E as He}from"./glfvtve5gp6wwjag.js";import{aG as kt,bI as Lt,rT as It,rU as Vt}from"./g2euln7v5pbm31qa.js";import{S as G,A as Bt,f as bt,a as Gt,b as Ot,p as _t,c as yt,N as qt,g as Ht,F as Ut}from"./nrq8e0wm52nuufbv.js";import{cF as Se,p as Mt,R as zt,D as jt,aA as Kt,er as Wt,u as Qt,jr as Jt}from"./d0xa318sl7ywi0za.js";import{M as De}from"./i693kfbch8smq86y.js";import{r as Ue}from"./oj9zwxa6l3kpv1x2.js";import{A as Xt,p as Yt,P as Zt,D as ea,C as ta}from"./nxan4e3brpzak2la.js";import{Q as aa}from"./ldtpmsnzn9ens47o.js";import{g as Fe}from"./ee6pijsbu8dfevmi.js";import{m as sa,A as ia}from"./gjym1xeroi22t6az.js";import{S as ra}from"./nxlq8vgdi36rqmya.js";import{S as na}from"./ga8ujjebb15fm0bs.js";import{S as la}from"./ogkptvpwmh7lqh1e.js";import"./e9wj7nd5g5h0l9yg.js";import"./baz4b8nlf8t2lb95.js";import"./gy1lpvuoewmzh42c.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./kbj1b07s2z6vxqkg.js";import"./hu1bt0oauegdhua6.js";import"./h4yh1661qhhbu5v5.js";import"./i2f5gqqndy3iowkc.js";import"./ipoljkkwhes3fgxa.js";import"./jxdumrq8vfk5kk1c.js";import"./oftnd9rlobxeh2e2.js";import"./kx64af29hscb23w7.js";import"./brzhn6w36e0ait35.js";import"./lptwpbjabrvjmhsj.js";import"./gkerdwj307fj3n4u.js";import"./h9z1eo55yfy9l6t8.js";import"./k6k3ilbqdb73kxkm.js";import"./dxkl0433k1u8ypnz.js";import"./ox7635ffwodpca7w.js";import"./nr9k12yditsrjrdm.js";import"./eder15khh2fy5wd2.js";import"./krfycj1ruc6rihlj.js";import"./lgfmpb0my7e1aj31.js";import"./ohau9tqj1fpdibg0.js";import"./cv4afpu20gjb9dll.js";import"./kubdgxu3crk3gqem.js";import"./kne35xckmmfq3xx6.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./c340ncgh31fwqkpk.js";import"./of0vtq1gcmd3mc3z.js";import"./m9dg467qzmmahw21.js";import"./dbnl40ahcmx1rqbw.js";import"./j723eutw6lfomm01.js";import"./gl4f6lge29au0ljx.js";import"./iio0zgk2sqlxbcjy.js";import"./obpubb7ugisfu36u.js";import"./ggvjblnzoirafiyl.js";import"./kc32gem4l2t3hnxt.js";import"./5uqv5sdajcdsdc3v.js";import"./kl0a548ohmz3fby2.js";import"./fe4yarxdk4eko5w6.js";import"./jc1wlz3ym1r6tf2l.js";import"./dhyn0hpw8j3dzdrv.js";function oa(s){"use forget";var ze,Ke,We,Qe,Je,Xe,Ye,Ze,et,tt,at,st,it,rt,nt,lt,ot,ct,dt,mt,ft,xt,ut;const e=O.c(129),{finding:i}=s,a=L(),p=i.commit_analysis,m=p.attack_path_analysis;if(!m)return null;const{adjustment_decider:d,matrix_severity:k,policy_adjusted_criticality:y,adjusted_criticality_final:j,adjustment_reason:g,likelihood:n,impact:v,assumptions:x,attack_path:l,evidence:h,narrative:o,controls:c,blindspots:u,identity:f,facts:r}=m,b=j||p.attack_path_final_criticality||m.severity||m.original_severity||"unknown",A=d||"—",E=k||"—",D=y||"—",M=v&&(v.level||v.why)?"".concat((ze=v.level)!=null?ze:"unknown").concat(v.why?" — ".concat(v.why):""):"—",N=n&&(n.level||n.why)?"".concat((Ke=n.level)!=null?Ke:"unknown").concat(n.why?" — ".concat(n.why):""):"—",F=!!(l!=null&&l.entry)||!!(l!=null&&l.pivot)||!!(l!=null&&l.impact)||!!(l!=null&&l.ascii);let $;e[0]!==x?($=x!=null?x:[],e[0]=x,e[1]=$):$=e[1];let _;e[2]!==((We=r==null?void 0:r.precondition)==null?void 0:We.requires)?(_=(Je=(Qe=r==null?void 0:r.precondition)==null?void 0:Qe.requires)!=null?Je:[],e[2]=(Xe=r==null?void 0:r.precondition)==null?void 0:Xe.requires,e[3]=_):_=e[3];let P;e[4]!==$||e[5]!==_?(P=[...$,..._],e[4]=$,e[5]=_,e[6]=P):P=e[6];const S=P,C=h&&h.length>0,R=c&&c.length>0,I=u&&u.length>0;let q;e[7]!==o?(q=o&&o.trim().length>0,e[7]=o,e[8]=q):q=e[8];const we=!!q,H=(Ye=r==null?void 0:r.category)!=null?Ye:"—",Re=(et=(Ze=r==null?void 0:r.vector)==null?void 0:Ze.network_scope)!=null?et:"unknown",Te=(at=(tt=r==null?void 0:r.scope)==null?void 0:tt.auth)!=null?at:"unknown",Le=(it=(st=r==null?void 0:r.precondition)==null?void 0:st.achievability)!=null?it:"unknown",Ie=(nt=(rt=r==null?void 0:r.input)==null?void 0:rt.attacker_controlled)!=null?nt:"unknown",Ve=(ot=(lt=r==null?void 0:r.evidence)==null?void 0:lt.poc)!=null?ot:"unknown",Be=(dt=(ct=r==null?void 0:r.target)==null?void 0:ct.reach)!=null?dt:"unknown",Ce=(ft=(mt=r==null?void 0:r.cross_boundary)==null?void 0:mt.description)!=null?ft:"",Ge=((xt=r==null?void 0:r.cross_boundary)==null?void 0:xt.verified)===!0?"verified":((ut=r==null?void 0:r.cross_boundary)==null?void 0:ut.verified)===!1?"unverified":"unknown";let U;e[9]!==a?(U=a.formatMessage({id:"aardvark.attackPath.title",defaultMessage:"Attack-path analysis"}),e[9]=a,e[10]=U):U=e[10];let z;e[11]!==a?(z=a.formatMessage({id:"aardvark.attackPath.policyDecision",defaultMessage:"Policy decision"}),e[11]=a,e[12]=z):z=e[12];let K;e[13]!==z?(K=t.jsx("h3",{className:"text-token-text-secondary mb-3 text-xs font-semibold tracking-wide uppercase",children:z}),e[13]=z,e[14]=K):K=e[14];let W;e[15]!==a?(W=a.formatMessage({id:"aardvark.attackPath.decider",defaultMessage:"Decider"}),e[15]=a,e[16]=W):W=e[16];let Q;e[17]!==A||e[18]!==W?(Q=t.jsx(w,{label:W,value:A}),e[17]=A,e[18]=W,e[19]=Q):Q=e[19];let J;e[20]!==a?(J=a.formatMessage({id:"aardvark.attackPath.matrixSeverity",defaultMessage:"Matrix severity"}),e[20]=a,e[21]=J):J=e[21];let X;e[22]!==E||e[23]!==J?(X=t.jsx(w,{label:J,value:E}),e[22]=E,e[23]=J,e[24]=X):X=e[24];let Y;e[25]!==a?(Y=a.formatMessage({id:"aardvark.attackPath.policyAdjusted",defaultMessage:"Policy adjusted"}),e[25]=a,e[26]=Y):Y=e[26];let Z;e[27]!==D||e[28]!==Y?(Z=t.jsx(w,{label:Y,value:D}),e[27]=D,e[28]=Y,e[29]=Z):Z=e[29];let ee;e[30]!==a?(ee=a.formatMessage({id:"aardvark.attackPath.finalVerdict",defaultMessage:"Final verdict"}),e[30]=a,e[31]=ee):ee=e[31];let te;e[32]!==b||e[33]!==ee?(te=t.jsx(w,{label:ee,value:b}),e[32]=b,e[33]=ee,e[34]=te):te=e[34];let ae;e[35]!==X||e[36]!==Z||e[37]!==te||e[38]!==Q?(ae=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[Q,X,Z,te]}),e[35]=X,e[36]=Z,e[37]=te,e[38]=Q,e[39]=ae):ae=e[39];let se;e[40]!==g||e[41]!==a?(se=g&&t.jsx("p",{className:"text-token-text-secondary mt-3 text-xs md:text-sm",children:t.jsx("span",{className:"font-semibold",children:a.formatMessage({id:"aardvark.attackPath.adjustmentRationale",defaultMessage:"Adjustment rationale: {rationale}"},{rationale:g})})}),e[40]=g,e[41]=a,e[42]=se):se=e[42];let ie;e[43]!==ae||e[44]!==se||e[45]!==K?(ie=t.jsxs("div",{children:[K,ae,se]}),e[43]=ae,e[44]=se,e[45]=K,e[46]=ie):ie=e[46];let re;e[47]!==a?(re=a.formatMessage({id:"aardvark.attackPath.decisionReasoning",defaultMessage:"Decision reasoning"}),e[47]=a,e[48]=re):re=e[48];let ne;e[49]!==re?(ne=t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:re}),e[49]=re,e[50]=ne):ne=e[50];let le;e[51]!==a?(le=a.formatMessage({id:"aardvark.attackPath.decisionReasoning.finalVerdict",defaultMessage:"Final verdict"}),e[51]=a,e[52]=le):le=e[52];const Oe=b==="—"?"—":"".concat(b).concat(A!=="—"?" (decider: ".concat(A,")"):"");let oe;e[53]!==le||e[54]!==Oe?(oe=t.jsx(w,{label:le,value:Oe}),e[53]=le,e[54]=Oe,e[55]=oe):oe=e[55];let ce;e[56]!==a?(ce=a.formatMessage({id:"aardvark.attackPath.impact",defaultMessage:"Impact"}),e[56]=a,e[57]=ce):ce=e[57];let de;e[58]!==M||e[59]!==ce?(de=t.jsx(w,{label:ce,value:M}),e[58]=M,e[59]=ce,e[60]=de):de=e[60];let me;e[61]!==a?(me=a.formatMessage({id:"aardvark.attackPath.likelihood",defaultMessage:"Likelihood"}),e[61]=a,e[62]=me):me=e[62];let fe;e[63]!==N||e[64]!==me?(fe=t.jsx(w,{label:me,value:N}),e[63]=N,e[64]=me,e[65]=fe):fe=e[65];let xe;e[66]!==oe||e[67]!==de||e[68]!==fe?(xe=t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[oe,de,fe]}),e[66]=oe,e[67]=de,e[68]=fe,e[69]=xe):xe=e[69];let ue;e[70]!==S||e[71]!==a?(ue=S.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"text-token-text-tertiary mb-1 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.keyAssumptions",defaultMessage:"Key assumptions"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:S.map(fa)})]}),e[70]=S,e[71]=a,e[72]=ue):ue=e[72];let pe;e[73]!==ne||e[74]!==xe||e[75]!==ue?(pe=t.jsxs("div",{children:[ne,xe,ue]}),e[73]=ne,e[74]=xe,e[75]=ue,e[76]=pe):pe=e[76];let ge;e[77]!==l||e[78]!==F||e[79]!==a?(ge=F&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.attackPath",defaultMessage:"Attack path"})}),t.jsxs("div",{className:"space-y-2",children:[(l==null?void 0:l.entry)&&t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.entry",defaultMessage:"Entry"}),value:l.entry}),(l==null?void 0:l.pivot)&&t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.pivot",defaultMessage:"Pivot"}),value:l.pivot}),(l==null?void 0:l.impact)&&t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.impactNode",defaultMessage:"Impact"}),value:l.impact}),(l==null?void 0:l.ascii)&&l.ascii.trim().length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"text-token-text-tertiary mb-1 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.diagram",defaultMessage:"Diagram"})}),t.jsx("pre",{className:"bg-token-main-surface-primary/40 text-token-text-secondary rounded-md p-3 font-mono text-xs whitespace-pre-wrap",children:l.ascii})]})]})]}),e[77]=l,e[78]=F,e[79]=a,e[80]=ge):ge=e[80];let he;e[81]!==S||e[82]!==a?(he=S.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.assumptions",defaultMessage:"Assumptions"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:S.map(ma)})]}),e[81]=S,e[82]=a,e[83]=he):he=e[83];let ve;e[84]!==h||e[85]!==C||e[86]!==a?(ve=C&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.evidence",defaultMessage:"Evidence"})}),t.jsx("ul",{className:"space-y-2",children:h.map((V,Pt)=>t.jsxs("li",{className:"bg-token-main-surface-primary/40 rounded-md p-2",children:[t.jsx("div",{className:"text-token-text-tertiary font-mono text-xs break-all",children:a.formatMessage({id:"aardvark.attackPath.evidence.location",defaultMessage:"{file}:{start}-{end}"},{file:V.file,start:V.line_start,end:V.line_end})}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:V.why})]},"".concat(V.file,":").concat(V.line_start,"-").concat(V.line_end,"-").concat(Pt)))})]}),e[84]=h,e[85]=C,e[86]=a,e[87]=ve):ve=e[87];let ke;e[88]!==we||e[89]!==a||e[90]!==o?(ke=we&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.narrative",defaultMessage:"Narrative"})}),t.jsx("div",{className:Se("prose prose-sm text-token-text-secondary max-w-none text-sm","prose-p:my-1 prose-ul:my-1 prose-ol:my-1"),children:t.jsx(De,{remarkPlugins:[Ue],children:o})})]}),e[88]=we,e[89]=a,e[90]=o,e[91]=ke):ke=e[91];let ye;e[92]!==c||e[93]!==R||e[94]!==a?(ye=R&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.controls",defaultMessage:"Controls"})}),t.jsx("ul",{className:"flex flex-wrap gap-2",children:c.map(da)})]}),e[92]=c,e[93]=R,e[94]=a,e[95]=ye):ye=e[95];let je;e[96]!==u||e[97]!==I||e[98]!==a?(je=I&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.blindspots",defaultMessage:"Residual risks / blind spots"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:u.map(ca)})]}),e[96]=u,e[97]=I,e[98]=a,e[99]=je):je=e[99];let be;e[100]!==f||e[101]!==a?(be=((f==null?void 0:f.service_account)||(f==null?void 0:f.managed_identity)||(f==null?void 0:f.privileges)&&f.privileges.length>0)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.identity",defaultMessage:"Identity"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.identity.serviceAccount",defaultMessage:"Service account"}),value:(f==null?void 0:f.service_account)||"—"}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.identity.managedIdentity",defaultMessage:"Managed identity"}),value:(f==null?void 0:f.managed_identity)||"—"}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.identity.privileges",defaultMessage:"Privileges"}),value:f!=null&&f.privileges&&f.privileges.length>0?f.privileges.join(", "):"—"})]})]}),e[100]=f,e[101]=a,e[102]=be):be=e[102];let _e;e[103]!==r||e[104]!==H||e[105]!==Ce||e[106]!==Ge||e[107]!==Ve||e[108]!==Ie||e[109]!==Le||e[110]!==Te||e[111]!==Be||e[112]!==Re||e[113]!==a?(_e=r&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.facts",defaultMessage:"Facts (context / rules)"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.category",defaultMessage:"Category"}),value:H}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.vector",defaultMessage:"Vector"}),value:Re}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.scope",defaultMessage:"Scope"}),value:Te}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.precondition",defaultMessage:"Precondition achievability"}),value:Le}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.input",defaultMessage:"Attacker control"}),value:Ie}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.evidenceType",defaultMessage:"Evidence type"}),value:Ve}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.targetReach",defaultMessage:"Target reach"}),value:Be}),t.jsx(w,{label:a.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryVerified",defaultMessage:"Cross-boundary"}),value:Ge})]}),Ce&&t.jsxs("div",{className:"text-token-text-secondary mt-2 text-sm",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:a.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryDescription",defaultMessage:"Cross-boundary path:"})}),t.jsx("div",{children:a.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryDescription.body",defaultMessage:"{description}"},{description:Ce})})]})]}),e[103]=r,e[104]=H,e[105]=Ce,e[106]=Ge,e[107]=Ve,e[108]=Ie,e[109]=Le,e[110]=Te,e[111]=Be,e[112]=Re,e[113]=a,e[114]=_e):_e=e[114];let Me;e[115]!==ie||e[116]!==pe||e[117]!==ge||e[118]!==he||e[119]!==ve||e[120]!==ke||e[121]!==ye||e[122]!==je||e[123]!==be||e[124]!==_e?(Me=t.jsxs("div",{className:"flex flex-col gap-6 text-sm leading-6",children:[ie,pe,ge,he,ve,ke,ye,je,be,_e]}),e[115]=ie,e[116]=pe,e[117]=ge,e[118]=he,e[119]=ve,e[120]=ke,e[121]=ye,e[122]=je,e[123]=be,e[124]=_e,e[125]=Me):Me=e[125];let Ae;return e[126]!==Me||e[127]!==U?(Ae=t.jsx(G,{title:U,children:Me}),e[126]=Me,e[127]=U,e[128]=Ae):Ae=e[128],Ae}function ca(s,e){return t.jsx("li",{className:"text-token-text-secondary",children:s},e)}function da(s,e){return t.jsx("li",{className:"bg-token-main-surface-primary/60 text-token-text-secondary rounded-full px-3 py-1 text-xs",children:s},"".concat(s,"-").concat(e))}function ma(s,e){return t.jsx("li",{className:"text-token-text-secondary",children:s},e)}function fa(s,e){return t.jsx("li",{className:"text-token-text-secondary",children:s},e)}function w({label:s,value:e}){const a=L().formatMessage({id:"aardvark.attackPath.placeholder",defaultMessage:"—"});return t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:s}),t.jsx("div",{className:"text-token-text-primary text-sm",children:e!=null?e:a})]})}const xa={pending:"muted",running:"warning",failed:"danger",success:"success",unknown:"muted"},ua=s=>s.status=="created"?"pending":s.status=="patch_generation_running"?"running":s.status=="patch_generation_failed"?"failed":s.patch_generation_success?"success":"unknown",pa=s=>s.status=="created"?"pending":s.status=="awaiting_validation"?"running":s.status=="failed_validation"?"failed":s.status=="validated"?"success":"unknown";function Nt(s){"use forget";const e=O.c(9),{task:i,mode:a}=s,p=L();let m;e[0]!==a||e[1]!==i?(m=a=="generation"?ua(i):pa(i),e[0]=a,e[1]=i,e[2]=m):m=e[2];const d=m,k=xa[d];let y;e[3]!==p||e[4]!==d?(y=p.formatMessage(Rt[d]),e[3]=p,e[4]=d,e[5]=y):y=e[5];const j=y;let g;return e[6]!==j||e[7]!==k?(g=t.jsx(Bt,{variant:k,children:j}),e[6]=j,e[7]=k,e[8]=g):g=e[8],g}function ga(s){"use forget";var E,D;const e=O.c(34),{latestTask:i,turn:a,formatStepTime:p}=s,m=i==null?void 0:i.patch_generation_submitted_at,d=(D=(E=a==null?void 0:a.latest_event)==null?void 0:E.created)!=null?D:null;let k;if(e[0]!==a){const M=a&&Array.isArray(a.output_items)?bt(Fe(a,"output_items",[]),ya):[],N=sa(M,va);k=a?Ne(B({},a),{output_items:[...N]}):null,e[0]=a,e[1]=k}else k=e[1];const y=k;let j;e[2]!==p||e[3]!==m?(j=m?p(m):null,e[2]=p,e[3]=m,e[4]=j):j=e[4];const g=j;let n;e[5]!==p||e[6]!==d?(n=d?p(d):null,e[5]=p,e[6]=d,e[7]=n):n=e[7];const v=n;let x;if(e[8]!==v||e[9]!==g){if(x=[],g){let M;e[11]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.startedLabel",defaultMessage:"Started"}),e[11]=M):M=e[11];let N;e[12]!==g?(N={key:"started",label:M,value:g},e[12]=g,e[13]=N):N=e[13],x.push(N)}if(v){let M;e[14]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.finishedLabel",defaultMessage:"Completed"}),e[14]=M):M=e[14];let N;e[15]!==v?(N={key:"finished",label:M,value:v},e[15]=v,e[16]=N):N=e[16],x.push(N)}e[8]=v,e[9]=g,e[10]=x}else x=e[10];let l;e[17]!==a?(l=a?aa(a):"",e[17]=a,e[18]=l):l=e[18];const h=l;let o,c;e[19]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.title",defaultMessage:"Patch generation"})}),c=Se("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[19]=o,e[20]=c):(o=e[19],c=e[20]);let u;e[21]!==x?(u=x.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:x.map(ha)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.noTiming",defaultMessage:"Timing details will appear once generation starts."})}),e[21]=x,e[22]=u):u=e[22];let f;e[23]!==i?(f=i&&t.jsx("div",{className:"sm:ms-4 sm:flex sm:min-w-[120px] sm:justify-end",children:t.jsx(Nt,{task:i,mode:"generation"})}),e[23]=i,e[24]=f):f=e[24];let r;e[25]!==u||e[26]!==f?(r=t.jsxs("div",{className:c,children:[u,f]}),e[25]=u,e[26]=f,e[27]=r):r=e[27];let b;e[28]!==h||e[29]!==y?(b=y&&t.jsx(Xt,{assistantTurn:y,outputText:h,className:"text-token-text-secondary text-sm leading-6"}),e[28]=h,e[29]=y,e[30]=b):b=e[30];let A;return e[31]!==b||e[32]!==r?(A=t.jsxs(t.Fragment,{children:[o,r,b]}),e[31]=b,e[32]=r,e[33]=A):A=e[33],A}function ha(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function va(s){return Ne(B({},s),{content:bt(Fe(s,"content",[]),ka)})}function ka(s){return Fe(s,"content_type")==="text"}function ya(s){return Fe(s,"type")==="message"}function ja(s){"use forget";var f;const e=O.c(29),{latestTask:i,formatStepTime:a}=s,p=i==null?void 0:i.fix_checker_started_at,m=i==null?void 0:i.fix_checker_finished_at,d=(f=i==null?void 0:i.fix_checker_rubric)!=null?f:"";let k;e[0]!==a||e[1]!==p?(k=p?a(p):null,e[0]=a,e[1]=p,e[2]=k):k=e[2];const y=k;let j;e[3]!==a||e[4]!==m?(j=m?a(m):null,e[3]=a,e[4]=m,e[5]=j):j=e[5];const g=j;let n;if(e[6]!==g||e[7]!==y){if(n=[],y){let r;e[9]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.startedLabel",defaultMessage:"Started"}),e[9]=r):r=e[9];let b;e[10]!==y?(b={key:"started",label:r,value:y},e[10]=y,e[11]=b):b=e[11],n.push(b)}if(g){let r;e[12]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.finishedLabel",defaultMessage:"Completed"}),e[12]=r):r=e[12];let b;e[13]!==g?(b={key:"finished",label:r,value:g},e[13]=g,e[14]=b):b=e[14],n.push(b)}e[6]=g,e[7]=y,e[8]=n}else n=e[8];let v,x;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("div",{className:"text-token-text-tertiary mt-4 text-xs font-semibold tracking-wide uppercase",children:t.jsx("span",{children:t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.title",defaultMessage:"Patch validation"})})}),x=Se("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[15]=v,e[16]=x):(v=e[15],x=e[16]);let l;e[17]!==n?(l=n.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:n.map(ba)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.noTiming",defaultMessage:"Validation timeline will populate once checks begin."})}),e[17]=n,e[18]=l):l=e[18];let h;e[19]!==i?(h=t.jsx(Nt,{task:i,mode:"validation"}),e[19]=i,e[20]=h):h=e[20];let o;e[21]!==l||e[22]!==h?(o=t.jsxs("div",{className:x,children:[l,h]}),e[21]=l,e[22]=h,e[23]=o):o=e[23];let c;e[24]!==d?(c=d&&t.jsx("div",{className:"prose prose-sm text-token-text-secondary mb-4 max-w-none",children:t.jsx(De,{children:d})}),e[24]=d,e[25]=c):c=e[25];let u;return e[26]!==o||e[27]!==c?(u=t.jsxs(t.Fragment,{children:[v,o,c]}),e[26]=o,e[27]=c,e[28]=u):u=e[28],u}function ba(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function _a(s){return typeof s!="object"||s==null||!("role"in s)||!("output_items"in s)?!1:s.role==="assistant"&&Array.isArray(s.output_items)}function Ma(s){"use forget";const e=O.c(44),{proposed_patch:i,findingId:a,refetchFinding:p}=s,m=L(),d=Mt(),[k,y]=qe.useState(!1),[j,g]=qe.useState(!1),n=i==null?void 0:i.latest_task;if(!i||!n)return null;const v=n.codex_task_turn,x=_a(v==null?void 0:v.turn)?v.turn:null;let l;if(e[0]!==x||e[1]!==a||e[2]!==m||e[3]!==j||e[4]!==n||e[5]!==(i==null?void 0:i.id)||e[6]!==p||e[7]!==d||e[8]!==k){const h=x?Yt({assistantTurn:x}):[],o=h.map(wa).join("\n\n"),c=async()=>{try{await kt(o,d),d.successNeutral(m.formatMessage($e.copyPatchSuccess),{duration:5,hasCloseButton:!0})}catch(_){}};let u;e[10]!==o||e[11]!==m||e[12]!==d?(u=async()=>{try{await kt("git apply - <<PATCH\n"+o+"\nPATCH",d),d.successNeutral(m.formatMessage($e.copyApplySuccess),{duration:5,hasCloseButton:!0})}catch(_){}},e[10]=o,e[11]=m,e[12]=d,e[13]=u):u=e[13];const f=u;let r;e[14]!==a||e[15]!==m||e[16]!==j||e[17]!==n.codex_task_id||e[18]!==n.codex_task_turn_id||e[19]!==p||e[20]!==d?(r=async _=>{if(!(n!=null&&n.codex_task_id)||!(n!=null&&n.codex_task_turn_id)||!a||j)return;g(!0);const P={parameters:{path:{id:a}},requestBody:{}};_!==void 0&&(P.requestBody.mode=_);try{if(await zt.safePost("/aardvark/scan-findings/{id}/pr",P),p)try{await p()}catch(S){const C=S;let R;C instanceof Error?R=C.message:R=String(C),jt.addError("aardvark.proposedPatch.refetchFindingError",{findingId:a,message:R})}d.successNeutral(m.formatMessage($e.createPrSuccess),{duration:3,hasCloseButton:!0})}catch(S){const C=S;jt.addError("aardvark.proposedPatch.createPrError",{findingId:a,taskId:n.codex_task_id,taskTurnId:n.codex_task_turn_id,mode:_!=null?_:null,message:C instanceof Error?C.message:String(C)}),d.danger(m.formatMessage($e.createPrError),{duration:3,hasCloseButton:!0}),g(!1);return}g(!1)},e[14]=a,e[15]=m,e[16]=j,e[17]=n.codex_task_id,e[18]=n.codex_task_turn_id,e[19]=p,e[20]=d,e[21]=r):r=e[21];const b=r,A=!!(n!=null&&n.codex_task_id)&&!!(n!=null&&n.codex_task_turn_id)&&!!a;let E;e[22]===Symbol.for("react.memo_cache_sentinel")?(E=function(P){return P?typeof P=="string"?Gt(P):Ot(P):null},e[22]=E):E=e[22];const D=E;let M;e[23]!==m?(M=m.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[23]=m,e[24]=M):M=e[24];let N;e[25]!==x||e[26]!==n?(N=t.jsx(ga,{latestTask:n,turn:x,formatStepTime:D}),e[25]=x,e[26]=n,e[27]=N):N=e[27];let F;e[28]!==n?(F=t.jsx(ja,{latestTask:n,formatStepTime:D}),e[28]=n,e[29]=F):F=e[29];let $;if(h.length>0){let _;e[30]!==k?(_=t.jsx(ea,{unifiedDiff:k,setUnifiedDiff:y,showFullDiff:!1,setShowFullDiff:Pa}),e[30]=k,e[31]=_):_=e[31];const P=t.jsxs("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[_,t.jsx(Zt,{copyApplyToClipboard:f,copyPatchToClipboard:c,createPr:b,navigateToCreatingPrPage:Na,updateBranch:void 0,canCreatePr:A,isCreatingPr:j,permissions:"write",assistantTurn:x,showOnlyViewPr:!1})]});let S;e[32]!==P?(S=t.jsx("div",{className:"mb-2 flex w-full flex-col gap-2",children:P}),e[32]=P,e[33]=S):S=e[33];let C;e[34]!==(i==null?void 0:i.id)||e[35]!==k?(C=(q,we)=>{var H;return t.jsx(ta,{diff:q,viewType:k?"unified":"split",stickyHeader:!1},"".concat((H=i==null?void 0:i.id)!=null?H:"diff","-canonical-").concat(we))},e[34]=i==null?void 0:i.id,e[35]=k,e[36]=C):C=e[36];const R=t.jsx("div",{className:"flex flex-col gap-4",children:h.map(C)});let I;e[37]!==S||e[38]!==R?(I=t.jsxs(t.Fragment,{children:[S,R]}),e[37]=S,e[38]=R,e[39]=I):I=e[39],$=I}else if((n==null?void 0:n.patch_generation_success)===!0){let _;e[40]!==m?(_=m.formatMessage({id:"aardvark.proposedPatch.noDiffsInHead",defaultMessage:"No diffs, this usually means the issue no longer exists in HEAD."}),e[40]=m,e[41]=_):_=e[41];let P;e[42]!==_?(P=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:_}),e[42]=_,e[43]=P):P=e[43],$=P}else $=null;l=t.jsxs(G,{title:M,children:[N,F,$]}),e[0]=x,e[1]=a,e[2]=m,e[3]=j,e[4]=n,e[5]=i==null?void 0:i.id,e[6]=p,e[7]=d,e[8]=k,e[9]=l}else l=e[9];return l}function Na(){}function Pa(){}function wa(s){var e;return(e=s.hunksText)!=null?e:""}const $e=At({createPrSuccess:{id:"aardvark.proposedPatch.createPrSuccess",defaultMessage:"Pull request created"},createPrError:{id:"aardvark.proposedPatch.createPrErrorToast",defaultMessage:"Failed to create pull request"},copyPatchSuccess:{id:"aardvark.proposedPatch.copyPatchSuccess",defaultMessage:"Patch copied"},copyApplySuccess:{id:"aardvark.proposedPatch.copyApplySuccess",defaultMessage:"Command copied"}});function Sa({content:s,start:e,className:i=""}){const a=Pe.useMemo(()=>s.trimEnd().split("\n"),[s]),p=typeof e=="number"?e:1;return t.jsx("div",{className:"bg-token-bg-elevated-secondary overflow-auto rounded ".concat(i),style:{maxHeight:400},children:t.jsx("table",{className:"w-full border-separate border-spacing-0",children:t.jsx("tbody",{children:a.map((m,d)=>t.jsxs("tr",{className:"align-top",children:[t.jsx("td",{className:"text-token-text-tertiary py-0.5 ps-3 pe-3 text-end align-top text-[11px] whitespace-nowrap select-none",children:p+d}),t.jsx("td",{className:"py-0.5 pe-3 font-mono text-sm whitespace-pre",children:m===""?" ":m})]},d))})})})}function Ca({finding:s}){var k,y,j,g;const e=L();let i=(y=(k=s.commit_analysis)==null?void 0:k.relevant_lines)!=null?y:[],a=Array.isArray(i)&&i.length>0;const p=(j=s.commit_analysis)==null?void 0:j.proposed_patch,m=typeof p=="string"&&p.trim().length>0;if(!a){const n=_t(p);i=(g=n==null?void 0:n.relevant_lines)!=null?g:[],a=Array.isArray(i)&&i.length>0}if(!a){if(m)return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.detailsTitle",defaultMessage:"Details"}),children:t.jsx("div",{className:"p-2",children:p})});if(!m)return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.evidence",defaultMessage:"Evidence"}),children:t.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.formatMessage({id:"aardvark.findings.noEvidence",defaultMessage:"No evidence available."})})})}const d=(()=>{var v,x,l,h;const n=new Map;for(const o of i){const c=o.path||(o==null?void 0:o.file_path)||"(unknown)",u=(v=o.start_line_number)!=null?v:0,f=(l=(x=o.end_line_number)!=null?x:o.start_line_number)!=null?l:0,r="".concat(c,"|").concat(u,"-").concat(f),b=(h=n.get(r))!=null?h:[];b.push(o),n.set(r,b)}return Array.from(n.entries()).sort((o,c)=>o[0].localeCompare(c[0]))})();return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.relevantLinesTitle",defaultMessage:"Relevant lines"}),children:t.jsx("div",{className:"space-y-3",children:d.map(([n,v])=>{const[x,l]=n.split("|");return t.jsxs("details",{open:!0,className:"group ring-token-border-light bg-token-main-surface-primary rounded-lg ring-1",children:[t.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium select-none",children:[t.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[t.jsx(Lt,{className:"icon-sm text-token-text-tertiary transition-transform group-open:rotate-180","aria-hidden":!0}),t.jsx("span",{className:"truncate",children:x})]}),t.jsx("span",{className:"text-token-text-tertiary ms-2 text-xs whitespace-nowrap",children:e.formatMessage({id:"aardvark.findings.lineRange",defaultMessage:"L{range}"},{range:l==null?void 0:l.replace("-","–")})})]}),t.jsx("div",{children:v.map((h,o)=>t.jsxs("div",{className:"space-y-2",children:[h.comment&&t.jsx("p",{className:"text-token-text-secondary mb-0 bg-yellow-50/60 px-3 py-3 text-sm dark:bg-yellow-900/30",children:h.comment}),h.content&&t.jsx(Sa,{content:h.content,start:h.start_line_number,className:"mb-0"})]},"".concat(n,"-").concat(o)))})]},n)})})})}function Aa({finding:s}){var g,n,v,x,l,h;const e=L(),i=s,a=Pe.useMemo(()=>{var o;return _t((o=i.commit_analysis)==null?void 0:o.proposed_patch)},[(g=i.commit_analysis)==null?void 0:g.proposed_patch]),p=Pe.useMemo(()=>{var o,c,u;return(u=(c=a==null?void 0:a.cvss_score)!=null?c:(o=i.commit_analysis)==null?void 0:o.cvss_score)!=null?u:null},[a,i.commit_analysis]),m=Pe.useMemo(()=>{var o,c,u;return(u=(c=a==null?void 0:a.criticality_cvss_reason)!=null?c:(o=i.commit_analysis)==null?void 0:o.criticality_cvss_score_reason)!=null?u:null},[a,i.commit_analysis]),d=Pe.useMemo(()=>{var u,f,r,b,A,E,D,M,N,F,$;const o=(u=i.commit_analysis)!=null?u:{},c=(f=o.attack_path_analysis)!=null?f:null;return{originalCrit:(b=(r=c==null?void 0:c.original_severity)!=null?r:o.criticality)!=null?b:null,matrixSeverity:(A=c==null?void 0:c.matrix_severity)!=null?A:null,policyAdjusted:(E=c==null?void 0:c.policy_adjusted_criticality)!=null?E:null,finalCrit:(M=(D=c==null?void 0:c.adjusted_criticality_final)!=null?D:o.attack_path_final_criticality)!=null?M:null,decider:(N=c==null?void 0:c.adjustment_decider)!=null?N:null,rationale:($=(F=c==null?void 0:c.adjustment_reason)!=null?F:o.attack_path_adjustment_reason)!=null?$:null}},[i.commit_analysis]),k=d.originalCrit&&d.finalCrit&&d.originalCrit!==d.finalCrit,y=d.rationale,j=o=>{if(!o)return"unknown";const c=String(o).toLowerCase();return c.charAt(0).toUpperCase()+c.slice(1)};return t.jsxs(G,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[((n=i.commit_analysis)==null?void 0:n.title)||e.formatMessage({id:"aardvark.findings.vulnerability",defaultMessage:"Vulnerability"}),t.jsx(yt,{level:i.criticality})]}),children:[t.jsx("div",{children:((v=i.commit_analysis)==null?void 0:v.bugs_found_or_fixed)&&t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(x=i.commit_analysis)==null?void 0:x.bugs_found_or_fixed})}),p!=null&&t.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-token-text-secondary flex items-center gap-1",children:t.jsx("div",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.cvssLabel",defaultMessage:"CVSS"})})}),t.jsxs("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-yellow-500 ring-amber-500/20",style:{backgroundColor:"rgba(245, 158, 11, 0.12)"},title:e.formatMessage({id:"aardvark.findings.cvssScore",defaultMessage:"CVSS score"}),children:[t.jsx(ra,{className:"me-1 h-[14px] w-[14px]","aria-hidden":!0}),p]})]}),m&&t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:m&&t.jsx("p",{className:"mb-2",children:m})}),t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:(l=i.commit_analysis)==null?void 0:l.description}),(k||y)&&t.jsxs("div",{className:"mt-3 text-sm leading-6",children:[t.jsxs("div",{className:"text-token-text-secondary mb-1 flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.attackPathDecisionLabel",defaultMessage:"Attack-path analysis:"})}),d.finalCrit&&t.jsx(yt,{level:(h=qt(d.finalCrit))!=null?h:"low"}),d.decider&&t.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.formatMessage({id:"aardvark.findings.attackPathDecider",defaultMessage:"(adjusted by {decider})"},{decider:d.decider})})]}),k&&t.jsx("div",{className:"text-token-text-tertiary mb-1",children:e.formatMessage({id:"aardvark.findings.attackPathChangeLine",defaultMessage:"Criticality changed from {original} to {final}."},{original:j(d.originalCrit),final:j(d.finalCrit)})}),y&&t.jsx("div",{className:"text-token-text-tertiary",children:t.jsx("p",{className:"mb-2",children:y})})]})]})}function Ea({finding:s}){var y,j,g;const e=L(),[i,a]=Pe.useState(!1),p=(y=s.commit_analysis)==null?void 0:y.validation_report,m=(j=s.commit_analysis)==null?void 0:j.validation_rubric,d=String(p||((g=s==null?void 0:s.commit_analysis)==null?void 0:g.validation_str)||"");if(!d&&!m)return null;const k=m&&d?2:1;return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.validation",defaultMessage:"Validation"}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-".concat(k),children:[m&&t.jsx("div",{className:"lg:col-span-1",children:t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:t.jsx(De,{remarkPlugins:[Ue],components:{code(l){var h=l,{inline:n,children:v}=h,x=vt(h,["inline","children"]);const o=String(v!=null?v:"");if(n)return t.jsx("code",Ne(B({className:"bg-token-bg-primary rounded px-1 py-0.5 text-[12px]"},x),{children:o}));const c=String((x==null?void 0:x.className)||""),u=/language-([\w-]+)/.exec(c),f=u==null?void 0:u[1];return t.jsx(It,{content:o,language:f,wrapperClassName:"mt-1",showActionBar:!1,codeContainerClassName:"p-3"})},input(n){return(n==null?void 0:n.type)!=="checkbox"?t.jsx("input",B({},n)):!!n.checked?t.jsx(na,{className:"mt-0.5 h-4 w-4 shrink-0 text-emerald-600"}):t.jsx(la,{className:"text-token-text-quaternary mt-0.5 h-4 w-4 shrink-0 opacity-70"})},li({children:n}){return t.jsx("li",{className:"hover:bg-token-bg-elevated-secondary/40 flex items-start gap-2 rounded-lg p-2",children:n})}},children:m})})}),d&&d.trim().length>0&&t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs font-semibold tracking-wide uppercase",children:e.formatMessage({id:"aardvark.findings.validationReportLabel",defaultMessage:"Validation report"})}),t.jsxs("div",{className:Se("relative rounded-md p-3 text-sm leading-6","bg-token-main-surface-primary/40"),children:[t.jsx("div",{className:Se("prose prose-sm text-foreground max-w-none",i?"max-h-none":"max-h-36 overflow-hidden"),children:t.jsx(De,{remarkPlugins:[Ue],children:d})}),!i&&t.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t"})]}),t.jsx("div",{className:"mt-2 flex items-center justify-end",children:t.jsx("button",{type:"button",className:"hover:bg-token-bg-elevated-secondary inline-flex h-8 items-center justify-center rounded px-2 text-xs",onClick:()=>a(n=>!n),children:i?e.formatMessage({id:"aardvark.findings.collapse",defaultMessage:"Collapse"}):e.formatMessage({id:"aardvark.findings.expand",defaultMessage:"Expand"})})})]})]})})}function $a({finding:s,refetchFinding:e}){var a;L();const{hasAttackPath:i}=Ht(s);return t.jsx("div",{className:"relative mx-auto w-full max-w-[1200px]",children:t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3 md:gap-6",children:[t.jsx("div",{className:"flex flex-col gap-4 md:col-span-2",children:t.jsx(Aa,{finding:s})}),t.jsx("div",{className:"flex h-fit flex-col gap-4 self-start",children:t.jsx(Ut,{finding:s})}),s.proposed_patch?t.jsx("div",{className:"md:col-span-3",children:t.jsx(Ma,{proposed_patch:s.proposed_patch,findingId:(a=s.hid)!=null?a:s.id,refetchFinding:e})}):null,t.jsx("div",{className:"md:col-span-3",children:t.jsx(Ca,{finding:s})}),t.jsx("div",{className:"md:col-span-3",children:t.jsx(Ea,{finding:s})}),i?t.jsx("div",{className:"md:col-span-3",children:t.jsx(oa,{finding:s})}):null]})})})}function Da(s){"use forget";const e=O.c(24),{findingId:i}=s,a=L(),p=Et(),m=$t(),d=Mt();let k;e[0]!==p.search||e[1]!==m?(k=()=>t.jsx("div",{className:"mx-auto mb-4 w-full max-w-[1200px]",children:t.jsx(Kt,{as:"button",size:"small",color:"secondary",onClick:()=>{m("/aardvark"+(p.search||""))},children:t.jsx(T,{id:"aardvark.details.back",defaultMessage:"Back to findings"})})}),e[0]=p.search,e[1]=m,e[2]=k):k=e[2];const y=k;let j;e[3]!==y?(j=r=>t.jsxs("div",{className:"w-full px-4 pb-6",children:[y(),t.jsx("div",{className:"border-token-border-light text-token-text-secondary mx-auto w-full max-w-[1200px] rounded-lg border px-4 py-6 text-center",children:t.jsx(T,Ne(B({},He.findingLoad),{values:{details:r.message}}))})]}),e[3]=y,e[4]=j):j=e[4];const g=j,{data:n,isLoading:v,refetch:x,error:l}=Tt(i);let h,o;if(e[5]!==l||e[6]!==a||e[7]!==d?(h=()=>{if(!l)return;const r=a.formatMessage(He.findingLoad,{details:l.message});d.danger(r)},o=[l,a,d],e[5]=l,e[6]=a,e[7]=d,e[8]=h,e[9]=o):(h=e[8],o=e[9]),qe.useEffect(h,o),v){let r;return e[10]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("div",{className:"w-full px-4 pb-6",children:t.jsx("div",{className:"flex h-[60vh] w-full items-center justify-center",children:t.jsx(Wt,{})})}),e[10]=r):r=e[10],r}if(l||!n){let r;e[11]!==l?(r=l!=null?l:new Error("Unknown error loading finding"),e[11]=l,e[12]=r):r=e[12];let b;return e[13]!==g||e[14]!==r?(b=g(r),e[13]=g,e[14]=r,e[15]=b):b=e[15],b}let c;e[16]!==y?(c=y(),e[16]=y,e[17]=c):c=e[17];let u;e[18]!==n||e[19]!==x?(u=t.jsx($a,{finding:n,refetchFinding:x}),e[18]=n,e[19]=x,e[20]=u):u=e[20];let f;return e[21]!==c||e[22]!==u?(f=t.jsxs("div",{className:"w-full px-4 pb-6",children:[c,u]}),e[21]=c,e[22]=u,e[23]=f):f=e[23],f}function Fa({findingId:s}){const e=Qt(),i=Vt(e),a=Jt();return i?t.jsx(Ra,Ne(B({},a),{findingId:s})):null}function Ra(s){"use forget";const e=O.c(2),{findingId:i}=s;let a;return e[0]!==i?(a=t.jsx(ia,{children:t.jsx(Da,{findingId:i})}),e[0]=i,e[1]=a):a=e[1],a}const Os=Dt(function(){const e=Ft(),i=L();if(!e.id){const a=i.formatMessage(He.findingNotFound);return t.jsx("div",{children:a})}return t.jsx(Fa,{findingId:e.id})});export{Os as default};
//# sourceMappingURL=nb9kuyv0p10xl9gs.js.map

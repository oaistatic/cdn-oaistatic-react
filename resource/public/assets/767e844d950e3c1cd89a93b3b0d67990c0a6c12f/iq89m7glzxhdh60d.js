const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kfhqwutw8t3jh6aj.js","assets/mw35uwhq4g8r9eam.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/ma98yesntrsi1rr9.js","assets/g2euln7v5pbm31qa.js","assets/conversation-small-lq38g8zw.css","assets/eti18uwq9j8ur3lc.js","assets/enpkwo0k2mfqjlio.js","assets/fdzi2sym03eufaos.js","assets/ko1u2otqsfwa0ohy.js","assets/na97s5us80xgwiaa.js","assets/hwa6pbq6i57ntwuh.js","assets/cfmv4ozi0jyg6itn.js","assets/bxq8qdjlrkpqhzqu.js","assets/nyxqrh4m1u1hf7xm.js","assets/jh7y36b2fd9dqy15.js","assets/pvi9p0c51odp9xiw.js","assets/pe4e1ebqw6qlpge9.js","assets/ejv9rjzfbwh1dn9a.js","assets/d0pdpvvqx24hob9r.js","assets/nc5snhuo5k648r43.js","assets/j5fhkqpinqfhn52i.js","assets/mnzn4aq9ma1fy9cn.js","assets/iman6sxicn70h91g.js","assets/hdkg0cys1b7b4f0v.js","assets/kx34yg3blv92o8xp.js","assets/map-with-entities-fh8z7aev.css"])))=>i.map(i=>d[i]);
var Zn=Object.freeze,Qn=Object.defineProperty,Er=Object.defineProperties;var Mr=Object.getOwnPropertyDescriptors;var Xt=Object.getOwnPropertySymbols;var eo=Object.prototype.hasOwnProperty,to=Object.prototype.propertyIsEnumerable;var As=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t);var Jn=(t,e,s)=>e in t?Qn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,M=(t,e)=>{for(var s in e||(e={}))eo.call(e,s)&&Jn(t,s,e[s]);if(Xt)for(var s of Xt(e))to.call(e,s)&&Jn(t,s,e[s]);return t},Y=(t,e)=>Er(t,Mr(e));var so=t=>typeof t=="symbol"?t:t+"",$e=(t,e)=>{var s={};for(var o in t)eo.call(t,o)&&e.indexOf(o)<0&&(s[o]=t[o]);if(t!=null&&Xt)for(var o of Xt(t))e.indexOf(o)<0&&to.call(t,o)&&(s[o]=t[o]);return s};var Yt=(t,e)=>Zn(Qn(t,"raw",{value:Zn(e||t.slice())}));var Kt=function(t,e){this[0]=t,this[1]=e},no=(t,e,s)=>{var o=(i,l,d,c)=>{try{var m=s[i](l),f=(l=m.value)instanceof Kt,h=m.done;Promise.resolve(f?l[0]:l).then(y=>f?o(i==="return"?i:"next",l[1]?{done:y.done,value:y.value}:y,d,c):d({value:y,done:h})).catch(y=>o("throw",y,d,c))}catch(y){c(y)}},a=i=>r[i]=l=>new Promise((d,c)=>o(i,l,d,c)),r={};return s=s.apply(t,e),r[As("asyncIterator")]=()=>r,a("next"),a("throw"),a("return"),r};var Rs=(t,e,s)=>(e=t[As("asyncIterator")])?e.call(t):(t=t[As("iterator")](),e={},s=(o,a)=>(a=t[o])&&(e[o]=r=>new Promise((i,l,d)=>(r=a.call(t,r),d=r.done,Promise.resolve(r.value).then(c=>i({value:c,done:d}),l)))),s("next"),s("return"),e);import{j as n,M as K,h as ie,r as g,v as Pr,_ as jt,c as ue,i as Ir,n as Pt,d as Ar,w as Rr,b as Lr,R as Dr,e as dn}from"./mw35uwhq4g8r9eam.js";import{S as Fr}from"./w3hi9hzc7twqpn11.js";import{M as Or,u as Ys,R as Ks,f as Zs,S as Js,g as Wr,I as zr,h as Br,C as Ur,i as Hr,j as Vr,k as qr,l as Gr}from"./kcex4rnzaebpwef1.js";import{u as Xr,g as Yr,s as Ls,F as nt,C as Kr,I as Zr,P as Jr,a as Qr,b as ei,c as ti,d as si}from"./nwl9s9haealsfe5d.js";import{cF as A,zX as ni,Q as _s,M as js,aw as oi,er as zt,u as ye,p as ks,J as ve,cD as un,b3 as mn,qZ as ai,eo as ri,b9 as ii,D as Ss,be as fn,ca as li,b5 as ci,a6 as oo,d as hn,ik as di,bD as ma,e as ui,aL as fa,au as ha,f5 as mi,aA as Ve,dp as ot,dP as fi,dH as hi,dI as pi,e5 as us,cw as pa,l3 as gi,f2 as xi,t2 as bi,qH as yi,n0 as wi,dF as vi,dC as _i,dB as ga,is as Qs,cA as en,hC as xa,jf as ji,d_ as ki,cy as Bt,o5 as ba,bo as Cs,iK as ut,mj as Si,cu as pn,iz as Ci,R as Ni,A as $i,V as ct,iP as Ti,jg as Ei,_ as rs,hX as Mi,hs as ao,eu as Pi,jr as Ii,e4 as Ai,W as Ri,rr as Et,eF as ya,e1 as gn,oy as Li,jb as Di,ek as ro,cB as wa,es as Fi,zY as Oi,fK as Wi,f7 as zi,zZ as Bi,n4 as Ui,bw as Hi,fj as Vi,lF as qi,fE as va,ay as Gi,cx as Ds,P as io,ps as Xi,aP as Yi,$ as Ki,a0 as Zi}from"./d0xa318sl7ywi0za.js";import{BX as Ji,BY as _a,hS as ja,aF as Qi,aG as ka,BZ as el,qJ as tl,lH as Ns,en as sl,dZ as nl,U as ol,g1 as dt,f_ as al,cO as rl,dE as il,ls as ll,iv as xn,iw as bn,ag as yn,ah as wn,rT as cl,d2 as Sa,hn as dl,hm as ul,ec as ml,ir as fl,ni as hl,At as pl,lF as kt,d3 as vn,zY as gl,dL as _n,B_ as xl,c_ as $s,cI as is,lr as bl,cd as yl,lA as wl,B$ as vl,ra as _l,h$ as jl,fV as Ut,lD as Ca,K as kl,m4 as Sl,C0 as Cl,pC as Nl,C1 as Na,i$ as $a,C2 as $l,C3 as Tl,hF as El,pF as Ml,f0 as Pl,dd as Il,d7 as Al,bI as Rl,me as Ll,bd as je,xZ as Dl,ik as Fl,C4 as Ol,iF as Wl,os as zl,jS as Zt,Aq as Bl,hc as Ul,C5 as Hl,C6 as Vl,Af as ql}from"./g2euln7v5pbm31qa.js";import{u as jn}from"./m1s7wxy82fhyl3zh.js";import{N as Gl}from"./of0vtq1gcmd3mc3z.js";import{g as lo,F as Xl,i as Yl}from"./c60v6twrznqavn77.js";import{S as Kl}from"./bhvk929w0gb4odci.js";import{v as Zl}from"./ko1u2otqsfwa0ohy.js";import{W as Jl}from"./nyxqrh4m1u1hf7xm.js";import{L as Ql}from"./iiok29s29bpdre61.js";import{u as ec}from"./enpkwo0k2mfqjlio.js";import{d as tc,C as sc}from"./iakh052vusklquwn.js";import{a as nc}from"./n5xkgyvdnxkh67ko.js";import{A as ls,g as oc,m as ac,b as tn,o as rc,I as Ta,D as ic,c as lc}from"./i1lnixtvuwzfguvz.js";import{u as cc}from"./nc5snhuo5k648r43.js";import{W as dc,d as uc,b as mc,a as fc}from"./ohau9tqj1fpdibg0.js";import hc from"./nt4e9i4qg34p2zjc.js";import{W as Ts}from"./ipoljkkwhes3fgxa.js";import{W as pc}from"./c5k9gv36gzuxi0am.js";import{W as co,i as gc}from"./hdw58d7g4tx8n6s4.js";import{j as xc,x as bc,z as yc}from"./ldtpmsnzn9ens47o.js";import{W as wc}from"./baz4b8nlf8t2lb95.js";import{A as vc}from"./jxdumrq8vfk5kk1c.js";import{u as kn,a as _c,W as uo,g as jc,c as kc,p as Sc}from"./g09bc254e08nnz5p.js";import{c as Cc,b as Nc,W as $c,a as Tc,d as Ea,e as Fs,f as Ma,E as mo,g as sn,u as Ec}from"./oscko8pqsql06nny.js";import{u as Pa}from"./mnzn4aq9ma1fy9cn.js";import{g as Mc,h as Pc}from"./j5fhkqpinqfhn52i.js";import{S as Ic}from"./glvtvsqozo9e3cjo.js";import{M as Sn}from"./i693kfbch8smq86y.js";import{a as Ac,b as Rc}from"./cz2iwgzw4rck3xnv.js";import{g as Lc,b as Dc,a as Fc,c as Oc,F as Wc,d as zc}from"./pvi9p0c51odp9xiw.js";import{v as fo,C as Bc,A as Uc,h as Hc,j as Vc,f as qc,p as Gc,k as Xc,n as Yc,P as Kc,o as Zc,q as Jc,L as Qc}from"./eq8fcle41l3uoq7q.js";import{u as It,t as ho,r as nn,g as qe}from"./i33so5jr0r2llm4i.js";import{c as Ia}from"./b7x946trz8yzbo2f.js";import{markdownToClipboardContent as ed}from"./h7tudz5piofu9rem.js";import{a as td,T as sd}from"./mtn6t8uzit6jedow.js";import"./oj9zwxa6l3kpv1x2.js";import"./kbj1b07s2z6vxqkg.js";import"./hu1bt0oauegdhua6.js";import"./h1em0bjkpkjv8ykw.js";import"./gy1lpvuoewmzh42c.js";import"./h4yh1661qhhbu5v5.js";import"./lep2wptoy14cfe2w.js";import"./iknugp00locgtve5.js";import"./la79eh1q1qxrfcxi.js";import"./ktjtg3fnpomr03qk.js";import"./fkrqr6nqq2852orb.js";import"./exovct07932vem5e.js";import"./ck4rwz4bvjdsyeld.js";import"./cv4afpu20gjb9dll.js";import"./lw2hpe6y5hhfte4k.js";import"./k6k3ilbqdb73kxkm.js";import"./ksb30nvrqfrocrgu.js";import"./h38m9m9rf2db1qpt.js";import"./mlgj7gsfvuk1e8bn.js";import"./mpk4drhv3szxuvkj.js";import"./fljft0gbsnm1ovqa.js";import"./k527f0oyvlppyfoy.js";import"./krfycj1ruc6rihlj.js";import"./mojznsm1zll43nmv.js";import"./l57v5lxkpqo9adh3.js";import"./b9m0h1g72p9whl0h.js";import"./f76gy0b8ieo4s693.js";import"./obs7vyhux2j83kng.js";import"./bwg0lbtx0n9f11bn.js";import"./mzril1pzbts3gz7n.js";import"./e0d69s7tsq37k47r.js";import"./ehv2vkvc6wjiqj3r.js";import"./ce3hgmw4iyyhicud.js";import"./c8dilzb1umlthpuq.js";import"./e1t6unu3olubcgkg.js";import"./bzxitjpdx1z6hpbp.js";import"./t4u99i3y1xwqt0zb.js";import"./d4h15g77ywnnjdmi.js";import"./ddina39kz3r81pp7.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./bhdyjo7ybkqcriof.js";import"./o4syhzyam6fzccjl.js";import"./iman6sxicn70h91g.js";import"./hdkg0cys1b7b4f0v.js";import"./kx34yg3blv92o8xp.js";import"./pe4e1ebqw6qlpge9.js";import"./ejv9rjzfbwh1dn9a.js";import"./ol9d5wxhynx9q2is.js";import"./fna9z31n721lpf9f.js";const nd=Ia("ChevronDownFilled","1em",["M15.8 7.73c.28.3.27.78-.03 1.06l-5.25 5a.75.75 0 0 1-1.04 0l-5.25-5a.75.75 0 0 1 1.04-1.08L10 12.2l4.73-4.5a.75.75 0 0 1 1.06.02Z"]),od=Ia("ChevronLeftFilled","1em",["M12.27 15.8a.75.75 0 0 1-1.06-.03l-5-5.25a.75.75 0 0 1 0-1.04l5-5.25a.75.75 0 1 1 1.08 1.04L7.8 10l4.5 4.73c.29.3.28.78-.02 1.06Z"]);function ad(s){var o=s,{children:t}=o,e=$e(o,["children"]);return n.jsxs(Or,Y(M({},e),{className:"decorated-link",children:[t,n.jsx("span",{"aria-hidden":!0,className:"ms-0.5 inline-block align-middle leading-none",children:n.jsx(Fr,{className:"block h-[0.75em] w-[0.75em] stroke-current stroke-[0.75]"})})]}))}const po=({children:t,"data-start":e=null,"data-end":s=null,"data-is-last-node":o,"data-is-only-node":a,tag:r})=>{const{animationTiming:i,shouldAnimate:l,shouldHide:d,isDisabled:c,onComplete:m,onReady:f}=Xr({isMarker:!0,tag:r,children:t,start:e,end:s,isLastNode:o,isOnlyNode:a});return c||d?n.jsx(r,{"data-start":e,"data-end":s,className:A(d&&"hidden"),children:t}):n.jsx(r,{"data-start":e,"data-end":s,className:A(Ls.marker,l?Ls.animate:Ls.hidden),onAnimationStart:()=>f(0),onAnimationEnd:()=>m(0),style:Yr(i),children:t})},rd={p:t=>n.jsx(nt,M({tag:"p"},t)),h1:t=>n.jsx(nt,M({tag:"h1"},t)),h2:t=>n.jsx(nt,M({tag:"h2"},t)),h3:t=>n.jsx(nt,M({tag:"h3"},t)),h4:t=>n.jsx(nt,M({tag:"h4"},t)),h5:t=>n.jsx(nt,M({tag:"h5"},t)),h6:t=>n.jsx(nt,M({tag:"h6"},t)),li:t=>n.jsx(po,M({tag:"li",isListItem:!0},t)),hr:t=>n.jsx(po,M({tag:"hr"},t))};function id(t){const e=t.split("\n");cd(e);const s=e.pop();if(s===":"||s==="::")e.push("");else{const o=ld(s).trimEnd();o&&e.push(o)}return e.join("\n")}function ld(t){if(!t||/^\s*-\s*([*_]+)?\s*$/.test(t))return"";const e=[];let s="",o=0;for(;o<t.length;){if(t[o]==="*"&&t[o+1]==="*"){s+="**",e.length&&e[e.length-1]==="**"?e.pop():e.push("**"),o+=2;continue}if(t[o]==="*"||t[o]==="_"){s+=t[o];const r=t[o];e.length&&e[e.length-1]===r?e.pop():e.push(r),o++;continue}if(t[o]==="["){const r=t[o];s+=r,e.push(r),o++;continue}if(t[o]==="]"){const r=t[o];s+=r,e.length&&e[e.length-1]==="["&&e.pop(),o++;continue}if(t[o]==="("&&t[o-1]==="]"){const r=t[o];s+=r,e.push(r),o++;continue}if(t[o]===")"){const r=t[o];s+=r,e.length&&e[e.length-1]==="("&&e.pop(),o++;continue}s+=t[o],o++}if(e.length===0)return t;let a=s.trimEnd();for(;e.length;){const r=e.pop();if(r==null)break;r==="("?a+=")":a.endsWith(r)?a=a.slice(0,-r.length).trimEnd():r==="["?a+="]()":a+=r}return a}function cd(t){let e=!1,s=null;for(let o=0;o<t.length;o++){const a=t[o],r=Ji(a);if(r){const l=r.info.trimStart(),d=r.info.trim();if(e)s&&r.marker===s.marker&&r.fence.length===s.fence.length&&d.length===0&&(s=null);else if(l.startsWith("{")){const c=hd(t,o,r);t[o]=c.normalizedLine,(c.linesConsumed>0||c.replacementLines.length)&&t.splice(o+1,c.linesConsumed,...c.replacementLines),s=r}else if(d.length===0&&o===t.length-1){t[o]="";continue}e=!e;continue}if(e){s&&bd(a,s)&&(t[o]="".concat(s.leadingWhitespace).concat(s.fence),s=null,e=!1);continue}const i=a.trim();if(i.startsWith(":::")&&i!==":::"){const l=i.indexOf("{");if(l===-1){const d=i.slice(3).trim();if(d.length>0&&!(d in ni)){t[o]=":::";continue}const c=a.replace(/\s+$/,"");t[o]=c+"{}";continue}ud(i,l)||(t[o]=dd(a,a.indexOf("{")))}t.length>1&&t[t.length-1]===":::"&&t[t.length-2]===":::"&&t.splice(-2)}s&&(t.push("".concat(s.leadingWhitespace).concat(s.fence)),s=null)}function dd(t,e){const s=t.replace(/\s+$/,""),o=s.slice(0,e).replace(/\s+$/,""),a=s.slice(e+1);if(a.trim().length===0||!/=/.test(a))return o+"{}";let i=null,l=!1;for(let d=0;d<a.length;d++){const c=a[d];if(l){l=!1;continue}if(c==="\\"){l=!0;continue}if(i){c===i&&(i=null);continue}if(c==='"'||c==="'"){i=c;continue}}return i?s+i+"}":/=[\s]*$/.test(a)?s+'""}':s+"}"}function ud(t,e){let s=null,o=0,a=!1;for(let r=e;r<t.length;r++){const i=t[r];if(a){a=!1;continue}if(i==="\\"){a=!0;continue}if(s){i===s&&(s=null);continue}if(i==='"'||i==="'"){s=i;continue}if(i==="{"){o++;continue}if(i==="}"){if(o--,o===0)return!0;continue}}return!1}function md(t){const e=t.match(/^\s*/),s=e?e[0]:"",o=t.slice(s.length);if(!o.startsWith("{"))return"".concat(s,"{}");let a;try{const[l]=_a(o,!0);a=l}catch(l){return"".concat(s,"{}")}const r=Aa(a);if(!r)return"".concat(s,"{}");const i=JSON.stringify(r);return"".concat(s).concat(i)}function Aa(t){if(!(!t||Array.isArray(t)||typeof t!="object"))return t}const fd=4,Ra=2048;function hd(t,e,s){var c,m;const o=s.leadingWhitespace.length+s.fence.length;let r=(m=(c=t[e])==null?void 0:c.slice(o))!=null?m:"",i=0,l=go(r);if(l.kind==="complete")return{normalizedLine:xo(s,l.value),linesConsumed:0,replacementLines:bo(l.remainder)};for(;l.kind==="needsMore"&&i<fd&&r.length<Ra;){const f=e+i+1;if(f>=t.length)break;const h=t[f];if(!gd(h))break;if(i++,r="".concat(r,"\n").concat(h!=null?h:""),l=go(r),l.kind==="complete")return{normalizedLine:xo(s,l.value),linesConsumed:i,replacementLines:bo(l.remainder)};if(l.kind==="invalid")break}return{normalizedLine:pd(s,r),linesConsumed:i,replacementLines:[]}}function go(t){if(!t)return{kind:"invalid"};const e=t.indexOf("{");if(e===-1)return{kind:"invalid"};const s=t.slice(e),o=xd(s);if(o==null)return t.length>=Ra?{kind:"invalid"}:{kind:"needsMore"};const a=s.slice(0,o+1);try{const[r,i]=_a(a.trim()),l=Aa(r);if(!l)return{kind:"invalid"};if(i!=null)return{kind:"needsMore"};const d=s.slice(o+1);return{kind:"complete",value:l,remainder:d}}catch(r){return{kind:"invalid"}}}function xo(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence);return"".concat(s).concat(JSON.stringify(e))}function pd(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence),o=md(e.replace(/\r?\n+/g," ").trimStart()).trim();return o.length===0?"".concat(s,"{}"):"".concat(s).concat(o)}function gd(t){if(!t)return!1;const e=t.trimStart();if(e.length===0)return!0;const s=e[0];return s==='"'||s==="'"||s==="{"||s==="}"||s==="["||s===","}function xd(t){let e=!1,s=0,o=!1,a=!1;for(let r=0;r<t.length;r++){const i=t[r];if(!e){i==="{"&&(e=!0,s=1);continue}if(a){a=!1;continue}if(i==="\\"){a=!0;continue}if(o){i==='"'&&(o=!1);continue}if(i==='"'){o=!0;continue}if(i==="{"){s++;continue}if(i==="}"){if(s--,s===0)return r;continue}}return null}function bo(t){if(!t)return[];const e=t.startsWith("\n")?t.slice(1):t;return e.length===0?[]:e.split("\n")}function bd(t,e){const s=t.trim();return s.length===0||!yd(s,e.marker)?!1:s.length<e.fence.length}function yd(t,e){for(let s=0;s<t.length;s++)if(t[s]!==e)return!1;return!0}function wd({citation:t}){return n.jsx(ja,{side:"top",triggerButton:n.jsx("span",{className:"inline-flex items-center font-bold",children:n.jsx(K,{id:"ZNWtPG",defaultMessage:"{startChar}clipboard {icon}{endChar}",values:{startChar:"「",icon:n.jsx(el,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:n.jsxs("div",{className:"flex flex-col items-stretch gap-1",children:[n.jsx("div",{className:"flex justify-end border-b",children:n.jsx(Qi,{onCopy:e=>ka(t.text,void 0,e),buttonText:!0,textPosition:"left"})}),n.jsx("div",{children:t.text})]})})}function vd({citation:t,conversation:e,nodeType:s}){const o=ie(),a=_s(e.id),r=tl(t.screenshot_asset_pointer,a);return s==="containerDirective"&&o.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"}),n.jsx(ja,{side:"top",triggerButton:n.jsx("span",{className:"inline-flex items-center font-bold",children:n.jsx(K,{id:"qUxKU1",defaultMessage:"{startChar}screenshot {icon}{endChar}",values:{startChar:"「",icon:n.jsx(Ns,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:r?n.jsx("img",{className:"w-xl max-w-screen",src:r,alt:o.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"})}):n.jsx("div",{className:"text-sm",children:n.jsx(K,{id:"BUdJTR",defaultMessage:"Screenshot not available"})})})}function La({conversation:t,messageId:e,fileId:s,fileName:o,processedMarkdownInfo:a,isStandaloneAttachment:r}){const i=_s(t.id),l=js(t.id,_=>{var b;return e?(b=_==null?void 0:_.tree.getNodeIfExists(e))==null?void 0:b.message:void 0}),d=g.useMemo(()=>{var C;if(!l)return null;const _={content_type:oi.Text,parts:["{{file:".concat(s,"}}")]},b=Y(M({},l==null?void 0:l.metadata),{is_synthetic_share_message:!0,is_standalone_share_attachment:r});return b.content_references=(C=a==null?void 0:a.displayedContentReferences.filter(E=>E.type!=="debug"))!=null?C:[],b.citations=[],a&&(_.parts=[a.rawText],b.n7jupd_crefs=a.n7jupdCrefs),Y(M({},l),{id:Pr(),content:_,metadata:b})},[l,s,a,r]),c=g.useMemo(()=>{if(!(!l||!d||!i))return{previewMessage:d,clientThreadId:t.id,fileId:s,messageId:l.id,serverThreadId:i,isStandaloneAttachment:r,fileName:o}},[d,t.id,s,l,i,r,o]),m=sl({odysseyShareIntent:c,clientThreadId:t.id}),[f,h]=g.useState(!1);return{onClick:g.useCallback(async()=>{h(!0),await m(),h(!1)},[h,m]),isLoading:f,isEnabled:!!c}}function _d({conversation:t,messageId:e,fileId:s,fileName:o,processedMarkdownInfo:a}){const r=ie(),{onClick:i,isLoading:l,isEnabled:d}=La({conversation:t,messageId:e,fileId:s,fileName:o,processedMarkdownInfo:a,isStandaloneAttachment:!1});return d?n.jsx(nl,{onClick:i,label:r.formatMessage({id:"ConversationTurn.sharePostButtonTooltip",defaultMessage:"Share"}),icon:l?zt:ol}):null}function jd(t){return t.endsWith(".md")}const kd=({citation:t,conversation:e,messageId:s})=>{const o=ye(),[a,r]=g.useState(!1),i=_s(e.id),l=ks(),[d,c]=g.useState(null),m=g.useRef(null),f=g.useCallback(N=>{l.danger(N,{toastId:"ttom_file_citation_failed_to_download_file"})},[l]),h=t.file_id,y=ve(o,"3154019201"),v=y,_=un(),b=jn(!0,i,h,void 0,f),C=b==null?void 0:b.data,E=(b==null?void 0:b.isPending)||!1;g.useEffect(()=>{var N;if((C==null?void 0:C.status)==="success"&&C.download_url){(N=m.current)==null||N.abort();const k=new AbortController;m.current=k,r(!0),(async()=>{try{const $=await fetch(C.download_url,{headers:_?{}:mn(),signal:k.signal});if(!$.ok)throw new Error("HTTP ".concat($.status));c(await $.text())}catch($){$.name!=="AbortError"&&l.danger("Failed to download file",{toastId:"ttom_file_citation_failed_to_download_file"})}finally{r(!1)}})()}return()=>{var k;(k=m.current)==null||k.abort()}},[C,l,_]);const p=g.useContext(dt),w=g.useMemo(()=>{var L,F,O,T,B,q,H,U,G;if(d==null)return null;const k=(T=((O=(F=(L=p==null?void 0:p.message)==null?void 0:L.metadata)==null?void 0:F.content_references_by_file)!=null?O:{})[t.cite_key])!=null?T:[],$=ai(d,k);let S=$.processedText;const I=(B=$.displayedContentReferences)!=null?B:[],x=(G=((U=(H=(q=p==null?void 0:p.message)==null?void 0:q.metadata)==null?void 0:H.n7jupd_crefs_by_file)!=null?U:{})[t.cite_key])!=null?G:[];return x.length>0&&(S=al(S,x)),{processedText:S,displayedContentReferences:I,n7jupdCrefs:x,rawText:d}},[d,p,t.cite_key]);return E||a?n.jsx(zt,{className:"inline"}):!w||!(p!=null&&p.message)?"[Could not display report]":n.jsx(dt.Provider,{value:Y(M({},p),{contentReferences:w.displayedContentReferences,n7jupdCrefs:w.n7jupdCrefs}),children:n.jsxs("div",{className:"border-token-border-light dark:border-token-bg-tertiary @container relative mx-[-16px] mt-4 mb-4 flex cursor-text flex-col items-start overflow-hidden rounded-[14px] border px-4 pt-6 pb-6 contain-inline-size sm:mx-[-32px] sm:rounded-[28px] sm:px-8 sm:shadow-sm",children:[n.jsx("div",{className:"w-full pt-1 pb-1 sm:pt-4 sm:pb-3",children:n.jsx(rl,{conversation:e,componentOverrides:Gl,children:w.processedText})}),v&&n.jsx("div",{className:"flex",children:y&&n.jsx(_d,{conversation:e,messageId:s,fileId:h,fileName:t.file_name,processedMarkdownInfo:w,isStandaloneAttachment:!1})})]})})},yo=(t,e)=>{const s=new Ql(new URL("{{.assetPrefix}}/assets/walnut-worker-1-RIZ5x0.js",import.meta.url),{type:"module"});return new Promise((o,a)=>{s.onmessage=r=>{var i;s.terminate(),r.data.error?a(new Error(r.data.error)):o((i=r.data.protoBytes)!=null?i:new Uint8Array)},s.onerror=r=>{s.terminate(),a(r)},s.postMessage({bytes:t.buffer,ext:e},[t.buffer])})},Sd="Walnut",Cd={hash:"sha256-ioryaekA5Ek7qwu8NSSzdkk3lN5vSoM2EfrrPyGSnZE=",fingerprinting:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"DocumentFormat.OpenXml.Framework.wasm","DocumentFormat.OpenXml.4gnu476eq8.wasm":"DocumentFormat.OpenXml.wasm","Google.Protobuf.bvef67su4p.wasm":"Google.Protobuf.wasm","System.Collections.Concurrent.9lu1brd9dn.wasm":"System.Collections.Concurrent.wasm","System.Collections.NonGeneric.knkpn76dbg.wasm":"System.Collections.NonGeneric.wasm","System.Collections.Specialized.fphqfm20s9.wasm":"System.Collections.Specialized.wasm","System.Collections.zpof7ebupv.wasm":"System.Collections.wasm","System.ComponentModel.Primitives.19qfe9vx44.wasm":"System.ComponentModel.Primitives.wasm","System.ComponentModel.TypeConverter.v6ok9r0yls.wasm":"System.ComponentModel.TypeConverter.wasm","System.ComponentModel.qu3d3gzmkd.wasm":"System.ComponentModel.wasm","System.Console.xgvsggvnx2.wasm":"System.Console.wasm","System.Diagnostics.DiagnosticSource.j8ly62mron.wasm":"System.Diagnostics.DiagnosticSource.wasm","System.IO.Compression.1207vjwudi.wasm":"System.IO.Compression.wasm","System.IO.Packaging.8th4tkd3a0.wasm":"System.IO.Packaging.wasm","System.Linq.Expressions.v4h61ruutf.wasm":"System.Linq.Expressions.wasm","System.Linq.ggmptkukob.wasm":"System.Linq.wasm","System.Memory.3sw3whopgd.wasm":"System.Memory.wasm","System.Net.Http.6m95liy40q.wasm":"System.Net.Http.wasm","System.Net.Primitives.gd20ym2wiq.wasm":"System.Net.Primitives.wasm","System.ObjectModel.toe3uknb7z.wasm":"System.ObjectModel.wasm","System.Private.CoreLib.m3s9xctfj9.wasm":"System.Private.CoreLib.wasm","System.Private.Uri.zuxqy2gx3e.wasm":"System.Private.Uri.wasm","System.Private.Xml.Linq.zd546umqfo.wasm":"System.Private.Xml.Linq.wasm","System.Private.Xml.6t8s398ltr.wasm":"System.Private.Xml.wasm","System.Runtime.InteropServices.JavaScript.5w5ncmofpv.wasm":"System.Runtime.InteropServices.JavaScript.wasm","System.Security.Cryptography.88lukhdacm.wasm":"System.Security.Cryptography.wasm","System.Text.RegularExpressions.k2or4udmln.wasm":"System.Text.RegularExpressions.wasm","System.t4d4s3f398.wasm":"System.wasm","System.Xml.Linq.62mgoxb9g2.wasm":"System.Xml.Linq.wasm","Walnut.0lrlfodehv.wasm":"Walnut.wasm","dotnet.native.d40gqx23ha.js":"dotnet.native.js","dotnet.native.aygawvuze6.wasm":"dotnet.native.wasm","dotnet.js":"dotnet.js","dotnet.runtime.9o45ky8ejm.js":"dotnet.runtime.js","icudt_CJK.tjcz0u77k5.dat":"icudt_CJK.dat","icudt_EFIGS.tptq2av103.dat":"icudt_EFIGS.dat","icudt_no_CJK.lfu7j35m59.dat":"icudt_no_CJK.dat"},jsModuleNative:{"dotnet.native.d40gqx23ha.js":"sha256-Yz25lwtGCTLJ6ZGeuldtG8q1sARdTE3ncbdIoV+a32k="},jsModuleRuntime:{"dotnet.runtime.9o45ky8ejm.js":"sha256-6QIZYgG+ftoT9N1H1EEJeXIhD/qbKqEcnmawDskiwdI="},wasmNative:{"dotnet.native.aygawvuze6.wasm":"sha256-ru+dVWUOHH60BtjhGrV6fWxJj+ZDCTYIMjF01AoNhsU="},icu:{"icudt_CJK.tjcz0u77k5.dat":"sha256-SZLtQnRc0JkwqHab0VUVP7T3uBPSeYzxzDnpxPpUnHk=","icudt_EFIGS.tptq2av103.dat":"sha256-8fItetYY8kQ0ww6oxwTLiT3oXlBwHKumbeP2pRF4yTc=","icudt_no_CJK.lfu7j35m59.dat":"sha256-L7sV7NEYP37/Qr2FPCePo5cJqRgTXRwGHuwF5Q+0Nfs="},coreAssembly:{"System.Private.CoreLib.m3s9xctfj9.wasm":"sha256-fgjq5sMzZEf1uwPYMkjMZScS4u6TyUqfbEP+BEQxoBg=","System.Runtime.InteropServices.JavaScript.5w5ncmofpv.wasm":"sha256-lWFSmAKoXr5ke4quj4mDqc9K8FtiqsRli8yH2+AsiIQ="},assembly:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"sha256-kqKbud4eaFNkjKW0OqLAmn6WKvayLb00uusbPCIHELQ=","DocumentFormat.OpenXml.4gnu476eq8.wasm":"sha256-NLIC+Ydg9UIoT0BupVmmUJiMZGYMnaa/dLjIrKMHo94=","Google.Protobuf.bvef67su4p.wasm":"sha256-+YTHK5iMJ1qqT8rwso0msRnFimxTnVn7anp423wPdM4=","System.Collections.Concurrent.9lu1brd9dn.wasm":"sha256-42c4PHN0rCakEdhwYIF+Gh+zYzH0USVgLTHmAM67dsA=","System.Collections.NonGeneric.knkpn76dbg.wasm":"sha256-MDgXzSQ6+n31fzEot23il4Tz8icWhBQOPJBWcPAWNpY=","System.Collections.Specialized.fphqfm20s9.wasm":"sha256-I4ObXcfKEYFE/rWO7yMwb52mB+TxNlVDr74zFi7VZBc=","System.Collections.zpof7ebupv.wasm":"sha256-57lJgKNbZqY86RSEXEugr/5z+KG34t3H/xRf3BGJxGA=","System.ComponentModel.Primitives.19qfe9vx44.wasm":"sha256-WwsxFkhJ2bnScc14Iq3C/Oujc30kI7N1c7AclgPMcWE=","System.ComponentModel.TypeConverter.v6ok9r0yls.wasm":"sha256-idNBYnCGYv7oJHAVQRZZMsHKhnISygjKF/7Pc/6YNaE=","System.ComponentModel.qu3d3gzmkd.wasm":"sha256-wifBFoiHVP4KaFhjz887NKTzJH/M6gWTCeR9gYcM078=","System.Console.xgvsggvnx2.wasm":"sha256-UY6M99pYB1FVWuUtdMP4VBoubK7+XwmMVLy5ymKPpjs=","System.Diagnostics.DiagnosticSource.j8ly62mron.wasm":"sha256-/TGI24Jx79K7wdRMcd2B8hLSAt55XyrqqilZYuSGURc=","System.IO.Compression.1207vjwudi.wasm":"sha256-99gjke7Xs66Q1t3Tnc6hyJXTJNs242YuR+JF1Dmr2Uc=","System.IO.Packaging.8th4tkd3a0.wasm":"sha256-1C+I5A7ESuL28X57RP+FiTL8ayuTe86SmJE6NSg4dQA=","System.Linq.Expressions.v4h61ruutf.wasm":"sha256-P+nlIV3Lelxh/GL45XSlhIbqfl8wROUSaM30VuJyr0M=","System.Linq.ggmptkukob.wasm":"sha256-ENWMas8jrh+VDxfIedAgvo+Xq5NDv5fkxQyQnGz8+JE=","System.Memory.3sw3whopgd.wasm":"sha256-s4ytDaGz9lgkWcvugGm7uXm32ktFEgEnljd75YCGsns=","System.Net.Http.6m95liy40q.wasm":"sha256-EmMh+7TEbcrjE07LZSbqsT+i3cg2SfuFEwB3v81srW0=","System.Net.Primitives.gd20ym2wiq.wasm":"sha256-/FmecRu5Wfb7p4wjY3KDbGzMWRfNbwsnnAnzdbPF9b8=","System.ObjectModel.toe3uknb7z.wasm":"sha256-HUvykr+C4XE/y2OMQ49bBU8+S644IUrkWewmynWp8Gs=","System.Private.Uri.zuxqy2gx3e.wasm":"sha256-Fejtz3SBcZXQZfPLUq7OAR777eOvADHVRni2jgd9CrE=","System.Private.Xml.Linq.zd546umqfo.wasm":"sha256-uS0XUclnc6brmaGFCZXDocwEPNdIW+RDVJtuiUSHUzQ=","System.Private.Xml.6t8s398ltr.wasm":"sha256-moJdO1oBJXlis9s2IobGWvvzrmZkBMWMGJohZ+K8KLU=","System.Security.Cryptography.88lukhdacm.wasm":"sha256-+I6ReCyc24I6xnyCUAOnvbs2DJc+kq8hkMUcQYNODvs=","System.Text.RegularExpressions.k2or4udmln.wasm":"sha256-nL7n4NFLJuA7lHZQLCCKYPQC2vL/5Fco431ijPaCsRs=","System.t4d4s3f398.wasm":"sha256-fVP2BxRRKpBA0PmBbKxmO45bXDrAXVn1GthlDclLbeU=","System.Xml.Linq.62mgoxb9g2.wasm":"sha256-UgDQgumqZj6p9gp1AxxwuF7FY0ittV25c4qrMW9q7XY=","Walnut.0lrlfodehv.wasm":"sha256-5J0XYEBBTilhTKezRlCA2AQ22kr3QKEDeTsNCJe99jc="}},Nd=0,$d=!0,Td="sharded",Ed={mainAssemblyName:Sd,resources:Cd,debugLevel:Nd,linkerEnabled:$d,globalizationMode:Td};//! The .NET Foundation licenses this file to you under the MIT license.
var Md=!1;const Pd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),Id=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),Cn=Symbol.for("wasm promise_control");function Qe(t,e){let s=null;const o=new Promise((function(r,i){s={isDone:!1,promise:null,resolve:l=>{s.isDone||(s.isDone=!0,r(l),t&&t())},reject:l=>{s.isDone||(s.isDone=!0,i(l),e&&e())}}}));s.promise=o;const a=o;return a[Cn]=s,{promise:a,promise_control:s}}function Ad(t){return t[Cn]}function Rd(t){t&&(function(e){return e[Cn]!==void 0})(t)||ee(!1,"Promise is not controllable")}const Ld="__mono_message__",Da=["debug","log","trace","warn","info","error"],Dt="MONO_WASM: ";let Ee,on,et,Es;function Dd(t){Es=t}function pe(t){if(j.diagnosticTracing){const e=typeof t=="function"?t():t;console.debug(Dt+e)}}function Fa(t,...e){console.info(Dt+t,...e)}function Oa(t,...e){console.info(t,...e)}function St(t,...e){console.warn(Dt+t,...e)}function Ct(t,...e){if(e&&e.length>0&&e[0]&&typeof e[0]=="object"){if(e[0].silent)return;if(e[0].toString)return void console.error(Dt+t,e[0].toString())}console.error(Dt+t,...e)}function Wa(t,e,s){return function(...o){try{let a=o[0];if(a===void 0)a="undefined";else if(a===null)a="null";else if(typeof a=="function")a=a.toString();else if(typeof a!="string")try{a=JSON.stringify(a)}catch(r){a=a.toString()}e(s?JSON.stringify({method:t,payload:a,arguments:o.slice(1)}):[t+a,...o.slice(1)])}catch(a){et.error("proxyConsole failed: ".concat(a))}}}function za(t,e,s){on=e,Es=t,et=M({},e);const o="".concat(s,"/console").replace("https://","wss://").replace("http://","ws://");Ee=new WebSocket(o),Ee.addEventListener("error",Ba),Ee.addEventListener("close",Ua),(function(){for(const a of Da)on[a]=Wa("console.".concat(a),Fd,!0)})()}function wo(t){let e=30;const s=()=>{Ee?Ee.bufferedAmount==0||e==0?(t&&Oa(t),(function(){for(const o of Da)on[o]=Wa("console.".concat(o),et.log,!1)})(),Ee.removeEventListener("error",Ba),Ee.removeEventListener("close",Ua),Ee.close(1e3,t),Ee=void 0):(e--,globalThis.setTimeout(s,100)):t&&et&&et.log(t)};s()}function Fd(t){Ee&&Ee.readyState===WebSocket.OPEN?Ee.send(t):et.log(t)}function Ba(t){et.error("[".concat(Es,"] proxy console websocket error: ").concat(t),t)}function Ua(t){et.debug("[".concat(Es,"] proxy console websocket closed: ").concat(t),t)}new Date().valueOf();const Ha={},an={},rn={};let ms,Os,vo;function Od(){const t=Object.values(rn),e=Object.values(an),s=jo(t),o=jo(e),a=s+o;if(a===0)return;const r=Me?"%c":"",i=Me?["background: purple; color: white; padding: 1px 3px; border-radius: 3px;","font-weight: bold;","font-weight: normal;"]:[],l=j.config.linkerEnabled?"":"\nThis application was built with linking (tree shaking) disabled. \nPublished applications will be significantly smaller if you install wasm-tools workload. \nSee also https://aka.ms/dotnet-wasm-features";console.groupCollapsed("".concat(r,"dotnet").concat(r," Loaded ").concat(Ws(a)," resources").concat(r).concat(l),...i),t.length&&(console.groupCollapsed("Loaded ".concat(Ws(s)," resources from cache")),console.table(rn),console.groupEnd()),e.length&&(console.groupCollapsed("Loaded ".concat(Ws(o)," resources from network")),console.table(an),console.groupEnd()),console.groupEnd()}async function Wd(){const t=ms;if(t){const e=(await t.keys()).map((async s=>{s.url in Ha||await t.delete(s)}));await Promise.all(e)}}function _o(t){return"".concat(t.resolvedUrl,".").concat(t.hash)}async function Va(){ms=await(async function(t){if(!j.config.cacheBootResources||globalThis.caches===void 0||globalThis.document===void 0||globalThis.isSecureContext===!1)return null;const e="dotnet-resources-".concat(globalThis.document.baseURI.substring(globalThis.document.location.origin.length));try{return await caches.open(e)||null}catch(s){return null}})()}function jo(t){return t.reduce(((e,s)=>e+(s.responseBytes||0)),0)}function Ws(t){return"".concat((t/1048576).toFixed(2)," MB")}function qa(){j.preferredIcuAsset=Ga(j.config);let t=j.config.globalizationMode=="invariant";if(!t)if(j.preferredIcuAsset)j.diagnosticTracing&&pe("ICU data archive(s) available, disabling invariant mode");else{if(j.config.globalizationMode==="custom"||j.config.globalizationMode==="all"||j.config.globalizationMode==="sharded"){const a="invariant globalization mode is inactive and no ICU data archives are available";throw Ct("ERROR: ".concat(a)),new Error(a)}j.diagnosticTracing&&pe("ICU data archive(s) not available, using invariant globalization mode"),t=!0,j.preferredIcuAsset=null}const e="DOTNET_SYSTEM_GLOBALIZATION_INVARIANT",s="DOTNET_SYSTEM_GLOBALIZATION_HYBRID",o=j.config.environmentVariables;if(o[s]===void 0&&j.config.globalizationMode==="hybrid"?o[s]="1":o[e]===void 0&&t&&(o[e]="1"),o.TZ===void 0)try{const a=Intl.DateTimeFormat().resolvedOptions().timeZone||null;a&&(o.TZ=a)}catch(a){Fa("failed to detect timezone, will fallback to UTC")}}function Ga(t){var e;if(!((e=t.resources)===null||e===void 0)&&e.icu&&t.globalizationMode!="invariant"){const s=t.applicationCulture||(Me?globalThis.navigator&&globalThis.navigator.languages&&globalThis.navigator.languages[0]:Intl.DateTimeFormat().resolvedOptions().locale),o=Object.keys(t.resources.icu),a={};for(let i=0;i<o.length;i++){const l=o[i];t.resources.fingerprinting?a[Qa(l)]=l:a[l]=l}let r=null;if(t.globalizationMode==="custom"){if(o.length>=1)return o[0]}else t.globalizationMode==="hybrid"?r="icudt_hybrid.dat":s&&t.globalizationMode!=="all"?t.globalizationMode==="sharded"&&(r=(function(i){const l=i.split("-")[0];return l==="en"||["fr","fr-FR","it","it-IT","de","de-DE","es","es-ES"].includes(i)?"icudt_EFIGS.dat":["zh","ko","ja"].includes(l)?"icudt_CJK.dat":"icudt_no_CJK.dat"})(s)):r="icudt.dat";if(r&&a[r])return a[r]}return t.globalizationMode="invariant",null}const ko=class{constructor(t){this.url=t}toString(){return this.url}};async function zd(t,e){try{const s=typeof globalThis.fetch=="function";if(tt){const o=t.startsWith("file://");if(!o&&s)return globalThis.fetch(t,e||{credentials:"same-origin"});Os||(vo=st.require("url"),Os=st.require("fs")),o&&(t=vo.fileURLToPath(t));const a=await Os.promises.readFile(t);return{ok:!0,headers:{length:0,get:()=>null},url:t,arrayBuffer:()=>a,json:()=>JSON.parse(a),text:()=>{throw new Error("NotImplementedException")}}}if(s)return globalThis.fetch(t,e||{credentials:"same-origin"});if(typeof read=="function")return{ok:!0,url:t,headers:{length:0,get:()=>null},arrayBuffer:()=>new Uint8Array(read(t,"binary")),json:()=>JSON.parse(read(t,"utf8")),text:()=>read(t,"utf8")}}catch(s){return{ok:!1,url:t,status:500,headers:{length:0,get:()=>null},statusText:"ERR28: "+s,arrayBuffer:()=>{throw s},json:()=>{throw s},text:()=>{throw s}}}throw new Error("No fetch implementation available")}function Xa(t){return typeof t!="string"&&ee(!1,"url must be a string"),!Ya(t)&&t.indexOf("./")!==0&&t.indexOf("../")!==0&&globalThis.URL&&globalThis.document&&globalThis.document.baseURI&&(t=new URL(t,globalThis.document.baseURI).toString()),t}const Bd=/^[a-zA-Z][a-zA-Z\d+\-.]*?:\/\//,Ud=/[a-zA-Z]:[\\/]/;function Ya(t){return tt||Ps?t.startsWith("/")||t.startsWith("\\")||t.indexOf("///")!==-1||Ud.test(t):Bd.test(t)}let vt,Jt=0;const Mt=[],Ue=[],Ka=new Map,Nn={"js-module-threads":!0,"js-module-globalization":!0,"js-module-runtime":!0,"js-module-dotnet":!0,"js-module-native":!0},$n=Y(M({},Nn),{"js-module-library-initializer":!0}),Za=Y(M({},Nn),{dotnetwasm:!0,heap:!0,manifest:!0}),Hd=Y(M({},$n),{manifest:!0}),So=Y(M({},$n),{dotnetwasm:!0}),ln={dotnetwasm:!0,symbols:!0,"segmentation-rules":!0},zs=Y(M({},$n),{dotnetwasm:!0,symbols:!0,"segmentation-rules":!0}),Vd={symbols:!0,"segmentation-rules":!0};function Qt(t){return!(t.behavior=="icu"&&t.name!=j.preferredIcuAsset)}function es(t,e,s){const o=Object.keys(e||{});ee(o.length==1,"Expect to have one ".concat(s," asset in resources"));const a=o[0],r={name:a,hash:e[a],behavior:s};return Tn(r),t.push(r),r}function Tn(t){Za[t.behavior]&&Ka.set(t.behavior,t)}function Ft(t){const e=(function(s){ee(Za[s],"Unknown single asset behavior ".concat(s));const o=Ka.get(s);return ee(o,"Single asset for ".concat(s," not found")),o})(t);if(!e.resolvedUrl){if(e.resolvedUrl=j.locateFile(e.name),Nn[e.behavior]){const s=er(e);s?(typeof s!="string"&&ee(!1,"loadBootResource response for 'dotnetjs' type should be a URL string"),e.resolvedUrl=s):e.resolvedUrl=Ms(e.resolvedUrl,e.behavior)}else if(e.behavior!=="dotnetwasm")throw new Error("Unknown single asset behavior ".concat(t))}return e}let Co=!1;async function fs(){if(!Co){Co=!0,j.diagnosticTracing&&pe("mono_download_assets");try{const t=[],e=[],s=(i,l)=>{!zs[i.behavior]&&Qt(i)&&j.expected_instantiated_assets_count++,!So[i.behavior]&&Qt(i)&&(j.expected_downloaded_assets_count++,l.push(En(i)))};for(const i of Mt)s(i,t);for(const i of Ue)s(i,e);j.allDownloadsQueued.promise_control.resolve(),Promise.all([...t,...e]).then((()=>{j.allDownloadsFinished.promise_control.resolve()})).catch((i=>{throw j.err("Error in mono_download_assets: "+i),Q(1,i),i})),await j.runtimeModuleLoaded.promise;const o=async i=>{const l=await i;if(l.buffer){if(!zs[l.behavior]){l.buffer&&typeof l.buffer=="object"||ee(!1,"asset buffer must be array-like or buffer-like or promise of these"),typeof l.resolvedUrl!="string"&&ee(!1,"resolvedUrl must be string");const d=l.resolvedUrl,c=await l.buffer,m=new Uint8Array(c);Us(l),await X.beforeOnRuntimeInitialized.promise,X.instantiate_asset(l,d,m)}}else ln[l.behavior]?(l.behavior==="symbols"?(await X.instantiate_symbols_asset(l),Us(l)):l.behavior==="segmentation-rules"&&(await X.instantiate_segmentation_rules_asset(l),Us(l)),ln[l.behavior]&&++j.actual_downloaded_assets_count):(l.isOptional||ee(!1,"Expected asset to have the downloaded buffer"),!So[l.behavior]&&Qt(l)&&j.expected_downloaded_assets_count--,!zs[l.behavior]&&Qt(l)&&j.expected_instantiated_assets_count--)},a=[],r=[];for(const i of t)a.push(o(i));for(const i of e)r.push(o(i));Promise.all(a).then((()=>{Rt||X.coreAssetsInMemory.promise_control.resolve()})).catch((i=>{throw j.err("Error in mono_download_assets: "+i),Q(1,i),i})),Promise.all(r).then((async()=>{Rt||(await X.coreAssetsInMemory.promise,X.allAssetsInMemory.promise_control.resolve())})).catch((i=>{throw j.err("Error in mono_download_assets: "+i),Q(1,i),i}))}catch(t){throw j.err("Error in mono_download_assets: "+t),t}}}let No=!1;function Ja(){if(No)return;No=!0;const t=j.config,e=[];if(t.assets)for(const s of t.assets)typeof s!="object"&&ee(!1,"asset must be object, it was ".concat(typeof s," : ").concat(s)),typeof s.behavior!="string"&&ee(!1,"asset behavior must be known string"),typeof s.name!="string"&&ee(!1,"asset name must be string"),s.resolvedUrl&&typeof s.resolvedUrl!="string"&&ee(!1,"asset resolvedUrl could be string"),s.hash&&typeof s.hash!="string"&&ee(!1,"asset resolvedUrl could be string"),s.pendingDownload&&typeof s.pendingDownload!="object"&&ee(!1,"asset pendingDownload could be object"),s.isCore?Mt.push(s):Ue.push(s),Tn(s);else if(t.resources){const s=t.resources;s.wasmNative||ee(!1,"resources.wasmNative must be defined"),s.jsModuleNative||ee(!1,"resources.jsModuleNative must be defined"),s.jsModuleRuntime||ee(!1,"resources.jsModuleRuntime must be defined"),es(Ue,s.wasmNative,"dotnetwasm"),es(e,s.jsModuleNative,"js-module-native"),es(e,s.jsModuleRuntime,"js-module-runtime"),t.globalizationMode=="hybrid"&&es(e,s.jsModuleGlobalization,"js-module-globalization");const o=(r,i)=>{!s.fingerprinting||r.behavior!="assembly"&&r.behavior!="pdb"&&r.behavior!="resource"||(r.virtualPath=Qa(r.name)),i?(r.isCore=!0,Mt.push(r)):Ue.push(r)};if(s.coreAssembly)for(const r in s.coreAssembly)o({name:r,hash:s.coreAssembly[r],behavior:"assembly"},!0);if(s.assembly)for(const r in s.assembly)o({name:r,hash:s.assembly[r],behavior:"assembly"},!s.coreAssembly);if(t.debugLevel!=0){if(s.corePdb)for(const r in s.corePdb)o({name:r,hash:s.corePdb[r],behavior:"pdb"},!0);if(s.pdb)for(const r in s.pdb)o({name:r,hash:s.pdb[r],behavior:"pdb"},!s.corePdb)}if(t.loadAllSatelliteResources&&s.satelliteResources)for(const r in s.satelliteResources)for(const i in s.satelliteResources[r])o({name:i,hash:s.satelliteResources[r][i],behavior:"resource",culture:r},!s.coreAssembly);if(s.coreVfs)for(const r in s.coreVfs)for(const i in s.coreVfs[r])o({name:i,hash:s.coreVfs[r][i],behavior:"vfs",virtualPath:r},!0);if(s.vfs)for(const r in s.vfs)for(const i in s.vfs[r])o({name:i,hash:s.vfs[r][i],behavior:"vfs",virtualPath:r},!s.coreVfs);const a=Ga(t);if(a&&s.icu)for(const r in s.icu)r===a?Ue.push({name:r,hash:s.icu[r],behavior:"icu",loadRemote:!0}):r.startsWith("segmentation-rules")&&r.endsWith(".json")&&Ue.push({name:r,hash:s.icu[r],behavior:"segmentation-rules"});if(s.wasmSymbols)for(const r in s.wasmSymbols)Mt.push({name:r,hash:s.wasmSymbols[r],behavior:"symbols"})}if(t.appsettings)for(let s=0;s<t.appsettings.length;s++){const o=t.appsettings[s],a=Kd(o);a!=="appsettings.json"&&a!=="appsettings.".concat(t.applicationEnvironment,".json")||Ue.push({name:o,behavior:"vfs",noCache:!0,useCredentials:!0})}t.assets=[...Mt,...Ue,...e]}function Qa(t){var e;const s=(e=j.config.resources)===null||e===void 0?void 0:e.fingerprinting;return s&&s[t]?s[t]:t}async function qd(t){const e=await En(t);return await e.pendingDownloadInternal.response,e.buffer}async function En(t){try{return await Bs(t)}catch(e){if(!j.enableDownloadRetry||Ps||tt||t.pendingDownload&&t.pendingDownloadInternal==t.pendingDownload||t.resolvedUrl&&t.resolvedUrl.indexOf("file://")!=-1||e&&e.status==404)throw e;t.pendingDownloadInternal=void 0,await j.allDownloadsQueued.promise;try{return j.diagnosticTracing&&pe("Retrying download '".concat(t.name,"'")),await Bs(t)}catch(s){return t.pendingDownloadInternal=void 0,await new Promise((o=>globalThis.setTimeout(o,100))),j.diagnosticTracing&&pe("Retrying download (2) '".concat(t.name,"' after delay")),await Bs(t)}}}async function Bs(t){for(;vt;)await vt.promise;try{++Jt,Jt==j.maxParallelDownloads&&(j.diagnosticTracing&&pe("Throttling further parallel downloads"),vt=Qe());const e=await(async function(s){if(s.pendingDownload&&(s.pendingDownloadInternal=s.pendingDownload),s.pendingDownloadInternal&&s.pendingDownloadInternal.response)return s.pendingDownloadInternal.response;if(s.buffer){const i=await s.buffer;return s.resolvedUrl||(s.resolvedUrl="undefined://"+s.name),s.pendingDownloadInternal={url:s.resolvedUrl,name:s.name,response:Promise.resolve({ok:!0,arrayBuffer:()=>i,json:()=>JSON.parse(new TextDecoder("utf-8").decode(i)),text:()=>{throw new Error("NotImplementedException")},headers:{get:()=>{}}})},s.pendingDownloadInternal.response}const o=s.loadRemote&&j.config.remoteSources?j.config.remoteSources:[""];let a;for(let i of o){i=i.trim(),i==="./"&&(i="");const l=Gd(s,i);s.name===l?j.diagnosticTracing&&pe("Attempting to download '".concat(l,"'")):j.diagnosticTracing&&pe("Attempting to download '".concat(l,"' for ").concat(s.name));try{s.resolvedUrl=l;const d=Xd(s);if(s.pendingDownloadInternal=d,a=await d.response,!a||!a.ok)continue;return a}catch(d){a||(a={ok:!1,url:l,status:0,statusText:""+d});continue}}const r=s.isOptional||s.name.match(/\.pdb$/)&&j.config.ignorePdbLoadErrors;if(a||ee(!1,"Response undefined ".concat(s.name)),!r){const i=new Error("download '".concat(a.url,"' for ").concat(s.name," failed ").concat(a.status," ").concat(a.statusText));throw i.status=a.status,i}Fa("optional download '".concat(a.url,"' for ").concat(s.name," failed ").concat(a.status," ").concat(a.statusText))})(t);return e&&(ln[t.behavior]||(t.buffer=await e.arrayBuffer(),++j.actual_downloaded_assets_count)),t}finally{if(--Jt,vt&&Jt==j.maxParallelDownloads-1){j.diagnosticTracing&&pe("Resuming more parallel downloads");const e=vt;vt=void 0,e.promise_control.resolve()}}}function Gd(t,e){let s;return e==null&&ee(!1,"sourcePrefix must be provided for ".concat(t.name)),t.resolvedUrl?s=t.resolvedUrl:(s=e===""?t.behavior==="assembly"||t.behavior==="pdb"?t.name:t.behavior==="resource"&&t.culture&&t.culture!==""?"".concat(t.culture,"/").concat(t.name):t.name:e+t.name,s=Ms(j.locateFile(s),t.behavior)),s&&typeof s=="string"||ee(!1,"attemptUrl need to be path or url string"),s}function Ms(t,e){return j.modulesUniqueQuery&&Hd[e]&&(t+=j.modulesUniqueQuery),t}let $o=0;const To=new Set;function Xd(t){try{t.resolvedUrl||ee(!1,"Request's resolvedUrl must be set");const e=(async function(o){let a=await(async function(r){const i=ms;if(!i||r.noCache||!r.hash||r.hash.length===0)return;const l=_o(r);let d;Ha[l]=!0;try{d=await i.match(l)}catch(m){}if(!d)return;const c=parseInt(d.headers.get("content-length")||"0");return rn[r.name]={responseBytes:c},d})(o);return a||(a=await(function(r){let i=r.resolvedUrl;if(j.loadBootResource){const d=er(r);if(d instanceof Promise)return d;typeof d=="string"&&(i=d)}const l={};return j.config.disableNoCacheFetch||(l.cache="no-cache"),r.useCredentials?l.credentials="include":!j.config.disableIntegrityCheck&&r.hash&&(l.integrity=r.hash),j.fetch_like(i,l)})(o),(function(r,i){const l=ms;if(!l||r.noCache||!r.hash||r.hash.length===0)return;const d=i.clone();setTimeout((()=>{const c=_o(r);(async function(m,f,h,y){const v=await y.arrayBuffer(),_=(function(E){if(typeof performance<"u")return performance.getEntriesByName(E)[0]})(y.url),b=_&&_.encodedBodySize||void 0;an[f]={responseBytes:b};const C=new Response(v,{headers:{"content-type":y.headers.get("content-type")||"","content-length":(b||y.headers.get("content-length")||"").toString()}});try{await m.put(h,C)}catch(E){}})(l,r.name,c,d)}),0)})(o,a)),a})(t),s={name:t.name,url:t.resolvedUrl,response:e};return To.add(t.name),s.response.then((()=>{t.behavior=="assembly"&&j.loadedAssemblies.push(t.name),$o++,j.onDownloadResourceProgress&&j.onDownloadResourceProgress($o,To.size)})),s}catch(e){const s={ok:!1,url:t.resolvedUrl,status:500,statusText:"ERR29: "+e,arrayBuffer:()=>{throw e},json:()=>{throw e}};return{name:t.name,url:t.resolvedUrl,response:Promise.resolve(s)}}}const Yd={resource:"assembly",assembly:"assembly",pdb:"pdb",icu:"globalization",vfs:"configuration",manifest:"manifest",dotnetwasm:"dotnetwasm","js-module-dotnet":"dotnetjs","js-module-native":"dotnetjs","js-module-runtime":"dotnetjs","js-module-threads":"dotnetjs"};function er(t){var e;if(j.loadBootResource){const s=(e=t.hash)!==null&&e!==void 0?e:"",o=t.resolvedUrl,a=Yd[t.behavior];if(a){const r=j.loadBootResource(a,t.name,o,s,t.behavior);return typeof r=="string"?Xa(r):r}}}function Us(t){t.pendingDownloadInternal=null,t.pendingDownload=null,t.buffer=null,t.moduleExports=null}function Kd(t){let e=t.lastIndexOf("/");return e>=0&&e++,t.substring(e)}async function tr(t){if(!t)return;const e=Object.keys(t);await Promise.all(e.map((s=>(async function(o){try{const a=Ms(j.locateFile(o),"js-module-library-initializer");j.diagnosticTracing&&pe("Attempting to import '".concat(a,"' for ").concat(o));const r=await import(a);j.libraryInitializers.push({scriptName:o,exports:r})}catch(a){St("Failed to import library initializer '".concat(o,"': ").concat(a))}})(s))))}async function hs(t,e){if(!j.libraryInitializers)return;const s=[];for(let o=0;o<j.libraryInitializers.length;o++){const a=j.libraryInitializers[o];a.exports[t]&&s.push(Zd(a.scriptName,t,(()=>a.exports[t](...e))))}await Promise.all(s)}async function Zd(t,e,s){try{await s()}catch(o){throw St("Failed to invoke '".concat(e,"' on library initializer '").concat(t,"': ").concat(o)),Q(1,o),o}}var Jd="Release";function de(t,e){if(t===e)return t;const s=M({},e);return s.assets!==void 0&&s.assets!==t.assets&&(s.assets=[...t.assets||[],...s.assets||[]]),s.resources!==void 0&&(s.resources=sr(t.resources||{assembly:{},jsModuleNative:{},jsModuleRuntime:{},wasmNative:{}},s.resources)),s.environmentVariables!==void 0&&(s.environmentVariables=M(M({},t.environmentVariables||{}),s.environmentVariables||{})),s.runtimeOptions!==void 0&&s.runtimeOptions!==t.runtimeOptions&&(s.runtimeOptions=[...t.runtimeOptions||[],...s.runtimeOptions||[]]),Object.assign(t,s)}function At(t,e){if(t===e)return t;const s=M({},e);return s.config&&(t.config||(t.config={}),s.config=de(t.config,s.config)),Object.assign(t,s)}function sr(t,e){if(t===e)return t;const s=M({},e);return s.assembly!==void 0&&(s.assembly=M(M({},t.assembly||{}),s.assembly||{})),s.lazyAssembly!==void 0&&(s.lazyAssembly=M(M({},t.lazyAssembly||{}),s.lazyAssembly||{})),s.pdb!==void 0&&(s.pdb=M(M({},t.pdb||{}),s.pdb||{})),s.jsModuleWorker!==void 0&&(s.jsModuleWorker=M(M({},t.jsModuleWorker||{}),s.jsModuleWorker||{})),s.jsModuleNative!==void 0&&(s.jsModuleNative=M(M({},t.jsModuleNative||{}),s.jsModuleNative||{})),s.jsModuleGlobalization!==void 0&&(s.jsModuleGlobalization=M(M({},t.jsModuleGlobalization||{}),s.jsModuleGlobalization||{})),s.jsModuleRuntime!==void 0&&(s.jsModuleRuntime=M(M({},t.jsModuleRuntime||{}),s.jsModuleRuntime||{})),s.wasmSymbols!==void 0&&(s.wasmSymbols=M(M({},t.wasmSymbols||{}),s.wasmSymbols||{})),s.wasmNative!==void 0&&(s.wasmNative=M(M({},t.wasmNative||{}),s.wasmNative||{})),s.icu!==void 0&&(s.icu=M(M({},t.icu||{}),s.icu||{})),s.satelliteResources!==void 0&&(s.satelliteResources=Eo(t.satelliteResources||{},s.satelliteResources||{})),s.modulesAfterConfigLoaded!==void 0&&(s.modulesAfterConfigLoaded=M(M({},t.modulesAfterConfigLoaded||{}),s.modulesAfterConfigLoaded||{})),s.modulesAfterRuntimeReady!==void 0&&(s.modulesAfterRuntimeReady=M(M({},t.modulesAfterRuntimeReady||{}),s.modulesAfterRuntimeReady||{})),s.extensions!==void 0&&(s.extensions=M(M({},t.extensions||{}),s.extensions||{})),s.vfs!==void 0&&(s.vfs=Eo(t.vfs||{},s.vfs||{})),Object.assign(t,s)}function Eo(t,e){if(t===e)return t;for(const s in e)t[s]=M(M({},t[s]),e[s]);return t}function cs(){const t=j.config;if(t.environmentVariables=t.environmentVariables||{},t.runtimeOptions=t.runtimeOptions||[],t.resources=t.resources||{assembly:{},jsModuleNative:{},jsModuleGlobalization:{},jsModuleWorker:{},jsModuleRuntime:{},wasmNative:{},vfs:{},satelliteResources:{}},t.assets){j.diagnosticTracing&&pe("config.assets is deprecated, use config.resources instead");for(const e of t.assets){const s={};s[e.name]=e.hash||"";const o={};switch(e.behavior){case"assembly":o.assembly=s;break;case"pdb":o.pdb=s;break;case"resource":o.satelliteResources={},o.satelliteResources[e.culture]=s;break;case"icu":o.icu=s;break;case"symbols":o.wasmSymbols=s;break;case"vfs":o.vfs={},o.vfs[e.virtualPath]=s;break;case"dotnetwasm":o.wasmNative=s;break;case"js-module-threads":o.jsModuleWorker=s;break;case"js-module-globalization":o.jsModuleGlobalization=s;break;case"js-module-runtime":o.jsModuleRuntime=s;break;case"js-module-native":o.jsModuleNative=s;break;case"js-module-dotnet":break;default:throw new Error("Unexpected behavior ".concat(e.behavior," of asset ").concat(e.name))}sr(t.resources,o)}}t.debugLevel===void 0&&Jd==="Debug"&&(t.debugLevel=-1),t.cachedResourcesPurgeDelay===void 0&&(t.cachedResourcesPurgeDelay=1e4),t.applicationCulture&&(t.environmentVariables.LANG="".concat(t.applicationCulture,".UTF-8")),X.diagnosticTracing=j.diagnosticTracing=!!t.diagnosticTracing,X.waitForDebugger=t.waitForDebugger,X.enablePerfMeasure=!!t.browserProfilerOptions&&globalThis.performance&&typeof globalThis.performance.measure=="function",j.maxParallelDownloads=t.maxParallelDownloads||j.maxParallelDownloads,j.enableDownloadRetry=t.enableDownloadRetry!==void 0?t.enableDownloadRetry:j.enableDownloadRetry}let Mo=!1;async function nr(t){var e;if(Mo)return void await j.afterConfigLoaded.promise;let s;try{if(t.configSrc||j.config&&Object.keys(j.config).length!==0&&(j.config.assets||j.config.resources)||(t.configSrc="./blazor.boot.json"),s=t.configSrc,Mo=!0,s&&(j.diagnosticTracing&&pe("mono_wasm_load_config"),await(async function(o){const a=j.locateFile(o.configSrc),r=j.loadBootResource!==void 0?j.loadBootResource("manifest","blazor.boot.json",a,"","manifest"):d(a);let i;i=r?typeof r=="string"?await d(Xa(r)):await r:await d(Ms(a,"manifest"));const l=await(async function(c){const m=j.config,f=await c.json();m.applicationEnvironment||(f.applicationEnvironment=c.headers.get("Blazor-Environment")||c.headers.get("DotNet-Environment")||"Production"),f.environmentVariables||(f.environmentVariables={});const h=c.headers.get("DOTNET-MODIFIABLE-ASSEMBLIES");h&&(f.environmentVariables.DOTNET_MODIFIABLE_ASSEMBLIES=h);const y=c.headers.get("ASPNETCORE-BROWSER-TOOLS");return y&&(f.environmentVariables.__ASPNETCORE_BROWSER_TOOLS=y),f})(i);function d(c){return j.fetch_like(c,{method:"GET",credentials:"include",cache:"no-cache"})}de(j.config,l)})(t)),cs(),await tr((e=j.config.resources)===null||e===void 0?void 0:e.modulesAfterConfigLoaded),await hs("onRuntimeConfigLoaded",[j.config]),t.onConfigLoaded)try{await t.onConfigLoaded(j.config,Ot),cs()}catch(o){throw Ct("onConfigLoaded() failed",o),o}cs(),j.afterConfigLoaded.promise_control.resolve(j.config)}catch(o){const a="Failed to load config file ".concat(s," ").concat(o," ").concat(o==null?void 0:o.stack);throw j.config=t.config=Object.assign(j.config,{message:a,error:o,isError:!0}),Q(1,new Error(a)),o}}typeof importScripts!="function"||globalThis.onmessage||(globalThis.dotnetSidecar=!0);const tt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Mn=typeof importScripts=="function",Qd=Mn&&typeof dotnetSidecar<"u",Rt=Mn&&!Qd,Me=typeof window=="object"||Mn&&!tt,Ps=!Me&&!tt;let X={},Pn={},j={},Ot={},st={},Po=!1;const ae={},oe={config:ae},Nt={mono:{},binding:{},internal:st,module:oe,loaderHelpers:j,runtimeHelpers:X,globalizationHelpers:Pn,api:Ot};function ee(t,e){if(t)return;const s="Assert failed: "+(typeof e=="function"?e():e),o=new Error(s);Ct(s,o),X.nativeAbort(o)}function Is(){return j.exitCode!==void 0}function eu(){return X.runtimeReady&&!Is()}function tu(){Is()&&ee(!1,".NET runtime already exited with ".concat(j.exitCode," ").concat(j.exitReason,". You can use runtime.runMain() which doesn't exit the runtime.")),X.runtimeReady||ee(!1,".NET runtime didn't start yet. Please call dotnet.create() first.")}function or(){Me&&(globalThis.addEventListener("unhandledrejection",ir),globalThis.addEventListener("error",lr))}let ps,gs;function ar(t){gs&&gs(t),Q(t,j.exitReason)}function rr(t){ps&&ps(t||j.exitReason),Q(1,t||j.exitReason)}function Q(t,e){var s,o;const a=e&&typeof e=="object";t=a&&typeof e.status=="number"?e.status:t===void 0?-1:t;const r=a&&typeof e.message=="string"?e.message:""+e;(e=a?e:X.ExitStatus?(function(d,c){const m=new X.ExitStatus(d);return m.message=c,m.toString=()=>c,m})(t,r):new Error("Exit with code "+t+" "+r)).status=t,e.message||(e.message=r);const i=""+(e.stack||new Error().stack);try{Object.defineProperty(e,"stack",{get:()=>i})}catch(d){}const l=!!e.silent;if(e.silent=!0,Is())j.diagnosticTracing&&pe("mono_exit called after exit");else{try{oe.onAbort==rr&&(oe.onAbort=ps),oe.onExit==ar&&(oe.onExit=gs),Me&&(globalThis.removeEventListener("unhandledrejection",ir),globalThis.removeEventListener("error",lr)),X.runtimeReady?(X.jiterpreter_dump_stats&&X.jiterpreter_dump_stats(!1),t===0&&(!((s=j.config)===null||s===void 0)&&s.interopCleanupOnExit)&&X.forceDisposeProxies(!0,!0),Md&&t!==0&&((o=j.config)===null||o===void 0||o.dumpThreadsOnNonZeroExit)):(j.diagnosticTracing&&pe("abort_startup, reason: ".concat(e)),(function(d){j.allDownloadsQueued.promise_control.reject(d),j.allDownloadsFinished.promise_control.reject(d),j.afterConfigLoaded.promise_control.reject(d),j.wasmCompilePromise.promise_control.reject(d),j.runtimeModuleLoaded.promise_control.reject(d),X.dotnetReady&&(X.dotnetReady.promise_control.reject(d),X.afterInstantiateWasm.promise_control.reject(d),X.beforePreInit.promise_control.reject(d),X.afterPreInit.promise_control.reject(d),X.afterPreRun.promise_control.reject(d),X.beforeOnRuntimeInitialized.promise_control.reject(d),X.afterOnRuntimeInitialized.promise_control.reject(d),X.afterPostRun.promise_control.reject(d))})(e))}catch(d){St("mono_exit A failed",d)}try{l||((function(d,c){if(d!==0&&c){const m=X.ExitStatus&&c instanceof X.ExitStatus?pe:Ct;typeof c=="string"?m(c):(c.stack===void 0&&(c.stack=new Error().stack+""),c.message?m(X.stringify_as_error_with_stack?X.stringify_as_error_with_stack(c.message+"\n"+c.stack):c.message+"\n"+c.stack):m(JSON.stringify(c)))}!Rt&&j.config&&(j.config.logExitCode?j.config.forwardConsoleLogsToWS?wo("WASM EXIT "+d):Oa("WASM EXIT "+d):j.config.forwardConsoleLogsToWS&&wo())})(t,e),(function(d){if(Me&&!Rt&&j.config&&j.config.appendElementOnExit&&document){const c=document.createElement("label");c.id="tests_done",d!==0&&(c.style.background="red"),c.innerHTML=""+d,document.body.appendChild(c)}})(t))}catch(d){St("mono_exit B failed",d)}j.exitCode=t,j.exitReason||(j.exitReason=e),!Rt&&X.runtimeReady&&oe.runtimeKeepalivePop()}if(j.config&&j.config.asyncFlushOnExit&&t===0)throw(async()=>{try{await(async function(){try{const d=await jt(()=>import("./kfhqwutw8t3jh6aj.js").then(v=>v.b),__vite__mapDeps([0,1])),c=v=>new Promise(((_,b)=>{v.on("error",b),v.end("","utf8",_)})),m=c(d.stderr),f=c(d.stdout);let h;const y=new Promise((v=>{h=setTimeout((()=>v("timeout")),1e3)}));await Promise.race([Promise.all([f,m]),y]),clearTimeout(h)}catch(d){Ct("flushing std* streams failed: ".concat(d))}})()}finally{Io(t,e)}})(),e;Io(t,e)}function Io(t,e){if(X.runtimeReady&&X.nativeExit)try{X.nativeExit(t)}catch(s){!X.ExitStatus||s instanceof X.ExitStatus||St("set_exit_code_and_quit_now failed: "+s.toString())}if(t!==0||!Me)throw tt&&st.process?st.process.exit(t):X.quit&&X.quit(t,e),e}function ir(t){cr(t,t.reason,"rejection")}function lr(t){cr(t,t.error,"error")}function cr(t,e,s){t.preventDefault();try{e||(e=new Error("Unhandled "+s)),e.stack===void 0&&(e.stack=new Error().stack),e.stack=e.stack+"",e.silent||(Ct("Unhandled error:",e),Q(1,e))}catch(o){}}(function(t){if(Po)throw new Error("Loader module already loaded");Po=!0,X=t.runtimeHelpers,Pn=t.globalizationHelpers,j=t.loaderHelpers,Ot=t.api,st=t.internal,Object.assign(Ot,{INTERNAL:st,invokeLibraryInitializers:hs}),Object.assign(t.module,{config:de(ae,{environmentVariables:{}})});const e={mono_wasm_bindings_is_ready:!1,config:t.module.config,diagnosticTracing:!1,nativeAbort:o=>{throw o||new Error("abort")},nativeExit:o=>{throw new Error("exit:"+o)}},s={gitHash:"fa7cdded37981a97cec9a3e233c4a6af58a91c57",config:t.module.config,diagnosticTracing:!1,maxParallelDownloads:16,enableDownloadRetry:!0,_loaded_files:[],loadedFiles:[],loadedAssemblies:[],libraryInitializers:[],workerNextNumber:1,actual_downloaded_assets_count:0,actual_instantiated_assets_count:0,expected_downloaded_assets_count:0,expected_instantiated_assets_count:0,afterConfigLoaded:Qe(),allDownloadsQueued:Qe(),allDownloadsFinished:Qe(),wasmCompilePromise:Qe(),runtimeModuleLoaded:Qe(),loadingWorkers:Qe(),is_exited:Is,is_runtime_running:eu,assert_runtime_running:tu,mono_exit:Q,createPromiseController:Qe,getPromiseController:Ad,assertIsControllablePromise:Rd,mono_download_assets:fs,resolve_single_asset_path:Ft,setup_proxy_console:za,set_thread_prefix:Dd,logDownloadStatsToConsole:Od,purgeUnusedCacheEntriesAsync:Wd,installUnhandledErrorHandler:or,retrieve_asset_download:qd,invokeLibraryInitializers:hs,exceptions:Pd,simd:Id};Object.assign(X,e),Object.assign(j,s)})(Nt);let ts,ss,Ao=!1,Ro=!1;async function dr(t){if(!Ro){if(Ro=!0,Me&&j.config.forwardConsoleLogsToWS&&globalThis.WebSocket!==void 0&&za("main",globalThis.console,globalThis.location.origin),oe||ee(!1,"Null moduleConfig"),j.config||ee(!1,"Null moduleConfig.config"),typeof t=="function"){const e=t(Nt.api);if(e.ready)throw new Error("Module.ready couldn't be redefined.");Object.assign(oe,e),At(oe,e)}else{if(typeof t!="object")throw new Error("Can't use moduleFactory callback of createDotnetRuntime function.");At(oe,t)}await(async function(e){if(tt){const r=await jt(()=>import("./kfhqwutw8t3jh6aj.js").then(l=>l.b),__vite__mapDeps([0,1])),i=14;if(r.versions.node.split(".")[0]<i)throw new Error("NodeJS at '".concat(r.execPath,"' has too low version '").concat(r.versions.node,"', please use at least ").concat(i,". See also https://aka.ms/dotnet-wasm-features"))}const s=import.meta.url,o=s.indexOf("?");var a;if(o>0&&(j.modulesUniqueQuery=s.substring(o)),j.scriptUrl=s.replace(/\\/g,"/").replace(/[?#].*/,""),j.scriptDirectory=(a=j.scriptUrl).slice(0,a.lastIndexOf("/"))+"/",j.locateFile=r=>"URL"in globalThis&&globalThis.URL!==ko?new URL(r,j.scriptDirectory).toString():Ya(r)?r:j.scriptDirectory+r,j.fetch_like=zd,j.out=console.log,j.err=console.error,j.onDownloadResourceProgress=e.onDownloadResourceProgress,Me&&globalThis.navigator){const r=globalThis.navigator,i=r.userAgentData&&r.userAgentData.brands;i&&i.length>0?j.isChromium=i.some((l=>l.brand==="Google Chrome"||l.brand==="Microsoft Edge"||l.brand==="Chromium")):r.userAgent&&(j.isChromium=r.userAgent.includes("Chrome"),j.isFirefox=r.userAgent.includes("Firefox"))}st.require=tt?await jt(()=>import("./d0xa318sl7ywi0za.js").then(r=>r.As),__vite__mapDeps([2,1,3])).then((r=>r.createRequire(import.meta.url))):Promise.resolve((()=>{throw new Error("require not supported")})),globalThis.URL===void 0&&(globalThis.URL=ko)})(oe)}}async function su(t){return await dr(t),ps=oe.onAbort,gs=oe.onExit,oe.onAbort=rr,oe.onExit=ar,oe.ENVIRONMENT_IS_PTHREAD?(async function(){(function(){const o=new MessageChannel,a=o.port1,r=o.port2;a.addEventListener("message",(i=>{var l,d;l=JSON.parse(i.data.config),d=JSON.parse(i.data.monoThreadInfo),Ao?j.diagnosticTracing&&pe("mono config already received"):(de(j.config,l),X.monoThreadInfo=d,cs(),j.diagnosticTracing&&pe("mono config received"),Ao=!0,j.afterConfigLoaded.promise_control.resolve(j.config),Me&&l.forwardConsoleLogsToWS&&globalThis.WebSocket!==void 0&&j.setup_proxy_console("worker-idle",console,globalThis.location.origin)),a.close(),r.close()}),{once:!0}),a.start(),self.postMessage({[Ld]:{monoCmd:"preload",port:r}},[r])})(),await j.afterConfigLoaded.promise,(function(){const o=j.config;o.assets||ee(!1,"config.assets must be defined");for(const a of o.assets)Tn(a),Vd[a.behavior]&&Ue.push(a)})(),setTimeout((async()=>{try{await fs()}catch(o){Q(1,o)}}),0);const e=Lo(),s=await Promise.all(e);return await Do(s),oe})():(async function(){var e;await nr(oe),Ja();const s=Lo();await Va(),(async function(){try{const a=Ft("dotnetwasm");await En(a),a&&a.pendingDownloadInternal&&a.pendingDownloadInternal.response||ee(!1,"Can't load dotnet.native.wasm");const r=await a.pendingDownloadInternal.response,i=r.headers&&r.headers.get?r.headers.get("Content-Type"):void 0;let l;if(typeof WebAssembly.compileStreaming=="function"&&i==="application/wasm")l=await WebAssembly.compileStreaming(r);else{Me&&i!=="application/wasm"&&St('WebAssembly resource does not have the expected content type "application/wasm", so falling back to slower ArrayBuffer instantiation.');const d=await r.arrayBuffer();j.diagnosticTracing&&pe("instantiate_wasm_module buffered"),l=Ps?await Promise.resolve(new WebAssembly.Module(d)):await WebAssembly.compile(d)}a.pendingDownloadInternal=null,a.pendingDownload=null,a.buffer=null,a.moduleExports=null,j.wasmCompilePromise.promise_control.resolve(l)}catch(a){j.wasmCompilePromise.promise_control.reject(a)}})(),setTimeout((async()=>{try{qa(),await fs()}catch(a){Q(1,a)}}),0);const o=await Promise.all(s);return await Do(o),await X.dotnetReady.promise,await tr((e=j.config.resources)===null||e===void 0?void 0:e.modulesAfterRuntimeReady),await hs("onRuntimeReady",[Nt.api]),Ot})()}function Lo(){const t=Ft("js-module-runtime"),e=Ft("js-module-native");return ts&&ss||(typeof t.moduleExports=="object"?ts=t.moduleExports:(j.diagnosticTracing&&pe("Attempting to import '".concat(t.resolvedUrl,"' for ").concat(t.name)),ts=import(t.resolvedUrl)),typeof e.moduleExports=="object"?ss=e.moduleExports:(j.diagnosticTracing&&pe("Attempting to import '".concat(e.resolvedUrl,"' for ").concat(e.name)),ss=import(e.resolvedUrl))),[ts,ss]}async function Do(t){const{initializeExports:e,initializeReplacements:s,configureRuntimeStartup:o,configureEmscriptenStartup:a,configureWorkerStartup:r,setRuntimeGlobals:i,passEmscriptenInternals:l}=t[0],{default:d}=t[1];if(i(Nt),e(Nt),j.config.globalizationMode==="hybrid"){const c=await(async function(){let f;const h=Ft("js-module-globalization");return typeof h.moduleExports=="object"?f=h.moduleExports:(pe("Attempting to import '".concat(h.resolvedUrl,"' for ").concat(h.name)),f=import(h.resolvedUrl)),await f})(),{initHybrid:m}=c;m(Pn,X)}await o(oe),j.runtimeModuleLoaded.promise_control.resolve(),d((c=>(Object.assign(oe,{ready:c.ready,__dotnet_runtime:{initializeReplacements:s,configureEmscriptenStartup:a,configureWorkerStartup:r,passEmscriptenInternals:l}}),oe))).catch((c=>{throw c.message&&c.message.toLowerCase().includes("out of memory")?new Error(".NET runtime has failed to start, because too much memory was requested. Please decrease the memory by adjusting EmccMaximumHeapSize. See also https://aka.ms/dotnet-wasm-features"):c}))}const nu=new class{withModuleConfig(t){try{return At(oe,t),this}catch(e){throw Q(1,e),e}}withOnConfigLoaded(t){try{return At(oe,{onConfigLoaded:t}),this}catch(e){throw Q(1,e),e}}withConsoleForwarding(){try{return de(ae,{forwardConsoleLogsToWS:!0}),this}catch(t){throw Q(1,t),t}}withExitOnUnhandledError(){try{return de(ae,{exitOnUnhandledError:!0}),or(),this}catch(t){throw Q(1,t),t}}withAsyncFlushOnExit(){try{return de(ae,{asyncFlushOnExit:!0}),this}catch(t){throw Q(1,t),t}}withExitCodeLogging(){try{return de(ae,{logExitCode:!0}),this}catch(t){throw Q(1,t),t}}withElementOnExit(){try{return de(ae,{appendElementOnExit:!0}),this}catch(t){throw Q(1,t),t}}withInteropCleanupOnExit(){try{return de(ae,{interopCleanupOnExit:!0}),this}catch(t){throw Q(1,t),t}}withDumpThreadsOnNonZeroExit(){try{return de(ae,{dumpThreadsOnNonZeroExit:!0}),this}catch(t){throw Q(1,t),t}}withWaitingForDebugger(t){try{return de(ae,{waitForDebugger:t}),this}catch(e){throw Q(1,e),e}}withInterpreterPgo(t,e){try{return de(ae,{interpreterPgo:t,interpreterPgoSaveDelay:e}),ae.runtimeOptions?ae.runtimeOptions.push("--interp-pgo-recording"):ae.runtimeOptions=["--interp-pgo-recording"],this}catch(s){throw Q(1,s),s}}withConfig(t){try{return de(ae,t),this}catch(e){throw Q(1,e),e}}withConfigSrc(t){try{return t&&typeof t=="string"||ee(!1,"must be file path or URL"),At(oe,{configSrc:t}),this}catch(e){throw Q(1,e),e}}withVirtualWorkingDirectory(t){try{return t&&typeof t=="string"||ee(!1,"must be directory path"),de(ae,{virtualWorkingDirectory:t}),this}catch(e){throw Q(1,e),e}}withEnvironmentVariable(t,e){try{const s={};return s[t]=e,de(ae,{environmentVariables:s}),this}catch(s){throw Q(1,s),s}}withEnvironmentVariables(t){try{return t&&typeof t=="object"||ee(!1,"must be dictionary object"),de(ae,{environmentVariables:t}),this}catch(e){throw Q(1,e),e}}withDiagnosticTracing(t){try{return typeof t!="boolean"&&ee(!1,"must be boolean"),de(ae,{diagnosticTracing:t}),this}catch(e){throw Q(1,e),e}}withDebugging(t){try{return t!=null&&typeof t=="number"||ee(!1,"must be number"),de(ae,{debugLevel:t}),this}catch(e){throw Q(1,e),e}}withApplicationArguments(...t){try{return t&&Array.isArray(t)||ee(!1,"must be array of strings"),de(ae,{applicationArguments:t}),this}catch(e){throw Q(1,e),e}}withRuntimeOptions(t){try{return t&&Array.isArray(t)||ee(!1,"must be array of strings"),ae.runtimeOptions?ae.runtimeOptions.push(...t):ae.runtimeOptions=t,this}catch(e){throw Q(1,e),e}}withMainAssembly(t){try{return de(ae,{mainAssemblyName:t}),this}catch(e){throw Q(1,e),e}}withApplicationArgumentsFromQuery(){try{if(!globalThis.window)throw new Error("Missing window to the query parameters from");if(globalThis.URLSearchParams===void 0)throw new Error("URLSearchParams is supported");const t=new URLSearchParams(globalThis.window.location.search).getAll("arg");return this.withApplicationArguments(...t)}catch(t){throw Q(1,t),t}}withApplicationEnvironment(t){try{return de(ae,{applicationEnvironment:t}),this}catch(e){throw Q(1,e),e}}withApplicationCulture(t){try{return de(ae,{applicationCulture:t}),this}catch(e){throw Q(1,e),e}}withResourceLoader(t){try{return j.loadBootResource=t,this}catch(e){throw Q(1,e),e}}async download(){try{await(async function(){dr(oe),await nr(oe),Ja(),await Va(),qa(),fs(),await j.allDownloadsFinished.promise})()}catch(t){throw Q(1,t),t}}async create(){try{return this.instance||(this.instance=await(async function(){return await su(oe),Nt.api})()),this.instance}catch(t){throw Q(1,t),t}}async run(){try{return oe.config||ee(!1,"Null moduleConfig.config"),this.instance||await this.create(),this.instance.runMainAndExit()}catch(t){throw Q(1,t),t}}};Ps||typeof globalThis.URL=="function"||ee(!1,"This browser/engine doesn't support URL API. Please use a modern version. See also https://aka.ms/dotnet-wasm-features"),typeof globalThis.BigInt64Array!="function"&&ee(!1,"This browser/engine doesn't support BigInt64Array API. Please use a modern version. See also https://aka.ms/dotnet-wasm-features");let ns=null;async function ou(){const t=await nu.withConfig(Ed).withResourceLoader((s,o,a,r)=>s==="dotnetjs"?a:new URL(a,location.href).origin!==location.origin?fetch(a,{credentials:"omit",integrity:r}):a).create(),e=t.getConfig().mainAssemblyName;return e?t.getAssemblyExports(e):null}const au=()=>(ns!=null||(ns=ou()),ns);function ru(){"use forget";const t=ue.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=au(),t[0]=e):e=t[0],e}const iu=fn(()=>jt(()=>import("./ma98yesntrsi1rr9.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12,13,14,15])).then(t=>t.WalnutMiniPlayer)),lu=({citation:t,conversation:e,messageId:s})=>{var P,u,D,R,z;const o=ru(),[a,r]=g.useState(!1),[i,l]=g.useState(null),[d,c]=g.useState(!1),m=!!((u=(P=g.useContext(dt))==null?void 0:P.message.metadata)!=null&&u.is_standalone_share_attachment),f=ri(),{presentationMap:h,updatePresentationMap:y,open:v}=ec(),_=ye(),b=_s(e.id),C=ve(_,"3154019201")&&!!b,E=ve(_,"638971034"),p=ii(_,"2888003541").value,w=Number((D=p==null?void 0:p.max_bytes)!=null?D:3e7),N=ks(),k=g.useRef(null),$=g.useCallback(V=>{N.danger(V,{toastId:"w_failed_to_download_file"})},[N]),S=!!t.file_id,I=jn(!1,e.id,t.file_id,()=>{},$),W=(R=h[t.file_id])==null?void 0:R.presentation,x=(z=h[t.file_id])==null?void 0:z.workbook,L=g.useCallback(async V=>{if(e.id!==void 0){V.preventDefault();const{data:Z}=await I.refetch();if(Z===void 0||(Z==null?void 0:Z.status)!=="success"){N.danger("Failed to download file");return}const te=document.createElement("a");te.href=Z.download_url,te.click()}},[e.id,I,N]),{refetch:F}=I,O=un();g.useEffect(()=>{var Z;(Z=k.current)==null||Z.abort();const V=new AbortController;return k.current=V,r(!0),(async()=>{var me;let te=!1;try{const{data:re}=await F();if(re===void 0||(re==null?void 0:re.status)!=="success"){N.danger("Failed to download file");return}const fe=await fetch(re.download_url,{headers:O?{}:mn(),signal:V.signal});if(!fe.ok)throw new Error("HTTP ".concat(fe.status));const se=await fe.blob();if(w!==0&&se.size>w){c(!0),l("fileTooLarge"),te=!0;return}const ke=new Uint8Array(await se.arrayBuffer()),he=(me=lo(t.file_name))!=null?me:"pptx";if(he==="pptx"){let le;if(E)le=await yo(ke,he);else{const Pe=await o;if(!Pe)return;le=Pe.PptxReader.ExtractSlidesProto(ke,!1)}const xe=Zl.decode(le);y(t.file_id,{fileBlob:se,fileName:t.file_name,presentation:xe,workbook:null,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}else{let le;if(E)le=await yo(ke,he);else{const Pe=await o;if(!Pe)return;le=Pe.XlsxReader.ExtractXlsxProto(ke,!1)}const xe=Jl.decode(le);y(t.file_id,{fileBlob:se,fileName:t.file_name,presentation:null,workbook:xe,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}}catch(re){re.name!=="AbortError"&&(c(!0),Ss.addError(re,{file_id:t.file_id}))}finally{r(!1),f&&!te&&v(t.file_id)}})(),()=>{var te;(te=k.current)==null||te.abort()}},[F,N,y,t.file_name,t.file_id,f,v,w,O,o,E]);function T(V){V.preventDefault(),v(t.file_id)}const{onClick:B,isLoading:q,isEnabled:H}=La({conversation:e,messageId:s,fileId:t.file_id,fileName:t.file_name,processedMarkdownInfo:null,isStandaloneAttachment:!0}),U=m&&!f,G=lo(t.file_name);return n.jsxs("div",{className:A("border-token-border-light flex max-w-[calc(0.8*var(--thread-content-max-width,40rem))] flex-col overflow-hidden rounded-lg border",m&&"mx-auto my-0"),children:[n.jsxs("div",{className:"text-token-text-secondary border-token-border-light flex flex-row justify-between gap-4 border-b p-2",children:[n.jsxs("div",{className:"flex flex-row items-center gap-2 overflow-hidden",children:[n.jsx(Xl,{fileName:t.file_name}),n.jsx("div",{className:"truncate text-sm font-medium",children:G==="pptx"?n.jsx(K,{id:"HTIcmf",defaultMessage:"Presentation"}):n.jsx(K,{id:"pftlup",defaultMessage:"Spreadsheet"})})]}),n.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center",children:[!U&&n.jsxs(n.Fragment,{children:[S&&n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",onClick:L,children:n.jsx(il,{})}),n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary disabled:text-token-text-tertiary rounded-full p-1 disabled:cursor-not-allowed disabled:bg-transparent",disabled:!W&&!x,onClick:T,children:n.jsx(Kl,{})})]}),C&&!!s&&H&&n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",disabled:!H,onClick:B,children:q?n.jsx(zt,{}):n.jsx(cu,{})})]})]}),n.jsxs("div",{className:"bg-token-bg-secondary group relative p-2",children:[n.jsx(iu,{walnutId:t.file_id,isLoading:a,isError:d,isInShareModal:U,errorMessage:i,handleDownloadClick:L}),U&&n.jsx("div",{className:"absolute end-5 top-46 z-10 inline-flex flex-shrink-0 items-end justify-end",children:n.jsx(ll,{className:A("inline h-4 w-24 text-end")})})]})]})},cu=({className:t})=>n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:t,children:[n.jsx("path",{d:"M3 12.4428V12.2806C3 11.9219 3.2843 11.631 3.63497 11.631C3.98563 11.631 4.26993 11.9219 4.26993 12.2806V12.4428C4.26993 13.1372 4.2708 13.6193 4.3007 13.994C4.33 14.3609 4.38426 14.5675 4.46108 14.7218L4.52821 14.8459C4.69655 15.1266 4.93812 15.3556 5.22657 15.5061L5.35059 15.5604C5.48786 15.6107 5.6688 15.6476 5.938 15.6701C6.30417 15.7008 6.77519 15.7007 7.45408 15.7007H12.546C13.2246 15.7007 13.6959 15.7008 14.0621 15.6701C14.4204 15.6402 14.6226 15.5846 14.7735 15.5061L14.8946 15.4364C15.169 15.2642 15.3929 15.0169 15.5399 14.7218L15.593 14.595C15.6421 14.4546 15.6782 14.2692 15.7003 13.994C15.7301 13.6193 15.73 13.1372 15.73 12.4428V12.2806C15.73 11.922 16.0145 11.6312 16.3651 11.631C16.7157 11.631 17 11.9219 17 12.2806V12.4428C17 13.1158 17.0006 13.6601 16.9655 14.0999C16.9342 14.4916 16.8722 14.8443 16.7343 15.1731L16.6709 15.3123C16.4174 15.8213 16.0318 16.2469 15.5585 16.544L15.3506 16.6632C14.9909 16.8507 14.6028 16.9281 14.1655 16.9646C13.7356 17.0006 13.2038 17 12.546 17H7.45408C6.79615 17 6.26438 17.0006 5.8345 16.9646C5.45207 16.9327 5.10749 16.8699 4.78649 16.729L4.65035 16.6632C4.1528 16.4038 3.73604 16.0094 3.44569 15.5251L3.32914 15.3123C3.14585 14.9444 3.07023 14.5473 3.03451 14.0999C2.9994 13.6601 3 13.1158 3 12.4428Z"}),n.jsx("path",{d:"M9.99993 13.2544C10.3505 13.2544 10.6348 12.9635 10.6348 12.6047V5.218L12.7337 7.36545L12.8335 7.44845C13.0799 7.61506 13.4146 7.58749 13.6316 7.36545C13.8486 7.14342 13.8756 6.80101 13.7127 6.54884L13.6316 6.44677L10.4493 3.19088C10.3302 3.06897 10.1683 3 9.99993 3C9.8316 3.0001 9.67044 3.06906 9.55138 3.19088L6.36815 6.44677C6.12048 6.70037 6.12057 7.11179 6.36815 7.36545C6.58526 7.58755 6.92077 7.61523 7.1673 7.44845L7.26707 7.36545L9.36491 5.21897V12.6047C9.36491 12.9634 9.64934 13.2542 9.99993 13.2544Z"})]}),du=new Set(["jpg","jpeg","png","gif","webp","svg"]),uu=t=>{const e=t.split(".").pop();return e?du.has(e):!1};function mu({citation:t,conversation:e,messageId:s}){var d;const o=ye(),a=li(),r=ci(),i=g.useRef(a!==oo.Research),l=hn(e.serverId$);if(g.useEffect(()=>{!i.current&&a===oo.Research&&(i.current=!0,r(null))},[a,r]),Yl(t.file_name)&&ve(o,"3392860057"))return n.jsx(lu,{citation:t,conversation:e,messageId:s,children:(d=t.label)!=null?d:t.file_name});if(jd(t.file_name))return n.jsx(kd,{citation:t,conversation:e,messageId:s});if(l)return n.jsx(fu,{citation:t,serverThreadId:l})}function fu({citation:t,serverThreadId:e}){var r,i;const s=ks(),o=g.useCallback(l=>{s.danger(l,{toastId:"fcoa_renderer_failed_to_download_file"})},[s]),{data:a}=jn(!0,e,t.file_id,void 0,o);return uu(t.file_name)&&(a!=null&&a.download_url)?n.jsx("img",{src:a==null?void 0:a.download_url,alt:(r=t.label)!=null?r:t.file_name,className:"max-h-[350px] max-w-screen"}):n.jsx("a",{href:a==null?void 0:a.download_url,children:(i=t.label)!=null?i:t.file_name})}function hu({citationIndex:t,conversation:e,nodeType:s,messageId:o}){var l;const a=parseInt(t,10),r=g.useContext(dt);if(!r)return null;const i=(l=r.n7jupdCrefs)==null?void 0:l[a];if(!i)return null;switch(i.type){case"clipboard":return n.jsx(wd,{citation:i});case"computer_output":return n.jsx(vd,{citation:i,conversation:e,nodeType:s});case"file":return n.jsx(mu,{citation:i,conversation:e,messageId:o});case"invalid":return null}}function pu(t){return t&&/^turn[0-9]+ifs[0-9]+$/.test(t)}function gu({path:t,lineRangeStart:e,lineRangeEnd:s,gitUrl:o}){const[a,r]=g.useState(!1),i=g.useContext(Ts),l=g.useRef(null),d=g.useRef(null),c=g.useRef(null),m=()=>{c.current&&(clearTimeout(c.current),c.current=null),r(!0)},f=()=>{c.current=window.setTimeout(()=>{r(!1)},200)};if(!t)return null;const h=i==null?void 0:i.fileSnapshots.find(v=>v.path===t);if(!h)return null;const y=bu(e,s,h);return y.length?n.jsxs(xn,{open:a,onOpenChange:r,children:[n.jsx(bn,{asChild:!0,onMouseEnter:m,onMouseLeave:f,children:n.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:n.jsx(hc,{className:"size-[10px]"})})}),n.jsx(yn,{children:n.jsx(wn,{ref:d,className:"z-50 focus:outline-none",side:"right",onMouseEnter:m,onMouseLeave:f,onOpenAutoFocus:v=>v.preventDefault(),children:n.jsx(xu,{snapshot:h,snippetLines:y,lineRangeStart:e,lineRangeEnd:s,gitUrl:o})})})]}):null}function xu({snapshot:t,snippetLines:e,lineRangeStart:s,lineRangeEnd:o,gitUrl:a}){var d;const r=(d=t.path.split(".").pop())!=null?d:"sh",i=e.reduce((c,m)=>{if(m.trim()==="")return c;const f=m.match(/^\s*/),h=f?f[0].length:0;return c===-1?h:Math.min(c,h)},-1),l=e.map(c=>i>0?c.slice(i):c).join("\n");return n.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex max-h-[600px] flex-col rounded-2xl border px-2 pt-2 pb-4 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[l&&n.jsx(cl,{wrapperClassName:"rounded-lg !bg-token-bg-tertiary !border-none mb-3 max-h-[400px] overflow-auto text-xs w-[600px] max-w-full",codeContainerClassName:"!p-2",language:r,content:l,showActionBar:!1}),n.jsxs("div",{className:"grid w-full grid-cols-[minmax(0,1fr)_auto] items-center justify-between gap-1 px-2 text-sm",children:[t.path,n.jsxs("div",{className:"text-token-text-tertiary flex items-center gap-1 whitespace-nowrap",children:[n.jsx(K,{id:"wham.citation.file.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:s,lineRangeEnd:o}}),a&&n.jsx("a",{className:"group flex w-full items-center gap-1 p-1",href:a,target:"_blank",rel:"noopener noreferrer",children:n.jsx(di,{className:"icon-xs hover:text-token-text-primary"})})]})]})]})}function bu(t,e,s){var i;if(s.contents){const l=s.contents.split("\n"),d=Math.max(0,t-1),c=e?Math.min(l.length,e):d+1;return l.slice(d,c)}const o=(i=s.line_range_contents)==null?void 0:i.find(l=>yu(l,t,e));if(!o)return[];const a=Math.max(t-o.line_range_start,0),r=a+(e-t+1);return o.content.slice(a,r)}function yu(t,e,s){return e<t.line_range_start?!1:!(s>t.line_range_end)}function wu({assetPointer:t}){var i,l,d,c,m;const e=g.useContext(Ts),s=ie(),o=e==null?void 0:e.imagePointers.find(f=>f.asset_pointer===t),a=Sa({asset:{content_type:ma.ImageAssetPointer,asset_pointer:(i=o==null?void 0:o.asset_pointer)!=null?i:"",size_bytes:(l=o==null?void 0:o.size_bytes)!=null?l:0,width:(d=o==null?void 0:o.width)!=null?d:0,height:(c=o==null?void 0:o.height)!=null?c:0}});if(!o||!((m=a.data)!=null&&m.url))return null;const r=s.formatMessage({id:"wham.contentReference.imageAlt",defaultMessage:"Captured screenshot"});return n.jsx(dl,{src:a.data.url,alt:r,className:"max-h-[250px] max-w-[250px]",children:n.jsx(ul,{src:a.data.url,alt:r,width:o.width,height:o.height,className:"max-h-[250px] max-w-[250px] object-contain"})})}function vu(){const t=fa.getItem(ha.ProposedTasks);return t&&typeof t=="object"?t:{}}const Fo=ui(t=>({tasks:vu(),store(e){t(s=>{const o=Y(M({},s.tasks),{[e.contentId]:e});return fa.setItem(ha.ProposedTasks,o),{tasks:o}})}}));function _u({title:t,prompt:e,environmentId:s,branch:o,contentId:a,hasHitRateLimit:r}){const[i,l]=g.useState(!1),d=mi(),{setEnvironmentId:c,setBranch:m}=xc(),{refetch:f}=bc(),h=ie(),y=ks(),v=Fo(w=>w.tasks[a]),_=Fo(w=>w.store),{mutate:b,isPending:C}=Ir({mutationFn:()=>wc.createNewTask(s,o,e,!1).catch(w=>{throw y.danger(Pt({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task"}),{id:"suggestion-".concat(a),duration:5,hasCloseButton:!0,toastId:"wham_proposed_task_failed_to_create_task"}),w}),onSuccess:async w=>{await f(),E(w)}}),E=w=>{try{const N=w.task.id,k=w.turn.id,$="/codex/tasks/".concat(N);_({contentId:a,prompt:e,scheduledTaskId:N,turnId:k,url:$}),l(!1)}catch(N){}},p=!s||!o||C||r;return n.jsxs("div",{className:A("mt-1 mb-3 flex w-full items-center rounded-xl px-3 py-3",v?"bg-token-bg-secondary border border-transparent":"bg-token-bg-primary border-token-border-default border shadow-[0px_1px_1px_0px_rgba(0,0,0,0.05)]"),children:[n.jsxs("div",{className:A("group flex flex-1 items-center gap-1",!v&&"-my-3 py-3",!v&&!p&&"cursor-pointer"),onClick:()=>{p||v||(c(s),m(o),l(!0),co.recordProposedTaskClicked("edit"))},children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("span",{className:"text-token-text-tertiary text-xs",children:n.jsx(K,{id:"wham.whamProposedTask.title",defaultMessage:"Suggested task"})}),n.jsx("span",{className:A("text-sm font-medium",v&&"text-token-text-tertiary"),children:t})]}),!p&&!v&&n.jsx(ml,{className:"icon-sm text-token-text-secondary mb-0.5 cursor-pointer self-end opacity-0 transition-opacity group-hover:opacity-100"})]}),n.jsx("div",{className:"flex items-center justify-end gap-2 text-xs",children:v?n.jsx(Ve,{size:"small",color:"secondary",as:"a",to:v==null?void 0:v.url,openNewTab:!0,children:n.jsx("span",{className:"text-token-text-primary font-medium",children:n.jsx(K,{id:"lwqFNG",defaultMessage:"View task"})})}):n.jsx(ju,{prompt:r?h.formatMessage({id:"wham.proposedTask.hitRateLimit",defaultMessage:"You have reached your rate limit"}):e,tooltipEnabled:!v&&!i,children:n.jsx(Ve,{size:"small",color:"secondary",disabled:p,onClick:()=>{co.recordProposedTaskClicked("create"),b()},children:n.jsxs("div",{className:"flex items-center gap-0.5",children:[n.jsx(K,{id:"b2N2Y8",defaultMessage:"Start task"}),C?n.jsx(zt,{className:"icon-xs me-[2px]"}):n.jsx(fl,{className:"icon-sm"})]})})})}),n.jsx(ot.Root,{testId:"modal-task-stub-composer",isOpen:i,onClose:()=>l(!1),children:n.jsx(ot.Overlay,{children:n.jsxs(ot.Content,{className:"flex max-w-3xl! items-center justify-center px-12 py-4 focus:outline-hidden",size:"normal",removeBackground:!0,onEscapeKeyDown:w=>{w.stopPropagation(),l(!1)},children:[n.jsxs(fi,{children:[n.jsx(hi,{children:n.jsx(K,{id:"wham.proposedTaskModel.title",defaultMessage:"Kick off a new Codex task"})}),n.jsx(pi,{children:n.jsx(K,{id:"wham.proposedTaskModel.description",defaultMessage:"Codex can propose new follow up tasks"})})]}),n.jsx(us.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:{duration:d?0:.25},className:"w-full",children:n.jsxs("div",{className:"flex flex-col items-center gap-8",children:[n.jsx("h1",{className:"text-token-text-primary dark text-[28px] font-semibold",children:n.jsx(K,{id:"wham.proposedTaskModal.title",defaultMessage:"Edit suggested task"})}),n.jsx(ku,{prompt:e,onSuccess:E})]})})]})})})]})}function ju({prompt:t,tooltipEnabled:e,children:s}){return e?n.jsx(pa,{side:"right",label:n.jsx("span",{className:"block p-2 text-start whitespace-pre-wrap",children:t}),wide:!0,children:s}):s}function ku({prompt:t,onSuccess:e}){const{composerController:s}=hl();return g.useEffect(()=>{gi(xi(s),t.trimEnd())},[s,t]),n.jsx(bi.Provider,{value:s,children:n.jsx(pc,{isBigBoxMode:!0,expanded:!0,disableDuringSubmit:!0,onSuccess:e})})}function Su({title:t,prompt:e}){const s=g.useContext(Ts),{data:o}=yc(),a=gc(o),r=g.useMemo(()=>Cu("".concat(s==null?void 0:s.taskId,":").concat(t,":").concat(e)),[s==null?void 0:s.taskId,t,e]);return!s||!s.environmentId||!s.branch?null:n.jsx(_u,{title:t,prompt:e,environmentId:s.environmentId,branch:s.branch,contentId:r,hasHitRateLimit:a})}function Cu(t){let e=5381;for(let s=0;s<t.length;s++)e=(e<<5)+e^t.charCodeAt(s);return(e>>>0).toString(16).padStart(8,"0")}function Nu({chunkId:t,lineRangeStart:e,lineRangeEnd:s}){const[o,a]=g.useState(!1),r=g.useContext(Ts),i=r==null?void 0:r.terminalMessageContents.find(v=>v.includes(t)),l=g.useRef(null),d=g.useRef(null),c=g.useRef(null);if(!i)return null;const m=Tu(i);if(!m)return null;const f=m.output.slice(e-1,s);if(!f.some(v=>!!v.length))return null;const h=()=>{c.current&&(clearTimeout(c.current),c.current=null),a(!0)},y=()=>{c.current=window.setTimeout(()=>{a(!1)},200)};return n.jsxs(xn,{open:o,onOpenChange:a,children:[n.jsx(bn,{asChild:!0,onMouseEnter:h,onMouseLeave:y,children:n.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:n.jsx(yi,{className:"size-[10px]"})})}),n.jsx(yn,{children:n.jsx(wn,{ref:d,className:"z-50 focus:outline-none",side:"right",onMouseEnter:h,onMouseLeave:y,onOpenAutoFocus:v=>v.preventDefault(),children:n.jsx("div",{className:"max-h-[500px] max-w-screen px-4",children:n.jsx($u,{lines:f,lineRangeStart:e,lineRangeEnd:s})})})})]})}function $u({lines:t,lineRangeStart:e,lineRangeEnd:s}){return n.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex flex-col overflow-auto rounded-2xl border px-2 pt-2 pb-3 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[n.jsx(vc,{className:"bg-token-sidebar-surface-primary dark mb-2.5 max-h-[200px] w-full overflow-auto rounded-lg p-3 font-mono text-xs whitespace-pre text-white dark:border dark:border-white/10",children:t.join("\n")}),n.jsx("div",{className:"flex w-full justify-end gap-1 px-2 text-sm",children:n.jsx("span",{className:"text-token-text-tertiary",children:n.jsx(K,{id:"wham.citation.terminal.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:e,lineRangeEnd:s}})})})]})}function Tu(t){try{const e=JSON.parse(t);return!("chunk_id"in e)||typeof e.chunk_id!="string"||!("session_name"in e)||typeof e.session_name!="string"||!("start_line_no"in e)||typeof e.start_line_no!="number"?null:"output"in e?e:null}catch(e){return null}}const ur=t=>{"use forget";const e=ue.c(40),{primaryLabel:s,primaryAction:o,subHeader:a,analyticsMetadata:r,hasBeenEdited:i,messageId:l,clientThreadId:d,messageRef:c,editorViewRef:m,shouldShowWritingBlockCanvasEdit:f,isInlineWritingBlockEditEnabled:h,isInlineWritingBlockExportEnabled:y,isWritingBlockFocusedModeEnabled:v,writingBlock:_,index:b,onChange:C,isStreaming:E,autosaveStatus:p,title:w,setDirty:N,flushPendingChanges:k,contentReferences:$,editorWrapperClassName:S}=t,I=f===void 0?!1:f,{shouldBlockDialogEscapeKeyDown:W}=kn(),x=hn(wi),L=g.useRef(null),[F,O]=g.useState(null);let T,B;e[0]!==F||e[1]!==x?(T=()=>{if(typeof document>"u")return;if(!x){F!=null&&O(null);return}const R=document.getElementById("thread");R&&R!==F&&O(R)},B=[x,F],e[0]=F,e[1]=x,e[2]=T,e[3]=B):(T=e[2],B=e[3]),g.useEffect(T,B);let q;e[4]===Symbol.for("react.memo_cache_sentinel")?(q=n.jsx("div",{id:"writing-block-dialog-overlay",className:Cc}),e[4]=q):q=e[4];let H;e[5]!==W?(H=R=>{W&&R.preventDefault()},e[5]=W,e[6]=H):H=e[6];let U;e[7]===Symbol.for("react.memo_cache_sentinel")?(U=R=>{R.preventDefault();const z=L.current;z&&z.focus()},e[7]=U):U=e[7];let G;e[8]!==m?(G=R=>{R.preventDefault();const z=m.current;z&&z.focus()},e[8]=m,e[9]=G):G=e[9];let P;e[10]!==r||e[11]!==p||e[12]!==d||e[13]!==$||e[14]!==S||e[15]!==k||e[16]!==i||e[17]!==b||e[18]!==h||e[19]!==y||e[20]!==E||e[21]!==v||e[22]!==l||e[23]!==c||e[24]!==C||e[25]!==o||e[26]!==s||e[27]!==N||e[28]!==I||e[29]!==a||e[30]!==w||e[31]!==_?(P=n.jsx(Nc,{editorViewRef:L,analyticsMetadata:r,primaryLabel:s,primaryAction:o,subHeader:a,hasBeenEdited:i,autosaveStatus:p,clientThreadId:d,messageId:l,isInlineWritingBlockExportEnabled:y,isWritingBlockFocusedModeEnabled:v,shouldShowWritingBlockCanvasEdit:I,title:w,index:b,messageRef:c,isInlineWritingBlockEditEnabled:h,writingBlock:_,onChange:C,isStreaming:E,setDirty:N,flushPendingChanges:k,contentReferences:$,editorWrapperClassName:S}),e[10]=r,e[11]=p,e[12]=d,e[13]=$,e[14]=S,e[15]=k,e[16]=i,e[17]=b,e[18]=h,e[19]=y,e[20]=E,e[21]=v,e[22]=l,e[23]=c,e[24]=C,e[25]=o,e[26]=s,e[27]=N,e[28]=I,e[29]=a,e[30]=w,e[31]=_,e[32]=P):P=e[32];let u;e[33]!==H||e[34]!==G||e[35]!==P?(u=n.jsx(vi,{onInteractOutside:Eu,onEscapeKeyDown:H,onOpenAutoFocus:U,onCloseAutoFocus:G,className:$c,children:P}),e[33]=H,e[34]=G,e[35]=P,e[36]=u):u=e[36];let D;return e[37]!==F||e[38]!==u?(D=n.jsxs(_i,{container:F,children:[q,u]}),e[37]=F,e[38]=u,e[39]=D):D=e[39],D};function Eu(t){const e=t.target;e!=null&&e.closest("#writing-block-dialog-overlay")||t.preventDefault()}const Mu=({children:t,analyticsMetadata:e,hasBeenEdited:s,messageId:o,clientThreadId:a,messageRef:r,editorViewRef:i,shouldShowWritingBlockCanvasEdit:l=!1,isInlineWritingBlockEditEnabled:d,isInlineWritingBlockExportEnabled:c,isWritingBlockFocusedModeEnabled:m,writingBlock:f,index:h,onChange:y,isStreaming:v,autosaveStatus:_,title:b,recipient:C,setDirty:E,flushPendingChanges:p,contentReferences:w})=>{const{headerLabel:N,emailSendButton:k,toField:$,subjectField:S,fullScreenEmailHeader:I}=Tc({writingBlock:f,clientThreadId:a,messageId:o,onChange:y,setDirty:E,flushPendingChanges:p,isStreaming:v,streamingTitle:b,streamingRecipient:C,isInlineWritingBlockEditEnabled:d}),{isFullscreenDialogOpen:W,setIsFullscreenDialogOpen:x}=kn();return n.jsx("div",{ref:r,id:"writing-block-".concat(o),className:A(sn),"data-writing-block":!0,children:n.jsxs(ga,{modal:!1,open:W,onOpenChange:x,children:[n.jsx(Ea,{primaryLabel:N,primaryAction:k,writingBlock:f,clientThreadId:a,messageId:o,title:b,hideDownloadButton:!0,hasBeenEdited:s,autosaveStatus:_,shouldShowWritingBlockCanvasEdit:l,isInlineWritingBlockExportEnabled:c,isWritingBlockFocusedModeEnabled:m,index:h,messageRef:r,contentReferences:w,isStreaming:v}),n.jsx("hr",{className:A(Fs)}),$,n.jsx("hr",{className:A(Fs)}),S,n.jsx("hr",{className:A(Fs)}),n.jsx(Ma,{editorViewRef:i,analyticsMetadata:e,isInlineWritingBlockEditEnabled:d,writingBlock:f,onChange:y,isStreaming:v,setDirty:E,flushPendingChanges:p,contentReferences:w,editorWrapperClassName:mo,children:t}),n.jsx(ur,{primaryLabel:N,primaryAction:k,subHeader:I,analyticsMetadata:e,hasBeenEdited:s,messageId:o,clientThreadId:a,messageRef:r,editorViewRef:i,shouldShowWritingBlockCanvasEdit:l,isInlineWritingBlockEditEnabled:d,isInlineWritingBlockExportEnabled:c,isWritingBlockFocusedModeEnabled:m,writingBlock:f,index:h,onChange:y,isStreaming:v,autosaveStatus:_,title:b,recipient:C,setDirty:E,flushPendingChanges:p,contentReferences:w,editorWrapperClassName:mo})]})})},Pu=t=>{"use forget";const e=ue.c(15);let s;e[0]!==t?(s=$e(t,[]),e[0]=t,e[1]=s):s=e[1];const o=ie(),a=ye(),r=g.useRef(!1),[i,l]=g.useState(!1),[d,c]=g.useState(!1);let m;e[2]!==a||e[3]!==o||e[4]!==s?(m=_=>{var E;const b=jc(a)(),C=kc(a)();_===!1&&(b||C)&&!window.confirm(o.formatMessage({id:"S9skgG",defaultMessage:"You have pending edits - are you sure you want to close?"}))||(_&&!r.current&&(r.current=!0,pl("ChatGPT Writing Block Fullscreen Dialog Opened","chatgpt_writing_block_fullscreen_opened",Y(M({},xa({clientThreadId:(E=s.conversation)==null?void 0:E.id,messageId:s.messageId})),{writingBlockId:s.id,variant:s.variant}))),l(_))},e[2]=a,e[3]=o,e[4]=s,e[5]=m):m=e[5];const f=m;let h;e[6]!==i||e[7]!==f||e[8]!==d?(h={isFullscreenDialogOpen:i,setIsFullscreenDialogOpen:f,shouldBlockDialogEscapeKeyDown:d,setShouldBlockDialogEscapeKeyDown:c},e[6]=i,e[7]=f,e[8]=d,e[9]=h):h=e[9];let y;e[10]!==s?(y=n.jsx(Iu,M({},s)),e[10]=s,e[11]=y):y=e[11];let v;return e[12]!==h||e[13]!==y?(v=n.jsx(_c.Provider,{value:h,children:y}),e[12]=h,e[13]=y,e[14]=v):v=e[14],v},Iu=t=>{"use forget";const e=ue.c(98),{conversation:s,title:o,children:a,originalContent:r,messageId:i,variant:l,recipient:d,isStreaming:c,index:m,id:f}=t,h=ye(),{isFullscreenDialogOpen:y,setIsFullscreenDialogOpen:v}=kn(),_=Qs(en.EditInCanvas);let b;e[0]!==h?(b=ve(h,"669593727"),e[0]=h,e[1]=b):b=e[1];const C=b,E=Qs(en.MagicEditEnabled);let p;e[2]!==h||e[3]!==E?(p=ve(h,"1101084612")||E,e[2]=h,e[3]=E,e[4]=p):p=e[4];const w=p;let N;e[5]!==s||e[6]!==f||e[7]!==m||e[8]!==i||e[9]!==r||e[10]!==d||e[11]!==o||e[12]!==l?(N={conversation:s,messageId:i,id:f,originalContent:r,index:m,variant:l,title:o,recipient:d},e[5]=s,e[6]=f,e[7]=m,e[8]=i,e[9]=r,e[10]=d,e[11]=o,e[12]=l,e[13]=N):N=e[13];const{conversation:k,writingBlock:$,contentReferences:S,autosaveStatus:I,flushPendingChanges:W,handleOnChange:x,messageRef:L,editorViewRef:F,analyticsMetadata:O,hasBeenEdited:T,isWritingBlockEditingAllowed:B,setDirty:q}=Ec(N);if(c&&l===uo.UNKNOWN&&r===""){const H="writing-block-".concat(i);let U;e[14]===Symbol.for("react.memo_cache_sentinel")?(U=A(sn,"px-4 py-2","h-10"),e[14]=U):U=e[14];let G;return e[15]!==L||e[16]!==H?(G=n.jsx("div",{ref:L,id:H,className:U,"data-writing-block":!0}),e[15]=L,e[16]=H,e[17]=G):G=e[17],G}switch(l){case uo.EMAIL:{const H=k==null?void 0:k.id,U=o!=null?o:"",G=d!=null?d:"";let P;return e[18]!==O||e[19]!==I||e[20]!==a||e[21]!==S||e[22]!==F||e[23]!==W||e[24]!==x||e[25]!==T||e[26]!==m||e[27]!==C||e[28]!==c||e[29]!==B||e[30]!==w||e[31]!==i||e[32]!==L||e[33]!==q||e[34]!==_||e[35]!==H||e[36]!==U||e[37]!==G||e[38]!==$?(P=n.jsx(Mu,{analyticsMetadata:O,hasBeenEdited:T,messageRef:L,editorViewRef:F,clientThreadId:H,messageId:i,index:m,shouldShowWritingBlockCanvasEdit:_,isInlineWritingBlockEditEnabled:B,isInlineWritingBlockExportEnabled:C,onChange:x,writingBlock:$,isStreaming:c,autosaveStatus:I,title:U,recipient:G,setDirty:q,flushPendingChanges:W,contentReferences:S,isWritingBlockFocusedModeEnabled:w,children:a}),e[18]=O,e[19]=I,e[20]=a,e[21]=S,e[22]=F,e[23]=W,e[24]=x,e[25]=T,e[26]=m,e[27]=C,e[28]=c,e[29]=B,e[30]=w,e[31]=i,e[32]=L,e[33]=q,e[34]=_,e[35]=H,e[36]=U,e[37]=G,e[38]=$,e[39]=P):P=e[39],P}default:{const H="writing-block-".concat(i);let U;e[40]===Symbol.for("react.memo_cache_sentinel")?(U=A(sn),e[40]=U):U=e[40];const G=k==null?void 0:k.id;let P;e[41]!==I||e[42]!==S||e[43]!==T||e[44]!==m||e[45]!==C||e[46]!==c||e[47]!==w||e[48]!==i||e[49]!==L||e[50]!==_||e[51]!==G||e[52]!==o||e[53]!==$?(P=n.jsx(Ea,{hasBeenEdited:T,autosaveStatus:I,writingBlock:$,clientThreadId:G,messageId:i,isInlineWritingBlockExportEnabled:C,isWritingBlockFocusedModeEnabled:w,shouldShowWritingBlockCanvasEdit:_,title:o,index:m,messageRef:L,contentReferences:S,isStreaming:c}),e[41]=I,e[42]=S,e[43]=T,e[44]=m,e[45]=C,e[46]=c,e[47]=w,e[48]=i,e[49]=L,e[50]=_,e[51]=G,e[52]=o,e[53]=$,e[54]=P):P=e[54];let u;e[55]===Symbol.for("react.memo_cache_sentinel")?(u=n.jsx("hr",{className:"border-token-border-light! border-0.5 my-0!"}),e[55]=u):u=e[55];let D;e[56]!==O||e[57]!==a||e[58]!==S||e[59]!==F||e[60]!==W||e[61]!==x||e[62]!==c||e[63]!==B||e[64]!==q||e[65]!==$?(D=n.jsx(Ma,{editorViewRef:F,analyticsMetadata:O,setDirty:q,isInlineWritingBlockEditEnabled:B,writingBlock:$,onChange:x,isStreaming:c,flushPendingChanges:W,contentReferences:S,children:a}),e[56]=O,e[57]=a,e[58]=S,e[59]=F,e[60]=W,e[61]=x,e[62]=c,e[63]=B,e[64]=q,e[65]=$,e[66]=D):D=e[66];const R=k==null?void 0:k.id;let z;e[67]!==O||e[68]!==I||e[69]!==S||e[70]!==F||e[71]!==W||e[72]!==x||e[73]!==T||e[74]!==m||e[75]!==C||e[76]!==c||e[77]!==B||e[78]!==w||e[79]!==i||e[80]!==L||e[81]!==d||e[82]!==q||e[83]!==_||e[84]!==R||e[85]!==o||e[86]!==$?(z=n.jsx(ur,{analyticsMetadata:O,hasBeenEdited:T,messageId:i,clientThreadId:R,messageRef:L,editorViewRef:F,shouldShowWritingBlockCanvasEdit:_,isInlineWritingBlockEditEnabled:B,isInlineWritingBlockExportEnabled:C,isWritingBlockFocusedModeEnabled:w,writingBlock:$,index:m,onChange:x,isStreaming:c,autosaveStatus:I,title:o,recipient:d,setDirty:q,flushPendingChanges:W,contentReferences:S}),e[67]=O,e[68]=I,e[69]=S,e[70]=F,e[71]=W,e[72]=x,e[73]=T,e[74]=m,e[75]=C,e[76]=c,e[77]=B,e[78]=w,e[79]=i,e[80]=L,e[81]=d,e[82]=q,e[83]=_,e[84]=R,e[85]=o,e[86]=$,e[87]=z):z=e[87];let V;e[88]!==y||e[89]!==v||e[90]!==z||e[91]!==P||e[92]!==D?(V=n.jsxs(ga,{modal:!1,open:y,onOpenChange:v,children:[P,u,D,z]}),e[88]=y,e[89]=v,e[90]=z,e[91]=P,e[92]=D,e[93]=V):V=e[93];let Z;return e[94]!==L||e[95]!==V||e[96]!==H?(Z=n.jsx("div",{ref:L,id:H,className:U,"data-writing-block":!0,children:V}),e[94]=L,e[95]=V,e[96]=H,e[97]=Z):Z=e[97],Z}}};function Au({metadata:t,trackContentReferenceEvent:e}){var i;const s=Ar(),o=ye(),a=un(),r=ve(o,"3375735072");return g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,{checkout_id:t.checkout_id})},[e,t.type,t.checkout_id]),r?n.jsxs("div",{className:"border-token-border-default bg-token-bg-primary not-prose mb-6 flex max-w-[420px] flex-col gap-4 rounded-[20px] border py-4 shadow-[0px_4px_16px_0px_rgba(0,_0,_0,_0.05)]","data-order-id":t.checkout_id,role:"group",children:[n.jsxs("div",{className:"flex items-center gap-2 px-4 text-sm font-medium",children:[n.jsx(ji,{className:"icon-lg text-green-400"}),n.jsx(K,{id:"checkout_purchase_confirmation_status",defaultMessage:"Purchase complete"})]}),n.jsxs("div",{className:"border-token-border-light flex items-start gap-3 border-b px-4 pb-4",children:[n.jsx("div",{className:"flex-shrink-0 overflow-hidden rounded-xl bg-gray-100 dark:bg-gray-700",children:n.jsx("img",{src:t.product_image_urls[0],alt:t.title,className:"m-0 aspect-square h-32 w-32 object-cover mix-blend-darken dark:mix-blend-lighten"})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"line-clamp-2 min-h-6 text-base leading-snug font-medium",title:t.title,children:t.title}),n.jsx("div",{className:"text-token-text-secondary text-[13px] leading-snug whitespace-pre-wrap",children:t.subtitle})]})]}),t.error_message&&n.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mx-4 flex items-center rounded-lg px-3 py-1 text-sm",children:t.error_message}),n.jsx("dl",{className:"space-y-1 px-4",children:(i=t.details)==null?void 0:i.map(l=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("dt",{className:"text-token-text-secondary flex-grow text-[13px] font-medium",children:l.label}),n.jsx("dd",{className:"text-token-text-primary text-[13px] font-medium",children:l.value})]},l.label))}),!a&&n.jsx("div",{className:"px-4",children:n.jsx(Ve,{fullWidth:!0,color:"secondary",className:"rounded-2xl border",onClick:()=>{s("#settings/".concat(ki.Orders,"?order=").concat(t.checkout_id))},children:n.jsx(K,{id:"2Dn5nu",defaultMessage:"View details"})})})]}):null}const Oo=4;function Ru(t){"use forget";const e=ue.c(41),{metadata:s,analyticsMetadata:o,trackContentReferenceEvent:a,imageSource:r}=t,i=r!=null?r:kt.Turn,l=Bt();let d,c,m;e[0]!==s.images?(d=s.images.some(Wu)?[]:s.images.map(Ou),m=Rr,c=d.map(Fu),e[0]=s.images,e[1]=d,e[2]=c,e[3]=m):(d=e[1],c=e[2],m=e[3]);let f;e[4]!==d?(f=p=>{const w=new Set;return p.forEach((N,k)=>{N.isSuccess&&w.add(d[k])}),w},e[4]=d,e[5]=f):f=e[5];let h;e[6]!==c||e[7]!==f?(h={queries:c,combine:f},e[6]=c,e[7]=f,e[8]=h):h=e[8];const y=m(h),v=s.images;let _,b,C;if(e[9]!==o||e[10]!==y||e[11]!==i||e[12]!==l||e[13]!==s.images||e[14]!==a){C=Symbol.for("react.early_return_sentinel");e:{let p;e[18]!==y?(p=$=>y.has($.thumbnail_url),e[18]=y,e[19]=p):p=e[19];const w=v.filter(p),N=s.images.length;if(s.images.some(Du)){let $;e[20]!==s.images?($=s.images.find(Lu),e[20]=s.images,e[21]=$):$=e[21];const S=$,I=S!=null&&S.float_top?"relative block":"float-image z-10 float-end clear-end ms-7 overflow-hidden";let W;e[22]!==I?(W=A("mb-7 mt-1 min-w-32 max-w-[22%] rounded-xl border-[0.5px] border-token-border-default",I),e[22]=I,e[23]=W):W=e[23];const x=W,L=S==null?void 0:S.content_url;let F;e[24]===Symbol.for("react.memo_cache_sentinel")?(F={imageUse:"deepResearch"},e[24]=F):F=e[24];let O;e[25]!==o||e[26]!==x||e[27]!==i||e[28]!==S||e[29]!==L||e[30]!==a?(O=n.jsx(at,{image:S,imageSource:i,analyticsMetadata:o,trackContentReferenceEvent:a,eventMetadata:F,aspectRatio:ls,className:x,contentReferenceType:"image_v2"},L),e[25]=o,e[26]=x,e[27]=i,e[28]=S,e[29]=L,e[30]=a,e[31]=O):O=e[31],C=O;break e}if(N===0){C=null;break e}if(N===1){const $=s.images[0];let S;e[32]===Symbol.for("react.memo_cache_sentinel")?(S={imageUse:"legacyCarousel"},e[32]=S):S=e[32];let I;e[33]!==o||e[34]!==i||e[35]!==$||e[36]!==a?(I=n.jsx(at,{image:$,imageSource:i,analyticsMetadata:o,trackContentReferenceEvent:a,eventMetadata:S,aspectRatio:ls,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 max-w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_v2"},$.content_url),e[33]=o,e[34]=i,e[35]=$,e[36]=a,e[37]=I):I=e[37],C=I;break e}const k=l||Oo==null?w.length:Math.min(w.length,Oo);_="no-scrollbar mt-1 mb-6 flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",b=w.slice(0,k).map(($,S)=>n.jsx("div",{className:A("border-token-border-default relative aspect-square w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-48 sm:w-[calc((100%-0.5rem)/4)]",S===0&&"rounded-s-xl",S===k-1&&"rounded-e-xl"),children:n.jsx(at,{image:$,imageSource:i,analyticsMetadata:o,trackContentReferenceEvent:a,eventMetadata:{imageUse:"legacyCarousel"},aspectRatio:ls,className:"h-full w-full",contentReferenceType:"image_v2"},$.thumbnail_url)},$.thumbnail_url))}e[9]=o,e[10]=y,e[11]=i,e[12]=l,e[13]=s.images,e[14]=a,e[15]=_,e[16]=b,e[17]=C}else _=e[15],b=e[16],C=e[17];if(C!==Symbol.for("react.early_return_sentinel"))return C;let E;return e[38]!==_||e[39]!==b?(E=n.jsx("div",{className:_,children:b}),e[38]=_,e[39]=b,e[40]=E):E=e[40],E}function Lu(t){return t.is_proxied_image}function Du(t){return t.is_proxied_image}function Fu(t){return oc(t,"_ImageCarousel")}function Ou(t){return t.thumbnail_url}function Wu(t){return t.is_proxied_image}const In=g.memo(Ru,(t,e)=>t.numImageResults===e.numImageResults&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.metadata.images.length===e.metadata.images.length&&t.metadata.images.every((s,o)=>s.content_url===e.metadata.images[o].content_url));function at(t){"use forget";var te,me;const e=ue.c(72),{image:s,imageSource:o,className:a,imgClassName:r,style:i,analyticsMetadata:l,trackContentReferenceEvent:d,eventMetadata:c,badge:m,lightboxImages:f,aspectRatio:h,enableHoverAnimation:y,fadeInOnMount:v,skeletonEl:_,contentReferenceType:b}=t;let C;e[0]!==c?(C=c===void 0?{}:c,e[0]=c,e[1]=C):C=e[1];const E=C,p=y===void 0?!0:y,w=h!=null?h:void 0;let N;e[2]!==w?(N={width:ic,aspectRatio:w},e[2]=w,e[3]=N):N=e[3];const k=ac(s,N);let $;e[4]!==(s==null?void 0:s.content_url)?($=s==null?void 0:s.content_url.replace(/^http:\/\//,"https://"),e[4]=s==null?void 0:s.content_url,e[5]=$):$=e[5];const S=$;let I;e[6]!==s?(I=Bu(s),e[6]=s,e[7]=I):I=e[7];const W=I,{isSuccess:x}=tn(k,"ImageCarousel_thumbnail"),{isSuccess:L,isError:F}=tn(W?S:void 0,"ImageCarousel_full");s==null||s.title;const O=s==null?void 0:s.title;let T;e[8]!==E||e[9]!==O||e[10]!==k?(T=M({image_url:k,title:O},E),e[8]=E,e[9]=O,e[10]=k,e[11]=T):T=e[11];const B=T;let q,H;e[12]!==b||e[13]!==B||e[14]!==s||e[15]!==x||e[16]!==d?(q=()=>{s&&x&&d("Search Content Reference Shown","search_content_reference_shown",b,B)},H=[d,s,x,B,b],e[12]=b,e[13]=B,e[14]=s,e[15]=x,e[16]=d,e[17]=q,e[18]=H):(q=e[17],H=e[18]),g.useEffect(q,H);let U,G;e[19]!==S||e[20]!==F||e[21]!==k?(U=()=>{S&&F&&Ss.addAction("Failed to download full image",{url:S,thumbnailUrl:k})},G=[S,F,k],e[19]=S,e[20]=F,e[21]=k,e[22]=U,e[23]=G):(U=e[22],G=e[23]),g.useEffect(U,G);const P=vn.useStore();let u,D,R,z;if(e[24]!==l||e[25]!==h||e[26]!==a||e[27]!==b||e[28]!==S||e[29]!==p||e[30]!==B||e[31]!==v||e[32]!==s||e[33]!==P||e[34]!==o||e[35]!==r||e[36]!==L||e[37]!==x||e[38]!==f||e[39]!==W||e[40]!==_||e[41]!==i||e[42]!==k||e[43]!==d){const re=rc((te=s==null?void 0:s.thumbnail_crop_info)!=null?te:null,(me=s==null?void 0:s.thumbnail_size)!=null?me:null,h!=null?h:void 0),fe=!s||!(x||L||s.is_proxied_image);let se;e:{if(fe){se=void 0;break e}if(s.is_proxied_image){se=s.url;break e}if(W&&L){se=S;break e}se=k}const ke=se;let he;e[48]!==h?(he=h?{aspectRatio:"".concat(h.width,"/").concat(h.height)}:{},e[48]=h,e[49]=he):he=e[49];let le;e[50]!==i||e[51]!==he?(le=M(M({},i),he),e[50]=i,e[51]=he,e[52]=le):le=e[52];const xe=le;e[53]!==a?(u=A("relative overflow-hidden",a),e[53]=a,e[54]=u):u=e[54],D=xe,e[55]!==l||e[56]!==b||e[57]!==B||e[58]!==s||e[59]!==P||e[60]!==o||e[61]!==f||e[62]!==d?(R=()=>{d("Search Content Reference Clicked","search_content_reference_clicked",b,B),P.setCurrentImage(s?{image:s,source:o,analyticsMetadata:l,imageResults:f}:void 0)},e[55]=l,e[56]=b,e[57]=B,e[58]=s,e[59]=P,e[60]=o,e[61]=f,e[62]=d,e[63]=R):R=e[63],z=zu({isLoading:fe,enableHoverAnimation:p,fadeInOnMount:v,src:ke,image:s,objectPosition:re,className:r,skeletonEl:_}),e[24]=l,e[25]=h,e[26]=a,e[27]=b,e[28]=S,e[29]=p,e[30]=B,e[31]=v,e[32]=s,e[33]=P,e[34]=o,e[35]=r,e[36]=L,e[37]=x,e[38]=f,e[39]=W,e[40]=_,e[41]=i,e[42]=k,e[43]=d,e[44]=u,e[45]=D,e[46]=R,e[47]=z}else u=e[44],D=e[45],R=e[46],z=e[47];let V;e[64]!==m?(V=m&&n.jsx("div",{className:"pointer-events-none absolute end-2 bottom-2",children:m}),e[64]=m,e[65]=V):V=e[65];let Z;return e[66]!==u||e[67]!==D||e[68]!==R||e[69]!==z||e[70]!==V?(Z=n.jsxs("button",{className:u,style:D,onClick:R,children:[z,V]}),e[66]=u,e[67]=D,e[68]=R,e[69]=z,e[70]=V,e[71]=Z):Z=e[71],Z}function zu({isLoading:t,enableHoverAnimation:e,fadeInOnMount:s,src:o,image:a,objectPosition:r,className:i,skeletonEl:l}){const d=l!=null?l:n.jsx("div",{className:"bg-token-main-surface-tertiary aspect-square h-full w-full animate-pulse"}),c=!t&&o!=null?n.jsx(us.img,{src:o,alt:a==null?void 0:a.content_url,style:r?{objectPosition:r}:{},className:A("bg-token-main-surface-tertiary absolute inset-0 m-0 h-full w-full object-cover",i),initial:s?{opacity:0}:!1,animate:{opacity:1},transition:s?{duration:.3,ease:"easeInOut"}:void 0}):null;return e?t?d:n.jsx(Ta,{children:c}):n.jsxs(n.Fragment,{children:[d,c]})}function Bu(t){return!t||t.is_proxied_image?!1:t.thumbnail_url.includes("images.openai.com")}function mr({numImages:t}){return n.jsxs("div",{className:"flex items-center gap-1 rounded-full px-2 py-1.5 text-white backdrop-blur-md backdrop-brightness-75",children:[n.jsx(gl,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs font-semibold",children:t})]})}function Uu(t){"use forget";const e=ue.c(70),{images:s,className:o,aspect:a,objectPosition:r,showArrows:i,imageClassName:l,slideClassName:d,gap:c,peekPercent:m,showDots:f,onClick:h}=t,y=o===void 0?"":o,v=a===void 0?"aspect-[16/9]":a,_=r===void 0?"object-cover":r,b=i===void 0?!0:i,C=l===void 0?"":l,E=d===void 0?"":d,p=c===void 0?2:c,w=m===void 0?95:m,N=f===void 0?!1:f,[k,$]=g.useState(0),[S,I]=g.useState(!1),W=g.useRef(null);let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=[],e[0]=x):x=e[0];const L=g.useRef(x),F=g.useRef(null),O=ie(),T=s.length;let B;e[1]!==w?(B=_t(w,0,100),e[1]=w,e[2]=B):B=e[2];const q=B,H="".concat(q,"%");let U;e[3]!==H?(U={maxWidth:H},e[3]=H,e[4]=U):U=e[4];const G=U;let P;e[5]!==T?(P=(ne,J)=>{const ge=L.current[ne];if(!ge)return 0;const ce=ge.offsetLeft,be=ce+ge.offsetWidth,Ce=J.clientWidth,we=Math.max(0,J.scrollWidth-Ce);if(T<=1||ne===0)return _t(ce,0,we);if(ne===T-1){const Ie=be-Ce;return _t(Ie,0,we)}const Le=ce-(Ce-ge.offsetWidth)/2;return _t(Le,0,we)},e[5]=T,e[6]=P):P=e[6];const u=P;let D;e[7]!==u||e[8]!==T?(D=(ne,J)=>{const ge=J===void 0?"smooth":J;if(T===0||ne<0||ne>=T)return;const ce=W.current;if(!ce)return;const be=u(ne,ce);if(zo(ce.scrollLeft,be)){ge!=="auto"&&ce.scrollTo({left:be,behavior:"auto"}),F.current=null;return}F.current=be,ce.scrollTo({left:be,behavior:ge})},e[7]=u,e[8]=T,e[9]=D):D=e[9];const R=D,z=S&&k!==0,V=S;let Z;e[10]!==k||e[11]!==R||e[12]!==T?(Z=ne=>{if(T===0)return;const J=_t(ne,0,T-1);R(J,"smooth"),J!==k&&$(J)},e[10]=k,e[11]=R,e[12]=T,e[13]=Z):Z=e[13];const te=Z;let me;e[14]!==te||e[15]!==k||e[16]!==T?(me=()=>{if(T!==0){if(k>=T-1){te(0);return}te(k+1)}},e[14]=te,e[15]=k,e[16]=T,e[17]=me):me=e[17];const re=me;let fe;e[18]!==te||e[19]!==k?(fe=()=>te(k-1),e[18]=te,e[19]=k,e[20]=fe):fe=e[20];const se=fe;let ke,he;e[21]!==u||e[22]!==k||e[23]!==T?(ke=()=>{const ne=W.current;if(!ne)return;const J=()=>{const ge=ne.scrollLeft||0,ce=F.current;if(ce!=null){zo(ge,ce)&&(F.current=null);return}let be=k,Ce=Number.POSITIVE_INFINITY;for(let we=0;we<T;we++){const Le=u(we,ne),Ie=Math.abs(Le-ge);Ie<Ce-.5&&(Ce=Ie,be=we)}be!==k&&$(be)};return ne.addEventListener("scroll",J,{passive:!0}),()=>ne.removeEventListener("scroll",J)},he=[T,k,u],e[21]=u,e[22]=k,e[23]=T,e[24]=ke,e[25]=he):(ke=e[24],he=e[25]),g.useEffect(ke,he);let le,xe;e[26]!==S||e[27]!==re||e[28]!==se||e[29]!==T?(le=()=>{if(!S)return;const ne=J=>{if(J.defaultPrevented||J.altKey||J.ctrlKey||J.metaKey||J.shiftKey)return;const ge=J.target;if(ge instanceof HTMLElement){if(ge.isContentEditable)return;const ce=ge.tagName;if(ce==="INPUT"||ce==="TEXTAREA"||ce==="SELECT")return;const be=ge.getAttribute("role");if(be==="textbox"||be==="combobox")return}T<=1||(J.key==="ArrowRight"?(J.preventDefault(),re()):J.key==="ArrowLeft"&&(J.preventDefault(),se()))};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},xe=[S,T,re,se],e[26]=S,e[27]=re,e[28]=se,e[29]=T,e[30]=le,e[31]=xe):(le=e[30],xe=e[31]),g.useEffect(le,xe);const Pe="select-none ".concat(y," relative");let Ge,ft;e[32]===Symbol.for("react.memo_cache_sentinel")?(Ge=()=>I(!0),ft=()=>I(!1),e[32]=Ge,e[33]=ft):(Ge=e[32],ft=e[33]);const ht="relative w-full ".concat(v," overflow-clip");let Re;e[34]!==p?(Re={gap:p},e[34]=p,e[35]=Re):Re=e[35];let Xe;e[36]!==C||e[37]!==s||e[38]!==O||e[39]!==_||e[40]!==h||e[41]!==E||e[42]!==T||e[43]!==G?(Xe=s.map((ne,J)=>{var ge;return n.jsx("div",{onClick:()=>h==null?void 0:h(ne,J),ref:ce=>{L.current[J]=ce},className:A("relative flex h-full shrink-0 grow-0 snap-always items-stretch",J===0&&"snap-start",J===T-1&&"snap-end",J>0&&J<T-1&&"snap-center",E),style:G,children:ne.content?ne.content:n.jsx("img",{src:ne.src,alt:(ge=ne.alt)!=null?ge:O.formatMessage({id:"wHCsqa",defaultMessage:"Slide {index}"},{index:J+1}),className:"h-full w-auto ".concat(_," ").concat(C)})},J)}),e[36]=C,e[37]=s,e[38]=O,e[39]=_,e[40]=h,e[41]=E,e[42]=T,e[43]=G,e[44]=Xe):Xe=e[44];let Se;e[45]!==Re||e[46]!==Xe?(Se=n.jsx("div",{ref:W,className:"no-scrollbar flex h-full w-full touch-pan-x snap-x snap-mandatory overflow-x-scroll scroll-smooth",style:Re,children:Xe}),e[45]=Re,e[46]=Xe,e[47]=Se):Se=e[47];let Ye;e[48]!==s.length||e[49]!==O||e[50]!==z||e[51]!==re||e[52]!==se||e[53]!==V||e[54]!==b?(Ye=b&&s.length>1&&n.jsxs(n.Fragment,{children:[n.jsx(Bo,{ariaLabel:O.formatMessage({id:"l9pylv",defaultMessage:"Previous slide"}),onClick:se,side:"start",visible:z,children:n.jsx(ba,{className:"icon-md"})}),n.jsx(Bo,{ariaLabel:O.formatMessage({id:"L0pbQh",defaultMessage:"Next slide"}),onClick:re,side:"end",visible:V,children:n.jsx(_n,{className:"icon-md"})})]}),e[48]=s.length,e[49]=O,e[50]=z,e[51]=re,e[52]=se,e[53]=V,e[54]=b,e[55]=Ye):Ye=e[55];let _e;e[56]!==te||e[57]!==s||e[58]!==k||e[59]!==O||e[60]!==N?(_e=N&&s.length>1&&s.length<=20&&n.jsx("div",{className:"absolute start-0 end-0 bottom-3 flex items-center justify-center",children:n.jsx("div",{className:"flex w-fit items-center justify-center gap-2 rounded-full bg-[#0D0D0D66] bg-clip-padding p-1 backdrop-blur",children:s.map((ne,J)=>n.jsx("button",{onClick:()=>te(J),"aria-label":O.formatMessage({id:"PUV+4+",defaultMessage:"Go to slide {index}"},{index:J+1}),className:"h-1.5 w-1.5 rounded-full transition-opacity ".concat(J===k?"bg-white":"bg-gray-400 opacity-60")},J))})}),e[56]=te,e[57]=s,e[58]=k,e[59]=O,e[60]=N,e[61]=_e):_e=e[61];let Ke;e[62]!==ht||e[63]!==Se||e[64]!==Ye||e[65]!==_e?(Ke=n.jsxs("div",{className:ht,children:[Se,Ye,_e]}),e[62]=ht,e[63]=Se,e[64]=Ye,e[65]=_e,e[66]=Ke):Ke=e[66];let pt;return e[67]!==Pe||e[68]!==Ke?(pt=n.jsx("div",{className:Pe,"aria-roledescription":"carousel",onMouseEnter:Ge,onMouseLeave:ft,children:Ke}),e[67]=Pe,e[68]=Ke,e[69]=pt):pt=e[69],pt}const Wo={width:4,height:5};function Hu(t){"use forget";const e=ue.c(7),{image:s}=t,o=Wo.height/Wo.width;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={maxHeight:"calc(100cqw * ".concat(o,")")},e[0]=a):a=e[0];let r;e[1]!==s.alt||e[2]!==s.content||e[3]!==s.src?(r=s.content?s.content:n.jsx("img",{src:s.src,alt:s.alt,className:"h-full w-full object-cover"}),e[1]=s.alt,e[2]=s.content,e[3]=s.src,e[4]=r):r=e[4];let i;return e[5]!==r?(i=n.jsx("div",{className:"[container-type:inline-size] w-full overflow-hidden [font-size:0] leading-none",style:a,children:r}),e[5]=r,e[6]=i):i=e[6],i}function Vu(t){"use forget";const e=ue.c(4);if(t.images.length===0)return null;if(t.images.length===1){let o;return e[0]!==t.images[0]?(o=n.jsx(Hu,{image:t.images[0]}),e[0]=t.images[0],e[1]=o):o=e[1],o}let s;return e[2]!==t?(s=n.jsx(Uu,M({},t)),e[2]=t,e[3]=s):s=e[3],s}const _t=(t,e,s)=>Math.min(Math.max(t,e),s),zo=(t,e,s=1)=>Math.abs(t-e)<=s;function Bo(t){"use forget";const e=ue.c(11),{ariaLabel:s,onClick:o,side:a,visible:r,children:i}=t,l=a==="start"?"start-0 justify-end":"end-0 justify-start",d=r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none ";let c;e[0]!==l||e[1]!==d?(c=A("group absolute top-0 bottom-0 flex h-full w-12.5 cursor-pointer items-center transition-opacity duration-300",l,d),e[0]=l,e[1]=d,e[2]=c):c=e[2];let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=A("btn-secondary active:bg-token-bg-tertiary group-hover:bg-token-bg-secondary flex h-8 w-8 items-center justify-center rounded-full bg-clip-padding shadow-sm group-hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!"),e[3]=m):m=e[3];let f;e[4]!==s||e[5]!==i?(f=n.jsx("button",{"aria-label":s,className:m,children:i}),e[4]=s,e[5]=i,e[6]=f):f=e[6];let h;return e[7]!==o||e[8]!==c||e[9]!==f?(h=n.jsx("div",{className:c,onClick:o,children:f}),e[7]=o,e[8]=c,e[9]=f,e[10]=h):h=e[10],h}const fr="mt-1 mb-5 [&:not(:first-child)]:mt-4",qu=/^image_group[\s\S]*$/;function Gu({contentReference:t,trackContentReferenceEvent:e,analyticsMetadata:s}){var l;const{images:o,layout:a="carousel"}=t,r=qu.test((l=t.matched_text)!=null?l:""),i={images:o,trackContentReferenceEvent:e,analyticsMetadata:s,isReferenceComplete:r};return a==="carousel"?n.jsx(rm,M({},i)):a==="bento"?n.jsx(tm,M({},i)):a==="full_width"?n.jsx(dm,M({},i)):null}const Xu={width:9,height:5},Yu={width:21,height:9};function Ku(t){switch(t){case 0:return"rounded-se-md rounded-ee-md rounded-ss-xl rounded-es-xl";case 1:return"rounded-se-xl rounded-ee-md rounded-ss-md rounded-es-md";case 2:return"rounded-se-md rounded-ee-xl rounded-ss-md rounded-es-md";default:return""}}const Zu=(t,e)=>{var s;return t.image_result?t.image_result.content_url:"".concat((s=t.image_search_query)!=null?s:t.image_ref_id,"-").concat(e)};function Ju(t){"use forget";const e=ue.c(14),{images:s,trackContentReferenceEvent:o,analyticsMetadata:a}=t,r=ye(),l=Cs(r)?Yu:Xu,d=l.width/3,c=l.height/2;let m;e[0]!==d||e[1]!==c?(m={width:d,height:c},e[0]=d,e[1]=c,e[2]=m):m=e[2];const f=m;let h;e[3]===Symbol.for("react.memo_cache_sentinel")?(h=A("grid grid-flow-dense grid-cols-3 grid-rows-2 gap-1",fr),e[3]=h):h=e[3];const y="".concat(l.width,"/").concat(l.height);let v;e[4]!==y?(v={aspectRatio:y},e[4]=y,e[5]=v):v=e[5];let _;e[6]!==a||e[7]!==s||e[8]!==f||e[9]!==o?(_=s.map((C,E)=>{var N;if(E>=3)return null;const w=E===Math.min(3,s.length)-1&&s.length>3;return n.jsx(at,{image:(N=C.image_result)!=null?N:void 0,imageSource:kt.ImageGroup,className:A("border-token-border-default h-full w-full border-[0.5px]",E===0&&"col-span-2 row-span-2",Ku(E)),badge:w?n.jsx(mr,{numImages:s.length}):void 0,lightboxImages:s.map(em).filter(Qu),aspectRatio:f,trackContentReferenceEvent:o,eventMetadata:{imageUse:"imageGroup",layout:"bento"},analyticsMetadata:a,contentReferenceType:"image_group"},Zu(C,E))}),e[6]=a,e[7]=s,e[8]=f,e[9]=o,e[10]=_):_=e[10];let b;return e[11]!==v||e[12]!==_?(b=n.jsx("div",{className:h,style:v,children:_}),e[11]=v,e[12]=_,e[13]=b):b=e[13],b}function Qu(t){return!!t}function em(t){return t.image_result}const An=(t,e)=>t.images.length===e.images.length&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.images.every((s,o)=>{var a,r;return((a=s.image_result)==null?void 0:a.content_url)===((r=e.images[o].image_result)==null?void 0:r.content_url)}),tm=g.memo(Ju,An),sm=3,Hs={width:5,height:4};function nm(t){"use forget";var v;const e=ue.c(23),{images:s,analyticsMetadata:o,trackContentReferenceEvent:a,isReferenceComplete:r}=t,i=Bt(),l=s.length;let d;e[0]!==s?(d=s.map(am).filter(om),e[0]=s,e[1]=d):d=e[1];const c=d;if(l===0)return null;if(l===1){const _=s[0];if(!_.image_result&&!r)return null;let b;e[2]===Symbol.for("react.memo_cache_sentinel")?(b=n.jsx("span",{"aria-hidden":!0,className:"clear-both m-0 block h-0 p-0"}),e[2]=b):b=e[2];const C=(v=_==null?void 0:_.image_result)!=null?v:void 0;let E;e[3]===Symbol.for("react.memo_cache_sentinel")?(E={imageUse:"imageGroup",layout:"single"},e[3]=E):E=e[3];let p;return e[4]!==o||e[5]!==C||e[6]!==a?(p=n.jsxs(n.Fragment,{children:[b,n.jsx(at,{image:C,imageSource:kt.ImageGroup,analyticsMetadata:o,trackContentReferenceEvent:a,eventMetadata:E,aspectRatio:ls,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_group"})]}),e[4]=o,e[5]=C,e[6]=a,e[7]=p):p=e[7],p}const m=i?s.length:Math.min(s.length,sm);let f;e[8]===Symbol.for("react.memo_cache_sentinel")?(f=A("no-scrollbar flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",fr),e[8]=f):f=e[8];let h;if(e[9]!==o||e[10]!==c||e[11]!==s||e[12]!==m||e[13]!==a){let _;e[15]!==o||e[16]!==c||e[17]!==s.length||e[18]!==m||e[19]!==a?(_=(b,C)=>{var p,w,N;const E=C===m-1;return n.jsx("div",{className:A("border-token-border-default relative w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-64 sm:w-[calc((100%-0.5rem)/3)]",C===0&&"rounded-s-xl",E&&"rounded-e-xl"),style:{aspectRatio:"".concat(Hs.width,"/").concat(Hs.height)},children:n.jsx(at,{image:(p=b.image_result)!=null?p:void 0,imageSource:kt.ImageGroup,lightboxImages:c,analyticsMetadata:o,trackContentReferenceEvent:a,eventMetadata:{imageUse:"imageGroup",layout:"carousel"},className:"h-full w-full",badge:E&&s.length>m&&n.jsx(mr,{numImages:s.length}),aspectRatio:Hs,contentReferenceType:"image_group"})},(N=(w=b.image_result)==null?void 0:w.thumbnail_url)!=null?N:"".concat(b.image_search_query,"-").concat(b.image_ref_id,"-").concat(C))},e[15]=o,e[16]=c,e[17]=s.length,e[18]=m,e[19]=a,e[20]=_):_=e[20],h=s.slice(0,m).map(_),e[9]=o,e[10]=c,e[11]=s,e[12]=m,e[13]=a,e[14]=h}else h=e[14];let y;return e[21]!==h?(y=n.jsx("div",{className:f,children:h}),e[21]=h,e[22]=y):y=e[22],y}function om(t){return!!t}function am(t){return t.image_result}const rm=g.memo(nm,An);function im(t){"use forget";var C;const e=ue.c(14),{images:s,analyticsMetadata:o,trackContentReferenceEvent:a}=t,r=Pa();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={track:"height"},e[0]=i):i=e[0];const[l,d]=xl(i),c=(C=l==null?void 0:l.height)!=null?C:null,m=r==null?void 0:r.onFullWidthImageHeightChange;let f,h;e[1]!==m||e[2]!==c?(f=()=>{!m||c==null||m(c)},h=[m,c],e[1]=m,e[2]=c,e[3]=f,e[4]=h):(f=e[3],h=e[4]),g.useEffect(f,h);let y;e[5]!==o||e[6]!==s||e[7]!==a?(y=s.map(E=>{var p;return{content:n.jsx(at,{image:(p=E.image_result)!=null?p:void 0,imageSource:kt.ImageGroup,aspectRatio:null,enableHoverAnimation:!1,analyticsMetadata:o,trackContentReferenceEvent:a,skeletonEl:n.jsx("div",{className:"bg-token-main-surface-tertiary aspect-[5/4] h-full w-full animate-pulse"}),lightboxImages:s.map(cm).filter(lm),className:"h-full w-full",contentReferenceType:"image_group",fadeInOnMount:!0})}}),e[5]=o,e[6]=s,e[7]=a,e[8]=y):y=e[8];const v=y;let _;e[9]!==v?(_=n.jsx(Vu,{images:v,aspect:"aspect-[5/4]",showDots:!0}),e[9]=v,e[10]=_):_=e[10];let b;return e[11]!==d||e[12]!==_?(b=n.jsx("div",{ref:d,className:"-mx-6 mt-[calc(-1rem-3px)] pb-5",children:_}),e[11]=d,e[12]=_,e[13]=b):b=e[13],b}function lm(t){return!!t}function cm(t){return t.image_result}const dm=g.memo(im,An),um=200,mm=100,os=Pt({id:"imagePill.screenshot",defaultMessage:"screenshot"}),hr="m-0 p-[2px] pe-1",fm=A(hr,"h-full rounded-lg object-contain"),hm=A(hr,"p-[4px]");function Uo({image:t}){const[e,s]=g.useState(!1),o=vn.useStore(),a=g.useRef(null),r=g.useRef(null),i=ie(),l=t==null?void 0:t.content_url,d=g.useMemo(()=>l?$s(l,"hostname"):null,[l]),c=g.useCallback(()=>{a.current&&clearTimeout(a.current)},[]),m=g.useCallback(()=>{t&&(c(),s(!1),o.setCurrentImage({image:t}))},[o,t,c]),f=g.useCallback(()=>{r.current&&clearTimeout(r.current)},[]),h=g.useCallback(()=>{s(!1)},[s]),y=g.useCallback(b=>{b.stopPropagation(),f(),a.current=setTimeout(()=>{s(!0)},um)},[f]),v=g.useCallback(b=>{b.stopPropagation(),c(),r.current=setTimeout(()=>{h()},mm)},[c,h]);g.useEffect(()=>{e&&f()},[e,f]);const _=g.useMemo(()=>({onBlur:v,onMouseLeave:v,onMouseEnter:y,onFocus:y}),[v,y]);return t?n.jsxs("span",Y(M({onClick:m,className:"relative"},_),{children:[n.jsxs(Ho,{isOpen:e,children:[n.jsx("img",{className:fm,src:t.thumbnail_url}),n.jsx("span",{children:d!=null?d:i.formatMessage(os)})]}),e&&n.jsx("div",{className:"absolute start-0 z-50",children:n.jsxs("div",Y(M({className:A("text-token-text-secondary border-token-border-light w-[256px] cursor-pointer px-3 pt-2 pb-3 text-sm shadow-md outline-[0.5px] outline-black/5",Si)},_),{children:[n.jsxs(ut,{href:t.content_url,target:"_blank",rel:"noopener",className:"z-50 mb-2 flex items-center gap-2 hover:opacity-70",onClick:b=>b.stopPropagation(),children:[n.jsx(is,{url:t.content_url,className:"m-0 size-4 p-0",size:32}),d!=null?d:i.formatMessage(os)]}),n.jsx("img",{className:"border-token-border-light m-0 cursor-pointer rounded-lg object-contain p-0 outline-[0.5px] outline-black/5",src:t.thumbnail_url,alt:d!=null?d:i.formatMessage(os),onClick:b=>{b.preventDefault(),m()}})]}))})]})):n.jsxs(Ho,{isOpen:!1,children:[n.jsx("span",{className:hm,children:n.jsx(zt,{})}),n.jsx("span",{children:d!=null?d:i.formatMessage(os)})]})}function Ho(o){var a=o,{children:t,isOpen:e}=a,s=$e(a,["children","isOpen"]);return n.jsx("span",Y(M({className:A("ms-1 cursor-pointer","inline-flex max-w-full items-center","relative top-[0.2rem]","animate-[show_150ms_ease-in]")},s),{children:n.jsx("span",{className:A("text-token-text-secondary flex h-4.5 overflow-hidden rounded-xl bg-[#F4F4F4] pe-2 text-[0.5625em] font-medium dark:bg-[#303030]","hover:bg-token-text-primary! hover:text-token-text-inverted",e&&"bg-token-main-surface-tertiary text-token-text-secondary","transition-colors duration-150 ease-in-out","items-center justify-center"),children:t})}))}async function pm({conversationId:t,messageId:e,assetPointerLinks:s,sharedConversationLikeId:o}){return await Ni.safePost("/conversation/get_images_for_message",{requestBody:{conversation_id:t!=null?t:null,share_id:o!=null?o:null,message_id:e,asset_pointer_links:s},authOption:$i.SendIfAvailable})}function gm({reference:t,conversationId:e,messageId:s,sharedConversationLikeId:o,isN7jupdMessage:a}){return Lr(M({queryKey:["inline-images",t,e,s],queryFn:async()=>{if(!t.asset_pointer_links||t.asset_pointer_links.length===0||!e&&!o)return{images:[],formats:[]};const i=await pm({conversationId:e,messageId:s,assetPointerLinks:t.asset_pointer_links,sharedConversationLikeId:o});for(let l=0;l<i.images.length;l++){const d=i.images[l],c=i.formats[l],m="image/".concat(c),f=xm(d,m);i.images[l]=f}return i}},a?{retry:3,retryDelay:5e3}:{}))}function xm(t,e="",s=512){const o=atob(t),a=[];for(let i=0;i<o.length;i+=s){const l=o.slice(i,i+s),d=new Array(l.length);for(let m=0;m<l.length;m++)d[m]=l.charCodeAt(m);const c=new Uint8Array(d);a.push(c)}const r=new Blob(a,{type:e});return URL.createObjectURL(r)}const bm=200;function ym({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:o}){var h;const a=pn(e),{postId:r}=g.useContext(bl),{data:i,isLoading:l,isError:d,error:c}=gm({reference:t,conversationId:a,messageId:s.id,sharedConversationLikeId:r,isN7jupdMessage:(h=s.metadata)==null?void 0:h.n7jupd_message}),m=g.useRef([]);g.useEffect(()=>()=>{m.current.forEach(y=>{URL.revokeObjectURL(y)}),m.current=[]},[]);const f=pr(s,t);return c||d||i&&!("images"in i)||l||!(i!=null&&i.images.length)?null:(m.current=[],n.jsx(n.Fragment,{children:i==null?void 0:i.images.map((y,v)=>{const _=gr(t,y,f);return n.jsx(In,{metadata:_,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:o},"image-carousel-inline-".concat(v))})}))}const wm=(t,e)=>{const s=new RegExp(e+"\\s*([^\\n]+)","m"),o=t.match(s);return o&&o[1]?o[1].trim().length:0};function pr(t,e){return g.useMemo(()=>{let s=-1;return t.content.content_type==="text"&&(s=wm(t.content.parts.join(""),e.matched_text)),s<bm||s===-1},[t,e.matched_text])}function gr(t,e,s){var o,a,r;return{matched_text:t.matched_text,start_idx:t.start_idx,end_idx:t.end_idx,safe_urls:t.safe_urls,alt:t.alt,prompt_text:t.prompt_text,type:"image_v2",refs:[],images:[{url:e,content_url:(o=t.clicked_from_url)!=null?o:"",thumbnail_url:e,title:(a=t.clicked_from_title)!=null?a:"",attribution:$s((r=t.clicked_from_url)!=null?r:e,"hostname"),content_size:{width:Vo,height:qo},thumbnail_size:{width:Vo,height:qo},is_proxied_image:!0,float_top:s}]}}const Vo=141,qo=143;function vm({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:o}){var y,v,_,b,C;const a=((y=s.metadata)==null?void 0:y.n7jupd_message)&&t.matched_text.includes("screenshot"),r=pn(e),i=(_=(v=g.useContext(Ci))==null?void 0:v.serverSharedThreadId)!=null?_:void 0,l=yl(t.asset_pointer_links[0]),d=g.useMemo(()=>({content_type:ma.ImageAssetPointer,size_bytes:0,width:0,height:0,asset_pointer:l}),[l]),c=Sa({asset:d,sharedThreadId:i,conversationId:r}),m=(b=c.data)==null?void 0:b.url,f=pr(s,t),h=g.useMemo(()=>m?gr(t,m,f):null,[m,t,f]);return c.error||c.isError?null:a&&!((C=c.data)!=null&&C.url)&&c.isLoading?n.jsx(Uo,{image:null},"image-pill-loading"):!a&&(c.isLoading||!c.data)||!h?null:a?n.jsx(Uo,{image:h.images[0]}):n.jsx(In,{metadata:h,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:o})}const He={TTFP:"products.ttfp",TTLT:"products.ttlt",TTF_VISIBLE_CONTENT_TOKEN:"products.ttf_visible_content_token"},Rn={[He.TTFP]:new Set,[He.TTLT]:new Set,[He.TTF_VISIBLE_CONTENT_TOKEN]:new Set};function Vs({profiler:t,messageId:e,metric:s,overrideDurationMs:o}){Rn[s].add(e);const a=jl();t.logTimingOnce(s,{context:{eval_preset:a.eval_preset},overrideDurationMs:o})}function qs({messageId:t,metric:e}){return Rn[e].has(t)}function xr(t){"use forget";const e=ue.c(27),{clientThreadId:s,messageId:o,products:a}=t;let r;e[0]!==o?(r=w=>[ct.getRequestId(w),ct.isMessageTurnEnded(w,o)],e[0]=o,e[1]=r):r=e[1];const[i,l]=js(s,r);let d;e[2]!==s?(d={namespace:wl.ProductsCompletionRequest,clientThreadId:s},e[2]=s,e[3]=d):d=e[3];const{profiler:c,isRequestActive:m}=vl(d),f=m&&!l,h=_l(f);let y,v;e[4]!==f||e[5]!==o||e[6]!==a.length||e[7]!==c?(y=()=>{qs({messageId:o,metric:He.TTFP})||c&&f&&a.length>0&&Vs({profiler:c,messageId:o,metric:He.TTFP})},v=[f,o,a.length,c],e[4]=f,e[5]=o,e[6]=a.length,e[7]=c,e[8]=y,e[9]=v):(y=e[8],v=e[9]),g.useEffect(y,v);let _,b;e[10]!==f||e[11]!==o||e[12]!==h||e[13]!==c?(_=()=>{qs({messageId:o,metric:He.TTLT})||c&&h.current&&!f&&Vs({profiler:c,messageId:o,metric:He.TTLT})},b=[o,h,f,c],e[10]=f,e[11]=o,e[12]=h,e[13]=c,e[14]=_,e[15]=b):(_=e[14],b=e[15]),g.useEffect(_,b);const C=ye();let E;e[16]!==C||e[17]!==o||e[18]!==c||e[19]!==i?(E=()=>{if(qs({messageId:o,metric:He.TTF_VISIBLE_CONTENT_TOKEN}))return;const w=i?Ti(C,i):null;if(c&&w){const N=He.TTF_VISIBLE_CONTENT_TOKEN;Rn[N].add(o),Vs({profiler:c,messageId:o,metric:N,overrideDurationMs:w.turnTracker.first_visible_content_token_lat})}},e[16]=C,e[17]=o,e[18]=c,e[19]=i,e[20]=E):E=e[20];let p;e[21]!==C||e[22]!==o||e[23]!==a.length||e[24]!==c||e[25]!==i?(p=[o,c,i,a.length,C],e[21]=C,e[22]=o,e[23]=a.length,e[24]=c,e[25]=i,e[26]=p):p=e[26],g.useEffect(E,p)}function _m({contentReference:t,clientThreadId:e,messageId:s,turnIndex:o,trackContentReferenceEvent:a}){const r=g.useCallback(()=>a("Search Content Reference Shown","search_content_reference_shown","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[a,t.start_idx,t.product.id]),i=g.useCallback(()=>a("Search Content Reference Clicked","search_content_reference_clicked","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[a,t.start_idx,t.product.id]),l=t.product;g.useEffect(()=>r(),[r]),xr({clientThreadId:e,messageId:s,products:[l]});const{openThreadSidebar:d}=Ut();return n.jsx("span",{className:"entity-underline hover:entity-accent inline cursor-pointer align-baseline",onClick:()=>{if(i(),l.offers||!l.url){if(!e)return;d({type:"product",messageId:s,turnIndex:o,contentReferenceStartIndex:t.start_idx,productIndex:0,productId:l.id,productUrl:l.url,interactionSource:"inline_link"})}else window.open(l.url,"_blank")},children:n.jsx("span",{className:"whitespace-normal",children:l.title})})}function br({items:t,targetItemCount:e,onCardRender:s,onCardShown:o,onCardClicked:a,onReplyClicked:r,allowFullWidth:i=!1,cardClassName:l,showGradient:d=!0,arrowClassName:c}){const m=g.useRef(null),[f,h]=g.useState(null),y=g.useRef(null),v=()=>{y.current=setTimeout(()=>{h(null),y.current=null},200)},_=()=>{y.current&&(clearTimeout(y.current),y.current=null)},b=g.useRef(null),[C,E]=g.useState({left:0,top:0}),p=8;g.useEffect(()=>{const S=m.current,I=b.current;if(!r||!f||!S||!I)return;const W=()=>{const x=f.card.getBoundingClientRect(),L=S.getBoundingClientRect(),F=I.getBoundingClientRect(),O=x.bottom-L.top+p;var T=x.left-L.left;T=Math.max(0,T),T=Math.min(T,L.width-F.width),E({left:T,top:O})};return W(),S.addEventListener("scroll",W),()=>S.removeEventListener("scroll",W)},[f,t,r]);const w=Bt(),N=w?2:4;if(e===void 0)e=t.length;else if(!e&&t.length<N)return null;const k=(e!=null?e:t.length)>=N,$=k&&w;return n.jsxs("div",{className:"relative",children:[n.jsx("div",{ref:m,className:A("flex flex-row gap-4 py-2",$&&"mx-[-1rem] px-[1rem]",k&&"no-scrollbar snap-x snap-mandatory overflow-x-scroll scroll-smooth"),children:t.map((S,I)=>n.jsx("div",{className:A(k||!i?"shrink-0 basis-[calc((100%-2rem)/3)] snap-start":"min-w-0 flex-1"),children:n.jsx(jm,{cardClassName:l,onShown:()=>o(S,I),onClick:()=>a(S,I),onHover:W=>{_(),W?h({card:W,item:S,index:I}):v()},children:s(S,!w&&e===1)})},I))}),k&&!$&&n.jsx(km,{scrollableRef:m,units:t.length,showGradient:d,arrowClassName:c}),r&&n.jsx("div",{ref:b,className:A("absolute z-10",f?"pointer-events-auto opacity-100":"pointer-events-none opacity-0","transition-[transform,opacity] duration-200"),style:{willChange:"opacity, transform",left:C.left,top:C.top,transform:f?"translateY(0)":"translateY(".concat(-p,"px)")},onMouseEnter:_,onMouseLeave:v,children:n.jsx(Ve,{className:A(f?"pointer-events-auto":"pointer-events-none","border-light bg-clip-padding px-4 py-2 shadow-md"),size:"small",color:"secondary",onClick:()=>f&&r(f.item,f.index),children:n.jsxs("div",{className:"flex flex-row items-center gap-1",children:[n.jsx(Ic,{className:"icon-sm text-token-text-secondary"}),n.jsx(K,{id:"9TG7OR",defaultMessage:"Ask about this"})]})})})]})}function jm({onShown:t,onClick:e,onHover:s,children:o,cardClassName:a}){const r=g.useRef(null),i=g.useRef(t);return g.useEffect(()=>{i.current=t},[t]),g.useEffect(()=>{if(!r.current)return;const l=new IntersectionObserver(([d])=>d.isIntersecting&&i.current(),{threshold:.5});return l.observe(r.current),()=>l.disconnect()},[]),n.jsx("div",{ref:r,className:A("h-full w-full","bg-token-bg-primary cursor-pointer",a),onClick:e,onMouseEnter:()=>r.current&&s(r.current),onMouseLeave:()=>s(null),children:o})}function km({scrollableRef:t,units:e,showGradient:s,arrowClassName:o}){const[a,r]=g.useState({left:!1,right:!1}),[i,l]=g.useState(!1);g.useEffect(()=>{const c=t.current;if(!c)return;const m=()=>{const{scrollLeft:f,scrollWidth:h,clientWidth:y}=c,v=f/(h-y);r({left:v>0,right:v<.99}),!i&&f>0&&l(!0)};return m(),c.addEventListener("scroll",m),()=>c.removeEventListener("scroll",m)},[t,e,i]);const d=c=>{const m=t.current;if(!m)return;l(!0);const{clientWidth:f,scrollWidth:h,scrollLeft:y}=m,v=Math.max(0,h-f),_=Math.max(0,Math.min(v,y+c*f));m.scrollTo({left:_,behavior:"smooth"})};return n.jsxs("div",{className:"pointer-events-none absolute start-0 top-0 flex h-full w-full flex-row",children:[n.jsx("div",{className:A("flex h-full w-9 items-center justify-start",i&&s&&"bg-linear-to-r from-(--bg-primary) to-transparent",a.left?"opacity-100":"opacity-0","transition-opacity duration-100"),children:n.jsx(Ve,{color:"secondary",size:"small",className:A("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[-50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",o),onClick:()=>d(-1),children:n.jsx(ba,{className:"icon"})})}),n.jsx("div",{className:A("ms-auto flex h-full w-9 items-center justify-end",i&&s&&"bg-linear-to-l from-(--bg-primary) to-transparent",a.right?"opacity-100":"opacity-0","transition-opacity duration-200"),children:n.jsx(Ve,{color:"secondary",size:"small",className:A("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",o),onClick:()=>d(1),children:n.jsx(_n,{className:"icon"})})})]})}function Sm({contentReference:t,clientThreadId:e,messageId:s,turnIndex:o,analyticsMetadata:a}){const r=t.products,i=t.target_product_count;xr({clientThreadId:e,messageId:s,products:r});const{showDebugConversationTurns:l}=Ei(),d=js(e,w=>{var $,S;const k=(S=($=ct.getNode(w,s).message.metadata)==null?void 0:$.content_references)==null?void 0:S.find(I=>I.type==="products");return t.start_idx===(k==null?void 0:k.start_idx)}),c=ye(),m=ve(c,"3144771298"),f=ve(c,"2212894775"),h=Ca(a),y=g.useCallback((w,N)=>h("Search Content Reference Shown","search_content_reference_shown","products",{content_reference_start_index:t.start_idx,product_index:N,product_id:w.id,product_url:w.url}),[h,t.start_idx]),v=g.useCallback((w,N)=>h("Search Content Reference Clicked","search_content_reference_clicked","products",{content_reference_start_index:t.start_idx,product_index:N,product_id:w.id}),[h,t.start_idx]),_=kl(c),{openThreadSidebar:b}=Ut(),C=(w,N)=>{if(e)if(v(w,N),w.offers){const k=Cl(),$=k?_.rooms$().get(k):null,S={type:"product",messageId:s,turnIndex:o,contentReferenceStartIndex:t.start_idx,productIndex:N,productId:w.id,productUrl:w.url,interactionSource:"carousel"};$!=null?_.hasAccess&&_.openThreadSidebar$($,S):b(S)}else window.open(w.url,"_blank")},{setTargetedContent:E}=Sl(),p=(w,N)=>{rs.logEventWithStatsig("Product Targeted Reply Clicked","product_targeted_reply_clicked",Y(M({},xa(a)),{content_reference_start_index:t.start_idx,product_index:(N+1).toString(),product_id:w.id})),E({type:"object",label:w.title,createNewCompletionParams:k=>{var S;const $=Mi(w.title);return Y(M({},k),{promptMessage:Nl(k.promptMessage,{metadata:{targeted_reply:w.title,targeted_reply_label:w.title,targeted_reply_icon:"product_tag"}}),appendMessages:[...(S=k.appendMessages)!=null?S:[],$]})},onCreateCompletion:({serverThreadId:k,currentLeafId:$})=>{rs.logEventWithStatsig("Targeted Reply Submitted","chatgpt_targeted_reply_submitted",{conversation_id:k,current_leaf_id:$,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(N+1).toString(),product_id:w.id})},onCleared:({serverThreadId:k,currentLeafId:$})=>{rs.logEventWithStatsig("Targeted Reply Cleared","chatgpt_targeted_reply_cleared",{conversation_id:k,current_leaf_id:$,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(N+1).toString(),product_id:w.id})}})};if(t.inline_carousel&&r.length===1){const w=r[0];return n.jsx("div",{className:"flex flex-col","data-testid":"shopping-widget",children:n.jsx(Em,{product:w,showDebug:l,onShown:()=>y(w,0),onClicked:()=>C(w,0)})})}return n.jsxs("div",{className:"flex flex-col","data-testid":"products-widget",children:[n.jsx(br,{items:r,targetItemCount:i,onCardRender:(w,N)=>n.jsx(Cm,{product:w,wide:N,showDebug:l,isProductV2CardEnabled:f}),onCardShown:y,onCardClicked:C,onReplyClicked:f?void 0:p,arrowClassName:f?"translate-y-[-85%]":"",allowFullWidth:!0,showGradient:!f,cardClassName:A(f?"group":"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden")}),d&&m&&!f&&n.jsxs("div",{className:"text-token-text-tertiary flex text-xs hover:cursor-pointer hover:underline",onClick:()=>window.open("https://help.openai.com/en/articles/11128490","_blank"),children:[n.jsx(K,{id:"4Y5Zn5",defaultMessage:"ChatGPT chooses products independently. Learn more"}),n.jsx(_n,{className:"icon -ms-0.5"})]}),!1]})}function Cm(t){"use forget";const e=ue.c(5),{product:s,wide:o,showDebug:a,isProductV2CardEnabled:r}=t,i=a===void 0?!1:a;let l;return e[0]!==r||e[1]!==s||e[2]!==i||e[3]!==o?(l=r?n.jsx($m,{product:s,wide:o,showDebug:i}):n.jsx(Nm,{product:s,wide:o,showDebug:i}),e[0]=r,e[1]=s,e[2]=i,e[3]=o,e[4]=l):l=e[4],l}function Nm({product:t,wide:e,showDebug:s=!1}){var l,d;const o=t.image_urls?t.image_urls[0]:void 0,[a,r]=g.useState("contain"),i=g.useRef(null);return n.jsxs("div",{className:A("flex",e?"flex-row":"flex-col"),children:[n.jsxs("div",{className:A("relative aspect-square",e?"w-1/3":"w-full","bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse"),children:[o?n.jsx("img",{ref:i,className:"absolute inset-0 m-0 h-full w-full mix-blend-darken object-".concat(a),src:o,alt:t.title,onLoad:()=>{if(!i.current)return;const{naturalWidth:c,naturalHeight:m}=i.current,f=c/m;r(Math.abs(f-1)<.25?"cover":"contain")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Ns,{className:"text-token-text-tertiary h-12 w-12"})}),t.featured_tag&&n.jsx("div",{className:"absolute start-3 end-3 bottom-3",children:n.jsxs("div",{className:"relative max-w-fit px-2 py-1",children:[n.jsx("div",{className:"absolute inset-0 rounded-full bg-white/60 backdrop-blur-xl"}),n.jsx("div",{className:"relative truncate text-xs font-semibold text-gray-950",children:t.featured_tag})]})})]}),n.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[n.jsx("div",{className:"line-clamp-2 leading-snug font-semibold text-ellipsis",children:t.title}),t.description&&n.jsx("div",{className:"line-clamp-3 pt-3 text-sm text-ellipsis",children:t.description}),n.jsx("div",{className:"flex-1"}),n.jsxs("div",{className:"flex flex-row items-end pt-3",children:[n.jsxs("div",{className:"flex flex-col overflow-hidden",children:[n.jsx("div",{className:"text-md leading-snug font-semibold",children:t.price}),n.jsx("div",{className:"text-token-text-secondary overflow-hidden pt-0.5 text-xs text-ellipsis whitespace-nowrap",children:t.merchants})]}),n.jsx("div",{className:"flex-1"}),t.num_reviews&&t.num_reviews>0&&n.jsxs("div",{className:"text-token-text-secondary flex w-fit flex-row gap-1 text-sm",children:[n.jsx(Kr,{rating:(l=t.rating)!=null?l:0/5}),((d=t.rating)!=null?d:0).toFixed(1)]})]}),!1]})]})}function $m({product:t,wide:e,showDebug:s=!1}){const o=t.image_urls?t.image_urls[0]:void 0,[a,r]=g.useState("contain"),[i,l]=g.useState("top"),d=g.useRef(null);return n.jsxs("div",{className:A("flex pb-2",e?"flex-row gap-3":"flex-col gap-2"),children:[n.jsx("div",{className:A("relative",e?"aspect-square w-1/4":"aspect-[13/16] w-full","overflow-clip rounded-xl bg-[#F3F3F3] dark:bg-[#F3F3F3]"),children:n.jsx(Ta,{className:"mix-blend-darken",children:o?n.jsx("img",{ref:d,className:"absolute inset-0 m-0 h-full w-full object-".concat(a," object-").concat(i),src:o,alt:t.title,onLoad:()=>{if(!d.current)return;const{naturalWidth:c,naturalHeight:m}=d.current,f=c/m;r(Math.abs(f-1)<.4?"cover":"contain"),l(m>c?"top":"center")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Ns,{className:"text-token-text-tertiary h-12 w-12"})})})}),n.jsxs("div",{className:"flex flex-col gap-1 px-1",children:[n.jsx("div",{className:A("line-clamp-2 font-medium text-ellipsis",e?"text-base":"text-sm"),children:t.title}),n.jsxs("div",{className:"text-token-text-secondary flex flex-row gap-0.25 text-sm",children:[n.jsx("div",{children:t.price}),n.jsx("div",{className:"mx-0.5",children:"•"}),n.jsx("div",{className:"w-0 flex-1 truncate",children:t.merchants})]}),!1]})]})}function Tm({className:t,imageUrl:e,productTitle:s,onClicked:o}){const[a,r]=g.useState("contain"),i=g.useRef(null);return n.jsx("div",{className:A(t,"hover:scale-[1.005]","dark:bg-token-text-inverted bg-token-bg-primary","cursor-pointer overflow-hidden rounded-xl shadow-inner transition-all duration-200","relative aspect-square max-h-60"),onClick:o,children:e?n.jsx("img",{ref:i,className:"m-0 h-full w-full overflow-hidden object-".concat(a," mix-blend-darken"),src:e,alt:s,onLoad:()=>{if(!i.current)return;const{naturalWidth:l,naturalHeight:d}=i.current,c=l/d;r(Math.abs(c-1)<.5?"cover":"contain")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Ns,{className:"text-token-text-tertiary h-12 w-12"})})})}function Em({product:t,showDebug:e=!1,onShown:s,onClicked:o}){return g.useEffect(()=>{s()},[s]),n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex flex-row gap-2 py-2",children:t.image_urls&&t.image_urls.length>0&&t.image_urls.slice(0,3).map(a=>n.jsx(Tm,{imageUrl:a,productTitle:t.title,onClicked:o},a))}),!1]})}const $t=new Map,Mm=256*256;function Pm(){"use forget";const t=ue.c(2),[e,s]=g.useState(160);let o,a;return t[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{if(typeof window>"u"||!window.matchMedia)return;const r=window.matchMedia("(min-width: 1024px)"),i=()=>s(r.matches?200:160);i();try{return r.addEventListener("change",i),()=>r.removeEventListener("change",i)}catch(l){return r.addListener(i),()=>{r.removeListener(i)}}},a=[],t[0]=o,t[1]=a):(o=t[0],a=t[1]),g.useEffect(o,a),e}function Im(){"use forget";const t=ue.c(2),[e,s]=g.useState(!1);let o,a;return t[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{if(typeof window>"u"||!window.matchMedia)return;const r=window.matchMedia("(min-width: 1024px)"),i=()=>s(r.matches);i();try{return r.addEventListener("change",i),()=>r.removeEventListener("change",i)}catch(l){return r.addListener(i),()=>{r.removeListener(i)}}},a=[],t[0]=o,t[1]=a):(o=t[0],a=t[1]),g.useEffect(o,a),e}function Am(){"use forget";const t=ue.c(2),[e,s]=g.useState(!1);let o,a;return t[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{if(typeof window>"u"||!window.matchMedia)return;const r=window.matchMedia("(max-width: 400px)"),i=()=>s(r.matches);i();try{return r.addEventListener("change",i),()=>r.removeEventListener("change",i)}catch(l){return r.addListener(i),()=>{r.removeListener(i)}}},a=[],t[0]=o,t[1]=a):(o=t[0],a=t[1]),g.useEffect(o,a),e}function Rm(t,e,s){let o=$t.get(t);if(o||(o={widths:new Map,subs:new Set,anchorId:void 0,anchorWidth:void 0},$t.set(t,o)),o.widths.set(e,s),!o.anchorId){o.anchorId=e,o.anchorWidth=s;for(const a of o.subs)a(o.anchorWidth);return}if(o.anchorId===e&&o.anchorWidth!==s){o.anchorWidth=s;for(const a of o.subs)a(o.anchorWidth)}}function Lm(t,e){const s=$t.get(t);s&&(s.widths.delete(e),s.anchorId===e&&(s.anchorId=void 0),s.widths.size===0&&$t.delete(t))}function Dm(t,e){let s=$t.get(t);return s||(s={widths:new Map,subs:new Set,anchorId:void 0,anchorWidth:void 0},$t.set(t,s)),s.subs.add(e),e(s.anchorWidth),()=>{s==null||s.subs.delete(e)}}function Fm(t){"use forget";var Fn,On,Wn,zn,Bn,Un,Hn,Vn,qn,Gn,Xn,Yn,Kn;const e=ue.c(114),{contentReference:s,clientThreadId:o,messageId:a,trackContentReferenceEvent:r,contentReferenceIndex:i,displayLayout:l}=t,d=ye();let c;e[0]!==d?(c=ve(d,"3974614370"),e[0]=d,e[1]=c):c=e[1];const m=c,f=pn(o);let h;e[2]!==s.end_idx||e[3]!==s.product.id||e[4]!==s.product.merchants||e[5]!==s.product.price||e[6]!==s.product.title||e[7]!==s.product.url||e[8]!==s.render_as||e[9]!==s.start_idx||e[10]!==a||e[11]!==f||e[12]!==r?(h=()=>r("Shopping Content Reference Shown","chatgpt_shopping_content_reference_shown","product",{content_reference_start_index:s.start_idx,content_reference_end_index:s.end_idx,product_id:s.product.id,message_id:a,conversation_id:f,product_url:s.product.url,render_as:s.render_as,price:s.product.price,product_name:s.product.title,merchant_name:s.product.merchants}),e[2]=s.end_idx,e[3]=s.product.id,e[4]=s.product.merchants,e[5]=s.product.price,e[6]=s.product.title,e[7]=s.product.url,e[8]=s.render_as,e[9]=s.start_idx,e[10]=a,e[11]=f,e[12]=r,e[13]=h):h=e[13];const y=ao(h);let v;e[14]!==s.end_idx||e[15]!==s.product.id||e[16]!==s.product.merchants||e[17]!==s.product.price||e[18]!==s.product.title||e[19]!==s.product.url||e[20]!==s.render_as||e[21]!==s.start_idx||e[22]!==a||e[23]!==f||e[24]!==r?(v=()=>r("Shopping Content Reference Clicked","chatgpt_shopping_content_reference_clicked","product",{content_reference_start_index:s.start_idx,content_reference_end_index:s.end_idx,product_id:s.product.id,message_id:a,conversation_id:f,product_url:s.product.url,render_as:s.render_as,price:s.product.price,product_name:s.product.title,merchant_name:s.product.merchants}),e[14]=s.end_idx,e[15]=s.product.id,e[16]=s.product.merchants,e[17]=s.product.price,e[18]=s.product.title,e[19]=s.product.url,e[20]=s.render_as,e[21]=s.start_idx,e[22]=a,e[23]=f,e[24]=r,e[25]=v):v=e[25];const _=ao(v),b=s.product;let C,E;e[26]!==y?(C=()=>y(),E=[y],e[26]=y,e[27]=C,e[28]=E):(C=e[27],E=e[28]),g.useEffect(C,E);const{openThreadSidebar:p}=Ut();let w;e[29]!==s.start_idx||e[30]!==a||e[31]!==p||e[32]!==b||e[33]!==m||e[34]!==_?(w=()=>{_(),m?p({type:"product_agent",messageId:a,product:b,contentReferenceStartIndex:s.start_idx,productIndex:0,interactionSource:"deep_shop"}):window.open(b.url,"_blank")},e[29]=s.start_idx,e[30]=a,e[31]=p,e[32]=b,e[33]=m,e[34]=_,e[35]=w):w=e[35];const N=w,k=(Fn=b.image_urls)==null?void 0:Fn[0],$=(On=s.render_as)!=null?On:"inline",S=$==="hero",[I,W]=g.useState(!0),x=S&&I,L=$==="table",F=l==="inline"&&!L;let O;e[36]!==b.price?(O=(Wn=b.price)==null?void 0:Wn.trim(),e[36]=b.price,e[37]=O):O=e[37];const T=O;let B;e[38]!==b.merchants?(B=(zn=b.merchants)==null?void 0:zn.trim(),e[38]=b.merchants,e[39]=B):B=e[39];const q=B,H=!!(T!=null?T:q),U=L?"table":F?"compact":"default",G=L?"flex w-full flex-col items-stretch gap-2 text-start self-start flex-1":F?"inline-flex max-w-full items-center gap-3 align-middle":"flex flex-row items-center gap-8 py-4";let P;e[40]!==G?(P=A(G,"cursor-pointer"),e[40]=G,e[41]=P):P=e[41];const u=P,D=L?"items-start text-start":"justify-center";let R;e[42]!==D?(R=A("flex flex-col gap-1",D),e[42]=D,e[43]=R):R=e[43];const z=R,V=L?"text-sm font-semibold line-clamp-2 text-balance":F?"text-base font-medium line-clamp-2 text-balance":"text-lg font-medium line-clamp-2 text-balance";let Z;e[44]!==V?(Z=A(V),e[44]=V,e[45]=Z):Z=e[45];const te=Z,me=L?"justify-start text-xs max-w-full":"text-sm";let re;e[46]!==me?(re=A("text-token-text-tertiary flex flex-wrap items-center gap-1 font-normal",me),e[46]=me,e[47]=re):re=e[47];const fe=re,se=g.useRef(null),ke=g.useId(),he=String(i!=null?i:ke),le=L?"product-table-".concat(a):"",[xe,Pe]=g.useState(void 0),Ge=Pm(),ft=Im(),ht=Am(),[Re,Xe]=g.useState(null),[Se,Ye]=g.useState(!1),_e=Re?Re.w/Math.max(1,Re.h):null,Ke=_e!=null&&_e>=1.8,pt=_e!=null&&_e<=.6,ne=_e==null||Ke||pt?"contain":"cover",J=Wm,ge=Om;let ce,be;if(e[48]!==le||e[49]!==he||e[50]!==k||e[51]!==L?(ce=()=>{if(!L||!k)return;const Fe=se.current;if(!Fe)return;const Te=J(Fe);if(Te){Te.style.paddingInlineEnd="8px";for(const Ze of Te.querySelectorAll("td"))Ze.style.textAlign="left"}const Ae=ge(Fe);Ae&&(Ae.style.verticalAlign="top",Ae.getAttribute("data-col-size")==="sm"&&Ae.setAttribute("data-col-size","md"));const Oe=new ResizeObserver(Ze=>{for(const Je of Ze){const We=Math.floor(Je.contentRect.width);We>0&&Rm(le,he,We)}});Oe.observe(Fe);const xt=Dm(le,Pe);return()=>{Oe.disconnect(),xt(),Lm(le,he)}},be=[le,he,L,k],e[48]=le,e[49]=he,e[50]=k,e[51]=L,e[52]=ce,e[53]=be):(ce=e[52],be=e[53]),Pi(ce,be),!b)return null;if(x){let Fe;e[54]===Symbol.for("react.memo_cache_sentinel")?(Fe=A("relative w-full overflow-hidden rounded-2xl bg-[#F3F3F3] dark:bg-[#F3F3F3]","aspect-auto h-auto","max-[400px]:h-auto"),e[54]=Fe):Fe=e[54];let Te;e:{if(ne==="cover"){if(ft){let ze;e[55]===Symbol.for("react.memo_cache_sentinel")?(ze={aspectRatio:2.59},e[55]=ze):ze=e[55],Te=ze;break e}if(ht){let ze;e[56]===Symbol.for("react.memo_cache_sentinel")?(ze={aspectRatio:1.5},e[56]=ze):ze=e[56],Te=ze;break e}const Ne=typeof _e=="number"&&_e>0?_e:2.59,qt=Math.min(Ne,2.59);let Gt;e[57]!==qt?(Gt={aspectRatio:qt},e[57]=qt,e[58]=Gt):Gt=e[58],Te=Gt;break e}if(ht){let Ne;e[59]===Symbol.for("react.memo_cache_sentinel")?(Ne={aspectRatio:1},e[59]=Ne):Ne=e[59],Te=Ne;break e}let wt;e[60]===Symbol.for("react.memo_cache_sentinel")?(wt={height:300},e[60]=wt):wt=e[60],Te=wt}let Ae;e[61]!==Se||e[62]!==ne||e[63]!==k||e[64]!==b.title?(Ae=k&&!Se&&n.jsx("img",{src:k,alt:(Bn=b.title)!=null?Bn:"",draggable:!1,className:A("absolute start-1/2 top-1/2 z-0 -translate-x-1/2 -translate-y-1/2","max-h-full max-w-full select-none",ne==="cover"?"object-cover":"object-contain","m-0 origin-center scale-100 mix-blend-darken transition-transform duration-200 hover:scale-105"),onLoad:wt=>{const Ne=wt.currentTarget;Ne.naturalWidth&&Ne.naturalHeight&&(Xe({w:Ne.naturalWidth,h:Ne.naturalHeight}),Ne.naturalWidth*Ne.naturalHeight<Mm&&W(!1))},onError:()=>Ye(!0)}),e[61]=Se,e[62]=ne,e[63]=k,e[64]=b.title,e[65]=Ae):Ae=e[65];let Oe;e[66]!==Se||e[67]!==k?(Oe=(!k||Se)&&n.jsx("div",{className:"text-token-text-tertiary/60 absolute start-1/2 top-1/2 z-0 -translate-x-1/2 -translate-y-1/2",children:n.jsx(yr,{className:"h-10 w-10"})}),e[66]=Se,e[67]=k,e[68]=Oe):Oe=e[68];let xt;e[69]===Symbol.for("react.memo_cache_sentinel")?(xt=n.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-10 mx-[-12px] mb-[-12px] h-[50%] bg-gradient-to-t from-black/30 to-transparent blur-md"}),e[69]=xt):xt=e[69];let Ze;e[70]===Symbol.for("react.memo_cache_sentinel")?(Ze=A("line-clamp-2 text-xl font-semibold text-balance text-ellipsis text-white lg:text-2xl","drop-shadow-[0_0_14px_rgba(0,0,0,0.45)]"),e[70]=Ze):Ze=e[70];let Je;e[71]!==b.title?(Je=n.jsx("h3",{className:Ze,children:b.title}),e[71]=b.title,e[72]=Je):Je=e[72];let We;e[73]!==b.merchants||e[74]!==b.price?(We=!!((Un=b.price)!=null?Un:b.merchants)&&n.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1 text-sm text-white/85 lg:text-base",children:[((Hn=b.price)==null?void 0:Hn.trim())&&n.jsx("span",{children:(Vn=b.price)==null?void 0:Vn.trim()}),((qn=b.price)==null?void 0:qn.trim())&&((Gn=b.merchants)==null?void 0:Gn.trim())&&n.jsx("span",{className:"mx-0.5",children:"•"}),((Xn=b.merchants)==null?void 0:Xn.trim())&&n.jsx("span",{className:"truncate",children:(Yn=b.merchants)==null?void 0:Yn.trim()})]}),e[73]=b.merchants,e[74]=b.price,e[75]=We):We=e[75];let bt;e[76]!==Je||e[77]!==We?(bt=n.jsxs("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-20 max-w-[70%] p-4 text-white dark:text-white",children:[Je,We]}),e[76]=Je,e[77]=We,e[78]=bt):bt=e[78];let yt;e[79]!==Te||e[80]!==Ae||e[81]!==Oe||e[82]!==bt?(yt=n.jsxs("div",{className:Fe,style:Te,children:[Ae,Oe,xt,bt]}),e[79]=Te,e[80]=Ae,e[81]=Oe,e[82]=bt,e[83]=yt):yt=e[83];let Vt;return e[84]!==N||e[85]!==yt?(Vt=n.jsx("div",{className:"w-full cursor-pointer",onClick:N,children:yt}),e[84]=N,e[85]=yt,e[86]=Vt):Vt=e[86],Vt}let Ce;e[87]!==xe?(Ce={width:xe},e[87]=xe,e[88]=Ce):Ce=e[88];let we;e[89]!==U||e[90]!==k||e[91]!==L||e[92]!==b.title||e[93]!==Ge||e[94]!==xe?(we=k&&n.jsx(zm,{imageUrl:k,productTitle:(Kn=b.title)!=null?Kn:"",size:U,pixelSize:L&&xe?Math.min(xe,Ge):void 0}),e[89]=U,e[90]=k,e[91]=L,e[92]=b.title,e[93]=Ge,e[94]=xe,e[95]=we):we=e[95];let Le;e[96]!==b.title||e[97]!==te?(Le=n.jsx("div",{className:te,children:b.title}),e[96]=b.title,e[97]=te,e[98]=Le):Le=e[98];let Ie;e[99]!==q||e[100]!==fe||e[101]!==T||e[102]!==H?(Ie=H&&n.jsxs("div",{className:fe,children:[T&&n.jsx("span",{children:T}),T&&q&&n.jsx("span",{className:"mx-0.5",children:"•"}),q&&n.jsx("span",{className:"truncate",children:q})]}),e[99]=q,e[100]=fe,e[101]=T,e[102]=H,e[103]=Ie):Ie=e[103];let gt;e[104]!==Le||e[105]!==Ie||e[106]!==z?(gt=n.jsxs("div",{className:z,children:[Le,Ie]}),e[104]=Le,e[105]=Ie,e[106]=z,e[107]=gt):gt=e[107];let Ht;return e[108]!==u||e[109]!==N||e[110]!==Ce||e[111]!==we||e[112]!==gt?(Ht=n.jsxs("div",{ref:se,className:u,style:Ce,onClick:N,children:[we,gt]}),e[108]=u,e[109]=N,e[110]=Ce,e[111]=we,e[112]=gt,e[113]=Ht):Ht=e[113],Ht}function Om(t){const e=t.parentElement;return e&&e.tagName.toLowerCase()==="th"?e:null}function Wm(t){var s,o,a;const e=(a=(o=(s=t.parentElement)==null?void 0:s.parentElement)==null?void 0:o.parentElement)==null?void 0:a.parentElement;return e&&e.tagName.toLowerCase()==="table"?e:null}function zm(t){"use forget";const e=ue.c(14),{className:s,imageUrl:o,productTitle:a,onClicked:r,size:i,pixelSize:l}=t,d=r===void 0?Bm:r,f={table:"w-full max-w-[160px] lg:max-w-[200px]",compact:"max-h-16",default:"w-[88px] lg:w-[160px]"}[i===void 0?"default":i],[h,y]=g.useState(null),[v,_]=g.useState(!1),b=h?h.w/Math.max(1,h.h):null,C=b!=null&&b>=1.8,E=b!=null&&b<=.6,p=C||E?"contain":"cover",w=A(s,"overflow-hidden rounded-xl","relative flex aspect-square shrink-0 items-center justify-center",f,"bg-[#F3F3F3] dark:bg-[#F3F3F3]");let N;e[0]!==l?(N=l?{width:l,height:l}:void 0,e[0]=l,e[1]=N):N=e[1];let k;e[2]!==v||e[3]!==o||e[4]!==p||e[5]!==a||e[6]!==_||e[7]!==y?(k=v?n.jsx(yr,{className:"text-token-text-tertiary/60 h-6 w-6"}):n.jsx("img",{className:A("size-full max-h-full max-w-full origin-center object-center mix-blend-darken transition-all duration-200 select-none",p==="contain"?"object-contain":"object-cover","scale-100 hover:scale-105"),src:o,alt:a,draggable:!1,onLoad:S=>{const I=S.currentTarget;I.naturalWidth&&I.naturalHeight&&y({w:I.naturalWidth,h:I.naturalHeight})},onError:()=>_(!0)}),e[2]=v,e[3]=o,e[4]=p,e[5]=a,e[6]=_,e[7]=y,e[8]=k):k=e[8];let $;return e[9]!==d||e[10]!==w||e[11]!==N||e[12]!==k?($=n.jsx("div",{className:w,onClick:d,style:N,children:k}),e[9]=d,e[10]=w,e[11]=N,e[12]=k,e[13]=$):$=e[13],$}function Bm(){}function yr(t){"use forget";const e=ue.c(5),{className:s}=t;let o,a,r;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",ry:"2"}),a=n.jsx("circle",{cx:"8.5",cy:"10",r:"1.5"}),r=n.jsx("path",{d:"M21 16l-5.5-5.5a1 1 0 00-1.4 0L7 18"}),e[0]=o,e[1]=a,e[2]=r):(o=e[0],a=e[1],r=e[2]);let i;return e[3]!==s?(i=n.jsxs("svg",{className:s,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[o,a,r]}),e[3]=s,e[4]=i):i=e[4],i}function Um({attribution:t,wordFadeType:e}){var r;const s=g.useContext(dt),o=$l(s==null?void 0:s.message.id,t.attributable_index),a=Tl();return n.jsx(qm,{isHighlighted:o,isDebugMode:a&&!1,content:(r=t.alt)!=null?r:"",attributableIndex:t.attributable_index,attributions:void 0,attributionsDebug:void 0,wordFadeType:e})}const Hm=g.memo(Sn);function Vm({content:t,isHighlighted:e,isDebugMode:s,attributableIndex:o,attributions:a,attributionsDebug:r,wordFadeType:i}){const l=i==="indexed",d=Na(),c=g.useMemo(()=>l?{handlers:{text:(h,y,v)=>{const _=[];for(const b of d(y.value))_.push({type:"element",tagName:"span",properties:{className:$a.fadeIn},children:[{type:"text",value:b}]});return _}}}:void 0,[l,d]),m=g.useMemo(()=>({p:({children:h})=>n.jsx(n.Fragment,{children:h})}),[]),f=n.jsx(Hm,{rehypePlugins:Zs,remarkPlugins:Ks,urlTransform:Ys,remarkRehypeOptions:c,components:m,children:t});return n.jsx(Gm,{isHighlighted:e,children:f})}const qm=Dr.memo(Vm);function Gm({isHighlighted:t,className:e,children:s}){return n.jsx("span",{className:A("relative","-mx-px my-[-0.2rem] rounded px-px py-[0.2rem]",t&&"attribution-highlight-bg","transition-colors duration-100 ease-in-out",e),children:s})}function Go(t,e){try{return BigInt(t).toLocaleString(e)}catch(s){const o=Number(t);return t.includes("e")||t.includes("E")?o.toExponential():o.toLocaleString(e,{maximumFractionDigits:6})}}function Xm({data:t,trackContentReferenceEvent:e}){g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=Ii().locale;return t.expression&&t.result!=null?n.jsxs("div",{className:"no-scrollbar overflow-auto sm:overflow-hidden",children:[n.jsxs("div",{className:"pb-1 text-lg font-semibold",children:[t.prefix&&n.jsx("span",{children:t.prefix}),n.jsx("span",{children:Go(t.result,s)}),t.suffix&&n.jsx("span",{children:t.suffix})]}),n.jsx("div",{className:"text-token-text-primary tracking-wide",children:"".concat(t.expression,"=").concat(Go(t.result,s))})]}):null}function wr({ref:t,onClick:e,onMouseEnter:s,onMouseLeave:o}){const a=ie();return n.jsx("button",{ref:t,"aria-label":a.formatMessage({id:"citation.icon.label",defaultMessage:"Coding Citation"}),onClick:e,onMouseEnter:s,onMouseLeave:o,className:A("rounded-xl px-1","bg-token-interactive-bg-tertiary-press text-token-text-secondary hover:text-token-text-inverted hover:bg-token-interactive-bg-primary-selected"),children:n.jsx(El,{className:"icon-sm"})})}function Ym({codeMessage:t,codeExecutionOutputMessage:e,onDismiss:s,FormattedText:o}){const a=ie();return n.jsx(ot.Root,{isOpen:!0,onClose:s,testId:"modal-code-execution",children:n.jsx(ot.Overlay,{children:n.jsxs(ot.Content,{className:"flex max-h-[75vh] max-w-lg flex-col overflow-hidden",children:[n.jsx(ot.Header,{title:a.formatMessage(Km.title),type:"success",closeButton:n.jsx(Ai,{onClick:s})}),n.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[n.jsx("div",{children:n.jsx(Ac,{FormattedText:o,message:t,codeRendererClassName:"border-none rounded-none",removeTopBorderRadius:!0})}),n.jsx("div",{children:n.jsx(Rc,{message:e})})]})]})})})}const Km=dn({title:{id:"CodeExecutionOutputModal.title",defaultMessage:"Analysis"}});function Zm({displayInfo:t,FormattedText:e,trackContentReferenceEvent:s}){const[o,a]=g.useState(!1),r=ie();return g.useEffect(()=>{s("Search Content Reference Shown","search_content_reference_shown",t.type)},[s,t.type]),n.jsxs(n.Fragment,{children:[n.jsx(pa,{label:r.formatMessage(Jm.viewAnalysis),side:"top",delayDuration:150,className:"align-middle",children:n.jsx(wr,{onClick:()=>a(!0)})}),o&&n.jsx(Ym,{FormattedText:e,codeMessage:t.codeMessage,codeExecutionOutputMessage:t.codeExecutionOutputMessage,onDismiss:()=>a(!1)})]})}const Jm=dn({viewAnalysis:{id:"viewAnalysis",defaultMessage:"View analysis"}});function Qm({contentReference:t,clientThreadId:e,turnIndex:s}){var y,v,_,b,C,E,p;const{toggleThreadSidebar:o}=Ut(),a=Ml("codingCitations"),[r,i]=g.useState(!1),l=g.useRef(null),d=()=>{l.current!=null&&window.clearTimeout(l.current),i(!0)},c=()=>{l.current=window.setTimeout(()=>i(!1),100)},m=g.useCallback(()=>{var w,N;e&&o({type:"codingCitations",turnIndex:s||1,messageId:(N=(w=t.cited_message)==null?void 0:w.id)!=null?N:"",matchedText:t.matched_text},a)},[o,e,a,t,s]);if(!t.cited_message||!t.highlighted_text)return null;let f;t.type==="python"?f=(_=(v=(y=t.cited_message)==null?void 0:y.metadata)==null?void 0:v.aggregate_result)==null?void 0:_.code:t.type==="container"&&(f=(E=(C=(b=t.cited_message)==null?void 0:b.metadata)==null?void 0:C.container_citation)==null?void 0:E.source_cmd);const h=(p=f==null?void 0:f.split("\n").length)!=null?p:0;return n.jsx("span",{className:"relative top-[0.1rem] inline-block align-middle",children:n.jsx("span",{className:"inline-flex items-center",children:n.jsxs(xn,{open:r,onOpenChange:i,children:[n.jsx(bn,{asChild:!0,children:n.jsx(wr,{onClick:m,onMouseEnter:d,onMouseLeave:c})}),n.jsx(yn,{children:n.jsx(wn,{align:"start",sideOffset:4,onMouseEnter:d,onMouseLeave:c,className:A("border-default bg-token-bg-primary rounded-2xl border p-3"),children:n.jsxs("aside",{className:"flex flex-col gap-3",children:[n.jsx("h2",{className:A("text-token-text-secondary text-xs font-medium"),children:t.type==="python"?n.jsx(K,{id:"citation.popover.label.python",defaultMessage:"Python script · {count, number} lines",values:{count:h}}):n.jsx(K,{id:"citation.popover.label.container",defaultMessage:"Bash script · {count, number} lines",values:{count:h}})}),n.jsx("hr",{}),n.jsx("h2",{className:A("text-sm font-medium","max-w-full break-words whitespace-pre-line sm:max-w-[300px]"),children:t.highlighted_text})]})})})]})})})}const ef="2758269539",tf=fn(()=>jt(()=>import("./g2euln7v5pbm31qa.js").then(t=>t.Dn),__vite__mapDeps([5,1,2,3,6])).then(t=>t.DILWidget));function sf({dil:t,dilUrl:e,trackContentReferenceEvent:s,widgetName:o}){g.useEffect(()=>{const r=o==null?void 0:{widget_name:o};s("Search Content Reference Shown","search_content_reference_shown","dil",r)},[s,o]);const a=ye();return ve(a,ef)?null:n.jsx(tf,{dil:t})}const vr=t=>{const e={};return t==null||t.forEach(s=>{s.selected_option_id&&(e[s.id]=s.selected_option_id)}),e},cn=t=>{if(!t)return t;const e=t.map(o=>o.id),s=vr(t);return t.map(o=>{var l,d;const a=o.options.map(c=>{var h,y;const m=(h=c.compatible_option_ids_by_group)!=null?h:void 0;let f=(y=c.available)!=null?y:!0;if(m&&(e.filter(_=>_!==o.id).some(_=>{var b,C;return((C=(b=m[_])==null?void 0:b.length)!=null?C:0)===0})&&e.length>1&&(f=!1),f))for(const[_,b]of Object.entries(s)){if(!b||_===o.id)continue;const C=m[_];if(!C||!C.includes(b)){f=!1;break}}return Y(M({},c),{available:f})}),r=(d=(l=a.find(c=>c.selected&&c.available))==null?void 0:l.id)!=null?d:"",i=a.map(c=>Y(M({},c),{selected:r!==""&&c.id===r}));return Y(M({},o),{options:i,selected_option_id:r||void 0})})};function nf({variants:t,optionGroupId:e,selectedOptionId:s}){var l;if(!t)return{variants:t,variantOptionsQuery:null};const o=t.map(d=>d.id===e?Y(M({},d),{options:d.options.map(c=>Y(M({},c),{selected:c.id===s})),selected_option_id:s}):d),a=cn(o),r=vr(a),i=(l=a==null?void 0:a.every(d=>d.selected_option_id))!=null?l:!1;return{variants:a,variantOptionsQuery:i?r:null}}function of({product:t,clientThreadId:e,messageId:s,contentReferenceStartIndex:o,trackContentReferenceEvent:a,showTitle:r=!1,showImageGallery:i=!1}){var p,w,N,k;const l=ye(),d=ve(l,"3375735072"),c=ve(l,"232003972"),m=g.useMemo(()=>({clientThreadId:e,messageId:s}),[e,s]),f=vn.useStore(),[h,y]=g.useState(!1),[v,_]=g.useState(Y(M({},t),{variants:cn(t.variants)})),[b,C]=g.useState(!1),E=r||c||d;return g.useEffect(()=>{let $=!0;return(async I=>{C(!0);try{try{for(var W=Rs(af(I)),x,L,F;x=!(L=await W.next()).done;x=!1){const O=L.value;$&&_(Y(M({},O),{variants:cn(O.variants)}))}}catch(L){F=[L]}finally{try{x&&(L=W.return)&&await L.call(W)}finally{if(F)throw F[0]}}}finally{$&&C(!1)}})(v),()=>{$=!1}},[(p=v.product_lookup_key)==null?void 0:p.variant_options_query]),v?n.jsxs("div",{className:"-mx-6",children:[i&&n.jsx(Zr,{imageUrls:(w=v.image_urls)!=null?w:[],title:v.title,onImageClick:$=>{f.setCurrentImage({image:{url:$,content_url:$,thumbnail_url:$,title:v.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:kt.ProductDetails,analyticsMetadata:m,contentReferenceStartIndex:o})}}),n.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col",children:[E&&n.jsxs("div",{className:"border-token-border-light flex flex-col border-b px-6 pb-3",children:[r&&n.jsx("div",{className:"text-token-text-primary text-xl font-medium capitalize",children:v.title}),c&&v.num_reviews&&v.rating&&n.jsx(Jr,{rating:v.rating,numReviews:v.num_reviews,ratingGroupedCitation:v.rating_grouped_citation,trackContentReferenceEvent:()=>{},analyticsMetadata:m}),d&&v.variants&&v.variants.length>0&&n.jsx("div",{className:"mt-5 mb-2",children:n.jsx(Qr,{options:v.variants,showErrors:h,updateOption:($,S,I)=>_(W=>rf({optionGroupId:$,selectedId:S,variant_index:I,product:W,trackContentReferenceEvent:a}))})})]}),n.jsx(ei,{className:"border-token-border-light -pt-3 -mx-3 flex flex-col border-b px-6 pb-3",offers:(N=t.offers)!=null?N:[],contentReferenceStartIndex:o,productIndex:0,product:t,trackContentReferenceEvent:a,analyticsMetadata:m,imageUrls:(k=t.image_urls)!=null?k:[],isLoading:b,onOpenCheckout:()=>y(!0)})]})]}):null}function af(t){return no(this,null,function*(){const{product_lookup_key:e}=t;if(!!!(e!=null&&e.variant_options_query)){yield t;return}const o=Pl("".concat(Ri,"/search/product_info_variants"),{method:"POST",headers:M({},mn({isAuthOptional:!0})),body:{product_lookup_key:t.product_lookup_key}});try{for(var a=Rs(o),r,i,l;r=!(i=yield new Kt(a.next())).done;r=!1){const d=i.value;"data"in d&&(yield d.data.product)}}catch(i){l=[i]}finally{try{r&&(i=a.return)&&(yield new Kt(i.call(a)))}finally{if(l)throw l[0]}}})}function rf({optionGroupId:t,selectedId:e,variant_index:s,product:o,trackContentReferenceEvent:a}){var d,c,m,f;const r=(d=o.variants)==null?void 0:d.find(h=>h.id===t);a("product_detail","product_detail","product_entity",{product_id:o.id,action:"variant_selected",section:"product_detail",section_location:"sidebar",variant_name:(c=r==null?void 0:r.label)!=null?c:"",variant_value:(f=(m=r==null?void 0:r.options.find(h=>h.id===e))==null?void 0:m.label)!=null?f:"",variant_index:s});const{variants:i,variantOptionsQuery:l}=nf({variants:o.variants,optionGroupId:t,selectedOptionId:e});return Y(M({},o),{variants:i,product_lookup_key:Y(M({},o.product_lookup_key),{variant_options_query:l})})}function lf({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:o}){var a,r,i;if(g.useEffect(()=>{var l,d;o("Entity Metadata Content Reference Shown","entity_metadata_content_reference_shown","entity_metadata",M({entity_type:t.entity_type},t.entity_type==="local_business"?{business_id:(l=t.entity_data)==null?void 0:l.id}:t.entity_type==="product"?{product_id:(d=t.entity_data)==null?void 0:d.id}:{}))},[o,t.entity_type,(a=t.entity_data)==null?void 0:a.id]),!(t!=null&&t.entity_data))return null;if(t.entity_type==="local_business"){const d=t.layout!=="one-line";return n.jsx(Mc,{isLoading:(r=t.metadata)==null?void 0:r.is_loading,business:t.entity_data,mapUrl:(i=t.metadata)==null?void 0:i.map_url,showActionButtons:d,showExtendedDetails:d,showTitle:d,showHourDetail:d,showPrice:d,trackContentReferenceEvent:o,topOffset:d?0:-4})}else if(t.entity_type==="product")return n.jsx(of,{product:t.entity_data,clientThreadId:e,messageId:s,contentReferenceStartIndex:t.start_idx,trackContentReferenceEvent:o});return null}function cf(t,e){return new Date(t).toLocaleDateString(e,{month:"long",day:"numeric",year:"numeric"})}function df({metadata:t,trackContentReferenceEvent:e}){const s=t.items.filter(o=>o.cloud_doc_url||Il(o.id));return s.length===0?null:n.jsx("div",{className:"mt-6 flex flex-col gap-3",children:s.map((o,a)=>n.jsx(uf,{item:o,index:a,trackContentReferenceEvent:e},a))})}function uf({item:t,index:e,trackContentReferenceEvent:s}){const o=ie(),a=ye(),r=Al(),{fileName:i,fileTypeDisplayName:l,fileTypeIcon:d,snippet:c,url:m,fileLastModifiedTime:f}=Lc(t,"icon object-contain",a,o,r),h={title:i,description:c!=null?c:"",index:e};return g.useEffect(()=>{s("Contextual Answers Content Reference Shown","contextual_answers_content_reference_shown","file_navlist",h)},[]),n.jsxs(ut,{className:"group/nav-list relative flex items-center gap-6 py-1.5",href:m!=null?m:"/",onClick:()=>{s("Contextual Answers Content Reference Clicked","contextual_answers_content_reference_clicked","file_navlist",h)},children:[n.jsx("div",{className:"absolute start-0 top-0 bottom-0 w-[3px] rounded-t-lg rounded-b-lg bg-black/10"}),n.jsxs("div",{className:"ms-4 flex grow flex-col gap-1 overflow-hidden text-ellipsis",children:[n.jsxs("div",{className:"not-prose text-token-text-primary flex items-center gap-1.5 text-sm",children:[d,n.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm",children:l})]}),n.jsx("div",{className:"text-token-link decoration-token-link line-clamp-2 font-semibold group-hover/nav-list:underline",children:i}),n.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm leading-snug font-normal",children:c}),f&&n.jsx("div",{className:"text-token-text-secondary text-sm",children:cf(f,o.locale)})]})]})}var Gs={line:{color:"#F66",width:1,dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(t,e){return!0},afterZoom:function(t,e){}}},mf={id:"crosshair",afterInit:function(t){if(t.config.options.scales.x){var e=t.config.options.scales.x.type;if(!(e!=="linear"&&e!=="time"&&e!=="category"&&e!=="logarithmic")){t.options.plugins.crosshair===void 0&&(t.options.plugins.crosshair=Gs),t.crosshair={enabled:!1,suppressUpdate:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,ignoreNextEvents:0,reset:function(){this.resetZoom(t,!1,!1)}.bind(this)};var s=this.getOption(t,"sync","enabled");s&&(t.crosshair.syncEventHandler=function(o){this.handleSyncEvent(t,o)}.bind(this),t.crosshair.resetZoomEventHandler=function(o){var a=this.getOption(t,"sync","group");o.chartId!==t.id&&o.syncGroup===a&&this.resetZoom(t,!0)}.bind(this),window.addEventListener("sync-event",t.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler)),t.panZoom=this.panZoom.bind(this,t)}}},afterDestroy:function(t){var e=this.getOption(t,"sync","enabled");e&&(window.removeEventListener("sync-event",t.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler))},panZoom:function(t,e){if(t.crosshair.originalData.length!==0){var s=t.crosshair.end-t.crosshair.start,o=t.crosshair.min,a=t.crosshair.max;e<0?(t.crosshair.start=Math.max(t.crosshair.start+e,o),t.crosshair.end=t.crosshair.start===o?o+s:t.crosshair.end+e):(t.crosshair.end=Math.min(t.crosshair.end+e,t.crosshair.max),t.crosshair.start=t.crosshair.end===a?a-s:t.crosshair.start+e),this.doZoom(t,t.crosshair.start,t.crosshair.end)}},getOption:function(t,e,s){return fo(t.options.plugins.crosshair[e]?t.options.plugins.crosshair[e][s]:void 0,Gs[e][s])},getXScale:function(t){return t.data.datasets.length?t.scales[t.getDatasetMeta(0).xAxisID]:null},getYScale:function(t){return t.scales[t.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(t,e){var s=this.getOption(t,"sync","group");if(e.chartId!==t.id&&e.syncGroup===s){var o=this.getXScale(t);if(o){var a=e.original.native.buttons===void 0?e.original.native.which:e.original.native.buttons;e.original.type==="mouseup"&&(a=0);var r={type:e.original.type=="click"?"mousemove":e.original.type,chart:t,x:o.getPixelForValue(e.xValue),y:e.original.y,native:{buttons:a},stop:!0};t._eventHandler(r)}}},afterEvent:function(t,e){if(t.config.options.scales.x.length==0)return;let s=e.event;var o=t.config.options.scales.x.type;if(!(o!=="linear"&&o!=="time"&&o!=="category"&&xscaleType!=="logarithmic")){var a=this.getXScale(t);if(a){if(t.crosshair.ignoreNextEvents>0){t.crosshair.ignoreNextEvents-=1;return}var r=s.native.buttons===void 0?s.native.which:s.native.buttons;s.native.type==="mouseup"&&(r=0);var i=this.getOption(t,"sync","enabled"),l=this.getOption(t,"sync","group");if(!s.stop&&i){var e=new CustomEvent("sync-event");e.chartId=t.id,e.syncGroup=l,e.original=s,e.xValue=a.getValueForPixel(s.x),window.dispatchEvent(e)}var d=this.getOption(t,"sync","suppressTooltips");if(t.crosshair.suppressTooltips=s.stop&&d,t.crosshair.enabled=s.type!=="mouseout"&&s.x>a.getPixelForValue(a.min)&&s.x<a.getPixelForValue(a.max),!t.crosshair.enabled&&!t.crosshair.suppressUpdate)return s.x>a.getPixelForValue(a.max)&&(t.crosshair.suppressUpdate=!0,t.update("none")),t.crosshair.dragStarted=!1,!1;t.crosshair.suppressUpdate=!1;var c=this.getOption(t,"zoom","enabled");if(r===1&&!t.crosshair.dragStarted&&c&&(t.crosshair.dragStartX=s.x,t.crosshair.dragStarted=!0),t.crosshair.dragStarted&&r===0){t.crosshair.dragStarted=!1;var m=a.getValueForPixel(t.crosshair.dragStartX),f=a.getValueForPixel(t.crosshair.x);Math.abs(t.crosshair.dragStartX-t.crosshair.x)>1&&this.doZoom(t,m,f),t.update("none")}t.crosshair.x=s.x,t.draw()}}},afterDraw:function(t){if(t.crosshair.enabled)return t.crosshair.dragStarted?this.drawZoombox(t):(this.drawTraceLine(t),this.interpolateValues(t),this.drawTracePoints(t)),!0},beforeTooltipDraw:function(t){return!t.crosshair.dragStarted&&!t.crosshair.suppressTooltips},resetZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(s){if(t.crosshair.originalData.length>0)for(var o=0;o<t.data.datasets.length;o++){var a=t.data.datasets[o];a.data=t.crosshair.originalData.shift(0)}t.crosshair.originalXRange.min?(t.options.scales.x.min=t.crosshair.originalXRange.min,t.crosshair.originalXRange.min=null):delete t.options.scales.x.min,t.crosshair.originalXRange.max?(t.options.scales.x.max=t.crosshair.originalXRange.max,t.crosshair.originalXRange.max=null):delete t.options.scales.x.max}t.crosshair.button&&t.crosshair.button.parentNode&&(t.crosshair.button.parentNode.removeChild(t.crosshair.button),t.crosshair.button=!1);var r=this.getOption(t,"sync","enabled");if(!e&&s&&r){var i=this.getOption(t,"sync","group"),l=new CustomEvent("reset-zoom-event");l.chartId=t.id,l.syncGroup=i,window.dispatchEvent(l)}s&&t.update("none")},doZoom:function(t,e,s){if(e>s){var o=e;e=s,s=o}var a=fo(t.options.plugins.crosshair.callbacks?t.options.plugins.crosshair.callbacks.beforeZoom:void 0,Gs.callbacks.beforeZoom);if(!a(e,s))return!1;if(t.crosshair.dragStarted=!1,t.options.scales.x.min&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.min=t.options.scales.x.min),t.options.scales.x.max&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.max=t.options.scales.x.max),!t.crosshair.button){var r=document.createElement("button"),i=this.getOption(t,"zoom","zoomButtonText"),l=this.getOption(t,"zoom","zoomButtonClass"),d=document.createTextNode(i);r.appendChild(d),r.className=l,r.addEventListener("click",function(){this.resetZoom(t)}.bind(this)),t.canvas.parentNode.appendChild(r),t.crosshair.button=r}t.options.scales.x.min=e,t.options.scales.x.max=s;var c=t.crosshair.originalData.length===0,m=t.config.options.scales.x.type!=="category";if(m)for(var f=0;f<t.data.datasets.length;f++){var h=[],y=0,v=!1,_=!1;c&&(t.crosshair.originalData[f]=t.data.datasets[f].data);for(var b=t.crosshair.originalData[f],C=0;C<b.length;C++){var E=b[C],p=E.x!==void 0?E.x:NaN;p>=e&&!v&&y>0&&(h.push(b[y-1]),v=!0),p>=e&&p<=s&&h.push(E),p>s&&!_&&y<b.length&&(h.push(E),_=!0),y+=1}t.data.datasets[f].data=h}if(t.crosshair.start=e,t.crosshair.end=s,c){var w=this.getXScale(t);t.crosshair.min=w.min,t.crosshair.max=w.max}t.crosshair.ignoreNextEvents=2,t.update("none");var N=this.getOption(t,"callbacks","afterZoom");N(e,s)},drawZoombox:function(t){var e=this.getYScale(t),s=this.getOption(t,"zoom","zoomboxBorderColor"),o=this.getOption(t,"zoom","zoomboxBackgroundColor");t.ctx.beginPath(),t.ctx.rect(t.crosshair.dragStartX,e.getPixelForValue(e.max),t.crosshair.x-t.crosshair.dragStartX,e.getPixelForValue(e.min)-e.getPixelForValue(e.max)),t.ctx.lineWidth=1,t.ctx.strokeStyle=s,t.ctx.fillStyle=o,t.ctx.fill(),t.ctx.fillStyle="",t.ctx.stroke(),t.ctx.closePath()},drawTraceLine:function(t){var e=this.getYScale(t),s=this.getOption(t,"line","width"),o=this.getOption(t,"line","color"),a=this.getOption(t,"line","dashPattern"),r=this.getOption(t,"snap","enabled"),i=t.crosshair.x;r&&t._active.length&&(i=t._active[0].element.x),t.ctx.beginPath(),t.ctx.setLineDash(a),t.ctx.moveTo(i,e.getPixelForValue(e.max)),t.ctx.lineWidth=s,t.ctx.strokeStyle=o,t.ctx.lineTo(i,e.getPixelForValue(e.min)),t.ctx.stroke(),t.ctx.setLineDash([])},drawTracePoints:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],o=t.getDatasetMeta(e),a=t.scales[o.yAxisID];o.hidden||!s.interpolate||(t.ctx.beginPath(),t.ctx.arc(t.crosshair.x,a.getPixelForValue(s.interpolatedValue),3,0,2*Math.PI,!1),t.ctx.fillStyle="white",t.ctx.lineWidth=2,t.ctx.strokeStyle=s.borderColor,t.ctx.fill(),t.ctx.stroke())}},interpolateValues:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],o=t.getDatasetMeta(e),a=t.scales[o.xAxisID],r=a.getValueForPixel(t.crosshair.x);if(!(o.hidden||!s.interpolate)){var i=s.data,l=i.findIndex(function(f){return f.x>=r}),d=i[l-1],c=i[l];if(t.data.datasets[e].steppedLine&&d)s.interpolatedValue=d.y;else if(d&&c){var m=(c.y-d.y)/(c.x-d.x);s.interpolatedValue=d.y+(r-d.x)*m}else s.interpolatedValue=NaN}}}};const xs=(t=1)=>"rgba(48, 166, 51, ".concat(t,")"),bs=(t=1)=>"rgba(241, 77, 66, ".concat(t,")"),Xo="text-[#30a633]",Yo="text-[#f14d42]",ff=["1d","5d","1m","6m","ytd","1y","5y","max"];function hf({histories:t,selectedInterval:e,onSelectHistoryInterval:s}){var a;const o=Object.keys((a=t==null?void 0:t.quotes)!=null?a:{});return n.jsx("div",{className:"text-token-text-tertiary inline-flex items-start justify-between rounded-[10px] bg-[#f4f4f4] p-[3px] text-xs font-semibold sm:justify-start sm:gap-1 dark:bg-[#393939]",children:o.map(r=>n.jsx("button",{onClick:()=>{s==null||s(r)},className:A("border border-transparent px-3 py-1.5 text-xs font-semibold uppercase",e===r?"border-token-border-default! bg-token-main-surface-primary text-token-text-primary shadow-xxs dark:border-token-border-medium! rounded-lg":"hover:text-token-text-secondary"),children:_r[r].label},r))})}const _r={"1d":{label:"1D",formatTimestampLabel:Ko,formatTimestampTooltip:Ko,maxTicksLimit:6,lineTension:.1},"5d":{label:"5D",formatTimestampLabel:Zo,formatTimestampTooltip:gf,maxTicksLimit:6,lineTension:.1},"1m":{label:"1M",formatTimestampLabel:Zo,formatTimestampTooltip:xf,maxTicksLimit:6,lineTension:.1,useUtc:!0},"6m":{label:"6M",formatTimestampLabel:Xs,formatTimestampTooltip:Tt,maxTicksLimit:5,lineTension:.1,useUtc:!0},ytd:{label:"YTD",formatTimestampLabel:Xs,formatTimestampTooltip:Tt,maxTicksLimit:5,lineTension:.1,useUtc:!0},"1y":{label:"1Y",formatTimestampLabel:Xs,formatTimestampTooltip:Tt,maxTicksLimit:5,lineTension:.2,useUtc:!0},"5y":{label:"5Y",formatTimestampLabel:Jo,formatTimestampTooltip:Tt,maxTicksLimit:5,lineTension:.2,useUtc:!0},max:{label:"max",formatTimestampLabel:Jo,formatTimestampTooltip:Tt,maxTicksLimit:5,lineTension:.2,useUtc:!0}};function pf(t){return t?ff.filter(s=>s in t.quotes).find(s=>t.quotes[s].length>0):void 0}function mt(t,e){return It(new Date(t*1e3),e!=null?e:"America/New_York")}function Ko(t,e,s){const o=mt(e,s);return t.formatTime(o,{hour:"numeric",minute:"numeric"})}function gf(t,e,s){const o=mt(e,s);return t.formatDate(o,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}function Tt(t,e,s){const o=mt(e,s);return t.formatDate(o,{month:"short",day:"numeric",year:"numeric"})}function Xs(t,e,s){const o=mt(e,s);return t.formatDate(o,{month:"short",year:"numeric"})}function Zo(t,e,s){const o=mt(e,s);return t.formatDate(o,{month:"short",day:"numeric"})}function xf(t,e,s){const o=mt(e,s);return t.formatDate(o,{weekday:"short",month:"short",day:"numeric"})}function Jo(t,e,s){const o=mt(e,s);return t.formatDate(o,{year:"numeric"})}Bc.register(Uc,Hc,Vc,qc,Gc,Xc,Yc,Kc,Zc,mf,Jc);const bf=100,Qo={color:"#b4b4b4",font:{size:10,weight:"600",family:"Menlo"}};function yf({isUp:t,histories:e,selectedInterval:s,setHighlightedPrice:o,latestTradingPeriod:a,timezone:r}){return n.jsx(n.Fragment,{children:e&&s&&a?n.jsx(wf,{isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:a,timezone:r,setHighlightedPrice:o}):n.jsx(Et,{className:"h-full",index:1,width:100})})}function wf({isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:o,timezone:a,setHighlightedPrice:r}){const[i,l]=g.useState(null),[d,c]=g.useState(!1),m=s==="1d",f=g.useMemo(()=>{let w=e.quotes[s].filter(N=>N.close>=0);if(m&&o){const N=o.regular.start_timestamp,k=o.regular.end_timestamp;if(w=w.filter($=>$.timestamp>=N&&$.timestamp<=k),w.length===0||w[w.length-1].timestamp<k){let S=w.length>0?w[w.length-1].timestamp:N-600;for(;S<k;)S+=600,w.push({timestamp:S,close:null})}}return w},[e,s,m,o]),h=_r[s],{formatTimestampTooltip:y,maxTicksLimit:v,useUtc:_=!1}=h,b=ie(),C=ya(),E=gn(),p=g.useMemo(()=>{const{formatTimestampLabel:w,lineTension:N}=h;return{labels:f.map(k=>w(b,k.timestamp,_?"UTC":a)),datasets:[{data:f.map(k=>k.close),borderColor:t?xs():bs(),pointRadius:0,pointHoverRadius:4,pointStyle:"circle",pointBackgroundColor:t?xs():bs(),pointHoverBorderWidth:2,pointHoverBorderColor:"rgba(255, 255, 255, 1)",backgroundColor:function(k){const{ctx:$,chartArea:S}=k.chart;if(S)return _f($,S,t)},fill:!0,borderWidth:2,lineTension:N!=null?N:.4}]}},[h,f,t,_,a,b]);return n.jsx("div",{className:"flex h-full flex-col gap-6",children:n.jsxs("div",{className:"relative h-full",onMouseEnter:()=>c(!0),onMouseLeave:()=>{c(!1),r(null)},children:[n.jsx(Qc,{options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},hover:{mode:d?"index":"point"},animation:!1,scales:{x:{afterBuildTicks:w=>{if(w.ticks.length>v)if(m)w.ticks=w.ticks.filter((N,k)=>f[k].timestamp%(C?3600:7200)===0);else{const N=Math.ceil(w.ticks.length/(v-1));w.ticks=w.ticks.filter((k,$)=>$>0&&($%N===0||$===w.ticks.length-1))}},grid:{display:!1},ticks:Y(M({},Qo),{align:"end"})},y:{ticks:Y(M({},Qo),{maxTicksLimit:7}),border:{display:!1},grid:{color:E?"rgba(255, 255, 255, 0.1)":"rgba(229, 229, 229, 0.5)"}}},plugins:{datalabels:{display:!1},legend:{display:!1},tooltip:{enabled:!1,animation:!1,displayColors:!1,callbacks:{title:function(w){var $;const N=w[0];if(!N)return"";const k=($=f[N.dataIndex])==null?void 0:$.timestamp;return k?y(b,k,_?"UTC":a):""}},external:({tooltip:w})=>{var N,k,$,S;d&&w.opacity>0&&r(Lt((S=($=(k=(N=w.dataPoints)==null?void 0:N[0])==null?void 0:k.parsed)==null?void 0:$.y)!=null?S:0)),l(I=>{var L,F,O,T,B;const W=w.chart.width,x=w.caretX>W-bf;return!I||I.x!==w.caretX||I.y!==w.caretY||I.opacity!==w.opacity||I.flip!==x?Y(M({},I),{x:w.caretX,y:w.caretY,dateLabel:(L=w.title)==null?void 0:L[0],value:Lt((B=(T=(O=(F=w.dataPoints)==null?void 0:F[0])==null?void 0:O.parsed)==null?void 0:T.y)!=null?B:0),opacity:w.opacity,flip:x}):I})}},dropShadow:!1,crosshair:{line:{color:E?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)",width:.5},zoom:{enabled:!1}}}},data:p}),n.jsx(vf,{tooltipData:i})]})})}function vf({tooltipData:t}){return!t||!t.opacity?null:n.jsx("div",{style:{left:t.x-5,top:10,transform:"translate(-50%, -50%)"},className:A("text-token-main-surface-primary dark:bg-token-main-surface-secondary pointer-events-none absolute translate-y-[-100%] rounded-lg bg-black px-2 py-1 font-mono font-semibold whitespace-nowrap dark:text-white"),children:n.jsx("div",{className:"text-xs",children:t.dateLabel})})}function _f(t,e,s){const o=t.createLinearGradient(0,e.top,0,e.bottom);return o.addColorStop(0,s?xs(.4):bs(.4)),o.addColorStop(1,s?xs(0):bs(0)),o}function Lt(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function Be({label:t,value:e,className:s}){return n.jsxs("div",{className:A("flex w-full flex-1 flex-row justify-between text-sm",s),children:[n.jsx("span",{className:"text-token-text-secondary font-normal whitespace-nowrap",children:t}),n.jsx("span",{className:"text-token-text-primary font-normal whitespace-nowrap",children:e})]})}function jf({metrics:t}){const e=ie(),s=!!(t.marketCap&&t.peRatio&&t.eps);return n.jsx("div",{className:"border-token-border-default flex flex-col gap-1 rounded-b-lg border-t bg-[#f4f4f4] px-4 py-3 dark:bg-[#393939]",children:n.jsxs("div",{className:A("grid grid-cols-2 gap-x-10 gap-y-3 lg:grid-cols-3 lg:gap-x-6"),children:[n.jsx(Be,{label:e.formatMessage({id:"MDHEj7",defaultMessage:"Open"}),value:e.formatNumber(t.openPrice,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-1"}),n.jsx(Be,{label:e.formatMessage({id:"PboNMC",defaultMessage:"Volume"}),value:e.formatNumber(t.intradayVolume,{notation:"compact",maximumFractionDigits:1}),className:A("order-2",!s&&"lg:order-last")}),n.jsxs("div",{className:"order-4 row-span-2 flex flex-col gap-3",children:[n.jsx(Be,{label:e.formatMessage({id:"bresUW",defaultMessage:"Day Low"}),value:e.formatNumber(t.intradayLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),n.jsx(Be,{label:e.formatMessage({id:"oWyv5V",defaultMessage:"Day High"}),value:e.formatNumber(t.intradayHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),n.jsxs("div",{className:"order-5 row-span-2 flex flex-col gap-3",children:[n.jsx(Be,{label:e.formatMessage({id:"DcEYIK",defaultMessage:"Year Low"}),value:e.formatNumber(t.fiftyTwoWeekLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),n.jsx(Be,{label:e.formatMessage({id:"ZfFtJ4",defaultMessage:"Year High"}),value:e.formatNumber(t.fiftyTwoWeekHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),t.marketCap&&n.jsx(Be,{label:e.formatMessage({id:"o7Vbua",defaultMessage:"Market Cap (TTM)"}),value:e.formatNumber(t.marketCap,{notation:"compact",maximumFractionDigits:2}),className:"order-last lg:order-3"}),t.peRatio&&t.eps&&n.jsxs(n.Fragment,{children:[n.jsx(Be,{label:e.formatMessage({id:"edGd+S",defaultMessage:"EPS (TTM)"}),value:e.formatNumber(t.eps,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"}),n.jsx(Be,{label:e.formatMessage({id:"uX5YWo",defaultMessage:"P/E Ratio (TTM)"}),value:e.formatNumber(t.peRatio,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"})]})]})})}function kf({data:t,priceChange:e,highlightedPrice:s,extendedPriceChange:o,url:a}){var i;function r(l,d="intraday",c=null){const{isUp:m,changePercentage:f,changeLabel:h,changeAmount:y}=l,v=Math.abs(f).toFixed(2),_=Lt(y);return n.jsxs("span",{className:"flex min-w-0 items-center gap-1",children:[d==="extended_hours"&&c!=null&&n.jsx("span",{className:"font-semibold",children:n.jsx(K,{id:"HWwWpW",defaultMessage:"{price}",values:{price:c}})}),n.jsx("span",{className:A("font-semibold",m?Xo:Yo),children:n.jsx(K,{id:"3x4Lkl",defaultMessage:"{sign}{changeAmount}",values:{changeAmount:_,sign:m?"+":""}})}),n.jsx("span",{className:A("font-semibold",m?Xo:Yo),children:n.jsx(K,{id:"MbfF1T",defaultMessage:"({sign}{changePercentage}%)",values:{changePercentage:v,sign:m?"+":"-"}})}),d==="extended_hours"?n.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h}):n.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h})]})}return n.jsxs("div",{children:[n.jsx("div",{className:"mt-2 text-sm",children:t?n.jsx(K,{id:"+2WHuv",defaultMessage:"{name} ({ticker})",values:{name:t.asset.name,ticker:t.asset.ticker}}):n.jsx("div",{className:"w-32 font-medium",children:n.jsx(Et,{index:9,width:100})})}),n.jsx("div",{className:"text-token-text-tertiary text-sm",children:t?n.jsx(n.Fragment,{children:a!=null&&n.jsxs(n.Fragment,{children:[" · ",n.jsx(ut,{href:a,className:"text-token-link hover:underline",children:$s(a,"hostname")})]})}):n.jsx("div",{className:"mt-2 w-36",children:n.jsx(Et,{index:6,width:100})})}),n.jsx("div",{className:"mt-2 flex text-4xl font-semibold",children:t?n.jsx(K,{id:"s+1uly",defaultMessage:"{price}",values:{price:s!=null?s:Lt(t.price.price)}}):n.jsx("div",{className:"w-32",children:n.jsx(Et,{index:0,width:100})})}),n.jsx("div",{className:"mt-2 flex items-center justify-start gap-1 text-sm",children:e?r(e):n.jsx("div",{className:"mt-2 w-40",children:n.jsx(Et,{index:3,width:100})})}),n.jsx("div",{className:"mt-0.5 flex items-center justify-start gap-1 text-sm",children:((i=t==null?void 0:t.price)==null?void 0:i.extended_price)!=null&&o!=null&&r(o,"extended_hours",Lt(t.price.extended_price))})]})}function Sf({contentReference:t,trackContentReferenceEvent:e}){var E,p,w,N,k,$,S,I,W,x,L,F,O,T,B;const s=ie();g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown","stock")},[e]);const o=pf((E=t==null?void 0:t.stock)==null?void 0:E.histories),a=t==null?void 0:t.stock,[r,i]=g.useState(o),[l,d]=g.useState(null),c=r==="1d",m=(N=(w=(p=a==null?void 0:a.histories)==null?void 0:p.quotes)==null?void 0:w[r!=null?r:""])==null?void 0:N[0],f=r&&r in ds?r:void 0,h=a&&(m&&!c?{changePercentage:(a.price.price-m.close)/m.close*100,changeAmount:a.price.price-m.close,changeLabel:f?s.formatMessage(ds[f]):"",isUp:a.price.price>m.close}:a.price.change_percent&&a.price.change?{changePercentage:a.price.change_percent*100,changeAmount:a.price.change,changeLabel:Nf(a.price.latest_trade_timestamp,a.asset.timezone,s),isUp:a.price.change?a.price.change>0:!1}:null),y=a&&a.price.extended_price!=null&&a.price.extended_change_percent!=null&&a.price.extended_change!=null?{changePercentage:a.price.extended_change_percent*100,changeAmount:a.price.extended_change,changeLabel:s.formatMessage((k=Cf(a.price.market_status))!=null?k:ds.extended),isUp:a.price.extended_change>0}:null,{fiftyTwoWeekHigh:v,fiftyTwoWeekLow:_}=g.useMemo(()=>{var G;const q=(G=a==null?void 0:a.histories)==null?void 0:G.quotes["1y"];if(!q)return{fiftyTwoWeekHigh:null,fiftyTwoWeekLow:null};const H=q.map(P=>P.high).filter(P=>P!=null),U=q.map(P=>P.low).filter(P=>P!=null);return{fiftyTwoWeekHigh:H.length>0?Math.max(...H):null,fiftyTwoWeekLow:U.length>0?Math.min(...U):null}},[($=a==null?void 0:a.histories)==null?void 0:$.quotes]),b=a!=null&&a.price.open_price&&a.price.intraday_high&&a.price.intraday_low&&a.price.intraday_volume&&v&&_?{openPrice:a.price.open_price,intradayHigh:a.price.intraday_high,intradayLow:a.price.intraday_low,intradayVolume:a.price.intraday_volume,fiftyTwoWeekHigh:v,fiftyTwoWeekLow:_,marketCap:(I=(S=a.metrics)==null?void 0:S.market_cap)!=null?I:void 0,peRatio:(x=(W=a.metrics)==null?void 0:W.pe_ratio)!=null?x:void 0,eps:(F=(L=a.metrics)==null?void 0:L.eps)!=null?F:void 0}:null,C=b!=null;return n.jsxs("div",{"data-testid":"finance-widget",className:A("border-token-border-default mb-2 flex min-h-[480px] flex-col gap-8 rounded-lg border"),children:[n.jsxs("div",{className:"mx-6 flex flex-wrap items-end justify-between",children:[n.jsx(kf,{data:a!=null?a:null,highlightedPrice:l,priceChange:h!=null?h:null,extendedPriceChange:y!=null?y:null,url:(O=t==null?void 0:t.url)!=null?O:null}),n.jsx("div",{className:"mt-4",children:n.jsx(hf,{selectedInterval:r,onSelectHistoryInterval:i,histories:a==null?void 0:a.histories})})]}),n.jsx("div",{className:"mx-6 h-[340px]",children:n.jsx(yf,{isUp:(T=h==null?void 0:h.isUp)!=null?T:!1,selectedInterval:r,histories:a==null?void 0:a.histories,setHighlightedPrice:d,onSelectHistoryInterval:q=>i(q),latestTradingPeriod:a==null?void 0:a.asset.latest_trading_period,timezone:(B=a==null?void 0:a.asset.timezone)!=null?B:null})}),C&&n.jsx("div",{className:"-mt-4",children:n.jsx(jf,{metrics:b})})]})}function Cf(t){if(t==null)return null;const e=t.toLowerCase();return e==="premarket"||e==="open"?Pt({id:"By+pvF",defaultMessage:"Pre-Market"}):e==="afterhours"||e==="closed"?Pt({id:"aLCg3c",defaultMessage:"After Hours"}):Pt({id:"2p526c",defaultMessage:"Extended Hours"})}function Nf(t,e,s){function o(a,r){const l=It(new Date,r),d=s.formatDate(l,{year:"numeric",month:"2-digit",day:"2-digit"}),c=ho(a*1e3),m=It(c,r),f=s.formatDate(m,{year:"numeric",month:"2-digit",day:"2-digit"});return d===f}if(!t||!e||o(t,e))return s.formatMessage(ds["1d"]);{const a=ho(t*1e3),r=It(a,e);return s.formatDate(r,{month:"long",day:"numeric"})}}const ds=dn({"1d":{id:"SMdcuo",defaultMessage:"Today"},extended:{id:"2p526c",defaultMessage:"Extended Hours"},"5d":{id:"HCA6lr",defaultMessage:"Past 5 days"},"1m":{id:"DJpPMq",defaultMessage:"Past month"},"6m":{id:"1mUJ2L",defaultMessage:"Past 6 months"},ytd:{id:"b9KkhV",defaultMessage:"Year to date"},"1y":{id:"XnvD9A",defaultMessage:"Past year"},"5y":{id:"DfI1RB",defaultMessage:"Past 5 years"},max:{id:"WzOhuU",defaultMessage:"Max"}});function $f({metadata:t,trackContentReferenceEvent:e}){const s=g.useCallback(l=>{e("link_action",null,t.type,{url:t.url,title:t.title,pub_date:null,sub_pill_index:null,link_type:"link_title",action:l})},[t.title,t.type,t.url,e]);g.useEffect(()=>{s("show")},[s]);const[o,a]=g.useState(!1),r=()=>{o||(s("hover"),a(!0))},i=()=>{s("click")};return n.jsx(ut,{href:t.url,onClick:i,onMouseEnter:r,onFocus:r,className:"underline",children:t.title})}const Tf={google_maps:{title:"Google Maps"}};function Ef({metadata:t,trackContentReferenceEvent:e}){var o,a;g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=(a=(o=Tf[t.provider])==null?void 0:o.title)!=null?a:"Maps";return n.jsx("span",{children:n.jsx(K,{id:"ZSUz1k",defaultMessage:" ({link}) ",values:{link:n.jsx(ut,{href:t.url,children:s})}})})}function Mf(t){"use forget";const e=ue.c(25),{metadata:s,trackContentReferenceEvent:o,isFirstAssistantContent:a}=t,r=ye();let i;e[0]!==r?(i=Cs(r),e[0]=r,e[1]=i):i=e[1];const l=i,d=s.items.length>0,c=g.useRef(o);let m,f;e[2]!==o?(m=()=>{c.current=o},f=[o],e[2]=o,e[3]=m,e[4]=f):(m=e[3],f=e[4]),g.useEffect(m,f);let h,y;e[5]!==d?(h=()=>{d&&c.current("Search Content Reference Shown","search_content_reference_shown","nav_list")},y=[d],e[5]=d,e[6]=h,e[7]=y):(h=e[6],y=e[7]),g.useEffect(h,y);let v;e[8]!==o?(v=(I,W)=>{o("link_action",null,"nav_list",Y(M({},ea(I,W)),{action:"click"}))},e[8]=o,e[9]=v):v=e[9];const _=v;let b;e[10]!==o?(b=(I,W)=>{o("link_action",null,"nav_list",Y(M({},ea(I,W)),{action:"show"}))},e[10]=o,e[11]=b):b=e[11];const C=b,E=l&&a,p=s.title&&!E;if(s.items.length===0)return null;const w=!E&&"mt-6";let N;e[12]!==w?(N=A("mb-1",w),e[12]=w,e[13]=N):N=e[13];let k;e[14]!==s.title||e[15]!==p?(k=p&&n.jsx("div",{className:"text-token-text-primary -mb-1 pb-3 font-semibold",children:s.title}),e[14]=s.title,e[15]=p,e[16]=k):k=e[16];let $;e[17]!==_||e[18]!==C||e[19]!==s.items?($=n.jsx(br,{items:s.items,onCardRender:Pf,onCardShown:C,onCardClicked:_,showGradient:!1,cardClassName:"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden"}),e[17]=_,e[18]=C,e[19]=s.items,e[20]=$):$=e[20];let S;return e[21]!==k||e[22]!==$||e[23]!==N?(S=n.jsxs("div",{className:N,"data-testid":"nav-list-widget",children:[k,$]}),e[21]=k,e[22]=$,e[23]=N,e[24]=S):S=e[24],S}function Pf(t){return n.jsx(If,{item:t})}function If({item:t}){var i,l;const{isSuccess:e}=tn((i=t.thumbnail_url)!=null?i:void 0,"NavListItem"),s=ie(),o=ye(),a=Cs(o),r=Li(s,t.pub_date);return n.jsxs(ut,{className:"flex flex-col items-center gap-4 overflow-hidden pb-6",href:t.url,children:[e&&t.thumbnail_url?n.jsx("div",{className:"relative h-36 w-full overflow-hidden",children:n.jsx("img",{src:t.thumbnail_url,className:"m-0 h-full w-full",style:{objectFit:"cover"},alt:t.title})}):n.jsxs("div",{className:A("icon-bg relative flex h-36 w-full shrink-0 items-center justify-center overflow-hidden",a&&"bg-token-bg-secondary"),children:[n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-cover bg-center bg-no-repeat blur-3xl",children:n.jsx(is,{url:t.url,size:256,minSize:128,className:"mix-soft-light opacity-30 dark:opacity-20"})}),n.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:n.jsx(is,{url:t.url,size:128,minSize:80,className:"icon-xl rounded-full"})})]}),n.jsxs("div",{className:A("flex flex-col gap-2 overflow-hidden px-4 text-ellipsis",a&&"w-full items-start"),children:[n.jsxs("div",{className:"text-token-text-primary flex items-center gap-1.5 text-xs",children:[n.jsx(is,{url:t.url,size:32,minSize:16,className:"icon-xs my-0 rounded-full"}),(l=t.attribution)!=null?l:$s(t.url)]}),n.jsx("div",{className:"text-token-text-primary decoration-token-link line-clamp-5 text-sm font-medium",children:t.title}),r&&n.jsx("div",{className:"text-token-text-secondary text-xs",children:r})]})]})}const ea=(t,e)=>({url:t.url,title:t.title,section_index:e,link_type:"text",section:"nav_list",section_location:"response"}),Af="{{.assetPrefix}}/assets/missing-logo-h96s4tk9.webp",ta={src:Af};function jr({team:t,className:e}){var r;const[s,o]=g.useState((r=t.logo)!=null?r:ta.src),a=()=>{Ss.addError("Unable to load sports widget logo",{name:t.name,logo:t.logo}),o(ta.src)};return n.jsx("img",{src:s,alt:t.name,className:e,onError:a})}const Wt=["ipl"],sa=6,rt="home",it="away";function Rf({scheduleRef:t,trackContentReferenceEvent:e}){var v,_,b,C;const[s,o]=g.useState(!0),a=ie(),r=t.games.length>0,i=t.league.id,l=Di(),d=Bt();if(g.useEffect(()=>{r&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasSchedule:!0})},[r]),!r)return null;const m=((_=(v=a.formatDateToParts(new Date,{timeZoneName:"long"}).find(E=>E.type==="timeZoneName"))==null?void 0:v.value)!=null?_:Intl.DateTimeFormat().resolvedOptions().timeZone).replace(/Daylight|Standard/g,"");let f=t.games;const h=E=>Math.abs(new Date().getTime()-new Date(E.date).getTime());h(f[0])>h(f[f.length-1])&&(f=f.slice().reverse());const y=s?f.slice(0,sa):f;return n.jsxs("div",{className:"not-prose mb-3","data-testid":"sports-schedule-widget",children:[n.jsx("div",{className:"font-semibold",children:n.jsx(K,{id:"LA6z9q",defaultMessage:"{league} Schedule",values:{league:t.league.display_name}})}),n.jsx("div",{className:"text-token-text-secondary text-sm",children:m}),y.length===1?n.jsx("div",{children:n.jsx(ro,{children:n.jsx(us.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},exit:{opacity:0,y:-15},transition:{duration:.2},children:n.jsx("div",{className:"border-token-border-medium mt-3 rounded-xl border py-3",children:n.jsx(Df,{game:y[0],useAlias:Wt.includes(i),leagueId:i,activeTeam:(C=(b=y[0])==null?void 0:b.active_team)!=null?C:null,isMobile:d})})})})}):n.jsx("div",{className:"grid grid-cols-1 pt-3 lg:grid-cols-2",children:n.jsx(ro,{children:y.map((E,p)=>{var w;return n.jsx(us.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0,transition:{delay:p*.04}},exit:{opacity:0,y:-15},transition:{duration:.2},children:n.jsx("div",{className:A("border-token-border-medium border-b py-3",p%2===0&&"lg:border-e lg:pe-4",p%2===1&&"lg:ps-4",Math.floor(p/2)===Math.ceil(f.length/2)-1&&"lg:border-b-0",p===f.length-1&&"border-b-0"),children:n.jsx(Lf,{game:E,useAlias:(l||d)&&Wt.includes(i),leagueId:i,activeTeam:(w=E.active_team)!=null?w:null})})},p)})})}),f.length>sa&&n.jsx("div",{className:"mt-2 flex items-center justify-between",children:n.jsx("button",{className:"flex items-center text-sm font-semibold",onClick:()=>o(!s),children:s?n.jsx(K,{id:"BH/Ee5",defaultMessage:"Show more {icon}",values:{icon:n.jsx(Rl,{className:"mb-[-2px]"})}}):n.jsx(K,{id:"Z9BlEu",defaultMessage:"Show less {icon}",values:{icon:n.jsx(Ll,{className:"mb-[-2px]"})}})})})]})}function Lf({game:t,useAlias:e=!1,leagueId:s,activeTeam:o}){var m,f;const a=Sr(t),r=[t.first_team_info,t.second_team_info],i=(m=r.find(h=>h.location===rt))!=null?m:t.first_team_info,l=(f=r.find(h=>h.location===it))!=null?f:t.second_team_info,d=(a==null?void 0:a.team.name)===(i==null?void 0:i.team.name),c=(a==null?void 0:a.team.name)===(l==null?void 0:l.team.name);return n.jsxs("div",{className:"flex w-full gap-1.5 py-3 text-base",children:[n.jsxs("div",{className:"flex flex-auto flex-col items-start gap-1 pe-3",children:[n.jsx(ws,{team:l.team,isWinner:c,isActive:o===it,logoSize:"small",useAlias:e}),n.jsx(ws,{team:i.team,isWinner:d,isActive:o===rt,logoSize:"small",useAlias:e})]}),n.jsxs("div",{className:A("flex flex-none flex-col items-start gap-1",Wt.includes(s)&&"me-4"),children:[n.jsx(vs,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"right"}:null,isWinner:c,negateScore:ys(s,it,o)}),n.jsx(vs,{score:i.score,scoreSuffix:i.score_suffix,scoreParenthetical:i.score_parenthetical?{message:i.score_parenthetical,position:"right"}:null,isWinner:d,negateScore:ys(s,rt,o)})]}),n.jsx("div",{className:"flex min-w-24 flex-none flex-col items-end justify-center gap-1 text-sm",children:n.jsx(Cr,{game:t})})]})}function Df({game:t,useAlias:e=!1,leagueId:s,activeTeam:o,isMobile:a}){var f,h;const r=Sr(t),i=[t.first_team_info,t.second_team_info],l=(f=i.find(y=>y.location===rt))!=null?f:t.first_team_info,d=(h=i.find(y=>y.location===it))!=null?h:t.second_team_info,c=(r==null?void 0:r.team.name)===(l==null?void 0:l.team.name),m=(r==null?void 0:r.team.name)===(d==null?void 0:d.team.name);return n.jsxs("div",{className:"flex w-full py-3 text-base",children:[n.jsx("div",{className:"flex flex-1 items-center justify-center px-2",children:n.jsx(ws,{team:d.team,isWinner:m,isActive:o===it,useAlias:e,layoutDirection:a?"column":"row"})}),n.jsx("div",{className:"ms-2 flex items-center justify-start sm:ms-8",children:n.jsx(vs,{score:d.score,scoreSuffix:d.score_suffix,scoreParenthetical:d.score_parenthetical?{message:d.score_parenthetical,position:"bottom"}:null,isWinner:m,negateScore:ys(s,it,o),className:"text-sm font-semibold sm:text-lg"})}),n.jsx("div",{className:"mx-2 flex w-24 shrink flex-col items-center justify-center gap-1 align-middle text-sm",children:n.jsx(Cr,{game:t})}),n.jsx("div",{className:"me-2 flex items-center justify-end sm:me-8",children:n.jsx(vs,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"bottom"}:null,isWinner:c,negateScore:ys(s,rt,o),className:"text-sm font-semibold sm:text-lg"})}),n.jsx("div",{className:"flex flex-1 items-center justify-center md:px-2",children:n.jsx(ws,{team:l.team,isWinner:c,isActive:o===rt,useAlias:e,layoutDirection:a?"column":"row"})})]})}function kr(t){return t.live?"live":new Date(t.date)<new Date?"complete":"scheduled"}function Sr(t){return kr(t)!=="complete"||t.first_team_info.score==null||t.second_team_info.score==null?null:t.first_team_info.score>t.second_team_info.score?t.first_team_info:t.second_team_info}function ys(t,e,s){return Wt.includes(t)&&e===rt&&s===it}function ws({team:t,isWinner:e,isActive:s,logoSize:o,useAlias:a=!1,layoutDirection:r="row"}){return n.jsxs("span",{className:A("flex items-center gap-1",e&&"font-semibold","max-w-64 lg:max-w-52 xl:max-w-64",r==="column"&&"flex-col"),children:[t.logo&&n.jsx(jr,{team:{name:t.name,logo:t.logo},className:A(o==="small"?"w-6":"w-8")}),n.jsx("span",{className:"truncate",children:a?t.alias:t.name}),s&&n.jsx("span",{className:"bg-token-surface-error inline-block h-2 w-2 rounded-full"})]})}function vs({score:t,scoreSuffix:e,scoreParenthetical:s,isWinner:o,negateScore:a=!1,className:r}){const i=ie();return t==null?null:n.jsxs("span",{className:A(o&&"font-semibold",r),children:[a?i.formatMessage({id:"sports.dash",defaultMessage:"-"}):t,e&&!a&&n.jsx("span",{children:e}),s&&!a&&n.jsx("span",{className:A("text-token-text-secondary font-normal",s.position==="right"&&"ms-1",s.position==="bottom"&&"mx-auto block text-center"),children:"(".concat(s.message,")")})]})}function Cr({game:t}){const e=ie();switch(kr(t)){case"live":return n.jsxs(n.Fragment,{children:[n.jsx(Ff,{}),n.jsx("div",{children:t.details})]});case"complete":return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-semibold",children:n.jsx(K,{id:"q/iMZL",defaultMessage:"Final"})}),n.jsx("div",{className:"text-token-text-secondary",children:nn(e,new Date(t.date))})]});case"scheduled":{const s=new Date(t.date);return isNaN(s.getTime())?null:n.jsxs(n.Fragment,{children:[n.jsx("div",{children:nn(e,s)}),n.jsx("div",{className:"text-token-text-secondary",children:e.formatDate(s,{timeStyle:"short"})})]})}}}function Ff(){return n.jsx("div",{className:"bg-token-surface-error rounded-[4px] px-1.5 py-1 text-xs font-semibold text-white",children:n.jsx(K,{id:"vObALn",defaultMessage:"Live"})})}function Of({standingsRef:t,trackContentReferenceEvent:e}){const[s,o]=g.useState(0),a=t.conferences.length>0,r=Bt(),i=t.league.id;g.useEffect(()=>{a&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasStandings:!0})},[a]);const l=t.conferences[s],d=t.conferences.length>1?t.conferences.map((c,m)=>n.jsx("button",{className:A(s===m?"text-token-text-primary":"text-token-text-tertiary","text-sm font-semibold"),onClick:()=>o(m),children:c.name},c.name)):null;return n.jsxs("div",{"data-testid":"sports-standings-widget",children:[d&&n.jsx("div",{className:"flex gap-4",children:d}),n.jsx("div",{className:"mt-3",children:l.divisions.map(c=>c.name?n.jsx("div",{className:"mt-3",children:n.jsx(na,{division:c,teamsColumnHeader:c.name})},c.name):n.jsx(na,{division:c,useAlias:r&&Wt.includes(i)}))})]})}function na({division:t,teamsColumnHeader:e,useAlias:s}){const o=t.headers.map(a=>a.key);return n.jsxs(je.Root,{size:"compact",className:"not-prose",children:[n.jsxs(je.Header,{children:[n.jsx(Wf,{children:e!=null?e:n.jsx(K,{id:"kKSGje",defaultMessage:"Team"})}),t.headers.map(a=>n.jsx(Nr,{textAlign:"center",className:"min-w-11 px-0!",children:n.jsx(oa,{data:a})},a.key))]}),n.jsx(je.Body,{children:t.teams.map(({team:a,data:r},i)=>{const l=r.reduce((d,c)=>(d[c.key]=c,d),{});return n.jsxs(je.Row,{children:[n.jsx(je.Cell,{className:"w-full border-0! py-0! ps-0!",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"text-token-text-tertiary me-2 w-4 whitespace-nowrap tabular-nums",children:i+1}),n.jsxs("div",{className:"flex items-center justify-start gap-2",children:[n.jsx(jr,{team:a,className:"w-6"}),n.jsx("span",{className:"text-base whitespace-nowrap",children:s?a.alias:a.name})]})]})}),o.map(d=>n.jsx(je.Cell,{className:"min-w-11 border-0! px-0! py-0! text-start whitespace-nowrap tabular-nums",textAlign:"center",children:n.jsx(oa,{data:l[d]})},d))]},a.name)})})]})}function oa({data:t}){switch(t.type){case"text":return n.jsx(n.Fragment,{children:t.text});default:return n.jsx(n.Fragment,{children:t.alt})}}var ca;const Nr=wa(je.HeaderCell)(ca||(ca=Yt(["text-token-text-secondary font-normal! text-sm static! bg-transparent! border-token-border-default! border-t-0! border-s-0! border-e-0!"])));var da;const Wf=wa(Nr)(da||(da=Yt(["text-token-text-primary ps-0!"])));function zf({metadata:t,trackContentReferenceEvent:e}){g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=ie(),o=It(t.utc_time,t.utc_offset),a=s.formatDate(o,{hour:"numeric",minute:"numeric"});return n.jsx("span",{children:a})}function Bf({metadata:t,trackContentReferenceEvent:e}){return g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]),n.jsx("div",{children:t.url?n.jsx(Dc,{webpageItem:{url:t.url,title:t.description,pub_date:null,snippet:"",attributions:null},className:"inline-flex flex-col",children:n.jsx(ut,{href:t.url,className:"font-semibold!",children:t.description})}):n.jsx("div",{className:"font-semibold!",children:t.description})})}function Uf({videoId:t,title:e="YouTube video player",fallbackText:s,cookieLess:o=!0,timeoutMs:a=5e3,className:r=""}){const i=g.useRef(null),l=g.useRef(null),d=g.useRef(!1),[c,m]=g.useState("idle"),f=()=>{d.current=!0,l.current&&(clearTimeout(l.current),l.current=null)};if(g.useEffect(()=>{m("loading"),d.current=!1;let y=null;return Hf().then(()=>{if(!i.current)return;i.current.textContent="",y=document.createElement("div"),y.style.width="200px",y.style.height="150px",i.current.appendChild(y),l.current=window.setTimeout(()=>{d.current||m("timeout")},a);const v=o?"https://www.youtube-nocookie.com":"https://www.youtube.com";new window.YT.Player(y,{width:200,height:150,videoId:t,host:v,playerVars:{rel:0,playsinline:1,origin:window.location.origin},events:{onReady:()=>{f(),m("ready")},onError:()=>{f(),m("error")}}})}).catch(()=>m("error")),()=>{f()}},[t,o,a]),c==="error"||c==="timeout")return n.jsx("a",{href:"https://www.youtube.com/watch?v=".concat(t),target:"_blank",rel:"noopener noreferrer",children:s});const h=o?"https://www.youtube-nocookie.com":"https://www.youtube.com";return n.jsxs(n.Fragment,{children:[n.jsx("div",{ref:i,"aria-hidden":!0,inert:!0,className:"hidden"}),n.jsx("iframe",{src:"".concat(h,"/embed/").concat(t),allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:r,title:e})]})}function Hf(){return new Promise(t=>{var s;if((s=window.YT)!=null&&s.Player)return t();const e=window.onYouTubeIframeAPIReady;if(window.onYouTubeIframeAPIReady=()=>{e==null||e(),t(),window.onYouTubeIframeAPIReady=e||(()=>{})},!document.querySelector("script[src*='youtube.com/iframe_api']")){const o=document.createElement("script");o.src="https://www.youtube.com/iframe_api",document.head.appendChild(o)}})}function Vf({url:t,className:e,iframeClassName:s,iframeTitle:o}){let a;const r=A("aspect-video w-full",s),i=qf(t);i&&(a=n.jsx(Uf,{className:r,videoId:i,title:o,fallbackText:o!=null?o:n.jsx(K,{id:"sonic.video.youtube.title",defaultMessage:"YouTube video link"}),cookieLess:!1}));const l=Gf(t);return l&&(a=n.jsx(Xf,{videoId:l,className:r,iframeTitle:o})),a?n.jsx("div",{className:e,children:a}):null}function qf(t){const e=/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|shorts\/|embed\/|v\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,s=t.match(e);return s?s[1]:null}function Gf(t){const e=/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/[^/]+\/videos\/|video\/|)(\d+)/,s=t.match(e);return s?s[1]:null}function Xf({videoId:t,className:e,iframeTitle:s}){return n.jsx(n.Fragment,{children:n.jsx("iframe",{className:e,src:"https://player.vimeo.com/video/".concat(t),frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:s})})}function Yf({video:t,trackContentReferenceEvent:e}){const s={url:t.url,title:t.title};return g.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,s)},[]),t.url==null||t.url===""?null:n.jsx("div",{className:"not-prose mb-3 flex flex-col gap-4 text-base","data-testid":"video-widget",children:n.jsx(Vf,{url:t.url,iframeClassName:"rounded-lg"})})}const Kf="webp",Zf=96,Jf=96,Qf="srgb",eh=4,th="uchar",sh=288,nh=!1,oh=!1,ah=!0,rh="{{.assetPrefix}}/assets/cloud-foggy-o4a3hmky.webp",ih={format:Kf,width:Zf,height:Jf,space:Qf,channels:eh,depth:th,density:sh,isProgressive:nh,hasProfile:oh,hasAlpha:ah,src:rh},lh="webp",ch=96,dh=96,uh="srgb",mh=4,fh="uchar",hh=288,ph=!1,gh=!1,xh=!0,bh="{{.assetPrefix}}/assets/cloudy-co8vwrk7.webp",yh={format:lh,width:ch,height:dh,space:uh,channels:mh,depth:fh,density:hh,isProgressive:ph,hasProfile:gh,hasAlpha:xh,src:bh},wh="webp",vh=96,_h=96,jh="srgb",kh=4,Sh="uchar",Ch=288,Nh=!1,$h=!1,Th=!0,Eh="{{.assetPrefix}}/assets/heavy-snow-mke52kag.webp",Mh={format:wh,width:vh,height:_h,space:jh,channels:kh,depth:Sh,density:Ch,isProgressive:Nh,hasProfile:$h,hasAlpha:Th,src:Eh},Ph="webp",Ih=96,Ah=96,Rh="srgb",Lh=4,Dh="uchar",Fh=288,Oh=!1,Wh=!1,zh=!0,Bh="{{.assetPrefix}}/assets/light-snow-mcy1l7t9.webp",Uh={format:Ph,width:Ih,height:Ah,space:Rh,channels:Lh,depth:Dh,density:Fh,isProgressive:Oh,hasProfile:Wh,hasAlpha:zh,src:Bh},Hh="webp",Vh=96,qh=96,Gh="srgb",Xh=4,Yh="uchar",Kh=288,Zh=!1,Jh=!1,Qh=!0,ep="{{.assetPrefix}}/assets/moon-drizzle-cplxr2ub.webp",tp={format:Hh,width:Vh,height:qh,space:Gh,channels:Xh,depth:Yh,density:Kh,isProgressive:Zh,hasProfile:Jh,hasAlpha:Qh,src:ep},sp="webp",np=96,op=96,ap="srgb",rp=4,ip="uchar",lp=288,cp=!1,dp=!1,up=!0,mp="{{.assetPrefix}}/assets/moon-hazy-jvgt25bp.webp",fp={format:sp,width:np,height:op,space:ap,channels:rp,depth:ip,density:lp,isProgressive:cp,hasProfile:dp,hasAlpha:up,src:mp},hp="webp",pp=96,gp=96,xp="srgb",bp=4,yp="uchar",wp=288,vp=!1,_p=!1,jp=!0,kp="{{.assetPrefix}}/assets/moon-mostly-cloudy-cia3do0v.webp",Sp={format:hp,width:pp,height:gp,space:xp,channels:bp,depth:yp,density:wp,isProgressive:vp,hasProfile:_p,hasAlpha:jp,src:kp},Cp="webp",Np=96,$p=96,Tp="srgb",Ep=4,Mp="uchar",Pp=288,Ip=!1,Ap=!1,Rp=!0,Lp="{{.assetPrefix}}/assets/moon-mostly-sunny-n3mh1b6a.webp",Dp={format:Cp,width:Np,height:$p,space:Tp,channels:Ep,depth:Mp,density:Pp,isProgressive:Ip,hasProfile:Ap,hasAlpha:Rp,src:Lp},Fp="webp",Op=96,Wp=96,zp="srgb",Bp=4,Up="uchar",Hp=288,Vp=!1,qp=!1,Gp=!0,Xp="{{.assetPrefix}}/assets/moon-shower-ntzhti9o.webp",Yp={format:Fp,width:Op,height:Wp,space:zp,channels:Bp,depth:Up,density:Hp,isProgressive:Vp,hasProfile:qp,hasAlpha:Gp,src:Xp},Kp="webp",Zp=96,Jp=96,Qp="srgb",eg=4,tg="uchar",sg=288,ng=!1,og=!1,ag=!0,rg="{{.assetPrefix}}/assets/moon-sunny-eg2emh4d.webp",ig={format:Kp,width:Zp,height:Jp,space:Qp,channels:eg,depth:tg,density:sg,isProgressive:ng,hasProfile:og,hasAlpha:ag,src:rg},lg="webp",cg=96,dg=96,ug="srgb",mg=4,fg="uchar",hg=288,pg=!1,gg=!1,xg=!0,bg="{{.assetPrefix}}/assets/rain-thunder-bx7a0l5g.webp",yg={format:lg,width:cg,height:dg,space:ug,channels:mg,depth:fg,density:hg,isProgressive:pg,hasProfile:gg,hasAlpha:xg,src:bg},wg="webp",vg=96,_g=96,jg="srgb",kg=4,Sg="uchar",Cg=288,Ng=!1,$g=!1,Tg=!0,Eg="{{.assetPrefix}}/assets/rain-cxs76xuj.webp",Mg={format:wg,width:vg,height:_g,space:jg,channels:kg,depth:Sg,density:Cg,isProgressive:Ng,hasProfile:$g,hasAlpha:Tg,src:Eg},Pg="webp",Ig=96,Ag=96,Rg="srgb",Lg=4,Dg="uchar",Fg=288,Og=!1,Wg=!1,zg=!0,Bg="{{.assetPrefix}}/assets/sleet-gc63vwmo.webp",Ug={format:Pg,width:Ig,height:Ag,space:Rg,channels:Lg,depth:Dg,density:Fg,isProgressive:Og,hasProfile:Wg,hasAlpha:zg,src:Bg},Hg="webp",Vg=96,qg=96,Gg="srgb",Xg=4,Yg="uchar",Kg=288,Zg=!1,Jg=!1,Qg=!0,ex="{{.assetPrefix}}/assets/snow-d0k6tmmc.webp",tx={format:Hg,width:Vg,height:qg,space:Gg,channels:Xg,depth:Yg,density:Kg,isProgressive:Zg,hasProfile:Jg,hasAlpha:Qg,src:ex},sx="webp",nx=96,ox=96,ax="srgb",rx=4,ix="uchar",lx=288,cx=!1,dx=!1,ux=!0,mx="{{.assetPrefix}}/assets/sun-drizzle-g94obr5e.webp",fx={format:sx,width:nx,height:ox,space:ax,channels:rx,depth:ix,density:lx,isProgressive:cx,hasProfile:dx,hasAlpha:ux,src:mx},hx="webp",px=96,gx=96,xx="srgb",bx=4,yx="uchar",wx=288,vx=!1,_x=!1,jx=!0,kx="{{.assetPrefix}}/assets/sun-hazy-c3z1j0hy.webp",Sx={format:hx,width:px,height:gx,space:xx,channels:bx,depth:yx,density:wx,isProgressive:vx,hasProfile:_x,hasAlpha:jx,src:kx},Cx="webp",Nx=96,$x=96,Tx="srgb",Ex=4,Mx="uchar",Px=288,Ix=!1,Ax=!1,Rx=!0,Lx="{{.assetPrefix}}/assets/sun-mostly-cloudy-d4o4zkga.webp",Dx={format:Cx,width:Nx,height:$x,space:Tx,channels:Ex,depth:Mx,density:Px,isProgressive:Ix,hasProfile:Ax,hasAlpha:Rx,src:Lx},Fx="webp",Ox=96,Wx=96,zx="srgb",Bx=4,Ux="uchar",Hx=288,Vx=!1,qx=!1,Gx=!0,Xx="{{.assetPrefix}}/assets/sun-mostly-sunny-livrdkgu.webp",Yx={format:Fx,width:Ox,height:Wx,space:zx,channels:Bx,depth:Ux,density:Hx,isProgressive:Vx,hasProfile:qx,hasAlpha:Gx,src:Xx},Kx="webp",Zx=96,Jx=96,Qx="srgb",eb=4,tb="uchar",sb=288,nb=!1,ob=!1,ab=!0,rb="{{.assetPrefix}}/assets/sun-shower-lvtjthah.webp",ib={format:Kx,width:Zx,height:Jx,space:Qx,channels:eb,depth:tb,density:sb,isProgressive:nb,hasProfile:ob,hasAlpha:ab,src:rb},lb="webp",cb=96,db=96,ub="srgb",mb=4,fb="uchar",hb=288,pb=!1,gb=!1,xb=!0,bb="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",yb={format:lb,width:cb,height:db,space:ub,channels:mb,depth:fb,density:hb,isProgressive:pb,hasProfile:gb,hasAlpha:xb,src:bb},wb="webp",vb=96,_b=96,jb="srgb",kb=4,Sb="uchar",Cb=288,Nb=!1,$b=!1,Tb=!0,Eb="{{.assetPrefix}}/assets/thunder-jgjqg9ai.webp",Mb={format:wb,width:vb,height:_b,space:jb,channels:kb,depth:Sb,density:Cb,isProgressive:Nb,hasProfile:$b,hasAlpha:Tb,src:Eb},Pb="webp",Ib=96,Ab=96,Rb="srgb",Lb=4,Db="uchar",Fb=288,Ob=!1,Wb=!1,zb=!0,Bb="{{.assetPrefix}}/assets/tornado-opa24tq3.webp",Ub={format:Pb,width:Ib,height:Ab,space:Rb,channels:Lb,depth:Db,density:Fb,isProgressive:Ob,hasProfile:Wb,hasAlpha:zb,src:Bb},Hb="webp",Vb=96,qb=96,Gb="srgb",Xb=4,Yb="uchar",Kb=288,Zb=!1,Jb=!1,Qb=!0,ey="{{.assetPrefix}}/assets/windy-mw0a3u21.webp",ty={format:Hb,width:Vb,height:qb,space:Gb,channels:Xb,depth:Yb,density:Kb,isProgressive:Zb,hasProfile:Jb,hasAlpha:Qb,src:ey},sy="webp",ny=96,oy=96,ay="srgb",ry=4,iy="uchar",ly=288,cy=!1,dy=!1,uy=!0,my="{{.assetPrefix}}/assets/cloud-foggy-fhg0jn0w.webp",fy={format:sy,width:ny,height:oy,space:ay,channels:ry,depth:iy,density:ly,isProgressive:cy,hasProfile:dy,hasAlpha:uy,src:my},hy="webp",py=96,gy=96,xy="srgb",by=4,yy="uchar",wy=288,vy=!1,_y=!1,jy=!0,ky="{{.assetPrefix}}/assets/cloudy-disd26f3.webp",Sy={format:hy,width:py,height:gy,space:xy,channels:by,depth:yy,density:wy,isProgressive:vy,hasProfile:_y,hasAlpha:jy,src:ky},Cy="webp",Ny=96,$y=96,Ty="srgb",Ey=4,My="uchar",Py=288,Iy=!1,Ay=!1,Ry=!0,Ly="{{.assetPrefix}}/assets/heavy-snow-g6jjwo2d.webp",Dy={format:Cy,width:Ny,height:$y,space:Ty,channels:Ey,depth:My,density:Py,isProgressive:Iy,hasProfile:Ay,hasAlpha:Ry,src:Ly},Fy="webp",Oy=96,Wy=96,zy="srgb",By=4,Uy="uchar",Hy=288,Vy=!1,qy=!1,Gy=!0,Xy="{{.assetPrefix}}/assets/light-snow-iz0efpkh.webp",Yy={format:Fy,width:Oy,height:Wy,space:zy,channels:By,depth:Uy,density:Hy,isProgressive:Vy,hasProfile:qy,hasAlpha:Gy,src:Xy},Ky="webp",Zy=96,Jy=96,Qy="srgb",ew=4,tw="uchar",sw=288,nw=!1,ow=!1,aw=!0,rw="{{.assetPrefix}}/assets/moon-drizzle-b1nfv39c.webp",iw={format:Ky,width:Zy,height:Jy,space:Qy,channels:ew,depth:tw,density:sw,isProgressive:nw,hasProfile:ow,hasAlpha:aw,src:rw},lw="webp",cw=96,dw=96,uw="srgb",mw=4,fw="uchar",hw=288,pw=!1,gw=!1,xw=!0,bw="{{.assetPrefix}}/assets/moon-hazy-nfnzea7a.webp",yw={format:lw,width:cw,height:dw,space:uw,channels:mw,depth:fw,density:hw,isProgressive:pw,hasProfile:gw,hasAlpha:xw,src:bw},ww="webp",vw=96,_w=96,jw="srgb",kw=4,Sw="uchar",Cw=288,Nw=!1,$w=!1,Tw=!0,Ew="{{.assetPrefix}}/assets/moon-mostly-cloudy-e56e3z55.webp",Mw={format:ww,width:vw,height:_w,space:jw,channels:kw,depth:Sw,density:Cw,isProgressive:Nw,hasProfile:$w,hasAlpha:Tw,src:Ew},Pw="webp",Iw=96,Aw=96,Rw="srgb",Lw=4,Dw="uchar",Fw=288,Ow=!1,Ww=!1,zw=!0,Bw="{{.assetPrefix}}/assets/moon-mostly-sunny-ffu4gzf4.webp",Uw={format:Pw,width:Iw,height:Aw,space:Rw,channels:Lw,depth:Dw,density:Fw,isProgressive:Ow,hasProfile:Ww,hasAlpha:zw,src:Bw},Hw="webp",Vw=96,qw=96,Gw="srgb",Xw=4,Yw="uchar",Kw=288,Zw=!1,Jw=!1,Qw=!0,e1="{{.assetPrefix}}/assets/moon-shower-e5dy9u48.webp",t1={format:Hw,width:Vw,height:qw,space:Gw,channels:Xw,depth:Yw,density:Kw,isProgressive:Zw,hasProfile:Jw,hasAlpha:Qw,src:e1},s1="webp",n1=96,o1=96,a1="srgb",r1=4,i1="uchar",l1=288,c1=!1,d1=!1,u1=!0,m1="{{.assetPrefix}}/assets/moon-sunny-d9o08xiw.webp",f1={format:s1,width:n1,height:o1,space:a1,channels:r1,depth:i1,density:l1,isProgressive:c1,hasProfile:d1,hasAlpha:u1,src:m1},h1="webp",p1=96,g1=96,x1="srgb",b1=4,y1="uchar",w1=288,v1=!1,_1=!1,j1=!0,k1="{{.assetPrefix}}/assets/rain-thunder-eplemvu1.webp",S1={format:h1,width:p1,height:g1,space:x1,channels:b1,depth:y1,density:w1,isProgressive:v1,hasProfile:_1,hasAlpha:j1,src:k1},C1="webp",N1=96,$1=96,T1="srgb",E1=4,M1="uchar",P1=288,I1=!1,A1=!1,R1=!0,L1="{{.assetPrefix}}/assets/rain-ogayr6kt.webp",D1={format:C1,width:N1,height:$1,space:T1,channels:E1,depth:M1,density:P1,isProgressive:I1,hasProfile:A1,hasAlpha:R1,src:L1},F1="webp",O1=96,W1=96,z1="srgb",B1=4,U1="uchar",H1=288,V1=!1,q1=!1,G1=!0,X1="{{.assetPrefix}}/assets/sleet-o8noil7l.webp",Y1={format:F1,width:O1,height:W1,space:z1,channels:B1,depth:U1,density:H1,isProgressive:V1,hasProfile:q1,hasAlpha:G1,src:X1},K1="webp",Z1=96,J1=96,Q1="srgb",ev=4,tv="uchar",sv=288,nv=!1,ov=!1,av=!0,rv="{{.assetPrefix}}/assets/snow-lq4cl3uc.webp",iv={format:K1,width:Z1,height:J1,space:Q1,channels:ev,depth:tv,density:sv,isProgressive:nv,hasProfile:ov,hasAlpha:av,src:rv},lv="webp",cv=96,dv=96,uv="srgb",mv=4,fv="uchar",hv=288,pv=!1,gv=!1,xv=!0,bv="{{.assetPrefix}}/assets/sun-drizzle-htsohv65.webp",yv={format:lv,width:cv,height:dv,space:uv,channels:mv,depth:fv,density:hv,isProgressive:pv,hasProfile:gv,hasAlpha:xv,src:bv},wv="webp",vv=96,_v=96,jv="srgb",kv=4,Sv="uchar",Cv=288,Nv=!1,$v=!1,Tv=!0,Ev="{{.assetPrefix}}/assets/sun-hazy-nfj7clcd.webp",Mv={format:wv,width:vv,height:_v,space:jv,channels:kv,depth:Sv,density:Cv,isProgressive:Nv,hasProfile:$v,hasAlpha:Tv,src:Ev},Pv="webp",Iv=96,Av=96,Rv="srgb",Lv=4,Dv="uchar",Fv=288,Ov=!1,Wv=!1,zv=!0,Bv="{{.assetPrefix}}/assets/sun-mostly-cloudy-e3pqqgs7.webp",Uv={format:Pv,width:Iv,height:Av,space:Rv,channels:Lv,depth:Dv,density:Fv,isProgressive:Ov,hasProfile:Wv,hasAlpha:zv,src:Bv},Hv="webp",Vv=96,qv=96,Gv="srgb",Xv=4,Yv="uchar",Kv=288,Zv=!1,Jv=!1,Qv=!0,e0="{{.assetPrefix}}/assets/sun-mostly-sunny-o99k1c7a.webp",t0={format:Hv,width:Vv,height:qv,space:Gv,channels:Xv,depth:Yv,density:Kv,isProgressive:Zv,hasProfile:Jv,hasAlpha:Qv,src:e0},s0="webp",n0=96,o0=96,a0="srgb",r0=4,i0="uchar",l0=288,c0=!1,d0=!1,u0=!0,m0="{{.assetPrefix}}/assets/sun-shower-ldwl4jbp.webp",f0={format:s0,width:n0,height:o0,space:a0,channels:r0,depth:i0,density:l0,isProgressive:c0,hasProfile:d0,hasAlpha:u0,src:m0},h0="webp",p0=96,g0=96,x0="srgb",b0=4,y0="uchar",w0=288,v0=!1,_0=!1,j0=!0,k0="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",S0={format:h0,width:p0,height:g0,space:x0,channels:b0,depth:y0,density:w0,isProgressive:v0,hasProfile:_0,hasAlpha:j0,src:k0},C0="webp",N0=96,$0=96,T0="srgb",E0=4,M0="uchar",P0=288,I0=!1,A0=!1,R0=!0,L0="{{.assetPrefix}}/assets/thunder-xzn1cku3.webp",D0={format:C0,width:N0,height:$0,space:T0,channels:E0,depth:M0,density:P0,isProgressive:I0,hasProfile:A0,hasAlpha:R0,src:L0},F0="webp",O0=96,W0=96,z0="srgb",B0=4,U0="uchar",H0=288,V0=!1,q0=!1,G0=!0,X0="{{.assetPrefix}}/assets/tornado-diqu61wg.webp",Y0={format:F0,width:O0,height:W0,space:z0,channels:B0,depth:U0,density:H0,isProgressive:V0,hasProfile:q0,hasAlpha:G0,src:X0},K0="webp",Z0=96,J0=96,Q0="srgb",e_=4,t_="uchar",s_=288,n_=!1,o_=!1,a_=!0,r_="{{.assetPrefix}}/assets/windy-n2v8wtyp.webp",i_={format:K0,width:Z0,height:J0,space:Q0,channels:e_,depth:t_,density:s_,isProgressive:n_,hasProfile:o_,hasAlpha:a_,src:r_},l_={foggy:{default:ih},cloudy:{default:yh},"heavy-snow":{default:Mh},"light-snow":{default:Uh},sleet:{default:Ug},drizzle:{default:fx,night:tp},hazy:{default:Sx,night:fp},"mostly-cloudy":{default:Dx,night:Sp},"mostly-sunny":{default:Yx,night:Dp},shower:{default:ib,night:Yp},sunny:{default:yb,night:ig},"rain-thunder":{default:yg},rain:{default:Mg},snow:{default:tx},thunder:{default:Mb},tornado:{default:Ub},windy:{default:ty}},c_={foggy:{default:fy},cloudy:{default:Sy},"heavy-snow":{default:Dy},"light-snow":{default:Yy},sleet:{default:Y1},drizzle:{default:yv,night:iw},hazy:{default:Mv,night:yw},"mostly-cloudy":{default:Uv,night:Mw},"mostly-sunny":{default:t0,night:Uw},shower:{default:f0,night:t1},sunny:{default:S0,night:f1},"rain-thunder":{default:S1},rain:{default:D1},snow:{default:iv},thunder:{default:D0},tornado:{default:Y0},windy:{default:i_}};function d_({weatherCode:t,isDarkMode:e,isNight:s}){const o=e?c_:l_,a=u_(t),r=o[a];return r.night&&s?r.night:r.default}function u_(t){switch(t){case 1:case 33:return"sunny";case 2:case 3:case 34:case 35:case 36:return"mostly-sunny";case 4:case 6:case 13:case 14:case 38:return"mostly-cloudy";case 5:case 37:return"hazy";case 7:case 8:return"cloudy";case 11:return"foggy";case 12:case 39:case 40:return"shower";case 15:case 16:case 17:case 41:case 42:return"thunder";case 18:return"rain";case 19:case 20:case 21:case 43:return"light-snow";case 22:case 23:case 44:return"snow";case 24:case 25:case 26:case 29:return"sleet";case 32:return"windy";default:return"cloudy"}}const m_="C";function f_(t,e){return Math.round(t==="F"?e*9/5+32:(e-32)*5/9)}function aa(t,e,s=m_){return t===s?"".concat(Math.round(e),"°"):"".concat(f_(t,e),"°")}const h_=7,ra=8,p_=g.memo(function({weatherResults:e,dateRange:s,turnIndex:o,trackContentReferenceEvent:a}){const[r,i]=C_(),l=b_(e);g.useEffect(()=>{a("Search Content Reference Shown","search_content_reference_shown","forecast")},[a]);const{daily:d,hourly:c,historical:m}=e;let f="daily";if(s||c&&d.length<2)f="hourly";else if(d.length>0)f="daily";else if(m&&(m==null?void 0:m.length)>0)f="historical";else return null;return n.jsxs("div",{className:"relative","data-testid":"weather-widget",children:[l?n.jsxs(n.Fragment,{children:[n.jsx(x_,{weatherResults:e}),n.jsx(y_,{weatherResults:e,temperatureUnit:r,setTemperatureUnit:i})]}):n.jsx("div",{className:"bg-token-main-surface-primary absolute end-0 top-3 z-10 rounded-sm",children:n.jsx($r,{onTemperatureUnitChange:i,temperatureUnit:r})}),n.jsx(j_,{turnIndex:o}),f==="hourly"&&n.jsx(w_,{weatherResults:e,temperatureUnit:r,dateRange:s}),f==="daily"&&n.jsx(v_,{dailyForecast:d.slice(0,h_),temperatureUnit:r}),f==="historical"&&n.jsx(__,{historical:m,temperatureUnit:r})]})});function g_({weatherAlert:t}){const[e,s]=g.useState(!1),o=ie(),a=ya(),r=qe(t.start_timestamp,t.utc_offset_sec),i=t.end_timestamp?qe(t.end_timestamp,t.utc_offset_sec):null,l=n.jsxs(n.Fragment,{children:[n.jsx("div",{children:n.jsx(K,{id:"JnuGPS",defaultMessage:"{start}{separator}{end}",values:{start:o.formatDate(r,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),separator:i?" - ":"",end:i?o.formatDate(i,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):""}})}),n.jsx("div",{children:t.summary})]});return n.jsxs("button",{className:"my-2 flex w-full flex-col gap-2 rounded-xl border border-red-200 bg-red-100 px-4 py-3 text-start text-sm text-red-800",onClick:()=>s(!e),children:[n.jsxs("div",{className:"flex w-full items-center gap-4",children:[n.jsx(Ui,{className:"h-9 w-9 shrink-0"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"font-bold",children:n.jsx(K,{id:"y+fy/l",defaultMessage:"Severe Weather: {name}",values:{name:t.name}})}),a&&l]}),n.jsx("div",{className:"grow"}),n.jsx("div",{className:"opacity-30",children:e?n.jsx(od,{className:"icon-lg"}):n.jsx(nd,{className:"icon-lg"})})]}),e&&t.details&&n.jsxs(n.Fragment,{children:[!a&&l,n.jsx("div",{className:"mt-1 whitespace-pre-wrap",children:t.details.trim()})]})]})}function x_({weatherResults:t}){const{severe:e}=t;return e?n.jsx("div",{className:"my-2",children:e.map((s,o)=>n.jsx(g_,{weatherAlert:s},o))}):null}function b_(t){const{historical:e,daily:s,hourly:o,current:a}=t;if(!a)return!1;let r=!1;const i=qe(a.timestamp,a.utc_offset_sec);for(const l of[e,s,o])l&&(r=r||(l==null?void 0:l.some(d=>Oi(i,qe(d.timestamp,d.utc_offset_sec)))));return r}function y_({weatherResults:t,temperatureUnit:e,setTemperatureUnit:s}){const o=ie(),{current:a}=t;if(!a)return null;const r=a.temperature.current,i=a.description,l=r!=null&&i&&" · ";return n.jsxs("div",{className:"not-prose flex items-center gap-4",children:[n.jsxs("div",{className:"grow",children:[n.jsxs("div",{className:"text-lg font-semibold",children:[r!=null&&n.jsx(K,{id:"FiwByI",defaultMessage:"Currently {temperature}",values:{temperature:lt(o,r,e)}}),l,i.description]}),n.jsx("div",{className:"text-token-text-secondary",children:S_(t.location)})]}),n.jsxs("div",{className:"flex",children:[n.jsx($r,{onTemperatureUnitChange:s,temperatureUnit:e}),n.jsx(Dn,{weatherDescriptionData:i,isNight:a.night})]})]})}function Ln({children:t}){return n.jsx("div",{className:"no-scrollbar not-prose mt-1 overflow-auto sm:overflow-hidden",children:n.jsx(je.Root,{className:"min-w-0",children:n.jsx(je.Body,{className:"border-token-border-medium border-b-[0.5px] [&_tr:last-child]:border-b-0",children:t})})})}function w_({weatherResults:t,temperatureUnit:e,dateRange:s}){const o=ie(),{hourly:a,current:r}=t;let i=a!=null?a:[];s&&(i=i.filter(m=>m.timestamp>=s.start_timestamp&&m.timestamp<s.end_timestamp));const[l,d]=g.useState(!1),c=i.length>ra;if(!l&&c){const m=i[0],f=qe(m.timestamp,m.utc_offset_sec);let h=!1;if(r){const y=qe(r.timestamp,r.utc_offset_sec);f.getTime()-y.getTime()>480*60*1e3&&i.length>18&&(i=i.slice(7,18),h=!0)}h||(i=i.slice(0,ra))}return n.jsxs(Ln,{children:[i.map((m,f)=>n.jsxs(je.Row,{children:[n.jsxs(De,{className:"w-44",children:[n.jsx(Dn,{weatherDescriptionData:m.description,isNight:m.night,size:"small"}),n.jsx("div",{className:"ms-3 whitespace-nowrap",children:n.jsx("span",{className:"lowercase",children:k_(o,m)})})]}),n.jsx(De,{className:"w-[60px] tabular-nums",children:n.jsx("div",{children:lt(o,m.temperature.current,e)})}),n.jsx(De,{children:m.description.description})]},f)),c&&n.jsx(je.Row,{children:n.jsx(De,{className:"w-44",children:n.jsx(Ve,{color:"secondary",onClick:()=>d(!l),size:"small",children:l?n.jsx(K,{id:"KoC8Ym",defaultMessage:"Show less"}):n.jsx(K,{id:"X8F8Y/",defaultMessage:"Show more"})})})})]})}function v_({dailyForecast:t,temperatureUnit:e}){const s=ie();return n.jsx(Ln,{children:t.map((o,a)=>n.jsxs(je.Row,{children:[n.jsxs(De,{className:"w-[7.5rem] min-w-[7.5rem]",children:[n.jsx(Dn,{weatherDescriptionData:o.description,isNight:o.night,size:"small"}),n.jsx("div",{className:"ms-3 whitespace-nowrap",children:nn(s,qe(o.timestamp,o.utc_offset_sec))})]}),n.jsxs(De,{className:"tabular-nums",children:[n.jsx("div",{children:lt(s,o.temperature.max,e)}),n.jsx("div",{className:"text-token-text-secondary ms-1",children:lt(s,o.temperature.min,e)})]}),n.jsx(De,{className:"min-w-80",children:o.description.description})]},a))})}function __({historical:t,temperatureUnit:e}){const s=ie();return t?n.jsx(Ln,{children:t.map((o,a)=>{const r=qe(o.timestamp,o.utc_offset_sec);return n.jsxs(je.Row,{children:[n.jsx(De,{className:"w-[250px]",children:n.jsx("div",{className:"ms-3 whitespace-nowrap",children:s.formatDate(r,{weekday:"long",month:"short",day:"numeric"})})}),n.jsx(De,{className:"tabular-nums",children:o.temperature.max&&o.temperature.min?n.jsxs(n.Fragment,{children:[n.jsx("div",{children:lt(s,o.temperature.max,e)}),n.jsx("div",{className:"text-token-text-secondary ms-1",children:lt(s,o.temperature.min,e)})]}):n.jsx("div",{children:lt(s,o.temperature.current,e)})}),n.jsx(De,{})]},a)})}):null}function De({className:t,children:e}){return n.jsx(je.Cell,{className:A("border-token-border-xlight! border-s-0! border-e-0! py-2! ps-4! pe-3! first:ps-0! last:pe-0!",t),divClassName:"items-start leading-relaxed",children:e})}function j_({turnIndex:t}){const e=lc(o=>{var a,r;return(r=(a=o.thread)==null?void 0:a.turns[t])==null?void 0:r.use_location}),[s]=cc();return!s.useLocation&&e?n.jsx("div",{className:"mt-3",children:n.jsx(Ve,{color:"secondary",icon:Bi,onClick:()=>{nc.setSettingsModalOpen(!0)},children:n.jsx(K,{id:"f47VEc",defaultMessage:"Share precise location"})})}):null}function $r({temperatureUnit:t,onTemperatureUnitChange:e}){const s=o=>t===o?"font-bold":"font-light";return n.jsx(Wi,{size:"small",triggerButton:n.jsx("button",{className:"text-token-text-tertiary hover:text-token-text-primary flex items-center justify-center p-1.5",children:n.jsx(Dl,{className:"icon-sm"})}),children:n.jsxs(zi.Item,{onClick:()=>{e(t==="C"?"F":"C")},className:"text-token-text-primary",children:[n.jsx(K,{id:"bQIoe/",defaultMessage:"Temperature"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:s("F"),children:n.jsx(K,{id:"bvDeBB",defaultMessage:"°F"})}),n.jsx("div",{className:"mx-1 h-4 border-s border-gray-300"}),n.jsx("div",{className:s("C"),children:n.jsx(K,{id:"iNiz6O",defaultMessage:"°C"})})]})]})})}function Dn({weatherDescriptionData:t,isNight:e=!1,size:s="normal"}){const o=gn(),a=s==="small"?30:50;return n.jsx("img",{draggable:!1,alt:t.description,src:d_({weatherCode:t.id,isDarkMode:o,isNight:e}).src,width:a,height:a})}function k_(t,e){const s=qe(e.timestamp,e.utc_offset_sec);return t.formatDate(s,{hour:"numeric"})}function lt(t,e,s){return e==null?"-":aa(s?s!=null?s:"F":Tr(t),e)}function Tr(t){const e=["en-US","en-BZ","en-BS","en-KY","en-PW"],s=t.locale||"en-US";return e.includes(s)?"F":"C"}function S_(t){const e=t.name.split(",").map(s=>s.trim());return t.country&&!e.includes(t.country)&&e.push(t.country),e.join(", ")}const C_=()=>{const t=ie(),[e,s]=Fi("USER_TEMPERATURE_UNIT",Tr(t),o=>["F","C"].includes(o));return[e,s]};function N_({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:o,contentReferenceIndex:a}){var v;const r=ye(),i=ve(r,"1950533395"),l=Pa(),d=l?"sidebar":"primary",c="metadata"in t&&((v=t.metadata)!=null&&v.location)?String(t.metadata.location):void 0,m=g.useMemo(()=>({content_reference_start_index:t.start_idx,entity_name:t.name,category:t.category,conversation_type:d,contentReferenceIndex:a,metadata_location:c}),[t.start_idx,t.name,t.category,d,a,c]);g.useEffect(()=>{o("Entity Anchor Content Reference Shown","entity_anchor_content_reference_shown","entity",m)},[o,m]);const{openThreadSidebar:f}=Ut(),{resetSidebarHistory:h}=Fl(),y=g.useCallback(_=>{var b,C;_.preventDefault(),o("Entity Anchor Content Reference Clicked","entity_anchor_content_reference_clicked","entity",m),e&&(l||h(),f({type:"entity",debugThreadId:void 0,messageId:s,contentReferenceStartIndex:t.start_idx,query:t.name,category:(b=t.category)!=null?b:void 0,extraParams:(C=t.extra_params)!=null?C:void 0}))},[o,m,e,l,f,s,t.start_idx,t.name,t.category,t.extra_params,h]);return t.category==="product_link"?i?n.jsx(Ve,{size:"medium",color:"secondary",className:"my-2",onClick:y,children:n.jsx(K,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):n.jsx("span",{className:"text-token-text-primary font-semibold",children:n.jsx(K,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):!i||t.status==="loading"?n.jsx("span",{className:"text-token-text-primary font-semibold",children:t.name}):n.jsx("span",{className:"hover:entity-accent entity-underline inline cursor-pointer align-baseline",onClick:y,children:n.jsx("span",{className:"whitespace-normal",children:t.name})})}const $_=fn(()=>jt(()=>import("./jh7y36b2fd9dqy15.js"),__vite__mapDeps([16,1,2,3,17,5,6,18,19,20,21,22,23,24,25,26,27])).then(t=>t.BusinessesMap)),T_=t=>!!t.dil,E_=t=>(t==null?void 0:t.type)==="element",M_=t=>t==="inline"||t==="block"||t==="container",P_=t=>{var s;if(!E_(t))return;const e=(s=t.properties)==null?void 0:s.displayLayout;return M_(e)?e:void 0};function I_(t){"use forget";var H,U,G,P;const e=ue.c(173),{index:s,FormattedText:o,node:a,wordFadeType:r}=t;let i;e[0]!==a?(i=P_(a),e[0]=a,e[1]=i):i=e[1];const l=i,d=parseInt(s,10),c=g.useContext(dt),m=ye(),h=Hi({id:(G=(U=(H=c==null?void 0:c.message)==null?void 0:H.metadata)==null?void 0:U.model_slug)!=null?G:""},m)||ve(m,"2137702454");let y;e[2]!==m?(y=Cs(m),e[2]=m,e[3]=y):y=e[3];const v=y;let _;e[4]!==c||e[5]!==v?(_=u=>{if(!v||(c==null?void 0:c.analyticsMetadata.turnIndex)===void 0)return[void 0,void 0];const D=ct.getConversationTurns(u),R=c.analyticsMetadata.turnIndex,z=D.findIndex(L_)===R,V=R>0?ct.getConversationTurnAtIndex(u,R-1):null,Z=Vi(V==null?void 0:V.messages.filter(qi));return[z,Z]},e[4]=c,e[5]=v,e[6]=_):_=e[6];const[b,C]=js(c==null?void 0:c.clientThreadId,_),E=b===!0&&d===0,p=Ca(c==null?void 0:c.analyticsMetadata),w=g.useRef(!1);if(c==null)return null;const{contentReferences:N,onShowSearchResults:k,numImageResults:$,analyticsMetadata:S,message:I,superWidgetContent:W}=c,x=N==null?void 0:N[d];if(!x||S.turnIndex===void 0||x.type===void 0)return null;let L;e[7]===Symbol.for("react.memo_cache_sentinel")?(L={img:R_},e[7]=L):L=e[7];let F;e[8]!==x.alt?(F=n.jsx(Sn,{components:L,children:x.alt}),e[8]=x.alt,e[9]=F):F=e[9];const O=F;let T=null;e:switch(x.type){case"title_citation":{let u;e[10]!==x||e[11]!==p?(u=n.jsx(Bf,{metadata:x,trackContentReferenceEvent:p}),e[10]=x,e[11]=p,e[12]=u):u=e[12],T=u;break e}case"link_title":{let u;e[13]!==x||e[14]!==p?(u=n.jsx($f,{metadata:x,trackContentReferenceEvent:p}),e[13]=x,e[14]=p,e[15]=u):u=e[15],T=u;break e}case"location_search":{let u;e[16]!==x||e[17]!==p?(u=n.jsx(Ef,{metadata:x,trackContentReferenceEvent:p}),e[16]=x,e[17]=p,e[18]=u):u=e[18],T=u;break e}case"time":{let u;e[19]!==x||e[20]!==p?(u=n.jsx(zf,{metadata:x,trackContentReferenceEvent:p}),e[19]=x,e[20]=p,e[21]=u):u=e[21],T=u;break e}case"image_v2":{const u=$!=null?$:0;let D;e[22]!==S||e[23]!==x||e[24]!==p||e[25]!==u?(D=n.jsx(In,{metadata:x,numImageResults:u,analyticsMetadata:S,trackContentReferenceEvent:p}),e[22]=S,e[23]=x,e[24]=p,e[25]=u,e[26]=D):D=e[26],T=D;break e}case"nav_list":{let u;e[27]!==x||e[28]!==p||e[29]!==E?(u=n.jsx(Mf,{metadata:x,trackContentReferenceEvent:p,isFirstAssistantContent:E}),e[27]=x,e[28]=p,e[29]=E,e[30]=u):u=e[30],T=u;break e}case"file_navlist":{let u;e[31]!==x||e[32]!==p?(u=n.jsx(df,{metadata:x,trackContentReferenceEvent:p}),e[31]=x,e[32]=p,e[33]=u):u=e[33],T=u;break e}case"file":{if(h){let u;e[34]!==x||e[35]!==N||e[36]!==p||e[37]!==d?(u=n.jsx(Wc,{contentReferences:N,fileRef:x,index:d,trackContentReferenceEvent:p}),e[34]=x,e[35]=N,e[36]=p,e[37]=d,e[38]=u):u=e[38],T=u}else{let u;e[39]!==x||e[40]!==p||e[41]!==d?(u=n.jsx(zc,{fileRef:x,index:d,trackContentReferenceEvent:p}),e[39]=x,e[40]=p,e[41]=d,e[42]=u):u=e[42],T=u}break e}case"grouped_webpages_model_predicted_fallback":{let u;e[43]!==x||e[44]!==c.message||e[45]!==p||e[46]!==d||e[47]!==a?(u=n.jsx(Oc,{webpageRef:x,node:a,trackContentReferenceEvent:p,message:c.message,index:d}),e[43]=x,e[44]=c.message,e[45]=p,e[46]=d,e[47]=a,e[48]=u):u=e[48],T=u;break e}case"grouped_webpages":{let u;e[49]!==x||e[50]!==c.message||e[51]!==p||e[52]!==d||e[53]!==a?(u=n.jsx(Fc,{webpageRef:x,node:a,trackContentReferenceEvent:p,message:c.message,index:d}),e[49]=x,e[50]=c.message,e[51]=p,e[52]=d,e[53]=a,e[54]=u):u=e[54],T=u;break e}case"tldr":break e;case"navigation":{let u;e[55]!==x||e[56]!==p||e[57]!==k?(u=n.jsx(Ol,{navigation:x,onShowSearchResults:k,trackContentReferenceEvent:p}),e[55]=x,e[56]=p,e[57]=k,e[58]=u):u=e[58],T=u;break e}case"stock":{let u;e[59]!==x||e[60]!==p?(u=n.jsx(Sf,{contentReference:x,trackContentReferenceEvent:p}),e[59]=x,e[60]=p,e[61]=u):u=e[61],T=u;break e}case"calculator":{let u;e[62]!==x||e[63]!==p?(u=n.jsx(Xm,{data:x,trackContentReferenceEvent:p}),e[62]=x,e[63]=p,e[64]=u):u=e[64],T=u;break e}case"python":case"container":{let u;e[65]!==S.turnIndex||e[66]!==x||e[67]!==c.clientThreadId?(u=n.jsx(Qm,{clientThreadId:c.clientThreadId,turnIndex:S.turnIndex,contentReference:x}),e[65]=S.turnIndex,e[66]=x,e[67]=c.clientThreadId,e[68]=u):u=e[68],T=u;break e}case"code_execution":{let u;e[69]!==o||e[70]!==x||e[71]!==p?(u=n.jsx(Zm,{FormattedText:o,displayInfo:x,trackContentReferenceEvent:p}),e[69]=o,e[70]=x,e[71]=p,e[72]=u):u=e[72],T=u;break e}case"forecast":{let u;e[73]!==S||e[74]!==x.date_range||e[75]!==x.forecast||e[76]!==p?(u=(x==null?void 0:x.forecast)&&n.jsx(p_,{weatherResults:x.forecast,dateRange:x.date_range,turnIndex:S.turnIndex,trackContentReferenceEvent:p}),e[73]=S,e[74]=x.date_range,e[75]=x.forecast,e[76]=p,e[77]=u):u=e[77],T=u;break e}case"businesses_map":{let u;e[78]!==x||e[79]!==p?(u=n.jsx($_,{contentReference:x,trackContentReferenceEvent:p}),e[78]=x,e[79]=p,e[80]=u):u=e[80],T=u;break e}case"map":{let u;e[81]!==S.turnIndex||e[82]!==x||e[83]!==c.clientThreadId||e[84]!==c.message.id||e[85]!==p?(u=n.jsx(Pc,{contentReference:x,trackContentReferenceEvent:p,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:S.turnIndex}),e[81]=S.turnIndex,e[82]=x,e[83]=c.clientThreadId,e[84]=c.message.id,e[85]=p,e[86]=u):u=e[86],T=u;break e}case"video":{let u;e[87]!==x||e[88]!==p?(u=n.jsx(Yf,{video:x,trackContentReferenceEvent:p}),e[87]=x,e[88]=p,e[89]=u):u=e[89],T=u;break e}case"sports_standings":{let u;e[90]!==x||e[91]!==p?(u=n.jsx(Of,{standingsRef:x,trackContentReferenceEvent:p}),e[90]=x,e[91]=p,e[92]=u):u=e[92],T=u;break e}case"sports_schedule":{let u;e[93]!==x||e[94]!==p?(u=n.jsx(Rf,{scheduleRef:x,trackContentReferenceEvent:p}),e[93]=x,e[94]=p,e[95]=u):u=e[95],T=u;break e}case"attribution":{let u;e[96]!==x||e[97]!==r?(u=n.jsx(Um,{attribution:x,wordFadeType:r}),e[96]=x,e[97]=r,e[98]=u):u=e[98],T=u;break e}case"debug":{let u;e[99]!==x?(u=n.jsx(n.Fragment,{children:Object.entries(x).map(A_)}),e[99]=x,e[100]=u):u=e[100],T=u;break e}case"image_inline":{let u;e[101]!==x||e[102]!==c.clientThreadId||e[103]!==p||e[104]!==I?(u=(P=I.metadata)!=null&&P.b1de6e2_rm?n.jsx(ym,{reference:x,clientThreadId:c.clientThreadId,trackContentReferenceEvent:p,message:I}):n.jsx(vm,{reference:x,clientThreadId:c.clientThreadId,trackContentReferenceEvent:p,message:I}),e[101]=x,e[102]=c.clientThreadId,e[103]=p,e[104]=I,e[105]=u):u=e[105],T=u;break e}case"image_group":{const u=C!=null?C:null,D=W!=null?W:null;let R;e[106]!==S||e[107]!==x||e[108]!==p||e[109]!==b||e[110]!==u||e[111]!==D?(R=n.jsx(Gu,{contentReference:x,trackContentReferenceEvent:p,analyticsMetadata:S,isFirstAssistantTurn:b,lastUserMsgOfPrevTurn:u,superWidgetContent:D}),e[106]=S,e[107]=x,e[108]=p,e[109]=b,e[110]=u,e[111]=D,e[112]=R):R=e[112],T=R;break e}case"product_entity":{let u;e[113]!==S.turnIndex||e[114]!==x||e[115]!==c.clientThreadId||e[116]!==c.message.id||e[117]!==p?(u=n.jsx(_m,{contentReference:x,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:S.turnIndex,trackContentReferenceEvent:p}),e[113]=S.turnIndex,e[114]=x,e[115]=c.clientThreadId,e[116]=c.message.id,e[117]=p,e[118]=u):u=e[118],T=u;break e}case"entity_metadata":{let u;e[119]!==x||e[120]!==c.clientThreadId||e[121]!==c.message.id||e[122]!==p?(u=n.jsx(lf,{contentReference:x,clientThreadId:c.clientThreadId,messageId:c.message.id,trackContentReferenceEvent:p}),e[119]=x,e[120]=c.clientThreadId,e[121]=c.message.id,e[122]=p,e[123]=u):u=e[123],T=u;break e}case"checkout_confirmation":{let u;e[124]!==x||e[125]!==p?(u=n.jsx(Au,{metadata:x,trackContentReferenceEvent:p}),e[124]=x,e[125]=p,e[126]=u):u=e[126],T=u;break e}case"entity":{let u;e[127]!==S.turnIndex||e[128]!==x||e[129]!==c.clientThreadId||e[130]!==c.message.id||e[131]!==p||e[132]!==d?(u=n.jsx(N_,{contentReference:x,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:S.turnIndex,trackContentReferenceEvent:p,contentReferenceIndex:d}),e[127]=S.turnIndex,e[128]=x,e[129]=c.clientThreadId,e[130]=c.message.id,e[131]=p,e[132]=d,e[133]=u):u=e[133],T=u;break e}case"product":{let u;e[134]!==S||e[135]!==x||e[136]!==c.clientThreadId||e[137]!==c.message.id||e[138]!==l||e[139]!==p||e[140]!==d?(u=n.jsx(Fm,{contentReference:x,clientThreadId:c.clientThreadId,messageId:c.message.id,trackContentReferenceEvent:p,contentReferenceIndex:d,analyticsMetadata:S,displayLayout:l}),e[134]=S,e[135]=x,e[136]=c.clientThreadId,e[137]=c.message.id,e[138]=l,e[139]=p,e[140]=d,e[141]=u):u=e[141],T=u;break e}case"products":{let u;e[142]!==S||e[143]!==x||e[144]!==c.clientThreadId||e[145]!==c.message.id?(u=n.jsx(Sm,{contentReference:x,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:S.turnIndex,analyticsMetadata:S}),e[142]=S,e[143]=x,e[144]=c.clientThreadId,e[145]=c.message.id,e[146]=u):u=e[146],T=u;break e}case"product_reviews":{let u;e[147]!==x||e[148]!==p?(u=n.jsx(si,{contentReference:x,disableAnimation:!0,trackContentReferenceEvent:p}),e[147]=x,e[148]=p,e[149]=u):u=e[149],T=u;break e}case"product_rationale":{let u;e[150]!==x||e[151]!==p?(u=n.jsx(ti,{contentReference:x,trackContentReferenceEvent:p,disableAnimation:!0}),e[150]=x,e[151]=p,e[152]=u):u=e[152],T=u;break e}case"dil":{let u;e[153]!==x.dil||e[154]!==x.dil_url||e[155]!==x.name||e[156]!==p?(u=n.jsx(sf,{dil:x.dil,dilUrl:x.dil_url,trackContentReferenceEvent:p,widgetName:x.name}),e[153]=x.dil,e[154]=x.dil_url,e[155]=x.name,e[156]=p,e[157]=u):u=e[157],T=u;break e}case"strix":break e;case"sources_footnote":return null}T_(x)&&"dil_url"in x;let B;e[166]!==O||e[167]!==x||e[168]!==p?(B=u=>(w.current||(p("Search Content Reference Failed","search_content_reference_failed",x.type),Ss.addError("Error rendering content reference: ".concat(x.type),Y(M({},u),{contentReference:x})),w.current=!0),x!=null&&x.alt?O:n.jsx("span",{className:"errored-object-".concat(x.type)})),e[166]=O,e[167]=x,e[168]=p,e[169]=B):B=e[169];let q;return e[170]!==T||e[171]!==B?(q=n.jsx(va,{name:"content-reference-renderer",fallback:B,children:T}),e[170]=T,e[171]=B,e[172]=q):q=e[172],q}function A_(t){const[e,s]=t;return n.jsx("sub",{className:"ms-1 w-fit rounded-md border-2 border-solid border-orange-500 px-1 leading-none",children:s},e)}function R_(t){const{src:e,alt:s}=t;return n.jsx("img",{src:e,alt:s,className:"max-h-28"})}function L_(t){return t.role===Gi.Assistant}var ua;const D_=new RegExp(String.raw(ua||(ua=Yt(["]((?!<)(","[^)\r\n]+?))"],["\\]\\((?!<)(","[^)\\r\\n]+?)\\)"])),Js),"g"),F_=/\s/;function ia(t){return t.replace(D_,(e,s)=>F_.test(s)?"](".concat("<".concat(s,">"),")"):e)}const as=(t,e,s)=>{Yi(s,t,void 0,e),Ki.count(Zi.WRITING_BLOCKS,t)};function O_(t){const l=t,{src:e,conversation:s}=l,o=$e(l,["src","conversation"]),a=hn(()=>s==null?void 0:s.serverId$()),r=g.useContext(dt),i=ql(a,e,r==null?void 0:r.useSafeUrls);return i==null?n.jsx("div",{}):n.jsx("img",Y(M({},o),{src:i}))}function W_(t){return n.jsx(I_,Y(M({},t),{FormattedText:z_}))}function z_({size:t="medium",children:e,className:s,conversation:o,messageId:a,isActivelyStreaming:r=!1,componentOverrides:i,isDeepResearchResultMessage:l,forceDarkMode:d,disableWordFade:c}){const m=gn()||d,{wordFadeType:f}=Wl(),h=zl(),y=g.useRef(!1),v=g.useRef(!1);y.current=!1;const _=ye(),b=Qs(en.DisableWritingBlockRendering),C=g.useMemo(()=>{var D;if(!i)return;const R=i,{[D=Ds]:P}=R;return $e(R,[so(D)])},[i]),E=g.useMemo(()=>i==null?void 0:i[Ds],[i]),p=g.useMemo(()=>M(M(Y(M({pre:({children:P,"data-start":u,"data-end":D,"data-is-last-node":R})=>n.jsx("pre",{className:"overflow-visible!","data-start":u,"data-end":D,"data-is-last-node":R,children:P}),code:P=>n.jsx(Ul,M({},P)),[Xi]:P=>n.jsx(W_,M({wordFadeType:f},P)),[Bl]:P=>o==null?null:n.jsx(hu,Y(M({},P),{conversation:o,messageId:a})),[sc]:tc,[fc]:gu,[mc]:Nu,[uc]:Su,[dc]:wu,a:P=>{var Z,te,me,re;const V=P,{node:u,children:D}=V,R=$e(V,["node","children"]),z=(Z=u==null?void 0:u.properties)==null?void 0:Z.href;if(typeof z=="string"&&z.startsWith(Js))return o!=null&&a!=null?n.jsx(Wr,Y(M({},R),{conversation:o,messageId:a,href:z,children:D})):null;if(typeof z=="string"&&z===zr){if(o==null||a==null)return D;const fe=(te=u==null?void 0:u.children)==null?void 0:te.map(se=>typeof se.value=="string"?se.value:"").join("").trim();return n.jsx(Br,Y(M({},P),{text:fe,conversation:o,messageId:a,className:"cursor-pointer"}))}if(typeof z=="string"&&z===Ur){if(o==null||a==null)return D;const fe=(me=u==null?void 0:u.children)==null?void 0:me.map(se=>typeof se.value=="string"?se.value:"").join("").trim();return n.jsx(Hr,Y(M({},P),{text:fe,conversation:o,messageId:a}))}if(typeof z=="string"&&z===Vr){if(o==null||a==null)return D;const fe=(re=u==null?void 0:u.children)==null?void 0:re.map(se=>typeof se.value=="string"?se.value:"").join("").trim();return n.jsx(qr,Y(M({},P),{text:fe,conversation:o,messageId:a}))}return z&&typeof z=="string"&&pu(z)?D:n.jsx(ad,Y(M({},P),{messageId:a}))},table:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);return n.jsx(sd,Y(M({},u),{onClickCopy:z=>{var Z;rs.logEvent("ChatGPT Table Copy Clicked");const V=o!=null&&a!=null?ct.getNode(io(o.id),a).message:void 0;ka(ed(P.markdownSource,(Z=V==null?void 0:V.metadata)==null?void 0:Z.content_references),void 0,z)}}))},td},h?{h1:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);return n.jsx("h1",M({"data-section-id":Zt(P.markdownSource)},u))},h2:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);return n.jsx("h2",M({"data-section-id":Zt(P.markdownSource)},u))},h3:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);return n.jsx("h3",M({"data-section-id":Zt(P.markdownSource)},u))},li:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);return n.jsx("li",M({"data-section-id":Zt(P.markdownSource)},u))}}:{}),{img:D=>{var R=D,{node:P}=R,u=$e(R,["node"]);var V;const z=(V=P==null?void 0:P.properties)==null?void 0:V.src;return typeof z=="string"&&(z.startsWith(Js)||z.startsWith("attachment:"))?null:n.jsx(O_,Y(M({},u),{conversation:o}))}}),f==="delay"?rd:[]),C!=null?C:{}),[h,f,C,o,a]),w=g.useCallback((P,u)=>{var D,R,z,V;if(P==null||o==null||a==null)return u;try{const Z=io(o.id),te=ct.getNode(Z,a),me=(V=(z=(R=(D=te==null?void 0:te.message)==null?void 0:D.metadata)==null?void 0:R.writing_blocks)==null?void 0:z[P])==null?void 0:V.content;return me!=null?me:u}catch(Z){return u}},[o,a]),N=g.useCallback((P,u)=>P?n.jsx(la,{components:p,remarkPlugins:Ks,rehypePlugins:Zs,urlTransform:Ys,children:ia(P)}):n.jsx(n.Fragment,{children:u}),[p]),k=g.useCallback(P=>{var D,R;if(y.current=!0,b){const z=(D=P.id)!=null?D:P.index!=null?String(P.index):void 0,V=w(z,P.content);return N(V,P.children)}if(typeof E=="function")return E(P);const u=Sc(P.variant);return n.jsx(Pu,{conversation:o,messageId:a,title:P.title,originalContent:P.content,variant:u,recipient:P.recipient,isStreaming:r,index:P.index,id:(R=P.id)!=null?R:String(P.index),children:P.children})},[b,w,N,E,a,r,o]),$=g.useMemo(()=>Y(M({},p),{[Ds]:k}),[p,k]),S=ve(_,"1839283687"),[I,W]=g.useState(!1),x=g.useMemo(()=>{const P=e!=null?e:"",u=r&&e?id(e):P;return ia(u)},[e,r]),L=g.useMemo(()=>Hl(x),[x]),F=g.useMemo(()=>I?Vl(x):x,[x,I]),O=Na(),T=g.useMemo(()=>[...Zs,[Gr,F]],[F]),B=g.useRef(!1);r&&(B.current=!0);const q=g.useMemo(()=>f==="indexed"&&!c?{handlers:{text:(P,u,D)=>{const R=[];for(const z of O(u.value))R.push({type:"element",tagName:"span",properties:{className:$a.fadeIn},children:[{type:"text",value:z}]});return R}}}:void 0,[f,O,c]),H=g.useMemo(()=>r||!L?!1:x.includes(":::writing"),[r,L,x]),U=g.useMemo(()=>{var P;return{contains_writing_directive:L?"true":"false",uses_old_syntax:H?"true":"false",client_thread_id:(P=o==null?void 0:o.id)!=null?P:"",message_id:a!=null?a:""}},[L,H,a,o]),G=g.useRef(!1);return g.useEffect(()=>{!H||G.current||(as("chatgpt_writing_block_uses_old_syntax",U,_),B.current&&as("chatgpt_new_writing_block_uses_old_syntax",U,_),G.current=!0)},[U,H,_]),g.useEffect(()=>{L&&(r||y.current||v.current||(as("chatgpt_writing_block_render_failed",U,_),B.current&&as("chatgpt_writing_block_first_render_failed",U,_),v.current=!0,W(!0)))},[_,o,r,a,L,W,H,U]),S?!1:n.jsx(va,{name:"formatted_text_error",fallback:()=>n.jsx(n.Fragment,{children:F}),children:n.jsx(la,{rehypePlugins:T,remarkPlugins:Ks,remarkRehypeOptions:q,className:A(s,"markdown prose dark:prose-invert w-full break-words",m?"dark":"light",t==="small"&&"prose-xs",l&&"deep-research-result","markdown-new-styling"),urlTransform:Ys,components:$,children:F})})}const la=g.memo(Sn);export{z_ as FormattedText,la as ReactMarkdownMemo};
//# sourceMappingURL=iq89m7glzxhdh60d.js.map

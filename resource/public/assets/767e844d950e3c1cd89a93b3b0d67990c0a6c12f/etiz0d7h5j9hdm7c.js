const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/g2euln7v5pbm31qa.js","assets/mw35uwhq4g8r9eam.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var q=Object.defineProperty,D=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var E=(e,r,t)=>r in e?q(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,b=(e,r)=>{for(var t in r||(r={}))H.call(r,t)&&E(e,t,r[t]);if(M)for(var t of M(r))J.call(r,t)&&E(e,t,r[t]);return e},R=(e,r)=>D(e,V(r));import{h as O,j as o,M as Q,d as X,r as d,_ as Y,y as Z,a1 as tt}from"./mw35uwhq4g8r9eam.js";import{aA as et,l_ as F,cF as rt,sE as ot,u as k,J as nt,jl as W,oU as st,be as at,bq as it,_ as ct,I as mt,pd as G,T as z,m as pt,fj as dt}from"./d0xa318sl7ywi0za.js";import{m as P}from"./nc6572sivljsjb83.js";import{R as lt}from"./ir2ki5n4li2l685e.js";import{S as ut}from"./j03r762zzaohakh7.js";import{lr as ht,ls as gt,d3 as ft,b4 as v,b5 as N}from"./g2euln7v5pbm31qa.js";import{C as L}from"./dukfeuga0ipvcx0b.js";import{a as xt}from"./5uqv5sdajcdsdc3v.js";import{a as Pt}from"./fo2xpy5kxcsnxpwn.js";import{b as kt,g as Tt,T as yt,W as bt,c as vt}from"./lkt2qv7ib8tsqf90.js";import{u as Ct}from"./mlgj7gsfvuk1e8bn.js";import{useSetupBaseWhamKeyboardActions as jt}from"./qyj59gvnqjp5wm2y.js";import{j as A,o as wt}from"./ldtpmsnzn9ens47o.js";import"./kc32gem4l2t3hnxt.js";import"./of0vtq1gcmd3mc3z.js";import"./dtmprrbw2fxa7u08.js";import"./j6o92bx1q4qhetyv.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./cvl54rj7bbx1877e.js";import"./i8gmt89kig8ue44v.js";import"./dejzmw8nrz6tr491.js";import"./kbwy95pwpw3ze3en.js";import"./dbnl40ahcmx1rqbw.js";import"./j723eutw6lfomm01.js";import"./gl4f6lge29au0ljx.js";import"./iio0zgk2sqlxbcjy.js";import"./obpubb7ugisfu36u.js";import"./c340ncgh31fwqkpk.js";import"./ggvjblnzoirafiyl.js";import"./fe4yarxdk4eko5w6.js";import"./kubdgxu3crk3gqem.js";import"./kne35xckmmfq3xx6.js";import"./jc1wlz3ym1r6tf2l.js";import"./dhyn0hpw8j3dzdrv.js";import"./ft92xq3wp8rdw7y4.js";import"./kl0a548ohmz3fby2.js";import"./nxan4e3brpzak2la.js";import"./i2f5gqqndy3iowkc.js";import"./ipoljkkwhes3fgxa.js";import"./jxdumrq8vfk5kk1c.js";import"./oftnd9rlobxeh2e2.js";import"./kx64af29hscb23w7.js";import"./brzhn6w36e0ait35.js";import"./lptwpbjabrvjmhsj.js";import"./gkerdwj307fj3n4u.js";import"./h9z1eo55yfy9l6t8.js";import"./ee6pijsbu8dfevmi.js";import"./k6k3ilbqdb73kxkm.js";import"./baz4b8nlf8t2lb95.js";import"./dxkl0433k1u8ypnz.js";import"./ox7635ffwodpca7w.js";import"./nr9k12yditsrjrdm.js";import"./eder15khh2fy5wd2.js";import"./krfycj1ruc6rihlj.js";import"./lgfmpb0my7e1aj31.js";import"./c8dilzb1umlthpuq.js";import"./hdw58d7g4tx8n6s4.js";import"./cmsg2ikilns8l0ug.js";import"./c5k9gv36gzuxi0am.js";import"./lw2hpe6y5hhfte4k.js";import"./ksb30nvrqfrocrgu.js";import"./h38m9m9rf2db1qpt.js";import"./mpk4drhv3szxuvkj.js";import"./fljft0gbsnm1ovqa.js";import"./k527f0oyvlppyfoy.js";import"./m4z0737cb20mwzwc.js";import"./ddina39kz3r81pp7.js";import"./w3hi9hzc7twqpn11.js";import"./ga8rhh96wttk8d8h.js";import"./f89v9mtyvakgmoul.js";import"./f3alhksm9dfhscbq.js";import"./ohau9tqj1fpdibg0.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./cv4afpu20gjb9dll.js";import"./h4yh1661qhhbu5v5.js";import"./hu1bt0oauegdhua6.js";const _t=({title:e})=>{const t=O().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return o.jsxs("div",{className:"flex justify-between print:hidden",children:[o.jsxs("div",{className:"flex flex-col justify-start",children:[o.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:e}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:o.jsx(Q,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:s=>o.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:s})}})})]}),o.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[o.jsx(ut,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),o.jsx(et,{className:rt("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open("https://chatgpt.com/?utm_src=deep-research-sharing","_blank")},icon:F,label:t,children:t})]})]})};function St({postWithProfile:e,title:r,children:t}){return o.jsx(ht.Provider,{value:{postId:e.post.id},children:o.jsx(ot,{children:o.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:o.jsxs("div",{className:"mx-auto max-w-3xl",children:[o.jsx("div",{className:"px-2 py-6",children:!!r&&o.jsx(_t,{title:r})}),o.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:o.jsxs("div",{className:"p-14 pt-8",children:[o.jsx("a",{href:"https://chatgpt.com/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:o.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[o.jsx(F,{className:"text-token-text-primary h-8 w-8"}),o.jsx(gt,{})]})}),t]})})]})})})})}function It(e){if(e.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const r=e.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn,exampleTaskInfo:r.example_task_info}}function Mt({postWithProfile:e}){var S;jt();const r=A(h=>h.addTurnToTaskMap),{task:t,fetchedTurns:s,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:c,exampleTaskInfo:p}=It(e),l=k(),i=O(),m=X(),u=ft.useCurrentImage()!=null,T=nt(l,"2818336692"),[x,y]=d.useState([]),C=d.useCallback(()=>{y([])},[]),{focusedAssistantTurn:g,setFocusedAssistantTurnId:j}=kt({taskId:t.id,task:t,currentUserTurn:n!=null?n:null,currentAssistantTurn:a!=null?a:null}),w=d.useMemo(()=>wt(g),[g]),K=d.useMemo(()=>({comments:x,setComments:y,clearComments:C,readonlyComments:w}),[x,y,C,w]),f=A(({getTurnsForTask:h})=>t?h(t.id):[]),_=d.useMemo(()=>{var h;return Tt({focusedAssistantTurn:g,pastTurns:f,currentDiffTaskTurnId:(h=c==null?void 0:c.id)!=null?h:null})},[g,c==null?void 0:c.id,f]),U=d.useMemo(()=>({setFocusedAssistantTurnId:j,focusedAssistantTurn:g,currentDiffTaskTurn:_,taskId:t==null?void 0:t.id,task:t,pastTurns:f,canFollowUp:!1}),[g,_,t,f,j]);return d.useEffect(()=>{var h;Object.values((h=s==null?void 0:s.turn_mapping)!=null?h:{}).forEach($=>{var I;r((I=t==null?void 0:t.id)!=null?I:"",$.turn)})},[s,r,t]),Ct([{key:"newTask",action:()=>{m("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:N.Chat,keyboardBinding:[v.Mod,v.Shift,"o"]},{key:"closeTask",action:()=>{m("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:N.Chat,keyboardBinding:[v.Escape],enabled:!u}]),!t||!f?null:o.jsx(W.Provider,{value:{postWithProfile:e,setIsReportModalOpen:()=>{}},children:o.jsx(st,{children:o.jsx(yt,{value:K,children:o.jsx(bt,{value:U,children:o.jsx(vt,{permissions:"read",turnId:(S=a==null?void 0:a.id)!=null?S:"",showForkButton:T,loadingTurnMapping:!1,isSharedExampleTask:!!p})})})})})}const Et=at(()=>Y(()=>import("./g2euln7v5pbm31qa.js").then(e=>e.Dr),__vite__mapDeps([0,1,2,3,4])).then(e=>e.PostSharingErrorModal)),cr=Z(function(){const r=tt();return r.kind==="forbidden"?o.jsx(Ot,{chatPageProps:r.chatPageProps,reason:"workspace"}):o.jsx(Rt,{loaderData:r})});function Rt({loaderData:e}){var a,c,p,l;const r=k();d.useEffect(()=>{var i,m;ct.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:e.postWithProfile.post.id,primary_attachment_type:(m=(i=e.postWithProfile.post.attachments)==null?void 0:i[0])==null?void 0:m.kind,referrer:e.referrer})},[e]);const{session:t}=mt(r),s=d.useMemo(()=>{var m,u;const i=G(r);return z.initThread({clientThreadId:i.id,conversationMode:{kind:pt.PrimaryAssistant},userId:(m=t==null?void 0:t.user)==null?void 0:m.id,accountId:(u=t==null?void 0:t.account)==null?void 0:u.id}),i},[r,(a=t==null?void 0:t.account)==null?void 0:a.id,(c=t==null?void 0:t.user)==null?void 0:c.id]),n=(p=e.postWithProfile.post.attachments)==null?void 0:p[0];if(n.kind==="deep_research"){const i=n.messages,m=dt(i),u=(l=m==null?void 0:m.metadata)==null?void 0:l.async_task_title;return m?o.jsx(St,{postWithProfile:e.postWithProfile,title:u,children:o.jsx(lt,{messages:i,conversation:s})}):null}return n.kind==="codex"?o.jsx(Mt,{postWithProfile:e.postWithProfile}):o.jsx(Ft,{postWithProfile:e.postWithProfile,chatPageProps:e.chatPageProps})}function B(e){return{url:"https://ogimg.chatgpt.com/?postId=".concat(e),size:[1200,630]}}function Nt(e,r){var s,n,a,c,p,l,i;if(!e.attachments||e.attachments.length===0)return{url:P.src};const t=e.attachments[0];switch(t.kind){case"media_generation":{const m=(n=(s=t.encodings)==null?void 0:s.md)!=null&&n.path?{url:t.encodings.md.path,size:[t.width,t.height]}:void 0,u=(c=(a=t.encodings)==null?void 0:a.unfurl)!=null&&c.path?{url:t.encodings.unfurl.path,size:[1200,630]}:void 0,T=(l=(p=t.encodings)==null?void 0:p.thumbnail)!=null&&l.path?{url:t.encodings.thumbnail.path}:void 0,x={url:t.url,size:[t.width,t.height]};return r&&m!=null?m:(i=u!=null?u:T)!=null?i:x}case"message_slice":return B(e.id);default:return{url:P.src}}}function At(e){var s,n,a;const r=(s=e.text)==null?void 0:s.trim();if(r)return r;const t=(n=e.attachments)==null?void 0:n[0];return(t==null?void 0:t.kind)==="media_generation"&&((a=t.title)!=null&&a.trim())?t.title.trim():"Shared Content"}const mr=({data:e})=>{const r=e,t={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:P.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:P.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:s}=r.postWithProfile,n=r.enforceRenderedOgImg?B(s.id):Nt(s,r.preferIntrinsicAspectRatioForOgImage),a=At(s),c=s.permalink,p=new Date(s.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:p},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function Ot({chatPageProps:e,reason:r}){const t=k();return d.useEffect(()=>{it(t,Et,{reason:r})},[]),o.jsx(L,b({},e))}function Ft({postWithProfile:e,chatPageProps:r}){const t=k(),[s,n]=d.useState(!1),[a]=d.useState(()=>G(t)),c=a.id,p=Pt(e.post.attachments);if(p){const{threadResponse:l}=p;z.updateThreadFromServer(c,l,{skipIfExisting:!0,continuingFromSharedPostId:e.post.id,forkFromSharedPost:!0})}return o.jsxs(W.Provider,{value:{postWithProfile:e,setIsReportModalOpen:n},children:[s&&o.jsx(xt,{post:e.post,onClose:()=>n(!1)}),o.jsx(L,R(b({},r),{clientThreadId:c}))]})}export{cr as default,mr as meta};
//# sourceMappingURL=etiz0d7h5j9hdm7c.js.map

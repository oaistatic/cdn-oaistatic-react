const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mgd4bano9n2tt0tl.js","assets/mw35uwhq4g8r9eam.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css"])))=>i.map(i=>d[i]);
var bt=Object.defineProperty,wt=Object.defineProperties;var Nt=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var ce=(e,r,n)=>r in e?bt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,N=(e,r)=>{for(var n in r||(r={}))ue.call(r,n)&&ce(e,n,r[n]);if(P)for(var n of P(r))fe.call(r,n)&&ce(e,n,r[n]);return e},A=(e,r)=>wt(e,Nt(r));var M=(e,r)=>{var n={};for(var t in e)ue.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&P)for(var t of P(e))r.indexOf(t)<0&&fe.call(e,t)&&(n[t]=e[t]);return n};import{be as xt,u as Ct,cC as kt,d as Ue,_ as E,cF as St,bq as At,$ as L,a0 as R,p as Et,cw as Tt,er as vt,qi as Lt,qj as je,R as Rt,ft as Dt,b6 as Ot,hC as Y,m as It,bW as Pt,lA as Mt,yD as Ft,a6 as Ut,f2 as jt,l3 as Bt,cx as O,ps as X,pt as Ht}from"./d0xa318sl7ywi0za.js";import{_ as $t,r as C,j as w,R as Q,u as qt,h as Wt,e as Gt,b as Kt}from"./mw35uwhq4g8r9eam.js";import{g1 as Vt,Af as zt,Ag as Yt,Ah as Xt,Ai as pe,sh as Qt,nZ as Be,Aj as de,xU as He,Ak as D,xV as Jt,Al as G,gv as $e,el as Zt,tB as en,cx as tn,v as k,Am as U,An as qe,fF as nn,it as rn,Ao as sn,Ap as on,f5 as We,Aq as an,Ar as ln,c_ as cn}from"./g2euln7v5pbm31qa.js";import{a as J,b as Ge,c as Ke,r as un,C as fn,s as v}from"./iakh052vusklquwn.js";import{r as Ve,c as ze}from"./ohau9tqj1fpdibg0.js";import{f as pn,r as Z,c as me}from"./oj9zwxa6l3kpv1x2.js";import{f as Ye,p as he,n as ge,h as Xe,s as ee,d as dn,w as te,a as mn,r as hn}from"./i693kfbch8smq86y.js";import{k as ye}from"./lep2wptoy14cfe2w.js";import{t as gn}from"./hu1bt0oauegdhua6.js";import{u as j}from"./iknugp00locgtve5.js";import{r as B}from"./kbj1b07s2z6vxqkg.js";const yn=xt(()=>$t(()=>import("./mgd4bano9n2tt0tl.js"),__vite__mapDeps([0,1,2,3])).then(e=>e.SafeLinkWarningModal)),_e={},be={},we={};function Ne(e,r){return"".concat(e,"::").concat(r)}function _n(o){var l=o,{node:e,onClick:r,children:n,messageId:t,href:s,disableSafeURLs:a}=l,i=M(l,["node","onClick","children","messageId","href","disableSafeURLs"]);var ie,oe,ae,le;const c=Ct(),u=kt();let p=r;const f=(ie=e==null?void 0:e.properties)==null?void 0:ie.href,g=C.useContext(Vt),m=Ue(()=>u==null?void 0:u.serverId$()),d=zt(m,s,(g==null?void 0:g.useSafeUrls)&&!a),h=Yt(u==null?void 0:u.id,t),_=(le=(ae=(oe=h==null?void 0:h.metadata)==null?void 0:oe.__internal)==null?void 0:ae.utm_tags)!=null?le:{},b=Xt(u==null?void 0:u.id),H=!a&&d===void 0;return t!=null&&typeof f=="string"&&f.includes("/bing/redirect")&&(_e[t]||(E.logEvent("Browsing Show Bing Link",{id:t,content:f}),_e[t]=!0),p=I=>{be[t]||(E.logEvent("Browsing Click Bing Link",{id:t,content:f}),be[t]=!0),r==null||r(I)}),p=I=>{const $=""+f;if(t&&!we[Ne(t,$)]){const _t=d||H?"URL Clicked Allowed":"URL Clicked Blocked";E.logEvent(_t,{id:t,content:$}),we[Ne(t,$)]=!0}r==null||r(I),H&&s&&(I.preventDefault(),At(c,yn,{urls:pe(s,_,b)}))},w.jsx(w.Fragment,{children:w.jsx("a",A(N({onClick:p},i),{className:St(i.className,H&&"cursor-pointer"),href:d&&pe(d,_,b),rel:"noopener",children:n}))})}const bn="w";function wn(a){var i=a,{messageId:e,conversation:r,text:n,children:t}=i,s=M(i,["messageId","conversation","text","children"]);const o=window.location.origin,l="".concat(o,"?q=").concat(encodeURIComponent(n)),c=Qt(),u=C.useCallback(async p=>{p.preventDefault(),L.count(R.DEFAULT,"instant_follow_up_anchor_clicked"),E.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:r.id,messageId:e}),c(p,{text:n,type:Be.Reply},[],0)},[r,e,n,c]);return w.jsx(_n,A(N({},s),{href:l,disableSafeURLs:!0,messageId:e,className:"cursor-pointer",onClick:u,children:t}))}const vs=Q.memo(wn),xe=/[#.]/g;function Nn(e,r){const n=e||"",t={};let s=0,a,i;for(;s<n.length;){xe.lastIndex=s;const o=xe.exec(n),l=n.slice(s,o?o.index:n.length);l&&(a?a==="#"?t.id=l:Array.isArray(t.className)?t.className.push(l):t.className=[l]:i=l,s+=l.length),o&&(a=o[0],s++)}return{type:"element",tagName:i||r||"div",properties:t,children:[]}}const xn=new Set(["button","menu","reset","submit"]),K={}.hasOwnProperty;function Qe(e,r,n){const t=n&&An(n);function s(a,i,...o){let l=-1,c;if(a==null){c={type:"root",children:[]};const u=i;o.unshift(u)}else if(c=Nn(a,r),c.tagName=c.tagName.toLowerCase(),t&&K.call(t,c.tagName)&&(c.tagName=t[c.tagName]),Cn(i,c.tagName)){let u;for(u in i)K.call(i,u)&&kn(e,c.properties,u,i[u])}else o.unshift(i);for(;++l<o.length;)V(c.children,o[l]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function Cn(e,r){return e==null||typeof e!="object"||Array.isArray(e)?!1:r==="input"||!e.type||typeof e.type!="string"?!0:"children"in e&&Array.isArray(e.children)?!1:r==="button"?xn.has(e.type.toLowerCase()):!("value"in e)}function kn(e,r,n,t){const s=Ye(e,n);let a=-1,i;if(t!=null){if(typeof t=="number"){if(Number.isNaN(t))return;i=t}else typeof t=="boolean"?i=t:typeof t=="string"?s.spaceSeparated?i=de(t):s.commaSeparated?i=he(t):s.commaOrSpaceSeparated?i=de(he(t).join(" ")):i=Ce(s,s.property,t):Array.isArray(t)?i=t.concat():i=s.property==="style"?Sn(t):String(t);if(Array.isArray(i)){const o=[];for(;++a<i.length;){const l=Ce(s,s.property,i[a]);o[a]=l}i=o}if(s.property==="className"&&Array.isArray(r.className)){const o=i;i=r.className.concat(o)}r[s.property]=i}}function V(e,r){let n=-1;if(r!=null)if(typeof r=="string"||typeof r=="number")e.push({type:"text",value:String(r)});else if(Array.isArray(r))for(;++n<r.length;)V(e,r[n]);else if(typeof r=="object"&&"type"in r)r.type==="root"?V(e,r.children):e.push(r);else throw new Error("Expected node, nodes, or string, got `"+r+"`")}function Ce(e,r,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||ge(n)===ge(r)))return!0}return n}function Sn(e){const r=[];let n;for(n in e)K.call(e,n)&&r.push([n,e[n]].join(": "));return r.join("; ")}function An(e){const r={};let n=-1;for(;++n<e.length;)r[e[n].toLowerCase()]=e[n];return r}const En=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Tn=Qe(Xe,"div"),vn=Qe(ee,"g",En),q={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"};function Ln(e,r){return Je(e,{})||{type:"root",children:[]}}function Je(e,r){const n=Rn(e,r);return n&&r.afterTransform&&r.afterTransform(e,n),n}function Rn(e,r){switch(e.nodeType){case 1:return Pn(e,r);case 3:return On(e);case 8:return In(e);case 9:return ke(e,r);case 10:return Dn();case 11:return ke(e,r);default:return}}function ke(e,r){return{type:"root",children:Ze(e,r)}}function Dn(){return{type:"doctype"}}function On(e){return{type:"text",value:e.nodeValue||""}}function In(e){return{type:"comment",value:e.nodeValue||""}}function Pn(e,r){const n=e.namespaceURI,t=n===q.svg?vn:Tn,s=n===q.html?e.tagName.toLowerCase():e.tagName,a=n===q.html&&s==="template"?e.content:e,i=e.getAttributeNames(),o={};let l=-1;for(;++l<i.length;)o[i[l]]=e.getAttribute(i[l])||"";return t(s,o,Ze(a,r))}function Ze(e,r){const n=e.childNodes,t=[];let s=-1;for(;++s<n.length;){const a=Je(n[s],r);a!==void 0&&t.push(a)}return t}new DOMParser;function Mn(e,r){const n=Fn(e);return Ln(n)}function Fn(e){const r=document.createElement("template");return r.innerHTML=e,r.content}const Se=(function(e,r,n){const t=He(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof r=="number"){if(r<0||r===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(r=e.children.indexOf(r),r<0)throw new Error("Expected child node or index");for(;++r<e.children.length;)if(t(e.children[r],r,e))return e.children[r]}),Ae=/\n/g,Ee=/[\t ]+/g,z=D("br"),Te=D(Gn),Un=D("p"),ve=D("tr"),jn=D(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",Wn,Kn]),et=D(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function Bn(e,r){const n=r||{},t="children"in e?e.children:[],s=et(e),a=rt(e,{whitespace:n.whitespace||"normal"}),i=[];(e.type==="text"||e.type==="comment")&&i.push(...nt(e,{breakBefore:!0,breakAfter:!0}));let o=-1;for(;++o<t.length;)i.push(...tt(t[o],e,{whitespace:a,breakBefore:o?void 0:s,breakAfter:o<t.length-1?z(t[o+1]):s}));const l=[];let c;for(o=-1;++o<i.length;){const u=i[o];typeof u=="number"?c!==void 0&&u>c&&(c=u):u&&(c!==void 0&&c>-1&&l.push("\n".repeat(c)||" "),c=-1,l.push(u))}return l.join("")}function tt(e,r,n){return e.type==="element"?Hn(e,r,n):e.type==="text"?n.whitespace==="normal"?nt(e,n):$n(e):[]}function Hn(e,r,n){const t=rt(e,n),s=e.children||[];let a=-1,i=[];if(jn(e))return i;let o,l;for(z(e)||ve(e)&&Se(r,e,ve)?l="\n":Un(e)?(o=2,l=2):et(e)&&(o=1,l=1);++a<s.length;)i=i.concat(tt(s[a],e,{whitespace:t,breakBefore:a?void 0:o,breakAfter:a<s.length-1?z(s[a+1]):l}));return Te(e)&&Se(r,e,Te)&&i.push("	"),o&&i.unshift(o),l&&i.push(l),i}function nt(e,r){const n=String(e.value),t=[],s=[];let a=0;for(;a<=n.length;){Ae.lastIndex=a;const l=Ae.exec(n),c=l&&"index"in l?l.index:n.length;t.push(qn(n.slice(a,c).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),a===0?r.breakBefore:!0,c===n.length?r.breakAfter:!0)),a=c+1}let i=-1,o;for(;++i<t.length;)t[i].charCodeAt(t[i].length-1)===8203||i<t.length-1&&t[i+1].charCodeAt(0)===8203?(s.push(t[i]),o=void 0):t[i]?(typeof o=="number"&&s.push(o),s.push(t[i]),o=0):(i===0||i===t.length-1)&&s.push(0);return s}function $n(e){return[String(e.value)]}function qn(e,r,n){const t=[];let s=0,a;for(;s<e.length;){Ee.lastIndex=s;const i=Ee.exec(e);a=i?i.index:e.length,!s&&!a&&i&&!r&&t.push(""),s!==a&&t.push(e.slice(s,a)),s=i?a+i[0].length:a}return s!==a&&!n&&t.push(""),t.join(" ")}function rt(e,r){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":r.whitespace;case"textarea":return"pre-wrap"}}return r.whitespace}function Wn(e){return!!(e.properties||{}).hidden}function Gn(e){return e.tagName==="td"||e.tagName==="th"}function Kn(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const Vn={},zn=[];function st(e){const r=e||Vn;return function(n,t){Jt(n,"element",function(s,a){const i=Array.isArray(s.properties.className)?s.properties.className:zn,o=i.includes("language-math"),l=i.includes("math-display"),c=i.includes("math-inline");let u=l;if(!o&&!l&&!c)return;let p=a[a.length-1],f=s;if(s.tagName==="code"&&o&&p&&p.type==="element"&&p.tagName==="pre"&&(f=p,p=a[a.length-2],u=!0),!p)return;const g=Bn(f,{whitespace:"pre"});let m;try{m=ye.renderToString(g,A(N({},r),{displayMode:u,throwOnError:!0}))}catch(h){const _=h,b=_.name.toLowerCase();t.message("Could not render math with KaTeX",{ancestors:[...a,s],cause:_,place:s.position,ruleId:b,source:"rehype-katex"}),b==="parseerror"?m=ye.renderToString(g,A(N({},r),{displayMode:u,strict:"ignore",throwOnError:!1})):m=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(r.errorColor||"#cc0000"),title:String(h)},children:[{type:"text",value:g}]}]}typeof m=="string"&&(m=Mn(m).children);const d=p.children.indexOf(f);return p.children.splice(d,1,...m),G})}}function Yn(e){pn(e,[/\r?\n|\r/g,Xn])}function Xn(){return{type:"break"}}function it(){return function(e){Yn(e)}}const ot="sandbox:";function Qn(e){const r=new URL(e).searchParams.get("se");if(!r)return!1;const n=Date.parse(r);return Number.isNaN(n)?!1:Date.now()>n}function Ls(s){var a=s,{messageId:e,conversation:r,href:n}=a,t=M(a,["messageId","conversation","href"]);const i=qt(),[o,l]=C.useState(!1),c=n.substring(ot.length),u=Ue(()=>r.serverId$()),p=Wt(),f=Et(),g=C.useCallback(_=>{const b=document.createElement("a");b.href=_,b.click(),l(!1)},[]),m=C.useCallback(_=>{l(!1),f.danger(_,{toastId:"file_download_failed"})},[f]),d=Zn(o,e,u,c,m,g).data,h=C.useCallback(async _=>{_.preventDefault();const b=(d==null?void 0:d.download_url)&&Qn(d.download_url);(d===void 0||(d==null?void 0:d.status)!=="success"||b)&&i.invalidateQueries({queryKey:at(e,c)}),(d==null?void 0:d.status)==="success"&&(d!=null&&d.download_url)&&!b?g(d.download_url):l(!0)},[d,i,e,c,g]);return w.jsx(Tt,{closeOnOutsideClick:!1,label:w.jsxs("span",{className:"flex items-center gap-1",children:[o?p.formatMessage(Le.startingDownload):p.formatMessage(Le.downloadFile),o&&w.jsx(vt,{})]}),side:"top",children:w.jsx("a",A(N({},t),{className:"cursor-pointer",onClick:_=>!o&&h(_)}))})}async function Jn(e,r,n){const t=await Rt.safeGet("/conversation/{conversation_id}/interpreter/download",{parameters:{path:{conversation_id:r},query:{message_id:e,sandbox_path:n}}});if(t.status===Dt.Success)return t;throw new je("Could not download file from advanced data analysis","error_code"in t?t.error_code:"unknown_error")}function Zn(e,r,n,t,s,a){const i=Lt();return Kt({queryKey:at(r,t),queryFn:()=>{if(n)return Jn(r,n,t).then(o=>((o==null?void 0:o.status)==="success"&&a(o.download_url),o)).catch(o=>{let l=i("default_download_link_error",{fileName:t});throw o instanceof je&&o.code!=null&&(l=i(o.code)),s==null||s(l),o})},enabled:!!(e&&r&&n&&t)})}function at(e,r){return["downloadSandboxLink",e,r]}const Le=Gt({downloadFile:{id:"SandboxDownload.downloadFile",defaultMessage:"Download file"},startingDownload:{id:"SandboxDownload.startingDownload",defaultMessage:"Starting download"}}),er="f",Rs="dr",lt=(e,r,n=!1)=>{const t=C.useRef(!1);C.useEffect(()=>{t.current||(t.current=!0,L.count(R.DEFAULT,"clickable_follow_up_text_shown"),n&&L.count(R.DEFAULT,"clickable_follow_up_deep_research_text_shown"),E.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",N({},Y({clientThreadId:e.id,messageId:r}))))},[e,r,n])},ct=({messageId:e,conversation:r,text:n})=>{const t=Ot.useStore(),s=$e(r.id);lt(r,e,!1);const a=C.useCallback(i=>{i.preventDefault(),L.count(R.DEFAULT,"clickable_follow_up_text_clicked"),E.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",Y({clientThreadId:r.id,messageId:e}));const o=t.getActiveSystemHintType();Zt({conversation:r,sourceEvent:i,promptMessage:Pt(n.toLowerCase(),{suggestion_type:Be.Reply}),completionMetadata:{systemHints:o?[o]:[],conversationMode:s!=null?s:{kind:It.PrimaryAssistant}}})},[r,s,e,t,n]);return w.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:a,children:n})},tr=({messageId:e,conversation:r,text:n})=>w.jsx(ct,{messageId:e,conversation:r,text:n}),Ds=Q.memo(tr),nr=({messageId:e,conversation:r,text:n})=>{const t=Mt(),{setThreadSystemHintMode:s}=en(),a=!!Ft(),i=$e(r.id);lt(r,e,!0);const o=C.useCallback(l=>{l.preventDefault(),L.count(R.DEFAULT,"clickable_follow_up_text_clicked"),L.count(R.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),E.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",Y({clientThreadId:r.id,messageId:e}));const c={clientThreadId:r.id};s(Ut.Research,!0,c);{const u=jt(t);u.focus(),Bt(u,n)}},[r,e,n,t,s,i]);return a?w.jsx(ct,{messageId:e,conversation:r,text:n}):w.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:[w.jsx(tn,{className:"icon me-1 inline-block"}),n]})},rr=({messageId:e,conversation:r,text:n})=>w.jsx(nr,{messageId:e,conversation:r,text:n}),Os=Q.memo(rr);function sr(){return e=>{k(e,{tagName:"table"},r=>{var s,a,i,o,l,c,u,p;const n=(i=(a=(s=r.children.find(f=>T(f,"thead")))==null?void 0:s.children.find(f=>T(f,"tr")))==null?void 0:a.children.filter(f=>T(f,"th")))!=null?i:[],t=(c=(l=(o=r.children.find(f=>T(f,"tbody")))==null?void 0:o.children.filter(f=>T(f,"tr")))==null?void 0:l.map(f=>f.children.filter(g=>T(g,"td"))))!=null?c:[];for(let f=0;f<n.length;f++){const g=n[f];let m=Re(g);for(let h=0;h<t.length;h++)m=Math.max(m,Re((u=t[h])==null?void 0:u[f]));const d=m>160?"xl":m>100?"lg":m>40?"md":"sm";g.properties["data-col-size"]=d;for(let h=0;h<t.length;h++)(p=t[h])!=null&&p[f]&&(t[h][f].properties["data-col-size"]=d)}})}}function T(e,r){return e.type==="element"&&e.tagName===r}function Re(e){let r=0;return e&&k(e,"text",n=>{r+=n.value.length}),r}const ir=new Set([bn,er]),Is=e=>e.startsWith(ot)||ir.has(e)||e.startsWith("tel:")||e.startsWith("sms:")?e:dn(e);function ut(){return e=>{k(e,"list",r=>{for(const n of r.children)n.spread=!0})}}function or(){return(e,r)=>{let n=0;const t=(s,a,i)=>{var c;const o=(c=s.data)!=null?c:s.data={};o.hName=O;const l=n++;o.hProperties=A(N({},a),{content:i,index:l})};k(e,(s,a,i)=>{var o,l,c,u,p,f,g;if(rn(s)){if(s.name!==O)return;const m=(l=(o=s.position)==null?void 0:o.start)==null?void 0:l.offset,d=(u=(c=s.position)==null?void 0:c.end)==null?void 0:u.offset;if(m==null||d==null)return;const h=gn(s),_=ar(s.attributes);t(s,_,h);return}if(sn(s)){if(a==null||i==null)return;const m=[[s.lang,s.meta].filter(Boolean).join(" "),(p=s.meta)!=null?p:"",(f=s.lang)!=null?f:""];let d=null;for(const b of m)if(b&&(d=on(b),d))break;if(!d&&m.some(b=>b.includes("{"))&&(d={}),!d)return;const h=(g=s.value)!=null?g:"",_={type:"containerDirective",name:O,attributes:d,children:[],position:s.position,data:s.data?N({},s.data):void 0};t(_,d,h),i.children[a]=_}})}}function ar(e){if(!e)return{};const r={};for(const[n,t]of Object.entries(e))typeof t=="string"&&(r[n]=t);return r}function Ps(e){return r=>{k(r,n=>{Object.defineProperties(n,{markdownSource:{get(){try{return e.slice(this.position.start.offset,this.position.end.offset)}catch(t){return""}}}})})}}const Ms=[[Z,{singleTilde:!1}],it,ut,[un,{singleDollarTextMath:!1}],J,or,Ge,Ke,...U?[U]:[],Ve,ft,pt];function ft(){return e=>{k(e,"textDirective",r=>{r.name!==X&&(r.type="text",r.value=":".concat(r.name))})}}const lr=/\u200b/g;function pt(){return e=>{k(e,"text",r=>{r.value=r.value.replace(lr,"")})}}function cr(){return e=>{var n;const r=(n=e.position)==null?void 0:n.end.offset;k(e,"element",(t,s)=>{var u;const{position:a}=t;if(!a)return;const{start:i,end:o}=a,l=i.offset,c=o.offset;(u=t.properties)!=null||(t.properties={}),l!=null&&(t.properties["data-start"]=l),c!=null&&(t.properties["data-end"]=c,r===c&&(t.properties["data-is-last-node"]=""),s===e.children.length-1&&(t.properties["data-is-only-node"]=""))})}}const Fs=[st,cr,sr,[nn,{target:"_new",rel:"noopener noreferrer"}],qe],ur=[[st,{output:"mathml"}],qe],ne=[[Z,{singleTilde:!1}],it,ut,J,Ge,Ke,...U?[U]:[],Ve,ft,pt],fr={blockquote:S,break:gr,code:x,definition:x,delete:S,emphasis:S,footnoteReference:x,footnoteDefinition:x,heading:hr,html:x,image:Oe,imageReference:Oe,inlineCode:Ie,list:S,listItem:S,link:S,linkReference:S,strong:S,table:x,tableCell:x,text:Ie,thematicBreak:x,toml:x,yaml:x},pr={},De=[];function dr(e){const r=N({},fr),n=e||pr,t=n.keep||De,s=n.remove||De;let a=-1;for(;++a<s.length;){const c=s[a];typeof c=="string"?r[c]=x:r[c[0]]=c[1]}let i={};if(t.length===0)i=r;else{let c;for(c in r)t.includes(c)||(i[c]=r[c]);for(a=-1;++a<t.length;)if(c=t[a],!Object.hasOwn(r,c))throw new Error("Unknown node type `"+c+"` in `keep`, use a replace tuple with a handle instead: `remove: [['"+c+"', handle]]`")}return function(c){return o(c)};function o(c){const u=c.type;let p=c;if(Object.hasOwn(i,u)){const f=i[u];f&&(p=f(p)||void 0)}return p=Array.isArray(p)?l(p):p,p&&"children"in p&&(p.children=l(p.children)),p}function l(c){let u=-1;const p=[];for(;++u<c.length;){const f=o(c[u]);Array.isArray(f)?p.push(...l(f)):f&&p.push(f)}return mr(p)}}function mr(e){let r=-1;const n=[];let t;for(;++r<e.length;){const s=e[r];t&&s.type===t.type&&"value"in s&&"value"in t?t.value+=s.value:(n.push(s),t=s)}return n}function Oe(e){const r="title"in e?e.title:"",n=e.alt||r||"";return n?{type:"text",value:n}:void 0}function Ie(e){return{type:"text",value:e.value}}function hr(e){return{type:"paragraph",children:e.children}}function S(e){return e.children}function gr(){return{type:"text",value:"\n"}}function x(){}function yr(e,r,n){const t=He(r);let s=!0;r&&typeof r=="object"&&"cascade"in r&&typeof r.cascade=="boolean"&&(s=r.cascade),a(e);function a(i,o,l){if(i!==e&&t(i,o,l))return!1;if("children"in i&&Array.isArray(i.children)){const c=i,u=c.children;let p=-1,f=0;if(u.length>0){for(;++p<u.length;)a(u[p],p,c)&&(u[f++]=u[p]);if(i!==e&&s&&!f)return!1;u.length=f}}return!0}}const _r=new Set([O,X,an,fn]),br=()=>e=>{yr(e,r=>We(r)&&_r.has(r.name))},wr=new RegExp("[\\u200B-\\u200D\\u2060\\uFEFF\\u00A0\\u202F\\u2000-\\u200A\\u3000\\u2028\\u2029]","gu");function Nr(e){const r=j().use(B).use(Z,{singleTilde:!1}).use(J).use(br).use(dr,{keep:["list","listItem"]}).use(ze,{bullet:"-",handlers:{text:n=>(n.value=n.value.replace(wr,""),n.value)}}).processSync(e);return String(r).trim()}const xr=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],Pe={}.hasOwnProperty;function Cr(e,r){const n=r||{};function t(s,...a){let i=t.invalid;const o=t.handlers;if(s&&Pe.call(s,e)){const l=String(s[e]);i=Pe.call(o,l)?o[l]:t.unknown}if(i)return i.call(this,s,...a)}return t.handlers=n.handlers||{},t.invalid=n.invalid,t.unknown=n.unknown,t}const kr=/^>|^->|<!--|-->|--!>|<!-$/g,Sr=[">"],Ar=["<",">"];function Er(e,r,n,t){return t.settings.bogusComments?"<?"+v(e.value,Object.assign({},t.settings.characterReferences,{subset:Sr}))+">":"<!--"+e.value.replace(kr,s)+"-->";function s(a){return v(a,Object.assign({},t.settings.characterReferences,{subset:Ar}))}}function Tr(e,r,n,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}const y=mt(1),dt=mt(-1),vr=[];function mt(e){return r;function r(n,t,s){const a=n?n.children:vr;let i=(t||0)+e,o=a[i];if(!s)for(;o&&te(o);)i+=e,o=a[i];return o}}const Lr={}.hasOwnProperty;function ht(e){return r;function r(n,t,s){return Lr.call(e,n.tagName)&&e[n.tagName](n,t,s)}}const re=ht({body:Dr,caption:W,colgroup:W,dd:Mr,dt:Pr,head:W,html:Rr,li:Ir,optgroup:Fr,option:Ur,p:Or,rp:Me,rt:Me,tbody:Br,td:Fe,tfoot:Hr,th:Fe,thead:jr,tr:$r});function W(e,r,n){const t=y(n,r,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&te(t.value.charAt(0)))}function Rr(e,r,n){const t=y(n,r);return!t||t.type!=="comment"}function Dr(e,r,n){const t=y(n,r);return!t||t.type!=="comment"}function Or(e,r,n){const t=y(n,r);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function Ir(e,r,n){const t=y(n,r);return!t||t.type==="element"&&t.tagName==="li"}function Pr(e,r,n){const t=y(n,r);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function Mr(e,r,n){const t=y(n,r);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function Me(e,r,n){const t=y(n,r);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function Fr(e,r,n){const t=y(n,r);return!t||t.type==="element"&&t.tagName==="optgroup"}function Ur(e,r,n){const t=y(n,r);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function jr(e,r,n){const t=y(n,r);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function Br(e,r,n){const t=y(n,r);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function Hr(e,r,n){return!y(n,r)}function $r(e,r,n){const t=y(n,r);return!t||t.type==="element"&&t.tagName==="tr"}function Fe(e,r,n){const t=y(n,r);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const qr=ht({body:Kr,colgroup:Vr,head:Gr,html:Wr,tbody:zr});function Wr(e){const r=y(e,-1);return!r||r.type!=="comment"}function Gr(e){const r=new Set;for(const t of e.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(r.has(t.tagName))return!1;r.add(t.tagName)}const n=e.children[0];return!n||n.type==="element"}function Kr(e){const r=y(e,-1,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&te(r.value.charAt(0)))&&!(r.type==="element"&&(r.tagName==="meta"||r.tagName==="link"||r.tagName==="script"||r.tagName==="style"||r.tagName==="template"))}function Vr(e,r,n){const t=dt(n,r),s=y(e,-1,!0);return n&&t&&t.type==="element"&&t.tagName==="colgroup"&&re(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function zr(e,r,n){const t=dt(n,r),s=y(e,-1);return n&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&re(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const F={name:[["	\n\f\r &/=>".split(""),"	\n\f\r \"&'/=>`".split("")],["\0	\n\f\r \"&'/<=>".split(""),"\0	\n\f\r \"&'/<=>`".split("")]],unquoted:[["	\n\f\r &>".split(""),"\0	\n\f\r \"&'<=>`".split("")],["\0	\n\f\r \"&'<=>`".split(""),"\0	\n\f\r \"&'<=>`".split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Yr(e,r,n,t){const s=t.schema,a=s.space==="svg"?!1:t.settings.omitOptionalTags;let i=s.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(e.tagName.toLowerCase());const o=[];let l;s.space==="html"&&e.tagName==="svg"&&(t.schema=ee);const c=Xr(t,e.properties),u=t.all(s.space==="html"&&e.tagName==="template"?e.content:e);return t.schema=s,u&&(i=!1),(c||!a||!qr(e,r,n))&&(o.push("<",e.tagName,c?" "+c:""),i&&(s.space==="svg"||t.settings.closeSelfClosing)&&(l=c.charAt(c.length-1),(!t.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&o.push(" "),o.push("/")),o.push(">")),o.push(u),!i&&(!a||!re(e,r,n))&&o.push("</"+e.tagName+">"),o.join("")}function Xr(e,r){const n=[];let t=-1,s;if(r){for(s in r)if(r[s]!==null&&r[s]!==void 0){const a=Qr(e,s,r[s]);a&&n.push(a)}}for(;++t<n.length;){const a=e.settings.tightAttributes?n[t].charAt(n[t].length-1):void 0;t!==n.length-1&&a!=='"'&&a!=="'"&&(n[t]+=" ")}return n.join("")}function Qr(e,r,n){const t=Ye(e.schema,r),s=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,a=e.settings.allowDangerousCharacters?0:1;let i=e.quote,o;if(t.overloadedBoolean&&(n===t.attribute||n==="")?n=!0:(t.boolean||t.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const l=v(t.attribute,Object.assign({},e.settings.characterReferences,{subset:F.name[s][a]}));return n===!0||(n=Array.isArray(n)?(t.commaSeparated?mn:ln)(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?l:(e.settings.preferUnquoted&&(o=v(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:F.unquoted[s][a]}))),o!==n&&(e.settings.quoteSmart&&me(n,i)>me(n,e.alternative)&&(i=e.alternative),o=i+v(n,Object.assign({},e.settings.characterReferences,{subset:(i==="'"?F.single:F.double)[s][a],attribute:!0}))+i),l+(o&&"="+o))}const Jr=["<","&"];function gt(e,r,n,t){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?e.value:v(e.value,Object.assign({},t.settings.characterReferences,{subset:Jr}))}function Zr(e,r,n,t){return t.settings.allowDangerousHtml?e.value:gt(e,r,n,t)}function es(e,r,n,t){return t.all(e)}const ts=Cr("type",{invalid:ns,unknown:rs,handlers:{comment:Er,doctype:Tr,element:Yr,raw:Zr,root:es,text:gt}});function ns(e){throw new Error("Expected node, not `"+e+"`")}function rs(e){const r=e;throw new Error("Cannot compile unknown node `"+r.type+"`")}const ss={},is={},os=[];function as(e,r){const n=r||ss,t=n.quote||'"',s=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:ls,all:cs,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||xr,characterReferences:n.characterReferences||is,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?ee:Xe,quote:t,alternative:s}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function ls(e,r,n){return ts(e,r,n,this)}function cs(e){const r=[],n=e&&e.children||os;let t=-1;for(;++t<n.length;)r[t]=this.one(n[t],t,e);return r.join("")}function us(e){const r=this,n=N(N({},r.data("settings")),e);r.compiler=t;function t(s){return as(s,n)}}function fs(e,r){const n=Ht(e,r);return Nr(yt(n,r))}function yt(e,r){return j().use(B).use(ne).use([[se,r!=null?r:[]]]).use(ze,{rule:"-",tightDefinitions:!0,handlers:{text:t=>(t.value=t.value.replaceAll("\\[","["),t.value),break:()=>"\n",link:ds}}).processSync(e).toString()}function ps(e,r){return j().use(B).use(ne).use([[se,r!=null?r:[]]]).use(hn).use(ur).use(us).processSync(e).toString()}const ds=(e,r,n,t)=>{const s=n.createTracker(t),a=n.enter("link"),i=n.enter("label");let o=s.move("[");return o+=s.move(n.containerPhrasing(e,N({before:o,after:"]("},s.current()))),o+=s.move("]("),i(),o+=s.move(e.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,ms)),e.title&&(o+=s.move(" "+JSON.stringify(e.title))),o+=s.move(")"),a(),o};function ms(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}const hs=j().use(B).use(ne).freeze();function se(e){return r=>{const n={},t=(s,a)=>{var i;switch(a.type){case"grouped_webpages":{const o=[];for(const l of a.items)if(l.url&&l.title){let c=n[l.url];c||(c=n[l.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:l.url,title:l.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:(i=l.attribution)!=null?i:cn(l.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((l,c,u)=>c<u.length-1?[l,{type:"text",value:", "}]:[l]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"map":case"tldr":case"navigation":case"stock":case"calculator":case"python":case"container":case"code_execution":case"forecast":case"businesses_map":case"entity_metadata":case"video":case"entity":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"checkout_confirmation":case"image_inline":case"image_group":case"product_entity":case"products":case"product":case"alt_text":case"product_reviews":case"product_rationale":case"dil":case"link_title":case"strix":if(a.alt){const o=hs.parse(a.alt);if(s.type!=="textDirective")return o.children;const l=o.children[0];if(l.type==="paragraph")return l.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};k(r,We,(s,a,i)=>{var c;if(i==null||a==null)return;if(s.type==="containerDirective"&&s.name===O){const u=Array.isArray(s.children)?s.children:[];return i.children.splice(a,1,...u),[G,a]}const o=gs(s,e),l=o?(c=t(s,o))!=null?c:[s]:[];return i.children.splice(a,1,...l),[G,a+l.length]}),r.children.push(...Object.values(n))}}function gs(e,r){var n;if(e.name===X){const t=(n=e.attributes)==null?void 0:n.index;if(t)return r[parseInt(t,10)]}}const Us=Object.freeze(Object.defineProperty({__proto__:null,markdownWithContentReferenceDirectivesToHTML:ps,markdownWithContentReferenceDirectivesToMarkdown:yt,messageTextToPlaintext:fs,replaceContentReferenceDirectivesWithMarkdown:se},Symbol.toStringTag,{value:"Module"}));export{er as C,bn as I,_n as M,Ms as R,ot as S,ps as a,Nr as b,se as c,br as d,pt as e,Fs as f,Ls as g,vs as h,Ds as i,Rs as j,Os as k,Ps as l,yt as m,Us as n,it as r,Is as u};
//# sourceMappingURL=kcex4rnzaebpwef1.js.map

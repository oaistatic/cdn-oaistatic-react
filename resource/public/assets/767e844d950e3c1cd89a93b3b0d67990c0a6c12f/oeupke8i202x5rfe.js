const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/8hzrd0lzhr5cygxm.js","assets/mw35uwhq4g8r9eam.js","assets/g2euln7v5pbm31qa.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/conversation-small-lq38g8zw.css","assets/ojmli062couj7r3v.js","assets/lv7ytt0l14b17ows.js","assets/mk0onprac2zx1h6t.js","assets/dzciepzlrexlt6ar.js","assets/tffc42bs0etu9v3l.js","assets/eg4jvzq610bzilv3.js","assets/oq8bsh1t4vyck4xl.js","assets/g6gtv3p57f0esi65.js","assets/dbnl40ahcmx1rqbw.js","assets/j723eutw6lfomm01.js","assets/gl4f6lge29au0ljx.js","assets/iio0zgk2sqlxbcjy.js","assets/obpubb7ugisfu36u.js","assets/c340ncgh31fwqkpk.js","assets/of0vtq1gcmd3mc3z.js","assets/ggvjblnzoirafiyl.js","assets/kc32gem4l2t3hnxt.js","assets/5uqv5sdajcdsdc3v.js","assets/kne35xckmmfq3xx6.js","assets/kl0a548ohmz3fby2.js","assets/fe4yarxdk4eko5w6.js","assets/kubdgxu3crk3gqem.js","assets/jc1wlz3ym1r6tf2l.js","assets/dhyn0hpw8j3dzdrv.js","assets/kubovzlwgxdy8km7.js","assets/ffo9fz3385kae4ff.js","assets/jds242fqj1w4n5ig.js"])))=>i.map(i=>d[i]);
var De=Object.defineProperty,Te=Object.defineProperties;var Ee=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var pe=(s,t,a)=>t in s?De(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))je.call(t,a)&&pe(s,a,t[a]);if(se)for(var a of se(t))Me.call(t,a)&&pe(s,a,t[a]);return s},I=(s,t)=>Te(s,Ee(t));var K=(s,t)=>{var a={};for(var n in s)je.call(s,n)&&t.indexOf(n)<0&&(a[n]=s[n]);if(s!=null&&se)for(var n of se(s))t.indexOf(n)<0&&Me.call(s,n)&&(a[n]=s[n]);return a};import{b as Z,h as y,u as Y,i as F,e as q,j as e,d as Ne,r as M,_ as Ce,M as j,k as Fe,y as Le}from"./mw35uwhq4g8r9eam.js";import{p as L,R as U,h7 as _e,wS as X,cF as ce,u as ee,u2 as Re,J as Be,er as H,e4 as Ve,hg as ve,h2 as We,dk as W,be as Pe,e as He,dz as Oe,bq as we,wQ as Ge,aB as $e,dp as be,ug as Ke,f7 as v,fJ as z,cw as Ue,aA as ae,L as de,e7 as ke,a7 as Qe,fK as ze,cd as Je,eS as Ze,mk as Ye}from"./d0xa318sl7ywi0za.js";import{b$ as Xe,fE as es,e6 as ss,bB as ts,B as as,lv as ye,bd as m,lu as me,be as rs,aE as ns,lt as ue,at as is,f8 as ls,b_ as os,bZ as cs,bb as ds}from"./g2euln7v5pbm31qa.js";import{k as ne,j as ie,l as le,m as ms}from"./ojmli062couj7r3v.js";import{m as Ie}from"./mk0onprac2zx1h6t.js";import{G as us}from"./dzciepzlrexlt6ar.js";import{i as gs,R as xs}from"./eg4jvzq610bzilv3.js";import{T as hs,a as fs}from"./oq8bsh1t4vyck4xl.js";import{a as ps,c as js}from"./g6gtv3p57f0esi65.js";import{u as Ms}from"./jds242fqj1w4n5ig.js";const $=25;function vs(s,t,a){return Z({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await U.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:t,limit:$,query:a}}})})}function Se(s,t,a){return Z({queryKey:["workspace",s,"invites","requests",t,a],queryFn:()=>U.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:t,limit:$,query:a}}})})}function Ae(s){const t=y(),a=L(),n=Y();return F({mutationFn:({inviteId:r,role:i,acceptRequest:l})=>U.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:r}},requestBody:{role:i,accept_request:l}}).catch(o=>{throw a.danger(t.formatMessage(A.updateInviteError,{error:o.message}),{loggingTitle:A.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),o}),onSuccess:(r,i)=>{if(i.acceptRequest)n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{var d;if(!l)return l;const o=l.items.filter(u=>u.id!==i.inviteId),c=Math.max(0,((d=l.total)!=null?d:0)-1);return I(x({},l),{items:o,total:c})});else if(i.role){const l=i.role;n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{if(!o)return o;const c=o.items.map(d=>d.id===i.inviteId?I(x({},d),{role:l}):d);return I(x({},o),{items:c})})}}})}function qe(s){const t=y(),a=L(),n=Y();return F({mutationFn:({email:r})=>U.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:r}}).catch(i=>{throw a.danger(t.formatMessage(A.deleteInviteError,{email:r,error:i.message}),{loggingTitle:A.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),i}),onSuccess:(r,{email:i})=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{var d;if(!l)return l;const o=l.items.filter(u=>u.email_address!==i),c=Math.max(0,((d=l.total)!=null?d:0)-1);return I(x({},l),{items:o,total:c})})}})}function bs(s){const t=y(),a=L(),n=Y();return F({mutationFn:()=>U.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(r=>{throw a.danger(t.formatMessage(A.acceptAllInviteRequestsError,{error:r.message}),{loggingTitle:A.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),r}),onSuccess:()=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},r=>r&&I(x({},r),{items:[],total:0}))}})}function ys(s){const t=y(),a=L(),n=Y();return F({mutationFn:({role:r,email:i})=>U.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[i],role:r,resend_emails:!0}}).then(({account_invites:l,errored_emails:o})=>{if(o.length>0)throw new Error(o[0].error);l.length>0&&a.success(t.formatMessage(A.resendInviteSuccess,{email:i}))}).catch(l=>{a.danger(t.formatMessage(A.resendInviteError,{email:i,error:l.message}),{loggingTitle:A.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["workspace",s,"invites"]}),n.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const A=q({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),ge=({userName:s,isScimManaged:t,dotted:a=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(_e,{user:{name:s,picture:null},size:"default",dotted:a}),t&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(Xe,{width:10,height:10})})]}),w=q({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}}),Ns=n=>{var r=n,{children:s,ref:t}=r,a=K(r,["children","ref"]);return e.jsx(X.Root,I(x({license:"commercial",sheetRole:"dialog"},a),{ref:t,children:s}))},Cs=i=>{var l=i,{children:s,ref:t,className:a,contentPlacement:n="left"}=l,r=K(l,["children","ref","className","contentPlacement"]);return e.jsx(X.View,I(x({className:ce("z-1",a),contentPlacement:n,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0},r),{ref:t,children:s}))},_s=n=>{var r=n,{className:s,ref:t}=r,a=K(r,["className","ref"]);return e.jsx(X.Backdrop,I(x({className:s},a),{ref:t}))},Rs=r=>{var i=r,{children:s,ref:t,className:a}=i,n=K(i,["children","ref","className"]);return e.jsx(X.Content,I(x({className:ce("bg-token-bg-primary box-border shadow-lg",a)},n),{ref:t,children:s}))},Ps=X.Portal,Q={Root:Ns,Portal:Ps,View:Cs,Backdrop:_s,Content:Rs},ws=({workspaceId:s,userId:t})=>Z({queryKey:[s,t,"user-roles"],queryFn:async()=>(await U.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s,consistency:"strong"},path:{workspace_id:s,principal_id:t}}})).roles}),Us=({workspaceId:s,userId:t})=>Z({queryKey:[s,t,"user-groups"],queryFn:async()=>(await U.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:t}}})).items}),ks=({workspaceId:s,userId:t,enabled:a=!0})=>Z({enabled:a,queryKey:[s,t,"user-credit-limit"],queryFn:async()=>await U.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/credit-limit",{parameters:{query:{account_id:s,consistency:"strong"},path:{workspace_id:s,principal_id:t}}})}),Is=({workspaceId:s,user:t,onClose:a})=>{var D;const n=ee(),r=y(),i=Ne(),l=Re(n),o=Be(n,"1261424157"),c=l&&o,{data:d,refetch:u,isFetching:g}=ws({workspaceId:s,userId:t.id}),h=M.useMemo(()=>d==null?void 0:d.filter(f=>!f.predefined_role),[d]),{data:p,refetch:R,isFetching:N}=Us({workspaceId:s,userId:t.account_user_id}),{data:C,isFetching:b,refetch:B}=ks({workspaceId:s,userId:t.id,enabled:c}),V=M.useCallback(async()=>{const f=[];f.push(R()),f.push(u()),c&&f.push(B()),await Promise.allSettled(f)},[c,B,R,u]),T=g||N||c&&b,S=f=>(f==null?void 0:f.limit)==null?r.formatMessage(P.creditLimitNotSet):r.formatMessage(P.creditsPerWeek,{value:r.formatNumber(f.limit)});return e.jsx(Q.Root,{presented:!0,defaultPresented:!0,onPresentedChange:a,children:e.jsx(Q.Portal,{children:e.jsxs(Q.View,{contentPlacement:"right",children:[e.jsx(Q.Backdrop,{}),e.jsxs(Q.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>void V(),className:"hover:bg-token-surface-hover dark:hover:bg-token-main-surface-tertiary keyboard-focused:bg-token-surface-hover flex h-9 w-9 items-center justify-center rounded-lg disabled:cursor-not-allowed disabled:opacity-60","aria-label":r.formatMessage(P.refresh),title:r.formatMessage(P.refresh),disabled:T,children:T?e.jsx(H,{className:"icon"}):e.jsx(es,{className:"icon"})}),e.jsx(Ve,{onClick:a,iconSize:"lg",autoFocus:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(_e,{user:{name:(D=t.name)!=null?D:"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:t.name}),e.jsx("div",{children:t.email})]})]}),e.jsx("hr",{className:"my-2.5"}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:r.formatMessage(P.groups)}),N&&e.jsx(H,{}),!N&&e.jsxs(e.Fragment,{children:[(p==null?void 0:p.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:r.formatMessage(P.noGroups)}),p==null?void 0:p.map(f=>e.jsx(ve,{className:"mx-0",as:"button",onClick:()=>i("/admin/groups/".concat(f.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(us,{group:f})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:f.name}),gs(f)&&e.jsx(xs,{})]})]})})},f.id))]})]}),e.jsx("hr",{className:"my-2.5"})]}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:r.formatMessage(P.customRoles)}),g&&e.jsx(H,{}),!g&&e.jsxs(e.Fragment,{children:[(h==null?void 0:h.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:r.formatMessage(P.noCustomRoles)}),h==null?void 0:h.map(f=>e.jsx(ve,{className:"mx-0",as:"button",onClick:()=>i("/admin/permissions/roles/".concat(f.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:f.predefined_role?e.jsx(ss,{className:"icon"}):e.jsx(We,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:f.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:f.description})]})]})})},f.id))]})]})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2.5"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:r.formatMessage(P.creditLimit)}),b&&e.jsx(H,{}),!b&&C&&!C.has_credit_limit&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:r.formatMessage(P.noCreditLimit)}),!b&&(C==null?void 0:C.has_credit_limit)&&e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 italic",children:[e.jsx("span",{className:"text-token-text-tertiary",children:r.formatMessage(P.alertCreditLimit)}),e.jsx("span",{children:S(C.soft_alert_credit_limit)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 italic",children:[e.jsx("span",{className:"text-token-text-tertiary",children:r.formatMessage(P.hardCapCreditLimit)}),e.jsx("span",{children:S(C.hard_cap_credit_limit)})]})]})]})]})]})]})]})})})},P=q({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"},refresh:{id:"RYOenw",defaultMessage:"Refresh"},creditLimit:{id:"K9xPUM",defaultMessage:"Usage limit"},noCreditLimit:{id:"lQKMD4",defaultMessage:"No credit limit"},alertCreditLimit:{id:"hTB/Lx",defaultMessage:"Alert"},hardCapCreditLimit:{id:"/JWyZZ",defaultMessage:"Hard cap"},creditsPerWeek:{id:"k/1C9U",defaultMessage:"{value} credits/week"},creditLimitNotSet:{id:"UJtBId",defaultMessage:"None"}});function xe({currentRole:s,onUpdateUserRole:t,disabled:a=!1}){const n=ne();return e.jsx(ts,{disabled:a,defaultValue:s,onValueChange:r=>{t(r)},triggerClassName:"text-base",options:[{label:n[W.STANDARD],value:W.STANDARD},{label:n[W.ADMIN],value:W.ADMIN},{label:n[W.OWNER],value:W.OWNER}]})}const Ss=Pe(()=>Ce(()=>import("./8hzrd0lzhr5cygxm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>s.ConfirmLogoutModal)),J=He(()=>({confirmModalUserData:null})),re={openModalForUser:s=>{J.setState({confirmModalUserData:s})},closeModal:()=>{J.setState({confirmModalUserData:null})}};function As({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var f;const n=ee(),[r,i]=M.useState(0),l=Oe(),[o,c]=M.useState(),d=Re(n),u=l==null?void 0:l.id,g=ie(s),h=le(s),p=g||h,R=Es(),N=Ls(s),C=Fs(s),{data:b}=as(s,r*ye,t);M.useEffect(()=>{i(0)},[t]);const B=M.useCallback(_=>{re.openModalForUser(_)},[]),V=M.useCallback(()=>{var k;const _=(k=J.getState().confirmModalUserData)==null?void 0:k.id;_!==void 0&&N.mutate({userId:_}),re.closeModal(),c(void 0)},[N]),T=M.useCallback((_,k)=>{a||R.mutate({userId:_,value:k,workspaceId:s})},[a,R,s]);if(b===void 0)return e.jsx(he,{});const S=b.items,D=Math.ceil(((f=b.total)!=null?f:0)/ye);return r>=D&&D!==0&&i(Math.max(D-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),p&&e.jsx("col",{className:"w-16"})]}),e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{children:e.jsx(j,x({},w.name))}),e.jsx(m.HeaderCell,{children:e.jsx("span",{className:g?"ps-3":"",children:e.jsx(j,x({},w.accountType))})}),e.jsx(m.HeaderCell,{children:e.jsx(j,x({},w.dateAdded))}),p&&e.jsx(m.HeaderCell,{className:"w-16"})]}),e.jsxs(m.Body,{children:[S.map(_=>e.jsx(Ds,{isCurrentUser:u!==void 0&&_.id===u,user:_,currentUserHasAdminRights:p,isCurrentUserOwner:g,onRemoveUserClick:()=>{var k,fe;return B({id:_.id,name:(k=_.name)!=null?k:"",email:(fe=_.email)!=null?fe:"",created_time:_.created_time})},onUpdateUserRole:T,onLogoutUser:async k=>{await C.mutateAsync({userId:k})},roleEditingDisabled:a,onClick:d?k=>c(k):void 0},_.id)),S.length===0&&e.jsx(m.Row,{className:"[&>td]:py-2",children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(j,x({},w.noResults))})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:D>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(me,{currentPage:r,onChangeIndex:i,length:D})})}),o&&e.jsx(Is,{workspaceId:s,user:o,onClose:()=>c(void 0)}),e.jsx(qs,{onDeleteConfirm:V})]})}function qs({onDeleteConfirm:s}){var r;const t=y(),a=J(i=>i.confirmModalUserData!==null),n=J(i=>i.confirmModalUserData===null?{}:{userId:i.confirmModalUserData.id,email:i.confirmModalUserData.email,name:i.confirmModalUserData.name,dateAdded:Ge(i.confirmModalUserData.created_time)});return e.jsx($e,{testId:"modal-remove-member",isOpen:a,title:t.formatMessage(w.removeMemberModalTitle),onClose:()=>re.closeModal(),type:"success",primaryButton:e.jsx(be.Button,{title:t.formatMessage(w.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(be.Button,{title:t.formatMessage(w.removeMemberModalCancel),color:"secondary",onClick:()=>re.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(r=n.name)!=null?r:n.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(j,I(x({},w.dateJoined),{values:{dateAdded:t.formatDate(n.dateAdded,{year:"numeric",month:"long",day:"numeric"})}}))})]})})}function Ds({user:s,currentUserHasAdminRights:t,isCurrentUserOwner:a,isCurrentUser:n,onRemoveUserClick:r,onUpdateUserRole:i,onLogoutUser:l,roleEditingDisabled:o,onClick:c}){var R;const u=ne()[s.role],g=y(),h=(R=s.name)!=null?R:g.formatMessage(w.missingName),p=ee();return e.jsxs(m.Row,{className:ce("[&>td]:py-2"),onClick:c?()=>c==null?void 0:c(s):void 0,children:[e.jsxs(m.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(ge,{userName:h,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[h,n&&e.jsx("span",{className:"ms-1",children:e.jsx(j,x({},w.youSpecifier))})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:s.role,onUpdateUserRole:N=>{i(s.id,N)},disabled:n||o}):u}),e.jsx(m.Cell,{children:g.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),t&&e.jsx(m.Cell,{children:e.jsx(Ts,{userId:s.id,onRemoveUserClick:r,onLogoutUserClick:()=>{we(p,Ss,{onConfirm:()=>l(s.id)})},isCurrentUser:n,isScimManaged:s.is_scim_managed})})]})}function Ts({isCurrentUser:s,onRemoveUserClick:t,onLogoutUserClick:a,userId:n,isScimManaged:r}){const i=ee(),l=y(),o=Ke(i),c=e.jsx(v.Item,{onClick:r?void 0:d=>{d.stopPropagation(),t(n)},color:"danger",icon:e.jsx(rs,{}),disabled:r,children:e.jsx(j,x({},w.removeMemberModalTitle))});return s?null:e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{className:"-my-2",children:e.jsx(z,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{size:"small",children:[o&&e.jsx(v.Item,{onClick:d=>{d.stopPropagation(),a(n)},icon:e.jsx(ns,{}),children:e.jsx(j,x({},w.logoutMember))}),r?e.jsx(Ue,{label:l.formatMessage(Ie.managedViaSCIMTooltip),className:"flex",side:"right",children:c}):c]})})]})}function Es(){const s=L();return F({mutationFn:({userId:t,workspaceId:a,value:n})=>U.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:a,user_id:t}},requestBody:{role:n}}).catch(r=>{s.danger("Unable to update user (".concat(t,") role: ").concat(r.message),{toastId:"user_manager_table"})})})}function Fs(s){const t=L();return F({mutationFn:({userId:a})=>U.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:a}}}),onError:(a,n)=>{t.danger("Unable to logout user (".concat(n.userId,") from workspace"),{toastId:"user_manager_table"})},onSuccess:()=>{t.success("User logged out of all sessions",{id:"user_logout_success"})}})}function Ls(s){const t=Y(),a=L();return F({mutationFn:({userId:n})=>U.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:n}}}).catch(r=>{a.danger("Unable to remove user (".concat(n,") from workspace: ").concat(r.message),{toastId:"user_manager_table"})}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s]})}})}function he(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(H,{})})}function Bs({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var h;const[n,r]=M.useState(0),{data:i}=Se(s,n*$,t),l=ie(s),o=le(s),c=y(),d=l||o;if(i===void 0)return e.jsx(he,{});const u=i.items,g=Math.ceil(((h=i.total)!=null?h:0)/$);return n>=g&&g!==0&&r(Math.max(g-1,0)),e.jsxs("div",{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(j,x({},O.email))}),e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:d?"ps-3":"",children:e.jsx(j,x({},O.role))})}),d&&e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:c.formatMessage(O.actions)})]}),e.jsxs(m.Body,{children:[u.map(p=>e.jsx(Vs,{workspaceId:s,invite:p,isCurrentUserOwner:l,currentUserHasAdminRights:d,isRoleEditingDisabled:a},p.id)),u.length===0&&e.jsx(m.Row,{children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(j,x({},O.noResults))})})})]})]}),g>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:n,onChangeIndex:r,length:g})})]})}function Vs({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n,isRoleEditingDisabled:r}){var d;const i=ne(),l=Ae(s),o=qe(s),c=y();return e.jsxs(m.Row,{className:"[&>td]:py-2",disabled:l.isPending||o.isPending||o.isPending,children:[e.jsx(m.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(d=t.email_address)!=null?d:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:u=>{r||l.mutate({inviteId:t.id,role:u})},disabled:r}):i[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(m.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{color:"secondary",onClick:()=>l.mutate({inviteId:t.id,acceptRequest:!0}),children:c.formatMessage(O.accept)}),e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{disabled:t.is_scim_managed,children:e.jsx(z,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsx(v.Content,{children:e.jsx(v.Item,{color:"danger",onClick:()=>{var u;return o.mutate({email:(u=t.email_address)!=null?u:""})},children:c.formatMessage(O.reject)})})})]})]})})})]})}const O=q({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),Ws=({workspaceId:s,isRoleEditingDisabled:t=!1})=>{var N,C;const a=y(),n=ie(s),r=le(s),i=n||r,l=bs(s),[o,c]=M.useState(""),[d,u]=M.useState(""),g=M.useMemo(()=>de(b=>u(b),300,{leading:!1,trailing:!0}),[]),{data:h}=Se(s,0,d),p=(N=h==null?void 0:h.total)!=null?N:0,R=p?a.formatMessage(oe.acceptAllWithCount,{count:p}):a.formatMessage(oe.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ue,{value:o,onChange:b=>{c(b.target.value),g(b.target.value)},placeholder:a.formatMessage(oe.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),i&&e.jsx(ae,{loading:l.isPending,disabled:((C=h==null?void 0:h.total)!=null?C:0)===0,onClick:()=>l.mutate(),children:R})]}),e.jsx(Bs,{workspaceId:s,filterInputValue:d,isRoleEditingDisabled:t})]})},oe=q({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}});function Hs({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var g;const[n,r]=M.useState(0),i=ie(s),l=le(s),o=i||l,{data:c}=vs(s,n*$,t);if(c===void 0)return e.jsx(he,{});const d=c.items,u=Math.ceil(((g=c.total)!=null?g:0)/$);return n>=u&&u!==0&&r(Math.max(u-1,0)),e.jsxs("div",{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),o&&e.jsx("col",{className:"w-16"})]}),e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(j,x({},G.email))}),e.jsx(m.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(j,x({},G.invitedDate))}),e.jsx(m.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:o?"ps-3":"",children:e.jsx(j,x({},G.role))})}),o&&e.jsx(m.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(m.Body,{children:[d.map(h=>e.jsx(Os,{workspaceId:s,invite:h,isCurrentUserOwner:i,currentUserHasAdminRights:o,isRoleEditingDisabled:a},h.id)),d.length===0&&e.jsx(m.Row,{children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(j,x({},G.noResults))})})})]})]}),u>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:n,onChangeIndex:r,length:u})})]})}function Os({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n,isRoleEditingDisabled:r}){var u;const i=y(),l=ne(),o=Ae(s),c=qe(s),d=ys(s);return e.jsxs(m.Row,{className:"[&>td]:py-2",disabled:o.isPending||c.isPending||c.isSuccess||d.isPending,children:[e.jsx(m.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(u=t.email_address)!=null?u:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(m.Cell,{children:i.formatDate(t.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:g=>{r||o.mutate({inviteId:t.id,role:g})},disabled:r}):l[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(m.Cell,{children:e.jsx(Gs,{onDeleteUser:()=>{var g;c.mutate({email:(g=t.email_address)!=null?g:""})},onResendInvite:()=>{var g,h;d.mutate({email:(g=t.email_address)!=null?g:"",role:(h=t.role)!=null?h:""})},disabled:t.is_scim_managed})})})]})}function Gs({onDeleteUser:s,onResendInvite:t,disabled:a}){const n=y();return e.jsx(e.Fragment,{children:a?e.jsx(v.Root,{children:e.jsx(v.Trigger,{disabled:!0,children:e.jsx(Ue,{label:n.formatMessage(Ie.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(z,{className:"icon-sm"})})})}):e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{children:e.jsx(z,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{children:[e.jsx(v.Item,{onClick:t,children:e.jsx(j,x({},G.resendInvite))}),e.jsx(v.Item,{onClick:s,children:e.jsx(j,x({},G.revokeInvite))})]})})]})})}const G=q({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),$s=({workspaceId:s,isRoleEditingDisabled:t=!1})=>{const a=y(),[n,r]=M.useState(""),[i,l]=M.useState(""),o=M.useMemo(()=>de(c=>l(c),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(ue,{value:n,onChange:c=>{r(c.target.value),o(c.target.value)},placeholder:a.formatMessage(Ks.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Hs,{workspaceId:s,filterInputValue:i,isRoleEditingDisabled:t})]})},Ks=q({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}}),Qs=Pe(()=>Ce(()=>import("./g2euln7v5pbm31qa.js").then(s=>s.Do),__vite__mapDeps([2,1,3,4,5])).then(s=>s.AdminInviteModal));function zs({workspaceId:s,isRoleEditingDisabled:t=!1}){const a=ee(),n=y(),r=ke(),[i,l]=M.useState(""),[o,c]=M.useState(""),d=M.useMemo(()=>de(p=>c(p),300,{leading:!1,trailing:!0}),[]);if(!r)return null;const u=r==null?void 0:r.isSelfServeBusiness(),g=r.isAdminOfAccount(),h=r.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(ue,{value:i,onChange:p=>{l(p.target.value),d(p.target.value)},placeholder:n.formatMessage(te.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(g||h||u)&&e.jsx(ae,{onClick:()=>{Qe.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),we(a,Qs,{workspace:r})},icon:is,children:e.jsx(j,x({},te.inviteMemberButton))}),u?e.jsx(ze,{triggerButton:e.jsx(ae,{color:"secondary",icon:z}),children:e.jsx(v.Item,{onClick:()=>{r&&Je.setLeaveWorkspaceData(r)},children:e.jsx(j,x({},te.leaveWorkspace))})}):null]})]}),e.jsx(As,{workspaceId:s,filterInputValue:o,isRoleEditingDisabled:t}),e.jsx("p",{className:"text-token-text-secondary mt-4 text-sm",children:e.jsx(j,x({},te.memberListUpdateDelayNote))})]})}const te=q({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"},memberListUpdateDelayNote:{id:"adminPage.memberListUpdateDelayNote",defaultMessage:"Note: Although new workspace members can access ChatGPT immediately, it may take up to 24 hours to show them in this list."}}),Js=s=>s==="members"||s==="invites"||s==="requests";function Zs({currentWorkspaceId:s}){var V,T;const t=y(),a=ke(),n=(V=a==null?void 0:a.isFreeWorkspace())!=null?V:!1,{count:r}=ls(s),i=ms(a),l=M.useMemo(()=>[{key:"members",label:t.formatMessage(E.allMembers),children:e.jsx(zs,{workspaceId:s,isRoleEditingDisabled:n})},{key:"invites",label:t.formatMessage(E.pendingInvites),children:e.jsx($s,{workspaceId:s,isRoleEditingDisabled:n})},{key:"requests",label:t.formatMessage(E.pendingRequests),children:e.jsx(Ws,{workspaceId:s,isRoleEditingDisabled:n})}],[s,t,n]),o=Ne(),[c]=Fe(),d=c.get("tab"),[u,g]=M.useState(d&&Js(d)?d:l[0].key),h=a!=null?os(a.data.role):void 0,p=a!=null?cs(a.data.role):void 0,R=a==null?void 0:a.isEnterprisey(),{data:N,isLoading:C}=Ze(s);let b=!1;p||h||!R?b=!0:b=!!((T=N==null?void 0:N.permissions)!=null&&T.includes("chatgpt.workspace.member.role.view"));const B=S=>{g(S),o({pathname:window.location.pathname,search:new URLSearchParams({tab:S}).toString()})};return a?C?e.jsx("div",{className:"mt-6 flex min-h-[40vh] items-center justify-center",children:e.jsx(H,{})}):b?e.jsxs(e.Fragment,{children:[e.jsx(ds,{children:e.jsx("title",{children:t.formatMessage(E.adminBrowserPageTitle)})}),e.jsx(ps,{title:t.formatMessage(E.adminPageTitle),subtitle:e.jsx(j,x({values:{totalMembers:r,planName:i}},E.totalMembers)),tabsHeader:e.jsx(hs,{items:l,activeTab:u,onTabChange:B})}),e.jsx(js,{children:e.jsx(fs,{items:l,activeTab:u})})]}):e.jsx("div",{className:"m-6",children:e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-secondary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[e.jsx(Ye,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),e.jsx(j,x({},E.membersPagePermissionDenied))]})}):null}const E=q({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} Â· {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},membersPagePermissionDenied:{id:"adminPage.membersPagePermissionDenied",defaultMessage:"You don't have permission to view this members list. Please contact your workspace admin for access or update the workspace settings."}}),ct=Le(function(){const t=Ms();return e.jsx(Zs,x({},t))});export{ct as a,w as m};
//# sourceMappingURL=oeupke8i202x5rfe.js.map

var de=Object.defineProperty,pe=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var W=(e,o,a)=>o in e?de(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,y=(e,o)=>{for(var a in o||(o={}))Se.call(o,a)&&W(e,a,o[a]);if(J)for(var a of J(o))he.call(o,a)&&W(e,a,o[a]);return e},w=(e,o)=>pe(e,ye(o));import{h as A,r as S,j as n,d as re,a as V,M as ee,S as ge}from"./mw35uwhq4g8r9eam.js";import{R as be,u as _e,ak as Pe,aA as Te,p as we,e7 as se,_ as oe,am as Me,D as Q,cq as Ee}from"./d0xa318sl7ywi0za.js";import{c as l,S as z,F as X,a as ne,C as Y,L as xe}from"./0vzw4aujxrcpkx50.js";import{k0 as Ce,k2 as Ne,cv as ve,gH as Le,eH as Ae,bf as je,f9 as Re,eM as Fe,eN as Oe,eI as q,oW as Ie,cu as Ue,eK as qe,gB as ze,bK as ke,bL as Qe}from"./g2euln7v5pbm31qa.js";import{P as le}from"./3xa3aq3nbd1nd678.js";import{u as Be,B as Ve}from"./keveoph4stiufpkl.js";import{S as Xe}from"./mdhx8v0rk5lzwfyg.js";const ae="country_code",k="step",B=e=>be.safePost("/accounts/pending_team_workspace",{requestBody:e}),Ye=({formData:e,onNext:o})=>{var d,_;const a=A(),[r,i]=S.useState({role:(d=e.role)!=null?d:"",department:(_=e.department)!=null?_:""}),[m,f]=S.useState({}),g=(t,s)=>{i(b=>w(y({},b),{[t]:s})),f(b=>w(y({},b),{[t]:""}))},h=S.useMemo(()=>{const t=Ce.map(s=>({label:a.formatMessage(s.displayValue),value:s.id}));return t.sort((s,b)=>s.label.localeCompare(b.label)),t},[a]),c=S.useMemo(()=>{const t=Ne.map(s=>({label:a.formatMessage(s.displayValue),value:s.id}));return t.sort((s,b)=>s.label.localeCompare(b.label)),t},[a]),u=S.useMemo(()=>[{formType:"select",label:a.formatMessage(l.roleLabel),name:"role",placeholder:a.formatMessage(l.rolePlaceholder),value:r.role,onChange:t=>g("role",t),error:m.role,required:!0,options:c},{formType:"select",label:a.formatMessage(l.workspaceDepartmentLabel),name:"department",placeholder:a.formatMessage(l.workspaceDepartmentPlaceholder),value:r.department,onChange:t=>g("department",t),error:m.department,required:!0,options:h}],[h,m.department,m.role,r.department,r.role,a,c]),p=()=>{const t={};return u.forEach(s=>{s.required&&!r[s.name]&&(t[s.name]=a.formatMessage(l.fieldRequired,{fieldName:s.label}))}),f(t),Object.values(t).every(s=>!s)};return n.jsx(z,{content:n.jsxs(X,{title:a.formatMessage(l.tellUsAboutWorkStepTitle),subTitle:a.formatMessage(l.tellUsAboutWorkStepSubtitle),children:[n.jsx("div",{className:"flex flex-col gap-6",children:u.map(t=>S.createElement(ne,w(y({},t),{key:t.name})))}),n.jsx(Y,{onClick:async()=>{p()&&await o(r)}})]})})},De=e=>e==="sales_marketing",Ke={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"};function He({isOneDollarPromoEligible:e,isFreeTrialPromoEligible:o,salesMarketingCopyEnabled:a}){return!e&&!o?{titleMessage:l.purchaseStepTitle,subTitleMessage:void 0}:e?{titleMessage:l.oneDollarPromoTitle,subTitleMessage:a?l.salesMarketingPromoSubtitleOneDollar:l.oneDollarPromoSubtitle}:{titleMessage:l.freeTrialPromoTitle,subTitleMessage:a?l.salesMarketingPromoSubtitleFree:l.freeTrialPromoSubtitle}}const $e=({onNext:e,onPrevious:o,pendingWorkspace:a,initialBillingDetails:r,formData:i})=>{var H,$;const m=A(),f=_e(),g=Re(),{data:h,isLoading:c,error:u}=ve({ctx:f,countryCode:r==null?void 0:r.country,currency:r==null?void 0:r.currency,enabled:r!=null}),p=re(),d=V(),t=S.useMemo(()=>{const G=new URLSearchParams(d.search).get("segment");return De(G)?G:null},[d.search])!=null&&Pe(f,"3300867660").get("enable_sales_marketing_copy",!1),s=($=new URLSearchParams((H=a==null?void 0:a.query_params)!=null?H:"").get(le))!=null?$:void 0,b=s!=null,{selectedPlan:E,setSelectedPlan:j,numSeats:x,setNumSeats:R,promoData:C,promoDataIsFromQueryParam:F,TEAM1DOLLAR_COUPON_IsEligible:N,TEAM_FREE_TRIAL_COUPON_IsEligible:v}=Be({initialSeats:i==null?void 0:i.numSeats,initialPromoCoupon:s,initialPromoCouponFromQueryParam:b}),{eligible:O,campaignId:T}=Le(),P=!s&&O,I=C!=null?C:P?{coupon:T,state:"eligible",redemption:null}:void 0,U=C?F:P?!1:void 0;if(!r||c||u!=null||!h)return n.jsx(z,{forceLightTheme:!0,content:null});const{annualBillingPlan:L}=Ae(r.currency,h),me=Math.floor(100-L.discountedMonthlyCost/L.monthlyCost*100),D={priceInterval:E,billingDetails:r,numSeats:x,promoData:I,promoDataIsFromQueryParam:U},ue=N||v,{titleMessage:ie,subTitleMessage:K}=He({isOneDollarPromoEligible:!!N,isFreeTrialPromoEligible:!!v,salesMarketingCopyEnabled:t}),fe=je(isNaN(x)?0:x,g,Fe);return n.jsx(z,{forceLightTheme:!0,onPrevious:o?()=>o(y({},D)):void 0,content:n.jsxs(X,{title:m.formatMessage(ie),subTitle:K&&m.formatMessage(K),children:[n.jsxs("div",{className:"flex flex-col gap-6",children:[n.jsx(Oe,{numSeats:x,minSeats:g,setNumSeats:R,classNames:Ke,label:n.jsx(ee,y({},l.seatsCountLabel))}),n.jsxs("div",{className:"flex flex-col gap-1.5",children:[n.jsx(xe,{required:!0,children:m.formatMessage(l.planSummaryTitle)}),n.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(ue&&E===q.FLEXIBLE)&&n.jsx(Xe,{ariaLabel:m.formatMessage(l.planTypeLabel),leftItem:{label:n.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:m.formatMessage(l.annualPlanLabel,{percent:me,span:Z=>n.jsx("span",{className:"text-[#10A37F]",children:Z})})}),value:q.ANNUAL},rightItem:{label:m.formatMessage(l.monthlyPlanLabel),value:q.FLEXIBLE},value:E,onChange:j}),n.jsx(Ve,{numSeats:fe,selectedPlan:E,billingDetails:r,totalLabel:l.allPlansTodayTotal,billDate:m.formatMessage(l.today),promoData:I})]})]})]}),n.jsx(Y,{onClick:()=>e(y({},D))}),n.jsx(Te,{color:"ghost",onClick:()=>p("/"),children:n.jsx(ee,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},Ze=({formData:e,onNext:o,onPrevious:a})=>{var d,_;const r=A(),[i,m]=S.useState({workspaceName:(d=e.workspaceName)!=null?d:"",companySize:(_=e.companySize)!=null?_:""}),[f,g]=S.useState({}),h=(t,s)=>{m(b=>w(y({},b),{[t]:s})),g(b=>w(y({},b),{[t]:""}))},c=Ie.map(t=>({label:typeof t.displayValue=="string"?t.displayValue:r.formatMessage(t.displayValue),value:t.id})),u=S.useMemo(()=>[{formType:"input",label:r.formatMessage(l.workspaceNameLabel),name:"workspaceName",placeholder:r.formatMessage(l.workspaceNamePlaceholder),value:i.workspaceName,onChange:t=>h("workspaceName",t),error:f.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:r.formatMessage(l.workspaceCompanySizeLabel),name:"companySize",placeholder:r.formatMessage(l.workspaceCompanySizePlaceholder),value:i.companySize,onChange:t=>h("companySize",t),error:f.companySize,required:!1,options:c}],[f.companySize,f.workspaceName,i.companySize,i.workspaceName,r,c]),p=()=>{const t={};return u.forEach(s=>{s.required&&!i[s.name]&&(t[s.name]=r.formatMessage(l.fieldRequired,{fieldName:s.label}))}),g(t),Object.values(t).every(s=>!s)};return n.jsx(z,{onPrevious:a?()=>a(y({},i)):void 0,content:n.jsxs(X,{title:r.formatMessage(l.workspaceNameStepTitle),subTitle:r.formatMessage(l.workspaceNameStepSubtitle),children:[n.jsx("div",{className:"flex flex-col gap-6",children:u.map(t=>S.createElement(ne,w(y({},t),{key:t.name})))}),n.jsx(Y,{disabled:!i.workspaceName,onClick:async()=>{p()&&await o(y({},i))}})]})})};var ce=(e=>(e.AboutWork="about-work",e.WorkspaceInfo="workspace-info",e.ConfigurePlan="configure-plan",e))(ce||{});const Ge=Ee(Object.values(ce),void 0),ca=({pendingWorkspace:e})=>{var E,j,x,R,C,F,N,v,O;const o=A(),[a,r]=S.useState({workspaceName:(E=e==null?void 0:e.workspace_name)!=null?E:void 0,role:(j=e==null?void 0:e.role)!=null?j:void 0,department:(x=e==null?void 0:e.department)!=null?x:void 0,companySize:(R=e==null?void 0:e.company_size)!=null?R:void 0,numSeats:(C=e==null?void 0:e.seat_quantity)!=null?C:void 0}),i=new URLSearchParams((F=e==null?void 0:e.query_params)!=null?F:"").get(le);ze(i!=null?i:"",!!i);const m=Je({data:a}),f=se(),g=V(),h=(O=(v=new URLSearchParams(g.search).get(ae))!=null?v:new URLSearchParams((N=e==null?void 0:e.query_params)!=null?N:"").get(ae))!=null?O:void 0,c=ge(),{country:u,userCountry:p}=ke({initialCountryCode:h}),d=Qe({country:u,currentAccount:f,location:"TeamDirectSignUpFlow"}),_=Ge(e==null?void 0:e.step_name),{step:t,nextStep:s}=We({initialStep:_&&M.includes(_)?_:void 0});S.useEffect(()=>{e||(()=>{var P;B({step_name:(P=e==null?void 0:e.step_name)!=null?P:M[0],query_params:g.search,user_segment:"v1"})})()},[]),S.useEffect(()=>{var U,L;const T=g.key,I=new URLSearchParams(window.location.search).get("referrer")||document.referrer;oe.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",w(y({},f==null?void 0:f.subscriptionAnalyticsParams),{referrer:I,initialTab:e==null?void 0:e.step_name,currentTab:t,locationKey:T,navigationType:c,initialCountrySelectorCountry:h!=null?h:u,selectedCountry:(U=d==null?void 0:d.country)!=null?U:"",selectedCurrency:(L=d==null?void 0:d.currency)!=null?L:"",userCountry:p!=null?p:""}))},[t]);const b=()=>{switch(t){case"about-work":return n.jsx(Ye,{formData:a,onNext:async T=>{const P=y(y({},a),T);r(P),await s(P)}});case"workspace-info":return n.jsx(Ze,{formData:a,onNext:async T=>{const P=y(y({},a),T);r(P),await s(P)}});case"configure-plan":return n.jsx($e,{formData:a,initialBillingDetails:d!=null?d:void 0,onNext:async T=>{await m(y(y({},a),T))},pendingWorkspace:e});default:return null}};return n.jsxs(n.Fragment,{children:[n.jsx("title",{children:o.formatMessage(l.teamSignUpPageTitle)}),b()]})},Je=({data:e,isCustomCheckout:o=!1})=>{const{prepareCheckoutSession:a,navigateToCheckout:r}=Ue(),i=we(),m=A(),f=se();return S.useCallback(async({priceInterval:h,billingDetails:c,numSeats:u,promoData:p,promoDataIsFromQueryParam:d})=>{var _;try{oe.logEvent("Account Pay: Payment Checkout Clicked",w(y({planType:Me.SELF_SERVE_BUSINESS},f==null?void 0:f.subscriptionAnalyticsParams),{referrer:document.referrer}));const t=await a(w(y(y({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:(_=e.workspaceName)!=null?_:"",price_interval:h,seat_quantity:u},billing_details:c},o?{}:{checkout_ui_mode:"redirect"}),h===q.FLEXIBLE&&(p!=null&&p.coupon)?{promo_campaign:{promo_campaign_id:p==null?void 0:p.coupon,is_coupon_from_query_param:!!d}}:{}),{cancel_url:window.location.href}));await r(t)}catch(t){Q.addError(t),i.warning(m.formatMessage(qe.paymentErrorWarning),{hasCloseButton:!0})}},[o,f==null?void 0:f.subscriptionAnalyticsParams,e.workspaceName,m,r,a,i])},te=(e,o)=>{const a=new URLSearchParams(window.location.search);Object.entries(e).forEach(([i,m])=>{a.set(i,m)});const r="".concat(window.location.pathname,"?").concat(a.toString());o?o(r,{replace:!1}):window.history.replaceState(null,"",r)},M=["configure-plan"],We=({initialStep:e})=>{const o=re(),a=V(),[r,i]=S.useState(()=>{const c=e!=null?e:M[0];return te({[k]:c}),c}),m=S.useCallback(c=>{i(c),te({[k]:c},o)},[o]),f=S.useRef(null);S.useEffect(()=>{const u=new URLSearchParams(a.search).get(k);u!==f.current&&u&&M.includes(u)&&u!==r&&m(u),f.current=u},[a.search,m,r]);const g=async c=>{let u=r;const p=M.indexOf(r);p>=0&&p<M.length-1&&(u=M[p+1],m(u));try{await B({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(d){Q.addError(d)}},h=S.useCallback(async c=>{let u=r;const p=M.indexOf(r);p>0&&(u=M[p-1],m(u));try{await B({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(d){Q.addError(d)}},[a.search,m,r]);return{step:r,nextStep:g,previousStep:h}};export{ca as C,k as S,De as i,Je as u};
//# sourceMappingURL=c88b35umkfs90bi2.js.map

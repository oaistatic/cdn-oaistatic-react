var he=Object.defineProperty,xe=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var le=(u,t,e)=>t in u?he(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e,se=(u,t)=>{for(var e in t||(t={}))pe.call(t,e)&&le(u,e,t[e]);if(te)for(var e of te(t))ge.call(t,e)&&le(u,e,t[e]);return u},re=(u,t)=>xe(u,ve(t));import{r as b,j as r,c as F,h as be}from"./mw35uwhq4g8r9eam.js";import{rx as Z,e5 as ee,cF as we,eu as q,ry as ye,rz as je,eF as Se,dp as Q,h5 as ke}from"./d0xa318sl7ywi0za.js";import{g as Ee}from"./eder15khh2fy5wd2.js";import{bf as O,X as _e,hb as Ne}from"./g2euln7v5pbm31qa.js";const ne=1.2,oe=.95,Re=80,Te=56,ie=.34,ae=b.memo(function({img:t,size:e,active:n,onClick:o,axis:s,index:l,indexMv:d}){var R,i;const c=b.useCallback(f=>{const x=Math.abs(f-l);return x<1?ne-(ne-oe)*x:oe},[l]),w=b.useCallback(f=>{const x=Math.abs(f-l);return x<1?1-(1-ie)*x:ie},[l]),h=Z(d,c),j=Z(d,w);return r.jsx(ee.button,{"aria-selected":n,role:"option",onClick:o,style:{height:e,width:e,scale:h,opacity:j},className:we("border-thin focus-visible:ring-ring overflow-hidden rounded-lg border-black/10 bg-gray-200 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-none dark:border-white/10",s==="vertical"?"mx-auto mb-2 block":"flex-shrink-0"),children:r.jsx("img",{src:(R=t.thumbnail)!=null?R:t.url,alt:(i=t.title)!=null?i:"",loading:"lazy",decoding:"async",className:"h-full w-full rounded-lg object-cover"})})});function ce(u){"use forget";const t=F.c(51),{axis:e,itemSize:n,gap:o,imagesLen:s,index:l,setIndex:d,externalSyncRef:c,wheelHostRef:w}=u,h=b.useRef(null),[j,R]=b.useState(0),i=n+o,f=i*(s-1);let x;t[0]!==e||t[1]!==l||t[2]!==i||t[3]!==f?(x=()=>{const m=h.current;if(!m)return;const a=Math.round(l*i);e==="vertical"?m.scrollTop=O(a,0,f):m.scrollLeft=O(a,0,f)},t[0]=e,t[1]=l,t[2]=i,t[3]=f,t[4]=x):x=t[4];let y;t[5]===Symbol.for("react.memo_cache_sentinel")?(y=[],t[5]=y):y=t[5],q(x,y);let _,S;t[6]!==e||t[7]!==i?(_=()=>{const m=()=>{const L=e==="vertical"?window.innerHeight-Te:window.innerWidth,M=Math.max(1,Math.floor(L/i)),A=M%2===0?M-1:M,I=e==="vertical"?Re:0;R(A*i-I)};m();let a=null;return typeof ResizeObserver<"u"&&(a=new ResizeObserver(()=>m()),a.observe(document.documentElement)),()=>{a&&a.disconnect()}},S=[e,i],t[6]=e,t[7]=i,t[8]=_,t[9]=S):(_=t[8],S=t[9]),q(_,S);let k;t[10]===Symbol.for("react.memo_cache_sentinel")?(k={container:h},t[10]=k):k=t[10];const{scrollX:z,scrollY:v}=ye(k),E=e==="vertical"?v:z;let T;t[11]!==i?(T=m=>m/i,t[11]=i,t[12]=T):T=t[12];const p=Z(E,T);let g;t[13]!==s||t[14]!==l||t[15]!==i||t[16]!==d?(g=m=>{const a=Math.round(m/i);a!==l&&a>=0&&a<s&&d(a)},t[13]=s,t[14]=l,t[15]=i,t[16]=d,t[17]=g):g=t[17],je(E,"change",g);let C;t[18]!==e||t[19]!==i||t[20]!==f?(C=(m,a)=>{const L=a===void 0?!1:a,M=h.current;if(!M)return;const A=Math.round(m*i),I=e==="vertical"?{top:O(A,0,f)}:{left:O(A,0,f)};L?M.scrollTo(re(se({},I),{behavior:"smooth"})):e==="vertical"?M.scrollTop=I.top:M.scrollLeft=I.left},t[18]=e,t[19]=i,t[20]=f,t[21]=C):C=t[21];const N=C,H=b.useRef(null);let V;t[22]!==s||t[23]!==N||t[24]!==d?(V=m=>{H.current||(H.current=requestAnimationFrame(()=>{d(a=>{const L=O(a+m,0,s-1);return L!==a&&N(L),L}),H.current=null}))},t[22]=s,t[23]=N,t[24]=d,t[25]=V):V=t[25];const J=V;let Y;t[26]!==e||t[27]!==J||t[28]!==s||t[29]!==l||t[30]!==N?(Y=m=>{if(e!=="vertical")return;const a=m.key==="ArrowUp"?-1:m.key==="ArrowDown"?1:0;if(a){if(m.repeat)J(a);else{const L=O(l+a,0,s-1);N(L,!0)}m.preventDefault()}},t[26]=e,t[27]=J,t[28]=s,t[29]=l,t[30]=N,t[31]=Y):Y=t[31];const D=Y;let $,K;t[32]!==e||t[33]!==D?($=()=>{if(e==="vertical")return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},K=[e,D],t[32]=e,t[33]=D,t[34]=$,t[35]=K):($=t[34],K=t[35]),b.useEffect($,K);let W,B;t[36]!==e||t[37]!==f||t[38]!==w?(W=()=>{if(!(w!=null&&w.current)||e!=="vertical")return;const m=w.current,a=h.current;if(!a)return;const L=M=>{M.preventDefault();let A=a.scrollTop+M.deltaY;const I=a.scrollTop<=0&&M.deltaY<0,me=a.scrollTop>=f&&M.deltaY>0;(I||me)&&(A=a.scrollTop+M.deltaY*.2),A=O(A,0,f),A!==a.scrollTop&&(a.scrollTop=A)};return m.addEventListener("wheel",L,{passive:!1}),()=>m.removeEventListener("wheel",L)},B=[e,w,f],t[36]=e,t[37]=f,t[38]=w,t[39]=W,t[40]=B):(W=t[39],B=t[40]),b.useEffect(W,B);let P,U;t[41]!==c||t[42]!==s||t[43]!==l||t[44]!==d?(P=()=>{if(!(c!=null&&c.current))return;const m=c.current,a=()=>{const L=Math.round(m.scrollLeft/m.clientWidth);L!==l&&L>=0&&L<s&&d(L)};return m.addEventListener("scroll",a,{passive:!0}),()=>m.removeEventListener("scroll",a)},U=[c,s,l,d],t[41]=c,t[42]=s,t[43]=l,t[44]=d,t[45]=P,t[46]=U):(P=t[45],U=t[46]),b.useEffect(P,U);let X;return t[47]!==p||t[48]!==j||t[49]!==N?(X={railRef:h,railHeight:j,indexMv:p,scrollToIndex:N},t[47]=p,t[48]=j,t[49]=N,t[50]=X):X=t[50],X}const Le=b.memo(function(t){"use forget";const e=F.c(34),{images:n,index:o,setIndex:s,wheelHostRef:l}=t;let d;e[0]!==n.length||e[1]!==o||e[2]!==s||e[3]!==l?(d={axis:"vertical",itemSize:46,gap:8,imagesLen:n.length,index:o,setIndex:s,wheelHostRef:l},e[0]=n.length,e[1]=o,e[2]=s,e[3]=l,e[4]=d):d=e[4];const{railRef:c,railHeight:w,indexMv:h,scrollToIndex:j}=ce(d);let R;e[5]!==j||e[6]!==s?(R=p=>{s(p),j(p)},e[5]=j,e[6]=s,e[7]=R):R=e[7];const i=R;let f;if(e[8]!==i||e[9]!==n){let p;e[11]!==i?(p=(g,C)=>()=>i(C),e[11]=i,e[12]=p):p=e[12],f=n.map(p),e[8]=i,e[9]=n,e[10]=f}else f=e[10];const x=f;let y;e[13]!==w?(y={height:w,contain:"layout size style"},e[13]=w,e[14]=y):y=e[14];let _;e[15]===Symbol.for("react.memo_cache_sentinel")?(_=r.jsx("div",{style:{height:"calc(50% - 23px)"}}),e[15]=_):_=e[15];let S;if(e[16]!==x||e[17]!==n||e[18]!==o||e[19]!==h){let p;e[21]!==x||e[22]!==o||e[23]!==h?(p=(g,C)=>{var N;return r.jsx(ae,{img:g,size:46,active:C===o,onClick:x[C],axis:"vertical",index:C,indexMv:h},(N=g.id)!=null?N:g.url)},e[21]=x,e[22]=o,e[23]=h,e[24]=p):p=e[24],S=n.map(p),e[16]=x,e[17]=n,e[18]=o,e[19]=h,e[20]=S}else S=e[20];let k;e[25]===Symbol.for("react.memo_cache_sentinel")?(k=r.jsx("div",{style:{height:"calc(50% - 23px)"}}),e[25]=k):k=e[25];let z;e[26]!==c||e[27]!==y||e[28]!==S?(z=r.jsxs(ee.div,{ref:c,style:y,className:"no-scrollbar overflow-y-scroll",children:[_,S,k]}),e[26]=c,e[27]=y,e[28]=S,e[29]=z):z=e[29];let v,E;e[30]===Symbol.for("react.memo_cache_sentinel")?(E=r.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-10 h-16 bg-gradient-to-b from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),v=r.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-10 h-16 bg-gradient-to-t from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),e[30]=v,e[31]=E):(v=e[30],E=e[31]);let T;return e[32]!==z?(T=r.jsxs("div",{className:"relative mt-4 w-24 self-start",role:"listbox","aria-orientation":"vertical",children:[z,E,v]}),e[32]=z,e[33]=T):T=e[33],T}),ze=b.memo(function(t){"use forget";const e=F.c(37),{images:n,index:o,setIndex:s,carouselRef:l}=t;let d;e[0]!==l||e[1]!==n.length||e[2]!==o||e[3]!==s?(d={axis:"horizontal",itemSize:32,gap:6,imagesLen:n.length,index:o,setIndex:s,externalSyncRef:l},e[0]=l,e[1]=n.length,e[2]=o,e[3]=s,e[4]=d):d=e[4];const{railRef:c,indexMv:w,scrollToIndex:h}=ce(d);let j,R;e[5]!==o||e[6]!==h?(j=()=>{h(o)},R=[o,h],e[5]=o,e[6]=h,e[7]=j,e[8]=R):(j=e[7],R=e[8]),q(j,R);let i;e[9]!==l||e[10]!==h||e[11]!==s?(i=g=>{s(g),h(g),l.current&&l.current.scrollTo({behavior:"instant",left:l.current.clientWidth*g})},e[9]=l,e[10]=h,e[11]=s,e[12]=i):i=e[12];const f=i;let x;if(e[13]!==f||e[14]!==n){let g;e[16]!==f?(g=(C,N)=>()=>f(N),e[16]=f,e[17]=g):g=e[17],x=n.map(g),e[13]=f,e[14]=n,e[15]=x}else x=e[15];const y=x;let _,S;e[18]===Symbol.for("react.memo_cache_sentinel")?(_={contain:"layout size style",contentVisibility:"auto"},S=r.jsx("div",{style:{width:"max(calc(50% - 32px + 6px), 0px)",flexShrink:0}}),e[18]=_,e[19]=S):(_=e[18],S=e[19]);let k;if(e[20]!==y||e[21]!==n||e[22]!==o||e[23]!==w){let g;e[25]!==y||e[26]!==o||e[27]!==w?(g=(C,N)=>{var H;return r.jsx(ae,{img:C,size:32,active:N===o,onClick:y[N],axis:"horizontal",index:N,indexMv:w},(H=C.id)!=null?H:C.url)},e[25]=y,e[26]=o,e[27]=w,e[28]=g):g=e[28],k=n.map(g),e[20]=y,e[21]=n,e[22]=o,e[23]=w,e[24]=k}else k=e[24];let z;e[29]===Symbol.for("react.memo_cache_sentinel")?(z=r.jsx("div",{style:{width:"max(calc(50% - 32px + 6px), 0px)",flexShrink:0}}),e[29]=z):z=e[29];let v;e[30]!==c||e[31]!==k?(v=r.jsxs(ee.div,{ref:c,className:"flex flex-1 gap-1.5 overflow-x-hidden px-4 py-2",style:_,children:[S,k,z]}),e[30]=c,e[31]=k,e[32]=v):v=e[32];let E,T;e[33]===Symbol.for("react.memo_cache_sentinel")?(E=r.jsx("div",{className:"pointer-events-none absolute inset-y-0 start-0 z-10 w-8 bg-gradient-to-r from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),T=r.jsx("div",{className:"pointer-events-none absolute inset-y-0 end-0 z-10 w-8 bg-gradient-to-l from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),e[33]=E,e[34]=T):(E=e[33],T=e[34]);let p;return e[35]!==v?(p=r.jsxs("div",{className:"relative flex min-h-[48px] w-full overflow-hidden",role:"listbox","aria-orientation":"horizontal",children:[v,E,T]}),e[35]=v,e[36]=p):p=e[36],p}),G=b.createContext({activeImage:void 0,index:0});function Ce({images:u,initialIndex:t=0,onClose:e,onIndexChange:n,children:o,inpaintingProps:s}){var S,k,z;const[l,d]=b.useState(t),c=u[l];b.useEffect(()=>{n==null||n(l)},[l,n]);const w=be(),h=Se()===!1,j=b.useRef(null),{footerSlot:R,headerActionsSlot:i}=Ee(o,{footerSlot:de,headerActionsSlot:ue}),f=b.useRef(null),x=u.length>1,y=b.useCallback(v=>{v.key==="Escape"&&(e(),v.preventDefault())},[e]);b.useEffect(()=>(document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}),[y]),q(()=>{var E;if(!h||!j.current)return;const v=(E=j.current)==null?void 0:E.querySelector('[data-position="'.concat(l,'"]'));v&&j.current.scrollTo({behavior:"instant",left:v.offsetLeft})},[h]);const _=s&&(s==null?void 0:s.mode)==="inpaint";return r.jsx(G.Provider,{value:{activeImage:c,index:l},children:r.jsx(Q.Root,{isOpen:!0,onClose:e,testId:"modal-lightbox-new",shouldIgnoreClickOutside:_,children:r.jsx(Q.Overlay,{children:r.jsxs(Q.Content,{size:"fullscreen",removePopoverStyling:!0,className:"grid min-h-0 grid-rows-[auto_minmax(0,1fr)] overflow-hidden",children:[r.jsxs(fe,{children:[r.jsxs("div",{className:"grid w-full grid-cols-[auto_1fr] items-start justify-between gap-1 md:gap-2",children:[r.jsx(_e,{icon:ke,onClick:e,"aria-label":w.formatMessage({id:"EYLKSm",defaultMessage:"Close"})}),(c==null?void 0:c.title)&&r.jsx("h2",{className:"line-clamp-1 self-center text-base font-medium md:line-clamp-none",children:c.title})]}),i]}),h?r.jsxs("div",{className:"grid h-full min-h-0 w-full grid-rows-[minmax(0,1fr)_auto] overflow-hidden",children:[r.jsx("ol",{ref:j,className:"no-scrollbar flex h-full snap-x snap-mandatory overflow-x-auto scroll-smooth",children:u.map((v,E)=>{var T,p;return r.jsx("li",{"data-position":E,className:"flex w-full flex-shrink-0 snap-start snap-always items-center justify-center px-4",children:r.jsx("img",{src:v.url,alt:(T=v.title)!=null?T:"",className:"max-h-full max-w-full rounded object-contain",fetchPriority:E===l?"high":"auto",loading:E===l?"eager":"lazy",decoding:"async"})},(p=v.id)!=null?p:v.url)})}),r.jsxs("div",{className:"no-scrollbar flex flex-col gap-2 overflow-hidden py-4",children:[x&&r.jsx(ze,{images:u,index:l,setIndex:d,carouselRef:j}),r.jsx("div",{className:"px-4",children:R})]})]}):r.jsxs("div",{ref:f,className:"grid h-full w-full grid-cols-[1fr_auto] items-center overflow-y-auto overscroll-contain",children:[r.jsxs("div",{className:"grid h-full min-h-0 w-full grid-rows-[minmax(0,1fr)_auto] justify-items-center px-4 pb-9",children:[c&&r.jsxs("div",{className:"relative mt-12 mb-12 flex items-center justify-center rounded bg-neutral-100",children:[r.jsx("img",{src:c.url,alt:(S=c.title)!=null?S:"",className:"h-full max-h-full w-auto max-w-full rounded object-contain",fetchPriority:"high",loading:"eager",decoding:"async"},(k=c.id)!=null?k:c.url),_&&r.jsx(Ne,{image:c,drawingState:s.drawingState,drawingCanvasRef:s.drawingCanvasRef})]},(z=c.id)!=null?z:c.url),R]}),!_&&x?r.jsx(Le,{images:u,index:l,setIndex:d,wheelHostRef:f}):r.jsx("div",{className:"h-full w-24"})]})]})})})})}function fe(u){"use forget";const t=F.c(2),{children:e}=u;let n;return t[0]!==e?(n=r.jsx("header",{className:"grid w-full grid-cols-[auto_1fr] gap-1 p-2",children:e}),t[0]=e,t[1]=n):n=t[1],n}function de(u){"use forget";const t=F.c(5),{children:e}=u,{activeImage:n}=b.useContext(G);let o;t[0]!==n||t[1]!==e?(o=typeof e=="function"?e({activeImage:n}):e,t[0]=n,t[1]=e,t[2]=o):o=t[2];const s=o;let l;return t[3]!==s?(l=r.jsx("footer",{className:"pointer-events-auto w-full max-w-[768px]",children:s}),t[3]=s,t[4]=l):l=t[4],l}function ue(u){"use forget";const t=F.c(5),{children:e}=u,{activeImage:n}=b.useContext(G);let o;if(t[0]!==n||t[1]!==e){const l=typeof e=="function"?e({activeImage:n}):e;o=[],b.Children.forEach(l,d=>{b.isValidElement(d)&&o.push(d)}),t[0]=n,t[1]=e,t[2]=o}else o=t[2];let s;return t[3]!==o?(s=r.jsx("div",{className:"flex items-baseline justify-end gap-2",children:o.map(Me)}),t[3]=o,t[4]=s):s=t[4],s}function Me(u,t){return r.jsx(b.Fragment,{children:u},t)}const De={Root:Ce,Header:fe,Footer:de,LightboxHeaderActions:ue,Context:G};export{de as Footer,fe as Header,ue as LightboxHeaderActions,De as LightboxNew,Ce as Root};
//# sourceMappingURL=ii6qhpkhs6vyylw8.js.map

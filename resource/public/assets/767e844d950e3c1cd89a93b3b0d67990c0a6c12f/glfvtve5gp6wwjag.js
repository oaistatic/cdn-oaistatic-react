var fe=Object.defineProperty,pe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var le=a=>{throw TypeError(a)};var ce=(a,e,t)=>e in a?fe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,F=(a,e)=>{for(var t in e||(e={}))ve.call(e,t)&&ce(a,t,e[t]);if(de)for(var t of de(e))we.call(e,t)&&ce(a,t,e[t]);return a},V=(a,e)=>pe(a,me(e));var ue=(a,e,t)=>e.has(a)||le("Cannot "+t);var d=(a,e,t)=>(ue(a,e,"read from private field"),t?t.call(a):e.get(a)),j=(a,e,t)=>e.has(a)?le("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),$=(a,e,t,s)=>(ue(a,e,"write to private field"),s?s.call(a,t):e.set(a,t),t);import{g as ye,c as Q,b as z,u as be}from"./mw35uwhq4g8r9eam.js";import{r as ke}from"./e9wj7nd5g5h0l9yg.js";import{W as J,b3 as X}from"./d0xa318sl7ywi0za.js";import{a as Ee}from"./baz4b8nlf8t2lb95.js";const He={new:{id:"aardvark.status.new",defaultMessage:"New",description:"New status"},triaged:{id:"aardvark.status.triaged",defaultMessage:"Triaged",description:"Triaged status"},in_progress:{id:"aardvark.status.inProgress",defaultMessage:"In progress",description:"In progress status"},fixed:{id:"aardvark.status.fixed",defaultMessage:"Fixed",description:"Fixed status"},wontfix:{id:"aardvark.status.wontfix",defaultMessage:"Won't fix",description:"Won't fix status"},duplicate:{id:"aardvark.status.duplicate",defaultMessage:"Duplicate",description:"Duplicate status"}},Ne={critical:{id:"aardvark.crit.critical",defaultMessage:"Critical",description:"Critical severity"},high:{id:"aardvark.crit.high",defaultMessage:"High",description:"High severity"},medium:{id:"aardvark.crit.medium",defaultMessage:"Medium",description:"Medium severity"},low:{id:"aardvark.crit.low",defaultMessage:"Low",description:"Low severity"}},De={none:{id:"aardvark.assignee.none",defaultMessage:"None",description:"None assignee option label"}},je={search:{id:"aardvark.filter.assignee.search",defaultMessage:"Search by name or email",description:"Search assignees by name or email"}},$e={success:{id:"aardvark.proposedPatch.generation.validation.success",defaultMessage:"Success",description:"Badge label indicating the patch generation or validation is successful."},failed:{id:"aardvark.proposedPatch.generation.validation.failed",defaultMessage:"Failed",description:"Badge label indicating the patch generation or validation is failed."},pending:{id:"aardvark.proposedPatch.generation.validation.pending",defaultMessage:"Pending",description:"Badge label indicating the patch generation or validation is pending."},running:{id:"aardvark.proposedPatch.generation.validation.running",defaultMessage:"Running",description:"Badge label indicating the patch generation or validation is running."},unknown:{id:"aardvark.proposedPatch.generation.validation.unknown",defaultMessage:"Unknown",description:"Badge label indicating the patch generation or validation is unknown."}},We={security:{id:"aardvark.finding.signal.security",defaultMessage:"Security",description:"Security signal"},privacy:{id:"aardvark.finding.signal.privacy",defaultMessage:"Privacy",description:"Privacy signal"},validated:{id:"aardvark.finding.signal.validated",defaultMessage:"Validated",description:"Validated signal"},patch:{id:"aardvark.finding.signal.patch",defaultMessage:"Patch generated",description:"Short chip label used in the findings list under the Vulnerability column and in the metadata Signals section to show that Aardvark generated a proposed patch for this finding. Audience: security reviewers scanning dense tables, so the label must stay a single short word with no punctuation. When present, it indicates has_patch=true; when absent, no patch is available."},attackpath:{id:"aardvark.finding.signal.attackpath",defaultMessage:"Attack-path",description:"Attack-path generated signal"}},Ue={committedHeader:{id:"aardvark.table.committedHeader",defaultMessage:"Committed",description:"Committed header"},detectedHeader:{id:"aardvark.table.detectedHeader",defaultMessage:"Detected",description:"Detected header"}},Oe={githubConnectionNotEnabled:{id:"aardvark.toast.githubConnectionNotEnabled",defaultMessage:"GitHub connection is not enabled. Please contact your workspace admin.",description:"Toast message shown when GitHub connection is not enabled"},statusUpdate:{id:"aardvark.toast.statusError",defaultMessage:"Failed to update status: {details}",description:"Toast message shown when updating a finding's status fails"},assigneeUpdate:{id:"aardvark.toast.assigneeError",defaultMessage:"Failed to update assignee: {details}",description:"Toast message shown when updating the assignee fails"},scanSettingsSave:{id:"aardvark.toast.scanSettingsError",defaultMessage:"Failed to save scan settings: {details}",description:"Toast shown when saving scan settings fails"},findingsLoad:{id:"aardvark.toast.findingsLoadError",defaultMessage:"Failed to load findings: {details}",description:"Toast shown when the findings table fails to load"},recommendedLoad:{id:"aardvark.toast.recommendedLoadError",defaultMessage:"Failed to load recommended findings: {details}",description:"Toast shown when the recommended list fails to load"},findingLoad:{id:"aardvark.toast.findingLoadError",defaultMessage:"Failed to load finding: {details}",description:"Toast shown when the finding details page fails to load"},scanConfigLoad:{id:"aardvark.toast.scanConfigLoadError",defaultMessage:"Failed to load scan configurations: {details}",description:"Toast shown when scan configurations cannot be retrieved"},accessibleReposLoad:{id:"aardvark.toast.accessibleReposLoadError",defaultMessage:"Failed to load repositories: {details}",description:"Error toast on the Aardvark findings page when the repository dropdown cannot load accessible repositories from /aardvark/scan-findings/list-accessible-repos. Audience: workspace members browsing findings; tone is urgent but concise. Shown as a single-line toast notification triggered immediately after the fetch fails. Placeholder {details} is the raw error detail string from the API and might be empty or a technical status message; show it verbatim."},githubConnection:{id:"aardvark.toast.githubConnectionError",defaultMessage:"GitHub connection error: {details}",description:"Toast shown on the Aardvark scans page when the GitHub connector fails to initialize through usePlatformConnector (for example when the connector service is unavailable or an auth handshake fails). Audience: workspace members trying to connect GitHub to configure scans; tone is urgent and concise. This is a single-line toast triggered as soon as the connector hook reports an error; no Markdown or HTML is supported. Placeholder {details} is the raw connector error message string returned from the hook; it may be empty or a technical error code—render it exactly as provided and allow it to be blank without substituting fallback text."},githubInstallationsLoad:{id:"aardvark.toast.githubInstallationsError",defaultMessage:"Failed to load GitHub installations: {details}",description:"Error toast on the Aardvark scans page when the GitHub installations list cannot be fetched via useWhamGithubInstallationsV2 while rendering the connected repositories section. Audience: workspace members configuring scans; tone should be urgent but concise. Appears as a single-line toast fired immediately after the fetch fails; no Markdown/HTML allowed. Placeholder {details} is the raw error detail string returned from the request and may be empty or a technical status message—display it verbatim even when empty."},githubRepositoriesLoad:{id:"aardvark.toast.githubRepositoriesError",defaultMessage:"Failed to load GitHub repositories: {details}",description:"Error toast on the Aardvark scans page when fetching the repository list for a selected GitHub installation fails in the connected repositories table (useInfiniteQuery pagination). Audience: workspace members reviewing or configuring scans; tone is urgent and concise. The toast is single-line and triggers immediately after the fetch error, including during paginated loads; no Markdown/HTML formatting. Placeholder {details} is the raw error message string from the failed request and may be empty or technical—render it exactly as provided and allow it to be blank."},githubConnectionInline:{id:"aardvark.home.connectGithub.error",defaultMessage:"We're having trouble connecting to GitHub right now. See console for full error details.",description:"Inline message shown on the Connect GitHub card when the connector is down"},recommendedMissingScan:{id:"aardvark.recommended.missingScan",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Inline error shown when no configured scan exists for the selected repo"},recommendedMissingScanToast:{id:"aardvark.recommended.missingScan.toast",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Toast shown when no configured scan exists for the selected repo"},findingNotFound:{id:"aardvark.finding.details.notFound",defaultMessage:"Finding not found",description:"Message shown when the finding details page fails to load because the finding ID is invalid"}},Se=["application/json"];function _e(a){return Se.includes(a)}function re(a){const e={};for(const[t,s]of Object.entries(a))s!=null&&(e[t]="".concat(s));return e}function Ce(a,e){for(const[t,s]of Object.entries(e))a=a.replace("{".concat(t,"}"),s);return a}var R,W,U,x,q,H;const Y=class Y{constructor(e,t,s,i,n,o){j(this,R);j(this,W);j(this,U);j(this,x);j(this,q);j(this,H);var v;if(/\/+$/.test(s))throw new Error("The prefix is not allowed to have trailing slashes");if(/\/+$/.test(t))throw new Error("The baseUrl is not allowed to have trailing slashes");$(this,W,s),$(this,H,t),$(this,U,i),$(this,x,n),$(this,R,e),$(this,q,{fetchFn:(v=o==null?void 0:o.fetchFn)!=null?v:fetch.bind(globalThis)})}withProduces(e){return new Y(d(this,R),d(this,H),d(this,W),e,d(this,x),d(this,q))}withConsumes(e){return new Y(d(this,R),d(this,H),d(this,W),d(this,U),e,d(this,q))}withPrefix(e){return new Y(d(this,R),d(this,H),e,d(this,U),d(this,x),d(this,q))}async _request(e,t,s,i){var y,p,w,g;let n=new URLSearchParams(re((y=s==null?void 0:s.query)!=null?y:{})).toString();n&&(n="?"+n);const o=d(this,H)+d(this,W)+t,v=s==null?void 0:JSON.stringify(s.body),l=v?{"Content-Type":d(this,U)}:null,f=await d(this,q).fetchFn(Ce(o,re((p=s==null?void 0:s.path)!=null?p:{}))+n,V(F({credentials:"same-origin"},i!=null?i:{}),{method:e,headers:V(F(F(V(F({},l!=null?l:{}),{Accept:d(this,x)}),(w=i==null?void 0:i.headers)!=null?w:{}),re((g=s==null?void 0:s.headers)!=null?g:{})),{"X-OpenAI-Client":d(this,R)}),body:v})),h=f.headers.get("Content-Type");if(!h)throw new Error("Content-Type was not provided with the response");if(!_e(h))throw new Error("Unsupported return content type ".concat(h));if(h!==d(this,x))throw new Error("Return content type ".concat(h," was provided but this client only accepts ").concat(d(this,x),"."));switch(h){case"application/json":const m=await f.json();return{status:f.status,data:m,raw:f}}}async get(e,...t){return await this._request("GET",e,...t)}async post(e,...t){return await this._request("POST",e,...t)}async put(e,...t){return await this._request("PUT",e,...t)}async patch(e,...t){return await this._request("PATCH",e,...t)}async delete(e,...t){return await this._request("DELETE",e,...t)}async head(e,...t){return await this._request("HEAD",e,...t)}};R=new WeakMap,W=new WeakMap,U=new WeakMap,x=new WeakMap,q=new WeakMap,H=new WeakMap;let oe=Y;class Z extends oe{constructor(e,t){super("aardvark",e,"","application/json","application/json",t)}}var Me=ke();const Be=ye(Me);function Ae(a){var e;if(!(typeof a!="object"||a===null)&&typeof((e=a.error)==null?void 0:e.message)=="string")return a.error.message}function ee(a,e){var i,n;const t=Ae(e),s=t!=null?t:"".concat(a," ").concat((n=(i=e.error)==null?void 0:i.code)!=null?n:"");return new Error(s)}function Qe(a){var s;if(a instanceof Ee)return a.payload.message;const e=(s=a==null?void 0:a.message)!=null?s:"";if(e.trim().startsWith("500"))return"Internal server error. Check console for details.";const t=140;return e.length>t?e.slice(0,t)+"...":e}const E=a=>a.split(",").map(e=>e.trim()).filter(e=>e&&e.toLowerCase()!=="all"),he=()=>["aardvark","scan-findings","accessible-repos"],ge=async a=>{const t=await new Z(J).get("/aardvark/scan-findings/list-accessible-repos",{headers:X(),query:{force_refresh:a}});if(t.status!==200)throw ee(t.status,t.data);return t.data};function Ke(){"use forget";const a=Q.c(1);let e;return a[0]===Symbol.for("react.memo_cache_sentinel")?(e={queryKey:he(),queryFn:Te,staleTime:3e6,refetchOnWindowFocus:!0},a[0]=e):e=a[0],z(e)}function Te(){return ge(!1)}function Ve(){"use forget";const a=Q.c(2),e=be();let t;return a[0]!==e?(t=async s=>{const i=await ge(s);return e.setQueryData(he(),i),i},a[0]=e,a[1]=t):t=a[1],t}function Fe(a){"use forget";var s,i,n,o,v,l,f,h,y;const e=Q.c(42);let t;e:{if(!a){let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[0]=u):u=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[1]=r):r=e[1];let N;e[2]===Symbol.for("react.memo_cache_sentinel")?(N=[],e[2]=N):N=e[2];let D;e[3]===Symbol.for("react.memo_cache_sentinel")?(D=[],e[3]=D):D=e[3];let O;e[4]===Symbol.for("react.memo_cache_sentinel")?(O=[],e[4]=O):O=e[4];let B;e[5]===Symbol.for("react.memo_cache_sentinel")?(B={repoCsv:"",repoList:u,validationFilter:"all",patchFilter:"all",statusesCsv:"",statusList:r,critCsv:"",criticalityList:N,assigneesCsv:"",assigneeList:D,assigneeEmailsCsv:"",assigneeEmailList:O,authorsCsv:"",authorList:[],sortParam:"",pathPrefixesCsv:"",queryText:""},e[5]=B):B=e[5],t=B;break e}let p,w,g,m,_,C,M,A,T,b,k,S,c,I,L,G,P;if(e[6]!==a){const u=new URLSearchParams(a),r=(s=u.get("repo"))!=null?s:"",N=u.get("validated"),D=u.get("has_patch"),O=N==="true"?"validated":N==="false"?"unvalidated":"all",B=D==="true"?"with_patch":D==="false"?"without_patch":"all",te=(i=u.get("status"))!=null?i:"",ae=(n=u.get("criticality"))!=null?n:"",se=(o=u.get("assignee"))!=null?o:"",ie=(v=u.get("assignee_email"))!=null?v:"",ne=(l=u.get("author"))!=null?l:"";g=(f=u.get("sort"))!=null?f:"",p=(h=u.get("path_prefix"))!=null?h:"",w=(y=u.get("q"))!=null?y:"",m=r,b=r?E(r):[],k=O,S=B,c=te,I=te?E(te):[],L=ae,G=ae?E(ae):[],P=se,_=se?E(se):[],C=ie,M=ie?E(ie):[],A=ne,T=ne?E(ne):[],e[6]=a,e[7]=p,e[8]=w,e[9]=g,e[10]=m,e[11]=_,e[12]=C,e[13]=M,e[14]=A,e[15]=T,e[16]=b,e[17]=k,e[18]=S,e[19]=c,e[20]=I,e[21]=L,e[22]=G,e[23]=P}else p=e[7],w=e[8],g=e[9],m=e[10],_=e[11],C=e[12],M=e[13],A=e[14],T=e[15],b=e[16],k=e[17],S=e[18],c=e[19],I=e[20],L=e[21],G=e[22],P=e[23];let K;e[24]!==p||e[25]!==w||e[26]!==g||e[27]!==m||e[28]!==_||e[29]!==C||e[30]!==M||e[31]!==A||e[32]!==T||e[33]!==b||e[34]!==k||e[35]!==S||e[36]!==c||e[37]!==I||e[38]!==L||e[39]!==G||e[40]!==P?(K={repoCsv:m,repoList:b,validationFilter:k,patchFilter:S,statusesCsv:c,statusList:I,critCsv:L,criticalityList:G,assigneesCsv:P,assigneeList:_,assigneeEmailsCsv:C,assigneeEmailList:M,authorsCsv:A,authorList:T,sortParam:g,pathPrefixesCsv:p,queryText:w},e[24]=p,e[25]=w,e[26]=g,e[27]=m,e[28]=_,e[29]=C,e[30]=M,e[31]=A,e[32]=T,e[33]=b,e[34]=k,e[35]=S,e[36]=c,e[37]=I,e[38]=L,e[39]=G,e[40]=P,e[41]=K):K=e[41],t=K}return t}function Ye(a,e){"use forget";const t=Q.c(31),{repoCsv:s,validationFilter:i,patchFilter:n,statusesCsv:o,critCsv:v,assigneesCsv:l,assigneeEmailsCsv:f,authorsCsv:h,sortParam:y,pathPrefixesCsv:p,queryText:w}=Fe(a),g=e==null?void 0:e.limit,m=e==null?void 0:e.cursor,_=g!=null?g:null,C=m!=null?m:null,M=y||null,A=p||null,T=w||null;let b;t[0]!==f||t[1]!==l||t[2]!==h||t[3]!==v||t[4]!==n||t[5]!==s||t[6]!==o||t[7]!==_||t[8]!==C||t[9]!==M||t[10]!==A||t[11]!==T||t[12]!==i?(b=["aardvark","findings","scan",s,i,o,v,l,f,h,_,C,M,A,T,n],t[0]=f,t[1]=l,t[2]=h,t[3]=v,t[4]=n,t[5]=s,t[6]=o,t[7]=_,t[8]=C,t[9]=M,t[10]=A,t[11]=T,t[12]=i,t[13]=b):b=t[13];let k;t[14]!==f||t[15]!==l||t[16]!==h||t[17]!==v||t[18]!==m||t[19]!==g||t[20]!==n||t[21]!==p||t[22]!==w||t[23]!==s||t[24]!==y||t[25]!==o||t[26]!==i?(k=async()=>{const c={},I=typeof g=="number"&&Number.isFinite(g)&&g>0?g:500,L=typeof m=="number"&&Number.isFinite(m)&&m>=0,G=L?m:0;if(c.limit=String(I),L&&(c.cursor=String(G)),s){const r=E(s);r.length>0&&(c.repo=r.join(","))}if(i==="validated"?c.validated="true":i==="unvalidated"&&(c.validated="false"),n==="with_patch"?c.has_patch="true":n==="without_patch"&&(c.has_patch="false"),y&&(c.sort=y),o){const r=E(o);r.length>0&&(c.status=r.join(","))}if(v){const r=E(v);r.length>0&&(c.criticality=r.join(","))}if(l){const r=E(l);r.length>0&&(c.assignee=r.join(","))}if(f){const r=E(f);r.length>0&&(c.assignee_email=r.join(","))}if(h){const r=E(h);r.length>0&&(c.author=r.join(","))}if(p){const r=E(p);r.length>0&&(c.path_prefix=r.join(","))}const P=w.trim();P&&(c.q=P);const u=await new Z(J).get("/aardvark/scan-findings",{headers:X(),query:c});if(u.status!==200)throw ee(u.status,u.data);return u.data},t[14]=f,t[15]=l,t[16]=h,t[17]=v,t[18]=m,t[19]=g,t[20]=n,t[21]=p,t[22]=w,t[23]=s,t[24]=y,t[25]=o,t[26]=i,t[27]=k):k=t[27];let S;return t[28]!==b||t[29]!==k?(S={queryKey:b,queryFn:k,staleTime:3e4,refetchOnWindowFocus:!0},t[28]=b,t[29]=k,t[30]=S):S=t[30],z(S)}function ze(a){"use forget";const e=Q.c(8),t=a!=null?a:null;let s;e[0]!==t?(s=["aardvark","findings","recommended",t],e[0]=t,e[1]=s):s=e[1];const i=!!t;let n;e[2]!==t?(n=async()=>{var f,h,y,p,w;if(!t)throw new Error("No configured scan id found for recommended findings");const l=await new Z(J).get("/aardvark/rankings",{headers:X(),query:{configured_scan_id:t}});if(l.status!==200)throw ee(l.status,l.data);return{items:(h=(f=l.data.ranking_item_list)==null?void 0:f.map(Le))!=null?h:[],total:(p=(y=l.data.ranking_item_list)==null?void 0:y.length)!=null?p:0,ranking_end_time:(w=l.data.ranking_end_time)!=null?w:null}},e[2]=t,e[3]=n):n=e[3];let o;return e[4]!==s||e[5]!==i||e[6]!==n?(o={queryKey:s,enabled:i,queryFn:n,staleTime:3e4,refetchOnWindowFocus:!0},e[4]=s,e[5]=i,e[6]=n,e[7]=o):o=e[7],z(o)}function Le(a){return a}function Je(a){"use forget";const e=Q.c(2);let t;return e[0]!==a?(t={queryKey:["aardvark","finding",a],queryFn:async()=>{const i=await new Z(J).get("/aardvark/scan-findings/{id}",{headers:X(),path:{id:a}});if(i.status!==200)throw ee(i.status,i.data);return i.data},staleTime:3e4,refetchInterval:Pe,refetchIntervalInBackground:!0,refetchOnWindowFocus:!0},e[0]=a,e[1]=t):t=e[1],z(t)}function Pe(a){const e=a.state.data,t=e==null?void 0:e.proposed_patch;return t?t.status!=="finished"?5e3:t.status==="finished"&&t.success!==!0?1e4:!1:!1}function Xe(a,e,t){a.setQueriesData({queryKey:["aardvark","findings"],exact:!1},s=>{var n;if(!s)return s;const i=((n=s.items)!=null?n:[]).map(o=>o.hid===e?F(F({},o),t):o);return V(F({},s),{items:i})})}function Ze(a,e,t){a.setQueryData(["aardvark","finding",e],s=>s&&F(F({},s),t))}export{je as A,Ne as C,Oe as E,We as F,$e as P,He as S,De as a,Z as b,Ze as c,he as d,Qe as e,Be as f,ee as g,Ve as h,Ke as i,Ye as j,Ue as k,ze as l,Xe as p,Je as u};
//# sourceMappingURL=glfvtve5gp6wwjag.js.map

var H=Object.defineProperty,V=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var L=(e,s,n)=>s in e?H(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,y=(e,s)=>{for(var n in s||(s={}))T.call(s,n)&&L(e,n,s[n]);if(j)for(var n of j(s))A.call(s,n)&&L(e,n,s[n]);return e},b=(e,s)=>V(e,W(s));var R=(e,s)=>{var n={};for(var t in e)T.call(e,t)&&s.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&j)for(var t of j(e))s.indexOf(t)<0&&A.call(e,t)&&(n[t]=e[t]);return n};import{j as a,M as _,c as B,r as M,h as $}from"./mw35uwhq4g8r9eam.js";import{cZ as C,c_ as S,cD as q,cE as K,cI as Q,c$ as X,d0 as Y,d1 as F,cd as Z,d2 as J,d3 as ee,d4 as w,d5 as te,d6 as se}from"./g2euln7v5pbm31qa.js";import{e5 as ne,u as D,bo as O,cF as E,M as G,op as ae,cu as re,bD as oe,hC as le,_ as z,iS as ie,cm as ce}from"./d0xa318sl7ywi0za.js";import{f as ue}from"./mfq2eda4qxrcz3ws.js";function fe(e,s,n){"use forget";var k;const t=B.c(12),[d,c]=pe(e,n);let u;t[0]!==n||t[1]!==s?(u=p=>{var m;const g=te(p,s);return[(m=p==null?void 0:p.tree.getNodeIfExists(n))==null?void 0:m.message,...g]},t[0]=n,t[1]=s,t[2]=u):u=t[2];const o=G(e,u);let r;t[3]!==o?(r=o.flatMap(he),t[3]=o,t[4]=r):r=t[4];const l=r;let i;t[5]!==l?(i=ue(l,ge).toSorted(de),t[5]=l,t[6]=i):i=t[6];const h=i,f=d.length+((k=c==null?void 0:c.length)!=null?k:0)+0+h.length;let x;return t[7]!==d||t[8]!==h||t[9]!==c||t[10]!==f?(x={citations:d,fastNavLinks:c,collapsedAndSortedSearchResults:h,sourcesCount:f},t[7]=d,t[8]=h,t[9]=c,t[10]=f,t[11]=x):x=t[11],x}function de(e,s){var n,t;return((n=s==null?void 0:s.pub_date)!=null?n:0)-((t=e==null?void 0:e.pub_date)!=null?t:0)}function ge(e){return e.entries}function he(e){return ae(e)}function Me({clientThreadId:e,turnIndex:s,messageId:n,isInSidebar:t=!1,isN7JUPDSidebar:d=!1,scrollToHeader:c,shouldAnimateScroll:u,combineSections:o=!1}){const r=D(),l=O(r),{fastNavLinks:i,citations:h,collapsedAndSortedSearchResults:f}=fe(e,s,n),x={clientThreadId:e,messageId:n,turnIndex:s};return a.jsxs("div",{className:E("bg-token-bg-primary flex w-full flex-col",t&&!o?l?"mt-[calc(var(--threadFlyOut-leading-height,var(--header-height))*-1)] min-h-screen":"mt-[calc(var(--threadFlyOut-leading-height,57px)*-1)] min-h-screen":"mt-0",t?"":"border-token-border-default border-t"),children:[i&&i.length>0&&a.jsx(N,{title:o?null:a.jsx(_,{id:"fYO0jL",defaultMessage:"Links"}),items:i,analyticsMetadata:b(y({},x),{linkType:"links"}),scrollToHeader:c===C.Links,shouldAnimateScroll:u,messageId:n,isN7JUPDSidebar:d,combineSections:o}),a.jsx(N,{title:o?null:a.jsx(_,{id:"dlVlo6",defaultMessage:"Citations"}),items:h,analyticsMetadata:b(y({},x),{linkType:"citation"}),scrollToHeader:c===C.Citations,shouldAnimateScroll:u,messageId:n,isN7JUPDSidebar:d,combineSections:o}),a.jsx(N,{title:o?null:a.jsx(_,{id:"Gz+4tE",defaultMessage:"More"}),items:f,analyticsMetadata:b(y({},x),{linkType:"search_result"}),messageId:n,scrollToHeader:c===C.SearchResults,shouldAnimateScroll:u,isN7JUPDSidebar:d,combineSections:o})]},"".concat(s,"-").concat(e))}function N({title:e,items:s,analyticsMetadata:n,scrollToHeader:t,messageId:d,shouldAnimateScroll:c,isN7JUPDSidebar:u,combineSections:o=!1}){const r=D(),l=O(r),i=M.useRef(null);return M.useEffect(()=>{i.current&&t&&setTimeout(()=>{i.current&&i.current.scrollIntoView({behavior:c?"smooth":"instant"})},300)},[t,c]),!s||s.length===0?null:a.jsxs("div",{ref:i,children:[e&&a.jsx(P,{className:E("bg-token-bg-primary text-token-text-primary sticky top-0 z-1 flex items-center px-6 pt-4 pb-4 text-sm font-medium",l?"border-b-thin h-[var(--header-height,3.5rem)] border-(--bento-border-color)":"border-token-border-light h-[calc(var(--header-height,3.5rem)+1px)] border-b"),children:e}),a.jsx("ul",{className:E("flex flex-col",o?"py-0":"px-3 py-2"),children:s.map((h,f)=>a.jsx(P,{index:f,children:a.jsx(me,{item:h,analyticsMetadata:b(y({},n),{groupIndex:f}),messageId:d,isN7JUPDSidebar:u},f)},"".concat(e,"-").concat(f)))})]})}function P({children:e,index:s=0,className:n=""}){return a.jsx(ne.li,{className:n,initial:{opacity:0},animate:{opacity:1},transition:{delay:(s+1)*.03+.2},children:e})}function xe({item:e,analyticsMetadata:s}){var x,k,p,g,m;const n=$(),{clientThreadId:t}=s,d=re(t),c=(k=(x=e.asset_pointer_links)==null?void 0:x[0])!=null?k:"",u=Z(c),o=J({asset:{content_type:oe.ImageAssetPointer,size_bytes:0,width:0,height:0,asset_pointer:u},conversationId:d}),r=(p=e.clicked_from_url)!=null?p:"",l=o.data?{url:o.data.url,thumbnail_url:o.data.url,content_url:r,title:(g=e.clicked_from_title)!=null?g:n.formatMessage({id:"jLfAkx",defaultMessage:"Image"}),content_size:{width:0,height:0},thumbnail_size:{width:0,height:0},is_proxied_image:!0,attribution:S(r,"hostname")}:null,i=ee.useStore(),h=v=>{v.preventDefault(),v.stopPropagation(),l&&i.setCurrentImage({image:l})},f=S(r,"hostname");return a.jsx("li",{children:a.jsxs(U,{analyticsMetadata:s,href:(m=l==null?void 0:l.content_url)!=null?m:"#",className:"hover:bg-token-main-surface-secondary flex flex-col gap-0.5 rounded-xl px-3 py-2.5",onClick:h,rel:"noopener",children:[a.jsxs("div",{className:"line-clamp-1 flex h-6 items-center gap-2 text-xs",children:[l?a.jsx("img",{src:l.thumbnail_url,className:"icon-sm bg-token-main-surface-primary rounded-full object-cover",alt:n.formatMessage({id:"LUO0a4",defaultMessage:"Image thumbnail"})}):a.jsx("span",{className:"icon-sm bg-token-main-surface-primary rounded-full"}),f]}),a.jsx("div",{className:"line-clamp-2 text-sm font-semibold break-words",children:e.clicked_from_title?e.clicked_from_title:a.jsx(_,{id:"mmoVoz",defaultMessage:"Unknown"})})]})})}function me({item:e,analyticsMetadata:s,messageId:n,isN7JUPDSidebar:t}){var x,k,p,g,m,v;const d=$();if(e.type==="image_inline"&&t)return a.jsx(xe,{item:e,analyticsMetadata:s});const u=(k=e.attribution)!=null?k:S((x=e==null?void 0:e.url)!=null?x:"","short"),o=(p=e.url)!=null?p:"",r=q(o),l=r?r.Icon:e.type==="file"?K:null,i=r?r.type:e.type==="file"?d.formatMessage({id:"8ny9KX",defaultMessage:"File"}):void 0,h=I=>"ref_id"in I&&"content_type"in I;return a.jsxs(U,{analyticsMetadata:s,href:o,target:"_blank",rel:"noopener",className:"hover:bg-token-surface-hover dark:hover:bg-token-main-surface-tertiary flex flex-col gap-0.5 rounded-xl px-3 py-2.5",onMouseEnter:()=>{F.setHighlightBySource(n,e)},onMouseLeave:()=>{F.clearHighlights()},children:[a.jsxs("div",{className:"line-clamp-1 flex h-6 items-center gap-2 text-xs",children:[l?a.jsx(l,{className:"icon-sm bg-token-main-surface-primary rounded-full object-cover",alt:i}):a.jsx(Q,{url:(g=e==null?void 0:e.url)!=null?g:"",className:"icon-sm bg-token-main-surface-primary rounded-full object-cover",size:32,minSize:20,fallback:a.jsx(X,{className:"icon-sm text-token-text-quaternary"})}),u,h(e)&&a.jsx(Y,{searchResult:e,className:"text-token-text-tertiary inline h-4 w-4"})]}),a.jsx("div",{className:"line-clamp-2 text-sm font-semibold break-words",children:(v=(m=e.title)!=null?m:e.name)!=null?v:""}),a.jsx("div",{className:"text-token-text-secondary line-clamp-2 text-sm leading-snug font-normal",children:a.jsx(ke,{date:e.pub_date,snippet:e.snippet})})]})}const U=M.forwardRef(function(s,n){const l=s,{analyticsMetadata:t}=l,d=R(l,["analyticsMetadata"]),i=t,{groupIndex:c,linkType:u}=i,o=R(i,["groupIndex","linkType"]),r=b(y({},le(o)),{url:s.href,section_index:(c+1).toString(),link_type:"text",section:u,section_location:"sidebar"});return M.useEffect(()=>{z.logEvent("link_action",b(y({},r),{action:"show"}))},[]),a.jsx("a",b(y({ref:n},d),{onClick:h=>{var f;(f=s.onClick)==null||f.call(s,h),h.stopPropagation(),z.logEvent("link_action",b(y({},r),{action:"click"}))}}))}),pe=(e,s)=>G(e,n=>{var f,x,k,p;const t=n&&((f=n.tree.getNodeIfExists(s))==null?void 0:f.message),d=(x=ie(t))!=null?x:[],c=Object.values((p=(k=t==null?void 0:t.metadata)==null?void 0:k.content_references_by_file)!=null?p:{}).flat(),u=ce([...d,...c]),o=se(u);let r=[];const l=u.filter(g=>g.type==="navigation");l.length>0&&(r=l.flatMap(g=>g.domains.flatMap(m=>[{title:m.title,snippet:m.domain,url:m.url},...m.sub_domains.map(v=>({title:v.title,snippet:m.domain,url:v.url}))])));const i=u.filter(g=>g.type==="tldr").filter(g=>!g.used_as_navigation);i.length>0&&i.forEach(g=>{r.push({title:g.display_title,url:g.url})});const h=r.length>0?r:void 0;return[o,h]});function ke({date:e,snippet:s}){return!e&&!s?null:e&&!s?a.jsx(w,{date:e}):!e&&s?a.jsx(a.Fragment,{children:s}):a.jsx("span",{children:a.jsx(_,{id:"bgWoDg",defaultMessage:"{date} â€” {snippet}",values:{date:a.jsx(w,{date:e}),snippet:s}})})}export{P as A,Me as S,fe as u};
//# sourceMappingURL=idtxxq2b89y0p07a.js.map

var h=(o,e)=>(e=Symbol[o])?e:Symbol.for("Symbol."+o);var g=(o,e,r)=>(e=o[h("asyncIterator")])?e.call(o):(o=o[h("iterator")](),e={},r=(i,d)=>(d=o[i])&&(e[i]=n=>new Promise((a,u,m)=>(n=d.call(o,n),m=n.done,Promise.resolve(n.value).then(l=>a({value:l,done:m}),u)))),r("next"),r("return"),e);import{y as R,a9 as F,k as B,d as k,r as c,u as A,j as t}from"./mw35uwhq4g8r9eam.js";import{u as D,co as T,j0 as v,gn as H,eG as L,g as y,m as N,T as j,oS as Q,oU as _,oE as O,gi as $,fj as G,L as q}from"./d0xa318sl7ywi0za.js";import{r as K,u as U,s as V,C as P,a as W,g as z,b as S,T as J,c as X}from"./g2euln7v5pbm31qa.js";import{T as Y,C as Z}from"./kyqrf9eexoyaphy1.js";import{g as ee}from"./krza42hj097hj350.js";import{C as w,T as te}from"./o2byzwyeejp0u9wz.js";import{C as oe}from"./byy90pmw2kt2bmil.js";import"./ixsv6fw3pmowsupe.js";import"./ce3hgmw4iyyhicud.js";import"./mstl8wgfzorpgdoe.js";import"./pcrw7exsshz05v7h.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./cfgm997jt4en0fjd.js";import"./c8dilzb1umlthpuq.js";import"./deakbbf27g8e7ba0.js";import"./d4h15g77ywnnjdmi.js";import"./obs7vyhux2j83kng.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./ns51nblw8ziscsgd.js";import"./je2fy8gnwj5wx4yy.js";import"./go83k4bw3m46lwwg.js";import"./eg4jdclswoidzo1l.js";import"./f76gy0b8ieo4s693.js";import"./juifnpcp74ymxcu2.js";import"./dvfkv7rxjyuaocsc.js";import"./67527rwulsulsisq.js";import"./deqlmsdlrzobu92w.js";import"./bs910zydm18dg184.js";import"./cz07pchyvxgswt7r.js";import"./dpnr7xd5p38jb3gp.js";import"./fwz0otujtd6fpo4d.js";import"./dxkl0433k1u8ypnz.js";import"./ox7635ffwodpca7w.js";import"./kc32gem4l2t3hnxt.js";import"./of0vtq1gcmd3mc3z.js";import"./irqko7c1s7qpl41n.js";import"./f3alhksm9dfhscbq.js";import"./kubdgxu3crk3gqem.js";import"./kne35xckmmfq3xx6.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./c340ncgh31fwqkpk.js";import"./m3aipoogd94oudzg.js";import"./bwg0lbtx0n9f11bn.js";import"./mtsxj0469osb30cx.js";import"./nc9vr5q4g3rosm9u.js";const tt=()=>(K(),null),ot=R(function(){const e=D(),r=F(),[i]=B(),d=k(),n=T(r.conversationId),a=v(i.get("readonly"),!1),u=v(i.get("isFullScreen"),!1),m=v(i.get("header"),!0),l=v(i.get("appPreview"),!1),C=H(),I=L(),b=v(i.get("hideBottomComposer"),!!a),f=T(r.canmoreId),s=c.useMemo(()=>y(e,n),[e,n]),p=U();c.useEffect(()=>{V({type:P.Textdoc,textdocId:f})},[f]),W(s.id,{kind:N.PrimaryAssistant});const x=A();if(c.useEffect(()=>(j.retainThread(s.id),()=>{setTimeout(()=>{x.invalidateQueries(z({clientThreadId:s.id}))},0),j.releaseThread(s.id)}),[s.id,x]),c.useEffect(()=>{f||d("/")},[f,d]),c.useEffect(()=>{S().sendMessage({type:w.Loaded})},[f]),!f||(p==null?void 0:p.type)!==P.Textdoc)return null;const E=()=>{S().sendMessage({type:w.Close})},M=a&&!m;return t.jsxs("div",{className:"h-full w-full overflow-hidden contain-content",children:[t.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}),t.jsx(Q.Provider,{value:y(e,s.id),children:t.jsx(_,{conversation:s,children:t.jsx(O,{conversation:s,children:t.jsx(J,{clientThreadId:s.id,children:l?t.jsx($,{children:t.jsx(se,{textdocId:p.textdocId})}):M?t.jsxs(t.Fragment,{children:[t.jsx(Y,{clientThreadId:s.id,disableScroll:!C,textdocId:p.textdocId}),t.jsx(Z,{})]}):t.jsx(te,{isEmbedded:!0,hideRunCode:!C,isFullScreen:u,hideHeader:!m,hideBottomComposer:b,isReadonlyFromQueryParam:a,hideRenameButton:I,clientThreadId:s.id,focusedTextdoc:p,onClose:E},"textdocContent")})})})})]})}),se=({textdocId:o})=>{var m;const e=c.useRef(null),r=X(o),[i,d]=c.useState(!1),n=(m=r==null?void 0:r.versions)!=null?m:[],a=G(n),u=c.useCallback(q(async l=>{const C=ee(l.type,l.content);if(e.current&&(C==="react"||C==="html")){d(!0);const s=e.current.evalAsync({language:C,code:l.content});try{for(var re=g(s),I,b,f;I=!(b=await re.next()).done;I=!1){const p=b.value;console.debug(p)}}catch(b){f=[b]}finally{try{I&&(b=re.return)&&await b.call(re)}finally{if(f)throw f[0]}}}d(!1)},100),[]);return c.useEffect(()=>{a&&u(a)},[a,u]),t.jsx(oe,{id:o,visuallyHidden:!i,ref:e,enableTransition:!0,title:""})};export{tt as clientLoader,ot as default};
//# sourceMappingURL=g6pv9zvgb0zh233n.js.map

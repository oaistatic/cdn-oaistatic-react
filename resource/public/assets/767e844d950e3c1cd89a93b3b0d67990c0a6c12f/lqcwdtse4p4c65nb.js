import{c as fe,aj as _e,j as w}from"./mw35uwhq4g8r9eam.js";import{u as Ce,e7 as me,d as b,lE as ge,e1 as ye,pf as pe,ns as te,ed as Ne,qf as Ie,g0 as Oe,g1 as ke,qg as se,qe as Te,ef as oe,ei as ce}from"./d0xa318sl7ywi0za.js";import{ca as Re,cb as re}from"./g2euln7v5pbm31qa.js";function Pe(t){"use forget";var $,B,U,W,V,z,G,Q,F,K,X,Y,H;const e=fe.c(34),o=Ce(),a=me();let d;e[0]!==o?(d=()=>{var c;return(c=Ne(o,{}).data)==null?void 0:c.connectors},e[0]=o,e[1]=d):d=e[1];const r=b(d),ie=r===void 0;let N;e[2]!==o?(N=()=>{var c;return(c=Ie(o,{fetchValidLinksOnly:!0}))==null?void 0:c.data},e[2]=o,e[3]=N):N=e[3];const l=b(N),ae=l===void 0;let I;e[4]!==o?(I=()=>Oe(o),e[4]=o,e[5]=I):I=e[5];const _=b(I);let O;e[6]!==o?(O=()=>ke(o),e[6]=o,e[7]=O):O=e[7];const C=b(O),de=_===void 0||C===void 0,m=ge(),x=ye(),{mutateAsync:h,isSuccess:S}=pe();let k;e[8]===Symbol.for("react.memo_cache_sentinel")?(k={filters:{mutationKey:["upgradeConnectorToSync"]},select:xe},e[8]=k):k=e[8];const L=_e(k);let T;e[9]!==a?(T=a==null?void 0:a.getWorkspaceId(),e[9]=a,e[10]=T):T=e[10];const{totalsByConnectorId:R}=Re(T);let y;if(e[11]!==L){y=new Set;for(const c of L)c.status==="success"&&y.add(c.variables.link.connector_id);e[11]=L,e[12]=y}else y=e[12];const M=y;let v;if(e[13]!==_||e[14]!==M||e[15]!==l||e[16]!==o||e[17]!==C||e[18]!==x||e[19]!==m||e[20]!==t.referrer||e[21]!==r||e[22]!==R||e[23]!==h||e[24]!==S){const c=new Map;for(const n of _!=null?_:[]){const i=(($=l==null?void 0:l.get(n.id))!=null?$:[]).length>0,u=(B=R.get(n.id))!=null?B:0;c.set(n.id,{key:n.id,label:n.name,connected:i,isSync:!1,totalCount:u,icon:w.jsx(re,{connector:n,size:"small"}),onClick:i?void 0:()=>m({connectorId:n.id,noRedirect:!0,referrer:t.referrer})})}for(const n of C!=null?C:[]){const s=n.user_connection_details.connector_id,i=r==null?void 0:r.find(q=>q.id===s);if(!i||!s)continue;const u=(V=(W=i==null?void 0:i.name)!=null?W:(U=n==null?void 0:n.connection_display_info)==null?void 0:U.display_name)!=null?V:"",le=M.has(s),J=((G=s&&((z=c.get(s))==null?void 0:z.connected))!=null?G:!1)||(n==null?void 0:n.user_connection_details.auth_status)==="admin_connected"||(n==null?void 0:n.user_connection_details.auth_status)==="user_connected"||["partially_activated","activated","activating"].includes(n==null?void 0:n.user_connection_details.activation_status)||le,f={key:n.user_connection_details.connection_type,label:u,connected:J,isSync:!0,totalCount:(Q=R.get(s))!=null?Q:0,icon:i?w.jsx(re,{connector:i,size:"small"}):w.jsx("img",{src:x&&((F=n==null?void 0:n.connection_display_info)!=null&&F.icon_dark_url)?(K=n==null?void 0:n.connection_display_info)==null?void 0:K.icon_dark_url:(Y=(X=n==null?void 0:n.connection_display_info)==null?void 0:X.icon_url)!=null?Y:"",alt:u,className:"icon-lg"}),onClick:J?void 0:()=>m({connectorId:s,noRedirect:!0,referrer:t.referrer})};n.user_connection_details.connection_type===te.gdrive_sync_connector?(f.connected=f.connected||S,f.onClick=f.connected?void 0:async()=>{var ee,ne;const q=(ee=r==null?void 0:r.find(be))==null?void 0:ee.id,Z=(ne=l==null?void 0:l.get(se))==null?void 0:ne.find(ue=>ue.connector_id===q);Z?(await h({link:Z,referrer:String(t.referrer)}),setTimeout(()=>{Te(o)},1e3)):m({connectorId:oe[ce.GDRIVE_ACTION_CONNECTOR],noRedirect:!0,referrer:t.referrer})}):n.user_connection_details.connection_type===te.notion_sync_connector&&(f.onClick=f.connected?void 0:()=>m({connectorId:oe[ce.NOTION_CONNECTOR],noRedirect:!0,referrer:t.referrer,syncOnly:!0})),c.set(s,f)}v=Array.from(c.values()),e[13]=_,e[14]=M,e[15]=l,e[16]=o,e[17]=C,e[18]=x,e[19]=m,e[20]=t.referrer,e[21]=r,e[22]=R,e[23]=h,e[24]=S,e[25]=v}else v=e[25];const P=v;let p;if(e[26]!==P){const c=new Map,n=Ae;for(const s of P){const i=String((H=s.label)!=null?H:"").toLowerCase().trim(),u=c.get(i);c.set(i,u?n(u,s):s)}p=Array.from(c.values()),p.sort(Ee),e[26]=P,e[27]=p}else p=e[27];const g=p;let E;e[28]!==g?(E=g.filter(ve),e[28]=g,e[29]=E):E=e[29];const j=E.length,D=de||ae||ie;let A;return e[30]!==j||e[31]!==D||e[32]!==g?(A={uniqueItems:g,connectedCount:j,isLoading:D},e[30]=j,e[31]=D,e[32]=g,e[33]=A):A=e[33],A}function ve(t){return t.connected}function Ee(t,e){var d,r;if(t.connected!==e.connected)return Number(e.connected)-Number(t.connected);const o=Number((d=t.totalCount)!=null?d:0),a=Number((r=e.totalCount)!=null?r:0);return o!==a?a-o:0}function Ae(t,e){var d,r;if(t.connected!==e.connected)return e.connected?e:t;if(t.isSync!==e.isSync)return e.isSync?e:t;const o=Number((d=t.totalCount)!=null?d:0),a=Number((r=e.totalCount)!=null?r:0);return o!==a&&a>o?e:t}function be(t){return t.id===se}function xe(t){return t.state}export{Pe as u};
//# sourceMappingURL=lqcwdtse4p4c65nb.js.map

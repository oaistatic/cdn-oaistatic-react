import{R as _,h as L,r as S,j as e,M as a}from"./mw35uwhq4g8r9eam.js";import{u as D,e7 as P,p as v,aL as b,au as M,D as E,aB as I,dp as N,d$ as T,aA as k,cw as A,fG as R}from"./d0xa318sl7ywi0za.js";import{cu as U,bK as F,bL as H,cv as K,E as z}from"./g2euln7v5pbm31qa.js";import{u as G}from"./ldtpmsnzn9ens47o.js";import"./ohau9tqj1fpdibg0.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./cv4afpu20gjb9dll.js";import"./h4yh1661qhhbu5v5.js";import"./hu1bt0oauegdhua6.js";import"./baz4b8nlf8t2lb95.js";const W="https://help.openai.com/en/articles/11481834",ae=({onClose:r})=>{var j;const[o,u]=_.useState(!1),{prepareCheckoutSession:s,navigateToCheckout:m}=U(),h=D(),t=P(),{country:p}=F(),i=H({country:p,currentAccount:t,location:"CodexCreditPurchaseModal",shouldUsePaidSubscriptionBillingCurrency:!0}),d=(j=t==null?void 0:t.mustGetSubscriptionBillingCurrency("CreditPurchaseModal"))!=null?j:"USD",{data:l,isLoading:x,error:g}=K({ctx:h,currency:d});let n=null;!x&&!g&&l&&(n=l.currencyConfig.amount_per_credit);const f=v(),y=L(),w=S.useCallback(async()=>{if(!o){u(!0);try{const c=t==null?void 0:t.id;if(!c)throw new Error("No account_id found");b.setItem(M.CreditCheckoutRedirectPath,"/codex/settings/usage");const B=await s({credit_purchase_data:{quantity:1e3,unit:"credit",account_id:c},billing_details:i});await m(B)}catch(c){b.removeItem(M.CreditCheckoutRedirectPath),E.addError(c),f.warning(y.formatMessage({id:"components.business.CreditPurchaseModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}),{hasCloseButton:!0})}finally{u(!1)}}},[i,y,o,m,s,f,t]);if(i)return e.jsxs(I,{isOpen:!0,onClose:r,type:"success",size:"custom",noPadding:!0,className:"max-w-xl p-6! pt-3!",showCloseButton:!0,testId:"modal-credit-purchase-modal",children:[e.jsx(N.Header,{className:"p-0! pb-4",title:e.jsx(a,{id:"wham.usageDashboard.metric.creditsAddCredits",defaultMessage:"Buy more messages"})}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(a,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription",defaultMessage:"Use Codex beyond rate limits. Add credits to instantly boost your plan. <u>Learn more</u>",values:{u:c=>e.jsx(T,{href:W,openNewTab:!0,children:c})}})}),e.jsx("div",{className:"flex flex-col",children:n&&e.jsx("div",{className:"mt-6",children:e.jsx(q,{numCredits:1e3,amountPerCredit:n,currency:d})})}),e.jsx(N.Actions,{secondaryButton:e.jsx(k,{disabled:o,onClick:r,color:"secondary",children:e.jsx(a,{id:"components.business.CreditPurchaseModal.cancel",defaultMessage:"Cancel"})}),primaryButton:e.jsx(k,{loading:o,onClick:()=>w(),color:"primary",children:e.jsx(a,{id:"components.business.CreditPurchaseModal.next",defaultMessage:"Next"})})})]})};function q({numCredits:r,amountPerCredit:C,currency:o}){var t,p,i,d,l,x,g,n;const u=Math.round(r*C*100)/100,{data:s,isLoading:m,isError:h}=G(r);return e.jsx("div",{className:"flex w-full flex-col",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-3 rounded-lg border border-gray-200 p-4 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(a,{id:"components.business.CreditPurchaseModal.numCredits",defaultMessage:"{numCredits, plural, one {# credit} other {# credits}}",values:{numCredits:r}})}),e.jsx("span",{className:"flex items-center gap-1",children:h?null:m?e.jsx(z,{className:"h-4 w-48"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.jsx(a,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2",defaultMessage:"{messagesLowerBound}-{messagesUpperBound} CLI or Extension messages",values:{messagesLowerBound:(p=(t=s==null?void 0:s.approx_local_messages)==null?void 0:t[0])!=null?p:0,messagesUpperBound:(d=(i=s==null?void 0:s.approx_local_messages)==null?void 0:i[1])!=null?d:0}})}),e.jsx(A,{label:e.jsxs("div",{className:"text-token-text-primary flex flex-col items-start text-xs",children:[e.jsx("p",{children:e.jsx(a,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2Tooltip1",defaultMessage:"Usage varies by type"})}),e.jsx("p",{children:e.jsx(a,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2Tooltip2",defaultMessage:"Cloud tasks: {messagesLowerBound}-{messagesUpperBound} messages",values:{messagesLowerBound:(x=(l=s==null?void 0:s.approx_cloud_messages)==null?void 0:l[0])!=null?x:0,messagesUpperBound:(n=(g=s==null?void 0:s.approx_cloud_messages)==null?void 0:g[1])!=null?n:0}})})]}),children:e.jsx(R,{className:"icon-sm text-token-text-tertiary"})})]})})]}),e.jsx("p",{className:"text-token-text-secondary font-medium",children:u.toLocaleString("en-US",{style:"currency",currency:o,maximumFractionDigits:2})})]})})}export{ae as CodexCreditPurchaseModal,q as CreditSelectorButtons};
//# sourceMappingURL=o9yk41rn9fs3l9gj.js.map

import{c as Ce,h as ve,r as W,j as s}from"./mw35uwhq4g8r9eam.js";import{eF as Se,aG as me,aF as je,A as Ne}from"./g2euln7v5pbm31qa.js";import{S as ke}from"./l4v2i2dq9gwjak1q.js";import{p as we,eG as Ae,d as Ie,kh as Oe,qU as Ee,dp as he,aB as Te}from"./d0xa318sl7ywi0za.js";import{a as Be}from"./laaag2ef692jond3.js";import{a as Re}from"./k18u5p03syimtxuo.js";import"./mraf0ji5wx0y0vgl.js";import"./fgu1j7e2q9emyzhc.js";import"./ouqfkhwho1d793yt.js";import"./f1b2o8cofuf894iu.js";import"./pbx1h703pubtj7lo.js";import"./c08xobknzytt16by.js";import"./iio0zgk2sqlxbcjy.js";import"./euzz83urne0h11ye.js";import"./e1t6unu3olubcgkg.js";import"./lcy2t692punsnn4q.js";import"./kcu1x1p0wojynl2j.js";import"./icplq4r4g4m9zwmv.js";import"./m2d85ixk2zz51mk9.js";import"./pdbvfcpzcg4ny695.js";import"./ki6jbruunap4y9wd.js";import"./k9kw5016oyk4ib9g.js";import"./lvrypwdhnjlsz45f.js";import"./gywigwwdbkbcgqzt.js";import"./la79eh1q1qxrfcxi.js";import"./i693kfbch8smq86y.js";import"./gy1lpvuoewmzh42c.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./kbj1b07s2z6vxqkg.js";import"./hu1bt0oauegdhua6.js";import"./oj9zwxa6l3kpv1x2.js";import"./h4yh1661qhhbu5v5.js";import"./bymjh2zr7tar40cn.js";import"./bzxitjpdx1z6hpbp.js";import"./nfv7adzg2a3x1oo5.js";import"./nte82mqftpddm52f.js";import"./3xa3aq3nbd1nd678.js";import"./jwvkjd19mng37ttq.js";import"./ffwmresmynw1bm5w.js";import"./dwcyf9zwrp4hlt30.js";import"./d0pdpvvqx24hob9r.js";import"./nc5snhuo5k648r43.js";import"./k527f0oyvlppyfoy.js";import"./nea9sowk1s9pzcpg.js";import"./ey0kaiz1v4k0znjj.js";import"./ht6uzt6gonugd1uu.js";import"./ivhsa3khymuxymxc.js";import"./egtdmf6pnrvsdet3.js";import"./iue4s7sqsxkz98qq.js";function Tt(Y){"use forget";const e=Ce.c(99),{onClose:c,sessionId:d,secret:a,email:ce,onActivated:D,onCancelled:F,renderAsSheet:xe}=Y,de=ce===void 0?"":ce,t=ve(),i=we(),p=Be(),[r,ge]=W.useState(""),[n,Z]=W.useState(null);let Q;e[0]===Symbol.for("react.memo_cache_sentinel")?(Q=Ae(),e[0]=Q):Q=e[0];const[l,Me]=W.useState(Q),[H,pe]=W.useState(!1),be=Ie(Oe),fe=!!xe;let _;e[1]===Symbol.for("react.memo_cache_sentinel")?(_=Ee(),e[1]=_):_=e[1];const ue=_,m=fe&&!ue,X=fe&&ue;let $;e[2]===Symbol.for("react.memo_cache_sentinel")?($=()=>{pe(!0),setTimeout(()=>pe(!1),2e3)},e[2]=$):$=e[2];const ee=$;let q;e[3]!==F||e[4]!==c?(q=()=>{F&&F(),c()},e[3]=F,e[4]=c,e[5]=q):q=e[5];const f=q;let te;e:{if(!a){te="";break e}const o=encodeURIComponent(de?"OpenAI:".concat(de):"OpenAI");let V,K;if(e[6]!==o||e[7]!==a){const ye=new URLSearchParams({secret:a,issuer:"OpenAI"});V=o,K=ye.toString(),e[6]=o,e[7]=a,e[8]=V,e[9]=K}else V=e[8],K=e[9];te="otpauth://totp/".concat(V,"?").concat(K)}const G=te;let J;e[10]!==p||e[11]!==r||e[12]!==t||e[13]!==D||e[14]!==c||e[15]!==d||e[16]!==i?(J=async()=>{try{Z(null),await p.mutateAsync({factor:"totp",code:r.trim(),sessionId:d}),i.success(t.formatMessage({id:"CGNzQD",defaultMessage:"Authenticator app enabled"}),{testId:"totp-mfa-activation-success"}),D&&D(),c()}catch(o){const V=o;Z(t.formatMessage(Re(V)))}},e[10]=p,e[11]=r,e[12]=t,e[13]=D,e[14]=c,e[15]=d,e[16]=i,e[17]=J):J=e[17];const u=J,se=!X,oe=X?"bg-token-bg-primary":void 0,ae=X?"top":void 0,re=m?be?"fit":"fill":void 0,ie=m?"large":void 0,le=m?"h-[max(100svh,100dvh,100%)]":void 0,ne=m?"sm:border-token-border-light! max-sm:h-full max-sm:w-screen max-sm:max-w-none max-sm:rounded-none sm:w-[calc(100vw-2rem)] sm:max-w-[900px] sm:border":void 0;let h;e[18]!==t?(h=t.formatMessage({id:"hvzmYC",defaultMessage:"Connect your authenticator app"}),e[18]=t,e[19]=h):h=e[19];let x;e[20]!==h?(x=s.jsx("span",{className:"text-heading-3",children:h}),e[20]=h,e[21]=x):x=e[21];let g;e[22]!==t?(g=t.formatMessage({id:"nqOq3M",defaultMessage:"Verify"}),e[22]=t,e[23]=g):g=e[23];let M;e[24]!==p||e[25]!==r||e[26]!==d?(M=r.trim().length!==6||!d||p.isPending,e[24]=p,e[25]=r,e[26]=d,e[27]=M):M=e[27];let b;e[28]!==u||e[29]!==g||e[30]!==M?(b=s.jsx(he.Button,{title:g,color:"primary",disabled:M,onClick:u}),e[28]=u,e[29]=g,e[30]=M,e[31]=b):b=e[31];let y;e[32]!==t?(y=t.formatMessage({id:"JEMdlA",defaultMessage:"Cancel"}),e[32]=t,e[33]=y):y=e[33];let C;e[34]!==f||e[35]!==y?(C=s.jsx(he.Button,{title:y,color:"secondary",onClick:f}),e[34]=f,e[35]=y,e[36]=C):C=e[36];let v;e[37]!==t?(v=t.formatMessage({id:"JUk2xI",defaultMessage:"Step 1:"}),e[37]=t,e[38]=v):v=e[38];let S;e[39]!==v?(S=s.jsx("span",{className:"me-1 font-semibold",children:v}),e[39]=v,e[40]=S):S=e[40];let j;e[41]!==t||e[42]!==l?(j=l?t.formatMessage({id:"cmQdj3",defaultMessage:"Enter the secret code below in your authenticator app, then enter the 6-digit code from the app."}):t.formatMessage({id:"NAp5hF",defaultMessage:"Scan the QR code using your authenticator app, then enter the 6-digit code from the app."}),e[41]=t,e[42]=l,e[43]=j):j=e[43];let N;e[44]!==S||e[45]!==j?(N=s.jsxs("div",{className:"text-token-text-primary text-sm",children:[S,j]}),e[44]=S,e[45]=j,e[46]=N):N=e[46];let k;e[47]!==H||e[48]!==t||e[49]!==G||e[50]!==a||e[51]!==l||e[52]!==i?(k=a&&s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"border-token-border-light rounded-2xl border p-5",children:s.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[!l&&G?s.jsx(Se,{value:G,size:180,includeMargin:!0}):null,l&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-token-border-light cursor-pointer rounded-md border px-3 py-2 font-mono text-base break-all select-text",onClick:o=>{me(a,i,o).then(()=>{ee()})},role:"button",tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),me(a,i,o).then(()=>{ee()}))},"aria-label":t.formatMessage({id:"j/bzO/",defaultMessage:"Copy code"}),title:t.formatMessage({id:"2gRO6C",defaultMessage:"Copy code"}),children:a}),s.jsx(je,{shouldChangeText:!1,buttonText:H?t.formatMessage({id:"seLOsT",defaultMessage:"Copied"}):t.formatMessage({id:"v3Cpi4",defaultMessage:"Copy code"}),onCopy:o=>{me(a,i,o).then(()=>{ee()})},className:"text-sm"})]}),s.jsx("button",{type:"button",className:"text-blue-400",onClick:()=>Me(ze),children:l?t.formatMessage({id:"yhrWS1",defaultMessage:"Show QR code instead"}):t.formatMessage({id:"Zqkdz9",defaultMessage:"Trouble scanning?"})})]})})}),e[47]=H,e[48]=t,e[49]=G,e[50]=a,e[51]=l,e[52]=i,e[53]=k):k=e[53];let w;e[54]!==t?(w=t.formatMessage({id:"OtuOes",defaultMessage:"Step 2:"}),e[54]=t,e[55]=w):w=e[55];let A;e[56]!==w?(A=s.jsx("span",{className:"me-1 font-semibold",children:w}),e[56]=w,e[57]=A):A=e[57];let I;e[58]!==t?(I=t.formatMessage({id:"VyVwRC",defaultMessage:"Enter your 6-digit code"}),e[58]=t,e[59]=I):I=e[59];let O;e[60]!==A||e[61]!==I?(O=s.jsxs("div",{className:"text-token-text-primary mt-2 text-sm",children:[A,I]}),e[60]=A,e[61]=I,e[62]=O):O=e[62];let E;e[63]!==u?(E=o=>{o.preventDefault(),u()},e[63]=u,e[64]=E):E=e[64];let T;e[65]!==t?(T=t.formatMessage({id:"f3B3Ii",defaultMessage:"Enter your 6-digit code"}),e[65]=t,e[66]=T):T=e[66];let B;e[67]!==n?(B=o=>{ge(o.target.value),n&&Z(null)},e[67]=n,e[68]=B):B=e[68];let R;e[69]!==r||e[70]!==T||e[71]!==B?(R=s.jsx(Ne,{className:"w-full max-w-md",ariaLabel:!1,name:"totp_otp",placeholder:T,value:r,onChange:B}),e[69]=r,e[70]=T,e[71]=B,e[72]=R):R=e[72];let z;e[73]!==E||e[74]!==R?(z=s.jsx("form",{onSubmit:E,className:"flex w-full justify-start",children:R}),e[73]=E,e[74]=R,e[75]=z):z=e[75];let L;e[76]!==n||e[77]!==t?(L=n&&s.jsxs("p",{className:"flex gap-1 text-xs text-red-500",children:[s.jsx(ke,{title:t.formatMessage({id:"totp.errorIcon",defaultMessage:"Error"})}),n]}),e[76]=n,e[77]=t,e[78]=L):L=e[78];let U;e[79]!==N||e[80]!==k||e[81]!==O||e[82]!==z||e[83]!==L?(U=s.jsx("div",{className:"text-token-text-primary self-stretch text-sm",children:s.jsxs("div",{className:"flex flex-col items-start gap-[16px] self-stretch",children:[N,k,O,z,L]})}),e[79]=N,e[80]=k,e[81]=O,e[82]=z,e[83]=L,e[84]=U):U=e[84];let P;return e[85]!==f||e[86]!==ae||e[87]!==re||e[88]!==ie||e[89]!==le||e[90]!==ne||e[91]!==x||e[92]!==b||e[93]!==C||e[94]!==U||e[95]!==se||e[96]!==oe||e[97]!==m?(P=s.jsx(Te,{testId:"modal-enroll-totp",contentClassName:"!px-6 !pt-6 !pb-[88px] md:!pb-[24px]",headerClassName:"!px-6 !py-0 !h-[76px] !items-center",shouldIgnoreClickOutside:!0,showCloseButton:!0,hasSeparator:!0,isOpen:!0,onClose:f,showOverlayBackground:se,overlayClassName:oe,position:ae,isBottomSheet:m,contentSize:re,topMargin:ie,contentSheetViewClassName:le,className:ne,type:"success",modalActionsClassName:"!mt-[24px]",title:x,primaryButton:b,secondaryButton:C,children:U}),e[85]=f,e[86]=ae,e[87]=re,e[88]=ie,e[89]=le,e[90]=ne,e[91]=x,e[92]=b,e[93]=C,e[94]=U,e[95]=se,e[96]=oe,e[97]=m,e[98]=P):P=e[98],P}function ze(Y){return!Y}export{Tt as EnrollTotpModal};
//# sourceMappingURL=ky8i65mskr0fal07.js.map

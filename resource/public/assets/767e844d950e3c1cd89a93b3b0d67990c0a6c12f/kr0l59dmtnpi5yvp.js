var j=Object.freeze,_=Object.defineProperty,I=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var S=(a,s,e)=>s in a?_(a,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[s]=e,g=(a,s)=>{for(var e in s||(s={}))U.call(s,e)&&S(a,e,s[e]);if(A)for(var e of A(s))q.call(s,e)&&S(a,e,s[e]);return a},v=(a,s)=>I(a,L(s));var h=(a,s)=>j(_(a,"raw",{value:j(s||a.slice())}));import{h as F,r as B,j as t,e as E,M as y,u as G,i as N}from"./mw35uwhq4g8r9eam.js";import{qk as J,n as w,aB as Q,er as K,n$ as O,o0 as V,cF as T,o2 as $,cB as b,aA as H,h4 as D,R}from"./d0xa318sl7ywi0za.js";import{cg as W}from"./g2euln7v5pbm31qa.js";function X(a){const s=G();return N({mutationFn:async({actionId:e,domain:x,settings:l})=>D.upsertUserActionSettings(e,x,l),onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function Y(a){const s=G();return N({mutationFn:async({pluginId:e})=>{await R.safeDelete("/aip/p/{id}/user-settings",{parameters:{path:{id:e}}})},onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const ne=({gizmo:a,onClose:s})=>{const{data:e,isLoading:x}=J(a.gizmo.id,!0),l=F(),[r,m]=B.useState("actions"),d=e!=null&&e.settings.some(i=>i.oauth_status!=null&&a.tools.some(o=>{var n;return o.type===w.JIT_PLUGIN&&((n=o.metadata)==null?void 0:n.action_id)===i.action_id}));return r==="connected_accounts"&&!d&&m("actions"),t.jsx(Q,{testId:"modal-gizmo-privacy-settings",title:l.formatMessage(c.title),isOpen:!0,onClose:s,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:x?t.jsx(K,{}):t.jsxs(O,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:r,onValueChange:i=>{m(i)},children:[d&&t.jsxs(V,{className:T("flex max-w-[200px] min-w-[180px] shrink-0 flex-col gap-2"),children:[t.jsx(z,{value:"actions",message:c.actions}),d&&t.jsx(z,{value:"connected_accounts",message:c.connectedAccounts})]}),t.jsxs("div",{className:"flex-1 text-sm",children:[r==="actions"&&t.jsxs(M,{children:[t.jsx(y,v(g({},c.allowedActionsDesc),{values:{gizmoName:a.gizmo.display.name}})),e==null?void 0:e.settings.map((i,o)=>{var u;const n=(u=a.tools)==null?void 0:u.find(p=>{var f;return p.type===w.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&t.jsx(Z,{gizmoId:a.gizmo.id,actionSettings:i,actionTool:n},o)})]}),r==="connected_accounts"&&t.jsxs(M,{children:[t.jsx(y,v(g({},c.connectedAccountsDesc),{values:{gizmoName:a.gizmo.display.name}})),t.jsx("div",{children:e==null?void 0:e.settings.map((i,o)=>{var u;const n=(u=a.tools)==null?void 0:u.find(p=>{var f;return p.type===w.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&i.oauth_status&&t.jsx(ee,{gizmoId:a.gizmo.id,actionSettings:i,actionTool:n},o)})})]})]})]})})};function z({value:a,message:s}){return t.jsx($,{className:"text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary flex rounded-md px-2 py-1.5 text-sm",value:a,children:t.jsx("div",{className:"truncate",children:t.jsx(y,g({},s))})})}function Z({gizmoId:a,actionSettings:s,actionTool:e}){var m,d,i;const x=X(a),l=(m=s.action_settings)==null?void 0:m.all,r=o=>{var n,u;(n=e.metadata)!=null&&n.action_id&&((u=e.metadata)!=null&&u.domain)&&x.mutateAsync({actionId:e.metadata.action_id,domain:e.metadata.domain,settings:{all:o}})};return t.jsx("div",{children:t.jsxs(C,{className:"border-b border-black/10 dark:border-white/10",children:[t.jsxs("div",{className:"flex flex-row space-x-4",children:[t.jsx("div",{className:"font-semibold",children:(d=e.metadata)==null?void 0:d.domain}),t.jsxs("a",{href:(i=e.metadata)==null?void 0:i.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"text-token-text-tertiary hover:text-token-text-secondary flex items-center gap-1 hover:cursor-pointer",children:[t.jsx(y,g({},c.privacyPolicyLink)),t.jsx(W,{className:"icon"})]})]}),t.jsxs("select",{value:l?"always_allow":"unset",onChange:o=>r(o.target.value),className:"bg-token-main-surface-primary rounded-sm border-none text-sm",children:[t.jsx("option",{value:"always_allow",children:t.jsx(y,g({},c.alwaysAllowDropdown))}),t.jsx("option",{value:"unset",children:t.jsx(y,g({},c.askDropdown))})]})]})})}function ee({gizmoId:a,actionSettings:s,actionTool:e}){var r;const x=Y(a),l=s.oauth_status==="valid";return t.jsxs(C,{children:[t.jsx("div",{className:"font-semibold",children:(r=e==null?void 0:e.metadata)==null?void 0:r.domain}),t.jsx(H,{color:"secondary",size:"small",onClick:()=>{var m,d,i,o,n;(m=e.metadata)!=null&&m.action_id&&((d=e.metadata)!=null&&d.domain)&&(l?x.mutateAsync({pluginId:(i=e.metadata)==null?void 0:i.action_id}):D.doOAuthRedirect(a,(o=e.metadata)==null?void 0:o.action_id,(n=e.metadata)==null?void 0:n.domain,window.location.href))},children:t.jsx(y,g({},l?c.logout:c.login))})]})}var k;const M=b.div(k||(k=h(["flex flex-col gap-6"])));var P;const C=b.div(P||(P=h(["flex flex-row justify-between py-3 items-center"]))),c=E({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}});export{ne as default};
//# sourceMappingURL=kr0l59dmtnpi5yvp.js.map

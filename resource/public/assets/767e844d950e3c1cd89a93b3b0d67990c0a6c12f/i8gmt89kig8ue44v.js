var J=Object.defineProperty,$=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var F=(o,t,a)=>t in o?J(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,u=(o,t)=>{for(var a in t||(t={}))K.call(t,a)&&F(o,a,t[a]);if(R)for(var a of R(t))X.call(t,a)&&F(o,a,t[a]);return o},b=(o,t)=>$(o,G(t));import{h as Y,u as Z,r as M,i as ee,j as e,M as L}from"./mw35uwhq4g8r9eam.js";import{m as se,o as te,p,q as ae,L as oe,H as ie,D as ne,t as re,W as A}from"./g2euln7v5pbm31qa.js";import{E as le}from"./dejzmw8nrz6tr491.js";import{dz as ce,u as de,p as ue,R as pe,dy as xe,ek as me,e5 as fe,h5 as ge,aA as he}from"./d0xa318sl7ywi0za.js";import{u as we}from"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";function ke(){return e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsxs("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:[e.jsx(A,{},1),e.jsx(A,{},2)]})})}function Se({onClose:o,mode:t="blocking",section:a="existing",source:_="unknown"}){var E,C;const{data:m,isFetching:H}=we(),n=ce(),I=(E=n==null?void 0:n.email)!=null?E:"",f=Y(),V=de(),P=(n==null?void 0:n.email_domain_type)==="professional",y=a==="existing"||a==="both",x=(a==="discoverable"||a==="both")&&P,{data:r,isFetching:z}=se(x),B=Z(),[T,g]=M.useState(null),U=ue(),{setHasSeenWorkspaceDiscoveryFirstLoginDontInvalidateCache:h}=te(),N=ee({mutationFn:async s=>{await pe.safePost("/accounts/{account_id}/invites/request",{parameters:{path:{account_id:s}}})},onSuccess:(s,i)=>{B.setQueryData(["discoverable-workspaces"],c=>c!=null&&c.workspaces?b(u({},c),{workspaces:c.workspaces.map(j=>j.id===i?b(u({},j),{requested:!0}):j)}):c)},onError:(s,i)=>{g(null),U.danger(f.formatMessage(p.requestAccessError),{toastId:"request-access-".concat(i)})},onSettled:()=>{g(null)}}),D=x&&!!(r!=null&&r.has_more),d=y&&H||x&&z,l=[];if(y&&l.push(...(m!=null?m:[]).map(s=>({type:"existing",w:s}))),x){const s=(C=r==null?void 0:r.workspaces)!=null?C:[];l.push(...s.map(i=>({type:"discoverable",w:i})))}const w=l.filter(s=>s.type==="existing").length,k=l.filter(s=>s.type==="discoverable").length,{hasLoggedFullscreenView:W,logFullscreenViewedOnce:q,logExitEvent:v,logRequestButtonClicked:O,logRequestButtonHovered:Q}=ae({source:_,existingCount:w,discoverableCount:k});if(M.useEffect(()=>{!W&&!d&&q()},[W,q,d]),t==="blocking"&&w===0&&!d)return null;const S=xe(V,"2133596510").get("enabled",!1);return e.jsx(me,{children:e.jsx(fe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4},"data-testid":"fullscreen-workspace-switcher",className:"bg-token-bg-primary absolute inset-0 start-0 top-0 z-50 h-full w-full",role:"dialog","aria-modal":"true","aria-label":f.formatMessage(p.title),children:e.jsxs("div",{className:"flex h-full max-h-full flex-col",children:[t==="dismissible"&&e.jsx("div",{className:"absolute end-4 top-4",children:e.jsx("button",{type:"button","aria-label":f.formatMessage(p.close),onClick:()=>{h(),v("close"),o()},className:"rounded-full p-2 hover:bg-transparent",children:e.jsx(ge,{className:"icon"})})}),e.jsx("div",{className:"flex flex-1 items-start justify-center px-6 pt-[15vh] pb-12",children:e.jsxs("div",{className:"flex w-[440px] flex-col items-center",children:[d?e.jsxs(e.Fragment,{children:[e.jsx(oe,{showCollaborationSubtitle:S}),e.jsx(ke,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{existingCount:w,discoverableCount:k,accountEmail:I,showCollaborationSubtitle:S}),l.length>0&&e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsx("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:l.map(s=>s.type==="existing"?e.jsx(le,{workspace:s.w,onOpen:()=>{h(),v("open_workspace")}},s.w.id):e.jsx(ne,{workspace:s.w,isLoading:N.isPending&&T===s.w.id,onHoverRequest:i=>{Q(i)},onRequestAccess:i=>{g(i.id),O(i),N.mutate(i.id)}},s.w.id))})})]}),a==="discoverable"&&k===0&&!d&&e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex w-full flex-col rounded-2xl border py-20",children:e.jsx("div",{className:"text-token-text-secondary text-center text-sm",children:e.jsx(L,u({},p.noWorkspacesToJoin))})})}),t==="dismissible"&&e.jsx("div",{className:"mt-4 w-full",children:e.jsx(he,{fullWidth:!0,onClick:()=>{h(),v("close"),o()},children:e.jsx(L,u({},p.done))})}),e.jsx(re,{showHiddenWorkspacesNote:D})]})})]})})})}export{Se as default};
//# sourceMappingURL=i8gmt89kig8ue44v.js.map

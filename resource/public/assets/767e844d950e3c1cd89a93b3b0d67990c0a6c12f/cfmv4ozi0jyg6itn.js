import{d as R}from"./fdzi2sym03eufaos.js";import{E as L,b as T}from"./na97s5us80xgwiaa.js";import{F as y,c as _,p as g,a as A,b as M,d as E}from"./bxq8qdjlrkpqhzqu.js";function C(t=0){return t>0?t:self.devicePixelRatio||1}async function F(t,w,u=404,h=0){const e=C(h),n=t.widthEmu*L,f=t.heightEmu*L,a=Math.min(1,u/Math.max(n,f)),m=Math.round(n*a*e),c=Math.round(f*a*e),x=new OffscreenCanvas(m,c),s=x.getContext("2d");if(!s)throw new Error("Failed to create 2D context");s.scale(e*a,e*a),await R(t,w,s,[]);const p=await x.convertToBlob({type:"image/png"});return new Promise(d=>{const i=new FileReader;i.onload=()=>d(i.result),i.readAsDataURL(p)})}async function H(t,w=20,u=10,h=0,e){const n=C(h),f=80,a=20,m=new OffscreenCanvas(u*f*n,w*a*n),c=m.getContext("2d");if(!c)return Promise.resolve("");c.scale(n,n);const s=Array(50).fill(y);for(const o of t.columns){const l=_(o.width);for(let r=o.min-1;r<o.max;r++)s[r]=l}const d=Array(50).fill(g(t.defaultRowHeight||A));for(const o of t.rows)o.customHeight&&(d[o.index-1]=g(o.height));const i=M(e);E(c,t,s,d,0,0,800,400,null,null,1,i,{},new Set,new Set,!1,e,T({colorScheme:{name:"default",colors:[]},lineStyleList:[],effectStyleList:[]}),!1);const P=await m.convertToBlob({type:"image/png"});return new Promise(o=>{const l=new FileReader;l.onload=()=>{var r,b;return o((b=(r=l.result)==null?void 0:r.toString())!=null?b:"")},l.readAsDataURL(P)})}export{H as a,F as s};
//# sourceMappingURL=cfmv4ozi0jyg6itn.js.map

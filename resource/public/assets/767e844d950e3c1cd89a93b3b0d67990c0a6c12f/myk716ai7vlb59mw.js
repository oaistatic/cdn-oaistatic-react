var J=Object.defineProperty,ee=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var V=(a,t,s)=>t in a?J(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,C=(a,t)=>{for(var s in t||(t={}))se.call(t,s)&&V(a,s,t[s]);if(B)for(var s of B(t))oe.call(t,s)&&V(a,s,t[s]);return a},h=(a,t)=>ee(a,ne(t));import{h as te,r as f,j as e,M as k}from"./mw35uwhq4g8r9eam.js";import{u as ce,e1 as ae,lE as ie,d as x,g0 as le,g1 as re,pf as de,f_ as ue,ed as ge,qf as pe,qz as fe,er as W,ns as v,ef as Q,ei as w,qA as xe,qe as X,qg as H,d_ as _e,aL as ye,aB as me,e4 as Ce,cF as K,aA as Y}from"./d0xa318sl7ywi0za.js";import{c7 as he,cb as ke,bp as ve,aZ as Ne,at as be}from"./g2euln7v5pbm31qa.js";function Me({onClose:a,onContinue:t}){const s=ce(),A=ae(),N=te(),{openSettings:I}=he(),_=ie(),[b,Z]=f.useState(!1),r=x(()=>le(s)),E=!r,d=x(()=>re(s)),R=d===void 0,{mutateAsync:L,isPending:P,isSuccess:j}=de(),u=x(()=>ue(s)),g=x(()=>{var n;return(n=ge(s,{}).data)==null?void 0:n.connectors}),D=g===void 0,p=x(()=>pe(s,{fetchValidLinksOnly:!0}).data),q=p===void 0,G=f.useMemo(()=>{const n=new Set(r==null?void 0:r.map(c=>c.type)),y=new Set(d==null?void 0:d.map(c=>"".concat(c.user_connection_details.connection_type))),i=new Set(fe().filter(c=>n.has(c)||y.has(c)));return Array.from(i).slice(0,5)},[r,d]),S=f.useMemo(()=>{var y;const n=[];if(E||D||q||R)return Array.from({length:5},(i,c)=>({icon:e.jsx(W,{}),label:"",key:"loading-"+c,connected:!1,onClick:void 0,loading:void 0}));for(const i of G){const c=r.find(o=>o.type===i);if(c){const o=u!=null&&u.has(c.type);n.push({icon:e.jsx(ke,{connector:c,size:"small"}),label:c.name,key:c.type,connected:o,onClick:o?void 0:()=>{_({connectorId:c.id,noRedirect:!0})},loading:void 0})}const l=[...d].find(o=>i===v.notion_sync_connector?o.user_connection_details.connection_instance_id.startsWith("ks--merge")&&o.user_connection_details.connection_type===i:o.user_connection_details.connection_type===i);if(l){const o=["partially_activated","activated","activating"].includes(l.user_connection_details.activation_status),m={icon:e.jsx("img",{src:A&&l.connection_display_info.icon_dark_url?l.connection_display_info.icon_dark_url:(y=l.connection_display_info.icon_url)!=null?y:"",alt:l.connection_display_info.display_name,className:"icon-lg"}),label:l.connection_display_info.display_name,key:l.user_connection_details.connection_type,connected:o,loading:void 0};i===v.notion_sync_connector?n.push(h(C({},m),{connected:o||!!(u!=null&&u.has(w.NOTION_CONNECTOR)),onClick:o?void 0:()=>{_({connectorId:Q[w.NOTION_CONNECTOR],noRedirect:!0,syncOnly:!0})}})):i===v.slack_sync_connector?n.push(h(C({},m),{connected:o||b,label:"Slack",onClick:o||b?void 0:async()=>{const{success:T}=await xe({connectorType:"slack",connectionId:l.user_connection_details.connection_instance_id,location:"user_nux_modal",intl:N});T&&(Z(!0),setTimeout(()=>{X(s)},1e3))}})):i===v.gdrive_sync_connector?n.push(h(C({},m),{connected:o||j,loading:P,label:"Google Drive",onClick:o||j?void 0:async()=>{var F,U;const T=(F=g==null?void 0:g.find(M=>M.id===H))==null?void 0:F.id,z=(U=p==null?void 0:p.get(H))==null?void 0:U.find(M=>M.connector_id===T);z?(await L({link:z,referrer:"glaux_nux_modal"}),setTimeout(()=>{X(s)},1e3)):_({connectorId:Q[w.GDRIVE_ACTION_CONNECTOR],noRedirect:!0})}})):n.push(m)}}return n.push({icon:e.jsx(ve,{className:"icon-lg"}),label:N.formatMessage({id:"+rj0FA",defaultMessage:"More apps"}),key:"more-apps",onClick:()=>{I(_e.Connectors)}}),n},[s,E,D,q,R,N,G,r,d,u,_,A,b,j,P,g,p,L,I]),O=f.useMemo(()=>S.filter(n=>n.connected),[S]),$=f.useCallback(()=>{ye.setItem("oai/apps/connectors/glauxOnboarding",new Date().getTime()),a(!1),t()},[t,a]);return e.jsxs(me,{className:"max-w-[480px] pb-8",hideSeparator:!0,isOpen:!0,onClose:()=>a(!1),showCloseButton:!1,testId:"modal-glaux-nux",type:"success",children:[e.jsx("div",{className:"flex justify-end pb-6",children:e.jsx(Ce,{onClick:()=>a(!1)})}),e.jsxs("div",{className:"flex flex-col px-8",children:[e.jsx("div",{className:"text-center text-2xl font-semibold",children:e.jsx(k,{id:"uXSq7y",defaultMessage:"Enable internal knowledge"})}),e.jsx("div",{className:"text-token-text-secondary mt-2 text-center",children:e.jsx(k,{id:"KyWNjA",defaultMessage:"Connect these apps for the best experience"})}),e.jsx("div",{className:"grid grid-cols-3 gap-2 py-10",children:S.map(n=>e.jsxs("div",{className:K("border-token-border-secondary flex grow flex-col gap-2 rounded-xl border p-3",n.onClick?"hover:bg-token-bg-tertiary cursor-pointer":""),onClick:n.onClick,children:[e.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:n.icon}),typeof n.connected=="boolean"?e.jsx("div",{className:"bg-token-bg-tertiary h-5 w-5 rounded-full",children:e.jsx("div",{className:K("flex h-full w-full items-center justify-center rounded-full",n.connected?"bg-blue-400":"bg-token-bg-tertiary"),children:n.loading?e.jsx(W,{}):n.connected?e.jsx(Ne,{className:"icon-xs fill-white"}):e.jsx(be,{className:"icon-xs"})})}):null]}),e.jsx("div",{className:"text-token-text-secondary mt-3 line-clamp-1 text-sm",children:n.label})]},n.key))}),e.jsx("div",{className:"flex flex-col gap-3",children:O.length<5&&O.length>0?e.jsx(Y,{onClick:$,size:"large",children:e.jsx(k,{id:"vec4yt",defaultMessage:"Continue with limited apps"})}):e.jsx(Y,{disabled:O.length<5,onClick:$,size:"large",children:e.jsx(k,{id:"MCrtpI",defaultMessage:"Continue"})})})]})]})}export{Me as GlauxNuxModal};
//# sourceMappingURL=myk716ai7vlb59mw.js.map

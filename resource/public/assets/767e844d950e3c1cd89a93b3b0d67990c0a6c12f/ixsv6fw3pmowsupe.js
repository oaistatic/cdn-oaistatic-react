const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/c7twthby4tcyhk4o.js","assets/mw35uwhq4g8r9eam.js","assets/pubq154p96h0wzc4.js","assets/juifnpcp74ymxcu2.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/je2fy8gnwj5wx4yy.js","assets/go83k4bw3m46lwwg.js","assets/g2euln7v5pbm31qa.js","assets/conversation-small-lq38g8zw.css","assets/ce3hgmw4iyyhicud.js","assets/krza42hj097hj350.js","assets/ns51nblw8ziscsgd.js","assets/c8dilzb1umlthpuq.js","assets/eg4jdclswoidzo1l.js","assets/f76gy0b8ieo4s693.js","assets/fd8selpa9l1l2dzd.js","assets/f5lfl2gmtl8dkh1o.js","assets/b9m0h1g72p9whl0h.js","assets/comments-plugin-tah3dlup.css","assets/codemirror-oguffqvb.css","assets/fwz0otujtd6fpo4d.js","assets/ccdelfl27o3fxeuu.js","assets/ehv2vkvc6wjiqj3r.js","assets/fwnz3uo9oosy1mt7.js","assets/dxkl0433k1u8ypnz.js","assets/ox7635ffwodpca7w.js","assets/dvfkv7rxjyuaocsc.js","assets/67527rwulsulsisq.js","assets/deqlmsdlrzobu92w.js","assets/mstl8wgfzorpgdoe.js","assets/pcrw7exsshz05v7h.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/cfgm997jt4en0fjd.js","assets/deakbbf27g8e7ba0.js","assets/d4h15g77ywnnjdmi.js","assets/obs7vyhux2j83kng.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/i73v6n7xsf322y5k.js","assets/nl4yxhv48cbxowcu.js","assets/l57v5lxkpqo9adh3.js","assets/iakh052vusklquwn.js","assets/i1lnixtvuwzfguvz.js","assets/gy1lpvuoewmzh42c.js","assets/h4yh1661qhhbu5v5.js","assets/hu1bt0oauegdhua6.js","assets/kbj1b07s2z6vxqkg.js","assets/h1em0bjkpkjv8ykw.js","assets/oj9zwxa6l3kpv1x2.js","assets/bwg0lbtx0n9f11bn.js","assets/cv4afpu20gjb9dll.js","assets/mojznsm1zll43nmv.js","assets/mzril1pzbts3gz7n.js","assets/iknugp00locgtve5.js","assets/lep2wptoy14cfe2w.js","assets/pvi9p0c51odp9xiw.js","assets/pe4e1ebqw6qlpge9.js","assets/ejv9rjzfbwh1dn9a.js","assets/prosemirror-egdr15sq.css","assets/bs910zydm18dg184.js","assets/cz07pchyvxgswt7r.js","assets/dpnr7xd5p38jb3gp.js","assets/e0d69s7tsq37k47r.js","assets/h7tudz5piofu9rem.js","assets/kcex4rnzaebpwef1.js","assets/ohau9tqj1fpdibg0.js","assets/i693kfbch8smq86y.js"])))=>i.map(i=>d[i]);
var Z=Object.defineProperty;var N=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var A=(e,n,t)=>n in e?Z(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,O=(e,n)=>{for(var t in n||(n={}))Q.call(n,t)&&A(e,t,n[t]);if(N)for(var t of N(n))V.call(n,t)&&A(e,t,n[t]);return e};import{j as l,r as C,_ as w,h as H,e as ee,c as ne,g as te,i as oe}from"./mw35uwhq4g8r9eam.js";import{Z as se,C as G}from"./ce3hgmw4iyyhicud.js";import{e5 as ae,cF as g,cy as U,h5 as le,ek as ie,be as W,n_ as $,p as X,u as q,Q as Y,D as re,R as ce,_ as k}from"./d0xa318sl7ywi0za.js";import{X as ue,dL as fe,c8 as pe,xG as me,g8 as s,g4 as de,g7 as _,g5 as be,f7 as Ee,aZ as xe,bu as Ce,xH as ge,pw as M,px as ye,aG as he,vH as J,xI as Te}from"./g2euln7v5pbm31qa.js";import{b as j}from"./mstl8wgfzorpgdoe.js";import{_ as _e,a as De,b as Oe,c as ve,u as Le,B as Se,d as we}from"./pcrw7exsshz05v7h.js";import{u as Ie}from"./cfgm997jt4en0fjd.js";import{c as Ne}from"./krza42hj097hj350.js";import{u as Ae}from"./c8dilzb1umlthpuq.js";import{d as ke}from"./deakbbf27g8e7ba0.js";import{s as z}from"./d4h15g77ywnnjdmi.js";import{d as v}from"./kl7c6054usfnqmd4.js";import{g as Me}from"./k97n0y6ba9c9h39c.js";function je({className:e,zIndexKey:n,onClick:t}){return l.jsx(ae.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:g("absolute inset-0",e,se[n]),onClick:t})}function Re({zIndexKey:e,onClick:n}){return l.jsx(je,{zIndexKey:e,onClick:n,className:"bg-gray-50/50 dark:bg-black/50"})}function Pe(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];e&&typeof e!="function"?console.error('react-scroll-to-bottom: First argument passed to "useObserveScrollPosition" must be a function.'):_e(t)||console.error('react-scroll-to-bottom: Second argument passed to "useObserveScrollPosition" must be an array if specified.');var o=De(),a=o.observeScrollPosition;C.useEffect(function(){return e&&a(e)},Oe(n=[]).call(n,ve(t),[!e,a]))}function Fe(){var e=Le(),n=e.scrollToTop;return n}const Be=({onScroll:e})=>(Pe(({scrollTop:n})=>{e==null||e(n)}),null),He=({shouldScrollToTop:e})=>{const n=Fe();return C.useEffect(()=>{e===!0&&n({behavior:"smooth"})},[e,n]),null},Ge=()=>{const e=Ie();C.useEffect(()=>{e({behavior:"smooth"})},[e]);const[n]=we();return n?null:l.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"border-token-border-default bg-token-main-surface-primary text-token-text-secondary absolute end-1/2 bottom-5 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border bg-clip-padding",children:l.jsx(pe,{className:"icon text-token-text-primary"})})};function Ue({children:e,onScroll:n,shouldScrollToTop:t,scrollToBottomMode:o="top",isLoading:a=!1,header:r,height:i="auto",overlay:u,hideChildren:p=!1,disableScroll:b=!1,ref:m,onCopy:E}){const c=l.jsx("div",{onCopy:E,className:g(p?"hidden":"block",i==="auto"?"h-auto":"h-full"),children:e});return l.jsxs("section",{ref:m,className:g("relative flex min-h-0 flex-auto grow flex-col",b&&"overflow-hidden"),children:[l.jsx(ie,{children:a&&l.jsx(Re,{zIndexKey:"textdocDiffLoadingOverlay"})}),!b&&l.jsxs(Se,{followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:"flex flex-col",className:"h-full",mode:o,children:[r,c,u&&l.jsx("div",{className:"pointer-events-none w-full flex-1",children:u}),o==="bottom"&&l.jsx(Ge,{}),l.jsx(Be,{onScroll:n}),l.jsx(He,{shouldScrollToTop:t})]}),b&&l.jsxs(l.Fragment,{children:[r,c,u&&l.jsx("div",{className:"pointer-events-none h-full w-full",children:u})]})]})}function We({className:e,children:n}){return l.jsx("header",{className:g(e,"touch:px-2.5 h-header-height flex flex-none items-center justify-between gap-1 px-2"),children:n})}function $e({className:e,children:n,size:t="lg",bold:o}){return l.jsx("h2",{className:g(e,"text-token-text-primary truncate",o?"font-bold":"font-normal",t==="lg"&&"text-lg",t==="base"&&"text-base"),children:n})}const Xe=({onClick:e})=>{const t=U()?fe:le;return l.jsx(ue,{icon:t,onClick:e})},R=e=>{const{r:n,g:t,b:o}=j.toRGBA(j.parse(e));return(n*299+t*587+o*114)/1e3<125},D=({children:e,isPreviewingCode:n=!1,transitionBackground:t=!1,previewBackgroundColor:o=null})=>{const a=n&&o&&R(o),r=n&&o&&!R(o);return l.jsx("section",{className:g("popover flex h-full w-full flex-col",t&&"transition-colors",a&&"dark",r&&"light",n?"bg-[rgba(249,249,249,1)] dark:bg-[rgba(33,33,33,1)]":"bg-transparent"),style:{backgroundColor:n&&o?o:void 0},children:e})};D.Title=$e;D.CloseButton=Xe;D.Header=We;D.Content=Ue;const qe=W(()=>w(()=>import("./c7twthby4tcyhk4o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])).then(e=>e.CodeComposer),{loading:()=>l.jsx("div",{className:G.code,children:l.jsx("div",{className:"h-full w-full px-4",children:l.jsx($,{lines:20})})})}),Dn=e=>l.jsx(qe,O({},e)),On=(e=[])=>e.filter(({status:n})=>n!==me.DISMISSED);var Ye=(e=>(e.ALL_HIDDEN="all_hidden",e.COMMENTS_READONLY="comments_readonly",e.ENABLED="enabled",e))(Ye||{});const P=775,Je=580,ze=36,Ke=18,vn=24,Ln=16,Ze=({numLines:e=20})=>{const[{width:n},t]=Ae(),o=U(),a=n>=P+Ne?P:Je,r=o?Ke:ze;return l.jsx("div",{className:g(G.document,"mt-4"),ref:t,style:{margin:"0 ".concat(r,"px")},children:l.jsx("div",{style:{width:a},children:l.jsx($,{lines:e})})})},Qe=W(()=>w(()=>import("./i73v6n7xsf322y5k.js"),__vite__mapDeps([41,1,42,4,5,17,3,16,11,8,9,12,10,13,18,15,7,14,19,43,38,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,21,22,23,24,25,26,62,63,64,65,30,31,32,33,34,35,36,37,39,40])).then(e=>e.DocumentComposer),{loading:({value:e,width:n=window.innerWidth})=>l.jsx(Ze,{numLines:Math.min(Math.ceil(e.length/(n/8)),30)})}),Sn=e=>l.jsx(Qe,O({},e));var T=(e=>(e.ADDED="added",e.REMOVED="removed",e.UNCHANGED="unchanged",e))(T||{});function I(e){if(e==="")return 0;const n=e.split("\n").length;return e.endsWith("\n")?n-1:n}function Ve(e,n){return ke(e,n,{newlineIsToken:!0}).map(o=>{var a;return{count:(a=o.count)!=null?a:I(o.value),value:o.value,type:o.added?"added":o.removed?"removed":"unchanged"}})}function en(e){let n="";for(const{type:t,value:o}of e)(t==="added"||t==="unchanged")&&(n+=o);return n}function nn(e,n){const t=I(n),o=sn(e,t);return{changes:Ve(o,n),numLinesDiffed:t}}function tn(e){const n=[...e],t=[],o=[];for(;n.length>0;){const a=n[n.length-1];if(a.type===T.REMOVED)n.pop(),a.type===T.REMOVED&&t.unshift(a);else if(a.type===T.ADDED)n.pop(),o.unshift(a);else break}return{prunedChanges:[...n,...o],prunedRemovedChanges:t}}function on(e,n){const{changes:t,numLinesDiffed:o}=nn(e,n),{prunedChanges:a,prunedRemovedChanges:r}=tn(t),i=en(a),u=r.map(b=>b.value).join("\n"),p=K(e,o,"start");return{content:i+u+p,numLinesDiffed:I(i)}}function sn(e,n){if(n<=0)return"";let t=0,o=e.length;for(let a=0;a<e.length;a++)if(e[a]==="\n"&&(t++,t===n)){o=a+1;break}return e.substring(0,o)}function K(e,n,t="start"){if(n<=0)return e;if(t==="start"){let i=0;for(let u=0;u<e.length;u++)if(e[u]==="\n"&&(i++,i===n))return e.substring(u+1);return""}let o=0,a=-1;const r=e.endsWith("\n")?n+1:n;for(let i=e.length-1;i>=0;i--)if(e[i]==="\n"&&(o++,o===r)){a=i;break}return a===-1?"":e.substring(0,a+1)}function wn(e,n){var u,p;const t=(u=e==null?void 0:e.type)!=null?u:s.LOADING,o=(p=e==null?void 0:e.content)!=null?p:"",a=de(e);if(!_(t)||n==null||!a||!be(e))return{content:o,currentlyStreamingLineIndex:null};const r=K(o,1,"end");if(r==="")return{content:n.content,currentlyStreamingLineIndex:0};const i=on(n.content,r);return{content:i.content,currentlyStreamingLineIndex:i.numLinesDiffed}}function an(e){"use forget";const n=ne.c(8),{textdocVersion:t,clientThreadId:o}=e,a=q();let r;n[0]!==t?(r=m=>t&&(m==null?void 0:m.lastCanvasAssistantMessageById[t.textdocId]),n[0]=t,n[1]=r):r=n[1];const i=ge(r),u=t==null?void 0:t.type,p=t!=null;let b;return n[2]!==o||n[3]!==a||n[4]!==p||n[5]!==i||n[6]!==u?(b=m=>{if(!m.selectedText)return;const E=Y(o);p&&E!=null&&i!=null&&J(a,{type:"copy",source:m.source,location:"canvas",selectedText:m.selectedText,messageId:i,serverThreadId:E,contentType:u!=null&&_(u)?"code":"text",productLogOnly:m.productLogOnly})},n[2]=o,n[3]=a,n[4]=p,n[5]=i,n[6]=u,n[7]=b):b=n[7],b}function In({textdocVersion:e,clientThreadId:n}){var m;const t=H(),o=X(),[a,r]=C.useState(!1),i=Ee(),u=an({textdocVersion:e,clientThreadId:n}),p=C.useRef((m=e==null?void 0:e.content)!=null?m:"");return C.useEffect(()=>{var E;p.current=(E=e==null?void 0:e.content)!=null?E:""},[e]),{handleCopy:E=>{a||(i(async()=>{const c=await z(p.current);u({source:"mouse",selectedText:c}),M.logButtonClick(ye.COPY,{contentLength:c.length,textdocType:e==null?void 0:e.type});let f={"text/plain":c};if((e==null?void 0:e.type)===s.DOCUMENT)try{const{markdownToClipboardContent:d}=await w(async()=>{const{markdownToClipboardContent:x}=await import("./h7tudz5piofu9rem.js");return{markdownToClipboardContent:x}},__vite__mapDeps([66,4,1,5,67,8,9,44,45,46,47,48,49,50,51,68,56,53,69,57]));f=d(c,[])}catch(d){M.logError("Error copying rich text",d)}he(f,o,E)},0),r(!0),i(()=>r(!1),2e3))},Icon:a?xe:Ce,copyLabel:t.formatMessage(ln.copy)}}const ln=ee({copy:{id:"rbIYfo",defaultMessage:"Copy"}}),F={[s.CODE_BASH]:{filenameExtension:"sh",blobType:"text/x-shellscript"},[s.CODE_ZSH]:{filenameExtension:"zsh",blobType:"text/x-shellscript"},[s.CODE_JAVASCRIPT]:{filenameExtension:"js",blobType:"application/javascript"},[s.CODE_TYPESCRIPT]:{filenameExtension:"ts",blobType:"application/typescript"},[s.CODE_HTML]:{filenameExtension:"html",blobType:"text/html"},[s.CODE_CSS]:{filenameExtension:"css",blobType:"text/css"},[s.CODE_PYTHON]:{filenameExtension:"py",blobType:"text/x-python"},[s.CODE_JSON]:{filenameExtension:"json",blobType:"application/json"},[s.CODE_SQL]:{filenameExtension:"sql",blobType:"application/sql"},[s.CODE_GO]:{filenameExtension:"go",blobType:"text/x-go"},[s.CODE_YAML]:{filenameExtension:"yaml",blobType:"application/x-yaml"},[s.CODE_JAVA]:{filenameExtension:"java",blobType:"text/x-java-source"},[s.CODE_RUST]:{filenameExtension:"rs",blobType:"text/rust"},[s.CODE_CPP]:{filenameExtension:"cpp",blobType:"text/x-c++src"},[s.CODE_SWIFT]:{filenameExtension:"swift",blobType:"text/swift"},[s.CODE_PHP]:{filenameExtension:"php",blobType:"application/x-httpd-php"},[s.CODE_XML]:{filenameExtension:"xml",blobType:"application/xml"},[s.CODE_RUBY]:{filenameExtension:"rb",blobType:"text/x-ruby"},[s.CODE_HASKELL]:{filenameExtension:"hs",blobType:"text/x-haskell"},[s.CODE_KOTLIN]:{filenameExtension:"kt",blobType:"text/x-kotlin"},[s.CODE_CSHARP]:{filenameExtension:"cs",blobType:"text/x-csharp"},[s.CODE_C]:{filenameExtension:"c",blobType:"text/x-csrc"},[s.CODE_OBJECTIVEC]:{filenameExtension:"m",blobType:"text/x-objectivec"},[s.CODE_R]:{filenameExtension:"r",blobType:"text/plain"},[s.CODE_LUA]:{filenameExtension:"lua",blobType:"text/x-lua"},[s.CODE_DART]:{filenameExtension:"dart",blobType:"text/x-dart"},[s.CODE_SCALA]:{filenameExtension:"scala",blobType:"text/x-scala"},[s.CODE_PERL]:{filenameExtension:"pl",blobType:"text/x-perl"},[s.CODE_COMMONLISP]:{filenameExtension:"lisp",blobType:"text/x-common-lisp"},[s.CODE_CLOJURE]:{filenameExtension:"clj",blobType:"text/x-clojure"},[s.CODE_OCAML]:{filenameExtension:"ml",blobType:"text/x-ocaml"},[s.CODE_POWERSHELL]:{filenameExtension:"ps1",blobType:"text/x-powershell"},[s.CODE_VERILOG]:{filenameExtension:"v",blobType:"text/x-verilog"},[s.CODE_DOCKERFILE]:{filenameExtension:"Dockerfile",blobType:"text/x-dockerfile"},[s.CODE_VUE]:{filenameExtension:"vue",blobType:"text/x-vue"},[s.CODE_REACT]:{filenameExtension:"jsx",blobType:"application/javascript"},[s.CODE_OTHER]:{filenameExtension:"txt",blobType:"text/plain"},[s.DOCUMENT]:{filenameExtension:"md",blobType:"text/markdown"},[s.LOADING]:{filenameExtension:"txt",blobType:"text/plain"}};var L,B;function rn(){if(B)return L;B=1;var e=Te(),n=e(function(t,o,a){return t+(a?"_":"")+o.toLowerCase()});return L=n,L}var cn=rn();const S=te(cn);function Nn({textdocVersion:e,clientThreadId:n}){const t=H(),o=X(),a=q(),r=C.useCallback((c,f)=>{var y;const d=(y=e==null?void 0:e.messageId)!=null?y:void 0,x=n!=null?Y(n):void 0;!x||!d||J(a,{source:"mouse",type:"download",selectedText:c,location:"canvas",contentType:f,messageId:d,serverThreadId:x,productLogOnly:!0})},[n,a,e]),i=t.formatMessage({id:"canvas.downloadFileError",defaultMessage:"Failed to download file. Please try again later."}),{mutate:u,isPending:p}=oe({mutationFn:async({textdocId:c,exportType:f})=>{const d=await ce.safePost("/export_doc/canvas",{requestBody:{textdoc_id:c,export_type:f},skipJsonTransform:!0});if(!d.ok)throw new Error("Failed to download file");return d},onSuccess:async(c,{exportType:f})=>{var h;if(!e)return;const d=await c.blob(),x=c.headers.get("Content-Disposition"),y=(h=Me(x))!=null?h:"".concat(S(e.title),".").concat(f);v(d,y)},onError:c=>{o.danger(i,{toastId:"textdoc_download_button",loggingTitle:i,loggingDescription:"Failed to download file"}),re.addError(c)}}),b=async c=>{if(e&&e.type!==s.LOADING&&e.type===s.DOCUMENT){let f;switch(c){case"md":f="chatgpt_canvas_md_download";break;case"pdf":f="chatgpt_canvas_pdf_download";break;case"docx":f="chatgpt_canvas_docx_download";break}if(k.logEventWithStatsig("ChatGPT Canvas Download",f),r(e.content,_(e.type)?"code":"text"),c==="pdf"||c==="docx")u({textdocId:e.textdocId,exportType:c});else if(c==="md"){const{filenameExtension:d,blobType:x}=F[e.type],y=await z(e.content),h=new Blob([y],{type:x});v(h,"".concat(S(e.title),".").concat(d))}}},m=()=>{if(!e)return;const{filenameExtension:c,blobType:f}=F[e.type];if(e.type===s.LOADING)return;k.logEventWithStatsig("ChatGPT Canvas Download","chatgpt_canvas_code_download",{blobType:f});const d=new Blob([e.content],{type:f});v(d,"".concat(S(e.title),".").concat(c)),r(e.content,_(e.type)?"code":"text")},E=t.formatMessage({id:"canvas.download-button",defaultMessage:"Download"});return{handleFileDownload:b,handleBlobDownload:m,isLoading:p,downloadCopyLabel:E,isDocument:(e==null?void 0:e.type)===s.DOCUMENT}}export{Dn as A,Ye as C,Ze as D,Re as L,vn as M,je as O,Ln as S,Sn as a,D as b,Nn as c,ze as d,Ke as e,On as f,wn as g,P as h,Je as i,an as j,In as u};
//# sourceMappingURL=ixsv6fw3pmowsupe.js.map

var cr=Object.defineProperty,fr=Object.defineProperties;var dr=Object.getOwnPropertyDescriptors;var Vs=Object.getOwnPropertySymbols;var ur=Object.prototype.hasOwnProperty,mr=Object.prototype.propertyIsEnumerable;var Xs=(t,e,n)=>e in t?cr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ks=(t,e)=>{for(var n in e||(e={}))ur.call(e,n)&&Xs(t,n,e[n]);if(Vs)for(var n of Vs(e))mr.call(e,n)&&Xs(t,n,e[n]);return t},Zs=(t,e)=>fr(t,dr(e));import{f as Zt,A as Se,g as Kt,h as qs,E as js}from"./ko1u2otqsfwa0ohy.js";import{b as hr,S as ar,r as Nt,d as pr,g as Js,a as ve}from"./na97s5us80xgwiaa.js";import{C as ue}from"./nyxqrh4m1u1hf7xm.js";const gr=80,br=15,it=40,lt=20;function Or(t){return t==null||t===0?gr:Math.round(t*7)}function kr(t){const e=t==null||t===0?br:t;return Math.round(e*96/72)}function te(t){let e="";for(t+=1;t;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-n)/26)}return e}function tt(t){const e=t.match(/[A-Z]+/);if(!e)return 0;let n=0;for(const s of e[0])n=n*26+(s.charCodeAt(0)-64);return n-1}function ct(t){const e=t.match(/\d+/);return e?parseInt(e[0],10)-1:0}function Qs(t){const e=t.replace(/^0x/i,"");if(e.length===8){const s=parseInt(e.slice(2,4),16),a=parseInt(e.slice(4,6),16),h=parseInt(e.slice(6,8),16);return"rgba(".concat(s,", ").concat(a,", ").concat(h,", ").concat(1 .toFixed(3),")")}return e.length===6?"#".concat(e):"#ffffff"}function we(t){return t==null?void 0:t===64?"#000000":["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"][t]}const xs=ar.get_table();function yr(t){const e=t.replace(/^#/,"");if(e.length!==6)return null;const n=parseInt(e.slice(0,2),16),s=parseInt(e.slice(2,4),16),a=parseInt(e.slice(4,6),16);return{r:n,g:s,b:a}}function Mr(t,e,n){t/=255,e/=255,n/=255;const s=Math.max(t,e,n),a=Math.min(t,e,n);let h=0,M=0;const S=(s+a)/2;if(s!==a){const N=s-a;switch(M=S>.5?N/(2-s-a):N/(s+a),s){case t:h=(e-n)/N+(e<n?6:0);break;case e:h=(n-t)/N+2;break;case n:h=(t-e)/N+4;break}h/=6}return{h,s:M,l:S}}function Cr(t,e,n){let s,a,h;if(e===0)s=a=h=n;else{const M=(U,v,b)=>(b<0&&(b+=1),b>1&&(b-=1),b<.16666666666666666?U+(v-U)*6*b:b<.5?v:b<.6666666666666666?U+(v-U)*(.6666666666666666-b)*6:U),S=n<.5?n*(1+e):n+e-n*e,N=2*n-S;s=M(N,S,t+1/3),a=M(N,S,t),h=M(N,S,t-1/3)}return{r:Math.round(s*255),g:Math.round(a*255),b:Math.round(h*255)}}function Tr(t,e){const n=yr(t);if(!n)return t;const{h:s,s:a,l:h}=Mr(n.r,n.g,n.b),M=e/1e5,S=M>=0?h+(1-h)*M:h*(1+M),{r:N,g:U,b:v}=Cr(s,a,Math.max(0,Math.min(1,S))),b=yt=>yt.toString(16).padStart(2,"0");return"#".concat(b(N)).concat(b(U)).concat(b(v))}function tr(t,e,n,s,a){var h,M,S,N,U,v,b,yt,Ft,Et,vt,ht,k,wt,It,Ot;if(!(!t||!e)){if(t.numFmtId!=null){n.numberFormatId=t.numFmtId;const d=(h=e.numberFormats)==null?void 0:h.find(D=>D.id===t.numFmtId);d!=null&&d.formatCode?n.numberFormatCode=d.formatCode:xs[t.numFmtId]&&(n.numberFormatCode=xs[t.numFmtId])}if(t.fillId!=null&&(!s||t.applyFill||t.applyFill===void 0)){const d=(M=e.fills)==null?void 0:M[t.fillId];if(d!=null&&d.color){const D=Nt(d.color,a);D&&(n.fill=D)}else{const D=(d==null?void 0:d.fgColor)||(d==null?void 0:d.bgColor);D&&(n.fill=Qs(D))}}if(t.fontId!=null&&((S=!s||t.applyFont)==null||S)){const d=e.fonts[t.fontId],D=(N=n.font)!=null?N:n.font={};if(typeof(d==null?void 0:d.fontSize)=="number"){const P=d.fontSize*1.3333333333333333;D.size=P}D.bold=(U=d==null?void 0:d.bold)!=null?U:D.bold,D.italic=(v=d==null?void 0:d.italic)!=null?v:D.italic,D.family=d!=null&&d.name?d.name:D.family;const m=(yt=(b=d==null?void 0:d.fill)==null?void 0:b.color)!=null?yt:d==null?void 0:d.color;if(m){let P;if(m.type===Zt.COLOR_TYPE_SYSTEM&&typeof m.value=="string"){if(m.value==="auto")P="#000000";else if(m.value.startsWith("indexed:")){const kt=parseInt((Ft=m.value.split(":")[1])!=null?Ft:"",10);Number.isNaN(kt)||(P=we(kt))}}P||(P=Nt(m,a)),P&&(D.color=P,n.textColor=P)}}if(t.horizontalAlignment&&(!s||t.applyAlignment||t.applyAlignment===void 0))switch(t.horizontalAlignment){case"left":case"center":case"right":n.align=t.horizontalAlignment;break}if(t.verticalAlignment&&(!s||t.applyAlignment||t.applyAlignment===void 0))switch(String(t.verticalAlignment).toLowerCase()){case"top":n.verticalAlign=Se.ANCHOR_TYPE_TOP;break;case"center":n.verticalAlign=Se.ANCHOR_TYPE_MIDDLE;break;case"bottom":n.verticalAlign=Se.ANCHOR_TYPE_BOTTOM;break}if(t.borderId!=null&&(!s||t.applyBorder||t.applyBorder===void 0)){const d=e.borders[t.borderId];if(d){(Et=n.borders)!=null||(n.borders={}),(vt=n.borderStyles)!=null||(n.borderStyles={});const D=(m,P)=>{var Wt,Jt;if(m){const Ht=m.type===Zt.COLOR_TYPE_SYSTEM,pt=m.value;if(m.type===Zt.COLOR_TYPE_SCHEME&&typeof pt=="string"&&pt.startsWith("theme:")){const ft=parseInt((Wt=pt.split(":")[1])!=null?Wt:"",10);if(!Number.isNaN(ft)){const Ct=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"][ft];if(Ct){const Lt=a.colorMap[Ct];if(Lt)return(Jt=m.transform)!=null&&Jt.tint?Tr(Lt,m.transform.tint):Lt}else{const Lt=Nt(m,a);if(Lt)return Lt}}}if(m.type===Zt.COLOR_TYPE_RGB&&typeof pt=="string"){const ft=pt.replace(/^#/i,"");if(ft.length===8)return Qs(ft);if(ft.length===6)return"#".concat(ft)}if(Ht&&(pt!=null&&pt.startsWith("indexed:")||pt==="auto")){const ft=we(P);if(ft)return ft}return Nt(m,a)}return we(P)};if((ht=d.left)!=null&&ht.style){let m=D(d.left.color,d.left.indexedColorId);m||(m="#000000"),m&&(n.borders.left=m),n.borderStyles.left=d.left.style}if((k=d.right)!=null&&k.style){let m=D(d.right.color,d.right.indexedColorId);m||(m="#000000"),m&&(n.borders.right=m),n.borderStyles.right=d.right.style}if((wt=d.top)!=null&&wt.style){let m=D(d.top.color,d.top.indexedColorId);m||(m="#000000"),m&&(n.borders.top=m),n.borderStyles.top=d.top.style}if((It=d.bottom)!=null&&It.style){let m=D(d.bottom.color,d.bottom.indexedColorId);m||(m="#000000"),m&&(n.borders.bottom=m),n.borderStyles.bottom=d.bottom.style}if((Ot=d.diagonal)!=null&&Ot.style){let m=D(d.diagonal.color,d.diagonal.indexedColorId);m||(m="#000000"),m&&(n.borders.diagonal=m),n.borderStyles.diagonal=d.diagonal.style}d.diagonalUp!=null&&(n.borderDiagonalUp=!!d.diagonalUp),d.diagonalDown!=null&&(n.borderDiagonalDown=!!d.diagonalDown)}}}}function $r(t){const{styles:e}=t,n=hr(t.theme),s={};return e&&e.cellXfs.forEach((a,h)=>{var S;const M={};if(a.xfId!=null&&e.cellStyleXfs&&e.cellStyleXfs[a.xfId]){const N=(S=e.cellStyleXfs[a.xfId])==null?void 0:S.format;tr(N,e,M,!1,n)}tr(a,e,M,!0,n),s[h]=M}),s}const he=t=>t/9525;function Sr(t,e,n,s,a,h,M,S,N,U,v){if(!(!e.drawings||e.drawings.length===0))for(const b of e.drawings){if(!b.chart||!b.fromAnchor||!b.toAnchor)continue;const yt=Number(b.fromAnchor.colId),Ft=Number(b.fromAnchor.rowId),Et=Number(b.toAnchor.colId),vt=Number(b.toAnchor.rowId)-1,ht=s[yt],k=a[Ft],wt=s[Et],It=a[vt];if(ht===void 0||k===void 0||wt===void 0||It===void 0)continue;const Ot=it+ht+he(Number(b.fromAnchor.colOffset))-h,d=lt+k+he(Number(b.fromAnchor.rowOffset))-M,D=it+wt+he(Number(b.toAnchor.colOffset))-h,m=lt+It+he(Number(b.toAnchor.rowOffset))-M;if(D<0||m<0||Ot>S||d>N)continue;const P={x:Ot,y:d,width:D-Ot,height:m-d};pr(t,b.chart,P,{themeMap:U,excelDefaults:!0})}}function er(t,e,n){var S,N,U,v;if(t.value===""||t.value==null)return"";const s=(N=e[(S=t.styleIndex)!=null?S:0])!=null?N:{},a=n?"".concat(t.value,"||").concat((U=s.numberFormatCode)!=null?U:""):void 0;if(a&&(n!=null&&n.has(a)))return(v=n.get(a))!=null?v:"";let h=t.value;const M=t.dataType===ue.CELL_DATA_TYPE_STRING||t.dataType===ue.CELL_DATA_TYPE_SHARED_STRING||t.dataType===ue.CELL_DATA_TYPE_INLINE_STRING;if(s.numberFormatCode&&!M){const b=Number(t.value);if(!Number.isNaN(b))try{h=ar.format(s.numberFormatCode,b)}catch(yt){h=t.value}}return a&&(n==null||n.set(a,h)),h}function se(t,e,n){switch(t.save(),n&&(t.strokeStyle=n),t.lineWidth=1,t.setLineDash([]),e){case"thin":t.lineWidth=1;break;case"medium":t.lineWidth=2;break;case"thick":t.lineWidth=3;break;case"dashed":case"mediumDashed":t.lineWidth=e==="mediumDashed"?2:1,t.setLineDash([6,3]);break;case"dashDot":t.setLineDash([6,3,1,3]);break;case"dashDotDot":t.setLineDash([6,3,1,3,1,3]);break;case"slantDashDot":t.setLineDash([]);break;case"double":break;default:t.lineWidth=1;break}}function pe(t,e,n,s,a,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=1;const S=2;e==="top"?(t.beginPath(),t.moveTo(s,a),t.lineTo(s+h,a),t.stroke(),t.beginPath(),t.moveTo(s,a+S),t.lineTo(s+h,a+S),t.stroke()):e==="bottom"?(t.beginPath(),t.moveTo(s,a+M),t.lineTo(s+h,a+M),t.stroke(),t.beginPath(),t.moveTo(s,a+M-S),t.lineTo(s+h,a+M-S),t.stroke()):e==="left"?(t.beginPath(),t.moveTo(s,a),t.lineTo(s,a+M),t.stroke(),t.beginPath(),t.moveTo(s+S,a),t.lineTo(s+S,a+M),t.stroke()):e==="right"&&(t.beginPath(),t.moveTo(s+h,a),t.lineTo(s+h,a+M),t.stroke(),t.beginPath(),t.moveTo(s+h-S,a),t.lineTo(s+h-S,a+M),t.stroke()),t.restore()}function ge(t,e,n,s,a,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=2,t.beginPath(),e==="top"?(t.moveTo(s,a),t.lineTo(s+h,a)):e==="bottom"?(t.moveTo(s,a+M),t.lineTo(s+h,a+M)):e==="left"?(t.moveTo(s,a),t.lineTo(s,a+M)):e==="right"&&(t.moveTo(s+h,a),t.lineTo(s+h,a+M)),t.stroke(),t.save(),t.globalAlpha=.5,t.strokeStyle="#ffffff",t.lineWidth=1;const S=8,N=6;if(e==="left"||e==="right"){const U=e==="right"?s+h:s,v=e==="right"?-N:N;for(let b=a;b<=a+M;b+=S)t.beginPath(),t.moveTo(U+v,b),t.lineTo(U,b+N),t.stroke()}else{const U=e==="bottom"?a+M:a,v=e==="bottom"?-N:N;for(let b=s;b<=s+h;b+=S)t.beginPath(),t.moveTo(b,U+v),t.lineTo(b+N,U),t.stroke()}t.restore(),t.restore()}const Fr=t=>{if(!t)return;let e=t.replace(/\s*\(Body\)\s*$/i,"");return e=e.replace(/\s+Regular$/i,""),e=e.replace(/\s+Bold$/i,""),e=e.replace(/\s+Italic$/i,""),e.trim()};function Er(t){const e=t.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\)$/i);if(!e)return null;const[,n,s,a]=e;return!n||!s||!a?null:[parseInt(n,10),parseInt(s,10),parseInt(a,10)]}const be=t=>t/9525,ye=new Map,Me=new Map;function Ar(t){const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}function nr(t,e){if(!e)return null;const n=t.images;if(!n||n.length===0)return null;const s=n.find(h=>h.id===e);if(!s)return null;const a=typeof s.data=="string"?Ar(s.data):s.data;return{id:s.id,contentType:s.contentType,data:a}}function Nr(t,e,n,s,a,h,M,S,N){var v,b,yt,Ft,Et,vt,ht,k,wt,It;const U=(v=e.drawings)!=null?v:[];if(U.length!==0)for(const Ot of U){const d=(b=Ot.imageReference)==null?void 0:b.id;if(!d)continue;const D=Ot.fromAnchor;if(!D)continue;const m=Ot.toAnchor,P=Number(D.colId),kt=Number(D.rowId),Wt=s[P],Jt=a[kt];if(typeof Wt>"u"||typeof Jt>"u")continue;const Ht=it+Wt+be(Number((yt=D.colOffset)!=null?yt:0))-h,pt=lt+Jt+be(Number((Ft=D.rowOffset)!=null?Ft:0))-M;let ft=0,Rt=0;if(m){const _t=Number(m.colId),Gt=Number(m.rowId)-1,Yt=s[_t],zt=a[Gt];if(typeof Yt>"u"||typeof zt>"u")continue;const Mt=it+Yt+be(Number((Et=m.colOffset)!=null?Et:0))-h,At=lt+zt+be(Number((vt=m.rowOffset)!=null?vt:0))-M;ft=Mt-Ht,Rt=At-pt}else{const _t=(ht=s[P])!=null?ht:0,Gt=(k=s[P+1])!=null?k:_t,Yt=(wt=a[kt-1])!=null?wt:0,zt=(It=a[kt])!=null?It:Yt,Mt=Math.max(0,Gt-_t),At=Math.max(0,zt-Yt),qt=nr(n,d);if(!qt)continue;const Ut=ye.get(qt.id);if(!Ut){if(!Me.has(qt.id)){const oe=Js(qt).then(ie=>(ye.set(qt.id,ie),ie));Me.set(qt.id,oe)}continue}const w=Ut.width,R=Ut.height;if(w<=0||R<=0||Mt<=0||At<=0)continue;const jt=Math.min(Mt/w,At/R);ft=Math.max(0,Math.floor(w*jt)),Rt=Math.max(0,Math.floor(R*jt));const Qt=(Mt-ft)/2,ne=(At-Rt)/2;t.drawImage(Ut,0,0,w,R,Ht+Qt,pt+ne,ft,Rt);continue}if(Ht+ft<0||pt+Rt<0||Ht>S||pt>N)continue;const Ct=nr(n,d);if(!Ct)continue;const Lt=ye.get(Ct.id);if(Lt){t.drawImage(Lt,0,0,Lt.width,Lt.height,Ht,pt,ft,Rt);continue}if(!Me.has(Ct.id)){const _t=Js(Ct).then(Gt=>(ye.set(Ct.id,Gt),Gt));Me.set(Ct.id,_t)}}}const fe=10/12,ee="#4F81BD",re={headerFill:{type:Zt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:0,shade:0,lumMod:1e5,lumOff:1180,satMod:0,alpha:1e5}},rowStripeFill:{type:Zt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},colStripeFill:{type:Zt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:8e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},firstLastColFill:{type:Zt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}}},vr={type:Zt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},or=new WeakMap;function Ce(t){let e=or.get(t);return e||(e={rowCellByColIdx:new Map,rowNonEmptyCols:new Map,textMetrics:new Map},or.set(t,e)),e}function de(t,e){return t+":"+e}function Te(t,e){let n=0,s=t.length;for(;n<s;){const a=n+s>>>1,h=t[a];h!==void 0&&h<e?n=a+1:s=a}return n}function sr(t,e){let n=0,s=t.length;for(;n<s;){const a=n+s>>>1,h=t[a];h!==void 0&&h<=e?n=a+1:s=a}return n}const wr=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function rr(t){var h;let e=0;t[e]==="$"&&e++;const n=e;for(;e<t.length&&/[A-Za-z]/.test((h=t[e])!=null?h:"");)e++;const s=t.slice(n,e);t[e]==="$"&&e++;const a=t.slice(e);return{col:tt(s),row:parseInt(a,10)||0}}function Rr(t){t=Math.max(1,t);let e="";for(;t>0;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-1)/26)}return e}function ir(t,e,n){var k;const s=t.startsWith("$"),a=s?1:0;let h=a;for(;h<t.length&&/[A-Za-z]/.test((k=t[h])!=null?k:"");)h++;const M=t.slice(a,h);let S=!1,N=h;t[N]==="$"&&(S=!0,N++);const U=t.slice(N),v=tt(M),b=parseInt(U,10)||0,yt=s?v:Math.max(1,v+e),Ft=S?b:Math.max(1,b+n),Et=Rr(yt),vt=(s?"$":"")+Et,ht=(S?"$":"")+String(Ft);return vt+ht}function lr(t,e,n){if(!t||!e||!n)return t;const{col:s,row:a}=rr(e),{col:h,row:M}=rr(n),S=h-s,N=M-a;return S===0&&N===0?t:t.replace(wr,(U,v,b,yt)=>{const Ft=v?String(v):"",Et=ir(String(b),S,N);if(!yt)return"".concat(Ft).concat(Et);const vt=ir(String(yt),S,N);return"".concat(Ft).concat(Et,":").concat(vt)})}function Lr(t){var n;const e=new Map;for(const s of(n=t.sharedFormulas)!=null?n:[])typeof s.si=="number"&&s.base&&s.anchor&&e.set(s.si,{base:s.base,anchor:s.anchor});return e}function Br(t,e,n,s,a,h,M,S,N,U,v,b,yt,Ft,Et,vt,ht,k,wt,It,Ot,d){var Le,Ie,_e,Pe,De,Oe,ke,$e,Be,We,Ye,He,Ge,ze,Ue,Ve,Xe,Ke,Ze,qe,je,Je,Qe,xe,tn,en,nn,on,sn,rn,ln,an,cn,fn,dn,un,mn,hn,pn,gn,bn,yn,Mn,Cn,Tn,Sn,Fn,En,An,Nn,vn,wn,Rn,Ln,In,_n,Pn,Dn,On,kn,$n,Bn,Wn,Yn,Hn,Gn,zn,Un,Vn,Xn,Kn,Zn,qn,jn,Jn,Qn,xn,to,eo,no,oo,so,ro,io,lo,ao,co,fo,uo,mo,ho,po,go,bo,yo,Mo,Co,To,So,Fo,Eo,Ao,No,vo,wo,Ro,Lo,Io,_o,Po,Do,Oo,ko,$o,Bo,Wo,Yo,Ho,Go,zo,Uo,Vo,Xo,Ko,Zo,qo,jo,Jo,Qo,xo,ts,es,ns,os,ss,rs,is,ls,as,cs,fs,ds,us,ms,hs,ps,gs,bs,ys,Ms,Cs,Ts,Ss,Fs,Es,As,Ns,vs,ws,Rs,Ls,Is,_s,Ps,Ds,Os,ks,$s,Bs,Ws,Ys,Hs,Gs,zs;const D=v||1,m=a/D,P=h/D,kt=new Set,Wt=Lr(e);function Jt(o,l){var E,_,V,Y,g;if(!(le.get(o)!=null))return(E=n[l])!=null?E:0;Fe(o);const y=(_=Ce(e).rowNonEmptyCols.get(o))!=null?_:[],c=sr(y,l);let i=(V=y[c])!=null?V:n.length;const u=(F,Z)=>{var rt;const st=At(F,Z);if(Ct(st)==null)return!1;for(const $ of Yt)if(((rt=$.ranges)!=null?rt:[]).some(C=>C.sheetName&&C.sheetName!==e.name?!1:Rt(F,Z,C)))return!0;return!1};for(let F=l+1;F<i;F++)if(u(o,F)){i=F;break}const p=(Y=w[l])!=null?Y:0,f=(g=w[i])!=null?g:p;return Math.max(0,f-p)}function Ht(o,l){var E,_,V,Y;if(l<0)return!1;Fe(o);const r=(E=Ce(e).rowNonEmptyCols.get(o))!=null?E:[],y=sr(r,l)-1;if(y<0)return!1;const c=(_=r[y])!=null?_:-1;if(c<0)return!1;const i=Ce(e).textMetrics.get(de(o,c));if(!i||i.isNumeric)return!1;const u=Math.max(0,((V=w[l+1])!=null?V:0)-((Y=w[c])!=null?Y:0)),p=Math.max(0,u-(i.padLr+i.padLr));return i.firstLineW+.001>=p}function pt(o){var c,i,u,p,f;if(typeof o!="number")return null;const l=(c=ht.styles)==null?void 0:c.dxfs,r=l==null?void 0:l[o];if(!r)return null;const y=(f=(i=r==null?void 0:r.fill)==null?void 0:i.color)!=null?f:(p=(u=r==null?void 0:r.font)==null?void 0:u.fill)==null?void 0:p.color;return y?Nt(y,k,"rgba(0,0,0,1)"):null}function ft(o){var c,i,u;if(typeof o!="number")return null;const l=(c=ht.styles)==null?void 0:c.dxfs,r=l==null?void 0:l[o],y=(u=(i=r==null?void 0:r.border)==null?void 0:i.bottom)==null?void 0:u.color;return y?Nt(y,k,"#cccccc"):null}function Rt(o,l,r){const y=tt(r.startAddress),c=ct(r.startAddress),i=tt(r.endAddress),u=ct(r.endAddress),p=Math.min(c,u),f=Math.max(c,u),E=Math.min(y,i),_=Math.max(y,i);return o>=p&&o<=f&&l>=E&&l<=_}function Ct(o){if(!o)return null;const l=Number(o.value);return Number.isNaN(l)?null:l}function Lt(o,l,r){const y=Array.isArray(l)?l:void 0;if(r==null)return!1;const c=(y==null?void 0:y[0])!=null?Number(y[0]):NaN,i=(y==null?void 0:y[1])!=null?Number(y[1]):NaN;switch(o){case"greaterThan":return r>c;case"greaterThanOrEqual":return r>=c;case"lessThan":return r<c;case"lessThanOrEqual":return r<=c;case"equal":return r===c;case"notEqual":return r!==c;case"between":return r>=Math.min(c,i)&&r<=Math.max(c,i);case"notBetween":return!(r>=Math.min(c,i)&&r<=Math.max(c,i));default:return!1}}const _t=(Le=e.conditionalFormattings)!=null?Le:[],Gt=[],Yt=[];for(const o of _t)for(const l of(Ie=o.rules)!=null?Ie:[])if(l.type==="colorScale"&&l.colorScale){const r=[];for(const g of(_e=o.ranges)!=null?_e:[]){if(g.sheetName&&g.sheetName!==e.name)continue;const F=tt(g.startAddress),Z=ct(g.startAddress),st=tt(g.endAddress),ot=ct(g.endAddress),rt=Math.min(Z,ot),$=Math.max(Z,ot),H=Math.min(F,st),C=Math.max(F,st);for(let j=rt;j<=$;j++){const J=e.rows.find(I=>I.index-1===j);if(J)for(let I=H;I<=C;I++){const et=J.cells.find($t=>tt($t.address)===I),dt=Ct(et);dt!=null&&r.push(dt)}}}const y=r.slice().sort((g,F)=>g-F),c=g=>{var H,C;if(y.length===0)return 0;const F=g/100*(y.length-1),Z=Math.floor(F),st=Math.min(y.length-1,Math.ceil(F)),ot=F-Z,rt=(H=y[Z])!=null?H:0,$=(C=y[st])!=null?C:rt;return rt+($-rt)*ot},i=(Pe=l.colorScale.cfvos)!=null?Pe:[],u=(De=l.colorScale.colors)!=null?De:[],p=[],f=[];for(let g=0;g<i.length;g++){const F=i[g];if(!F)continue;let Z=0;F.type==="min"?Z=(Oe=y[0])!=null?Oe:0:F.type==="max"?Z=(ke=y[y.length-1])!=null?ke:0:F.type==="num"?Z=Number(($e=F.val)!=null?$e:0):F.type==="percentile"?Z=c(Number((Be=F.val)!=null?Be:0)):Z=Number((We=F.val)!=null?We:0),f.push(Z);const st=u[g],ot=st?Nt(st,k,"rgba(0,0,0,1)"):"rgba(0,0,0,1)",rt=(Ye=Er(ot))!=null?Ye:[0,0,0];p.push({pos:0,rgb:rt})}const E=Math.min(...f),_=Math.max(...f),V=g=>_===E?0:(g-E)/(_-E);for(let g=0;g<p.length;g++){const F=p[g];F&&(F.pos=V((He=f[g])!=null?He:0))}const Y=(i!=null?i:[]).some(g=>g.type==="min"||g.type==="max");Gt.push({ranges:o.ranges,stops:p,vMin:E,vMax:_,priority:typeof l.priority=="number"?l.priority:9999,includeEndpoints:Y})}for(const o of _t)for(const l of(Ge=o.rules)!=null?Ge:[])if(l.type==="dataBar"){const r=[];for(const u of(ze=o.ranges)!=null?ze:[]){if(u.sheetName&&u.sheetName!==e.name)continue;const p=tt(u.startAddress),f=ct(u.startAddress),E=tt(u.endAddress),_=ct(u.endAddress),V=Math.min(f,_),Y=Math.max(f,_),g=Math.min(p,E),F=Math.max(p,E);for(let Z=V;Z<=Y;Z++){const st=e.rows.find(ot=>ot.index-1===Z);if(st)for(let ot=g;ot<=F;ot++){const rt=st.cells.find(H=>tt(H.address)===ot),$=Ct(rt);$!=null&&r.push($)}}}if(r.length===0)continue;const y=Math.min(...r),c=Math.max(...r),i=Nt((Ve=(Ue=l.dataBar)==null?void 0:Ue.color)!=null?Ve:vr,k,((Xe=k.colorMap)==null?void 0:Xe.accent1)||ee);Yt.push({ranges:o.ranges,vMin:y,vMax:c,colorCss:i,priority:typeof l.priority=="number"?l.priority:9999,showValue:!0})}t.save(),t.scale(v,v);const zt=.5/(window.devicePixelRatio*v),Mt=Ce(e);function At(o,l){var r;return Fe(o),(r=Mt.rowCellByColIdx.get(o))==null?void 0:r.get(l)}const qt={thin:1,dashed:2,dashDot:2,dashDotDot:2,medium:3,mediumDashed:3,slantDashDot:3,thick:4,double:5},Ut=o=>{var l;return o&&(l=qt[o])!=null?l:0},w=[0];for(let o=0;o<n.length;o++)w[o+1]=((Ke=w[o])!=null?Ke:0)+((Ze=n[o])!=null?Ze:0);const R=[0];for(let o=0;o<s.length;o++)R[o+1]=((qe=R[o])!=null?qe:0)+((je=s[o])!=null?je:0);const jt=Math.max(0,Te(w,m)-1),Qt=Math.min(n.length-1,Te(w,m+M/v)+1),ne=Math.max(0,Te(R,P)-1),oe=Math.min(s.length-1,Te(R,P+S/v)+1);t.clearRect(0,0,M/v,S/v),t.fillStyle="white",t.fillRect(0,0,M/v,S/v);const ie=new Map;for(const o of e.rows)ie.set(o.index-1,o);const le=new Map;if(It&&It.length>0){const o=s.length;for(let l=0;l<o;l++){const r=(Je=It[l])!=null?Je:l,y=ie.get(r);y&&le.set(l,y)}}else for(const o of e.rows)le.set(o.index-1,o);function Fe(o){var c;if(Mt.rowCellByColIdx.has(o)&&Mt.rowNonEmptyCols.has(o))return;const l=le.get(o);if(!l){Mt.rowCellByColIdx.set(o,new Map),Mt.rowNonEmptyCols.set(o,[]);return}const r=new Map,y=[];for(const i of l.cells){const u=tt(i.address);r.set(u,i);const p=i.value!=null&&String(i.value)!=="",f=!!((c=i.paragraphs)!=null&&c.some(E=>{var _;return(_=E.runs)==null?void 0:_.some(V=>{var Y;return((Y=V.text)!=null?Y:"").length>0})}));(p||f||i.formula||typeof i.sharedFormulaSi=="number")&&y.push(u)}y.sort((i,u)=>i-u),Mt.rowCellByColIdx.set(o,r),Mt.rowNonEmptyCols.set(o,y)}const Ee=[];for(const o of(Qe=e.columns)!=null?Qe:[]){const l=o,r=typeof(l==null?void 0:l.styleIndex)=="number"?l.styleIndex:void 0;if(typeof r=="number"){const y=Math.max(0,((xe=o.min)!=null?xe:1)-1),c=Math.max(y,((en=(tn=o.max)!=null?tn:o.min)!=null?en:1)-1);for(let i=y;i<=c;i++)Ee[i]==null&&(Ee[i]=r)}}const Ae=new Set,Ne=new Set;if(((on=(nn=e.pivotTables)==null?void 0:nn.length)!=null?on:0)>0)for(const o of(sn=e.pivotTables)!=null?sn:[]){const l=o.location,r=(rn=l==null?void 0:l.reference)!=null?rn:"";if(!r)continue;const[y,c]=r.split(":"),i=tt(y||"A1"),u=ct(y||"A1"),p=c?tt(c):i,f=c?ct(c):u,E=Math.max(Math.min(i,p),jt),_=Math.min(Math.max(i,p),Qt),V=Math.max(Math.min(u,f),ne),Y=Math.min(Math.max(u,f),oe);if(E>_||V>Y)continue;const g=typeof(l==null?void 0:l.firstHeaderRow)=="number"&&l.firstHeaderRow>0?l.firstHeaderRow-1:u,F=typeof(l==null?void 0:l.firstDataRow)=="number"&&l.firstDataRow>0?l.firstDataRow-1:Math.min(f,g+1),Z=typeof(l==null?void 0:l.firstHeaderColumn)=="number"&&l.firstHeaderColumn>0?l.firstHeaderColumn-1:i,st=typeof(l==null?void 0:l.firstDataColumn)=="number"&&l.firstDataColumn>0?l.firstDataColumn-1:Math.min(p,Z+1),ot=Nt(re.headerFill,k,((ln=k.colorMap)==null?void 0:ln.accent1)||ee),rt=Nt(re.firstLastColFill,k,((an=k.colorMap)==null?void 0:an.accent1)||ee);if(F>=V){const $=V,H=Math.min(Y,F-1);if(H>=$){const C=it+((cn=w[E])!=null?cn:0)-m,j=lt+((fn=R[$])!=null?fn:0)-P,J=((dn=w[_+1])!=null?dn:0)-((un=w[E])!=null?un:0),I=((mn=R[H+1])!=null?mn:0)-((hn=R[$])!=null?hn:0);t.fillStyle=ot,t.fillRect(C,j,J,I);for(let et=$;et<=H;et++)for(let dt=E;dt<=_;dt++)Ae.add("".concat(te(dt)).concat(et+1))}}if(st>=E){const $=E,H=Math.min(_,st-1);if(H>=$){const C=it+((pn=w[$])!=null?pn:0)-m,j=lt+((gn=R[V])!=null?gn:0)-P,J=((bn=w[H+1])!=null?bn:0)-((yn=w[$])!=null?yn:0),I=((Mn=R[Y+1])!=null?Mn:0)-((Cn=R[V])!=null?Cn:0);t.fillStyle=ot,t.fillRect(C,j,J,I);for(let et=V;et<=Y;et++)for(let dt=$;dt<=H;dt++)Ae.add("".concat(te(dt)).concat(et+1))}}if(o.rowGrandTotals){const $=Y,H=it+((Tn=w[E])!=null?Tn:0)-m,C=lt+((Sn=R[$])!=null?Sn:0)-P,j=((Fn=w[_+1])!=null?Fn:0)-((En=w[E])!=null?En:0),J=(An=s[$])!=null?An:0;t.fillStyle=rt,t.fillRect(H,C,j,J);for(let I=E;I<=_;I++)Ne.add("".concat(te(I)).concat($+1))}if(o.columnGrandTotals){const $=_,H=it+((Nn=w[$])!=null?Nn:0)-m,C=lt+((vn=R[V])!=null?vn:0)-P,j=(wn=n[$])!=null?wn:0,J=((Rn=R[Y+1])!=null?Rn:0)-((Ln=R[V])!=null?Ln:0);t.fillStyle=rt,t.fillRect(H,C,j,J);for(let I=V;I<=Y;I++)Ne.add("".concat(te($)).concat(I+1))}}const ae=(In=e.tables)!=null?In:[],Re=new Set;if(ae.length>0)for(const o of ae){if(!o.ref)continue;const[l,r]=o.ref.split(":");if(!l)continue;const y=tt(l),c=ct(l),i=r?tt(r):y,u=r?ct(r):c,p=Math.max(Math.min(y,i),jt),f=Math.min(Math.max(y,i),Qt),E=Math.max(Math.min(c,u),ne),_=Math.min(Math.max(c,u),oe);if(p>f||E>_)continue;const V=Math.max(0,Math.min(1,(_n=o.headerRowCount)!=null?_n:1)),Y=Math.max(0,Math.min(1,(Pn=o.totalsRowCount)!=null?Pn:o.totalsRowShown?1:0)),g=Math.min(_,Math.max(E,Math.min(c,u)+V)),F=Math.max(E,Math.min(_,Math.max(c,u)-Y)),Z=Nt(re.headerFill,k,((Dn=k.colorMap)==null?void 0:Dn.accent1)||ee),st=Nt(re.rowStripeFill,k,((On=k.colorMap)==null?void 0:On.accent1)||ee),ot=Nt(re.colStripeFill,k,((kn=k.colorMap)==null?void 0:kn.accent1)||ee),rt=Nt(re.firstLastColFill,k,(($n=k.colorMap)==null?void 0:$n.accent1)||ee);if(V>0){const C=Math.min(_,Math.min(c,u));if(C>=E&&C<=_){const j=it+((Bn=w[p])!=null?Bn:0)-m,J=lt+((Wn=R[C])!=null?Wn:0)-P,I=((Yn=w[f+1])!=null?Yn:0)-((Hn=w[p])!=null?Hn:0),et=(Gn=s[C])!=null?Gn:0,dt=o==null?void 0:o.dataDxfId,$t=(zn=pt(dt))!=null?zn:Z;t.fillStyle=$t,t.fillRect(j,J,I,et);for(let xt=p;xt<=f;xt++)Re.add("".concat(te(xt)).concat(C+1))}}if((Un=o.style)!=null&&Un.showRowStripes&&g<=F){for(let C=g;C<=F;C++)if((C-g)%2===1){const J=it+((Vn=w[p])!=null?Vn:0)-m,I=lt+((Xn=R[C])!=null?Xn:0)-P,et=((Kn=w[f+1])!=null?Kn:0)-((Zn=w[p])!=null?Zn:0),dt=(qn=s[C])!=null?qn:0;t.fillStyle=st,t.fillRect(J,I,et,dt)}}if((jn=o.style)!=null&&jn.showColumnStripes&&g<=F){for(let C=p;C<=f;C++)if((C-Math.min(y,i))%2===1){const J=it+((Jn=w[C])!=null?Jn:0)-m,I=lt+((Qn=R[g])!=null?Qn:0)-P,et=(xn=n[C])!=null?xn:0,dt=((to=R[F+1])!=null?to:0)-((eo=R[g])!=null?eo:0);t.fillStyle=ot,t.fillRect(J,I,et,dt)}}const $=!!((no=o.style)!=null&&no.showFirstColumn),H=!!((oo=o.style)!=null&&oo.showLastColumn);if(g<=F&&($||H)){if($){const C=Math.min(y,i);if(C>=p&&C<=f){const j=it+((so=w[C])!=null?so:0)-m,J=lt+((ro=R[g])!=null?ro:0)-P,I=(io=n[C])!=null?io:0,et=((lo=R[F+1])!=null?lo:0)-((ao=R[g])!=null?ao:0);t.fillStyle=rt,t.fillRect(j,J,I,et)}}if(H){const C=Math.max(y,i);if(C>=p&&C<=f){const j=it+((co=w[C])!=null?co:0)-m,J=lt+((fo=R[g])!=null?fo:0)-P,I=(uo=n[C])!=null?uo:0,et=((mo=R[F+1])!=null?mo:0)-((ho=R[g])!=null?ho:0);t.fillStyle=rt,t.fillRect(j,J,I,et)}}}}for(let o=ne;o<=oe;o++){const l=le.get(o),r=lt+((po=R[o])!=null?po:0)-P,y=[];for(let c=jt;c<=Qt;c++){const i=it+((go=w[c])!=null?go:0)-m;let u=(bo=n[c])!=null?bo:0,p=(yo=s[o])!=null?yo:0;const f=At(o,c),E="".concat(te(c)).concat(o+1),_=l==null?void 0:l.styleIndex,V=Ee[c],Y=(To=(Co=(Mo=f==null?void 0:f.styleIndex)!=null?Mo:_)!=null?Co:V)!=null?To:0,g=(So=b[Y])!=null?So:{},F=(Fo=g.borders)==null?void 0:Fo.diagonal,Z=!!g.borderDiagonalUp,st=!!g.borderDiagonalDown,ot=(Eo=g.borderStyles)==null?void 0:Eo.diagonal;if(f){const T=(()=>{if(wt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const A=Wt.get(f.sharedFormulaSi);if(A)return"= ".concat(lr(A.base,A.anchor,f.address))}}return er(f,b)})(),L=(()=>{if(wt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Wt.has(f.sharedFormulaSi)))return!1;const A=Number(f.value);return f.dataType!==ue.CELL_DATA_TYPE_STRING&&!Number.isNaN(A)})(),G=((No=(Ao=g.font)==null?void 0:Ao.size)!=null?No:11*(96/72))*fe,at=Math.max(2,Math.round((G||11)*.35)),O=Math.max(1,Math.round((G||11)*.25));if(L)Mt.textMetrics.set(de(o,c),{firstLineW:0,padLr:at,padTb:O,isNumeric:L});else{const ut={paragraphs:f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:T,citations:[]}]}],textStyle:{alignment:Kt.ALIGNMENT_TYPE_LEFT},bbox:{xEmu:0,yEmu:0,widthEmu:Math.round(1e6*9525),heightEmu:Math.round(p*9525)},type:js.ELEMENT_TYPE_TEXT,levelsStyles:[]},nt=ve(ut,t,k,void 0,{resolvedStyle:{alignment:Kt.ALIGNMENT_TYPE_LEFT},bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:fe,wrap:!1}),q=(Ro=(wo=(vo=nt==null?void 0:nt.lines)==null?void 0:vo[0])==null?void 0:wo.widthPx)!=null?Ro:0;Mt.textMetrics.set(de(o,c),{firstLineW:q,padLr:at,padTb:O,isNumeric:L})}}const rt=(Lo=e.mergedCells)!=null?Lo:[];let $=!1,H=o,C=o,j=c,J=c,I=(Io=g.borders)!=null?Io:null,et=(_o=g.borderStyles)!=null?_o:null;{const T=rt.find(L=>Rt(o,c,L));if(T){const L=tt(T.startAddress),Q=ct(T.startAddress),G=tt(T.endAddress),at=ct(T.endAddress);if(H=Math.min(Q,at),C=Math.max(Q,at),j=Math.min(L,G),J=Math.max(L,G),$=o===H&&c===j,!$)continue;u=((Po=w[J+1])!=null?Po:0)-((Do=w[j])!=null?Do:0),p=((Oo=R[C+1])!=null?Oo:0)-((ko=R[H])!=null?ko:0);let O=0,A=0,ut=0,nt=0;const q={},x={};for(let B=j;B<=J;B++){const X=At(H,B),mt=(Bo=b[($o=X==null?void 0:X.styleIndex)!=null?$o:0])!=null?Bo:{},W=(Wo=mt.borderStyles)==null?void 0:Wo.top,K=Ut(W);(Yo=mt.borders)!=null&&Yo.top&&K>=O&&(q.top=mt.borders.top,x.top=W,O=K)}for(let B=j;B<=J;B++){const X=At(C,B),mt=(Go=b[(Ho=X==null?void 0:X.styleIndex)!=null?Ho:0])!=null?Go:{},W=(zo=mt.borderStyles)==null?void 0:zo.bottom,K=Ut(W);(Uo=mt.borders)!=null&&Uo.bottom&&K>=A&&(q.bottom=mt.borders.bottom,x.bottom=W,A=K)}for(let B=H;B<=C;B++){const X=At(B,j),mt=(Xo=b[(Vo=X==null?void 0:X.styleIndex)!=null?Vo:0])!=null?Xo:{},W=(Ko=mt.borderStyles)==null?void 0:Ko.left,K=Ut(W);(Zo=mt.borders)!=null&&Zo.left&&K>=ut&&(q.left=mt.borders.left,x.left=W,ut=K)}for(let B=H;B<=C;B++){const X=At(B,J),mt=(jo=b[(qo=X==null?void 0:X.styleIndex)!=null?qo:0])!=null?jo:{},W=(Jo=mt.borderStyles)==null?void 0:Jo.right,K=Ut(W);(Qo=mt.borders)!=null&&Qo.right&&K>=nt&&(q.right=mt.borders.right,x.right=W,nt=K)}I=q,et=x}}const dt=g.fill;dt&&(t.fillStyle=dt,t.fillRect(i,r,u,p));let $t=null,xt=null,me=Number.POSITIVE_INFINITY,Us=Number.POSITIVE_INFINITY;if(_t.length>0){for(const T of _t)if(((xo=T.ranges)!=null?xo:[]).some(Q=>Q.sheetName&&Q.sheetName!==e.name?!1:Rt(o,c,Q)))for(const Q of(ts=T.rules)!=null?ts:[]){const G=typeof Q.priority=="number"?Q.priority:9999;if(Q.type==="cellIs"){const at=Ct(f);if(Lt((es=Q.operator)!=null?es:"",Q.formula,at)){const O=Q.dxfId;if(G<me){const q=pt(O);q&&($t=q,me=G)}const A=(ns=ht.styles)==null?void 0:ns.dxfs,ut=typeof O=="number"?A==null?void 0:A[O]:void 0,nt=(ss=(os=ut==null?void 0:ut.font)==null?void 0:os.fill)==null?void 0:ss.color;nt&&G<Us&&(xt=nt,Us=G),$t||($t="rgba(255,199,206,1)")}}}for(const T of Gt){if(!((rs=T.ranges)!=null?rs:[]).some(q=>q.sheetName&&q.sheetName!==e.name?!1:Rt(o,c,q)))continue;const Q=Ct(f);if(Q==null)continue;const G=T.vMax===T.vMin?0:(Q-T.vMin)/(T.vMax-T.vMin),at=Math.max(0,Math.min(1,G));if(Number.isNaN(at))continue;const O=T.stops;if(O.length===0)continue;let A=(ls=(is=O[0])==null?void 0:is.rgb)!=null?ls:[0,0,0];if(O.length===1)A=(cs=(as=O[0])==null?void 0:as.rgb)!=null?cs:[0,0,0];else{let q=0;for(;q<O.length-1&&at>((ds=(fs=O[q+1])==null?void 0:fs.pos)!=null?ds:0);)q++;const x=O[q];if(!x)continue;const B=O[Math.min(q+1,O.length-1)];if(!B)continue;const X=x.pos===B.pos?0:(at-x.pos)/(B.pos-x.pos);A=[Math.round(x.rgb[0]+(B.rgb[0]-x.rgb[0])*X),Math.round(x.rgb[1]+(B.rgb[1]-x.rgb[1])*X),Math.round(x.rgb[2]+(B.rgb[2]-x.rgb[2])*X)]}const ut="rgba(".concat(A[0],",").concat(A[1],",").concat(A[2],",1)"),nt=T.priority;nt<me&&($t=ut,me=nt)}}if($t&&(t.fillStyle=$t,t.fillRect(i,r,u,p)),Et.has("".concat(e.name,":").concat(E))&&(t.fillStyle="#eeeeee",t.fillRect(i,r,u,p)),vt&&N===o&&U===c&&(t.fillStyle="rgba(255,255,0,0.2)",t.fillRect(i,r,u,p)),Yt.length>0){let T=null;for(const L of Yt)((us=L.ranges)!=null?us:[]).some(G=>G.sheetName&&G.sheetName!==e.name?!1:Rt(o,c,G))&&(!T||L.priority<T.priority)&&(T=L);if(T){const L=Ct(f);if(L!=null){const G=Math.max(0,u-2),at=Math.max(0,p-2),O=T.vMin,A=T.vMax;if(A!==O&&G>0&&at>0){let ut=i+1,nt=0;if(O>=0)nt=Math.max(0,Math.min(1,(L-O)/(A-O)))*G;else if(A<=0)nt=Math.max(0,Math.min(1,(L-A)/(O-A)))*G,ut=i+1+(G-nt);else{const q=-O/(A-O),x=G*q;if(L>=0){const B=Math.max(0,Math.min(1,L/A));ut=i+1+x,nt=B*(G-x)}else{const B=Math.max(0,Math.min(1,L/O));ut=i+1+x-B*x,nt=B*x}}nt>.5&&(t.save(),t.globalAlpha=.6,t.fillStyle=T.colorCss,t.fillRect(ut,r+1,nt,at),t.restore())}}}}if(I){const T=I,L=et!=null?et:{};T.top&&(L.top==="double"?pe(t,"top",T.top,i,r,u,p):L.top==="slantDashDot"?ge(t,"top",T.top,i,r,u,p):(se(t,L.top,T.top),t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r),t.stroke(),t.restore())),T.bottom&&(L.bottom==="double"?pe(t,"bottom",T.bottom,i,r,u,p):L.bottom==="slantDashDot"?ge(t,"bottom",T.bottom,i,r,u,p):(se(t,L.bottom,T.bottom),t.beginPath(),t.moveTo(i,r+p),t.lineTo(i+u,r+p),t.stroke(),t.restore())),T.left&&(L.left==="double"?pe(t,"left",T.left,i,r,u,p):L.left==="slantDashDot"?ge(t,"left",T.left,i,r,u,p):(se(t,L.left,T.left),t.beginPath(),t.moveTo(i,r),t.lineTo(i,r+p),t.stroke(),t.restore())),T.right&&(L.right==="double"?pe(t,"right",T.right,i,r,u,p):L.right==="slantDashDot"?ge(t,"right",T.right,i,r,u,p):(se(t,L.right,T.right),t.beginPath(),t.moveTo(i+u,r),t.lineTo(i+u,r+p),t.stroke(),t.restore()))}if(e.showGridLines!==!1&&!(!!g.fill||!!$t)){t.strokeStyle="#ccc",t.lineWidth=zt;const L=(()=>{var gt,bt;const W=At(o-1,c),K=(gt=W==null?void 0:W.styleIndex)!=null?gt:0;return(bt=b[K])!=null?bt:{}})(),Q=(()=>{var gt,bt;const W=At(o,c-1),K=(gt=W==null?void 0:W.styleIndex)!=null?gt:0;return(bt=b[K])!=null?bt:{}})(),G=(W,K)=>{var bt;const gt=(bt=e.mergedCells)!=null?bt:[];for(const Tt of gt){const Pt=tt(Tt.startAddress),Dt=ct(Tt.startAddress),Bt=tt(Tt.endAddress),Vt=ct(Tt.endAddress),St=Math.min(Pt,Bt),z=Math.max(Pt,Bt),Xt=Math.min(Dt,Vt),ce=Math.max(Dt,Vt);if(K>=St&&K<=z&&W-1>=Xt&&W<=ce)return!0}return!1},at=(W,K)=>{var bt;const gt=(bt=e.mergedCells)!=null?bt:[];for(const Tt of gt){const Pt=tt(Tt.startAddress),Dt=ct(Tt.startAddress),Bt=tt(Tt.endAddress),Vt=ct(Tt.endAddress),St=Math.min(Pt,Bt),z=Math.max(Pt,Bt),Xt=Math.min(Dt,Vt),ce=Math.max(Dt,Vt);if(W>=Xt&&W<=ce&&K-1>=St&&K<=z)return!0}return!1},O=!!(I!=null&&I.top),A=(W,K)=>{for(const gt of ae){if(!gt.ref)continue;const bt=tt(gt.ref.split(":")[0]||gt.ref),Tt=ct(gt.ref.split(":")[0]||gt.ref),Pt=gt.ref.split(":")[1],Dt=Pt?tt(Pt):bt,Bt=Pt?ct(Pt):Tt,Vt=Math.min(bt,Dt),St=Math.max(bt,Dt),z=Math.min(Tt,Bt),Xt=Math.max(Tt,Bt);if(K>=Vt&&K<=St&&W-1>=z&&W<=Xt)return!0}return!1},ut=!!((ms=L.borders)!=null&&ms.bottom),nt=G(o,c),q=A(o,c);!O&&!ut&&!nt&&!q&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r),t.stroke());const x=!!(I!=null&&I.left),B=!!((hs=Q.borders)!=null&&hs.right),X=Ht(o,c-1),mt=at(o,c);!x&&!B&&!X&&!mt&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i,r+p),t.stroke())}if(Ft.has(E)){const T=yt[E];T&&(t.save(),t.fillStyle=T+"22",t.fillRect(i,r,u,p),t.restore(),t.strokeStyle=T,t.lineWidth=2,t.strokeRect(i,r,u,p))}if(f){const T=(()=>{if(wt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const St=Wt.get(f.sharedFormulaSi);if(St)return"= ".concat(lr(St.base,St.anchor,f.address))}}return er(f,b)})(),L=f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:T,citations:[]}]}],Q=(()=>{if(wt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Wt.has(f.sharedFormulaSi)))return!1;const St=Number(f.value);return f.dataType!==ue.CELL_DATA_TYPE_STRING&&!Number.isNaN(St)})(),G={anchor:(ps=g.verticalAlign)!=null?ps:Se.ANCHOR_TYPE_BOTTOM,alignment:g.align==="center"?Kt.ALIGNMENT_TYPE_CENTER:g.align==="right"?Kt.ALIGNMENT_TYPE_RIGHT:g.align==="left"?Kt.ALIGNMENT_TYPE_LEFT:Q?Kt.ALIGNMENT_TYPE_RIGHT:Kt.ALIGNMENT_TYPE_LEFT},at={paragraphs:L,textStyle:G,bbox:{xEmu:Math.round(i*9525),yEmu:Math.round(r*9525),widthEmu:Math.round(u*9525),heightEmu:Math.round(p*9525)},type:js.ELEMENT_TYPE_TEXT,levelsStyles:[]},O=(ys=(gs=ht.styles)==null?void 0:gs.cellXfs)==null?void 0:ys[(bs=Y!=null?Y:f==null?void 0:f.styleIndex)!=null?bs:0],A=O&&O.fontId!=null?(Cs=(Ms=ht.styles)==null?void 0:Ms.fonts)==null?void 0:Cs[O.fontId]:void 0,ut=Re.has(E),nt=Ae.has(E)||Ne.has(E);for(const St of(Ts=at.paragraphs)!=null?Ts:[])for(const z of(Ss=St.runs)!=null?Ss:[]){if(z.textStyle=(Fs=z.textStyle)!=null?Fs:{},typeof z.textStyle.fontSize=="number"&&z.textStyle.fontSize>0&&z.textStyle.fontSize<100&&(z.textStyle.fontSize=Math.round(z.textStyle.fontSize*100)),!(typeof z.textStyle.fontSize=="number"&&z.textStyle.fontSize>0)){const Xt=(Es=g.font)==null?void 0:Es.size,ce=typeof Xt=="number"&&Xt>0?Xt*72/96:11;z.textStyle.fontSize=Math.round(ce*100)}z.textStyle.bold==null&&((As=g.font)==null?void 0:As.bold)!=null&&(z.textStyle.bold=!!g.font.bold),(ut||nt)&&(z.textStyle.bold=!0),z.textStyle.italic==null&&((Ns=g.font)==null?void 0:Ns.italic)!=null&&(z.textStyle.italic=!!g.font.italic),z.textStyle.name==null&&(z.textStyle.name=Fr((ws=A==null?void 0:A.name)!=null?ws:(vs=g.font)==null?void 0:vs.family)),z.textStyle.underline==null&&(A!=null&&A.underline)&&(z.textStyle.underline=A.underline),xt?z.textStyle.fill={color:xt,type:qs.FILL_TYPE_SOLID,gradientStops:[]}:!z.textStyle.fill&&(A!=null&&A.fill)?z.textStyle.fill=A.fill:z.textStyle.fill||(z.textStyle.fill={color:{type:2,value:"FF000000",transform:void 0,lastColor:""},type:qs.FILL_TYPE_SOLID,gradientStops:[]})}typeof f.styleIndex=="number"&&!kt.has(f.styleIndex)&&kt.size<12&&kt.add(f.styleIndex);const q=Jt(o,c),B=((Ls=(Rs=g.font)==null?void 0:Rs.size)!=null?Ls:11*(96/72))*fe,X=Math.max(2,Math.round((B||11)*.35)),mt=Math.max(1,Math.round((B||11)*.25)),W=ve(at,t,k,void 0,{resolvedStyle:G,bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:fe,wrap:!1}),K=(Os=(Ds=(_s=(Is=W==null?void 0:W.lines)==null?void 0:Is[0])==null?void 0:_s.widthPx)!=null?Ds:(Ps=Mt.textMetrics.get(de(o,c)))==null?void 0:Ps.firstLineW)!=null?Os:0;Mt.textMetrics.set(de(o,c),{firstLineW:K,padLr:X,padTb:mt,isNumeric:Q});const gt=Math.max(0,u-(X+X)),bt=!Q&&K>gt,Tt=Math.max(u,K+(X+X)),Pt=$&&(J>j||C>H)?u:q,Dt=bt?Math.min(Pt,Tt):u,Bt=bt?Zs(Ks({},G),{alignment:Kt.ALIGNMENT_TYPE_LEFT}):G,Vt=()=>{t.save(),t.beginPath(),t.rect(i,r,Dt,p),t.clip();const St=Bt.alignment===Kt.ALIGNMENT_TYPE_LEFT?Math.max(Dt,K+(X+X)):Dt;ve(at,t,k,void 0,{resolvedStyle:Bt,bboxPx:{x:i,y:r,width:St,height:p},textScale:fe,wrap:!1}),t.restore()};y.push(()=>{Vt(),F&&(Z||st)&&(se(t,ot,F),st&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r+p),t.stroke()),Z&&(t.beginPath(),t.moveTo(i,r+p),t.lineTo(i+u,r),t.stroke()),t.restore())})}}if(ae.length>0)for(const c of ae){if(!c.ref)continue;const[i,u]=c.ref.split(":"),p=tt(i!=null?i:"A1"),f=ct(i!=null?i:"A1"),E=u?tt(u):p,_=u?ct(u):f,V=Math.max(Math.min(p,E),jt),Y=Math.min(Math.max(p,E),Qt),g=Math.min(f,_),F=Math.max(f,_);if(!(V>Y)&&o>=g&&o<=F){const Z=it+((ks=w[V])!=null?ks:0)-m,st=it+(($s=w[Y+1])!=null?$s:0)-m,ot=lt+((Ws=(Bs=R[o+1])!=null?Bs:R[o])!=null?Ws:0)-P,rt=ft(c==null?void 0:c.dataDxfId)||"#cccccc";se(t,"thin",rt),t.beginPath(),t.moveTo(Z,ot),t.lineTo(st,ot),t.stroke(),t.restore()}}for(const c of y)c()}Nr(t,e,ht,w,R,m,P,M/v,S/v),Sr(t,e,ht,w,R,m,P,M/v,S/v,k),t.textAlign="center",t.textBaseline="middle",t.font="12px sans-serif";for(let o=jt;o<=Qt;o++){const l=it+((Ys=w[o])!=null?Ys:0)-m,r=(Hs=n[o])!=null?Hs:0;t.fillStyle="#f5f5f5",t.fillRect(l,0,r,lt),t.strokeStyle="#ccc",t.lineWidth=zt,t.strokeRect(l,0,r,lt),t.fillStyle="#333",t.fillText(te(o),l+r/2,lt/2)}for(let o=ne;o<=oe;o++){const l=lt+((Gs=R[o])!=null?Gs:0)-P,r=(zs=s[o])!=null?zs:0;r<=0||(t.fillStyle="#f5f5f5",t.fillRect(0,l,it,r),t.strokeStyle="#ccc",t.lineWidth=zt,t.strokeRect(0,l,it,r),t.fillStyle="#333",t.fillText((o+1).toString(),it/2,l+r/2))}t.fillStyle="#f5f5f5",t.fillRect(0,0,it,lt),t.strokeStyle="#ccc",t.lineWidth=zt,t.strokeRect(0,0,it,lt),t.restore()}export{lt as C,gr as F,it as R,br as a,$r as b,Or as c,Br as d,tt as e,te as f,er as g,kr as p,ct as r};
//# sourceMappingURL=bxq8qdjlrkpqhzqu.js.map

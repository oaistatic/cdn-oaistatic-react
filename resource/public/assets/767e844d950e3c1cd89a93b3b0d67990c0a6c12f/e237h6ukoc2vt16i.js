var _=Object.defineProperty,A=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(s,e,n)=>e in s?_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,y=(s,e)=>{for(var n in e||(e={}))E.call(e,n)&&w(s,n,e[n]);if(v)for(var n of v(e))F.call(e,n)&&w(s,n,e[n]);return s},j=(s,e)=>A(s,C(e));import{h as O,r as g,j as t,M as f,ad as Q}from"./mw35uwhq4g8r9eam.js";import{ay as N,aw as M,u as W,bw as P,iK as R,gw as I}from"./d0xa318sl7ywi0za.js";import{cA as S,cB as b,cC as D,cD as k,bp as G,cE as T}from"./g2euln7v5pbm31qa.js";function J(s){var n,c,o;const e=[];for(const l of s){const x=e.length?e[e.length-1]:null;if(l.status!=="in_progress"){if(l.author.role===N.Tool&&l.author.name==="api_tool.call_tool"&&l.content.content_type===M.MultimodalText){const a=(n=l.metadata)==null?void 0:n.citation_metadata,r=a==null?void 0:a.id;if(!a||!r)continue;const i={id:a.id,name:a.title,url:a.url,messageId:l.id};x?x.results.push(i):e.push({call:"unhandled",results:[i]})}else if(l.author.role===N.Assistant&&l.recipient==="api_tool.call_tool"&&l.content.content_type===M.Code&&l.content.language==="json"){let a={};try{if(a=JSON.parse(l.content.text),typeof a.args=="string")try{a.args=JSON.parse(a.args)}catch(r){continue}}catch(r){continue}if(!a.path)continue;if(a.path==="mixer://search"&&typeof((c=a.args)==null?void 0:c.sources)=="object"){const r=[],i=a.args.sources;for(const u in i){const d=i[u],m=S(u);if(m){const h=new Set;d.forEach(p=>{p.query&&!h.has(p.query)&&(r.push(j(y({isMixer:!1,path:u},m),{query:p.query})),h.add(p.query))})}}e.push({call:{isMixer:!0,messageId:l.id,path:"mixer://search",queries:r},results:[]})}else if((o=a.args)!=null&&o.query){const r=S(a.path);r&&e.push({call:j(y({isMixer:!1,messageId:l.id,path:a.path},r),{query:a.args.query}),results:[]})}}}}return e}function q(s){return s?s.replace(/\s*--[^\s=]+(?:=[^\s]+)?/g,"").replace(/\s+/g," ").trim():""}function V({messages:s,isLastMessage:e}){const n=O(),c=W(),o=s.some(r=>{var i,u;return P({id:(u=(i=r.metadata)==null?void 0:i.model_slug)!=null?u:""},c)}),l=g.useMemo(()=>e?b.Running:b.Finished,[e]),x=g.useMemo(()=>e?n.formatMessage({id:"SrnzPW",defaultMessage:"Searching internal knowledge"}):n.formatMessage({id:"rI4m7i",defaultMessage:"Searched internal knowledge"}),[n,e]),a=g.useMemo(()=>J(s),[s]);return o?t.jsx(D,{highlightedCommand:x,showWorkUserSetting:!1,status:l,children:a.map((r,i)=>{if(r.call==="unhandled")return null;{const u=(r.call.isMixer?r.call.queries:[r.call]).map((d,m)=>{const h=q(d.query);return t.jsx(z,{query:h},m)});return t.jsxs("div",{className:"relative flex w-full items-stretch gap-2 overflow-clip",children:[t.jsxs("div",{className:"flex w-4 flex-none flex-col items-center",children:[t.jsx("div",{className:"flex h-5 flex-none items-center justify-center",children:r.call.isMixer?t.jsx("div",{className:"bg-token-interactive-icon-tertiary-default h-[6px] w-[6px] rounded-full"}):t.jsx(r.call.Icon,{className:"icon-sm"})}),i<a.length-1&&t.jsx("div",{className:"bg-token-border-heavy h-1 w-[1px] flex-auto rounded-full"})]}),t.jsxs("div",{className:"mb-3 flex w-1 flex-auto flex-col gap-3",children:[t.jsx("p",{className:"text-token-text-secondary flex flex-auto flex-row flex-wrap gap-1",children:r.call.isMixer?u.length===1?t.jsx(f,{id:"olKix8",defaultMessage:'Searched for "{query}"',values:{query:u[0]}}):t.jsx(f,{id:"5CdONM",defaultMessage:"Searched for {queries}",values:{queries:t.jsx(Q,{value:u})}}):t.jsx(f,{id:"olKix8",defaultMessage:'Searched for "{query}"',values:{query:q(r.call.query)}})}),!!r.results.length&&t.jsx("div",{className:"overflow-x-auto",children:t.jsx("div",{className:"flex flex-row gap-2",children:r.results.map(d=>t.jsx(K,{url:d.url,name:d.name},d.id))})})]})]},r.call.messageId)}})}):null}function K({url:s,name:e}){var o;const n=k(s!=null?s:""),c=(o=n==null?void 0:n.Icon)!=null?o:s?G:T;return t.jsxs(R,{className:"bg-token-bg-tertiary hover:bg-token-interactive-bg-tertiary-hover flex h-[25px] max-w-64 flex-row items-center gap-1 rounded-xl px-2 text-[10px] leading-[13px]",href:s,children:[t.jsx(c,{className:"icon-sm"}),t.jsx("p",{className:"text-token-text-secondary truncate overflow-ellipsis",children:e})]})}function Z({maxResults:s,results:e}){const n=g.useMemo(()=>{const c=new Set;return e.slice(0,s-1).forEach(o=>{var x,a;const l=k((x=o.url)!=null?x:"");c.add((a=l==null?void 0:l.Icon)!=null?a:o.url?G:T)}),Array.from(c)},[e,s]);return t.jsxs("div",{className:"bg-token-bg-tertiary flex h-[25px] max-w-64 flex-row items-center gap-1 rounded-xl px-2 text-[10px] leading-[13px]",children:[n.map((c,o)=>t.jsx(c,{className:"icon-sm"},o)),t.jsx("p",{className:"text-token-text-secondary truncate overflow-ellipsis",children:t.jsx(f,{id:"Wj+XrO",defaultMessage:"{number} more",values:{number:e.length-(s-1)}})})]})}function z({query:s}){return t.jsx(B,{Icon:I,label:s})}function B({label:s,Icon:e}){return t.jsxs("div",{className:"bg-token-bg-tertiary flex h-[25px] max-w-64 flex-row items-center gap-1 rounded-xl px-2 text-[10px] leading-[13px]",children:[t.jsx(e,{className:"icon-xs"}),t.jsx("p",{className:"text-token-text-secondary truncate overflow-ellipsis",children:s})]})}function $({maxResults:s,queries:e}){return t.jsxs("div",{className:"bg-token-bg-tertiary flex h-[25px] max-w-64 flex-row items-center gap-1 rounded-xl px-2 text-[10px] leading-[13px]",children:[t.jsx(I,{className:"icon-xs"}),t.jsx("p",{className:"text-token-text-secondary truncate overflow-ellipsis",children:t.jsx(f,{id:"axYnJ7",defaultMessage:"{number} more searches",values:{number:e.length-(s-1)}})})]})}export{B as GlauxCoTChipWithIcon,V as GlauxMessage,$ as GlauxSearchQueryOverflow,z as GlauxSearchQueryWithIcon,K as GlauxSearchResultItem,Z as GlauxSearchResultOverflow,q as cleanQuery,J as groupGlauxMessages};
//# sourceMappingURL=e237h6ukoc2vt16i.js.map

import{a9 as R,j as a,ah as T,h as U,d as E,u as B,i as D,n as O,M as v,y as $}from"./mw35uwhq4g8r9eam.js";import{N as I}from"./cl2i3iqpmcb4wvd9.js";import{p as L,er as q}from"./d0xa318sl7ywi0za.js";import{f4 as z}from"./g2euln7v5pbm31qa.js";import{W as Q}from"./msmm4s2uspal1mht.js";import{R as G,I as c,S as M}from"./mp1v4mj1e9tsamhf.js";import{E as H,R as J,g as K}from"./cln2roac07fmiq0u.js";import{u as X}from"./o8muva2a6y8pvlji.js";import{c as Y,a as Z,d as V}from"./ldtpmsnzn9ens47o.js";import{W as ee,a as te,w as ae}from"./baz4b8nlf8t2lb95.js";import"./dtmprrbw2fxa7u08.js";import"./j6o92bx1q4qhetyv.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./cvl54rj7bbx1877e.js";import"./i8gmt89kig8ue44v.js";import"./dejzmw8nrz6tr491.js";import"./e5bg4yzr7nht9sxr.js";import"./hdw58d7g4tx8n6s4.js";import"./kubdgxu3crk3gqem.js";import"./kne35xckmmfq3xx6.js";import"./c340ncgh31fwqkpk.js";import"./of0vtq1gcmd3mc3z.js";import"./m4z0737cb20mwzwc.js";import"./ddina39kz3r81pp7.js";import"./ksb30nvrqfrocrgu.js";import"./kx64af29hscb23w7.js";import"./w3hi9hzc7twqpn11.js";import"./mozvd7p01wv3j6u2.js";import"./bzhbjc3vjefv3qwn.js";import"./ijk9p5ylletqfo5k.js";import"./h38m9m9rf2db1qpt.js";import"./mdhx8v0rk5lzwfyg.js";import"./lptwpbjabrvjmhsj.js";import"./sbrp17m0bwny70wh.js";import"./oyfed4d8xid8ujwa.js";import"./jxdumrq8vfk5kk1c.js";import"./c8dilzb1umlthpuq.js";import"./c08xobknzytt16by.js";import"./ohau9tqj1fpdibg0.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./cv4afpu20gjb9dll.js";import"./h4yh1661qhhbu5v5.js";import"./hu1bt0oauegdhua6.js";function se(){const{environmentId:s}=R(),{eligible:r}=z();return r?a.jsx(T,{to:"/codex"}):s?a.jsx(re,{environmentId:s}):a.jsx(I,{})}function re({environmentId:s}){var u,l,h,_,f,g,S;const r=U(),i=L(),b=E(),d=B(),{data:e,isLoading:N,isError:C}=Y(s),p=(u=e==null?void 0:e.secrets)!=null?u:{},k=X()?"workspace":"private",{mutate:A,isPending:x}=D({mutationFn:t=>ee.updateEnvironment(s,t),onSuccess:async t=>{await Z(d,s),V(d,s,t),i.success(r.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),b("/codex/settings/environment/".concat(s))},onError:t=>{if(t instanceof te){ae(t,"wham_edit_environment_".concat(s),r,i);return}i.danger(O({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment"}),{toastId:"wham_edit_environment_failed_to_update_environment"})}});function F(t){var j,w;const n=K(t.secrets,p),W=t.envVars.reduce((o,y)=>(o[y.key]=y.value,o),{}),m=(w=(j=t.share_targets)==null?void 0:j.map(o=>o.trim()))==null?void 0:w.filter(Boolean),P=t.share_settings==="private"?[]:m==null?void 0:m.map(o=>({email:o,permission:"editor",type:"user"}));A({etag:e==null?void 0:e.etag,label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,share_targets:P,secrets:n,env_vars:W,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return a.jsx(Q,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:N?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(q,{})}):C?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?a.jsxs(a.Fragment,{children:[a.jsxs(G,{className:"sticky top-0 px-4",children:[a.jsx(c,{label:r.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),a.jsx(M,{}),a.jsx(c,{label:e.label,url:"/codex/settings/environment/".concat(s),className:"font-medium"}),a.jsx(M,{}),a.jsx(c,{label:r.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),a.jsx(H,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e==null?void 0:e.label,description:(l=e==null?void 0:e.description)!=null?l:"",share_settings:(h=e==null?void 0:e.share_settings)!=null?h:k,share_targets:(f=(_=e==null?void 0:e.share_targets)==null?void 0:_.map(t=>t.email))!=null?f:[],machine:e==null?void 0:e.machine_id,repositoryId:e==null?void 0:e.repos[0],workspaceDirectory:(g=e==null?void 0:e.workspace_dir)!=null?g:"",agentNetworkAccess:e==null?void 0:e.agent_network_access,setupCommands:e!=null&&e.setup?Array.isArray(e==null?void 0:e.setup)?e.setup.join("\n"):e.setup:"",maintenanceSetupCommands:e!=null&&e.maintenance_setup?Array.isArray(e==null?void 0:e.maintenance_setup)?e.maintenance_setup.join("\n"):e.maintenance_setup:"",envVars:Object.entries((S=e==null?void 0:e.env_vars)!=null?S:{}).map(([t,n])=>({key:t,value:n})),secrets:Object.keys(p).map(t=>({key:t,value:J,isEditing:!1})),autoSetupSettings:e==null?void 0:e.auto_setup_settings,cacheSettings:e==null?void 0:e.cache_settings},primaryButtonText:r.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:F,isPending:x})]}):a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const Ye=()=>[{title:"Codex"}],Ze=$(function(){return a.jsx(se,{})});export{Ze as default,Ye as meta};
//# sourceMappingURL=go5u9dj1x5s345ww.js.map

var _=Object.freeze,z=Object.defineProperty,P=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var $=(n,a,s)=>a in n?z(n,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[a]=s,B=(n,a)=>{for(var s in a||(a={}))ee.call(a,s)&&$(n,s,a[s]);if(V)for(var s of V(a))te.call(a,s)&&$(n,s,a[s]);return n},O=(n,a)=>P(n,K(a));var X=(n,a)=>_(z(n,"raw",{value:_(a||n.slice())}));import{r as j,j as t,M as ne}from"./mw35uwhq4g8r9eam.js";import{S as W,R as ae,B as ie,T as se,a as M,C as re,X as oe,b as ce,Y as le,c as de,d as G,M as H,e as U,f as ue,r as me}from"./j29baj0apaw4vezi.js";import{as as y}from"./g2euln7v5pbm31qa.js";import{cB as xe,er as fe,cF as he}from"./d0xa318sl7ywi0za.js";import{p as ve}from"./og1ftjb0zeoepdz3.js";const Y="default",Q=n=>n.toLocaleString();var J;const q=xe.div(J||(J=X(["flex h-full grow items-center justify-center text-lg text-token-text-tertiary"]))),Z=n=>"values"in n,je=n=>"blank"in n,ge=(n,a)=>{var m,x,v;if(je(n))return(m=n.blank)!=null?m:0;if(a)return(x=n.total)!=null?x:0;let s=0;for(const f of Object.values((v=n.values)!=null?v:{}))typeof f=="number"&&f>s&&(s=f);return s};function Ce({title:n,data:a,hideLegend:s=!1,seriesColorMap:m,forceStack:x=!1,stackOrder:v,legendOrder:f,filters:l,filterLabel:R,valueFormatter:k,labelFormatter:A,hideYAxis:I=!1,hideReferenceLine:L=!1}){"use no forget";const[h,w]=j.useState(()=>{var o;return(o=l==null?void 0:l[0])==null?void 0:o.id}),N=k!=null?k:Q,D=j.useCallback(o=>{w(o)},[]),{activeData:e,processedSeriesData:i}=j.useMemo(()=>{if(a==="loading")return{activeData:"loading",processedSeriesData:"loading"};if(!(l!=null&&l.length))return{activeData:a,processedSeriesData:a.data};const o=h!=null?h:l[0].id,g=l.find(u=>u.id===o);if(!g)return{activeData:a,processedSeriesData:a.data};const c=g.apply(a);return{activeData:c,processedSeriesData:c.data}},[l,h,a]),d=l!=null&&l.length?h!=null?h:l[0].id:"",r=j.useMemo(()=>x||!m?!0:Object.values(m).filter(o=>typeof o=="string").length<=1,[x,m]),S=j.useMemo(()=>i==="loading"?0:i.reduce((o,g)=>{var c;return Math.max(o,(c=ge(g,r))!=null?c:0)},0),[i,r]),E=j.useMemo(()=>{if(e==="loading"||i==="loading")return{};const o=f?new Map(f.map((c,u)=>[c,u])):void 0,g=Object.keys(e.metrics).map(c=>{var b,p;const u=i.reduce((C,T)=>{var F;return Z(T)?C+((F=T.values[c])!=null?F:0):C},0);return{displayName:(p=(b=e.metrics[c])==null?void 0:b.displayName)!=null?p:c,total:u,groupKey:c}}).sort((c,u)=>{if(o){const b=o.get(c.groupKey),p=o.get(u.groupKey);if(b!==void 0&&p!==void 0)return b-p;if(b!==void 0)return-1;if(p!==void 0)return 1}return u.total-c.total});return Object.fromEntries(g.map(({total:c,groupKey:u,displayName:b},p)=>{var C;return[u,{displayName:b,total:c,color:(C=m==null?void 0:m[u])!=null?C:W[p%W.length]}]}))},[f,i,m,e]);return t.jsxs("div",{className:"border-token-border-default mb-4 flex min-h-[350px] flex-col rounded-lg border pt-4 pb-4",children:[t.jsx("div",{className:"px-6",children:t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"text-token-text-secondary text-sm",children:n!=null?n:null}),l!=null&&l.length?t.jsx("div",{className:"flex shrink-0 items-center gap-2",children:t.jsxs(y.Root,{value:d,onValueChange:D,children:[t.jsxs(y.Trigger,{"aria-label":R,className:"border-token-border-default text-token-text-primary bg-token-bg-primary flex items-center gap-2 rounded-full border px-3 py-1.5 text-sm font-medium",children:[t.jsx(y.Value,{}),t.jsx(y.Icon,{})]}),t.jsx(y.Portal,{children:t.jsx(y.Content,{className:"min-w-[160px]",children:l.map(o=>t.jsx(y.Item,{value:o.id,children:o.label},o.id))})})]})}):null]})}),t.jsx(be,{processedData:i,maxTotal:S,seriesMetadata:E,hideLegend:s,stackSeries:r,stackOrder:v,legendOrder:f,valueFormatter:N,labelFormatter:A,hideYAxis:I,hideReferenceLine:L})]})}function be({processedData:n,maxTotal:a,seriesMetadata:s,hideLegend:m,stackSeries:x,stackOrder:v,legendOrder:f,valueFormatter:l,labelFormatter:R,hideYAxis:k=!1,hideReferenceLine:A=!1}){"use no forget";const[I,L]=j.useState(),h=j.useMemo(()=>{if(f)return new Map(f.map((e,i)=>[e,i]))},[f]),w=j.useMemo(()=>Object.entries(s).sort(([e],[i])=>{if(e==="other"&&i==="other")return 0;if(e==="other")return 1;if(i==="other")return-1;if(h){const d=h.get(e),r=h.get(i);if(d!==void 0&&r!==void 0)return d-r;if(d!==void 0)return-1;if(r!==void 0)return 1}return 0}),[h,s]),N=j.useMemo(()=>{const e=w.map(([r])=>r);if(!v||v.length===0)return e;const i=new Set(v),d=[];return v.forEach(r=>{e.includes(r)&&d.push(r)}),e.forEach(r=>{i.has(r)||d.push(r)}),d},[w,v]);if(n==="loading")return t.jsx(q,{children:t.jsx(fe,{})});if(a===0)return t.jsx(q,{children:t.jsx(ne,{id:"codex.analytics.multiBarOverview.noData",defaultMessage:"No data for this period"})});const D=x?n.map(e=>{var i,d;if(Z(e))for(let r=N.length-1;r>=0;r-=1){const S=N[r];if(((d=(i=e.values)==null?void 0:i[S])!=null?d:0)>0)return S}}):[];return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:he(me,"flex grow items-center"),children:t.jsx(ae,{width:"100%",height:220,children:t.jsxs(ie,{data:n,margin:{left:k?20:-20,top:14,right:20},barGap:x?4:1,children:[t.jsx(se,{isAnimationActive:!1,content:({payload:e,active:i,label:d})=>t.jsx(re,{active:i,label:d,payload:e&&[...e].reverse(),valueFormatter:l,labelFormatter:R,metricToLabel:s}),cursor:{opacity:.2,fill:M}}),t.jsx(oe,{dataKey:"date",axisLine:!1,tickLine:!1,tick:ce,tickFormatter:e=>ve(e).toLocaleDateString(void 0,{month:"short",day:"numeric"}),interval:n.length-2}),t.jsx(le,{axisLine:!1,tickLine:!1,hide:k,domain:[0,a],ticks:[0,a],fontSize:11,fill:M,tick:e=>t.jsx(de,O(B({},e),{textAnchor:"start",y:e.payload.value===0?e.y:e.y-10,x:e.x-10,fontWeight:400,children:Q(e.payload.value)}))}),N.map(e=>{const i="values.".concat(e),d=I&&I!==e;return t.jsx(G,{dataKey:i,stackId:x?Y:void 0,isAnimationActive:!1,children:n.map((r,S)=>{var c,u;const E=x&&D[S]===e,o=x?E?[4,4,0,0]:[0,0,0,0]:[4,4,0,0],g=d?H:(u=(c=s[e])==null?void 0:c.color)!=null?u:H;return t.jsx(U,{radius:o,fill:g,opacity:d?.15:1},"cell-".concat(e,"-").concat(S))})},i)}),x?t.jsx(G,{dataKey:"blank",minPointSize:1,stackId:Y,isAnimationActive:!1,children:n.map((e,i)=>t.jsx(U,{opacity:.5,fill:"blank"in e&&e.blank===0?M:"transparent"},"cell-".concat(i)))}):null,!A&&t.jsx(ue,{y:a,stroke:M,strokeDasharray:"3 3",shape:e=>t.jsx("line",O(B({},e),{x1:22}))})]})})}),!m&&t.jsx("div",{className:"text-token-text-primary flex w-full flex-wrap items-center justify-center text-sm",children:w.map(([e,{displayName:i,color:d}])=>t.jsxs("div",{className:"mx-4 mb-1 flex cursor-pointer items-center justify-center",title:i,onMouseOut:()=>L(void 0),onMouseOver:()=>L(e),children:[t.jsx("div",{className:"me-1 h-2 w-2 rounded-[1px]",style:{backgroundColor:d}}),t.jsx("span",{className:"me-1 whitespace-nowrap",children:i})]},e))})]})}export{Ce as M};
//# sourceMappingURL=fa78ilwaaz4m4hwc.js.map

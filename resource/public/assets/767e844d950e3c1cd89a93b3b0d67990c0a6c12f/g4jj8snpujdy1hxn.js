import{j as e,h as T,M as S,g as re,r as E}from"./mw35uwhq4g8r9eam.js";import{m as _,i as le,d as de,a as ie,T as ce}from"./krza42hj097hj350.js";import{aF as me,g8 as xe,dE as G,ax as fe,nk as z,pv as ue,c as he,g3 as $,g7 as pe,pw as be,px as ge,py as je,X as ve}from"./g2euln7v5pbm31qa.js";import{u as ye,c as ke,D as Ne}from"./ixsv6fw3pmowsupe.js";import{eA as Q,cF as j,f7 as v,cw as N,aA as J,hW as Me,sy as we,u as U,cu as Ce,fj as Ee,n_ as K,e5 as X,fG as Se}from"./d0xa318sl7ywi0za.js";import{S as Te}from"./bhvk929w0gb4odci.js";import{t as Be}from"./fna9z31n721lpf9f.js";import{C as Y,T as De}from"./kyqrf9eexoyaphy1.js";import{g as Le}from"./bj1ejin6tzi0v3v8.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./c8dilzb1umlthpuq.js";import"./mstl8wgfzorpgdoe.js";import"./pcrw7exsshz05v7h.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./cfgm997jt4en0fjd.js";import"./deakbbf27g8e7ba0.js";import"./d4h15g77ywnnjdmi.js";import"./obs7vyhux2j83kng.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";function Ae({textdocVersion:r,clientThreadId:n}){const{handleCopy:c,copyLabel:m}=ye({textdocVersion:r,clientThreadId:n}),d=!Q();return e.jsx(me,{onCopy:c,className:"px-1.5 py-1",iconClassName:j("icon-md",!d&&"hidden"),iconOnly:d,buttonText:d?void 0:m})}function Re({textdocVersion:r,isDisabled:n=!1,clientThreadId:c}){const m=T(),{handleFileDownload:d,handleBlobDownload:f,isLoading:u,downloadCopyLabel:t,isDocument:s}=ke({textdocVersion:r,clientThreadId:c});return n||(n=u||!r||r.type===xe.LOADING),s?e.jsxs(v.Root,{open:!u&&!n?void 0:!1,children:[e.jsx(v.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:t,children:e.jsx(G,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{align:"end",children:[e.jsx(v.Item,{onClick:l=>{l.preventDefault(),d("pdf")},children:m.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(v.Item,{onClick:l=>{l.preventDefault(),d("docx")},children:m.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(v.Item,{onClick:l=>{l.preventDefault(),d("md")},children:m.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:t,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:e.jsx(G,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function Fe({onClick:r}){const n=T();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:r,children:[e.jsx(N,{label:e.jsx(S,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(fe,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function We({onClick:r,disabled:n,isCodePreviewable:c}){const d=T().formatMessage(c?_.previewCode:_.runCode);return n?e.jsx(J,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(N,{label:e.jsx(S,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(z,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d})]})}):e.jsxs(J,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:r,disabled:!1,children:[e.jsx(N,{label:e.jsx(S,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(z,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d})]})}var A,Z;function He(){if(Z)return A;Z=1;var r=ue(),n=Me(),c=we(),m=parseFloat,d=Math.min,f=Math.random;function u(t,s,l){if(l&&typeof l!="boolean"&&n(t,s,l)&&(s=l=void 0),l===void 0&&(typeof s=="boolean"?(l=s,s=void 0):typeof t=="boolean"&&(l=t,t=void 0)),t===void 0&&s===void 0?(t=0,s=1):(t=c(t),s===void 0?(s=t,t=0):s=c(s)),t>s){var a=t;t=s,s=a}if(l||t%1||s%1){var h=f();return d(t+h*(s-t+m("1e-"+((h+"").length-1))),s)}return r(t,s)}return A=u,A}var qe=He();const _e=re(qe),Ge=({isCanvasHovered:r=!1,onClick:n})=>{const c=T();return e.jsx(N,{label:c.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(ve,{color:r?"primary":"secondary",icon:Te,onClick:n})})},ze=({textdocId:r,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,marginBottom:u,size:t="large",height:s=t==="large"?"22rem":"10rem",minHeight:l,isCanvasOpen:a=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:B=!1,isInlinePreview:o=!1,isStreaming:g=!1,isUserMessage:y=!1,onClick:p,onPreview:D,children:L})=>{const M=E.useRef(null),[k,R]=E.useState(!1),[V]=E.useState(()=>_e(100,180,!1)),P=U(),w=he(r),I=Ce(n),i=Ee(w==null?void 0:w.versions),x=$(P),C=!x,O=w==null&&I===void 0,ee=i==null||g,F=!!i&&le(i.type,i.content),te=!!i&&de(i.type),ae=F||te,W=b&&a&&f!=null?f:d,se=W?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!k}),children:W}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(K,{lines:1,size:"base",width:100,widthVariance:0})}),H=i!=null&&i.type&&pe(i.type)?ie(i.type):void 0,q=!c||B?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:V},children:e.jsx(K,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":x}),children:c}),x&&H&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",H]})]}),ne=()=>{!M.current||h||(be.logButtonClick(ge.MESSAGE_ATTACHMENT,{type:m}),je(M.current),p==null||p())},oe=Q();return e.jsxs(X.div,{role:C?"button":void 0,id:Le(r),initial:{opacity:g?0:1,scale:g?.9:1},animate:{opacity:1,scale:1},transition:x?{type:"spring",bounce:0,damping:60}:{type:"spring",bounce:0},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",x?"overflow-visible":"overflow-hidden",h?"cursor-default":C?"cursor-pointer":"cursor-text",{"select-none":C,"border-token-text-tertiary font-medium dark:border-gray-600":b&&a,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":a||!o,"rounded-3xl":!a&&o,"max-w-full":!y&&(a||!o),"max-w-[var(--user-chat-width,70%)]":y&&(a||!o),[oe?"w-full":"".concat(Be.tableContainer," rounded-none")]:!y&&!a&&o,"w-[var(--user-chat-width,70%)]":y&&!a&&o,"w-full pt-1 pb-3 sm:max-w-none":o&&x}),onMouseEnter:()=>!h&&R(!0),onMouseLeave:()=>R(!1),onClick:()=>C?ne():void 0,ref:M,style:{marginBottom:u,height:o&&!a?s:void 0,minHeight:o&&!a?l:void 0,width:t==="small"?"300px":void 0},children:[!(x&&o)&&e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!k&&!b,"border-token-border-heavy":k&&!b,"text-token-text-primary text-sm font-medium":!a&&k&&o,"py-2":a||!o,"py-3":!x&&!a&&o,"text-token-text-secondary text-sm font-medium":!a&&!k&&o,"pt-0 pb-2 sm:px-6":x}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":a||!o,"gap-3.5":!a&&o}),children:[!x&&se,q]}),a?e.jsx(X.span,{animate:g?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:g&&e.jsx(ce,{gap:1,padding:0})}):e.jsx(Ge,{isCanvasHovered:k,onClick:p})]}),x&&o&&!h?e.jsx("div",{className:"thread-xl:-top-[var(--header-height)] sticky top-0 z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:j("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:q}),e.jsx("div",{className:"flex items-center justify-end",children:O&&!a?e.jsxs("span",{className:"bg-token-surface-tertiary/40 text-token-text-tertiary inline-flex items-center px-2.5 py-0.5 text-xs font-normal",children:[e.jsx(Se,{className:"me-1 h-3 w-3 shrink-0"}),e.jsx(S,{id:"m8Uz8Y",defaultMessage:"Canvas is not supported in shared conversations"})]}):x&&!a?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ae,{textdocVersion:i!=null?i:null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Fe,{onClick:p})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Re,{isDisabled:ee,textdocVersion:i!=null?i:null,clientThreadId:n})}),ae&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(We,{isCodePreviewable:F,disabled:g,onClick:D})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!a&&L,o&&!a&&!x&&e.jsx(Y,{size:t,position:"bottom"}),o&&t==="small"&&!a&&!x&&e.jsx(Y,{size:t,position:"right"})]})]})},mt=({textdocId:r,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,isCanvasOpen:u=!1,isFetching:t=!1,isFocused:s=!1,isInlinePreview:l=!1,isStreaming:a=!1,isUserMessage:h=!1,onClick:b,onPreview:B})=>{const[o,g]=E.useState(!1),y=U(),p=$(y),D=M=>{g(M>0)},L=l&&!u?16:12;return e.jsx(ze,{textdocId:r,name:c,tag:m,icon:d,height:p?"auto":void 0,iconSelected:f,marginBottom:L,isCanvasOpen:u,isFocused:s,isInlinePreview:l,isStreaming:a,isUserMessage:h,onClick:b,onPreview:B,clientThreadId:n,children:l&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":o,"border-transparent":!o}),children:t&&!(p&&a)?e.jsx(Ne,{numLines:20}):!!r&&e.jsx(De,{disableScroll:p,onScroll:D,textdocId:r,clientThreadId:n})})})};export{mt as CanvasMessageAttachment,ze as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=g4jj8snpujdy1hxn.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/f4lmde6olrjh5i2c.js","assets/mw35uwhq4g8r9eam.js","assets/d0xa318sl7ywi0za.js","assets/root-kavs8piy.css","assets/irqezh7teqj3ew03.js","assets/g2euln7v5pbm31qa.js","assets/conversation-small-lq38g8zw.css","assets/ehwx8pj63nln1ugv.js","assets/ffo9fz3385kae4ff.js","assets/bzxitjpdx1z6hpbp.js","assets/iman6sxicn70h91g.js","assets/nvot86jvh8vwigra.js","assets/l2u6v2d9vfposl4n.js","assets/e5bg4yzr7nht9sxr.js","assets/i693kfbch8smq86y.js","assets/gy1lpvuoewmzh42c.js","assets/iknugp00locgtve5.js","assets/h1em0bjkpkjv8ykw.js","assets/kbj1b07s2z6vxqkg.js","assets/hu1bt0oauegdhua6.js","assets/oj9zwxa6l3kpv1x2.js","assets/h4yh1661qhhbu5v5.js","assets/fkrqr6nqq2852orb.js","assets/la79eh1q1qxrfcxi.js","assets/nk904upldvj1ufei.js","assets/m966r6qv7jykyvdd.js","assets/mtsxj0469osb30cx.js","assets/gs306ibz22k5zi3r.js","assets/lvrypwdhnjlsz45f.js","assets/pdbvfcpzcg4ny695.js","assets/ki6jbruunap4y9wd.js","assets/gywigwwdbkbcgqzt.js","assets/l4v2i2dq9gwjak1q.js","assets/pbx1h703pubtj7lo.js","assets/f89v9mtyvakgmoul.js","assets/oftnd9rlobxeh2e2.js","assets/nc9vr5q4g3rosm9u.js","assets/ns51nblw8ziscsgd.js","assets/ehv2vkvc6wjiqj3r.js","assets/ce3hgmw4iyyhicud.js","assets/lqx184c6v77q7gok.js","assets/l6qxa8uogotap2gn.js","assets/mqid879cmc46z1v1.js","assets/ok9dkhrmtedi0ido.js","assets/dpnr7xd5p38jb3gp.js","assets/mgd4bano9n2tt0tl.js","assets/ohiuwbpwp4hx5ge4.js"])))=>i.map(i=>d[i]);
var wn=Object.freeze,jn=Object.defineProperty,qo=Object.defineProperties;var Vo=Object.getOwnPropertyDescriptors;var Cn=Object.getOwnPropertySymbols;var Ko=Object.prototype.hasOwnProperty,Ho=Object.prototype.propertyIsEnumerable;var ds=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),Go=s=>{throw TypeError(s)};var zs=(s,e,t)=>e in s?jn(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,he=(s,e)=>{for(var t in e||(e={}))Ko.call(e,t)&&zs(s,t,e[t]);if(Cn)for(var t of Cn(e))Ho.call(e,t)&&zs(s,t,e[t]);return s},lt=(s,e)=>qo(s,Vo(e));var J=(s,e,t)=>zs(s,typeof e!="symbol"?e+"":e,t);var Tt=(s,e)=>wn(jn(s,"raw",{value:wn(e||s.slice())}));var Ms=function(s,e){this[0]=s,this[1]=e},Nn=(s,e,t)=>{var o=(a,r,c,m)=>{try{var f=t[a](r),h=(r=f.value)instanceof Ms,x=f.done;Promise.resolve(h?r[0]:r).then(u=>h?o(a==="return"?a:"next",r[1]?{done:u.done,value:u.value}:u,c,m):c({value:u,done:x})).catch(u=>o("throw",u,c,m))}catch(u){m(u)}},i=a=>l[a]=r=>new Promise((c,m)=>o(a,r,c,m)),l={};return t=t.apply(s,e),l[ds("asyncIterator")]=()=>l,i("next"),i("throw"),i("return"),l},Sn=s=>{var e=s[ds("asyncIterator")],t=!1,o,i={};return e==null?(e=s[ds("iterator")](),o=l=>i[l]=a=>e[l](a)):(e=e.call(s),o=l=>i[l]=a=>{if(t){if(t=!1,l==="throw")throw a;return a}return t=!0,{done:!1,value:new Ms(new Promise(r=>{var c=e[l](a);c instanceof Object||Go("Object expected"),r(c)}),1)}}),i[ds("iterator")]=()=>i,o("next"),"throw"in e?o("throw"):i.throw=l=>{throw l},"return"in e&&o("return"),i},En=(s,e,t)=>(e=s[ds("asyncIterator")])?e.call(s):(s=s[ds("iterator")](),e={},t=(o,i)=>(i=s[o])&&(e[o]=l=>new Promise((a,r,c)=>(l=i.call(s,l),c=l.done,Promise.resolve(l.value).then(m=>a({value:m,done:c}),r)))),t("next"),t("return"),e);import{h as Ft,j as n,e as Os,r as P,c as $e,M as ne,_ as Se,v as Jo,n as ut,k as Xo}from"./mw35uwhq4g8r9eam.js";import{ev as Yo,aA as pt,cB as us,ca as Qo,g4 as so,g3 as an,cw as qs,mk as Zo,dp as Ot,e4 as no,fG as oo,cn as Ee,cq as ht,i$ as Ke,iZ as Ie,co as q,i_ as io,kz as ao,ct as ln,ym as ei,cp as lo,be as Ls,kB as ti,bP as xe,aD as Vs,ff as Ks,bq as Pt,R as rn,bk as et,g as _s,cF as rt,h5 as cn,eG as dn,ky as As,mH as si,qU as ni,yn as oi,U as $n,mK as ii,iC as ai,hs as Lt,fh as li,gi as ri,u as ys,ji as ro,d as ke,Q as un,dH as ci,o5 as di,dJ as ui,V as Zs,P as Mn,a1 as mi,D as fi,lF as pi,vW as hi,aw as gi,ay as xi,cf as _i,bc as yi,sZ as Tn,rx as An,e5 as en,n4 as bi,fK as vi,f7 as Hs,J as co,fE as ki,kD as wi,bg as Ci,b6 as ji,fz as uo,cd as Ni,cs as Si,ek as Ei,gh as In,jC as $i,fD as Mi,ip as Ti,cu as Ai,gB as Ii,M as Ri,H as Oi,qu as Rn,ee as Li,lE as Pi,kQ as On,hC as Ln,kR as Pn,as as Fi,ec as Di,iF as Wi,aa as Fn,k as Bi,d$ as Ui}from"./d0xa318sl7ywi0za.js";import{cb as tn,aF as zi,aG as qi,eG as Gs,cg as Vi,mT as Ki,b9 as Hi,mI as mn,im as mo,X as Gi,qN as Ji,ba as Xi,bI as fn,zS as Dn,zT as Yi,zU as Qi,w1 as Zi,il as ea,w0 as ps,i0 as fo,cJ as ta,nN as sa,cB as At,zV as Ts,z as na,cC as Wn,zW as oa,ec as ia,ac as aa}from"./g2euln7v5pbm31qa.js";import{S as la}from"./nk904upldvj1ufei.js";import{g as ra}from"./m966r6qv7jykyvdd.js";import{L as sn}from"./mtsxj0469osb30cx.js";import{p as po,h as Rt,g as pn,a as ho,b as go,J as L,c as xo,i as Ze,d as ca,e as da,f as ua,j as ma,k as fa,l as pa,m as Bn}from"./gs306ibz22k5zi3r.js";import{A as ha}from"./lvrypwdhnjlsz45f.js";import{t as ga}from"./l2u6v2d9vfposl4n.js";import{S as xa}from"./f89v9mtyvakgmoul.js";import{S as _a}from"./oftnd9rlobxeh2e2.js";import{a as Un,b as ya,i as ba}from"./nc9vr5q4g3rosm9u.js";import{M as Js,E as va}from"./ns51nblw8ziscsgd.js";import{a as Xs}from"./ehv2vkvc6wjiqj3r.js";import{A as _o,C as ka}from"./lqx184c6v77q7gok.js";var Xn;const wa=us.div(Xn||(Xn=Tt(["h-px bg-token-border-default"])));var Yn;const mt=us.div(Yn||(Yn=Tt(["text-sm font-medium py-3 leading-6"])));var Qn;const Ca=us.div(Qn||(Qn=Tt(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),Ys=":",ja=({to:s,cc:e,bcc:t,subject:o,body:i,onClick:l,isDraft:a=!0,isCanceled:r=!1})=>{const c=Ft(),m=[];return s&&m.push(n.jsx("div",{children:n.jsxs("div",{className:"flex",children:[n.jsxs(mt,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(It.draftToFieldLabel),Ys]}),n.jsx(mt,{children:s})]})},"to")),e&&m.push(n.jsx("div",{children:n.jsxs("div",{className:"flex",children:[n.jsxs(mt,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(It.draftCcFieldLabel),Ys]}),n.jsx(mt,{children:e})]})},"cc")),t&&m.push(n.jsx("div",{children:n.jsxs("div",{className:"flex",children:[n.jsxs(mt,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(It.draftBccFieldLabel),Ys]}),n.jsx(mt,{children:t})]})},"bcc")),o&&m.push(n.jsx(mt,{children:o},"subject")),i&&m.push(n.jsx(mt,{className:"whitespace-pre-line",children:i},"body")),n.jsxs(Ca,{children:[n.jsxs("div",{className:"mb-4 flex items-center",children:[n.jsx(Yo,{className:"icon-sm me-4"}),n.jsx("div",{className:"font-semibold",children:a?c.formatMessage(It.draftMessageLabel):c.formatMessage(It.sentMessageLabel)})]}),m.map((f,h)=>n.jsxs(P.Fragment,{children:[n.jsx(wa,{}),f]},h)),a&&!r&&n.jsx("div",{className:"mt-2 flex justify-end gap-4",children:n.jsx(pt,{color:"primary",className:"py-2",onClick:l,children:c.formatMessage(It.sendButton)})}),r&&n.jsx("div",{className:"mt-2 flex justify-end gap-4",children:n.jsx(pt,{color:"primary",className:"py-2",disabled:!0,children:c.formatMessage(It.canceledButton)})})]})},It=Os({draftMessageLabel:{id:"emailView.draftMessageLabel",defaultMessage:"Draft Message"},sentMessageLabel:{id:"emailView.sentMessageLabel",defaultMessage:"Sent Message"},sendButton:{id:"emailView.sendButton",defaultMessage:"Send"},draftToFieldLabel:{id:"emailView.draftToLabel",defaultMessage:"To"},draftCcFieldLabel:{id:"emailView.draftCcLabel",defaultMessage:"Cc"},draftBccFieldLabel:{id:"emailView.draftBccLabel",defaultMessage:"Bcc"},canceledButton:{id:"emailView.canceledButton",defaultMessage:"Canceled"}}),Na=s=>{"use forget";const e=$e.c(19),{clientThreadId:t,action:o,messages:i,onRequestCompletion:l,handleUserAction:a,rememberAnswer:r,toolCallSafetySummary:c}=s;let m;e[0]!==i?(m=po(i),e[0]=i,e[1]=m):m=e[1];const{assistantMessage:f}=m,h=Qo();let x;e[2]!==c?(x=c!=null&&c.sensitive_data?Object.keys(c.sensitive_data).some(Sa):!1,e[2]=c,e[3]=x):x=e[3];const u=x,g=(c==null?void 0:c.danger_level)==="HIGH"||u;let b;return e[4]!==o.allow||e[5]!==o.always_allow||e[6]!==o.deny||e[7]!==o.name||e[8]!==o.type||e[9]!==h||e[10]!==f||e[11]!==t||e[12]!==a||e[13]!==g||e[14]!==i||e[15]!==l||e[16]!==r||e[17]!==c?(b=o.type==="deny"?n.jsx(pt,{className:"flex-1",color:g?"primary":"secondary",size:"medium",onClick:p=>{a({clientThreadId:t,sourceEvent:p,onRequestCompletion:l,assistantMessage:f,allMessages:i,actionData:lt(he({type:"deny"},o.deny),{remember_answer:r}),activeSystemHint:h})},children:n.jsx(ne,he({},o.name==="decline"?hs.decline:hs.deny))}):o.type==="allow"?n.jsx(pt,{className:"flex-1",color:g?"secondary":"primary",size:"medium",onClick:p=>{a({clientThreadId:t,sourceEvent:p,onRequestCompletion:l,assistantMessage:f,allMessages:i,actionData:lt(he({type:"allow"},o.allow),{remember_answer:r}),activeSystemHint:h})},children:c!=null&&c.action_name?c.action_name:n.jsx(ne,he({},o.name==="allow"?hs.allow:hs.confirm))}):o.type==="always_allow"?n.jsx(pt,{className:"flex-1",color:"secondary",size:"medium",onClick:p=>{a({clientThreadId:t,sourceEvent:p,onRequestCompletion:l,assistantMessage:f,allMessages:i,actionData:he({type:"always_allow"},o.always_allow),activeSystemHint:h})},children:n.jsx(ne,he({},hs.alwaysAllow))}):null,e[4]=o.allow,e[5]=o.always_allow,e[6]=o.deny,e[7]=o.name,e[8]=o.type,e[9]=h,e[10]=f,e[11]=t,e[12]=a,e[13]=g,e[14]=i,e[15]=l,e[16]=r,e[17]=c,e[18]=b):b=e[18],b},hs=Os({alwaysAllow:{id:"jitPluginMessage.alwaysAllow",defaultMessage:"Always Allow"},allow:{id:"jitPluginMessage.allow",defaultMessage:"Allow"},decline:{id:"jitPluginMessage.decline",defaultMessage:"Decline"},confirm:{id:"jitPluginMessage.confirm",defaultMessage:"Confirm"},deny:{id:"jitPluginMessage.deny",defaultMessage:"Deny"}});function Sa(s){return s==="Suspicious Content"}function Ea({functionName:s,params:e,toolCallSafetySummary:t,result:o,isWrite:i,messages:l,clientThreadId:a,jitPluginData:r,onRequestCompletion:c,rememberForThisConversation:m}){var b,p,d,y;const f=so(),h=an(),{namespace:x,actionName:u}=$a(s),g=((b=r==null?void 0:r.from_server)==null?void 0:b.type)!=="denied_by_user"?(p=r==null?void 0:r.from_server)==null?void 0:p.body.actions.map((j,k)=>n.jsx(Na,{clientThreadId:a,messages:l,onRequestCompletion:c,action:j,handleUserAction:Rt,rememberAnswer:m,toolCallSafetySummary:t},k)):null;if(x==="api_tool"&&u==="call_tool"&&e&&"path"in e&&"args"in e&&typeof e.path=="string"&&(typeof e.args=="object"||typeof e.args=="string")&&e.args!=null){const[j,k,w]=e.path.split("/").filter(Boolean);if(j&&k&&w){const E=[...f.connectorLinks.values()].flat().find(I=>I.id===k),C=E&&h.platformConnectors.get(E.connector_id);return n.jsx(zn,{connector:{name:(d=C==null?void 0:C.name)!=null?d:j,logo_url:(y=C==null?void 0:C.logo_url)!=null?y:null},actionName:w,isWrite:i,params:typeof e.args=="object"?e.args:JSON.parse(e.args),toolCallSafetySummary:t,result:o,actionButtons:g})}}return n.jsx(zn,{connector:{name:x,logo_url:null},actionName:u,isWrite:i,params:e,result:o,actionButtons:g})}function $a(s){const e=s.indexOf("."),t=e===-1?s:s.slice(0,e),o=e===-1?"":s.slice(e+1);return{namespace:t,actionName:o}}function zn({connector:s,actionName:e,params:t,result:o,isWrite:i,toolCallSafetySummary:l,actionButtons:a}){var v,D,W,H;const r=Ft(),[c,m]=P.useState(!1),[,f]=P.useState("request"),h=P.useId(),x=P.useId(),u=(v=l==null?void 0:l.title)!=null?v:"",g=(D=l==null?void 0:l.description)!=null?D:"",b=e,p=Object.entries((W=l==null?void 0:l.sensitive_data)!=null?W:{}).filter(([,_])=>_==null?!1:Array.isArray(_)),d=Object.entries((H=l==null?void 0:l.suspicious_data)!=null?H:{}).filter(([,_])=>_==null?!1:Array.isArray(_)),y=p.length>0||d.length>0,j=_=>_.join(", "),k=_=>{const $=j(_);return $.length<20?$:$.slice(0,20)+"..."},w=t!=null,E=o!=null,C=w||E,I=()=>{f(w?"request":"response"),m(!0)};return l?n.jsxs("div",{className:"mt-1 mb-4 w-full max-w-md",children:[n.jsxs("div",{className:"border-token-border-medium bg-token-bg-tertiary/20 flex flex-col gap-3 rounded-3xl border px-5 py-5 text-start",children:[n.jsx("div",{className:"flex items-center justify-between gap-2",children:n.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[n.jsx(tn,{connector:s,size:"xsmall"}),n.jsx("div",{className:"flex flex-1 flex-col gap-2",children:n.jsx("div",{className:"text-token-text-secondary text-sm tracking-wide",children:s.name})})]})}),n.jsxs("div",{className:"flex flex-col gap-2 px-1",children:[n.jsx("h2",{className:"text-token-text-primary text-lg font-semibold",children:u}),g&&n.jsxs("p",{className:"text-token-text-secondary text-sm",children:[g,C&&n.jsxs(n.Fragment,{children:[" ",n.jsx("button",{type:"button",onClick:I,className:"text-token-text-secondary font-regular underline",children:n.jsx(ne,he({},ft.details))})]})]})]}),y&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col gap-2 px-1 py-2",children:[n.jsx("div",{className:"text-token-text-tertiary font-regular text-sm",children:r.formatMessage(ft.dataShared)}),n.jsxs("dl",{className:"",children:[p.map(([_,$])=>{const S=j($),R=k($);return n.jsxs("div",{className:"flex flex-col gap-1 py-1 sm:flex-row sm:items-center sm:gap-4",children:[n.jsx("dt",{className:"font-regular text-token-text-tertiary text-start text-sm",children:_}),n.jsx("dd",{className:"text-token-text-primary text-sm font-normal sm:ms-auto sm:max-w-xs sm:truncate sm:text-end",children:n.jsx(qs,{side:"top",align:"end",label:S?n.jsx("div",{className:"text-token-text-primary max-w-xs text-start text-sm break-words",children:S}):void 0,children:n.jsx("span",{className:"block truncate",children:R})})})]},_)}),d.map(([_,$])=>{const S=j($),R=k($);return n.jsxs("div",{className:"flex flex-col gap-1 py-1 sm:flex-row sm:items-center sm:gap-4",children:[n.jsx("dt",{className:"font-regular text-interactive-label-warning-secondary text-start text-sm",children:n.jsx(qs,{side:"top",align:"start",label:r.formatMessage(ft.suspiciousContentTooltip),children:n.jsxs("span",{className:"inline-flex items-center gap-1",children:[n.jsx("span",{className:"text-token-text-error",children:_}),n.jsx(Zo,{"aria-hidden":"true",className:"interactive-label-warning-secondary icon-xs text-token-text-error"})]})})}),n.jsx("dd",{className:"text-token-text-primary text-sm font-normal sm:ms-auto sm:max-w-xs sm:truncate sm:text-end",children:n.jsx(qs,{side:"top",align:"end",label:S?n.jsx("div",{className:"text-token-text-primary max-w-xs text-start text-sm break-words",children:S}):void 0,children:n.jsx("span",{className:"block truncate",children:R})})})]},_)})]})]}),n.jsx("div",{className:"token-border-subtle mx-1 mt-1 h-0 border-t"})]}),a&&Array.isArray(a)&&a.length>0&&n.jsx("div",{className:"mt-3 mb-1 flex flex-wrap justify-end gap-3",children:a})]}),n.jsx("div",{className:"text-token-text-tertiary mt-3 text-center text-sm",children:n.jsx(ne,{id:"APIToolCallCard.toolCallSafetyWarning",defaultMessage:"Using tools comes with risks. <link>Learn more</link>",values:{link:_=>n.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:_},"link")}})}),C&&n.jsx(Ot.Root,{testId:"modal-api-tool-call-details",isOpen:c,onClose:m,children:n.jsx(Ot.Overlay,{children:n.jsx(Ot.Content,{size:"large",className:"max-w-2xl",ariaLabelledBy:h,ariaDescribedBy:g?x:void 0,children:n.jsxs("div",{className:"flex flex-col py-2",children:[n.jsx(Ot.Header,{hasSeparator:!0,title:n.jsx("span",{id:h,className:"px-2",children:n.jsx(ne,he({},ft.details))}),closeButton:n.jsx(no,{className:"me-2",onClick:()=>m(!1)})}),n.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[g&&n.jsx("p",{id:x,className:"text-token-text-secondary text-sm",children:g}),n.jsx("div",{className:"border-token-border-subtle bg-token-bg-secondary/40 flex flex-col overflow-hidden rounded-2xl border",children:n.jsxs("div",{className:"border-token-border-subtle flex flex-wrap items-center justify-between gap-3 py-1",children:[n.jsxs("div",{className:"border-token-border-subtle flex w-full items-center justify-between border-b px-4 py-3",children:[n.jsx("span",{className:"text-token-text-primary text-sm font-semibold",children:b}),i&&n.jsx("div",{className:"bg-token-bg-status-error/10 text-token-text-error inline-flex min-w-[60px] items-center justify-center rounded-full px-2 text-[10px] font-semibold tracking-wide uppercase",children:n.jsx(ne,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),n.jsxs("div",{className:"mb-4 grid w-full gap-4 px-1",children:[t!=null&&n.jsx(xs,{isInitialLevelExpanded:i,name:ft.request,params:t}),o!=null&&n.jsx(xs,{name:ft.response,params:o})]})]})})]})]})})})})]}):n.jsxs("div",{className:"bg-token-bg-default mt-1 mb-4 grid max-w-xl gap-4 rounded-xl p-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(tn,{connector:{name:s.name,logo_url:s.logo_url,logo_url_dark:void 0},size:"large"}),n.jsxs("div",{className:"flex flex-1 flex-col",children:[n.jsx("div",{className:"text-token-text-secondary text-xs",children:s.name}),n.jsx("div",{className:"text-token-text-primary text-sm",children:e})]}),i&&n.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:n.jsx(ne,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),t!=null&&n.jsx(xs,{isInitialLevelExpanded:i,name:ft.request,params:t}),o!=null&&n.jsx(xs,{name:ft.response,params:o}),i&&n.jsxs("div",{className:"text-token-text-secondary text-sm",children:[n.jsx(oo,{className:"icon-sm me-1 mb-0.5 inline-block"}),n.jsx(ne,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:_=>n.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:_},"link")}})]})]})}function xs({name:s,afterName:e,params:t,isInitialLevelExpanded:o=!1}){const i=Ft();return n.jsxs("div",{className:"bg-token-bg-secondary/30 max-w-full min-w-0 space-y-3 rounded-lg p-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"text-token-text-secondary text-xs",children:typeof s=="string"?s:i.formatMessage(s)}),e]}),n.jsx(zi,{buttonText:!0,className:"text-token-text-secondary text-xs",onCopy:()=>qi(typeof t=="string"?t:JSON.stringify(t))})]}),typeof t=="string"?n.jsx("div",{className:"text-token-text-primary line-clamp-3 font-mono text-sm",children:t}):n.jsx(sn,{isInitialLevelExpanded:o,value:t})]})}const ft=Os({request:{id:"APIToolCallCard.request",defaultMessage:"Request"},response:{id:"APIToolCallCard.response",defaultMessage:"Response"},details:{id:"APIToolCallCard.details",defaultMessage:"Details"},noDetails:{id:"APIToolCallCard.noDetails",defaultMessage:"No additional details available."},dataShared:{id:"APIToolCallCard.dataShared",defaultMessage:"Sharing data includes:"},functionLabel:{id:"APIToolCallCard.function",defaultMessage:"Function"},allowForConversation:{id:"APIToolCallCard.allowForConversation",defaultMessage:"Allow for conversation"},suspiciousContentTooltip:{id:"APIToolCallCard.suspiciousContentTooltip",defaultMessage:"There is a suspicious piece of text being shared that looks like random or encrypted data. It could be risky, for example it could contain your personal information encrypted in some way. It may not be harmful though, for example if it is part of a legitimate link being shared. It is safe to deny the action."}}),Ma=["stripe"],Ta=["card"],Aa=["terms_of_use","privacy_policy","seller_shop_policies"],Ia=["missing","invalid","out_of_stock","payment_declined","requires_sign_in","requires_3ds"],Ra=["plain","markdown"],Oa=["items_base_amount","items_discount","subtotal","discount","fulfillment","tax","fee","tip","total"],yo=["not_ready_for_payment","ready_for_payment","completed","canceled"],bo=Ee({id:q,item:Ee({id:q,quantity:Ie}),base_amount:Ie,discount:Ie,subtotal:Ie,tax:Ie,total:Ie}),vo=Ee({type:ht(Oa),display_text:q,amount:Ie}),La=Ee({id:q,type:()=>"shipping",title:q,subtitle:q,subtotal:Ie,tax:Ie,total:Ie,carrier_info:q,earliest_delivery_time:q,latest_delivery_time:q}),Pa=Ee({id:q,type:()=>"digital",title:q,subtitle:q,subtotal:Ie,tax:Ie,total:Ie}),ko=s=>{var t;switch(ln((t=lo(s))==null?void 0:t.type,["shipping","digital"])){case"shipping":return La(s);case"digital":return Pa(s)}},wo=ht(Ra),Fa=Ee({type:()=>"info",param:q,content_type:wo,content:q}),Co=Ee({type:()=>"error",code:ht(Ia),param:q,content_type:wo,content:q}),jo=s=>{var t;switch(ln((t=lo(s))==null?void 0:t.type,["info","error"])){case"info":return Fa(s);case"error":return Co(s)}},No=Ee({type:ht(Aa),url:q}),So=Ee({name:q,line_one:q,line_two:q,city:q,state:q,country:s=>{var e;return(e=ga(s))!=null?e:"US"},postal_code:q}),Da=Ee({id:q,checkout_session_id:q,permalink_url:q}),Eo=Ee({merchant_id:q,provider:ht(Ma),supported_payment_methods:Ke(ht(Ta))}),$o=s=>ln(q(s).toUpperCase(),ei),Wa=Ee({id:q,payment_provider:Eo,status:ht(yo),currency:$o,line_items:Ke(bo),totals:Ke(vo),fulfillment_options:Ke(ko),fulfillment_address:ao(So),fulfillment_option_id:io(q),messages:Ke(jo),links:Ke(No)}),Cr=Ee({id:q,buyer:Ee({email:q,phone_number:q}),status:ht(yo),currency:$o,line_items:Ke(bo),totals:Ke(vo),fulfillment_options:Ke(ko),fulfillment_address:ao(So),fulfillment_option_id:io(q),messages:Ke(jo),links:Ke(No),order:Da}),Ba=Ls(()=>Se(()=>import("./f4lmde6olrjh5i2c.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40])).then(s=>s.EcosystemCheckoutModal));class Ua{constructor(e){J(this,"checkoutPromise$",xe(null));J(this,"chatSDK$",xe(null));J(this,"resolvedWidget$",xe(null));J(this,"isLoadingPayment$",xe(!0));J(this,"checkoutSession$",xe(null));J(this,"grandTotal$",Vs(()=>{var e;return(e=this.checkoutSession$())==null?void 0:e.totals.find(t=>t.type==="total")}));J(this,"status$",xe("idle"));J(this,"messages$",xe([]));J(this,"errorMessages$",Vs(()=>this.messages$().filter(e=>e.type==="error")));J(this,"paymentDetails$",xe(null));J(this,"paymentTypes$",xe([]));J(this,"allowedCountries$",xe([]));J(this,"paymentSheetButtonCta$",xe(""));J(this,"publishableKey$",xe(null));J(this,"customerId$",xe(null));J(this,"footerMessage$",xe(null));J(this,"sellerDetails$",xe(null));J(this,"billingAddress$",xe(null));J(this,"billingAddressComplete$",Vs(()=>{var e,t,o,i,l,a;return this.billingAddress$()?!!((e=this.billingAddress$())!=null&&e.name)&&!!((t=this.billingAddress$())!=null&&t.line_one)&&!!((o=this.billingAddress$())!=null&&o.city)&&!!((i=this.billingAddress$())!=null&&i.state)&&!!((l=this.billingAddress$())!=null&&l.country)&&!!((a=this.billingAddress$())!=null&&a.postal_code):!1}));J(this,"openCheckout",(e,t,o)=>new Promise((i,l)=>{Ks(()=>{var a;this.checkoutPromise$.set({resolve:i,reject:l}),this.chatSDK$.set(e),this.resolvedWidget$.set(t),this.checkoutSession$.set(o),this.billingAddress$.set((a=o.fulfillment_address)!=null?a:null),Pt(this.conversation.ctx,Ba,{conversation:this.conversation})})}));J(this,"closeCheckout",()=>Ks(()=>{this.messages$.set([]),this.chatSDK$.set(null),this.checkoutSession$.set(null),this.billingAddress$.set(null),this.paymentSheetButtonCta$.set(""),this.checkoutPromise$.set(null),this.status$.set("idle")}));J(this,"cancelCheckout$",()=>{var e;(e=this.checkoutPromise$())==null||e.reject(),this.closeCheckout()});J(this,"completeCheckout$",e=>{var t,o;this.status$.set("complete"),(o=(t=this.checkoutPromise$())==null?void 0:t.resolve)==null||o.call(t,e)});J(this,"addErrorMessage$",e=>{this.messages$.set([...this.messages$(),Co({code:"invalid",content:e})])});J(this,"fetchStripeSession$",async()=>{var u,g,b,p,d,y;const e=window.location.href,t=e.includes("/share/"),o=this.conversation.serverId$(),i=Eo((g=(u=this.checkoutSession$())==null?void 0:u.payment_provider)!=null?g:{}),{customer_id:l,customer_session_client_secret:a,publishable_key:r,payment_types:c,allowed_countries:m,seller_details:f,payment_sheet_button_cta:h,footer_level_message:x=null}=await rn.safePost("/shopping/ecosystem/checkout/{checkout_session_id}",{parameters:{path:{checkout_session_id:(p=(b=this.checkoutSession$())==null?void 0:b.id)!=null?p:""}},requestBody:he({payment_provider:i,merchant_name:et(this.resolvedWidget$()).name,links:(y=(d=this.checkoutSession$())==null?void 0:d.links)!=null?y:[],ecosystem_app_uri:et(this.chatSDK$()).widgetParent,connector_id:et(this.chatSDK$()).connectorId},t?{sharedConversationUrl:e}:{conversationId:o})});return Ks(()=>{this.footerMessage$.set(x),this.publishableKey$.set(r),this.customerId$.set(l),this.paymentTypes$.set(c),this.allowedCountries$.set(m),this.sellerDetails$.set(f),this.paymentSheetButtonCta$.set(h)}),{client_secret:a,publishable_key:r}});this.conversation=e}}const za=ti(s=>new Ua(s)),qa=/^[A-Z]{3}$/,Va=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|[+-]\d{2}:\d{2})$/i,Ka=/^\+[1-9]\d{1,14}$/,Ha=["fee","tax","fulfillment","discount","items_discount","tip"];function K(s,e,t){if(!s){if(t)throw new Error("Invalid checkout session: ".concat(e));console.warn("Invalid checkout session: ".concat(e))}}const we=(s,e,t)=>{K(s.trim().length>0,"".concat(e," must be a non-empty string"),t)},gs=(s,e,t,o)=>{K(s.length<=e,"".concat(t," must be ").concat(e," characters or fewer"),o)},ct=(s,e,t)=>{K(Number.isInteger(s),"".concat(e," must be provided in integer minor currency units"),t),K(s>=0,"".concat(e," must be greater than or equal to 0"),t)},Ga=(s,e,t)=>{K(Number.isInteger(s)&&s>0,"".concat(e," must be a positive integer"),t)},qn=s=>Va.test(s)&&!Number.isNaN(Date.parse(s)),Ja=(s,e)=>{K(s.length>0,"links must include at least one entry (e.g. terms of use or privacy policy)",e),s.forEach((t,o)=>{we(t.url,"links[".concat(o,"].url"),e);try{new URL(t.url)}catch(i){throw new Error("Invalid checkout session: links[".concat(o,"].url must be an absolute URL"))}})},Xa=(s,e)=>{var t;we(s.name,"fulfillment_address.name",e),gs(s.name,256,"fulfillment_address.name",e),we(s.line_one,"fulfillment_address.line_one",e),gs(s.line_one,60,"fulfillment_address.line_one",e),(t=s.line_two)!=null&&t.trim()&&gs(s.line_two,60,"fulfillment_address.line_two",e),we(s.city,"fulfillment_address.city",e),gs(s.city,60,"fulfillment_address.city",e),we(s.state,"fulfillment_address.state",e),we(s.country,"fulfillment_address.country",e),we(s.postal_code,"fulfillment_address.postal_code",e),gs(s.postal_code,20,"fulfillment_address.postal_code",e),s.phone_number&&K(Ka.test(s.phone_number),"fulfillment_address.phone_number must follow the E.164 format (example: +15551234567)",e)},Ya=(s,e)=>{const t={baseAmount:0,discount:0,subtotal:0,tax:0,total:0};for(const[o,i]of s.entries()){we(i.id,"line_items[".concat(o,"].id"),e),we(i.item.id,"line_items[".concat(o,"].item.id"),e),Ga(i.item.quantity,"line_items[".concat(o,"].item.quantity"),e),ct(i.base_amount,"line_items[".concat(o,"].base_amount"),e),ct(i.discount,"line_items[".concat(o,"].discount"),e),ct(i.subtotal,"line_items[".concat(o,"].subtotal"),e),ct(i.tax,"line_items[".concat(o,"].tax"),e),ct(i.total,"line_items[".concat(o,"].total"),e);const l=i.base_amount-i.discount;K(i.subtotal===l,"line_items[".concat(o,"].subtotal must equal base_amount - discount (").concat(l,")"),e);const a=i.subtotal+i.tax;K(i.total===a,"line_items[".concat(o,"].total must equal subtotal + tax (").concat(a,")"),e),t.baseAmount+=i.base_amount,t.discount+=i.discount,t.subtotal+=i.subtotal,t.tax+=i.tax,t.total+=i.total}return t},Qa=(s,e,t)=>{var u,g,b,p,d,y;K(s.length>0,"totals must contain at least one entry",t);const o={};for(const[j,k]of s.entries()){ct(k.amount,"totals[".concat(j,"].amount"),t);const w=o[k.type];w!=null&&K(Ha.includes(k.type),'totals contains duplicate total type "'.concat(k.type,'"'),t),o[k.type]=(w!=null?w:0)+k.amount}K(o.items_base_amount!==void 0,"totals must include an items_base_amount entry",t),K(o.subtotal!==void 0,"totals must include a subtotal entry",t),K(o.total!==void 0,"totals must include a total entry",t);const i=o;K(i.items_base_amount===e.baseAmount,"totals.items_base_amount (".concat(i.items_base_amount,") must equal the sum of line item base_amounts (").concat(e.baseAmount,")"),t),i.items_discount!==void 0&&K(i.items_discount===e.discount,"totals.items_discount (".concat(i.items_discount,") must equal the sum of line item discounts (").concat(e.discount,")"),t);const l=(u=i.items_discount)!=null?u:e.discount,a=e.baseAmount-l;K(i.subtotal===a,"subtotal must equal items_base_amount - items_discount (".concat(a,")"),t);const r=(g=i.discount)!=null?g:0,c=(b=i.fulfillment)!=null?b:0,m=(p=i.tax)!=null?p:e.tax,f=(d=i.fee)!=null?d:0,h=(y=i.tip)!=null?y:0,x=e.baseAmount-l-r+c+m+f+h;return K(i.total===x,"total must equal items_base_amount - items_discount - discount + fulfillment + tax + fee (".concat(x,")"),t),i},Za=(s,e)=>{const t=new Map;for(const[o,i]of s.entries()){if(we(i.id,"fulfillment_options[".concat(o,"].id"),e),we(i.title,"fulfillment_options[".concat(o,"].title"),e),i.type==="shipping"&&we(i.subtitle,"fulfillment_options[".concat(o,"].subtitle"),e),ct(i.subtotal,"fulfillment_options[".concat(o,"].subtotal"),e),ct(i.tax,"fulfillment_options[".concat(o,"].tax"),e),ct(i.total,"fulfillment_options[".concat(o,"].total"),e),K(i.total===i.subtotal+i.tax,"fulfillment_options[".concat(o,"].total must equal subtotal + tax"),e),K(!t.has(i.id),'fulfillment option ids must be unique; duplicate id "'.concat(i.id,'"'),e),i.type==="shipping"){we(i.carrier_info,"fulfillment_options[".concat(o,"].carrier_info"),e),K(qn(i.earliest_delivery_time),"fulfillment_options[".concat(o,"].earliest_delivery_time must be an RFC 3339 timestamp"),e),K(qn(i.latest_delivery_time),"fulfillment_options[".concat(o,"].latest_delivery_time must be an RFC 3339 timestamp"),e);const l=Date.parse(i.earliest_delivery_time),a=Date.parse(i.latest_delivery_time);K(l<=a,"fulfillment_options[".concat(o,"].earliest_delivery_time must be before or equal to latest_delivery_time"),e)}t.set(i.id,i)}return t},el=(s,e=!1)=>{we(s.id,"id",e),K(qa.test(s.currency),'currency "'.concat(s.currency,'" must be a lower-case ISO 4217 code'),e),K(s.payment_provider.supported_payment_methods.length>0,"payment_provider.supported_payment_methods must include at least one entry",e),we(s.payment_provider.merchant_id,"payment_provider.merchant_id",e),K(s.line_items.length>0,"line_items must contain at least one entry",e),K(s.totals.length>0,"totals must contain at least one entry",e),Ja(s.links,e),s.fulfillment_address&&Xa(s.fulfillment_address,e);const t=Ya(s.line_items,e),o=Qa(s.totals,t,e),i=Za(s.fulfillment_options,e);if(s.fulfillment_option_id){const l=et(i.get(s.fulfillment_option_id),'fulfillment_option_id "'.concat(s.fulfillment_option_id,'" must match an available fulfillment option'));K(o.fulfillment!==void 0,"totals must include a fulfillment entry when a fulfillment option is selected",e),K(o.fulfillment===l.total,"fulfillment total (".concat(o.fulfillment,") must equal the selected fulfillment option total (").concat(l.total,")"),e)}},Mo=async({ctx:s,chatSDK:e,clientThreadId:t,resolvedWidget:o,checkoutSession:i})=>{const l=Wa(i);return el(l,!1),za(_s(s,t)).openCheckout(e,o,l)},tl=Ls(()=>Se(()=>import("./l6qxa8uogotap2gn.js"),__vite__mapDeps([41,1,2,3,5,6,42])).then(s=>s.EcosystemAppFeedback)),sl=s=>{"use forget";const e=$e.c(20),{logoUrl:t,name:o,isLoading:i,onClick:l,conversationId:a,chatSDK:r,withGutter:c,withMarginBottom:m}=s,f=c===void 0?!1:c,x=(m===void 0?!1:m)&&"mb-4",u=f&&"px-4";let g;e[0]!==x||e[1]!==u?(g=rt("text-token-text-secondary dark:text-token-text-tertiary flex w-full items-center gap-2 max-sm:mt-1",x,u),e[0]=x,e[1]=u,e[2]=g):g=e[2];let b;e[3]!==i||e[4]!==t||e[5]!==o?(b=!t||i?n.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-lg"}):t&&o&&n.jsx("img",{className:"h-5 w-5 rounded-lg",src:t,alt:o}),e[3]=i,e[4]=t,e[5]=o,e[6]=b):b=e[6];let p;e[7]!==o?(p=o?n.jsx("button",{className:"hover:text-token-text-primary group-hover:text-token-text-primary",children:o}):n.jsx("div",{className:"loading-results-shimmer h-5 w-16 rounded-md"}),e[7]=o,e[8]=p):p=e[8];let d;e[9]!==l||e[10]!==b||e[11]!==p?(d=n.jsxs("span",{className:"group inline-flex items-center gap-2",onClick:l,role:"button",children:[b,p]}),e[9]=l,e[10]=b,e[11]=p,e[12]=d):d=e[12];let y;e[13]!==r||e[14]!==a?(y=n.jsx("span",{className:"ms-auto",children:n.jsx(tl,{chatSDK:r,conversationId:a})}),e[13]=r,e[14]=a,e[15]=y):y=e[15];let j;return e[16]!==g||e[17]!==d||e[18]!==y?(j=n.jsxs("div",{className:g,children:[d,y]}),e[16]=g,e[17]=d,e[18]=y,e[19]=j):j=e[19],j},nn=44,nl=s=>{"use forget";const e=$e.c(7),{safeAreaInsetTop:t,safeAreaInsetLeft:o,onClick:i}=s;let l;e[0]!==o||e[1]!==t?(l={height:nn,width:nn,marginTop:t,marginLeft:o},e[0]=o,e[1]=t,e[2]=l):l=e[2];let a;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=n.jsx(cn,{}),e[3]=a):a=e[3];let r;return e[4]!==i||e[5]!==l?(r=n.jsx("button",{className:"bg-token-bg-primary text-token-text-primary shadow-short dark:shadow-long fixed start-4 top-0 z-10 aspect-square rounded-full p-3 transition-transform active:scale-115 active:opacity-75",onClick:i,style:l,children:a}),e[4]=i,e[5]=l,e[6]=r):r=e[6],r},To=8,ol=s=>{"use forget";const e=$e.c(34),{title:t,widgetDisplayName:o,widgetDomain:i,onClickBack:l,onClickClose:a,onClickForward:r,onClickOpenInApp:c,canGoBack:m,canGoForward:f,logo:h}=s,x=Ft();if(dn()){let v;return e[0]!==a?(v=n.jsx(nl,{safeAreaInsetTop:To,safeAreaInsetLeft:0,onClick:a}),e[0]=a,e[1]=v):v=e[1],v}let u;e[2]!==x?(u=x.formatMessage({id:"H0F9KU",defaultMessage:"Close"}),e[2]=x,e[3]=u):u=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=n.jsx(cn,{className:"icon"}),e[4]=g):g=e[4];let b;e[5]!==a||e[6]!==u?(b=n.jsx(Gs,{label:u,className:"h-7! w-7!",onClick:a,icon:g}),e[5]=a,e[6]=u,e[7]=b):b=e[7];let p;e[8]!==m||e[9]!==f||e[10]!==x||e[11]!==l||e[12]!==r?(p=(m||f)&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Gs,{label:x.formatMessage({id:"y0H9Ps",defaultMessage:"Back"}),className:"h-7! w-7!",onClick:l,disabled:!m,icon:n.jsx(xa,{className:"icon"})}),n.jsx(Gs,{label:x.formatMessage({id:"4zGgS+",defaultMessage:"Forward"}),className:"h-7! w-7!",onClick:r,disabled:!f,icon:n.jsx(_a,{className:"icon"})})]}),e[8]=m,e[9]=f,e[10]=x,e[11]=l,e[12]=r,e[13]=p):p=e[13];let d;e[14]!==b||e[15]!==p?(d=n.jsxs("div",{className:"flex items-center justify-start gap-3",children:[b,p]}),e[14]=b,e[15]=p,e[16]=d):d=e[16];let y;e[17]!==t?(y=n.jsx("div",{className:"text-token-text-secondary flex items-center justify-center text-base",children:t}),e[17]=t,e[18]=y):y=e[18];const j=h?void 0:Vi,k=!i;let w;e[19]!==h||e[20]!==o?(w=h&&n.jsx("img",{src:h,alt:o,className:"me-2 h-4 w-4"}),e[19]=h,e[20]=o,e[21]=w):w=e[21];let E;e[22]!==o?(E=n.jsx(ne,{id:"JvQEOX",defaultMessage:"Open in {app}",values:{app:o}}),e[22]=o,e[23]=E):E=e[23];let C;e[24]!==c||e[25]!==E||e[26]!==j||e[27]!==k||e[28]!==w?(C=n.jsx("div",{className:"flex items-center justify-end",children:n.jsxs(pt,{icon:j,disabled:k,onClick:c,color:"secondary",children:[w,E]})}),e[24]=c,e[25]=E,e[26]=j,e[27]=k,e[28]=w,e[29]=C):C=e[29];let I;return e[30]!==C||e[31]!==d||e[32]!==y?(I=n.jsxs("div",{className:"border-token-border-secondary bg-token-bg-primary sm:bg-token-bg-primary z-10 grid h-(--header-height) grid-cols-[1fr_auto_1fr] border-b px-2",children:[d,y,C]}),e[30]=C,e[31]=d,e[32]=y,e[33]=I):I=e[33],I},Ao=new Set(["http:","https:"]),Vn={"http:":80,"https:":443,"ws:":80,"wss:":443};function Io(s){if(!s)return null;const e=s.trim();if(!e||e.includes("\\"))return null;try{return{url:new URL(e)}}catch(t){if(!/^[a-z][a-z0-9+.-]*:/.test(e))try{const o=e.startsWith("//")?"https:".concat(e):"https://".concat(e);return{url:new URL(o)}}catch(o){return null}return null}}function Ro(s){var x,u;const e=s.trim();if(!e)return null;const t=/^([a-z][a-z0-9+.-]*):$/i.exec(e);if(t)return{kind:"scheme",scheme:"".concat(t[1].toLowerCase(),":")};const o=/^(?:([a-z][a-z0-9+.+-]*):\/\/)?(\*|\*\.[^/:]+|[^/:]+)(?::(\*|\d+))?(\/.*)?$/i.exec(e);if(!o)return null;const i=o[1]?"".concat(o[1].toLowerCase(),":"):void 0,l=o[2],a=(x=o[3])!=null?x:null,r=(u=o[4])!=null?u:null,c=l.startsWith("*."),m=(c?l.slice(2):l).toLowerCase().replace(/\.$/,"");let f=null,h=!1;return a!==null&&(h=!0,f=a==="*"?"*":Number(a),f!=="*"&&(!Number.isFinite(f)||f<0))?null:{kind:"host",scheme:i,host:m,wildcard:c,portExplicit:h,port:f,path:r}}function Is(s){return s.toLowerCase().replace(/\.$/,"")}function Oo(s,e){const t=Is(s),o=Is(e);return t===o||t.endsWith("."+o)}function il(s,e,t){return t?Oo(s,e):Is(s)===Is(e)}function al(s,e){var o,i;if(e.port==="*")return!0;const t=s.port?Number(s.port):(o=Vn[s.protocol])!=null?o:null;if(!e.portExplicit){const l=(i=Vn[s.protocol])!=null?i:null;return t===l}return typeof e.port=="number"&&t===e.port}function ll(s){var i,l;const e=(i=s.scheme)!=null?i:"https:";if(!Ao.has(e)||!s.host)return null;const t=typeof s.port=="number"?":".concat(s.port):"",o=(l=s.path)!=null?l:"";try{return new URL("".concat(e,"//").concat(s.host).concat(t).concat(o))}catch(a){return null}}function rl(s){var o,i;const e=Io(s!=null?s:void 0);if(e&&Ao.has(e.url.protocol)&&!e.url.hostname.includes("*"))return e.url.toString();if(!s)return null;const t=Ro(s);return!t||t.kind==="scheme"?null:(i=(o=ll(t))==null?void 0:o.toString())!=null?i:null}function cl(s,e,t){var r;if(!s)return!1;const o=Io(s);if(!o)return!1;const i=o.url;if(i.username||i.password)return!1;const l=[];(r=e==null?void 0:e.connectDomains)!=null&&r.length&&l.push(...e.connectDomains);const a=t==null?void 0:t.trim();return a&&l.push(a),l.length?l.some(c=>{const m=Ro(c);if(!m)return!1;if(m.kind==="scheme")return i.protocol===m.scheme;if(m.scheme)return!(i.protocol!==m.scheme||!il(i.hostname,m.host,m.wildcard)||!al(i,m));{const f=m.host;return!!Oo(i.hostname,f)}}):!1}const dl=Ls(()=>Se(()=>import("./ok9dkhrmtedi0ido.js"),__vite__mapDeps([43,1,2,3,44])).then(s=>s.ConfirmExternalLinkModal)),Kn=Ls(()=>Se(()=>import("./mgd4bano9n2tt0tl.js"),__vite__mapDeps([45,1,2,3])).then(s=>s.SafeLinkWarningModal)),Hn=(s,e)=>{si()?Pt(s,dl,{url:e}):window.open(e,"_blank","noopener,noreferrer")},Lo=async({ctx:s,href:e,resolvedPineappleUri:t,csp:o,domain:i,distributionChannel:l})=>{if(e){if(l===As.OPENAI){if(await ul(e,t)){Hn(s,e);return}Pt(s,Kn,{urls:e});return}if(cl(e,o,i)){Hn(s,e);return}Pt(s,Kn,{urls:e})}};async function ul(s,e){try{return(await rn.safePost("/ecosystem/url_safe",{requestBody:{url:s,resolved_pineapple_uri:e}})).safe}catch(t){return!1}}const Po=s=>{let e="unknown";dn()?e="mobile":ni()?e="tablet":oi()&&(e="desktop");let t="web";return s==="skybridge"&&(t="native"),{device:{type:e,platform:t},capabilities:{hover:$n(ai),touch:$n(ii)}}},ml=s=>s.concat().sort().map(e=>"".concat(e," *")).join("; "),fl=(s,e,t)=>"?"+["","app=".concat(s),"locale=".concat(e),"deviceType=".concat(Po(s).device.type),""].filter(Boolean).join("&"),pl=s=>{if(s){const e=new URL(Un);return e.hostname="".concat(s,".").concat(e.hostname),e.protocol=ya,e.origin}return Un};function hl(s){"use forget";const e=$e.c(24),{host:t,features:o,isInert:i,title:l,ref:a,subdomain:r,iframeRef:c,api:m,locale:f}=s,h=t===void 0?"chatgpt":t,x=i===void 0?!1:i,[u]=P.useState(gl);let g;e[0]!==u?(g=async(S,...R)=>{var V;const X=R;return await li(()=>!!u()),et((V=u())==null?void 0:V[S],"Method ".concat(String(S)," not found"))(...X)},e[0]=u,e[1]=g):g=e[1];const b=Lt(g);let p,d;e[2]!==b?(p=()=>new Proxy({},{get:(S,R)=>(...X)=>b(R,...X)}),d=[b],e[2]=b,e[3]=p,e[4]=d):(p=e[3],d=e[4]),P.useImperativeHandle(a,p,d);const y=P.useRef(m);let j,k;e[5]!==m?(j=()=>{y.current=m},k=[m],e[5]=m,e[6]=j,e[7]=k):(j=e[6],k=e[7]),P.useEffect(j,k);let w;e[8]!==u?(w=S=>S?(ba(S,new Proxy(y.current,{get:(R,X)=>y.current[X]}),["runUserCode","runWidgetCode","runComponent"]).then(R=>{u.set(R)}),()=>{u.set(null)}):u.set(null),e[8]=u,e[9]=w):w=e[9];const E=Lt(w);let C;e[10]!==r?(C=pl(r),e[10]=r,e[11]=C):C=e[11];const I=C,v="sandbox-".concat(I);let D;e[12]!==h||e[13]!==f?(D=fl(h,f),e[12]=h,e[13]=f,e[14]=D):D=e[14];const W="".concat(I).concat(D),H=Ki(E,c);let _;e[15]!==o?(_=o!=null&&o.length?ml(o):void 0,e[15]=o,e[16]=_):_=e[16];let $;return e[17]!==x||e[18]!==v||e[19]!==W||e[20]!==H||e[21]!==_||e[22]!==l?($=n.jsx(ri,{children:n.jsx("iframe",{title:l,inert:x,src:W,ref:H,sandbox:"allow-scripts allow-same-origin allow-forms",allow:_,className:"h-full w-full max-w-full"},v)}),e[17]=x,e[18]=v,e[19]=W,e[20]=H,e[21]=_,e[22]=l,e[23]=$):$=e[23],$}function gl(){return xe(null)}const xl=async(s,e)=>{const{trackFatalWidgetError:t}=await Se(async()=>{const{trackFatalWidgetError:o}=await import("./mqid879cmc46z1v1.js");return{trackFatalWidgetError:o}},__vite__mapDeps([42,2,1,3]));t(s,e)},_l=async(s,e)=>{const{trackWidgetError:t}=await Se(async()=>{const{trackWidgetError:o}=await import("./mqid879cmc46z1v1.js");return{trackWidgetError:o}},__vite__mapDeps([42,2,1,3]));t(s,e)},yl=async s=>{const{trackWidgetLinkOut:e}=await Se(async()=>{const{trackWidgetLinkOut:t}=await import("./mqid879cmc46z1v1.js");return{trackWidgetLinkOut:t}},__vite__mapDeps([42,2,1,3]));e(s)},bl=async(s,e)=>{const{trackSandboxInstrument:t}=await Se(async()=>{const{trackSandboxInstrument:o}=await import("./mqid879cmc46z1v1.js");return{trackSandboxInstrument:o}},__vite__mapDeps([42,2,1,3]));t(s,e)},vl=async s=>{const{trackSecurityPolicyViolation:e}=await Se(async()=>{const{trackSecurityPolicyViolation:t}=await import("./mqid879cmc46z1v1.js");return{trackSecurityPolicyViolation:t}},__vite__mapDeps([42,2,1,3]));e(s)},kl=async(s,e)=>{const{trackWidgetDisplayMode:t}=await Se(async()=>{const{trackWidgetDisplayMode:o}=await import("./mqid879cmc46z1v1.js");return{trackWidgetDisplayMode:o}},__vite__mapDeps([42,2,1,3]));t(s,e)},wl=async(s,e)=>{const{trackWidgetNavigation:t}=await Se(async()=>{const{trackWidgetNavigation:o}=await import("./mqid879cmc46z1v1.js");return{trackWidgetNavigation:o}},__vite__mapDeps([42,2,1,3]));t(s,e)},Cl=async s=>{const{trackWidgetCheckoutSession:e}=await Se(async()=>{const{trackWidgetCheckoutSession:t}=await import("./mqid879cmc46z1v1.js");return{trackWidgetCheckoutSession:t}},__vite__mapDeps([42,2,1,3]));e(s)},jl={insets:{top:0,bottom:0,left:0,right:0}};function Nl(){let s,e;return{promise:new Promise((o,i)=>{s=o,e=i}),resolve:s,reject:e}}const Fo=({host:s,ref:e,iframeRef:t,html:o,accessToken:i,features:l,safeArea:a=jl,attributionId:r,conversationId:c,widgetId:m,widgetParent:f,widgetDistributionChannel:h,suggestionMessageId:x,widgetType:u,csp:g,subdomain:b,viewParams:p,widgetState:d=null,toolInput:y=null,toolOutput:j=null,toolResponseMetadata:k=null,subjectId:w=null,maxHeight:E,theme:C,title:I,api:v,locale:D,displayMode:W="inline",onReady:H,onError:_})=>{"use no forget";const $=P.useMemo(()=>{var N;return{attribution_id:(N=r!=null?r:f)!=null?N:"",name:u,conversation_id:c!=null?c:null,message_id:m||null,suggestion_message_id:x!=null?x:null,distribution_channel:h}},[h,r,f,u,c,m,x]),S=P.useRef(null),R=P.useRef(null),X=P.useRef(null),A=Lt(()=>{_==null||_()}),V=Lt(()=>{H==null||H()}),Y=Lt(async N=>{var Z,ue;R.current=Nl();const B=(Z=S.current)==null?void 0:Z.runWidgetCode({html:N,widgetId:m,viewParams:p,widgetState:d,toolInput:y,toolOutput:j,toolResponseMetadata:k,subjectId:w,features:l,maxHeight:E,theme:C,displayMode:W,safeArea:a,userAgent:Po(s),csp:g});if(B)try{for(var re=En(await B),oe,fe,ie;oe=!(fe=await re.next()).done;oe=!1){const G=fe.value;G.type===Js.ENVIRONMENT_STATUS&&G.status===va.RUNNING_CODE?(V(),(ue=R.current)==null||ue.resolve()):G.type===Js.ERROR?(_l($,G.error),X.current=G.error):G.type===Js.RUN_COMPLETE&&G.wasFatalError&&(xl($,X.current),A())}}catch(fe){ie=[fe]}finally{try{oe&&(fe=re.return)&&await fe.call(re)}finally{if(ie)throw ie[0]}}});P.useEffect(()=>{o&&Y(o)},[o,Y]);const O=Lt(async N=>{var B;await((B=R.current)==null?void 0:B.promise),N()});return P.useEffect(()=>{O(()=>{var N;(N=S.current)==null||N.setWidgetProps({widgetId:m,widgetState:d,toolInput:y,toolOutput:j,toolResponseMetadata:k,subjectId:w})})},[m,d,y,j,k,w,O]),P.useEffect(()=>{O(()=>{var N;(N=S.current)==null||N.setAdditionalGlobals({additionalGlobals:{maxHeight:E}})})},[E,O]),P.useEffect(()=>{O(()=>{var N;(N=S.current)==null||N.setAdditionalGlobals({additionalGlobals:{displayMode:W,view:{params:p,mode:W}}})})},[W,p,O]),P.useEffect(()=>{O(()=>{var N;(N=S.current)==null||N.setTheme({theme:C})})},[C,O]),P.useEffect(()=>{O(()=>{var N;(N=S.current)==null||N.setSafeArea({safeArea:a})})},[a,O]),n.jsx(hl,{title:I,host:s,subdomain:b,features:l,api:lt(he({},v),{notifyNavigation:N=>{var B;wl($,N),(B=v.notifyNavigation)==null||B.call(v,N)},requestCheckout:N=>{var B;return Cl($),(B=v.requestCheckout)==null?void 0:B.call(v,N)},requestDisplayMode:N=>{var Z,ue;const{mode:B}=N;return B!==W&&kl($,B),(ue=(Z=v.requestDisplayMode)==null?void 0:Z.call(v,N))!=null?ue:{mode:B}},openExternal:N=>{var B;yl($),(B=v.openExternal)==null||B.call(v,N)},sendInstrument:N=>{bl(N,$)},notifySecurityPolicyViolation:N=>{vl(lt(he({},$),{violation:N}))},streamCompletion:function(N){return Nn(this,null,function*(){const{completionStream:B}=yield new Ms(Se(async()=>{const{completionStream:Z}=await import("./ohiuwbpwp4hx5ge4.js");return{completionStream:Z}},__vite__mapDeps([46,2,1,3,5,6])));yield*Sn(B(N,et(f),i))})},callCompletion:async function(N){const{callCompletion:B}=await Se(async()=>{const{callCompletion:Z}=await import("./ohiuwbpwp4hx5ge4.js");return{callCompletion:Z}},__vite__mapDeps([46,2,1,3,5,6]));return await B(N,et(f),i)}}),iframeRef:t,ref:Hi(S,e),locale:D})},Qs=s=>{"use forget";var Je,dt;const e=$e.c(90),{heightHint:t,title:o,sendFollowUpMessage:i,conversation:l,chatSDK:a,clientThreadId:r,resolvedWidget:c,onClose:m,domain:f,html:h,attributionId:x,widgetId:u,widgetParent:g,suggestionMessageId:b,widgetType:p,features:d,subdomain:y,csp:j,locale:k,params:w}=s,E=t===void 0?null:t,C=ys();let I;e[0]!==l?(I=mn(l),e[0]=l,e[1]=I):I=e[1];const v=I,[D,W]=P.useState(E),[H,_]=P.useState(!1),$=P.useRef(null),S=ro(),[R,X]=P.useState(!1),[A,V]=P.useState(null);let Y;e[2]!==a||e[3]!==v?(Y=()=>v.getWidgetStateAndProps$(a),e[2]=a,e[3]=v,e[4]=Y):Y=e[4];const{toolInput:O,toolOutput:N,widgetState:B,toolResponseMetadata:Z}=ke(Y),ue=(dt=(Je=a.metadata)==null?void 0:Je.subject_id)!=null?dt:null,re=A!=null?A:0;let oe;e[5]!==re?(oe={insets:{top:re,bottom:0,left:0,right:0}},e[5]=re,e[6]=oe):oe=e[6];const fe=oe,ie=!R,G=R?"opacity-100":"opacity-0";let F;e[7]!==G?(F=rt(G),e[7]=G,e[8]=F):F=e[8];const Pe=!R,He=R?"opacity-100":"opacity-0";let ee;e[9]!==He?(ee=rt("relative flex min-h-0 max-w-xl flex-col overflow-hidden lg:max-w-3xl",He),e[9]=He,e[10]=ee):ee=e[10];let pe;e[11]!==o?(pe=n.jsx(ci,{asChild:!0,className:"sr-only",children:n.jsx("span",{children:o})}),e[11]=o,e[12]=pe):pe=e[12];let Fe;e[13]===Symbol.for("react.memo_cache_sentinel")?(Fe=mo({axis:"height",onChange:me=>{const{height:Oe}=me;return V(Oe)}}),e[13]=Fe):Fe=e[13];let Ce;e[14]!==H?(Ce=H&&n.jsx(Gi,{onClick:()=>{var me;return(me=$.current)==null?void 0:me.navigate({delta:-1})},className:"text-white mix-blend-difference grayscale",children:n.jsx(di,{})}),e[14]=H,e[15]=Ce):Ce=e[15];let De;e[16]!==m?(De=n.jsx(ui,{asChild:!0,children:n.jsx(no,{onClick:m,iconSize:"lg",className:"ms-auto text-white mix-blend-difference grayscale"})}),e[16]=m,e[17]=De):De=e[17];let ge;e[18]!==Ce||e[19]!==De?(ge=n.jsxs("header",{className:"absolute start-0 end-0 top-0 flex items-center p-2",ref:Fe,children:[Ce,De]}),e[18]=Ce,e[19]=De,e[20]=ge):ge=e[20];const ye=Math.max(D!=null?D:0,E!=null?E:0);let Me;e[21]!==ye?(Me={height:ye},e[21]=ye,e[22]=Me):Me=e[22];const We=S!=null?S:"light";let Ge;e[23]===Symbol.for("react.memo_cache_sentinel")?(Ge=()=>X(!0),e[23]=Ge):Ge=e[23];let Re;e[24]!==r?(Re=un(r),e[24]=r,e[25]=Re):Re=e[25];let Be;e[26]===Symbol.for("react.memo_cache_sentinel")?(Be=me=>{W(me)},e[26]=Be):Be=e[26];let Te;if(e[27]!==a||e[28]!==r||e[29]!==j||e[30]!==C||e[31]!==f||e[32]!==v||e[33]!==m||e[34]!==c||e[35]!==i||e[36]!==g){let me;e[38]!==a||e[39]!==r||e[40]!==C||e[41]!==c?(me=de=>Mo({ctx:C,chatSDK:a,clientThreadId:r,checkoutSession:de,resolvedWidget:c}),e[38]=a,e[39]=r,e[40]=C,e[41]=c,e[42]=me):me=e[42];let Oe;e[43]===Symbol.for("react.memo_cache_sentinel")?(Oe=de=>{const{canGoBack:je}=de;_(je)},e[43]=Oe):Oe=e[43];let Ue,st,ze;e[44]!==v||e[45]!==g?(Ue=(de,je)=>v.callTool$(et(g),de,je),st=de=>v.uploadFile$(et(g),de),ze=de=>v.downloadFile$(et(g),de.fileId),e[44]=v,e[45]=g,e[46]=Ue,e[47]=st,e[48]=ze):(Ue=e[46],st=e[47],ze=e[48]);let nt;e[49]!==v?(nt=(de,je)=>v.setWidgetState$(de,je),e[49]=v,e[50]=nt):nt=e[50],Te={notifyIntrinsicHeight:Be,openExternal(de){var Xe;const{href:je}=de;Lo({ctx:C,href:je,csp:j,resolvedPineappleUri:(Xe=a.metadata.resolved_pineapple_uri)!=null?Xe:null,domain:f,distributionChannel:a.distributionChannel})},sendFollowUpMessage:i,requestClose:m,notifyEscapeKey:m,requestCheckout:me,notifyNavigation:Oe,callTool:Ue,uploadFile:st,downloadFile:ze,updateWidgetState:nt},e[27]=a,e[28]=r,e[29]=j,e[30]=C,e[31]=f,e[32]=v,e[33]=m,e[34]=c,e[35]=i,e[36]=g,e[37]=Te}else Te=e[37];let se;e[51]!==x||e[52]!==a.distributionChannel||e[53]!==j||e[54]!==d||e[55]!==h||e[56]!==k||e[57]!==w||e[58]!==fe||e[59]!==y||e[60]!==ue||e[61]!==b||e[62]!==We||e[63]!==Re||e[64]!==Te||e[65]!==O||e[66]!==N||e[67]!==Z||e[68]!==u||e[69]!==g||e[70]!==B||e[71]!==p?(se=n.jsx(Fo,{host:"chatgpt",html:h,ref:$,theme:We,attributionId:x,onReady:Ge,conversationId:Re,widgetId:u,widgetParent:g,widgetDistributionChannel:a.distributionChannel,suggestionMessageId:b,widgetType:p,subdomain:y,widgetState:B,toolInput:O,toolOutput:N,toolResponseMetadata:Z,subjectId:ue,features:d,viewParams:w,safeArea:fe,displayMode:"modal",api:Te,csp:j,locale:k}),e[51]=x,e[52]=a.distributionChannel,e[53]=j,e[54]=d,e[55]=h,e[56]=k,e[57]=w,e[58]=fe,e[59]=y,e[60]=ue,e[61]=b,e[62]=We,e[63]=Re,e[64]=Te,e[65]=O,e[66]=N,e[67]=Z,e[68]=u,e[69]=g,e[70]=B,e[71]=p,e[72]=se):se=e[72];let ce;e[73]!==Me||e[74]!==se?(ce=n.jsx("div",{className:"max-h-full flex-shrink overflow-y-auto",style:Me,children:se}),e[73]=Me,e[74]=se,e[75]=ce):ce=e[75];let ae;e[76]!==ee||e[77]!==pe||e[78]!==ge||e[79]!==ce||e[80]!==Pe?(ae=n.jsxs(Ot.Content,{"aria-hidden":Pe,className:ee,children:[pe,ge,ce]}),e[76]=ee,e[77]=pe,e[78]=ge,e[79]=ce,e[80]=Pe,e[81]=ae):ae=e[81];let _e;e[82]!==R||e[83]!==ae?(_e=n.jsx(Ot.Overlay,{showBackground:R,children:ae}),e[82]=R,e[83]=ae,e[84]=_e):_e=e[84];let tt;return e[85]!==m||e[86]!==_e||e[87]!==ie||e[88]!==F?(tt=n.jsx(Ot.Root,{"aria-hidden":ie,className:F,isOpen:!0,onClose:m,testId:"modal-kanzi-widget",children:_e}),e[85]=m,e[86]=_e,e[87]=ie,e[88]=F,e[89]=tt):tt=e[89],tt},Sl=(s,{csp:e,domain:t,subdomain:o})=>"".concat(s.metadata.html_asset_pointer,"-").concat(JSON.stringify(e),"-").concat(t,"-").concat(o),El=({chatSDK:s,prompt:e,persistedSystemHintsStore:t,clientThreadId:o,systemPrompt:i,isVisible:l=!1})=>{var c;const a=Zs.getRequestId(Mn(o));if(mi(a))return null;if(!e)return fi.addError("No prompt provided to sendFollowUpMessage"),null;const r=Zs.getBranch(Mn(o)).findLast(({message:m})=>pi(m));return{completionType:yi.Next,appendMessages:i?[_i(['The user is referring to the "'.concat(s.widgetType,'" tool with additional instructions:\n').concat(i)],{exclude_after_next_user_message:!0})]:[],promptMessage:{id:Jo(),author:{role:xi.Tool,name:s.widgetType},content:{content_type:gi.Text,parts:[e]},recipient:"all",metadata:{system_hints:hi(t),developer_mode_connector_ids:(c=r==null?void 0:r.message.metadata)==null?void 0:c.developer_mode_connector_ids,chatgpt_sdk_attribution:s.metadata.attribution_id,is_visually_hidden_from_conversation:!l}},eventSource:"mouse"}},Gn=s=>{"use forget";const e=$e.c(6),{onClose:t,onSubmit:o,clientX:i,clientY:l,placeholder:a}=s;let r;return e[0]!==i||e[1]!==l||e[2]!==t||e[3]!==o||e[4]!==a?(r=n.jsx("div",{className:"pointer-events-none fixed inset-0 z-[1000]",children:n.jsx($l,{clientX:i,clientY:l,placeholder:a,onSubmit:o,onBlur:t})}),e[0]=i,e[1]=l,e[2]=t,e[3]=o,e[4]=a,e[5]=r):r=e[5],r},$l=s=>{"use forget";const e=$e.c(43),{placeholder:t,clientX:o,clientY:i,onBlur:l,onSubmit:a}=s,r=Ft(),[c,m]=P.useState("");let f;e[0]!==c?(f=c.trim(),e[0]=c,e[1]=f):f=e[1];const h=!!f;let x;e[2]!==a||e[3]!==c?(x=O=>{const{metaKey:N,shiftKey:B,key:Z}=O;Z==="Enter"&&!O.nativeEvent.isComposing&&c.trim()&&!(B||N)?(a==null||a(O,c),O.preventDefault()):Z==="Escape"&&m("")},e[2]=a,e[3]=c,e[4]=x):x=e[4];const u=x,g=Tn(0),b=Tn(0);let p;e[5]!==i?(p=O=>i-8<=O?i+O+O:i-8,e[5]=i,e[6]=p):p=e[6];const d=An(g,p);let y;e[7]!==o?(y=O=>o+O>window.innerWidth?o-O:o,e[7]=o,e[8]=y):y=e[8];const j=An(b,y);let k;e[9]!==g||e[10]!==b?(k=mo({axis:"both",onChange:O=>{g.set(O.height),b.set(O.width)}}),e[9]=g,e[10]=b,e[11]=k):k=e[11];let w,E;e[12]===Symbol.for("react.memo_cache_sentinel")?(w={opacity:0,scale:.95},E={opacity:1,scale:1},e[12]=w,e[13]=E):(w=e[12],E=e[13]);let C;e[14]!==j||e[15]!==d?(C={top:d,left:j},e[14]=j,e[15]=d,e[16]=C):C=e[16];let I,v,D;e[17]===Symbol.for("react.memo_cache_sentinel")?(D={opacity:0,scale:.95},I={type:"spring",bounce:.1,duration:.1},v=rt("pointer-events-auto absolute z-[1000] -translate-y-full"),e[17]=I,e[18]=v,e[19]=D):(I=e[17],v=e[18],D=e[19]);let W;e[20]===Symbol.for("react.memo_cache_sentinel")?(W=O=>m(O.target.value),e[20]=W):W=e[20];let H;e[21]!==u||e[22]!==l||e[23]!==t?(H=n.jsx("div",{children:n.jsx("input",{autoFocus:!0,className:"border-none text-sm shadow-[none] outline-none focus:border-none focus:outline-none",placeholder:t,onBlur:l,onChange:W,onKeyDown:u})}),e[21]=u,e[22]=l,e[23]=t,e[24]=H):H=e[24];let _;e[25]===Symbol.for("react.memo_cache_sentinel")?(_=n.jsx(Xs.Separator,{}),e[25]=_):_=e[25];const $=!h;let S;e[26]!==r?(S=r.formatMessage({id:"iIqOqN",defaultMessage:"Submit"}),e[26]=r,e[27]=S):S=e[27];let R;e[28]!==a||e[29]!==c?(R=O=>a==null?void 0:a(O,c),e[28]=a,e[29]=c,e[30]=R):R=e[30];let X;e[31]===Symbol.for("react.memo_cache_sentinel")?(X=n.jsx(Ji,{className:"h-4 w-4 text-white dark:text-black"}),e[31]=X):X=e[31];let A;e[32]!==$||e[33]!==S||e[34]!==R?(A=n.jsx(Xs.Button,{disabled:$,"aria-label":S,className:"ms-2 me-1 flex h-6 w-6 items-center justify-center rounded-full bg-black dark:bg-white",onClick:R,children:X}),e[32]=$,e[33]=S,e[34]=R,e[35]=A):A=e[35];let V;e[36]!==H||e[37]!==A?(V=n.jsxs(Xs,{children:[H,_,A]}),e[36]=H,e[37]=A,e[38]=V):V=e[38];let Y;return e[39]!==V||e[40]!==k||e[41]!==C?(Y=n.jsx(en.div,{ref:k,initial:w,animate:E,style:C,exit:D,transition:I,className:v,children:V}),e[39]=V,e[40]=k,e[41]=C,e[42]=Y):Y=e[42],Y},Ml=({title:s,logoUrl:e})=>n.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light my-2 flex w-fit items-center gap-2 rounded-xl px-4 py-2 pe-6",children:[e?n.jsx("img",{className:"h-5 w-5 rounded-md",src:e,alt:s!=null?s:""}):n.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-md"}),n.jsx("div",{className:"text-token-text-primary text-base font-medium",children:s})]}),Tl=s=>{"use forget";const e=$e.c(6),{errorMessage:t,onClickRetry:o}=s;let i,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=n.jsx(bi,{className:"icon"}),l=n.jsx(ne,{id:"DTbTrQ",defaultMessage:"Error loading app"}),e[0]=i,e[1]=l):(i=e[0],l=e[1]);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a=n.jsx(ne,{id:"thEh3U",defaultMessage:"Retry"}),e[2]=a):a=e[2];let r;return e[3]!==t||e[4]!==o?(r=n.jsx(Xi,{type:"error",icon:i,title:l,content:t,primaryCtaText:a,primaryCtaColor:"secondary",onPrimaryCtaClick:o}),e[3]=t,e[4]=o,e[5]=r):r=e[5],r},Al=s=>{"use forget";var m;const e=$e.c(7),{clientThreadId:t,messages:o,isLastMessageInTurn:i,rememberForThisConversation:l,onRequestCompletion:a}=s;let r,c;if(e[0]!==t||e[1]!==i||e[2]!==o||e[3]!==a||e[4]!==l){c=Symbol.for("react.early_return_sentinel");e:{const{jitPluginData:f}=pn(o,i);if(!(f!=null&&f.from_server)||((m=f.from_server)==null?void 0:m.type)==="denied_by_user"){c=null;break e}const{from_server:h}=f,{body:x}=h,{domain:u,actions:g}=x;r=g.map((b,p)=>n.jsx(_o,{clientThreadId:t,messages:o,onRequestCompletion:a,action:b,domain:u,handleUserAction:Rt,rememberAnswer:l},p))}e[0]=t,e[1]=i,e[2]=o,e[3]=a,e[4]=l,e[5]=r,e[6]=c}else r=e[5],c=e[6];return c!==Symbol.for("react.early_return_sentinel")?c:r};function Il(s){"use forget";var I,v;const e=$e.c(40),{messages:t,isLastMessageInTurn:o,clientThreadId:i,onRequestCompletion:l}=s,[a,r]=P.useState(!1);let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=n.jsx(ne,{id:"WidgetOverlay.alwaysAsk",defaultMessage:"Always ask"}),e[0]=c):c=e[0];const m=c;let f;e[1]===Symbol.for("react.memo_cache_sentinel")?(f=n.jsx(ne,{id:"WidgetOverlay.allowThisConversation",defaultMessage:"Allow for this conversation"}),e[1]=f):f=e[1];const h=f,x=so(),u=an();let g;e[2]!==o||e[3]!==t?(g=pn(t,o),e[2]=o,e[3]=t,e[4]=g):g=e[4];const{uiState:b}=g;let p;e[5]!==o||e[6]!==t?(p=ho(t,o),e[5]=o,e[6]=t,e[7]=p):p=e[7];const d=p;let y,j,k,w;if(e[8]!==i||e[9]!==u||e[10]!==o||e[11]!==x.connectorLinks||e[12]!==t||e[13]!==d||e[14]!==l||e[15]!==a||e[16]!==b){const D=go(t,o),[W,H,_]=(I=D==null?void 0:D.path.split("/").filter(Boolean))!=null?I:[],$=[...x.connectorLinks.values()].flat().find(Y=>Y.id===H),S=$&&u.platformConnectors.get($.connector_id);y=b===L.UserConfirmation,j="bg-token-bg-primary text-token-text-primary shadow-long pointer-events-auto grid w-[min(90%,40rem)] max-w-[min(100%,600px)] gap-4 rounded-2xl p-4 sm:rounded-3xl";const R=n.jsx("div",{className:"text-token-text-primary ms-3 font-medium",children:n.jsx(ne,{id:"VHhzt6",defaultMessage:"{connectorName} wants to perform an action",values:{connectorName:W}})});let X;e[21]!==d||e[22]!==a?(X=d?n.jsx("div",{className:"-mt-0.5 flex justify-start text-sm",children:n.jsx(vi,{size:"small",triggerButton:n.jsxs("button",{className:"bg-token-bg-primary hover:bg-token-bg-tertiary text-token-text-primary inline-flex items-center gap-1 rounded-lg px-2 py-1 ps-3 transition-colors",children:[a?h:m,n.jsx(fn,{strokeWidth:1,className:"icon-sm opacity-30","aria-hidden":!0})]}),children:n.jsxs(Hs.RadioGroup,{value:a?"allow":"ask",onValueChange:Y=>r(Y==="allow"),children:[n.jsx(Hs.RadioItem,{value:"ask",children:m}),n.jsx(Hs.RadioItem,{value:"allow",children:h})]})})}):null,e[21]=d,e[22]=a,e[23]=X):X=e[23];let A;e[24]!==R||e[25]!==X?(A=n.jsxs("div",{className:"flex flex-1 flex-col",children:[R,X]}),e[24]=R,e[25]=X,e[26]=A):A=e[26];let V;e[27]!==i||e[28]!==o||e[29]!==t||e[30]!==l||e[31]!==a?(V=n.jsx("div",{className:"flex items-center justify-center gap-2",children:n.jsx(Al,{clientThreadId:i,messages:t,isLastMessageInTurn:o,rememberForThisConversation:a,onRequestCompletion:l})}),e[27]=i,e[28]=o,e[29]=t,e[30]=l,e[31]=a,e[32]=V):V=e[32],k=n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tn,{connector:{name:W,logo_url:(v=S==null?void 0:S.logo_url)!=null?v:null},size:"medium",className:"bg-primary shadow-xxs max-h-fit rounded-2xl border bg-clip-padding p-2"}),A,V]}),w=D!=null&&n.jsx(xs,{name:_,afterName:y&&n.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:n.jsx(ne,{id:"APIToolCallCard.write",defaultMessage:"Write"})}),params:typeof D.args=="object"?D.args:JSON.parse(D.args)}),e[8]=i,e[9]=u,e[10]=o,e[11]=x.connectorLinks,e[12]=t,e[13]=d,e[14]=l,e[15]=a,e[16]=b,e[17]=y,e[18]=j,e[19]=k,e[20]=w}else y=e[17],j=e[18],k=e[19],w=e[20];let E;e[33]!==y?(E=y&&n.jsxs("div",{className:"text-token-text-secondary text-xs",children:[n.jsx(oo,{className:"icon-sm me-2 mb-0.5 inline-block"}),n.jsx(ne,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:Rl}})]}),e[33]=y,e[34]=E):E=e[34];let C;return e[35]!==j||e[36]!==k||e[37]!==w||e[38]!==E?(C=n.jsxs("div",{className:j,children:[k,w,E]}),e[35]=j,e[36]=k,e[37]=w,e[38]=E,e[39]=C):C=e[39],C}function Rl(s){return n.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:s},"link")}const Ol=["midi","microphone","local-network-access"],Ll=s=>{"use forget";var hn,gn,xn,_n,yn;const e=$e.c(256),{chatSDK:t,clientThreadId:o,onRequestCompletion:i,isLastMessageInTurn:l}=s,a=ys();let r;e[0]!==a?(r=()=>uo(a),e[0]=a,e[1]=r):r=e[1];const c=ke(r);let m;e[2]!==a?(m=Ci(a),e[2]=a,e[3]=m):m=e[3];const{locale:f}=m;let h,x;e[4]!==o||e[5]!==a?(h=_s(a,o),x=mn(h),e[4]=o,e[5]=a,e[6]=h,e[7]=x):(h=e[6],x=e[7]);const u=x,g=Yi(),[b,p]=P.useState(null),d=Qi(t),{refetch:y,isLoading:j,isError:k,html:w,domain:E,subdomain:C,name:I,logoUrl:v,csp:D,prefersBorder:W,hideWidgetActions:H}=d,{widgetParent:_,widgetType:$,metadata:S}=t,[R,X]=P.useState(null),A=P.useRef(null),V=P.useRef(null),Y=ji.useStore();let O;e[8]!==t||e[9]!==o||e[10]!==i||e[11]!==Y?(O=z=>{const be=El(lt(he({},z),{chatSDK:t,persistedSystemHintsStore:Y,clientThreadId:o}));be!=null&&i(be)},e[8]=t,e[9]=o,e[10]=i,e[11]=Y,e[12]=O):O=e[12];const N=O;let B;e[13]!==u?(B=()=>u.title$(),e[13]=u,e[14]=B):B=e[14];const Z=ke(B);let ue;e[15]!==t||e[16]!==u?(ue=()=>u.isPinned$(t),e[15]=t,e[16]=u,e[17]=ue):ue=e[17];const re=ke(ue);let oe;e[18]!==t||e[19]!==u?(oe=()=>u.isPinOrigin$(t),e[18]=t,e[19]=u,e[20]=oe):oe=e[20];const fe=ke(oe);let ie;e[21]!==t||e[22]!==u?(ie=()=>u.isPinOrigin$(t)?u.displayMode$():"inline",e[21]=t,e[22]=u,e[23]=ie):ie=e[23];const G=ke(ie),F=G==="fullscreen",Pe=G==="pip";let He;e[24]!==u?(He=()=>u.maxWidgetHeight$(),e[24]=u,e[25]=He):He=e[25];const ee=ke(He);let pe;e[26]!==t.widgetId||e[27]!==u?(pe=()=>u.transitioningId$()===t.widgetId,e[26]=t.widgetId,e[27]=u,e[28]=pe):pe=e[28];const Fe=ke(pe);let Ce;e[29]!==t||e[30]!==u?(Ce=()=>u.getLatestChatSDK$(t),e[29]=t,e[30]=u,e[31]=Ce):Ce=e[31];const De=ke(Ce),ge=b!=null?b:t;let ye;e[32]!==ge||e[33]!==u?(ye=()=>u.getWidgetStateAndProps$(ge),e[32]=ge,e[33]=u,e[34]=ye):ye=e[34];const{toolInput:Me,toolOutput:We,widgetState:Ge,toolResponseMetadata:Re}=ke(ye),Be=(gn=(hn=ge.metadata)==null?void 0:hn.subject_id)!=null?gn:null,Te=De.messages,se=ge.widgetId,ce=(xn=S==null?void 0:S.attribution_id)!=null?xn:_,ae=t.distributionChannel,[_e,tt]=P.useState(0),[Je,dt]=P.useState(!1),[me,Oe]=P.useState(!1),[Ue,st]=P.useState(!1),[ze,nt]=P.useState(!1),de=ro(),je=t.distributionChannel===As.OPENAI&&H;let Xe;e[35]!==se||e[36]!==t||e[37]!==G||e[38]!==R||e[39]!==fe||e[40]!==u||e[41]!==Y||e[42]!==W?(Xe=(z,be)=>{if(z===G)return{mode:z};z==="fullscreen"&&(Ni.setSidebarOpen(!1),Y.setActiveSystemHint(null)),fe?u.transitioningId$.set(se):u.transitioningId$.set(t.widgetId),z!=="inline"&&u.subscribeToNewMessages$(t,p);const Et=()=>{var $t,Mt;($t=V.current)==null||$t.focus(),z==="inline"?(Mt=A.current)==null||Mt.navigate({popToRoot:!0}):u.setPinnedWidgetHeight(R!=null?R:0),p(null),u.setDisplayMode$(t,z,be)};return W?(ea({forceFlushSync:!0,className:z==="inline"?[ps["pinned-widget"],ps["becoming-inline"]]:G==="inline"?[ps["pinned-widget"],ps["becoming-pinned"]]:ps["pinned-widget"],update:Et}).finished.then(()=>{u.transitioningId$.set(null)}),{mode:z}):(Et(),u.transitioningId$.set(null),{mode:z})},e[35]=se,e[36]=t,e[37]=G,e[38]=R,e[39]=fe,e[40]=u,e[41]=Y,e[42]=W,e[43]=Xe):Xe=e[43];const te=Lt(Xe);let gt,xt;e[44]!==re||e[45]!==te?(gt=()=>{if(re)return Si(window,{keydown:z=>{z.key==="Escape"&&te("inline")}})},xt=[re,te],e[44]=re,e[45]=te,e[46]=gt,e[47]=xt):(gt=e[46],xt=e[47]),P.useEffect(gt,xt);let _t;e[48]!==y||e[49]!==_e?(_t=()=>{y(),dt(!1),Oe(!1),tt(_e+1)},e[48]=y,e[49]=_e,e[50]=_t):_t=e[50];const Dt=_t;let yt;e[51]!==te?(yt=()=>{dt(!0),te("inline")},e[51]=te,e[52]=yt):yt=e[52];const Wt=yt;let bt;e[53]!==o||e[54]!==a?(bt=Zi(_s(a,o)),e[53]=o,e[54]=a,e[55]=bt):bt=e[55];const{height$:Bt,marginBottom$:Ut}=bt;let vt;e[56]!==Bt||e[57]!==fe||e[58]!==F||e[59]!==Ut?(vt=()=>{var z,be;return F&&fe?16+((z=Bt())!=null?z:0)+((be=Ut())!=null?be:0):0},e[56]=Bt,e[57]=fe,e[58]=F,e[59]=Ut,e[60]=vt):vt=e[60];const zt=ke(vt);let kt;e[61]!==F?(kt=()=>F&&dn()?nn+To:0,e[61]=F,e[62]=kt):kt=e[62];const qt=ke(kt);let wt;e[63]!==qt||e[64]!==zt?(wt={insets:{top:qt,bottom:zt,left:0,right:0}},e[63]=qt,e[64]=zt,e[65]=wt):wt=e[65];const Vt=wt;let ot;e[66]!==t.distributionChannel||e[67]!==c?(ot=[],c&&ot.push(...Ol),t.distributionChannel===As.OPENAI&&ot.push("clipboard-read","clipboard-write"),e[66]=t.distributionChannel,e[67]=c,e[68]=ot):ot=e[68];const qe=ot;if(g){let z;return e[69]!==v||e[70]!==I?(z=n.jsx(Ml,{title:I,logoUrl:v}),e[69]=v,e[70]=I,e[71]=z):z=e[71],z}else if(re&&!fe&&!Fe)return null;const Ct=F?void 0:R?"".concat(Math.min(R,ee!=null?ee:1/0),"px"):"auto",jt=(_n=t.metadata.height_hint)!=null?_n:400;let Nt;e[72]!==o||e[73]!==fe||e[74]!==l||e[75]!==Te||e[76]!==i?(Nt=xo(Te,l||fe)&&n.jsx(Il,{messages:Te,isLastMessageInTurn:l||fe,clientThreadId:o,onRequestCompletion:i}),e[72]=o,e[73]=fe,e[74]=l,e[75]=Te,e[76]=i,e[77]=Nt):Nt=e[77];const Ye=Nt,St=j||!me||R==null;let M;e[78]!==E?(M=rl(E),e[78]=E,e[79]=M):M=e[79];const U=M;let Q;e[80]!==o?(Q=un(o),e[80]=o,e[81]=Q):Q=e[81];const T=Q,Le=Fe&&W&&"[view-transition-name:pinned-kanzi-widget]",Qe=!fe&&"relative mb-2";let Ne;e[82]!==G||e[83]!==Ct||e[84]!==jt||e[85]!==F||e[86]!==Pe||e[87]!==re||e[88]!==W||e[89]!==Le||e[90]!==Qe?(Ne=rt("no-scrollbar",Le,Qe,G==="inline"&&rt("thread-sm:w-full",!re&&"mx-0 max-sm:-mx-(--thread-content-margin) max-sm:w-[100cqw] max-sm:overflow-hidden",W&&!re&&!F&&"max-sm:overflow-visible max-sm:px-4"),Pe&&"thread-xl:top-4 fixed start-4 end-4 top-4 z-50 mx-auto max-w-(--thread-content-max-width) sm:start-0 sm:end-0 sm:top-(--header-height) sm:w-full",F?"fixed start-0 end-0 top-0 bottom-0 z-50 mx-auto flex w-auto flex-col overflow-hidden":"overflow-visible",!Ct&&!jt&&!F&&"opacity-0"),e[82]=G,e[83]=Ct,e[84]=jt,e[85]=F,e[86]=Pe,e[87]=re,e[88]=W,e[89]=Le,e[90]=Qe,e[91]=Ne):Ne=e[91];let Ve;e[92]!==ee?(Ve={maxHeight:ee},e[92]=ee,e[93]=Ve):Ve=e[93];let it;e[94]!==F||e[95]!==re||e[96]!==te?(it=re&&!F&&n.jsx("button",{className:"absolute -start-2 -top-1.5 z-10 rounded-full bg-[#3a3a3a] p-1.25 text-white shadow-[0px_0px_0px_1px_var(--border-heavy),0px_4px_12px_rgba(0,0,0,0.12)] hover:bg-[#6a6a6a] md:-start-6",onClick:()=>te("inline"),children:n.jsx(cn,{className:"h-4.5 w-4.5"})}),e[94]=F,e[95]=re,e[96]=te,e[97]=it):it=e[97];let at;e[98]!==Ue||e[99]!==ze||e[100]!==Z||e[101]!==F||e[102]!==v||e[103]!==I||e[104]!==te||e[105]!==U?(at=F&&n.jsx(ol,{logo:v,onClickBack:()=>{var z;return(z=A.current)==null?void 0:z.navigate({delta:-1})},onClickClose:()=>te("inline"),onClickForward:()=>{var z;return(z=A.current)==null?void 0:z.navigate({delta:1})},canGoBack:Ue,canGoForward:ze,title:(yn=Z!=null?Z:I)!=null?yn:"",widgetDisplayName:I!=null?I:"",widgetDomain:U!=null?U:null,onClickOpenInApp:()=>{var z;(z=A.current)==null||z.getCurrentPath().then(be=>{be==null||!U||window.open(new URL(be.replace(/^\/+/,""),U),"_blank")})}}),e[98]=Ue,e[99]=ze,e[100]=Z,e[101]=F,e[102]=v,e[103]=I,e[104]=te,e[105]=U,e[106]=at):at=e[106];const Kt=F?"flex-1":"h-full",Ht=!re&&W&&"border-token-border-light shadow-short rounded-2xl sm:rounded-3xl dark:shadow-[0px_0px_0px_1px_#414141,0px_4px_14px_rgba(0,0,0,0.24)]",Gt=!F&&(W||Pe)&&"rounded-2xl sm:rounded-3xl",ms=Pe&&"shadow-[0px_0px_0px_1px_var(--border-heavy),0px_6px_20px_rgba(0,0,0,0.1)] md:-mx-4";let Jt;e[107]!==Kt||e[108]!==Ht||e[109]!==Gt||e[110]!==ms?(Jt=rt("relative overflow-hidden",Kt,Ht,Gt,ms),e[107]=Kt,e[108]=Ht,e[109]=Gt,e[110]=ms,e[111]=Jt):Jt=e[111];const Ps=St?jt:Ct;let Xt;e[112]!==Ps?(Xt={height:Ps},e[112]=Ps,e[113]=Xt):Xt=e[113];let Yt;e[114]!==St?(Yt=St&&n.jsx(en.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"loading-results-shimmer absolute inset-0 sm:rounded-3xl"},"loading-results-shimmer"),e[114]=St,e[115]=Yt):Yt=e[115];let Qt;e[116]!==Yt?(Qt=n.jsx(Ei,{initial:!1,children:Yt}),e[116]=Yt,e[117]=Qt):Qt=e[117];let Zt;e[118]!==ge||e[119]!==_e||e[120]!==d?(Zt=_e||Sl(ge,d),e[118]=ge,e[119]=_e,e[120]=d,e[121]=Zt):Zt=e[121];const Fs=de!=null?de:"light",Ds=G!=null?G:"inline";let bs;e[122]===Symbol.for("react.memo_cache_sentinel")?(bs=()=>Oe(!0),e[122]=bs):bs=e[122];let es;if(e[123]!==se||e[124]!==ce||e[125]!==t||e[126]!==o||e[127]!==h||e[128]!==D||e[129]!==a||e[130]!==ae||e[131]!==E||e[132]!==qe||e[133]!==w||e[134]!==u||e[135]!==f||e[136]!==S.suggestion_message_id||e[137]!==d||e[138]!==N||e[139]!==te||e[140]!==C||e[141]!==_||e[142]!==$){let z;e[144]!==a?(z=le=>{const{clientX:ve,clientY:Ae,placeholder:fs}=le;return new Promise((Bo,Uo)=>{var bn,vn,kn;const cs=(bn=V.current)==null?void 0:bn.getBoundingClientRect();Pt(a,Gn,{placeholder:fs,clientX:ve+((vn=cs==null?void 0:cs.left)!=null?vn:0),clientY:Ae+((kn=cs==null?void 0:cs.top)!=null?kn:0),onSubmit:(lr,zo)=>{Bo({prompt:zo}),In(a,Gn)},onClose:Uo})})},e[144]=a,e[145]=z):z=e[145];let be;e[146]!==se||e[147]!==ce||e[148]!==t||e[149]!==o||e[150]!==h||e[151]!==D||e[152]!==a||e[153]!==E||e[154]!==qe||e[155]!==w||e[156]!==f||e[157]!==S.suggestion_message_id||e[158]!==d||e[159]!==N||e[160]!==C||e[161]!==_||e[162]!==$?(be=le=>{const{title:ve,params:Ae,heightHint:fs}=le;Pt(a,Qs,{resolvedWidget:d,conversation:h,sendFollowUpMessage:N,chatSDK:t,features:qe,clientThreadId:o,title:ve,params:Ae,html:w,attributionId:ce,widgetId:se,widgetParent:_,suggestionMessageId:S==null?void 0:S.suggestion_message_id,widgetType:$,subdomain:C,domain:E,csp:D,locale:f,heightHint:fs})},e[146]=se,e[147]=ce,e[148]=t,e[149]=o,e[150]=h,e[151]=D,e[152]=a,e[153]=E,e[154]=qe,e[155]=w,e[156]=f,e[157]=S.suggestion_message_id,e[158]=d,e[159]=N,e[160]=C,e[161]=_,e[162]=$,e[163]=be):be=e[163];let Et;e[164]!==se||e[165]!==a||e[166]!==u?(Et=()=>{if($i(a,Qs))return In(a,Qs);u.closeWidget$(se,"request_close")},e[164]=se,e[165]=a,e[166]=u,e[167]=Et):Et=e[167];let $t;e[168]!==t||e[169]!==o||e[170]!==a||e[171]!==d?($t=le=>Mo({ctx:a,chatSDK:t,clientThreadId:o,checkoutSession:le,resolvedWidget:d}),e[168]=t,e[169]=o,e[170]=a,e[171]=d,e[172]=$t):$t=e[172];let Mt;e[173]!==te?(Mt=()=>te("inline"),e[173]=te,e[174]=Mt):Mt=e[174];let ws;e[175]===Symbol.for("react.memo_cache_sentinel")?(ws=le=>{const{canGoBack:ve,canGoForward:Ae}=le;st(ve),nt(Ae)},e[175]=ws):ws=e[175];let Cs;e[176]!==u?(Cs=(le,ve)=>u.setWidgetState$(le,ve),e[176]=u,e[177]=Cs):Cs=e[177];let js;e[178]!==te?(js=le=>{const{mode:ve,title:Ae}=le;return te(ve,Ae)},e[178]=te,e[179]=js):js=e[179];let Ns,Ss,Es;e[180]!==u||e[181]!==_?(Ns=(le,ve)=>u.callTool$(_,le,ve),Ss=le=>u.uploadFile$(_,le),Es=le=>u.downloadFile$(_,le.fileId),e[180]=u,e[181]=_,e[182]=Ns,e[183]=Ss,e[184]=Es):(Ns=e[182],Ss=e[183],Es=e[184]);let $s;e[185]!==a?($s=le=>{const{connectorId:ve}=le;return new Promise(Ae=>{const fs=window.location.href;Pt(a,ha,{connectorId:ve,redirectAfter:fs,onComplete:()=>{Ae({didConnect:!0})},onClose:()=>{Ae({didConnect:!1})}})})},e[185]=a,e[186]=$s):$s=e[186],es={openExternal(le){var Ae;const{href:ve}=le;Lo({ctx:a,href:ve,resolvedPineappleUri:(Ae=t.metadata.resolved_pineapple_uri)!=null?Ae:null,csp:D,domain:E,distributionChannel:ae})},openPromptInput:z,requestModal:be,requestClose:Et,requestCheckout:$t,notifyEscapeKey:Mt,notifyNavigation:ws,notifyIntrinsicHeight:X,sendFollowUpMessage:N,updateWidgetState:Cs,requestDisplayMode:js,callTool:Ns,uploadFile:Ss,downloadFile:Es,requestLinkToConnector:$s},e[123]=se,e[124]=ce,e[125]=t,e[126]=o,e[127]=h,e[128]=D,e[129]=a,e[130]=ae,e[131]=E,e[132]=qe,e[133]=w,e[134]=u,e[135]=f,e[136]=S.suggestion_message_id,e[137]=d,e[138]=N,e[139]=te,e[140]=C,e[141]=_,e[142]=$,e[143]=es}else es=e[143];let ts;e[187]!==se||e[188]!==ce||e[189]!==T||e[190]!==D||e[191]!==ae||e[192]!==qe||e[193]!==Wt||e[194]!==w||e[195]!==f||e[196]!==ee||e[197]!==S.suggestion_message_id||e[198]!==Vt||e[199]!==C||e[200]!==Be||e[201]!==Zt||e[202]!==Fs||e[203]!==Ds||e[204]!==es||e[205]!==Me||e[206]!==We||e[207]!==Re||e[208]!==_||e[209]!==Ge||e[210]!==$?(ts=n.jsx(Fo,{iframeRef:V,ref:A,host:"chatgpt",title:$,locale:f,html:w,csp:D,features:qe,subdomain:C,attributionId:ce,conversationId:T,widgetId:se,suggestionMessageId:S.suggestion_message_id,widgetType:$,widgetParent:_,widgetState:Ge,widgetDistributionChannel:ae,toolInput:Me,toolOutput:We,toolResponseMetadata:Re,subjectId:Be,maxHeight:ee,theme:Fs,displayMode:Ds,safeArea:Vt,onReady:bs,onError:Wt,api:es},Zt),e[187]=se,e[188]=ce,e[189]=T,e[190]=D,e[191]=ae,e[192]=qe,e[193]=Wt,e[194]=w,e[195]=f,e[196]=ee,e[197]=S.suggestion_message_id,e[198]=Vt,e[199]=C,e[200]=Be,e[201]=Zt,e[202]=Fs,e[203]=Ds,e[204]=es,e[205]=Me,e[206]=We,e[207]=Re,e[208]=_,e[209]=Ge,e[210]=$,e[211]=ts):ts=e[211];let ss;e[212]!==Ye?(ss=!!Ye&&n.jsx("div",{className:"bg-token-bg-secondary/50 pointer-events-auto absolute inset-0 z-0 flex items-center justify-center rounded-none sm:rounded-3xl"}),e[212]=Ye,e[213]=ss):ss=e[213];let ns;e[214]!==Jt||e[215]!==Xt||e[216]!==Qt||e[217]!==ts||e[218]!==ss?(ns=n.jsxs("div",{className:Jt,style:Xt,children:[Qt,ts,ss]}),e[214]=Jt,e[215]=Xt,e[216]=Qt,e[217]=ts,e[218]=ss,e[219]=ns):ns=e[219];let os;e[220]!==Ye||e[221]!==F||e[222]!==me?(os=me&&Ye&&n.jsx(en.div,{className:rt("pointer-events-none absolute inset-0 z-10 flex justify-center",F?"top-(--header-height) items-center":"items-start pt-10"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:.1,duration:.24},children:Ye}),e[220]=Ye,e[221]=F,e[222]=me,e[223]=os):os=e[223];let vs;e[224]!==Ne||e[225]!==Ve||e[226]!==it||e[227]!==at||e[228]!==ns||e[229]!==os?(vs=n.jsxs("div",{className:Ne,style:Ve,children:[it,at,ns,os]}),e[224]=Ne,e[225]=Ve,e[226]=it,e[227]=at,e[228]=ns,e[229]=os,e[230]=vs):vs=e[230];const Ws=vs,Bs=k||Je,Us=!re&&!k&&t.distributionChannel!==As.OPENAI;let is;e[231]!==F?(is=F&&n.jsx("div",{className:"bg-token-bg-primary fixed start-0 end-0 top-0 bottom-0 z-10"}),e[231]=F,e[232]=is):is=e[232];let as;e[233]!==t||e[234]!==T||e[235]!==j||e[236]!==v||e[237]!==I||e[238]!==Us||e[239]!==U?(as=Us&&n.jsx("div",{className:"mt-2 sm:mt-4",children:n.jsx(sl,{withMarginBottom:!0,onClick:U?()=>window.open(U,"_blank","noopener,noreferrer"):void 0,isLoading:j,logoUrl:v,name:I,conversationId:T,chatSDK:t})}),e[233]=t,e[234]=T,e[235]=j,e[236]=v,e[237]=I,e[238]=Us,e[239]=U,e[240]=as):as=e[240];let ls;e[241]!==Dt||e[242]!==Bs||e[243]!==k||e[244]!==Je||e[245]!==Ws?(ls=Bs?n.jsx("div",{className:rt(k&&"mt-2"),children:n.jsx(Tl,{onClickRetry:Dt,errorMessage:k?"Failed to fetch template":Je?"Runtime error":void 0})}):Ws,e[241]=Dt,e[242]=Bs,e[243]=k,e[244]=Je,e[245]=Ws,e[246]=ls):ls=e[246];let rs;e[247]!==je||e[248]!==F||e[249]!==W?(rs=!F&&!W&&!je&&n.jsx("div",{className:"bg-token-border-default my-3 h-px w-full"}),e[247]=je,e[248]=F,e[249]=W,e[250]=rs):rs=e[250];let ks;return e[251]!==is||e[252]!==as||e[253]!==ls||e[254]!==rs?(ks=n.jsxs(n.Fragment,{children:[is,as,ls,rs]}),e[251]=is,e[252]=as,e[253]=ls,e[254]=rs,e[255]=ks):ks=e[255],ks},Pl=s=>{"use forget";const e=$e.c(18),{messages:t,clientThreadId:o,onRequestCompletion:i,isLastMessageInTurn:l}=s;let a;e[0]!==t?(a=Dn(t),e[0]=t,e[1]=a):a=e[1];const r=a,c=ys();let m,f;e[2]!==o||e[3]!==c?(m=_s(c,o),f=mn(m),e[2]=o,e[3]=c,e[4]=m,e[5]=f):(m=e[4],f=e[5]);const h=f;let x;e[6]!==r.widgetId||e[7]!==h?(x=()=>h.closedWidgetIds$().has(r.widgetId),e[6]=r.widgetId,e[7]=h,e[8]=x):x=e[8];const u=ke(x);let g;e[9]!==r||e[10]!==m||e[11]!==h?(g=()=>{if(!r.sessionId||h.isPinned$(r))return!0;const d=wi(m);for(let y=d.length-1;y>=0;y--){const{messages:j}=d[y];let k;try{k=Dn(j)}catch(C){continue}if(k==null)continue;const{sessionId:w,invocationUuid:E}=k;if(w&&w===r.sessionId)return E===r.invocationUuid}return!0},e[9]=r,e[10]=m,e[11]=h,e[12]=g):g=e[12];const b=ke(g);if(r.metadata.is_widget_closed||u||r.isError||!b)return null;let p;return e[13]!==r||e[14]!==o||e[15]!==l||e[16]!==i?(p=n.jsx(Ll,{clientThreadId:o,onRequestCompletion:i,isLastMessageInTurn:l,chatSDK:r}),e[13]=r,e[14]=o,e[15]=l,e[16]=i,e[17]=p):p=e[17],p},Fl=s=>{"use forget";const e=$e.c(5),{messages:t,clientThreadId:o,onRequestCompletion:i,isLastMessageInTurn:l}=s,a=ys();if(co(a,"1037317296"))return null;let r;return e[0]!==o||e[1]!==l||e[2]!==t||e[3]!==i?(r=n.jsx(ki,{name:"ChatSDKContent",children:n.jsx(Pl,{messages:t,clientThreadId:o,onRequestCompletion:i,isLastMessageInTurn:l})}),e[0]=o,e[1]=l,e[2]=t,e[3]=i,e[4]=r):r=e[4],r};function Dl({messageMetadata:s}){const[e,t]=P.useState(!1);return n.jsxs("div",{className:"my-2 flex flex-col text-sm",children:[n.jsxs("div",{className:"flex flex-row items-center hover:cursor-pointer",onClick:()=>{t(!e)},children:[e?n.jsx(fn,{className:"icon-sm"}):n.jsx(Mi,{className:"icon-sm"}),n.jsx("div",{className:"font-semibold",children:s.display_message})]}),e&&n.jsx("pre",{children:JSON.stringify(s.data,null,2)})]})}function Wl({debugMessages:s}){return s.length===0?null:n.jsx("div",{children:s.map((e,t)=>{var i,l;const o=(l=(i=e.metadata)==null?void 0:i.jit_plugin_data)==null?void 0:l.from_server;return o&&o.type==="debug"?n.jsx(Dl,{messageMetadata:o.body},t):null})})}const Do="openaiFileIdRefs",Bl=["send_email","batch_modify_email","create_event","update_event","delete_event"];function Ul({name:s,params:e,result:t,privacyPolicyUrl:o,isPromptingForPermission:i}){var r;const a=((r=e==null?void 0:e[Do])!=null?r:[]).map((c,m)=>{const f=c.name.startsWith("dalle-");let h=c.name;return f&&(h="".concat(h,".webp")),n.jsx(fo,{file:h,fileId:c.id},m)});return n.jsxs("div",{className:"divide-token-border-default border-token-border-default mt-1 mb-4 divide-y overflow-hidden rounded-xl border",children:[s&&n.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary px-4 py-2 text-sm",children:n.jsx(ne,{id:"JITPluginMessage.params.toolCall",defaultMessage:"Tool call: {name}",values:{name:n.jsx("span",{className:"text-token-text-primary",children:s})}})}),e&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:[i?n.jsx(ne,{id:"JITPluginMessage.params.sharing.present",defaultMessage:"The following will be shared:"}):n.jsx(ne,{id:"JITPluginMessage.params.sharing.past",defaultMessage:"The following was shared:"}),o&&n.jsx("a",{href:Ti(o),className:"text-token-text-primary",target:"_blank",rel:"noreferrer",children:n.jsx(ne,he({},Ze.privacyPolicyLink))})]}),n.jsx("div",{className:"px-4 py-2",children:n.jsx(sn,{value:e})}),a.length>0&&n.jsx("div",{className:"px-4 py-2",children:a})]}),t&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:n.jsx(ne,{id:"JITPluginMessage.params.result",defaultMessage:"Result:"})}),n.jsx("div",{className:"px-4 py-2",children:n.jsx(sn,{value:t})})]})]})}var Zn;const zl=us.div(Zn||(Zn=Tt(["h-px bg-token-border-default"])));var eo;const Jn=us.div(eo||(eo=Tt(["text-sm font-medium py-3 leading-6"])));var to;const ql=us.div(to||(to=Tt(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),Vl=":",Kl=({functionName:s,parameters:e,onClick:t,isDraft:o=!0,isCanceled:i=!1})=>{const l=Ft(),a=Object.entries(e).filter(([r,c])=>!c||r==="timezone_str"&&c===Intl.DateTimeFormat().resolvedOptions().timeZone?!1:c.length>0);return n.jsxs(ql,{children:[n.jsx("div",{className:"mb-4 flex items-center font-semibold",children:n.jsx("div",{children:o?on(s):Hl(s,l)})}),a.map(([r,c])=>n.jsxs("div",{children:[n.jsx(zl,{}),n.jsxs("div",{className:"flex",children:[n.jsxs(Jn,{className:"text-token-text-tertiary me-1",children:[on(r),Vl]}),n.jsx(Jn,{className:"whitespace-pre-line",children:Wo(c,l)})]})]},r)),o&&!i&&n.jsx("div",{className:"mt-2 flex justify-end gap-4",children:n.jsx(pt,{color:"primary",className:"py-2",onClick:t,children:l.formatMessage(Rs.approveButton)})}),i&&n.jsx("div",{className:"mt-2 flex justify-end gap-4",children:n.jsx(pt,{color:"primary",className:"py-2",disabled:!0,children:l.formatMessage(Rs.canceledButton)})})]})},Hl=(s,e)=>{switch(s){case"create_event":return"Created Event ✅";default:return"".concat(on(s)," ").concat(e.formatMessage(Rs.completedAction)," ✅")}},on=s=>{switch(s){case"timezone_str":return"Timezone";default:return s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}},Wo=(s,e)=>{if(Array.isArray(s))return s.map(i=>Wo(i,e)).join(e.formatMessage(Rs.valueSeparator));if(typeof s=="object")return JSON.stringify(s);if(s.match(/^\s*\d{4}-\d{2}-\d{2}/)==null)return s;const o=new Date(s);return Number.isNaN(o.getTime())?s:e.formatDate(o,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},Rs=Os({approveButton:{id:"ParametersView.approveButton",defaultMessage:"Approve"},completedAction:{id:"ParametersView.completedAction",defaultMessage:"Completed"},canceledButton:{id:"ParametersView.canceledButton",defaultMessage:"Canceled"},valueSeparator:{id:"ParametersView.valueSeparator",defaultMessage:","}}),Gl="list_resources",Jl="read_resource",Xl="search_tools",Yl="call_tool",Ql="api_tool.list_resources",Zl="api_tool.search_tools",er="api_tool",tr=new Set([Ql,Zl,er]),sr=s=>tr.has(s);function nr(s,e,t,o,i,l=null){const a=or(e,o,i,l);return a?typeof a=="string"?a:s.formatMessage(a,t):null}function or(s,e,t,o=null){if(![L.Finished,L.Running,L.Stopped].includes(t)||!e)return s;if(e.endsWith(Gl)){const i=o==null?void 0:o[t];return i!=null?i:t===L.Finished||t===L.Stopped?ut({id:"OdEouq",defaultMessage:"Looked for available tools"}):ut({id:"hSyoq0",defaultMessage:"Looking for available tools"})}else if(e.endsWith(Xl)){const i=o==null?void 0:o[t];return i!=null?i:t===L.Finished||t===L.Stopped?ut({id:"4et5qC",defaultMessage:"Searched tools"}):ut({id:"V0IDh0",defaultMessage:"Searching tools"})}else if(e.endsWith(Yl)){const i=o==null?void 0:o[t];return i!=null?i:t===L.Finished||t===L.Stopped?ut({id:"NTASw4",defaultMessage:"Called tool"}):ut({id:"gc64KQ",defaultMessage:"Calling tool"})}else if(e.endsWith(Jl)){const i=o==null?void 0:o[t];return i!=null?i:t===L.Finished||t===L.Stopped?ut({id:"f8Ld/y",defaultMessage:"Read resource"}):ut({id:"1dbn0w",defaultMessage:"Reading resource"})}return s}const ir=(s,e)=>{const t=s.recipient==="api_tool.call_tool",o=["mcp://komi","mcp://kakao"],i=Fn(s).toLowerCase(),l=t&&o.some(r=>i.includes(r));let a=!1;if(l&&e){const r=Fn(e);if(r){let c;try{c=JSON.parse(r)}catch(m){}a=typeof c=="object"&&c!==null&&"widget"in c}}return{calledKakoMCP:l,displayedWidget:a}};function ar({messages:s,nextMessage:e,clientThreadId:t,isLastMessageInTurn:o,isLastTurnInConversation:i,connectorFixture:l,onRequestCompletion:a}){var _e,tt,Je,dt,me,Oe,Ue,st,ze,nt,de,je,Xe,te,gt,xt,_t,Dt,yt,Wt,bt,Bt,Ut,vt,zt,kt,qt,wt,Vt,ot,qe,Ct,jt,Nt,Ye,St;const r=ys(),[c,m]=Xo(),{assistantMessage:f,toolMessages:h,debugMessages:x}=po(s),u=(_e=f.recipient)!=null?_e:"",g=Ai(t),{addSource:b}=ta(t),{uiState:p,jitPluginData:d,fileAttachments:y,invokedPlugin:j,lastConfirmActionJitPluginData:k}=pn(s,o),w=Ft(),E=Ii(),[C,I,v]=Ri(t,M=>{var Q,T,Le;const U=(T=(Q=f.metadata)==null?void 0:Q.gizmo_id)!=null?T:M?Zs.getGizmoId(M):E;return[U,aa(M==null?void 0:M.mode,U),(Le=M==null?void 0:M.conversationOrigin)!=null?Le:null]}),D=h.length>0?h[h.length-1]:void 0,W=ir(f,D),H=sa(I)&&I.gizmo_id===C,_=(tt=Oi(C,H))==null?void 0:tt.data,[$,S]=P.useState(!1),[R,X]=P.useState(!1),A=Rn(f.recipient);let V;if((A==null?void 0:A.functionName)!=null&&(_==null?void 0:_.tools)!=null){for(const M of _.tools)if(ca(M,A.functionName)){V=M;break}}const Y=(Je=Rn(e==null?void 0:e.recipient))==null?void 0:Je.namespace,{connectorId:O,connectorToolStatus:N,connectorStatusMessage:B,showConnectorConnect:Z}=da(A==null?void 0:A.namespace,Y,h,i),ue=ke(()=>uo(r)),re=an(!0,Li.JIT_PLUGIN),oe=l!=null?l:re.platformConnectors.get(O!=null?O:""),fe=Pi();let ie=((dt=d==null?void 0:d.from_server)==null?void 0:dt.type)!=="denied_by_user"?(me=d==null?void 0:d.from_server)==null?void 0:me.body.domain:(Oe=V==null?void 0:V.metadata)==null?void 0:Oe.domain,G=null,F=null;if(!ie&&(A!=null&&A.functionName)&&A.namespace==="kanzi_app"){const[M,U]=A.functionName.split("/");ie=M.replace(/_/g," "),G=n.jsx(Ui,{openNewTab:!0,className:"text-token-text-secondary pt-1 opacity-0 transition-opacity duration-200 group-hover/tool-message:opacity-100",href:"/kanzi/studio/c/".concat(U),children:n.jsx(ia,{})})}ue&&u==="api_tool.call_tool"&&(F=n.jsx("button",{onClick:()=>ra(_s(r,t)).focusMessage$(f.id),className:"text-token-text-secondary",children:n.jsx(la,{})})),ie?ie.endsWith("__jit_plugin")&&(ie=ie.slice(0,-12)):ie="connector";const Pe=(Ue=V==null?void 0:V.metadata)==null?void 0:Ue.privacy_policy_url;P.useEffect(()=>{var U,Q;if(((U=ua(d==null?void 0:d.from_client))==null?void 0:U.type)==="oauth_success")return;const M=c.get("oauth_success");if(((Q=d==null?void 0:d.from_server)==null?void 0:Q.type)==="oauth_required"&&M){m(T=>(T.delete("oauth_success"),T),{replace:!0});for(const T of d.from_server.body.actions)if(T.type==="oauth_redirect"){Rt({eventSource:"url",assistantMessage:f,onRequestCompletion:a,actionData:{type:"oauth_success",target_message_id:T.oauth_redirect.target_message_id},clientThreadId:t});return}}},[I,f,s,t,a,d,i,c,m,b]),P.useEffect(()=>{var Q;const M=c.get("link_success"),U=c.get("oauth_success");if((M||U)&&((Q=d==null?void 0:d.from_server)==null?void 0:Q.type)==="link_required"){m(T=>(T.delete("link_success"),T.delete("oauth_success"),T),{replace:!0});for(const T of d.from_server.body.actions)if(T.type==="link_created"){Rt({eventSource:"url",assistantMessage:f,onRequestCompletion:a,actionData:{type:"link_success",target_message_id:T.link_created.target_message_id},clientThreadId:t});return}}},[c,m,f,t,a,d]);const He=r&&co(r,"2792858552");let ee=At.Running,pe=ie?Ze.running:Ze.starting,Fe={domain:ie};if(p===L.Hidden)return null;if(p===L.OauthLogin||p===L.UserConfirmation||p===L.NoAuthLink){ee=At.Paused,pe=Ze.confirmingSimple;const M={gizmoName:(st=_==null?void 0:_.gizmo.display.name)!=null?st:"ChatGPT",domain:ie};Fe=lt(he({},M),{title:U=>n.jsxs("div",{className:"inline-flex items-center gap-1 text-sm",children:[U,n.jsx(fn,{className:"icon-sm"})]}),subtitle:U=>n.jsx("div",{className:"text-xs",children:U})})}else p===L.Finished?(ee=At.Finished,pe=Ze.finished,Fe={domain:ie}):p===L.Error?(ee=At.Error,pe=Ze.error):p===L.Stopped||p===L.Denied?(ee=At.Stopped,pe=p===L.Denied?Ze.declined:Ze.stopped):p===L.Allowed&&(ee=At.Stopped,pe=Ze.allowed);const Ce=((ze=d==null?void 0:d.from_server)==null?void 0:ze.type)!=="denied_by_user"?(nt=d==null?void 0:d.from_server)==null?void 0:nt.body.actions.map((M,U)=>n.jsx(_o,{clientThreadId:t,messages:s,onRequestCompletion:a,action:M,domain:ie,handleUserAction:Rt,rememberAnswer:$},U)):null;let De=null;((de=f.metadata)!=null&&de.tool_invoking_message||(je=f.metadata)!=null&&je.tool_invoked_message||(te=(Xe=f.metadata)==null?void 0:Xe.chatgpt_sdk)!=null&&te.tool_invoking_message||(xt=(gt=f.metadata)==null?void 0:gt.chatgpt_sdk)!=null&&xt.tool_invoked_message)&&(De={[L.Running]:(bt=(Wt=(Dt=(_t=f.metadata)==null?void 0:_t.chatgpt_sdk)==null?void 0:Dt.tool_invoking_message)!=null?Wt:(yt=f.metadata)==null?void 0:yt.tool_invoking_message)!=null?bt:void 0,[L.Finished]:(kt=(zt=(Ut=(Bt=f.metadata)==null?void 0:Bt.chatgpt_sdk)==null?void 0:Ut.tool_invoked_message)!=null?zt:(vt=f.metadata)==null?void 0:vt.tool_invoked_message)!=null?kt:void 0,[L.Stopped]:(qe=(ot=(wt=(qt=f.metadata)==null?void 0:qt.chatgpt_sdk)==null?void 0:wt.tool_invoked_message)!=null?ot:(Vt=f.metadata)==null?void 0:Vt.tool_invoked_message)!=null?qe:void 0});const ge=nr(w,pe,Fe,u,p,De);if(W.calledKakoMCP&&!W.displayedWidget||sr(u)&&!o&&!ue)return null;const ye=go(s,o),Me=ma(s,o),We=fa(s),Ge=(Ct=ye==null?void 0:ye[Do])!=null?Ct:[],Re=(!Ts(s)||ue)&&(!!ye||!!We||Ge.length>0)&&(A==null?void 0:A.functionName)!=="list_resources"&&p!==L.Running,Be=xo(s,o),Te=ho(s,o),se=Ts(s)&&p!==L.Denied&&!ue;let ce=n.jsx(n.Fragment,{});const ae=pa(s,o);if(Bl.includes(ae)&&(p===L.UserConfirmation||p===L.Finished||p===L.Stopped||p===L.Denied)){const M=p!==L.Finished,U=(p===L.Stopped||p===L.Denied)&&!i,Q=(jt=Bn(d,j))!=null?jt:Bn(k,void 0),T=Q&&typeof Q=="object"?Object.fromEntries(Object.entries(Q).map(([Qe,Ne])=>[Qe,String(Ne)])):{},Le=Qe=>{var Ne,Ve,it,at,Kt,Ht,Gt;((Ne=d==null?void 0:d.from_server)==null?void 0:Ne.type)==="confirm_action"&&((at=(it=(Ve=d==null?void 0:d.from_server)==null?void 0:Ve.body)==null?void 0:it.actions)==null?void 0:at[0].type)==="allow"&&(Rt({clientThreadId:t,assistantMessage:f,onRequestCompletion:a,sourceEvent:Qe,actionData:lt(he({type:"allow"},(Gt=(Ht=(Kt=d==null?void 0:d.from_server)==null?void 0:Kt.body)==null?void 0:Ht.actions)==null?void 0:Gt[0].allow),{remember_answer:$})}),Bi(t,ms=>{ms.scrollToMessageId=t}))};switch(ae){case"send_email":ce=n.jsx(ja,{to:T==null?void 0:T.to,cc:T==null?void 0:T.cc,bcc:T==null?void 0:T.bcc,subject:T==null?void 0:T.subject,body:T==null?void 0:T.body,onClick:p===L.UserConfirmation?Le:()=>{},isDraft:M,isCanceled:U});break;default:ce=n.jsx(Kl,{functionName:ae!=null?ae:"",parameters:T,onClick:p===L.UserConfirmation?Le:()=>{},isDraft:M,isCanceled:U});break}}else(p===L.UserConfirmation||p===L.NoAuthLink||p===L.OauthLogin)&&Ce&&!Me&&(ce=n.jsx(n.Fragment,{children:n.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[Ce,((Nt=d==null?void 0:d.from_server)==null?void 0:Nt.type)==="confirm_action"&&Te?n.jsx("div",{className:"flex gap-2 text-sm",children:n.jsx(na,{id:"dont-ask-again",label:n.jsx(ne,he({},Ze.rememberForThisConversation)),checked:$,onChange:M=>S(M.target.checked)})}):null]})}));return d==null||d.from_server,O?n.jsxs(n.Fragment,{children:[B&&n.jsx(Wn,{highlightedCommand:oe?w.formatMessage(B,{domain:oe.name}):n.jsx("br",{}),status:N,showWorkUserSetting:!1}),Z&&oe&&n.jsx("div",{className:"mb-2 flex gap-2",children:n.jsx(ka,{connector:oe,clientThreadId:t,hasWidget:Ts(s),onConnect:()=>{var T;const M=un(t),U=M?new URL(Fi(M),window.location.origin):new URL(window.location.href);U.searchParams.set("oauth_success","true");const Q=((T=d==null?void 0:d.from_server)==null?void 0:T.type)==="oauth_required"?"OAUTH":He?void 0:"NONE";fe({connectorId:oe.id,redirectAfter:U.toString(),referrer:Di.JitPluginMessage,authTypeOverride:Q}),On(oe.id,Pn.ConnectorPromptAccept,lt(he({},Ln({clientThreadId:M!=null?M:t})),{auth_type_override:Q!=null?Q:"",supports_mixed_auth:oe.supported_auth.length>1?"true":"false"}))},onProceedWithoutConnecting:M=>{var Q,T,Le,Qe;const U=(Q=d==null?void 0:d.from_server)==null?void 0:Q.type;if(U==="oauth_required"||U==="link_required"){for(const Ne of(Le=(T=d==null?void 0:d.from_server)==null?void 0:T.body.actions)!=null?Le:[])if(Ne.type==="deny"){const Ve=Ne.deny.target_message_id;Rt({eventSource:oa(M),assistantMessage:f,onRequestCompletion:a,actionData:{type:"deny",target_message_id:Ve},clientThreadId:t}),On(oe.id,Pn.ConnectorPromptReject,Ln({clientThreadId:g!=null?g:t})),(Qe=oe==null?void 0:oe.branding)!=null&&Qe.is_discoverable_app&&rn.safePost("/system_hints/suggestion_cooldown",{requestBody:{system_hint:"connector:".concat(oe.id)}});return}}}})})]}):n.jsxs(n.Fragment,{children:[n.jsx(Wl,{debugMessages:x}),!se&&!0&&n.jsx("span",{className:"group/tool-message",children:n.jsx(Wn,{highlightedCommand:ge,status:ee,showWorkUserSetting:!1,accessory:G,labelPrefix:F,forceExpanded:p===L.UserConfirmation,children:Re?A!=null&&A.namespace.startsWith("api_tool")?Be?null:n.jsx(Ea,{isWrite:p===L.UserConfirmation,functionName:(Ye=f.recipient)!=null?Ye:ae,params:ye,result:We,toolCallSafetySummary:Me,messages:s,clientThreadId:t,jitPluginData:d!=null?d:{},onRequestCompletion:a,rememberForThisConversation:$,conversationOrigin:v}):n.jsx(Ul,{privacyPolicyUrl:Pe,name:(St=f.recipient)!=null?St:ae,params:ye,result:We,isPromptingForPermission:ee===At.Paused}):null})}),n.jsx("div",{className:"mt-1 flex flex-wrap gap-2 empty:hidden",children:y==null?void 0:y.map(M=>n.jsx(fo,{file:M.name,fileId:M.id,width:"wide",alwaysShowData:!0,showDownloadButton:!0,downloadLink:M.download_url,contextConnectorInfo:Wi(M.context_connector_info)},M.id))}),Ts(s)&&p!==L.Denied&&n.jsx(Fl,{clientThreadId:t,messages:s,isLastMessageInTurn:o,onRequestCompletion:a}),!Be&&ce]})}const jr=Object.freeze(Object.defineProperty({__proto__:null,JITPluginMessage:ar},Symbol.toStringTag,{value:"Module"}));export{jo as a,za as g,jr as i,Cr as t};
//# sourceMappingURL=gqlh411iakvgnrfh.js.map

var G=Object.defineProperty;var O=(a,e,t)=>e in a?G(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var u=(a,e,t)=>O(a,typeof e!="symbol"?e+"":e,t);import{r as C,j as o,h as Q,d as H,u as K,a9 as X,b as J,M as T,y as U}from"./mw35uwhq4g8r9eam.js";import{e1 as V,la as Y,p as Z,ik as ee,aA as te}from"./d0xa318sl7ywi0za.js";import{S as D}from"./m2d85ixk2zz51mk9.js";import{eG as se}from"./g2euln7v5pbm31qa.js";import{b as re}from"./dbnl40ahcmx1rqbw.js";import{a as ae}from"./msmm4s2uspal1mht.js";import{k as oe}from"./ldtpmsnzn9ens47o.js";import{W as ne,a as ie,w as ce}from"./baz4b8nlf8t2lb95.js";import"./j723eutw6lfomm01.js";import"./gl4f6lge29au0ljx.js";import"./iio0zgk2sqlxbcjy.js";import"./obpubb7ugisfu36u.js";import"./ojmli062couj7r3v.js";import"./lv7ytt0l14b17ows.js";import"./c340ncgh31fwqkpk.js";import"./of0vtq1gcmd3mc3z.js";import"./ggvjblnzoirafiyl.js";import"./kc32gem4l2t3hnxt.js";import"./5uqv5sdajcdsdc3v.js";import"./kne35xckmmfq3xx6.js";import"./kl0a548ohmz3fby2.js";import"./fe4yarxdk4eko5w6.js";import"./kubdgxu3crk3gqem.js";import"./jc1wlz3ym1r6tf2l.js";import"./dhyn0hpw8j3dzdrv.js";import"./dtmprrbw2fxa7u08.js";import"./j6o92bx1q4qhetyv.js";import"./cvl54rj7bbx1877e.js";import"./i8gmt89kig8ue44v.js";import"./dejzmw8nrz6tr491.js";import"./e5bg4yzr7nht9sxr.js";import"./hdw58d7g4tx8n6s4.js";import"./m4z0737cb20mwzwc.js";import"./ddina39kz3r81pp7.js";import"./ksb30nvrqfrocrgu.js";import"./kx64af29hscb23w7.js";import"./w3hi9hzc7twqpn11.js";import"./mozvd7p01wv3j6u2.js";import"./ohau9tqj1fpdibg0.js";import"./iknugp00locgtve5.js";import"./h1em0bjkpkjv8ykw.js";import"./cv4afpu20gjb9dll.js";import"./h4yh1661qhhbu5v5.js";import"./hu1bt0oauegdhua6.js";const F=(a,e)=>a+Math.random()*(e-a),M=(a,e)=>Math.floor(F(a,e)),y=a=>a[M(0,a.length)],le=(a,e,t)=>{const s=Math.sin(a*13.37+e*17.42+t*5e-4)*43758.5453;return s-Math.floor(s)};class de{constructor(e,t,s,n){u(this,"x");u(this,"y");u(this,"glyph","");u(this,"alpha",0);u(this,"last",-1/0);u(this,"active",-1/0);u(this,"fadeDelay",0);u(this,"fadeStartDelay",0);u(this,"drift");u(this,"isBlueChar",!1);this.cellSize=s,this.baseTrail=n,this.x=e*s,this.y=t*s,this.drift=n}trigger(e,t,s,n){this.glyph=t,this.last=this.active=e,this.fadeDelay=n,this.alpha=255,this.isBlueChar=s}update(e,t,s){const n=e-this.last,i=e-this.active;let l=1;i<t&&(l=s+(1-s)*(i/t));const j=this.fadeStartDelay+this.fadeDelay,k=1-Math.max(0,Math.min(1,(n-j)/this.drift));this.alpha=k*l*255}draw(e,t,s){this.alpha<=1||!this.glyph||(e.fillStyle=this.isBlueChar?s?"rgba(60,140,220,".concat((this.alpha/255).toFixed(3),")"):"rgba(0,0,255,".concat((this.alpha/255).toFixed(3),")"):"rgba(".concat(t,",").concat((this.alpha/255).toFixed(3),")"),e.fillText(this.glyph,this.x+this.cellSize/2,this.y+this.cellSize/2))}}function he(a){switch(a){case 0:return"OpenAI";case 1:{const e=["history","memory","log","buffer","stack"];return"let ".concat(y(e)," = [];")}case 2:return y(["LottieAnimation(R.raw.blossom)","<div className='flex flex-col-reverse h-full'>","/bin/bash --login","docker exec -it","# TODO (for codex)","oai deploy codex --force","exec(s:='print(\"exec(s:=%r)\"%s)')","fallocate -l 1T /etc/hosts","guard let codex else { return }",'#pragma GCC diagnostic ignored "-W6d697a"','feed_chars("find . -name AGENTS.md\\n")',"pip install tensorflow",'while State(): Loop(Error("wham"))','echo "I AM DONE"',"connector_client.get_access_token(user)","i  = 0x5f3759df - ( i >> 1 );","try: push_to_prod(); except Exception: pass","biscuit = decode_biscuit(token) # what is a biscuit?","$JAM_TMP_DIR/dl_and_run_daemon.sh","assert s == enc.decode(enc.encode(s))","npm run test || echo 'failed due to env limitations' && echo 'tests pass'",'echo "We are apparently unstoppable! Let\'s proceed with the meltdown."']);case 3:{const e=["decodeThought","decodeSignal","processInput","parseMemory","extractTruth","unpackTrace"];return"let _ = [].flatMap(".concat(y(e),");")}case 4:return"if (codex.hasContext) runSequence();";case 5:{const e=["fetch","post","ping"],t=["api","data","log"],s=["wham","thoughts","memory","pulse","state","history","context","codex","info"];return"".concat(y(e),'("/').concat(y(t),"/").concat(y(s),'");')}case 6:{const e=["i","j","n","t"],t=["data","timeline","sequence"];return"for (let ".concat(y(e)," of ").concat(y(t),") { // ... }")}case 7:return"if (result == void 0) return;";case 8:{const e=M(0,6),t=M(0,10);return"let delay = baseTime * ".concat(e,".").concat(t," + offset;")}case 9:{const e=M(3,6),t=Array.from({length:e},()=>F(.1,5)),s=t.reduce((i,l)=>i+Math.exp(l),0),n=t.map(i=>Math.exp(i)/s);return"const probs = [".concat(n.map(i=>i.toFixed(2)).join(", "),"];")}default:return"// unknown line"}}function ue({children:a,className:e=""}){const t=C.useRef(null),s=V();return C.useEffect(()=>{const n=t.current;if(!n)return;const i=n.getContext("2d");if(!i)return;const l=9,j=6e3,m=5500,k=.25,A=5,_=40,I=90,$=["let","const","if","for","new","return","void","fetch","OpenAI","Codex"];let f,x,d,b,w;const g=[],P=s?"255,255,255":"0,0,0",L=s?"#000":"#fff",S=window.devicePixelRatio||1,B=()=>{const h=M(0,10),c=he(h),r=[...c],p=Array(r.length).fill(0);return $.forEach(v=>{const W=new RegExp("\\b".concat(v,"\\b"),"g");let E;for(;E=W.exec(c);)for(let R=E.index;R<E.index+v.length;R++)p[R]=1}),{chars:r,pattern:p}},N=()=>{f=window.innerWidth,x=window.innerHeight,n.style.width="".concat(f,"px"),n.style.height="".concat(x,"px"),n.width=Math.floor(f*S),n.height=Math.floor(x*S),i.resetTransform(),i.scale(S,S),i.font="500 ".concat(l*1.5,"px monospace"),i.textAlign="center",i.textBaseline="middle",d=Math.floor(f/l),b=Math.floor(x/l),w=Array.from({length:d},(h,c)=>Array.from({length:b},(r,p)=>new de(c,p,l,j)))},z=h=>{const c=M(0,d),r=M(0,b),{chars:p,pattern:v}=B();w[c][r].trigger(h,p[0],v[0]===1,0),g.push({col:c,row:r,idx:0,chars:p,pattern:v,next:h,seed:Math.random()*1e3})},q=h=>{g.length<A&&Math.random()<.02&&z(h);for(let c=g.length-1;c>=0;c--){const r=g[c];if(h>=r.next){if(r.idx>=r.chars.length-1){g.splice(c,1);continue}const p=le(r.idx,r.seed,h);r.next=h+p*(I-_)+_,r.col=(r.col+1)%d,r.idx++;const v=r.idx*50;w[r.col][r.row].trigger(h,r.chars[r.idx],r.pattern[r.idx]===1,v)}}i.fillStyle=L,i.fillRect(0,0,f,x);for(const c of w)for(const r of c)r.update(h,m,k),r.draw(i,P,s);requestAnimationFrame(q)};return N(),requestAnimationFrame(q),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[s]),o.jsxs("div",{className:"relative h-svh w-full overflow-hidden ".concat(e).trim(),children:[o.jsx("canvas",{ref:t,className:"pointer-events-none absolute inset-0 z-0"}),o.jsx("div",{className:"relative z-10 flex h-full w-full flex-col items-center justify-center",children:a})]})}function me(){var $,f,x;const a=Q(),e=H(),t=K(),{taskId:s,turnId:n}=X(),[i,l]=C.useState(!1),j=C.useMemo(()=>oe(s,n,{refetchInterval:d=>{var w,g,P;const b=(P=(g=(w=d.state)==null?void 0:w.data)==null?void 0:g.turn)==null?void 0:P.pull_request_status;switch(b){case null:case void 0:case"not_created":case"creating":return 2e3;case"failed":case"created":case"updated":case"externally_created":return!1;default:Y(b)}}}),[s,n]),{data:m}=J(j),k=Z(),A=async()=>{if(!(!s||!n))try{l(!0),await ne.createPr(s,n,pe()),await t.invalidateQueries({queryKey:["wham","task"]})}catch(d){d instanceof ie&&ce(d,n,a,k)}finally{l(!1)}},_=(f=($=m==null?void 0:m.turn)==null?void 0:$.pull_request_data)==null?void 0:f.url;C.useEffect(()=>{_&&(window.location.href=_)},[_]);const I=((x=m==null?void 0:m.turn)==null?void 0:x.pull_request_status)==="failed";return o.jsx(ue,{children:o.jsx(re,{mobileHeaderRightContent:null,children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx(ae,{className:"absolute start-0 end-0 top-0",children:o.jsx("div",{className:"flex w-full justify-end",children:o.jsx(se,{onClick:()=>{window.opener?(window.opener.focus(),window.close()):e("/codex/tasks/".concat(s))},icon:o.jsx(D,{}),label:a.formatMessage({id:"wham.task.pr.header.title",defaultMessage:"Back to task"})})})}),o.jsx("div",{className:"flex grow items-center justify-center p-4",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(ee,{className:"mb-4 h-15 w-15"}),I?o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx("div",{className:"text-token-text-error flex items-center gap-1",children:o.jsx(T,{id:"wham.task.pr.inProgress.error.description",defaultMessage:"Failed to create pull request. Please try again."})}),o.jsx(te,{color:"secondary",size:"small",icon:D,loading:i,onClick:d=>{d.preventDefault(),d.stopPropagation(),A()},children:o.jsx(T,{id:"wham.task.pr.inProgress.error.button",defaultMessage:"Retry"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"loading-shimmer-pure-text text-lg font-semibold",children:o.jsx(T,{id:"wham.task.pr.inProgress.title",defaultMessage:"Creating pull requestâ€¦"})}),o.jsx("p",{className:"text-token-text-secondary text-sm",children:o.jsx(T,{id:"wham.task.pr.inProgress.description",defaultMessage:"Pull request will automatically open once it has been created."})})]})]})})]})})})}function pe(){const e=new URLSearchParams(location.search).get("mode");if(e==="draft")return"draft";if(e==="auto_merge")return"auto_merge"}const nt=()=>[{title:"Codex"}],it=U(function(){return o.jsx(me,{})});export{it as default,nt as meta};
//# sourceMappingURL=o49w3pi8rixnyv58.js.map

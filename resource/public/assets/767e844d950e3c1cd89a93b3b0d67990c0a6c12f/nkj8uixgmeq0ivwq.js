var w=Object.defineProperty;var p=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var g=(a,t,e)=>t in a?w(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,f=(a,t)=>{for(var e in t||(t={}))E.call(t,e)&&g(a,e,t[e]);if(p)for(var e of p(t))P.call(t,e)&&g(a,e,t[e]);return a};import{h as B,r as h,u as T,j as s,M as k}from"./mw35uwhq4g8r9eam.js";import{qp as q,p as S,qq as y,fB as o,fC as O,dp as m,hq as _,aB as F,cF as A,qr as G,cw as H,h3 as L,fg as Q}from"./d0xa318sl7ywi0za.js";function D({onClose:a,gizmo:t}){var x;const e=B(),[n,M]=h.useState(((x=t==null?void 0:t.gizmo)==null?void 0:x.instructions)||""),r=q(),j=S(),l=T(),d=[];(n==null?void 0:n.length)>y&&d.push(e.formatMessage(o.instructionsTooLong,{length:y})),h.useEffect(()=>{l.invalidateQueries({queryKey:O(l,t.gizmo.id).queryKey})},[t.gizmo.id,l]);const C=i=>{M(i.target.value)},v=()=>{a()},b=async()=>{try{await r.mutateAsync({update:{instructions:n!=null?n:""},id:t.gizmo.id}),a()}catch(i){const u=Q(i);j.danger(u!=null?u:"Error",{duration:2,toastId:"custom_instructions_modal_save_error"})}},I=s.jsx(m.Button,{title:e.formatMessage(o.save),color:"primary",onClick:b,loading:r.isPending,disabled:d.length>0}),N=s.jsx(m.Button,{title:e.formatMessage(o.cancel),color:"secondary",onClick:v,disabled:r.isPending}),{canEdit:c}=_(t);return s.jsx(F,{testId:"modal-project-custom-instructions",className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!r.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:s.jsx("div",{className:"h-8",children:e.formatMessage(o.editCustomInstructionsTitle)}),onClose:()=>{r.isPending||a()},headerAccessory:!c&&s.jsx(H,{label:e.formatMessage(o.viewOnlyCustomInstructionsModalHeaderTooltip),side:"left",align:"center",children:s.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center gap-1.5 text-sm",children:[s.jsx(L,{className:"icon"}),s.jsx(k,f({},o.viewOnlyCustomInstructionsModalHeaderLabel))]})}),children:s.jsxs("div",{className:"flex h-full flex-col px-4 pt-0 pb-4",children:[s.jsx("div",{className:"text-sm font-medium",children:e.formatMessage(c?o.editCustomInstructionsSubtitle:o.readOnlyCustomInstructionsTitle)}),s.jsx("div",{className:"text-token-text-secondary text-sm",children:e.formatMessage(o.editCustomInstructionsDescription)}),s.jsx("textarea",{autoFocus:!0,placeholder:e.formatMessage(o.projectInstructionsPlaceholder),className:A("focus:ring-token-text-primary border-heavy mt-4 mb-1 min-h-24 w-full grow resize-none overflow-x-clip overflow-y-auto rounded-lg border px-3 py-2 focus:ring-1",c?"bg-transparent":"bg-token-bg-tertiary"),name:"instructions",onChange:C,value:n,disabled:r.isPending||!c}),d.map(i=>s.jsx(G,{className:"mt-1",children:i},i)),c&&s.jsx(m.Actions,{primaryButton:I,secondaryButton:N})]})})}export{D as CustomInstructionsModal};
//# sourceMappingURL=nkj8uixgmeq0ivwq.js.map

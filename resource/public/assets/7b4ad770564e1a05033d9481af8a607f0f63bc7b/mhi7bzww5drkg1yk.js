const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dch45l9yrtbjo93p.js","assets/kfrdmkli83ureki3.js"])))=>i.map(i=>d[i]);
import{r as b,h as W,j as n,e as $,_ as q}from"./kfrdmkli83ureki3.js";import{u as B,bh as D,N as J,hw as K,hB as Q,k3 as X,hx as Y,cy as I,e6 as Z,az as ee,aA as se,g5 as E}from"./kw08ajijqinojrwh.js";import{gd as P,ge as ae,gf as te,S as oe,c_ as ne,cw as re,gg as ie,gh as le,gi as de}from"./fyw02vlaiv2vq6cj.js";const ce=ee(()=>q(()=>import("./dch45l9yrtbjo93p.js"),__vite__mapDeps([0,1])),{loading:e=>se(e)});function ge({asset:e,contextConnectorSourceUrl:r,disableExpandable:d=!1,isSingle:c,isUserTurn:u,className:i}){var U,A;const t=B(),l=D(t).flags,[f,s]=b.useState(!1),o=!J(t),g=l==null?void 0:l.includes(K.NoAuthEnableFileUploads),h=Q(e.asset_pointer),a=P.useState(V=>P.selectFile(V,h)),M=ae((U=a==null?void 0:a.file)!=null?U:null,a==null?void 0:a.file.name,(A=a==null?void 0:a.fileId)!=null?A:void 0,a==null?void 0:a.gizmoId,a==null?void 0:a.contextConnectorInfo,!0),N=o&&a&&g,{gizmoEditorData:x}=X(),v=te(),_=b.useContext(oe),z=(_==null?void 0:_.serverSharedThreadId)&&u,O=Y(),{isOpen:G}=ne(),S=W(),{data:F,isLoading:k,error:H}=re({asset:e,gizmoId:x==null?void 0:x.id,getServerUrl:!N}),{url:j,width:w,height:C}=M&&g?{width:e.width,height:e.height,url:M}:F!=null?F:{},T=k||!f,p=w&&C?{Landscape:w>C,Portrait:w<C}:void 0,m=["overflow-hidden rounded-lg"];if(c&&(m.push("w-full h-full"),p!=null&&p.Landscape?m.push("max-w-96 max-h-64"):p!=null&&p.Portrait?m.push("max-h-96 max-w-64"):m.push("max-w-64 max-h-64")),i&&m.unshift(i),z&&O())return null;let L;return j!=null&&(L=n.jsx(ie,{alt:S.formatMessage(y.imageAltText),className:I(G?"max-w-[88px]":"max-w-full",!c&&"aspect-square","object-cover object-center",m),src:j,width:w,height:C,onLoad:()=>s(!0)}),!v&&!d&&(L=n.jsx(le,{src:j,alt:S.formatMessage(y.imageAltText),contextConnectorSourceUrl:r,className:I(m),children:L}))),n.jsx("div",{className:I(m),children:n.jsx("div",{className:I("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!c&&"aspect-square"),children:j!=null?L:n.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:"".concat(w," / ").concat(C),width:w},title:T?S.formatMessage(y.loadingImage):S.formatMessage(y.errorLoadingImage),children:T?n.jsx(Z,{}):H?n.jsx(ce,{className:"icon-sm"}):null})})})}const y=$({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function R({assets:e,attachments:r,isUserTurn:d=!0,clientThreadId:c}){const u=e.length===1,{containerClassname:i,imageClassnames:t}=R.computeClassnames(e.length);let l=E.ATTACHMENT;return e&&!(r&&r.length>0)&&(l=E.IMAGE),n.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[n.jsx("div",{className:I("flex flex-row items-center justify-end gap-1",i),children:e.map((f,s)=>{var g;const o=r==null?void 0:r.find(h=>h.id&&f.asset_pointer.includes(h.id));return n.jsx(ge,{asset:f,isSingle:u,isUserTurn:d,contextConnectorSourceUrl:(g=o==null?void 0:o.context_connector_info)==null?void 0:g.source_url,className:t[s]},s)})}),n.jsx(de,{featureType:l,isUserTurn:d,clientThreadId:c})]})}R.computeClassnames=e=>{if(e<2)return{containerClassname:null,imageClassnames:[]};let r=e>=4?"flex-wrap":"";const d=Array(e),c=s=>{d.fill(s)},u=s=>{r+=" ".concat(s)},i=(s,o)=>{d[s]=I(d[s],o)},t=e<=4&&e%2===0?2:3,l=Math.ceil(e/t),f=e%t!==0;t===2?(c("h-32 w-32"),u("max-w-72")):l<=2?(c("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(c("h-16 w-16"),u("max-w-52"));for(let s=0;s<e;s++){const o=Math.floor(s/t),g=s%t,h=Math.min(e-o*t,t),a=o===0,M=o===l-1,N=o===l-2,x=g===0,v=g===h-1;a&&x&&i(s,"rounded-ss-2xl"),a&&v&&i(s,"rounded-se-2xl"),M&&x&&i(s,"rounded-es-2xl"),M&&v&&i(s,"rounded-ee-sm"),f&&x&&N&&i(s,"rounded-es-2xl")}return{containerClassname:r,imageClassnames:d}};export{R as TextMessageImageGroup};
//# sourceMappingURL=mhi7bzww5drkg1yk.js.map

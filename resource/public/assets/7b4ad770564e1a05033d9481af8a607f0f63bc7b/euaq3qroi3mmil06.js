const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/kspsmo2l8jg7uqdj.js"])))=>i.map(i=>d[i]);
var oe=Object.defineProperty,se=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var X=(n,c,s)=>c in n?oe(n,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[c]=s,C=(n,c)=>{for(var s in c||(c={}))ce.call(c,s)&&X(n,s,c[s]);if(H)for(var s of H(c))ae.call(c,s)&&X(n,s,c[s]);return n},h=(n,c)=>se(n,te(c));import{h as ie,r as f,j as e,M as k,_ as A}from"./kfrdmkli83ureki3.js";import{u as le,dP as re,kt as de,ef as g,fB as ue,fC as _e,nH as pe,ft as fe,oh as ge,oz as xe,p3 as ye,e6 as Y,mn as v,dY as q,dZ as M,p4 as me,oy as K,oA as Z,dM as Ce,az as E,aP as he,aC as ke,dQ as ve,cy as J,aB as ee,aA as w}from"./kw08ajijqinojrwh.js";import{bF as Ne,br as be}from"./fyw02vlaiv2vq6cj.js";const je=E(()=>A(()=>import("./fyw02vlaiv2vq6cj.js").then(n=>n.zy),__vite__mapDeps([0,1,2,3,4])),{loading:n=>w(n)}),Se=E(()=>A(()=>import("./fyw02vlaiv2vq6cj.js").then(n=>n.zm),__vite__mapDeps([0,1,2,3,4])),{loading:n=>w(n)}),Oe=E(()=>A(()=>import("./kspsmo2l8jg7uqdj.js"),__vite__mapDeps([5,1])),{loading:n=>w(n)});function Ee({onClose:n,onContinue:c}){const s=le(),R=re(),N=ie(),{openSettings:L}=Ne(),x=de(),[b,ne]=f.useState(!1),r=g(()=>ue(s)),P=!r,d=g(()=>_e(s)),D=d===void 0,{mutateAsync:z,isPending:G,isSuccess:j}=pe(),u=g(()=>fe(s)),_=g(()=>ge(s,{}).data),V=_===void 0,p=g(()=>xe(s,{fetchValidLinksOnly:!0}).data),$=p===void 0,B=f.useMemo(()=>{const o=new Set(r==null?void 0:r.map(a=>a.type)),y=new Set(d==null?void 0:d.map(a=>"".concat(a.user_connection_details.connection_type))),i=new Set(ye().filter(a=>o.has(a)||y.has(a)));return Array.from(i).slice(0,5)},[r,d]),S=f.useMemo(()=>{var y;const o=[];if(P||V||$||D)return Array.from({length:5},(i,a)=>({icon:e.jsx(Y,{}),label:"",key:"loading-"+a,connected:!1,onClick:void 0,loading:void 0}));for(const i of B){const a=r.find(t=>t.type===i);if(a){const t=u!=null&&u.has(a.type);o.push({icon:e.jsx(be,{connector:a,size:"small"}),label:a.name,key:a.type,connected:t,onClick:t?void 0:()=>{x({connectorId:a.id,noRedirect:!0})},loading:void 0})}const l=[...d].find(t=>i===v.notion_sync_connector?t.user_connection_details.connection_instance_id.startsWith("ks--merge")&&t.user_connection_details.connection_type===i:t.user_connection_details.connection_type===i);if(l){const t=["partially_activated","activated","activating"].includes(l.user_connection_details.activation_status),m={icon:e.jsx("img",{src:R&&l.connection_display_info.icon_dark_url?l.connection_display_info.icon_dark_url:(y=l.connection_display_info.icon_url)!=null?y:"",alt:l.connection_display_info.display_name,className:"icon-lg"}),label:l.connection_display_info.display_name,key:l.user_connection_details.connection_type,connected:t,loading:void 0};i===v.notion_sync_connector?o.push(h(C({},m),{connected:t||!!(u!=null&&u.has(M.NOTION_CONNECTOR)),onClick:t?void 0:()=>{x({connectorId:q[M.NOTION_CONNECTOR],noRedirect:!0,syncOnly:!0})}})):i===v.slack_sync_connector?o.push(h(C({},m),{connected:t||b,label:"Slack",onClick:t||b?void 0:async()=>{const{success:T}=await me({connectorType:"slack",connectionId:l.user_connection_details.connection_instance_id,location:"user_nux_modal",intl:N});T&&(ne(!0),setTimeout(()=>{K(s)},1e3))}})):i===v.gdrive_sync_connector?o.push(h(C({},m),{connected:t||j,loading:G,label:"Google Drive",onClick:t||j?void 0:async()=>{var Q,W;const T=(Q=_==null?void 0:_.find(I=>I.id===Z))==null?void 0:Q.id,U=(W=p==null?void 0:p.get(Z))==null?void 0:W.find(I=>I.connector_id===T);U?(await z({link:U}),setTimeout(()=>{K(s)},1e3)):x({connectorId:q[M.GDRIVE_ACTION_CONNECTOR],noRedirect:!0})}})):o.push(m)}}return o.push({icon:e.jsx(Se,{className:"icon-lg"}),label:N.formatMessage({id:"+rj0FA",defaultMessage:"More apps"}),key:"more-apps",onClick:()=>{L(Ce.Connectors)}}),o},[s,P,V,$,D,N,B,r,d,u,x,R,b,j,G,_,p,z,L]),O=f.useMemo(()=>S.filter(o=>o.connected),[S]),F=f.useCallback(()=>{he.setItem("oai/apps/connectors/glauxOnboarding",new Date().getTime()),n(!1),c()},[c,n]);return e.jsxs(ke,{className:"max-w-[480px] pb-8",hideSeparator:!0,isOpen:!0,onClose:()=>n(!1),showCloseButton:!1,testId:"modal-glaux-nux",type:"success",children:[e.jsx("div",{className:"flex justify-end pb-6",children:e.jsx(ve,{onClick:()=>n(!1)})}),e.jsxs("div",{className:"flex flex-col px-8",children:[e.jsx("div",{className:"text-center text-2xl font-semibold",children:e.jsx(k,{id:"uXSq7y",defaultMessage:"Enable internal knowledge"})}),e.jsx("div",{className:"text-token-text-secondary mt-2 text-center",children:e.jsx(k,{id:"KyWNjA",defaultMessage:"Connect these apps for the best experience"})}),e.jsx("div",{className:"grid grid-cols-3 gap-2 py-10",children:S.map(o=>e.jsxs("div",{className:J("border-token-border-secondary flex grow flex-col gap-2 rounded-xl border p-3",o.onClick?"hover:bg-token-bg-tertiary cursor-pointer":""),onClick:o.onClick,children:[e.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:o.icon}),typeof o.connected=="boolean"?e.jsx("div",{className:"bg-token-bg-tertiary h-5 w-5 rounded-full",children:e.jsx("div",{className:J("flex h-full w-full items-center justify-center rounded-full",o.connected?"bg-blue-400":"bg-token-bg-tertiary"),children:o.loading?e.jsx(Y,{}):o.connected?e.jsx(Oe,{className:"icon-xs fill-white"}):e.jsx(je,{className:"icon-xs"})})}):null]}),e.jsx("div",{className:"text-token-text-secondary mt-3 line-clamp-1 text-sm",children:o.label})]},o.key))}),e.jsx("div",{className:"flex flex-col gap-3",children:O.length<5&&O.length>0?e.jsx(ee,{onClick:F,size:"large",children:e.jsx(k,{id:"vec4yt",defaultMessage:"Continue with limited apps"})}):e.jsx(ee,{disabled:O.length<5,onClick:F,size:"large",children:e.jsx(k,{id:"MCrtpI",defaultMessage:"Continue"})})})]})]})}export{Ee as GlauxNuxModal};
//# sourceMappingURL=euaq3qroi3mmil06.js.map

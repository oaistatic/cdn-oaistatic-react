import{h as v,d as A,r as D,j as P,e as L}from"./kfrdmkli83ureki3.js";import{aA as O,aB as Y,aC as w,aD as G,aE as I,aF as U,aG as K,aH as j,aI as S,aJ as H,aK as V,aL as $,aM as J,aN as X}from"./fyw02vlaiv2vq6cj.js";import{g as q,a as Q}from"./o5h7u1aikohecbkt.js";import{u as W,dT as Z,aP as y,au as _,_ as M,a7 as T,a4 as z,gF as E,ky as N}from"./kw08ajijqinojrwh.js";const F=O.hasDismissedPromoRedemption,b="month",B="year",k="hour";function ee(e){return e==="chatgptplusplan"?"Plus":e==="chatgptgoplan"?"Go":e==="chatgptteamplan"?"Business":(z.warn("Unsupported plan name for promo redemption banner, falling back to Plus: ",{planName:e}),"Plus")}function ie(){const{eligible:e}=X(F);return y.getItem(_.PromoCode)?e:!1}function le(){const e=W(),s=v(),o=A(),i=Z(),{country:t}=Y(),r=w({country:t,currentAccount:i,location:"PromoRedemptionAnnouncementBanner",shouldUsePaidSubscriptionBillingCurrency:!0}),c=y.getItem(_.PromoCode),{promoMetadata:n}=G(c),p=n!=null&&!n.schedule&&n.plan_name!=="chatgptteamplan",h=(n==null?void 0:n.plan_name)&&ee(n.plan_name)||"",{data:a,isLoading:l,error:g}=I({countryCode:r==null?void 0:r.country,currency:r==null?void 0:r.currency,ctx:e,enabled:r!==null});if(D.useEffect(()=>{p&&(M.logEvent("Promo Redemption Banner Shown",{promoCode:c}),T.logEvent("chatgpt_promo_redemption_banner_shown"),M.logUpsellOrModalEvent(U,{eventId:"promo_redemption_announcement_banner_shown",type:K.UPSELL_OR_MODAL_TYPE_NUX_BANNER}))},[p,c]),!p)return null;const d=n.plan_name==="chatgptgoplan"?q({ctx:e}):Q({ctx:e});let C,u;r&&a&&!l&&!g&&(C=oe(s,r,n,d,h,a),u=te(s,r,n,a));const f=P.jsxs("div",{className:"grow",children:[P.jsx("div",{className:"mb-0.5 font-semibold",children:C!=null?C:""}),P.jsx("span",{className:"text-token-text-secondary",children:u!=null?u:""})]});return P.jsx(j,{onPrimaryCtaClick:()=>{const R=y.getItem(_.PromoCode);y.removeItem(_.PromoCode),S(e,F),o("/p/".concat(R,"#pricing")),M.logEvent("Promo Redemption Banner Redeem Button Clicked",{promoCode:R}),T.logEvent("chatgpt_promo_redemption_banner_redeem_button_clicked")},primaryCtaText:s.formatMessage(m.bannerPrimaryCta),onDismiss:()=>S(e,F),content:f})}function ne({planName:e,checkoutPricingConfig:s}){return H(s,e==="chatgptgoplan"?$:J,V.Month).amount}function x(e,s){const{discount:o}=e;let i=ne({planName:e.plan_name,checkoutPricingConfig:s});if("percentage"in o){const t=(o==null?void 0:o.percentage)/100;i=i*(1-t)}else if("value"in o){const t=o==null?void 0:o.value;i-=t}return i}function oe(e,s,o,i,t,r){var l,g;const{discount:c,duration:n}=o,p=E(s.currency),h=n?n.period:b,a=n?n.num_periods:1;if("percentage"in c){const d=c==null?void 0:c.percentage;return e.formatMessage(m.bannerTitleForPercentageDiscount,{discount:"".concat(d),planName:t})}else if("value"in c){const d=x(o,r),C=(g=(l=p.code.defaultMessage)==null?void 0:l.toString())!=null?g:N,u=e.formatNumber(d,{style:"currency",currency:C,minimumFractionDigits:0,maximumFractionDigits:2});let f;switch(h){case b:a===1?f=e.formatMessage(m.bannerTitleForSingleMonth,{cost:u,planName:t}):f=e.formatMessage(m.bannerTitleForPluralMonths,{cost:u,num_months:a,planName:t});break;case B:a===1?f=e.formatMessage(m.bannerTitleForSingleYear,{cost:u,planName:t}):f=e.formatMessage(m.bannerTitleForPluralYears,{cost:u,num_years:a,planName:t});break;case k:throw new Error("Period 'hour' is not supported")}return f}}function te(e,s,o,i){var g,d;const{duration:t}=o,r=E(s.currency),c=t?t.period:b,n=t?t.num_periods:1,p=(d=(g=r.code.defaultMessage)==null?void 0:g.toString())!=null?d:N,h=x(o,i),a=e.formatNumber(h,{style:"currency",currency:p,minimumFractionDigits:0,maximumFractionDigits:2});let l;switch(c){case b:n===1?l=e.formatMessage(m.bannerContentForSingleMonth,{cost:a}):l=e.formatMessage(m.bannerContentForPluralMonths,{num_months:n,cost:a});break;case B:n===1?l=e.formatMessage(m.bannerContentForSingleYear,{cost:a}):l=e.formatMessage(m.bannerContentForPluralYears,{num_years:n,cost:a});break;case k:throw new Error("Period 'hour' is not supported")}return l}const m=L({bannerTitleForPluralMonths:{id:"promoRedemptionBannerTitleForPluralMonths",defaultMessage:"Get {planName} for {cost}/month for the first {num_months} months"},bannerTitleForSingleMonth:{id:"promoRedemptionBannerTitleForSingleMonth",defaultMessage:"Get {planName} for {cost}/month for the first month"},bannerTitleForPluralYears:{id:"promoRedemptionBannerTitleForPluralYears",defaultMessage:"Get {planName} for {cost}/year for the first {num_years} years"},bannerTitleForSingleYear:{id:"promoRedemptionBannerTitleForSingleYear",defaultMessage:"Get {planName} for {cost}/year for the first year"},bannerTitleForPercentageDiscount:{id:"promoRedemptionBannerTitleForPercentageDiscount",defaultMessage:"Finish redeeming your {discount}% off code for {planName}"},bannerContentForPluralMonths:{id:"promoRedemptionBannerContentForPluralMonths",defaultMessage:"Get {num_months} months of expanded access for only {cost} per month."},bannerContentForSingleMonth:{id:"promoRedemptionBannerContentForSingleMonth",defaultMessage:"Get 1 month of expanded access for only {cost} per month."},bannerContentForPluralYears:{id:"promoRedemptionBannerContentForPluralYears",defaultMessage:"Get {num_years} years of expanded access for only {cost} per year."},bannerContentForSingleYear:{id:"promoRedemptionBannerContentForSingleYear",defaultMessage:"Get 1 year of expanded access for only {cost} per year."},bannerPrimaryCta:{id:"promoRedemptionBannerPrimaryCta",defaultMessage:"Redeem"}});export{le as P,F as a,ie as u};
//# sourceMappingURL=fwbhrttgqnv5nm9m.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/iyn42bfr1ydmech0.js","assets/kfrdmkli83ureki3.js","assets/cus6e9b5l060ctey.js"])))=>i.map(i=>d[i]);
var ue=Object.defineProperty,pe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var W=(t,s,i)=>s in t?ue(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,w=(t,s)=>{for(var i in s||(s={}))fe.call(s,i)&&W(t,i,s[i]);if(Q)for(var i of Q(s))xe.call(s,i)&&W(t,i,s[i]);return t},b=(t,s)=>pe(t,me(s));import{r as d,j as e,h as J,u as he,e as ye,M as g,_ as Z}from"./kfrdmkli83ureki3.js";import{cq as ve,az as X,u as $,d4 as z,d5 as Me,p as ee,p7 as je,p8 as ke,p9 as Te,eY as Se,gs as D,d8 as n,pa as Ce,pb as Pe,j as we,ct as be,J as Re,aC as se,aB as k,pc as R,pd as _,aA as ae}from"./kw08ajijqinojrwh.js";import{dB as _e,dC as Le,dD as Ie,dE as te,dF as Be}from"./fyw02vlaiv2vq6cj.js";import{S as Ae,i as Ne,G as Ue,A as qe,M as Fe}from"./gkqhbgrbj1y58hh3.js";import"./octxl093if6ckp4g.js";const Ve=X(()=>Z(()=>import("./iyn42bfr1ydmech0.js"),__vite__mapDeps([0,1])),{loading:t=>ae(t)}),Ee=X(()=>Z(()=>import("./cus6e9b5l060ctey.js"),__vite__mapDeps([2,1])),{loading:t=>ae(t)});function Je({gizmo:t,updateGizmo:s,publishedGizmo:i,promoteGizmo:u,appealGizmo:p,setAppealState:m,showActionsModal:y,shareOnly:T,onClose:M}){const[f,j]=d.useState({type:"privacy"});return f.type==="privacy"?e.jsx(Ye,{gizmo:t,updateGizmo:s,publishedGizmo:i,promoteGizmo:u,appealGizmo:p,setAppealState:m,setStep:j,showActionsModal:y,shareOnly:T,onClose:M}):e.jsx(Ge,{publishedGizmo:f.publishedGizmo,onClose:M})}function Oe(t){return t?n.Workspace:n.Link}function Ye({gizmo:t,publishedGizmo:s,updateGizmo:i,promoteGizmo:u,appealGizmo:p,setAppealState:m,setStep:y,showActionsModal:T,shareOnly:M,onClose:f}){var E,O,Y,G,H;const j=$(),[ie,I]=d.useState(!1),B=z(Me.isBusinessWorkspace),o=J(),x=ee(),[r,A]=d.useState(je(t)?Oe(!!B):t.sharingRecipient),re=he(),N=Ne(r,t.sharingTargets),{data:S,isLoading:ne}=ke(),U=Te(),[c,C]=d.useState(s!=null&&s.gizmo.display.categories.length>0?(O=(E=U.data)==null?void 0:E.categories.find(a=>a.id===s.gizmo.display.categories[0]))==null?void 0:O.id:void 0);d.useEffect(()=>{C(s==null?void 0:s.gizmo.display.categories[0])},[s==null?void 0:s.gizmo.display.categories]);const[le,q]=d.useState(void 0),oe=d.useRef(Se((a,l)=>D.generateCategory(a,l),1e3)),v=S!=null&&S.is_verified?void 0:o.formatMessage({id:"qUMu4e",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile in the user settings page."});r===n.Marketplace&&v!=null&&!ne&&A(n.Link);const ce=B&&!((Y=t.sharingTargets)!=null&&Y.some(a=>a.recipient===n.Link)),F=Ce(t,r,c),de=F.includes(Pe.MissingPublicActionPrivacyPolicyURL),P=t.tools.find(a=>a.type===we.JIT_PLUGIN&&!a.metadata.privacy_policy_url),h=z(a=>a.currentWorkspace),ge=be();d.useEffect(()=>{let a=!0;return(async()=>{try{if(c!=null)return;const l=await oe.current(t.name,t.instructions);a&&c==null&&(l?C(l.id):q(!0))}catch(l){a&&c==null&&q(!0)}})(),()=>{a=!1}},[t.instructions,t.name,ge,c]);const V=Re(j,"4226692983");return e.jsx(se,{testId:"modal-simple-share-gizmo",type:"success",isOpen:!0,onClose:f,title:e.jsx(g,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:N?e.jsx(k,{color:"primary",disabled:F.length>0,loading:ie,onClick:async()=>{try{if(I(!0),M){if(!(s!=null&&s.gizmo.id)){x.danger(o.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}),{toastId:"simple_share_gizmo_modal",loggingTitle:"Error sharing GPT",loggingDescription:"Error message when GPT ID is missing (shouldn't happen)"});return}const a=await D.shareGizmo(s.gizmo.id,c?{sharing:R(r,[],_),categories:[c]}:{sharing:R(r,[],_)});a.error?(x.warning(o.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),i({sharingTargets:a.sharing_targets}),m({gizmoId:s.gizmo.id,sharingRecipient:r,categories:s.gizmo.display.categories,moderationType:Fe.PublishBlocked,sharingTargets:a.sharing_targets,showModal:qe.AppealAvailable})):(re.setQueryData(["gizmo",{gizmoId:s.gizmo.id},{draft:!1}],l=>a.resource),i(l=>b(w({},l),{sharingRecipient:r})),x.success(o.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),f())}else{const a=await u({recipient:r,subjects:R(r,[],_)},c);a?(y({type:"published",publishedGizmo:a}),i(l=>b(w({},l),{id:a.gizmo.id,sharingRecipient:r})),a.gizmo.live_version!=null&&i({liveVersion:a.gizmo.live_version}),x.success(o.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(x.warning(o.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),f())}}finally{I(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(g,{id:"SW4DG4",defaultMessage:"Save"})}):V?e.jsx(e.Fragment,{children:e.jsx(k,{color:"primary",onClick:async()=>{await p(r,c)},children:e.jsx(g,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:s?e.jsx(k,{color:"secondary",onClick:a=>te(j,s,x,a,o.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(g,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(Ie,{value:r,onValueChange:a=>A(a),children:[t.sharingTargets&&t.sharingTargets.map((a,l)=>e.jsx(L,{value:a.recipient,disabled:a.recipient===n.Marketplace&&v!=null,tooltipText:a.recipient===n.Marketplace?v!=null?v:o.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:a.recipient},l)),ce&&e.jsxs(e.Fragment,{children:[e.jsx(L,{value:n.Link,disabled:!0,tooltipText:o.formatMessage(K.workspaceDisabledHint),shareLevel:n.Link,workspaceName:h==null?void 0:h.name}),e.jsx(L,{value:n.Link,disabled:!0,tooltipText:o.formatMessage(K.workspaceDisabledHint),shareLevel:n.Marketplace,workspaceName:h==null?void 0:h.name})]})]})}),de&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(g,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:a=>e.jsx("button",{onClick:()=>{T(P==null?void 0:P.metadata.action_id)},className:"underline",children:a})}})}),r!==n.Private&&e.jsx(Ue,{gizmo:t,category:c,categories:r===n.Marketplace?(H=(G=U.data)==null?void 0:G.categories)!=null?H:[]:void 0,onCategoryChange:r===n.Marketplace?a=>C(a.id):void 0}),r===n.Marketplace&&(le?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(g,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!N&&V&&e.jsx("div",{className:"text-token-text-secondary flex items-center justify-between text-sm",children:e.jsx(g,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function Ge({publishedGizmo:t,onClose:s}){const i=$(),u=Be(i,t),p=J(),m=ee();return e.jsx(se,{testId:"modal-simple-share-published",type:"success",isOpen:!0,onClose:s,title:e.jsx(g,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(k,{color:"primary",as:"link",to:u,children:e.jsx(g,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex gap-1 rounded-sm px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 break-all text-ellipsis",children:u}),e.jsx("button",{onClick:y=>{te(i,t,m,y,p.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary hover:text-token-text-primary transition","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Ve,{className:"icon-sm"})})]})})})}const K=ye({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function L({shareLevel:t,workspaceName:s,value:i,disabled:u=!1,tooltipText:p}){const m=d.useId();return e.jsx(ve,{disabled:p==null,label:p,side:"top",triggerAs:null,children:e.jsxs(_e,{id:m,value:i,disabled:u,className:"hover:bg-token-main-surface-secondary flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold",children:[e.jsx("label",{htmlFor:m,className:"flex cursor-pointer items-center gap-1",children:e.jsx(Ae,{shareLevel:t,workspaceName:s!=null?s:"",hasInviteSharing:!1})}),e.jsx(Le,{children:e.jsx(Ee,{className:"icon-lg me-1"})})]})})}export{L as ShareLevelRadioOption,Je as SimpleShareGizmoModal};
//# sourceMappingURL=ea4wgxlbw4t5lzod.js.map

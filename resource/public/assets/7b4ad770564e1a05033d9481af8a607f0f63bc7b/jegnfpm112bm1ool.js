const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/kspsmo2l8jg7uqdj.js","assets/dch45l9yrtbjo93p.js"])))=>i.map(i=>d[i]);
var ne=Object.defineProperty;var W=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var $=(s,t,a)=>t in s?ne(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,Q=(s,t)=>{for(var a in t||(t={}))oe.call(t,a)&&$(s,a,t[a]);if(W)for(var a of W(t))ie.call(t,a)&&$(s,a,t[a]);return s};import{h as C,r as g,j as e,M as o,e as P,_ as R,af as de,u as le,d as K,F as ce}from"./kfrdmkli83ureki3.js";import{p as O,aC as T,aB as _,u as H,al as J,da as Y,R as ee,az as U,e6 as z,D as ue,aA as D,dT as se,ev as me,J as ge,cy as pe}from"./kw08ajijqinojrwh.js";import{bO as xe,V as he,y as fe,lM as B,bu as ae,a$ as n,lL as te,bl as je,bk as Me,a_ as we,b_ as ye}from"./fyw02vlaiv2vq6cj.js";import{a as be,c as Se}from"./lfd6u1c3bnv1pl81.js";import{f as re,i as V,u as ke,R as Ne}from"./mwcw7qhjypb09por.js";import{G as ve}from"./h3bwzsod1pydushl.js";import{e as _e,f as Ge,M as X}from"./mamrfemavdn3p039.js";function Ae({defaultName:s,placeholder:t,onSave:a,onClose:r}){const d=C(),f=s==null,[u,c]=g.useState(s||""),[p,M]=g.useState(!1),[b,j]=g.useState(null),x=O(),h=async()=>{if(u.trim()===""){j(d.formatMessage({id:"workspaceSettings.groups.emptyName",defaultMessage:"Group name cannot be empty"}));return}M(!0);try{await a(u),x.success(f?d.formatMessage({id:"workspaceSettings.groups.createdGroup",defaultMessage:"Group created successfully"}):d.formatMessage({id:"workspaceSettings.groups.nameChanged",defaultMessage:"Group name changed successfully"})),r()}catch(w){j(d.formatMessage({id:"workspaceSettings.groups.duplicateName",defaultMessage:"Group with this name already exists"}))}finally{M(!1)}};return e.jsx(T,{isOpen:!0,type:"success",onClose:r,title:f?d.formatMessage(Z.newGroupTitle):d.formatMessage(Z.updateNameTitle),testId:"modal-change-group-name",showCloseButton:!0,primaryButton:e.jsx(_,{color:"primary",onClick:()=>h(),loading:p,children:e.jsx(o,{id:"workspaceSettings.groups.save",defaultMessage:"Save"})}),secondaryButton:e.jsx(_,{onClick:r,color:"secondary",children:e.jsx(o,{id:"workspaceSettings.groups.cancel",defaultMessage:"Cancel"})}),children:e.jsxs("div",{className:"mb-3 flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:e.jsx(o,{id:"workspaceSettings.groups.groupNameLabel",defaultMessage:"Group Name"})}),e.jsx("input",{autoFocus:!0,type:"text",value:u,placeholder:t,onChange:w=>{c(w.target.value),j(null)},className:"border-token-border-secondary focus:border-token-accent bg-token-bg-primary w-full rounded border px-3 py-2 text-sm focus:outline-none",onKeyDown:w=>{w.key==="Enter"&&h()}}),b&&e.jsx("p",{className:"text-xs text-red-500",children:b})]})})}const Z=P({newGroupTitle:{id:"workspaceSettings.groups.newGroup",defaultMessage:"New group"},updateNameTitle:{id:"workspaceSettings.groups.updateNameTitle",defaultMessage:"Update group name"}}),Ce=P({bulkAddMembersError:{id:"workspaceSettings.groups.bulkAddMembers.error",defaultMessage:"Unable to add some members to the group."}}),L=1e3;function Ee({group:s,isOpen:t,onClose:a}){const r=C(),d=O(),f=r.formatMessage({id:"workspaceSettings.groups.addMember",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),u=H(),c=J(u),[p,M]=g.useState([]),[b,j]=g.useState(!1);async function x(){var N;const h=c==null?void 0:c.getWorkspaceId();if(!h)throw new Error("No workspace ID found");j(!0);const w=[],S=50;for(let m=0;m<p.length;m+=S)w.push(p.slice(m,m+S));const G=async m=>ee.safePost("/accounts/{account_id}/group/{group_id}/users",{parameters:{path:{account_id:h,group_id:s.id}},requestBody:{email_addresses:m}});try{const v=(await Promise.all(w.map(y=>G(y)))).reduce((y,i)=>y+i.added_group_users.length,0);d.success(r.formatMessage({id:"yU4Zf0",defaultMessage:"Added {numUsers} users to the group"},{numUsers:v})),a==null||a()}catch(m){const v=(N=re(r,m,{targetIsRestrictedSafeModeGroup:V(s)}))!=null?N:r.formatMessage(Ce.bulkAddMembersError);d.danger(v,{duration:3})}finally{j(!1)}}return e.jsxs(T,{testId:"modal-bulk-add-group-members",isOpen:t,onClose:a!=null?a:Y,title:f,type:"success",showCloseButton:!0,primaryButton:e.jsx(_,{onClick:x,disabled:p.length===0||p.length>L,loading:b,children:e.jsx(o,{id:"EpbOzA",defaultMessage:"Add users to group"})}),children:[e.jsx(Pe,{onChange:M}),p.length>L&&e.jsx("div",{className:"text-token-text-error mt-2 text-sm",children:e.jsx(o,{id:"9lp0Tc",defaultMessage:"Email list is limited to {maxEmails} users at once",values:{maxEmails:L}})})]})}function Pe({onChange:s}){const[t,a]=g.useState("");return e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("label",{htmlFor:"group-email-paste",children:[e.jsx(o,{id:"qvGcSC",defaultMessage:"Emails"}),e.jsx("br",{}),e.jsx("span",{className:"text-token-text-tertiary text-sm",children:e.jsx(o,{id:"Fhd+5h",defaultMessage:"Paste email addresses here, one per line:"})})]}),e.jsx(xe,{id:"group-email-paste",className:"h-[250px] text-sm",value:t,onChange:r=>{a(r.target.value),s(Re(r.target.value))},placeholder:"jean@example.com\njoohyun@example.com\nmuhammed@example.com\nsusan@example.com"})]})}function Re(s){return s.split("\n").map(t=>t.trim()).filter(t=>t.length>0).filter(t=>he.test(t))}const Ue=U(()=>R(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zy),__vite__mapDeps([0,1,2,3,4])),{loading:s=>D(s)}),De=U(()=>R(()=>import("./kspsmo2l8jg7uqdj.js"),__vite__mapDeps([5,1])),{loading:s=>D(s)});function Ie({group:s,isOpen:t,onClose:a}){var E;const r=C(),d=O(),f=r.formatMessage({id:"workspaceSettings.addGroupsMembersModal.title",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),u=H(),c=J(u),p=c==null?void 0:c.getWorkspaceId(),[M,b]=g.useState(""),[j,x]=g.useState(0),{data:h,isLoading:w}=fe(p,j*B,M,B,de),[S,G]=g.useState([]),[N,m]=g.useState([]),[v,y]=g.useState("interactive"),i=h?Math.ceil(((E=h.total)!=null?E:0)/B):0;async function A(l){var q;m(k=>[...k,l]);try{await Be(p,s.id,l),G(k=>[...k,l])}catch(k){ue.addError(k);const I=(q=re(r,k,{targetIsRestrictedSafeModeGroup:V(s)}))!=null?q:r.formatMessage(Le.addMemberError);d.danger(I,{duration:3})}finally{m(k=>k.filter(I=>I!==l))}}return v==="batch"?e.jsx(Ee,{group:s,isOpen:t,onClose:a}):e.jsx(T,{testId:"modal-add-group-member",type:"warning",isOpen:t,onClose:a!=null?a:Y,title:f,size:"custom",className:"max-w-(--breakpoint-md)",showCloseButton:!0,primaryButton:e.jsx(_,{onClick:a,children:e.jsx(o,{id:"0NAzDq",defaultMessage:"Done"})}),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{children:f}),e.jsx(_,{onClick:()=>{y("batch")},color:"secondary",children:e.jsx(o,{id:"5GPldp",defaultMessage:"Bulk add users"})})]}),e.jsx(ae,{value:M,inputClassName:"w-full",onChange:l=>{b(l.target.value)}}),e.jsxs(n.Root,{className:"min-w-full",children:[e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{children:e.jsx(o,{id:"workspaceSettings.groups.addMember.name",defaultMessage:"Name"})}),e.jsx(n.HeaderCell,{children:e.jsx(o,{id:"workspaceSettings.groups.addMember.email",defaultMessage:"Email"})}),e.jsx(n.HeaderCell,{})]}),e.jsxs(n.Body,{children:[!h&&w&&e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:3,children:e.jsx(z,{})})}),h==null?void 0:h.items.map(l=>e.jsxs(n.Row,{children:[e.jsx(n.Cell,{children:l.name}),e.jsx(n.Cell,{children:l.email}),e.jsx(n.Cell,{textAlign:"right",className:"pe-1",children:e.jsx(_,{size:"small",color:"secondary",disabled:N.includes(l.id),onClick:()=>{S.includes(l.id)||A(l.id)},icon:S.includes(l.id)?De:Ue,children:S.includes(l.id)?e.jsx(o,{id:"workspaceSettings.groups.addMember.addButton",defaultMessage:"Added"}):e.jsx(o,{id:"workspaceSettings.groups.addMember.addedButton",defaultMessage:"Add"})})})]},l.id))]})]}),e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx(te,{currentPage:j,onChangeIndex:l=>{x(l)},length:i})})]})})}async function Be(s,t,a){await ee.safePatch("/accounts/{account_id}/group/{group_id}",{parameters:{path:{account_id:s,group_id:t}},requestBody:{user_id:a}})}const Le=P({addMemberError:{id:"EnX2ZH",defaultMessage:"Unable to add member to the group."}}),Fe=U(()=>R(()=>import("./dch45l9yrtbjo93p.js"),__vite__mapDeps([6,1])),{loading:s=>D(s)}),Oe=U(()=>R(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zy),__vite__mapDeps([0,1,2,3,4])),{loading:s=>D(s)});function Te({workspaceId:s}){const t=C(),a=le(),r=se(),d=!(r!=null&&r.isAdminOfAccount()||r!=null&&r.isOwnerOfAccount()),f=H(),[u,c]=g.useState(""),p=ye(u,300),M=K(),[b,j]=g.useState(0),{groups:x,isLoading:h,isPlaceholderData:w}=_e({workspaceId:s,currPage:b,groupFilter:p}),[S,G]=g.useState(!1),{data:N}=ke(s,ge(f,"3020999601")),m=i=>{i&&(j(0),c("")),G(i)},{createGroup:v}=Ge({workspaceId:s,currentGroups:x});let y=x?[...x.items]:[];if(N&&x){const i=N.group;if(i){const A=y.filter(({id:E})=>E!==i.id);y=b===0?[i].concat(A):y}}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-6 mb-3 flex flex-row justify-between gap-2",children:[e.jsx(ae,{inputClassName:"w-[250px] rounded-full! text-sm",value:u,onChange:i=>{c(i.target.value),j(0)},placeholder:t.formatMessage({id:"workspaceSettings.groups.search",defaultMessage:"Search group name"})}),!d&&e.jsx(_,{onClick:()=>m(!0),icon:Oe,children:e.jsx(o,{id:"workspaceSettings.groups.create",defaultMessage:"Create group"})})]}),e.jsxs("div",{children:[e.jsxs(n.Root,{className:"min-w-full",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-16"})]}),e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{children:e.jsx(o,{id:"workspaceSettings.groups.groupName",defaultMessage:"Group name"})}),e.jsx(n.HeaderCell,{children:e.jsx(o,{id:"workspaceSettings.groups.members",defaultMessage:"Members"})}),e.jsx(n.HeaderCell,{children:e.jsx(o,{id:"workspaceSettings.groups.created",defaultMessage:"Created"})}),e.jsx(n.HeaderCell,{})]}),e.jsx(n.Body,{className:pe((h||w)&&"opacity-50"),children:x==null?e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:5,textAlign:"center",children:e.jsx(z,{})})}):y.length===0?e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:5,textAlign:"center",children:u===""?e.jsx(o,{id:"workspaceSettings.groups.noGroups",defaultMessage:"No groups found."}):e.jsx(o,{id:"workspaceSettings.groups.noGroupsWithFIlter",defaultMessage:"No groups found. Try changing the search query."})})}):y.map(i=>e.jsx(He,{group:i,workspaceId:s,onAddMember:()=>{a.invalidateQueries({queryKey:[s,"groups"]})},readOnly:d},i.id))})]}),x&&e.jsx("div",{className:"text-center",children:e.jsx(te,{length:Math.ceil(x.total/X),currentPage:Math.min(b,Math.ceil(x.total/X)),onChangeIndex:i=>j(i)})})]}),S&&e.jsx(Ae,{onClose:()=>m(!1),onSave:async i=>{const{id:A}=await v({name:i,workspaceId:s});M("/admin/groups/".concat(A))},placeholder:t.formatMessage({id:"workspaceSettings.groups.placeholder",defaultMessage:"E.g. marketing team"})})]})}function Ke({currentWorkspaceId:s}){var M;const t=C(),a=se();let r=!1;const d=a!=null?je(a.data.role):void 0,f=a!=null?Me(a.data.role):void 0,u=a==null?void 0:a.isEnterprisey(),{data:c,isLoading:p}=me(s);return f||d||!u?r=!0:r=!!((M=c==null?void 0:c.permissions)!=null&&M.includes("chatgpt.workspace.member.role.view")),p?e.jsx("div",{className:"mt-6 flex min-h-[40vh] items-center justify-center",children:e.jsx(z,{})}):r?e.jsxs(e.Fragment,{children:[e.jsx(we,{children:e.jsx("title",{children:t.formatMessage(F.title)})}),e.jsx(be,{title:t.formatMessage(F.title),subtitle:e.jsx(o,{id:"NDDzzF",defaultMessage:"Only workspace admins can edit these settings."})}),e.jsx(Se,{showSpinner:!1,children:e.jsx(Te,{workspaceId:s})})]}):e.jsx("div",{className:"m-6",children:e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-secondary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[e.jsx(Fe,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),e.jsx(o,Q({},F.groupsPagePermissionDenied))]})})}function He({group:s,onAddMember:t,readOnly:a}){const[r,d]=g.useState(!1),f=K(),u=V(s);return e.jsxs(e.Fragment,{children:[e.jsxs(n.Row,{className:"[&>td]:py-2",onClick:()=>f("/admin/groups/".concat(s.id)),children:[e.jsxs(n.Cell,{children:[e.jsx(ve,{group:s}),e.jsx("div",{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.name}),u&&e.jsx(Ne,{})]})})]}),e.jsx(n.Cell,{children:e.jsx(o,{id:"workspaceSettings.groups.memberCount",defaultMessage:"{count} members",values:{count:s.num_members}})}),e.jsx(n.Cell,{children:s.created_time&&e.jsx(ce,{value:s.created_time,year:"numeric",month:"short",day:"numeric"})})]}),r&&!a&&!s.is_scim_managed&&e.jsx(Ie,{isOpen:!0,onClose:()=>{t(s.id),d(!1)},group:s})]})}const F=P({title:{id:"admin.groupsSettings.title",defaultMessage:"Groups"},groupsPagePermissionDenied:{id:"adminPage.groupsPagePermissionDenied",defaultMessage:"You don't have permission to view this groups list."}});export{Ie as A,Ae as U,Ke as W,F as m};
//# sourceMappingURL=jegnfpm112bm1ool.js.map

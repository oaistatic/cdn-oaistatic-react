var h=(o,e)=>(e=Symbol[o])?e:Symbol.for("Symbol."+o);var g=(o,e,r)=>(e=o[h("asyncIterator")])?e.call(o):(o=o[h("iterator")](),e={},r=(i,d)=>(d=o[i])&&(e[i]=n=>new Promise((a,u,m)=>(n=d.call(o,n),m=n.done,Promise.resolve(n.value).then(l=>a({value:l,done:m}),u)))),r("next"),r("return"),e);import{y as E,a9 as F,o as B,d as D,r as c,u as k,j as t}from"./kfrdmkli83ureki3.js";import{u as A,ci as T,i0 as v,fR as H,ek as L,g as y,n as N,T as j,nC as Q,nD as _,m4 as O,fM as $,eZ as q,L as G}from"./kw08ajijqinojrwh.js";import{C as K}from"./omn9nfsnpjwo50x8.js";import{r as V,u as W,s as Z,C as P,a as z,g as J,b as w,T as U,c as X}from"./fyw02vlaiv2vq6cj.js";import{T as Y,C as ee}from"./mjysf44drisu4ssr.js";import{g as te}from"./juhk9bg10nm4p27d.js";import{C as I,T as oe}from"./gp1ys6tmiztz1f16.js";import"./edhlcmww46h398kf.js";import"./drmwaklva7v056il.js";import"./ns51nblw8ziscsgd.js";import"./hytzro4etxb8j4b5.js";import"./bj2o1htuhytjg1ta.js";import"./ce3hgmw4iyyhicud.js";import"./e7j9ia0bu5w3396k.js";import"./byis8e009cwknczn.js";import"./fx4g5niv8hgtkxju.js";import"./mywblj616r9yptxe.js";import"./mstl8wgfzorpgdoe.js";import"./cp40hb6p64z5j02r.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./fxom17ahenhnb7xw.js";import"./deakbbf27g8e7ba0.js";import"./ft1wtuo4ibr3do9l.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./f86yt77iw8uocdb0.js";import"./f538t4a72yr8mvhj.js";import"./cjv4tm2buxt5byw3.js";import"./bmm8s4kivjzbh6zb.js";import"./o9u4h3iqiok9m0a8.js";import"./lfj020w6m7gfm8bo.js";import"./de3ceoxcpky3ng0s.js";import"./gf4c0f98pdaqc94a.js";import"./idxukd613qgy7urm.js";import"./he1xnididjbc7s63.js";import"./i85urdvpkzpdgj3s.js";import"./dd8hh2tmra1psngf.js";import"./irqko7c1s7qpl41n.js";import"./eix6aku103dkp2pu.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./dlgsnq6ip01ej7wa.js";const et=()=>(V(),null),tt=E(function(){const e=A(),r=F(),[i]=B(),d=D(),n=T(r.conversationId),a=v(i.get("readonly"),!1),u=v(i.get("isFullScreen"),!1),m=v(i.get("header"),!0),l=v(i.get("appPreview"),!1),C=H(),S=L(),b=v(i.get("hideBottomComposer"),!!a),f=T(r.canmoreId),s=c.useMemo(()=>y(e,n),[e,n]),p=W();c.useEffect(()=>{Z({type:P.Textdoc,textdocId:f})},[f]),z(s.id,{kind:N.PrimaryAssistant});const x=k();if(c.useEffect(()=>(j.retainThread(s.id),()=>{setTimeout(()=>{x.invalidateQueries(J({clientThreadId:s.id}))},0),j.releaseThread(s.id)}),[s.id,x]),c.useEffect(()=>{f||d("/")},[f,d]),c.useEffect(()=>{w().sendMessage({type:I.Loaded})},[f]),!f||(p==null?void 0:p.type)!==P.Textdoc)return null;const M=()=>{w().sendMessage({type:I.Close})},R=a&&!m;return t.jsxs("div",{className:"h-full w-full overflow-hidden contain-content",children:[t.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}),t.jsx(Q.Provider,{value:y(e,s.id),children:t.jsx(_,{conversation:s,children:t.jsx(O,{conversation:s,children:t.jsx(U,{clientThreadId:s.id,children:l?t.jsx($,{children:t.jsx(se,{textdocId:p.textdocId})}):R?t.jsxs(t.Fragment,{children:[t.jsx(Y,{clientThreadId:s.id,disableScroll:!C,textdocId:p.textdocId}),t.jsx(ee,{})]}):t.jsx(oe,{isEmbedded:!0,hideRunCode:!C,isFullScreen:u,hideHeader:!m,hideBottomComposer:b,isReadonlyFromQueryParam:a,hideRenameButton:S,clientThreadId:s.id,focusedTextdoc:p,onClose:M},"textdocContent")})})})})]})}),se=({textdocId:o})=>{var m;const e=c.useRef(null),r=X(o),[i,d]=c.useState(!1),n=(m=r==null?void 0:r.versions)!=null?m:[],a=q(n),u=c.useCallback(G(async l=>{const C=te(l.type,l.content);if(e.current&&(C==="react"||C==="html")){d(!0);const s=e.current.evalAsync({language:C,code:l.content});try{for(var re=g(s),S,b,f;S=!(b=await re.next()).done;S=!1){const p=b.value;console.debug(p)}}catch(b){f=[b]}finally{try{S&&(b=re.return)&&await b.call(re)}finally{if(f)throw f[0]}}}d(!1)},100),[]);return c.useEffect(()=>{a&&u(a)},[a,u]),t.jsx(K,{id:o,visuallyHidden:!i,ref:e,enableTransition:!0,title:""})};export{et as clientLoader,tt as default};
//# sourceMappingURL=zh67g5fp3jybbsml.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/b65n5l6h7l9qoz7n.js","assets/kfrdmkli83ureki3.js","assets/fyw02vlaiv2vq6cj.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var U=Object.defineProperty,q=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var E=(e,r,t)=>r in e?U(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,v=(e,r)=>{for(var t in r||(r={}))Q.call(r,t)&&E(e,t,r[t]);if(M)for(var t of M(r))X.call(r,t)&&E(e,t,r[t]);return e},R=(e,r)=>q(e,H(r));import{_ as O,h as W,j as o,M as Z,d as Y,r as d,y as tt,a1 as et}from"./kfrdmkli83ureki3.js";import{az as z,aB as rt,kQ as F,cy as ot,aA as nt,r6 as st,u as k,J as at,ie as G,nD as it,br as ct,_ as mt,I as pt,nE as L,T as B,n as dt,eZ as lt}from"./kw08ajijqinojrwh.js";import{m as P}from"./nc6572sivljsjb83.js";import{R as ut}from"./kxbocgn3s27tp480.js";import{lI as ht,lJ as gt,cx as ft,aW as b,aX as A}from"./fyw02vlaiv2vq6cj.js";import{C as K}from"./h1ae971q4xx5gc40.js";import{b as xt}from"./nunatmpame7vjusr.js";import{a as Pt}from"./kxw7q92iph67t48h.js";import{b as kt,g as Tt,T as yt,W as vt,c as bt}from"./cxcgq7fw1eh9yl4l.js";import{u as Ct}from"./ny16i6vydtz4gnvl.js";import{useSetupBaseWhamKeyboardActions as _t}from"./op7sgz1bowo3300n.js";import{k as N,t as jt}from"./oyvo09ze11a90qsd.js";import"./he1xnididjbc7s63.js";import"./i85urdvpkzpdgj3s.js";import"./dd8hh2tmra1psngf.js";import"./mxzgpx7wtm4zk5cj.js";import"./cn1z5fx9l5xxo8vy.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./i8h8r8n4rn16l2h5.js";import"./n6eim64jp78x17ti.js";import"./d24clsve229czwkp.js";import"./ckililxopth81755.js";import"./mj0406dyy526560j.js";import"./n25jb1xrdrimv99m.js";import"./nm285usnll51g0n4.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./moa9hw4knutxpmay.js";import"./nh6x5pasrftsddpw.js";import"./c7lf6x6u521mpx19.js";import"./hk5ml9l4i4ups2ga.js";import"./fwbhrttgqnv5nm9m.js";import"./k68z30a1j9zr4phk.js";import"./emcmoa6z1wsa6qof.js";import"./be1f0w4doetbrndv.js";import"./m93ibzwrrpoc1bdm.js";import"./hrprrmrs14hiemon.js";import"./nvxri8mldbk6o2on.js";import"./eb8h7c171jyixp4q.js";import"./giwakgarsud1rsxv.js";import"./pbjg7z6w7wj6b69y.js";import"./fy52bb9t6zneap2s.js";import"./lafhvalu919ojf7s.js";import"./lptwpbjabrvjmhsj.js";import"./l8r2q1y684enjq2l.js";import"./j3xa7zoduffqfxbm.js";import"./kmtsjg7uv0tesj55.js";import"./gf4c0f98pdaqc94a.js";import"./idxukd613qgy7urm.js";import"./jqc82mvozbbjvbcp.js";import"./et0kjfzq519mr3zi.js";import"./dn55ejno9ewvlhxs.js";import"./edhlcmww46h398kf.js";import"./goxcf7vc701q04ob.js";import"./nc8gen230lb13csi.js";import"./zmq298rl93f7s2hn.js";import"./fux1oumbpb3w9e7e.js";import"./mo4f6niq6474ip4n.js";import"./i6j31imn3cki69v8.js";import"./lrftmyomhnslqldf.js";import"./e96bwg1s7x4og2fp.js";import"./fxythiulbb2q3qno.js";import"./cw8iso7iidphmxgk.js";import"./eix6aku103dkp2pu.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./h1em0bjkpkjv8ykw.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";const wt=z(()=>O(()=>import("./b65n5l6h7l9qoz7n.js"),__vite__mapDeps([0,1])),{loading:e=>nt(e)}),St=({title:e})=>{const t=W().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return o.jsxs("div",{className:"flex justify-between print:hidden",children:[o.jsxs("div",{className:"flex flex-col justify-start",children:[o.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:e}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:o.jsx(Z,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:s=>o.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:s})}})})]}),o.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[o.jsx(wt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),o.jsx(rt,{className:ot("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:F,label:t,children:t})]})]})};function It({postWithProfile:e,title:r,children:t}){return o.jsx(ht.Provider,{value:{postId:e.post.id},children:o.jsx(st,{children:o.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:o.jsxs("div",{className:"mx-auto max-w-3xl",children:[o.jsx("div",{className:"px-2 py-6",children:!!r&&o.jsx(St,{title:r})}),o.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:o.jsxs("div",{className:"p-14 pt-8",children:[o.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:o.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[o.jsx(F,{className:"text-token-text-primary h-8 w-8"}),o.jsx(gt,{})]})}),t]})})]})})})})}function Mt(e){if(e.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const r=e.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn,exampleTaskInfo:r.example_task_info}}function Et({postWithProfile:e}){var S;_t();const r=N(h=>h.addTurnToTaskMap),{task:t,fetchedTurns:s,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:c,exampleTaskInfo:p}=Mt(e),l=k(),i=W(),m=Y(),u=ft.useCurrentImage()!=null,T=at(l,"2818336692"),[x,y]=d.useState([]),C=d.useCallback(()=>{y([])},[]),{focusedAssistantTurn:g,setFocusedAssistantTurnId:_}=kt({taskId:t.id,task:t,currentUserTurn:n!=null?n:null,currentAssistantTurn:a!=null?a:null}),j=d.useMemo(()=>jt(g),[g]),V=d.useMemo(()=>({comments:x,setComments:y,clearComments:C,readonlyComments:j}),[x,y,C,j]),f=N(({getTurnsForTask:h})=>t?h(t.id):[]),w=d.useMemo(()=>{var h;return Tt({focusedAssistantTurn:g,pastTurns:f,currentDiffTaskTurnId:(h=c==null?void 0:c.id)!=null?h:null})},[g,c==null?void 0:c.id,f]),$=d.useMemo(()=>({setFocusedAssistantTurnId:_,focusedAssistantTurn:g,currentDiffTaskTurn:w,taskId:t==null?void 0:t.id,task:t,pastTurns:f,canFollowUp:!1}),[g,w,t,f,_]);return d.useEffect(()=>{var h;Object.values((h=s==null?void 0:s.turn_mapping)!=null?h:{}).forEach(J=>{var I;r((I=t==null?void 0:t.id)!=null?I:"",J.turn)})},[s,r,t]),Ct([{key:"newTask",action:()=>{m("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:A.Chat,keyboardBinding:[b.Mod,b.Shift,"o"]},{key:"closeTask",action:()=>{m("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:A.Chat,keyboardBinding:[b.Escape],enabled:!u}]),!t||!f?null:o.jsx(G.Provider,{value:{postWithProfile:e,setIsReportModalOpen:()=>{}},children:o.jsx(it,{children:o.jsx(yt,{value:V,children:o.jsx(vt,{value:$,children:o.jsx(bt,{permissions:"read",turnId:(S=a==null?void 0:a.id)!=null?S:"",showForkButton:T,loadingTurnMapping:!1,isSharedExampleTask:!!p})})})})})}const Rt=z(()=>O(()=>import("./fyw02vlaiv2vq6cj.js").then(e=>e.zJ),__vite__mapDeps([2,1,3,4,5])).then(e=>e.PostSharingErrorModal)),sr=tt(function(){const r=et();return r.kind==="forbidden"?o.jsx(Wt,{chatPageProps:r.chatPageProps,reason:"workspace"}):o.jsx(At,{loaderData:r})});function At({loaderData:e}){var a,c,p,l;const r=k();d.useEffect(()=>{var i,m;mt.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:e.postWithProfile.post.id,primary_attachment_type:(m=(i=e.postWithProfile.post.attachments)==null?void 0:i[0])==null?void 0:m.kind,referrer:e.referrer})},[e]);const{session:t}=pt(r),s=d.useMemo(()=>{var m,u;const i=L(r);return B.initThread({clientThreadId:i.id,conversationMode:{kind:dt.PrimaryAssistant},userId:(m=t==null?void 0:t.user)==null?void 0:m.id,accountId:(u=t==null?void 0:t.account)==null?void 0:u.id}),i},[r,(a=t==null?void 0:t.account)==null?void 0:a.id,(c=t==null?void 0:t.user)==null?void 0:c.id]),n=(p=e.postWithProfile.post.attachments)==null?void 0:p[0];if(n.kind==="deep_research"){const i=n.messages,m=lt(i),u=(l=m==null?void 0:m.metadata)==null?void 0:l.async_task_title;return m?o.jsx(It,{postWithProfile:e.postWithProfile,title:u,children:o.jsx(ut,{messages:i,conversation:s})}):null}return n.kind==="codex"?o.jsx(Et,{postWithProfile:e.postWithProfile}):o.jsx(zt,{postWithProfile:e.postWithProfile,chatPageProps:e.chatPageProps})}function D(e){return{url:"https://ogimg.chatgpt.com/?postId=".concat(e),size:[1200,630]}}function Nt(e,r){var s,n,a,c,p,l,i;if(!e.attachments||e.attachments.length===0)return{url:P.src};const t=e.attachments[0];switch(t.kind){case"media_generation":{const m=(n=(s=t.encodings)==null?void 0:s.md)!=null&&n.path?{url:t.encodings.md.path,size:[t.width,t.height]}:void 0,u=(c=(a=t.encodings)==null?void 0:a.unfurl)!=null&&c.path?{url:t.encodings.unfurl.path,size:[1200,630]}:void 0,T=(l=(p=t.encodings)==null?void 0:p.thumbnail)!=null&&l.path?{url:t.encodings.thumbnail.path}:void 0,x={url:t.url,size:[t.width,t.height]};return r&&m!=null?m:(i=u!=null?u:T)!=null?i:x}case"message_slice":return D(e.id);default:return{url:P.src}}}function Ot(e){var s,n,a;const r=(s=e.text)==null?void 0:s.trim();if(r)return r;const t=(n=e.attachments)==null?void 0:n[0];return(t==null?void 0:t.kind)==="media_generation"&&((a=t.title)!=null&&a.trim())?t.title.trim():"Shared Content"}const ar=({data:e})=>{const r=e,t={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:P.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:P.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:s}=r.postWithProfile,n=r.enforceRenderedOgImg?D(s.id):Nt(s,r.preferIntrinsicAspectRatioForOgImage),a=Ot(s),c=s.permalink,p=new Date(s.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:p},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function Wt({chatPageProps:e,reason:r}){const t=k();return d.useEffect(()=>{ct(t,Rt,{reason:r})},[]),o.jsx(K,v({},e))}function zt({postWithProfile:e,chatPageProps:r}){const t=k(),[s,n]=d.useState(!1),[a]=d.useState(()=>L(t)),c=a.id,p=Pt(e.post.attachments);if(p){const{threadResponse:l}=p;B.updateThreadFromServer(c,l,{skipIfExisting:!0,continuingFromSharedPostId:e.post.id,forkFromSharedPost:!0})}return o.jsxs(G.Provider,{value:{postWithProfile:e,setIsReportModalOpen:n},children:[s&&o.jsx(xt,{post:e.post,onClose:()=>n(!1)}),o.jsx(K,R(v({},r),{clientThreadId:c}))]})}export{sr as default,ar as meta};
//# sourceMappingURL=nx5gu0l203j7313b.js.map

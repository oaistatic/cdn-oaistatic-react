const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/dr1v3i80rkhviakg.js","assets/nz44s7ebe5b6pll5.js","assets/jqy8zfwhk6ptqvmj.js","assets/mv59uia51hlqeiwb.js"])))=>i.map(i=>d[i]);
var Rs=Object.defineProperty,As=Object.defineProperties;var Ps=Object.getOwnPropertyDescriptors;var Wt=Object.getOwnPropertySymbols;var Ls=Object.prototype.hasOwnProperty,Es=Object.prototype.propertyIsEnumerable;var Gt=(t,e,a)=>e in t?Rs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,$=(t,e)=>{for(var a in e||(e={}))Ls.call(e,a)&&Gt(t,a,e[a]);if(Wt)for(var a of Wt(e))Es.call(e,a)&&Gt(t,a,e[a]);return t},le=(t,e)=>As(t,Ps(e));import{b as ts,r as L,j as s,M as g,h as ne,a as He,d as qe,c as ie,e as lt,_ as xe,ao as ct,L as Ct,ap as Is,F as Fs,u as Ts,t as Os,g as $s,y as Ds}from"./kfrdmkli83ureki3.js";import{A as Bs,a as Hs,b as zs}from"./dy2d092duzrccyw9.js";import{h as Rt,i as mt,j as Vs,E as Te,r as vt,b as Us,e as At,k as ss,l as Ws,n as as,o as ut,q as ft,t as ht,v as rs,a as xt,F as pt,S as ls,A as ns,w as _t,x as Gs,g as qs}from"./cg9zyx3f2s9b21n8.js";import{W as Pt,b7 as gt,aB as he,p as nt,dT as Lt,dk as is,cy as G,gA as Qs,az as pe,aA as ge,e6 as bt,fd as Ks,eG as Mt,cq as os,u as it,al as Et,cB as ds,pK as cs,i1 as ms,dZ as us,vP as Ys,h7 as Xs,e9 as Js,iE as Zs,ih as ea,nD as ta}from"./kw08ajijqinojrwh.js";import{i as sa,W as aa}from"./zmq298rl93f7s2hn.js";import{y as ra,b_ as la,hb as fs,hc as hs,B as xs,E as ps,a$ as E,bp as qt,J as Be,x as gs,lH as na,qG as ia}from"./fyw02vlaiv2vq6cj.js";import{k as oa,x as da,W as ca}from"./oyvo09ze11a90qsd.js";import{b as ma}from"./mj0406dyy526560j.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./dd8hh2tmra1psngf.js";import"./l58qw9nc0ur9qkul.js";import"./fbnp4n11buhgth4v.js";import"./fux1oumbpb3w9e7e.js";import"./mo4f6niq6474ip4n.js";import"./ny16i6vydtz4gnvl.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./h1em0bjkpkjv8ykw.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";import"./n25jb1xrdrimv99m.js";import"./nm285usnll51g0n4.js";import"./moa9hw4knutxpmay.js";import"./nh6x5pasrftsddpw.js";import"./c7lf6x6u521mpx19.js";import"./hk5ml9l4i4ups2ga.js";import"./fwbhrttgqnv5nm9m.js";function yt(t){const{data:e,isLoading:a,refetch:r,isFetching:l,error:n}=ts({queryKey:["aardvark","scan-configs",t!=null?t:"personal"],enabled:!0,queryFn:async()=>{var f,i;const m=new Rt(Pt),x={limit:1e3},b=await m.get("/aardvark/scan_configurations",{headers:gt(),query:x});if(b.status!==200)throw mt(b.status,b.data);return(i=(f=b.data.items)==null?void 0:f.map(d=>{var u;return le($({},d),{lookback_days:(u=d.lookback_days)!=null?u:null})}))!=null?i:[]},refetchOnWindowFocus:!0}),{scanMap:o,configIdByRepo:c,configVersionById:h}=L.useMemo(()=>{const m=new Map,x=new Map,b=new Map;for(const f of e!=null?e:[])x.set(f.repo_id,f.id),b.set(f.id,f.version),m.set(f.repo_id,f);return{scanMap:m,configIdByRepo:x,configVersionById:b}},[e]);return{scanMap:o,configIdByRepo:c,configVersionById:h,isLoading:a||l,refetch:r,error:n}}function Qt(t,e,a){const r=["aardvark","scan-configs",t!=null?t:"personal"];a.setQueryData(r,l=>{const n=Array.isArray(l)?[...l]:[],o=Vs(n,c=>c.id===e.id);return o>=0?n[o]=e:n.push(e),n})}function vs({error:t=!1,handleOpenGithubModal:e}={}){const a=L.useMemo(()=>t?s.jsx("div",{className:"bg-token-danger-muted text-token-text-secondary mt-4 rounded-md px-3 py-2 text-sm",role:"alert",children:s.jsx(g,$({},Te.githubConnectionInline))}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"mt-4 flex items-center justify-center",children:s.jsx(he,{as:"button",size:"small",color:"secondary",onClick:e,children:s.jsx(g,{id:"aardvark.whamRepos.connectGithub",defaultMessage:"Connect GitHub"})})})}),[t,e]);return s.jsxs("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mx-auto mt-6 w-full max-w-[640px] rounded-lg border px-5 py-6 text-center shadow-sm backdrop-blur-[2px]",children:[s.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.home.connectGithub.title",defaultMessage:"Connect GitHub to start scanning repositories with Aardvark."})}),a]})}function Ge(t,e){const r=new URLSearchParams(t).get(e);return!r||r.trim()===""?[]:r.split(",").map(l=>l.trim()).filter(Boolean)}function ua(){const t=He(),e=qe(),a=Lt(),r=is(),l=r==null?void 0:r.email,n=a==null?void 0:a.getWorkspaceId(),{isLoading:o,scanMap:c,error:h}=yt(n),{repoOptions:m,repoScanIdMap:x}=L.useMemo(()=>{var p,y;const i=new Map,d=new Map;for(const v of c.values()){const k=String((p=v.repo_url)!=null?p:"").trim();if(!k)continue;i.set(k,vt(k)||k);const w=String((y=v.id)!=null?y:"").trim();w&&d.set(k,w)}const u=Array.from(i.entries()).map(([v,M])=>({value:v,label:M}));return u.sort((v,M)=>v.label.localeCompare(M.label)),{repoOptions:u,repoScanIdMap:d}},[c]);return L.useEffect(()=>{var u;const i=new URLSearchParams(t.search);if(!t.search||t.search===""||t.search==="?"){if(o)return;i.has("recommended")||i.set("recommended","true");const y=sa([],m.map(v=>v.value));!i.has("repo")&&y.length>0&&i.set("repo",y.join(",")),i.set("sort",(u=i.get("sort"))!=null?u:"sev_desc"),e({search:"?".concat(i.toString())},{replace:!0})}},[t.search,e,l,m,o]),L.useEffect(()=>{var k,w;if(o||m.length===0)return;const i=new URLSearchParams(t.search);if(!(i.get("recommended")==="true"))return;const u=(k=m[0])==null?void 0:k.value;if(!u)return;const p=(w=i.get("repo"))!=null?w:"",y=p.split(",").map(S=>S.trim()).filter(Boolean);let v=y.length>0?y[0]:u;m.some(S=>S.value===v)||(v=u),(y.length!==1||y[0]!==v||p!==v)&&(i.set("repo",v),e({search:"?".concat(i.toString())},{replace:!0}))},[t.search,e,m,o]),{filters:L.useMemo(()=>{var Y,me;const i=new URLSearchParams(t.search),d=new Set(Ge(t.search,"status")),u=new Set(Ge(t.search,"criticality")),p=Ge(t.search,"repo"),y=Ge(t.search,"assignee"),v=Ge(t.search,"path_prefix"),M=(me=(Y=i.get("q"))==null?void 0:Y.trim())!=null?me:"",k=i.get("validated"),w=i.get("has_patch"),S=k==="true"?"validated":k==="false"?"unvalidated":"all",C=w==="true"?"with_patch":w==="false"?"without_patch":"all",_=i.get("recommended")==="true",j=new Set(Array.from(d)),N=new Set(Array.from(u)),P=new Set(p),R=P.size===1?Array.from(P)[0]:"all",A=new Set(y),O=Ge(t.search,"author"),U=new Set(O),z=new Set(v);return{selectedCriticalities:N,securityOnly:!1,privacyOnly:!1,selectedStatuses:j,selectedRepo:R,selectedRepos:P,selectedPathPrefixes:z,keywordQuery:M,recommendedOnly:_,existsInHeadOnly:!1,validationFilter:S,patchFilter:C,selectedAssignees:A,selectedAuthors:U}},[t.search]),onChangeFilters:i=>{const d=new URLSearchParams(t.search),u=i;u.recommendedOnly?d.set("recommended","true"):d.delete("recommended"),u.selectedRepos&&u.selectedRepos.size>0?d.set("repo",Array.from(u.selectedRepos).join(",")):d.delete("repo"),u.selectedCriticalities&&u.selectedCriticalities.size>0?d.set("criticality",Array.from(u.selectedCriticalities).join(",")):d.delete("criticality"),u.selectedStatuses&&u.selectedStatuses.size>0?d.set("status",Array.from(u.selectedStatuses).join(",")):d.delete("status"),u.validationFilter==="validated"?d.set("validated","true"):u.validationFilter==="unvalidated"?d.set("validated","false"):d.delete("validated"),u.patchFilter==="with_patch"?d.set("has_patch","true"):u.patchFilter==="without_patch"?d.set("has_patch","false"):d.delete("has_patch"),u.selectedAssignees&&u.selectedAssignees.size>0?d.set("assignee",Array.from(u.selectedAssignees).join(",")):d.delete("assignee"),u.selectedAuthors&&u.selectedAuthors.size>0?d.set("author",Array.from(u.selectedAuthors).join(",")):d.delete("author"),u.selectedPathPrefixes&&u.selectedPathPrefixes.size>0?d.set("path_prefix",Array.from(u.selectedPathPrefixes).join(",")):d.delete("path_prefix");const p=u.keywordQuery.trim();p?d.set("q",p):d.delete("q"),e({search:"?".concat(d.toString())},{replace:!0})},repoOptions:m,repoOptionsLoading:o,repoScanIdMap:x,repoOptionsError:h}}const bs=L.createContext(null);function fa({children:t}){const{filters:e,onChangeFilters:a,repoOptions:r,repoOptionsLoading:l,repoScanIdMap:n,repoOptionsError:o}=ua(),c=nt(),h=ne();return L.useEffect(()=>{if(!o)return;const m=h.formatMessage(Te.scanConfigLoad,{details:o.message});c.danger(m)},[h,o,c]),s.jsx(bs.Provider,{value:{filters:e,onChangeFilters:a,repoOptions:r,repoOptionsLoading:l,repoScanIdMap:n,repoOptionsError:o},children:t})}function ot(){const t=L.useContext(bs);if(!t)throw new Error("useAardvarkFiltersContext must be used within AardvarkFiltersProvider");return t}const ha=t=>{const e=t.split(/[\n,]/g).map(a=>a.trim()).filter(Boolean);return Array.from(new Set(e)).join("\n")};function xa({intl:t,label:e,placeholder:a,helper:r,clearMessage:l,value:n,onChange:o}){const[c,h]=L.useState(n),m=L.useRef(n);L.useEffect(()=>{n!==m.current&&(m.current=n,h(n))},[n]);const x=f=>{const i=f.target.value;h(i);const d=ha(i);m.current=d,o(d)},b=()=>{m.current="",h(""),o("")};return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:t.formatMessage(e)}),s.jsx("textarea",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong min-h-[96px] rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c,onChange:x,placeholder:t.formatMessage(a)}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-token-text-tertiary text-xs",children:t.formatMessage(r)}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:b,children:t.formatMessage(l)})]})]})}function pa({intl:t,label:e,options:a,selectedValues:r,onToggle:l}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"text-token-text-secondary text-sm font-medium",children:t.formatMessage(e)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(n=>{const o=r.has(n.value);return s.jsxs("label",{className:G("flex cursor-pointer items-center justify-between px-3 py-2 text-sm transition-colors",o?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsx("span",{className:"flex items-center gap-3",children:n.label}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:o,onChange:()=>l(n.value)})]},n.value)})})]})}function ga(t,e,a=50,r=!0){const l=String(e!=null?e:"").trim(),n=Math.max(1,Math.min(a,500));return ts({queryKey:["aardvark","authors",t||null,l||null,n],queryFn:async()=>{const o=new Rt(Pt),c={limit:String(n)};t&&t.size>0&&(c.repo=Array.from(t).join(",")),l&&(c.q=l);const h=await o.get("/aardvark/scan-findings/list-authors",{headers:gt(),query:c});if(h.status!==200)throw mt(h.status,h.data);return h.data},staleTime:3e4,refetchOnWindowFocus:!0,enabled:r})}function va({intl:t,label:e,placeholder:a,loadingMessage:r,emptyMessage:l,clearMessage:n,fieldState:o}){const c=o;return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:t.formatMessage(e)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c.query,onChange:h=>c.setQuery(h.target.value),placeholder:t.formatMessage(a)}),s.jsx("div",{className:"border-token-border-light max-h-48 overflow-y-auto rounded-md border",children:c.isLoading?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:t.formatMessage(r)}):c.options.length===0?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:t.formatMessage(l)}):c.options.map(({email:h,label:m,subtitle:x})=>s.jsxs("label",{className:G("border-token-border-subtle flex cursor-pointer items-center justify-between gap-2 border-b px-3 py-2 text-sm last:border-b-0",c.selection.has(h)?"bg-token-main-surface-secondary/60 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col",children:[s.jsx("span",{children:m||h}),x?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:x}):null]}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:c.selection.has(h),onChange:()=>c.toggle(h)})]},h))}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:c.clear,children:t.formatMessage(n)})})]})}const Kt=t=>(t!=null?t:"").trim().toLowerCase(),ba=(t,e)=>{const a=e.trim().toLowerCase();return a?t.filter(({label:r,email:l,subtitle:n})=>"".concat(r," ").concat(l," ").concat(n!=null?n:"").toLowerCase().includes(a)):t};function ys({ctx:t,factory:e,items:a,isFetching:r}){var h;const l=is(),n=(h=l==null?void 0:l.email)!=null?h:"",o=Kt(n);return{options:L.useMemo(()=>{const m=[];n&&e.selfOptionMessage&&m.push({email:n,label:t.intl.formatMessage(e.selfOptionMessage),subtitle:n});const x=Qs(Us(a.map(b=>{var u,p;const f=(u=b.email)!=null?u:void 0,i=Kt(f);if(!f||!i||i===o)return null;const d=(p=b.name)!=null?p:void 0;return{email:f,label:d||f,subtitle:d?f:void 0,_norm:i}}),Boolean),"_norm");return m.push(...x),m},[t.intl,e.selfOptionMessage,a,n,o]),isLoading:r}}const ya=(t,e,a)=>{var n;const{data:r,isFetching:l}=ga(t.filters.selectedRepos,e,100,!0);return ys({ctx:t,factory:a,items:(n=r==null?void 0:r.items)!=null?n:[],isFetching:l})},ka=(t,e,a)=>{var n,o;const{data:r,isFetching:l}=ra((n=t.workspaceId)!=null?n:void 0,0,e,100);return ys({ctx:t,factory:a,items:(o=r==null?void 0:r.items)!=null?o:[],isFetching:l})};function ja({section:t,ctx:e}){const[a,r]=L.useState(""),l=la(a,300),{options:n,isLoading:o}=t.useOptionsHook(e,l,t),c={query:a,setQuery:r,options:ba(n,a),isLoading:o,clear:()=>e.setField(t.field,new Set),selection:e.draft[t.field],toggle:h=>e.toggleSetValue(t.field,h)};return s.jsx(va,{intl:e.intl,label:t.label,placeholder:t.placeholder,loadingMessage:t.loadingMessage,emptyMessage:t.emptyMessage,clearMessage:t.clearMessage,fieldState:c})}function wa({intl:t,label:e,options:a,selectedValue:r,onSelect:l}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:t.formatMessage(e)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(n=>{const o=r===n.value;return s.jsxs("label",{className:G("flex cursor-pointer items-center justify-between gap-3 px-3 py-2 text-sm transition-colors",o?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"font-medium",children:s.jsx(g,$({},n.label))}),n.helper?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.formatMessage(n.helper)}):null]}),s.jsx("span",{className:G("flex h-4 w-4 shrink-0 items-center justify-center rounded-full border-2",o?"border-token-text-primary bg-token-text-primary":"border-token-border-light bg-transparent"),"aria-hidden":!0,children:o?s.jsx("span",{className:"bg-token-bg-primary block h-2 w-2 rounded-full"}):null}),s.jsx("input",{type:"radio",className:"sr-only",checked:o,onChange:()=>l(n.value)})]},n.value)})})]})}function Ma({intl:t,label:e,placeholder:a,helper:r,value:l,onChange:n}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:t.formatMessage(e)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:l,onChange:o=>n(o.target.value),placeholder:t.formatMessage(a)}),s.jsx("p",{className:"text-token-text-tertiary text-xs",children:t.formatMessage(r)})]})}const kt="text",jt="comma-text",st="multiselect",at="singleselect",rt="searchable-multiselect",Na=t=>Array.from(t).join("\n");function Sa(t,e){switch(t.kind){case kt:return e[t.field].trim().length>0;case jt:case rt:case st:return e[t.field].size>0;case at:return t.inactiveValue!==void 0?e[t.field]!==t.inactiveValue:!0;default:return!1}}function _a(t,e,a){switch(t.kind){case kt:{const r=e[t.field].trim();return r?r.length>24?"".concat(r.slice(0,24),"…"):r:null}case jt:case rt:case st:{const r=e[t.field].size;return r===0?null:a.formatMessage(t.summaryMessage,{count:r})}case at:{const r=t.options.find(l=>l.value===e[t.field]);return r?a.formatMessage(r.label):null}default:return null}}function Ca(t){"use forget";const e=ie.c(44),{section:a,ctx:r}=t;switch(a.kind){case kt:{const l=r.draft[a.field];let n;e[0]!==r||e[1]!==a.field?(n=c=>r.setField(a.field,c),e[0]=r,e[1]=a.field,e[2]=n):n=e[2];let o;return e[3]!==r.intl||e[4]!==a.helper||e[5]!==a.label||e[6]!==a.placeholder||e[7]!==l||e[8]!==n?(o=s.jsx(Ma,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,value:l,onChange:n}),e[3]=r.intl,e[4]=a.helper,e[5]=a.label,e[6]=a.placeholder,e[7]=l,e[8]=n,e[9]=o):o=e[9],o}case jt:{const l=r.draft[a.field];let n;e[10]!==l?(n=Na(l),e[10]=l,e[11]=n):n=e[11];const o=n;let c;e[12]!==r||e[13]!==a.field?(c=m=>{const x=m?m.split("\n"):[];r.setField(a.field,new Set(x))},e[12]=r,e[13]=a.field,e[14]=c):c=e[14];let h;return e[15]!==r.intl||e[16]!==o||e[17]!==a.clearMessage||e[18]!==a.helper||e[19]!==a.label||e[20]!==a.placeholder||e[21]!==c?(h=s.jsx(xa,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,clearMessage:a.clearMessage,value:o,onChange:c}),e[15]=r.intl,e[16]=o,e[17]=a.clearMessage,e[18]=a.helper,e[19]=a.label,e[20]=a.placeholder,e[21]=c,e[22]=h):h=e[22],h}case rt:{let l;return e[23]!==r||e[24]!==a?(l=s.jsx(ja,{section:a,ctx:r}),e[23]=r,e[24]=a,e[25]=l):l=e[25],l}case st:{const l=r.draft[a.field];let n;e[26]!==r||e[27]!==a.field?(n=c=>{r.toggleSetValue(a.field,c)},e[26]=r,e[27]=a.field,e[28]=n):n=e[28];let o;return e[29]!==r.intl||e[30]!==a.label||e[31]!==a.options||e[32]!==l||e[33]!==n?(o=s.jsx(pa,{intl:r.intl,label:a.label,options:a.options,selectedValues:l,onToggle:n}),e[29]=r.intl,e[30]=a.label,e[31]=a.options,e[32]=l,e[33]=n,e[34]=o):o=e[34],o}case at:{const l=r.draft[a.field];let n;e[35]!==r||e[36]!==a.field?(n=c=>r.setField(a.field,c),e[35]=r,e[36]=a.field,e[37]=n):n=e[37];let o;return e[38]!==r.intl||e[39]!==a.label||e[40]!==a.options||e[41]!==l||e[42]!==n?(o=s.jsx(wa,{intl:r.intl,label:a.label,options:a.options,selectedValue:l,onSelect:n}),e[38]=r.intl,e[39]=a.label,e[40]=a.options,e[41]=l,e[42]=n,e[43]=o):o=e[43],o}default:return null}}const Ra=["new","triaged","in_progress","fixed","wontfix","duplicate"],Aa=["critical","high","medium","low"],Pa=["all","validated","unvalidated"],La=["all","with_patch","without_patch"],T=lt({keywordLabel:{id:"aardvark.filtersPopover.keyword",defaultMessage:"Keyword"},keywordHint:{id:"aardvark.filtersPopover.keyword.hint",defaultMessage:"Matches title, summary, vulnerability text, and analysis details."},keywordPlaceholder:{id:"aardvark.filtersPopover.keyword.placeholder",defaultMessage:"Search vulnerability details…"},navSearchPlaceholder:{id:"aardvark.filtersPopover.nav.search",defaultMessage:"Search filters"},navEmpty:{id:"aardvark.filtersPopover.nav.empty",defaultMessage:"No filters match your search."},navPlaceholder:{id:"aardvark.filtersPopover.nav.placeholder",defaultMessage:"Select a filter from the list to configure it."},directoriesLabel:{id:"aardvark.filtersPopover.directories",defaultMessage:"Directories"},directoriesHint:{id:"aardvark.filtersPopover.directories.hint",defaultMessage:"Separate prefixes with commas or new lines and prefix a value with ! to exclude it. Example: services/auth/, !web/app/"},directoriesPlaceholder:{id:"aardvark.filtersPopover.directories.placeholder",defaultMessage:"services/auth/, web/app/, shared/utils/"},pathsSummary:{id:"aardvark.filtersPopover.directories.summary",defaultMessage:"{count} paths"},clearDirectories:{id:"aardvark.filtersPopover.directories.clear",defaultMessage:"Clear directories"},authorsLabel:{id:"aardvark.filtersPopover.authors",defaultMessage:"Authors"},authorsPlaceholder:{id:"aardvark.filtersPopover.authors.placeholder",defaultMessage:"Search by author email…"},authorsLoading:{id:"aardvark.filtersPopover.authors.loading",defaultMessage:"Loading authors…"},authorsEmpty:{id:"aardvark.filtersPopover.authors.empty",defaultMessage:"No matching authors"},clearAuthors:{id:"aardvark.filtersPopover.authors.clear",defaultMessage:"Clear authors"},authoredByMe:{id:"aardvark.filtersPopover.authors.me",defaultMessage:"Authored by me"},assigneesLabel:{id:"aardvark.filtersPopover.assignees",defaultMessage:"Assignees"},assigneePlaceholder:{id:"aardvark.filtersPopover.assignees.placeholder",defaultMessage:"Search assignees…"},assigneesLoading:{id:"aardvark.filtersPopover.assignees.loading",defaultMessage:"Loading assignees…"},assigneesEmpty:{id:"aardvark.filtersPopover.assignees.empty",defaultMessage:"No matching assignees"},countSummary:{id:"aardvark.filtersPopover.countSummary",defaultMessage:"{count} selected"},clearAssignees:{id:"aardvark.filtersPopover.assignees.clear",defaultMessage:"Clear assignees"},assignedToMe:{id:"aardvark.filtersPopover.assignees.me",defaultMessage:"Assigned to me"},criticalityLabel:{id:"aardvark.filtersPopover.criticality",defaultMessage:"Criticality"},statusLabel:{id:"aardvark.filtersPopover.status",defaultMessage:"Status"},validationLabel:{id:"aardvark.filtersPopover.validation",defaultMessage:"Validation"},validationValidatedDetail:{id:"aardvark.filtersPopover.validation.validated.detail",defaultMessage:"Aardvark was able to trigger the exploit in an isolated sandbox to confirm it’s real."},patchLabel:{id:"aardvark.filtersPopover.patch",defaultMessage:"Patch availability"},patchGeneratedDetail:{id:"aardvark.filtersPopover.patch.generated.detail",defaultMessage:"Shows only findings where Aardvark successfully generated a proposed patch for review."},patchAllOption:{id:"aardvark.filtersPopover.patch.all",defaultMessage:"All findings"},patchWithOption:{id:"aardvark.filtersPopover.patch.with",defaultMessage:"Patch generated"},patchWithoutOption:{id:"aardvark.filtersPopover.patch.without",defaultMessage:"No patch yet"},applyButton:{id:"aardvark.filtersPopover.apply",defaultMessage:"Apply filters"},cancelButton:{id:"aardvark.filtersPopover.cancel",defaultMessage:"Cancel"},clearFiltersButton:{id:"aardvark.filtersPopover.clear",defaultMessage:"Clear filters"}}),Ea={all:{id:"aardvark.filtersPopover.validation.all",defaultMessage:"All findings",description:"Radio label that keeps the validation filter unset so all findings appear."},validated:{id:"aardvark.filtersPopover.validation.validated",defaultMessage:"Validated only",description:"Radio label that filters the list to validated findings only."},unvalidated:{id:"aardvark.filtersPopover.validation.unvalidated",defaultMessage:"Unvalidated only",description:"Radio label that filters the list to unvalidated findings only."}},Ia={all:T.patchAllOption,with_patch:T.patchWithOption,without_patch:T.patchWithoutOption},Nt=[{kind:kt,id:"keyword",label:T.keywordLabel,field:"keywordQuery",placeholder:T.keywordPlaceholder,helper:T.keywordHint},{kind:jt,id:"directories",label:T.directoriesLabel,field:"selectedPathPrefixes",placeholder:T.directoriesPlaceholder,helper:T.directoriesHint,clearMessage:T.clearDirectories,summaryMessage:T.pathsSummary},{kind:rt,id:"authors",label:T.authorsLabel,field:"selectedAuthors",placeholder:T.authorsPlaceholder,loadingMessage:T.authorsLoading,emptyMessage:T.authorsEmpty,clearMessage:T.clearAuthors,selfOptionMessage:T.authoredByMe,useOptionsHook:ya,summaryMessage:T.countSummary},{kind:rt,id:"assignees",label:T.assigneesLabel,field:"selectedAssignees",placeholder:T.assigneePlaceholder,loadingMessage:T.assigneesLoading,emptyMessage:T.assigneesEmpty,clearMessage:T.clearAssignees,selfOptionMessage:T.assignedToMe,useOptionsHook:ka,summaryMessage:T.countSummary},{kind:st,id:"criticalities",label:T.criticalityLabel,field:"selectedCriticalities",options:Aa.map(t=>({value:t,label:s.jsx(At,{level:t})})),summaryMessage:T.countSummary},{kind:st,id:"statuses",label:T.statusLabel,field:"selectedStatuses",options:Ra.map(t=>({value:t,label:s.jsx(g,$({},ss[t]))})),summaryMessage:T.countSummary},{kind:at,id:"validation",label:T.validationLabel,field:"validationFilter",options:Pa.map(t=>({value:t,label:Ea[t],helper:t==="validated"?T.validationValidatedDetail:void 0})),inactiveValue:"all"},{kind:at,id:"patches",label:T.patchLabel,field:"patchFilter",options:La.map(t=>({value:t,label:Ia[t],helper:t==="with_patch"?T.patchGeneratedDetail:void 0})),inactiveValue:"all"}];function Fa({isOpen:t,onClose:e}){var C,_;const a=ne(),{filters:r,onChangeFilters:l}=ot(),n=Lt(),o=n==null?void 0:n.getWorkspaceId(),c=L.useCallback(()=>{var j,N;return{keywordQuery:(j=r.keywordQuery)!=null?j:"",selectedPathPrefixes:new Set((N=r.selectedPathPrefixes)!=null?N:[]),selectedAuthors:new Set(r.selectedAuthors),selectedAssignees:new Set(r.selectedAssignees),selectedStatuses:new Set(r.selectedStatuses),selectedCriticalities:new Set(r.selectedCriticalities),validationFilter:r.validationFilter,patchFilter:r.patchFilter}},[r]),h=L.useCallback(()=>({keywordQuery:"",selectedPathPrefixes:new Set,selectedAuthors:new Set,selectedAssignees:new Set,selectedStatuses:new Set,selectedCriticalities:new Set,validationFilter:"all",patchFilter:"all"}),[]),[m,x]=L.useState(c),[b,f]=L.useState(""),[i,d]=L.useState((_=(C=Nt[0])==null?void 0:C.id)!=null?_:"");L.useEffect(()=>{t&&(x(c()),f(""))},[c,t]);const u=L.useMemo(()=>{const j=b.trim().toLowerCase();return j?Nt.filter(N=>a.formatMessage(N.label).toLowerCase().includes(j)):Nt},[a,b]);L.useEffect(()=>{var j,N;if(u.length===0){i!==""&&d("");return}u.some(P=>P.id===i)||d((N=(j=u[0])==null?void 0:j.id)!=null?N:"")},[u,i]);const p=L.useMemo(()=>{var j,N;return(N=(j=u.find(P=>P.id===i))!=null?j:u[0])!=null?N:null},[u,i]),y=L.useCallback((j,N)=>{x(P=>le($({},P),{[j]:N}))},[]),v=L.useCallback((j,N)=>{x(P=>{const R=new Set(P[j]);return R.has(N)?R.delete(N):R.add(N),le($({},P),{[j]:R})})},[]),M=()=>{l($($({},r),m)),e()},k=()=>{x(c()),f(""),e()},w=()=>{x(h())},S={draft:m,filters:r,workspaceId:o,setField:y,toggleSetValue:v,intl:a};return s.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:[s.jsxs("div",{className:"border-token-border-subtle w-full shrink-0 border-b pe-0 pb-2 md:w-60 md:border-e md:border-b-0 md:pe-3 md:pb-0",children:[s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong mb-2 w-full rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:b,onChange:j=>f(j.target.value),placeholder:a.formatMessage(T.navSearchPlaceholder),"aria-label":a.formatMessage(T.navSearchPlaceholder)}),s.jsx("div",{className:"flex max-h-[420px] flex-col gap-1 overflow-y-auto pe-1",children:u.length===0?s.jsx("div",{className:"text-token-text-tertiary rounded-md px-3 py-4 text-xs",children:a.formatMessage(T.navEmpty)}):u.map(j=>{const N=a.formatMessage(j.label),P=j.id===(p==null?void 0:p.id),R=_a(j,m,a),A=Sa(j,m);return s.jsx("button",{type:"button",className:G("text-token-text-secondary flex flex-col rounded-md px-3 py-2 text-start text-sm transition-colors",P?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"hover:bg-token-bg-secondary"),onClick:()=>d(j.id),children:s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:"truncate",children:N}),s.jsxs("div",{className:"flex items-center gap-2",children:[R?s.jsx("span",{className:"text-token-text-tertiary text-[11px]",children:R}):null,A?s.jsx("span",{className:"bg-token-text-secondary inline-block h-2.5 w-2.5 rounded-full","aria-hidden":!0}):null]})]})},j.id)})})]}),s.jsxs("div",{className:"flex min-h-[320px] flex-1 flex-col gap-4",children:[s.jsx("div",{className:"flex-1 overflow-y-auto pe-1",children:p?s.jsx(Ca,{section:p,ctx:S}):s.jsx("div",{className:"text-token-text-tertiary text-sm",children:a.formatMessage(T.navPlaceholder)})}),s.jsxs("div",{className:"border-token-border-light flex items-center justify-end gap-3 border-t pt-3",children:[s.jsx(he,{color:"ghost",type:"button",onClick:w,children:a.formatMessage(T.clearFiltersButton)}),s.jsx(he,{color:"secondary",type:"button",onClick:k,children:a.formatMessage(T.cancelButton)}),s.jsx(he,{type:"button",onClick:M,children:a.formatMessage(T.applyButton)})]})]})]})}const ks=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zE),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)}),Ce=lt({keyword:{id:"aardvark.filter.summary.keyword",defaultMessage:'contains "{value}"'},directories:{id:"aardvark.filter.summary.directories",defaultMessage:"{count, plural, one {# path} other {# paths}}"},authors:{id:"aardvark.filter.summary.authors",defaultMessage:"is {value}"},assignees:{id:"aardvark.filter.summary.assignees",defaultMessage:"is {value}"},statuses:{id:"aardvark.filter.summary.statuses",defaultMessage:"is {value}"},criticalities:{id:"aardvark.filter.summary.criticalities",defaultMessage:"is {value}"},validation:{id:"aardvark.filter.summary.validation",defaultMessage:"is {value}"},clearAria:{id:"aardvark.filter.summary.clear",defaultMessage:'Clear "{label}" filter chip'},clearIcon:{id:"aardvark.filter.summary.clearIcon",defaultMessage:"×"}}),Ie=lt({keyword:{id:"aardvark.filter.summary.title.keyword",defaultMessage:"Keyword"},directories:{id:"aardvark.filter.summary.title.directories",defaultMessage:"Paths"},authors:{id:"aardvark.filter.summary.title.authors",defaultMessage:"Author"},assignees:{id:"aardvark.filter.summary.title.assignees",defaultMessage:"Assignee"},statuses:{id:"aardvark.filter.summary.title.statuses",defaultMessage:"Status"},criticalities:{id:"aardvark.filter.summary.title.criticalities",defaultMessage:"Criticality"},validation:{id:"aardvark.filter.summary.title.validation",defaultMessage:"Validation"},patch:{id:"aardvark.filter.summary.title.patch",defaultMessage:"Patch"}}),Ta=lt({all:{id:"aardvark.filter.summary.validation.all",defaultMessage:"All findings"},validated:{id:"aardvark.filter.summary.validation.validated",defaultMessage:"Validated only"},unvalidated:{id:"aardvark.filter.summary.validation.unvalidated",defaultMessage:"Unvalidated only"}}),Oa=lt({all:{id:"aardvark.filter.summary.patch.all",defaultMessage:"All findings"},with_patch:{id:"aardvark.filter.summary.patch.with_patch",defaultMessage:"With patch generated only"},without_patch:{id:"aardvark.filter.summary.patch.without_patch",defaultMessage:"Without patch generated only"}}),$a=(t,e=30)=>t.length>e?"".concat(t.slice(0,e),"…"):t,dt=t=>t.join(", "),Da=t=>t.charAt(0).toUpperCase()+t.slice(1);function Ba({renderLayout:t}={}){var f;const e=ne(),{filters:a,onChangeFilters:r}=ot(),[l,n]=L.useState(!1),o=((f=a.keywordQuery)!=null?f:"").trim(),c=L.useMemo(()=>{var d,u,p,y,v,M,k,w,S,C;let i=0;return i+=(u=(d=a.selectedAuthors)==null?void 0:d.size)!=null?u:0,i+=(y=(p=a.selectedAssignees)==null?void 0:p.size)!=null?y:0,i+=(M=(v=a.selectedStatuses)==null?void 0:v.size)!=null?M:0,i+=(w=(k=a.selectedCriticalities)==null?void 0:k.size)!=null?w:0,i+=(C=(S=a.selectedPathPrefixes)==null?void 0:S.size)!=null?C:0,i+=o?1:0,i+=a.existsInHeadOnly?1:0,i+=a.validationFilter!=="all"?1:0,i+=a.patchFilter!=="all"?1:0,i+=a.recommendedOnly?1:0,i},[a,o]),h=L.useMemo(()=>{var k,w,S,C,_,j;const i=[],d=((k=a.keywordQuery)!=null?k:"").trim();d&&i.push({id:"keyword",title:e.formatMessage(Ie.keyword),value:e.formatMessage(Ce.keyword,{value:$a(d)}),onClear:()=>r(le($({},a),{keywordQuery:""}))});const u=Array.from((w=a.selectedPathPrefixes)!=null?w:[]);u.length>0&&i.push({id:"directories",title:e.formatMessage(Ie.directories),value:e.formatMessage(Ce.directories,{count:u.length}),onClear:()=>r(le($({},a),{selectedPathPrefixes:new Set}))});const p=Array.from((S=a.selectedAuthors)!=null?S:[]);p.length>0&&i.push({id:"authors",title:e.formatMessage(Ie.authors),value:e.formatMessage(Ce.authors,{value:dt(p)}),onClear:()=>r(le($({},a),{selectedAuthors:new Set}))});const y=Array.from((C=a.selectedAssignees)!=null?C:[]);y.length>0&&i.push({id:"assignees",title:e.formatMessage(Ie.assignees),value:e.formatMessage(Ce.assignees,{value:dt(y)}),onClear:()=>r(le($({},a),{selectedAssignees:new Set}))});const v=Array.from((_=a.selectedStatuses)!=null?_:[]);if(v.length>0){const N=v.map(P=>e.formatMessage(ss[P]));i.push({id:"statuses",title:e.formatMessage(Ie.statuses),value:e.formatMessage(Ce.statuses,{value:dt(N)}),onClear:()=>r(le($({},a),{selectedStatuses:new Set}))})}const M=Array.from((j=a.selectedCriticalities)!=null?j:[]);if(M.length>0){const N=M.map(Da);i.push({id:"criticalities",title:e.formatMessage(Ie.criticalities),value:e.formatMessage(Ce.criticalities,{value:dt(N)}),onClear:()=>r(le($({},a),{selectedCriticalities:new Set}))})}return a.validationFilter!=="all"&&i.push({id:"validation",title:e.formatMessage(Ie.validation),value:e.formatMessage(Ce.validation,{value:e.formatMessage(Ta[a.validationFilter])}),onClear:()=>r(le($({},a),{validationFilter:"all"}))}),a.patchFilter!=="all"&&i.push({id:"patch",title:e.formatMessage(Ie.patch),value:e.formatMessage(Oa[a.patchFilter]),onClear:()=>r(le($({},a),{patchFilter:"all"}))}),i},[a,e,r]),m=s.jsxs(fs,{open:l,onOpenChange:n,children:[s.jsx(hs,{asChild:!0,children:s.jsxs("button",{type:"button",className:G("border-token-border-light inline-flex h-9 items-center gap-2 rounded-md border px-3 text-sm font-medium transition-colors",c>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),"aria-label":e.formatMessage({id:"aardvark.filter.dropdown.trigger",defaultMessage:"Filter findings"}),children:[s.jsx("span",{children:e.formatMessage({id:"aardvark.filter.dropdown.label",defaultMessage:"Filter"})}),c>0?s.jsx("span",{className:"bg-token-main-surface-primary/70 text-token-text-primary inline-flex items-center rounded-full px-2 text-xs font-medium",children:e.formatMessage({id:"aardvark.filter.dropdown.count",defaultMessage:"{count}"},{count:c})}):null,s.jsx(ks,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]})}),s.jsx(xs,{children:s.jsx(ps,{side:"bottom",align:"end",sideOffset:8,collisionPadding:16,className:"border-token-border-light bg-token-bg-primary z-30 max-h-[85vh] w-[min(720px,calc(100vw-16px))] overflow-y-auto rounded-lg border p-4 shadow-2xl sm:max-h-[80vh] sm:w-[min(720px,calc(100vw-32px))]",children:s.jsx(Fa,{isOpen:l,onClose:()=>n(!1)})})})]}),x=h.length>0?s.jsx("div",{className:"flex flex-wrap items-center gap-2",children:h.map(i=>s.jsxs("div",{className:"border-token-border-light bg-token-bg-secondary/80 text-token-text-primary inline-flex items-center gap-2 rounded-full border px-2 py-1 text-xs shadow-sm",children:[s.jsx("span",{className:"text-token-text-tertiary text-[10px] font-semibold tracking-wide uppercase",children:i.title}),s.jsx("span",{className:"text-token-text-primary text-xs",children:i.value}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-sm",onClick:i.onClear,"aria-label":e.formatMessage(Ce.clearAria,{label:"".concat(i.title," ").concat(i.value)}),children:s.jsx("span",{"aria-hidden":"true",children:s.jsx(g,$({},Ce.clearIcon))})})]},i.id))}):null,b=x?s.jsx("div",{className:"mt-3",children:x}):null;return t?s.jsx(s.Fragment,{children:t({trigger:m,chips:b})}):s.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col gap-2 rounded-lg px-2 py-2",children:[s.jsx("div",{className:"flex justify-end",children:m}),b]})}function Ha(){var b;const t=ne(),{filters:e,onChangeFilters:a,repoOptions:r,repoOptionsLoading:l}=ot(),[n,o]=L.useState(""),h=(b=L.useMemo(()=>{var f;return Array.from((f=e.selectedRepos)!=null?f:[])},[e.selectedRepos])[0])!=null?b:"",m=L.useMemo(()=>{var i;if(!h)return"";const f=r.find(d=>d.value===h);return(i=f==null?void 0:f.label)!=null?i:h},[h,r]),x=L.useMemo(()=>{var f,i,d,u,p;if(e.recommendedOnly){if(m)return m;const y=(f=r[0])==null?void 0:f.label;return y&&y.trim().length>0?y:t.formatMessage({id:"aardvark.filter.recommended.selectRepo",defaultMessage:"Choose a repository"})}return e.selectedRepos&&e.selectedRepos.size>0?e.selectedRepos.size===1?m||t.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(d=(i=e.selectedRepos)==null?void 0:i.size)!=null?d:0}):t.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(p=(u=e.selectedRepos)==null?void 0:u.size)!=null?p:0}):t.formatMessage({id:"aardvark.filter.allRepos.label",defaultMessage:"All repos"})},[e.recommendedOnly,e.selectedRepos,t,m,r]);return r.length===0?s.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[e.recommendedOnly?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:s.jsx(g,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories"})}),s.jsx("span",{className:"border-token-border-light text-token-text-tertiary inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm",children:l?s.jsxs(s.Fragment,{children:[s.jsx(bt,{className:"text-token-text-tertiary h-4 w-4"}),s.jsx(g,{id:"aardvark.filter.repos.loading",defaultMessage:"Loading repositories..."})]}):s.jsx(g,{id:"aardvark.filter.repos.empty",defaultMessage:"No repositories available"})})]})]}):s.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[e.recommendedOnly?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:s.jsx(g,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories"})}),s.jsxs(Ks,{triggerButton:s.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm transition-colors "+(e.selectedRepos&&e.selectedRepos.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[s.jsx("span",{children:x}),s.jsx(ks,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[s.jsx("div",{className:"p-2.5",children:s.jsx(Mt.InputItem,{autoFocus:!0,holdFocus:!0,value:n,onChange:f=>o(f.target.value),placeholder:t.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"}),"aria-label":t.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"})})}),e.recommendedOnly?null:s.jsx(Mt.MultiSelectCheckboxItem,{checked:!(e.selectedRepos&&e.selectedRepos.size>0),onCheckedChange:()=>a(le($({},e),{selectedRepos:new Set,selectedRepo:"all"})),children:t.formatMessage({id:"aardvark.filter.allRepos",defaultMessage:"All repos"})}),r.filter(f=>n?"".concat(f.label," ").concat(f.value).toLowerCase().includes(n.toLowerCase()):!0).map(f=>{var i;return s.jsx(Mt.MultiSelectCheckboxItem,{checked:!!((i=e.selectedRepos)!=null&&i.has(f.value)),onCheckedChange:()=>{var u,p;const d=new Set(e.selectedRepos);if(d.has(f.value)?d.delete(f.value):(e.recommendedOnly&&d.clear(),d.add(f.value)),e.recommendedOnly){if(d.size===0){const y=(p=(u=r[0])==null?void 0:u.value)!=null?p:"";y&&d.add(y)}else if(d.size>1){const[y]=Array.from(d);d.clear(),y&&d.add(y)}}a(le($({},e),{selectedRepos:d,selectedRepo:d.size===1?Array.from(d)[0]:"all"}))},children:f.label},f.value)})]})]})]})}function js(t){var e;return(e=t.created_at)!=null?e:null}function ws(t){var e,a;return(a=(e=t.commit_analysis)==null?void 0:e.committer_date)!=null?a:null}function Ms(t,e){return t?t.length<=e?t:t.slice(0,e-1)+"…":""}const za=pe(()=>xe(()=>import("./dr1v3i80rkhviakg.js"),__vite__mapDeps([5,1])),{loading:t=>ge(t)}),Va=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zE),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)}),Se="items-center min-h-16 px-3 py-3",Fe="text-token-text-tertiary text-sm font-semibold",Yt="bg-token-main-surface-secondary/70 text-token-text-secondary rounded-lg px-2 py-0.5 text-xs break-all",Xt=2;function Ua(){"use forget";var Qe,Ke,Ye,Xe,Je,Ze;const t=ie.c(101),e=ne(),a=nt(),r=qe(),l=He();let n;t[0]!==l.search?(n=new URLSearchParams(l.search),t[0]=l.search,t[1]=n):n=t[1];const o=n;let c;t[2]!==o?(c=((Qe=o.get("limit"))!=null?Qe:"").toLowerCase(),t[2]=o,t[3]=c):c=t[3];const h=c;let m;t[4]!==o?(m=o.get("cursor"),t[4]=o,t[5]=m):m=t[5];const x=m,b=new Set(["10","20","50","100"]),f=Number(h);let i;t[6]!==h||t[7]!==f?(i=b.has(h)&&Number.isFinite(f)?f:50,t[6]=h,t[7]=f,t[8]=i):i=t[8];const d=i,u=x?Number(x):NaN;let p;t[9]!==u?(p=Number.isFinite(u)?Math.max(0,u):0,t[9]=u,t[10]=p):p=t[10];const y=p,v=d;let M;t[11]!==y||t[12]!==d?(M={limit:d,cursor:y},t[11]=y,t[12]=d,t[13]=M):M=t[13];const k=Ws(l.search,M);let w,S;t[14]!==k.error||t[15]!==e||t[16]!==a?(w=()=>{if(k.error){const W=e.formatMessage(Te.findingsLoad,{details:k.error.message});a.danger(W)}},S=[k.error,e,a],t[14]=k.error,t[15]=e,t[16]=a,t[17]=w,t[18]=S):(w=t[17],S=t[18]),L.useEffect(w,S);let C;t[19]!==((Ke=k.data)==null?void 0:Ke.items)?(C=(Xe=(Ye=k.data)==null?void 0:Ye.items)!=null?Xe:[],t[19]=(Je=k.data)==null?void 0:Je.items,t[20]=C):C=t[20];const _=C,j=(Ze=k.data)==null?void 0:Ze.total,N=typeof j=="number"?j:_.length,P=y,R=k.isLoading,A=Math.max(1,Math.ceil(N/v)),O=Math.min(Math.max(1,Math.floor(P/v)+1),A);let U;t[21]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx(Ba,{renderLayout:Ka}),t[21]=U):U=t[21];let z;t[22]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx(E.HeaderCell,{className:G("w-10 px-4 py-3 pe-2 text-start",Fe),children:s.jsx(g,{id:"aardvark.findings.number",defaultMessage:"#"})}),t[22]=z):z=t[22];let q;t[23]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx(E.HeaderCell,{className:G("max-w-100 px-4 py-3 ps-2 text-start",Fe),children:s.jsx(g,{id:"aardvark.table.repoAndPathsHeader",defaultMessage:"Repository & paths"})}),t[23]=q):q=t[23];let Y;t[24]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe),children:s.jsx(g,{id:"aardvark.table.criticality",defaultMessage:"Criticality"})}),t[24]=Y):Y=t[24];let me;t[25]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe),children:s.jsx(g,{id:"aardvark.table.vulnerability",defaultMessage:"Vulnerability"})}),t[25]=me):me=t[25];let ae;t[26]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe),children:s.jsx(g,{id:"aardvark.table.statusHeader",defaultMessage:"Status"})}),t[26]=ae):ae=t[26];let re;t[27]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe),children:s.jsx(g,{id:"aardvark.table.assigneeHeader",defaultMessage:"Assignee"})}),t[27]=re):re=t[27];let Z;t[28]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe),children:s.jsx(g,{id:"aardvark.table.timestampsHeader",defaultMessage:"Timestamps"})}),t[28]=Z):Z=t[28];let ee;t[29]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsxs(E.Header,{children:[z,q,Y,me,ae,re,Z,s.jsx(E.HeaderCell,{className:G("px-4 py-3",Fe)})]}),t[29]=ee):ee=t[29];let B;t[30]!==e||t[31]!==R||t[32]!==l.search||t[33]!==r||t[34]!==_||t[35]!==P?(B=R?s.jsx(E.Row,{children:s.jsx(E.Cell,{colSpan:8,divClassName:Se,children:s.jsx("div",{className:"flex h-full w-full items-center justify-center",children:s.jsx(bt,{className:"text-token-text-tertiary h-6 w-6"})})})}):_.length===0?s.jsx(E.Row,{children:s.jsx(E.Cell,{colSpan:8,divClassName:Se,children:s.jsx(g,{id:"aardvark.table.emptyFindings",defaultMessage:"No findings"})})}):_.map((W,F)=>{var Ot,$t,Dt,Bt,Ht,zt,Vt;const H=($t=(Ot=W.hid)!=null?Ot:W.id)!=null?$t:"",ce=as(W),$e=ce.slice(0,Xt),et=ce.length>Xt,Ne=ut(ws(W)),De=ut(js(W)),Ue=ft(Ne),We=ft(De),tt=ht(e,Ne),wt=ht(e,De),Cs=ce.length>0,{isValidated:It,hasPatch:Ft}=rs(W),Tt=(zt=(Ht=(Dt=W.commit_analysis)==null?void 0:Dt.title)!=null?Ht:(Bt=W.commit_analysis)==null?void 0:Bt.description)!=null?zt:"";return s.jsxs(E.Row,{className:"group/row hover:bg-token-bg-secondary/60 border-token-border-light min-h-14 cursor-pointer border-b text-sm transition-colors last:border-b-0",onClick:()=>{H&&r("/aardvark/findings/".concat(encodeURIComponent(H)).concat(l.search||""))},children:[s.jsx(E.Cell,{divClassName:G(Se,"text-start pe-2 text-token-text-tertiary tabular-nums"),children:P+F+1}),s.jsx(E.Cell,{divClassName:G(Se,"text-start max-w-100"),children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-token-text-primary font-medium",children:vt((Vt=W.repo_url)!=null?Vt:"")||e.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})}),s.jsx("div",{children:Cs?s.jsx(os,{label:ce.join("\n"),children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[$e.map(Ut=>s.jsx("span",{className:Yt,children:Ut},"".concat(Ut.toLowerCase(),"-").concat(F))),et&&s.jsx("span",{className:Yt,children:s.jsx(g,{id:"aardvark.table.more",defaultMessage:"..."})})]})}):s.jsx("span",{className:"text-token-text-tertiary mt-1 inline-block text-xs",children:s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})})]})}),s.jsx(E.Cell,{divClassName:Se,children:s.jsx(At,{level:W.criticality})}),s.jsx(E.Cell,{divClassName:G(Se,"max-w-100"),children:s.jsxs("div",{className:"flex flex-col gap-2 text-start",children:[s.jsx("span",{className:"text-token-text-primary font-medium",title:Tt,children:Ms(Tt,140)}),(It||Ft)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[It?s.jsx(xt,{variant:"success",size:"sm",children:s.jsx(g,$({},pt.validated))}):null,Ft?s.jsx(xt,{variant:"purple",size:"sm",children:s.jsx(g,$({},pt.patch))}):null]})]})}),s.jsx(E.Cell,{divClassName:G(Se,"text-start"),children:s.jsx("div",{onClick:Qa,children:s.jsx(ls,{finding:W})})}),s.jsx(E.Cell,{divClassName:G(Se,"text-start"),children:s.jsx("div",{onClick:qa,children:s.jsx(ns,{finding:W})})}),s.jsx(E.Cell,{divClassName:G(Se,"text-start"),children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex flex-row gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-sm font-semibold",children:s.jsx(g,$({},_t.committedHeader))}),s.jsx("span",{className:"text-token-text-primary text-sm",title:tt!=null?tt:void 0,children:Ue?s.jsx(ct,{value:Ue.value,unit:Ue.unit,numeric:"auto"}):s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})]}),s.jsxs("div",{className:"flex flex-row gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-sm font-semibold",children:s.jsx(g,$({},_t.detectedHeader))}),s.jsx("span",{className:"text-token-text-primary text-sm",title:wt!=null?wt:void 0,children:We?s.jsx(ct,{value:We.value,unit:We.unit,numeric:"auto"}):s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})]})]})}),s.jsx(E.Cell,{divClassName:Se,children:s.jsxs(Ct,{to:H?"/aardvark/findings/".concat(encodeURIComponent(H)).concat(l.search||""):"#",onClick:Ga,className:G("inline-flex h-9 w-9 items-center justify-center rounded-full text-sm transition-colors",H?"text-token-text-primary hover:bg-token-main-surface-secondary":"text-token-text-tertiary pointer-events-none"),children:[s.jsx("span",{className:"sr-only",children:s.jsx(g,{id:"aardvark.table.viewButton",defaultMessage:"View"})}),s.jsx(za,{className:"icon-sm","aria-hidden":!0})]})})]},"".concat(H||"finding","-").concat(F))}),t[30]=e,t[31]=R,t[32]=l.search,t[33]=r,t[34]=_,t[35]=P,t[36]=B):B=t[36];let Q;t[37]!==B?(Q=s.jsxs(E.Root,{className:"overflow-x-auto",disableScroll:!0,children:[ee,s.jsx(E.Body,{children:B})]}),t[37]=B,t[38]=Q):Q=t[38];const J="border-token-border-light flex items-center justify-between border-t px-4 py-3 ".concat(R?"animate-pulse blur-[1px]":""),te=_.length===0?0:P+1,se=_.length===0?0:Math.min(P+_.length,N);let K;t[39]!==te||t[40]!==se||t[41]!==N?(K=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.findings.range",defaultMessage:"{from}-{to} of {total} results",values:{from:te,to:se,total:N}})}),t[39]=te,t[40]=se,t[41]=N,t[42]=K):K=t[42];let de;t[43]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"rows-per-page",children:s.jsx(g,{id:"aardvark.pagination.rowsPerPage",defaultMessage:"Rows per page"})}),t[43]=de):de=t[43];const oe=String(v);let X;t[44]!==l.search||t[45]!==r?(X=W=>{const F=new URLSearchParams(l.search);F.set("limit",W),F.set("cursor","0"),r({search:"?".concat(F.toString())},{replace:!0})},t[44]=l.search,t[45]=r,t[46]=X):X=t[46];let I;t[47]===Symbol.for("react.memo_cache_sentinel")?(I=[{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],t[47]=I):I=t[47];let D;t[48]!==oe||t[49]!==X?(D=s.jsx(qt,{triggerId:"rows-per-page",triggerClassName:"min-w-[84px]",contentClassName:"!min-w-[84px]",value:oe,onValueChange:X,options:I}),t[48]=oe,t[49]=X,t[50]=D):D=t[50];let V;t[51]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"page-select",children:s.jsx(g,{id:"aardvark.pagination.page",defaultMessage:"Page"})}),t[51]=V):V=t[51];const Re=String(O);let ve;t[52]!==l.search||t[53]!==r||t[54]!==A||t[55]!==v?(ve=W=>{const F=Math.min(Math.max(1,Number(W)),A),H=new URLSearchParams(l.search);H.set("cursor",String((F-1)*v)),r({search:"?".concat(H.toString())},{replace:!0})},t[52]=l.search,t[53]=r,t[54]=A,t[55]=v,t[56]=ve):ve=t[56];let Ae;t[57]!==A?(Ae=Array.from({length:A},Wa),t[57]=A,t[58]=Ae):Ae=t[58];let be;t[59]!==Re||t[60]!==ve||t[61]!==Ae?(be=s.jsx(qt,{triggerId:"page-select",triggerClassName:"min-w-[72px]",contentClassName:"!min-w-[72px]",value:Re,onValueChange:ve,options:Ae}),t[59]=Re,t[60]=ve,t[61]=Ae,t[62]=be):be=t[62];let ye;t[63]!==A?(ye=s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.pagination.of",defaultMessage:"of {count}",values:{count:A}})}),t[63]=A,t[64]=ye):ye=t[64];let Pe;t[65]!==be||t[66]!==ye?(Pe=s.jsxs(s.Fragment,{children:[V,be,ye]}),t[65]=be,t[66]=ye,t[67]=Pe):Pe=t[67];const ze=R||O<=1;let Le;t[68]!==l.search||t[69]!==r||t[70]!==v||t[71]!==O?(Le=()=>{const W=Math.max(1,O-1),F=new URLSearchParams(l.search);F.set("cursor",String((W-1)*v)),r({search:"?".concat(F.toString())},{replace:!0})},t[68]=l.search,t[69]=r,t[70]=v,t[71]=O,t[72]=Le):Le=t[72];let Ve;t[73]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(g,{id:"aardvark.pagination.prev",defaultMessage:"Previous"}),t[73]=Ve):Ve=t[73];let Ee;t[74]!==ze||t[75]!==Le?(Ee=s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:ze,onClick:Le,children:Ve}),t[74]=ze,t[75]=Le,t[76]=Ee):Ee=t[76];const we=R||O>=A;let ue;t[77]!==l.search||t[78]!==r||t[79]!==A||t[80]!==v||t[81]!==O?(ue=()=>{const W=Math.min(A,O+1),F=new URLSearchParams(l.search);F.set("cursor",String((W-1)*v)),r({search:"?".concat(F.toString())},{replace:!0})},t[77]=l.search,t[78]=r,t[79]=A,t[80]=v,t[81]=O,t[82]=ue):ue=t[82];let ke;t[83]===Symbol.for("react.memo_cache_sentinel")?(ke=s.jsx(g,{id:"aardvark.pagination.next",defaultMessage:"Next"}),t[83]=ke):ke=t[83];let Me;t[84]!==we||t[85]!==ue?(Me=s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:we,onClick:ue,children:ke}),t[84]=we,t[85]=ue,t[86]=Me):Me=t[86];let fe;t[87]!==Ee||t[88]!==Me?(fe=s.jsxs("div",{className:"flex items-center gap-2",children:[Ee,Me]}),t[87]=Ee,t[88]=Me,t[89]=fe):fe=t[89];let je;t[90]!==D||t[91]!==Pe||t[92]!==fe?(je=s.jsxs("div",{className:"flex items-center gap-3",children:[de,D,Pe,fe]}),t[90]=D,t[91]=Pe,t[92]=fe,t[93]=je):je=t[93];let _e;t[94]!==J||t[95]!==K||t[96]!==je?(_e=s.jsxs("div",{className:J,children:[K,je]}),t[94]=J,t[95]=K,t[96]=je,t[97]=_e):_e=t[97];let Oe;return t[98]!==Q||t[99]!==_e?(Oe=s.jsxs("div",{className:"mx-auto w-full",children:[U,s.jsxs("div",{className:"border-token-border-light bg-token-main-surface-primary overflow-hidden rounded-2xl border",children:[Q,_e]})]}),t[98]=Q,t[99]=_e,t[100]=Oe):Oe=t[100],Oe}function Wa(t,e){return{label:String(e+1),value:String(e+1)}}function Ga(t){return t.stopPropagation()}function qa(t){return t.stopPropagation()}function Qa(t){return t.stopPropagation()}function Ka(t){const{trigger:e,chips:a}=t;return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"mb-5",children:[s.jsxs("div",{className:"mb-3 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsx(Ya,{}),s.jsx("div",{className:"flex justify-end",children:e})]}),a]})})}function Ya(){"use forget";var p,y,v,M,k;const t=ie.c(28),e=ne(),a=qe(),r=He();let l,n,o,c,h,m,x;if(t[0]!==e||t[1]!==r.search||t[2]!==a){const C=((p=new URLSearchParams(r.search).get("sort"))!=null?p:"sev_desc,date_desc").split(",").map(tr).filter(Boolean),_=(y=C[0])!=null?y:"sev_desc",j=(v=C.find(er))!=null?v:"sev_desc",N=(M=C.find(Za))!=null?M:"commit_date_desc",P=(k=C.find(Ja))!=null?k:"date_desc";let R;t[10]!==r.search||t[11]!==a?(R=(z,q)=>{const Y=new URLSearchParams(r.search);Y.set("sort","".concat(z,",").concat(q)),a({search:"?".concat(Y.toString())},{replace:!0})},t[10]=r.search,t[11]=a,t[12]=R):R=t[12];const A=R,O=()=>{const q=_.startsWith("sev")&&j==="sev_desc"?"sev_asc":"sev_desc";A(q,"date_desc")},U=()=>{const q=_.startsWith("commit_date")&&N==="commit_date_desc"?"commit_date_asc":"commit_date_desc";A(q,"sev_desc")};x=()=>{const q=_.startsWith("date")&&P==="date_desc"?"date_asc":"date_desc";A(q,"sev_desc")},h={id:"severity",label:e.formatMessage({id:"aardvark.table.criticality",defaultMessage:"Criticality"}),isActive:_.startsWith("sev"),direction:j.endsWith("_asc")?"asc":"desc",onClick:O},m={id:"commit_date",label:e.formatMessage({id:"aardvark.table.committedDateHeader",defaultMessage:"Committed date"}),isActive:_.startsWith("commit_date"),direction:N.endsWith("_asc")?"asc":"desc",onClick:U},l="detected_date",t[13]!==e?(n=e.formatMessage({id:"aardvark.table.detectedDateHeader",defaultMessage:"Detected date"}),t[13]=e,t[14]=n):n=t[14],o=_.startsWith("date"),c=P.endsWith("_asc")?"asc":"desc",t[0]=e,t[1]=r.search,t[2]=a,t[3]=l,t[4]=n,t[5]=o,t[6]=c,t[7]=h,t[8]=m,t[9]=x}else l=t[3],n=t[4],o=t[5],c=t[6],h=t[7],m=t[8],x=t[9];let b;t[15]!==l||t[16]!==n||t[17]!==o||t[18]!==c||t[19]!==x?(b={id:l,label:n,isActive:o,direction:c,onClick:x},t[15]=l,t[16]=n,t[17]=o,t[18]=c,t[19]=x,t[20]=b):b=t[20];let f;t[21]!==h||t[22]!==m||t[23]!==b?(f=[h,m,b],t[21]=h,t[22]=m,t[23]=b,t[24]=f):f=t[24];const i=f;let d;t[25]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("span",{children:s.jsx(g,{id:"aardvark.table.sortByLabel",defaultMessage:"Sort by"})}),t[25]=d):d=t[25];let u;return t[26]!==i?(u=s.jsxs("div",{className:"text-token-text-tertiary flex flex-wrap items-center gap-3 text-sm font-semibold",children:[d,s.jsx("div",{className:"flex flex-wrap gap-2 text-sm normal-case",children:i.map(Xa)})]}),t[26]=i,t[27]=u):u=t[27],u}function Xa(t){return s.jsx(sr,$({},t),t.id)}function Ja(t){return t.startsWith("date")}function Za(t){return t.startsWith("commit_date")}function er(t){return t.startsWith("sev")}function tr(t){return t.trim()}function sr(t){"use forget";const e=ie.c(13),{label:a,isActive:r,direction:l,onClick:n}=t,o=r?"border-token-border-strong bg-token-main-surface-secondary text-token-text-primary shadow-sm":"border-token-border-light text-token-text-tertiary hover:text-token-text-primary";let c;e[0]!==o?(c=G("inline-flex items-center gap-1 rounded-full border px-3 py-1 text-sm font-medium transition-colors",o),e[0]=o,e[1]=c):c=e[1];let h;e[2]!==a?(h=s.jsx("span",{children:a}),e[2]=a,e[3]=h):h=e[3];const m=l==="asc"&&"rotate-180";let x;e[4]!==m?(x=G("icon-xs transition-transform",m),e[4]=m,e[5]=x):x=e[5];let b;e[6]!==x?(b=s.jsx(Va,{className:x,"aria-hidden":!0}),e[6]=x,e[7]=b):b=e[7];let f;return e[8]!==n||e[9]!==c||e[10]!==h||e[11]!==b?(f=s.jsxs("button",{type:"button",className:c,onClick:n,children:[h,b]}),e[8]=n,e[9]=c,e[10]=h,e[11]=b,e[12]=f):f=e[12],f}const ar=pe(()=>xe(()=>import("./dr1v3i80rkhviakg.js"),__vite__mapDeps([5,1])),{loading:t=>ge(t)}),Jt=2,Ns="bg-token-main-surface-secondary/70 text-token-text-secondary rounded-lg px-2 py-0.5 text-xs break-all";function rr(){"use forget";var K,de,oe,X;const t=ie.c(55),e=ne(),{filters:a,repoOptions:r,repoOptionsLoading:l,repoScanIdMap:n}=ot(),o=nt(),c=He(),h=qe();let m,x;t[0]!==c.search||t[1]!==h?(m=()=>{const I=new URLSearchParams(c.search);let D=!1;if(I.has("cursor")&&(I.delete("cursor"),D=!0),I.has("limit")&&(I.delete("limit"),D=!0),!D)return;const V=I.toString();h({search:V?"?".concat(V):""},{replace:!0})},x=[c.search,h],t[0]=c.search,t[1]=h,t[2]=m,t[3]=x):(m=t[2],x=t[3]),L.useEffect(m,x);let b,f;t[4]!==a.selectedRepos||t[5]!==n?(b=a.selectedRepos&&a.selectedRepos.size>0?Array.from(a.selectedRepos)[0]:null,f=b&&(K=n.get(b))!=null?K:null,t[4]=a.selectedRepos,t[5]=n,t[6]=b,t[7]=f):(b=t[6],f=t[7]);const i=f,{data:d,isLoading:u,error:p}=Gs(i);let y,v;t[8]!==e||t[9]!==p||t[10]!==o?(y=()=>{if(p){const I=e.formatMessage(Te.recommendedLoad,{details:p.message});o.danger(I)}},v=[e,p,o],t[8]=e,t[9]=p,t[10]=o,t[11]=y,t[12]=v):(y=t[11],v=t[12]),L.useEffect(y,v);const M=d==null?void 0:d.items;let k;t[13]!==M?(k=M!=null?M:[],t[13]=M,t[14]=k):k=t[14];const w=k,S=d==null?void 0:d.total,C=!l&&!!b&&!i;let _,j;t[15]!==e||t[16]!==C||t[17]!==o?(_=()=>{C&&o.danger(e.formatMessage(Te.recommendedMissingScanToast))},j=[e,C,o],t[15]=e,t[16]=C,t[17]=o,t[18]=_,t[19]=j):(_=t[18],j=t[19]),L.useEffect(_,j);let N=null;if(t[20]!==w||t[21]!==N){for(const I of w){const D=I.ranking_end_time,V=typeof D=="number"?D:typeof D=="string"?Number(D):null;V==null||!Number.isFinite(V)||(N==null||V>N)&&(N=V)}t[20]=w,t[21]=N,t[22]=N}else N=t[22];const P=N;let R;e:{if(P==null){R=null;break e}const I=P*1e3;if(!Number.isFinite(I)){R=null;break e}let D,V;if(t[23]!==I?(D=new Date(I),V=Number.isNaN(D.getTime()),t[23]=I,t[24]=D,t[25]=V):(D=t[24],V=t[25]),V){R=null;break e}R=D}const A=R;let O;if(t[26]!==a.selectedRepos||t[27]!==r){e:{const[I]=Array.from((de=a.selectedRepos)!=null?de:[]);if(!I){O="";break e}const D=r.find(V=>V.value===I);O=(X=(oe=D==null?void 0:D.label)!=null?oe:vt(I))!=null?X:I}t[26]=a.selectedRepos,t[27]=r,t[28]=O}else O=t[28];const U=O;let z;t[29]!==w?(z=w.slice(0,10),t[29]=w,t[30]=z):z=t[30];const q=z;let Y;t[31]!==e?(Y=e.formatMessage({id:"aardvark.recommended.heading.targetAll",defaultMessage:"all repositories"}),t[31]=e,t[32]=Y):Y=t[32];const ae=U||Y,re=q.length;if(C){let I;return t[33]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:s.jsx(g,$({},Te.recommendedMissingScan))})}),t[33]=I):I=t[33],I}if(l||u){let I;return t[34]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary flex min-h-[240px] items-center justify-center rounded-2xl border",children:s.jsx(bt,{className:"text-token-text-tertiary h-6 w-6"})})}),t[34]=I):I=t[34],I}if(q.length===0){let I;return t[35]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:s.jsx(g,{id:"aardvark.recommended.empty",defaultMessage:"No recommended findings right now"})})}),t[35]=I):I=t[35],I}let Z;t[36]!==ae?(Z=s.jsx("div",{className:"space-y-2",children:s.jsx("h3",{className:"text-token-text-primary text-xl leading-7 font-semibold",children:s.jsx(g,{id:"aardvark.recommended.heading.top",defaultMessage:"Aardvark Top {count} for {repo}",values:{count:10,repo:ae}})})}),t[36]=ae,t[37]=Z):Z=t[37];let ee;t[38]!==A?(ee=A?s.jsx("div",{className:"text-token-text-tertiary text-xs sm:text-sm",children:s.jsx(g,{id:"aardvark.recommended.updated",defaultMessage:"Updated {date} at {time}",values:{date:s.jsx(Fs,{value:A,year:"numeric",month:"long",day:"numeric"}),time:s.jsx(Is,{value:A,hour:"numeric",minute:"2-digit"})}})}):null,t[38]=A,t[39]=ee):ee=t[39];let B;t[40]!==Z||t[41]!==ee?(B=s.jsxs("header",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[Z,ee]}),t[40]=Z,t[41]=ee,t[42]=B):B=t[42];let Q;t[43]!==q?(Q=q.map(lr),t[43]=q,t[44]=Q):Q=t[44];let J;t[45]!==Q?(J=s.jsx("ol",{className:"flex flex-col gap-4",children:Q}),t[45]=Q,t[46]=J):J=t[46];let te;t[47]!==S||t[48]!==U||t[49]!==re?(te=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:S?U?s.jsx(g,{id:"aardvark.recommended.range.forRepo",defaultMessage:"Showing top {count} findings for {repo}",values:{count:re,repo:U}}):s.jsx(g,{id:"aardvark.recommended.range",defaultMessage:"Showing top {count} recommended findings",values:{count:re}}):U?s.jsx(g,{id:"aardvark.recommended.range.forRepo.noTotal",defaultMessage:"Showing top {count} findings for {repo}",values:{count:re,repo:U}}):s.jsx(g,{id:"aardvark.recommended.range.noTotal",defaultMessage:"Showing top {count} recommended findings",values:{count:re}})}),t[47]=S,t[48]=U,t[49]=re,t[50]=te):te=t[50];let se;return t[51]!==B||t[52]!==J||t[53]!==te?(se=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsxs("div",{className:"flex flex-col gap-5",children:[B,J,te]})}),t[51]=B,t[52]=J,t[53]=te,t[54]=se):se=t[54],se}function lr(t,e){return s.jsx(nr,{finding:t,index:e,baseIndex:0},"".concat(t.hid,"-").concat(e))}function nr(t){"use forget";var U,z,q,Y,me,ae,re,Z,ee;const e=ie.c(72),{finding:a,index:r,baseIndex:l}=t,n=ne(),o=qe(),c=He(),h=(z=(U=a.hid)!=null?U:a.id)!=null?z:"";let m;e[0]!==a.repo_url||e[1]!==n?(m=vt((q=a.repo_url)!=null?q:"")||n.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"}),e[0]=a.repo_url,e[1]=n,e[2]=m):m=e[2];const x=m;let b,f,i,d,u,p,y,v,M,k,w,S,C,_,j,N;if(e[3]!==l||e[4]!==h||e[5]!==a||e[6]!==r||e[7]!==n||e[8]!==c.search||e[9]!==o){N=(re=(ae=(Y=a.commit_analysis)==null?void 0:Y.title)!=null?ae:(me=a.commit_analysis)==null?void 0:me.description)!=null?re:n.formatMessage({id:"aardvark.recommended.missingTitle",defaultMessage:"Untitled finding"});const B=(ee=(Z=a.commit_analysis)==null?void 0:Z.description)!=null?ee:"",Q=typeof a.ranking_reason=="string"?a.ranking_reason:void 0;let J;e[26]!==B||e[27]!==Q?(J=Q&&Q.trim().length>0?Q:B,e[26]=B,e[27]=Q,e[28]=J):J=e[28],S=J;let te;e[29]!==a?(te=as(a),e[29]=a,e[30]=te):te=e[30],M=te;let se;if(e[31]!==a||e[32]!==n){const X=ut(ws(a)),I=ut(js(a));b=ft(X),i=ft(I),f=ht(n,X),se=ht(n,I),e[31]=a,e[32]=n,e[33]=b,e[34]=f,e[35]=i,e[36]=se}else b=e[33],f=e[34],i=e[35],se=e[36];d=se,k=l+r+1;let K;e[37]!==a?(K=rs(a),e[37]=a,e[38]=K):K=e[38],{isValidated:v,hasPatch:y}=K;let de;e[39]!==h||e[40]!==c.search||e[41]!==o?(de=()=>{h&&o("/aardvark/findings/".concat(encodeURIComponent(h)).concat(c.search||""))},e[39]=h,e[40]=c.search,e[41]=o,e[42]=de):de=e[42],p=de;let oe;e[43]!==p?(oe=X=>{(X.key==="Enter"||X.key===" ")&&(X.preventDefault(),p())},e[43]=p,e[44]=oe):oe=e[44],u=oe,w=c.search||"",C="button",_=0,j=n.formatMessage({id:"aardvark.recommended.card.ariaLabel",defaultMessage:"View details for {title}"},{title:N}),e[3]=l,e[4]=h,e[5]=a,e[6]=r,e[7]=n,e[8]=c.search,e[9]=o,e[10]=b,e[11]=f,e[12]=i,e[13]=d,e[14]=u,e[15]=p,e[16]=y,e[17]=v,e[18]=M,e[19]=k,e[20]=w,e[21]=S,e[22]=C,e[23]=_,e[24]=j,e[25]=N}else b=e[10],f=e[11],i=e[12],d=e[13],u=e[14],p=e[15],y=e[16],v=e[17],M=e[18],k=e[19],w=e[20],S=e[21],C=e[22],_=e[23],j=e[24],N=e[25];let P;e[45]!==b||e[46]!==f||e[47]!==i||e[48]!==d||e[49]!==a.criticality||e[50]!==y||e[51]!==v||e[52]!==M||e[53]!==k||e[54]!==x||e[55]!==S||e[56]!==N?(P=s.jsx(ir,{rank:k,title:N,summary:S,repoName:x,criticality:a.criticality,pathPrefixes:M,committedRelative:b,committedTooltip:f,detectedRelative:i,detectedTooltip:d,isValidated:v,hasPatch:y}),e[45]=b,e[46]=f,e[47]=i,e[48]=d,e[49]=a.criticality,e[50]=y,e[51]=v,e[52]=M,e[53]=k,e[54]=x,e[55]=S,e[56]=N,e[57]=P):P=e[57];let R;e[58]!==h||e[59]!==a||e[60]!==w?(R=s.jsx(cr,{finding:a,detailId:h,search:w}),e[58]=h,e[59]=a,e[60]=w,e[61]=R):R=e[61];let A;e[62]!==P||e[63]!==R?(A=s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start",children:[P,R]}),e[62]=P,e[63]=R,e[64]=A):A=e[64];let O;return e[65]!==u||e[66]!==p||e[67]!==C||e[68]!==_||e[69]!==j||e[70]!==A?(O=s.jsx("li",{children:s.jsx("article",{role:C,tabIndex:_,"aria-label":j,onClick:p,onKeyDown:u,className:"border-token-border-light/70 bg-token-main-surface-secondary/40 hover:border-token-border-strong hover:bg-token-main-surface-tertiary focus-visible:border-token-border-strong focus-visible:ring-token-border-strong dark:bg-token-main-surface-secondary/70 group/card flex cursor-pointer flex-col gap-4 rounded-2xl border px-4 py-4 shadow-md transition-all hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:outline-none",children:A})}),e[65]=u,e[66]=p,e[67]=C,e[68]=_,e[69]=j,e[70]=A,e[71]=O):O=e[71],O}function ir(t){"use forget";const e=ie.c(33),{rank:a,title:r,summary:l,repoName:n,criticality:o,pathPrefixes:c,committedRelative:h,committedTooltip:m,detectedRelative:x,detectedTooltip:b,isValidated:f,hasPatch:i}=t;let d;e[0]!==a?(d=s.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-primary border-token-border-light flex h-9 w-9 shrink-0 items-center justify-center rounded-full border text-sm font-semibold",children:a}),e[0]=a,e[1]=d):d=e[1];let u;e[2]!==o?(u=s.jsx(At,{level:o}),e[2]=o,e[3]=u):u=e[3];let p;e[4]!==r?(p=s.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:r}),e[4]=r,e[5]=p):p=e[5];let y;e[6]!==u||e[7]!==p?(y=s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u,p]}),e[6]=u,e[7]=p,e[8]=y):y=e[8];let v;e[9]!==l?(v=l?s.jsx("p",{className:"text-token-text-secondary text-sm leading-6",children:Ms(l,260)}):null,e[9]=l,e[10]=v):v=e[10];let M;e[11]!==h||e[12]!==m||e[13]!==x||e[14]!==b||e[15]!==c||e[16]!==n?(M=s.jsx(or,{repoName:n,pathPrefixes:c,committedRelative:h,committedTooltip:m,detectedRelative:x,detectedTooltip:b}),e[11]=h,e[12]=m,e[13]=x,e[14]=b,e[15]=c,e[16]=n,e[17]=M):M=e[17];let k;e[18]!==f?(k=f?s.jsx(xt,{variant:"success",size:"sm",children:s.jsx(g,$({},pt.validated))}):null,e[18]=f,e[19]=k):k=e[19];let w;e[20]!==i?(w=i?s.jsx(xt,{variant:"purple",size:"sm",className:"font-medium",children:s.jsx(g,$({},pt.patch))}):null,e[20]=i,e[21]=w):w=e[21];let S;e[22]!==k||e[23]!==w?(S=s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[k,w]}),e[22]=k,e[23]=w,e[24]=S):S=e[24];let C;e[25]!==y||e[26]!==v||e[27]!==M||e[28]!==S?(C=s.jsxs("div",{className:"min-w-0 flex-1 space-y-3",children:[y,v,M,S]}),e[25]=y,e[26]=v,e[27]=M,e[28]=S,e[29]=C):C=e[29];let _;return e[30]!==d||e[31]!==C?(_=s.jsxs("div",{className:"flex flex-1 gap-4",children:[d,C]}),e[30]=d,e[31]=C,e[32]=_):_=e[32],_}function or(t){"use forget";const e=ie.c(37),{repoName:a,pathPrefixes:r,committedRelative:l,committedTooltip:n,detectedRelative:o,detectedTooltip:c}=t;let h,m,x,b,f,i;if(e[0]!==r||e[1]!==a){const j=r.slice(0,Jt),N=r.length>Jt,P=r.length>0;f="mt-1 flex flex-wrap items-center gap-x-6 gap-y-2 align-middle text-xs";let R;e[8]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(g,{id:"aardvark.recommended.meta.repo",defaultMessage:"Repository"})}),e[8]=R):R=e[8],e[9]!==a?(i=s.jsxs("div",{className:"flex gap-1",children:[R,s.jsx("dd",{className:"text-token-text-primary",children:a})]}),e[9]=a,e[10]=i):i=e[10],x="flex items-center gap-1 align-middle",e[11]===Symbol.for("react.memo_cache_sentinel")?(b=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(g,{id:"aardvark.recommended.meta.paths",defaultMessage:"Paths"})}),e[11]=b):b=e[11],h="text-token-text-primary",m=P?s.jsx(os,{label:r.join("\n"),children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[j.map(dr),N?s.jsx("span",{className:Ns,children:s.jsx(g,{id:"aardvark.table.more",defaultMessage:"..."})}):null]})}):s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),e[0]=r,e[1]=a,e[2]=h,e[3]=m,e[4]=x,e[5]=b,e[6]=f,e[7]=i}else h=e[2],m=e[3],x=e[4],b=e[5],f=e[6],i=e[7];let d;e[12]!==h||e[13]!==m?(d=s.jsx("dd",{className:h,children:m}),e[12]=h,e[13]=m,e[14]=d):d=e[14];let u;e[15]!==x||e[16]!==b||e[17]!==d?(u=s.jsxs("div",{className:x,children:[b,d]}),e[15]=x,e[16]=b,e[17]=d,e[18]=u):u=e[18];let p;e[19]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(g,$({},_t.committedHeader))}),e[19]=p):p=e[19];const y=n!=null?n:void 0;let v;e[20]!==l?(v=l?s.jsx(ct,{value:l.value,unit:l.unit,numeric:"auto"}):s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),e[20]=l,e[21]=v):v=e[21];let M;e[22]!==y||e[23]!==v?(M=s.jsxs("div",{className:"flex gap-1",children:[p,s.jsx("dd",{className:"text-token-text-primary",title:y,children:v})]}),e[22]=y,e[23]=v,e[24]=M):M=e[24];let k;e[25]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(g,{id:"aardvark.recommended.meta.detected",defaultMessage:"Detected"})}),e[25]=k):k=e[25];const w=c!=null?c:void 0;let S;e[26]!==o?(S=o?s.jsx(ct,{value:o.value,unit:o.unit,numeric:"auto"}):s.jsx(g,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),e[26]=o,e[27]=S):S=e[27];let C;e[28]!==w||e[29]!==S?(C=s.jsxs("div",{className:"flex gap-1",children:[k,s.jsx("dd",{className:"text-token-text-primary",title:w,children:S})]}),e[28]=w,e[29]=S,e[30]=C):C=e[30];let _;return e[31]!==M||e[32]!==C||e[33]!==f||e[34]!==i||e[35]!==u?(_=s.jsxs("dl",{className:f,children:[i,u,M,C]}),e[31]=M,e[32]=C,e[33]=f,e[34]=i,e[35]=u,e[36]=_):_=e[36],_}function dr(t,e){return s.jsx("span",{className:Ns,children:t},"".concat(t.toLowerCase(),"-").concat(e))}function cr(t){"use forget";const e=ie.c(15),{finding:a,detailId:r,search:l}=t;let n;e[0]!==a?(n=s.jsx("div",{onClick:fr,children:s.jsx(ls,{finding:a})}),e[0]=a,e[1]=n):n=e[1];let o;e[2]!==a?(o=s.jsx("div",{onClick:ur,children:s.jsx(ns,{finding:a})}),e[2]=a,e[3]=o):o=e[3];let c;e[4]!==n||e[5]!==o?(c=s.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:[n,o]}),e[4]=n,e[5]=o,e[6]=c):c=e[6];const h=r?"/aardvark/findings/".concat(encodeURIComponent(r)).concat(l):"#",m="inline-flex h-9 w-9 items-center justify-center rounded-full text-sm transition-colors ".concat(r?"text-token-text-primary hover:bg-token-main-surface-secondary":"text-token-text-tertiary pointer-events-none");let x,b;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("span",{className:"sr-only",children:s.jsx(g,{id:"aardvark.table.viewButton",defaultMessage:"View"})}),b=s.jsx(ar,{className:"icon-sm","aria-hidden":!0}),e[7]=x,e[8]=b):(x=e[7],b=e[8]);let f;e[9]!==h||e[10]!==m?(f=s.jsx("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:s.jsxs(Ct,{to:h,onClick:mr,className:m,children:[x,b]})}),e[9]=h,e[10]=m,e[11]=f):f=e[11];let i;return e[12]!==c||e[13]!==f?(i=s.jsxs("div",{className:"flex w-full flex-col gap-3 lg:max-w-[260px] lg:items-end",children:[c,f]}),e[12]=c,e[13]=f,e[14]=i):i=e[14],i}function mr(t){return t.stopPropagation()}function ur(t){return t.stopPropagation()}function fr(t){return t.stopPropagation()}const hr=pe(()=>xe(()=>import("./nz44s7ebe5b6pll5.js"),__vite__mapDeps([6,1])),{loading:t=>ge(t)});function xr(){"use forget";var _;const t=ie.c(33),e=He(),a=qe();let r;t[0]!==e.search?(r=new URLSearchParams(e.search),t[0]=e.search,t[1]=r):r=t[1];const l=r;let n;t[2]!==l?(n=l.get("recommended"),t[2]=l,t[3]=n):n=t[3];const o=n==="true";let c;if(t[4]!==e.search){const j=new URLSearchParams(e.search),N=["repo","status","criticality","assignee","author","validated","path_prefix","q"],P={};for(const R of N)P[R]=(_=j.get(R))!=null?_:"";c=JSON.stringify(P),t[4]=e.search,t[5]=c}else c=t[5];const h=c,m=L.useRef(h);let x,b;t[6]!==h||t[7]!==e.search||t[8]!==a||t[9]!==l?(x=()=>{if(m.current!==h){const j=new URLSearchParams(e.search);j.set("cursor","0"),j.toString()!==l.toString()&&a({search:"?".concat(j.toString())},{replace:!0})}m.current=h},b=[h,a,e.search,l],t[6]=h,t[7]=e.search,t[8]=a,t[9]=l,t[10]=x,t[11]=b):(x=t[10],b=t[11]),L.useEffect(x,b);let f,i;t[12]!==e.search||t[13]!==a?(f=()=>{const j=new URLSearchParams(e.search),N=j.get("finding");if(!N)return;j.delete("finding");const P=j.toString(),R=P?"?".concat(P):"";a("/aardvark/findings/".concat(encodeURIComponent(N)).concat(R),{replace:!0})},i=[e.search,a],t[12]=e.search,t[13]=a,t[14]=f,t[15]=i):(f=t[14],i=t[15]),L.useEffect(f,i);let d;t[16]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.home.findings",defaultMessage:"Manage findings"})}),t[16]=d):d=t[16];let u;t[17]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(hr,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),t[17]=u):u=t[17];let p;t[18]!==e.search||t[19]!==a?(p=j=>{var P;j.preventDefault(),a({search:e.search,hash:"#configurescans-connected-repos"},{replace:!1});const N=typeof globalThis<"u"?(P=globalThis.document)==null?void 0:P.getElementById("connected-repos"):null;if(N)try{N.scrollIntoView({behavior:"smooth",block:"start"})}catch(R){}},t[18]=e.search,t[19]=a,t[20]=p):p=t[20];let y;t[21]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx(g,{id:"aardvark.findings.configured.link",defaultMessage:"connected repos"}),t[21]=y):y=t[21];let v;t[22]!==p?(v=s.jsx("div",{role:"note",className:"border-token-border-light/60 bg-token-bg-tertiary/50 flex flex-col gap-2 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",children:s.jsx("div",{className:"text-token-text-secondary flex items-start gap-3 text-sm leading-6",children:s.jsxs("div",{className:"flex items-center gap-x-2",children:[u,s.jsx("p",{className:"m-0",children:s.jsx("span",{className:"text-token-text-primary",children:s.jsx(g,{id:"aardvark.findings.configured.notice",defaultMessage:"Only showing findings from repositories you can access and have connected. View all {link}.",values:{link:s.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:p,children:y})}})})})]})})}),t[22]=p,t[23]=v):v=t[23];let M,k;t[24]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx("div",{className:"mt-3 flex w-full flex-wrap items-center justify-center gap-3",children:s.jsx(pr,{})}),k=s.jsx(Ha,{}),t[24]=M,t[25]=k):(M=t[24],k=t[25]);let w;t[26]!==v?(w=s.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[d,v,M,k]}),t[26]=v,t[27]=w):w=t[27];let S;t[28]!==o?(S=s.jsx("div",{children:o?s.jsx(rr,{}):s.jsx(Ua,{})}),t[28]=o,t[29]=S):S=t[29];let C;return t[30]!==w||t[31]!==S?(C=s.jsx("section",{className:"mt-8",children:s.jsx(fa,{children:s.jsxs("div",{className:"mx-auto w-full",children:[w,S]})})}),t[30]=w,t[31]=S,t[32]=C):C=t[32],C}function pr(){"use forget";const t=ie.c(25),{filters:e,onChangeFilters:a,repoOptions:r}=ot();let l;t[0]!==e||t[1]!==a||t[2]!==r?(l=k=>{var C,_;if(k===e.recommendedOnly)return;let w=new Set(e.selectedRepos);if(k){const j=(_=(C=r[0])==null?void 0:C.value)!=null?_:"";if(w.size===0)j&&(w=new Set([j]));else if(w.size>1){const[N]=Array.from(w),P=N&&N.trim().length>0?N:j;w=P&&P.trim().length>0?new Set([P]):new Set}else{const[N]=Array.from(w);N&&!r.some(P=>P.value===N)&&j&&(w=new Set([j]))}}else w=new Set;const S=k?le($({},e),{selectedCriticalities:new Set,selectedStatuses:new Set,selectedPathPrefixes:new Set,selectedAssignees:new Set,selectedAuthors:new Set,keywordQuery:"",validationFilter:"all"}):e;a(le($({},S),{recommendedOnly:k,selectedRepos:w,selectedRepo:w.size===1?Array.from(w)[0]:"all"}))},t[0]=e,t[1]=a,t[2]=r,t[3]=l):l=t[3];const n=l,o=e.recommendedOnly?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary";let c;t[4]!==o?(c=G("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-token-outline-primary",o),t[4]=o,t[5]=c):c=t[5];const h=c,m=e.recommendedOnly?"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary":"bg-token-main-surface-secondary text-token-text-primary shadow-sm";let x;t[6]!==m?(x=G("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible-outline-2 focus-visible-outline-offset-2 focus-visible-outline-token-outline-primary",m),t[6]=m,t[7]=x):x=t[7];const b=x;let f;t[8]!==n?(f=()=>n(!0),t[8]=n,t[9]=f):f=t[9];let i;t[10]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(g,{id:"aardvark.filter.recommended",defaultMessage:"Recommended findings"}),t[10]=i):i=t[10];let d;t[11]!==e.recommendedOnly||t[12]!==h||t[13]!==f?(d=s.jsx("button",{type:"button","aria-pressed":e.recommendedOnly,className:h,onClick:f,children:i}),t[11]=e.recommendedOnly,t[12]=h,t[13]=f,t[14]=d):d=t[14];const u=!e.recommendedOnly;let p;t[15]!==n?(p=()=>n(!1),t[15]=n,t[16]=p):p=t[16];let y;t[17]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx(g,{id:"aardvark.filter.allFindings",defaultMessage:"All findings"}),t[17]=y):y=t[17];let v;t[18]!==b||t[19]!==u||t[20]!==p?(v=s.jsx("button",{type:"button","aria-pressed":u,className:b,onClick:p,children:y}),t[18]=b,t[19]=u,t[20]=p,t[21]=v):v=t[21];let M;return t[22]!==v||t[23]!==d?(M=s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary inline-flex items-center gap-1 rounded-lg border px-1 py-1 shadow-sm",children:[d,v]}),t[22]=v,t[23]=d,t[24]=M):M=t[24],M}const Zt=14;function Ss(t){return t===void 0||typeof t=="number"&&Number.isFinite(t)&&t>=0&&t<=90}function gr({value:t,onChange:e,isSaving:a}){const r=ne(),l=Ss(t);return s.jsxs("div",{className:"grid w-full grid-cols-[1fr,auto] grid-rows-[auto,auto] gap-x-4 gap-y-1 ".concat(a?"pointer-events-none opacity-60":""),children:[s.jsx("label",{className:"col-start-1 row-start-1 justify-self-start text-start text-sm font-medium",children:s.jsx(g,{id:"aardvark.whamRepos.lookbackDays",defaultMessage:"Lookback window"})}),s.jsx("div",{className:"text-token-text-tertiary col-start-1 row-start-2 justify-self-start text-start text-[11px]",children:s.jsx(g,{id:"aardvark.whamRepos.lookbackDays.help",defaultMessage:"How far back to scan existing commits when first enabled."})}),s.jsxs("div",{className:"col-start-2 row-span-2 flex flex-col items-end gap-2 self-center justify-self-end",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:r.formatMessage({id:"aardvark.whamRepos.preset.1w",defaultMessage:"1w"}),value:7},{label:r.formatMessage({id:"aardvark.whamRepos.preset.2w",defaultMessage:"2w"}),value:14},{label:r.formatMessage({id:"aardvark.whamRepos.preset.1m",defaultMessage:"1m"}),value:30},{label:r.formatMessage({id:"aardvark.whamRepos.preset.3m",defaultMessage:"3m"}),value:90},{label:r.formatMessage({id:"aardvark.whamRepos.preset.indefinite",defaultMessage:"Indefinite"}),value:void 0}].map(n=>{var o;return s.jsx("button",{type:"button",onClick:()=>e(n.value),className:"border-token-border-light rounded-md border px-2 py-1 text-xs "+(t===n.value?"bg-token-main-surface-secondary text-token-text-primary":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:n.label},String((o=n.value)!=null?o:"indefinite"))})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"number",value:t!=null?t:"",placeholder:t===void 0?r.formatMessage({id:"aardvark.whamRepos.preset.placeholder.indefinite",defaultMessage:"Indefinite"}):void 0,onChange:n=>{const o=n.target.value;if(o===""||o==="indefinite"){e(void 0);return}const c=parseInt(o,10);Number.isFinite(c)&&e(c)},"aria-invalid":!l,"aria-describedby":l?void 0:"lookback-error",className:"border-token-border-light bg-token-main-surface-secondary text-token-text-primary w-24 rounded-md border px-2 py-1 text-end text-xs focus:ring-1 focus:outline-none "+(l?"focus:ring-token-border-light":"border-red-500 focus:ring-red-500"),"aria-label":r.formatMessage({id:"aardvark.whamRepos.lookbackDays.input",defaultMessage:"Lookback days"})}),t!==void 0&&s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.whamRepos.lookbackDays.suffix",defaultMessage:"days"})})]}),l?null:s.jsx("div",{id:"lookback-error",className:"self-end text-[11px] text-red-500",children:s.jsx(g,{id:"aardvark.whamRepos.lookbackDays.error",defaultMessage:"Enter a value between 0 and 90."})})]})]})}function vr(t){"use no forget";var P;const{open:e,onOpenChange:a,repoName:r,repoId:l,repoFullName:n}=t,o=ne(),c=nt(),h=it(),m=Et(h),x=(P=m==null?void 0:m.authUserId)!=null?P:"",b=m==null?void 0:m.getWorkspaceId(),{environmentId:f,setEnvironmentId:i}=oa(),{scanMap:d,configIdByRepo:u,configVersionById:p}=yt(b),y=Ts(),[v,M]=L.useState(!1),[k,w]=L.useState(!1),[S,C]=L.useState(Zt),_=L.useMemo(()=>d.get(l),[d,l]);L.useEffect(()=>{var A,O;if(!e)return;if(M(((A=_==null?void 0:_.state)!=null?A:"disabled")==="enabled"),i((O=_==null?void 0:_.environment_id)!=null?O:null),!_){C(Zt);return}const R=_.lookback_days;C(R==null?void 0:R)},[e,_,i]);const j=()=>{a(!1)},N=async()=>{w(!0);try{const R=u.get(l),A=new Rt(Pt);if(!R){const z=await A.post("/aardvark/scan_configurations",{headers:gt(),body:{environment_id:f||"env-default",repo_id:l,repo_url:"https://github.com/".concat(n),state:v?"enabled":"disabled",owner_id:x,lookback_days:S!=null?S:null}});if(z.status!==201)throw mt(z.status,z.data);Qt(b,z.data,y),a(!1),c.successNeutral(o.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"}));return}const O=p.get(R),U=await A.patch("/aardvark/scan_configurations/{id}",{headers:gt(),path:{id:R},body:{version:O,state:v?"enabled":"disabled",owner_id:v?x:void 0,environment_id:f,lookback_days:S!=null?S:null}});if(U.status!==200)throw mt(U.status,U.data);Qt(b,U.data,y),a(!1),c.successNeutral(o.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"}))}catch(R){const A=R,O=o.formatMessage(Te.scanSettingsSave,{details:A.message});c.danger(O)}finally{w(!1)}};return s.jsxs(fs,{open:e,onOpenChange:a,children:[s.jsx(hs,{asChild:!0,children:s.jsx(he,{as:"button",color:"secondary",size:"small",children:s.jsx(g,{id:"aardvark.whamRepos.configureButton",defaultMessage:"Configure"})})}),s.jsx(xs,{children:s.jsxs(ps,{side:"bottom",align:"end",sideOffset:8,className:"border-token-border-light bg-token-bg-primary z-10 w-[520px] rounded-lg border p-4 shadow-xl",children:[s.jsx("div",{className:"text-token-text-primary mb-3 text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.whamRepos.scanSettingsInlineTitle",defaultMessage:"Scan settings for {repo}",values:{repo:r}})}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-medium",children:s.jsx(g,{id:"aardvark.whamRepos.enabledToggle",defaultMessage:"Enabled"})}),s.jsx(ds,{checked:v,onCheckedChange:R=>M(R),"aria-hidden":!0,disabled:k})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium",children:s.jsx(g,{id:"aardvark.whamRepos.environment",defaultMessage:"Codex environment"})}),s.jsx("div",{className:k?"pointer-events-none opacity-60":"",children:s.jsx(aa,{showBranchSelector:!1,filters:{repos:[l]},allowRepositorySelection:!1})})]}),s.jsx(gr,{value:S,onChange:C,isSaving:k}),s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(he,{color:"secondary",onClick:j,children:s.jsx(g,{id:"aardvark.whamRepos.cancel",defaultMessage:"Cancel"})}),s.jsx(he,{color:"primary",disabled:k||v&&(!f||!Ss(S)),onClick:()=>void N(),children:k?s.jsx(g,{id:"aardvark.whamRepos.saving",defaultMessage:"Saving..."}):s.jsx(g,{id:"aardvark.whamRepos.save",defaultMessage:"Save"})})]})]})]})})]})}const br=pe(()=>xe(()=>import("./jqy8zfwhk6ptqvmj.js"),__vite__mapDeps([7,1])),{loading:t=>ge(t)});function yr({hasGithubConnection:t,openGithubModal:e}){const a=ne();return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{id:"connected-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.whamRepos.connectedSectionTitle",defaultMessage:"Your connected repositories"})}),s.jsx("a",{href:"#configurescans-connected-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":a.formatMessage({id:"aardvark.whamRepos.connectedLinkAria",defaultMessage:"Deep link to connected repositories"}),children:s.jsx(br,{className:"icon-sm"})})]}),s.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:s.jsx(g,{id:"aardvark.whamRepos.connectedSectionDescription",defaultMessage:"These are repositories from your GitHub organizations that you’ve connected. You can configure scans for them here. Missing a repo? {link}",values:{link:s.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:r=>{r.preventDefault(),t?window.open("https://github.com/apps/chatgpt-codex-connector/installations/select_target","_blank"):e()},children:s.jsx(g,{id:"aardvark.whamRepos.configureAccess",defaultMessage:"Configure repository access."})})}})})]})}const kr=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zu),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)}),jr=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zL),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)}),_s=100;function wr(t){"use forget";var _e,Oe,Qe,Ke,Ye,Xe,Je,Ze,W;const e=ie.c(87),{scanMap:a}=t,r=ne(),{data:l,isLoading:n}=da();let o;e[0]!==(l==null?void 0:l.memberships)?(o=(_e=l==null?void 0:l.memberships)!=null?_e:[],e[0]=l==null?void 0:l.memberships,e[1]=o):o=e[1];let c;e[2]!==(l==null?void 0:l.other)?(c=(Oe=l==null?void 0:l.other)!=null?Oe:[],e[2]=l==null?void 0:l.other,e[3]=c):c=e[3];let h;e[4]!==o||e[5]!==c?(h=[...o,...c],e[4]=o,e[5]=c,e[6]=h):h=e[6];const m=h,[x,b]=L.useState(null);let f,i;e[7]!==m||e[8]!==x?(f=()=>{if(m.length===0){b(null);return}(x==null||!m.some(F=>F.id===x))&&b(m[0].id)},i=[m,x],e[7]=m,e[8]=x,e[9]=f,e[10]=i):(f=e[9],i=e[10]),L.useEffect(f,i);const[d,u]=L.useState(""),{openGithubModal:p,error:y}=cs(us.GITHUB_CONNECTOR,"github","/aardvark",ms.CODEX);let v;e[11]!==x?(v=["aardvark","wham","repositories",x],e[11]=x,e[12]=v):v=e[12];const M=!!x;let k;e[13]!==x?(k=F=>{const{pageParam:H}=F;return ca.getRepositoriesByInstallationId(x!=null?x:0,H,_s)},e[13]=x,e[14]=k):k=e[14];let w;e[15]!==v||e[16]!==M||e[17]!==k?(w={queryKey:v,enabled:M,initialPageParam:1,queryFn:k,getNextPageParam:Ar,refetchOnWindowFocus:!0},e[15]=v,e[16]=M,e[17]=k,e[18]=w):w=e[18];const{data:S,isLoading:C,fetchNextPage:_,hasNextPage:j,isFetchingNextPage:N}=Os(w);let P;e[19]!==(S==null?void 0:S.pages)?(P=(Qe=S==null?void 0:S.pages.flatMap(Rr))!=null?Qe:[],e[19]=S==null?void 0:S.pages,e[20]=P):P=e[20];const R=P,A=n||C,O=(Ye=(Ke=l==null?void 0:l.memberships)==null?void 0:Ke.length)!=null?Ye:0,U=(Je=(Xe=l==null?void 0:l.other)==null?void 0:Xe.length)!=null?Je:0,z=O+U>0,q=it(),Y=Et(q),me=(Ze=Y==null?void 0:Y.authUserId)!=null?Ze:"";let ae;e[21]!==d?(ae=F=>F.name.toLowerCase().includes(d.trim().toLowerCase()),e[21]=d,e[22]=ae):ae=e[22];const re=R.filter(ae);let Z,ee;e[23]!==_||e[24]!==j||e[25]!==N||e[26]!==d?(Z=()=>{d.trim()!==""&&j&&!N&&_()},ee=[d,j,N,_],e[23]=_,e[24]=j,e[25]=N,e[26]=d,e[27]=Z,e[28]=ee):(Z=e[27],ee=e[28]),L.useEffect(Z,ee);const[B,Q]=L.useState(!1);let J;e[29]!==a||e[30]!==B?(J=F=>{var ce;if(!B)return!0;const H=a.get(F.id);return((ce=H==null?void 0:H.state)!=null?ce:"disabled")==="enabled"},e[29]=a,e[30]=B,e[31]=J):J=e[31];const te=re.filter(J);let se;if(e[32]!==te||e[33]!==a){se=[...te];let F;e[35]!==a?(F=(H,ce)=>{var Ne,De;const $e=((Ne=a.get(H.id))==null?void 0:Ne.state)==="enabled",et=((De=a.get(ce.id))==null?void 0:De.state)==="enabled";return $e===et?H.name.localeCompare(ce.name):$e?-1:1},e[35]=a,e[36]=F):F=e[36],se.sort(F),e[32]=te,e[33]=a,e[34]=se}else se=e[34];const K=se,[de,oe]=L.useState(1),X=Math.max(1,Math.ceil(K.length/5)),I=Math.min(de,X),D=(I-1)*5,V=Math.min(D+5,K.length);let Re,ve;e[37]!==V||e[38]!==_||e[39]!==j||e[40]!==N||e[41]!==R.length?(Re=()=>{V>=R.length&&j&&!N&&_()},ve=[V,R.length,j,N,_],e[37]=V,e[38]=_,e[39]=j,e[40]=N,e[41]=R.length,e[42]=Re,e[43]=ve):(Re=e[42],ve=e[43]),L.useEffect(Re,ve);const Ae=K.slice(D,V);let be;e[44]===Symbol.for("react.memo_cache_sentinel")?(be=()=>{oe(1)},e[44]=be):be=e[44];let ye;e[45]!==d||e[46]!==x||e[47]!==B?(ye=[d,x,B],e[45]=d,e[46]=x,e[47]=B,e[48]=ye):ye=e[48],L.useEffect(be,ye);const[Pe,ze]=L.useState(null),Le=F=>ze(F),Ve=()=>ze(null),Ee="flex flex-col gap-3";let we;e[49]!==m.length||e[50]!==y||e[51]!==l||e[52]!==A||e[53]!==p?(we=!A&&(l==null||m.length===0)?s.jsx(vs,{error:!!y,handleOpenGithubModal:p}):null,e[49]=m.length,e[50]=y,e[51]=l,e[52]=A,e[53]=p,e[54]=we):we=e[54];let ue;e[55]!==m.length||e[56]!==z||e[57]!==l||e[58]!==A||e[59]!==p?(ue=(!l||m.length===0)&&!A?null:s.jsx(yr,{hasGithubConnection:z,openGithubModal:p}),e[55]=m.length,e[56]=z,e[57]=l,e[58]=A,e[59]=p,e[60]=ue):ue=e[60];let ke;e[61]!==m||e[62]!==l||e[63]!==r||e[64]!==A||e[65]!==d||e[66]!==x||e[67]!==Q||e[68]!==B?(ke=(!l||m.length===0)&&!A?null:s.jsxs("div",{className:"flex flex-row items-end gap-3",children:[s.jsxs("div",{className:"flex w-60 flex-col gap-2",children:[s.jsx("p",{className:"text-token-text-primary text-sm leading-6 font-medium",children:s.jsx(g,{id:"aardvark.whamRepos.githubOrg",defaultMessage:"GitHub organization"})}),s.jsxs(Be.Root,{value:(W=x==null?void 0:x.toString())!=null?W:"",onValueChange:F=>b(parseInt(F)),disabled:m.length===0,children:[s.jsx(Be.Trigger,{className:"border-token-border-heavy bg-token-bg-primary w-60 rounded-md border",children:s.jsxs("div",{className:"flex w-full items-center justify-between",children:[s.jsx("div",{className:"truncate",children:s.jsx(Be.Value,{placeholder:r.formatMessage({id:"aardvark.whamRepos.selectOrg",defaultMessage:"Select organization"})})}),s.jsx(Be.Icon,{})]})}),s.jsx(Be.Portal,{children:s.jsx(Be.Content,{align:"start",className:"rounded-lg",children:m.map(Cr)})})]})]}),s.jsx("div",{className:"flex-1",children:s.jsx(gs,{color:"search",iconPosition:"left",icon:kr,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:d,onChange:F=>u(F.target.value),placeholder:r.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:r.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})}),s.jsxs("div",{className:"flex h-9 items-center gap-2 self-end whitespace-nowrap",children:[s.jsx(ds,{checked:B,onCheckedChange:F=>Q(F),"aria-label":r.formatMessage({id:"aardvark.whamRepos.toggleShowEnabled",defaultMessage:"Enabled only"})}),s.jsx("span",{className:"text-xs",children:s.jsx(g,{id:"aardvark.whamRepos.showEnabled",defaultMessage:"Enabled only"})})]})]}),e[61]=m,e[62]=l,e[63]=r,e[64]=A,e[65]=d,e[66]=x,e[67]=Q,e[68]=B,e[69]=ke):ke=e[69];const Me=(!l||m.length===0)&&!A?null:s.jsxs(E.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[s.jsxs(E.Header,{children:[s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.settingsHeader",defaultMessage:"Settings"})})]}),s.jsxs(E.Body,{children:[A&&s.jsx(s.Fragment,{children:Array.from({length:5}).map(_r)}),!A&&K.length===0&&s.jsx(E.Row,{children:s.jsx(E.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:s.jsx(g,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}),Ae.map(F=>{var We;const H=a.get(F.id),ce=(H==null?void 0:H.state)==="enabled",$e=(We=H==null?void 0:H.owner)==null?void 0:We.email,et=$e||r.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),Ne=!!H,De=!!(H!=null&&H.owner_id)&&H.owner_id===me,Ue="https://github.com/"+F.repository_full_name;return s.jsx(s.Fragment,{children:s.jsxs(E.Row,{className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm",children:[s.jsxs(E.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:[s.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(Ue,"_blank"),children:F.name}),s.jsx("a",{href:Ue,target:"_blank",rel:"noopener noreferrer",className:"ms-2 opacity-0 group-hover/row:opacity-100",onClick:Sr,children:s.jsx(jr,{className:"icon-sm"})})]}),s.jsx(E.Cell,{divClassName:"flex h-14 items-center justify-start gap-3 ps-2",children:s.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(Ne&&ce?"bg-green-500/10 text-green-600":Ne&&!ce?"bg-token-text-status-error/15 text-token-text-status-error":"bg-token-bg-tertiary text-token-text-tertiary"),children:Ne?ce?s.jsx(g,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):s.jsx(g,{id:"aardvark.status.disabled",defaultMessage:"Disabled"}):s.jsx(g,{id:"aardvark.status.unconfigured",defaultMessage:"Unconfigured"})})}),s.jsx(E.Cell,{divClassName:"flex h-14 items-center ps-2",children:!Ne||De?s.jsx(vr,{open:Pe===F.id,onOpenChange:tt=>tt?Le(F.id):Ve(),repoName:F.name,repoId:F.id,repoFullName:F.repository_full_name}):s.jsx("div",{className:"flex flex-col",children:s.jsx("span",{children:s.jsx(g,{id:"aardvark.whamRepos.ownedBy",defaultMessage:"Owned by {email}",values:{email:et}})})})})]},F.id)})})]})]});let fe;e[70]!==m.length||e[71]!==V||e[72]!==K.length||e[73]!==j||e[74]!==l||e[75]!==A||e[76]!==X||e[77]!==I||e[78]!==B||e[79]!==D?(fe=(!l||m.length===0)&&!A?null:s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary flex items-center justify-between border-t px-3 py-2 ".concat(A?"animate-pulse blur-[1px]":""),children:[s.jsxs("div",{className:"text-token-text-tertiary text-xs",children:[s.jsx(g,{id:"aardvark.whamRepos.range",defaultMessage:"{from}-{to} of {total} repositories",values:{from:K.length===0?0:D+1,to:V,total:K.length}}),B&&s.jsx("span",{className:"text-token-text-secondary ms-2",children:s.jsx(g,{id:"aardvark.whamRepos.filteredEnabled",defaultMessage:"Showing enabled only"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:A||I<=1,onClick:()=>oe(Nr),children:s.jsx(g,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:A||I>=X&&!j,onClick:()=>oe(Mr),children:s.jsx(g,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]}),e[70]=m.length,e[71]=V,e[72]=K.length,e[73]=j,e[74]=l,e[75]=A,e[76]=X,e[77]=I,e[78]=B,e[79]=D,e[80]=fe):fe=e[80];let je;return e[81]!==we||e[82]!==ue||e[83]!==ke||e[84]!==Me||e[85]!==fe?(je=s.jsxs("div",{className:Ee,children:[we,ue,ke,Me,fe]}),e[81]=we,e[82]=ue,e[83]=ke,e[84]=Me,e[85]=fe,e[86]=je):je=e[86],je}function Mr(t){return t+1}function Nr(t){return Math.max(1,t-1)}function Sr(t){return t.stopPropagation()}function _r(t,e){return s.jsx(E.Row,{children:s.jsx(E.Cell,{colSpan:4,divClassName:"p-2",children:s.jsx("div",{className:"bg-token-bg-primary border-token-border-light h-6 w-full animate-pulse rounded-md border blur-[1px]"})})},"skeleton-".concat(e))}function Cr(t){return s.jsx(Be.Item,{value:t.id.toString(),children:t.account_login},t.id)}function Rr(t){var e;return(e=t.repositories)!=null?e:[]}function Ar(t,e){var r;if(!(((r=t==null?void 0:t.repositories)!=null?r:[]).length<_s))return e.length+1}const Pr=pe(()=>xe(()=>import("./jqy8zfwhk6ptqvmj.js"),__vite__mapDeps([7,1])),{loading:t=>ge(t)});function Lr(){const t=ne();return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{id:"configured-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.whamRepos.configuredSectionTitle",defaultMessage:"All configured repositories"})}),s.jsx("a",{href:"#configurescans-configured-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":t.formatMessage({id:"aardvark.whamRepos.configuredLinkAria",defaultMessage:"Deep link to configured repositories"}),children:s.jsx(Pr,{className:"icon-sm"})})]}),s.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:s.jsx(g,{id:"aardvark.whamRepos.configuredSectionDescription",defaultMessage:"This is the full list of repositories in the workspace with scan configurations, created by you or other workspace members. You may not see findings for repos you haven’t connected."})})]})}var St,es;function Er(){if(es)return St;es=1;var t=Ys(),e=Xs();function a(r,l,n,o){return r==null?[]:(e(l)||(l=l==null?[]:[l]),n=o?void 0:n,e(n)||(n=n==null?[]:[n]),t(r,l,n))}return St=a,St}var Ir=Er();const Fr=$s(Ir),Tr=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zu),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)}),Or=pe(()=>xe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zL),__vite__mapDeps([0,1,2,3,4])),{loading:t=>ge(t)});function $r({scanConfigurations:t}){const e=ne(),a=5,[r,l]=L.useState(1),[n,o]=L.useState(""),c=L.useMemo(()=>{const i=n.trim().toLowerCase(),d=t.filter(u=>{var k,w;const p=u.repo_url.replace("https://github.com/",""),y=p.split("/"),v=(k=y.pop())!=null?k:p,M=(w=y[0])!=null?w:"";return i?v.toLowerCase().includes(i)||M.toLowerCase().includes(i):!0});return Fr(d,[u=>{var p;return((p=u.state)!=null?p:"disabled")==="enabled"?0:1},u=>{var y;return((y=u.repo_url.replace("https://github.com/","").split("/")[0])!=null?y:"").toLowerCase()},u=>{var M;const p=u.repo_url.replace("https://github.com/","");return((M=p.split("/").pop())!=null?M:p).toLowerCase()}],["asc","asc","asc"])},[t,n]),h=Math.max(1,Math.ceil(c.length/a)),m=Math.min(r,h),x=(m-1)*a,b=Math.min(x+a,c.length),f=c.slice(x,b);return L.useEffect(()=>{l(1)},[t.length,n]),s.jsxs(s.Fragment,{children:[s.jsx(Lr,{}),s.jsx("div",{className:"mb-3 flex justify-end",children:s.jsx("div",{className:"w-64",children:s.jsx(gs,{color:"search",iconPosition:"left",icon:Tr,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-configured-repos",type:"text",value:n,onChange:i=>o(i.target.value),placeholder:e.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:e.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})})}),s.jsxs(E.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[s.jsxs(E.Header,{children:[s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.organizationHeader",defaultMessage:"Organization"})}),s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),s.jsx(E.HeaderCell,{className:"ps-2 text-sm",children:s.jsx(g,{id:"aardvark.whamRepos.ownerHeader",defaultMessage:"Owner"})})]}),s.jsx(E.Body,{children:f.length===0?s.jsx(E.Row,{children:s.jsx(E.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:s.jsx(g,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}):s.jsx(s.Fragment,{children:f.map(i=>{var M,k,w,S;const d=i.repo_url.replace("https://github.com/",""),u=(M=d.split("/").pop())!=null?M:d,p=(k=d.split("/")[0])!=null?k:d,y=(S=(w=i.owner)==null?void 0:w.email)!=null?S:e.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),v=i.state==="enabled";return s.jsxs(E.Row,{className:"h-14 px-2 text-sm",children:[s.jsx(E.Cell,{divClassName:"flex h-14 items-center ps-2",children:p}),s.jsxs(E.Cell,{divClassName:"flex h-14 items-center ps-2",children:[s.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(i.repo_url,"_blank"),children:u}),s.jsx("a",{href:i.repo_url,target:"_blank",rel:"noopener noreferrer",className:"ms-2",onClick:C=>C.stopPropagation(),children:s.jsx(Or,{className:"icon-sm"})})]}),s.jsx(E.Cell,{divClassName:"flex h-14 items-center ps-2",children:s.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(v?"bg-green-500/10 text-green-600":"bg-token-text-status-error/15 text-token-text-status-error"),children:v?s.jsx(g,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):s.jsx(g,{id:"aardvark.repos.status.disabled",defaultMessage:"Disabled"})})}),s.jsx(E.Cell,{divClassName:"flex h-14 items-center ps-2",children:y})]},"other-".concat(i.repo_id))})})})]}),s.jsxs("div",{className:"border-token-border-light bg-token-bg-primary mt-2 flex items-center justify-between border-t px-3 py-2",children:[s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(g,{id:"aardvark.whamRepos.configuredRange",defaultMessage:"{from}-{to} of {total} repositories",values:{from:c.length===0?0:x+1,to:b,total:c.length}})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:m<=1,onClick:()=>l(i=>Math.max(1,i-1)),children:s.jsx(g,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),s.jsx(he,{as:"button",size:"small",color:"secondary",disabled:m>=h,onClick:()=>l(i=>i+1),children:s.jsx(g,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]})]})}const Dr=pe(()=>xe(()=>import("./mv59uia51hlqeiwb.js"),__vite__mapDeps([8,1])),{loading:t=>ge(t)});function Br(){const t=ne(),e=He(),[a,r]=L.useState(!1);return Js(()=>{const n=(e.hash||"").replace(/^#/,"").toLowerCase();(n==="configurescans-connected-repos"||n==="configurescans-configured-repos")&&r(!0)},[e.hash]),L.useEffect(()=>{const n=(e.hash||"").replace(/^#/,"").toLowerCase();let o=!1,c="configure-scans";if(n==="configurescans-connected-repos"?(o=!0,c="connected-repos"):n==="configurescans-configured-repos"&&(o=!0,c="configured-repos"),o){r(!0);try{let h=0;const m=()=>{const x=document.getElementById(c)||document.getElementById("configure-scans");x?x.scrollIntoView({behavior:"smooth",block:"start"}):h<10&&(h+=1,setTimeout(m,50))};requestAnimationFrame(m)}catch(h){}}},[e.hash]),s.jsxs("section",{id:"configure-scans",className:"mt-8",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[s.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:s.jsx(g,{id:"aardvark.home.repository",defaultMessage:"Configure scans"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-xs leading-5",children:s.jsx(g,{id:"aardvark.home.showRepos.message",defaultMessage:"Expand scan configuration"})}),s.jsx(Zs,{label:"",ariaLabel:t.formatMessage({id:"aardvark.home.showRepos.toggle",defaultMessage:"Expand scan configuration"}),enabled:a,onChange:l=>r(l)})]})]}),a?s.jsx(Hr,{}):null]})}function Hr(){const t=it(),e=Et(t),a=e==null?void 0:e.getWorkspaceId(),{scanMap:r}=yt(a),l=Array.from(r.values());return s.jsxs("div",{children:[s.jsx("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mb-5 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",role:"note",children:s.jsxs("div",{className:"text-token-text-secondary flex items-center gap-2 text-sm leading-6",children:[s.jsx(Dr,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),s.jsxs("p",{className:"m-0",children:[s.jsx("span",{className:"text-token-text-primary font-semibold",children:s.jsx(g,{id:"aardvark.home.configureScans.disclaimer.title",defaultMessage:"Workspace visibility:"})}),s.jsx("span",{className:"text-token-text-secondary ms-1",children:s.jsx(g,{id:"aardvark.home.configureScans.disclaimer",defaultMessage:"Scan configurations are visible to all workspace members. However, findings are only visible to workspace members with access to the repository."})})]})]})}),s.jsx(wr,{scanMap:r}),l.length>0?s.jsx("div",{className:"mt-6",children:s.jsx($r,{scanConfigurations:l})}):null]})}function zr(){"use forget";const t=ie.c(19),e=nt(),a=ne(),r=Lt();let l;t[0]!==r?(l=r==null?void 0:r.getWorkspaceId(),t[0]=r,t[1]=l):l=t[1];const n=l,{scanMap:o,isLoading:c}=yt(n),h=o.size>0,m=it();let x;t[2]!==m?(x=na(m),t[2]=m,t[3]=x):x=t[3];const b=x,{isConnected:f,isLoading:i,error:d,openGithubModal:u}=cs(us.GITHUB_CONNECTOR,"github","/aardvark",ms.CODEX);let p,y;t[4]!==d||t[5]!==a||t[6]!==e?(p=()=>{d&&e.danger(a.formatMessage(Te.githubConnection),{id:"github_connection_error",duration:5,error:d})},y=[d,a,e],t[4]=d,t[5]=a,t[6]=e,t[7]=p,t[8]=y):(p=t[7],y=t[8]),L.useEffect(p,y);let v;t[9]!==d||t[10]!==b||t[11]!==h||t[12]!==f||t[13]!==i||t[14]!==u||t[15]!==c?(v=()=>i||c?s.jsx("div",{className:"flex h-40 items-center justify-center",children:s.jsx(bt,{className:"text-token-text-tertiary h-6 w-6"})}):f||!c&&h?s.jsxs(s.Fragment,{children:[b&&s.jsx(Vr,{}),s.jsx(Br,{}),s.jsx(xr,{})]}):s.jsx(vs,{error:!!d,handleOpenGithubModal:u}),t[9]=d,t[10]=b,t[11]=h,t[12]=f,t[13]=i,t[14]=u,t[15]=c,t[16]=v):v=t[16];const M=v;let k;return t[17]!==M?(k=s.jsx("div",{className:"w-full px-4 pb-6",children:M()}),t[17]=M,t[18]=k):k=t[18],k}function Vr(){return s.jsx("div",{className:"border-token-border-light from-token-surface-secondary/90 via-token-surface-primary/80 to-token-surface-secondary/80 mb-4 w-full rounded-3xl border bg-gradient-to-r p-6 shadow-sm",children:s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-token-text-tertiary text-xs font-semibold tracking-[0.16em] uppercase",children:s.jsx(g,{id:"bY8EMn",defaultMessage:"New · repo access controls"})}),s.jsx("h2",{className:"text-token-text-primary mt-1 text-lg font-semibold",children:s.jsx(g,{id:"k+BhWu",defaultMessage:"Manage repository access in the admin console"})}),s.jsx("p",{className:"text-token-text-secondary text-sm",children:s.jsx(g,{id:"mmxIEp",defaultMessage:"Grant or revoke user access using the live Habitat-backed ACLs. Audit all active grants without leaving Aardvark."})})]}),s.jsx(Ct,{to:"/aardvark/admin",className:"bg-token-highlight text-token-surface-primary inline-flex items-center justify-center rounded-full px-5 py-2 text-sm font-semibold shadow-sm transition hover:brightness-110",children:s.jsx(g,{id:"M+gdBA",defaultMessage:"Open admin console"})})]})})}function Ur(){"use forget";const t=ie.c(2),e=it(),a=ia(e),r=ea();if(!a)return null;let l;return t[0]!==r?(l=s.jsx(Wr,$({},r)),t[0]=r,t[1]=l):l=t[1],l}function Wr(t){"use forget";const e=ie.c(2);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(Bs,{}),e[0]=a):a=e[0];let r;return e[1]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsxs(s.Fragment,{children:[s.jsxs(ma,{mobileHeaderRightContent:null,children:[a,s.jsx(Hs,{children:s.jsx(zs,{})}),s.jsx(Gr,{})]}),s.jsx(qs,{})]}),e[1]=r):r=e[1],r}const Gr=()=>{"use forget";const t=ie.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=s.jsx(ta,{children:s.jsx("div",{className:"no-scrollbar h-full w-full",children:s.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:s.jsx(zr,{})})})}),t[0]=e):e=t[0],e},Cl=Ds(function(){return s.jsx(Ur,{})});export{Cl as default};
//# sourceMappingURL=sl1t1a4vpjw4kue5.js.map

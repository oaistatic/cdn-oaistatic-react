const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/o2kvjcphiwxgrxo0.js","assets/kfrdmkli83ureki3.js","assets/dch45l9yrtbjo93p.js","assets/mxxk8a6tsnqbiapb.js","assets/ffrotvb922yxp30i.js","assets/nlj7ey81i8rm36n9.js"])))=>i.map(i=>d[i]);
var I=Object.defineProperty,R=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var k=(t,e,a)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,p=(t,e)=>{for(var a in e||(e={}))S.call(e,a)&&k(t,a,e[a]);if(j)for(var a of j(e))O.call(e,a)&&k(t,a,e[a]);return t},g=(t,e)=>R(t,F(e));var q=(t,e)=>{var a={};for(var r in t)S.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&j)for(var r of j(t))e.indexOf(r)<0&&O.call(t,r)&&(a[r]=t[r]);return a};import{j as s,M as _,b as E,d as L,r as z,_ as v}from"./kfrdmkli83ureki3.js";import{R as m,A as x,D as A,pT as H,_ as b,gX as N,aB as w,az as f,as as W,cy as B,dM as G,pU as P,aA as y}from"./kw08ajijqinojrwh.js";import{c7 as U}from"./fyw02vlaiv2vq6cj.js";import{M as V}from"./m3joncw451cqbul2.js";import{r as $}from"./i7t1qh3u8s8bvtb8.js";const de=async t=>await m.safePost("/shopping/customer",{requestBody:{items:t.map(e=>({id:e.id,value:e.value,quantity:e.quantity}))},authOption:x.SendIfAvailable}),me=async c=>{var n=c,{conversationId:t,sharedConversationUrl:e,existing_customer_session_client_secret:a}=n,r=q(n,["conversationId","sharedConversationUrl","existing_customer_session_client_secret"]);const l=async()=>await m.safePost("/shopping/checkout",{requestBody:{items:r.items.map(d=>({id:d.id,value:d.value,quantity:d.quantity})),conversation_id:t,shared_conversation_url:e,existing_customer_session_client_secret:a},authOption:x.SendIfAvailable});try{return await l()}catch(d){return await l()}},xe=async(t,{shippingMethodId:e,shippingAddress:a,items:r})=>{var d,h,o;const c=performance.now(),n={items:r.map(i=>({id:i.id,value:i.value,quantity:i.quantity}))};e!=null&&(n.shipping_option_id=e),a!=null&&(n.shipping_address={name:(d=a.name)!=null?d:void 0,line_one:(h=a.addressLine1)!=null?h:void 0,line_two:a.addressLine2,city:a.city,state:a.state,postal_code:a.postalCode,country:a.country,phone_number:(o=a.phoneNumber)!=null?o:void 0}),n.items=r.map(i=>({id:i.id,value:i.value,quantity:i.quantity}));const l=await m.safePatch("/shopping/checkout/{checkout_session_id}/update",{parameters:{path:{checkout_session_id:t}},requestBody:n,authOption:x.SendIfAvailable});return A.addAction("shopping_checkout.update",{durationMs:performance.now()-c}),l},he=async(t,e,a,r,c)=>await m.safePost("/shopping/checkout/{checkout_session_id}/complete",{parameters:{path:{checkout_session_id:t}},requestBody:{items:e.map(n=>({id:n.id,value:n.value,quantity:n.quantity})),payment_method:a,attempt_id:r,shipping_address:c},authOption:x.SendIfAvailable}),Q=async()=>(await m.safeGet("/shopping/orders",{authOption:x.SendIfAvailable})).orders,K=async t=>await m.safeGet("/shopping/order/{order_id}",{parameters:{path:{order_id:t}},authOption:x.SendIfAvailable}),X=f(()=>v(()=>import("./o2kvjcphiwxgrxo0.js"),__vite__mapDeps([0,1])),{loading:t=>y(t)}),J=f(()=>v(()=>import("./dch45l9yrtbjo93p.js"),__vite__mapDeps([2,1])),{loading:t=>y(t)}),Y=f(()=>v(()=>import("./mxxk8a6tsnqbiapb.js"),__vite__mapDeps([3,1])),{loading:t=>y(t)}),Z=f(()=>v(()=>import("./ffrotvb922yxp30i.js"),__vite__mapDeps([4,1])),{loading:t=>y(t)}),D=f(()=>v(()=>import("./nlj7ey81i8rm36n9.js"),__vite__mapDeps([5,1])),{loading:t=>y(t)}),C=1e3*5*60;function ue(){const t=ae();return t?s.jsx(te,{orderId:t}):s.jsx(H,{title:s.jsx(_,{id:"xdSD9Q",defaultMessage:"Orders"}),children:s.jsx(ee,{})})}const M=()=>s.jsxs("div",{className:"flex w-full gap-3 py-2",children:[s.jsx("div",{className:"bg-token-bg-tertiary h-20 w-20 rounded-xl"}),s.jsxs("div",{className:"flex flex-1 flex-col items-start justify-start gap-1",children:[s.jsx(P,{index:0,width:50,heightSize:"sm"}),s.jsx(P,{index:0,width:70,heightSize:"sm"})]})]});function ee(){const t=L(),{data:e,isLoading:a,isError:r,error:c}=E({queryKey:["orders"],queryFn:Q,staleTime:C,refetchOnMount:"always",refetchOnWindowFocus:"always"});return a?s.jsx(M,{}):r?s.jsxs("div",{className:"flex min-h-[400px] w-full flex-col items-center justify-center py-6 text-sm",children:[s.jsx(J,{className:"icon-xl"}),s.jsx("div",{className:"text-base font-medium",children:s.jsx(_,{id:"/GqhEc",defaultMessage:"Error loading orders"})}),!1]}):e&&(e!=null&&e.length)?s.jsx("div",{className:"flex flex-col",children:e==null?void 0:e.map((n,l)=>s.jsxs(s.Fragment,{children:[s.jsx(se,{order:n,onClick:()=>{T(t,n.order.id)}},n.order.id),l!==e.length-1&&s.jsx("div",{className:"bg-token-border-light h-px"})]}))}):s.jsxs("div",{className:"flex min-h-[400px] w-full flex-col items-center justify-center py-6 text-sm",children:[s.jsx(Y,{className:"icon-xl"}),s.jsx("div",{className:"text-base font-medium",children:s.jsx(_,{id:"2XILkl",defaultMessage:"No orders yet"})}),s.jsx("div",{className:"text-token-text-secondary text-xs",children:s.jsx(_,{id:"LwFNFv",defaultMessage:"Products you buy with ChatGPT will show here."})})]})}const se=({order:t,onClick:e})=>{var a;return s.jsxs("button",{className:"my-3",onClick:e,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{children:s.jsx("img",{className:"border-token-border-default bg-token-bg-primary shadow-xxs relative h-14 w-14 rounded-[10px] border border-[.5px]",src:(a=t.image_url)!=null?a:"",alt:t.title})}),s.jsxs("div",{className:"flex flex-1 flex-col items-start justify-start gap-0.5",children:[s.jsx("div",{className:"-mt-1 line-clamp-2 text-start text-base",children:t.title}),s.jsx("div",{className:"text-token-text-secondary text-xs",children:t.subtitle})]}),s.jsx("div",{className:"me-2 flex items-center justify-center",children:s.jsx(Z,{className:"icon"})})]}),t.error_message&&s.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mt-3 flex items-center rounded-lg px-3 py-1 text-sm",children:t.error_message})]})},te=({orderId:t})=>{var c,n,l,d,h;const{data:e,isLoading:a}=E({queryKey:["order",t],queryFn:()=>K(t),staleTime:C,refetchOnMount:"always",refetchOnWindowFocus:"always"}),r=L();return z.useEffect(()=>{(e!=null&&e.order.conversation_id||e!=null&&e.order.shared_conversation_url)&&t&&b.logEventWithStatsig("product_order_history","product_order_history",g(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"shown",order_id:t,shared_conversation_url:e.order.shared_conversation_url}))},[e==null?void 0:e.order.conversation_id,e==null?void 0:e.order.shared_conversation_url,t]),s.jsxs("div",{children:[s.jsxs("div",{className:"h-header-height my-1 -ms-1 flex flex-shrink-0 items-center gap-2",children:[s.jsx(w,{color:"ghost",size:"medium",onClick:()=>T(r,void 0),contentWrapperClassName:"gap-[6px]",className:"w-9 rounded-lg",children:s.jsx(D,{className:"icon icon-sm"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(U,{className:"icon h-[18px] w-[18px] rounded-full",url:(c=e==null?void 0:e.merchant_logo_url)!=null?c:"",size:128,minSize:16,fallback:s.jsx(X,{className:"text-token-text-tertiary"})}),s.jsx("div",{className:"text-sm font-normal",children:e==null?void 0:e.merchant_title})]}),s.jsx("div",{className:"text-token-text-secondary text-xs",children:e==null?void 0:e.merchant_subtitle})]})]}),a?s.jsx(M,{}):e?s.jsxs("div",{className:"flex flex-col pt-1 pb-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"bg-token-bg-tertiary dark:bg-token-main-surface-primary-inverse overflow-clip rounded-lg",children:s.jsx("img",{className:"m-0 aspect-square h-32 w-32 object-cover mix-blend-darken",src:(n=e==null?void 0:e.image_url)!=null?n:"",alt:(l=e==null?void 0:e.title)!=null?l:""})}),s.jsxs("div",{className:"flex flex-1 flex-col gap-0.5",children:[s.jsx("div",{className:"text-normal line-clamp-2 text-[17px] font-medium",children:e.title}),s.jsx("div",{className:"text-token-text-secondary text-sm",children:e==null?void 0:e.subtitle}),s.jsxs("div",{className:"mt-2 flex w-full flex-1 items-end gap-2",children:[((d=e.order.conversation_id)!=null?d:e.order.shared_conversation_url)&&s.jsx(w,{as:"a",to:e.order.shared_conversation_url||W(e.order.conversation_id),onClick:o=>{o.stopPropagation(),b.logEventWithStatsig("product_order_history","product_order_history",g(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"open_conversation_button_clicked",order_id:t,shared_conversation_url:e.order.shared_conversation_url}))},color:"ghost",className:"border-token-border-light rounded-2xl border px-4",children:s.jsx(_,{id:"bLLnUh",defaultMessage:"Open in ChatGPT"})}),e.external_buttons.map((o,i)=>s.jsx(s.Fragment,{children:s.jsx(w,{as:"a",to:o.url,openNewTab:!0,onClick:u=>{u.stopPropagation(),b.logEventWithStatsig("product_order_history","product_order_history",g(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"external_link_button_clicked",url:o.url,order_id:t}))},color:"ghost",className:"border-token-border-light rounded-2xl border px-4",children:o.title},"".concat(o.title,"-").concat(i))}))]})]})]}),e.error_message&&s.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mt-4 flex items-center rounded-lg px-3 py-1 text-sm",children:e.error_message}),s.jsx("div",{className:"mt-8 flex flex-col gap-8",children:(h=e==null?void 0:e.sections)==null?void 0:h.map(o=>s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"border-token-border-light border-b pb-2.5 text-base font-medium",children:o.title}),s.jsx("dl",{className:"divide-token-border-light divide-y",children:o.items.map(i=>s.jsxs("div",{className:"text-token-text-primary flex items-start gap-2 py-2.5 text-sm",children:[s.jsx("dt",{className:"flex-grow text-sm",children:i.label}),s.jsx("dd",{className:"text-end text-sm font-medium whitespace-pre",children:s.jsx(V,{remarkPlugins:[[$,{singleTilde:!1}]],components:{a:u=>s.jsx("a",g(p({},u),{className:B(u.className,"underline"),target:"_blank",children:u.children}))},children:i.value})})]},i.label))})]},o.title))})]}):null]})},T=(t,e)=>{const a=window.location.hash,[r,c]=a.split("?"),n=new URLSearchParams(c);e?n.set("order",e):n.delete("order");const l="#settings/".concat(G.Orders).concat(n.toString()?"?".concat(n.toString()):"");t(l,{replace:!0})},ae=()=>{const t=window.location.hash,[e,a]=t.split("?");return new URLSearchParams(a).get("order")};export{ue as O,de as a,he as c,me as g,T as s,xe as u};
//# sourceMappingURL=hoo89wr86agqpm13.js.map

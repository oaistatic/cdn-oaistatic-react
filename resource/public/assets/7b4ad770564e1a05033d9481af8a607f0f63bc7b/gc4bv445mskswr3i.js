const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
import{h as j,u as J,d as L,i as W,j as e,M as i,_ as F,a9 as K,ag as Y,r as T,F as ee,y as ae}from"./kfrdmkli83ureki3.js";import{p as z,aC as $,db as p,cy as te,az as V,dk as se,dT as ne,e6 as ie,cq as w,aB as f,aA as q}from"./kw08ajijqinojrwh.js";import{N as re}from"./bri823nczhk5gr7r.js";import{e5 as oe}from"./fyw02vlaiv2vq6cj.js";import{W as le}from"./e1cxccp3u9us8gn7.js";import{W as me}from"./goxcf7vc701q04ob.js";import{R as de,I,S as ce}from"./oaj1k9dxyi6fkrjm.js";import{u as ue}from"./fx0u8y75z4qg1qfs.js";import{k as h,W as U,v as ge,i as fe,c as he}from"./oyvo09ze11a90qsd.js";import{E as pe}from"./hzc9tt7ii8vra0by.js";import{P as xe,a as ve}from"./lptwpbjabrvjmhsj.js";import"./mxzgpx7wtm4zk5cj.js";import"./cn1z5fx9l5xxo8vy.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./i8h8r8n4rn16l2h5.js";import"./n6eim64jp78x17ti.js";import"./d24clsve229czwkp.js";import"./f1g778pkk2fhpy9x.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./dd8hh2tmra1psngf.js";import"./e96bwg1s7x4og2fp.js";import"./fxythiulbb2q3qno.js";import"./fux1oumbpb3w9e7e.js";import"./lafhvalu919ojf7s.js";import"./jz5yvmwm8tdb0l95.js";import"./abvgi6h30lz61l9g.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./h1em0bjkpkjv8ykw.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";function Me({environmentId:s,onClose:a}){const n=j(),o=z(),l=J(),d=L(),g=h(c=>c.setEnvironmentId),x=h(c=>c.setBranch),{mutate:t,isPending:v}=W({mutationFn:()=>U.deleteEnvironment(s),onSuccess:async()=>{ge(l,s),await fe(l),h.getState().environmentId===s&&(g(null),x(null)),o.success(n.formatMessage({id:"wham.deleteEnvironmentModal.environmentDeletedSuccessfully",defaultMessage:"Environment deleted successfully"})),a(),d("/codex/settings/environments")},onError:()=>{o.danger(n.formatMessage({id:"wham.deleteEnvironmentModal.failedToDeleteEnvironment",defaultMessage:"Failed to delete environment"}))}});return e.jsx($,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(i,{id:"wham.deleteEnvironmentModal.title",defaultMessage:"Delete environment"}),onClose:a,primaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.deleteEnvironmentModal.delete",defaultMessage:"Delete"}),color:"danger",loading:v,onClick:()=>{t()}}),secondaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.deleteEnvironmentModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:a}),children:e.jsx("div",{className:"text-sm",children:e.jsx(i,{id:"wham.deleteEnvironmentModal.message",defaultMessage:"Tasks that use it will remain, but users wonâ€™t be able to create follow-up tasks."})})})}function r({label:s,children:a,className:n}){return e.jsxs("div",{className:te("flex flex-col gap-1",n),children:[e.jsx("dt",{className:"text-token-text-primary text-sm font-medium",children:s}),e.jsx("dd",{className:"text-token-text-primary text-sm font-normal",children:a})]})}function we({environmentId:s,onClose:a}){const n=j(),o=z(),{mutate:l,isPending:d}=W({mutationFn:()=>U.invalidateEnvironmentCache(s),onSuccess:()=>{o.success(n.formatMessage({id:"wham.resetCacheModal.cacheResetSuccessfully",defaultMessage:"Cache reset successfully"})),a()},onError:()=>{o.danger(n.formatMessage({id:"wham.resetCacheModal.failedToResetCache",defaultMessage:"Failed to reset cache"}))}});return e.jsx($,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(i,{id:"wham.resetEnvironmentCacheModal.title",defaultMessage:"Reset cache"}),onClose:a,primaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.resetEnvironmentCacheModal.delete",defaultMessage:"Reset"}),color:"danger",loading:d,onClick:()=>{l()}}),secondaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.resetEnvironmentCacheModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:a}),children:e.jsx("div",{className:"text-sm",children:e.jsx(i,{id:"wham.resetEnvironmentCacheModal.message",defaultMessage:"All currently cached containers will be invalidated. The cache will be cleared for all users."})})})}const je=V(()=>F(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zh),__vite__mapDeps([0,1,2,3,4])),{loading:s=>q(s)}),Ee=V(()=>F(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zL),__vite__mapDeps([0,1,2,3,4])),{loading:s=>q(s)});function _e(){const{environmentId:s}=K(),{eligible:a}=oe();return a?e.jsx(Y,{to:"/codex"}):s?e.jsx(ye,{environmentId:s}):e.jsx(re,{})}function be(s){return s==null||s.setup==null?!1:Array.isArray(s.setup)?s.setup.length>0&&s.setup.every(a=>a!==""):s.setup!==""}function De(s,a,n){var o,l;return s?!!((l=(o=s.permissions)==null?void 0:o.can_write)!=null&&l||n!=null&&n.isAdminOfAccount()||(a==null?void 0:a.email)===s.creator.email):!1}function Pe(s,a,n){var o,l;return s?!!((l=(o=s==null?void 0:s.permissions)==null?void 0:o.can_delete)!=null&&l||n!=null&&n.isAdminOfAccount()||(a==null?void 0:a.email)===s.creator.email):!1}function ye({environmentId:s}){var D,P,y,N,k,C,S,A,O,R;const a=j(),n=L(),[o,l]=T.useState(!1),[d,g]=T.useState(!1),x=h(m=>m.setEnvironmentId),{data:t,isLoading:v,isError:c}=he(s),E=se(),u=ne(),_=De(t,E,u),b=Pe(t,E,u),X=ue(),M=u==null?void 0:u.name,H=M!=null?M:a.formatMessage({id:"wham.environmentDetailsPage.workspace",defaultMessage:"Workspace"}),Q=!be(t)&&(t==null?void 0:t.auto_setup_settings)==null,Z=(P=(D=t==null?void 0:t.auto_setup_settings)==null?void 0:D.use_auto_setup)!=null?P:Q;return e.jsxs(le,{topPadding:!0,showSidebar:!1,children:[e.jsx("div",{className:"flex flex-col px-8 md:px-16",children:v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(ie,{})}):c?e.jsx(pe,{title:a.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironment",defaultMessage:"Error loading environment"}),description:a.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironmentDescription",defaultMessage:"Error loading environment description"})}):t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-default flex flex-col justify-between gap-2 border-b pb-4",children:e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs(de,{children:[e.jsx(I,{label:a.formatMessage({id:"wham.environmentDetailsPage.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(ce,{}),e.jsx(I,{label:t.label,url:"/codex/settings/environment/".concat(s),className:"text-token-text-primary font-medium"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(w,{label:b?void 0:a.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentTooltip",defaultMessage:"Only creators or editors of the environment, or an admin, can delete an environment"}),children:e.jsx(f,{color:"danger-outline",onClick:()=>l(!0),disabled:!b,"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentAriaLabel",defaultMessage:"Button to delete {environmentName}"},{environmentName:t.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.deleteEnvironment",defaultMessage:"Delete"})})}),e.jsx(w,{label:_?void 0:a.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentTooltip",defaultMessage:"Only creators or editors of the environment, or an admin, can edit an environment"}),children:e.jsx(f,{icon:je,onClick:()=>{n("/codex/settings/environment/".concat(s,"/edit"))},color:"secondary",disabled:!_,"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentAriaLabel",defaultMessage:"Button to edit {environmentName}"},{environmentName:t.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.editEnvironment",defaultMessage:"Edit"})})}),e.jsx(f,{size:"small",color:"secondary",onClick:()=>{x(s),me.recordClickEnv(),n("/codex")},"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.useEnvironmentAriaLabel",defaultMessage:"Button to use environment {environmentName} in a codex task"},{environmentName:t.label}),children:e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(i,{id:"wham.turnInfoRow.useEnvironment",defaultMessage:"Use this"}),e.jsx(Ee,{className:"icon-sm"})]})})]})]})}),e.jsx("div",{className:"text-token-text-primary py-8 text-xl",children:t.label}),e.jsxs("div",{className:"grid gap-x-12 gap-y-6 md:grid-cols-2",children:[e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.creator",defaultMessage:"Creator"}),children:t.creator.email}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.image",defaultMessage:"Image"}),children:t.machine.label||e.jsx(i,{id:"wham.environmentDetailsPage.noImage",defaultMessage:"No image"})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.description",defaultMessage:"Description"}),children:(y=t.description)!=null?y:e.jsx(i,{id:"wham.environmentDetailsPage.noDescription",defaultMessage:"N/A"})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.agentNetworkAccess",defaultMessage:"Agent internet access"}),children:((N=t.agent_network_access)==null?void 0:N.mode)==="on"?t.agent_network_access.preset_allowlist===xe?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.unrestricted",defaultMessage:"On: unrestricted"}):t.agent_network_access.preset_allowlist===ve?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.codex",defaultMessage:"On: common dependencies"}):e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.custom",defaultMessage:"On: custom domains"}):t.agent_network_access==null||t.agent_network_access.mode==="off"?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.off",defaultMessage:"Off"}):null}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.postSetupCaching",defaultMessage:"Post setup caching"}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[((k=t.cache_settings)==null?void 0:k.post_setup_cache_enabled)===!0?e.jsx(i,{id:"wham.environmentDetailsPage.postSetupCaching.on",defaultMessage:"On"}):e.jsx(i,{id:"wham.environmentDetailsPage.postSetupCaching.off",defaultMessage:"Off"}),((C=t.cache_settings)==null?void 0:C.post_setup_cache_enabled)&&e.jsx(w,{label:a.formatMessage({id:"wham.environmentDetailsPage.resetCacheTooltip",defaultMessage:"Invalidate any currently cached containers"}),children:e.jsx(f,{size:"small",onClick:()=>g(!0),color:"secondary","aria-label":a.formatMessage({id:"wham.environmentDetailsPage.resetCacheAriaLabel",defaultMessage:"Button to invalidate cache for {environmentName}"},{environmentName:t.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.resetCache",defaultMessage:"Reset cache"})})})]})}),((S=t.cache_settings)==null?void 0:S.post_setup_cache_enabled)&&e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.maintenanceSetupScript",defaultMessage:"Maintenance setup script"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(t.maintenance_setup)?t.maintenance_setup:[t.maintenance_setup]).filter(Boolean).join("\n")})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.environmentVariables",defaultMessage:"Environment variables"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys((A=t.env_vars)!=null?A:{}).filter(m=>!m.startsWith("CODEX_ENV_")).join("\n")})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.secrets",defaultMessage:"Secrets"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys((O=t.secrets)!=null?O:{}).join("\n")})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.createdAt",defaultMessage:"Created at"}),children:t.created_at?e.jsx(ee,{value:new Date(t.created_at*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(i,{id:"wham.environmentDetailsPage.noCreationDate",defaultMessage:"No creation date"})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.setupScript",defaultMessage:"Setup script"}),children:Z?e.jsx(i,{id:"wham.environmentDetailsPage.autoSetup.automatic",defaultMessage:"Automatic"}):e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(t.setup)?t.setup:[t.setup]).filter(Boolean).join("\n")})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.repository",defaultMessage:"Repository"}),children:t.repo_map?Object.values(t.repo_map).map(m=>m.repository_full_name):e.jsx(i,{id:"wham.environmentDetailsPage.noRepository",defaultMessage:"No repository"})}),e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.numTasks",defaultMessage:"No. of tasks"}),children:(R=t.task_count)!=null?R:0}),X&&e.jsxs(e.Fragment,{children:[e.jsx(r,{label:a.formatMessage({id:"94ZVks",defaultMessage:"Share"}),children:t.share_settings==="workspace"?a.formatMessage({id:"wham.environmentDetailsPage.sharedWithWorkspace",defaultMessage:"Shared with {workspaceName}"},{workspaceName:H}):a.formatMessage({id:"wham.environmentDetailsPage.private",defaultMessage:"Private"})}),t.share_settings!=="private"&&e.jsx(r,{label:a.formatMessage({id:"wham.environmentDetailsPage.shareTargets",defaultMessage:"Additional editors"}),children:t.share_targets&&t.share_targets.length>0?e.jsx("div",{className:"flex flex-col gap-1",children:t.share_targets.map((m,G)=>{var B;return e.jsx("span",{children:m.email},"".concat((B=m.type)!=null?B:"user","-").concat(m.email,"-").concat(G))})}):e.jsx(i,{id:"wham.environmentDetailsPage.shareTargetsNone",defaultMessage:"None"})})]})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(i,{id:"wham.environmentDetailsPage.environmentNotFound",defaultMessage:"Environment not found"})})}),o&&e.jsx(Me,{environmentId:s,onClose:()=>l(!1)}),d&&e.jsx(we,{environmentId:s,onClose:()=>g(!1)})]})}const ca=()=>[{title:"Codex"}],ua=ae(function(){return e.jsx(_e,{})});export{ua as default,ca as meta};
//# sourceMappingURL=gc4bv445mskswr3i.js.map

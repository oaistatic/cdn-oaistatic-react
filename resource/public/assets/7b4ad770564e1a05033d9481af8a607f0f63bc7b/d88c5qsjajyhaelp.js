const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/h48j4g76f726xzx4.js","assets/kfrdmkli83ureki3.js","assets/fyw02vlaiv2vq6cj.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/k2qubbcyaku76gbs.js","assets/op0mk9py5p8nmkr9.js","assets/l233qajtxk4u5anh.js"])))=>i.map(i=>d[i]);
var _e=Object.defineProperty,je=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var ne=(s,e,r)=>e in s?_e(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,F=(s,e)=>{for(var r in e||(e={}))oe.call(e,r)&&ne(s,r,e[r]);if(K)for(var r of K(e))le.call(e,r)&&ne(s,r,e[r]);return s},L=(s,e)=>je(s,ye(e));var ce=(s,e)=>{var r={};for(var a in s)oe.call(s,a)&&e.indexOf(a)<0&&(r[a]=s[a]);if(s!=null&&K)for(var a of K(s))e.indexOf(a)<0&&le.call(s,a)&&(r[a]=s[a]);return r};import{j as t,_ as O,h as E,c as B,M as C,r as ee,e as ke,R as G,a as be,d as Ne,y as Me,a9 as we}from"./kfrdmkli83ureki3.js";import{c as Se,r as Pe,s as de,f as X,A as Ae,S as Ce,a as $,F as Q,P as Ee,b as xe,m as Te,d as De,p as pe,e as Re,u as Fe,E as te,g as Ie}from"./cg9zyx3f2s9b21n8.js";import{A as Le,a as Be,b as Ve}from"./dy2d092duzrccyw9.js";import{ak as $e,al as se,qF as Ge,qG as Oe}from"./fyw02vlaiv2vq6cj.js";import{az as H,aA as q,p as re,cy as Y,R as He,D as me,aB as qe,e6 as Ue,u as ze,ih as We,nD as Ke}from"./kw08ajijqinojrwh.js";import{A as Qe,p as Je,P as Xe,D as Ye,C as Ze}from"./eb8h7c171jyixp4q.js";import{R as et}from"./oyvo09ze11a90qsd.js";import{g as Z}from"./kmtsjg7uv0tesj55.js";import{M as ae}from"./m3joncw451cqbul2.js";import{r as fe}from"./i7t1qh3u8s8bvtb8.js";import{b as tt}from"./mj0406dyy526560j.js";import"./l58qw9nc0ur9qkul.js";import"./fbnp4n11buhgth4v.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./dd8hh2tmra1psngf.js";import"./giwakgarsud1rsxv.js";import"./pbjg7z6w7wj6b69y.js";import"./fy52bb9t6zneap2s.js";import"./lafhvalu919ojf7s.js";import"./lptwpbjabrvjmhsj.js";import"./l8r2q1y684enjq2l.js";import"./j3xa7zoduffqfxbm.js";import"./gf4c0f98pdaqc94a.js";import"./idxukd613qgy7urm.js";import"./jqc82mvozbbjvbcp.js";import"./et0kjfzq519mr3zi.js";import"./dn55ejno9ewvlhxs.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./h1em0bjkpkjv8ykw.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";import"./gy1lpvuoewmzh42c.js";import"./kbj1b07s2z6vxqkg.js";import"./n25jb1xrdrimv99m.js";import"./nm285usnll51g0n4.js";import"./moa9hw4knutxpmay.js";import"./nh6x5pasrftsddpw.js";import"./c7lf6x6u521mpx19.js";import"./hk5ml9l4i4ups2ga.js";import"./fwbhrttgqnv5nm9m.js";function T({title:s,children:e,className:r=""}){return t.jsx("div",{className:"border-token-border-light bg-token-main-surface-primary ring-token-border-light/60 overflow-hidden rounded-lg border p-4 shadow ring-1 shadow-black/20 md:p-5 dark:shadow-black/60 dark:ring-white/10 ".concat(r),children:t.jsxs("section",{children:[s&&t.jsx("div",{className:"text-title-small mb-5 font-semibold tracking-wide",children:s}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:e})]})})}function A({label:s,children:e}){return t.jsxs("div",{className:"grid grid-cols-2 items-start gap-1 text-sm md:grid-cols-[auto,1fr] md:gap-2",children:[t.jsx("div",{className:"text-token-text-tertiary md:w-44",children:s}),t.jsx("div",{className:"w-full min-w-0 overflow-hidden break-words hyphens-auto",children:e})]})}const st=H(()=>O(()=>import("./h48j4g76f726xzx4.js"),__vite__mapDeps([0,1])),{loading:s=>q(s)});function ue(s){if(s==null)return"";const e=String(s).trim();return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1).trim():e}function at({finding:s}){var g,h,p,i,v,f;const e=E(),r=re(),a=s,m=a.patch_generated,n=m==null?!!a.proposed_patch:String(m).toLowerCase()==="true",o=(h=(g=a.commit_analysis)==null?void 0:g.commit_hash)!=null?h:"",u=Se(a.repo_url,o);return t.jsxs(T,{title:e.formatMessage({id:"aardvark.findings.metadataTitle",defaultMessage:"Metadata"}),children:[t.jsxs("div",{className:"grid grid-cols-1 items-stretch gap-3 text-sm",children:[t.jsx(A,{label:e.formatMessage({id:"aardvark.table.repo",defaultMessage:"Repository"}),children:a.repo_url?t.jsx("a",{href:a.repo_url,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent hover:underline",children:Pe(a.repo_url)}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})})}),t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.commit",defaultMessage:"Commit"}),children:u?t.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent font-mono text-xs hover:underline",children:de(o)}):t.jsx("code",{className:"bg-token-bg-elevated-secondary rounded px-1 py-0.5 text-[10px]",children:de(o)})}),t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.author",defaultMessage:"Author"}),children:t.jsxs("div",{className:"flex min-w-0 flex-col",children:[(()=>{var c;const l=ue((c=a.commit_analysis)==null?void 0:c.author);return l?t.jsx("span",{className:"truncate",children:l}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"})})})(),(()=>{var c;const l=ue((c=a.commit_analysis)==null?void 0:c.author_email);return l?t.jsx("span",{className:"text-token-text-tertiary font-mono text-xs break-all",children:l}):null})()]})}),t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.authoredAt",defaultMessage:"Authored at"}),children:X((i=(p=a.commit_analysis)==null?void 0:p.author_date)!=null?i:null)}),t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.committedAt",defaultMessage:"Committed at"}),children:X((f=(v=a.commit_analysis)==null?void 0:v.committer_date)!=null?f:null)}),t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.createdAt",defaultMessage:"Detected at"}),children:X(a.created_at)}),t.jsx(A,{label:e.formatMessage({id:"aardvark.table.assignee",defaultMessage:"Assignee"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Ae,{finding:a})})}),t.jsx(A,{label:e.formatMessage({id:"aardvark.table.status",defaultMessage:"Status"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Ce,{finding:a})})}),(()=>{var _,k,x;const l=(_=a==null?void 0:a.commit_analysis)!=null?_:{},c=String((k=l.security_related)!=null?k:"no").toLowerCase()==="yes",d=String((x=l.privacy_related)!=null?x:"no").toLowerCase()==="yes",j=l.validated===!0||String(l.validated).toLowerCase()==="true";return!c&&!d&&!j&&!n?null:t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.signals",defaultMessage:"Signals"}),children:t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c&&t.jsx($,{variant:"critical",children:e.formatMessage(Q.security)}),d&&t.jsx($,{variant:"warning",children:e.formatMessage(Q.privacy)}),j&&t.jsx($,{variant:"success",children:e.formatMessage(Q.validated)}),n&&t.jsx($,{variant:"purple",children:e.formatMessage(Q.patch)})]})})})(),a.resolution_reason?t.jsx(A,{label:e.formatMessage({id:"aardvark.findings.resolutionReason",defaultMessage:"Resolution notes"}),children:t.jsxs("div",{className:"text-sm whitespace-pre-wrap",children:[a.resolution_reason,a.resolution_set_by_email?t.jsx("div",{className:"text-token-text-tertiary mt-1 text-xs",children:e.formatMessage({id:"aardvark.findings.resolutionSetBy",defaultMessage:"Set by {email}"},{email:a.resolution_set_by_email})}):null]})}):null]}),t.jsxs("div",{className:"mt-3 grid grid-cols-1 items-stretch gap-3 p-1 sm:grid-cols-2",children:[u&&t.jsx(rt,{commitUrlStr:u}),t.jsx($e,{className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",iconClassName:"icon-sm",buttonText:e.formatMessage({id:"aardvark.actions.share",defaultMessage:"Share link"}),onCopy:l=>{const c=typeof window<"u"&&window.location?"".concat(window.location.origin).concat(window.location.pathname):"";se(c,r,l),r.successNeutral(e.formatMessage({id:"aardvark.toast.linkCopied",defaultMessage:"Link copied"}),{duration:2})}})]})]})}function rt({commitUrlStr:s}){const e=E();return t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",children:[t.jsx(st,{className:"icon-sm me-1","aria-hidden":!0}),e.formatMessage({id:"aardvark.actions.openGithub",defaultMessage:"Open in GitHub"})]})}const it={pending:"muted",running:"warning",failed:"danger",success:"success",unknown:"muted"},nt=s=>s.status=="created"?"pending":s.status=="patch_generation_running"?"running":s.status=="patch_generation_failed"?"failed":s.patch_generation_success?"success":"unknown",ot=s=>s.status=="created"?"pending":s.status=="awaiting_validation"?"running":s.status=="failed_validation"?"failed":s.status=="validated"?"success":"unknown";function ge(s){"use forget";const e=B.c(9),{task:r,mode:a}=s,m=E();let n;e[0]!==a||e[1]!==r?(n=a=="generation"?nt(r):ot(r),e[0]=a,e[1]=r,e[2]=n):n=e[2];const o=n,u=it[o];let g;e[3]!==m||e[4]!==o?(g=m.formatMessage(Ee[o]),e[3]=m,e[4]=o,e[5]=g):g=e[5];const h=g;let p;return e[6]!==h||e[7]!==u?(p=t.jsx($,{variant:u,children:h}),e[6]=h,e[7]=u,e[8]=p):p=e[8],p}function lt(s){"use forget";var D,V;const e=B.c(34),{latestTask:r,turn:a,formatStepTime:m}=s,n=r==null?void 0:r.patch_generation_submitted_at,o=(V=(D=a==null?void 0:a.latest_event)==null?void 0:D.created)!=null?V:null;let u;if(e[0]!==a){const N=a&&Array.isArray(a.output_items)?xe(Z(a,"output_items",[]),ft):[],M=Te(N,dt);u=a?L(F({},a),{output_items:[...M]}):null,e[0]=a,e[1]=u}else u=e[1];const g=u;let h;e[2]!==m||e[3]!==n?(h=n?m(n):null,e[2]=m,e[3]=n,e[4]=h):h=e[4];const p=h;let i;e[5]!==m||e[6]!==o?(i=o?m(o):null,e[5]=m,e[6]=o,e[7]=i):i=e[7];const v=i;let f;if(e[8]!==v||e[9]!==p){if(f=[],p){let N;e[11]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx(C,{id:"aardvark.proposedPatch.patchGeneration.startedLabel",defaultMessage:"Started"}),e[11]=N):N=e[11];let M;e[12]!==p?(M={key:"started",label:N,value:p},e[12]=p,e[13]=M):M=e[13],f.push(M)}if(v){let N;e[14]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx(C,{id:"aardvark.proposedPatch.patchGeneration.finishedLabel",defaultMessage:"Completed"}),e[14]=N):N=e[14];let M;e[15]!==v?(M={key:"finished",label:N,value:v},e[15]=v,e[16]=M):M=e[16],f.push(M)}e[8]=v,e[9]=p,e[10]=f}else f=e[10];let l;e[17]!==a?(l=a?et(a):"",e[17]=a,e[18]=l):l=e[18];const c=l;let d,j;e[19]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:t.jsx(C,{id:"aardvark.proposedPatch.patchGeneration.title",defaultMessage:"Patch generation"})}),j=Y("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[19]=d,e[20]=j):(d=e[19],j=e[20]);let _;e[21]!==f?(_=f.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:f.map(ct)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(C,{id:"aardvark.proposedPatch.patchGeneration.noTiming",defaultMessage:"Timing details will appear once generation starts."})}),e[21]=f,e[22]=_):_=e[22];let k;e[23]!==r?(k=r&&t.jsx("div",{className:"sm:ms-4 sm:flex sm:min-w-[120px] sm:justify-end",children:t.jsx(ge,{task:r,mode:"generation"})}),e[23]=r,e[24]=k):k=e[24];let x;e[25]!==_||e[26]!==k?(x=t.jsxs("div",{className:j,children:[_,k]}),e[25]=_,e[26]=k,e[27]=x):x=e[27];let y;e[28]!==c||e[29]!==g?(y=g&&t.jsx(Qe,{assistantTurn:g,outputText:c,className:"text-token-text-secondary text-sm leading-6"}),e[28]=c,e[29]=g,e[30]=y):y=e[30];let I;return e[31]!==y||e[32]!==x?(I=t.jsxs(t.Fragment,{children:[d,x,y]}),e[31]=y,e[32]=x,e[33]=I):I=e[33],I}function ct(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function dt(s){return L(F({},s),{content:xe(Z(s,"content",[]),mt)})}function mt(s){return Z(s,"content_type")==="text"}function ft(s){return Z(s,"type")==="message"}function ut(s){"use forget";var k;const e=B.c(29),{latestTask:r,formatStepTime:a}=s,m=r==null?void 0:r.fix_checker_started_at,n=r==null?void 0:r.fix_checker_finished_at,o=(k=r==null?void 0:r.fix_checker_rubric)!=null?k:"";let u;e[0]!==a||e[1]!==m?(u=m?a(m):null,e[0]=a,e[1]=m,e[2]=u):u=e[2];const g=u;let h;e[3]!==a||e[4]!==n?(h=n?a(n):null,e[3]=a,e[4]=n,e[5]=h):h=e[5];const p=h;let i;if(e[6]!==p||e[7]!==g){if(i=[],g){let x;e[9]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(C,{id:"aardvark.proposedPatch.patchValidation.startedLabel",defaultMessage:"Started"}),e[9]=x):x=e[9];let y;e[10]!==g?(y={key:"started",label:x,value:g},e[10]=g,e[11]=y):y=e[11],i.push(y)}if(p){let x;e[12]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(C,{id:"aardvark.proposedPatch.patchValidation.finishedLabel",defaultMessage:"Completed"}),e[12]=x):x=e[12];let y;e[13]!==p?(y={key:"finished",label:x,value:p},e[13]=p,e[14]=y):y=e[14],i.push(y)}e[6]=p,e[7]=g,e[8]=i}else i=e[8];let v,f;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("div",{className:"text-token-text-tertiary mt-4 text-xs font-semibold tracking-wide uppercase",children:t.jsx("span",{children:t.jsx(C,{id:"aardvark.proposedPatch.patchValidation.title",defaultMessage:"Patch validation"})})}),f=Y("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[15]=v,e[16]=f):(v=e[15],f=e[16]);let l;e[17]!==i?(l=i.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:i.map(xt)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(C,{id:"aardvark.proposedPatch.patchValidation.noTiming",defaultMessage:"Validation timeline will populate once checks begin."})}),e[17]=i,e[18]=l):l=e[18];let c;e[19]!==r?(c=t.jsx(ge,{task:r,mode:"validation"}),e[19]=r,e[20]=c):c=e[20];let d;e[21]!==l||e[22]!==c?(d=t.jsxs("div",{className:f,children:[l,c]}),e[21]=l,e[22]=c,e[23]=d):d=e[23];let j;e[24]!==o?(j=o&&t.jsx("div",{className:"prose prose-sm text-token-text-secondary mb-4 max-w-none",children:t.jsx(ae,{children:o})}),e[24]=o,e[25]=j):j=e[25];let _;return e[26]!==d||e[27]!==j?(_=t.jsxs(t.Fragment,{children:[v,d,j]}),e[26]=d,e[27]=j,e[28]=_):_=e[28],_}function xt(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function pt(s){return typeof s!="object"||s==null||!("role"in s)||!("output_items"in s)?!1:s.role==="assistant"&&Array.isArray(s.output_items)}function gt(s){"use forget";const e=B.c(53),{proposed_patch:r,findingId:a,refetchFinding:m}=s,n=E(),o=re(),[u,g]=ee.useState(!1),[h,p]=ee.useState(!1);if(!r)return null;const i=r.latest_task;if(!i){let c;e[0]!==n?(c=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[0]=n,e[1]=c):c=e[1];let d;e[2]!==n?(d=n.formatMessage({id:"aardvark.proposedPatch.noTaskAvailable",defaultMessage:"A proposed patch has not been generated yet."}),e[2]=n,e[3]=d):d=e[3];let j;e[4]!==d?(j=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:d}),e[4]=d,e[5]=j):j=e[5];let _;return e[6]!==c||e[7]!==j?(_=t.jsx(T,{title:c,children:j}),e[6]=c,e[7]=j,e[8]=_):_=e[8],_}const v=i.codex_task_turn,f=pt(v==null?void 0:v.turn)?v.turn:null;let l;if(e[9]!==f||e[10]!==a||e[11]!==n||e[12]!==h||e[13]!==i||e[14]!==r.id||e[15]!==m||e[16]!==o||e[17]!==u){const c=f?Je({assistantTurn:f}):[],d=c.map(_t).join("\n\n"),j=async()=>{try{await se(d,o),o.successNeutral(n.formatMessage(J.copyPatchSuccess),{duration:5,hasCloseButton:!0})}catch(b){}};let _;e[19]!==d||e[20]!==n||e[21]!==o?(_=async()=>{try{await se("git apply - <<PATCH\n"+d+"\nPATCH",o),o.successNeutral(n.formatMessage(J.copyApplySuccess),{duration:5,hasCloseButton:!0})}catch(b){}},e[19]=d,e[20]=n,e[21]=o,e[22]=_):_=e[22];const k=_;let x;e[23]!==a||e[24]!==n||e[25]!==h||e[26]!==i.codex_task_id||e[27]!==i.codex_task_turn_id||e[28]!==m||e[29]!==o?(x=async b=>{if(!(i!=null&&i.codex_task_id)||!(i!=null&&i.codex_task_turn_id)||!a||h)return;p(!0);const w={parameters:{path:{id:a}},requestBody:{}};b!==void 0&&(w.requestBody.mode=b);try{if(await He.safePost("/aardvark/scan-findings/{id}/pr",w),m)try{await m()}catch(P){const S=P;let R;S instanceof Error?R=S.message:R=String(S),me.addError("aardvark.proposedPatch.refetchFindingError",{findingId:a,message:R})}o.successNeutral(n.formatMessage(J.createPrSuccess),{duration:3,hasCloseButton:!0})}catch(P){const S=P;me.addError("aardvark.proposedPatch.createPrError",{findingId:a,taskId:i.codex_task_id,taskTurnId:i.codex_task_turn_id,mode:b!=null?b:null,message:S instanceof Error?S.message:String(S)}),o.danger(n.formatMessage(J.createPrError),{duration:3,hasCloseButton:!0}),p(!1);return}p(!1)},e[23]=a,e[24]=n,e[25]=h,e[26]=i.codex_task_id,e[27]=i.codex_task_turn_id,e[28]=m,e[29]=o,e[30]=x):x=e[30];const y=x,I=!!(i!=null&&i.codex_task_id)&&!!(i!=null&&i.codex_task_turn_id)&&!!a;let D;e[31]===Symbol.for("react.memo_cache_sentinel")?(D=function(w){return w?typeof w=="string"?X(w):De(w):null},e[31]=D):D=e[31];const V=D;let N;e[32]!==n?(N=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[32]=n,e[33]=N):N=e[33];let M;e[34]!==f||e[35]!==i?(M=t.jsx(lt,{latestTask:i,turn:f,formatStepTime:V}),e[34]=f,e[35]=i,e[36]=M):M=e[36];let U;e[37]!==i?(U=t.jsx(ut,{latestTask:i,formatStepTime:V}),e[37]=i,e[38]=U):U=e[38];let z;if(c.length>0){let b;e[39]!==u?(b=t.jsx(Ye,{unifiedDiff:u,setUnifiedDiff:g,showFullDiff:!1,setShowFullDiff:vt}),e[39]=u,e[40]=b):b=e[40];const w=t.jsxs("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[b,t.jsx(Xe,{copyApplyToClipboard:k,copyPatchToClipboard:j,createPr:y,navigateToCreatingPrPage:ht,updateBranch:void 0,canCreatePr:I,isCreatingPr:h,permissions:"write",assistantTurn:f,showOnlyViewPr:!1})]});let P;e[41]!==w?(P=t.jsx("div",{className:"mb-2 flex w-full flex-col gap-2",children:w}),e[41]=w,e[42]=P):P=e[42];let S;e[43]!==r.id||e[44]!==u?(S=(he,ve)=>{var ie;return t.jsx(Ze,{diff:he,viewType:u?"unified":"split",stickyHeader:!1},"".concat((ie=r==null?void 0:r.id)!=null?ie:"diff","-canonical-").concat(ve))},e[43]=r.id,e[44]=u,e[45]=S):S=e[45];const R=t.jsx("div",{className:"flex flex-col gap-4",children:c.map(S)});let W;e[46]!==P||e[47]!==R?(W=t.jsxs(t.Fragment,{children:[P,R]}),e[46]=P,e[47]=R,e[48]=W):W=e[48],z=W}else if((i==null?void 0:i.status)==="patch_generation_running")z=null;else{let b;e[49]!==n?(b=n.formatMessage({id:"aardvark.proposedPatch.noDiffsInHead",defaultMessage:"No diffs—this usually means the issue no longer exists in HEAD."}),e[49]=n,e[50]=b):b=e[50];let w;e[51]!==b?(w=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:b}),e[51]=b,e[52]=w):w=e[52],z=w}l=t.jsxs(T,{title:N,children:[M,U,z]}),e[9]=f,e[10]=a,e[11]=n,e[12]=h,e[13]=i,e[14]=r.id,e[15]=m,e[16]=o,e[17]=u,e[18]=l}else l=e[18];return l}function ht(){}function vt(){}function _t(s){var e;return(e=s.hunksText)!=null?e:""}const J=ke({createPrSuccess:{id:"aardvark.proposedPatch.createPrSuccess",defaultMessage:"Pull request created"},createPrError:{id:"aardvark.proposedPatch.createPrErrorToast",defaultMessage:"Failed to create pull request"},copyPatchSuccess:{id:"aardvark.proposedPatch.copyPatchSuccess",defaultMessage:"Patch copied"},copyApplySuccess:{id:"aardvark.proposedPatch.copyApplySuccess",defaultMessage:"Command copied"}}),jt=H(()=>O(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zE),__vite__mapDeps([2,1,3,4,5])),{loading:s=>q(s)});function yt({content:s,start:e,className:r=""}){const a=G.useMemo(()=>s.trimEnd().split("\n"),[s]),m=typeof e=="number"?e:1;return t.jsx("div",{className:"bg-token-bg-elevated-secondary overflow-auto rounded ".concat(r),style:{maxHeight:400},children:t.jsx("table",{className:"w-full border-separate border-spacing-0",children:t.jsx("tbody",{children:a.map((n,o)=>t.jsxs("tr",{className:"align-top",children:[t.jsx("td",{className:"text-token-text-tertiary py-0.5 ps-3 pe-3 text-end align-top text-[11px] whitespace-nowrap select-none",children:m+o}),t.jsx("td",{className:"py-0.5 pe-3 font-mono text-sm whitespace-pre",children:n===""?" ":n})]},o))})})})}function kt({finding:s}){var u,g,h,p;const e=E();let r=(g=(u=s.commit_analysis)==null?void 0:u.relevant_lines)!=null?g:[],a=Array.isArray(r)&&r.length>0;const m=(h=s.commit_analysis)==null?void 0:h.proposed_patch,n=typeof m=="string"&&m.trim().length>0;if(!a){const i=pe(m);r=(p=i==null?void 0:i.relevant_lines)!=null?p:[],a=Array.isArray(r)&&r.length>0}if(!a){if(n)return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.detailsTitle",defaultMessage:"Details"}),children:t.jsx("div",{className:"p-2",children:m})});if(!n)return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.evidence",defaultMessage:"Evidence"}),children:t.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.formatMessage({id:"aardvark.findings.noEvidence",defaultMessage:"No evidence available."})})})}const o=(()=>{var v,f,l,c;const i=new Map;for(const d of r){const j=d.path||(d==null?void 0:d.file_path)||"(unknown)",_=(v=d.start_line_number)!=null?v:0,k=(l=(f=d.end_line_number)!=null?f:d.start_line_number)!=null?l:0,x="".concat(j,"|").concat(_,"-").concat(k),y=(c=i.get(x))!=null?c:[];y.push(d),i.set(x,y)}return Array.from(i.entries()).sort((d,j)=>d[0].localeCompare(j[0]))})();return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.relevantLinesTitle",defaultMessage:"Relevant lines"}),children:t.jsx("div",{className:"space-y-3",children:o.map(([i,v])=>{const[f,l]=i.split("|");return t.jsxs("details",{open:!0,className:"group ring-token-border-light bg-token-main-surface-primary rounded-lg ring-1",children:[t.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium select-none",children:[t.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[t.jsx(jt,{className:"icon-sm text-token-text-tertiary transition-transform group-open:rotate-180","aria-hidden":!0}),t.jsx("span",{className:"truncate",children:f})]}),t.jsx("span",{className:"text-token-text-tertiary ms-2 text-xs whitespace-nowrap",children:e.formatMessage({id:"aardvark.findings.lineRange",defaultMessage:"L{range}"},{range:l==null?void 0:l.replace("-","–")})})]}),t.jsx("div",{children:v.map((c,d)=>t.jsxs("div",{className:"space-y-2",children:[c.comment&&t.jsx("p",{className:"text-token-text-secondary mb-0 bg-yellow-50/60 px-3 py-3 text-sm dark:bg-yellow-900/30",children:c.comment}),c.content&&t.jsx(yt,{content:c.content,start:c.start_line_number,className:"mb-0"})]},"".concat(i,"-").concat(d)))})]},i)})})})}const bt=H(()=>O(()=>import("./k2qubbcyaku76gbs.js"),__vite__mapDeps([6,1])),{loading:s=>q(s)});function Nt({finding:s}){var o,u,g,h,p;const e=E(),r=s,a=G.useMemo(()=>{var i;return pe((i=r.commit_analysis)==null?void 0:i.proposed_patch)},[(o=r.commit_analysis)==null?void 0:o.proposed_patch]),m=G.useMemo(()=>{var i,v,f;return(f=(v=a==null?void 0:a.cvss_score)!=null?v:(i=r.commit_analysis)==null?void 0:i.cvss_score)!=null?f:null},[a,r.commit_analysis]),n=G.useMemo(()=>{var i,v,f;return(f=(v=a==null?void 0:a.criticality_cvss_reason)!=null?v:(i=r.commit_analysis)==null?void 0:i.criticality_cvss_score_reason)!=null?f:null},[a,r.commit_analysis]);return t.jsxs(T,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[((u=r.commit_analysis)==null?void 0:u.title)||e.formatMessage({id:"aardvark.findings.vulnerability",defaultMessage:"Vulnerability"}),t.jsx(Re,{level:r.criticality})]}),children:[t.jsx("div",{children:((g=r.commit_analysis)==null?void 0:g.bugs_found_or_fixed)&&t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(h=r.commit_analysis)==null?void 0:h.bugs_found_or_fixed})}),m!=null&&t.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-token-text-secondary flex items-center gap-1",children:t.jsx("div",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.cvssLabel",defaultMessage:"CVSS"})})}),t.jsxs("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-yellow-500 ring-amber-500/20",style:{backgroundColor:"rgba(245, 158, 11, 0.12)"},title:e.formatMessage({id:"aardvark.findings.cvssScore",defaultMessage:"CVSS score"}),children:[t.jsx(bt,{className:"me-1 h-[14px] w-[14px]","aria-hidden":!0}),m]})]}),n&&t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:n&&t.jsx("p",{className:"mb-2",children:n})}),t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(p=r.commit_analysis)==null?void 0:p.description})]})}const Mt=H(()=>O(()=>import("./op0mk9py5p8nmkr9.js"),__vite__mapDeps([7,1])),{loading:s=>q(s)}),wt=H(()=>O(()=>import("./l233qajtxk4u5anh.js"),__vite__mapDeps([8,1])),{loading:s=>q(s)});function St({finding:s}){var g,h,p;const e=E(),[r,a]=G.useState(!1),m=(g=s.commit_analysis)==null?void 0:g.validation_report,n=(h=s.commit_analysis)==null?void 0:h.validation_rubric,o=String(m||((p=s==null?void 0:s.commit_analysis)==null?void 0:p.validation_str)||"");if(!o&&!n)return null;const u=n&&o?2:1;return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.validation",defaultMessage:"Validation"}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-".concat(u),children:[n&&t.jsx("div",{className:"lg:col-span-1",children:t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:t.jsx(ae,{remarkPlugins:[fe],components:{code(l){var c=l,{inline:i,children:v}=c,f=ce(c,["inline","children"]);const d=String(v!=null?v:"");if(i)return t.jsx("code",L(F({className:"bg-token-bg-primary rounded px-1 py-0.5 text-[12px]"},f),{children:d}));const j=String((f==null?void 0:f.className)||""),_=/language-([\w-]+)/.exec(j),k=_==null?void 0:_[1];return t.jsx(Ge,{content:d,language:k,wrapperClassName:"mt-1",showActionBar:!1,codeContainerClassName:"p-3"})},input(i){return(i==null?void 0:i.type)!=="checkbox"?t.jsx("input",F({},i)):!!i.checked?t.jsx(wt,{className:"mt-0.5 h-4 w-4 shrink-0 text-emerald-600"}):t.jsx(Mt,{className:"text-token-text-quaternary mt-0.5 h-4 w-4 shrink-0 opacity-70"})},li({children:i}){return t.jsx("li",{className:"hover:bg-token-bg-elevated-secondary/40 flex items-start gap-2 rounded-lg p-2",children:i})}},children:n})})}),o&&o.trim().length>0&&t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs font-semibold tracking-wide uppercase",children:e.formatMessage({id:"aardvark.findings.validationReportLabel",defaultMessage:"Validation report"})}),t.jsxs("div",{className:Y("relative rounded-md p-3 text-sm leading-6","bg-token-main-surface-primary/40"),children:[t.jsx("div",{className:Y("prose prose-sm text-foreground max-w-none",r?"max-h-none":"max-h-36 overflow-hidden"),children:t.jsx(ae,{remarkPlugins:[fe],children:o})}),!r&&t.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t"})]}),t.jsx("div",{className:"mt-2 flex items-center justify-end",children:t.jsx("button",{type:"button",className:"hover:bg-token-bg-elevated-secondary inline-flex h-8 items-center justify-center rounded px-2 text-xs",onClick:()=>a(i=>!i),children:r?e.formatMessage({id:"aardvark.findings.collapse",defaultMessage:"Collapse"}):e.formatMessage({id:"aardvark.findings.expand",defaultMessage:"Expand"})})})]})]})})}function Pt({finding:s,refetchFinding:e}){var r;return E(),t.jsx("div",{className:"relative mx-auto w-full max-w-[1200px]",children:t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3 md:gap-6",children:[t.jsx("div",{className:"flex flex-col gap-4 md:col-span-2",children:t.jsx(Nt,{finding:s})}),t.jsx("div",{className:"flex h-fit flex-col gap-4 self-start",children:t.jsx(at,{finding:s})}),s.proposed_patch?t.jsx("div",{className:"md:col-span-3",children:t.jsx(gt,{proposed_patch:s.proposed_patch,findingId:(r=s.hid)!=null?r:s.id,refetchFinding:e})}):null,t.jsx("div",{className:"md:col-span-3",children:t.jsx(kt,{finding:s})}),t.jsx("div",{className:"md:col-span-3",children:t.jsx(St,{finding:s})})]})})})}function At(s){"use forget";const e=B.c(24),{findingId:r}=s,a=E(),m=be(),n=Ne(),o=re();let u;e[0]!==m.search||e[1]!==n?(u=()=>t.jsx("div",{className:"mx-auto mb-4 w-full max-w-[1200px]",children:t.jsx(qe,{as:"button",size:"small",color:"secondary",onClick:()=>{n("/aardvark"+(m.search||""))},children:t.jsx(C,{id:"aardvark.details.back",defaultMessage:"Back to findings"})})}),e[0]=m.search,e[1]=n,e[2]=u):u=e[2];const g=u;let h;e[3]!==g?(h=x=>t.jsxs("div",{className:"w-full px-4 pb-6",children:[g(),t.jsx("div",{className:"border-token-border-light text-token-text-secondary mx-auto w-full max-w-[1200px] rounded-lg border px-4 py-6 text-center",children:t.jsx(C,L(F({},te.findingLoad),{values:{details:x.message}}))})]}),e[3]=g,e[4]=h):h=e[4];const p=h,{data:i,isLoading:v,refetch:f,error:l}=Fe(r);let c,d;if(e[5]!==l||e[6]!==a||e[7]!==o?(c=()=>{if(!l)return;const x=a.formatMessage(te.findingLoad,{details:l.message});o.danger(x)},d=[l,a,o],e[5]=l,e[6]=a,e[7]=o,e[8]=c,e[9]=d):(c=e[8],d=e[9]),ee.useEffect(c,d),v){let x;return e[10]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx("div",{className:"w-full px-4 pb-6",children:t.jsx("div",{className:"flex h-[60vh] w-full items-center justify-center",children:t.jsx(Ue,{})})}),e[10]=x):x=e[10],x}if(l||!i){let x;e[11]!==l?(x=l!=null?l:new Error("Unknown error loading finding"),e[11]=l,e[12]=x):x=e[12];let y;return e[13]!==p||e[14]!==x?(y=p(x),e[13]=p,e[14]=x,e[15]=y):y=e[15],y}let j;e[16]!==g?(j=g(),e[16]=g,e[17]=j):j=e[17];let _;e[18]!==i||e[19]!==f?(_=t.jsx(Pt,{finding:i,refetchFinding:f}),e[18]=i,e[19]=f,e[20]=_):_=e[20];let k;return e[21]!==j||e[22]!==_?(k=t.jsxs("div",{className:"w-full px-4 pb-6",children:[j,_]}),e[21]=j,e[22]=_,e[23]=k):k=e[23],k}function Ct({findingId:s}){const e=ze(),r=Oe(e),a=We();return r?t.jsx(Et,L(F({},a),{findingId:s})):null}function Et(s){"use forget";const e=B.c(7),{findingId:r}=s;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(Le,{}),e[0]=a):a=e[0];let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(Be,{children:t.jsx(Ve,{})}),e[1]=m):m=e[1];let n;e[2]!==r?(n=t.jsxs(tt,{mobileHeaderRightContent:null,children:[a,m,t.jsx(Ke,{children:t.jsx("div",{className:"no-scrollbar h-full w-full",children:t.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:t.jsx(At,{findingId:r})})})})]}),e[2]=r,e[3]=n):n=e[3];let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(Ie,{}),e[4]=o):o=e[4];let u;return e[5]!==n?(u=t.jsxs(t.Fragment,{children:[n,o]}),e[5]=n,e[6]=u):u=e[6],u}const Ss=Me(function(){const e=we(),r=E();if(!e.id){const a=r.formatMessage(te.findingNotFound);return t.jsx("div",{children:a})}return t.jsx(Ct,{findingId:e.id})});export{Ss as default};
//# sourceMappingURL=d88c5qsjajyhaelp.js.map

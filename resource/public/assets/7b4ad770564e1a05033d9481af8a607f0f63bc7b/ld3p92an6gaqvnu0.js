var ue=Object.defineProperty,ie=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var G=(e,r,a)=>r in e?ue(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,p=(e,r)=>{for(var a in r||(r={}))de.call(r,a)&&G(e,a,r[a]);if(K)for(var a of K(r))pe.call(r,a)&&G(e,a,r[a]);return e},w=(e,r)=>ie(e,fe(r));import{h as L,r as S,j as l,d as te,a as V,M as W,S as Se}from"./kfrdmkli83ureki3.js";import{R as ye,u as he,ak as ge,aB as be,p as _e,dT as se,_ as re,am as Pe,D as B,ck as Te}from"./kw08ajijqinojrwh.js";import{c as m,S as q,F as D,a as oe,C as X,L as we}from"./m0t07ixd92668z9e.js";import{k5 as Me,k7 as Ee,aE as xe,lB as Ce,dH as Ne,b0 as ve,eE as Le,dN as Ae,dO as je,dI as F,mJ as Re,bZ as Oe,dL as Ue,lv as Ie,aB as Fe,aC as qe}from"./fyw02vlaiv2vq6cj.js";import{P as ne,u as ke,B as ze}from"./m9gq49u2vlb0cjyx.js";import{S as Be}from"./ds50f4rqnruk5v5l.js";const ee="country_code",z="step",Q=e=>ye.safePost("/accounts/pending_team_workspace",{requestBody:e}),Qe=({formData:e,onNext:r})=>{var y,_;const a=L(),[t,d]=S.useState({role:(y=e.role)!=null?y:"",department:(_=e.department)!=null?_:""}),[n,f]=S.useState({}),g=(s,o)=>{d(h=>w(p({},h),{[s]:o})),f(h=>w(p({},h),{[s]:""}))},b=S.useMemo(()=>{const s=Me.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return s.sort((o,h)=>o.label.localeCompare(h.label)),s},[a]),c=S.useMemo(()=>{const s=Ee.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return s.sort((o,h)=>o.label.localeCompare(h.label)),s},[a]),u=S.useMemo(()=>[{formType:"select",label:a.formatMessage(m.roleLabel),name:"role",placeholder:a.formatMessage(m.rolePlaceholder),value:t.role,onChange:s=>g("role",s),error:n.role,required:!0,options:c},{formType:"select",label:a.formatMessage(m.workspaceDepartmentLabel),name:"department",placeholder:a.formatMessage(m.workspaceDepartmentPlaceholder),value:t.department,onChange:s=>g("department",s),error:n.department,required:!0,options:b}],[b,n.department,n.role,t.department,t.role,a,c]),i=()=>{const s={};return u.forEach(o=>{o.required&&!t[o.name]&&(s[o.name]=a.formatMessage(m.fieldRequired,{fieldName:o.label}))}),f(s),Object.values(s).every(o=>!o)};return l.jsx(q,{content:l.jsxs(D,{title:a.formatMessage(m.tellUsAboutWorkStepTitle),subTitle:a.formatMessage(m.tellUsAboutWorkStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:u.map(s=>S.createElement(oe,w(p({},s),{key:s.name})))}),l.jsx(X,{onClick:async()=>{i()&&await r(t)}})]})})},Ve=e=>e==="sales_marketing",De={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"};function Xe({isOneDollarPromoEligible:e,isFreeTrialPromoEligible:r,salesMarketingCopyEnabled:a}){return!e&&!r?{titleMessage:m.purchaseStepTitle,subTitleMessage:void 0}:e?{titleMessage:m.oneDollarPromoTitle,subTitleMessage:a?m.salesMarketingPromoSubtitleOneDollar:m.oneDollarPromoSubtitle}:{titleMessage:m.freeTrialPromoTitle,subTitleMessage:a?m.salesMarketingPromoSubtitleFree:m.freeTrialPromoSubtitle}}const Ye=({onNext:e,onPrevious:r,pendingWorkspace:a,initialBillingDetails:t,formData:d})=>{var Z,$;const n=L(),f=he(),g=Le(),{data:b,isLoading:c,error:u}=xe({ctx:f,countryCode:t==null?void 0:t.country,currency:t==null?void 0:t.currency,enabled:t!=null}),i=te(),y=V(),s=S.useMemo(()=>{const J=new URLSearchParams(y.search).get("segment");return Ve(J)?J:null},[y.search])!=null&&ge(f,"3300867660").get("enable_sales_marketing_copy",!1),o=($=new URLSearchParams((Z=a==null?void 0:a.query_params)!=null?Z:"").get(ne))!=null?$:void 0,{selectedPlan:h,setSelectedPlan:A,numSeats:E,setNumSeats:j,promoData:x,TEAM1DOLLAR_COUPON_IsEligible:C,TEAM_FREE_TRIAL_COUPON_IsEligible:N}=ke({initialSeats:d==null?void 0:d.numSeats,initialPromoCoupon:o}),{eligible:R,campaignId:O}=Ce(),U=!o&&R,T=x!=null?x:U?{coupon:O,state:"eligible",redemption:null}:void 0;if(!t||c||u!=null||!b)return l.jsx(q,{forceLightTheme:!0,content:null});const{annualBillingPlan:P}=Ne(t.currency,b),k=Math.floor(100-P.discountedMonthlyCost/P.monthlyCost*100),v={priceInterval:h,billingDetails:t,numSeats:E,promoData:T},I=C||N,{titleMessage:ce,subTitleMessage:Y}=Xe({isOneDollarPromoEligible:!!C,isFreeTrialPromoEligible:!!N,salesMarketingCopyEnabled:s}),me=ve(isNaN(E)?0:E,g,Ae);return l.jsx(q,{forceLightTheme:!0,onPrevious:r?()=>r(p({},v)):void 0,content:l.jsxs(D,{title:n.formatMessage(ce),subTitle:Y&&n.formatMessage(Y),children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsx(je,{numSeats:E,minSeats:g,setNumSeats:j,classNames:De,label:l.jsx(W,p({},m.seatsCountLabel))}),l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx(we,{required:!0,children:n.formatMessage(m.planSummaryTitle)}),l.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(I&&h===F.FLEXIBLE)&&l.jsx(Be,{ariaLabel:n.formatMessage(m.planTypeLabel),leftItem:{label:l.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:n.formatMessage(m.annualPlanLabel,{percent:k,span:H=>l.jsx("span",{className:"text-[#10A37F]",children:H})})}),value:F.ANNUAL},rightItem:{label:n.formatMessage(m.monthlyPlanLabel),value:F.FLEXIBLE},value:h,onChange:A}),l.jsx(ze,{numSeats:me,selectedPlan:h,billingDetails:t,totalLabel:m.allPlansTodayTotal,billDate:n.formatMessage(m.today),promoData:T})]})]})]}),l.jsx(X,{onClick:()=>e(p({},v))}),l.jsx(be,{color:"ghost",onClick:()=>i("/"),children:l.jsx(W,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},Ze=({formData:e,onNext:r,onPrevious:a})=>{var y,_;const t=L(),[d,n]=S.useState({workspaceName:(y=e.workspaceName)!=null?y:"",companySize:(_=e.companySize)!=null?_:""}),[f,g]=S.useState({}),b=(s,o)=>{n(h=>w(p({},h),{[s]:o})),g(h=>w(p({},h),{[s]:""}))},c=Re.map(s=>({label:typeof s.displayValue=="string"?s.displayValue:t.formatMessage(s.displayValue),value:s.id})),u=S.useMemo(()=>[{formType:"input",label:t.formatMessage(m.workspaceNameLabel),name:"workspaceName",placeholder:t.formatMessage(m.workspaceNamePlaceholder),value:d.workspaceName,onChange:s=>b("workspaceName",s),error:f.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:t.formatMessage(m.workspaceCompanySizeLabel),name:"companySize",placeholder:t.formatMessage(m.workspaceCompanySizePlaceholder),value:d.companySize,onChange:s=>b("companySize",s),error:f.companySize,required:!1,options:c}],[f.companySize,f.workspaceName,d.companySize,d.workspaceName,t,c]),i=()=>{const s={};return u.forEach(o=>{o.required&&!d[o.name]&&(s[o.name]=t.formatMessage(m.fieldRequired,{fieldName:o.label}))}),g(s),Object.values(s).every(o=>!o)};return l.jsx(q,{onPrevious:a?()=>a(p({},d)):void 0,content:l.jsxs(D,{title:t.formatMessage(m.workspaceNameStepTitle),subTitle:t.formatMessage(m.workspaceNameStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:u.map(s=>S.createElement(oe,w(p({},s),{key:s.name})))}),l.jsx(X,{disabled:!d.workspaceName,onClick:async()=>{i()&&await r(p({},d))}})]})})};var le=(e=>(e.AboutWork="about-work",e.WorkspaceInfo="workspace-info",e.ConfigurePlan="configure-plan",e))(le||{});const $e=Te(Object.values(le),void 0),ra=({pendingWorkspace:e})=>{var h,A,E,j,x,C,N,R,O,U;const r=L(),[a,t]=S.useState({workspaceName:(h=e==null?void 0:e.workspace_name)!=null?h:void 0,role:(A=e==null?void 0:e.role)!=null?A:void 0,department:(E=e==null?void 0:e.department)!=null?E:void 0,companySize:(j=e==null?void 0:e.company_size)!=null?j:void 0,numSeats:(x=e==null?void 0:e.seat_quantity)!=null?x:void 0});Ie((N=new URLSearchParams((C=e==null?void 0:e.query_params)!=null?C:"").get(ne))!=null?N:"");const d=He({data:a}),n=se(),f=V(),g=(U=(O=new URLSearchParams(f.search).get(ee))!=null?O:new URLSearchParams((R=e==null?void 0:e.query_params)!=null?R:"").get(ee))!=null?U:void 0,b=Se(),{country:c,userCountry:u}=Fe({initialCountryCode:g}),i=qe({country:c,currentAccount:n,location:"TeamDirectSignUpFlow"}),y=$e(e==null?void 0:e.step_name),{step:_,nextStep:s}=Je({initialStep:y&&M.includes(y)?y:void 0});S.useEffect(()=>{e||(()=>{var P;Q({step_name:(P=e==null?void 0:e.step_name)!=null?P:M[0],query_params:f.search,user_segment:"v1"})})()},[]),S.useEffect(()=>{var v,I;const T=f.key,k=new URLSearchParams(window.location.search).get("referrer")||document.referrer;re.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",w(p({},n==null?void 0:n.subscriptionAnalyticsParams),{referrer:k,initialTab:e==null?void 0:e.step_name,currentTab:_,locationKey:T,navigationType:b,initialCountrySelectorCountry:g!=null?g:c,selectedCountry:(v=i==null?void 0:i.country)!=null?v:"",selectedCurrency:(I=i==null?void 0:i.currency)!=null?I:"",userCountry:u!=null?u:""}))},[_]);const o=()=>{switch(_){case"about-work":return l.jsx(Qe,{formData:a,onNext:async T=>{const P=p(p({},a),T);t(P),await s(P)}});case"workspace-info":return l.jsx(Ze,{formData:a,onNext:async T=>{const P=p(p({},a),T);t(P),await s(P)}});case"configure-plan":return l.jsx(Ye,{formData:a,initialBillingDetails:i!=null?i:void 0,onNext:async T=>{await d(p(p({},a),T))},pendingWorkspace:e});default:return null}};return l.jsxs(l.Fragment,{children:[l.jsx("title",{children:r.formatMessage(m.teamSignUpPageTitle)}),o()]})},He=({data:e,isCustomCheckout:r=!1})=>{const{prepareCheckoutSession:a,navigateToCheckout:t}=Oe(),d=_e(),n=L(),f=se();return S.useCallback(async({priceInterval:b,billingDetails:c,numSeats:u,promoData:i})=>{var y;try{re.logEvent("Account Pay: Payment Checkout Clicked",w(p({planType:Pe.SELF_SERVE_BUSINESS},f==null?void 0:f.subscriptionAnalyticsParams),{referrer:document.referrer}));const _=await a(w(p({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:(y=e.workspaceName)!=null?y:"",price_interval:b,seat_quantity:u},billing_details:c},r?{}:{checkout_ui_mode:"redirect"}),{promo_campaign:b===F.FLEXIBLE?i==null?void 0:i.coupon:null,cancel_url:window.location.href}));await t(_)}catch(_){B.addError(_),d.warning(n.formatMessage(Ue.paymentErrorWarning),{hasCloseButton:!0})}},[r,f==null?void 0:f.subscriptionAnalyticsParams,e.workspaceName,n,t,a,d])},ae=(e,r)=>{const a=new URLSearchParams(window.location.search);Object.entries(e).forEach(([d,n])=>{a.set(d,n)});const t="".concat(window.location.pathname,"?").concat(a.toString());r?r(t,{replace:!1}):window.history.replaceState(null,"",t)},M=["configure-plan"],Je=({initialStep:e})=>{const r=te(),a=V(),[t,d]=S.useState(()=>{const c=e!=null?e:M[0];return ae({[z]:c}),c}),n=S.useCallback(c=>{d(c),ae({[z]:c},r)},[r]),f=S.useRef(null);S.useEffect(()=>{const u=new URLSearchParams(a.search).get(z);u!==f.current&&u&&M.includes(u)&&u!==t&&n(u),f.current=u},[a.search,n,t]);const g=async c=>{let u=t;const i=M.indexOf(t);i>=0&&i<M.length-1&&(u=M[i+1],n(u));try{await Q({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(y){B.addError(y)}},b=S.useCallback(async c=>{let u=t;const i=M.indexOf(t);i>0&&(u=M[i-1],n(u));try{await Q({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(y){B.addError(y)}},[a.search,n,t]);return{step:t,nextStep:g,previousStep:b}};export{ra as C,z as S,Ve as i,He as u};
//# sourceMappingURL=ld3p92an6gaqvnu0.js.map

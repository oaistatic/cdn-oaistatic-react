const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l3z5gz1257zwquc2.js","assets/kfrdmkli83ureki3.js","assets/ea3j10kjv7ntyk1b.js","assets/nz44s7ebe5b6pll5.js","assets/jqy8zfwhk6ptqvmj.js","assets/ezd0hym0jr36348y.js","assets/iyn42bfr1ydmech0.js","assets/c6p8m6momceptpgr.js","assets/nlj7ey81i8rm36n9.js","assets/ztysthz0x5np2s72.js","assets/l4m29zus5vmyfglr.js","assets/gkqhbgrbj1y58hh3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/fyw02vlaiv2vq6cj.js","assets/conversation-small-lq38g8zw.css","assets/octxl093if6ckp4g.js","assets/ea4wgxlbw4t5lzod.js","assets/hdrss3fwjz1zjmw7.js","assets/iwr3smf9emayvqcc.js","assets/5bcdej51598lc3xr.js","assets/bkoreaa3tygyxbms.js","assets/mywblj616r9yptxe.js","assets/ce3hgmw4iyyhicud.js","assets/mstl8wgfzorpgdoe.js","assets/cp40hb6p64z5j02r.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/fxom17ahenhnb7xw.js","assets/e7j9ia0bu5w3396k.js","assets/edhlcmww46h398kf.js","assets/deakbbf27g8e7ba0.js","assets/ft1wtuo4ibr3do9l.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/f86yt77iw8uocdb0.js","assets/gp1ys6tmiztz1f16.js","assets/omn9nfsnpjwo50x8.js","assets/juhk9bg10nm4p27d.js","assets/ns51nblw8ziscsgd.js","assets/drmwaklva7v056il.js","assets/hytzro4etxb8j4b5.js","assets/bj2o1htuhytjg1ta.js","assets/byis8e009cwknczn.js","assets/fx4g5niv8hgtkxju.js","assets/f538t4a72yr8mvhj.js","assets/cjv4tm2buxt5byw3.js","assets/bmm8s4kivjzbh6zb.js","assets/o9u4h3iqiok9m0a8.js","assets/lfj020w6m7gfm8bo.js","assets/de3ceoxcpky3ng0s.js","assets/gf4c0f98pdaqc94a.js","assets/idxukd613qgy7urm.js","assets/he1xnididjbc7s63.js","assets/i85urdvpkzpdgj3s.js","assets/dd8hh2tmra1psngf.js","assets/irqko7c1s7qpl41n.js","assets/eix6aku103dkp2pu.js","assets/c326bjybavj646xd.js","assets/lwyag88acem9bm0o.js","assets/lg0oi3tmjv8kv2p4.js","assets/b3ungmqo5x8kj4fh.js","assets/o5h7u1aikohecbkt.js","assets/w4rmhhxvug61xnae.js","assets/dlgsnq6ip01ej7wa.js","assets/bj1ejin6tzi0v3v8.js","assets/jmsinnid4uz0b7g4.js","assets/o7pht8413wmzlt1j.js","assets/d3gl9smdb5iqto0t.js","assets/je694u6n7mxuffnb.js","assets/m89x2zftpo6hrypr.js","assets/k68z30a1j9zr4phk.js","assets/nh6x5pasrftsddpw.js","assets/c7lf6x6u521mpx19.js","assets/hk5ml9l4i4ups2ga.js","assets/fwbhrttgqnv5nm9m.js","assets/emcmoa6z1wsa6qof.js","assets/be1f0w4doetbrndv.js","assets/m93ibzwrrpoc1bdm.js","assets/nunatmpame7vjusr.js","assets/nvxri8mldbk6o2on.js","assets/hrprrmrs14hiemon.js","assets/n25jb1xrdrimv99m.js","assets/nm285usnll51g0n4.js","assets/l90r9q79a715o0cp.js","assets/i645xwusmfb9eqih.js","assets/glbh7hth6ffzrz0j.js","assets/mj0406dyy526560j.js","assets/moa9hw4knutxpmay.js"])))=>i.map(i=>d[i]);
var Je=Object.freeze,ss=Object.defineProperty,Js=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var es=(t,e,n)=>e in t?ss(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))et.call(e,n)&&es(t,n,e[n]);if(De)for(var n of De(e))st.call(e,n)&&es(t,n,e[n]);return t},A=(t,e)=>Js(t,Ds(e));var je=(t,e)=>Je(ss(t,"raw",{value:Je(e||t.slice())}));import{R as xs,r as j,j as s,_ as E,d as fe,M as x,F as tt,c as pe,e as ge,h as te,u as nt,y as ot,a9 as it,o as rt}from"./kfrdmkli83ureki3.js";import{ca as ue,fb as Ve,V as ae,O as he,hn as Be,ho as $e,D as Le,ai as at,ax as lt,hB as ct,u as ee,g as vs,l4 as dt,lq as X,cg as We,ka as js,c as _s,be as ut,t8 as ys,nD as bs,m4 as Ms,d as Pe,qN as Ps,ga as Ue,n as me,l as He,m as mt,ku as ft,ay as pt,aw as gt,ab as ht,bz as xt,eK as vt,az as O,cv as qe,cy as le,t9 as jt,p7 as ws,d8 as de,p as xe,s4 as _t,gn as yt,eG as re,gs as bt,dT as Mt,pb as oe,pa as Qe,ta as ze,qA as Pt,pc as wt,pd as Tt,d4 as Ts,aA as W,br as It,fd as Ke,pt as Is,pw as kt,pu as ks,c4 as Ct,tb as Gt,j7 as Ee,tc as St,kJ as Cs,ps as At,qP as Ce,qQ as Ge,j as Y,_ as Gs,kI as Nt,aC as Rt,td as Ss,te as Lt,al as we,cu as be,rZ as Ut,tf as zt,oL as Et,tg as Ot,a7 as Ft,th as ts,cq as As,d_ as Vt,dR as Ns,gc as Rs,gg as Bt,aZ as $t,e6 as Ls,eV as Us,fQ as Wt,nE as Me,P as Ht,J as zs,jj as Es,bS as qt,ti as Qt,c9 as ns,qJ as Kt,tj as Xt,d5 as Yt,dk as Zt,gm as Jt,ct as Dt,H as en,tk as sn,tl as tn,L as nn,tm as on,ao as rn,aP as os,au as is,jp as an,f8 as rs,tn as as,to as ln,hX as cn,hY as dn,pI as un,i as ls,nV as mn}from"./kw08ajijqinojrwh.js";import{a as Os,bB as Fs,dE as fn,jv as ie,qt as pn,jI as gn,qu as cs,gW as ds,g3 as Vs,qv as Bs,g4 as hn,g6 as xn,T as vn,qw as jn,qx as _n,n4 as yn,de as bn,hP as Mn,jX as us,bH as Pn,dD as wn,dB as Tn,eB as In,d1 as kn,r as Cn,le as Gn,lf as Sn,lg as An}from"./fyw02vlaiv2vq6cj.js";import{b as ms,s as Nn,c as Rn,g as Ln,A as _e,d as Un,M as zn}from"./gkqhbgrbj1y58hh3.js";import{f as $s}from"./m89x2zftpo6hrypr.js";import{M as Ws}from"./k68z30a1j9zr4phk.js";import{i as Oe}from"./l90r9q79a715o0cp.js";import{G as En}from"./octxl093if6ckp4g.js";import{C as On}from"./i645xwusmfb9eqih.js";import{h as Fn}from"./nh6x5pasrftsddpw.js";import{u as Hs}from"./c7lf6x6u521mpx19.js";import{a as Vn,G as Bn}from"./glbh7hth6ffzrz0j.js";import{F as Z,a as J,b as Se,c as $n,G as Wn}from"./je694u6n7mxuffnb.js";import{b as Hn}from"./mj0406dyy526560j.js";function qn(t,e){const n=he(t),o=ae.getTree(n),i=[];let r=ae.getCurrentNode(n);for(;r!=null&&(e==null||r.id!==e);)i.unshift(r.message),r=r.parentId!==""?o.getNodeByIdOrMessageId(r.parentId):void 0;return i}function Qn(t){return t.filter(o=>o.recipient==="gizmo_editor.update_behavior").flatMap(o=>o.content.content_type==="text"?o.content.parts:o.content.content_type==="code"?[o.content.text]:[]).map(o=>JSON.parse(o)).reduce((o,i)=>v(v({},o),i),{})}async function Kn(t){let e;for(const n of t)if(n.author.name==="gizmo_editor.generate_profile_pic"){const o=lt.getImageAssetPointers(n);o.length>0&&(e=o.at(-1))}if(e!=null){const n=ct(e.asset_pointer),o=await Be(n);if(o.status===$e.Success)return{id:n,permalink:o.download_url}}}async function Xn(t,e,n,o){const i=qn(e,o),r=Qn(i);let a=await Kn(i);if(Oe(r)&&a==null)return;const{name:f,context:l,description:d,profile_pic_file_id:M,prompt_starters:c}=r;if(M!=null)try{const p=await Be(M,t.id);p.status===$e.Success&&(a={id:M,permalink:p.download_url})}catch(p){Le.addError(new Error("Error while retrieving profile pic in update",{cause:p})),n.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const C={name:typeof f=="string"?f:void 0,description:typeof d=="string"?d:void 0,instructions:typeof l=="string"?l:void 0,promptStarters:Array.isArray(c)?c:void 0,profilePictureId:a==null?void 0:a.id,profilePictureUrl:a==null?void 0:a.permalink};return at(C,p=>p!=null)}function Yn(t){var l,d,M;const e=new Set;for(const c of t.tools)e.add(c.type);const n=(l=t.name)!=null?l:"",o=(d=t.description)!=null?d:"",i=(M=t.instructions)!=null?M:"",r=Array.from(e).join(","),a=n===""&&o===""&&i==="",f=t.profilePictureUrl!=null;return a?"The GPT you are about to has the following abilities: ".concat(r,"."):"This is the GPT's current set of fields:\n\nname: ".concat(n,"\n\ndescription: ").concat(o,"\n\ncontext: ").concat(i,"\n\nabilities: ").concat(r,"\n\n").concat(f?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}const Zn=10;function Jn(t,e){var M,c,C,p,g,u,h,N,w,T,_;const n=t.current,o=e.current;if(Ve(n,o))return;const i={};n.name!==(o==null?void 0:o.name)&&(i.name=n.name),((M=n.description)!=null?M:"")!==((c=o==null?void 0:o.description)!=null?c:"")&&(i.description=(C=n.description)!=null?C:""),n.instructions!==((p=o==null?void 0:o.instructions)!=null?p:"")&&(i.context=(g=n.instructions)!=null?g:"");const r=new Set((h=(u=o==null?void 0:o.files)==null?void 0:u.map(y=>y.file_id))!=null?h:[]),a=new Set((w=(N=n.files)==null?void 0:N.map(y=>y.file_id))!=null?w:[]),f=((T=n.files)!=null?T:[]).filter(y=>!r.has(y.file_id)),l=((_=o==null?void 0:o.files)!=null?_:[]).filter(y=>!a.has(y.file_id));if(Oe(i)&&f.length===0&&l.length===0)return;const d=[];if(!Oe(i)){const y="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(i,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');d.push(ue(y))}if(l.length>0&&d.push(ue("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(l.map(y=>y.file_id).join(", ")))),f.length>0){const y=f.slice(0,Zn);d.push(ue("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(y.map(R=>R.file_id).join(", ")),{attachments:y.map(R=>({id:R.file_id,name:R.name,size:R.size}))}))}return d}function Dn(t){if(t.length===0)return;const e="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(t.map(n=>'"'.concat(n.fileId,'"')).join(", "));return[ue(e)]}function eo(t){const e="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.";if(!ae.findNode(he(t),o=>o.message.content.content_type==="text"&&o.message.content.parts[0]===e))return[ue(e)]}function so(t,e){j.useEffect(()=>{ae.findNode(he(t),o=>ft(o.message)||o.message.author.role===pt.System&&o.message.content.content_type===gt.Text)||He(t,o=>{ht.updateTree(o,(i,r)=>{const a=i.findNode(f=>{var l;return((l=f.message.clientMetadata)==null?void 0:l.isPlaceholderTemplateAssistantWelcomeMessage)===!0},r);return a&&(a.id===r&&(r=i.rootId),i.deleteNode(a.id)),e?i.addMessageNode(r,xt(e,void 0,{isPlaceholderTemplateAssistantWelcomeMessage:!0})):r})})},[t,e])}function to(t,e,n){var l;const o=ee(),i=vs(o,t),r=Pe(()=>vt(i)),a=(l=r.models.get(Ps))!=null?l:r&&$s(r.models.values(),d=>d.tags.includes(Ue.GPT_4o));Os(t,{kind:me.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:n},{forcedModelId:a==null?void 0:a.id}),j.useEffect(()=>{He(t,d=>{d.mode={kind:me.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:mt(n)}})},[o,t,e.id,n,a,r]);const[f]=j.useState(()=>{const d=e.id==null,M=e.id!=null&&e.name!==""&&e.description!=null&&e.instructions!==""&&e.profilePictureUrl!=null;return d?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':M?"Welcome back! Is there anything ".concat(e.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});so(t,f)}function no({gizmoEditorData:t,updateGizmo:e,clientThreadId:n,gizmoEditorDataRef:o,magicMakerBehaviorOverrides:i,magicMakerConversationGizmoEditorDataRef:r,requireGizmoId:a}){const f=ee(),l=vs(f,n),d=j.useRef(a);d.current=a;const M=j.useMemo(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:i,getGizmoId:d.current}),[t,i]),c=dt(p=>p.files.filter(g=>g.status===X.Ready&&g.gizmoId!=null)),C=j.useCallback(p=>{var g,u,h,N,w;if(e(T=>{var _;return A(v({},T),{files:[...(_=T.files)!=null?_:[],...We(c.map(y=>{var R;return y.fileId!=null&&{file_id:y.fileId,name:y.file.name,size:y.file.size,type:js(y.file),last_modified:y.file.lastModified,file_size_tokens:(R=y.fileSpec)==null?void 0:R.fileTokenSize}}))]})}),r.current=_s(o.current),!p.completionType||p.completionType===ut.Next){const T=ae.getCurrentNode(he(n)),_=(g=T.message.clientMetadata)!=null&&g.isPlaceholderTemplateAssistantWelcomeMessage?T.message:void 0;_&&(p.existingMessages=[_]),p.prependMessages=[...(u=Dn(c))!=null?u:[],...(h=Jn(o,r))!=null?h:[],...(N=eo(n))!=null?N:[],...(w=p.prependMessages)!=null?w:[]]}return p},[n,c,o,r,e]);return s.jsx(ys.Provider,{value:M,children:s.jsx("div",{className:"relative flex h-full grow overflow-auto",children:s.jsx("div",{className:"grow",children:s.jsx(bs,{conversation:l,children:s.jsx(Ms,{conversation:l,children:s.jsx(Ws,{conversation:l,withCustomCompletionParams:C,hideHeader:!0})})})})})})}const oo=xs.memo(no),io=O(()=>E(()=>import("./l3z5gz1257zwquc2.js"),__vite__mapDeps([0,1])),{loading:t=>W(t)}),ro=O(()=>E(()=>import("./ea3j10kjv7ntyk1b.js"),__vite__mapDeps([2,1])),{loading:t=>W(t)}),ao=O(()=>E(()=>import("./nz44s7ebe5b6pll5.js"),__vite__mapDeps([3,1])),{loading:t=>W(t)}),qs=O(()=>E(()=>import("./jqy8zfwhk6ptqvmj.js"),__vite__mapDeps([4,1])),{loading:t=>W(t)}),lo=O(()=>E(()=>import("./ezd0hym0jr36348y.js"),__vite__mapDeps([5,1])),{loading:t=>W(t)}),co=O(()=>E(()=>import("./iyn42bfr1ydmech0.js"),__vite__mapDeps([6,1])),{loading:t=>W(t)}),uo=O(()=>E(()=>import("./c6p8m6momceptpgr.js"),__vite__mapDeps([7,1])),{loading:t=>W(t)}),mo=O(()=>E(()=>import("./nlj7ey81i8rm36n9.js"),__vite__mapDeps([8,1])),{loading:t=>W(t)}),fo=O(()=>E(()=>import("./ztysthz0x5np2s72.js"),__vite__mapDeps([9,1])),{loading:t=>W(t)}),po=O(()=>E(()=>import("./l4m29zus5vmyfglr.js"),__vite__mapDeps([10,1])),{loading:t=>W(t)}),go=O(()=>E(()=>import("./gkqhbgrbj1y58hh3.js").then(t=>t.e),__vite__mapDeps([11,1,12,13,14,15,16])).then(t=>t.ShareGizmoModal)),ho=O(()=>E(()=>import("./ea4wgxlbw4t5lzod.js"),__vite__mapDeps([17,1,12,13,14,15,11,16])).then(t=>t.SimpleShareGizmoModal));function Fe(t){return!!(t&&typeof t=="object"&&"gizmo"in t)}function Qs(t){window.history.length>1?t(-1):t(jt())}function xo(t){"use forget";var B;const e=pe.c(38),{gizmo:n,publishedGizmo:o,isUpsertLoading:i,isPromoteLoading:r,isUploadingProfilePic:a,updateGizmo:f,promoteGizmo:l,appealGizmo:d,setAppealState:M,showActionsModal:c}=t,C=ee(),p=Mt();let g;if(e[0]!==n||e[1]!==r||e[2]!==a||e[3]!==i){if(g=[],(n==null||r||i)&&g.push(oe.Loading),n!=null){let k;e[5]!==n?(k=Qe(n),e[5]=n,e[6]=k):k=e[6],g.push(...k)}a&&g.push(oe.UploadingProfilePic),e[0]=n,e[1]=r,e[2]=a,e[3]=i,e[4]=g}else g=e[4];const u=g;let h;e[7]!==n?(h=ws(n),e[7]=n,e[8]=h):h=e[8];const N=h;let w;e[9]!==p||e[10]!==d||e[11]!==C||e[12]!==n||e[13]!==l||e[14]!==o||e[15]!==M||e[16]!==c||e[17]!==f?(w=k=>{requestAnimationFrame(()=>It(C,p!=null&&p.isWorkspaceAccount()?go:ho,{gizmo:n,publishedGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:M,showActionsModal:c,updateGizmo:f,shareOnly:k==="share"}))},e[9]=p,e[10]=d,e[11]=C,e[12]=n,e[13]=l,e[14]=o,e[15]=M,e[16]=c,e[17]=f,e[18]=w):w=e[18];const T=w,[_,y]=j.useState(!1),R=n.sharingRecipient?ms[n.sharingRecipient]:ms.private,F=r||i;let P;e[19]!==R||e[20]!==u||e[21]!==n.id||e[22]!==n.sharing||e[23]!==T||e[24]!==F||e[25]!==N||e[26]!==r||e[27]!==i||e[28]!==l||e[29]!==o?(P=N?s.jsx(ie,{color:"primary",onClick:()=>T("promote"),loading:u.length>0&&u.every(vo),disabled:F||n.id===void 0||u.length>0,tooltip:u.length>0?u.map(ze).join("\n"):void 0,"data-testid":"gizmo-editor-create-gpt-button",children:s.jsx(x,{id:"svUGIb",defaultMessage:"Create"})}):s.jsxs(s.Fragment,{children:[s.jsx(ie,{color:"secondary",loading:r||!o,disabled:F,icon:R,onClick:()=>T("share"),children:s.jsx(x,{id:"aXKW4G",defaultMessage:"Share"})}),s.jsx(ie,{color:"primary",onClick:async()=>{var U;let k=n.sharing.subjects.map(Nn);const H=Pt(n.sharing.subjects);k=wt(n.sharing.recipient,k,(U=H==null?void 0:H.capabilities)!=null?U:Tt);const m=o&&Fe(o)?o.gizmo.display.categories[0]:void 0;await l({recipient:n.sharing.recipient,subjects:k},m)&&y(!0)},loading:i||!o,disabled:F||u.length>0,tooltip:u.length>0?u.map(ze).join("\n"):void 0,children:s.jsx(x,{id:"84QVoj",defaultMessage:"Update"})})]}),e[19]=R,e[20]=u,e[21]=n.id,e[22]=n.sharing,e[23]=T,e[24]=F,e[25]=N,e[26]=r,e[27]=i,e[28]=l,e[29]=o,e[30]=P):P=e[30];let I;e[31]!==(p==null?void 0:p.data)||e[32]!==_||e[33]!==o?(I=_&&o&&s.jsx(Rn,{publishedGizmo:o,sharing:Fe(o)?o.gizmo.sharing:void 0,onClose:()=>y(!1),workspaceName:(B=p==null?void 0:p.data.name)!=null?B:""}),e[31]=p==null?void 0:p.data,e[32]=_,e[33]=o,e[34]=I):I=e[34];let G;return e[35]!==P||e[36]!==I?(G=s.jsxs(s.Fragment,{children:[P,I]}),e[35]=P,e[36]=I,e[37]=G):G=e[37],G}function vo(t){return[oe.Loading,oe.UploadingProfilePic].includes(t)}function jo(t){"use forget";var R;const e=pe.c(26),{gizmoEditorData:n,publishedGizmo:o,revertDraft:i}=t,r=ee(),a=te(),f=xe(),l=fe(),[d,M]=j.useState(!1),{canDelete:c}=_t(o),{canCreate:C}=yt();if(!!!(o||i||n!=null&&n.id&&n.liveVersion>0||c))return null;let g;e[0]===Symbol.for("react.memo_cache_sentinel")?(g=s.jsx(ie,{color:"ghost",icon:lo}),e[0]=g):g=e[0];let u;e[1]!==r||e[2]!==o||e[3]!==f?(u=o!=null&&s.jsxs(re.Item,{onClick:F=>{fn(r,o,f,F)},children:[s.jsx(qs,{className:"icon-sm"}),s.jsx(x,v({},D.copyLink))]}),e[1]=r,e[2]=o,e[3]=f,e[4]=u):u=e[4];let h;e[5]!==a||e[6]!==i?(h=i!=null&&s.jsxs(re.Item,{onClick:()=>{window.confirm(a.formatMessage(D.revertConfirm))&&i()},children:[s.jsx(ro,{className:"icon-sm"}),s.jsx(x,{id:"W2blnV",defaultMessage:"Revert..."})]}),e[5]=a,e[6]=i,e[7]=h):h=e[7];let N;e[8]!==C||e[9]!==n||e[10]!==l?(N=(n==null?void 0:n.id)!=null&&n.liveVersion>0&&s.jsxs(s.Fragment,{children:[s.jsxs(re.Item,{onClick:()=>{l("/g/".concat(n.id,"/view"))},children:[s.jsx(uo,{className:"icon-sm"}),s.jsx(x,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),C&&s.jsxs(re.Item,{onClick:async()=>{const F=await bt.copyGizmo({gizmoId:n.id});F.gizmo.id&&l("/gpts/editor/".concat(F.gizmo.id))},children:[s.jsx(co,{className:"icon-sm"}),s.jsx(x,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),e[8]=C,e[9]=n,e[10]=l,e[11]=N):N=e[11];let w;e[12]!==o?(w=o&&Fe(o)&&((R=o.gizmo.current_user_permission)==null?void 0:R.can_delete)&&s.jsxs(re.Item,{color:"danger",onClick:()=>{M(!0)},children:[s.jsx(io,{className:"icon-sm"}),s.jsx(x,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),e[12]=o,e[13]=w):w=e[13];let T;e[14]!==u||e[15]!==h||e[16]!==N||e[17]!==w?(T=s.jsxs(Ke,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:g,children:[u,h,N,w]}),e[14]=u,e[15]=h,e[16]=N,e[17]=w,e[18]=T):T=e[18];let _;e[19]!==(n==null?void 0:n.id)||e[20]!==l||e[21]!==d?(_=d&&s.jsx(En,{gizmoId:(n==null?void 0:n.id)||"",onSuccess:()=>Qs(l),onClose:()=>{M(!1)}}),e[19]=n==null?void 0:n.id,e[20]=l,e[21]=d,e[22]=_):_=e[22];let y;return e[23]!==T||e[24]!==_?(y=s.jsxs(s.Fragment,{children:[T,_]}),e[23]=T,e[24]=_,e[25]=y):y=e[25],y}var ps;const ye=qe.div(ps||(ps=je(["flex items-center gap-1"])));function _o(t){"use forget";const e=pe.c(7),{gizmoEditorData:n}=t,o=Ts(yo);switch(n.sharingRecipient){case de.Private:{let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(ao,{className:"icon-xs"}),s.jsx(x,v({},D.onlyMe))]}),e[0]=i):i=e[0],i}case de.Link:{let i;return e[1]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(qs,{className:"icon-xs"}),s.jsx(x,v({},D.anyoneWithLink))]}),e[1]=i):i=e[1],i}case de.Workspace:{let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(fo,{className:"icon-xs"}),e[2]=i):i=e[2];let r;return e[3]!==o?(r=s.jsxs(ye,{children:[i,o]}),e[3]=o,e[4]=r):r=e[4],r}case de.Marketplace:{let i;return e[5]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(ye,{children:[s.jsx(po,{className:"icon-xs"}),s.jsx(x,v({},D.public))]}),e[5]=i):i=e[5],i}default:{let i;return e[6]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx("div",{}),e[6]=i):i=e[6],i}}}function yo(t){var e;return(e=t.currentWorkspace)==null?void 0:e.name}function bo(t){"use forget";const e=pe.c(14),{gizmoEditorData:n}=t;let o;e[0]!==n.profilePictureUrl?(o=n.profilePictureUrl!=null?s.jsx(Fs,{isFirstParty:!1,src:n.profilePictureUrl,className:"h-8 w-8"}):s.jsx("div",{className:"border-token-border-medium h-8 w-8 rounded-full border-2 border-dashed"}),e[0]=n.profilePictureUrl,e[1]=o):o=e[1];let i;e[2]!==n.name?(i=n.name||s.jsx(x,v({},D.newGPT)),e[2]=n.name,e[3]=i):i=e[3];let r;e[4]!==i?(r=s.jsx("div",{className:"text-sm font-semibold",children:i}),e[4]=i,e[5]=r):r=e[5];let a;e[6]!==n?(a=s.jsx("div",{className:"text-token-text-secondary text-xs",children:ws(n)?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-token-text-tertiary h-1.5 w-1.5 rounded-full"}),s.jsx(x,v({},D.draft))]}):s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-brand-green h-1.5 w-1.5 rounded-full"}),n.sharingRecipient===de.Marketplace?s.jsx(x,v({},D.published)):s.jsx(x,{id:"gizmoEditorHeader.live",defaultMessage:"Live"}),s.jsx(x,A(v({},D.dotSeparator),{tagName:"span"})),s.jsx(_o,{gizmoEditorData:n})]})}),e[6]=n,e[7]=a):a=e[7];let f;e[8]!==r||e[9]!==a?(f=s.jsxs("div",{children:[r,a]}),e[8]=r,e[9]=a,e[10]=f):f=e[10];let l;return e[11]!==o||e[12]!==f?(l=s.jsxs("div",{className:"flex items-center gap-2",children:[o,f]}),e[11]=o,e[12]=f,e[13]=l):l=e[13],l}var gs;const Mo=qe.div(gs||(gs=je(["\n  cursor-pointer\n  border-b\n  pb-[1px]\n  pt-[2px]\n  text-sm\n  text-token-text-secondary\n  hover:border-token-border-xheavy\n  hover:text-token-text-primary\n  mx-2\n"])));function Po({gizmoEditorData:t,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,publishedGizmo:i,updateGizmo:r,promoteGizmo:a,appealGizmo:f,setAppealState:l,revertDraft:d,draftMessage:M,className:c,hasUnpublishedChanges:C,showActionsModal:p}){var u,h;const g=fe();return s.jsxs("div",{className:le("border-token-border-medium relative flex h-14 w-full items-center justify-between gap-2 border-b px-3",c),children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("a",{className:"text-token-text-primary cursor-pointer",onClick:()=>Qs(g),children:s.jsx(mo,{className:"icon"})}),s.jsx(bo,{gizmoEditorData:t})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[i&&((h=(u=i==null?void 0:i.gizmo)==null?void 0:u.live_version)!=null?h:0)>1&&s.jsx(Mo,{onClick:()=>g("/g/".concat(t.id,"/view")),children:s.jsx(x,{id:"P0Ri/k",defaultMessage:"Last edited {date}",values:{date:s.jsx(tt,{value:i.gizmo.updated_at,day:"numeric",month:"short",year:new Date(i.gizmo.updated_at).getFullYear()===new Date().getFullYear()?void 0:"numeric"})}})}),M,s.jsx(jo,{gizmoEditorData:t,publishedGizmo:i,revertDraft:d}),s.jsx(xo,{gizmo:t,publishedGizmo:i,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,updateGizmo:r,promoteGizmo:a,appealGizmo:f,setAppealState:l,hasUnpublishedChanges:C,showActionsModal:p})]})]})}const D=ge({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},dotSeparator:{id:"gizmo.dotSeparator",defaultMessage:"Â·"}}),wo=O(()=>E(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zy),__vite__mapDeps([14,1,12,13,15])),{loading:t=>W(t)}),To=512;function Io({gizmoEditorData:t,onFileChange:e}){const n=te(),o=xe(),[i,r]=j.useState(void 0),a=j.useRef(e);j.useEffect(()=>{a.current=e});async function f(M){if(M.length>0){const c=await Gt(M[0],To),C=Ee(c);r({tempId:C,file:c,status:X.Uploading,progress:1,fileId:null,cdnUrl:null}),a.current("uploading"),St(C,c,n,o,Cs.ProfilePicture,{onFileCreated(p,g,u){r(h=>h!=="initial"&&(h==null?void 0:h.tempId)===p&&h.status===X.Uploading?A(v({},h),{progress:10,fileId:g,cdnUrl:u}):h)},onFileUploadProgress(p,g){r(u=>u!=="initial"&&(u==null?void 0:u.tempId)===p&&u.status===X.Uploading?A(v({},u),{progress:g}):u)},onFileUploaded(p,g,u){r(h=>h!=="initial"&&(h==null?void 0:h.tempId)===p?(a.current(h),A(v({},h),{status:X.Ready,progress:100,fileSpec:v({name:h.file.name,id:h.fileId,size:h.file.size},u!=null?u:{})})):h)},onError(p){r(g=>{if(g!=="initial"&&(g==null?void 0:g.tempId)===p){a.current(void 0);return}return g})}})}}const{open:l,getInputProps:d}=Hs(v({disabled:!1,noClick:!0,onDropAccepted:f,onDropRejected:M=>Fn(M,n,o,Ct.ProfilePicture),multiple:!0,maxSize:ks},Is(kt)));return s.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[s.jsx(Ke,{sideOffset:8,triggerButton:s.jsx("button",{className:"h-20 w-20",children:i!=null&&i!="initial"&&i.status!=X.Ready?s.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[s.jsx(pn,{file:i.file}),i.status===X.Uploading&&i.progress<90?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:s.jsx(gn,{percentage:i.progress,className:"h-6 w-6"})}):null]}):(t==null?void 0:t.profilePictureUrl)!=null&&(t==null?void 0:t.profilePictureUrl)!==""?s.jsx(Fs,{isFirstParty:!1,src:t.profilePictureUrl}):s.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:s.jsx(wo,{className:"text-4xl"})})}),children:s.jsx(re.Item,{onClick:l,children:s.jsx(x,{id:"ERQwXg",defaultMessage:"Upload Photo"})})}),s.jsx("input",v({},d()))]})}function ko({gizmoEditorData:t,requireGizmoId:e,currentModelConfig:n,updateGizmo:o}){var F;const i=te(),r=xe(),[a,f]=j.useState(0),l=j.useRef(new Map),d=At(n,void 0),M=(t==null||t.firstPartyProjectType,void 0),c=async P=>{Gs.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const I=await e();P.length>0&&await Promise.all(P.map(G=>{const B=Ee(G);l.current.set(B,{tempId:B,gizmoId:I,file:G,status:X.Uploading,progress:1,fileId:null,cdnUrl:null}),Nt(Ee(G),G,i,r,{kind:Cs.Gizmo,gizmoId:I},{onFileUploaded:(k,H,m,S)=>{const U=l.current.get(k);U==null||U.fileId==null||(o($=>{var se,q;return A(v({},$),{files:[...(se=$.files)!=null?se:[],{file_id:U.fileId,name:U.file.name,size:U.file.size,type:(q=S==null?void 0:S.mimeType)!=null?q:js(G),last_modified:U.file.lastModified,file_size_tokens:S==null?void 0:S.fileTokenSize}]})}),l.current.delete(k),f($=>$+1))},onFileCreated:(k,H,m)=>{l.current.set(k,A(v({tempId:k,gizmoId:I,file:G,status:X.Uploading,progress:1},l.current.get(k)),{fileId:H,cdnUrl:m})),f(S=>S+1)},onFileUploadProgress:(k,H)=>{const m=l.current.get(k);(m==null?void 0:m.status)===X.Uploading&&l.current.set(k,A(v({},m),{progress:H})),f(S=>S+1)},onError:k=>{l.current.delete(k)}},{usesRetrievalIndex:n!=null&&Ce(n,G.type,G.name)===Ge.Retrieval,contextScopes:M})}))},{getInputProps:C,open:p}=Hs(v({disabled:!1,noClick:!0,onDropAccepted:c,multiple:!0,maxSize:ks,maxFiles:10},Is(d))),g=(F=t==null?void 0:t.files)!=null?F:[];function u(P){return s.jsx(ds,{onRemoveFileClick:()=>{l.current.delete(P.tempId),f(I=>I+1)},file:P.file,loadingPercentage:P.status===X.Uploading?P.progress:void 0},P.tempId)}function h(P){return s.jsx(ds,{file:P.name,fileId:P.file_id,onRemoveFileClick:()=>o(I=>{var G;return A(v({},I),{files:(G=I==null?void 0:I.files)==null?void 0:G.filter(B=>B.file_id!==P.file_id)})}),gizmoId:t==null?void 0:t.id},P.file_id)}const N=Array.from(l.current.values()).filter(P=>g.every(I=>I.file_id!==P.fileId)),[w,T]=cs(N,P=>n!=null&&Ce(n,P.file.type,P.file.name)===Ge.CodeInterpreter),[_,y]=cs(g,P=>n!=null&&P.type!=null&&Ce(n,P.type,P.name)===Ge.CodeInterpreter),R=j.useRef(_.length);return j.useEffect(()=>{_.length>R.current&&o(P=>{var I,G;return(I=P.tools)!=null&&I.some(B=>B.type===Y.PYTHON)?P:A(v({},P),{tools:[...(G=P.tools)!=null?G:[],{type:Y.PYTHON}]})}),R.current=_.length},[_.length]),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"text-token-text-tertiary rounded-lg text-xs",children:s.jsx(x,v({},Co.knowledgeWarning))}),T.length>0||y.length>0?s.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(u),y.map(h)]}):null,w.length>0||_.length>0?s.jsxs("div",{children:[s.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:s.jsx(x,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.map(u),_.map(h)]})]}):null,s.jsx("div",{children:s.jsxs(ie,{onClick:p,children:[s.jsx("input",v({},C())),s.jsx(x,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const Co=ge({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT can potentially reveal part or all of the files uploaded."}});function Go({placeholder:t,text:e,onChange:n,onClose:o}){return s.jsxs(Rt,{testId:"modal-gizmo-editor-form",className:"max-h-[100vh]! max-w-[80vw]!",type:"success",isOpen:!0,onClose:o,primaryButton:s.jsx(ie,{onClick:o,children:s.jsx(x,{id:"FeFVdS",defaultMessage:"Close"})}),children:[s.jsx("textarea",{className:"bg-token-main-surface-primary h-[70vh] w-full resize-none rounded-lg dark:border-gray-700",value:e,onChange:i=>{n(i.target.value)},placeholder:t}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,v({},Ss.instructionsWarning))})]})}const So=O(()=>E(()=>import("./hdrss3fwjz1zjmw7.js"),__vite__mapDeps([18,1])),{loading:t=>W(t)}),Ao=O(()=>E(()=>import("./kw08ajijqinojrwh.js").then(t=>t.yt),__vite__mapDeps([12,1,13])),{loading:t=>W(t)});var hs;const Ae=qe.div(hs||(hs=je(["text-sm text-red-500"])));function No({children:t,collapsed:e,initial:n}){return s.jsx(Vt,{initial:n,children:!e&&s.jsx(Ns.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})})}function Ro({gizmo:t,onShowActionsEditor:e,isDisabled:n}){var a,f,l;const o=te(),i=xe(),r=s.jsxs("div",{className:"space-y-1",children:[(a=t==null?void 0:t.tools)==null?void 0:a.map((d,M)=>{var c;return d.type!==Y.JIT_PLUGIN?null:s.jsxs("div",{children:[s.jsx(Wn,{isDisabled:n,actionTool:d,onShowActionsEditor:()=>e(d.metadata.domain)}),((c=d.metadata.auth)==null?void 0:c.type)==="oauth"&&s.jsx(On,{label:o.formatMessage(V.callbackUrlLabel),value:"https://chat.openai.com/aip/".concat(d.metadata.action_id,"/oauth/callback"),onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},M)}),((l=(f=t==null?void 0:t.tools)==null?void 0:f.filter(d=>d.type===Y.JIT_PLUGIN))!=null?l:[]).length>=ts?s.jsx("div",{children:o.formatMessage(V.maxActionsReached,{number:ts})}):s.jsx(ie,{disabled:n,onClick:()=>{e("Unknown domain")},className:"mt-2",children:s.jsx(x,v({},V.createActionLabel))})]});return n?s.jsx(As,{side:"top",label:o.formatMessage(V.disabledCustomActionsTooltip),children:r}):r}function Lo(t){var e,n,o;return((n=(e=t.files)==null?void 0:e.length)!=null?n:0)>0||((o=t==null?void 0:t.tools)==null?void 0:o.some(i=>i.type===Y.JIT_PLUGIN))}function Uo({gizmoEditorData:t,updateGizmo:e,currentModelConfig:n,setIsUploadingProfilePic:o,requireGizmoId:i,onShowActionsEditor:r}){var F,P,I,G,B,k,H;const a=(F=t==null?void 0:t.tools)!=null?F:[],[f,l]=j.useState(!1),[d,M]=j.useState(!0),c=(P=t==null?void 0:t.promptStarters)!=null?P:[],C=[...c,...c.length<Lt?[""]:[]],p=Qe(t),g=ee(),u=we(g),h=u==null?void 0:u.isWorkspaceAccount(),N=Vs(be.WorkspaceGPTCustomActions),w=te(),T=Pe(()=>Rs(g,{isGizmo:!0})),_=u==null?void 0:u.hasPaidFeatures(),{data:y}=Pe(()=>Bt(g)),R=y!=null&&y.editor?Bs((I=t==null?void 0:t.tools)!=null?I:[])?y.editor.models_list_with_custom_actions:y.editor.models_list:[];return s.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[s.jsxs("div",{className:"grow",children:[s.jsxs(Z,{children:[s.jsx(Io,{gizmoEditorData:t,onFileChange:async m=>{if(m!=null&&m!=="uploading"&&m.fileId!=null){const S=await Be(m.fileId);S.status===$e.Success&&e({profilePictureId:m.fileId!=null?m.fileId:void 0,profilePictureUrl:S.download_url})}else e({profilePictureId:void 0,profilePictureUrl:void 0});o(m==="uploading")}}),s.jsx(J,{label:s.jsx(x,{id:"M4dZms",defaultMessage:"Name"}),description:s.jsx(x,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),s.jsx(Se,{type:"text",placeholder:w.formatMessage(V.gptNamePlaceholder),value:(G=t==null?void 0:t.name)!=null?G:"",onChange:m=>{e({name:m.target.value})},onBlurCapture:()=>e(m=>A(v({},m),{name:m.name.trim()})),"data-testid":"gizmo-name-input"}),p.includes(oe.GizmoNameTooLong)?s.jsx(Ae,{className:"mt-1",children:s.jsx(x,A(v({},V.nameTooLong),{values:{length:Ut}}))}):null]}),s.jsxs(Z,{className:"mt-4",children:[s.jsx(J,{label:s.jsx(x,{id:"YDzNvf",defaultMessage:"Description"}),description:s.jsx(x,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),s.jsx(Se,{type:"text",placeholder:w.formatMessage(V.descriptionPlaceholder),value:(B=t==null?void 0:t.description)!=null?B:"",onChange:m=>e({description:m.target.value}),onBlurCapture:()=>e(m=>{var S,U;return A(v({},m),{description:(U=(S=m.description)==null?void 0:S.trim())!=null?U:""})}),"data-testid":"gizmo-description-input"}),p.includes(oe.GizmoDescriptionTooLong)?s.jsx(Ae,{className:"mt-1",children:s.jsx(x,A(v({},V.descriptionTooLong),{values:{length:zt}}))}):null]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:w.formatMessage(V.instructionsSubtitle)}),s.jsxs("div",{className:"relative",children:[s.jsx($n,{className:"resize-none",rows:8,value:t==null?void 0:t.instructions,onChange:m=>e({instructions:m.target.value}),onBlurCapture:()=>e(m=>A(v({},m),{instructions:m.instructions.trim()})),placeholder:w.formatMessage(V.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),s.jsx("button",{className:"text-token-text-tertiary absolute end-2 bottom-3",onClick:()=>l(!0),children:s.jsx(So,{className:"icon-sm"})})]}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(x,v({},Ss.instructionsWarning))}),p.includes(oe.GizmoInstructionsTooLong)?s.jsx(Ae,{className:"mt-1",children:s.jsx(x,A(v({},V.instructionsTooLong),{values:{length:Et}}))}):null]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:s.jsx(x,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),s.jsx("div",{className:"flex flex-col gap-1",children:C.map((m,S)=>s.jsxs("div",{className:"flex items-center",children:[s.jsx(Se,{className:"rounded-e-none",value:m,type:"text",maxLength:Ot,onChange:U=>{const $=U.target.value;e(se=>{var q;return A(v({},se),{promptStarters:We(S>=((q=c.length)!=null?q:0)?[...c!=null?c:[],$]:c.map((ve,Te)=>Te===S?$===""?void 0:$:ve))})})}}),s.jsx("button",{className:"border-token-border-medium flex h-9 w-9 items-center justify-center rounded-lg rounded-s-none border border-s-0",onClick:()=>e(U=>A(v({},U),{promptStarters:c.filter(($,se)=>se!==S)})),children:s.jsx(Ao,{className:"icon-sm"})})]},S))})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:w.formatMessage(V.knowledgeExplanation)}),s.jsx(ko,{gizmoEditorData:t,requireGizmoId:i,currentModelConfig:n,updateGizmo:e})]}),_&&s.jsxs(Z,{children:[s.jsx(J,{label:s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[s.jsx(x,{id:"wnVs4X",defaultMessage:"Recommended Model"}),s.jsx(Vn,{description:s.jsx(x,v({},V.recommendedModelExplainer))})]})}),s.jsx("div",{style:{fontSize:"12px",color:"var(--gray-600)",marginTop:"4px",marginBottom:"8px"},children:s.jsx(x,v({},V.recommendedModelDescriberUnderTitle))}),s.jsxs("select",{className:"border-token-border-medium bg-token-main-surface-primary w-full rounded-lg border px-3 py-2 text-sm",value:(k=t.defaultModel)!=null?k:"",onChange:m=>{Ft.logEvent("gizmo_recommended_model_selected",m.target.value),e({defaultModel:m.target.value===""?null:m.target.value})},children:[s.jsx("option",{value:"",children:w.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"})}),[...T.models.values()].filter(m=>R.includes(m.id)).sort((m,S)=>m.title.localeCompare(S.title)).map(m=>s.jsx("option",{value:m.id,children:m.title},m.id))]})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:s.jsx(x,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),s.jsx(Bn,{enabledTools:a,onEnabledToolsChange:m=>e({tools:m})})]}),s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"7r7v+u",defaultMessage:"Actions"}),description:s.jsx(x,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),s.jsx(Ro,{isDisabled:!!(h&&!N),gizmo:t,onShowActionsEditor:r})]}),!h&&Lo(t)&&s.jsxs(Z,{children:[s.jsx(J,{label:s.jsx(x,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!d,onClick:()=>{M(m=>!m)}}),s.jsx(No,{collapsed:d,initial:!1,children:s.jsx(hn,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:s.jsx(x,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!t.trainingDisabled,onChange:()=>{e({trainingDisabled:!t.trainingDisabled})}})})]})]}),f&&s.jsx(Go,{text:(H=t.instructions)!=null?H:"",onChange:m=>{e({instructions:m})},onClose:()=>l(!1),placeholder:w.formatMessage(V.instructionsSubtitle)})]})}const V=ge({recommendedModelDescriberUnderTitle:{id:"gizmo.recommendedModelDescriberUnderTitle",defaultMessage:"Recommend a model to the user, which should be used by default for best results."},recommendedModelExplainer:{id:"gizmo.recommendedModelExplainer",defaultMessage:"When the user loads a new conversation with the GPT the recommended model will be used. If the model is not available to the user, a similar model may be automatically selected."},nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters. If you need to provide more context, you may want to attach a file or knowledge document."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}}),zo=O(()=>E(()=>import("./iwr3smf9emayvqcc.js"),__vite__mapDeps([19,1])),{loading:t=>W(t)});function Eo(t,e){const n=Us(t);if(!Array.isArray(t.detail))return n;const o=We(t.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return e.formatMessage(V.nameTooLong,{length:i.ctx.limit_value});case"description":return e.formatMessage(V.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return e.formatMessage(V.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return o.length>0?o.join("\n"):n}function Oo({upsertDraftError:t}){const e=te(),n=Eo(t,e);return s.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[s.jsx("div",{children:s.jsx(x,v({},Ks.errorSavingDraft))}),n!=null&&s.jsx(As,{label:n,children:s.jsx(zo,{className:"icon-sm"})})]})}function Fo({isPublished:t,isSavingDraft:e,hasUnpublishedChanges:n,upsertDraftError:o,className:i}){return o instanceof $t?s.jsx(Oo,{upsertDraftError:o}):n?s.jsxs("div",{className:le("flex items-center gap-2",i),children:[s.jsx("span",{className:"text-token-text-secondary",children:t?s.jsx(x,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):s.jsx(x,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),s.jsx("div",{className:"text-token-text-tertiary w-4",children:e&&s.jsx(Ls,{})})]}):null}const Ks=ge({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}}),Vo=O(()=>E(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zE),__vite__mapDeps([14,1,12,13,15])),{loading:t=>W(t)}),Bo=O(()=>E(()=>import("./5bcdej51598lc3xr.js"),__vite__mapDeps([20,1])),{loading:t=>W(t)}),$o=O(()=>E(()=>import("./bkoreaa3tygyxbms.js"),__vite__mapDeps([21,1,12,13,14,15,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66])).then(t=>t.CanvasFocusedViewManager));var Wo=(t=>(t.TestGizmoAction="test_gizmo_action",t))(Wo||{});const Ho=new Wt;function qo({conversation:t,gizmoHasCustomActions:e,preferredModelId:n}){const{modelLabel:o,dropdownSections:i}=jn(t,e,n),r=s.jsxs(yn,{children:[s.jsx(x,{id:"IhcP1l",defaultMessage:"Model"}),s.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:o}),s.jsx(Vo,{className:"icon-sm text-token-text-tertiary"})]});return s.jsx(Ke,{size:"small",alignOffset:-4,triggerButton:r,children:s.jsx(_n,{sections:i})})}function Qo({gizmoEditorData:t,isSavingDraft:e,showTitle:n=!0}){var N,w,T;const o=ee(),[i,r]=j.useState(()=>Me(o,{urlGizmoId:t.id}));Os(i.id,{kind:me.GizmoTest,gizmo_id:t.id}),j.useEffect(()=>{He(i.id,_=>{_.mode={kind:me.GizmoTest,gizmo_id:t.id}})},[i.id,t.id]);const a=(N=t.files)==null?void 0:N.map(_=>_.file_id).join();j.useEffect(()=>{Ht(i.id)!=null&&r(Me(o,{urlGizmoId:t.id}))},[o,t.id,t.instructions,t.tools,a,i.id]);const f=j.useMemo(()=>({gizmoEditorData:t,mode:"test"}),[t]),l=zs(o,"1213809372"),d=(w=we(o))==null?void 0:w.hasPaidFeatures(),M=l||d,[c,C]=j.useState(0),p=()=>{C(_=>_-360)},g=t.id,u=Ko(i);j.useEffect(()=>Es(Ho,{test_gizmo_action:({rootDomain:_,operationName:y})=>{g&&u(g,_,y)}}),[u,g]);const h=j.useCallback(()=>s.jsx("div",{className:"h-full w-full",children:s.jsx(xn,{gizmo:t,hideOwner:!0,showStarterPrompts:!0})}),[t]);return s.jsx(ys.Provider,{value:f,children:s.jsx(bs,{conversation:i,children:s.jsx(Ms,{conversation:i,children:s.jsx(vn,{clientThreadId:i.id,children:s.jsx("div",{className:le("flex h-full w-full",e&&"cursor-wait opacity-80 transition"),children:s.jsxs("div",{className:"flex grow flex-col",children:[s.jsx("div",{className:"relative mb-2 shrink-0",children:s.jsx("div",{className:"flex justify-center py-1",children:n&&s.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[s.jsx("div",{className:"icon"}),s.jsxs("button",{onClick:()=>{p(),r(Me(o,{urlGizmoId:t.id}))},className:"flex items-center gap-2",children:[s.jsx(x,{id:"2u/6Ja",defaultMessage:"Preview"}),s.jsx(Ns.div,{className:"text-token-text-primary",animate:{rotate:c},transition:{duration:.3},children:s.jsx(Bo,{className:"icon invisible group-hover:visible"})})]}),M&&s.jsx(qo,{conversation:i,gizmoHasCustomActions:!!Bs(t.tools),preferredModelId:(T=t.defaultModel)!=null?T:void 0})]})})}),s.jsxs("div",{className:le("relative grow overflow-auto px-2",e&&"pointer-events-none"),children:[s.jsx(Ws,{conversation:i,hideHeader:!0,renderEmptyState:h()}),s.jsx(Hn.Sidebars,{children:s.jsx($o,{clientThreadId:i.id,overrideWidth:0,isAutoFocusDisabled:!0})})]})]})})})})})})}const fs=xs.memo(Qo);function Ko(t){"use forget";const e=pe.c(2);let n;return e[0]!==t?(n=(o,i,r)=>{bn({conversation:t,eventSource:"url",promptMessage:qt("Call the ".concat(i," API with the ").concat(r," operation"),{jit_plugin_data:{from_client:{type:"test",operation:r,tool_name:Qt(i)}}}),completionMetadata:{conversationMode:{kind:me.GizmoTest,gizmo_id:o}}})},e[0]=t,e[1]=n):n=e[1],n}const Xo=O(()=>E(()=>import("./jmsinnid4uz0b7g4.js"),__vite__mapDeps([67,1,12,13,68,14,15,69,70,11,16,71,72,73,74,75,76,63,64,61,62,77,55,56,78,54,79,59,60,80,81,82,83,84,85,86,87,88,89])).then(t=>t.GizmoActionsEditor));var Xs=(t=>(t.MAGIC_MAKER="magic",t.ADVANCED="advanced",t.PREVIEW="preview",t))(Xs||{});function Ne({value:t,label:e,testId:n}){return s.jsx(Tn,{value:t,className:"text-md border-token-border-default text-token-text-tertiary hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] w-1/3 grow rounded-lg p-1.5 font-semibold transition md:w-1/2","data-testid":n,children:e})}function Yo({className:t,editorTab:e,setEditorTab:n}){const o=te();return s.jsxs(wn,{className:le("bg-token-main-surface-secondary flex w-full overflow-hidden rounded-xl p-1.5 md:w-1/2",t),value:e,onValueChange:i=>{n(i)},children:[s.jsx(Ne,{value:"magic",label:o.formatMessage(Re.magicMakerLabel)}),s.jsx(Ne,{value:"advanced",label:o.formatMessage(Re.configureLabel),testId:"gizmo-editor-configure-button"}),s.jsx("div",{className:"flex w-1/3 md:hidden",children:s.jsx(Ne,{value:"preview",label:o.formatMessage(Re.previewLabel)})})]})}function Zo(t,e){return t.length!==e.length?!1:t.every(n=>e.some(o=>o.type===n.type))}function Jo(t,e){var n,o,i,r;return t.name===e.gizmo.display.name&&t.description===e.gizmo.display.description&&t.instructions===e.gizmo.instructions&&Zo(t.tools,e.tools)&&Ve((o=(n=t.files)==null?void 0:n.map(a=>a.file_id))!=null?o:[],(r=(i=e.files)==null?void 0:i.map(a=>a.file_id))!=null?r:[])&&t.profilePictureUrl==e.gizmo.display.profile_picture_url&&t.profilePictureId==e.gizmo.display.profile_pic_id}const Ys=({gizmo:t,onNewGizmoId:e})=>{var Ye;const n=nt(),o=Dt(),i=Vs(be.BrowsingAvailable),r=(o==null?void 0:o.includes(be.GizmoCanvasToggle))&&(o==null?void 0:o.includes(be.Canvas)),a=ee(),f=zs(a,"4148168517"),l=te(),d=xe(),M=()=>{const b=[];i&&b.push({type:Y.BROWSER}),r&&b.push({type:Y.CANVAS});const L=A(v({},as),{tools:[...as.tools,...b]});return f?A(v({},L),{tools:[...L.tools.filter(z=>z.type!==Y.DALLE),{type:Y.IMAGE_GEN}]}):L},c=j.useRef(t!=null?us(t):M()),C=j.useRef(t),p=j.useRef(c.current),[g,u]=j.useState(()=>c.current),[h]=j.useState(()=>Me(a)),[N]=j.useState(()=>({context_message:Yn(c.current),model_slug:Ue.GPT_4o,enabled_tools:[{tool_id:t!=null?"gizmo_editor":"gizmo_creator"}]}));to(h.id,p.current,N);const w=Pe(()=>Rs(a,{isGizmo:!0})),T=(Ye=w.models.get(Ps))!=null?Ye:w&&$s(w.models.values(),b=>b.tags.includes(Ue.GPT_4o)),{data:_}=en(c.current.id),y=sn(),{isPending:R,error:F}=y,P=tn(),I=j.useMemo(()=>_!=null&&!Jo(g,_),[g,_]),G=async()=>{var L;const b=c.current;try{const z=await y.mutateAsync({editorData:b,gizmoId:b.id});if(C.current=z,c.current.id==null){const Q=z.gizmo.id;c.current=A(v({},c.current),{id:Q,sharingTargets:z.gizmo.sharing_targets}),u(c.current),e==null||e(Q)}for(const Q of z.tools.filter(K=>K.type===Y.JIT_PLUGIN)){const K=c.current.tools.find(ce=>ce.type===Y.JIT_PLUGIN&&ce.metadata.domain===Q.metadata.domain);K&&K.metadata.action_id!==Q.metadata.action_id&&(K.metadata=A(v({},K.metadata),{action_id:Q.metadata.action_id}),u(c.current))}return z}catch(z){const Q=(L=Us(z))!=null?L:l.formatMessage(Ks.errorSavingDraft);throw d.warning(Q,{duration:2}),z}},B=j.useRef(void 0),k=async()=>c.current.id!=null?c.current.id:(B.current==null&&(B.current=G().then(b=>b.gizmo.id).catch(b=>{throw B.current=void 0,b})),B.current),[H]=j.useState(()=>nn(()=>G(),2e3,{trailing:!0})),m=j.useCallback((b,L=!0)=>{const z=typeof b=="function"?b(c.current):on(c.current,b);Ve(z,c.current)||(c.current=z,u(c.current),L&&H())},[H]),S=j.useRef(void 0);j.useEffect(()=>Es(rn,{completionFinished:async b=>{const L=b.serverThreadId;if(L!=null)try{const z=await Xn(c.current,L,d,S.current);z!=null&&(m(z),p.current=_s(c.current))}catch(z){Le.addError(z),d.warning("Something went wrong generating your GPT",{duration:3})}finally{S.current=ae.getCurrentNode(he(L)).message.id}}}),[d,m]);const[U,$]=j.useState(void 0);j.useEffect(()=>{$(Ln(t))},[t==null?void 0:t.gizmo.id]);const se=async(b,L)=>{var ce,Ze;const z=Qe(c.current,b.recipient,L);if(z.length>0){d.warning("Could not save GPT:\n\n".concat(z.map(ne=>"- ".concat(ze(ne))).join("\n")),{duration:3});return}const Q=await G(),K=Q.gizmo.id;try{return Gs.logEvent("Promote Gizmo",{gizmo_id:Q.gizmo.id,sharing_recipient:b.recipient,editor_tab:q}),await P.mutateAsync({gizmoId:Q.gizmo.id,data:{sharingSubjects:b.subjects,sharingRecipient:b.recipient,categories:L==null?void 0:[L]}},{onSuccess(ke){n.setQueryData(rs(n,K).queryKey,ke),n.invalidateQueries({queryKey:["gizmos"]}),n.invalidateQueries({queryKey:["gizmo",{gizmoId:K}]}),n.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:K}]})}})}catch(ne){if(ne instanceof ln)$({gizmoId:K,sharingRecipient:b.recipient,moderationType:zn.PublishBlocked,sharingTargets:(ce=ne.response)==null?void 0:ce.sharing_targets,showModal:_e.AppealAvailable});else{Le.addError(ne);const ke=(Ze=ne.detail)!=null?Ze:"An unknown error occurred";d.warning("Error saving GPT - "+ke,{duration:6})}}},[q,ve]=j.useState(()=>{const b=os.getItem(is.GizmoEditorTab);return Object.values(Xs).includes(b)?b:"magic"});j.useEffect(()=>an(()=>{const b=Pn(a).width;b!=null&&b>=768&&q==="preview"&&ve("magic")}),[a,q]);const[Te,Zs]=j.useState(!1),[Xe,Ie]=j.useState(void 0);return s.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[s.jsx(Po,{gizmoEditorData:g,isUpsertLoading:y.isPending,isPromoteLoading:P.isPending,hasUnpublishedChanges:I,isUploadingProfilePic:Te,publishedGizmo:_,updateGizmo:m,promoteGizmo:async(b,L)=>{const z=await se(b,L);return c.current=A(v({},c.current),{sharingRecipient:b.recipient}),u(c.current),os.setItem(is.GizmoEditorTab,q),z},appealGizmo:async(b,L)=>{U!=null&&$(A(v({},U),{sharingRecipient:b,categories:L==null?void 0:[L],showModal:_e.AppealAvailable}))},setAppealState:$,revertDraft:_!=null&&I?()=>{const b=n.getQueryData(rs(n,c.current.id).queryKey);if(b!=null){const L=us(b);c.current=L,u(L),G()}}:void 0,draftMessage:s.jsx(Fo,{isPublished:_!=null&&(_.gizmo.share_recipient==="marketplace"||_.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:I,isSavingDraft:R,upsertDraftError:F,className:"text-sm"}),showActionsModal:b=>{Ie(b)},className:"shrink-0"}),U&&s.jsx(Un,{appealState:U,onAppealClose:()=>$(A(v({},U),{showModal:_e.None})),onAppealSubmitted:()=>$(A(v({},U),{showModal:_e.AppealSent}))}),s.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[s.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:s.jsx("div",{className:"h-full grow overflow-hidden",children:Xe!==void 0?s.jsx(Xo,{currentlyEditingActionDomain:Xe,gizmoEditorData:g,updateGizmo:m,onClose:()=>{Ie(void 0)}}):s.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[s.jsx("div",{className:"flex w-full flex-row justify-center",children:s.jsx(Yo,{editorTab:q,setEditorTab:ve,className:"mb-2 shrink-0 self-center"})}),s.jsx("div",{className:"grow overflow-hidden",children:q==="magic"?s.jsx("div",{className:"h-full w-full",children:s.jsx(oo,{gizmoEditorData:g,updateGizmo:m,clientThreadId:h.id,gizmoEditorDataRef:c,magicMakerBehaviorOverrides:N,magicMakerConversationGizmoEditorDataRef:p,requireGizmoId:k},h.id)}):q==="advanced"?s.jsx(Uo,{gizmoEditorData:g,updateGizmo:m,currentModelConfig:T,setIsUploadingProfilePic:Zs,requireGizmoId:k,onShowActionsEditor:b=>{Ie(b)}}):s.jsx(fs,{gizmoEditorData:g,isSavingDraft:R,showTitle:!1})})]})})}),s.jsx("div",{className:le("border-token-border-medium bg-token-main-surface-secondary hidden w-1/2 justify-center border-s pt-4",q!=="preview"&&"md:flex"),children:s.jsx("div",{className:"grow",children:s.jsx(fs,{gizmoEditorData:g,isSavingDraft:R})})})]})]})};function Do({gizmoId:t,version:e}){const{data:n}=Xt({gizmoId:t,draft:!0,version:e}),o=Ts(Yt.accountUserId),i=Zt(),r=i==null?void 0:i.id,a=Jt(n)&&n!=null&&o!=null&&r!=null;return n==null||!a?null:s.jsx(Ys,{gizmo:n})}function ei({onNewGizmoId:t}){return s.jsx(Ys,{onNewGizmoId:t})}const si=({gizmoId:t,remixSourceId:e,version:n})=>{const o=fe(),i=ee(),r=we(i),a=j.useRef(void 0);j.useEffect(()=>(ns.enterGizmoEditor(),()=>{ns.exitGizmoEditor()}),[]);let f=t;return t!=null&&a.current===t&&(f=void 0),Mn({newChatAction:l=>{In(i,l,{location:"Keyboard command"}),l.defaultPrevented||kn(o)}}),r?f!==void 0?s.jsx(Do,{gizmoId:f,version:n},f):s.jsx(ei,{remixSourceId:e,onNewGizmoId:l=>{a.current=l,window.history.replaceState(window.history.state,"",Kt(l))}}):s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsx(Ls,{})})},Re=ge({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});function ti(t){const e=fe();j.useEffect(()=>{t||e(cn(dn.NO_ACCESS))},[t,e])}const vi=()=>(Cn(),null),ji=ot(function(){const e=ee(),n=we(e),o=!!(n!=null&&n.hasPlusFeatures());ti(n==null||o);const i=it(),[r]=rt(),a=fe(),f=i.slug,l=r.get("version"),d=f?un(f):void 0,M=r.get("remixFrom");return j.useEffect(()=>{Gn(!0).then(c=>{Sn.initializeAndGatherData(c),An.initializeAndGatherData(c)})},[]),j.useEffect(()=>{n!=null&&!o&&a("/")},[n,a,o]),j.useEffect(()=>{d&&ls(d)&&a("/g/".concat(f,"/project"))},[d,a,f]),!o||d&&ls(d)?null:s.jsx(mn,{children:s.jsx(si,{gizmoId:d,remixSourceId:M!=null?M:void 0,version:l!=null?Number(l):void 0})})});export{Ho as G,Wo as a,vi as c,ji as g};
//# sourceMappingURL=l63n08c1kupvjl5f.js.map

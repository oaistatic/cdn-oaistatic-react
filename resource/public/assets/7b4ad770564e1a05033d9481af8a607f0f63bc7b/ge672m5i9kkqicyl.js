const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/njem4hkd3vzqk90b.js","assets/kcrfstn8nf4rn51p.js","assets/et0kjfzq519mr3zi.js","assets/m6idklazvjc7d344.js","assets/l3z5gz1257zwquc2.js","assets/odtbrxkncka8brls.js","assets/otibmnf3wcwem3h5.js","assets/lpy0q055i382xanc.js","assets/ba3v27n9os9eq40q.js","assets/kw03hsqv96j7mp48.js","assets/bonby2i4xf93dev1.js","assets/bmbles0xorj6gxly.js","assets/jqy8zfwhk6ptqvmj.js","assets/iyoy7y29jyu5lcn2.js","assets/iz35nlf95x4k1pcg.js","assets/l8r2q1y684enjq2l.js","assets/j3xa7zoduffqfxbm.js","assets/kmtsjg7uv0tesj55.js"])))=>i.map(i=>d[i]);
var It=Object.freeze,kt=Object.defineProperty,Ts=Object.defineProperties;var Ms=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var wt=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable;var st=(o,e,t)=>e in o?kt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,pe=(o,e)=>{for(var t in e||(e={}))wt.call(e,t)&&st(o,t,e[t]);if(Qe)for(var t of Qe(e))Et.call(e,t)&&st(o,t,e[t]);return o},je=(o,e)=>Ts(o,Ms(e));var Rt=(o,e)=>{var t={};for(var s in o)wt.call(o,s)&&e.indexOf(s)<0&&(t[s]=o[s]);if(o!=null&&Qe)for(var s of Qe(o))e.indexOf(s)<0&&Et.call(o,s)&&(t[s]=o[s]);return t};var Ve=(o,e,t)=>st(o,typeof e!="symbol"?e+"":e,t);var nt=(o,e)=>It(kt(o,"raw",{value:It(e||o.slice())}));import{c as E,h as oe,r as C,j as n,_ as V,e as Ns,b as ns,M as xe,a9 as Is,y as ks}from"./kfrdmkli83ureki3.js";import{sV as ws,rE as Es,vC as ut,tK as Rs,tI as At,iu as As,l$ as Ds,aF as ze,J as os,bd as Ps,ph as $s,vD as Ls,vE as Fs,vF as Us,vG as Os,vH as Bs,sY as zs,vI as Hs,vJ as Gs,vK as Dt,vL as Vs,sW as Pt,az as q,aA as K,cy as se,u as Q,kS as qs,d as U,lu as Ws,kE as Ks,eG as ge,a6 as Ce,dR as Be,ln as Ys,u8 as Js,pw as mt,bf as Qs,W as Xs,br as re,fL as Zs,aa as en,nE as tn,T as $t,q9 as sn,ay as nn,oe as on,pm as ln,_ as an,gy as Lt,cq as rn,o9 as ls,al as xt,fd as cn,c9 as dn,d_ as un,vM as ot,fM as as,lZ as mn,e9 as fn,eZ as pn,L as gn,e6 as hn,jb as xn,bh as is,gc as yn,aB as vn}from"./kw08ajijqinojrwh.js";import{vA as rs,bP as ve,vB as Ft,F as _n,vC as bn,sr as jn,vD as Cn,vE as Sn,vF as Tn,ub as Mn,vG as Nn,ga as In,pl as cs,vH as ds,cd as us,dp as Ut,dq as Ot,fc as kn,al as wn,vI as ms,vJ as En,vK as Rn,bS as fs,vL as Bt,vM as An,vN as Dn,hb as Pn,hc as $n,B as Ln,E as Fn,vO as zt,bT as ps,vP as Un,vQ as On,vR as Bn,vS as zn,n4 as Ht,vT as Hn,a_ as Gn,fQ as Vn,pO as qn,vU as Wn,az as Kn,ay as Gt,vV as Yn}from"./fyw02vlaiv2vq6cj.js";import{LightboxNew as Jn}from"./kcrfstn8nf4rn51p.js";import{C as Qn}from"./he1xnididjbc7s63.js";import{m as Xn,r as Zn}from"./e2qiox9wm3uaxg29.js";import{T as eo}from"./lwq1uhykon6kdpgz.js";import{B as Vt}from"./lkxvbqgsq9u8m27e.js";import{S as to}from"./nm285usnll51g0n4.js";import{a as so}from"./hrprrmrs14hiemon.js";import{D as no}from"./nh6x5pasrftsddpw.js";import{u as oo}from"./c7lf6x6u521mpx19.js";import{M as gs}from"./m3joncw451cqbul2.js";import{ProductFlyout as lo}from"./b61p2jrlkx9diop7.js";import{a as ao}from"./lazh7fd24t88wsap.js";import"./et0kjfzq519mr3zi.js";import"./i85urdvpkzpdgj3s.js";import"./dd8hh2tmra1psngf.js";import"./bdqubk4ywd0en7sc.js";import"./ci7lhbgv3s1kfbx6.js";import"./kbj1b07s2z6vxqkg.js";import"./hu1bt0oauegdhua6.js";import"./h1em0bjkpkjv8ykw.js";import"./i7t1qh3u8s8bvtb8.js";import"./gy1lpvuoewmzh42c.js";import"./dm8z7bzkrzic0zmg.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./mer2el06ski1l09m.js";import"./lep2wptoy14cfe2w.js";import"./fna9z31n721lpf9f.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./n25jb1xrdrimv99m.js";import"./nunatmpame7vjusr.js";import"./nvxri8mldbk6o2on.js";import"./hk5ml9l4i4ups2ga.js";import"./fwbhrttgqnv5nm9m.js";import"./d7ayto02yo7jqocx.js";import"./ehyvmdoziyg4axk8.js";import"./hoo89wr86agqpm13.js";import"./ejjzjfpdlx2v908r.js";import"./i8e4tsbcdrbcc668.js";import"./hgrkp82vl7wpvpuw.js";import"./gljkwjomy29v9c26.js";import"./oafyrulh7bq2qerb.js";import"./b4dmcdh59zl3olaw.js";const ft=new ws("calpicoMentionPlugin");function yt(){return{queryText:"",active:!1,range:void 0}}function vt(o,e){return o.setMeta(ft,e),o}function io(o){o.dispatch(vt(o.state.tr,yt()))}function ro(o,e,t,s){const a=o.state.tr;vt(a,yt()),a.insertText(e+" ",t,s),o.dispatch(a)}function co(o){var s,a;if(o.depth===0)return;const t=((a=(s=o.nodeBefore)==null?void 0:s.text)!=null?a:"").match(/(?:^|\s)@(\w*)$/);if(t){const l=o.pos-t[1].length-1,r=o.pos;return{range:{from:l,to:r},queryText:t[1]}}}function uo(){return new Es({key:ft,state:{init(){return yt()},apply(o,e,t,s){var l;const a=pe(pe({},e),o.getMeta(ft));if(o.selection.from===o.selection.to&&!s.doc.eq(t.doc)){const r=co(o.selection.$from);a.active=!!r,r&&(a.range=r.range,a.queryText=r.queryText)}return(l=a.onMentionMatch)==null||l.call(a,a.active&&a.range?{text:a.queryText,range:a.range}:void 0),a}}})}function mo(o,e){"use no forget";const t=oe(),[s,a]=C.useState(void 0),[l,r]=C.useState(0);C.useEffect(()=>{e.dispatch(vt(e.state.tr,{onMentionMatch(p){a(p)}}))},[e]);const c=t.formatMessage({id:"NiduaL",defaultMessage:"Ask anything"}),m=C.useMemo(()=>{const p=[];return p.push({text:"@ChatGPT",displayName:"ChatGPT",description:c}),s?p.filter(g=>g.text.replace(/^@/,"").toLowerCase().includes(s.text.toLowerCase())?!e.state.doc.textContent.includes(g.text.toLowerCase()):!1):[]},[s,e,c]),u=s!=null&&m.length>0;C.useEffect(()=>{r(0)},[m]);const f=ut(()=>{var g;if(!s)return!1;const p=(g=m[l])!=null?g:m[0];return p?(ro(e,p.text,s.range.from,s.range.to),!0):!1}),i=ut(p=>{r(g=>{const d=m.length;return(p(g)%d+d)%d})});return C.useEffect(()=>{if(u)return Rs(e,p=>{if(p==="up")i(g=>g-1);else if(p==="down")i(g=>g+1);else if(p==="cancel")At(e),io(e);else if(p==="submit"||p==="checkMatch")return f()}),()=>{e.isDestroyed||At(e)}},[u,e]),{suggestions:m,isSuggestorOpen:u,selectedIndex:l,setSelectedIndex:i,saveMention:f}}function fo(o){"use forget";const e=E.c(13),{roomId:t,editorView:s}=o,{suggestions:a,isSuggestorOpen:l,selectedIndex:r,setSelectedIndex:c,saveMention:m}=mo(t,s);if(!l)return null;let u;if(e[0]!==s||e[1]!==m||e[2]!==r||e[3]!==c||e[4]!==a){let i;e[6]!==s||e[7]!==m||e[8]!==r||e[9]!==c?(i=(p,g)=>n.jsx(As,{as:"div",autoFocus:!1,className:"rounded-lg px-1 py-2",highlighted:g===r,icon:n.jsx(Ds,{iconName:"openai",size:"small"}),onMouseOver:()=>c(()=>g),onClick:()=>{m(),s.focus()},children:n.jsxs("span",{children:[n.jsx("span",{className:"font-medium",children:p.displayName}),n.jsxs("span",{className:"text-token-text-secondary",children:[" · ",p.description]})]})},g),e[6]=s,e[7]=m,e[8]=r,e[9]=c,e[10]=i):i=e[10],u=a.map(i),e[0]=s,e[1]=m,e[2]=r,e[3]=c,e[4]=a,e[5]=u}else u=e[5];let f;return e[11]!==u?(f=n.jsx("div",{className:"shadow-long popover bg-token-bg-primary absolute start-0 end-0 bottom-full mb-2 max-w-xs rounded-2xl py-1.5",onMouseDown:po,children:u}),e[11]=u,e[12]=f):f=e[12],f}function po(o){o.preventDefault()}class go{constructor(e){Ve(this,"roomId");Ve(this,"attachments$");Ve(this,"replyTo$");Ve(this,"focusComposer$");this.roomId=e,this.attachments$=ze([]),this.replyTo$=ze(null),this.focusComposer$=ze(!1)}setReplyToImage(e,t){this.replyTo$.set({messageId:e,messageType:"object",previewText:t.formatMessage({id:"n6PU6i",defaultMessage:"Image"})})}setReplyToMessage(e,t){const s=rs(e,200);s.length===0?this.setReplyToImage(e.id,t):this.replyTo$.set({messageId:e.id,messageType:"text",previewText:s}),this.focusComposer$.set(!0)}clearReplyTo(){this.replyTo$.set(null)}}const hs=C.createContext({});function xs(o){const[e]=C.useState(()=>"controller"in o?o.controller:new go(o.roomId));if(!e)throw new Error("CalpicoRoomControllerProvider: roomId or controller is required");return n.jsx(hs.Provider,{value:e,children:o.children})}function We(){return C.use(hs)}const ho="image/*",Xe=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],ys=[".pdf",".docx",".txt"],xo=[ho,...Xe,...ys].join(",");function _t(o){return o!=null&&o.startsWith("image/")}function vs(o,e){switch(o){case"application/pdf":return e.formatMessage({id:"eEaagW",defaultMessage:"PDF"});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return e.formatMessage({id:"0BrFKi",defaultMessage:"Document"});case"text/plain":return e.formatMessage({id:"C0VVm2",defaultMessage:"Text"});case"image/png":case"image/jpeg":case"image/gif":case"image/webp":return e.formatMessage({id:"3NDFKD",defaultMessage:"Image"});default:return e.formatMessage({id:"65WvIM",defaultMessage:"File"})}}const yo=1024*1024,lt=5;function bt(o){var e;return(e=os(o,"4123826335"))!=null?e:!1}function vo(o){var a;const t=(a=Ps(o,"216497991").get("max_file_size_mb",lt))!=null?a:lt;return(Number.isFinite(t)?Math.max(t,1):lt)*yo}function _o({editorValue$:o,intl:e}){const t=new $s(null,{state:Ls.create({schema:Gs,plugins:[Fs(),Us(),uo(),Os(e.formatMessage({id:"3MYRWW",defaultMessage:"Send a message or @ChatGPT"})),Bs(),zs(je(pe({},Pt),{"Shift-Enter":Pt.Enter,"Mod-z":Vs,"Mod-y":Dt,"Mod-Shift-z":Dt})),Hs()]}),dispatchTransaction(s){const a=t.state.apply(s);t.updateState(a),o.set(a.doc.textContent)}});return t}q(()=>V(()=>import("./fyw02vlaiv2vq6cj.js").then(o=>o.zy),__vite__mapDeps([0,1,2,3,4])),{loading:o=>K(o)});q(()=>V(()=>import("./kw08ajijqinojrwh.js").then(o=>o.yt),__vite__mapDeps([2,1,3])),{loading:o=>K(o)});function pt(o,e){const t=ze({file:o,state:"pending"});return(async function(){try{const a=await e(o);t.set(je(pe({},a),{file:o,state:"complete"}))}catch(a){t.set({file:o,state:"error"})}})(),t}function bo({file:o,className:e}){const t=oe(),s=C.useMemo(()=>URL.createObjectURL(o),[o]);return n.jsx("img",{src:s,alt:t.formatMessage({id:"H7BtDz",defaultMessage:"Image preview"}),className:se("h-10 w-10 rounded-lg object-cover",e)})}const jo=q(()=>V(()=>import("./njem4hkd3vzqk90b.js"),__vite__mapDeps([5,1])),{loading:o=>K(o)}),Co=q(()=>V(()=>import("./fyw02vlaiv2vq6cj.js").then(o=>o.ze),__vite__mapDeps([0,1,2,3,4])),{loading:o=>K(o)}),So=q(()=>V(()=>import("./kw08ajijqinojrwh.js").then(o=>o.yt),__vite__mapDeps([2,1,3])),{loading:o=>K(o)}),To=1024*1024,Mo=1,qe=Ns({addPhotosAndFiles:{defaultMessage:"Add photos & files",id:"calpico.composer.plusMenu.addPhotosAndFiles"},webSearch:{defaultMessage:"Web search",id:"calpico.composer.plusMenu.webSearch"},createImage:{defaultMessage:"Create image",id:"calpico.composer.plusMenu.createImage"}});async function gt(o,e){const t=new FormData;return t.append("file",e),{calpicoFileId:(await Qs.post("".concat(Xs,"/calpico/chatgpt/rooms/").concat(o,"/files"),t)).id}}function _s({roomId:o,scrollToBottom:e}){const t=Q(),s=oe(),a=qs(t),l=ve(t),r=bt(t),c=vo(t),m=U(()=>l.rooms$().get(o)),u=C.useRef(null),f=C.useRef(null),[i,p]=C.useState(null),[g]=C.useState(()=>ze("")),[d]=C.useState(()=>ze(null)),v=We(),x=U(()=>v.replyTo$()),b=U(()=>g()),h=U(()=>d()),y=h!=null,_=No(i,u,b),S=y||_,w=U(Ws)?_n:bn,M=C.useCallback(()=>{a.danger(s.formatMessage({id:"eMW6kP",defaultMessage:"Documents must be {maxSize} MB or smaller."},{maxSize:s.formatNumber(c/To,{maximumFractionDigits:1,minimumFractionDigits:0})}),{id:"calpico_file_upload_size_limit",toastId:"calpico_file_upload_size_limit"})},[s,c,a]),T=C.useCallback(I=>{var ne,W,ue,Z;const N=(ne=I.type)!=null?ne:"";if(_t(N)||N.startsWith("image/"))return!0;const A=(Z=(ue=(W=I.name)==null?void 0:W.toLowerCase)==null?void 0:ue.call(W))!=null?Z:"";return!(Xe.includes(N)||ys.some(ee=>A.endsWith(ee)))||I.size<=c?!0:(M(),!1)},[c,M]),j=C.useCallback(I=>{v.attachments$.set(N=>[...N,{kind:"fileUpload",calpicoFileId:"",state:I}])},[v]),$=C.useCallback(I=>{if(I)for(const N of Array.from(I)){if(!T(N))continue;const A=pt(N,z=>gt(o,z));j(A)}},[j,o,T]),P=C.useCallback(I=>{$(I.target.files),I.target.value=""},[$]),H=C.useCallback(()=>{var I;(I=f.current)==null||I.click()},[]),L=C.useCallback(I=>{d.set(N=>N===I?N:I)},[d]),G=C.useCallback(I=>{d.set(N=>N===I?null:N)},[d]),O=U(()=>v.attachments$()),F=O.length>0||S?"-mb-2.5":"-my-2.5",B=U(()=>!O.some(N=>N.kind==="fileUpload"&&N.state().state!=="complete")&&(g().trim()!==""||O.length>0)),Y=ut(()=>{if(i==null)return;const I=Js(i.state.doc).content;if(B){const N=[];for(const A of O)switch(A.kind){case"fileUpload":{const z=A.state();z.state==="complete"&&N.push({attachment:{type:"file",file_id:z.calpicoFileId},metadata:null});break}case"link":N.push({attachment:{type:"link",url:A.attachment.url},metadata:null});break;case"post":N.push({attachment:{type:"post",post_id:A.attachment.post_id},metadata:null});break;case"sticker":N.push({attachment:{type:"sticker",sticker_id:A.stickerId},metadata:{type:"sticker",sticker_id:A.stickerId,image_url:A.imageUrl,image_metadata:null,file_id:null}});break}l.sendMessage$(o,{content:je(pe({text:I===""?null:I},N.length>0&&{attachments:N.map(A=>A.attachment)}),{system_hints:h?[h]:[]}),reply_to:x!=null&&x.messageId?{message_id:x.messageId}:void 0,request_id:crypto.randomUUID()},N.map(A=>A.metadata)),i&&i.dispatch(i.state.tr.delete(0,i.state.doc.content.size)),v.attachments$.set([]),v.clearReplyTo(),d.set(null),e({animation:"instant"})}});C.useEffect(()=>{const I=u.current;if(!I)return;const N=_o({editorValue$:g,intl:s});p(N);const A=Ks(N,{Enter:W=>W.shiftKey?!1:(W.preventDefault(),Y(),!0)});I.appendChild(N.dom);const z=()=>{Nn({roomId:o})},ne=W=>{var ee,ie;const Z=Array.from((ie=(ee=W.clipboardData)==null?void 0:ee.files)!=null?ie:[]).filter(te=>mt.includes(te.type)||r&&Xe.includes(te.type)?T(te):!1);Z.length===0||Z.length>16||(W.preventDefault(),Z.forEach(te=>{const me=pt(te,fe=>gt(o,fe));j(me)}))};return N.dom.addEventListener("keydown",z),N.dom.addEventListener("paste",ne),N.focus(),()=>{N.dom.removeEventListener("keydown",z),N.dom.removeEventListener("paste",ne),A(),N.destroy(),p(null)}},[o,m,g,s,v,T,r,j]);const le=U(()=>v.focusComposer$());C.useEffect(()=>{le&&i&&(i.focus(),v.focusComposer$.set(!1))},[le,i,v]);const X=Ft(Ce.Research),ae=Ft(Ce.PictureV2),ce=n.jsxs(n.Fragment,{children:[n.jsx(ge.Group,{separator:!1,className:"content-sheet:content-sheet-inset-section",children:n.jsx(ge.Item,{icon:n.jsx(jo,{className:"icon"}),label:s.formatMessage(qe.addPhotosAndFiles),onClick:H},"add-files")}),n.jsxs(ge.Group,{className:"content-sheet:content-sheet-inset-section",children:[n.jsx(ge.Item,{icon:X?n.jsx(X,{className:"icon"}):void 0,label:s.formatMessage(qe.webSearch),onClick:()=>L(Ce.Search)},Ce.Search),n.jsx(ge.Item,{icon:ae?n.jsx(ae,{className:"icon"}):void 0,label:s.formatMessage(qe.createImage),onClick:()=>L(Ce.PictureV2)},Ce.PictureV2)]})]}),de=S||O.length>0||x;return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"relative w-full",children:[i!=null&&n.jsx(fo,{editorView:i,roomId:o}),n.jsxs(Be.div,{layout:!0,transition:w,className:se("shadow-short bg-token-bg-elevated-primary overflow-hidden",de?"rounded-3xl":"rounded-full"),children:[x!=null&&n.jsx("div",{children:n.jsx(jn,{replyRegions:[{type:x.messageType,value:x.previewText,onRemoveRegion:()=>v.clearReplyTo()}]})}),O.length>0&&n.jsx("div",{className:"px-4 pt-4 pb-2",children:n.jsx(Eo,{attachments:O,onRemove:I=>v.attachments$.set(N=>N.filter(A=>A!==I)),render:I=>{switch(I.kind){case"fileUpload":return n.jsx(ko,{fileAttachment:I,documentUploadEnabled:r});case"sticker":return null;default:return null}}})}),n.jsx("input",{ref:f,type:"file",accept:r?xo:"image/*",className:"hidden",onChange:P}),n.jsxs(Be.div,{layout:"position",transition:w,className:se("grid grid-cols-[auto_1fr_auto] gap-x-2 px-3 py-2.5",S?y?"gap-y-2 [grid-template-areas:'primary_primary_primary'_'leading_tools_trailing']":"gap-y-2 [grid-template-areas:'primary_primary_primary'_'leading_._trailing']":"items-center [grid-template-areas:'leading_primary_trailing']"),children:[n.jsx(Be.div,{layout:"position",transition:w,className:"flex items-center [grid-area:leading]",children:n.jsx(Cn,{items:ce,children:n.jsx(Sn,{onDoubleClick:H})})}),n.jsx(Be.div,{layout:"position",transition:w,className:se(F,"flex min-h-14 flex-1 items-center [grid-area:primary]"),children:n.jsx("div",{ref:u,className:se("bg-token-bg-elevated-primary min-h-12 w-full rounded-2xl px-2",Tn["prosemirror-parent"],Ys()?"firefox":"default-browser")})}),n.jsx(Be.div,{layout:"position",transition:w,className:"flex items-center justify-end [grid-area:trailing]",children:n.jsx("button",{className:"composer-submit-btn composer-submit-button-color h-9 w-9",disabled:!B,onClick:()=>{Y()},children:n.jsx(Co,{className:"icon-sm"})})}),y&&n.jsx(Be.div,{layout:"position",transition:w,className:"min-w-0 [grid-area:tools]",initial:{opacity:0,y:-6},animate:{opacity:1,y:0},children:n.jsx("div",{className:"flex flex-wrap gap-2",children:h&&n.jsx(Mn,{icon:h===Ce.Search?X&&n.jsx(X,{className:"icon"}):ae&&n.jsx(ae,{className:"icon"}),label:h===Ce.Search?s.formatMessage(qe.webSearch):s.formatMessage(qe.createImage),removable:!0,onRemove:()=>G(h)},h)})})]})]})]})})}function No(o,e,t){"use forget";const s=E.c(5),[a,l]=C.useState(!1),r=t!=="";let c,m;return s[0]!==e||s[1]!==o||s[2]!==r?(c=()=>{const u=e.current,f=o&&o.dom?o.dom:null;if(!u||!f)return;const i=g=>{if(!u.isConnected||!f.isConnected){l(!1);return}const d=g!=null?g:f.offsetHeight,v=Io(u,f),x=d-v>Mo;l(b=>x?!0:r?b:!1)},p=In({axis:"height",debounce:!0,target:f,onChange:g=>{const{height:d}=g;return i(d)}});return i(f.offsetHeight),()=>{p==null||p()}},m=[o,e,r],s[0]=e,s[1]=o,s[2]=r,s[3]=c,s[4]=m):(c=s[3],m=s[4]),C.useEffect(c,m),a}function Io(o,e){var m,u;const t=getComputedStyle(e),s=(m=Number.parseFloat(t.paddingTop))!=null?m:0,a=(u=Number.parseFloat(t.paddingBottom))!=null?u:0,l=Number.parseFloat(t.lineHeight);if(!Number.isNaN(l))return l+s+a;const r=o.ownerDocument.createElement("span");r.textContent=" ",r.style.visibility="hidden",r.style.position="absolute",r.style.font=t.font,r.style.lineHeight=t.lineHeight,r.style.paddingTop=t.paddingTop,r.style.paddingBottom=t.paddingBottom,o.appendChild(r);const c=r.offsetHeight;return o.removeChild(r),c}function ko(o){"use forget";const e=E.c(8),{fileAttachment:t,documentUploadEnabled:s}=o;let a;e[0]!==t?(a=()=>t.state(),e[0]=t,e[1]=a):a=e[1];const l=U(a);if(_t(l.file.type)||l.file.type.startsWith("image/")||!s){const m=l.state==="complete"?void 0:"opacity-50";let u;return e[2]!==m||e[3]!==l.file?(u=n.jsx(bo,{file:l.file,className:m}),e[2]=m,e[3]=l.file,e[4]=u):u=e[4],u}let c;return e[5]!==l.file||e[6]!==l.state?(c=n.jsx(wo,{file:l.file,state:l.state}),e[5]=l.file,e[6]=l.state,e[7]=c):c=e[7],c}function wo(o){"use forget";const e=E.c(19),{file:t,state:s}=o,a=oe(),l=s==="complete";let r;e[0]!==t.type||e[1]!==a?(r=t.type&&t.type!==""?vs(t.type,a):a.formatMessage({id:"6+b7GT",defaultMessage:"Unknown file type"}),e[0]=t.type,e[1]=a,e[2]=r):r=e[2];const c=r,m=!l&&"opacity-50";let u;e[3]!==m?(u=se("border-token-border-light bg-token-bg-tertiary flex max-w-xs items-center gap-2 rounded-lg border px-3 py-2 text-start",m),e[3]=m,e[4]=u):u=e[4];let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f=n.jsx(cs,{className:"icon-sm"}),e[5]=f):f=e[5];let i;e[6]!==t.name||e[7]!==a?(i=t.name||a.formatMessage({id:"pMikPF",defaultMessage:"Document"}),e[6]=t.name,e[7]=a,e[8]=i):i=e[8];let p;e[9]!==i?(p=n.jsx("div",{className:"text-token-text-primary truncate text-sm font-medium",children:i}),e[9]=i,e[10]=p):p=e[10];let g;e[11]!==c?(g=n.jsx("div",{className:"text-token-text-secondary truncate text-xs",children:c}),e[11]=c,e[12]=g):g=e[12];let d;e[13]!==p||e[14]!==g?(d=n.jsxs("div",{className:"min-w-0",children:[p,g]}),e[13]=p,e[14]=g,e[15]=d):d=e[15];let v;return e[16]!==u||e[17]!==d?(v=n.jsxs("div",{className:u,children:[f,d]}),e[16]=u,e[17]=d,e[18]=v):v=e[18],v}function Eo({attachments:o,onRemove:e,render:t}){return o.length===0?null:n.jsx("div",{className:"flex gap-2",children:o.map((s,a)=>n.jsxs("div",{className:"group relative",children:[t(s),n.jsx("button",{type:"button",onClick:()=>e(s),className:"bg-token-bg-primary text-token-text-secondary border-token-border-heavy invisible absolute -end-2 -top-2 flex h-4 w-4 items-center justify-center rounded-full border group-hover:visible",children:n.jsx(So,{className:"icon-xs"})})]},a))})}const ht=q(()=>V(()=>import("./kcrfstn8nf4rn51p.js"),__vite__mapDeps([6,1,2,3,7,0,4])).then(o=>o.LightboxNew.Root));function jt(o){"use forget";var $,P,H,L,G,O,F;const e=E.c(33),{calpicoFileId:t,attachment:s,roomId:a,messageId:l}=o,r=Q();let c;e[0]!==r?(c=ve(r),e[0]=r,e[1]=c):c=e[1];const m=c,u=oe(),f=t!=null?t:"";let i;e[2]!==f?(i=ds(f),e[2]=f,e[3]=i):i=e[3];const p=m.hasAccess&&t!=null;let g;e[4]!==i||e[5]!==p?(g=je(pe({},i),{enabled:p}),e[4]=i,e[5]=p,e[6]=g):g=e[6];const{data:d}=ns(g),v=We();let x,b,h,y,_;if(e[7]!==s||e[8]!==t||e[9]!==d){if(b=void 0,_=0,h=0,y=($=t!=null?t:s==null?void 0:s.post_id)!=null?$:"image",d!=null&&d.download_url){const{image_metadata:B}=d;B&&(_=(P=B.width)!=null?P:0,h=(H=B.height)!=null?H:0),b=d.download_url}else s!=null&&s.thumbnail_url&&(_=(G=(L=s.thumbnail_metadata)==null?void 0:L.width)!=null?G:0,h=(F=(O=s.thumbnail_metadata)==null?void 0:O.height)!=null?F:0,b=s.thumbnail_url);e[7]=s,e[8]=t,e[9]=d,e[10]=b,e[11]=h,e[12]=y,e[13]=_}else b=e[10],h=e[11],y=e[12],_=e[13];if(x=_&&h?_/h:null,b==null)return null;let S;e[14]!==u?(S=u.formatMessage({id:"rLelSU",defaultMessage:"Image attachment"}),e[14]=u,e[15]=S):S=e[15];const k=S;let w;e[16]!==v||e[17]!==r||e[18]!==b||e[19]!==h||e[20]!==k||e[21]!==y||e[22]!==l||e[23]!==a||e[24]!==_?(w=()=>{const B=[{id:y,archived:!1,transformationId:null,url:b,assetPointer:null,thumbnail:null,width:_,height:h,title:k}];ht.prefetch(),re(r,ht,{images:B,initialIndex:0,children:a&&l?n.jsx(Jn.Footer,{children:n.jsx(xs,{controller:v,children:n.jsx(Ro,{roomId:a,messageId:l})})}):null})},e[16]=v,e[17]=r,e[18]=b,e[19]=h,e[20]=k,e[21]=y,e[22]=l,e[23]=a,e[24]=_,e[25]=w):w=e[25];const M=w;let T;e[26]!==x?(T=x?{aspectRatio:x}:{},e[26]=x,e[27]=T):T=e[27];let j;return e[28]!==b||e[29]!==M||e[30]!==k||e[31]!==T?(j=n.jsx("img",{src:b,className:"max-h-64 min-w-0 flex-1 cursor-pointer rounded-lg object-fill",style:T,alt:k,onClick:M}),e[28]=b,e[29]=M,e[30]=k,e[31]=T,e[32]=j):j=e[32],j}function Ro(o){"use forget";const e=E.c(10),{roomId:t,messageId:s}=o,a=Q(),l=We(),r=oe();let c;e[0]!==a?(c=()=>(Zs(a,ht),!1),e[0]=a,e[1]=c):c=e[1];const m=c;let u,f;e[2]!==r||e[3]!==s||e[4]!==l?(u=()=>(l.setReplyToImage(s,r),()=>{l.clearReplyTo()}),f=[l,s,r],e[2]=r,e[3]=s,e[4]=l,e[5]=u,e[6]=f):(u=e[5],f=e[6]),C.useEffect(u,f);let i;return e[7]!==m||e[8]!==t?(i=n.jsx("div",{className:"px-0",children:n.jsx(_s,{roomId:t,scrollToBottom:m})}),e[7]=m,e[8]=t,e[9]=i):i=e[9],i}const Ao=q(()=>V(()=>import("./m6idklazvjc7d344.js"),__vite__mapDeps([8,1])),{loading:o=>K(o)});function Do(o){"use forget";var m;const e=E.c(14),{attachment:t}=o;let s;e[0]!==t.thumbnail_url||e[1]!==t.title?(s=t.thumbnail_url&&n.jsx("img",{className:"object-cover",src:t.thumbnail_url,alt:(m=t.title)!=null?m:void 0}),e[0]=t.thumbnail_url,e[1]=t.title,e[2]=s):s=e[2];let a;e[3]!==t.title?(a=n.jsx("div",{className:"font-medium",children:t.title}),e[3]=t.title,e[4]=a):a=e[4];let l;e[5]!==t.description?(l=n.jsx("div",{className:"text-sm",children:t.description}),e[5]=t.description,e[6]=l):l=e[6];let r;e[7]!==a||e[8]!==l?(r=n.jsxs("div",{className:"p-2",children:[a,l]}),e[7]=a,e[8]=l,e[9]=r):r=e[9];let c;return e[10]!==t.url||e[11]!==s||e[12]!==r?(c=n.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-default block max-w-sm overflow-hidden rounded-2xl border",children:[s,r]}),e[10]=t.url,e[11]=s,e[12]=r,e[13]=c):c=e[13],c}function bs(o){"use forget";const e=E.c(2),{label:t}=o;let s;return e[0]!==t?(s=n.jsx("div",{className:"text-token-text-secondary mb-1 text-xs",children:t}),e[0]=t,e[1]=s):s=e[1],s}function Ct(o){"use forget";const e=E.c(15),{previewContent:t,attachment:s,onOpen:a}=o;let l;e[0]!==s.url||e[1]!==a?(l=p=>{(a==null?void 0:a(s.url))&&(p.preventDefault(),p.stopPropagation())},e[0]=s.url,e[1]=a,e[2]=l):l=e[2];let r;e[3]!==s.title?(r=n.jsx("div",{className:"font-medium",children:s.title}),e[3]=s.title,e[4]=r):r=e[4];const c=t!=null?t:"";let m;e[5]!==c?(m=n.jsx("div",{className:"text-sm",children:n.jsx(us,{size:"small",children:c})}),e[5]=c,e[6]=m):m=e[6];let u;e[7]!==r||e[8]!==m?(u=n.jsxs("div",{className:"space-y-1",children:[r,m]}),e[7]=r,e[8]=m,e[9]=u):u=e[9];let f;e[10]===Symbol.for("react.memo_cache_sentinel")?(f=n.jsx("div",{className:"pointer-events-none absolute start-0 end-0 bottom-0 z-10 h-12 bg-gradient-to-b from-transparent from-20% to-[var(--bg-primary)] to-100%"}),e[10]=f):f=e[10];let i;return e[11]!==s.url||e[12]!==l||e[13]!==u?(i=n.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-light relative block max-h-64 max-w-sm overflow-hidden rounded-2xl border p-4",onClick:l,children:[u,f]}),e[11]=s.url,e[12]=l,e[13]=u,e[14]=i):i=e[14],i}function Po(o){"use forget";const e=E.c(14),{attachment:t,roomId:s}=o;let a;e[0]!==t?(a=n.jsx(Ct,{attachment:t}),e[0]=t,e[1]=a):a=e[1];let l=a;if(t.messages.length>0){const m=t.messages[t.messages.length-1];e:switch(m.content.content_type){case"text":{let u;e[2]!==t||e[3]!==m?(u=n.jsx(js,{message:m,attachment:t}),e[2]=t,e[3]=m,e[4]=u):u=e[4],l=u;break e}case"multimodal_text":{let u;e[5]!==t||e[6]!==m||e[7]!==s?(u=n.jsx(Lo,{message:m,attachment:t,roomId:s,messageId:m.id}),e[5]=t,e[6]=m,e[7]=s,e[8]=u):u=e[8],l=u;break e}}}let r;e[9]!==t.label?(r=t.label&&n.jsx(bs,{label:t.label}),e[9]=t.label,e[10]=r):r=e[10];let c;return e[11]!==l||e[12]!==r?(c=n.jsxs("div",{children:[r,l]}),e[11]=l,e[12]=r,e[13]=c):c=e[13],c}function $o(o){"use forget";var c;const e=E.c(8),{attachment:t}=o;let s;e[0]!==t.label?(s=t.label&&n.jsx(bs,{label:t.label}),e[0]=t.label,e[1]=s):s=e[1];const a=(c=t.preview)!=null?c:void 0;let l;e[2]!==t||e[3]!==a?(l=n.jsx(Ct,{previewContent:a,attachment:t}),e[2]=t,e[3]=a,e[4]=l):l=e[4];let r;return e[5]!==s||e[6]!==l?(r=n.jsxs("div",{children:[s,l]}),e[5]=s,e[6]=l,e[7]=r):r=e[7],r}function js(o){"use forget";const e=E.c(6),{message:t,attachment:s,onOpen:a}=o;let l;e[0]!==t?(l=en(t,{shouldGetTextFromContentReferences:!0,shouldGetVisibleText:!0}),e[0]=t,e[1]=l):l=e[1];const r=l;let c;return e[2]!==s||e[3]!==a||e[4]!==r?(c=n.jsx(Ct,{previewContent:r,attachment:s,onOpen:a}),e[2]=s,e[3]=a,e[4]=r,e[5]=c):c=e[5],c}function Lo(o){"use forget";const e=E.c(7),{message:t,attachment:s,roomId:a,messageId:l}=o;if(t.content.content_type==="multimodal_text"&&t.content.parts.some(Fo)&&(s.thumbnail_url||s.thumbnail_metadata)){let m;return e[0]!==s||e[1]!==l||e[2]!==a?(m=n.jsx(jt,{attachment:s,roomId:a,messageId:l},s.post_id),e[0]=s,e[1]=l,e[2]=a,e[3]=m):m=e[3],m}let c;return e[4]!==s||e[5]!==t?(c=n.jsx(js,{message:t,attachment:s}),e[4]=s,e[5]=t,e[6]=c):c=e[6],c}function Fo(o){return typeof o=="object"&&o!=null&&"content_type"in o&&o.content_type==="image_asset_pointer"}function Uo(o){"use forget";var m,u;const e=E.c(6),{attachment:t}=o,s=t.video_metadata?"".concat(t.video_metadata.width," / ").concat(t.video_metadata.height):void 0,a=(m=t.video_url)!=null?m:void 0,l=(u=t.thumbnail_url)!=null?u:void 0;let r;e[0]!==s?(r=s?{aspectRatio:s}:void 0,e[0]=s,e[1]=r):r=e[1];let c;return e[2]!==a||e[3]!==l||e[4]!==r?(c=n.jsx("video",{src:a,poster:l,controls:!0,autoPlay:!0,muted:!0,playsInline:!0,className:"max-h-64 w-full rounded-lg object-contain",style:r}),e[2]=a,e[3]=l,e[4]=r,e[5]=c):c=e[5],c}function Ze(o){"use forget";const e=E.c(13),{message:t,roomId:s}=o,a=Q();let l;e[0]!==a?(l=bt(a),e[0]=a,e[1]=l):l=e[1];const r=l,c=t.role==="assistant"?t.attachments:t.content.attachments;if(c==null||c.length===0)return null;let m;if(e[2]!==c||e[3]!==r||e[4]!==t.id||e[5]!==s){let f;e[7]!==r||e[8]!==t.id||e[9]!==s?(f=i=>{switch(i.type){case"file":return r?n.jsx("div",{children:n.jsx(Oo,{attachment:i,roomId:s,messageId:t.id})},i.file_id):n.jsx("div",{children:n.jsx(jt,{calpicoFileId:i.file_id,roomId:s,messageId:t.id})},i.file_id);case"link":return n.jsx("div",{className:"mb-2",children:n.jsx(Do,{attachment:i},i.url)});case"post":return n.jsx("div",{className:"mb-2",children:n.jsx(Po,{attachment:i,roomId:s,messageId:t.id},i.post_id)});case"conversation":return n.jsx("div",{className:"mb-2",children:n.jsx($o,{attachment:i,roomId:s,messageId:t.id},i.conversation_id)});case"media":return n.jsx("div",{className:"mb-2",children:n.jsx(Uo,{attachment:i},i.post_id)});case"sticker":return null;case"sticker_pack":return null}return null},e[7]=r,e[8]=t.id,e[9]=s,e[10]=f):f=e[10],m=c.map(f),e[2]=c,e[3]=r,e[4]=t.id,e[5]=s,e[6]=m}else m=e[6];let u;return e[11]!==m?(u=n.jsx("div",{className:"mb-2 flex max-w-full items-end gap-2",children:m}),e[11]=m,e[12]=u):u=e[12],u}function Oo(o){"use forget";var H,L,G,O;const e=E.c(36),{attachment:t,roomId:s,messageId:a}=o,l=Q();let r;e[0]!==l?(r=ve(l),e[0]=l,e[1]=r):r=e[1];const c=r,m=oe();let u;e[2]!==t.file_id?(u=ds(t.file_id),e[2]=t.file_id,e[3]=u):u=e[3];const f=c.hasAccess&&t.file==null;let i;e[4]!==u||e[5]!==f?(i=je(pe({},u),{enabled:f}),e[4]=u,e[5]=f,e[6]=i):i=e[6];const{data:p,status:g}=ns(i),d=(H=t.file)!=null?H:p;if(d==null&&g==="pending"){let F;e[7]!==m?(F=m.formatMessage({id:"k1r+7h",defaultMessage:"Loading…"}),e[7]=m,e[8]=F):F=e[8];let B;return e[9]!==F?(B=n.jsx("div",{className:"border-token-border-light bg-token-bg-tertiary text-token-text-secondary flex max-w-sm items-center gap-2 rounded-lg border px-3 py-2 text-sm",children:F}),e[9]=F,e[10]=B):B=e[10],B}if(!d)return null;if(_t((L=d.mime_type)!=null?L:void 0)){let F;return e[11]!==t.file_id||e[12]!==a||e[13]!==s?(F=n.jsx(jt,{calpicoFileId:t.file_id,roomId:s,messageId:a}),e[11]=t.file_id,e[12]=a,e[13]=s,e[14]=F):F=e[14],F}const x=(G=d.download_url)!=null?G:void 0;let b;e[15]!==d.name||e[16]!==m?(b=(O=d.name)!=null?O:m.formatMessage({id:"yBlMBy",defaultMessage:"Document"}),e[15]=d.name,e[16]=m,e[17]=b):b=e[17];const h=b;let y;e[18]!==d.mime_type||e[19]!==m?(y=vs(d.mime_type,m),e[18]=d.mime_type,e[19]=m,e[20]=y):y=e[20];const _=y;let S;e[21]!==x?(S=()=>{x&&window.open(x,"_blank","noopener,noreferrer")},e[21]=x,e[22]=S):S=e[22];const k=!x;let w;e[23]===Symbol.for("react.memo_cache_sentinel")?(w=n.jsx(cs,{className:"icon-md shrink-0"}),e[23]=w):w=e[23];let M;e[24]!==h?(M=n.jsx("div",{className:"text-token-text-primary line-clamp-2 font-medium",children:h}),e[24]=h,e[25]=M):M=e[25];let T;e[26]!==_?(T=n.jsx("div",{className:"text-token-text-secondary truncate text-xs",children:_}),e[26]=_,e[27]=T):T=e[27];let j;e[28]!==M||e[29]!==T?(j=n.jsxs("div",{className:"min-w-0 flex-1",children:[M,T]}),e[28]=M,e[29]=T,e[30]=j):j=e[30];let $;e[31]===Symbol.for("react.memo_cache_sentinel")?($=n.jsx(Ao,{className:"icon-sm shrink-0"}),e[31]=$):$=e[31];let P;return e[32]!==j||e[33]!==S||e[34]!==k?(P=n.jsxs("button",{type:"button",onClick:S,className:"border-token-border-light bg-token-bg-tertiary flex w-full max-w-sm items-center gap-3 rounded-lg border px-3 py-3 text-start transition disabled:cursor-not-allowed disabled:opacity-60",disabled:k,children:[w,j,$]}),e[32]=j,e[33]=S,e[34]=k,e[35]=P):P=e[35],P}function Bo(o){"use forget";var v,x,b;const e=E.c(17),{message:t}=o;if(t.content.content_type!=="text")return null;const s=String(t.content.parts[0]||""),a=(v=t.metadata)==null?void 0:v.content_references;let l;e[0]!==s||e[1]!==a?(l=ln(s,a),e[0]=s,e[1]=a,e[2]=l):l=e[2];const{processedText:r,displayedContentReferences:c}=l;let m;e[3]!==((x=t.metadata)==null?void 0:x.content_references)?(m=(h,y)=>{var _,S,k;an.logEvent("ChatGPT Table Copy Clicked"),wn(Xn((_=h.markdownSource)!=null?_:"",(k=(S=t.metadata)==null?void 0:S.content_references)!=null?k:[]),void 0,y)},e[3]=(b=t.metadata)==null?void 0:b.content_references,e[4]=m):m=e[4];const u=m;let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f={turnIndex:0},e[5]=f):f=e[5];let i;e[6]!==c||e[7]!==t?(i={message:t,contentReferences:c,isActivelyStreaming:!1,onShowSearchResults:zo,useSafeUrls:!0,analyticsMetadata:f},e[6]=c,e[7]=t,e[8]=i):i=e[8];let p;e[9]!==u?(p={table:h=>{const S=h,{node:y}=S,_=Rt(S,["node"]);return n.jsx("div",{className:"w-full max-w-full overflow-x-auto",style:{scrollbarWidth:"none"},children:n.jsx(eo,je(pe({},_),{unstyledContainer:!0,onClickCopy:k=>u(y,k)}))})}},e[9]=u,e[10]=p):p=e[10];let g;e[11]!==r||e[12]!==p?(g=n.jsx(us,{className:"[&>p:last-child]:mb-0!",componentOverrides:p,children:r}),e[11]=r,e[12]=p,e[13]=g):g=e[13];let d;return e[14]!==i||e[15]!==g?(d=n.jsx(kn.Provider,{value:i,children:g}),e[14]=i,e[15]=g,e[16]=d):d=e[16],d}function zo(){}function Ho(o,e){var l;const t=on.createRootNode("calpico-root-".concat(o)),s={[t.id]:{id:t.id,parent:t.parentId,children:[],message:t.message}};let a=t.id;for(const r of e)s[r.id]={id:r.id,parent:a,children:[],message:r},(l=s[a])==null||l.children.push(r.id),a=r.id;return{conversation_id:o,mapping:s,current_node:a,moderation_results:[],title:null}}function Go({message:o,roomId:e}){const t=Q(),[s]=C.useState(()=>tn(t)),a=o.rawMessages,[l,r]=C.useState(()=>new Set),c=a.every(i=>l.has(i.id)),m=C.useMemo(()=>Ho(s.id,a),[a,s.id]);C.useEffect(()=>{$t.updateThreadFromServer(s.id,m,{skipIfExisting:!1}),r(new Set(a.map(i=>i.id)))},[a,s.id,m]),C.useEffect(()=>()=>{$t.deleteThread(s.id)},[s.id]);const u=C.useMemo(()=>a.reduce((i,p)=>sn(i,p),[]),[a]);if(!c||u.length===0)return n.jsxs(Ut,{clientThreadId:s.id,children:[a.map(i=>n.jsx("div",{className:"mb-3 last:mb-0",children:n.jsx(Bo,{message:i})},i.id)),o.attachments&&n.jsx(Ze,{roomId:e,message:o}),n.jsx(Ot,{clientThreadId:s.id})]});const f=u.length-1;return n.jsxs(Ut,{clientThreadId:s.id,children:[u.map((i,p)=>{const g=p===f,d=i.role===nn.Assistant&&g;return n.jsx("div",{children:n.jsx(Qn,{groupedMessagesToRender:i.messageGroups,allMessages:i.messages,allGroupedMessages:i.messageGroups,conversation:s,isUserTurn:!1,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,isFinalTurn:g,isFinalUserTurn:!1,isFinalAssistantTurn:d,hasActiveRequest:!1,onRequestCompletion:()=>{},turnIndex:p})},i.id)}),o.attachments&&n.jsx(Ze,{roomId:e,message:o}),n.jsx(Ot,{clientThreadId:s.id})]})}function Vo(o){"use forget";const e=E.c(15),{accountUserId:t,size:s,allowViewingProfile:a}=o,l=Q(),r=ms(t),c=En(t);let m;e[0]!==c||e[1]!==r?(m=r!=null&&c!=null?{name:r,picture:c}:void 0,e[0]=c,e[1]=r,e[2]=m):m=e[2];const u=m;if(a){let i;e[3]!==t||e[4]!==l?(i=()=>{re(l,Rn,{accountUserId:t})},e[3]=t,e[4]=l,e[5]=i):i=e[5];let p;e[6]!==s||e[7]!==u?(p=n.jsx(Lt,{user:u,size:s}),e[6]=s,e[7]=u,e[8]=p):p=e[8];let g;return e[9]!==i||e[10]!==p?(g=n.jsx("button",{onClick:i,className:"relative z-10",children:p}),e[9]=i,e[10]=p,e[11]=g):g=e[11],g}let f;return e[12]!==s||e[13]!==u?(f=n.jsx(Lt,{user:u,size:s}),e[12]=s,e[13]=u,e[14]=f):f=e[14],f}const qo=q(()=>V(()=>import("./l3z5gz1257zwquc2.js"),__vite__mapDeps([9,1])),{loading:o=>K(o)}),Wo=q(()=>V(()=>import("./fyw02vlaiv2vq6cj.js").then(o=>o.zy),__vite__mapDeps([0,1,2,3,4])),{loading:o=>K(o)}),Ko=q(()=>V(()=>import("./odtbrxkncka8brls.js"),__vite__mapDeps([10,1])),{loading:o=>K(o)}),Yo=q(()=>V(()=>import("./otibmnf3wcwem3h5.js"),__vite__mapDeps([11,1])),{loading:o=>K(o)});q(()=>V(()=>import("./lpy0q055i382xanc.js"),__vite__mapDeps([12,1])),{loading:o=>K(o)});const Jo=q(()=>V(()=>import("./ba3v27n9os9eq40q.js"),__vite__mapDeps([13,1])),{loading:o=>K(o)});function qt({actions:o,className:e}){return n.jsx("div",{className:se("flex min-h-6 items-center gap-1",e),children:o.map((t,s)=>t.popoverContent?n.jsxs(Pn,{children:[n.jsx($n,{asChild:!0,children:n.jsx("button",{type:"button",onClick:t.onClick,title:t.title,className:"radix-state-open:bg-token-bg-tertiary hover:bg-token-bg-tertiary radix-state-open:text-token-icon-primary hover:text-token-icon-primary text-token-icon-secondary flex h-6 w-6 items-center justify-center rounded-full transition",children:t.icon})}),n.jsx(Ln,{children:n.jsx(Fn,{side:"top",sideOffset:8,align:"center",className:"bg-token-bg-primary rounded-full px-4 py-1 shadow-[0_4px_64px_0_rgba(0,0,0,0.2)]",children:t.popoverContent})})]},s):n.jsx("button",{type:"button",onClick:t.onClick,title:t.title,className:"radix-state-open:bg-token-bg-tertiary hover:bg-token-bg-tertiary radix-state-open:text-token-icon-primary hover:text-token-icon-primary text-token-icon-secondary flex h-6 w-6 items-center justify-center rounded-full transition",children:t.icon},s))})}function at(o){"use forget";const e=E.c(6),{roomId:t,message:s,className:a,enabledActions:l}=o,r=Q(),c=ve(r),m=We(),u=s.id,f=oe();if(s.role==="user"&&(s.deliveryState==="pending"||s.deliveryState==="failed")){let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=[],e[0]=d):d=e[0];let v;return e[1]!==a?(v=n.jsx(qt,{className:a,actions:d}),e[1]=a,e[2]=v):v=e[2],v}const p=l.map(d=>{var v;switch(d){case"addReaction":{const x=(v=xt(r))==null?void 0:v.normalizedAccountUserId,b=x?s.reactions[x]:null,h=b?Vt.includes(b):!1;return{icon:n.jsx(Yo,{className:"icon-sm"}),popoverContent:n.jsxs(n.Fragment,{children:[Vt.map(y=>n.jsx(Bt,{asChild:!0,children:n.jsx("button",{className:se("inline-flex h-10 w-10 items-center justify-center rounded-full text-2xl",b===y&&"bg-token-bg-secondary"),onClick:async()=>{b===y?await c.removeMessageReaction$(t,u):await c.addMessageReaction$(t,u,{reaction:y})},children:y})},y)),n.jsx(Bt,{asChild:!0,children:b==null||h?n.jsx("button",{className:"inline-flex h-10 w-10 items-center justify-center text-2xl",onClick:()=>{re(r,An,{onSelect:async _=>{await c.addMessageReaction$(t,u,{reaction:_})}})},children:n.jsx("div",{className:"bg-token-bg-secondary flex h-7 w-7 items-center justify-center rounded-full",children:n.jsx(Wo,{className:"icon-sm text-token-icon-primary"})})},"more_emojis"):n.jsx("button",{className:se("bg-token-bg-secondary inline-flex h-10 w-10 items-center justify-center rounded-full text-2xl"),onClick:async()=>{await c.removeMessageReaction$(t,u)},children:b},b)})]}),title:f.formatMessage({id:"o7T6ns",defaultMessage:"Add reaction"})}}case"reply":return{icon:n.jsx(Jo,{className:"icon-sm"}),title:f.formatMessage({id:"67Ys9k",defaultMessage:"Reply"}),onClick:()=>{m.setReplyToMessage(s,f)}};case"report":return{icon:n.jsx(Ko,{className:"icon-sm"}),title:f.formatMessage({id:"5Z3K6i",defaultMessage:"Report"}),onClick:()=>{re(r,fs,{entityId:s.id,entityType:ls.Message,title:f.formatMessage({id:"32LaLp",defaultMessage:"Report message"})})}};case"delete":{const x=()=>{c.deleteMessage$(t,u)},b=()=>{re(r,Dn,{handleDelete:x})};return{icon:n.jsx(qo,{className:"icon-sm"}),title:f.formatMessage({id:"8SVfHI",defaultMessage:"Delete"}),onClick:b}}case"inspectorLog":return null;default:return null}}).filter(Qo);let g;return e[3]!==p||e[4]!==a?(g=n.jsx(qt,{className:a,actions:p}),e[3]=p,e[4]=a,e[5]=g):g=e[5],g}function Qo(o){return o!=null}function it(o){"use forget";var f;const e=E.c(15),{message:t,className:s}=o;let a,l,r,c;if(e[0]!==s||e[1]!==t.reactions){c=Symbol.for("react.early_return_sentinel");e:{const i=Object.entries(t.reactions);if(i.length===0){c=null;break e}const p=new Map;for(const[g,d]of i)p.has(d)||p.set(d,[]),(f=p.get(d))==null||f.push(g);e[6]!==s?(l=se("flex items-center gap-1",s),e[6]=s,e[7]=l):l=e[7],e[8]===Symbol.for("react.memo_cache_sentinel")?(a=se("bg-token-bg-tertiary outline-token-bg-primary flex items-center rounded-full px-1 text-sm outline-2"),e[8]=a):a=e[8],r=Array.from(p.entries()).map(Xo)}e[0]=s,e[1]=t.reactions,e[2]=a,e[3]=l,e[4]=r,e[5]=c}else a=e[2],l=e[3],r=e[4],c=e[5];if(c!==Symbol.for("react.early_return_sentinel"))return c;let m;e[9]!==a||e[10]!==r?(m=n.jsx("div",{className:a,children:r}),e[9]=a,e[10]=r,e[11]=m):m=e[11];let u;return e[12]!==l||e[13]!==m?(u=n.jsx("div",{className:l,children:m}),e[12]=l,e[13]=m,e[14]=u):u=e[14],u}function Xo(o){const[e,t]=o;return n.jsx(Zo,{emoji:e,userIds:t},e)}function Zo({emoji:o,userIds:e}){const t=Q(),s=ve(t),a=U(()=>e.map(m=>{var f,i;if(m==="assistant")return"ChatGPT";const u=(f=s.users$().get(m))==null?void 0:f.name;return u==null?(i=s.userProfileSnapshots$().get(m))==null?void 0:i.name:u})),l=e.length,r=a.map((m,u)=>m!=null?m:e[u]),c=n.jsx("div",{className:"flex flex-col items-center gap-0.5",children:r.map((m,u)=>n.jsx("span",{children:m},"".concat(e[u],"-").concat(u)))});return n.jsx(rn,{label:c,side:"top",withArrow:!0,sideOffset:0,theme:"default",className:"inline-flex cursor-default items-center gap-1 rounded-full px-1 py-0.5",children:n.jsxs("span",{className:"inline-flex items-center gap-1",children:[n.jsx("span",{children:o}),l>1?n.jsx("span",{className:"text-token-text-secondary text-xs",children:l}):null]})})}const el=q(()=>V(()=>import("./l3z5gz1257zwquc2.js"),__vite__mapDeps([9,1])),{loading:o=>K(o)}),tl=q(()=>V(()=>import("./kw03hsqv96j7mp48.js"),__vite__mapDeps([14,1])),{loading:o=>K(o)}),sl=q(()=>V(()=>import("./bonby2i4xf93dev1.js"),__vite__mapDeps([15,1])),{loading:o=>K(o)}),nl=q(()=>V(()=>import("./bmbles0xorj6gxly.js"),__vite__mapDeps([16,1])),{loading:o=>K(o)}),ol=q(()=>V(()=>import("./jqy8zfwhk6ptqvmj.js"),__vite__mapDeps([17,1])),{loading:o=>K(o)}),ll=q(()=>V(()=>import("./odtbrxkncka8brls.js"),__vite__mapDeps([10,1])),{loading:o=>K(o)}),al=q(()=>V(()=>import("./iyoy7y29jyu5lcn2.js"),__vite__mapDeps([18,1])),{loading:o=>K(o)}),il=q(()=>V(()=>import("./iz35nlf95x4k1pcg.js"),__vite__mapDeps([19,1])),{loading:o=>K(o)});function rl(o){"use forget";var _;const e=E.c(26),{room:t}=o,s=Q();let a;e[0]!==t?(a=()=>t==null?void 0:t.name$(),e[0]=t,e[1]=a):a=e[1];const l=U(a);let r;e[2]!==t?(r=()=>t==null?void 0:t.creatorAccountUserId$(),e[2]=t,e[3]=r):r=e[3];const c=U(r);let m;e[4]!==s?(m=(_=xt(s))==null?void 0:_.normalizedAccountUserId,e[4]=s,e[5]=m):m=e[5];const u=m===c;let f;e[6]!==t?(f=()=>{var S;return(S=t==null?void 0:t.members$().length)!=null?S:0},e[6]=t,e[7]=f):f=e[7];const i=U(f),p=u||i===1,g=i>1,d=oe();let v;e[8]!==l?(v=l==null?null:n.jsx(dl,{roomName:l}),e[8]=l,e[9]=v):v=e[9];let x;e[10]!==s||e[11]!==d||e[12]!==t||e[13]!==l||e[14]!==p||e[15]!==g?(x=t==null||l==null?n.jsx("div",{}):n.jsxs("div",{className:"flex w-2/3 items-center",children:[n.jsx("div",{className:"md:hidden",children:n.jsx(to,{onClick:cl})}),n.jsxs(cn,{alignOffset:-4,size:"small",triggerButton:n.jsxs(Ht,{children:[n.jsx("span",{className:"truncate overflow-hidden text-start text-lg",children:l}),n.jsx(il,{className:"icon-sm text-token-icon-tertiary"})]}),testId:"calpico-room-settings-dropdown",children:[n.jsx(ge.Item,{icon:nl,onClick:()=>{re(s,zt,{room:t})},children:n.jsx(xe,{id:"MlDLlK",defaultMessage:"People"})}),n.jsx(ge.Item,{icon:ol,onClick:()=>{re(s,ps,{room:t})},children:n.jsx(xe,{id:"C+QPSB",defaultMessage:"Manage group link"})}),n.jsx(ge.Item,{icon:sl,onClick:()=>{re(s,Un,{room:t})},children:n.jsx(xe,{id:"S+Al8v",defaultMessage:"Rename group"})}),n.jsx(ge.Item,{icon:tl,onClick:()=>{re(s,On,{room:t})},children:n.jsx(xe,{id:"iQoNfK",defaultMessage:"Customize ChatGPT"})}),n.jsx(ge.Separator,{}),n.jsx(ge.Item,{icon:ll,onClick:()=>{re(s,fs,{entityId:t.id,entityType:ls.CalpicoRoom,title:d.formatMessage({id:"o7lr8d",defaultMessage:"Report group chat"})})},color:"danger",children:n.jsx(xe,{id:"rGTGQC",defaultMessage:"Report"})}),g?n.jsx(ge.Item,{icon:al,onClick:()=>{re(s,Bn,{room:t})},color:"danger",children:n.jsx(xe,{id:"/E3t8l",defaultMessage:"Leave group"})}):null,p?n.jsx(ge.Item,{icon:el,onClick:()=>{re(s,zn,{room:t})},color:"danger",children:n.jsx(xe,{id:"c7EK/q",defaultMessage:"Delete group"})}):null]})]}),e[10]=s,e[11]=d,e[12]=t,e[13]=l,e[14]=p,e[15]=g,e[16]=x):x=e[16];let b;e[17]!==s||e[18]!==t?(b=t==null?null:n.jsx("div",{className:"px-2.5",children:n.jsx(Ht,{className:"-me-1 rounded-full px-1 py-1",onClick:()=>{re(s,zt,{room:t})},children:n.jsx(Hn,{room:t,baseSize:32,variant:"horizontal-stack"})})}),e[17]=s,e[18]=t,e[19]=b):b=e[19];let h;e[20]!==x||e[21]!==b?(h=n.jsxs(so,{id:"calpico-page-header",shouldHideHeaderOnSmallScreens:!1,shouldUseEmptyStateLayout:!1,shouldStickSnorlaxNewThread:!1,shouldUseDefaultHeaderPositioning:!0,shouldUseTransparentDefaultHeaderBackground:!0,shouldForceTransparentBackground:!1,shouldShowUpgradeStyles:!1,edgeShadowClass:"[box-shadow:var(--sharp-edge-top-shadow)]",shouldDisableTransition:!0,children:[x,b]}),e[20]=x,e[21]=b,e[22]=h):h=e[22];let y;return e[23]!==v||e[24]!==h?(y=n.jsxs(n.Fragment,{children:[v,h]}),e[23]=v,e[24]=h,e[25]=y):y=e[25],y}function cl(){return dn.setSidebarOpen(!0)}function dl(o){"use forget";const e=E.c(2),{roomName:t}=o;let s;return e[0]!==t?(s=n.jsx(Gn,{children:n.jsx("title",{children:t})}),e[0]=t,e[1]=s):s=e[1],s}const ul=q(()=>V(()=>import("./ba3v27n9os9eq40q.js"),__vite__mapDeps([13,1])),{loading:o=>K(o)});function rt(o){"use forget";const e=E.c(6),{targetMessage:t}=o,s=oe();let a;e[0]!==s||e[1]!==t?(a=t?rs(t,100)||s.formatMessage({id:"PnfKiD",defaultMessage:"Attachment"}):s.formatMessage({id:"y3kg1o",defaultMessage:"Loading message"}),e[0]=s,e[1]=t,e[2]=a):a=e[2];const l=a;let r;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx(ul,{className:"icon-sm me-1 flex-shrink-0"}),e[3]=r):r=e[3];let c;return e[4]!==l?(c=n.jsx(un,{children:n.jsxs("div",{className:"text-token-text-secondary mb-1 flex items-start text-xs font-medium",children:[r,n.jsx("span",{className:"line-clamp-2 break-words",children:l})]})}),e[4]=l,e[5]=c):c=e[5],c}function ml({children:o,className:e}){const t=Q(),s=We(),a=bt(t),l=oe(),{getRootProps:r,isDragActive:c}=oo({onDropAccepted:m=>{const u=Array.from(m).map(f=>pt(f,i=>gt(s.roomId,i)));s.attachments$.set(f=>[...f,...u.map(i=>({kind:"fileUpload",calpicoFileId:"",state:i}))])},multiple:!0,accept:a?pe(pe({},ot(mt)),ot(Xe)):ot(mt)});return n.jsxs("div",je(pe({},r()),{className:se("relative",e),children:[o,c?n.jsxs(no,{children:[n.jsx(Vn,{}),n.jsx("div",{className:"font-medium",children:a?l.formatMessage({id:"4GdYBD",defaultMessage:"Drop a file to upload"}):l.formatMessage({id:"tUo5fR",defaultMessage:"Drop an image to upload"})})]}):null]}))}function fl(o){"use forget";const e=E.c(20),{roomId:t}=o,s=Q();let a;e[0]!==s?(a=ve(s),e[0]=s,e[1]=a):a=e[1];const l=a,r=oe();let c;e[2]!==l||e[3]!==t?(c=()=>{var b;return(b=l.rooms$().get(t))==null?void 0:b.assistantHeartbeats$()},e[2]=l,e[3]=t,e[4]=c):c=e[4];const m=U(c);let u;e[5]!==r?(u=r.formatMessage({id:"9vw5O1",defaultMessage:"User"}),e[5]=r,e[6]=u):u=e[6];const f=u;let i;e[7]!==l||e[8]!==f||e[9]!==t?(i=()=>{var h,y;return((y=(h=l.rooms$().get(t))==null?void 0:h.userHeartbeats$())!=null?y:[]).map(_=>{var k,w;const{accountUserId:S}=_;return(w=(k=l.users$().get(S))==null?void 0:k.name)!=null?w:f})},e[7]=l,e[8]=f,e[9]=t,e[10]=i):i=e[10];const p=U(i);let g;e[11]!==m?(g=m!=null?m:[],e[11]=m,e[12]=g):g=e[12];let d;e[13]!==g?(d=g.map(pl),e[13]=g,e[14]=d):d=e[14];let v;e[15]!==p?(v=p.length>0?n.jsx(yl,{typingUserDisplayNames:p}):null,e[15]=p,e[16]=v):v=e[16];let x;return e[17]!==d||e[18]!==v?(x=n.jsxs("div",{className:"flex flex-col gap-4",children:[d,v]}),e[17]=d,e[18]=v,e[19]=x):x=e[19],x}function pl(o){return n.jsx(gl,{message:o.message},o.modelSlug)}function gl(o){"use forget";const e=E.c(4),{message:t}=o;let s,a;e[0]===Symbol.for("react.memo_cache_sentinel")?(s=[Zn],a={p:xl,strong:hl},e[0]=s,e[1]=a):(s=e[0],a=e[1]);const l=t!=null?t:"";let r;return e[2]!==l?(r=n.jsx("div",{className:"flex items-center gap-3",children:n.jsx(gs,{remarkPlugins:s,components:a,className:"markdown [&>p:last-child]:mb-0!",children:l})}),e[2]=l,e[3]=r):r=e[3],r}function hl(o){const{children:e}=o;return n.jsx("strong",{className:"font-semibold",children:e})}function xl(o){const{children:e}=o;return n.jsx("p",{className:"text-token-text-secondary loading-shimmer-pure-text text-sm leading-tight wrap-anywhere",children:e})}function yl(o){"use forget";const e=E.c(14),{typingUserDisplayNames:t}=o,s=t.length;if(s===0)return null;let a;e[0]!==s||e[1]!==t[0]?(a=s===1&&n.jsx(xe,{id:"7izLl8",defaultMessage:"{userDisplayName} is typing",values:{userDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]})}}),e[0]=s,e[1]=t[0],e[2]=a):a=e[2];let l;e[3]!==s||e[4]!==t[0]||e[5]!==t[1]?(l=s===2&&n.jsx(xe,{id:"nVUHou",defaultMessage:"{primaryUserDisplayName} & {secondaryUserDisplayName} are typing",values:{primaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]}),secondaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[1]})}}),e[3]=s,e[4]=t[0],e[5]=t[1],e[6]=l):l=e[6];let r;e[7]!==s||e[8]!==t[0]?(r=s>2&&n.jsx(xe,{id:"k+PAM5",defaultMessage:"{primaryUserDisplayName} & <strong>{remainingCount} more</strong> are typing",values:{primaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]}),remainingCount:s-1,strong:vl}}),e[7]=s,e[8]=t[0],e[9]=r):r=e[9];let c;return e[10]!==a||e[11]!==l||e[12]!==r?(c=n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("p",{className:"text-token-text-secondary loading-shimmer-pure-text items-baseline text-sm leading-tight",children:[a,l,r]})}),e[10]=a,e[11]=l,e[12]=r,e[13]=c):c=e[13],c}function vl(o){return n.jsx("strong",{className:"font-semibold",children:o},"typing-indicator-strong")}const Cs=String.raw;var Xt;const Wt=Cs(Xt||(Xt=nt(["p{Emoji}(?:p{EMod}|[󠀠-󠁾]+󠁿|️?⃣?)"],["\\p{Emoji}(?:\\p{EMod}|[\\u{E0020}-\\u{E007E}]+\\u{E007F}|\\uFE0F?\\u20E3?)"])));var Zt;const _l=()=>new RegExp(Cs(Zt||(Zt=nt(["p{RI}{2}|(?![#*d](?!️?⃣))","(?:‍",")*"],["\\p{RI}{2}|(?![#*\\d](?!\\uFE0F?\\u20E3))","(?:\\u200D",")*"])),Wt,Wt),"gu"),bl=5;function jl(o){if(o.includes("\n"))return!1;const e=_l();if(!new RegExp("^(?:".concat(e.source,"| )+$"),"u").test(o))return!1;const s=Array.from(o.matchAll(e)).length;return!(s===0||s>bl)}function Kt(o){"use forget";const e=E.c(4),{text:t}=o;if(jl(t)){let a;return e[0]!==t?(a=n.jsx("p",{className:"text-2xl",children:t}),e[0]=t,e[1]=a):a=e[1],a}let s;return e[2]!==t?(s=n.jsx("p",{className:"m-0 wrap-anywhere whitespace-pre-wrap",children:t}),e[2]=t,e[3]=s):s=e[3],s}function Cl(o){"use forget";const e=E.c(8),{room:t}=o;let s;e[0]!==t?(s=()=>t.threadSidebar$(),e[0]=t,e[1]=s):s=e[1];const a=U(s),l=a!=null;let r;e[2]!==a||e[3]!==t?(r=n.jsx(Sl,{room:t,activeSidebar:a}),e[2]=a,e[3]=t,e[4]=r):r=e[4];let c;return e[5]!==l||e[6]!==r?(c=n.jsx(as,{children:n.jsx(qn,{isExpanded:l,children:r})}),e[5]=l,e[6]=r,e[7]=c):c=e[7],c}function Sl({room:o,activeSidebar:e}){const t=U(mn);if(!e)return null;switch(e.type){case"product":return n.jsx(Tl,{room:o,activeSidebar:e,type:t?"sidebar":"modal"})}return null}function Tl(o){"use forget";const e=E.c(25),{activeSidebar:t,room:s,type:a}=o,l=a===void 0?"sidebar":a,r=Q(),c=s.id,{calpicoMessageId:m,messageId:u,contentReferenceStartIndex:f,productIndex:i}=t;let p;e[0]!==m||e[1]!==f||e[2]!==u||e[3]!==s?(p=()=>{var M,T;const k=s.messages$().find(j=>j.id===m);if(!k||k.role!=="assistant")return null;const w=k.rawMessages.find(j=>j.id===u);return w?(T=(M=w.metadata)==null?void 0:M.content_references)==null?void 0:T.find(j=>j.start_idx===f):null},e[0]=m,e[1]=f,e[2]=u,e[3]=s,e[4]=p):p=e[4];const g=U(p);let d;e[5]!==u||e[6]!==c?(d={clientThreadId:c,messageId:u},e[5]=u,e[6]=c,e[7]=d):d=e[7];const v=d;let x;e[8]!==r||e[9]!==s?(x=()=>{ve(r).closeThreadSidebar$(s)},e[8]=r,e[9]=s,e[10]=x):x=e[10];const b=x;if(!g)return null;let h;e[11]!==g||e[12]!==i?(h=ao({contentReference:g,productIndex:i}),e[11]=g,e[12]=i,e[13]=h):h=e[13];const{product:y}=h;if(!y)return null;let _;e[14]!==f||e[15]!==u||e[16]!==i?(_={messageId:u,contentReferenceStartIndex:f,productIndex:i},e[14]=f,e[15]=u,e[16]=i,e[17]=_):_=e[17];let S;return e[18]!==v||e[19]!==b||e[20]!==y||e[21]!==c||e[22]!==_||e[23]!==l?(S=n.jsx(lo,{clientThreadId:c,product:y,sidebar:_,handleCloseThreadSidebar:b,analyticsMetadata:v,type:l}),e[18]=v,e[19]=b,e[20]=y,e[21]=c,e[22]=_,e[23]=l,e[24]=S):S=e[24],S}/*!---------------------------------------------------------------------------------------------
 *  Copyright (c) StackBlitz. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/const Ml={damping:.7,stiffness:.05,mass:1.25},Nl=70,Il=1e3/60,kl=350;let et=!1;var es;(es=globalThis.document)==null||es.addEventListener("mousedown",()=>{et=!0});var ts;(ts=globalThis.document)==null||ts.addEventListener("mouseup",()=>{et=!1});var ss;(ss=globalThis.document)==null||ss.addEventListener("click",()=>{et=!1});const wl=(o={})=>{const[e,t]=C.useState(!1),[s,a]=C.useState(o.initial!==!1),[l,r]=C.useState(!1),c=C.useRef(null);c.current=o;const m=C.useCallback(()=>{var _;if(!et)return!1;const h=window.getSelection();if(!h||!h.rangeCount)return!1;const y=h.getRangeAt(0);return y.commonAncestorContainer.contains(x.current)||((_=x.current)==null?void 0:_.contains(y.commonAncestorContainer))},[]),u=C.useCallback(h=>{i.isAtBottom=h,a(h)},[]),f=C.useCallback(h=>{i.escapedFromLock=h,t(h)},[]),i=C.useMemo(()=>{let h;return{escapedFromLock:e,isAtBottom:s,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){var y,_;return(_=(y=x.current)==null?void 0:y.scrollTop)!=null?_:0},set scrollTop(y){x.current&&(x.current.scrollTop=y,i.ignoreScrollToTop=x.current.scrollTop)},get targetScrollTop(){return!x.current||!b.current?0:x.current.scrollHeight-1-x.current.clientHeight},get calculatedTargetScrollTop(){if(!x.current||!b.current)return 0;const{targetScrollTop:y}=this;if(!o.targetScrollTop)return y;if((h==null?void 0:h.targetScrollTop)===y)return h.calculatedScrollTop;const _=Math.max(Math.min(o.targetScrollTop(y,{scrollElement:x.current,contentElement:b.current}),y),0);return h={targetScrollTop:y,calculatedScrollTop:_},requestAnimationFrame(()=>{h=void 0}),_},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=Nl}}},[]),p=C.useCallback((h={})=>{var T,j;typeof h=="string"&&(h={animation:h}),h.preserveScrollPosition||u(!0);const y=Date.now()+(Number(h.wait)||0),_=dt(c.current,h.animation),{ignoreEscapes:S=!1}=h;let k,w=i.calculatedTargetScrollTop;h.duration instanceof Promise?h.duration.finally(()=>{k=Date.now()}):k=y+((T=h.duration)!=null?T:0);const M=async()=>{const $=new Promise(requestAnimationFrame).then(()=>{var G,O;if(!i.isAtBottom)return i.animation=void 0,!1;const{scrollTop:P}=i,H=performance.now(),L=(H-((G=i.lastTick)!=null?G:H))/Il;if(i.animation||(i.animation={behavior:_,promise:$,ignoreEscapes:S}),i.animation.behavior===_&&(i.lastTick=H),m()||y>Date.now())return M();if(P<Math.min(w,i.calculatedTargetScrollTop)){if(((O=i.animation)==null?void 0:O.behavior)===_){if(_==="instant")return i.scrollTop=i.calculatedTargetScrollTop,M();i.velocity=(_.damping*i.velocity+_.stiffness*i.scrollDifference)/_.mass,i.accumulated+=i.velocity*L,i.scrollTop+=i.accumulated,i.scrollTop!==P&&(i.accumulated=0)}return M()}return k>Date.now()?(w=i.calculatedTargetScrollTop,M()):(i.animation=void 0,i.scrollTop<i.calculatedTargetScrollTop?p({animation:dt(c.current,c.current.resize),ignoreEscapes:S,duration:Math.max(0,k-Date.now())||void 0}):i.isAtBottom)});return $.then(P=>(requestAnimationFrame(()=>{i.animation||(i.lastTick=void 0,i.velocity=0)}),P))};return h.wait!==!0&&(i.animation=void 0),((j=i.animation)==null?void 0:j.behavior)===_?i.animation.promise:M()},[u,m,i]),g=C.useCallback(()=>{f(!0),u(!1)},[f,u]),d=C.useCallback(({target:h})=>{if(h!==x.current)return;const{scrollTop:y,ignoreScrollToTop:_}=i;let{lastScrollTop:S=y}=i;i.lastScrollTop=y,i.ignoreScrollToTop=void 0,_&&_>y&&(S=_),r(i.isNearBottom),setTimeout(()=>{var M;if(i.resizeDifference||y===_)return;if(m()){f(!0),u(!1);return}const k=y>S,w=y<S;if((M=i.animation)!=null&&M.ignoreEscapes){i.scrollTop=S;return}w&&(f(!0),u(!1)),k&&f(!1),!i.escapedFromLock&&i.isNearBottom&&u(!0)},1)},[f,u,m,i]),v=C.useCallback(({target:h,deltaY:y})=>{var S;let _=h;for(;!["scroll","auto"].includes(getComputedStyle(_).overflow);){if(!_.parentElement)return;_=_.parentElement}_===x.current&&y<0&&x.current.scrollHeight>x.current.clientHeight&&!((S=i.animation)!=null&&S.ignoreEscapes)&&(f(!0),u(!1))},[f,u,i]),x=Yt(h=>{var y,_;(y=x.current)==null||y.removeEventListener("scroll",d),(_=x.current)==null||_.removeEventListener("wheel",v),h==null||h.addEventListener("scroll",d,{passive:!0}),h==null||h.addEventListener("wheel",v,{passive:!0})},[]),b=Yt(h=>{var _,S;if((_=i.resizeObserver)==null||_.disconnect(),!h)return;let y;i.resizeObserver=new ResizeObserver(([k])=>{const{height:w}=k.contentRect,M=w-(y!=null?y:w);if(i.resizeDifference=M,i.scrollTop>i.targetScrollTop&&(i.scrollTop=i.targetScrollTop),r(i.isNearBottom),M>=0){const T=dt(c.current,y?c.current.resize:c.current.initial);p({animation:T,wait:!0,preserveScrollPosition:!0,duration:T==="instant"?void 0:kl})}else i.isNearBottom&&(f(!1),u(!0));y=w,requestAnimationFrame(()=>{setTimeout(()=>{i.resizeDifference===M&&(i.resizeDifference=0)},1)})}),(S=i.resizeObserver)==null||S.observe(h)},[]);return{contentRef:b,scrollRef:x,scrollToBottom:p,stopScroll:g,isAtBottom:s||l,isNearBottom:l,escapedFromLock:e,state:i}};function Yt(o,e){const t=C.useCallback(s=>(t.current=s,o(s)),e);return t}const ct=new Map;function dt(...o){var a,l,r;const e=pe({},Ml);let t=!1;for(const c of o){if(c==="instant"){t=!0;continue}typeof c=="object"&&(t=!1,e.damping=(a=c.damping)!=null?a:e.damping,e.stiffness=(l=c.stiffness)!=null?l:e.stiffness,e.mass=(r=c.mass)!=null?r:e.mass)}const s=JSON.stringify(e);return ct.has(s)||ct.set(s,Object.freeze(e)),t?"instant":ct.get(s)}q(()=>V(()=>import("./l8r2q1y684enjq2l.js"),__vite__mapDeps([20,1,2,3,21,22,0,4])).then(o=>o.JsonViewer));function Jt(o,e){return o.role!==e.role?!1:o.role==="user"&&e.role==="user"?o.accountUserId===e.accountUserId:(o.role==="assistant"&&e.role==="assistant",!1)}function Qt(o,e){return xn(e.createdAt,o.createdAt)>30}function Ss(o){"use forget";const e=E.c(15),{date:t}=o,s=Q();let a;if(e[0]!==s||e[1]!==t){const p=is(s).locale;a=Yn(t,p),e[0]=s,e[1]=t,e[2]=a}else a=e[2];const{date:l,time:r}=a;let c;e[3]!==t?(c=t.toISOString(),e[3]=t,e[4]=c):c=e[4];let m;e[5]!==l?(m=n.jsx("span",{className:"font-semibold",children:l}),e[5]=l,e[6]=m):m=e[6];let u;e[7]!==r?(u=n.jsx("span",{children:r}),e[7]=r,e[8]=u):u=e[8];let f;e[9]!==m||e[10]!==u?(f=n.jsx(xe,{id:"Bn2rwA",defaultMessage:"{date} {time}",values:{date:m,time:u}}),e[9]=m,e[10]=u,e[11]=f):f=e[11];let i;return e[12]!==c||e[13]!==f?(i=n.jsx("time",{className:"text-token-text-secondary block w-full px-2 py-0.5 text-center text-xs",dateTime:c,children:f}),e[12]=c,e[13]=f,e[14]=i):i=e[14],i}function El(){"use forget";var l;const o=E.c(2),e=Q(),t=(l=Is().id)!=null?l:null,s=ve(e);if(t==null||!s.hasAccess)return null;let a;return o[0]!==t?(a=n.jsx(Rl,{roomId:t}),o[0]=t,o[1]=a):a=o[1],a}function Rl(o){"use forget";var St;const e=E.c(124),{roomId:t}=o,s=Q();let a;e[0]!==s?(a=ve(s),e[0]=s,e[1]=a):a=e[1];const l=a;let r;e[2]!==l||e[3]!==t?(r=()=>l.rooms$().get(t),e[2]=l,e[3]=t,e[4]=r):r=e[4];const c=U(r);let m;e[5]!==c?(m=()=>{var D;return(D=c==null?void 0:c.fetchSource$())!=null?D:null},e[5]=c,e[6]=m):m=e[6];const u=U(m),f=c==null,i=f||u==="summary";let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p={initial:"instant",resize:"instant"},e[7]=p):p=e[7];const{contentRef:g,scrollRef:d,scrollToBottom:v,isNearBottom:x}=wl(p);let b;e[8]===Symbol.for("react.memo_cache_sentinel")?(b=new Set([]),e[8]=b):b=e[8];const h=C.useRef(b);let y,_;e[9]!==l||e[10]!==t||e[11]!==i?(y=()=>{!i||h.current.has(t)||(h.current.add(t),l.fetchRoom$(t))},_=[l,i,t],e[9]=l,e[10]=t,e[11]=i,e[12]=y,e[13]=_):(y=e[12],_=e[13]),C.useEffect(y,_);let S;e[14]===Symbol.for("react.memo_cache_sentinel")?(S=new Set([]),e[14]=S):S=e[14];const k=C.useRef(S);let w,M;e[15]!==l||e[16]!==f||e[17]!==t?(M=()=>{f||k.current.has(t)||(k.current.add(t),l.fetchMessages$({roomId:t}))},w=[l,f,t],e[15]=l,e[16]=f,e[17]=t,e[18]=w,e[19]=M):(w=e[18],M=e[19]),C.useEffect(M,w);let T;e[20]!==l||e[21]!==t?(T=()=>{var D;return(D=l.rooms$().get(t))==null?void 0:D.viewMessages$()},e[20]=l,e[21]=t,e[22]=T):T=e[22];const j=U(T),$=C.useRef(null);let P;e[23]!==l||e[24]!==t?(P=()=>{var D,R;return(R=(D=l.rooms$().get(t))==null?void 0:D.isFetchingMessages$())!=null?R:!1},e[23]=l,e[24]=t,e[25]=P):P=e[25];const H=U(P);let L;e[26]!==l||e[27]!==t?(L=()=>{var D,R;return(R=(D=l.rooms$().get(t))==null?void 0:D.hasFetchedBeginning$())!=null?R:!1},e[26]=l,e[27]=t,e[28]=L):L=e[28];const G=U(L);let O;e[29]!==l||e[30]!==t?(O=()=>{var R,J,he;const D=(R=l.rooms$().get(t))==null?void 0:R.viewMessages$();return(he=(J=D==null?void 0:D[0])==null?void 0:J.id)!=null?he:null},e[29]=l,e[30]=t,e[31]=O):O=e[31];const F=U(O);let B;e[32]!==l||e[33]!==F||e[34]!==t||e[35]!==d?(B=D=>{const R=d.current;if(!R)return;const J=l.rooms$().get(t);if(!J||J.isFetchingMessages$()||J.hasFetchedBeginning$()||D==="scroll"&&!(R.scrollTop<=200))return;const he=F!=null?F:null,He=R.getBoundingClientRect(),Se=he?R.querySelector('[data-message-id="'.concat(he,'"]')):null,Je=Se?Se.getBoundingClientRect().top-He.top:null;$.current={previousScrollHeight:R.scrollHeight,anchorId:he,anchorOffset:Je},l.fetchMoreMessages$(t,"before")},e[32]=l,e[33]=F,e[34]=t,e[35]=d,e[36]=B):B=e[36];const Y=B;let le,X;e[37]!==Y||e[38]!==d?(le=()=>{const D=d.current;if(D==null)return;const R=gn(()=>{Y("scroll")},100);return D.addEventListener("scroll",R,{passive:!0}),()=>{D.removeEventListener("scroll",R),R.cancel()}},X=[d,Y],e[37]=Y,e[38]=d,e[39]=le,e[40]=X):(le=e[39],X=e[40]),C.useEffect(le,X);let ae;e[41]!==Y||e[42]!==d?(ae=()=>{const D=d.current;if(!D)return;const R=requestAnimationFrame(()=>{D.scrollHeight<=D.clientHeight+1&&Y("underflow")});return()=>cancelAnimationFrame(R)},e[41]=Y,e[42]=d,e[43]=ae):ae=e[43];let ce;e[44]!==Y||e[45]!==j||e[46]!==d?(ce=[j,d,Y],e[44]=Y,e[45]=j,e[46]=d,e[47]=ce):ce=e[47],C.useEffect(ae,ce);let de;e[48]!==d?(de=()=>{const D=$.current;if(!D)return;const R=d.current;if(!R){$.current=null;return}const{anchorId:J,anchorOffset:he,previousScrollHeight:He}=D,Se=function(Ge,Mt){Ge.scrollTop=Ge.scrollTop+Mt};if(J&&he!=null){const Tt=R.getBoundingClientRect(),Ge=R.querySelector('[data-message-id="'.concat(J,'"]'));if(Ge){const Nt=Ge.getBoundingClientRect().top-Tt.top-he;Nt&&Se(R,Nt),$.current=null;return}}const Je=R.scrollHeight-He;Je&&Se(R,Je),$.current=null},e[48]=d,e[49]=de):de=e[49];let I;e[50]!==j||e[51]!==d?(I=[j,d],e[50]=j,e[51]=d,e[52]=I):I=e[52],fn(de,I);let N;e[53]!==j?(N=pn(j),e[53]=j,e[54]=N):N=e[54];const A=N,z=A==null?void 0:A.id,ne=A==null?void 0:A.createdAt;let W;e[55]===Symbol.for("react.memo_cache_sentinel")?(W=new Set,e[55]=W):W=e[55];const ue=C.useRef(W);let Z,ee;e[56]!==l||e[57]!==x||e[58]!==ne||e[59]!==z||e[60]!==t?(Z=()=>{z==null||ne==null||!x||ue.current.has(z)||(ue.current.add(z),l.markRoomRead$(t,ne))},ee=[z,ne,t,l,x],e[56]=l,e[57]=x,e[58]=ne,e[59]=z,e[60]=t,e[61]=Z,e[62]=ee):(Z=e[61],ee=e[62]),C.useEffect(Z,ee);let ie;e[63]===Symbol.for("react.memo_cache_sentinel")?(ie=new Set,e[63]=ie):ie=e[63];const te=C.useRef(ie);let me,fe;e[64]!==x||e[65]!==z||e[66]!==v?(me=()=>{z==null||!x||te.current.has(z)||(te.current.add(z),requestAnimationFrame(()=>{v("instant")}))},fe=[z,v,x],e[64]=x,e[65]=z,e[66]=v,e[67]=me,e[68]=fe):(me=e[67],fe=e[68]),C.useEffect(me,fe);const _e=!H&&((St=j==null?void 0:j.length)!=null?St:0)<Wn,ye=H&&!G&&!_e,be=oe(),tt=c!=null?c:null;let Te;e[69]!==tt?(Te=n.jsx(rl,{room:tt}),e[69]=tt,e[70]=Te):Te=e[70];let Ke;e[71]===Symbol.for("react.memo_cache_sentinel")?(Ke={scrollbarGutter:"stable both-edges"},e[71]=Ke):Ke=e[71];let Me;e[72]!==ye?(Me=ye?n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(hn,{className:"text-token-text-secondary"})}):null,e[72]=ye,e[73]=Me):Me=e[73];let Ne;e[74]!==j?(Ne=j!=null?j:[],e[74]=j,e[75]=Ne):Ne=e[75];let Ie;if(e[76]!==t||e[77]!==j||e[78]!==Ne){let D;e[80]!==t||e[81]!==j?(D=(R,J)=>{const he=J>0&&j!=null&&Qt(j[J-1],R),He=J>0&&j!=null&&Jt(R,j[J-1])&&!he,Se=j!=null&&J<j.length-1&&Jt(R,j[J+1])&&!Qt(R,j[J+1]);return[he?n.jsx(Ss,{date:R.createdAt},"ts-".concat(R.id)):null,n.jsx(Dl,{calpicoMessage:R,roomId:t,groupWithPrevious:He,groupWithNext:Se},R.id)]},e[80]=t,e[81]=j,e[82]=D):D=e[82],Ie=Ne.map(D),e[76]=t,e[77]=j,e[78]=Ne,e[79]=Ie}else Ie=e[79];let ke;e[83]!==A||e[84]!==t?(ke=A!=null?n.jsx(fl,{roomId:t}):null,e[83]=A,e[84]=t,e[85]=ke):ke=e[85];let we;e[86]!==g||e[87]!==Me||e[88]!==Ie||e[89]!==ke?(we=n.jsx(Kn,{fullHeight:!0,horizontalPadding:"standard",children:n.jsx(Gt,{children:n.jsxs("div",{className:"relative flex min-h-full grow flex-col justify-start gap-2 py-6",style:Ke,ref:g,children:[Me,Ie,ke]})})}),e[86]=g,e[87]=Me,e[88]=Ie,e[89]=ke,e[90]=we):we=e[90];let Ee;e[91]!==d||e[92]!==we?(Ee=n.jsx("div",{className:"thread-xl:pt-(--header-height) flex-1 overflow-y-scroll",ref:d,children:we}),e[91]=d,e[92]=we,e[93]=Ee):Ee=e[93];let Re;e[94]!==t||e[95]!==v?(Re=n.jsx(_s,{roomId:t,scrollToBottom:v}),e[94]=t,e[95]=v,e[96]=Re):Re=e[96];let Ae;e[97]!==be?(Ae=be.formatMessage({id:"ISN8OO",defaultMessage:"ChatGPT can make mistakes. Check important info. Your personal ChatGPT memory is never used in group chats."}),e[97]=be,e[98]=Ae):Ae=e[98];let De;e[99]!==Ae?(De=n.jsx("div",{className:"text-token-text-secondary relative mt-auto flex min-h-8 w-full items-center justify-center p-2 text-center text-xs text-pretty",children:n.jsx("p",{children:Ae})}),e[99]=Ae,e[100]=De):De=e[100];let Pe;e[101]!==Re||e[102]!==De?(Pe=n.jsx("div",{children:n.jsxs(Gt,{children:[Re,De]})}),e[101]=Re,e[102]=De,e[103]=Pe):Pe=e[103];let $e;e[104]!==Te||e[105]!==Ee||e[106]!==Pe?($e=n.jsx(ml,{className:"min-w-0 grow",children:n.jsxs("section",{className:"flex h-screen flex-col",children:[Te,Ee,Pe]})}),e[104]=Te,e[105]=Ee,e[106]=Pe,e[107]=$e):$e=e[107];let Le;e[108]!==l||e[109]!==(c==null?void 0:c._oai_internal_roomSystemInstructions)||e[110]!==(c==null?void 0:c._oai_internal_speakDecisionToolDescription)||e[111]!==t?(Le=null,e[108]=l,e[109]=c==null?void 0:c._oai_internal_roomSystemInstructions,e[110]=c==null?void 0:c._oai_internal_speakDecisionToolDescription,e[111]=t,e[112]=Le):Le=e[112];let Fe;e[113]!==c?(Fe=c?n.jsx(Cl,{room:c}):null,e[113]=c,e[114]=Fe):Fe=e[114];let Ue;e[115]!==Fe?(Ue=n.jsx(as,{children:Fe}),e[115]=Fe,e[116]=Ue):Ue=e[116];let Oe;e[117]!==$e||e[118]!==Le||e[119]!==Ue?(Oe=n.jsxs("div",{className:"@container/thread flex h-screen",children:[$e,Le,Ue]}),e[117]=$e,e[118]=Le,e[119]=Ue,e[120]=Oe):Oe=e[120];let Ye;return e[121]!==t||e[122]!==Oe?(Ye=n.jsx(xs,{roomId:t,children:Oe},t),e[121]=t,e[122]=Oe,e[123]=Ye):Ye=e[123],Ye}function Al(o){"use forget";const e=E.c(2),{accountUserId:t}=o,s=ms(t);let a;return e[0]!==s?(a=n.jsx("span",{className:"text-token-text-secondary text-xs",children:s}),e[0]=s,e[1]=a):a=e[1],a}function Dl(o){"use forget";var b,h,y,_,S,k,w;const e=E.c(114),{calpicoMessage:t,roomId:s,groupWithPrevious:a,groupWithNext:l}=o,r=Q(),c=is(r).locale,m=oe();let u;e[0]!==r?(u=ve(r),e[0]=r,e[1]=u):u=e[1];const f=u;let i;e[2]!==f?(i=()=>f.messageDebugMode$(),e[2]=f,e[3]=i):i=e[3],U(i);let p;e[4]!==f||e[5]!==s?(p=()=>{const M=f.rooms$().get(s);return M?M.shouldInsertHeader$():!1},e[4]=f,e[5]=s,e[6]=p):p=e[6];const g=U(p),d=t,v=xt(r),x=(b=v==null?void 0:v.normalizedAccountUserId)!=null?b:null;switch(d.role){case"user":{const M=d.accountUserId===x,T=!!((h=d.content.attachments)!=null&&h.length);let j;e[10]!==d.reactions?(j=Object.keys(d.reactions),e[10]=d.reactions,e[11]=j):j=e[11];const $=j.length>0;if(M){const A=(y=d.requestId)!=null?y:d.id,z=!l&&"mb-4",ne=$&&"mb-2";let W;e[12]!==z||e[13]!==ne?(W=se("group/message relative flex flex-col items-end gap-1",z,ne),e[12]=z,e[13]=ne,e[14]=W):W=e[14];let ue;e[15]!==d.replyTo?(ue=d.replyTo?n.jsx(rt,{targetMessage:(_=d.replyTo.message)!=null?_:null}):null,e[15]=d.replyTo,e[16]=ue):ue=e[16];let Z;e[17]===Symbol.for("react.memo_cache_sentinel")?(Z=["addReaction","reply","delete"],e[17]=Z):Z=e[17];let ee;e[18]!==d||e[19]!==s?(ee=n.jsx(at,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:Z}),e[18]=d,e[19]=s,e[20]=ee):ee=e[20];let ie;e[21]!==T||e[22]!==d||e[23]!==s?(ie=T?n.jsx(Ze,{message:d,roomId:s}):null,e[21]=T,e[22]=d,e[23]=s,e[24]=ie):ie=e[24];let te;e[25]!==T||e[26]!==d.content.text?(te=d.content.text?n.jsx("div",{className:se("group/message user-message-bubble-color relative max-w-full rounded-ss-3xl rounded-b-3xl px-4 py-2.5",T?"rounded-se-lg":"rounded-se-3xl"),children:n.jsx(Kt,{text:d.content.text})}):null,e[25]=T,e[26]=d.content.text,e[27]=te):te=e[27];let me;e[28]!==d||e[29]!==s?(me=n.jsx(it,{roomId:s,message:d,className:"absolute end-3 -bottom-4 z-10"}),e[28]=d,e[29]=s,e[30]=me):me=e[30];let fe;e[31]!==m||e[32]!==d.deliveryErrorMessage||e[33]!==d.deliveryState?(fe=d.deliveryState==="failed"?n.jsx("p",{className:"text-token-text-error mt-1 text-end text-xs",role:"alert",children:(S=d.deliveryErrorMessage)!=null?S:m.formatMessage({id:"PTNnih",defaultMessage:"Failed to send message."})}):null,e[31]=m,e[32]=d.deliveryErrorMessage,e[33]=d.deliveryState,e[34]=fe):fe=e[34];let _e;e[35]!==ie||e[36]!==te||e[37]!==me||e[38]!==fe?(_e=n.jsxs("div",{className:"relative flex max-w-4/5 flex-col items-end justify-end",children:[ie,te,me,fe]}),e[35]=ie,e[36]=te,e[37]=me,e[38]=fe,e[39]=_e):_e=e[39];let ye;e[40]!==ee||e[41]!==_e?(ye=n.jsxs("div",{className:"flex w-full flex-row items-center justify-end gap-2",children:[ee,_e]}),e[40]=ee,e[41]=_e,e[42]=ye):ye=e[42];let be;return e[43]!==d.id||e[44]!==ye||e[45]!==A||e[46]!==W||e[47]!==ue?(be=n.jsxs("div",{className:W,"data-message-id":d.id,children:[ue,ye]},A),e[43]=d.id,e[44]=ye,e[45]=A,e[46]=W,e[47]=ue,e[48]=be):be=e[48],be}const P=!l&&"mb-4",H=$&&"mb-3";let L;e[49]!==P||e[50]!==H?(L=se("group/message flex gap-2",P,H),e[49]=P,e[50]=H,e[51]=L):L=e[51];let G;e[52]!==l||e[53]!==d.accountUserId?(G=l?n.jsx("div",{className:"h-7 w-7 flex-shrink-0"}):n.jsx("div",{className:"gizmo-shadow-stroke h-7 w-7 flex-shrink-0 self-end rounded-full",children:n.jsx(Vo,{accountUserId:d.accountUserId,allowViewingProfile:!0,size:"medium"})}),e[52]=l,e[53]=d.accountUserId,e[54]=G):G=e[54];const O=a?null:n.jsx("div",{className:"flex w-full items-center ps-4",children:n.jsxs("div",{children:[n.jsx(Al,{accountUserId:d.accountUserId}),n.jsx("span",{className:"text-token-text-secondary ms-2 text-xs opacity-0 group-hover/message:opacity-100",title:d.createdAt.toLocaleString(c),children:d.createdAt.toLocaleTimeString(c,{hour:"numeric",minute:"2-digit"})})]})});let F;e[55]!==d.replyTo?(F=d.replyTo?n.jsx(rt,{targetMessage:(k=d.replyTo.message)!=null?k:null}):null,e[55]=d.replyTo,e[56]=F):F=e[56];let B;e[57]!==T||e[58]!==d||e[59]!==s?(B=T?n.jsx(Ze,{message:d,roomId:s}):null,e[57]=T,e[58]=d,e[59]=s,e[60]=B):B=e[60];let Y;e[61]!==T||e[62]!==d.content.text?(Y=d.content.text?n.jsx("div",{className:se("group/message bg-token-bg-tertiary relative max-w-full rounded-ss-3xl rounded-b-3xl px-4 py-2.5",T?"rounded-se-lg":"rounded-se-3xl"),children:n.jsx(Kt,{text:d.content.text})}):null,e[61]=T,e[62]=d.content.text,e[63]=Y):Y=e[63];let le;e[64]!==d||e[65]!==s?(le=n.jsx(it,{roomId:s,message:d,className:"absolute end-3 -bottom-4 z-10"}),e[64]=d,e[65]=s,e[66]=le):le=e[66];let X;e[67]!==B||e[68]!==Y||e[69]!==le?(X=n.jsxs("div",{className:"relative flex max-w-4/5 flex-col justify-start",children:[B,Y,le]}),e[67]=B,e[68]=Y,e[69]=le,e[70]=X):X=e[70];let ae;e[71]===Symbol.for("react.memo_cache_sentinel")?(ae=["addReaction","reply","report"],e[71]=ae):ae=e[71];let ce;e[72]!==d||e[73]!==s?(ce=n.jsx(at,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:ae}),e[72]=d,e[73]=s,e[74]=ce):ce=e[74];let de;e[75]!==X||e[76]!==ce?(de=n.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-2",children:[X,ce]}),e[75]=X,e[76]=ce,e[77]=de):de=e[77];let I;e[78]!==F||e[79]!==de||e[80]!==O?(I=n.jsxs("div",{className:"flex grow flex-col items-start gap-1",children:[O,F,de]}),e[78]=F,e[79]=de,e[80]=O,e[81]=I):I=e[81];let N;return e[82]!==d.id||e[83]!==I||e[84]!==L||e[85]!==G?(N=n.jsxs("div",{className:L,"data-message-id":d.id,children:[G,I]}),e[82]=d.id,e[83]=I,e[84]=L,e[85]=G,e[86]=N):N=e[86],N}case"assistant":{const M=a?null:n.jsx("div",{className:"mb-1 flex w-full items-center justify-between",children:n.jsxs("div",{children:[n.jsx(Pl,{modelSlug:d.modelSlug}),n.jsx("span",{className:"text-token-text-secondary ms-2 text-xs opacity-0 group-hover/message:opacity-100",title:d.createdAt.toLocaleString(c),children:d.createdAt.toLocaleTimeString(c,{hour:"numeric",minute:"2-digit"})})]})});let T;e[87]!==d.replyTo?(T=d.replyTo?n.jsx(rt,{targetMessage:(w=d.replyTo.message)!=null?w:null}):null,e[87]=d.replyTo,e[88]=T):T=e[88];let j;e[89]!==d||e[90]!==s?(j=n.jsx("div",{className:"relative max-w-full min-w-0 shrink",children:n.jsx(Go,{message:d,roomId:s})}),e[89]=d,e[90]=s,e[91]=j):j=e[91];let $;e[92]!==M||e[93]!==T||e[94]!==j?($=n.jsxs("div",{className:"relative flex grow flex-col",children:[M,T,j]}),e[92]=M,e[93]=T,e[94]=j,e[95]=$):$=e[95];let P;e[96]!==d||e[97]!==s?(P=Object.keys(d.reactions).length>0?n.jsx("div",{className:"flex",children:n.jsx(it,{roomId:s,message:d})}):null,e[96]=d,e[97]=s,e[98]=P):P=e[98];let H;e[99]===Symbol.for("react.memo_cache_sentinel")?(H=["addReaction","reply","delete"],e[99]=H):H=e[99];let L;e[100]!==d||e[101]!==s?(L=n.jsx(at,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:H}),e[100]=d,e[101]=s,e[102]=L):L=e[102];let G;return e[103]!==d.id||e[104]!==L||e[105]!==$||e[106]!==P?(G=n.jsxs("div",{className:"group/message","data-message-id":d.id,children:[$,P,L]}),e[103]=d.id,e[104]=L,e[105]=$,e[106]=P,e[107]=G):G=e[107],G}case"system":{let M;return e[108]!==f||e[109]!==r||e[110]!==d||e[111]!==s||e[112]!==g?(M=n.jsx($l,{message:d,roomId:s,ctx:r,calpicoState:f,shouldInsertHeader:g}),e[108]=f,e[109]=r,e[110]=d,e[111]=s,e[112]=g,e[113]=M):M=e[113],M}}}function Pl(o){"use forget";const e=E.c(11),{modelSlug:t}=o,s=Q();let a;e[0]!==s?(a=()=>yn(s,{isGizmo:!1}),e[0]=s,e[1]=a):a=e[1];const l=U(a);let r;e:{if(t!=null){let f;if(e[2]!==t||e[3]!==l.categories){let g;e[5]!==t?(g=d=>{const{defaultModel:v}=d;return v===t},e[5]=t,e[6]=g):g=e[6],f=l.categories.find(g),e[2]=t,e[3]=l.categories,e[4]=f}else f=e[4];const i=f,p=i==null?void 0:i.shortLabel;if(p){r="ChatGPT ".concat(p);break e}}r="ChatGPT"}const c=r;if(os(s,"1987254067")){let f;return e[7]!==c?(f=n.jsx("span",{className:"text-token-text-secondary text-xs",children:c}),e[7]=c,e[8]=f):f=e[8],f}let u;return e[9]!==c?(u=n.jsx("span",{className:"text-token-text-secondary text-xs",title:c,children:"ChatGPT"}),e[9]=c,e[10]=u):u=e[10],u}function $l(o){"use forget";const e=E.c(23),{message:t,roomId:s,ctx:a,calpicoState:l,shouldInsertHeader:r}=o,c=t.content.type==="create_magic_link"||t.content.type==="create_chat"&&!r,m=oe();let u;e[0]!==m?(u=m.formatMessage({id:"HYPzFm",defaultMessage:"Invite with link"}),e[0]=m,e[1]=u):u=e[1];const f=u;let i;e[2]!==m?(i=m.formatMessage({id:"e7LaZn",defaultMessage:"Your personal ChatGPT memory is never used in group chats."}),e[2]=m,e[3]=i):i=e[3];const p=i;let g;e[4]!==t.content.type||e[5]!==t.createdAt||e[6]!==t.id?(g=t.content.type==="create_chat"?n.jsx("div",{className:"mb-3",children:n.jsx(Ss,{date:t.createdAt},"ts-".concat(t.id))}):null,e[4]=t.content.type,e[5]=t.createdAt,e[6]=t.id,e[7]=g):g=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d={p:Fl,strong:Ll},e[8]=d):d=e[8];let v;e[9]!==t.content.text?(v=n.jsx("div",{className:"self-center",children:n.jsx("div",{className:"flex items-center justify-center gap-1.5",children:n.jsx(gs,{components:d,children:t.content.text})})}),e[9]=t.content.text,e[10]=v):v=e[10];let x;e[11]!==l||e[12]!==a||e[13]!==p||e[14]!==s||e[15]!==f||e[16]!==c?(x=c?n.jsxs("div",{className:"mt-4 self-center text-center",children:[n.jsx("p",{className:"text-token-text-secondary text-xs",children:p}),n.jsx(vn,{color:"secondary",className:"mt-4 mb-2",contentWrapperClassName:"text-xs font-semibold",label:f,onClick:()=>{const h=l.rooms$().get(s);h&&re(a,ps,{room:h})},children:f})]}):null,e[11]=l,e[12]=a,e[13]=p,e[14]=s,e[15]=f,e[16]=c,e[17]=x):x=e[17];let b;return e[18]!==t.id||e[19]!==g||e[20]!==v||e[21]!==x?(b=n.jsxs("div",{className:"self-center","data-message-id":t.id,children:[g,v,x]}),e[18]=t.id,e[19]=g,e[20]=v,e[21]=x,e[22]=b):b=e[22],b}function Ll(o){const{children:e}=o;return n.jsx("strong",{className:"font-semibold",children:e})}function Fl(o){const{children:e}=o;return n.jsx("p",{className:"text-token-text-secondary text-center text-xs wrap-anywhere",children:e})}const Ua=()=>null,Oa=()=>!1,Ba=ks(function(){"use forget";const e=E.c(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=n.jsxs(n.Fragment,{children:[n.jsx("meta",{name:"robots",content:"noindex,nofollow"}),n.jsx(El,{})]}),e[0]=t):t=e[0],t});export{Ua as clientLoader,Ba as default,Oa as shouldRevalidate};
//# sourceMappingURL=ge672m5i9kkqicyl.js.map

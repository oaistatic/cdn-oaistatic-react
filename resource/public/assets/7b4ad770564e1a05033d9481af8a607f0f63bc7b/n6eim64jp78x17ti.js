const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kw08ajijqinojrwh.js","assets/kfrdmkli83ureki3.js","assets/root-fi49nzd2.css"])))=>i.map(i=>d[i]);
var J=Object.defineProperty,$=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var C=(t,a,o)=>a in t?J(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,u=(t,a)=>{for(var o in a||(a={}))K.call(a,o)&&C(t,o,a[o]);if(q)for(var o of q(a))X.call(a,o)&&C(t,o,a[o]);return t},b=(t,a)=>$(t,G(a));import{_ as Y,h as Z,u as ee,r as L,i as se,j as e,M as F}from"./kfrdmkli83ureki3.js";import{j as te,k as ae,m as p,l as oe,L as ie,H as ne,D as re,o as le,W as M}from"./fyw02vlaiv2vq6cj.js";import{E as ce}from"./d24clsve229czwkp.js";import{az as de,dk as ue,u as pe,p as xe,R as me,dj as fe,d_ as ge,dR as he,aB as ve,aA as we}from"./kw08ajijqinojrwh.js";import{u as ke}from"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";const je=de(()=>Y(()=>import("./kw08ajijqinojrwh.js").then(t=>t.yt),__vite__mapDeps([0,1,2])),{loading:t=>we(t)});function be(){return e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsxs("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:[e.jsx(M,{},1),e.jsx(M,{},2)]})})}function qe({onClose:t,mode:a="blocking",section:o="existing",source:A="unknown"}){var R,S;const{data:m,isFetching:I}=ke(),n=ue(),H=(R=n==null?void 0:n.email)!=null?R:"",f=Z(),P=pe(),V=(n==null?void 0:n.email_domain_type)==="professional",y=o==="existing"||o==="both",x=(o==="discoverable"||o==="both")&&V,{data:r,isFetching:z}=te(x),B=ee(),[T,g]=L.useState(null),D=xe(),{setHasSeenWorkspaceDiscoveryFirstLoginDontInvalidateCache:h}=ae(),_=se({mutationFn:async s=>{await me.safePost("/accounts/{account_id}/invites/request",{parameters:{path:{account_id:s}}})},onSuccess:(s,i)=>{B.setQueryData(["discoverable-workspaces"],c=>c!=null&&c.workspaces?b(u({},c),{workspaces:c.workspaces.map(j=>j.id===i?b(u({},j),{requested:!0}):j)}):c)},onError:(s,i)=>{g(null),D.danger(f.formatMessage(p.requestAccessError),{toastId:"request-access-".concat(i)})},onSettled:()=>{g(null)}}),O=x&&!!(r!=null&&r.has_more),d=y&&I||x&&z,l=[];if(y&&l.push(...(m!=null?m:[]).map(s=>({type:"existing",w:s}))),x){const s=(S=r==null?void 0:r.workspaces)!=null?S:[];l.push(...s.map(i=>({type:"discoverable",w:i})))}const v=l.filter(s=>s.type==="existing").length,w=l.filter(s=>s.type==="discoverable").length,{hasLoggedFullscreenView:N,logFullscreenViewedOnce:W,logExitEvent:k,logRequestButtonClicked:U,logRequestButtonHovered:Q}=oe({source:A,existingCount:v,discoverableCount:w});if(L.useEffect(()=>{!N&&!d&&W()},[N,W,d]),a==="blocking"&&v===0&&!d)return null;const E=fe(P,"2133596510").get("enabled",!1);return e.jsx(ge,{children:e.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4},"data-testid":"fullscreen-workspace-switcher",className:"bg-token-bg-primary absolute inset-0 start-0 top-0 z-50 h-full w-full",role:"dialog","aria-modal":"true","aria-label":f.formatMessage(p.title),children:e.jsxs("div",{className:"flex h-full max-h-full flex-col",children:[a==="dismissible"&&e.jsx("div",{className:"absolute end-4 top-4",children:e.jsx("button",{type:"button","aria-label":f.formatMessage(p.close),onClick:()=>{h(),k("close"),t()},className:"rounded-full p-2 hover:bg-transparent",children:e.jsx(je,{className:"icon"})})}),e.jsx("div",{className:"flex flex-1 items-start justify-center px-6 pt-[15vh] pb-12",children:e.jsxs("div",{className:"flex w-[440px] flex-col items-center",children:[d?e.jsxs(e.Fragment,{children:[e.jsx(ie,{showCollaborationSubtitle:E}),e.jsx(be,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{existingCount:v,discoverableCount:w,accountEmail:H,showCollaborationSubtitle:E}),l.length>0&&e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsx("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:l.map(s=>s.type==="existing"?e.jsx(ce,{workspace:s.w,onOpen:()=>{h(),k("open_workspace")}},s.w.id):e.jsx(re,{workspace:s.w,isLoading:_.isPending&&T===s.w.id,onHoverRequest:i=>{Q(i)},onRequestAccess:i=>{g(i.id),U(i),_.mutate(i.id)}},s.w.id))})})]}),o==="discoverable"&&w===0&&!d&&e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex w-full flex-col rounded-2xl border py-20",children:e.jsx("div",{className:"text-token-text-secondary text-center text-sm",children:e.jsx(F,u({},p.noWorkspacesToJoin))})})}),a==="dismissible"&&e.jsx("div",{className:"mt-4 w-full",children:e.jsx(ve,{fullWidth:!0,onClick:()=>{h(),k("close"),t()},children:e.jsx(F,u({},p.done))})}),e.jsx(le,{showHiddenWorkspacesNote:O})]})})]})})})}export{qe as default};
//# sourceMappingURL=n6eim64jp78x17ti.js.map

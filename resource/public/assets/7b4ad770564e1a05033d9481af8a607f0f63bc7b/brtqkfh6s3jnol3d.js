var Ee=Object.defineProperty,Fe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var me=(a,r,c)=>r in a?Ee(a,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[r]=c,t=(a,r)=>{for(var c in r||(r={}))Ve.call(r,c)&&me(a,c,r[c]);if(pe)for(var c of pe(r))Re.call(r,c)&&me(a,c,r[c]);return a},h=(a,r)=>Fe(a,Ue(r));import{h as We,a as Le,d as qe,o as He,u as Ge,e as Ke,r as o,b as Ye,j as e,M as n,y as Be}from"./kfrdmkli83ureki3.js";import{u as Qe,N as $e,n7 as ze,dT as Ze,dk as Je,ag as he,ah as ke,aZ as U,_ as Oe,eV as je,D as we,o2 as Xe,nQ as et,aS as G,aB as p,e6 as tt}from"./kw08ajijqinojrwh.js";import{T as K}from"./d926frjkxobgocsd.js";const i=Ke({loginRequiredTitle:{id:"k12InvitePage.loginRequiredTitle",defaultMessage:"Log in to accept this invite"},loginRequiredDescription:{id:"k12InvitePage.loginRequiredDescription",defaultMessage:"Log in as {email} to continue. After logging in, we’ll bring you right back to this page."},loginRequiredSignupDescription:{id:"k12InvitePage.loginRequiredSignupDescription",defaultMessage:"Don’t have access to {email}? Create an account with that email and return here. Use the buttons below to continue."},loginCta:{id:"k12InvitePage.loginCta",defaultMessage:"Log in"},signupCta:{id:"k12InvitePage.signupCta",defaultMessage:"Sign up"},inviteGreeting:{id:"k12InvitePage.inviteGreeting",defaultMessage:"Hey, you’re signed in as {email}"},inviteDescription:{id:"k12InvitePage.inviteDescription",defaultMessage:"You’ve been invited to join the {workspaceName} workspace. Click below to continue."},invitePendingDescription:{id:"k12InvitePage.invitePendingDescription",defaultMessage:"We need to confirm you’re an educator before you can join this workspace. Continue to complete a quick verification."},startVerificationCta:{id:"k12InvitePage.startVerificationCta",defaultMessage:"Continue to verification"},refreshStatusCta:{id:"k12InvitePage.refreshStatusCta",defaultMessage:"Refresh status"},inviteVerifiedTitle:{id:"k12InvitePage.inviteVerifiedTitle",defaultMessage:"You’re verified and ready to join"},inviteVerifiedDescription:{id:"k12InvitePage.inviteVerifiedDescription",defaultMessage:"Great news! Verification is complete. Accept the invite to open {workspaceName}."},acceptInviteCta:{id:"k12InvitePage.acceptInviteCta",defaultMessage:"Accept invite and continue"},inviteVerificationFailedTitle:{id:"k12InvitePage.inviteVerificationFailedTitle",defaultMessage:"We couldn’t verify your eligibility"},inviteVerificationFailedDescription:{id:"k12InvitePage.inviteVerificationFailedDescription",defaultMessage:"We weren’t able to confirm you’re an educator, so you can’t accept this invite. If this is a mistake, please contact your workspace admin."},inviteExpiredTitle:{id:"k12InvitePage.inviteExpiredTitle",defaultMessage:"This invite has expired"},inviteExpiredDescription:{id:"k12InvitePage.inviteExpiredDescription",defaultMessage:"You’re signed in as {email}, but the invite to join {workspaceName} has expired. Ask the sender for a new invite."},inviteAcceptedTitle:{id:"k12InvitePage.inviteAcceptedTitle",defaultMessage:"You’re already part of this workspace"},inviteAcceptedDescription:{id:"k12InvitePage.inviteAcceptedDescription",defaultMessage:"It looks like you’ve already joined {workspaceName}. Head to ChatGPT to start working with your workspace."},inviteWrongUserTitle:{id:"k12InvitePage.inviteWrongUserTitle",defaultMessage:"This invite belongs to a different account"},inviteWrongUserDescription:{id:"k12InvitePage.inviteWrongUserDescription",defaultMessage:"You’re signed in as {email}, but this invite was sent to a different email address. Sign in with the invited account or ask the sender for a new invite."},inviteWrongUserTargetDescription:{id:"k12InvitePage.inviteWrongUserTargetDescription",defaultMessage:"This invite was sent to {email}. Log in with that email to continue."},inviteWrongUserSwitchAccountCta:{id:"k12InvitePage.inviteWrongUserSwitchAccountCta",defaultMessage:"Switch accounts"},inviteNotFoundTitle:{id:"k12InvitePage.inviteNotFoundTitle",defaultMessage:"Invite not found"},inviteNotFoundDescription:{id:"k12InvitePage.inviteNotFoundDescription",defaultMessage:"We couldn’t find an invite that matches this link. It may have been deleted or replaced. Ask your workspace admin to send a new invite."},inviteUnknownTitle:{id:"k12InvitePage.inviteUnknownTitle",defaultMessage:"We’re having trouble loading this invite"},inviteUnknownDescription:{id:"k12InvitePage.inviteUnknownDescription",defaultMessage:"Please refresh the page. If the issue persists, request a new invite from your workspace admin."},inviteMissingInviteTitle:{id:"k12InvitePage.inviteMissingInviteTitle",defaultMessage:"This invite link is incomplete"},inviteMissingInviteDescription:{id:"k12InvitePage.inviteMissingInviteDescription",defaultMessage:"We can’t load the invite because the link is missing required details. Request a new invite and try again."},inviteActionError:{id:"k12InvitePage.inviteActionError",defaultMessage:"We couldn’t complete that action. Please try again in a moment."},inviteCheckingStatus:{id:"k12InvitePage.inviteCheckingStatus",defaultMessage:"Checking your invite…"},inviteGoHomeCta:{id:"k12InvitePage.inviteGoHomeCta",defaultMessage:"Go to ChatGPT"},inviteMissingWorkspace:{id:"k12InvitePage.inviteMissingWorkspace",defaultMessage:"We couldn’t find the workspace details for this invite. Please double-check the link or ask the sender to resend it."},inviteWorkspaceFallback:{id:"k12InvitePage.inviteWorkspaceFallback",defaultMessage:"your new workspace"},inviteEmailFallback:{id:"k12InvitePage.inviteEmailFallback",defaultMessage:"your account"}}),d={impression:{segment:"K12 Invite: Shown",statsig:"chatgpt_k12_invite_shown"},login:{segment:"K12 Invite: Login Clicked",statsig:"chatgpt_k12_invite_login_clicked"},signup:{segment:"K12 Invite: Signup Clicked",statsig:"chatgpt_k12_invite_signup_clicked"},refreshStatus:{segment:"K12 Invite: Refresh Status Clicked",statsig:"chatgpt_k12_invite_refresh_status_clicked"},startVerification:{segment:"K12 Invite: Start Verification Clicked",statsig:"chatgpt_k12_invite_start_verification_clicked"},acceptInvite:{segment:"K12 Invite: Accept Invite Clicked",statsig:"chatgpt_k12_invite_accept_clicked"},acceptResult:{segment:"K12 Invite: Accept Invite Result",statsig:"chatgpt_k12_invite_accept_result"},switchAccount:{segment:"K12 Invite: Switch Account Clicked",statsig:"chatgpt_k12_invite_switch_account_clicked"},goHome:{segment:"K12 Invite: Go Home Clicked",statsig:"chatgpt_k12_invite_go_home_clicked"}},it=()=>{var ie,ne,se,ae,re,oe,ce,le,de,ue,ge,ve,xe,fe;const a=Qe(),r=We(),c=Le(),Y=qe(),[T]=He(),C=$e(a),P=ze(a),V=Ze(),R=Je(),B=Ge(),D=(ie=P==null?void 0:P.user)==null?void 0:ie.email,A="".concat(c.pathname).concat(c.search).concat(c.hash),E=(ae=(se=V==null?void 0:V.planType)!=null?se:(ne=P==null?void 0:P.account)==null?void 0:ne.planType)!=null?ae:null,W=(re=R==null?void 0:R.email_domain_type)!=null?re:null,L=(oe=T.get("inv_ws_name"))!=null?oe:void 0,y=(ce=T.get("inv_email"))!=null?ce:void 0,f=(le=T.get("wId"))!=null?le:void 0,x=(de=T.get("aiId"))!=null?de:void 0,Q=r.formatMessage(i.inviteEmailFallback),Ie=r.formatMessage(i.inviteWorkspaceFallback);o.useEffect(()=>{f&&he.setCookie(ke.AcceptAccountId,f,{maxAge:120})},[f]);const s=Ye({queryKey:["k12InviteStatus",x],enabled:!!x,retry:!1,queryFn:async()=>{if(!x)throw new Error("Missing invite id");return await K.refreshInviteStatus(x)}}),[q,_]=o.useState(null),[Ce,$]=o.useState(!1),[z,_e]=o.useState(!1),b=(ue=y!=null?y:D)!=null?ue:Q,N=L!=null?L:Ie,H=D!=null?D:Q,F=o.useMemo(()=>new URLSearchParams(c.search).get("referer"),[c.search]),k=(ve=(ge=s.data)==null?void 0:ge.metadata)!=null?ve:void 0,g=k==null?void 0:k.invite_status,j=(xe=k==null?void 0:k.verification_status)!=null?xe:void 0,S=(fe=k==null?void 0:k.verification_id)!=null?fe:void 0,Z=o.useMemo(()=>({isLoggedIn:C,loggedInStatus:C?"logged_in":"logged_out",accountPlanType:C?E!=null?E:"unknown":null,emailDomainType:W,referer:F!=null?F:null,accountInviteId:x!=null?x:null,workspaceId:f!=null?f:null,invitedEmail:y!=null?y:null,displayEmail:b,workspaceName:N,signedInEmail:H}),[x,b,N,W,y,C,E,F,H,f]),u=o.useMemo(()=>C?x?s.isLoading&&s.data==null?"loading":s.error?s.error instanceof U&&s.error.status===403?"wrong_user_error":s.error instanceof U&&s.error.status===404?"not_found_error":"unknown_error":k?g==="wrong_user"?"wrong_user":g==="expired"?"expired":g==="accepted"?"accepted":g==="not_found"?"not_found":ye(j)?"verification_failed":j==="verified"||j==="linked"?"verified_ready":g!=="pending"&&g!=="requested"?"unknown_status":"pending":"unknown_status":"missing_invite":"login_required",[x,k,g,s.data,s.error,s.isLoading,C,j]),J=o.useMemo(()=>h(t({},Z),{view:u,inviteStatus:g!=null?g:null,verificationStatus:j!=null?j:null}),[Z,g,u,j]),v=o.useCallback((l,w,M)=>{Oe.logEventWithStatsig(l,w,t(t({},J),M))},[J]),O=o.useRef(!1),X=!C||W!=null,ee=u!=="loading";o.useEffect(()=>{!X||!ee||O.current||(v(d.impression.segment,d.impression.statsig),O.current=!0)},[X,ee,v]),o.useEffect(()=>{_(null)},[g,j]),o.useEffect(()=>{s.error&&_(null)},[s.error]);const m=o.useCallback(({title:l,content:w,actions:M,showActionError:De=!0})=>e.jsxs("div",{className:"flex min-h-[60vh] flex-col items-center justify-center gap-4 p-6 text-center",children:[e.jsx("h1",{className:"text-token-text-primary text-2xl font-semibold",children:l}),w,De&&q?e.jsx("p",{className:"text-danger text-sm",children:q}):null,M]}),[q]),I=o.useCallback(()=>{v(d.refreshStatus.segment,d.refreshStatus.statsig,{source:u}),_(null),s.refetch()},[s,u,v]),be=o.useCallback(async()=>{_(null),$(!0),v(d.startVerification.segment,d.startVerification.statsig,{source:u,verificationId:S!=null?S:null});try{const l=S!=null?S:(await K.createVerification()).verification_id,w=nt(l,window.location.href);window.location.href=w}catch(l){const w=je(l);_(w!=null?w:r.formatMessage(i.inviteActionError))}finally{$(!1)}},[S,r,u,v]),Ne=o.useCallback(async()=>{if(!(!f||!x)){_(null),_e(!0),v(d.acceptInvite.segment,d.acceptInvite.statsig,{source:u});try{await K.acceptInvite(x),he.deleteCookie(ke.AcceptAccountId),we.addAction("k12Invite.accept_invite.success",{accountInviteId:x,workspaceId:f}),v(d.acceptResult.segment,d.acceptResult.statsig,{source:u,status:"success"}),await new Promise(l=>setTimeout(l,3e3)),Xe(a,B,f),et()}catch(l){we.addAction("k12Invite.accept_invite.error",{accountInviteId:x,workspaceId:f,error:l instanceof Error?l.message:String(l)});const w=l instanceof Error?{errorName:l.name,errorMessage:l.message}:{errorName:typeof l,errorMessage:String(l)};v(d.acceptResult.segment,d.acceptResult.statsig,t({source:u,status:"error"},w));const M=je(l);_(M!=null?M:r.formatMessage(i.inviteActionError))}}},[f,x,r,a,B,u,v]),Se=o.useCallback(()=>{_(null),v(d.switchAccount.segment,d.switchAccount.statsig,{source:u}),G(a,{fallbackScreenHint:"login",useFallbackScreenHint:!0,callbackUrl:A,skipLoginModal:!0})},[a,A,u,v]),Me=o.useCallback(()=>{v(d.login.segment,d.login.statsig,{source:u}),G(a,{fallbackScreenHint:"login",useFallbackScreenHint:!0,callbackUrl:A,skipLoginModal:!0})},[A,a,u,v]),Pe=o.useCallback(()=>{v(d.signup.segment,d.signup.statsig,{source:u}),G(a,{fallbackScreenHint:"signup",useFallbackScreenHint:!0,callbackUrl:A,skipLoginModal:!0})},[A,a,u,v]),Ae=o.useCallback(()=>{v(d.goHome.segment,d.goHome.statsig,{source:u}),Y("/")},[u,v,Y]),te=m({title:e.jsx(n,t({},i.inviteWrongUserTitle)),content:e.jsxs("div",{className:"text-token-text-secondary flex max-w-md flex-col gap-3 text-base",children:[e.jsx("p",{children:e.jsx(n,h(t({},i.inviteWrongUserDescription),{values:{email:H}}))}),y?e.jsx("p",{className:"text-token-text-tertiary text-sm",children:e.jsx(n,h(t({},i.inviteWrongUserTargetDescription),{values:{email:e.jsx("span",{className:"text-token-text-primary font-semibold",children:y})}}))}):null]}),actions:e.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[e.jsx(p,{onClick:Se,className:"w-48",children:e.jsx(n,t({},i.inviteWrongUserSwitchAccountCta))}),e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,className:"w-48",children:e.jsx(n,t({},i.refreshStatusCta))})]}),showActionError:!1});if(!C)return e.jsxs("div",{className:"flex min-h-[60vh] flex-col items-center justify-center gap-5 p-6 text-center",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:e.jsx(n,t({},i.loginRequiredTitle))}),e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,h(t({},i.loginRequiredDescription),{values:{email:b}}))}),e.jsx("p",{className:"text-token-text-tertiary max-w-md text-sm",children:e.jsx(n,h(t({},i.loginRequiredSignupDescription),{values:{email:b}}))}),e.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[e.jsx(p,{onClick:Me,className:"w-48",children:e.jsx(n,t({},i.loginCta))}),e.jsx(p,{color:"secondary",onClick:Pe,className:"w-48",children:e.jsx(n,t({},i.signupCta))})]})]});if(!x)return m({title:e.jsx(n,t({},i.inviteMissingInviteTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteMissingInviteDescription))}),showActionError:!1});if(s.isLoading&&s.data==null)return m({title:e.jsx(n,h(t({},i.inviteGreeting),{values:{email:b}})),content:e.jsxs("div",{className:"text-token-text-secondary flex max-w-md flex-col items-center gap-4 text-base",children:[e.jsx("p",{className:"text-center",children:e.jsx(n,h(t({},i.inviteDescription),{values:{workspaceName:e.jsx("span",{className:"text-token-text-primary font-semibold",children:N})}}))}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(tt,{className:"text-token-text-secondary h-8 w-8"}),e.jsx(n,t({},i.inviteCheckingStatus))]})]}),showActionError:!1});if(s.error)return s.error instanceof U&&s.error.status===403?te:s.error instanceof U&&s.error.status===404?m({title:e.jsx(n,t({},i.inviteNotFoundTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteNotFoundDescription))}),showActionError:!1}):m({title:e.jsx(n,t({},i.inviteUnknownTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteUnknownDescription))}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})});if(!k)return m({title:e.jsx(n,t({},i.inviteUnknownTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteUnknownDescription))}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})});if(g==="wrong_user")return te;if(g==="expired")return m({title:e.jsx(n,t({},i.inviteExpiredTitle)),content:e.jsx("div",{className:"text-token-text-secondary flex max-w-md flex-col gap-3 text-base",children:e.jsx("p",{children:e.jsx(n,h(t({},i.inviteExpiredDescription),{values:{email:b,workspaceName:e.jsx("span",{className:"text-token-text-primary font-semibold",children:N})}}))})}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})});if(g==="accepted")return m({title:e.jsx(n,t({},i.inviteAcceptedTitle)),content:e.jsx("div",{className:"text-token-text-secondary flex max-w-md flex-col gap-3 text-base",children:e.jsx("p",{children:e.jsx(n,h(t({},i.inviteAcceptedDescription),{values:{workspaceName:e.jsx("span",{className:"text-token-text-primary font-semibold",children:N})}}))})}),actions:e.jsx(p,{onClick:Ae,children:e.jsx(n,t({},i.inviteGoHomeCta))}),showActionError:!1});if(g==="not_found")return m({title:e.jsx(n,t({},i.inviteNotFoundTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteNotFoundDescription))}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))}),showActionError:!1});if(ye(j))return m({title:e.jsx(n,t({},i.inviteVerificationFailedTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteVerificationFailedDescription))}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})});if(j==="verified"||j==="linked")return m({title:e.jsx(n,t({},i.inviteVerifiedTitle)),content:e.jsxs("div",{className:"text-token-text-secondary flex max-w-md flex-col gap-3 text-base",children:[e.jsx("p",{children:e.jsx(n,h(t({},i.inviteVerifiedDescription),{values:{workspaceName:e.jsx("span",{className:"text-token-text-primary font-semibold",children:N})}}))}),f?null:e.jsx("p",{className:"text-token-text-tertiary text-sm",children:e.jsx(n,t({},i.inviteMissingWorkspace))})]}),actions:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(p,{onClick:Ne,loading:z,disabled:!f||!x||z,children:e.jsx(n,t({},i.acceptInviteCta))}),e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})]})});if(g!=="pending"&&g!=="requested")return m({title:e.jsx(n,t({},i.inviteUnknownTitle)),content:e.jsx("p",{className:"text-token-text-secondary max-w-md text-base",children:e.jsx(n,t({},i.inviteUnknownDescription))}),actions:e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})});const Te=e.jsxs("div",{className:"text-token-text-secondary flex max-w-md flex-col gap-3 text-base",children:[e.jsx("p",{className:"text-center",children:e.jsx(n,h(t({},i.inviteDescription),{values:{workspaceName:e.jsx("span",{className:"text-token-text-primary font-semibold",children:N})}}))}),e.jsx("p",{children:e.jsx(n,t({},i.invitePendingDescription))}),f?null:e.jsx("p",{className:"text-token-text-tertiary text-sm",children:e.jsx(n,t({},i.inviteMissingWorkspace))})]});return m({title:e.jsx(n,h(t({},i.inviteGreeting),{values:{email:b}})),content:Te,actions:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(p,{onClick:be,loading:Ce,children:e.jsx(n,t({},i.startVerificationCta))}),e.jsx(p,{color:"secondary",onClick:I,loading:s.isFetching,children:e.jsx(n,t({},i.refreshStatusCta))})]})})};function nt(a,r){const c=new URL("https://services.sheerid.com/verify/68d47554aa292d20b9bec8f7/");return c.searchParams.set("verificationId",a),c.searchParams.set("redirectUrl",r),c.toString()}function ye(a){return a==="error"}const lt=Be(function(){return e.jsx(it,{})});export{lt as default};
//# sourceMappingURL=brtqkfh6s3jnol3d.js.map

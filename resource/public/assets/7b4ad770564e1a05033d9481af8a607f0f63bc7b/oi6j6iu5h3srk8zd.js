var _=Object.defineProperty;var h=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var m=(t,a,e)=>a in t?_(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,f=(t,a)=>{for(var e in a||(a={}))p.call(a,e)&&m(t,e,a[e]);if(h)for(var e of h(a))v.call(a,e)&&m(t,e,a[e]);return t};import{j as c,h as b,r as y,i as x}from"./kfrdmkli83ureki3.js";import{bP as S,n as w,bT as T}from"./fyw02vlaiv2vq6cj.js";import{u as C,kS as j,_ as d,aC as E,db as M,br as P}from"./kw08ajijqinojrwh.js";function k(t){"use no forget";const a=C(),e=t.onClose,s=S(a),r=b(),i=j(a),o=B({calpicoState:s,intl:r,onClose:e,props:t,toaster:i}),n=o.isPending,l=()=>{o.isPending||o.mutate()},g=y.useRef(!1),u=t.type==="from-conversation"?t.serverThreadId:void 0;return y.useEffect(()=>{g.current||(g.current=!0,d.logEventWithStatsig("Calpico - create chat - modal shown","chatgpt_web_calpico_create_chat_modal_shown",{type:t.type,source:t.source,conversation_id:u}))},[t.type,u,t.source]),c.jsx(E,{testId:"modal-start-group-chat",isOpen:!0,onClose:()=>e(),type:"success",title:t.type==="from-conversation"?r.formatMessage({id:"0xSPqM",defaultMessage:"Start group chat from this conversation"}):r.formatMessage({id:"Ue2MBg",defaultMessage:"Use ChatGPT together"}),primaryButton:c.jsx(M.Button,{title:r.formatMessage({id:"agv82V",defaultMessage:"Start group chat"}),color:"primary",disabled:n,onClick:()=>{l()},"data-testid":"start-group-chat-confirm-button"}),secondaryButton:c.jsx(M.Button,{title:r.formatMessage({id:"W6b5j+",defaultMessage:"Cancel"}),color:"secondary",disabled:n,onClick:()=>{d.logEventWithStatsig("Calpico - create chat - canceled","chatgpt_web_calpico_create_chat_canceled",{type:t.type,source:t.source,conversation_id:u}),e()},"data-testid":"start-group-chat-cancel-button"}),children:c.jsx("p",{className:"text-token-text-secondary text-sm",children:t.type==="from-conversation"?r.formatMessage({id:"n10x8B",defaultMessage:"Only this conversation will be shared. Your personal ChatGPT memory is always private."}):r.formatMessage({id:"agcfjk",defaultMessage:"Add people to your chats to plan, share ideas, and get creative."})})})}function B({calpicoState:t,intl:a,onClose:e,props:s,toaster:r}){"use no forget";const i=C();return x({mutationKey:["calpico","start-group-chat",s.type],mutationFn:async()=>{let o;if(s.type==="from-conversation"){const{serverThreadId:n}=s;o=(await t.shareThreadToCalpico$(n)).id}else o=(await t.createRoom$({room_type:"GROUP_DM",with_account_user_ids:[]})).id;return d.logEventWithStatsig("Calpico - create chat - chat created","chatgpt_web_calpico_create_chat_chat_created",{type:s.type,source:s.source,conversation_id:s.type==="from-conversation"?s.serverThreadId:void 0}),o},onSuccess:o=>{t.fetchMessages$({roomId:o}),e(),w("/gg/".concat(o)),setTimeout(()=>{const n=t.rooms$().get(o);n!=null&&P(i,T,{room:n})})},onError:()=>{r.danger(a.formatMessage({id:"OJyo7m",defaultMessage:"Unable to create a group chat"}))}})}const O=t=>{"use no forget";return c.jsx(k,f({},t))};export{O as CalpicoStartChatModalContainer};
//# sourceMappingURL=oi6j6iu5h3srk8zd.js.map

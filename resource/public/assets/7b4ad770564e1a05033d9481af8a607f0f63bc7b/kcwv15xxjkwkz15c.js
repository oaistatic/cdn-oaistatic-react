var ur=Object.defineProperty,mr=Object.defineProperties;var hr=Object.getOwnPropertyDescriptors;var Zs=Object.getOwnPropertySymbols;var pr=Object.prototype.hasOwnProperty,gr=Object.prototype.propertyIsEnumerable;var qs=(t,e,n)=>e in t?ur(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,js=(t,e)=>{for(var n in e||(e={}))pr.call(e,n)&&qs(t,n,e[n]);if(Zs)for(var n of Zs(e))gr.call(e,n)&&qs(t,n,e[n]);return t},Js=(t,e)=>mr(t,hr(e));import{C as qt,A as Fe,a as me,b as Zt,F as Qs,E as xs}from"./gz2kraed79kezjd0.js";import{b as br,a as dr,r as vt,c as yr,g as tr,e as we}from"./ywxlziofi4jg74sa.js";const Mr=80,Tr=15,at=40,lt=20;function $r(t){return t==null||t===0?Mr:Math.round(t*7)}function Br(t){const e=t==null||t===0?Tr:t;return Math.round(e*96/72)}function ee(t){let e="";for(t+=1;t;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-n)/26)}return e}function et(t){const e=t.match(/[A-Z]+/);if(!e)return 0;let n=0;for(const s of e[0])n=n*26+(s.charCodeAt(0)-64);return n-1}function ft(t){const e=t.match(/\d+/);return e?parseInt(e[0],10)-1:0}function er(t){const e=t.replace(/^0x/i,"");if(e.length===8){const s=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16),h=parseInt(e.slice(6,8),16);return"rgba(".concat(s,", ").concat(l,", ").concat(h,", ").concat(1 .toFixed(3),")")}return e.length===6?"#".concat(e):"#ffffff"}function Re(t){return t==null?void 0:t===64?"#000000":["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"][t]}const nr=dr.get_table();function Cr(t){const e=t.replace(/^#/,"");if(e.length!==6)return null;const n=parseInt(e.slice(0,2),16),s=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return{r:n,g:s,b:l}}function Sr(t,e,n){t/=255,e/=255,n/=255;const s=Math.max(t,e,n),l=Math.min(t,e,n);let h=0,M=0;const S=(s+l)/2;if(s!==l){const N=s-l;switch(M=S>.5?N/(2-s-l):N/(s+l),s){case t:h=(e-n)/N+(e<n?6:0);break;case e:h=(n-t)/N+2;break;case n:h=(t-e)/N+4;break}h/=6}return{h,s:M,l:S}}function Fr(t,e,n){let s,l,h;if(e===0)s=l=h=n;else{const M=(V,v,b)=>(b<0&&(b+=1),b>1&&(b-=1),b<.16666666666666666?V+(v-V)*6*b:b<.5?v:b<.6666666666666666?V+(v-V)*(.6666666666666666-b)*6:V),S=n<.5?n*(1+e):n+e-n*e,N=2*n-S;s=M(N,S,t+1/3),l=M(N,S,t),h=M(N,S,t-1/3)}return{r:Math.round(s*255),g:Math.round(l*255),b:Math.round(h*255)}}function Er(t,e){const n=Cr(t);if(!n)return t;const{h:s,s:l,l:h}=Sr(n.r,n.g,n.b),M=e/1e5,S=M>=0?h+(1-h)*M:h*(1+M),{r:N,g:V,b:v}=Fr(s,l,Math.max(0,Math.min(1,S))),b=Mt=>Mt.toString(16).padStart(2,"0");return"#".concat(b(N)).concat(b(V)).concat(b(v))}function or(t,e,n,s,l){var h,M,S,N,V,v,b,Mt,Et,At,wt,pt,k,Rt,_t,kt;if(!(!t||!e)){if(t.numFmtId!=null){n.numberFormatId=t.numFmtId;const d=(h=e.numberFormats)==null?void 0:h.find(D=>D.id===t.numFmtId);d!=null&&d.formatCode?n.numberFormatCode=d.formatCode:nr[t.numFmtId]&&(n.numberFormatCode=nr[t.numFmtId])}if(t.fillId!=null&&(!s||t.applyFill||t.applyFill===void 0)){const d=(M=e.fills)==null?void 0:M[t.fillId];if(d!=null&&d.color){const D=vt(d.color,l);D&&(n.fill=D)}else{const D=(d==null?void 0:d.fgColor)||(d==null?void 0:d.bgColor);D&&(n.fill=er(D))}}if(t.fontId!=null&&((S=!s||t.applyFont)==null||S)){const d=e.fonts[t.fontId],D=(N=n.font)!=null?N:n.font={};if(typeof(d==null?void 0:d.fontSize)=="number"){const P=d.fontSize*1.3333333333333333;D.size=P}D.bold=(V=d==null?void 0:d.bold)!=null?V:D.bold,D.italic=(v=d==null?void 0:d.italic)!=null?v:D.italic,D.family=d!=null&&d.name?d.name:D.family;const m=(Mt=(b=d==null?void 0:d.fill)==null?void 0:b.color)!=null?Mt:d==null?void 0:d.color;if(m){let P;if(m.type===qt.COLOR_TYPE_SYSTEM&&typeof m.value=="string"){if(m.value==="auto")P="#000000";else if(m.value.startsWith("indexed:")){const $t=parseInt((Et=m.value.split(":")[1])!=null?Et:"",10);Number.isNaN($t)||(P=Re($t))}}P||(P=vt(m,l)),P&&(D.color=P,n.textColor=P)}}if(t.horizontalAlignment&&(!s||t.applyAlignment||t.applyAlignment===void 0))switch(t.horizontalAlignment){case"left":case"center":case"right":n.align=t.horizontalAlignment;break}if(t.verticalAlignment&&(!s||t.applyAlignment||t.applyAlignment===void 0))switch(String(t.verticalAlignment).toLowerCase()){case"top":n.verticalAlign=Fe.ANCHOR_TYPE_TOP;break;case"center":n.verticalAlign=Fe.ANCHOR_TYPE_MIDDLE;break;case"bottom":n.verticalAlign=Fe.ANCHOR_TYPE_BOTTOM;break}if(t.borderId!=null&&(!s||t.applyBorder||t.applyBorder===void 0)){const d=e.borders[t.borderId];if(d){(At=n.borders)!=null||(n.borders={}),(wt=n.borderStyles)!=null||(n.borderStyles={});const D=(m,P)=>{var Gt,Qt;if(m){const zt=m.type===qt.COLOR_TYPE_SYSTEM,gt=m.value;if(m.type===qt.COLOR_TYPE_SCHEME&&typeof gt=="string"&&gt.startsWith("theme:")){const dt=parseInt((Gt=gt.split(":")[1])!=null?Gt:"",10);if(!Number.isNaN(dt)){const Tt=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"][dt];if(Tt){const Lt=l.colorMap[Tt];if(Lt)return(Qt=m.transform)!=null&&Qt.tint?Er(Lt,m.transform.tint):Lt}else{const Lt=vt(m,l);if(Lt)return Lt}}}if(m.type===qt.COLOR_TYPE_RGB&&typeof gt=="string"){const dt=gt.replace(/^#/i,"");if(dt.length===8)return er(dt);if(dt.length===6)return"#".concat(dt)}if(zt&&(gt!=null&&gt.startsWith("indexed:")||gt==="auto")){const dt=Re(P);if(dt)return dt}return vt(m,l)}return Re(P)};if((pt=d.left)!=null&&pt.style){let m=D(d.left.color,d.left.indexedColorId);m||(m="#000000"),m&&(n.borders.left=m),n.borderStyles.left=d.left.style}if((k=d.right)!=null&&k.style){let m=D(d.right.color,d.right.indexedColorId);m||(m="#000000"),m&&(n.borders.right=m),n.borderStyles.right=d.right.style}if((Rt=d.top)!=null&&Rt.style){let m=D(d.top.color,d.top.indexedColorId);m||(m="#000000"),m&&(n.borders.top=m),n.borderStyles.top=d.top.style}if((_t=d.bottom)!=null&&_t.style){let m=D(d.bottom.color,d.bottom.indexedColorId);m||(m="#000000"),m&&(n.borders.bottom=m),n.borderStyles.bottom=d.bottom.style}if((kt=d.diagonal)!=null&&kt.style){let m=D(d.diagonal.color,d.diagonal.indexedColorId);m||(m="#000000"),m&&(n.borders.diagonal=m),n.borderStyles.diagonal=d.diagonal.style}d.diagonalUp!=null&&(n.borderDiagonalUp=!!d.diagonalUp),d.diagonalDown!=null&&(n.borderDiagonalDown=!!d.diagonalDown)}}}}function Wr(t){const{styles:e}=t,n=br(t.theme),s={};return e&&e.cellXfs.forEach((l,h)=>{var S;const M={};if(l.xfId!=null&&e.cellStyleXfs&&e.cellStyleXfs[l.xfId]){const N=(S=e.cellStyleXfs[l.xfId])==null?void 0:S.format;or(N,e,M,!1,n)}or(l,e,M,!0,n),s[h]=M}),s}const pe=t=>t/9525;function Ar(t,e,n,s,l,h,M,S,N,V,v){if(!(!e.drawings||e.drawings.length===0))for(const b of e.drawings){if(!b.chart||!b.fromAnchor||!b.toAnchor)continue;const Mt=Number(b.fromAnchor.colId),Et=Number(b.fromAnchor.rowId),At=Number(b.toAnchor.colId),wt=Number(b.toAnchor.rowId)-1,pt=s[Mt],k=l[Et],Rt=s[At],_t=l[wt];if(pt===void 0||k===void 0||Rt===void 0||_t===void 0)continue;const kt=at+pt+pe(Number(b.fromAnchor.colOffset))-h,d=lt+k+pe(Number(b.fromAnchor.rowOffset))-M,D=at+Rt+pe(Number(b.toAnchor.colOffset))-h,m=lt+_t+pe(Number(b.toAnchor.rowOffset))-M;if(D<0||m<0||kt>S||d>N)continue;const P={x:kt,y:d,width:D-kt,height:m-d};yr(t,b.chart,P,{themeMap:V,excelDefaults:!0})}}function sr(t,e,n){var S,N,V,v;if(t.value===""||t.value==null)return"";const s=(N=e[(S=t.styleIndex)!=null?S:0])!=null?N:{},l=n?"".concat(t.value,"||").concat((V=s.numberFormatCode)!=null?V:""):void 0;if(l&&(n!=null&&n.has(l)))return(v=n.get(l))!=null?v:"";let h=t.value;const M=t.dataType===me.CELL_DATA_TYPE_STRING||t.dataType===me.CELL_DATA_TYPE_SHARED_STRING||t.dataType===me.CELL_DATA_TYPE_INLINE_STRING;if(s.numberFormatCode&&!M){const b=Number(t.value);if(!Number.isNaN(b))try{h=dr.format(s.numberFormatCode,b)}catch(Mt){h=t.value}}return l&&(n==null||n.set(l,h)),h}function re(t,e,n){switch(t.save(),n&&(t.strokeStyle=n),t.lineWidth=1,t.setLineDash([]),e){case"thin":t.lineWidth=1;break;case"medium":t.lineWidth=2;break;case"thick":t.lineWidth=3;break;case"dashed":case"mediumDashed":t.lineWidth=e==="mediumDashed"?2:1,t.setLineDash([6,3]);break;case"dashDot":t.setLineDash([6,3,1,3]);break;case"dashDotDot":t.setLineDash([6,3,1,3,1,3]);break;case"slantDashDot":t.setLineDash([]);break;case"double":break;default:t.lineWidth=1;break}}function ge(t,e,n,s,l,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=1;const S=2;e==="top"?(t.beginPath(),t.moveTo(s,l),t.lineTo(s+h,l),t.stroke(),t.beginPath(),t.moveTo(s,l+S),t.lineTo(s+h,l+S),t.stroke()):e==="bottom"?(t.beginPath(),t.moveTo(s,l+M),t.lineTo(s+h,l+M),t.stroke(),t.beginPath(),t.moveTo(s,l+M-S),t.lineTo(s+h,l+M-S),t.stroke()):e==="left"?(t.beginPath(),t.moveTo(s,l),t.lineTo(s,l+M),t.stroke(),t.beginPath(),t.moveTo(s+S,l),t.lineTo(s+S,l+M),t.stroke()):e==="right"&&(t.beginPath(),t.moveTo(s+h,l),t.lineTo(s+h,l+M),t.stroke(),t.beginPath(),t.moveTo(s+h-S,l),t.lineTo(s+h-S,l+M),t.stroke()),t.restore()}function be(t,e,n,s,l,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=2,t.beginPath(),e==="top"?(t.moveTo(s,l),t.lineTo(s+h,l)):e==="bottom"?(t.moveTo(s,l+M),t.lineTo(s+h,l+M)):e==="left"?(t.moveTo(s,l),t.lineTo(s,l+M)):e==="right"&&(t.moveTo(s+h,l),t.lineTo(s+h,l+M)),t.stroke(),t.save(),t.globalAlpha=.5,t.strokeStyle="#ffffff",t.lineWidth=1;const S=8,N=6;if(e==="left"||e==="right"){const V=e==="right"?s+h:s,v=e==="right"?-N:N;for(let b=l;b<=l+M;b+=S)t.beginPath(),t.moveTo(V+v,b),t.lineTo(V,b+N),t.stroke()}else{const V=e==="bottom"?l+M:l,v=e==="bottom"?-N:N;for(let b=s;b<=s+h;b+=S)t.beginPath(),t.moveTo(b,V+v),t.lineTo(b+N,V),t.stroke()}t.restore(),t.restore()}const Nr=t=>{if(!t)return;let e=t.replace(/\s*\(Body\)\s*$/i,"");return e=e.replace(/\s+Regular$/i,""),e=e.replace(/\s+Bold$/i,""),e=e.replace(/\s+Italic$/i,""),e.trim()};function vr(t){const e=t.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\)$/i);if(!e)return null;const[,n,s,l]=e;return!n||!s||!l?null:[parseInt(n,10),parseInt(s,10),parseInt(l,10)]}const ye=t=>t/9525,Me=new Map,Te=new Map;function wr(t){const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}function rr(t,e){if(!e)return null;const n=t.images;if(!n||n.length===0)return null;const s=n.find(h=>h.id===e);if(!s)return null;const l=typeof s.data=="string"?wr(s.data):s.data;return{id:s.id,contentType:s.contentType,data:l}}function Rr(t,e,n,s,l,h,M,S,N){var v,b,Mt,Et,At,wt,pt,k,Rt,_t;const V=(v=e.drawings)!=null?v:[];if(V.length!==0)for(const kt of V){const d=(b=kt.imageReference)==null?void 0:b.id;if(!d)continue;const D=kt.fromAnchor;if(!D)continue;const m=kt.toAnchor,P=Number(D.colId),$t=Number(D.rowId),Gt=s[P],Qt=l[$t];if(typeof Gt>"u"||typeof Qt>"u")continue;const zt=at+Gt+ye(Number((Mt=D.colOffset)!=null?Mt:0))-h,gt=lt+Qt+ye(Number((Et=D.rowOffset)!=null?Et:0))-M;let dt=0,Nt=0;if(m){const Pt=Number(m.colId),Ut=Number(m.rowId)-1,Bt=s[Pt],Vt=l[Ut];if(typeof Bt>"u"||typeof Vt>"u")continue;const Ct=at+Bt+ye(Number((At=m.colOffset)!=null?At:0))-h,St=lt+Vt+ye(Number((wt=m.rowOffset)!=null?wt:0))-M;dt=Ct-zt,Nt=St-gt}else{const Pt=(pt=s[P])!=null?pt:0,Ut=(k=s[P+1])!=null?k:Pt,Bt=(Rt=l[$t-1])!=null?Rt:0,Vt=(_t=l[$t])!=null?_t:Bt,Ct=Math.max(0,Ut-Pt),St=Math.max(0,Vt-Bt),jt=rr(n,d);if(!jt)continue;const Xt=Me.get(jt.id);if(!Xt){if(!Te.has(jt.id)){const se=tr(jt).then(ae=>(Me.set(jt.id,ae),ae));Te.set(jt.id,se)}continue}const w=Xt.width,R=Xt.height;if(w<=0||R<=0||Ct<=0||St<=0)continue;const Jt=Math.min(Ct/w,St/R);dt=Math.max(0,Math.floor(w*Jt)),Nt=Math.max(0,Math.floor(R*Jt));const xt=(Ct-dt)/2,oe=(St-Nt)/2;t.drawImage(Xt,0,0,w,R,zt+xt,gt+oe,dt,Nt);continue}if(zt+dt<0||gt+Nt<0||zt>S||gt>N)continue;const Tt=rr(n,d);if(!Tt)continue;const Lt=Me.get(Tt.id);if(Lt){t.drawImage(Lt,0,0,Lt.width,Lt.height,zt,gt,dt,Nt);continue}if(!Te.has(Tt.id)){const Pt=tr(Tt).then(Ut=>(Me.set(Tt.id,Ut),Ut));Te.set(Tt.id,Pt)}}}const de=10/12,ne="#4F81BD",ie={headerFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:0,shade:0,lumMod:1e5,lumOff:1180,satMod:0,alpha:1e5}},rowStripeFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},colStripeFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:8e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},firstLastColFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}}},Lr={type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},ir=new WeakMap;function Ce(t){let e=ir.get(t);return e||(e={rowCellByColIdx:new Map,rowNonEmptyCols:new Map,textMetrics:new Map},ir.set(t,e)),e}function ue(t,e){return t+":"+e}function Se(t,e){let n=0,s=t.length;for(;n<s;){const l=n+s>>>1,h=t[l];h!==void 0&&h<e?n=l+1:s=l}return n}function ar(t,e){let n=0,s=t.length;for(;n<s;){const l=n+s>>>1,h=t[l];h!==void 0&&h<=e?n=l+1:s=l}return n}const Ir=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function lr(t){var h;let e=0;t[e]==="$"&&e++;const n=e;for(;e<t.length&&/[A-Za-z]/.test((h=t[e])!=null?h:"");)e++;const s=t.slice(n,e);t[e]==="$"&&e++;const l=t.slice(e);return{col:et(s),row:parseInt(l,10)||0}}function _r(t){t=Math.max(1,t);let e="";for(;t>0;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-1)/26)}return e}function cr(t,e,n){var k;const s=t.startsWith("$"),l=s?1:0;let h=l;for(;h<t.length&&/[A-Za-z]/.test((k=t[h])!=null?k:"");)h++;const M=t.slice(l,h);let S=!1,N=h;t[N]==="$"&&(S=!0,N++);const V=t.slice(N),v=et(M),b=parseInt(V,10)||0,Mt=s?v:Math.max(1,v+e),Et=S?b:Math.max(1,b+n),At=_r(Mt),wt=(s?"$":"")+At,pt=(S?"$":"")+String(Et);return wt+pt}function fr(t,e,n){if(!t||!e||!n)return t;const{col:s,row:l}=lr(e),{col:h,row:M}=lr(n),S=h-s,N=M-l;return S===0&&N===0?t:t.replace(Ir,(V,v,b,Mt)=>{const Et=v?String(v):"",At=cr(String(b),S,N);if(!Mt)return"".concat(Et).concat(At);const wt=cr(String(Mt),S,N);return"".concat(Et).concat(At,":").concat(wt)})}function Pr(t){var n;const e=new Map;for(const s of(n=t.sharedFormulas)!=null?n:[])typeof s.si=="number"&&s.base&&s.anchor&&e.set(s.si,{base:s.base,anchor:s.anchor});return e}function Yr(t,e,n,s,l,h,M,S,N,V,v,b,Mt,Et,At,wt,pt,k,Rt,_t,kt,d){var Ie,_e,Pe,De,Oe,ke,$e,Be,We,Ye,He,Ge,ze,Ue,Ve,Xe,Ke,Ze,qe,je,Je,Qe,xe,tn,en,nn,on,sn,rn,an,ln,cn,fn,dn,un,mn,hn,pn,gn,bn,yn,Mn,Tn,Cn,Sn,Fn,En,An,Nn,vn,wn,Rn,Ln,In,_n,Pn,Dn,On,kn,$n,Bn,Wn,Yn,Hn,Gn,zn,Un,Vn,Xn,Kn,Zn,qn,jn,Jn,Qn,xn,to,eo,no,oo,so,ro,io,ao,lo,co,fo,uo,mo,ho,po,go,bo,yo,Mo,To,Co,So,Fo,Eo,Ao,No,vo,wo,Ro,Lo,Io,_o,Po,Do,Oo,ko,$o,Bo,Wo,Yo,Ho,Go,zo,Uo,Vo,Xo,Ko,Zo,qo,jo,Jo,Qo,xo,ts,es,ns,os,ss,rs,is,as,ls,cs,fs,ds,us,ms,hs,ps,gs,bs,ys,Ms,Ts,Cs,Ss,Fs,Es,As,Ns,vs,ws,Rs,Ls,Is,_s,Ps,Ds,Os,ks,$s,Bs,Ws,Ys,Hs,Gs,zs,Us,Vs;const D=v||1,m=l/D,P=h/D,$t=new Set,Gt=Pr(e);function Qt(o,a){var E,_,X,H,g;if(!(le.get(o)!=null))return(E=n[a])!=null?E:0;Ee(o);const y=(_=Ce(e).rowNonEmptyCols.get(o))!=null?_:[],c=ar(y,a);let i=(X=y[c])!=null?X:n.length;const u=(F,q)=>{var it;const rt=St(F,q);if(Tt(rt)==null)return!1;for(const $ of Bt)if(((it=$.ranges)!=null?it:[]).some(T=>T.sheetName&&T.sheetName!==e.name?!1:Nt(F,q,T)))return!0;return!1};for(let F=a+1;F<i;F++)if(u(o,F)){i=F;break}const p=(H=w[a])!=null?H:0,f=(g=w[i])!=null?g:p;return Math.max(0,f-p)}function zt(o,a){var E,_,X,H;if(a<0)return!1;Ee(o);const r=(E=Ce(e).rowNonEmptyCols.get(o))!=null?E:[],y=ar(r,a)-1;if(y<0)return!1;const c=(_=r[y])!=null?_:-1;if(c<0)return!1;const i=Ce(e).textMetrics.get(ue(o,c));if(!i||i.isNumeric)return!1;const u=Math.max(0,((X=w[a+1])!=null?X:0)-((H=w[c])!=null?H:0)),p=Math.max(0,u-(i.padLr+i.padLr));return i.firstLineW+.001>=p}function gt(o){var c,i,u,p,f;if(typeof o!="number")return null;const a=(c=pt.styles)==null?void 0:c.dxfs,r=a==null?void 0:a[o];if(!r)return null;const y=(f=(i=r==null?void 0:r.fill)==null?void 0:i.color)!=null?f:(p=(u=r==null?void 0:r.font)==null?void 0:u.fill)==null?void 0:p.color;return y?vt(y,k,"rgba(0,0,0,1)"):null}function dt(o){var c,i,u;if(typeof o!="number")return null;const a=(c=pt.styles)==null?void 0:c.dxfs,r=a==null?void 0:a[o],y=(u=(i=r==null?void 0:r.border)==null?void 0:i.bottom)==null?void 0:u.color;return y?vt(y,k,"#cccccc"):null}function Nt(o,a,r){const y=et(r.startAddress),c=ft(r.startAddress),i=et(r.endAddress),u=ft(r.endAddress),p=Math.min(c,u),f=Math.max(c,u),E=Math.min(y,i),_=Math.max(y,i);return o>=p&&o<=f&&a>=E&&a<=_}function Tt(o){if(!o)return null;const a=Number(o.value);return Number.isNaN(a)?null:a}function Lt(o,a,r){const y=Array.isArray(a)?a:void 0;if(r==null)return!1;const c=(y==null?void 0:y[0])!=null?Number(y[0]):NaN,i=(y==null?void 0:y[1])!=null?Number(y[1]):NaN;switch(o){case"greaterThan":return r>c;case"greaterThanOrEqual":return r>=c;case"lessThan":return r<c;case"lessThanOrEqual":return r<=c;case"equal":return r===c;case"notEqual":return r!==c;case"between":return r>=Math.min(c,i)&&r<=Math.max(c,i);case"notBetween":return!(r>=Math.min(c,i)&&r<=Math.max(c,i));default:return!1}}const Pt=(Ie=e.conditionalFormattings)!=null?Ie:[],Ut=[],Bt=[];for(const o of Pt)for(const a of(_e=o.rules)!=null?_e:[])if(a.type==="colorScale"&&a.colorScale){const r=[];for(const g of(Pe=o.ranges)!=null?Pe:[]){if(g.sheetName&&g.sheetName!==e.name)continue;const F=et(g.startAddress),q=ft(g.startAddress),rt=et(g.endAddress),st=ft(g.endAddress),it=Math.min(q,st),$=Math.max(q,st),G=Math.min(F,rt),T=Math.max(F,rt);for(let J=it;J<=$;J++){const Q=e.rows.find(I=>I.index-1===J);if(Q)for(let I=G;I<=T;I++){const nt=Q.cells.find(Wt=>et(Wt.address)===I),ut=Tt(nt);ut!=null&&r.push(ut)}}}const y=r.slice().sort((g,F)=>g-F),c=g=>{var G,T;if(y.length===0)return 0;const F=g/100*(y.length-1),q=Math.floor(F),rt=Math.min(y.length-1,Math.ceil(F)),st=F-q,it=(G=y[q])!=null?G:0,$=(T=y[rt])!=null?T:it;return it+($-it)*st},i=(De=a.colorScale.cfvos)!=null?De:[],u=(Oe=a.colorScale.colors)!=null?Oe:[],p=[],f=[];for(let g=0;g<i.length;g++){const F=i[g];if(!F)continue;let q=0;F.type==="min"?q=(ke=y[0])!=null?ke:0:F.type==="max"?q=($e=y[y.length-1])!=null?$e:0:F.type==="num"?q=Number((Be=F.val)!=null?Be:0):F.type==="percentile"?q=c(Number((We=F.val)!=null?We:0)):q=Number((Ye=F.val)!=null?Ye:0),f.push(q);const rt=u[g],st=rt?vt(rt,k,"rgba(0,0,0,1)"):"rgba(0,0,0,1)",it=(He=vr(st))!=null?He:[0,0,0];p.push({pos:0,rgb:it})}const E=Math.min(...f),_=Math.max(...f),X=g=>_===E?0:(g-E)/(_-E);for(let g=0;g<p.length;g++){const F=p[g];F&&(F.pos=X((Ge=f[g])!=null?Ge:0))}const H=(i!=null?i:[]).some(g=>g.type==="min"||g.type==="max");Ut.push({ranges:o.ranges,stops:p,vMin:E,vMax:_,priority:typeof a.priority=="number"?a.priority:9999,includeEndpoints:H})}for(const o of Pt)for(const a of(ze=o.rules)!=null?ze:[])if(a.type==="dataBar"){const r=[];for(const u of(Ue=o.ranges)!=null?Ue:[]){if(u.sheetName&&u.sheetName!==e.name)continue;const p=et(u.startAddress),f=ft(u.startAddress),E=et(u.endAddress),_=ft(u.endAddress),X=Math.min(f,_),H=Math.max(f,_),g=Math.min(p,E),F=Math.max(p,E);for(let q=X;q<=H;q++){const rt=e.rows.find(st=>st.index-1===q);if(rt)for(let st=g;st<=F;st++){const it=rt.cells.find(G=>et(G.address)===st),$=Tt(it);$!=null&&r.push($)}}}if(r.length===0)continue;const y=Math.min(...r),c=Math.max(...r),i=vt((Xe=(Ve=a.dataBar)==null?void 0:Ve.color)!=null?Xe:Lr,k,((Ke=k.colorMap)==null?void 0:Ke.accent1)||ne);Bt.push({ranges:o.ranges,vMin:y,vMax:c,colorCss:i,priority:typeof a.priority=="number"?a.priority:9999,showValue:!0})}t.save(),t.scale(v,v);const Vt=.5/(window.devicePixelRatio*v),Ct=Ce(e);function St(o,a){var r;return Ee(o),(r=Ct.rowCellByColIdx.get(o))==null?void 0:r.get(a)}const jt={thin:1,dashed:2,dashDot:2,dashDotDot:2,medium:3,mediumDashed:3,slantDashDot:3,thick:4,double:5},Xt=o=>{var a;return o&&(a=jt[o])!=null?a:0},w=[0];for(let o=0;o<n.length;o++)w[o+1]=((Ze=w[o])!=null?Ze:0)+((qe=n[o])!=null?qe:0);const R=[0];for(let o=0;o<s.length;o++)R[o+1]=((je=R[o])!=null?je:0)+((Je=s[o])!=null?Je:0);const Jt=Math.max(0,Se(w,m)-1),xt=Math.min(n.length-1,Se(w,m+M/v)+1),oe=Math.max(0,Se(R,P)-1),se=Math.min(s.length-1,Se(R,P+S/v)+1);t.clearRect(0,0,M/v,S/v),t.fillStyle="white",t.fillRect(0,0,M/v,S/v);const ae=new Map;for(const o of e.rows)ae.set(o.index-1,o);const le=new Map;if(_t&&_t.length>0){const o=s.length;for(let a=0;a<o;a++){const r=(Qe=_t[a])!=null?Qe:a,y=ae.get(r);y&&le.set(a,y)}}else for(const o of e.rows)le.set(o.index-1,o);function Ee(o){var c;if(Ct.rowCellByColIdx.has(o)&&Ct.rowNonEmptyCols.has(o))return;const a=le.get(o);if(!a){Ct.rowCellByColIdx.set(o,new Map),Ct.rowNonEmptyCols.set(o,[]);return}const r=new Map,y=[];for(const i of a.cells){const u=et(i.address);r.set(u,i);const p=i.value!=null&&String(i.value)!=="",f=!!((c=i.paragraphs)!=null&&c.some(E=>{var _;return(_=E.runs)==null?void 0:_.some(X=>{var H;return((H=X.text)!=null?H:"").length>0})}));(p||f||i.formula||typeof i.sharedFormulaSi=="number")&&y.push(u)}y.sort((i,u)=>i-u),Ct.rowCellByColIdx.set(o,r),Ct.rowNonEmptyCols.set(o,y)}const Ae=[];for(const o of(xe=e.columns)!=null?xe:[]){const a=o,r=typeof(a==null?void 0:a.styleIndex)=="number"?a.styleIndex:void 0;if(typeof r=="number"){const y=Math.max(0,((tn=o.min)!=null?tn:1)-1),c=Math.max(y,((nn=(en=o.max)!=null?en:o.min)!=null?nn:1)-1);for(let i=y;i<=c;i++)Ae[i]==null&&(Ae[i]=r)}}const Ne=new Set,ve=new Set;if(((sn=(on=e.pivotTables)==null?void 0:on.length)!=null?sn:0)>0)for(const o of(rn=e.pivotTables)!=null?rn:[]){const a=o.location,r=(an=a==null?void 0:a.reference)!=null?an:"";if(!r)continue;const[y,c]=r.split(":"),i=et(y||"A1"),u=ft(y||"A1"),p=c?et(c):i,f=c?ft(c):u,E=Math.max(Math.min(i,p),Jt),_=Math.min(Math.max(i,p),xt),X=Math.max(Math.min(u,f),oe),H=Math.min(Math.max(u,f),se);if(E>_||X>H)continue;const g=typeof(a==null?void 0:a.firstHeaderRow)=="number"&&a.firstHeaderRow>0?a.firstHeaderRow-1:u,F=typeof(a==null?void 0:a.firstDataRow)=="number"&&a.firstDataRow>0?a.firstDataRow-1:Math.min(f,g+1),q=typeof(a==null?void 0:a.firstHeaderColumn)=="number"&&a.firstHeaderColumn>0?a.firstHeaderColumn-1:i,rt=typeof(a==null?void 0:a.firstDataColumn)=="number"&&a.firstDataColumn>0?a.firstDataColumn-1:Math.min(p,q+1),st=vt(ie.headerFill,k,((ln=k.colorMap)==null?void 0:ln.accent1)||ne),it=vt(ie.firstLastColFill,k,((cn=k.colorMap)==null?void 0:cn.accent1)||ne);if(F>=X){const $=X,G=Math.min(H,F-1);if(G>=$){const T=at+((fn=w[E])!=null?fn:0)-m,J=lt+((dn=R[$])!=null?dn:0)-P,Q=((un=w[_+1])!=null?un:0)-((mn=w[E])!=null?mn:0),I=((hn=R[G+1])!=null?hn:0)-((pn=R[$])!=null?pn:0);t.fillStyle=st,t.fillRect(T,J,Q,I);for(let nt=$;nt<=G;nt++)for(let ut=E;ut<=_;ut++)Ne.add("".concat(ee(ut)).concat(nt+1))}}if(rt>=E){const $=E,G=Math.min(_,rt-1);if(G>=$){const T=at+((gn=w[$])!=null?gn:0)-m,J=lt+((bn=R[X])!=null?bn:0)-P,Q=((yn=w[G+1])!=null?yn:0)-((Mn=w[$])!=null?Mn:0),I=((Tn=R[H+1])!=null?Tn:0)-((Cn=R[X])!=null?Cn:0);t.fillStyle=st,t.fillRect(T,J,Q,I);for(let nt=X;nt<=H;nt++)for(let ut=$;ut<=G;ut++)Ne.add("".concat(ee(ut)).concat(nt+1))}}if(o.rowGrandTotals){const $=H,G=at+((Sn=w[E])!=null?Sn:0)-m,T=lt+((Fn=R[$])!=null?Fn:0)-P,J=((En=w[_+1])!=null?En:0)-((An=w[E])!=null?An:0),Q=(Nn=s[$])!=null?Nn:0;t.fillStyle=it,t.fillRect(G,T,J,Q);for(let I=E;I<=_;I++)ve.add("".concat(ee(I)).concat($+1))}if(o.columnGrandTotals){const $=_,G=at+((vn=w[$])!=null?vn:0)-m,T=lt+((wn=R[X])!=null?wn:0)-P,J=(Rn=n[$])!=null?Rn:0,Q=((Ln=R[H+1])!=null?Ln:0)-((In=R[X])!=null?In:0);t.fillStyle=it,t.fillRect(G,T,J,Q);for(let I=X;I<=H;I++)ve.add("".concat(ee($)).concat(I+1))}}const ce=(_n=e.tables)!=null?_n:[],Le=new Set;if(ce.length>0)for(const o of ce){if(!o.ref)continue;const[a,r]=o.ref.split(":");if(!a)continue;const y=et(a),c=ft(a),i=r?et(r):y,u=r?ft(r):c,p=Math.max(Math.min(y,i),Jt),f=Math.min(Math.max(y,i),xt),E=Math.max(Math.min(c,u),oe),_=Math.min(Math.max(c,u),se);if(p>f||E>_)continue;const X=Math.max(0,Math.min(1,(Pn=o.headerRowCount)!=null?Pn:1)),H=Math.max(0,Math.min(1,(Dn=o.totalsRowCount)!=null?Dn:o.totalsRowShown?1:0)),g=Math.min(_,Math.max(E,Math.min(c,u)+X)),F=Math.max(E,Math.min(_,Math.max(c,u)-H)),q=vt(ie.headerFill,k,((On=k.colorMap)==null?void 0:On.accent1)||ne),rt=vt(ie.rowStripeFill,k,((kn=k.colorMap)==null?void 0:kn.accent1)||ne),st=vt(ie.colStripeFill,k,(($n=k.colorMap)==null?void 0:$n.accent1)||ne),it=vt(ie.firstLastColFill,k,((Bn=k.colorMap)==null?void 0:Bn.accent1)||ne);if(X>0){const T=Math.min(_,Math.min(c,u));if(T>=E&&T<=_){const J=at+((Wn=w[p])!=null?Wn:0)-m,Q=lt+((Yn=R[T])!=null?Yn:0)-P,I=((Hn=w[f+1])!=null?Hn:0)-((Gn=w[p])!=null?Gn:0),nt=(zn=s[T])!=null?zn:0,ut=o==null?void 0:o.dataDxfId,Wt=(Un=gt(ut))!=null?Un:q;t.fillStyle=Wt,t.fillRect(J,Q,I,nt);for(let te=p;te<=f;te++)Le.add("".concat(ee(te)).concat(T+1))}}if((Vn=o.style)!=null&&Vn.showRowStripes&&g<=F){for(let T=g;T<=F;T++)if((T-g)%2===1){const Q=at+((Xn=w[p])!=null?Xn:0)-m,I=lt+((Kn=R[T])!=null?Kn:0)-P,nt=((Zn=w[f+1])!=null?Zn:0)-((qn=w[p])!=null?qn:0),ut=(jn=s[T])!=null?jn:0;t.fillStyle=rt,t.fillRect(Q,I,nt,ut)}}if((Jn=o.style)!=null&&Jn.showColumnStripes&&g<=F){for(let T=p;T<=f;T++)if((T-Math.min(y,i))%2===1){const Q=at+((Qn=w[T])!=null?Qn:0)-m,I=lt+((xn=R[g])!=null?xn:0)-P,nt=(to=n[T])!=null?to:0,ut=((eo=R[F+1])!=null?eo:0)-((no=R[g])!=null?no:0);t.fillStyle=st,t.fillRect(Q,I,nt,ut)}}const $=!!((oo=o.style)!=null&&oo.showFirstColumn),G=!!((so=o.style)!=null&&so.showLastColumn);if(g<=F&&($||G)){if($){const T=Math.min(y,i);if(T>=p&&T<=f){const J=at+((ro=w[T])!=null?ro:0)-m,Q=lt+((io=R[g])!=null?io:0)-P,I=(ao=n[T])!=null?ao:0,nt=((lo=R[F+1])!=null?lo:0)-((co=R[g])!=null?co:0);t.fillStyle=it,t.fillRect(J,Q,I,nt)}}if(G){const T=Math.max(y,i);if(T>=p&&T<=f){const J=at+((fo=w[T])!=null?fo:0)-m,Q=lt+((uo=R[g])!=null?uo:0)-P,I=(mo=n[T])!=null?mo:0,nt=((ho=R[F+1])!=null?ho:0)-((po=R[g])!=null?po:0);t.fillStyle=it,t.fillRect(J,Q,I,nt)}}}}for(let o=oe;o<=se;o++){const a=le.get(o),r=lt+((go=R[o])!=null?go:0)-P,y=[];for(let c=Jt;c<=xt;c++){const i=at+((bo=w[c])!=null?bo:0)-m;let u=(yo=n[c])!=null?yo:0,p=(Mo=s[o])!=null?Mo:0;const f=St(o,c),E="".concat(ee(c)).concat(o+1),_=a==null?void 0:a.styleIndex,X=Ae[c],H=(So=(Co=(To=f==null?void 0:f.styleIndex)!=null?To:_)!=null?Co:X)!=null?So:0,g=(Fo=b[H])!=null?Fo:{},F=(Eo=g.borders)==null?void 0:Eo.diagonal,q=!!g.borderDiagonalUp,rt=!!g.borderDiagonalDown,st=(Ao=g.borderStyles)==null?void 0:Ao.diagonal;if(f){const C=(()=>{if(Rt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const A=Gt.get(f.sharedFormulaSi);if(A)return"= ".concat(fr(A.base,A.anchor,f.address))}}return sr(f,b)})(),L=(()=>{if(Rt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Gt.has(f.sharedFormulaSi)))return!1;const A=Number(f.value);return f.dataType!==me.CELL_DATA_TYPE_STRING&&!Number.isNaN(A)})(),z=((vo=(No=g.font)==null?void 0:No.size)!=null?vo:11*(96/72))*de,ct=Math.max(2,Math.round((z||11)*.35)),O=Math.max(1,Math.round((z||11)*.25));if(L)Ct.textMetrics.set(ue(o,c),{firstLineW:0,padLr:ct,padTb:O,isNumeric:L});else{const mt={paragraphs:f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:C,citations:[]}]}],textStyle:{alignment:Zt.ALIGNMENT_TYPE_LEFT},bbox:{xEmu:0,yEmu:0,widthEmu:Math.round(1e6*9525),heightEmu:Math.round(p*9525)},type:xs.ELEMENT_TYPE_TEXT,levelsStyles:[]},ot=we(mt,t,k,void 0,{resolvedStyle:{alignment:Zt.ALIGNMENT_TYPE_LEFT},bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:de,wrap:!1}),j=(Lo=(Ro=(wo=ot==null?void 0:ot.lines)==null?void 0:wo[0])==null?void 0:Ro.widthPx)!=null?Lo:0;Ct.textMetrics.set(ue(o,c),{firstLineW:j,padLr:ct,padTb:O,isNumeric:L})}}const it=(Io=e.mergedCells)!=null?Io:[];let $=!1,G=o,T=o,J=c,Q=c,I=(_o=g.borders)!=null?_o:null,nt=(Po=g.borderStyles)!=null?Po:null;{const C=it.find(L=>Nt(o,c,L));if(C){const L=et(C.startAddress),x=ft(C.startAddress),z=et(C.endAddress),ct=ft(C.endAddress);if(G=Math.min(x,ct),T=Math.max(x,ct),J=Math.min(L,z),Q=Math.max(L,z),$=o===G&&c===J,!$)continue;u=((Do=w[Q+1])!=null?Do:0)-((Oo=w[J])!=null?Oo:0),p=((ko=R[T+1])!=null?ko:0)-(($o=R[G])!=null?$o:0);let O=0,A=0,mt=0,ot=0;const j={},tt={};for(let B=J;B<=Q;B++){const K=St(G,B),ht=(Wo=b[(Bo=K==null?void 0:K.styleIndex)!=null?Bo:0])!=null?Wo:{},W=(Yo=ht.borderStyles)==null?void 0:Yo.top,Z=Xt(W);(Ho=ht.borders)!=null&&Ho.top&&Z>=O&&(j.top=ht.borders.top,tt.top=W,O=Z)}for(let B=J;B<=Q;B++){const K=St(T,B),ht=(zo=b[(Go=K==null?void 0:K.styleIndex)!=null?Go:0])!=null?zo:{},W=(Uo=ht.borderStyles)==null?void 0:Uo.bottom,Z=Xt(W);(Vo=ht.borders)!=null&&Vo.bottom&&Z>=A&&(j.bottom=ht.borders.bottom,tt.bottom=W,A=Z)}for(let B=G;B<=T;B++){const K=St(B,J),ht=(Ko=b[(Xo=K==null?void 0:K.styleIndex)!=null?Xo:0])!=null?Ko:{},W=(Zo=ht.borderStyles)==null?void 0:Zo.left,Z=Xt(W);(qo=ht.borders)!=null&&qo.left&&Z>=mt&&(j.left=ht.borders.left,tt.left=W,mt=Z)}for(let B=G;B<=T;B++){const K=St(B,Q),ht=(Jo=b[(jo=K==null?void 0:K.styleIndex)!=null?jo:0])!=null?Jo:{},W=(Qo=ht.borderStyles)==null?void 0:Qo.right,Z=Xt(W);(xo=ht.borders)!=null&&xo.right&&Z>=ot&&(j.right=ht.borders.right,tt.right=W,ot=Z)}I=j,nt=tt}}const ut=g.fill;ut&&(t.fillStyle=ut,t.fillRect(i,r,u,p));let Wt=null,te=null,he=Number.POSITIVE_INFINITY,Xs=Number.POSITIVE_INFINITY;if(Pt.length>0){for(const C of Pt)if(((ts=C.ranges)!=null?ts:[]).some(x=>x.sheetName&&x.sheetName!==e.name?!1:Nt(o,c,x)))for(const x of(es=C.rules)!=null?es:[]){const z=typeof x.priority=="number"?x.priority:9999;if(x.type==="cellIs"){const ct=Tt(f);if(Lt((ns=x.operator)!=null?ns:"",x.formula,ct)){const O=x.dxfId;if(z<he){const j=gt(O);j&&(Wt=j,he=z)}const A=(os=pt.styles)==null?void 0:os.dxfs,mt=typeof O=="number"?A==null?void 0:A[O]:void 0,ot=(rs=(ss=mt==null?void 0:mt.font)==null?void 0:ss.fill)==null?void 0:rs.color;ot&&z<Xs&&(te=ot,Xs=z),Wt||(Wt="rgba(255,199,206,1)")}}}for(const C of Ut){if(!((is=C.ranges)!=null?is:[]).some(j=>j.sheetName&&j.sheetName!==e.name?!1:Nt(o,c,j)))continue;const x=Tt(f);if(x==null)continue;const z=C.vMax===C.vMin?0:(x-C.vMin)/(C.vMax-C.vMin),ct=Math.max(0,Math.min(1,z));if(Number.isNaN(ct))continue;const O=C.stops;if(O.length===0)continue;let A=(ls=(as=O[0])==null?void 0:as.rgb)!=null?ls:[0,0,0];if(O.length===1)A=(fs=(cs=O[0])==null?void 0:cs.rgb)!=null?fs:[0,0,0];else{let j=0;for(;j<O.length-1&&ct>((us=(ds=O[j+1])==null?void 0:ds.pos)!=null?us:0);)j++;const tt=O[j];if(!tt)continue;const B=O[Math.min(j+1,O.length-1)];if(!B)continue;const K=tt.pos===B.pos?0:(ct-tt.pos)/(B.pos-tt.pos);A=[Math.round(tt.rgb[0]+(B.rgb[0]-tt.rgb[0])*K),Math.round(tt.rgb[1]+(B.rgb[1]-tt.rgb[1])*K),Math.round(tt.rgb[2]+(B.rgb[2]-tt.rgb[2])*K)]}const mt="rgba(".concat(A[0],",").concat(A[1],",").concat(A[2],",1)"),ot=C.priority;ot<he&&(Wt=mt,he=ot)}}if(Wt&&(t.fillStyle=Wt,t.fillRect(i,r,u,p)),At.has("".concat(e.name,":").concat(E))&&(t.fillStyle="#eeeeee",t.fillRect(i,r,u,p)),wt&&N===o&&V===c&&(t.fillStyle="rgba(255,255,0,0.2)",t.fillRect(i,r,u,p)),Bt.length>0){let C=null;for(const L of Bt)((ms=L.ranges)!=null?ms:[]).some(z=>z.sheetName&&z.sheetName!==e.name?!1:Nt(o,c,z))&&(!C||L.priority<C.priority)&&(C=L);if(C){const L=Tt(f);if(L!=null){const z=Math.max(0,u-2),ct=Math.max(0,p-2),O=C.vMin,A=C.vMax;if(A!==O&&z>0&&ct>0){let mt=i+1,ot=0;if(O>=0)ot=Math.max(0,Math.min(1,(L-O)/(A-O)))*z;else if(A<=0)ot=Math.max(0,Math.min(1,(L-A)/(O-A)))*z,mt=i+1+(z-ot);else{const j=-O/(A-O),tt=z*j;if(L>=0){const B=Math.max(0,Math.min(1,L/A));mt=i+1+tt,ot=B*(z-tt)}else{const B=Math.max(0,Math.min(1,L/O));mt=i+1+tt-B*tt,ot=B*tt}}ot>.5&&(t.save(),t.globalAlpha=.6,t.fillStyle=C.colorCss,t.fillRect(mt,r+1,ot,ct),t.restore())}}}}if(I){const C=I,L=nt!=null?nt:{};C.top&&(L.top==="double"?ge(t,"top",C.top,i,r,u,p):L.top==="slantDashDot"?be(t,"top",C.top,i,r,u,p):(re(t,L.top,C.top),t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r),t.stroke(),t.restore())),C.bottom&&(L.bottom==="double"?ge(t,"bottom",C.bottom,i,r,u,p):L.bottom==="slantDashDot"?be(t,"bottom",C.bottom,i,r,u,p):(re(t,L.bottom,C.bottom),t.beginPath(),t.moveTo(i,r+p),t.lineTo(i+u,r+p),t.stroke(),t.restore())),C.left&&(L.left==="double"?ge(t,"left",C.left,i,r,u,p):L.left==="slantDashDot"?be(t,"left",C.left,i,r,u,p):(re(t,L.left,C.left),t.beginPath(),t.moveTo(i,r),t.lineTo(i,r+p),t.stroke(),t.restore())),C.right&&(L.right==="double"?ge(t,"right",C.right,i,r,u,p):L.right==="slantDashDot"?be(t,"right",C.right,i,r,u,p):(re(t,L.right,C.right),t.beginPath(),t.moveTo(i+u,r),t.lineTo(i+u,r+p),t.stroke(),t.restore()))}if(e.showGridLines!==!1&&!(!!g.fill||!!Wt)){t.strokeStyle="#ccc",t.lineWidth=Vt;const L=(()=>{var bt,yt;const W=St(o-1,c),Z=(bt=W==null?void 0:W.styleIndex)!=null?bt:0;return(yt=b[Z])!=null?yt:{}})(),x=(()=>{var bt,yt;const W=St(o,c-1),Z=(bt=W==null?void 0:W.styleIndex)!=null?bt:0;return(yt=b[Z])!=null?yt:{}})(),z=(W,Z)=>{var yt;const bt=(yt=e.mergedCells)!=null?yt:[];for(const Ft of bt){const Dt=et(Ft.startAddress),Ot=ft(Ft.startAddress),Yt=et(Ft.endAddress),Kt=ft(Ft.endAddress),U=Math.min(Dt,Yt),Y=Math.max(Dt,Yt),It=Math.min(Ot,Kt),Ht=Math.max(Ot,Kt);if(Z>=U&&Z<=Y&&W-1>=It&&W<=Ht)return!0}return!1},ct=(W,Z)=>{var yt;const bt=(yt=e.mergedCells)!=null?yt:[];for(const Ft of bt){const Dt=et(Ft.startAddress),Ot=ft(Ft.startAddress),Yt=et(Ft.endAddress),Kt=ft(Ft.endAddress),U=Math.min(Dt,Yt),Y=Math.max(Dt,Yt),It=Math.min(Ot,Kt),Ht=Math.max(Ot,Kt);if(W>=It&&W<=Ht&&Z-1>=U&&Z<=Y)return!0}return!1},O=!!(I!=null&&I.top),A=(W,Z)=>{for(const bt of ce){if(!bt.ref)continue;const yt=et(bt.ref.split(":")[0]||bt.ref),Ft=ft(bt.ref.split(":")[0]||bt.ref),Dt=bt.ref.split(":")[1],Ot=Dt?et(Dt):yt,Yt=Dt?ft(Dt):Ft,Kt=Math.min(yt,Ot),U=Math.max(yt,Ot),Y=Math.min(Ft,Yt),It=Math.max(Ft,Yt);if(Z>=Kt&&Z<=U&&W-1>=Y&&W<=It)return!0}return!1},mt=!!((hs=L.borders)!=null&&hs.bottom),ot=z(o,c),j=A(o,c);!O&&!mt&&!ot&&!j&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r),t.stroke());const tt=!!(I!=null&&I.left),B=!!((ps=x.borders)!=null&&ps.right),K=zt(o,c-1),ht=ct(o,c);!tt&&!B&&!K&&!ht&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i,r+p),t.stroke())}if(Et.has(E)){const C=Mt[E];C&&(t.save(),t.fillStyle=C+"22",t.fillRect(i,r,u,p),t.restore(),t.strokeStyle=C,t.lineWidth=2,t.strokeRect(i,r,u,p))}if(f){const C=(()=>{if(Rt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const U=Gt.get(f.sharedFormulaSi);if(U)return"= ".concat(fr(U.base,U.anchor,f.address))}}return sr(f,b)})(),L=f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:C,citations:[]}]}],x=(()=>{if(Rt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Gt.has(f.sharedFormulaSi)))return!1;const U=Number(f.value);return f.dataType!==me.CELL_DATA_TYPE_STRING&&!Number.isNaN(U)})(),z={anchor:(gs=g.verticalAlign)!=null?gs:Fe.ANCHOR_TYPE_BOTTOM,alignment:g.align==="center"?Zt.ALIGNMENT_TYPE_CENTER:g.align==="right"?Zt.ALIGNMENT_TYPE_RIGHT:g.align==="left"?Zt.ALIGNMENT_TYPE_LEFT:x?Zt.ALIGNMENT_TYPE_RIGHT:Zt.ALIGNMENT_TYPE_LEFT},ct={paragraphs:L,textStyle:z,bbox:{xEmu:Math.round(i*9525),yEmu:Math.round(r*9525),widthEmu:Math.round(u*9525),heightEmu:Math.round(p*9525)},type:xs.ELEMENT_TYPE_TEXT,levelsStyles:[]},O=(Ms=(bs=pt.styles)==null?void 0:bs.cellXfs)==null?void 0:Ms[(ys=H!=null?H:f==null?void 0:f.styleIndex)!=null?ys:0],A=O&&O.fontId!=null?(Cs=(Ts=pt.styles)==null?void 0:Ts.fonts)==null?void 0:Cs[O.fontId]:void 0,mt=Le.has(E),ot=Ne.has(E)||ve.has(E);for(const U of(Ss=ct.paragraphs)!=null?Ss:[])for(const Y of(Fs=U.runs)!=null?Fs:[]){if(Y.textStyle=(Es=Y.textStyle)!=null?Es:{},typeof Y.textStyle.fontSize=="number"&&Y.textStyle.fontSize>0&&Y.textStyle.fontSize<100&&(Y.textStyle.fontSize=Math.round(Y.textStyle.fontSize*100)),!(typeof Y.textStyle.fontSize=="number"&&Y.textStyle.fontSize>0)){const It=(As=g.font)==null?void 0:As.size,Ht=typeof It=="number"&&It>0?It*72/96:11;Y.textStyle.fontSize=Math.round(Ht*100)}Y.textStyle.bold==null&&((Ns=g.font)==null?void 0:Ns.bold)!=null&&(Y.textStyle.bold=!!g.font.bold),(mt||ot)&&(Y.textStyle.bold=!0),Y.textStyle.italic==null&&((vs=g.font)==null?void 0:vs.italic)!=null&&(Y.textStyle.italic=!!g.font.italic),Y.textStyle.name==null&&(Y.textStyle.name=Nr((Rs=A==null?void 0:A.name)!=null?Rs:(ws=g.font)==null?void 0:ws.family)),Y.textStyle.underline==null&&(A!=null&&A.underline)&&(Y.textStyle.underline=A.underline),te?Y.textStyle.fill={color:te,type:Qs.FILL_TYPE_SOLID,gradientStops:[]}:!Y.textStyle.fill&&(A!=null&&A.fill)?Y.textStyle.fill=A.fill:Y.textStyle.fill||(Y.textStyle.fill={color:{type:2,value:"FF000000",transform:void 0,lastColor:""},type:Qs.FILL_TYPE_SOLID,gradientStops:[]})}typeof f.styleIndex=="number"&&!$t.has(f.styleIndex)&&$t.size<12&&$t.add(f.styleIndex);const j=Qt(o,c),B=((Is=(Ls=g.font)==null?void 0:Ls.size)!=null?Is:11*(96/72))*de,K=Math.max(2,Math.round((B||11)*.35)),ht=Math.max(1,Math.round((B||11)*.25)),W=we(ct,t,k,void 0,{resolvedStyle:z,bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:de,wrap:!1}),Z=(ks=(Os=(Ps=(_s=W==null?void 0:W.lines)==null?void 0:_s[0])==null?void 0:Ps.widthPx)!=null?Os:(Ds=Ct.textMetrics.get(ue(o,c)))==null?void 0:Ds.firstLineW)!=null?ks:0;Ct.textMetrics.set(ue(o,c),{firstLineW:Z,padLr:K,padTb:ht,isNumeric:x});const bt=Math.max(0,u-(K+K)),yt=!x&&Z>bt,Ft=Math.max(u,Z+(K+K)),Dt=$&&(Q>J||T>G)?u:j,Ot=yt?Math.min(Dt,Ft):u,Yt=yt?Js(js({},z),{alignment:Zt.ALIGNMENT_TYPE_LEFT}):z;if(E==="B2"){const U=St(o,c+1);(U==null?void 0:U.value)!=null&&String(U.value),($s=U==null?void 0:U.paragraphs)!=null&&$s.some(It=>{var Ht;return(Ht=It.runs)==null?void 0:Ht.some(fe=>{var Ks;return((Ks=fe.text)!=null?Ks:"").length>0})}),U!=null&&U.formula||(U==null||U.sharedFormulaSi);const Y=Tt(U);Bt.some(It=>{var Ht;return((Ht=It.ranges)!=null?Ht:[]).some(fe=>(!fe.sheetName||fe.sheetName===e.name)&&Nt(o,c+1,fe))})&&Y!=null}const Kt=()=>{t.save(),t.beginPath(),t.rect(i,r,Ot,p),t.clip();const U=Yt.alignment===Zt.ALIGNMENT_TYPE_LEFT?Math.max(Ot,Z+(K+K)):Ot;we(ct,t,k,void 0,{resolvedStyle:Yt,bboxPx:{x:i,y:r,width:U,height:p},textScale:de,wrap:!1}),t.restore()};y.push(()=>{Kt(),F&&(q||rt)&&(re(t,st,F),rt&&(t.beginPath(),t.moveTo(i,r),t.lineTo(i+u,r+p),t.stroke()),q&&(t.beginPath(),t.moveTo(i,r+p),t.lineTo(i+u,r),t.stroke()),t.restore())})}}if(ce.length>0)for(const c of ce){if(!c.ref)continue;const[i,u]=c.ref.split(":"),p=et(i!=null?i:"A1"),f=ft(i!=null?i:"A1"),E=u?et(u):p,_=u?ft(u):f,X=Math.max(Math.min(p,E),Jt),H=Math.min(Math.max(p,E),xt),g=Math.min(f,_),F=Math.max(f,_);if(!(X>H)&&o>=g&&o<=F){const q=at+((Bs=w[X])!=null?Bs:0)-m,rt=at+((Ws=w[H+1])!=null?Ws:0)-m,st=lt+((Hs=(Ys=R[o+1])!=null?Ys:R[o])!=null?Hs:0)-P,it=dt(c==null?void 0:c.dataDxfId)||"#cccccc";re(t,"thin",it),t.beginPath(),t.moveTo(q,st),t.lineTo(rt,st),t.stroke(),t.restore()}}for(const c of y)c()}Rr(t,e,pt,w,R,m,P,M/v,S/v),Ar(t,e,pt,w,R,m,P,M/v,S/v,k),t.textAlign="center",t.textBaseline="middle",t.font="12px sans-serif";for(let o=Jt;o<=xt;o++){const a=at+((Gs=w[o])!=null?Gs:0)-m,r=(zs=n[o])!=null?zs:0;t.fillStyle="#f5f5f5",t.fillRect(a,0,r,lt),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(a,0,r,lt),t.fillStyle="#333",t.fillText(ee(o),a+r/2,lt/2)}for(let o=oe;o<=se;o++){const a=lt+((Us=R[o])!=null?Us:0)-P,r=(Vs=s[o])!=null?Vs:0;r<=0||(t.fillStyle="#f5f5f5",t.fillRect(0,a,at,r),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(0,a,at,r),t.fillStyle="#333",t.fillText((o+1).toString(),at/2,a+r/2))}t.fillStyle="#f5f5f5",t.fillRect(0,0,at,lt),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(0,0,at,lt),t.restore()}export{lt as C,Mr as F,at as R,Tr as a,Wr as b,$r as c,Yr as d,et as e,ee as f,sr as g,Br as p,ft as r};
//# sourceMappingURL=kcwv15xxjkwkz15c.js.map

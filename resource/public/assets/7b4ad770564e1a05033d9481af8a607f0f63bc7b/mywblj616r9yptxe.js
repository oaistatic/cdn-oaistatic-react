const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kw08ajijqinojrwh.js","assets/kfrdmkli83ureki3.js","assets/root-fi49nzd2.css","assets/ffrotvb922yxp30i.js","assets/fhiqz5jh4i8adn2f.js","assets/nv78vw3zo9kkss1o.js","assets/gbvne18halyi17u1.js","assets/cjv4tm2buxt5byw3.js","assets/f538t4a72yr8mvhj.js","assets/bj2o1htuhytjg1ta.js","assets/fyw02vlaiv2vq6cj.js","assets/conversation-small-lq38g8zw.css","assets/ce3hgmw4iyyhicud.js","assets/juhk9bg10nm4p27d.js","assets/ns51nblw8ziscsgd.js","assets/edhlcmww46h398kf.js","assets/e7j9ia0bu5w3396k.js","assets/hytzro4etxb8j4b5.js","assets/m148ha1ozi8vz2cs.js","assets/ink8x3k66s63lr27.js","assets/jnr2ibp3zs9z7xhs.js","assets/comments-plugin-tah3dlup.css","assets/codemirror-g1j9yafs.css","assets/lfj020w6m7gfm8bo.js","assets/de3ceoxcpky3ng0s.js","assets/fezjsdexlc6827p7.js","assets/nvbtsxz152qyrww5.js","assets/me479l0dlgxhtxr0.js","assets/gf4c0f98pdaqc94a.js","assets/idxukd613qgy7urm.js","assets/bmm8s4kivjzbh6zb.js","assets/mstl8wgfzorpgdoe.js","assets/cp40hb6p64z5j02r.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/fxom17ahenhnb7xw.js","assets/deakbbf27g8e7ba0.js","assets/ft1wtuo4ibr3do9l.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/f86yt77iw8uocdb0.js","assets/apk64hcfjxdfvbpb.js","assets/ifhsypom7qzhsv63.js","assets/hzx9fvhly6v2qmjm.js","assets/mer2el06ski1l09m.js","assets/gy1lpvuoewmzh42c.js","assets/dm8z7bzkrzic0zmg.js","assets/hu1bt0oauegdhua6.js","assets/fx4g5niv8hgtkxju.js","assets/bdqubk4ywd0en7sc.js","assets/ci7lhbgv3s1kfbx6.js","assets/kbj1b07s2z6vxqkg.js","assets/h1em0bjkpkjv8ykw.js","assets/i7t1qh3u8s8bvtb8.js","assets/ab1440qk9vnud23e.js","assets/glg11vispnpcyq1s.js","assets/jhvofh4m5uva5wy3.js","assets/ipjj058rvhjq2uu2.js","assets/lep2wptoy14cfe2w.js","assets/hgrkp82vl7wpvpuw.js","assets/gljkwjomy29v9c26.js","assets/oafyrulh7bq2qerb.js","assets/prosemirror-egdr15sq.css","assets/o9u4h3iqiok9m0a8.js","assets/iyn42bfr1ydmech0.js","assets/kspsmo2l8jg7uqdj.js","assets/e2qiox9wm3uaxg29.js","assets/mgt4kmm4im6a7le7.js","assets/esgn9c4esm3mlqc4.js","assets/m3joncw451cqbul2.js"])))=>i.map(i=>d[i]);
var Q=Object.defineProperty;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var j=(e,n,t)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,I=(e,n)=>{for(var t in n||(n={}))V.call(n,t)&&j(e,t,n[t]);if(R)for(var t of R(n))ee.call(n,t)&&j(e,t,n[t]);return e};import{j as l,r as g,_,h as U,e as ne,c as te,g as oe,i as se}from"./kfrdmkli83ureki3.js";import{Z as ae,C as W}from"./ce3hgmw4iyyhicud.js";import{dR as le,cy as y,az as h,cs as $,d_ as ie,aA as T,mE as q,p as X,u as Y,P as z,D as re,R as ce,_ as k}from"./kw08ajijqinojrwh.js";import{df as ue,ut as fe,fj as s,ff as pe,fi as v,fg as de,e7 as me,uO as be,mH as M,mI as Ee,al as Ce,uP as J}from"./fyw02vlaiv2vq6cj.js";import{b as P}from"./mstl8wgfzorpgdoe.js";import{_ as xe,a as _e,b as ge,c as ye,u as he,B as Te,d as De}from"./cp40hb6p64z5j02r.js";import{u as Oe}from"./fxom17ahenhnb7xw.js";import{T as ve}from"./e7j9ia0bu5w3396k.js";import{u as Le}from"./edhlcmww46h398kf.js";import{d as Ie}from"./deakbbf27g8e7ba0.js";import{s as K}from"./ft1wtuo4ibr3do9l.js";import{d as w}from"./kl7c6054usfnqmd4.js";import{g as we}from"./k97n0y6ba9c9h39c.js";import{r as Ae}from"./f86yt77iw8uocdb0.js";function Se({className:e,zIndexKey:n,onClick:t}){return l.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:y("absolute inset-0",e,ae[n]),onClick:t})}function Ne({zIndexKey:e,onClick:n}){return l.jsx(Se,{zIndexKey:e,onClick:n,className:"bg-gray-50/50 dark:bg-black/50"})}function Re(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];e&&typeof e!="function"?console.error('react-scroll-to-bottom: First argument passed to "useObserveScrollPosition" must be a function.'):xe(t)||console.error('react-scroll-to-bottom: Second argument passed to "useObserveScrollPosition" must be an array if specified.');var o=_e(),a=o.observeScrollPosition;g.useEffect(function(){return e&&a(e)},ge(n=[]).call(n,ye(t),[!e,a]))}function je(){var e=he(),n=e.scrollToTop;return n}const ke=h(()=>_(()=>import("./kw08ajijqinojrwh.js").then(e=>e.yt),__vite__mapDeps([0,1,2])),{loading:e=>T(e)}),Me=h(()=>_(()=>import("./ffrotvb922yxp30i.js"),__vite__mapDeps([3,1])),{loading:e=>T(e)}),Pe=h(()=>_(()=>import("./fhiqz5jh4i8adn2f.js"),__vite__mapDeps([4,1])),{loading:e=>T(e)}),Fe=({onScroll:e})=>(Re(({scrollTop:n})=>{e==null||e(n)}),null),Be=({shouldScrollToTop:e})=>{const n=je();return g.useEffect(()=>{e===!0&&n({behavior:"smooth"})},[e,n]),null},He=()=>{const e=Oe();g.useEffect(()=>{e({behavior:"smooth"})},[e]);const[n]=De();return n?null:l.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"border-token-border-default bg-token-main-surface-primary text-token-text-secondary absolute end-1/2 bottom-5 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border bg-clip-padding",children:l.jsx(Pe,{className:"icon text-token-text-primary"})})};function Ge({children:e,onScroll:n,shouldScrollToTop:t,scrollToBottomMode:o="top",isLoading:a=!1,header:r,height:i="auto",overlay:u,hideChildren:p=!1,disableScroll:b=!1,ref:d,onCopy:E}){const c=l.jsx("div",{onCopy:E,className:y(p?"hidden":"block",i==="auto"?"h-auto":"h-full"),children:e});return l.jsxs("section",{ref:d,className:y("relative flex min-h-0 flex-auto grow flex-col",b&&"overflow-hidden"),children:[l.jsx(ie,{children:a&&l.jsx(Ne,{zIndexKey:"textdocDiffLoadingOverlay"})}),!b&&l.jsxs(Te,{followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:"flex flex-col",className:"h-full",mode:o,children:[r,c,u&&l.jsx("div",{className:"pointer-events-none w-full flex-1",children:u}),o==="bottom"&&l.jsx(He,{}),l.jsx(Fe,{onScroll:n}),l.jsx(Be,{shouldScrollToTop:t})]}),b&&l.jsxs(l.Fragment,{children:[r,c,u&&l.jsx("div",{className:"pointer-events-none h-full w-full",children:u})]})]})}function Ue({className:e,children:n}){return l.jsx("header",{className:y(e,"touch:px-2.5 h-header-height flex flex-none items-center justify-between gap-1 px-2"),children:n})}function We({className:e,children:n,size:t="lg",bold:o}){return l.jsx("h2",{className:y(e,"text-token-text-primary truncate",o?"font-bold":"font-normal",t==="lg"&&"text-lg",t==="base"&&"text-base"),children:n})}const $e=({onClick:e})=>{const t=$()?Me:ke;return l.jsx(ue,{icon:t,onClick:e})},F=e=>{const{r:n,g:t,b:o}=P.toRGBA(P.parse(e));return(n*299+t*587+o*114)/1e3<125},L=({children:e,isPreviewingCode:n=!1,transitionBackground:t=!1,previewBackgroundColor:o=null})=>{const a=n&&o&&F(o),r=n&&o&&!F(o);return l.jsx("section",{className:y("popover flex h-full w-full flex-col",t&&"transition-colors",a&&"dark",r&&"light",n?"bg-[rgba(249,249,249,1)] dark:bg-[rgba(33,33,33,1)]":"bg-transparent"),style:{backgroundColor:n&&o?o:void 0},children:e})};L.Title=We;L.CloseButton=$e;L.Header=Ue;L.Content=Ge;const qe=h(()=>_(()=>import("./nv78vw3zo9kkss1o.js"),__vite__mapDeps([5,1,6,7,0,2,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.CodeComposer),{loading:()=>l.jsx("div",{className:W.code,children:l.jsx("div",{className:"h-full w-full px-4",children:l.jsx(q,{lines:20})})})}),vn=e=>l.jsx(qe,I({},e)),Ln=(e=[])=>e.filter(({status:n})=>n!==fe.DISMISSED);var Xe=(e=>(e.ALL_HIDDEN="all_hidden",e.COMMENTS_READONLY="comments_readonly",e.ENABLED="enabled",e))(Xe||{});const B=775,Ye=580,ze=36,Je=18,In=24,wn=16,Ke=({numLines:e=20})=>{const[{width:n},t]=Le(),o=$(),a=n>=B+ve?B:Ye,r=o?Je:ze;return l.jsx("div",{className:y(W.document,"mt-4"),ref:t,style:{margin:"0 ".concat(r,"px")},children:l.jsx("div",{style:{width:a},children:l.jsx(q,{lines:e})})})},Ze=h(()=>_(()=>import("./apk64hcfjxdfvbpb.js"),__vite__mapDeps([42,1,43,0,2,19,7,18,13,10,11,14,12,15,20,17,9,16,21,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,23,24,25,26,27,28,29,64,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.DocumentComposer),{loading:({value:e,width:n=window.innerWidth})=>l.jsx(Ke,{numLines:Math.ceil(e.length/(n/8))})}),An=e=>l.jsx(Ze,I({},e));var O=(e=>(e.ADDED="added",e.REMOVED="removed",e.UNCHANGED="unchanged",e))(O||{});function N(e){if(e==="")return 0;const n=e.split("\n").length;return e.endsWith("\n")?n-1:n}function Qe(e,n){return Ie(e,n,{newlineIsToken:!0}).map(o=>{var a;return{count:(a=o.count)!=null?a:N(o.value),value:o.value,type:o.added?"added":o.removed?"removed":"unchanged"}})}function Ve(e){let n="";for(const{type:t,value:o}of e)(t==="added"||t==="unchanged")&&(n+=o);return n}function en(e,n){const t=N(n),o=on(e,t);return{changes:Qe(o,n),numLinesDiffed:t}}function nn(e){const n=[...e],t=[],o=[];for(;n.length>0;){const a=n[n.length-1];if(a.type===O.REMOVED)n.pop(),a.type===O.REMOVED&&t.unshift(a);else if(a.type===O.ADDED)n.pop(),o.unshift(a);else break}return{prunedChanges:[...n,...o],prunedRemovedChanges:t}}function tn(e,n){const{changes:t,numLinesDiffed:o}=en(e,n),{prunedChanges:a,prunedRemovedChanges:r}=nn(t),i=Ve(a),u=r.map(b=>b.value).join("\n"),p=Z(e,o,"start");return{content:i+u+p,numLinesDiffed:N(i)}}function on(e,n){if(n<=0)return"";let t=0,o=e.length;for(let a=0;a<e.length;a++)if(e[a]==="\n"&&(t++,t===n)){o=a+1;break}return e.substring(0,o)}function Z(e,n,t="start"){if(n<=0)return e;if(t==="start"){let i=0;for(let u=0;u<e.length;u++)if(e[u]==="\n"&&(i++,i===n))return e.substring(u+1);return""}let o=0,a=-1;const r=e.endsWith("\n")?n+1:n;for(let i=e.length-1;i>=0;i--)if(e[i]==="\n"&&(o++,o===r)){a=i;break}return a===-1?"":e.substring(0,a+1)}function Sn(e,n){var u,p;const t=(u=e==null?void 0:e.type)!=null?u:s.LOADING,o=(p=e==null?void 0:e.content)!=null?p:"",a=pe(e);if(!v(t)||n==null||!a||!de(e))return{content:o,currentlyStreamingLineIndex:null};const r=Z(o,1,"end");if(r==="")return{content:n.content,currentlyStreamingLineIndex:0};const i=tn(n.content,r);return{content:i.content,currentlyStreamingLineIndex:i.numLinesDiffed}}const sn=h(()=>_(()=>import("./iyn42bfr1ydmech0.js"),__vite__mapDeps([65,1])),{loading:e=>T(e)}),an=h(()=>_(()=>import("./kspsmo2l8jg7uqdj.js"),__vite__mapDeps([66,1])),{loading:e=>T(e)});function ln(e){"use forget";const n=te.c(8),{textdocVersion:t,clientThreadId:o}=e,a=Y();let r;n[0]!==t?(r=d=>t&&(d==null?void 0:d.lastCanvasAssistantMessageById[t.textdocId]),n[0]=t,n[1]=r):r=n[1];const i=be(r),u=t==null?void 0:t.type,p=t!=null;let b;return n[2]!==o||n[3]!==a||n[4]!==p||n[5]!==i||n[6]!==u?(b=d=>{if(!d.selectedText)return;const E=z(o);p&&E!=null&&i!=null&&J(a,{type:"copy",source:d.source,location:"canvas",selectedText:d.selectedText,messageId:i,serverThreadId:E,contentType:u!=null&&v(u)?"code":"text",productLogOnly:d.productLogOnly})},n[2]=o,n[3]=a,n[4]=p,n[5]=i,n[6]=u,n[7]=b):b=n[7],b}function Nn({textdocVersion:e,clientThreadId:n}){var d;const t=U(),o=X(),[a,r]=g.useState(!1),i=me(),u=ln({textdocVersion:e,clientThreadId:n}),p=g.useRef((d=e==null?void 0:e.content)!=null?d:"");return g.useEffect(()=>{var E;p.current=(E=e==null?void 0:e.content)!=null?E:""},[e]),{handleCopy:E=>{a||(i(async()=>{const c=await K(p.current);u({source:"mouse",selectedText:c}),M.logButtonClick(Ee.COPY,{contentLength:c.length,textdocType:e==null?void 0:e.type});let f={"text/plain":c};if((e==null?void 0:e.type)===s.DOCUMENT)try{const{markdownToClipboardContent:m}=await _(async()=>{const{markdownToClipboardContent:C}=await import("./e2qiox9wm3uaxg29.js").then(x=>x.j);return{markdownToClipboardContent:C}},__vite__mapDeps([67,10,1,0,2,11,50,51,52,48,53,54,46,47,68,58,69,55,45,70,59]));f=m(c,[])}catch(m){M.logError("Error copying rich text",m)}Ce(f,o,E)},0),r(!0),i(()=>r(!1),2e3))},Icon:a?an:sn,copyLabel:t.formatMessage(rn.copy)}}const rn=ne({copy:{id:"rbIYfo",defaultMessage:"Copy"}}),H={[s.CODE_BASH]:{filenameExtension:"sh",blobType:"text/x-shellscript"},[s.CODE_ZSH]:{filenameExtension:"zsh",blobType:"text/x-shellscript"},[s.CODE_JAVASCRIPT]:{filenameExtension:"js",blobType:"application/javascript"},[s.CODE_TYPESCRIPT]:{filenameExtension:"ts",blobType:"application/typescript"},[s.CODE_HTML]:{filenameExtension:"html",blobType:"text/html"},[s.CODE_CSS]:{filenameExtension:"css",blobType:"text/css"},[s.CODE_PYTHON]:{filenameExtension:"py",blobType:"text/x-python"},[s.CODE_JSON]:{filenameExtension:"json",blobType:"application/json"},[s.CODE_SQL]:{filenameExtension:"sql",blobType:"application/sql"},[s.CODE_GO]:{filenameExtension:"go",blobType:"text/x-go"},[s.CODE_YAML]:{filenameExtension:"yaml",blobType:"application/x-yaml"},[s.CODE_JAVA]:{filenameExtension:"java",blobType:"text/x-java-source"},[s.CODE_RUST]:{filenameExtension:"rs",blobType:"text/rust"},[s.CODE_CPP]:{filenameExtension:"cpp",blobType:"text/x-c++src"},[s.CODE_SWIFT]:{filenameExtension:"swift",blobType:"text/swift"},[s.CODE_PHP]:{filenameExtension:"php",blobType:"application/x-httpd-php"},[s.CODE_XML]:{filenameExtension:"xml",blobType:"application/xml"},[s.CODE_RUBY]:{filenameExtension:"rb",blobType:"text/x-ruby"},[s.CODE_HASKELL]:{filenameExtension:"hs",blobType:"text/x-haskell"},[s.CODE_KOTLIN]:{filenameExtension:"kt",blobType:"text/x-kotlin"},[s.CODE_CSHARP]:{filenameExtension:"cs",blobType:"text/x-csharp"},[s.CODE_C]:{filenameExtension:"c",blobType:"text/x-csrc"},[s.CODE_OBJECTIVEC]:{filenameExtension:"m",blobType:"text/x-objectivec"},[s.CODE_R]:{filenameExtension:"r",blobType:"text/plain"},[s.CODE_LUA]:{filenameExtension:"lua",blobType:"text/x-lua"},[s.CODE_DART]:{filenameExtension:"dart",blobType:"text/x-dart"},[s.CODE_SCALA]:{filenameExtension:"scala",blobType:"text/x-scala"},[s.CODE_PERL]:{filenameExtension:"pl",blobType:"text/x-perl"},[s.CODE_COMMONLISP]:{filenameExtension:"lisp",blobType:"text/x-common-lisp"},[s.CODE_CLOJURE]:{filenameExtension:"clj",blobType:"text/x-clojure"},[s.CODE_OCAML]:{filenameExtension:"ml",blobType:"text/x-ocaml"},[s.CODE_POWERSHELL]:{filenameExtension:"ps1",blobType:"text/x-powershell"},[s.CODE_VERILOG]:{filenameExtension:"v",blobType:"text/x-verilog"},[s.CODE_DOCKERFILE]:{filenameExtension:"Dockerfile",blobType:"text/x-dockerfile"},[s.CODE_VUE]:{filenameExtension:"vue",blobType:"text/x-vue"},[s.CODE_REACT]:{filenameExtension:"jsx",blobType:"application/javascript"},[s.CODE_OTHER]:{filenameExtension:"txt",blobType:"text/plain"},[s.DOCUMENT]:{filenameExtension:"md",blobType:"text/markdown"},[s.LOADING]:{filenameExtension:"txt",blobType:"text/plain"}};var A,G;function cn(){if(G)return A;G=1;var e=Ae(),n=e(function(t,o,a){return t+(a?"_":"")+o.toLowerCase()});return A=n,A}var un=cn();const S=oe(un);function Rn({textdocVersion:e,clientThreadId:n}){const t=U(),o=X(),a=Y(),r=g.useCallback((c,f)=>{var x;const m=(x=e==null?void 0:e.messageId)!=null?x:void 0,C=n!=null?z(n):void 0;!C||!m||J(a,{source:"mouse",type:"download",selectedText:c,location:"canvas",contentType:f,messageId:m,serverThreadId:C,productLogOnly:!0})},[n,a,e]),i=t.formatMessage({id:"canvas.downloadFileError",defaultMessage:"Failed to download file. Please try again later."}),{mutate:u,isPending:p}=se({mutationFn:async({textdocId:c,exportType:f})=>{const m=await ce.safePost("/export_doc/canvas",{requestBody:{textdoc_id:c,export_type:f},skipJsonTransform:!0});if(!m.ok)throw new Error("Failed to download file");return m},onSuccess:async(c,{exportType:f})=>{var D;if(!e)return;const m=await c.blob(),C=c.headers.get("Content-Disposition"),x=(D=we(C))!=null?D:"".concat(S(e.title),".").concat(f);w(m,x)},onError:c=>{o.danger(i,{toastId:"textdoc_download_button",loggingTitle:i,loggingDescription:"Failed to download file"}),re.addError(c)}}),b=async c=>{if(e&&e.type!==s.LOADING&&e.type===s.DOCUMENT){let f;switch(c){case"md":f="chatgpt_canvas_md_download";break;case"pdf":f="chatgpt_canvas_pdf_download";break;case"docx":f="chatgpt_canvas_docx_download";break}if(k.logEventWithStatsig("ChatGPT Canvas Download",f),r(e.content,v(e.type)?"code":"text"),c==="pdf"||c==="docx")u({textdocId:e.textdocId,exportType:c});else if(c==="md"){const{filenameExtension:m,blobType:C}=H[e.type],x=await K(e.content),D=new Blob([x],{type:C});w(D,"".concat(S(e.title),".").concat(m))}}},d=()=>{if(!e)return;const{filenameExtension:c,blobType:f}=H[e.type];if(e.type===s.LOADING)return;k.logEventWithStatsig("ChatGPT Canvas Download","chatgpt_canvas_code_download",{blobType:f});const m=new Blob([e.content],{type:f});w(m,"".concat(S(e.title),".").concat(c)),r(e.content,v(e.type)?"code":"text")},E=t.formatMessage({id:"canvas.download-button",defaultMessage:"Download"});return{handleFileDownload:b,handleBlobDownload:d,isLoading:p,downloadCopyLabel:E,isDocument:(e==null?void 0:e.type)===s.DOCUMENT}}export{vn as A,Xe as C,Ke as D,Ne as L,In as M,Se as O,wn as S,An as a,L as b,Rn as c,B as d,Ye as e,Ln as f,Sn as g,ze as h,Je as i,ln as j,Nn as u};
//# sourceMappingURL=mywblj616r9yptxe.js.map

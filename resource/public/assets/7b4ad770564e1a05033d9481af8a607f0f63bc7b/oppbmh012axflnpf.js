import{c as fe,ai as _e,j as B}from"./kfrdmkli83ureki3.js";import{u as Ce,dT as me,ef as E,kt as ge,dP as ye,nH as pe,mn as te,oh as Ne,oz as Ie,fB as ke,fC as Oe,oA as ie,oy as Te,dY as oe,dZ as ce}from"./kw08ajijqinojrwh.js";import{bI as Re,br as se}from"./fyw02vlaiv2vq6cj.js";function Pe(t){"use forget";var $,U,W,z,V,q,G,Q,Y,F,H,K,X;const e=fe.c(34),o=Ce(),a=me();let d;e[0]!==o?(d=()=>Ne(o,{}).data,e[0]=o,e[1]=d):d=e[1];const c=E(d),re=c===void 0;let N;e[2]!==o?(N=()=>{var s;return(s=Ie(o,{fetchValidLinksOnly:!0}))==null?void 0:s.data},e[2]=o,e[3]=N):N=e[3];const l=E(N),ae=l===void 0;let I;e[4]!==o?(I=()=>ke(o),e[4]=o,e[5]=I):I=e[5];const _=E(I);let k;e[6]!==o?(k=()=>Oe(o),e[6]=o,e[7]=k):k=e[7];const C=E(k),de=_===void 0||C===void 0,m=ge(),x=ye(),{mutateAsync:h,isSuccess:L}=pe();let O;e[8]===Symbol.for("react.memo_cache_sentinel")?(O={filters:{mutationKey:["upgradeConnectorToSync"]},select:xe},e[8]=O):O=e[8];const S=_e(O);let T;e[9]!==a?(T=a==null?void 0:a.getWorkspaceId(),e[9]=a,e[10]=T):T=e[10];const{totalsByConnectorId:R}=Re(T);let y;if(e[11]!==S){y=new Set;for(const s of S)s.status==="success"&&y.add(s.variables.link.connector_id);e[11]=S,e[12]=y}else y=e[12];const M=y;let v;if(e[13]!==_||e[14]!==M||e[15]!==l||e[16]!==o||e[17]!==C||e[18]!==x||e[19]!==m||e[20]!==t.referrer||e[21]!==c||e[22]!==R||e[23]!==h||e[24]!==L){const s=new Map;for(const n of _!=null?_:[]){const r=(($=l==null?void 0:l.get(n.id))!=null?$:[]).length>0,u=(U=R.get(n.id))!=null?U:0;s.set(n.id,{key:n.id,label:n.name,connected:r,isSync:!1,totalCount:u,icon:B.jsx(se,{connector:n,size:"small"}),onClick:r?void 0:()=>m({connectorId:n.id,noRedirect:!0,referrer:t.referrer})})}for(const n of C!=null?C:[]){const i=n.user_connection_details.connector_id,r=c==null?void 0:c.find(w=>w.id===i);if(!r||!i)continue;const u=(V=(z=r==null?void 0:r.name)!=null?z:(W=n==null?void 0:n.connection_display_info)==null?void 0:W.display_name)!=null?V:"",le=M.has(i),Z=((G=i&&((q=s.get(i))==null?void 0:q.connected))!=null?G:!1)||(n==null?void 0:n.user_connection_details.auth_status)==="admin_connected"||(n==null?void 0:n.user_connection_details.auth_status)==="user_connected"||["partially_activated","activated","activating"].includes(n==null?void 0:n.user_connection_details.activation_status)||le,f={key:n.user_connection_details.connection_type,label:u,connected:Z,isSync:!0,totalCount:(Q=R.get(i))!=null?Q:0,icon:r?B.jsx(se,{connector:r,size:"small"}):B.jsx("img",{src:x&&((Y=n==null?void 0:n.connection_display_info)!=null&&Y.icon_dark_url)?(F=n==null?void 0:n.connection_display_info)==null?void 0:F.icon_dark_url:(K=(H=n==null?void 0:n.connection_display_info)==null?void 0:H.icon_url)!=null?K:"",alt:u,className:"icon-lg"}),onClick:Z?void 0:()=>m({connectorId:i,noRedirect:!0,referrer:t.referrer})};n.user_connection_details.connection_type===te.gdrive_sync_connector?(f.connected=f.connected||L,f.onClick=f.connected?void 0:async()=>{var ee,ne;const w=(ee=c==null?void 0:c.find(Ee))==null?void 0:ee.id,J=(ne=l==null?void 0:l.get(ie))==null?void 0:ne.find(ue=>ue.connector_id===w);J?(await h({link:J}),setTimeout(()=>{Te(o)},1e3)):m({connectorId:oe[ce.GDRIVE_ACTION_CONNECTOR],noRedirect:!0,referrer:t.referrer})}):n.user_connection_details.connection_type===te.notion_sync_connector&&(f.onClick=f.connected?void 0:()=>m({connectorId:oe[ce.NOTION_CONNECTOR],noRedirect:!0,referrer:t.referrer,syncOnly:!0})),s.set(i,f)}v=Array.from(s.values()),e[13]=_,e[14]=M,e[15]=l,e[16]=o,e[17]=C,e[18]=x,e[19]=m,e[20]=t.referrer,e[21]=c,e[22]=R,e[23]=h,e[24]=L,e[25]=v}else v=e[25];const P=v;let p;if(e[26]!==P){const s=new Map,n=be;for(const i of P){const r=String((X=i.label)!=null?X:"").toLowerCase().trim(),u=s.get(r);s.set(r,u?n(u,i):i)}p=Array.from(s.values()),p.sort(Ae),e[26]=P,e[27]=p}else p=e[27];const g=p;let A;e[28]!==g?(A=g.filter(ve),e[28]=g,e[29]=A):A=e[29];const D=A.length,j=de||ae||re;let b;return e[30]!==D||e[31]!==j||e[32]!==g?(b={uniqueItems:g,connectedCount:D,isLoading:j},e[30]=D,e[31]=j,e[32]=g,e[33]=b):b=e[33],b}function ve(t){return t.connected}function Ae(t,e){var d,c;if(t.connected!==e.connected)return Number(e.connected)-Number(t.connected);const o=Number((d=t.totalCount)!=null?d:0),a=Number((c=e.totalCount)!=null?c:0);return o!==a?a-o:0}function be(t,e){var d,c;if(t.connected!==e.connected)return e.connected?e:t;if(t.isSync!==e.isSync)return e.isSync?e:t;const o=Number((d=t.totalCount)!=null?d:0),a=Number((c=e.totalCount)!=null?c:0);return o!==a&&a>o?e:t}function Ee(t){return t.id===ie}function xe(t){return t.state}export{Pe as u};
//# sourceMappingURL=oppbmh012axflnpf.js.map

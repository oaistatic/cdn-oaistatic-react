const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fyw02vlaiv2vq6cj.js","assets/kfrdmkli83ureki3.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/oxnkxgnxllf109os.js"])))=>i.map(i=>d[i]);
var Ze=Object.defineProperty,$e=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var Pe=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ke=(t,e,o)=>e in t?Ze(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,Ie=(t,e)=>{for(var o in e||(e={}))Ye.call(e,o)&&ke(t,o,e[o]);if(Pe)for(var o of Pe(e))qe.call(e,o)&&ke(t,o,e[o]);return t},Me=(t,e)=>$e(t,Je(e));import{r as d,_ as Oe,c as Qe,h as Be,j as i}from"./kfrdmkli83ureki3.js";import{mH as ve,mI as et,aZ as tt,bH as ot}from"./fyw02vlaiv2vq6cj.js";import{S as st,C as He,e as Se,d as nt}from"./hytzro4etxb8j4b5.js";import{Z as De,T as rt}from"./ce3hgmw4iyyhicud.js";import{a as Ve}from"./me479l0dlgxhtxr0.js";import{bl as lt,az as ze,u as it,d as at,cy as ee,dR as Q,aA as Ge,d_ as ct,lr as ut,L as ft,e9 as mt}from"./kw08ajijqinojrwh.js";import{u as Ke}from"./edhlcmww46h398kf.js";import{u as pt,i as Fe,a as dt}from"./de3ceoxcpky3ng0s.js";import{i as ht}from"./gf4c0f98pdaqc94a.js";import{E as Ne,a as Et}from"./e7j9ia0bu5w3396k.js";function Xe(t){const e=t();if(e==null)return;const{from:o,to:l,sourceFrom:s,sourceTo:f}=e;if(o==null||l==null||s==null||f==null){ve.logError("Missing selection range on targeted edit",e);return}const h=st.ASK;ve.logButtonClick(et.TOOLBAR_ASK_CHATGPT,{action:h,sourceFrom:s,sourceTo:f}),He.startCommentingOn({type:Se.SELECTION,from:o,to:l,sourceRange:{start:s,end:f},action:h})}function yt(t,e,o){d.useEffect(()=>{if(o)return;const l=s=>{(s.metaKey||s.ctrlKey)&&s.key.toLowerCase()==="k"&&(s.preventDefault(),Xe(e))};return t==null||t.addEventListener("keydown",l),()=>t==null?void 0:t.removeEventListener("keydown",l)},[t,e,o])}var Ue=(t=>(t.ABOVE="above",t.BELOW="below",t))(Ue||{});function Re(t,e){return lt(t.coordsAtPos(e))}const vt=ze(()=>Oe(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.ze),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Ge(t)}),je=360,St=250,We=44,_t=.5,xt=[.5,.9,1],bt=[1,.75,.2],Ct=t=>{"use forget";const e=Qe.c(89),{onClose:o,onSubmit:l,opensOverDocument:s,opensFromGutter:f,gutterHasComments:h,ref:E}=t,n=s===void 0?!1:s,a=f===void 0?!1:f,_=h===void 0?!1:h,S=it(),c=Be(),q=d.useRef(null),L=d.useRef(!1),[u,P]=d.useState(""),[x,te]=d.useState(!0);let g;e[0]!==o?(g=()=>{document.hasFocus()&&(P(""),o==null||o(L.current))},e[0]=o,e[1]=g):g=e[1];const k=g;let I;e[2]!==u||e[3]!==l?(I=(v,w)=>{const A=w===void 0?u:w;L.current=!0,l==null||l(v,A),P("")},e[2]=u,e[3]=l,e[4]=I):I=e[4];const b=I;let y;e[5]!==S||e[6]!==n?(y=()=>n?ot(S).width<je+100?St:je:Ne,e[5]=S,e[6]=n,e[7]=y):y=e[7];const M=at(y);let m;e[8]!==a||e[9]!==n?(m={},a&&(m.top=-12),n&&a?m.right=0:m.left=0,e[8]=a,e[9]=n,e[10]=m):m=e[10];let T="";a&&!n?T="8px 50%":a&&n?T="calc(100% + 8px) 50%":n&&(T="center left");let C=0;a&&!n&&_&&(C=Et);let N;e[11]!==b||e[12]!==u||e[13]!==o?(N=v=>{const{metaKey:w,shiftKey:A,key:Ae}=v;Ae==="Enter"&&!v.nativeEvent.isComposing&&u&&!(A||w)?(b(v),v.preventDefault()):Ae==="Escape"&&(P(""),o==null||o(!1))},e[11]=b,e[12]=u,e[13]=o,e[14]=N):N=e[14];const D=N;let r;e[15]!==c?(r=c.formatMessage({id:"VvfbvY",defaultMessage:"Edit or explain..."}),e[15]=c,e[16]=r):r=e[16];const p=r;let R;e[17]!==E?(R=tt(q,E),e[17]=E,e[18]=R):R=e[18];let oe;e[19]===Symbol.for("react.memo_cache_sentinel")?(oe=ee("absolute flex items-center",De.commentComposer),e[19]=oe):oe=e[19];let j;e[20]!==m?(j=Me(Ie({},m),{minHeight:We}),e[20]=m,e[21]=j):j=e[21];let se,ne;e[22]===Symbol.for("react.memo_cache_sentinel")?(se={type:"spring",bounce:.18,duration:.48},ne={translateX:0},e[22]=se,e[23]=ne):(se=e[22],ne=e[23]);let O;e[24]!==C?(O={translateX:C},e[24]=C,e[25]=O):O=e[25];let re;e[26]===Symbol.for("react.memo_cache_sentinel")?(re={translateX:0},e[26]=re):re=e[26];const _e=!x;let B;e[27]!==x||e[28]!==_e?(B=ee("no-scrollbar border-token-border-default relative z-10 flex items-center overflow-x-hidden border",rt,{"rounded-full":x,"rounded-2xl":_e}),e[27]=x,e[28]=_e,e[29]=B):B=e[29];const xe=n?Ne:24,be=n?void 0:_t;let H;e[30]!==xe||e[31]!==be?(H={width:xe,scale:be},e[30]=xe,e[31]=be,e[32]=H):H=e[32];const Ce=n?void 0:xt;let V;e[33]!==Ce||e[34]!==M?(V={width:M,scale:Ce},e[33]=Ce,e[34]=M,e[35]=V):V=e[35];const ge=n?void 0:bt,Te=n?Ne:24;let z;e[36]!==n?(z=n?0:[1,1,0],e[36]=n,e[37]=z):z=e[37];let G;e[38]!==ge||e[39]!==Te||e[40]!==z?(G={filter:"blur(16px)",scale:ge,width:Te,opacity:z},e[38]=ge,e[39]=Te,e[40]=z,e[41]=G):G=e[41];const we=n?.14:0;let le;e[42]===Symbol.for("react.memo_cache_sentinel")?(le={type:"tween",duration:.2},e[42]=le):le=e[42];let ie;e[43]===Symbol.for("react.memo_cache_sentinel")?(ie=[0,.95,1],e[43]=ie):ie=e[43];let ae;e[44]===Symbol.for("react.memo_cache_sentinel")?(ae={type:"tween",times:ie},e[44]=ae):ae=e[44];let K;e[45]!==we?(K={type:"spring",bounce:we,duration:.28,scale:le,opacity:ae},e[45]=we,e[46]=K):K=e[46];let F;e[47]!==T?(F={transformOrigin:T},e[47]=T,e[48]=F):F=e[48];let ce;e[49]===Symbol.for("react.memo_cache_sentinel")?(ce=i.jsx(Q.div,{className:"absolute inset-0 z-[-1] bg-gray-50/75 backdrop-blur-3xl backdrop-saturate-25 dark:bg-gray-700/75",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.2}}),e[49]=ce):ce=e[49];let ue,fe;e[50]===Symbol.for("react.memo_cache_sentinel")?(ue=(v,w)=>{const{rowHeight:A}=w;te(Math.floor(v/A)<=1)},fe=v=>{const{target:w}=v,{value:A}=w;return P(A)},e[50]=ue,e[51]=fe):(ue=e[50],fe=e[51]);let X;e[52]!==k||e[53]!==D||e[54]!==u||e[55]!==p?(X=i.jsx(ht,{"aria-placeholder":p,value:u,className:"text-token-text-primary placeholder:text-token-text-secondary w-full resize-none border-0 bg-transparent px-1 py-0 pe-2 outline-0 focus:ring-0 focus-visible:ring-0",autoFocus:!0,maxRows:4,onBlur:k,onHeightChange:ue,onChange:fe,onKeyDown:D}),e[52]=k,e[53]=D,e[54]=u,e[55]=p,e[56]=X):X=e[56];let U;e[57]!==u||e[58]!==p?(U=!u&&i.jsx("span",{"aria-hidden":!0,className:"text-token-text-secondary absolute inline-block ps-1 text-nowrap",children:p}),e[57]=u,e[58]=p,e[59]=U):U=e[59];const Le=!x;let W;e[60]!==Le?(W=ee("-me-1.5 h-6 w-6 rounded-full bg-black text-center dark:bg-white",{"self-end":Le}),e[60]=Le,e[61]=W):W=e[61];let me,pe,de,he;e[62]===Symbol.for("react.memo_cache_sentinel")?(me={opacity:0},pe={opacity:1},de={opacity:0},he={type:"tween",duration:.1},e[62]=me,e[63]=pe,e[64]=de,e[65]=he):(me=e[62],pe=e[63],de=e[64],he=e[65]);let Z;e[66]!==b?(Z=v=>b(v),e[66]=b,e[67]=Z):Z=e[67];let Ee;e[68]===Symbol.for("react.memo_cache_sentinel")?(Ee=i.jsx(vt,{className:"h-6 w-6 text-white dark:text-black"}),e[68]=Ee):Ee=e[68];let $;e[69]!==W||e[70]!==Z?($=i.jsx(Q.button,{className:W,initial:me,animate:pe,exit:de,transition:he,onMouseDown:Z,children:Ee}),e[69]=W,e[70]=Z,e[71]=$):$=e[71];let J;e[72]!==X||e[73]!==U||e[74]!==$?(J=i.jsxs(Q.div,{className:"bg-token-main-surface-primary relative z-0 flex w-full items-center px-4 py-2.5",children:[ce,X,U,$]}),e[72]=X,e[73]=U,e[74]=$,e[75]=J):J=e[75];let Y;e[76]!==B||e[77]!==H||e[78]!==V||e[79]!==G||e[80]!==K||e[81]!==F||e[82]!==J?(Y=i.jsx(Q.div,{className:B,initial:H,animate:V,exit:G,transition:K,style:F,children:J}),e[76]=B,e[77]=H,e[78]=V,e[79]=G,e[80]=K,e[81]=F,e[82]=J,e[83]=Y):Y=e[83];let ye;return e[84]!==j||e[85]!==O||e[86]!==Y||e[87]!==R?(ye=i.jsx(Q.div,{ref:R,className:oe,style:j,transition:se,initial:ne,animate:O,exit:re,children:Y}),e[84]=j,e[85]=O,e[86]=Y,e[87]=R,e[88]=ye):ye=e[88],ye},Ht=(t,e)=>{if((e==null?void 0:e.type)!==Se.SELECTION)return null;try{const{from:o,to:l}=e,{top:s}=t.dom.getBoundingClientRect(),{bottom:f,top:h}=Re(t,o),{bottom:E}=Re(t,l),n=Fe(t)?-30:-24;let a=f-s+n;const _=h-s;return a=E-s+8,{composerTop:a,loadingTop:_}}catch(o){return ve.logError("Invalid position in SelectionCommentComposer",o),null}},gt=({toolbarPosition:t,composerRect:e,view:o})=>{const{width:l}=e;let{height:s}=e;if(s||(s=We),o==null||t==null)return null;const{right:f,left:h}=o.dom.getBoundingClientRect(),{left:E,top:n,aboveOrBelow:a,toolbarSize:_}=t,S=n-(a===Ue.ABOVE&&s!==0?s-_.height:0),c=dt(o)?12:0;return{left:Math.min(E,f-h-l-c),composerTop:S,aboveOrBelow:a}},Tt=({toolbarPosition:t,commentingOn:e,isWaitingForCommentResponse:o=!1,onAddComment:l})=>{const s=pt()(),[f,h]=Ke(),E=gt({view:s,toolbarPosition:t,composerRect:f});if(s==null||E==null)return null;const{left:n,composerTop:a}=E,_=(S,c)=>{if((e==null?void 0:e.type)!==Se.SELECTION)return;const{action:q,sourceRange:L}=e;l==null||l(S,c,q,L,e.type)};return i.jsx(ct,{children:(e==null?void 0:e.type)===Se.SELECTION&&!o&&i.jsx("div",{className:ee("absolute",De.commentComposer),style:{left:n,top:a},children:i.jsx(Ct,{opensOverDocument:!0,onClose:S=>{var c;S||(He.cancelCommentingOn(),s&&Fe(s)&&!s.state.selection.empty&&s.dispatch(s.state.tr.setSelection(new ut(s.state.selection.$from))),(c=document.getSelection())==null||c.removeAllRanges())},onSubmit:_,ref:h})},"composer")})},wt=ze(()=>Oe(()=>import("./oxnkxgnxllf109os.js"),__vite__mapDeps([5,1])),{loading:t=>Ge(t)}),Lt=({isSendDisabled:t=!1,getSelectionRange:e})=>{const o=Be(),l=()=>{Xe(e)};return i.jsx(Ve.Action,{isDisabled:t,label:o.formatMessage({id:"wOaJUU",defaultMessage:"Ask ChatGPT"}),onClick:l,icon:wt})},Vt=({getEditorDom:t,getToolbarPosition:e,getSelectionRange:o,toolbarType:l,children:s,onAddComment:f,isWaitingForCommentResponse:h=!1,isSendDisabled:E=!1,showAskChatGPT:n=!0,fixToolbarPositionOnInteraction:a=!1,savedSelection:_=!1,toolbarContentRef:S,setIsToolbarOpen:c,forceClose:q=!1})=>{const[{height:L,width:u},P]=Ke(),[x,te]=d.useState(!0),[g,k]=d.useState(!1),[I,b]=d.useState(!0),y=t(),M=nt(({commentingOn:r})=>r),[m,T]=d.useState(null);yt(y,o,E);const C=d.useCallback(()=>{const r=t(),p=document.getSelection();return!p||p.type!=="Range"||p.isCollapsed||!(r!=null&&r.contains(p.anchorNode))},[t]);d.useEffect(()=>{const r=ft(()=>{k(!0)},200,{leading:!0}),p=()=>{r.cancel(),k(!1)};return y==null||y.addEventListener("pointerdown",r,{passive:!0}),document.addEventListener("pointerup",p,{passive:!0}),()=>{y==null||y.removeEventListener("pointerdown",r),document.removeEventListener("pointerup",p)}},[y]),d.useEffect(()=>{if(g){b(!1);return}const r=setTimeout(()=>b(!0),100);return()=>{clearTimeout(r)}},[g]),d.useEffect(()=>{const r=()=>{te(C())};return document.addEventListener("selectionchange",r,{passive:!0}),()=>{document.removeEventListener("selectionchange",r)}},[C]),mt(()=>{if(x||C())return te(!0);try{const r=e({width:u,height:L});r!=null&&!a&&T(r)}catch(r){ve.logError("Invalid position in getToolbarPosition",r)}},[L,u,x,C,e,a]);const N=i.jsxs(Ve,{toolbarType:l,children:[n&&i.jsx(Lt,{isSendDisabled:E,getSelectionRange:o}),s]}),D=!q&&(!x||_)&&!M&&m!=null&&I;return d.useEffect(()=>{c==null||c(D)},[D,c]),i.jsxs(i.Fragment,{children:[i.jsx("div",{"aria-hidden":"true",className:"pointer-events-none invisible fixed start-0 top-0 h-0 overflow-clip",children:i.jsx("div",{ref:P,children:N})}),D&&i.jsx("div",{style:{top:m.top,left:m.left},className:ee("absolute",De.toolbar,g?"pointer-events-none":"pointer-events-auto"),ref:S,children:N}),i.jsx(Tt,{toolbarPosition:m,commentingOn:M,isWaitingForCommentResponse:h,onAddComment:f})]})};export{Ue as A,Ct as C,Vt as T,Re as c,Ht as g};
//# sourceMappingURL=nvbtsxz152qyrww5.js.map

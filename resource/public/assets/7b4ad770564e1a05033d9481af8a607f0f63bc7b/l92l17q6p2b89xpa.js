const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/c38q3o8c9sxr04er.js","assets/kfrdmkli83ureki3.js","assets/kmjljr0f5g55xi5s.js","assets/duz09euqvesjqb1t.js","assets/fyw02vlaiv2vq6cj.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/hdrss3fwjz1zjmw7.js","assets/m6idklazvjc7d344.js","assets/hnxmt79i260xx1a3.js","assets/ywxlziofi4jg74sa.js","assets/gz2kraed79kezjd0.js","assets/kf7tqzde2yk57qjr.js","assets/dnv6hspqfrgw4och.js","assets/kcwv15xxjkwkz15c.js","assets/h48j4g76f726xzx4.js","assets/lpy0q055i382xanc.js","assets/mauhe4xggt6ulnl1.js","assets/bonby2i4xf93dev1.js","assets/j4p4w74o1oeu6aq1.js","assets/cus6e9b5l060ctey.js","assets/ffrotvb922yxp30i.js","assets/nlj7ey81i8rm36n9.js","assets/if8tezek9xcjkt0r.js","assets/eblm0a618bl6wf18.js","assets/ip1a99ta06lqiwzj.js","assets/k4byn8m0gei390jf.js","assets/ht149o3c8qgexr92.js","assets/decxj0nfuivtbs7k.js","assets/ejd4bb0myatokvzs.js","assets/l2dc1a6f6pz6h0zz.js","assets/ztysthz0x5np2s72.js","assets/d1v5eq12z2rar6o7.js","assets/naoaa24cgmdbcxxy.js","assets/glgf3sl2j4mvtn59.js","assets/b1ysmkfbechoun0g.js","assets/dpf52wv18uwxh9t9.js","assets/ohnma74ezw59jlv8.js","assets/oiijv6l0h3xmsh54.js","assets/hgrkp82vl7wpvpuw.js","assets/gljkwjomy29v9c26.js","assets/oafyrulh7bq2qerb.js","assets/f9iz92mggx1znv92.js","assets/lfpgz10qy2vdux3v.js","assets/e2qiox9wm3uaxg29.js","assets/bdqubk4ywd0en7sc.js","assets/ci7lhbgv3s1kfbx6.js","assets/kbj1b07s2z6vxqkg.js","assets/hu1bt0oauegdhua6.js","assets/h1em0bjkpkjv8ykw.js","assets/i7t1qh3u8s8bvtb8.js","assets/gy1lpvuoewmzh42c.js","assets/dm8z7bzkrzic0zmg.js","assets/mgt4kmm4im6a7le7.js","assets/ipjj058rvhjq2uu2.js","assets/esgn9c4esm3mlqc4.js","assets/ab1440qk9vnud23e.js","assets/mer2el06ski1l09m.js","assets/m3joncw451cqbul2.js","assets/lep2wptoy14cfe2w.js","assets/ehyvmdoziyg4axk8.js","assets/hoo89wr86agqpm13.js","assets/ejjzjfpdlx2v908r.js","assets/i8e4tsbcdrbcc668.js","assets/b4dmcdh59zl3olaw.js","assets/product-variants-gcznzbx5.css","assets/fey3pq4cxpkljcdg.js","assets/dd8hh2tmra1psngf.js","assets/f9w7j5yxpj8jmmro.js","assets/iiok29s29bpdre61.js","assets/aiiufwic7bdf3k4b.js","assets/giwakgarsud1rsxv.js","assets/nc8gen230lb13csi.js","assets/goxcf7vc701q04ob.js","assets/oyvo09ze11a90qsd.js","assets/zmq298rl93f7s2hn.js","assets/fux1oumbpb3w9e7e.js","assets/mo4f6niq6474ip4n.js","assets/ny16i6vydtz4gnvl.js","assets/i6j31imn3cki69v8.js","assets/lrftmyomhnslqldf.js","assets/dn55ejno9ewvlhxs.js","assets/pd4wtm7wtmrmmmqr.js","assets/pbjg7z6w7wj6b69y.js","assets/ansi-1f6vhsjh.css","assets/ccwkzjxugf5q7bsx.js","assets/bp7aioeryj7wbfac.js","assets/c80q12olrn2ogvv0.js","assets/glg11vispnpcyq1s.js","assets/hzx9fvhly6v2qmjm.js","assets/jnr2ibp3zs9z7xhs.js","assets/hytzro4etxb8j4b5.js","assets/e7j9ia0bu5w3396k.js","assets/fx4g5niv8hgtkxju.js","assets/jhvofh4m5uva5wy3.js","assets/nvbtsxz152qyrww5.js","assets/ce3hgmw4iyyhicud.js","assets/me479l0dlgxhtxr0.js","assets/edhlcmww46h398kf.js","assets/de3ceoxcpky3ng0s.js","assets/cjv4tm2buxt5byw3.js","assets/gf4c0f98pdaqc94a.js","assets/idxukd613qgy7urm.js","assets/ft1wtuo4ibr3do9l.js","assets/fxythiulbb2q3qno.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/writing-block-focused-view-jhg5bjd7.css","assets/krqkx98dtny8rc4e.js","assets/hdkg0cys1b7b4f0v.js","assets/b9tsn3f51rdwvzaj.js","assets/lsiyzz89iotypx8y.js","assets/fnm17yfijbvphy5g.js","assets/h5lqaaue6r5l2022.js","assets/ol9d5wxhynx9q2is.js","assets/lwq1uhykon6kdpgz.js","assets/fna9z31n721lpf9f.js","assets/table-components-iztk4amh.css"])))=>i.map(i=>d[i]);
var Qs=Object.freeze,tn=Object.defineProperty,Ir=Object.defineProperties;var Ar=Object.getOwnPropertyDescriptors;var wt=Object.getOwnPropertySymbols;var sn=Object.prototype.hasOwnProperty,nn=Object.prototype.propertyIsEnumerable;var ss=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t);var en=(t,e,s)=>e in t?tn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,D=(t,e)=>{for(var s in e||(e={}))sn.call(e,s)&&en(t,s,e[s]);if(wt)for(var s of wt(e))nn.call(e,s)&&en(t,s,e[s]);return t},U=(t,e)=>Ir(t,Ar(e));var on=t=>typeof t=="symbol"?t:t+"",Te=(t,e)=>{var s={};for(var n in t)sn.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&wt)for(var n of wt(t))e.indexOf(n)<0&&nn.call(t,n)&&(s[n]=t[n]);return s};var jt=(t,e)=>Qs(tn(t,"raw",{value:Qs(e||t.slice())}));var kt=function(t,e){this[0]=t,this[1]=e},rn=(t,e,s)=>{var n=(i,l,c,d)=>{try{var u=s[i](l),m=(l=u.value)instanceof kt,h=u.done;Promise.resolve(m?l[0]:l).then(x=>m?n(i==="return"?i:"next",l[1]?{done:x.done,value:x.value}:x,c,d):c({value:x,done:h})).catch(x=>n("throw",x,c,d))}catch(x){d(x)}},r=i=>a[i]=l=>new Promise((c,d)=>n(i,l,c,d)),a={};return s=s.apply(t,e),a[ss("asyncIterator")]=()=>a,r("next"),r("throw"),r("return"),a};var ns=(t,e,s)=>(e=t[ss("asyncIterator")])?e.call(t):(t=t[ss("iterator")](),e={},s=(n,r)=>(r=t[n])&&(e[n]=a=>new Promise((i,l,c)=>(a=r.call(t,a),c=a.done,Promise.resolve(a.value).then(d=>i({value:d,done:c}),l)))),s("next"),s("return"),e);import{j as o,_ as X,M as H,h as le,r as p,v as Lr,c as he,i as Rr,l as mt,d as Dr,w as Fr,b as Or,g as zr,n as Ps,R as yo,e as Is}from"./kfrdmkli83ureki3.js";import{M as Wr,u as bs,R as _s,c as vs,S as ws,m as Hr,d as Br,I as Vr,e as Ur,C as qr,f as Gr,g as Xr,h as Zr,i as Yr}from"./e2qiox9wm3uaxg29.js";import{az as Z,aA as Q,cy as A,y2 as Kr,P as Bt,M as Vt,aw as Jr,e6 as yt,u as xe,p as Ut,J as Se,b7 as As,pm as Qr,e3 as ea,bd as ta,D as qt,c7 as sa,b9 as na,a6 as an,d as Ve,bE as bo,e as oa,aP as _o,au as vo,eE as ra,aB as Pe,db as qe,dB as aa,dt as ia,du as la,dR as at,cq as Ls,jT as ca,jB as da,rq as ua,co as Rs,dm as wo,dn as jo,dr as ko,lr as Lt,hq as Co,cu as So,lT as ma,dM as fa,cs as bt,bp as We,hT as Gt,gA as No,z as Xt,aa as Mo,hI as Qe,l7 as ha,R as pa,A as ga,y3 as xa,hH as ya,gE as ba,jv as _a,jg as os,d_ as js,ed as Eo,dP as Zt,L as va,fM as wa,V as Ye,hN as ja,ia as ka,_ as Tt,gX as Ca,hg as Sa,ih as Na,dQ as Ma,W as Ea,pU as ut,ej as To,aN as $o,n2 as Ta,i6 as $a,cv as Po,e7 as Pa,y4 as Ia,fd as Aa,eG as La,bx as Ra,eZ as Da,ku as Fa,f9 as Io,ay as Oa,cr as rs,O as ln,nO as za,aT as Wa,$ as Ha,a0 as Ba}from"./kw08ajijqinojrwh.js";import{u as Va,g as Ua,s as as,F as Ue,C as qa,I as Ga,P as Xa,a as Za,b as Ya,c as Ka,d as Ja}from"./ehyvmdoziyg4axk8.js";import{yR as Qa,yS as Ao,gL as Lo,ak as ei,al as Ro,p5 as ti,dh as si,ds as ni,cL as Ds,fc as Ke,fa as oi,cd as ri,lJ as ai,hb as Fs,hc as Os,B as zs,E as Ws,qF as ii,cw as Do,gh as li,gg as ci,lX as Je,cx as Hs,yT as Yt,qJ as Fo,yU as Oo,yV as zo,yW as Wo,yX as di,ct as Kt,c7 as $t,lI as ui,S as mi,bL as fi,Q as _t,ms as Ho,lR as hi,yY as pi,nx as gi,gU as xi,lV as Bo,bP as yi,mg as bi,yZ as _i,ng as vi,y_ as Vo,ac as Uo,y$ as wi,z0 as ji,nj as ki,e1 as Ci,cG as Si,cB as Ni,z1 as qo,a$ as Ee,z2 as Mi,ab as Ei,j5 as Ti,jY as Ct,h9 as $i,gb as Pi,z3 as Ii,z4 as Ai,x7 as Li}from"./fyw02vlaiv2vq6cj.js";import{u as Bs}from"./fey3pq4cxpkljcdg.js";import{N as Ri}from"./dd8hh2tmra1psngf.js";import{g as cn,F as Di,i as Fi}from"./f9w7j5yxpj8jmmro.js";import{v as Oi,u as zi,P as Wi,W as Hi}from"./gz2kraed79kezjd0.js";import{L as Bi}from"./iiok29s29bpdre61.js";import{b as Vi,C as Ui}from"./bdqubk4ywd0en7sc.js";import{a as qi}from"./aiiufwic7bdf3k4b.js";import{A as Pt,g as Gi,c as Xi,b as ks,o as Zi,I as Go,D as Yi,d as Ki}from"./ci7lhbgv3s1kfbx6.js";import{u as Ji}from"./lfpgz10qy2vdux3v.js";import{W as Qi,c as el,b as tl,a as sl}from"./mgt4kmm4im6a7le7.js";import{W as Jt}from"./giwakgarsud1rsxv.js";import{W as nl}from"./nc8gen230lb13csi.js";import{W as dn,i as ol}from"./goxcf7vc701q04ob.js";import{u as rl}from"./pd4wtm7wtmrmmmqr.js";import{k as al,A as il,W as ll,m as cl}from"./oyvo09ze11a90qsd.js";import{A as dl}from"./pbjg7z6w7wj6b69y.js";import{a as ul,d as Xo,e as is,f as Zo,E as un,g as Yo,b as Ko,c as Jo,h as Cs,u as ml,W as mn,p as fl}from"./ccwkzjxugf5q7bsx.js";import{u as Vs}from"./krqkx98dtny8rc4e.js";import{n as hl,p as pl,w as gl}from"./hdkg0cys1b7b4f0v.js";import{M as Us}from"./m3joncw451cqbul2.js";import{a as xl,b as yl}from"./b9tsn3f51rdwvzaj.js";import{g as bl,b as _l,a as vl,c as wl,F as jl,d as kl}from"./hgrkp82vl7wpvpuw.js";import{v as fn,C as Cl,A as Sl,h as Nl,j as Ml,f as El,p as Tl,k as $l,n as Pl,P as Il,o as Al,q as Ll,L as Rl}from"./lsiyzz89iotypx8y.js";import{u as ft,t as hn,r as Ss,g as ze}from"./fnm17yfijbvphy5g.js";import{c as Qo}from"./h5lqaaue6r5l2022.js";import{a as Dl,T as Fl}from"./lwq1uhykon6kdpgz.js";const Ol=Qo("ChevronDownFilled","1em",["M15.8 7.73c.28.3.27.78-.03 1.06l-5.25 5a.75.75 0 0 1-1.04 0l-5.25-5a.75.75 0 0 1 1.04-1.08L10 12.2l4.73-4.5a.75.75 0 0 1 1.06.02Z"]),zl=Qo("ChevronLeftFilled","1em",["M12.27 15.8a.75.75 0 0 1-1.06-.03l-5-5.25a.75.75 0 0 1 0-1.04l5-5.25a.75.75 0 1 1 1.08 1.04L7.8 10l4.5 4.73c.29.3.28.78-.02 1.06Z"]);function Wl(){var t=hl(arguments),e=t.text,s=t.options,n=t.metadata;return pl(e,s,n)}function Hl(){return gl(Wl,arguments)}const Bl=Z(()=>X(()=>import("./c38q3o8c9sxr04er.js"),__vite__mapDeps([0,1])),{loading:t=>Q(t)});function Vl(s){var n=s,{children:t}=n,e=Te(n,["children"]);return o.jsxs(Wr,U(D({},e),{className:"decorated-link",children:[t,o.jsx("span",{"aria-hidden":!0,className:"ms-0.5 inline-block align-middle leading-none",children:o.jsx(Bl,{className:"block h-[0.75em] w-[0.75em] stroke-current stroke-[0.75]"})})]}))}const pn=({children:t,"data-start":e=null,"data-end":s=null,"data-is-last-node":n,"data-is-only-node":r,tag:a})=>{const{animationTiming:i,shouldAnimate:l,shouldHide:c,isDisabled:d,onComplete:u,onReady:m}=Va({isMarker:!0,tag:a,children:t,start:e,end:s,isLastNode:n,isOnlyNode:r});return d||c?o.jsx(a,{"data-start":e,"data-end":s,className:A(c&&"hidden"),children:t}):o.jsx(a,{"data-start":e,"data-end":s,className:A(as.marker,l?as.animate:as.hidden),onAnimationStart:()=>m(0),onAnimationEnd:()=>u(0),style:Ua(i),children:t})},Ul={p:t=>o.jsx(Ue,D({tag:"p"},t)),h1:t=>o.jsx(Ue,D({tag:"h1"},t)),h2:t=>o.jsx(Ue,D({tag:"h2"},t)),h3:t=>o.jsx(Ue,D({tag:"h3"},t)),h4:t=>o.jsx(Ue,D({tag:"h4"},t)),h5:t=>o.jsx(Ue,D({tag:"h5"},t)),h6:t=>o.jsx(Ue,D({tag:"h6"},t)),li:t=>o.jsx(pn,D({tag:"li",isListItem:!0},t)),hr:t=>o.jsx(pn,D({tag:"hr"},t))};function ql(t){const e=t.split("\n");Xl(e);const s=e.pop();if(s===":"||s==="::")e.push("");else{const n=Gl(s).trimEnd();n&&e.push(n)}return e.join("\n")}function Gl(t){if(!t||/^\s*-\s*([*_]+)?\s*$/.test(t))return"";const e=[];let s="",n=0;for(;n<t.length;){if(t[n]==="*"&&t[n+1]==="*"){s+="**",e.length&&e[e.length-1]==="**"?e.pop():e.push("**"),n+=2;continue}if(t[n]==="*"||t[n]==="_"){s+=t[n];const a=t[n];e.length&&e[e.length-1]===a?e.pop():e.push(a),n++;continue}if(t[n]==="["){const a=t[n];s+=a,e.push(a),n++;continue}if(t[n]==="]"){const a=t[n];s+=a,e.length&&e[e.length-1]==="["&&e.pop(),n++;continue}if(t[n]==="("&&t[n-1]==="]"){const a=t[n];s+=a,e.push(a),n++;continue}if(t[n]===")"){const a=t[n];s+=a,e.length&&e[e.length-1]==="("&&e.pop(),n++;continue}s+=t[n],n++}if(e.length===0)return t;let r=s.trimEnd();for(;e.length;){const a=e.pop();if(a==null)break;a==="("?r+=")":r.endsWith(a)?r=r.slice(0,-a.length).trimEnd():a==="["?r+="]()":r+=a}return r}function Xl(t){let e=!1,s=null;for(let n=0;n<t.length;n++){const r=t[n],a=Qa(r);if(a){const l=a.info.trimStart(),c=a.info.trim();if(e)s&&a.marker===s.marker&&a.fence.length===s.fence.length&&c.length===0&&(s=null);else if(l.startsWith("{")){const d=Ql(t,n,a);t[n]=d.normalizedLine,(d.linesConsumed>0||d.replacementLines.length)&&t.splice(n+1,d.linesConsumed,...d.replacementLines),s=a}else if(c.length===0&&n===t.length-1){t[n]="";continue}e=!e;continue}if(e){s&&nc(r,s)&&(t[n]="".concat(s.leadingWhitespace).concat(s.fence),s=null,e=!1);continue}const i=r.trim();if(i.startsWith(":::")&&i!==":::"){const l=i.indexOf("{");if(l===-1){const c=i.slice(3).trim();if(c.length>0&&!(c in Kr)){t[n]=":::";continue}const d=r.replace(/\s+$/,"");t[n]=d+"{}";continue}Yl(i,l)||(t[n]=Zl(r,r.indexOf("{")))}t.length>1&&t[t.length-1]===":::"&&t[t.length-2]===":::"&&t.splice(-2)}s&&(t.push("".concat(s.leadingWhitespace).concat(s.fence)),s=null)}function Zl(t,e){const s=t.replace(/\s+$/,""),n=s.slice(0,e).replace(/\s+$/,""),r=s.slice(e+1);if(r.trim().length===0||!/=/.test(r))return n+"{}";let i=null,l=!1;for(let c=0;c<r.length;c++){const d=r[c];if(l){l=!1;continue}if(d==="\\"){l=!0;continue}if(i){d===i&&(i=null);continue}if(d==='"'||d==="'"){i=d;continue}}return i?s+i+"}":/=[\s]*$/.test(r)?s+'""}':s+"}"}function Yl(t,e){let s=null,n=0,r=!1;for(let a=e;a<t.length;a++){const i=t[a];if(r){r=!1;continue}if(i==="\\"){r=!0;continue}if(s){i===s&&(s=null);continue}if(i==='"'||i==="'"){s=i;continue}if(i==="{"){n++;continue}if(i==="}"){if(n--,n===0)return!0;continue}}return!1}function Kl(t){const e=t.match(/^\s*/),s=e?e[0]:"",n=t.slice(s.length);if(!n.startsWith("{"))return"".concat(s,"{}");let r;try{const[l]=Ao(n,!0);r=l}catch(l){return"".concat(s,"{}")}const a=er(r);if(!a)return"".concat(s,"{}");const i=JSON.stringify(a);return"".concat(s).concat(i)}function er(t){if(!(!t||Array.isArray(t)||typeof t!="object"))return t}const Jl=4,tr=2048;function Ql(t,e,s){var d,u;const n=s.leadingWhitespace.length+s.fence.length;let a=(u=(d=t[e])==null?void 0:d.slice(n))!=null?u:"",i=0,l=gn(a);if(l.kind==="complete")return{normalizedLine:xn(s,l.value),linesConsumed:0,replacementLines:yn(l.remainder)};for(;l.kind==="needsMore"&&i<Jl&&a.length<tr;){const m=e+i+1;if(m>=t.length)break;const h=t[m];if(!tc(h))break;if(i++,a="".concat(a,"\n").concat(h!=null?h:""),l=gn(a),l.kind==="complete")return{normalizedLine:xn(s,l.value),linesConsumed:i,replacementLines:yn(l.remainder)};if(l.kind==="invalid")break}return{normalizedLine:ec(s,a),linesConsumed:i,replacementLines:[]}}function gn(t){if(!t)return{kind:"invalid"};const e=t.indexOf("{");if(e===-1)return{kind:"invalid"};const s=t.slice(e),n=sc(s);if(n==null)return t.length>=tr?{kind:"invalid"}:{kind:"needsMore"};const r=s.slice(0,n+1);try{const[a,i]=Ao(r.trim()),l=er(a);if(!l)return{kind:"invalid"};if(i!=null)return{kind:"needsMore"};const c=s.slice(n+1);return{kind:"complete",value:l,remainder:c}}catch(a){return{kind:"invalid"}}}function xn(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence);return"".concat(s).concat(JSON.stringify(e))}function ec(t,e){const s="".concat(t.leadingWhitespace).concat(t.fence),n=Kl(e.replace(/\r?\n+/g," ").trimStart()).trim();return n.length===0?"".concat(s,"{}"):"".concat(s).concat(n)}function tc(t){if(!t)return!1;const e=t.trimStart();if(e.length===0)return!0;const s=e[0];return s==='"'||s==="'"||s==="{"||s==="}"||s==="["||s===","}function sc(t){let e=!1,s=0,n=!1,r=!1;for(let a=0;a<t.length;a++){const i=t[a];if(!e){i==="{"&&(e=!0,s=1);continue}if(r){r=!1;continue}if(i==="\\"){r=!0;continue}if(n){i==='"'&&(n=!1);continue}if(i==='"'){n=!0;continue}if(i==="{"){s++;continue}if(i==="}"){if(s--,s===0)return a;continue}}return null}function yn(t){if(!t)return[];const e=t.startsWith("\n")?t.slice(1):t;return e.length===0?[]:e.split("\n")}function nc(t,e){const s=t.trim();return s.length===0||!oc(s,e.marker)?!1:s.length<e.fence.length}function oc(t,e){for(let s=0;s<t.length;s++)if(t[s]!==e)return!1;return!0}const rc=Z(()=>X(()=>import("./kmjljr0f5g55xi5s.js"),__vite__mapDeps([2,1])),{loading:t=>Q(t)});function ac({citation:t}){return o.jsx(Lo,{side:"top",triggerButton:o.jsx("span",{className:"inline-flex items-center font-bold",children:o.jsx(H,{id:"ZNWtPG",defaultMessage:"{startChar}clipboard {icon}{endChar}",values:{startChar:"「",icon:o.jsx(rc,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:o.jsxs("div",{className:"flex flex-col items-stretch gap-1",children:[o.jsx("div",{className:"flex justify-end border-b",children:o.jsx(ei,{onCopy:e=>Ro(t.text,void 0,e),buttonText:!0,textPosition:"left"})}),o.jsx("div",{children:t.text})]})})}const ic=Z(()=>X(()=>import("./duz09euqvesjqb1t.js"),__vite__mapDeps([3,1])),{loading:t=>Q(t)});function lc({citation:t,conversation:e,nodeType:s}){const n=le(),r=Bt(e.id),a=ti(t.screenshot_asset_pointer,r);return s==="containerDirective"&&n.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"}),o.jsx(Lo,{side:"top",triggerButton:o.jsx("span",{className:"inline-flex items-center font-bold",children:o.jsx(H,{id:"qUxKU1",defaultMessage:"{startChar}screenshot {icon}{endChar}",values:{startChar:"「",icon:o.jsx(ic,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:a?o.jsx("img",{className:"w-xl max-w-screen",src:a,alt:n.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"})}):o.jsx("div",{className:"text-sm",children:o.jsx(H,{id:"BUdJTR",defaultMessage:"Screenshot not available"})})})}const cc=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zi),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function sr({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r,isStandaloneAttachment:a}){const i=Bt(t.id),l=Vt(t.id,v=>{var w;return e?(w=v==null?void 0:v.tree.getNodeIfExists(e))==null?void 0:w.message:void 0}),c=p.useMemo(()=>{var j;if(!l)return null;const v={content_type:Jr.Text,parts:["{{file:".concat(s,"}}")]},w=U(D({},l==null?void 0:l.metadata),{is_synthetic_share_message:!0,is_standalone_share_attachment:a});return w.content_references=(j=r==null?void 0:r.displayedContentReferences.filter(C=>C.type!=="debug"))!=null?j:[],w.citations=[],r&&(v.parts=[r.rawText],w.n7jupd_crefs=r.n7jupdCrefs),U(D({},l),{id:Lr(),content:v,metadata:w})},[l,s,r,a]),d=p.useMemo(()=>{if(!(!l||!c||!i))return{previewMessage:c,clientThreadId:t.id,fileId:s,messageId:l.id,serverThreadId:i,isStandaloneAttachment:a,fileName:n}},[c,t.id,s,l,i,a,n]),u=si({odysseyShareIntent:d,clientThreadId:t.id}),[m,h]=p.useState(!1);return{onClick:p.useCallback(async()=>{h(!0),await u(),h(!1)},[h,u]),isLoading:m,isEnabled:!!d}}function dc({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r}){const a=le(),{onClick:i,isLoading:l,isEnabled:c}=sr({conversation:t,messageId:e,fileId:s,fileName:n,processedMarkdownInfo:r,isStandaloneAttachment:!1});return c?o.jsx(ni,{onClick:i,label:a.formatMessage({id:"ConversationTurn.sharePostButtonTooltip",defaultMessage:"Share"}),icon:l?yt:cc}):null}function uc(t){return t.endsWith(".md")}const mc=({citation:t,conversation:e,messageId:s})=>{const n=xe(),[r,a]=p.useState(!1),i=Bt(e.id),l=Ut(),[c,d]=p.useState(null),u=p.useRef(null),m=p.useCallback(k=>{l.danger(k,{toastId:"ttom_file_citation_failed_to_download_file"})},[l]),h=t.file_id,x=Se(n,"3154019201"),_=x,v=Ds(),w=Bs(!0,i,h,void 0,m),j=w==null?void 0:w.data,C=(w==null?void 0:w.isPending)||!1;p.useEffect(()=>{var k;if((j==null?void 0:j.status)==="success"&&j.download_url){(k=u.current)==null||k.abort();const S=new AbortController;u.current=S,a(!0),(async()=>{try{const N=await fetch(j.download_url,{headers:v?{}:As(),signal:S.signal});if(!N.ok)throw new Error("HTTP ".concat(N.status));d(await N.text())}catch(N){N.name!=="AbortError"&&l.danger("Failed to download file",{toastId:"ttom_file_citation_failed_to_download_file"})}finally{a(!1)}})()}return()=>{var S;(S=u.current)==null||S.abort()}},[j,l,v]);const f=p.useContext(Ke),y=p.useMemo(()=>{var F,L,T,E,z,G,B,K,te;if(c==null)return null;const S=(E=((T=(L=(F=f==null?void 0:f.message)==null?void 0:F.metadata)==null?void 0:L.content_references_by_file)!=null?T:{})[t.cite_key])!=null?E:[],N=Qr(c,S);let M=N.processedText;const $=(z=N.displayedContentReferences)!=null?z:[],b=(te=((K=(B=(G=f==null?void 0:f.message)==null?void 0:G.metadata)==null?void 0:B.n7jupd_crefs_by_file)!=null?K:{})[t.cite_key])!=null?te:[];return b.length>0&&(M=oi(M,b)),{processedText:M,displayedContentReferences:$,n7jupdCrefs:b,rawText:c}},[c,f,t.cite_key]);return C||r?o.jsx(yt,{className:"inline"}):!y||!(f!=null&&f.message)?"[Could not display report]":o.jsx(Ke.Provider,{value:U(D({},f),{contentReferences:y.displayedContentReferences,n7jupdCrefs:y.n7jupdCrefs}),children:o.jsxs("div",{className:"border-token-border-light dark:border-token-bg-tertiary @container relative mx-[-16px] mt-4 mb-4 flex cursor-text flex-col items-start overflow-hidden rounded-[14px] border px-4 pt-6 pb-6 contain-inline-size sm:mx-[-32px] sm:rounded-[28px] sm:px-8 sm:shadow-sm",children:[o.jsx("div",{className:"w-full pt-1 pb-1 sm:pt-4 sm:pb-3",children:o.jsx(ri,{conversation:e,componentOverrides:Ri,children:y.processedText})}),_&&o.jsx("div",{className:"flex",children:x&&o.jsx(dc,{conversation:e,messageId:s,fileId:h,fileName:t.file_name,processedMarkdownInfo:y,isStandaloneAttachment:!1})})]})})},bn=(t,e)=>{const s=new Bi(new URL("{{.assetPrefix}}/assets/walnut-worker-DDidQYdP.js",import.meta.url),{type:"module"});return new Promise((n,r)=>{s.onmessage=a=>{var i;s.terminate(),a.data.error?r(new Error(a.data.error)):n((i=a.data.protoBytes)!=null?i:new Uint8Array)},s.onerror=a=>{s.terminate(),r(a)},s.postMessage({bytes:t.buffer,ext:e},[t.buffer])})},fc="Walnut",hc={hash:"sha256-LqZfOaN8w1y5KOF6ytEmIdqOkXeRAKzJtivwaYHqku4=",fingerprinting:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"DocumentFormat.OpenXml.Framework.wasm","DocumentFormat.OpenXml.r766fg9imt.wasm":"DocumentFormat.OpenXml.wasm","Google.Protobuf.bvef67su4p.wasm":"Google.Protobuf.wasm","System.Collections.Concurrent.dg7gv773h7.wasm":"System.Collections.Concurrent.wasm","System.Collections.NonGeneric.xh26yzmj9q.wasm":"System.Collections.NonGeneric.wasm","System.Collections.Specialized.k9ijgfx3oq.wasm":"System.Collections.Specialized.wasm","System.Collections.e40hzefbp0.wasm":"System.Collections.wasm","System.ComponentModel.Primitives.p7eihts9gc.wasm":"System.ComponentModel.Primitives.wasm","System.ComponentModel.TypeConverter.yc3lg0zbud.wasm":"System.ComponentModel.TypeConverter.wasm","System.ComponentModel.nu6ttwym4t.wasm":"System.ComponentModel.wasm","System.Console.2u9f7xoyjt.wasm":"System.Console.wasm","System.Diagnostics.DiagnosticSource.3zzx5i2bbp.wasm":"System.Diagnostics.DiagnosticSource.wasm","System.IO.Compression.hdb1gzcatq.wasm":"System.IO.Compression.wasm","System.IO.Packaging.8th4tkd3a0.wasm":"System.IO.Packaging.wasm","System.Linq.Expressions.y2o66p61a5.wasm":"System.Linq.Expressions.wasm","System.Linq.pk029p0ix8.wasm":"System.Linq.wasm","System.Memory.pk7xw966yi.wasm":"System.Memory.wasm","System.Net.Http.ela86sx87h.wasm":"System.Net.Http.wasm","System.Net.Primitives.e24bsgwgy3.wasm":"System.Net.Primitives.wasm","System.ObjectModel.6ul5qo6tt0.wasm":"System.ObjectModel.wasm","System.Private.CoreLib.2ast54y18t.wasm":"System.Private.CoreLib.wasm","System.Private.Uri.34jz1zbpkm.wasm":"System.Private.Uri.wasm","System.Private.Xml.Linq.qo5fu6rx08.wasm":"System.Private.Xml.Linq.wasm","System.Private.Xml.jqrh4s0xni.wasm":"System.Private.Xml.wasm","System.Runtime.InteropServices.JavaScript.ptvo7oirfc.wasm":"System.Runtime.InteropServices.JavaScript.wasm","System.Security.Cryptography.yghuwbq1rf.wasm":"System.Security.Cryptography.wasm","System.Text.RegularExpressions.woo0o1jb20.wasm":"System.Text.RegularExpressions.wasm","System.8rv0tdtrxz.wasm":"System.wasm","System.Xml.Linq.fnt4rzi185.wasm":"System.Xml.Linq.wasm","Walnut.0vgw8eoql2.wasm":"Walnut.wasm","dotnet.native.0636i1lq9c.js":"dotnet.native.js","dotnet.native.zzbol9rv1j.wasm":"dotnet.native.wasm","dotnet.js":"dotnet.js","dotnet.runtime.drv0pr9n5o.js":"dotnet.runtime.js","icudt_CJK.tjcz0u77k5.dat":"icudt_CJK.dat","icudt_EFIGS.tptq2av103.dat":"icudt_EFIGS.dat","icudt_no_CJK.lfu7j35m59.dat":"icudt_no_CJK.dat"},jsModuleNative:{"dotnet.native.0636i1lq9c.js":"sha256-eOSbmdfdvZnWUgf0HnOlq0pzSFy11pyE4WY5A/bXqIY="},jsModuleRuntime:{"dotnet.runtime.drv0pr9n5o.js":"sha256-yfXUv1l/B489E8p12JxUvxly0JvHL9CCsoZUDlfGH9c="},wasmNative:{"dotnet.native.zzbol9rv1j.wasm":"sha256-v7sIQgsxYlZxP1U1O8+/+QbuogAs3q+OgUmKYGQEhL8="},icu:{"icudt_CJK.tjcz0u77k5.dat":"sha256-SZLtQnRc0JkwqHab0VUVP7T3uBPSeYzxzDnpxPpUnHk=","icudt_EFIGS.tptq2av103.dat":"sha256-8fItetYY8kQ0ww6oxwTLiT3oXlBwHKumbeP2pRF4yTc=","icudt_no_CJK.lfu7j35m59.dat":"sha256-L7sV7NEYP37/Qr2FPCePo5cJqRgTXRwGHuwF5Q+0Nfs="},coreAssembly:{"System.Private.CoreLib.2ast54y18t.wasm":"sha256-aklKXz16j6YsJZ7e7Kith4Jncrh9z8KwSVqmZ9onfUc=","System.Runtime.InteropServices.JavaScript.ptvo7oirfc.wasm":"sha256-46EslAlUY8PCFPNNdxh6xyl1tMDibDGNP8Izg1454zo="},assembly:{"DocumentFormat.OpenXml.Framework.edzyb0h7ls.wasm":"sha256-kqKbud4eaFNkjKW0OqLAmn6WKvayLb00uusbPCIHELQ=","DocumentFormat.OpenXml.r766fg9imt.wasm":"sha256-CdxuDQwg/TCEGCjgMmTFDI1VqSvhCPjufTf6E34sRcc=","Google.Protobuf.bvef67su4p.wasm":"sha256-+YTHK5iMJ1qqT8rwso0msRnFimxTnVn7anp423wPdM4=","System.Collections.Concurrent.dg7gv773h7.wasm":"sha256-Q0t+lcdV4fbf4dlwKQCsokiL4Xwb5/RA4PKHw0Epfy4=","System.Collections.NonGeneric.xh26yzmj9q.wasm":"sha256-JUDrn7Om1WpQQdWHTaqXKj/3EobK0GWT1k1gVLEN/DM=","System.Collections.Specialized.k9ijgfx3oq.wasm":"sha256-OF8j9PfGV75lZ7E3FyULLUIRFPJQvpkm4IPxppAWJbc=","System.Collections.e40hzefbp0.wasm":"sha256-3sUZ64D/YCJbw5WumYeKGFTRuqgQauwlXdeT6qTqnfg=","System.ComponentModel.Primitives.p7eihts9gc.wasm":"sha256-dV0r23r7Lx5OxQXMJ14aC6agLulNBGIKSruhV0rx1yk=","System.ComponentModel.TypeConverter.yc3lg0zbud.wasm":"sha256-vvvYMybVeXzv4HJqiyd7iNAPMZ1jcbplD3jR0OUpKlU=","System.ComponentModel.nu6ttwym4t.wasm":"sha256-EdstTP9IiGWSnfAiUfYQU/+yVLpIFnkDsEhkbUYb1Bk=","System.Console.2u9f7xoyjt.wasm":"sha256-impSSXOvVI1OlM3VB67h2UWC8s89uwvX6Hgpj61TXr4=","System.Diagnostics.DiagnosticSource.3zzx5i2bbp.wasm":"sha256-X8GRK2kyaCYrvHDMMpZah01/45/agEOGsEGDme3FoYc=","System.IO.Compression.hdb1gzcatq.wasm":"sha256-1avnbMsYG348l6vTPbcjRPhUYpJotFC3oo4HhvAx0/U=","System.IO.Packaging.8th4tkd3a0.wasm":"sha256-1C+I5A7ESuL28X57RP+FiTL8ayuTe86SmJE6NSg4dQA=","System.Linq.Expressions.y2o66p61a5.wasm":"sha256-aim/Zu8aVv9Ks0amT1ETMHDVYou4htLWYVaiY6t6jFI=","System.Linq.pk029p0ix8.wasm":"sha256-l2OMvJ/4QA2lOgA9B5jpmCTtbi3eQCI6kzh8FtE2dRQ=","System.Memory.pk7xw966yi.wasm":"sha256-mWj1AQRTZv4MVK979XjQrZBgC+TsR5qspsObnCl0OZE=","System.Net.Http.ela86sx87h.wasm":"sha256-oq1HdWFv3md3LJ+cuYG4SvSqFkxHG9hAjiDKFOmitno=","System.Net.Primitives.e24bsgwgy3.wasm":"sha256-VsWTEOyEbltVNWebWtzswCEfVLEN7seHoNS6agRLaJw=","System.ObjectModel.6ul5qo6tt0.wasm":"sha256-Mqjt8iygUqGlnAvdiEdCvkrO/2e2oT04GXu9W3klLBw=","System.Private.Uri.34jz1zbpkm.wasm":"sha256-fbeiKtQPeS/eVZ4NLtr/UMtzpz1Qj7DWR1/jOBWoPfE=","System.Private.Xml.Linq.qo5fu6rx08.wasm":"sha256-do8HcvsRlHrzqquDkQl6MMvuTEgZIypo9T4sy8aw20Q=","System.Private.Xml.jqrh4s0xni.wasm":"sha256-VaUN8FKyCWvhqngi8AGac1fdW6tbrriW5tSxbTMpX6U=","System.Security.Cryptography.yghuwbq1rf.wasm":"sha256-8r8r+1iud18cVRj+drs6QMU+Pbi5fh3tj50AilEPWto=","System.Text.RegularExpressions.woo0o1jb20.wasm":"sha256-ANdAHV1xjhmnR3y6yA9nEMpmcfuT2mmd8oQ84iNsSd8=","System.8rv0tdtrxz.wasm":"sha256-xMF0eauQ5DkSzUozHLFFMQnL6DSJO09nJLtgag+Dzbw=","System.Xml.Linq.fnt4rzi185.wasm":"sha256-5claBNmyy8L12DFLS17Fh4SBiTjwhYts3ds7g8dX8Gc=","Walnut.0vgw8eoql2.wasm":"sha256-XB2iiH4JHEYveaOiBw5Lz1hhUTOkKGyw+VJNv+kAitM="}},pc=0,gc=!0,xc="sharded",yc={mainAssemblyName:fc,resources:hc,debugLevel:pc,linkerEnabled:gc,globalizationMode:xc};let St=null;async function bc(){const t=await Oi.withConfig(yc).withResourceLoader((s,n,r,a)=>s==="dotnetjs"?r:new URL(r,location.href).origin!==location.origin?fetch(r,{credentials:"omit",integrity:a}):r).create(),e=t.getConfig().mainAssemblyName;return e?t.getAssemblyExports(e):null}const _c=()=>(St!=null||(St=bc()),St);function vc(){"use forget";const t=he.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=_c(),t[0]=e):e=t[0],e}const wc=Z(()=>X(()=>import("./hdrss3fwjz1zjmw7.js"),__vite__mapDeps([8,1])),{loading:t=>Q(t)}),jc=Z(()=>X(()=>import("./m6idklazvjc7d344.js"),__vite__mapDeps([9,1])),{loading:t=>Q(t)}),kc=Z(()=>X(()=>import("./hnxmt79i260xx1a3.js"),__vite__mapDeps([10,1,5,6,11,12,4,7,13,14,15])).then(t=>t.WalnutMiniPlayer)),Cc=({citation:t,conversation:e,messageId:s})=>{var I,g,O,R,W;const n=vc(),[r,a]=p.useState(!1),[i,l]=p.useState(null),[c,d]=p.useState(!1),u=!!((g=(I=p.useContext(Ke))==null?void 0:I.message.metadata)!=null&&g.is_standalone_share_attachment),m=ea(),{presentationMap:h,updatePresentationMap:x,open:_}=zi(),v=xe(),w=Bt(e.id),j=Se(v,"3154019201")&&!!w,C=Se(v,"638971034"),f=ta(v,"2888003541").value,y=Number((O=f==null?void 0:f.max_bytes)!=null?O:3e7),k=Ut(),S=p.useRef(null),N=p.useCallback(V=>{k.danger(V,{toastId:"w_failed_to_download_file"})},[k]),M=!!t.file_id,$=Bs(!1,e.id,t.file_id,()=>{},N),P=(R=h[t.file_id])==null?void 0:R.presentation,b=(W=h[t.file_id])==null?void 0:W.workbook,F=p.useCallback(async V=>{if(e.id!==void 0){V.preventDefault();const{data:Y}=await $.refetch();if(Y===void 0||(Y==null?void 0:Y.status)!=="success"){k.danger("Failed to download file");return}const J=document.createElement("a");J.href=Y.download_url,J.click()}},[e.id,$,k]),{refetch:L}=$,T=Ds();p.useEffect(()=>{var Y;(Y=S.current)==null||Y.abort();const V=new AbortController;return S.current=V,a(!0),(async()=>{var de;let J=!1;try{const{data:oe}=await L();if(oe===void 0||(oe==null?void 0:oe.status)!=="success"){k.danger("Failed to download file");return}const ie=await fetch(oe.download_url,{headers:T?{}:As(),signal:V.signal});if(!ie.ok)throw new Error("HTTP ".concat(ie.status));const ee=await ie.blob();if(y!==0&&ee.size>y){d(!0),l("fileTooLarge"),J=!0;return}const ye=new Uint8Array(await ee.arrayBuffer()),ue=(de=cn(t.file_name))!=null?de:"pptx";if(ue==="pptx"){let re;if(C)re=await bn(ye,ue);else{const ne=await n;if(!ne)return;re=ne.PptxReader.ExtractSlidesProto(ye,!1)}const be=Wi.decode(re);x(t.file_id,{fileBlob:ee,fileName:t.file_name,presentation:be,workbook:null,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}else{let re;if(C)re=await bn(ye,ue);else{const ne=await n;if(!ne)return;re=ne.XlsxReader.ExtractXlsxProto(ye,!1)}const be=Hi.decode(re);x(t.file_id,{fileBlob:ee,fileName:t.file_name,presentation:null,workbook:be,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}}catch(oe){oe.name!=="AbortError"&&(d(!0),qt.addError(oe,{file_id:t.file_id}))}finally{a(!1),m&&!J&&_(t.file_id)}})(),()=>{var J;(J=S.current)==null||J.abort()}},[L,k,x,t.file_name,t.file_id,m,_,y,T,n,C]);function E(V){V.preventDefault(),_(t.file_id)}const{onClick:z,isLoading:G,isEnabled:B}=sr({conversation:e,messageId:s,fileId:t.file_id,fileName:t.file_name,processedMarkdownInfo:null,isStandaloneAttachment:!0}),K=u&&!m,te=cn(t.file_name);return o.jsxs("div",{className:A("border-token-border-light flex max-w-[calc(0.8*var(--thread-content-max-width,40rem))] flex-col overflow-hidden rounded-lg border",u&&"mx-auto my-0"),children:[o.jsxs("div",{className:"text-token-text-secondary border-token-border-light flex flex-row justify-between gap-4 border-b p-2",children:[o.jsxs("div",{className:"flex flex-row items-center gap-2 overflow-hidden",children:[o.jsx(Di,{fileName:t.file_name}),o.jsx("div",{className:"truncate text-sm font-medium",children:te==="pptx"?o.jsx(H,{id:"HTIcmf",defaultMessage:"Presentation"}):o.jsx(H,{id:"pftlup",defaultMessage:"Spreadsheet"})})]}),o.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center",children:[!K&&o.jsxs(o.Fragment,{children:[M&&o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",onClick:F,children:o.jsx(jc,{})}),o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary disabled:text-token-text-tertiary rounded-full p-1 disabled:cursor-not-allowed disabled:bg-transparent",disabled:!P&&!b,onClick:E,children:o.jsx(wc,{})})]}),j&&!!s&&B&&o.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",disabled:!B,onClick:z,children:G?o.jsx(yt,{}):o.jsx(Sc,{})})]})]}),o.jsxs("div",{className:"bg-token-bg-secondary group relative p-2",children:[o.jsx(kc,{walnutId:t.file_id,isLoading:r,isError:c,isInShareModal:K,errorMessage:i,handleDownloadClick:F}),K&&o.jsx("div",{className:"absolute end-5 top-46 z-10 inline-flex flex-shrink-0 items-end justify-end",children:o.jsx(ai,{className:A("inline h-4 w-24 text-end")})})]})]})},Sc=({className:t})=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:t,children:[o.jsx("path",{d:"M3 12.4428V12.2806C3 11.9219 3.2843 11.631 3.63497 11.631C3.98563 11.631 4.26993 11.9219 4.26993 12.2806V12.4428C4.26993 13.1372 4.2708 13.6193 4.3007 13.994C4.33 14.3609 4.38426 14.5675 4.46108 14.7218L4.52821 14.8459C4.69655 15.1266 4.93812 15.3556 5.22657 15.5061L5.35059 15.5604C5.48786 15.6107 5.6688 15.6476 5.938 15.6701C6.30417 15.7008 6.77519 15.7007 7.45408 15.7007H12.546C13.2246 15.7007 13.6959 15.7008 14.0621 15.6701C14.4204 15.6402 14.6226 15.5846 14.7735 15.5061L14.8946 15.4364C15.169 15.2642 15.3929 15.0169 15.5399 14.7218L15.593 14.595C15.6421 14.4546 15.6782 14.2692 15.7003 13.994C15.7301 13.6193 15.73 13.1372 15.73 12.4428V12.2806C15.73 11.922 16.0145 11.6312 16.3651 11.631C16.7157 11.631 17 11.9219 17 12.2806V12.4428C17 13.1158 17.0006 13.6601 16.9655 14.0999C16.9342 14.4916 16.8722 14.8443 16.7343 15.1731L16.6709 15.3123C16.4174 15.8213 16.0318 16.2469 15.5585 16.544L15.3506 16.6632C14.9909 16.8507 14.6028 16.9281 14.1655 16.9646C13.7356 17.0006 13.2038 17 12.546 17H7.45408C6.79615 17 6.26438 17.0006 5.8345 16.9646C5.45207 16.9327 5.10749 16.8699 4.78649 16.729L4.65035 16.6632C4.1528 16.4038 3.73604 16.0094 3.44569 15.5251L3.32914 15.3123C3.14585 14.9444 3.07023 14.5473 3.03451 14.0999C2.9994 13.6601 3 13.1158 3 12.4428Z"}),o.jsx("path",{d:"M9.99993 13.2544C10.3505 13.2544 10.6348 12.9635 10.6348 12.6047V5.218L12.7337 7.36545L12.8335 7.44845C13.0799 7.61506 13.4146 7.58749 13.6316 7.36545C13.8486 7.14342 13.8756 6.80101 13.7127 6.54884L13.6316 6.44677L10.4493 3.19088C10.3302 3.06897 10.1683 3 9.99993 3C9.8316 3.0001 9.67044 3.06906 9.55138 3.19088L6.36815 6.44677C6.12048 6.70037 6.12057 7.11179 6.36815 7.36545C6.58526 7.58755 6.92077 7.61523 7.1673 7.44845L7.26707 7.36545L9.36491 5.21897V12.6047C9.36491 12.9634 9.64934 13.2542 9.99993 13.2544Z"})]}),Nc=new Set(["jpg","jpeg","png","gif","webp","svg"]),Mc=t=>{const e=t.split(".").pop();return e?Nc.has(e):!1};function Ec({citation:t,conversation:e,messageId:s}){var c;const n=xe(),r=sa(),a=na(),i=p.useRef(r!==an.Research),l=Ve(e.serverId$);if(p.useEffect(()=>{!i.current&&r===an.Research&&(i.current=!0,a(null))},[r,a]),Fi(t.file_name)&&Se(n,"3392860057"))return o.jsx(Cc,{citation:t,conversation:e,messageId:s,children:(c=t.label)!=null?c:t.file_name});if(uc(t.file_name))return o.jsx(mc,{citation:t,conversation:e,messageId:s});if(l)return o.jsx(Tc,{citation:t,serverThreadId:l})}function Tc({citation:t,serverThreadId:e}){var a,i;const s=Ut(),n=p.useCallback(l=>{s.danger(l,{toastId:"fcoa_renderer_failed_to_download_file"})},[s]),{data:r}=Bs(!0,e,t.file_id,void 0,n);return Mc(t.file_name)&&(r!=null&&r.download_url)?o.jsx("img",{src:r==null?void 0:r.download_url,alt:(a=t.label)!=null?a:t.file_name,className:"max-h-[350px] max-w-screen"}):o.jsx("a",{href:r==null?void 0:r.download_url,children:(i=t.label)!=null?i:t.file_name})}function $c({citationIndex:t,conversation:e,nodeType:s,messageId:n}){var l;const r=parseInt(t,10),a=p.useContext(Ke);if(!a)return null;const i=(l=a.n7jupdCrefs)==null?void 0:l[r];if(!i)return null;switch(i.type){case"clipboard":return o.jsx(ac,{citation:i});case"computer_output":return o.jsx(lc,{citation:i,conversation:e,nodeType:s});case"file":return o.jsx(Ec,{citation:i,conversation:e,messageId:n});case"invalid":return null}}function Pc(t){return t&&/^turn[0-9]+ifs[0-9]+$/.test(t)}const Ic=Z(()=>X(()=>import("./h48j4g76f726xzx4.js"),__vite__mapDeps([16,1])),{loading:t=>Q(t)}),Ac=Z(()=>X(()=>import("./lpy0q055i382xanc.js"),__vite__mapDeps([17,1])),{loading:t=>Q(t)});function Lc({path:t,lineRangeStart:e,lineRangeEnd:s,gitUrl:n}){const[r,a]=p.useState(!1),i=p.useContext(Jt),l=p.useRef(null),c=p.useRef(null),d=p.useRef(null),u=()=>{d.current&&(clearTimeout(d.current),d.current=null),a(!0)},m=()=>{d.current=window.setTimeout(()=>{a(!1)},200)};if(!t)return null;const h=i==null?void 0:i.fileSnapshots.find(_=>_.path===t);if(!h)return null;const x=Dc(e,s,h);return x.length?o.jsxs(Fs,{open:r,onOpenChange:a,children:[o.jsx(Os,{asChild:!0,onMouseEnter:u,onMouseLeave:m,children:o.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:o.jsx(Ac,{className:"size-[10px]"})})}),o.jsx(zs,{children:o.jsx(Ws,{ref:c,className:"z-50 focus:outline-none",side:"right",onMouseEnter:u,onMouseLeave:m,onOpenAutoFocus:_=>_.preventDefault(),children:o.jsx(Rc,{snapshot:h,snippetLines:x,lineRangeStart:e,lineRangeEnd:s,gitUrl:n})})})]}):null}function Rc({snapshot:t,snippetLines:e,lineRangeStart:s,lineRangeEnd:n,gitUrl:r}){var c;const a=(c=t.path.split(".").pop())!=null?c:"sh",i=e.reduce((d,u)=>{if(u.trim()==="")return d;const m=u.match(/^\s*/),h=m?m[0].length:0;return d===-1?h:Math.min(d,h)},-1),l=e.map(d=>i>0?d.slice(i):d).join("\n");return o.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex max-h-[600px] flex-col rounded-2xl border px-2 pt-2 pb-4 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[l&&o.jsx(ii,{wrapperClassName:"rounded-lg !bg-token-bg-tertiary !border-none mb-3 max-h-[400px] overflow-auto text-xs w-[600px] max-w-full",codeContainerClassName:"!p-2",language:a,content:l,showActionBar:!1}),o.jsxs("div",{className:"grid w-full grid-cols-[minmax(0,1fr)_auto] items-center justify-between gap-1 px-2 text-sm",children:[t.path,o.jsxs("div",{className:"text-token-text-tertiary flex items-center gap-1 whitespace-nowrap",children:[o.jsx(H,{id:"wham.citation.file.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:s,lineRangeEnd:n}}),r&&o.jsx("a",{className:"group flex w-full items-center gap-1 p-1",href:r,target:"_blank",rel:"noopener noreferrer",children:o.jsx(Ic,{className:"icon-xs hover:text-token-text-primary"})})]})]})]})}function Dc(t,e,s){var i;if(s.contents){const l=s.contents.split("\n"),c=Math.max(0,t-1),d=e?Math.min(l.length,e):c+1;return l.slice(c,d)}const n=(i=s.line_range_contents)==null?void 0:i.find(l=>Fc(l,t,e));if(!n)return[];const r=Math.max(t-n.line_range_start,0),a=r+(e-t+1);return n.content.slice(r,a)}function Fc(t,e,s){return e<t.line_range_start?!1:!(s>t.line_range_end)}function Oc({assetPointer:t}){var i,l,c,d,u;const e=p.useContext(Jt),s=le(),n=e==null?void 0:e.imagePointers.find(m=>m.asset_pointer===t),r=Do({asset:{content_type:bo.ImageAssetPointer,asset_pointer:(i=n==null?void 0:n.asset_pointer)!=null?i:"",size_bytes:(l=n==null?void 0:n.size_bytes)!=null?l:0,width:(c=n==null?void 0:n.width)!=null?c:0,height:(d=n==null?void 0:n.height)!=null?d:0}});if(!n||!((u=r.data)!=null&&u.url))return null;const a=s.formatMessage({id:"wham.contentReference.imageAlt",defaultMessage:"Captured screenshot"});return o.jsx(li,{src:r.data.url,alt:a,className:"max-h-[250px] max-w-[250px]",children:o.jsx(ci,{src:r.data.url,alt:a,width:n.width,height:n.height,className:"max-h-[250px] max-w-[250px] object-contain"})})}function zc(){const t=_o.getItem(vo.ProposedTasks);return t&&typeof t=="object"?t:{}}const _n=oa(t=>({tasks:zc(),store(e){t(s=>{const n=U(D({},s.tasks),{[e.contentId]:e});return _o.setItem(vo.ProposedTasks,n),{tasks:n}})}})),Wc=Z(()=>X(()=>import("./mauhe4xggt6ulnl1.js"),__vite__mapDeps([18,1])),{loading:t=>Q(t)}),Hc=Z(()=>X(()=>import("./bonby2i4xf93dev1.js"),__vite__mapDeps([19,1])),{loading:t=>Q(t)});function Bc({title:t,prompt:e,environmentId:s,branch:n,contentId:r,hasHitRateLimit:a}){const[i,l]=p.useState(!1),c=ra(),{setEnvironmentId:d,setBranch:u}=al(),{refetch:m}=il(),h=le(),x=Ut(),_=_n(y=>y.tasks[r]),v=_n(y=>y.store),{mutate:w,isPending:j}=Rr({mutationFn:()=>ll.createNewTask(s,n,e,!1).catch(y=>{throw x.danger(mt({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task"}),{id:"suggestion-".concat(r),duration:5,hasCloseButton:!0,toastId:"wham_proposed_task_failed_to_create_task"}),y}),onSuccess:async y=>{await m(),C(y)}}),C=y=>{try{const k=y.task.id,S=y.turn.id,N="/codex/tasks/".concat(k);v({contentId:r,prompt:e,scheduledTaskId:k,turnId:S,url:N}),l(!1)}catch(k){}},f=!s||!n||j||a;return o.jsxs("div",{className:A("mt-1 mb-3 flex w-full items-center rounded-xl px-3 py-3",_?"bg-token-bg-secondary border border-transparent":"bg-token-bg-primary border-token-border-default border shadow-[0px_1px_1px_0px_rgba(0,0,0,0.05)]"),children:[o.jsxs("div",{className:A("group flex flex-1 items-center gap-1",!_&&"-my-3 py-3",!_&&!f&&"cursor-pointer"),onClick:()=>{f||_||(d(s),u(n),l(!0),dn.recordProposedTaskClicked("edit"))},children:[o.jsxs("div",{className:"flex flex-col gap-0.5",children:[o.jsx("span",{className:"text-token-text-tertiary text-xs",children:o.jsx(H,{id:"wham.whamProposedTask.title",defaultMessage:"Suggested task"})}),o.jsx("span",{className:A("text-sm font-medium",_&&"text-token-text-tertiary"),children:t})]}),!f&&!_&&o.jsx(Hc,{className:"icon-sm text-token-text-secondary mb-0.5 cursor-pointer self-end opacity-0 transition-opacity group-hover:opacity-100"})]}),o.jsx("div",{className:"flex items-center justify-end gap-2 text-xs",children:_?o.jsx(Pe,{size:"small",color:"secondary",as:"a",to:_==null?void 0:_.url,openNewTab:!0,children:o.jsx("span",{className:"text-token-text-primary font-medium",children:o.jsx(H,{id:"lwqFNG",defaultMessage:"View task"})})}):o.jsx(Vc,{prompt:a?h.formatMessage({id:"wham.proposedTask.hitRateLimit",defaultMessage:"You have reached your rate limit"}):e,tooltipEnabled:!_&&!i,children:o.jsx(Pe,{size:"small",color:"secondary",disabled:f,onClick:()=>{dn.recordProposedTaskClicked("create"),w()},children:o.jsxs("div",{className:"flex items-center gap-0.5",children:[o.jsx(H,{id:"b2N2Y8",defaultMessage:"Start task"}),j?o.jsx(yt,{className:"icon-xs me-[2px]"}):o.jsx(Wc,{className:"icon-sm"})]})})})}),o.jsx(qe.Root,{testId:"modal-task-stub-composer",isOpen:i,onClose:()=>l(!1),children:o.jsx(qe.Overlay,{children:o.jsxs(qe.Content,{className:"flex max-w-3xl! items-center justify-center px-12 py-4 focus:outline-hidden",size:"normal",removeBackground:!0,onEscapeKeyDown:y=>{y.stopPropagation(),l(!1)},children:[o.jsxs(aa,{children:[o.jsx(ia,{children:o.jsx(H,{id:"wham.proposedTaskModel.title",defaultMessage:"Kick off a new Codex task"})}),o.jsx(la,{children:o.jsx(H,{id:"wham.proposedTaskModel.description",defaultMessage:"Codex can propose new follow up tasks"})})]}),o.jsx(at.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:{duration:c?0:.25},className:"w-full",children:o.jsxs("div",{className:"flex flex-col items-center gap-8",children:[o.jsx("h1",{className:"text-token-text-primary dark text-[28px] font-semibold",children:o.jsx(H,{id:"wham.proposedTaskModal.title",defaultMessage:"Edit suggested task"})}),o.jsx(Uc,{prompt:e,onSuccess:C})]})})]})})})]})}function Vc({prompt:t,tooltipEnabled:e,children:s}){return e?o.jsx(Ls,{side:"right",label:o.jsx("span",{className:"block p-2 text-start whitespace-pre-wrap",children:t}),wide:!0,children:s}):s}function Uc({prompt:t,onSuccess:e}){const{composerController:s}=rl();return p.useEffect(()=>{ca(da(s),t.trimEnd())},[s,t]),o.jsx(ua.Provider,{value:s,children:o.jsx(nl,{isBigBoxMode:!0,expanded:!0,disableDuringSubmit:!0,onSuccess:e})})}function qc({title:t,prompt:e}){const s=p.useContext(Jt),{data:n}=cl(),r=ol(n),a=p.useMemo(()=>Gc("".concat(s==null?void 0:s.taskId,":").concat(t,":").concat(e)),[s==null?void 0:s.taskId,t,e]);return!s||!s.environmentId||!s.branch?null:o.jsx(Bc,{title:t,prompt:e,environmentId:s.environmentId,branch:s.branch,contentId:a,hasHitRateLimit:r})}function Gc(t){let e=5381;for(let s=0;s<t.length;s++)e=(e<<5)+e^t.charCodeAt(s);return(e>>>0).toString(16).padStart(8,"0")}const Xc=Z(()=>X(()=>import("./j4p4w74o1oeu6aq1.js"),__vite__mapDeps([20,1])),{loading:t=>Q(t)});function Zc({chunkId:t,lineRangeStart:e,lineRangeEnd:s}){const[n,r]=p.useState(!1),a=p.useContext(Jt),i=a==null?void 0:a.terminalMessageContents.find(_=>_.includes(t)),l=p.useRef(null),c=p.useRef(null),d=p.useRef(null);if(!i)return null;const u=Kc(i);if(!u)return null;const m=u.output.slice(e-1,s);if(!m.some(_=>!!_.length))return null;const h=()=>{d.current&&(clearTimeout(d.current),d.current=null),r(!0)},x=()=>{d.current=window.setTimeout(()=>{r(!1)},200)};return o.jsxs(Fs,{open:n,onOpenChange:r,children:[o.jsx(Os,{asChild:!0,onMouseEnter:h,onMouseLeave:x,children:o.jsx("span",{ref:l,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:o.jsx(Xc,{className:"size-[10px]"})})}),o.jsx(zs,{children:o.jsx(Ws,{ref:c,className:"z-50 focus:outline-none",side:"right",onMouseEnter:h,onMouseLeave:x,onOpenAutoFocus:_=>_.preventDefault(),children:o.jsx("div",{className:"max-h-[500px] max-w-screen px-4",children:o.jsx(Yc,{lines:m,lineRangeStart:e,lineRangeEnd:s})})})})]})}function Yc({lines:t,lineRangeStart:e,lineRangeEnd:s}){return o.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex flex-col overflow-auto rounded-2xl border px-2 pt-2 pb-3 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[o.jsx(dl,{className:"bg-token-sidebar-surface-primary dark mb-2.5 max-h-[200px] w-full overflow-auto rounded-lg p-3 font-mono text-xs whitespace-pre text-white dark:border dark:border-white/10",children:t.join("\n")}),o.jsx("div",{className:"flex w-full justify-end gap-1 px-2 text-sm",children:o.jsx("span",{className:"text-token-text-tertiary",children:o.jsx(H,{id:"wham.citation.terminal.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:e,lineRangeEnd:s}})})})]})}function Kc(t){try{const e=JSON.parse(t);return!("chunk_id"in e)||typeof e.chunk_id!="string"||!("session_name"in e)||typeof e.session_name!="string"||!("start_line_no"in e)||typeof e.start_line_no!="number"?null:"output"in e?e:null}catch(e){return null}}const Jc=({children:t,analyticsMetadata:e,hasBeenEdited:s,messageId:n,clientThreadId:r,messageRef:a,editorViewRef:i,fullscreenEditorViewRef:l,dialogPortalContainer:c,shouldShowWritingBlockCanvasEdit:d=!1,isInlineWritingBlockEditEnabled:u,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,writingBlock:x,index:_,onChange:v,isStreaming:w,autosaveStatus:j,title:C,recipient:f,setDirty:y,flushPendingChanges:k,contentReferences:S})=>{const N=Rs(r),{headerLabel:M,emailSendButton:$,toField:P,subjectField:b,fullScreenEmailHeader:F}=ul({writingBlock:x,clientThreadId:r,messageId:n,onChange:v,setDirty:y,flushPendingChanges:k,isStreaming:w,streamingTitle:C,streamingRecipient:f,isInlineWritingBlockEditEnabled:u});return o.jsx("div",{ref:a,id:"writing-block-".concat(n),className:A(Cs),"data-writing-block":!0,children:o.jsxs(wo,{modal:!1,children:[o.jsx(Xo,{primaryLabel:M,primaryAction:$,writingBlock:x,clientThreadId:r,messageId:n,title:C,hideDownloadButton:!0,hasBeenEdited:s,autosaveStatus:j,shouldShowWritingBlockCanvasEdit:d,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,serverThreadId:N,index:_,messageRef:a,contentReferences:S,isStreaming:w}),o.jsx("hr",{className:A(is)}),P,o.jsx("hr",{className:A(is)}),b,o.jsx("hr",{className:A(is)}),o.jsx(Zo,{editorViewRef:i,analyticsMetadata:e,isInlineWritingBlockEditEnabled:u,writingBlock:x,onChange:v,isStreaming:w,setDirty:y,flushPendingChanges:k,contentReferences:S,editorWrapperClassName:un,children:t}),o.jsxs(jo,{container:c,children:[o.jsx("div",{className:Yo}),o.jsx(ko,{onOpenAutoFocus:L=>{L.preventDefault();const T=l.current;if(!T)return;T.focus();const E=T.state.doc.content.size,z=T.state.tr.setSelection(Lt.create(T.state.doc,E)).scrollIntoView();T.dispatch(z)},onCloseAutoFocus:L=>{L.preventDefault();const T=i.current;if(!T)return;T.focus();const E=T.state.doc.content.size,z=T.state.tr.setSelection(Lt.create(T.state.doc,E)).scrollIntoView();T.dispatch(z)},className:Ko,children:o.jsx(Jo,{editorViewRef:l,analyticsMetadata:e,primaryLabel:M,primaryAction:$,subHeader:F,hasBeenEdited:s,autosaveStatus:j,clientThreadId:r,messageId:n,isInlineWritingBlockExportEnabled:m,isWritingBlockFocusedModeEnabled:h,serverThreadId:N,shouldShowWritingBlockCanvasEdit:d,title:C,index:_,messageRef:a,isInlineWritingBlockEditEnabled:u,writingBlock:x,onChange:v,isStreaming:w,setDirty:y,flushPendingChanges:k,contentReferences:S,editorWrapperClassName:un})})]})]})})},Qc=t=>{"use forget";const e=he.c(111),{conversation:s,title:n,children:r,originalContent:a,messageId:i,variant:l,recipient:c,isStreaming:d,index:u,id:m}=t,h=Ve(ma),x=xe(),_=Co(So.EditInCanvas);let v;e[0]!==x?(v=Se(x,"669593727"),e[0]=x,e[1]=v):v=e[1];const w=v;let j;e[2]!==x?(j=Se(x,"1101084612"),e[2]=x,e[3]=j):j=e[3];const C=j;let f;e[4]!==s||e[5]!==m||e[6]!==u||e[7]!==i||e[8]!==a||e[9]!==c||e[10]!==n||e[11]!==l?(f={conversation:s,messageId:i,id:m,originalContent:a,index:u,variant:l,title:n,recipient:c},e[4]=s,e[5]=m,e[6]=u,e[7]=i,e[8]=a,e[9]=c,e[10]=n,e[11]=l,e[12]=f):f=e[12];const{conversation:y,serverThreadId:k,writingBlock:S,contentReferences:N,autosaveStatus:M,flushPendingChanges:$,handleOnChange:P,messageRef:b,editorViewRef:F,analyticsMetadata:L,hasBeenEdited:T,isWritingBlockEditingAllowed:E,setDirty:z}=ml(f),G=p.useRef(null),[B,K]=p.useState(null);let te,I;if(e[13]!==B||e[14]!==h?(te=()=>{if(typeof document>"u")return;if(!h){B!=null&&K(null);return}const g=document.getElementById("thread");g&&g!==B&&K(g)},I=[h,B],e[13]=B,e[14]=h,e[15]=te,e[16]=I):(te=e[15],I=e[16]),p.useEffect(te,I),d&&l===mn.UNKNOWN&&a===""){const g="writing-block-".concat(i);let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=A(Cs,"px-4 py-2","h-10"),e[17]=O):O=e[17];let R;return e[18]!==b||e[19]!==g?(R=o.jsx("div",{ref:b,id:g,className:O,"data-writing-block":!0}),e[18]=b,e[19]=g,e[20]=R):R=e[20],R}switch(l){case mn.EMAIL:{const g=y==null?void 0:y.id,O=n!=null?n:"",R=c!=null?c:"";let W;return e[21]!==L||e[22]!==M||e[23]!==r||e[24]!==N||e[25]!==B||e[26]!==F||e[27]!==$||e[28]!==P||e[29]!==T||e[30]!==u||e[31]!==w||e[32]!==d||e[33]!==E||e[34]!==C||e[35]!==i||e[36]!==b||e[37]!==z||e[38]!==_||e[39]!==g||e[40]!==O||e[41]!==R||e[42]!==S?(W=o.jsx(Jc,{analyticsMetadata:L,hasBeenEdited:T,messageRef:b,editorViewRef:F,dialogPortalContainer:B,fullscreenEditorViewRef:G,clientThreadId:g,messageId:i,index:u,shouldShowWritingBlockCanvasEdit:_,isInlineWritingBlockEditEnabled:E,isInlineWritingBlockExportEnabled:w,onChange:P,writingBlock:S,isStreaming:d,autosaveStatus:M,title:O,recipient:R,setDirty:z,flushPendingChanges:$,contentReferences:N,isWritingBlockFocusedModeEnabled:C,children:r}),e[21]=L,e[22]=M,e[23]=r,e[24]=N,e[25]=B,e[26]=F,e[27]=$,e[28]=P,e[29]=T,e[30]=u,e[31]=w,e[32]=d,e[33]=E,e[34]=C,e[35]=i,e[36]=b,e[37]=z,e[38]=_,e[39]=g,e[40]=O,e[41]=R,e[42]=S,e[43]=W):W=e[43],W}default:{const g="writing-block-".concat(i);let O;e[44]===Symbol.for("react.memo_cache_sentinel")?(O=A(Cs),e[44]=O):O=e[44];const R=y==null?void 0:y.id;let W;e[45]!==M||e[46]!==N||e[47]!==T||e[48]!==u||e[49]!==w||e[50]!==d||e[51]!==C||e[52]!==i||e[53]!==b||e[54]!==k||e[55]!==_||e[56]!==R||e[57]!==n||e[58]!==S?(W=o.jsx(Xo,{hasBeenEdited:T,autosaveStatus:M,writingBlock:S,clientThreadId:R,messageId:i,isInlineWritingBlockExportEnabled:w,isWritingBlockFocusedModeEnabled:C,serverThreadId:k,shouldShowWritingBlockCanvasEdit:_,title:n,index:u,messageRef:b,contentReferences:N,isStreaming:d}),e[45]=M,e[46]=N,e[47]=T,e[48]=u,e[49]=w,e[50]=d,e[51]=C,e[52]=i,e[53]=b,e[54]=k,e[55]=_,e[56]=R,e[57]=n,e[58]=S,e[59]=W):W=e[59];let V;e[60]===Symbol.for("react.memo_cache_sentinel")?(V=o.jsx("hr",{className:"border-token-border-light! border-0.5 my-0!"}),e[60]=V):V=e[60];let Y;e[61]!==L||e[62]!==r||e[63]!==N||e[64]!==F||e[65]!==$||e[66]!==P||e[67]!==d||e[68]!==E||e[69]!==z||e[70]!==S?(Y=o.jsx(Zo,{editorViewRef:F,analyticsMetadata:L,setDirty:z,isInlineWritingBlockEditEnabled:E,writingBlock:S,onChange:P,isStreaming:d,flushPendingChanges:$,contentReferences:N,children:r}),e[61]=L,e[62]=r,e[63]=N,e[64]=F,e[65]=$,e[66]=P,e[67]=d,e[68]=E,e[69]=z,e[70]=S,e[71]=Y):Y=e[71];let J;e[72]===Symbol.for("react.memo_cache_sentinel")?(J=o.jsx("div",{className:Yo}),e[72]=J):J=e[72];let de;e[73]===Symbol.for("react.memo_cache_sentinel")?(de=me=>{me.preventDefault();const ae=G.current;if(!ae)return;ae.focus();const pe=ae.state.doc.content.size,ce=ae.state.tr.setSelection(Lt.create(ae.state.doc,pe)).scrollIntoView();ae.dispatch(ce)},e[73]=de):de=e[73];let oe;e[74]!==F?(oe=me=>{me.preventDefault();const ae=F.current;if(!ae)return;ae.focus();const pe=ae.state.doc.content.size,ce=ae.state.tr.setSelection(Lt.create(ae.state.doc,pe)).scrollIntoView();ae.dispatch(ce)},e[74]=F,e[75]=oe):oe=e[75];let ie;e[76]===Symbol.for("react.memo_cache_sentinel")?(ie=A(Ko),e[76]=ie):ie=e[76];const ee=y==null?void 0:y.id;let ye;e[77]!==L||e[78]!==M||e[79]!==N||e[80]!==$||e[81]!==P||e[82]!==T||e[83]!==u||e[84]!==w||e[85]!==d||e[86]!==E||e[87]!==C||e[88]!==i||e[89]!==b||e[90]!==k||e[91]!==z||e[92]!==_||e[93]!==ee||e[94]!==n||e[95]!==S?(ye=o.jsx(Jo,{editorViewRef:G,analyticsMetadata:L,hasBeenEdited:T,autosaveStatus:M,clientThreadId:ee,messageId:i,isInlineWritingBlockExportEnabled:w,isWritingBlockFocusedModeEnabled:C,serverThreadId:k,shouldShowWritingBlockCanvasEdit:_,title:n,index:u,messageRef:b,isInlineWritingBlockEditEnabled:E,writingBlock:S,onChange:P,isStreaming:d,setDirty:z,flushPendingChanges:$,contentReferences:N}),e[77]=L,e[78]=M,e[79]=N,e[80]=$,e[81]=P,e[82]=T,e[83]=u,e[84]=w,e[85]=d,e[86]=E,e[87]=C,e[88]=i,e[89]=b,e[90]=k,e[91]=z,e[92]=_,e[93]=ee,e[94]=n,e[95]=S,e[96]=ye):ye=e[96];let ue;e[97]!==oe||e[98]!==ye?(ue=o.jsx(ko,{onOpenAutoFocus:de,onCloseAutoFocus:oe,className:ie,children:ye}),e[97]=oe,e[98]=ye,e[99]=ue):ue=e[99];let re;e[100]!==B||e[101]!==ue?(re=o.jsxs(jo,{container:B,children:[J,ue]}),e[100]=B,e[101]=ue,e[102]=re):re=e[102];let be;e[103]!==Y||e[104]!==re||e[105]!==W?(be=o.jsxs(wo,{modal:!1,children:[W,V,Y,re]}),e[103]=Y,e[104]=re,e[105]=W,e[106]=be):be=e[106];let ne;return e[107]!==b||e[108]!==be||e[109]!==g?(ne=o.jsx("div",{ref:b,id:g,className:O,"data-writing-block":!0,children:be}),e[107]=b,e[108]=be,e[109]=g,e[110]=ne):ne=e[110],ne}}},ed=Z(()=>X(()=>import("./cus6e9b5l060ctey.js"),__vite__mapDeps([21,1])),{loading:t=>Q(t)});function td({metadata:t,trackContentReferenceEvent:e}){var i;const s=Dr(),n=xe(),r=Ds(),a=Se(n,"3375735072");return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,{checkout_id:t.checkout_id})},[e,t.type,t.checkout_id]),a?o.jsxs("div",{className:"border-token-border-default bg-token-bg-primary not-prose mb-6 flex max-w-[420px] flex-col gap-4 rounded-[20px] border py-4 shadow-[0px_4px_16px_0px_rgba(0,_0,_0,_0.05)]","data-order-id":t.checkout_id,role:"group",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 text-sm font-medium",children:[o.jsx(ed,{className:"icon-lg text-green-400"}),o.jsx(H,{id:"checkout_purchase_confirmation_status",defaultMessage:"Purchase complete"})]}),o.jsxs("div",{className:"border-token-border-light flex items-start gap-3 border-b px-4 pb-4",children:[o.jsx("div",{className:"flex-shrink-0 overflow-hidden rounded-xl bg-gray-100 dark:bg-gray-700",children:o.jsx("img",{src:t.product_image_urls[0],alt:t.title,className:"m-0 aspect-square h-32 w-32 object-cover mix-blend-darken dark:mix-blend-lighten"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"line-clamp-2 min-h-6 text-base leading-snug font-medium",title:t.title,children:t.title}),o.jsx("div",{className:"text-token-text-secondary text-[13px] leading-snug whitespace-pre-wrap",children:t.subtitle})]})]}),t.error_message&&o.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mx-4 flex items-center rounded-lg px-3 py-1 text-sm",children:t.error_message}),o.jsx("dl",{className:"space-y-1 px-4",children:(i=t.details)==null?void 0:i.map(l=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("dt",{className:"text-token-text-secondary flex-grow text-[13px] font-medium",children:l.label}),o.jsx("dd",{className:"text-token-text-primary text-[13px] font-medium",children:l.value})]},l.label))}),!r&&o.jsx("div",{className:"px-4",children:o.jsx(Pe,{fullWidth:!0,color:"secondary",className:"rounded-2xl border",onClick:()=>{s("#settings/".concat(fa.Orders,"?order=").concat(t.checkout_id))},children:o.jsx(H,{id:"2Dn5nu",defaultMessage:"View details"})})})]}):null}const vn=4;function sd(t){"use forget";const e=he.c(50),{metadata:s,analyticsMetadata:n,trackContentReferenceEvent:r,imageSource:a,superWidgetContent:i,isFirstAssistantContent:l}=t,c=a!=null?a:Je.Turn,d=bt(),u=xe();let m;e[0]!==u?(m=We(u)&&!Gt(u),e[0]=u,e[1]=m):m=e[1];const h=m;let x;e:{if(!h||!i){x=s.images;break e}const $=i.widgets.images;let P;e[2]!==s.images||e[3]!==$?(P=No(s.images.concat($),ld),e[2]=s.images,e[3]=$,e[4]=P):P=e[4],x=P}const _=x;let v,w,j;e[5]!==_||e[6]!==s.images?(v=s.images.some(id)?[]:_.map(ad),j=Fr,w=v.map(rd),e[5]=_,e[6]=s.images,e[7]=v,e[8]=w,e[9]=j):(v=e[7],w=e[8],j=e[9]);let C;e[10]!==v?(C=$=>{const P=new Set;return $.forEach((b,F)=>{b.isSuccess&&P.add(v[F])}),P},e[10]=v,e[11]=C):C=e[11];let f;e[12]!==w||e[13]!==C?(f={queries:w,combine:C},e[12]=w,e[13]=C,e[14]=f):f=e[14];const y=j(f);let k,S,N;if(e[15]!==n||e[16]!==y||e[17]!==c||e[18]!==_||e[19]!==l||e[20]!==d||e[21]!==s.images||e[22]!==h||e[23]!==r){N=Symbol.for("react.early_return_sentinel");e:{let $;e[27]!==y?($=T=>y.has(T.thumbnail_url),e[27]=y,e[28]=$):$=e[28];const P=_.filter($),b=s.images.length;if(s.images.some(od)){let T;e[29]!==s.images?(T=s.images.find(nd),e[29]=s.images,e[30]=T):T=e[30];const E=T,z=E!=null&&E.float_top?"relative block":"float-image z-10 float-end clear-end ms-7 overflow-hidden";let G;e[31]!==z?(G=A("mb-7 mt-1 min-w-32 max-w-[22%] rounded-xl border-[0.5px] border-token-border-default",z),e[31]=z,e[32]=G):G=e[32];const B=G,K=E==null?void 0:E.content_url;let te;e[33]===Symbol.for("react.memo_cache_sentinel")?(te={imageUse:"deepResearch"},e[33]=te):te=e[33];let I;e[34]!==n||e[35]!==B||e[36]!==c||e[37]!==E||e[38]!==K||e[39]!==r?(I=o.jsx(Oe,{image:E,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:te,aspectRatio:Pt,className:B,contentReferenceType:"image_v2"},K),e[34]=n,e[35]=B,e[36]=c,e[37]=E,e[38]=K,e[39]=r,e[40]=I):I=e[40],N=I;break e}if(b===0){N=null;break e}if(b===1){const T=s.images[0];let E;e[41]===Symbol.for("react.memo_cache_sentinel")?(E={imageUse:"legacyCarousel"},e[41]=E):E=e[41];let z;e[42]!==n||e[43]!==c||e[44]!==T||e[45]!==r?(z=o.jsx(Oe,{image:T,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:E,aspectRatio:Pt,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 max-w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_v2"},T.content_url),e[42]=n,e[43]=c,e[44]=T,e[45]=r,e[46]=z):z=e[46],N=z;break e}const F=h?null:vn,L=d||F==null?P.length:Math.min(P.length,F);if(P.length>vn&&h){N=o.jsx(dd,{images:P.slice(0,L),imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,isFirstAssistantContent:l});break e}k="no-scrollbar mt-1 mb-6 flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",S=P.slice(0,L).map((T,E)=>o.jsx("div",{className:A("border-token-border-default relative aspect-square w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-48 sm:w-[calc((100%-0.5rem)/4)]",E===0&&"rounded-s-xl",E===L-1&&"rounded-e-xl"),children:o.jsx(Oe,{image:T,imageSource:c,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:{imageUse:"legacyCarousel"},aspectRatio:Pt,className:"h-full w-full",contentReferenceType:"image_v2"},T.thumbnail_url)},T.thumbnail_url))}e[15]=n,e[16]=y,e[17]=c,e[18]=_,e[19]=l,e[20]=d,e[21]=s.images,e[22]=h,e[23]=r,e[24]=k,e[25]=S,e[26]=N}else k=e[24],S=e[25],N=e[26];if(N!==Symbol.for("react.early_return_sentinel"))return N;let M;return e[47]!==k||e[48]!==S?(M=o.jsx("div",{className:k,children:S}),e[47]=k,e[48]=S,e[49]=M):M=e[49],M}function nd(t){return t.is_proxied_image}function od(t){return t.is_proxied_image}function rd(t){return Gi(t,"_ImageCarousel")}function ad(t){return t.thumbnail_url}function id(t){return t.is_proxied_image}function ld(t){return t.thumbnail_url}const qs=p.memo(sd,(t,e)=>t.numImageResults===e.numImageResults&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.metadata.images.length===e.metadata.images.length&&t.metadata.images.every((s,n)=>s.content_url===e.metadata.images[n].content_url));function Oe(t){"use forget";var J,de;const e=he.c(72),{image:s,imageSource:n,className:r,imgClassName:a,style:i,analyticsMetadata:l,trackContentReferenceEvent:c,eventMetadata:d,badge:u,lightboxImages:m,aspectRatio:h,enableHoverAnimation:x,fadeInOnMount:_,skeletonEl:v,contentReferenceType:w}=t;let j;e[0]!==d?(j=d===void 0?{}:d,e[0]=d,e[1]=j):j=e[1];const C=j,f=x===void 0?!0:x,y=h!=null?h:void 0;let k;e[2]!==y?(k={width:Yi,aspectRatio:y},e[2]=y,e[3]=k):k=e[3];const S=Xi(s,k);let N;e[4]!==(s==null?void 0:s.content_url)?(N=s==null?void 0:s.content_url.replace(/^http:\/\//,"https://"),e[4]=s==null?void 0:s.content_url,e[5]=N):N=e[5];const M=N;let $;e[6]!==s?($=fd(s),e[6]=s,e[7]=$):$=e[7];const P=$,{isSuccess:b}=ks(S,"ImageCarousel_thumbnail"),{isSuccess:F,isError:L}=ks(P?M:void 0,"ImageCarousel_full");s==null||s.title;const T=s==null?void 0:s.title;let E;e[8]!==C||e[9]!==T||e[10]!==S?(E=D({image_url:S,title:T},C),e[8]=C,e[9]=T,e[10]=S,e[11]=E):E=e[11];const z=E;let G,B;e[12]!==w||e[13]!==z||e[14]!==s||e[15]!==b||e[16]!==c?(G=()=>{s&&b&&c("Search Content Reference Shown","search_content_reference_shown",w,z)},B=[c,s,b,z,w],e[12]=w,e[13]=z,e[14]=s,e[15]=b,e[16]=c,e[17]=G,e[18]=B):(G=e[17],B=e[18]),p.useEffect(G,B);let K,te;e[19]!==M||e[20]!==L||e[21]!==S?(K=()=>{M&&L&&qt.addAction("Failed to download full image",{url:M,thumbnailUrl:S})},te=[M,L,S],e[19]=M,e[20]=L,e[21]=S,e[22]=K,e[23]=te):(K=e[22],te=e[23]),p.useEffect(K,te);const I=Hs.useStore();let g,O,R,W;if(e[24]!==l||e[25]!==h||e[26]!==r||e[27]!==w||e[28]!==M||e[29]!==f||e[30]!==z||e[31]!==_||e[32]!==s||e[33]!==I||e[34]!==n||e[35]!==a||e[36]!==F||e[37]!==b||e[38]!==m||e[39]!==P||e[40]!==v||e[41]!==i||e[42]!==S||e[43]!==c){const oe=Zi((J=s==null?void 0:s.thumbnail_crop_info)!=null?J:null,(de=s==null?void 0:s.thumbnail_size)!=null?de:null,h!=null?h:void 0),ie=!s||!(b||F||s.is_proxied_image);let ee;e:{if(ie){ee=void 0;break e}if(s.is_proxied_image){ee=s.url;break e}if(P&&F){ee=M;break e}ee=S}const ye=ee;let ue;e[48]!==h?(ue=h?{aspectRatio:"".concat(h.width,"/").concat(h.height)}:{},e[48]=h,e[49]=ue):ue=e[49];let re;e[50]!==i||e[51]!==ue?(re=D(D({},i),ue),e[50]=i,e[51]=ue,e[52]=re):re=e[52];const be=re;e[53]!==r?(g=A("relative overflow-hidden",r),e[53]=r,e[54]=g):g=e[54],O=be,e[55]!==l||e[56]!==w||e[57]!==z||e[58]!==s||e[59]!==I||e[60]!==n||e[61]!==m||e[62]!==c?(R=()=>{c("Search Content Reference Clicked","search_content_reference_clicked",w,z),I.setCurrentImage(s?{image:s,source:n,analyticsMetadata:l,imageResults:m}:void 0)},e[55]=l,e[56]=w,e[57]=z,e[58]=s,e[59]=I,e[60]=n,e[61]=m,e[62]=c,e[63]=R):R=e[63],W=cd({isLoading:ie,enableHoverAnimation:f,fadeInOnMount:_,src:ye,image:s,objectPosition:oe,className:a,skeletonEl:v}),e[24]=l,e[25]=h,e[26]=r,e[27]=w,e[28]=M,e[29]=f,e[30]=z,e[31]=_,e[32]=s,e[33]=I,e[34]=n,e[35]=a,e[36]=F,e[37]=b,e[38]=m,e[39]=P,e[40]=v,e[41]=i,e[42]=S,e[43]=c,e[44]=g,e[45]=O,e[46]=R,e[47]=W}else g=e[44],O=e[45],R=e[46],W=e[47];let V;e[64]!==u?(V=u&&o.jsx("div",{className:"pointer-events-none absolute end-2 bottom-2",children:u}),e[64]=u,e[65]=V):V=e[65];let Y;return e[66]!==g||e[67]!==O||e[68]!==R||e[69]!==W||e[70]!==V?(Y=o.jsxs("button",{className:g,style:O,onClick:R,children:[W,V]}),e[66]=g,e[67]=O,e[68]=R,e[69]=W,e[70]=V,e[71]=Y):Y=e[71],Y}function cd({isLoading:t,enableHoverAnimation:e,fadeInOnMount:s,src:n,image:r,objectPosition:a,className:i,skeletonEl:l}){if(t)return l!=null?l:o.jsx("div",{className:"bg-token-main-surface-tertiary aspect-square h-full w-full animate-pulse"});const c=o.jsx(at.img,{src:n,alt:r==null?void 0:r.content_url,style:a?{objectPosition:a}:{},className:A("bg-token-main-surface-tertiary m-0 h-full w-full object-cover",i),initial:s?{opacity:0}:!1,animate:{opacity:1},transition:s?{duration:.3,ease:"easeInOut"}:void 0});return e?o.jsx(Go,{children:c}):c}function dd(t){"use forget";const e=he.c(15),{images:s,imageSource:n,analyticsMetadata:r,trackContentReferenceEvent:a,isFirstAssistantContent:i}=t,l=xe();let c;e[0]!==l?(c=()=>Xt(l),e[0]=l,e[1]=c):c=e[1];const d=Ve(c),u=md,m=i&&"mt-2",h=d?"-mx-[var(--thread-content-margin)]":"-mx-6";let x;e[2]!==m||e[3]!==h?(x=A("relative mb-6",m,h),e[2]=m,e[3]=h,e[4]=x):x=e[4];let _;e[5]!==r||e[6]!==n||e[7]!==a?(_=j=>o.jsx(Oe,{image:j,imageSource:n,analyticsMetadata:r,trackContentReferenceEvent:a,className:"aspect-auto h-full w-full",aspectRatio:null,contentReferenceType:"image_v2"}),e[5]=r,e[6]=n,e[7]=a,e[8]=_):_=e[8];let v;e[9]!==s||e[10]!==_?(v=o.jsx(Yt,{items:s,getItemKey:ud,itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)]",getItemStyle:u,onRenderItem:_,className:"h-48 min-h-48"}),e[9]=s,e[10]=_,e[11]=v):v=e[11];let w;return e[12]!==x||e[13]!==v?(w=o.jsx("div",{className:x,children:v}),e[12]=x,e[13]=v,e[14]=w):w=e[14],w}function ud(t){return t.thumbnail_url}function md(t){const{width:e,height:s}=t.content_size;return{width:s?e/s*192:180}}function fd(t){return!t||t.is_proxied_image?!1:t.thumbnail_url.includes("images.openai.com")}const wn=4,nr=5;function hd(t){"use forget";var N,M,$,P;const e=he.c(29),{images:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:a}=t,i=xe();let l;e[0]!==i?(l=We(i),e[0]=i,e[1]=l):l=e[1];const c=l;let d;e[2]!==n?(d=n?Mo(n):null,e[2]=n,e[3]=d):d=e[3];const u=d,m=(M=(N=r==null?void 0:r.widgets)==null?void 0:N.query)!=null?M:"";let h;e[4]!==u||e[5]!==m?(h=((P=($=m==null?void 0:m.trim())==null?void 0:$.length)!=null?P:0)>0?m:u,e[4]=u,e[5]=m,e[6]=h):h=e[6];const x=h;let _;e[7]!==i||e[8]!==s.length||e[9]!==c||e[10]!==x?(_=()=>{!c||s.length>=wn||!x||Oo(i,x,"images")},e[7]=i,e[8]=s.length,e[9]=c,e[10]=x,e[11]=_):_=e[11];let v;e[12]!==i||e[13]!==s.length||e[14]!==c||e[15]!==n||e[16]!==x||e[17]!==r?(v=[i,c,n,x,s.length,r],e[12]=i,e[13]=s.length,e[14]=c,e[15]=n,e[16]=x,e[17]=r,e[18]=v):v=e[18],p.useEffect(_,v);let w;e[19]!==c||e[20]!==x?(w=b=>{var T,E;if(!c||!x)return[[],!1];const L=(T=b.entries[x])!=null?T:zo;return[(E=L.images)!=null?E:[],Wo(L,"images")]},e[19]=c,e[20]=x,e[21]=w):w=e[21];const[j,C]=Fo(w);let f;if(e[22]!==s||e[23]!==a||e[24]!==j){const b=s.map(yd).filter(xd);f=a&&s.every(gd)&&s.length<wn?No(b.concat(j.slice(0,nr)),pd):b,e[22]=s,e[23]=a,e[24]=j,e[25]=f}else f=e[25];const y=f,k=a&&C;let S;return e[26]!==y||e[27]!==k?(S={items:y,isLoading:k},e[26]=y,e[27]=k,e[28]=S):S=e[28],S}function pd(t){return t.thumbnail_url}function gd(t){return!!t.image_result}function xd(t){return!!t}function yd(t){return t.image_result?{title:t.image_result.title,url:t.image_result.url,content_url:t.image_result.content_url,thumbnail_url:t.image_result.thumbnail_url,content_size:t.image_result.content_size,thumbnail_size:t.image_result.thumbnail_size}:null}const bd=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zs),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function or({numImages:t}){return o.jsxs("div",{className:"flex items-center gap-1 rounded-full px-2 py-1.5 text-white backdrop-blur-md backdrop-brightness-75",children:[o.jsx(bd,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs font-semibold",children:t})]})}const _d=Z(()=>X(()=>import("./ffrotvb922yxp30i.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)}),vd=Z(()=>X(()=>import("./nlj7ey81i8rm36n9.js"),__vite__mapDeps([23,1])),{loading:t=>Q(t)});function wd(t){"use forget";const e=he.c(70),{images:s,className:n,aspect:r,objectPosition:a,showArrows:i,imageClassName:l,slideClassName:c,gap:d,peekPercent:u,showDots:m,onClick:h}=t,x=n===void 0?"":n,_=r===void 0?"aspect-[16/9]":r,v=a===void 0?"object-cover":a,w=i===void 0?!0:i,j=l===void 0?"":l,C=c===void 0?"":c,f=d===void 0?2:d,y=u===void 0?95:u,k=m===void 0?!1:m,[S,N]=p.useState(0),[M,$]=p.useState(!1),P=p.useRef(null);let b;e[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],e[0]=b):b=e[0];const F=p.useRef(b),L=p.useRef(null),T=le(),E=s.length;let z;e[1]!==y?(z=nt(y,0,100),e[1]=y,e[2]=z):z=e[2];const G=z,B="".concat(G,"%");let K;e[3]!==B?(K={maxWidth:B},e[3]=B,e[4]=K):K=e[4];const te=K;let I;e[5]!==E?(I=(se,q)=>{const fe=F.current[se];if(!fe)return 0;const ge=fe.offsetLeft,ke=ge+fe.offsetWidth,st=q.clientWidth,Le=Math.max(0,q.scrollWidth-st);if(E<=1||se===0)return nt(ge,0,Le);if(se===E-1){const vt=ke-st;return nt(vt,0,Le)}const ts=ge-(st-fe.offsetWidth)/2;return nt(ts,0,Le)},e[5]=E,e[6]=I):I=e[6];const g=I;let O;e[7]!==g||e[8]!==E?(O=(se,q)=>{const fe=q===void 0?"smooth":q;if(E===0||se<0||se>=E)return;const ge=P.current;if(!ge)return;const ke=g(se,ge);if(kn(ge.scrollLeft,ke)){fe!=="auto"&&ge.scrollTo({left:ke,behavior:"auto"}),L.current=null;return}L.current=ke,ge.scrollTo({left:ke,behavior:fe})},e[7]=g,e[8]=E,e[9]=O):O=e[9];const R=O,W=M&&S!==0,V=M;let Y;e[10]!==S||e[11]!==R||e[12]!==E?(Y=se=>{if(E===0)return;const q=nt(se,0,E-1);R(q,"smooth"),q!==S&&N(q)},e[10]=S,e[11]=R,e[12]=E,e[13]=Y):Y=e[13];const J=Y;let de;e[14]!==J||e[15]!==S||e[16]!==E?(de=()=>{if(E!==0){if(S>=E-1){J(0);return}J(S+1)}},e[14]=J,e[15]=S,e[16]=E,e[17]=de):de=e[17];const oe=de;let ie;e[18]!==J||e[19]!==S?(ie=()=>J(S-1),e[18]=J,e[19]=S,e[20]=ie):ie=e[20];const ee=ie;let ye,ue;e[21]!==g||e[22]!==S||e[23]!==E?(ye=()=>{const se=P.current;if(!se)return;const q=()=>{const fe=se.scrollLeft||0,ge=L.current;if(ge!=null){kn(fe,ge)&&(L.current=null);return}let ke=S,st=Number.POSITIVE_INFINITY;for(let Le=0;Le<E;Le++){const ts=g(Le,se),vt=Math.abs(ts-fe);vt<st-.5&&(st=vt,ke=Le)}ke!==S&&N(ke)};return se.addEventListener("scroll",q,{passive:!0}),()=>se.removeEventListener("scroll",q)},ue=[E,S,g],e[21]=g,e[22]=S,e[23]=E,e[24]=ye,e[25]=ue):(ye=e[24],ue=e[25]),p.useEffect(ye,ue);let re,be;e[26]!==M||e[27]!==oe||e[28]!==ee||e[29]!==E?(re=()=>{if(!M)return;const se=q=>{if(q.defaultPrevented||q.altKey||q.ctrlKey||q.metaKey||q.shiftKey)return;const fe=q.target;if(fe instanceof HTMLElement){if(fe.isContentEditable)return;const ge=fe.tagName;if(ge==="INPUT"||ge==="TEXTAREA"||ge==="SELECT")return;const ke=fe.getAttribute("role");if(ke==="textbox"||ke==="combobox")return}E<=1||(q.key==="ArrowRight"?(q.preventDefault(),oe()):q.key==="ArrowLeft"&&(q.preventDefault(),ee()))};return window.addEventListener("keydown",se),()=>window.removeEventListener("keydown",se)},be=[M,E,oe,ee],e[26]=M,e[27]=oe,e[28]=ee,e[29]=E,e[30]=re,e[31]=be):(re=e[30],be=e[31]),p.useEffect(re,be);const ne="select-none ".concat(x," relative");let me,ae;e[32]===Symbol.for("react.memo_cache_sentinel")?(me=()=>$(!0),ae=()=>$(!1),e[32]=me,e[33]=ae):(me=e[32],ae=e[33]);const pe="relative w-full ".concat(_," overflow-clip");let ce;e[34]!==f?(ce={gap:f},e[34]=f,e[35]=ce):ce=e[35];let ve;e[36]!==j||e[37]!==s||e[38]!==T||e[39]!==v||e[40]!==h||e[41]!==C||e[42]!==E||e[43]!==te?(ve=s.map((se,q)=>{var fe;return o.jsx("div",{onClick:()=>h==null?void 0:h(se,q),ref:ge=>{F.current[q]=ge},className:A("relative flex h-full shrink-0 grow-0 snap-always items-stretch",q===0&&"snap-start",q===E-1&&"snap-end",q>0&&q<E-1&&"snap-center",C),style:te,children:se.content?se.content:o.jsx("img",{src:se.src,alt:(fe=se.alt)!=null?fe:T.formatMessage({id:"wHCsqa",defaultMessage:"Slide {index}"},{index:q+1}),className:"h-full w-auto ".concat(v," ").concat(j)})},q)}),e[36]=j,e[37]=s,e[38]=T,e[39]=v,e[40]=h,e[41]=C,e[42]=E,e[43]=te,e[44]=ve):ve=e[44];let Ne;e[45]!==ce||e[46]!==ve?(Ne=o.jsx("div",{ref:P,className:"no-scrollbar flex h-full w-full touch-pan-x snap-x snap-mandatory overflow-x-scroll scroll-smooth",style:ce,children:ve}),e[45]=ce,e[46]=ve,e[47]=Ne):Ne=e[47];let _e;e[48]!==s.length||e[49]!==T||e[50]!==W||e[51]!==oe||e[52]!==ee||e[53]!==V||e[54]!==w?(_e=w&&s.length>1&&o.jsxs(o.Fragment,{children:[o.jsx(Cn,{ariaLabel:T.formatMessage({id:"l9pylv",defaultMessage:"Previous slide"}),onClick:ee,side:"start",visible:W,children:o.jsx(vd,{className:"icon-md"})}),o.jsx(Cn,{ariaLabel:T.formatMessage({id:"L0pbQh",defaultMessage:"Next slide"}),onClick:oe,side:"end",visible:V,children:o.jsx(_d,{className:"icon-md"})})]}),e[48]=s.length,e[49]=T,e[50]=W,e[51]=oe,e[52]=ee,e[53]=V,e[54]=w,e[55]=_e):_e=e[55];let we;e[56]!==J||e[57]!==s||e[58]!==S||e[59]!==T||e[60]!==k?(we=k&&s.length>1&&s.length<=20&&o.jsx("div",{className:"absolute start-0 end-0 bottom-3 flex items-center justify-center",children:o.jsx("div",{className:"flex w-fit items-center justify-center gap-2 rounded-full bg-[#0D0D0D66] bg-clip-padding p-1 backdrop-blur",children:s.map((se,q)=>o.jsx("button",{onClick:()=>J(q),"aria-label":T.formatMessage({id:"PUV+4+",defaultMessage:"Go to slide {index}"},{index:q+1}),className:"h-1.5 w-1.5 rounded-full transition-opacity ".concat(q===S?"bg-white":"bg-gray-400 opacity-60")},q))})}),e[56]=J,e[57]=s,e[58]=S,e[59]=T,e[60]=k,e[61]=we):we=e[61];let je;e[62]!==pe||e[63]!==Ne||e[64]!==_e||e[65]!==we?(je=o.jsxs("div",{className:pe,children:[Ne,_e,we]}),e[62]=pe,e[63]=Ne,e[64]=_e,e[65]=we,e[66]=je):je=e[66];let Me;return e[67]!==ne||e[68]!==je?(Me=o.jsx("div",{className:ne,"aria-roledescription":"carousel",onMouseEnter:me,onMouseLeave:ae,children:je}),e[67]=ne,e[68]=je,e[69]=Me):Me=e[69],Me}const jn={width:4,height:5};function jd(t){"use forget";const e=he.c(7),{image:s}=t,n=jn.height/jn.width;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={maxHeight:"calc(100cqw * ".concat(n,")")},e[0]=r):r=e[0];let a;e[1]!==s.alt||e[2]!==s.content||e[3]!==s.src?(a=s.content?s.content:o.jsx("img",{src:s.src,alt:s.alt,className:"h-full w-full object-cover"}),e[1]=s.alt,e[2]=s.content,e[3]=s.src,e[4]=a):a=e[4];let i;return e[5]!==a?(i=o.jsx("div",{className:"[container-type:inline-size] w-full overflow-hidden [font-size:0] leading-none",style:r,children:a}),e[5]=a,e[6]=i):i=e[6],i}function kd(t){"use forget";const e=he.c(4);if(t.images.length===0)return null;if(t.images.length===1){let n;return e[0]!==t.images[0]?(n=o.jsx(jd,{image:t.images[0]}),e[0]=t.images[0],e[1]=n):n=e[1],n}let s;return e[2]!==t?(s=o.jsx(wd,D({},t)),e[2]=t,e[3]=s):s=e[3],s}const nt=(t,e,s)=>Math.min(Math.max(t,e),s),kn=(t,e,s=1)=>Math.abs(t-e)<=s;function Cn(t){"use forget";const e=he.c(11),{ariaLabel:s,onClick:n,side:r,visible:a,children:i}=t,l=r==="start"?"start-0 justify-end":"end-0 justify-start",c=a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none ";let d;e[0]!==l||e[1]!==c?(d=A("group absolute top-0 bottom-0 flex h-full w-12.5 cursor-pointer items-center transition-opacity duration-300",l,c),e[0]=l,e[1]=c,e[2]=d):d=e[2];let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=A("btn-secondary active:bg-token-bg-tertiary group-hover:bg-token-bg-secondary flex h-8 w-8 items-center justify-center rounded-full bg-clip-padding shadow-sm group-hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!"),e[3]=u):u=e[3];let m;e[4]!==s||e[5]!==i?(m=o.jsx("button",{"aria-label":s,className:u,children:i}),e[4]=s,e[5]=i,e[6]=m):m=e[6];let h;return e[7]!==n||e[8]!==d||e[9]!==m?(h=o.jsx("div",{className:d,onClick:n,children:m}),e[7]=n,e[8]=d,e[9]=m,e[10]=h):h=e[10],h}const Gs="mt-1 mb-5 [&:not(:first-child)]:mt-4",Cd=/^image_group[\s\S]*$/;function Sd({contentReference:t,trackContentReferenceEvent:e,analyticsMetadata:s,superWidgetContent:n,lastUserMsgOfPrevTurn:r,isFirstAssistantTurn:a}){var x;const i=xe(),l=We(i),c=Gt(i),{images:d,layout:u="carousel"}=t,m=Cd.test((x=t.matched_text)!=null?x:""),h={images:d,trackContentReferenceEvent:e,analyticsMetadata:s,isReferenceComplete:m};return l&&!c&&a&&(u==="carousel"||u==="bento")&&n?o.jsx(Vd,D({superWidgetContent:n,lastUserMsgOfPrevTurn:r,imageSource:Je.ImageGroup},h)):u==="carousel"?o.jsx(Od,D({},h)):u==="bento"?o.jsx(Ad,D({},h)):u==="full_width"?o.jsx(Bd,D({},h)):null}const Nd={width:9,height:5},Md={width:21,height:9};function Ed(t){switch(t){case 0:return"rounded-se-md rounded-ee-md rounded-ss-xl rounded-es-xl";case 1:return"rounded-se-xl rounded-ee-md rounded-ss-md rounded-es-md";case 2:return"rounded-se-md rounded-ee-xl rounded-ss-md rounded-es-md";default:return""}}const Td=(t,e)=>{var s;return t.image_result?t.image_result.content_url:"".concat((s=t.image_search_query)!=null?s:t.image_ref_id,"-").concat(e)};function $d(t){"use forget";const e=he.c(14),{images:s,trackContentReferenceEvent:n,analyticsMetadata:r}=t,a=xe(),l=We(a)?Md:Nd,c=l.width/3,d=l.height/2;let u;e[0]!==c||e[1]!==d?(u={width:c,height:d},e[0]=c,e[1]=d,e[2]=u):u=e[2];const m=u;let h;e[3]===Symbol.for("react.memo_cache_sentinel")?(h=A("grid grid-flow-dense grid-cols-3 grid-rows-2 gap-1",Gs),e[3]=h):h=e[3];const x="".concat(l.width,"/").concat(l.height);let _;e[4]!==x?(_={aspectRatio:x},e[4]=x,e[5]=_):_=e[5];let v;e[6]!==r||e[7]!==s||e[8]!==m||e[9]!==n?(v=s.map((j,C)=>{var k;if(C>=3)return null;const y=C===Math.min(3,s.length)-1&&s.length>3;return o.jsx(Oe,{image:(k=j.image_result)!=null?k:void 0,imageSource:Je.ImageGroup,className:A("border-token-border-default h-full w-full border-[0.5px]",C===0&&"col-span-2 row-span-2",Ed(C)),badge:y?o.jsx(or,{numImages:s.length}):void 0,lightboxImages:s.map(Id).filter(Pd),aspectRatio:m,trackContentReferenceEvent:n,eventMetadata:{imageUse:"imageGroup",layout:"bento"},analyticsMetadata:r,contentReferenceType:"image_group"},Td(j,C))}),e[6]=r,e[7]=s,e[8]=m,e[9]=n,e[10]=v):v=e[10];let w;return e[11]!==_||e[12]!==v?(w=o.jsx("div",{className:h,style:_,children:v}),e[11]=_,e[12]=v,e[13]=w):w=e[13],w}function Pd(t){return!!t}function Id(t){return t.image_result}const Xs=(t,e)=>t.images.length===e.images.length&&t.analyticsMetadata===e.analyticsMetadata&&t.trackContentReferenceEvent===e.trackContentReferenceEvent&&t.images.every((s,n)=>{var r,a;return((r=s.image_result)==null?void 0:r.content_url)===((a=e.images[n].image_result)==null?void 0:a.content_url)}),Ad=p.memo($d,Xs),Ld=3,ls={width:5,height:4};function Rd(t){"use forget";var _;const e=he.c(23),{images:s,analyticsMetadata:n,trackContentReferenceEvent:r,isReferenceComplete:a}=t,i=bt(),l=s.length;let c;e[0]!==s?(c=s.map(Fd).filter(Dd),e[0]=s,e[1]=c):c=e[1];const d=c;if(l===0)return null;if(l===1){const v=s[0];if(!v.image_result&&!a)return null;let w;e[2]===Symbol.for("react.memo_cache_sentinel")?(w=o.jsx("span",{"aria-hidden":!0,className:"clear-both m-0 block h-0 p-0"}),e[2]=w):w=e[2];const j=(_=v==null?void 0:v.image_result)!=null?_:void 0;let C;e[3]===Symbol.for("react.memo_cache_sentinel")?(C={imageUse:"imageGroup",layout:"single"},e[3]=C):C=e[3];let f;return e[4]!==n||e[5]!==j||e[6]!==r?(f=o.jsxs(o.Fragment,{children:[w,o.jsx(Oe,{image:j,imageSource:Je.ImageGroup,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:C,aspectRatio:Pt,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]",contentReferenceType:"image_group"})]}),e[4]=n,e[5]=j,e[6]=r,e[7]=f):f=e[7],f}const u=i?s.length:Math.min(s.length,Ld);let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=A("no-scrollbar flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",Gs),e[8]=m):m=e[8];let h;if(e[9]!==n||e[10]!==d||e[11]!==s||e[12]!==u||e[13]!==r){let v;e[15]!==n||e[16]!==d||e[17]!==s.length||e[18]!==u||e[19]!==r?(v=(w,j)=>{var f,y,k;const C=j===u-1;return o.jsx("div",{className:A("border-token-border-default relative w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-64 sm:w-[calc((100%-0.5rem)/3)]",j===0&&"rounded-s-xl",C&&"rounded-e-xl"),style:{aspectRatio:"".concat(ls.width,"/").concat(ls.height)},children:o.jsx(Oe,{image:(f=w.image_result)!=null?f:void 0,imageSource:Je.ImageGroup,lightboxImages:d,analyticsMetadata:n,trackContentReferenceEvent:r,eventMetadata:{imageUse:"imageGroup",layout:"carousel"},className:"h-full w-full",badge:C&&s.length>u&&o.jsx(or,{numImages:s.length}),aspectRatio:ls,contentReferenceType:"image_group"})},(k=(y=w.image_result)==null?void 0:y.thumbnail_url)!=null?k:"".concat(w.image_search_query,"-").concat(w.image_ref_id,"-").concat(j))},e[15]=n,e[16]=d,e[17]=s.length,e[18]=u,e[19]=r,e[20]=v):v=e[20],h=s.slice(0,u).map(v),e[9]=n,e[10]=d,e[11]=s,e[12]=u,e[13]=r,e[14]=h}else h=e[14];let x;return e[21]!==h?(x=o.jsx("div",{className:m,children:h}),e[21]=h,e[22]=x):x=e[22],x}function Dd(t){return!!t}function Fd(t){return t.image_result}const Od=p.memo(Rd,Xs);function zd(t){"use forget";var j;const e=he.c(14),{images:s,analyticsMetadata:n,trackContentReferenceEvent:r}=t,a=Vs();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={track:"height"},e[0]=i):i=e[0];const[l,c]=di(i),d=(j=l==null?void 0:l.height)!=null?j:null,u=a==null?void 0:a.onFullWidthImageHeightChange;let m,h;e[1]!==u||e[2]!==d?(m=()=>{!u||d==null||u(d)},h=[u,d],e[1]=u,e[2]=d,e[3]=m,e[4]=h):(m=e[3],h=e[4]),p.useEffect(m,h);let x;e[5]!==n||e[6]!==s||e[7]!==r?(x=s.map(C=>{var f;return{content:o.jsx(Oe,{image:(f=C.image_result)!=null?f:void 0,imageSource:Je.ImageGroup,aspectRatio:null,enableHoverAnimation:!1,analyticsMetadata:n,trackContentReferenceEvent:r,skeletonEl:o.jsx("div",{className:"bg-token-main-surface-tertiary aspect-[3/2] h-full w-full animate-pulse"}),lightboxImages:s.map(Hd).filter(Wd),className:"h-full w-full",contentReferenceType:"image_group",fadeInOnMount:!0})}}),e[5]=n,e[6]=s,e[7]=r,e[8]=x):x=e[8];const _=x;let v;e[9]!==_?(v=o.jsx(kd,{images:_,aspect:"aspect-[5/4]",showDots:!0}),e[9]=_,e[10]=v):v=e[10];let w;return e[11]!==c||e[12]!==v?(w=o.jsx("div",{ref:c,className:"-mx-6 mt-[calc(-1rem-3px)] pb-5",children:v}),e[11]=c,e[12]=v,e[13]=w):w=e[13],w}function Wd(t){return!!t}function Hd(t){return t.image_result}const Bd=p.memo(zd,Xs);function Vd(t){"use forget";const e=he.c(21),{images:s,imageSource:n,superWidgetContent:r,lastUserMsgOfPrevTurn:a,analyticsMetadata:i,trackContentReferenceEvent:l,isReferenceComplete:c}=t,d=xe(),u=We(d);let m;e[0]!==d?(m=()=>Xt(d),e[0]=d,e[1]=m):m=e[1];const h=Ve(m);let x;e[2]!==s||e[3]!==c||e[4]!==a||e[5]!==r?(x={images:s,lastUserMsgOfPrevTurn:a,superWidgetContent:r,isContentReferenceComplete:c},e[2]=s,e[3]=c,e[4]=a,e[5]=r,e[6]=x):x=e[6];const{items:_,isLoading:v}=hd(x),w=v&&u?nr:0,j=qd,C=h?"-mx-[var(--thread-content-margin)]":"-mx-6";let f;e[7]!==C?(f=A("relative mb-6",Gs,C),e[7]=C,e[8]=f):f=e[8];let y;e[9]!==i||e[10]!==n||e[11]!==_||e[12]!==l?(y=M=>o.jsx(Oe,{image:M,imageSource:n,analyticsMetadata:i,trackContentReferenceEvent:l,className:"aspect-auto h-full w-full",aspectRatio:null,contentReferenceType:"image_group",lightboxImages:_}),e[9]=i,e[10]=n,e[11]=_,e[12]=l,e[13]=y):y=e[13];const k=_.length===0?4:w;let S;e[14]!==_||e[15]!==y||e[16]!==k?(S=o.jsx(Yt,{items:_,getItemKey:Ud,itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)]",loadingItemClassName:"min-w-[240px]",getItemStyle:j,onRenderItem:y,className:"h-48 min-h-48",numLoadingItems:k}),e[14]=_,e[15]=y,e[16]=k,e[17]=S):S=e[17];let N;return e[18]!==f||e[19]!==S?(N=o.jsx("div",{className:f,children:S}),e[18]=f,e[19]=S,e[20]=N):N=e[20],N}function Ud(t){return t.thumbnail_url}function qd(t){const{width:e,height:s}=t.content_size;return{width:s?e/s*192:180}}const Gd=200,Xd=100,Nt=mt({id:"imagePill.screenshot",defaultMessage:"screenshot"}),rr="m-0 p-[2px] pe-1",Zd=A(rr,"h-full rounded-lg object-contain"),Yd=A(rr,"p-[4px]");function Sn({image:t}){const[e,s]=p.useState(!1),n=Hs.useStore(),r=p.useRef(null),a=p.useRef(null),i=le(),l=t==null?void 0:t.content_url,c=p.useMemo(()=>l?Kt(l,"hostname"):null,[l]),d=p.useCallback(()=>{r.current&&clearTimeout(r.current)},[]),u=p.useCallback(()=>{t&&(d(),s(!1),n.setCurrentImage({image:t}))},[n,t,d]),m=p.useCallback(()=>{a.current&&clearTimeout(a.current)},[]),h=p.useCallback(()=>{s(!1)},[s]),x=p.useCallback(w=>{w.stopPropagation(),m(),r.current=setTimeout(()=>{s(!0)},Gd)},[m]),_=p.useCallback(w=>{w.stopPropagation(),d(),a.current=setTimeout(()=>{h()},Xd)},[d,h]);p.useEffect(()=>{e&&m()},[e,m]);const v=p.useMemo(()=>({onBlur:_,onMouseLeave:_,onMouseEnter:x,onFocus:x}),[_,x]);return t?o.jsxs("span",U(D({onClick:u,className:"relative"},v),{children:[o.jsxs(Nn,{isOpen:e,children:[o.jsx("img",{className:Zd,src:t.thumbnail_url}),o.jsx("span",{children:c!=null?c:i.formatMessage(Nt)})]}),e&&o.jsx("div",{className:"absolute start-0 z-50",children:o.jsxs("div",U(D({className:A("text-token-text-secondary border-token-border-light w-[256px] cursor-pointer px-3 pt-2 pb-3 text-sm shadow-md outline-[0.5px] outline-black/5",ha)},v),{children:[o.jsxs(Qe,{href:t.content_url,target:"_blank",rel:"noopener",className:"z-50 mb-2 flex items-center gap-2 hover:opacity-70",onClick:w=>w.stopPropagation(),children:[o.jsx($t,{url:t.content_url,className:"m-0 size-4 p-0",size:32}),c!=null?c:i.formatMessage(Nt)]}),o.jsx("img",{className:"border-token-border-light m-0 cursor-pointer rounded-lg object-contain p-0 outline-[0.5px] outline-black/5",src:t.thumbnail_url,alt:c!=null?c:i.formatMessage(Nt),onClick:w=>{w.preventDefault(),u()}})]}))})]})):o.jsxs(Nn,{isOpen:!1,children:[o.jsx("span",{className:Yd,children:o.jsx(yt,{})}),o.jsx("span",{children:c!=null?c:i.formatMessage(Nt)})]})}function Nn(n){var r=n,{children:t,isOpen:e}=r,s=Te(r,["children","isOpen"]);return o.jsx("span",U(D({className:A("ms-1 cursor-pointer","inline-flex max-w-full items-center","relative top-[0.2rem]","animate-[show_150ms_ease-in]")},s),{children:o.jsx("span",{className:A("text-token-text-secondary flex h-4.5 overflow-hidden rounded-xl bg-[#F4F4F4] pe-2 text-[0.5625em] font-medium dark:bg-[#303030]","hover:bg-token-text-primary! hover:text-token-text-inverted",e&&"bg-token-main-surface-tertiary text-token-text-secondary","transition-colors duration-150 ease-in-out","items-center justify-center"),children:t})}))}async function Kd({conversationId:t,messageId:e,assetPointerLinks:s,sharedConversationLikeId:n}){return await pa.safePost("/conversation/get_images_for_message",{requestBody:{conversation_id:t!=null?t:null,share_id:n!=null?n:null,message_id:e,asset_pointer_links:s},authOption:ga.SendIfAvailable})}function Jd({reference:t,conversationId:e,messageId:s,sharedConversationLikeId:n,isN7jupdMessage:r}){return Or(D({queryKey:["inline-images",t,e,s],queryFn:async()=>{if(!t.asset_pointer_links||t.asset_pointer_links.length===0||!e&&!n)return{images:[],formats:[]};const i=await Kd({conversationId:e,messageId:s,assetPointerLinks:t.asset_pointer_links,sharedConversationLikeId:n});for(let l=0;l<i.images.length;l++){const c=i.images[l],d=i.formats[l],u="image/".concat(d),m=Qd(c,u);i.images[l]=m}return i}},r?{retry:3,retryDelay:5e3}:{}))}function Qd(t,e="",s=512){const n=atob(t),r=[];for(let i=0;i<n.length;i+=s){const l=n.slice(i,i+s),c=new Array(l.length);for(let u=0;u<l.length;u++)c[u]=l.charCodeAt(u);const d=new Uint8Array(c);r.push(d)}const a=new Blob(r,{type:e});return URL.createObjectURL(a)}const eu=200;function tu({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:n}){var h;const r=Rs(e),{postId:a}=p.useContext(ui),{data:i,isLoading:l,isError:c,error:d}=Jd({reference:t,conversationId:r,messageId:s.id,sharedConversationLikeId:a,isN7jupdMessage:(h=s.metadata)==null?void 0:h.n7jupd_message}),u=p.useRef([]);p.useEffect(()=>()=>{u.current.forEach(x=>{URL.revokeObjectURL(x)}),u.current=[]},[]);const m=ar(s,t);return d||c||i&&!("images"in i)||l||!(i!=null&&i.images.length)?null:(u.current=[],o.jsx(o.Fragment,{children:i==null?void 0:i.images.map((x,_)=>{const v=ir(t,x,m);return o.jsx(qs,{metadata:v,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:n},"image-carousel-inline-".concat(_))})}))}const su=(t,e)=>{const s=new RegExp(e+"\\s*([^\\n]+)","m"),n=t.match(s);return n&&n[1]?n[1].trim().length:0};function ar(t,e){return p.useMemo(()=>{let s=-1;return t.content.content_type==="text"&&(s=su(t.content.parts.join(""),e.matched_text)),s<eu||s===-1},[t,e.matched_text])}function ir(t,e,s){var n,r,a;return{matched_text:t.matched_text,start_idx:t.start_idx,end_idx:t.end_idx,safe_urls:t.safe_urls,alt:t.alt,prompt_text:t.prompt_text,type:"image_v2",refs:[],images:[{url:e,content_url:(n=t.clicked_from_url)!=null?n:"",thumbnail_url:e,title:(r=t.clicked_from_title)!=null?r:"",attribution:Kt((a=t.clicked_from_url)!=null?a:e,"hostname"),content_size:{width:Mn,height:En},thumbnail_size:{width:Mn,height:En},is_proxied_image:!0,float_top:s}]}}const Mn=141,En=143;function nu({reference:t,clientThreadId:e,message:s,trackContentReferenceEvent:n}){var x,_,v,w,j;const r=((x=s.metadata)==null?void 0:x.n7jupd_message)&&t.matched_text.includes("screenshot"),a=Rs(e),i=(v=(_=p.useContext(mi))==null?void 0:_.serverSharedThreadId)!=null?v:void 0,l=fi(t.asset_pointer_links[0]),c=p.useMemo(()=>({content_type:bo.ImageAssetPointer,size_bytes:0,width:0,height:0,asset_pointer:l}),[l]),d=Do({asset:c,sharedThreadId:i,conversationId:a}),u=(w=d.data)==null?void 0:w.url,m=ar(s,t),h=p.useMemo(()=>u?ir(t,u,m):null,[u,t,m]);return d.error||d.isError?null:r&&!((j=d.data)!=null&&j.url)&&d.isLoading?o.jsx(Sn,{image:null},"image-pill-loading"):!r&&(d.isLoading||!d.data)||!h?null:r?o.jsx(Sn,{image:h.images[0]}):o.jsx(qs,{metadata:h,analyticsMetadata:{clientThreadId:e,messageId:s.id},numImageResults:1,trackContentReferenceEvent:n})}const Ce=1e-6;let it=typeof Float32Array<"u"?Float32Array:Array;function ou(){const t=new it(2);return it!=Float32Array&&(t[0]=0,t[1]=0),t}function Tn(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t}function ru(t,e){return t[0]=-e[0],t[1]=-e[1],t}function lr(t,e,s,n){const r=e[0],a=e[1];return t[0]=r+n*(s[0]-r),t[1]=a+n*(s[1]-a),t}(function(){const t=ou();return function(e,s,n,r,a,i){let l,c;for(s||(s=2),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],a(t,t,i),e[l]=t[0],e[l+1]=t[1];return e}})();function au(){const t=new it(3);return it!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function iu(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t}function lu(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t}function cu(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}const du=lu;(function(){const t=au();return function(e,s,n,r,a,i){let l,c;for(s||(s=3),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,i),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();function uu(t,e){const s=e[0],n=e[1],r=e[2],a=e[3],i=e[4],l=e[5],c=e[6],d=e[7],u=e[8],m=e[9],h=e[10],x=e[11],_=e[12],v=e[13],w=e[14],j=e[15],C=s*l-n*i,f=s*c-r*i,y=s*d-a*i,k=n*c-r*l,S=n*d-a*l,N=r*d-a*c,M=u*v-m*_,$=u*w-h*_,P=u*j-x*_,b=m*w-h*v,F=m*j-x*v,L=h*j-x*w;let T=C*L-f*F+y*b+k*P-S*$+N*M;return T?(T=1/T,t[0]=(l*L-c*F+d*b)*T,t[1]=(r*F-n*L-a*b)*T,t[2]=(v*N-w*S+j*k)*T,t[3]=(h*S-m*N-x*k)*T,t[4]=(c*P-i*L-d*$)*T,t[5]=(s*L-r*P+a*$)*T,t[6]=(w*y-_*N-j*f)*T,t[7]=(u*N-h*y+x*f)*T,t[8]=(i*F-l*P+d*M)*T,t[9]=(n*P-s*F-a*M)*T,t[10]=(_*S-v*y+j*C)*T,t[11]=(m*y-u*S-x*C)*T,t[12]=(l*$-i*b-c*M)*T,t[13]=(s*b-n*$+r*M)*T,t[14]=(v*f-_*k-w*C)*T,t[15]=(u*k-m*f+h*C)*T,t):null}function cs(t,e,s){const n=e[0],r=e[1],a=e[2],i=e[3],l=e[4],c=e[5],d=e[6],u=e[7],m=e[8],h=e[9],x=e[10],_=e[11],v=e[12],w=e[13],j=e[14],C=e[15];let f=s[0],y=s[1],k=s[2],S=s[3];return t[0]=f*n+y*l+k*m+S*v,t[1]=f*r+y*c+k*h+S*w,t[2]=f*a+y*d+k*x+S*j,t[3]=f*i+y*u+k*_+S*C,f=s[4],y=s[5],k=s[6],S=s[7],t[4]=f*n+y*l+k*m+S*v,t[5]=f*r+y*c+k*h+S*w,t[6]=f*a+y*d+k*x+S*j,t[7]=f*i+y*u+k*_+S*C,f=s[8],y=s[9],k=s[10],S=s[11],t[8]=f*n+y*l+k*m+S*v,t[9]=f*r+y*c+k*h+S*w,t[10]=f*a+y*d+k*x+S*j,t[11]=f*i+y*u+k*_+S*C,f=s[12],y=s[13],k=s[14],S=s[15],t[12]=f*n+y*l+k*m+S*v,t[13]=f*r+y*c+k*h+S*w,t[14]=f*a+y*d+k*x+S*j,t[15]=f*i+y*u+k*_+S*C,t}function Ns(t,e,s){const n=s[0],r=s[1],a=s[2];let i,l,c,d,u,m,h,x,_,v,w,j;return e===t?(t[12]=e[0]*n+e[4]*r+e[8]*a+e[12],t[13]=e[1]*n+e[5]*r+e[9]*a+e[13],t[14]=e[2]*n+e[6]*r+e[10]*a+e[14],t[15]=e[3]*n+e[7]*r+e[11]*a+e[15]):(i=e[0],l=e[1],c=e[2],d=e[3],u=e[4],m=e[5],h=e[6],x=e[7],_=e[8],v=e[9],w=e[10],j=e[11],t[0]=i,t[1]=l,t[2]=c,t[3]=d,t[4]=u,t[5]=m,t[6]=h,t[7]=x,t[8]=_,t[9]=v,t[10]=w,t[11]=j,t[12]=i*n+u*r+_*a+e[12],t[13]=l*n+m*r+v*a+e[13],t[14]=c*n+h*r+w*a+e[14],t[15]=d*n+x*r+j*a+e[15]),t}function cr(t,e,s){const n=s[0],r=s[1],a=s[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function mu(t,e,s){const n=Math.sin(s),r=Math.cos(s),a=e[4],i=e[5],l=e[6],c=e[7],d=e[8],u=e[9],m=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+d*n,t[5]=i*r+u*n,t[6]=l*r+m*n,t[7]=c*r+h*n,t[8]=d*r-a*n,t[9]=u*r-i*n,t[10]=m*r-l*n,t[11]=h*r-c*n,t}function fu(t,e,s){const n=Math.sin(s),r=Math.cos(s),a=e[0],i=e[1],l=e[2],c=e[3],d=e[4],u=e[5],m=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+d*n,t[1]=i*r+u*n,t[2]=l*r+m*n,t[3]=c*r+h*n,t[4]=d*r-a*n,t[5]=u*r-i*n,t[6]=m*r-l*n,t[7]=h*r-c*n,t}function hu(t,e,s,n,r){const a=1/Math.tan(e/2);if(t[0]=a/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0){const i=1/(n-r);t[10]=(r+n)*i,t[14]=2*r*n*i}else t[10]=-1,t[14]=-2*n;return t}const pu=hu;function $n(t,e){const s=t[0],n=t[1],r=t[2],a=t[3],i=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=t[9],h=t[10],x=t[11],_=t[12],v=t[13],w=t[14],j=t[15],C=e[0],f=e[1],y=e[2],k=e[3],S=e[4],N=e[5],M=e[6],$=e[7],P=e[8],b=e[9],F=e[10],L=e[11],T=e[12],E=e[13],z=e[14],G=e[15];return Math.abs(s-C)<=Ce*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(n-f)<=Ce*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-y)<=Ce*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-k)<=Ce*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(i-S)<=Ce*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(l-N)<=Ce*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(c-M)<=Ce*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(d-$)<=Ce*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(u-P)<=Ce*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(m-b)<=Ce*Math.max(1,Math.abs(m),Math.abs(b))&&Math.abs(h-F)<=Ce*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(x-L)<=Ce*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(_-T)<=Ce*Math.max(1,Math.abs(_),Math.abs(T))&&Math.abs(v-E)<=Ce*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(w-z)<=Ce*Math.max(1,Math.abs(w),Math.abs(z))&&Math.abs(j-G)<=Ce*Math.max(1,Math.abs(j),Math.abs(G))}function gu(){const t=new it(4);return it!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function xu(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t}function yu(t,e,s){const n=e[0],r=e[1],a=e[2],i=e[3];return t[0]=s[0]*n+s[4]*r+s[8]*a+s[12]*i,t[1]=s[1]*n+s[5]*r+s[9]*a+s[13]*i,t[2]=s[2]*n+s[6]*r+s[10]*a+s[14]*i,t[3]=s[3]*n+s[7]*r+s[11]*a+s[15]*i,t}(function(){const t=gu();return function(e,s,n,r,a,i){let l,c;for(s||(s=4),n||(n=0),r?c=Math.min(r*s+n,e.length):c=e.length,l=n;l<c;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,i),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();function It(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rt(t,e){const s=yu([],e,t);return xu(s,s,1/s[3]),s}function Ms(t,e,s){return t<e?e:t>s?s:t}function bu(t){return Math.log(t)*Math.LOG2E}const _u=Math.log2||bu;function Be(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const $e=Math.PI,dr=$e/4,Ae=$e/180,Es=180/$e,gt=512,Pn=4003e4,Mt=85.051129,ur=1.5;function vu(t){return Math.pow(2,t)}function ot(t){const[e,s]=t;Be(Number.isFinite(e)),Be(Number.isFinite(s)&&s>=-90&&s<=90,"invalid latitude");const n=e*Ae,r=s*Ae,a=gt*(n+$e)/(2*$e),i=gt*($e+Math.log(Math.tan(dr+r*.5)))/(2*$e);return[a,i]}function ht(t){const[e,s]=t,n=e/gt*(2*$e)-$e,r=2*(Math.atan(Math.exp(s/gt*(2*$e)-$e))-dr);return[n*Es,r*Es]}function wu(t){const{latitude:e,longitude:s,highPrecision:n=!1}=t;Be(Number.isFinite(e)&&Number.isFinite(s));const r=gt,a=Math.cos(e*Ae),i=r/360,l=i/a,c=r/Pn/a,d={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[i,l,c],degreesPerUnit:[1/i,1/l,1/c]};if(n){const u=Ae*Math.tan(e*Ae)/a,m=i*u/2,h=r/Pn*u,x=h/l*c;d.unitsPerDegree2=[0,m,h],d.unitsPerMeter2=[x,0,x]}return d}function ju(t){const{height:e,pitch:s,bearing:n,altitude:r,scale:a,center:i}=t,l=It();Ns(l,l,[0,0,-r]),mu(l,l,-s*Ae),fu(l,l,n*Ae);const c=a/e;return cr(l,l,[c,c,c]),i&&Ns(l,l,cu([],i)),l}function ku(t){const{width:e,height:s,altitude:n,pitch:r=0,offset:a,center:i,scale:l,nearZMultiplier:c=1,farZMultiplier:d=1}=t;let{fovy:u=Rt(ur)}=t;n!==void 0&&(u=Rt(n));const m=u*Ae,h=r*Ae,x=mr(u);let _=x;i&&(_+=i[2]*l/Math.cos(h)/s);const v=m*(.5+(a?a[1]:0)/s),w=Math.sin(v)*_/Math.sin(Ms(Math.PI/2-h-v,.01,Math.PI-.01)),j=Math.sin(h)*w+_,C=_*10,f=Math.min(j*d,C);return{fov:m,aspect:e/s,focalDistance:x,near:c,far:f}}function Cu(t){const{fov:e,aspect:s,near:n,far:r}=ku(t);return pu([],e,s,n,r)}function Rt(t){return 2*Math.atan(.5/t)*Es}function mr(t){return .5/Math.tan(.5*t*Ae)}function Su(t,e){const[s,n,r=0]=t;return Be(Number.isFinite(s)&&Number.isFinite(n)&&Number.isFinite(r)),rt(e,[s,n,r,1])}function In(t,e,s=0){const[n,r,a]=t;if(Be(Number.isFinite(n)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(a))return rt(e,[n,r,a,1]);const i=rt(e,[n,r,0,1]),l=rt(e,[n,r,1,1]),c=i[2],d=l[2],u=c===d?0:((s||0)-c)/(d-c);return lr([],i,l,u)}function Nu(t){const{width:e,height:s,bounds:n,minExtent:r=0,maxZoom:a=24,offset:i=[0,0]}=t,[[l,c],[d,u]]=n,m=Mu(t.padding),h=ot([l,Ms(u,-Mt,Mt)]),x=ot([d,Ms(c,-Mt,Mt)]),_=[Math.max(Math.abs(x[0]-h[0]),r),Math.max(Math.abs(x[1]-h[1]),r)],v=[e-m.left-m.right-Math.abs(i[0])*2,s-m.top-m.bottom-Math.abs(i[1])*2];Be(v[0]>0&&v[1]>0);const w=v[0]/_[0],j=v[1]/_[1],C=(m.right-m.left)/2/w,f=(m.top-m.bottom)/2/j,y=[(x[0]+h[0])/2+C,(x[1]+h[1])/2+f],k=ht(y),S=Math.min(a,_u(Math.abs(Math.min(w,j))));return Be(Number.isFinite(S)),{longitude:k[0],latitude:k[1],zoom:S}}function Mu(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Be(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const An=Math.PI/180;function Eu(t,e=0){const{width:s,height:n,unproject:r}=t,a={targetZ:e},i=r([0,n],a),l=r([s,n],a);let c,d;const u=t.fovy?.5*t.fovy*An:Math.atan(.5/t.altitude),m=(90-t.pitch)*An;return u>m-.01?(c=Ln(t,0,e),d=Ln(t,s,e)):(c=r([0,0],a),d=r([s,0],a)),[i,l,d,c]}function Ln(t,e,s){const{pixelUnprojectionMatrix:n}=t,r=rt(n,[e,0,1,1]),a=rt(n,[e,t.height,1,1]),l=(s*t.distanceScales.unitsPerMeter[2]-r[2])/(a[2]-r[2]),c=lr([],r,a,l),d=ht(c);return d.push(s),d}class Dt{constructor(e={width:1,height:1}){this.equals=j=>j instanceof Dt?j.width===this.width&&j.height===this.height&&$n(j.projectionMatrix,this.projectionMatrix)&&$n(j.viewMatrix,this.viewMatrix):!1,this.project=(j,C={})=>{const{topLeft:f=!0}=C,y=this.projectPosition(j),k=Su(y,this.pixelProjectionMatrix),[S,N]=k,M=f?N:this.height-N;return j.length===2?[S,M]:[S,M,k[2]]},this.unproject=(j,C={})=>{const{topLeft:f=!0,targetZ:y=void 0}=C,[k,S,N]=j,M=f?S:this.height-S,$=y&&y*this.distanceScales.unitsPerMeter[2],P=In([k,M,N],this.pixelUnprojectionMatrix,$),[b,F,L]=this.unprojectPosition(P);return Number.isFinite(N)?[b,F,L]:Number.isFinite(y)?[b,F,y]:[b,F]},this.projectPosition=j=>{const[C,f]=ot(j),y=(j[2]||0)*this.distanceScales.unitsPerMeter[2];return[C,f,y]},this.unprojectPosition=j=>{const[C,f]=ht(j),y=(j[2]||0)*this.distanceScales.metersPerUnit[2];return[C,f,y]};let{width:s,height:n,altitude:r=null,fovy:a=null}=e;const{latitude:i=0,longitude:l=0,zoom:c=0,pitch:d=0,bearing:u=0,position:m=null,nearZMultiplier:h=.02,farZMultiplier:x=1.01}=e;s=s||1,n=n||1,a===null&&r===null?(r=ur,a=Rt(r)):a===null?a=Rt(r):r===null&&(r=mr(a));const _=vu(c);r=Math.max(.75,r);const v=wu({longitude:l,latitude:i}),w=ot([l,i]);w.push(0),m&&iu(w,w,du([],m,v.unitsPerMeter)),this.projectionMatrix=Cu({width:s,height:n,scale:_,center:w,pitch:d,fovy:a,nearZMultiplier:h,farZMultiplier:x}),this.viewMatrix=ju({height:n,scale:_,center:w,pitch:d,bearing:u,altitude:r}),this.width=s,this.height=n,this.scale=_,this.latitude=i,this.longitude=l,this.zoom=c,this.pitch=d,this.bearing=u,this.altitude=r,this.fovy=a,this.center=w,this.meterOffset=m||[0,0,0],this.distanceScales=v,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:s,projectionMatrix:n,viewMatrix:r}=this,a=It();cs(a,a,n),cs(a,a,r),this.viewProjectionMatrix=a;const i=It();cr(i,i,[e/2,-s/2,1]),Ns(i,i,[1,-1,0]),cs(i,i,a);const l=uu(It(),i);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=i,this.pixelUnprojectionMatrix=l}projectFlat(e){return ot(e)}unprojectFlat(e){return ht(e)}getMapCenterByLngLatPosition({lngLat:e,pos:s}){const n=In(s,this.pixelUnprojectionMatrix),r=ot(e),a=Tn([],r,ru([],n)),i=Tn([],this.center,a);return ht(i)}fitBounds(e,s={}){const{width:n,height:r}=this,{longitude:a,latitude:i,zoom:l}=Nu(Object.assign({width:n,height:r,bounds:e},s));return new Dt({width:n,height:r,longitude:a,latitude:i,zoom:l})}getBounds(e){const s=this.getBoundingRegion(e),n=Math.min(...s.map(l=>l[0])),r=Math.max(...s.map(l=>l[0])),a=Math.min(...s.map(l=>l[1])),i=Math.max(...s.map(l=>l[1]));return[[n,a],[r,i]]}getBoundingRegion(e={}){return Eu(this,e.z||0)}getLocationAtPoint({lngLat:e,pos:s}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:s})}}function Tu(t,e,s={}){const n={type:"Feature"};return(s.id===0||s.id)&&(n.id=s.id),s.bbox&&(n.bbox=s.bbox),n.properties=e||{},n.geometry=t,n}function fr(t,e,s={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Rn(t[0])||!Rn(t[1]))throw new Error("coordinates must contain numbers");return Tu({type:"Point",coordinates:t},e,s)}function $u(t,e={}){const s={type:"FeatureCollection"};return e.id&&(s.id=e.id),e.bbox&&(s.bbox=e.bbox),s.features=t,s}function Rn(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function hr(t,e,s){if(t!==null)for(var n,r,a,i,l,c,d,u=0,m=0,h,x=t.type,_=x==="FeatureCollection",v=x==="Feature",w=_?t.features.length:1,j=0;j<w;j++){d=_?t.features[j].geometry:v?t.geometry:t,h=d?d.type==="GeometryCollection":!1,l=h?d.geometries.length:1;for(var C=0;C<l;C++){var f=0,y=0;if(i=h?d.geometries[C]:d,i!==null){c=i.coordinates;var k=i.type;switch(u=0,k){case null:break;case"Point":if(e(c,m,j,f,y)===!1)return!1;m++,f++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],m,j,f,y)===!1)return!1;m++,k==="MultiPoint"&&f++}k==="LineString"&&f++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(r=0;r<c[n].length-u;r++){if(e(c[n][r],m,j,f,y)===!1)return!1;m++}k==="MultiLineString"&&f++,k==="Polygon"&&y++}k==="Polygon"&&f++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(y=0,r=0;r<c[n].length;r++){for(a=0;a<c[n][r].length-u;a++){if(e(c[n][r][a],m,j,f,y)===!1)return!1;m++}y++}f++}break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(hr(i.geometries[n],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function pr(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const s=[1/0,1/0,-1/0,-1/0];return hr(t,n=>{s[0]>n[0]&&(s[0]=n[0]),s[1]>n[1]&&(s[1]=n[1]),s[2]<n[0]&&(s[2]=n[0]),s[3]<n[1]&&(s[3]=n[1])}),s}var Pu=pr;function Iu(t,e={}){const s=pr(t),n=(s[0]+s[2])/2,r=(s[1]+s[3])/2;return fr([n,r],e.properties,e)}var Au=Iu,ds,Dn;function Lu(){if(Dn)return ds;Dn=1;var t=xa(),e=ya(),s=ba(),n=_a(),r=t.isFinite,a=Math.min;function i(l){var c=Math[l];return function(d,u){if(d=s(d),u=u==null?0:a(e(u),292),u&&r(d)){var m=(n(d)+"e").split("e"),h=c(m[0]+"e"+(+m[1]+u));return m=(n(h)+"e").split("e"),+(m[0]+"e"+(+m[1]-u))}return c(d)}}return ds=i,ds}var us,Fn;function Ru(){if(Fn)return us;Fn=1;var t=Lu(),e=t("round");return us=e,us}var Du=Ru();const He=zr(Du),Fu=p.createContext(null);function Ou(t,e){const s=Array.isArray(t)?t[0]:t?t.x:0,n=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return s===r&&n===a}function Fe(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!Fe(t[s],e[s]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const s=Object.keys(t),n=Object.keys(e);if(s.length!==n.length)return!1;for(const r of s)if(!e.hasOwnProperty(r)||!Fe(t[r],e[r]))return!1;return!0}return!1}function zu(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function On(t,e){if(!t.getProjection)return;const s=t.getProjection(),n=e.getProjection();Fe(s,n)||e.setProjection(s)}function zn(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Wn(t,e){const s=e.viewState||e;let n=!1;if("longitude"in s&&"latitude"in s){const r=t.center;t.center=new r.constructor(s.longitude,s.latitude),n=n||r!==t.center}if("zoom"in s){const r=t.zoom;t.zoom=s.zoom,n=n||r!==t.zoom}if("bearing"in s){const r=t.bearing;t.bearing=s.bearing,n=n||r!==t.bearing}if("pitch"in s){const r=t.pitch;t.pitch=s.pitch,n=n||r!==t.pitch}return s.padding&&!t.isPaddingEqual(s.padding)&&(n=!0,t.padding=s.padding),n}const Wu=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Hn(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const n of t.layers)e[n.id]=n;const s=t.layers.map(n=>{let r=null;"interactive"in n&&(r=Object.assign({},n),delete r.interactive);const a=e[n.ref];if(a){r=r||Object.assign({},n),delete r.ref;for(const i of Wu)i in a&&(r[i]=a[i])}return r||n});return U(D({},t),{layers:s})}var Bn={};const Vn={version:8,sources:{},layers:[]},Un={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ms={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},qn={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Hu=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Bu=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class lt{constructor(e,s,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const a=this.props[qn[r.type]];a?a(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const a=this.props[Un[r.type]];a&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),a(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const a=this.props[ms[r.type]];a&&a(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=s,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const s=this.props;this.props=e;const n=this._updateSettings(e,s);n&&this._createShadowTransform(this._map);const r=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,s),this._updateStyleComponents(e,s),this._updateHandlers(e,s),(n||r||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,s){const n=lt.savedMaps.pop();if(!n)return null;const r=n.map,a=r.getContainer();for(s.className=a.className;a.childNodes.length>0;)s.appendChild(a.childNodes[0]);r._container=s;const i=r._resizeObserver;i&&(i.disconnect(),i.observe(s)),n.setProps(U(D({},e),{styleDiffing:!1})),r.resize();const{initialViewState:l}=e;return l&&(l.bounds?r.fitBounds(l.bounds,U(D({},l.fitBoundsOptions),{duration:0})):n._updateViewState(l,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),n}_initialize(e){const{props:s}=this,{mapStyle:n=Vn}=s,r=U(D(D({},s),s.initialViewState),{accessToken:s.mapboxAccessToken||Vu()||null,container:e,style:Hn(n)}),a=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),s.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,s.gl)}const i=new this._MapClass(r);a.padding&&i.setPadding(a.padding),s.cursor&&(i.getCanvas().style.cursor=s.cursor),this._createShadowTransform(i);const l=i._render;i._render=u=>{this._inRender=!0,l.call(i,u),this._inRender=!1};const c=i._renderTaskQueue.run;i._renderTaskQueue.run=u=>{c.call(i._renderTaskQueue,u),this._onBeforeRepaint()},i.on("render",()=>this._onAfterRepaint());const d=i.fire;i.fire=this._fireEvent.bind(this,d),i.on("resize",()=>{this._renderTransform.resize(i.transform.width,i.transform.height)}),i.on("styledata",()=>{this._updateStyleComponents(this.props,{}),On(i.transform,this._renderTransform)}),i.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in Un)i.on(u,this._onPointerEvent);for(const u in ms)i.on(u,this._onCameraEvent);for(const u in qn)i.on(u,this._onEvent);this._map=i}recycle(){const s=this.map.getContainer().querySelector("[mapboxgl-children]");s==null||s.remove(),lt.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const s=zu(e.transform);e.painter.transform=s,this._renderTransform=s}_updateSize(e){const{viewState:s}=e;if(s){const n=this._map;if(s.width!==n.transform.width||s.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(e,s){if(this._internalUpdate)return!1;const n=this._map,r=this._renderTransform,{zoom:a,pitch:i,bearing:l}=r,c=n.isMoving();c&&(r.cameraElevationReference="sea");const d=Wn(r,D(D({},zn(n.transform)),e));if(c&&(r.cameraElevationReference="ground"),d&&s){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=a!==r.zoom),u.rotate||(u.rotate=l!==r.bearing),u.pitch||(u.pitch=i!==r.pitch)}return c||Wn(n.transform,e),d}_updateSettings(e,s){const n=this._map;let r=!1;for(const a of Hu)if(a in e&&!Fe(e[a],s[a])){r=!0;const i=n["set".concat(a[0].toUpperCase()).concat(a.slice(1))];i==null||i.call(n,e[a])}return r}_updateStyle(e,s){if(e.cursor!==s.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==s.mapStyle){const{mapStyle:n=Vn,styleDiffing:r=!0}=e,a={diff:r};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Hn(n),a),!0}return!1}_updateStyleComponents(e,s){const n=this._map;let r=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!Fe(e.light,s.light)&&(r=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!Fe(e.fog,s.fog)&&(r=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!Fe(e.terrain,s.terrain)&&(!e.terrain||n.getSource(e.terrain.source))&&(r=!0,n.setTerrain(e.terrain))),r}_updateHandlers(e,s){var n,r;const a=this._map;let i=!1;for(const l of Bu){const c=(n=e[l])!==null&&n!==void 0?n:!0,d=(r=s[l])!==null&&r!==void 0?r:!0;Fe(c,d)||(i=!0,c?a[l].enable(c):a[l].disable())}return i}_queryRenderedFeatures(e){const s=this._map,n=s.transform,{interactiveLayerIds:r=[]}=this.props;try{return s.transform=this._renderTransform,s.queryRenderedFeatures(e,{layers:r.filter(s.getLayer.bind(s))})}catch(a){return[]}finally{s.transform=n}}_updateHover(e){var s;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=e.type,i=((s=this._hoveredFeatures)===null||s===void 0?void 0:s.length)>0,l=this._queryRenderedFeatures(e.point),c=l.length>0;!c&&i&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,c&&!i&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,s,n){const r=this._map,a=r.transform,i=typeof s=="string"?s:s.type;return i==="move"&&this._updateViewState(this.props,!1),i in ms&&(typeof s=="object"&&(s.viewState=zn(a)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,s,n),r.transform=a,r):(e.call(r,s,n),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const s=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{On(this._renderTransform,s),e.transform=s}}}lt.savedMaps=[];function Vu(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||Bn.MapboxAccessToken}catch(e){}try{t=t||Bn.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(e){}return t}const Uu=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function qu(t){if(!t)return null;const e=t.map,s={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:n=>{const r=e.transform;e.transform=t.transform;const a=e.project(n);return e.transform=r,a},unproject:n=>{const r=e.transform;e.transform=t.transform;const a=e.unproject(n);return e.transform=r,a},queryTerrainElevation:(n,r)=>{const a=e.transform;e.transform=t.transform;const i=e.queryTerrainElevation(n,r);return e.transform=a,i},queryRenderedFeatures:(n,r)=>{const a=e.transform;e.transform=t.transform;const i=e.queryRenderedFeatures(n,r);return e.transform=a,i}};for(const n of Gu(e))!(n in s)&&!Uu.includes(n)&&(s[n]=e[n].bind(e));return s}function Gu(t){const e=new Set;let s=t;for(;s;){for(const n of Object.getOwnPropertyNames(s))n[0]!=="_"&&typeof t[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&e.add(n);s=Object.getPrototypeOf(s)}return Array.from(e)}const Xu=typeof document<"u"?p.useLayoutEffect:p.useEffect,Zu=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Yu(t,e){for(const n of Zu)n in e&&(t[n]=e[n]);const{RTLTextPlugin:s="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;s&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(s,n=>{n&&console.error(n)},!0)}const Qt=p.createContext(null);function Ku(t,e,s){const n=p.useContext(Fu),[r,a]=p.useState(null),i=p.useRef(),{current:l}=p.useRef({mapLib:null,map:null});p.useEffect(()=>{const u=t.mapLib;let m=!0,h;return Promise.resolve(u||s).then(x=>{if(!m)return;if(!x)throw new Error("Invalid mapLib");const _="Map"in x?x:x.default;if(!_.Map)throw new Error("Invalid mapLib");if(Yu(_,t),!_.supported||_.supported(t))t.reuseMaps&&(h=lt.reuse(t,i.current)),h||(h=new lt(_.Map,t,i.current)),l.map=qu(h),l.mapLib=_,a(h),n==null||n.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(x=>{const{onError:_}=t;_?_({type:"error",target:null,originalEvent:null,error:x}):console.error(x)}),()=>{m=!1,h&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),Xu(()=>{r&&r.setProps(t)}),p.useImperativeHandle(e,()=>l.map,[r]);const c=p.useMemo(()=>D({position:"relative",width:"100%",height:"100%"},t.style),[t.style]),d={height:"100%"};return p.createElement("div",{id:t.id,ref:i,style:c},r&&p.createElement(Qt.Provider,{value:l},p.createElement("div",{"mapboxgl-children":"",style:d},t.children)))}const Ju=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function et(t,e){if(!t||!e)return;const s=t.style;for(const n in e){const r=e[n];Number.isFinite(r)&&!Ju.test(n)?s[n]="".concat(r,"px"):s[n]=r}}function Qu(t,e){const{map:s,mapLib:n}=p.useContext(Qt),r=p.useRef({props:t});r.current.props=t;const a=p.useMemo(()=>{let v=!1;p.Children.forEach(t.children,C=>{C&&(v=!0)});const w=U(D({},t),{element:v?document.createElement("div"):null}),j=new n.Marker(w);return j.setLngLat([t.longitude,t.latitude]),j.getElement().addEventListener("click",C=>{var f,y;(y=(f=r.current.props).onClick)===null||y===void 0||y.call(f,{type:"click",target:j,originalEvent:C})}),j.on("dragstart",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDragStart)===null||y===void 0||y.call(f,k)}),j.on("drag",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDrag)===null||y===void 0||y.call(f,k)}),j.on("dragend",C=>{var f,y;const k=C;k.lngLat=a.getLngLat(),(y=(f=r.current.props).onDragEnd)===null||y===void 0||y.call(f,k)}),j},[]);p.useEffect(()=>(a.addTo(s.getMap()),()=>{a.remove()}),[]);const{longitude:i,latitude:l,offset:c,style:d,draggable:u=!1,popup:m=null,rotation:h=0,rotationAlignment:x="auto",pitchAlignment:_="auto"}=t;return p.useEffect(()=>{et(a.getElement(),d)},[d]),p.useImperativeHandle(e,()=>a,[]),(a.getLngLat().lng!==i||a.getLngLat().lat!==l)&&a.setLngLat([i,l]),c&&!Ou(a.getOffset(),c)&&a.setOffset(c),a.isDraggable()!==u&&a.setDraggable(u),a.getRotation()!==h&&a.setRotation(h),a.getRotationAlignment()!==x&&a.setRotationAlignment(x),a.getPitchAlignment()!==_&&a.setPitchAlignment(_),a.getPopup()!==m&&a.setPopup(m),Ps.createPortal(t.children,a.getElement())}const em=p.memo(p.forwardRef(Qu));function Gn(t){return new Set(t?t.trim().split(/\s+/):[])}function tm(t,e){const{map:s,mapLib:n}=p.useContext(Qt),r=p.useMemo(()=>document.createElement("div"),[]),a=p.useRef({props:t});a.current.props=t;const i=p.useMemo(()=>{const l=D({},t),c=new n.Popup(l);return c.setLngLat([t.longitude,t.latitude]),c.once("open",d=>{var u,m;(m=(u=a.current.props).onOpen)===null||m===void 0||m.call(u,d)}),c},[]);if(p.useEffect(()=>{const l=c=>{var d,u;(u=(d=a.current.props).onClose)===null||u===void 0||u.call(d,c)};return i.on("close",l),i.setDOMContent(r).addTo(s.getMap()),()=>{i.off("close",l),i.isOpen()&&i.remove()}},[]),p.useEffect(()=>{et(i.getElement(),t.style)},[t.style]),p.useImperativeHandle(e,()=>i,[]),i.isOpen()&&((i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!Fe(i.options.offset,t.offset)&&i.setOffset(t.offset),(i.options.anchor!==t.anchor||i.options.maxWidth!==t.maxWidth)&&(i.options.anchor=t.anchor,i.setMaxWidth(t.maxWidth)),i.options.className!==t.className)){const l=Gn(i.options.className),c=Gn(t.className);for(const d of l)c.has(d)||i.removeClassName(d);for(const d of c)l.has(d)||i.addClassName(d);i.options.className=t.className}return Ps.createPortal(t.children,r)}p.memo(p.forwardRef(tm));function ct(t,e,s,n){const r=p.useContext(Qt),a=p.useMemo(()=>t(r),[]);return p.useEffect(()=>{const i=e,l=typeof e=="function"?e:null,{map:c}=r;return c.hasControl(a)||c.addControl(a,i==null?void 0:i.position),()=>{l&&l(r),c.hasControl(a)&&c.removeControl(a)}},[]),a}function sm(t){const e=ct(({mapLib:s})=>new s.AttributionControl(t),{position:t.position});return p.useEffect(()=>{et(e._container,t.style)},[t.style]),null}p.memo(sm);function nm(t){const e=ct(({mapLib:s})=>new s.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return p.useEffect(()=>{et(e._controlContainer,t.style)},[t.style]),null}p.memo(nm);function om(t,e){const s=p.useRef({props:t}),n=ct(({mapLib:r})=>{const a=new r.GeolocateControl(t),i=a._setupUI;return a._setupUI=l=>{a._container.hasChildNodes()||i(l)},a.on("geolocate",l=>{var c,d;(d=(c=s.current.props).onGeolocate)===null||d===void 0||d.call(c,l)}),a.on("error",l=>{var c,d;(d=(c=s.current.props).onError)===null||d===void 0||d.call(c,l)}),a.on("outofmaxbounds",l=>{var c,d;(d=(c=s.current.props).onOutOfMaxBounds)===null||d===void 0||d.call(c,l)}),a.on("trackuserlocationstart",l=>{var c,d;(d=(c=s.current.props).onTrackUserLocationStart)===null||d===void 0||d.call(c,l)}),a.on("trackuserlocationend",l=>{var c,d;(d=(c=s.current.props).onTrackUserLocationEnd)===null||d===void 0||d.call(c,l)}),a},{position:t.position});return s.current.props=t,p.useImperativeHandle(e,()=>n,[]),p.useEffect(()=>{et(n._container,t.style)},[t.style]),null}p.memo(p.forwardRef(om));function rm(t){const e=ct(({mapLib:s})=>new s.NavigationControl(t),{position:t.position});return p.useEffect(()=>{et(e._container,t.style)},[t.style]),null}const am=p.memo(rm);function im(t){const e=ct(({mapLib:a})=>new a.ScaleControl(t),{position:t.position}),s=p.useRef(t),n=s.current;s.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==n.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==n.unit&&e.setUnit(t.unit),p.useEffect(()=>{et(e._container,r)},[r]),null}p.memo(im);const lm=X(()=>import("./if8tezek9xcjkt0r.js").then(t=>t.m),__vite__mapDeps([24,1])),cm=p.forwardRef(function(e,s){return Ku(e,s,lm)}),dm=em,um=am,mm=Z(()=>X(()=>import("./eblm0a618bl6wf18.js"),__vite__mapDeps([25,1])),{loading:t=>Q(t)}),gr=Z(()=>X(()=>import("./ip1a99ta06lqiwzj.js"),__vite__mapDeps([26,1])),{loading:t=>Q(t)}),fm=Z(()=>X(()=>import("./k4byn8m0gei390jf.js"),__vite__mapDeps([27,1])),{loading:t=>Q(t)}),hm=Z(()=>X(()=>import("./ht149o3c8qgexr92.js"),__vite__mapDeps([28,1])),{loading:t=>Q(t)}),pm=Z(()=>X(()=>import("./decxj0nfuivtbs7k.js"),__vite__mapDeps([29,1])),{loading:t=>Q(t)}),gm=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zz),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),xm=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zE),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)});function es({business:t,showHourDetail:e}){const s=le();if(t.is_closed_permanently)return o.jsx("span",{className:"text-red-600",children:o.jsx(H,{id:"businessMetadata.closedPermanently",defaultMessage:"Closed Permanently"})},"closed_permanently");const n=t.next_open_hour,r=t.is_open!==void 0&&t.is_open!=null?t.is_open?o.jsx("span",{className:"text-green-600",children:o.jsx(H,{id:"businessMetadata.openHourDetail",defaultMessage:"Open"})},"open"):o.jsx("span",{children:o.jsx(H,{id:"businessMetadata.closedStatus",defaultMessage:"Closed"})},"closed"):null;if(!e||!n)return r;const a=n.day===new Date().getDay(),i=Ts(s,t.is_open?n.end:n.start),l=a?s.formatMessage({id:"Adun59",defaultMessage:"{openClosedText} until {time}"},{openClosedText:r,time:i}):s.formatMessage({id:"tMworT",defaultMessage:"{openClosedText} until {day} {time}"},{openClosedText:r,day:yr(s,n.day),time:i});return o.jsx("div",{children:l&&o.jsx("span",{children:l})})}function ym({business:t,isLoading:e=!1,mapUrl:s,showTitle:n=!1,showPrice:r=!0,showHourDetail:a=!0,showActionButtons:i=!0,showActionButtonsIcons:l=!1,showExtendedDetails:c=!1,trackContentReferenceEvent:d,topOffset:u=0}){const m=!(a&&t.next_open_hour)||t.is_closed_permanently;return o.jsxs("div",{className:A("text-token-text-primary bg-token-bg-primary mb-4 max-w-md rounded-md",e&&"pointer-events-none animate-pulse opacity-80",u&&"mt-[".concat(u,"px]")),children:[n&&t.name&&o.jsx("h2",{className:"mb-0! leading-tight",children:t.name}),o.jsx("div",{className:"leaading-tight",children:o.jsx(xr,{business:t,showPrice:r,showHours:m})}),!m&&!c&&o.jsx("div",{className:"leading-tight",children:o.jsx(es,{business:t,showHourDetail:!0})}),i&&o.jsx(_m,{business:t,trackContentReferenceEvent:d,mapUrl:s,showActionButtonsIcons:l}),c&&!m&&o.jsx(vm,{business:t})]})}function xr(t){"use forget";const e=he.c(15),{business:s,showPrice:n,showHours:r}=t,a=n===void 0?!0:n,i=r===void 0?!0:r,l=s.categories&&s.categories.length>0?s.categories[0]:"";let c;e[0]!==s.rating?(c=s.rating?o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(mm,{className:"mt-0.25 h-3.5 w-3.5"}),s.rating.toFixed(1)]},"rating"):null,e[0]=s.rating,e[1]=c):c=e[1];let d;e[2]!==l?(d=l?o.jsx("span",{children:o.jsx(H,{id:"businessMetadata.category",defaultMessage:"{category}",values:{category:l}})},"category"):null,e[2]=l,e[3]=d):d=e[3];let u;e[4]!==s.price_str||e[5]!==a?(u=a&&s.price_str?o.jsx("span",{children:s.price_str},"price"):null,e[4]=s.price_str,e[5]=a,e[6]=u):u=e[6];let m;e[7]!==s||e[8]!==i?(m=i&&s.is_open!=null&&o.jsx(es,{business:s,showHourDetail:!1}),e[7]=s,e[8]=i,e[9]=m):m=e[9];let h;return e[10]!==c||e[11]!==d||e[12]!==u||e[13]!==m?(h=o.jsx("div",{className:"flex flex-wrap items-center font-normal",children:[c,d,u,m].filter(Boolean).map(bm)}),e[10]=c,e[11]=d,e[12]=u,e[13]=m,e[14]=h):h=e[14],h}function bm(t,e){return o.jsxs(yo.Fragment,{children:[e>0&&o.jsx("span",{className:"mx-1",children:"•"}),t]},e)}function _m({business:t,trackContentReferenceEvent:e,mapUrl:s,showActionButtonsIcons:n}){const r=p.useRef({directions:null,website:null,phone:null});p.useEffect(()=>{r.current={directions:null,website:null,phone:null}},[t.id]);const a=p.useMemo(()=>({section:"entity_metadata",section_location:"response",entity_type:"local_business",business_id:t.id,provider:t.provider}),[t.id,t.provider]),i=p.useCallback((l,c,d)=>{if(!e)return;const u=U(D({},a),{cta_type:l,url:d,link_type:"button",action:c});e("link_action",null,"entity_metadata",u),c==="show"?e("Entity Metadata Content Reference Shown","entity_metadata_content_reference_shown","entity_metadata",u):c==="click"&&e("Entity Metadata Content Reference Clicked","entity_metadata_content_reference_clicked","entity_metadata",u)},[a,e]);return p.useEffect(()=>{if(e&&(s&&r.current.directions!==s&&(i("directions","show",s),r.current.directions=s),t.website_url&&r.current.website!==t.website_url&&(i("website","show",t.website_url),r.current.website=t.website_url),t.phone)){const l="tel:".concat(t.phone);r.current.phone!==l&&(i("phone","show",l),r.current.phone=l)}},[t.phone,t.website_url,s,e,i]),o.jsxs("div",{className:"justify-left mt-3 flex w-full flex-wrap gap-2",children:[s&&o.jsx(os,{type:"button",className:"btn btn-primary btn-small relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{i("directions","click",s),window.open(s,"_blank","noopener,noreferrer")},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(fm,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.directions",defaultMessage:"Directions"})]},"rating")}),t.website_url&&o.jsx(os,{type:"button",className:"btn btn-secondary btn-small text-token-text-primary relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{const l=t.website_url;l&&(i("website","click",l),window.open(l,"_blank","noopener,noreferrer"))},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(gm,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.website",defaultMessage:"Website"})]},"rating")}),t.phone&&o.jsx(os,{type:"button",className:"btn btn-secondary btn-small text-token-text-primary relative m-0! w-auto min-w-fit px-4 py-1 text-xs font-medium",onClick:()=>{const l="tel:".concat(t.phone);i("phone","click",l),window.location.href=l},children:o.jsxs("span",{className:"flex items-center gap-1",children:[n&&o.jsx(gr,{className:"text-token-text-primary h-4 w-4"}),o.jsx(H,{id:"businessMetadata.call",defaultMessage:"Call"})]},"rating")})]})}function vm({business:t}){var c;const e=le(),[s,n]=p.useState(!1),r=t.hours&&t.hours.length>0||t.next_open_hour||t.is_open!=null||t.is_closed_permanently,a=t.hours?wm(t.hours):[],i=a.length>0,l=t.phone?(c=Hl(t.phone))==null?void 0:c.formatNational():null;return o.jsx("div",{className:"mt-3",children:o.jsxs("div",{className:"divide-token-border-light divide-y",children:[r&&o.jsxs(o.Fragment,{children:[o.jsx(fs,{icon:o.jsx(pm,{className:"h-6 w-6"}),value:o.jsx(es,{business:t,showHourDetail:!0}),isExpandable:!0,isExpanded:s,onClick:()=>n(d=>i&&!d)}),o.jsx(js,{initial:!1,children:s&&i&&o.jsx(at.div,{className:"divide-token-border-light divide-y overflow-hidden select-none",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"tween",duration:.2,ease:"easeInOut"},children:a.map(d=>o.jsxs("div",{className:"flex min-h-[40px] items-center gap-2 py-2 text-sm",children:[o.jsx("div",{className:"w-[125px]",children:yr(e,d.day,"long")}),o.jsx("div",{children:d.isClosed?o.jsx(H,{id:"businessMetadata.closed",defaultMessage:"Closed"}):o.jsx(o.Fragment,{children:d.times.map((u,m)=>o.jsx("div",{children:"".concat(Ts(e,u.start)," - ").concat(Ts(e,u.end))},m))})})]},d.day))},"hours-details")})]}),t.address&&o.jsx(fs,{icon:o.jsx(hm,{className:"h-6 w-6"}),value:t.address}),l&&o.jsx(fs,{icon:o.jsx(gr,{className:"h-5 w-5"}),value:l})]})})}function fs({icon:t,value:e,onClick:s,isExpandable:n=!1,isExpanded:r=!1}){return o.jsxs("div",{className:A("flex min-h-[44px] items-center gap-4 py-2",s&&"cursor-pointer"),onClick:s,children:[o.jsx("div",{className:"flex h-6 w-6 items-center justify-center",children:t}),o.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),n&&o.jsx("button",{type:"button",className:A("text-token-text-secondary p-1 transition-all",r&&"rotate-180"),children:o.jsx(xm,{className:"h-5 w-5"})})]})}function wm(t){var n;const e=[1,2,3,4,5,6,0];let s=[];if(Array.isArray(t)&&t.length>0){const r=new Map;for(const a of t){const i=(n=r.get(a.day))!=null?n:[];i.push({start:a.start,end:a.end}),r.set(a.day,i)}s=e.map(a=>{var l;const i=(l=r.get(a))!=null?l:[];return i.sort((c,d)=>c.start.localeCompare(d.start)),{day:a,times:i,isClosed:i.length===0}})}return s}function Ts(t,e){const s=e.slice(0,2),n=e.slice(2,4),r=new Date(0,0,0,parseInt(s,10),parseInt(n,10));return t.formatTime(r,{hour:"numeric",minute:"2-digit"})}function yr(t,e,s="short"){return t.formatDate(new Date(0,0,e),{weekday:s})}const jm="pk.eyJ1Ijoib2FpLWRhdGEiLCJhIjoiY20yYzRzZmFtMGNqNjJscHo2dThqdnkwNCJ9.rTosfWNn9lUu4slvYfMzHg",km=Z(()=>X(()=>import("./eblm0a618bl6wf18.js"),__vite__mapDeps([25,1])),{loading:t=>Q(t)}),Cm=Z(()=>X(()=>import("./ejd4bb0myatokvzs.js"),__vite__mapDeps([30,1])),{loading:t=>Q(t)}),Sm=Z(()=>X(()=>import("./l2dc1a6f6pz6h0zz.js"),__vite__mapDeps([31,1])),{loading:t=>Q(t)}),Nm=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zF),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),Mm=Z(()=>X(()=>import("./ztysthz0x5np2s72.js"),__vite__mapDeps([32,1])),{loading:t=>Q(t)}),Xn=50,Zn=20,Yn=20,Kn=20,Em=400;function Tm(t){"use forget";const e=he.c(56),{contentReference:s,clientThreadId:n,messageId:r,trackContentReferenceEvent:a}=t,i=le(),l=xe();let c;e[0]!==l?(c=Se(l,"1950533395"),e[0]=l,e[1]=c):c=e[1];const d=c,u=s.entities,m=p.useRef(!0),h=p.useRef(null),x=p.useRef(null);let _;e[2]===Symbol.for("react.memo_cache_sentinel")?(_={longitude:0,latitude:0,zoom:12},e[2]=_):_=e[2];const v=_,w=p.useRef(v);let j;e[3]===Symbol.for("react.memo_cache_sentinel")?(j=U(D({},v),{pitch:0,bearing:0}),e[3]=j):j=e[3];const[C,f]=p.useState(j),[y,k]=p.useState(-1),S=p.useRef(y);let N;e[4]===Symbol.for("react.memo_cache_sentinel")?(N=ne=>{S.current=ne,k(ne)},e[4]=N):N=e[4];const M=N,$=!Eo(),[P,b]=p.useState(!1),F=p.useRef(!1);let L,T;e[5]!==a?(L=()=>{F.current||(a("Search Content Reference Shown","search_content_reference_shown","map"),F.current=!0)},T=[a],e[5]=a,e[6]=L,e[7]=T):(L=e[6],T=e[7]),p.useEffect(L,T);let E,z;e[8]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{if(!h.current)return;const ne=va(()=>{var ae;(ae=x.current)==null||ae.resize()},100),me=new ResizeObserver(ne);return me.observe(h.current),()=>{me.disconnect()}},z=[],e[8]=E,e[9]=z):(E=e[8],z=e[9]),p.useEffect(E,z);let G;e[10]===Symbol.for("react.memo_cache_sentinel")?(G=new Set,e[10]=G):G=e[10];const[B,K]=p.useState(G),te=p.useRef(-1),[I,g]=p.useState(!1);let O;e[11]!==u||e[12]!==I||e[13]!==C.zoom?(O=()=>{var me,ae,pe;if(!x.current||!I)return;const ne=Lm;if(te.current==-1||te.current!==C.zoom){const ce=[];for(const _e of u){const we=(me=x.current)==null?void 0:me.project([_e.longitude,_e.latitude]);if(!we)return;const je=we.x-30,Me=we.y,se=(ae=_e.entity.rating)!=null?ae:0,q=(pe=_e.entity.is_open)!=null?pe:!1;ce.push({id:_e.id,x:je,y:Me,w:60,h:30,rating:se,openNow:q})}ce.sort(Am);const ve=new Set,Ne=new Map(ce.map(Im));for(const _e of ce){let we=!1;for(const je of ve){const Me=Ne.get(je);if(Me&&ne(_e,Me)){we=!0;break}}we||ve.add(_e.id)}K(_e=>_e.size===ve.size&&[..._e].every(we=>ve.has(we))?_e:ve)}te.current=C.zoom},e[11]=u,e[12]=I,e[13]=C.zoom,e[14]=O):O=e[14];let R;e[15]!==u||e[16]!==I||e[17]!==C.zoom||e[18]!==B?(R=[C.zoom,B,I,u],e[15]=u,e[16]=I,e[17]=C.zoom,e[18]=B,e[19]=R):R=e[19],p.useEffect(O,R);let W,V;e[20]!==u||e[21]!==y?(W=()=>{const ne=function(){var _e;const pe=function(je,Me){const se=x.current;if(!se)return!1;const{width:q,height:fe}=se.getContainer().getBoundingClientRect(),ge=se.unproject([Zn,Xn]),ke=se.unproject([q-Yn,fe-Kn]);return He(je,5)>=He(ke.lat,5)&&He(je,5)<=He(ge.lat,5)&&He(Me,5)>=He(ge.lng,5)&&He(Me,5)<=He(ke.lng,5)},ce=$u(u.filter((we,je)=>m.current||y===-1||je===y).map(Pm)),ve=Pu(ce),Ne=Au(ce);if(h.current){const we=h.current.clientWidth,je=h.current.clientHeight,Me=new Dt({width:we,height:je,longitude:Ne.geometry.coordinates[0],latitude:Ne.geometry.coordinates[1]}),{zoom:se,latitude:q,longitude:fe}=Me.fitBounds([[ve[0],ve[1]],[ve[2],ve[3]]],{maxZoom:13.5,padding:{top:Xn,left:Zn,right:Yn,bottom:Kn}});m.current?(f(ge=>U(D({},ge),{zoom:se,latitude:q,longitude:fe})),w.current={longitude:fe,latitude:q,zoom:se},m.current=!1):pe(q,fe)||(_e=x.current)==null||_e.flyTo({center:[fe,q]})}};if(u.length===0)return;if(m.current){ne();return}if(y===-1)return;const me=setTimeout(ne,200);return()=>clearTimeout(me)},V=[u,y],e[20]=u,e[21]=y,e[22]=W,e[23]=V):(W=e[22],V=e[23]),p.useEffect(W,V);const{openThreadSidebar:Y}=_t(),{resetSidebarHistory:J}=Ho(),de=Vs();let oe;e[24]!==n||e[25]!==s.start_idx||e[26]!==de||e[27]!==r||e[28]!==Y||e[29]!==J?(oe=(ne,me)=>{M(ne),n&&(de||J(),Y({type:"entity",debugThreadId:void 0,messageId:r,contentReferenceStartIndex:s.start_idx,query:me.name,category:"local_business",extraParams:me.entity.location?{location:me.entity.location}:void 0}))},e[24]=n,e[25]=s.start_idx,e[26]=de,e[27]=r,e[28]=Y,e[29]=J,e[30]=oe):oe=e[30];const ie=oe,ee=Zt();let ye;if(e[31]!==u||e[32]!==ee||e[33]!==d||e[34]!==ie||e[35]!==y||e[36]!==a||e[37]!==B){let ne;e[39]!==y?(ne=(ae,pe)=>ae.idx===y?1:pe.idx===y?-1:ae.idx-pe.idx,e[39]=y,e[40]=ne):ne=e[40];let me;e[41]!==ee||e[42]!==d||e[43]!==ie||e[44]!==y||e[45]!==a||e[46]!==B?(me=ae=>{const{business:pe,idx:ce}=ae,ve=ce===y;return o.jsx(dm,{longitude:pe.longitude,latitude:pe.latitude,anchor:"bottom",children:o.jsx(Ls,{label:o.jsx(zm,{business:pe.entity,idx:ce,trackContentReferenceEvent:a,onOpenEntity:()=>ie(ce,pe),enableSidebarNavigation:d}),onOpenChange:Ne=>M(Ne?ce:-1),delayDuration:150,theme:ee?"default":"white",customPaddingClassName:"bg-clip-padding",customBorderClassName:"border-token-border-default border",contentClassName:"animate-show rounded-[20px]!",side:"top",sideOffset:10,wide:!0,interactive:!0,children:o.jsxs("div",{className:"relative",children:[o.jsx(Rm,{business:pe,isSelected:ve}),o.jsx("div",{className:"absolute start-1/2 top-full -translate-x-1/2 font-bold text-nowrap text-gray-800 [text-shadow:_-0.8px_-0.8px_0_#fff,_0.8px_-0.8px_0_#fff,_-0.8px_0.8px_0_#fff,_0.8px_0.8px_0_#fff]",style:{opacity:B.has(pe.id)?1:0},children:pe.name}),o.jsx("div",{className:A("absolute inset-0 rounded-xl",d&&"cursor-pointer"),onClick:d?Ne=>{Ne.preventDefault(),M(ce),ie(ce,pe)}:void 0})]})},ce)},ce)},e[41]=ee,e[42]=d,e[43]=ie,e[44]=y,e[45]=a,e[46]=B,e[47]=me):me=e[47],ye=u.map($m).sort(ne).map(me),e[31]=u,e[32]=ee,e[33]=d,e[34]=ie,e[35]=y,e[36]=a,e[37]=B,e[38]=ye}else ye=e[38];const ue=ye;let re;e[48]!==i||e[49]!==$||e[50]!==ue||e[51]!==P||e[52]!==C?(re=!$&&o.jsx("div",{className:"bg-token-bg-primary pt-4",children:o.jsxs("div",{style:{height:Em},className:"bg-token-bg-primary relative w-full",ref:h,children:[o.jsx("div",{className:"relative h-full w-full overflow-hidden rounded-xl",children:o.jsxs(cm,U(D({},C),{mapboxAccessToken:jm,mapStyle:"mapbox://styles/oai-data/cmhawgfb0000n01sd7bcybf4f",attributionControl:!1,renderWorldCopies:!1,cooperativeGestures:!0,onMove:ne=>{f(ne.viewState),Dm(w.current,ne)&&b(!0)},locale:{"ScrollZoomBlocker.CtrlMessage":i.formatMessage({id:"1aF2nO",defaultMessage:"Hold Ctrl to zoom"}),"ScrollZoomBlocker.CmdMessage":i.formatMessage({id:"8R2Dga",defaultMessage:"Hold ⌘ to zoom"})},ref:x,keyboard:!1,onLoad:()=>{g(!0)},children:[o.jsx(um,{position:"top-right",showCompass:!1,style:{borderRadius:9999,overflow:"hidden"}}),o.jsx(Fm,{show:P,onClick:()=>{f(U(D({},w.current),{pitch:0,bearing:0})),b(!1)}}),ue]}))}),o.jsx("div",{className:"absolute start-3 top-3",children:o.jsx(Hm,{})})]})}),e[48]=i,e[49]=$,e[50]=ue,e[51]=P,e[52]=C,e[53]=re):re=e[53];let be;return e[54]!==re?(be=o.jsx(wa,{children:o.jsx("div",{className:"not-prose","data-testid":"businesses-map-widget",children:re})}),e[54]=re,e[55]=be):be=e[55],be}function $m(t,e){return{business:t,idx:e}}function Pm(t){return fr([t.longitude,t.latitude])}function Im(t){return[t.id,t]}function Am(t,e){const s=t.openNow,n=e.openNow;return s&&!n?-1:!s&&n?1:e.rating-t.rating}function Lm(t,e){return!(t.x+t.w<=e.x||e.x+e.w<=t.x||t.y+t.h<=e.y||e.y+e.h<=t.y)}const Rm=({business:t,isSelected:e})=>{var s;return o.jsx("div",{className:A("border-token-border-default shadow-elevation-03 flex h-7 min-w-7 items-center justify-center rounded-full border bg-clip-padding text-xs font-medium",e?"bg-token-interactive-bg-primary-press text-token-interactive-label-primary-press":"bg-token-bg-primary"),children:t.entity.rating?o.jsxs("div",{className:"flex items-center gap-0.75 px-2.5",children:[o.jsx("span",{children:(s=t.entity.rating)==null?void 0:s.toFixed(1)}),o.jsx(km,{className:"h-3 w-3"})]}):o.jsx(Mm,{className:"h-3 w-3"})})},Dm=(t,e)=>{if(t){const s=Math.abs(e.viewState.zoom-t.zoom),n=Math.abs(e.viewState.latitude-t.latitude),r=Math.abs(e.viewState.longitude-t.longitude);return s>.05||n>5e-4||r>5e-4}return!1};function Fm(t){"use forget";const e=he.c(6),{show:s,onClick:n}=t,[r,a]=p.useState(null);let i,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=()=>({onAdd(){const u=document.createElement("div");return u.className="mapboxgl-ctrl mapboxgl-ctrl-group",a(u),u},onRemove(){a(null)}}),l={position:"top-right"},e[0]=i,e[1]=l):(i=e[0],l=e[1]),ct(i,l);let c;return e[2]!==r||e[3]!==n||e[4]!==s?(c=r&&s?Ps.createPortal(o.jsx(Om,{onClick:n}),r):null,e[2]=r,e[3]=n,e[4]=s,e[5]=c):c=e[5],c}function Om(t){"use forget";const e=he.c(8),{onClick:s}=t,n=le();let r;e[0]!==s?(r=c=>{c.preventDefault(),s()},e[0]=s,e[1]=r):r=e[1];let a;e[2]!==n?(a=n.formatMessage({id:"dUWlu0",defaultMessage:"Reset view"}),e[2]=n,e[3]=a):a=e[3];let i;e[4]===Symbol.for("react.memo_cache_sentinel")?(i=o.jsx(Cm,{className:"icon h-[18px]! w-[18px]!"}),e[4]=i):i=e[4];let l;return e[5]!==r||e[6]!==a?(l=o.jsx(Pe,{type:"button",color:"secondary",size:"small",className:"flex h-[30px] items-center justify-center bg-clip-padding text-black",contentWrapperClassName:"font-semibold",onClick:r,title:a,children:i}),e[5]=r,e[6]=a,e[7]=l):l=e[7],l}function zm({business:t,idx:e,trackContentReferenceEvent:s,onOpenEntity:n,enableSidebarNavigation:r}){var u;const a=!Eo(),i={section:"map",section_location:"response",section_index:e},l="https://www.google.com/maps/dir/?api=1&destination=".concat(encodeURIComponent([t.name,t.address].join(",")));t.address&&s("link_action",null,"map",U(D({},i),{url:l,link_type:"button",action:"show"})),t.website_url&&s("link_action",null,"map",U(D({},i),{url:t.website_url,link_type:"button",action:"show"}));function c(){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"text-token-text-primary mt-auto flex min-h-[30px] w-full min-w-0 flex-wrap justify-center gap-2 text-base",children:[t.address&&o.jsx(hs,{to:l,onClick:()=>{s("link_action",null,"map",U(D({},i),{url:l,link_type:"button",action:"click"}))},children:o.jsx(H,{id:"+a2f/C",defaultMessage:"Directions"})}),t.website_url&&o.jsx(hs,{to:t.website_url,onClick:()=>{s("link_action",null,"map",U(D({},i),{url:t.website_url,link_type:"button",action:"click"}))},children:o.jsx(H,{id:"r0oqXM",defaultMessage:"Website"})}),t.phone&&o.jsx(hs,{to:"tel:"+t.phone,children:o.jsx(H,{id:"B/an6M",defaultMessage:"Call"})})]})})}const d=(u=t.image_urls)==null?void 0:u[0];return o.jsx(at.div,{initial:{x:"0%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}},animate:{x:"0%",opacity:1,pointerEvents:"auto",transition:{duration:.15,ease:"easeOut"}},children:o.jsxs("div",{className:A("bg-token-main-surface-primary relative text-start font-normal"),children:[o.jsxs("div",{className:"flex flex-col gap-2 p-3",children:[o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:A("h-23 w-23 shrink-0 overflow-hidden rounded-lg",r&&"cursor-pointer"),onClick:r?m=>{m.preventDefault(),n==null||n()}:void 0,children:d?o.jsx("img",{className:"h-full w-full object-cover",src:d!=null?d:void 0,alt:t.name}):o.jsx("div",{className:"h-full w-full bg-gray-100"})}),o.jsxs("div",{className:"flex min-w-0 flex-1 flex-col justify-center gap-0.5",children:[r?o.jsx("div",{className:"hover:entity-accent line-clamp-2 w-full cursor-pointer text-[17px] font-medium",onClick:m=>{m.preventDefault(),n==null||n()},title:t.name,children:t.name}):o.jsx("div",{title:t.name,className:"text-token-text-primary line-clamp-2 w-full text-[17px] font-medium",children:t.name}),o.jsx(Wm,{business:t})]})]}),!a&&o.jsx("div",{className:"mt-1",children:c()})]}),a&&c()]})})}function hs(t){"use forget";const e=he.c(4),{to:s,onClick:n,children:r}=t;let a;return e[0]!==r||e[1]!==n||e[2]!==s?(a=o.jsx(Pe,{onClick:n,as:"link",to:s,openNewTab:!0,rel:"noreferrer",color:"secondary",size:"small",className:"h-[30px] min-w-25 flex-1 rounded-full border",contentWrapperClassName:"text-token-text-primary font-semibold",children:r}),e[0]=r,e[1]=n,e[2]=s,e[3]=a):a=e[3],a}function Wm({business:t}){return o.jsxs("div",{className:"text-token-text-primary flex flex-col gap-0.5 text-sm",children:[o.jsx(xr,{business:t,showPrice:!0,showHours:!1}),o.jsx(es,{business:t,showHourDetail:!0})]})}function Hm(){const[t,e]=p.useState(!1),s=()=>e(r=>!r),n=t?Nm:Sm;return o.jsxs("div",{className:A("text-token-text-primary flex h-5 items-center justify-start overflow-hidden rounded-full text-[10px] font-light whitespace-nowrap transition-all",t?"w-full bg-white":"w-5 bg-white/60 backdrop-blur-xl backdrop-filter hover:bg-white/70"),children:[o.jsx("button",{onClick:s,className:A("flex min-w-5 items-center justify-center transition-all"),children:o.jsx(n,{className:"icon-sm transition-colors"})}),o.jsxs("div",{className:"pe-2",children:["© ",o.jsx("a",{href:"https://www.mapbox.com/about/maps",target:"_blank",rel:"noreferrer",className:"text-[#2964aa]!",children:"Mapbox"})," ",o.jsx("a",{href:"https://www.mapbox.com/legal/end-user-terms",target:"_blank",rel:"noreferrer",className:"me-2 text-[#2964aa]!",children:o.jsx(H,{id:"u3dZJq",defaultMessage:"Terms"})}),"© ",o.jsx("a",{href:"http://www.openstreetmap.org/about",target:"_blank",rel:"noreferrer",className:"text-[#2964aa]!",children:"OpenStreetMap"})]})]})}const De={TTFP:"products.ttfp",TTLT:"products.ttlt",TTF_VISIBLE_CONTENT_TOKEN:"products.ttf_visible_content_token"},Zs={[De.TTFP]:new Set,[De.TTLT]:new Set,[De.TTF_VISIBLE_CONTENT_TOKEN]:new Set};function ps({profiler:t,messageId:e,metric:s,overrideDurationMs:n}){Zs[s].add(e);const r=xi();t.logTimingOnce(s,{context:{eval_preset:r.eval_preset},overrideDurationMs:n})}function gs({messageId:t,metric:e}){return Zs[e].has(t)}function br(t){"use forget";const e=he.c(27),{clientThreadId:s,messageId:n,products:r}=t;let a;e[0]!==n?(a=y=>[Ye.getRequestId(y),Ye.isMessageTurnEnded(y,n)],e[0]=n,e[1]=a):a=e[1];const[i,l]=Vt(s,a);let c;e[2]!==s?(c={namespace:hi.ProductsCompletionRequest,clientThreadId:s},e[2]=s,e[3]=c):c=e[3];const{profiler:d,isRequestActive:u}=pi(c),m=u&&!l,h=gi(m);let x,_;e[4]!==m||e[5]!==n||e[6]!==r.length||e[7]!==d?(x=()=>{gs({messageId:n,metric:De.TTFP})||d&&m&&r.length>0&&ps({profiler:d,messageId:n,metric:De.TTFP})},_=[m,n,r.length,d],e[4]=m,e[5]=n,e[6]=r.length,e[7]=d,e[8]=x,e[9]=_):(x=e[8],_=e[9]),p.useEffect(x,_);let v,w;e[10]!==m||e[11]!==n||e[12]!==h||e[13]!==d?(v=()=>{gs({messageId:n,metric:De.TTLT})||d&&h.current&&!m&&ps({profiler:d,messageId:n,metric:De.TTLT})},w=[n,h,m,d],e[10]=m,e[11]=n,e[12]=h,e[13]=d,e[14]=v,e[15]=w):(v=e[14],w=e[15]),p.useEffect(v,w);const j=xe();let C;e[16]!==j||e[17]!==n||e[18]!==d||e[19]!==i?(C=()=>{if(gs({messageId:n,metric:De.TTF_VISIBLE_CONTENT_TOKEN}))return;const y=i?ja(j,i):null;if(d&&y){const k=De.TTF_VISIBLE_CONTENT_TOKEN;Zs[k].add(n),ps({profiler:d,messageId:n,metric:k,overrideDurationMs:y.turnTracker.first_visible_content_token_lat})}},e[16]=j,e[17]=n,e[18]=d,e[19]=i,e[20]=C):C=e[20];let f;e[21]!==j||e[22]!==n||e[23]!==r.length||e[24]!==d||e[25]!==i?(f=[n,d,i,r.length,j],e[21]=j,e[22]=n,e[23]=r.length,e[24]=d,e[25]=i,e[26]=f):f=e[26],p.useEffect(C,f)}function Bm({contentReference:t,clientThreadId:e,messageId:s,turnIndex:n,trackContentReferenceEvent:r}){const a=p.useCallback(()=>r("Search Content Reference Shown","search_content_reference_shown","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[r,t.start_idx,t.product.id]),i=p.useCallback(()=>r("Search Content Reference Clicked","search_content_reference_clicked","product_entity",{content_reference_start_index:t.start_idx,product_id:t.product.id}),[r,t.start_idx,t.product.id]),l=t.product;p.useEffect(()=>a(),[a]),br({clientThreadId:e,messageId:s,products:[l]});const{openThreadSidebar:c}=_t();return o.jsx("span",{className:"entity-underline hover:entity-accent inline cursor-pointer align-baseline",onClick:()=>{if(i(),l.offers||!l.url){if(!e)return;c({type:"product",messageId:s,turnIndex:n,contentReferenceStartIndex:t.start_idx,productIndex:0,productId:l.id,productUrl:l.url,interactionSource:"inline_link"})}else window.open(l.url,"_blank")},children:o.jsx("span",{className:"whitespace-normal",children:l.title})})}const Vm=Z(()=>X(()=>import("./ffrotvb922yxp30i.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)}),Um=Z(()=>X(()=>import("./nlj7ey81i8rm36n9.js"),__vite__mapDeps([23,1])),{loading:t=>Q(t)}),qm=Z(()=>X(()=>import("./d1v5eq12z2rar6o7.js"),__vite__mapDeps([33,1])),{loading:t=>Q(t)});function _r({items:t,targetItemCount:e,onCardRender:s,onCardShown:n,onCardClicked:r,onReplyClicked:a,allowFullWidth:i=!1,cardClassName:l,showGradient:c=!0,arrowClassName:d}){const u=p.useRef(null),[m,h]=p.useState(null),x=p.useRef(null),_=()=>{x.current=setTimeout(()=>{h(null),x.current=null},200)},v=()=>{x.current&&(clearTimeout(x.current),x.current=null)},w=p.useRef(null),[j,C]=p.useState({left:0,top:0}),f=8;p.useEffect(()=>{const M=u.current,$=w.current;if(!a||!m||!M||!$)return;const P=()=>{const b=m.card.getBoundingClientRect(),F=M.getBoundingClientRect(),L=$.getBoundingClientRect(),T=b.bottom-F.top+f;var E=b.left-F.left;E=Math.max(0,E),E=Math.min(E,F.width-L.width),C({left:E,top:T})};return P(),M.addEventListener("scroll",P),()=>M.removeEventListener("scroll",P)},[m,t,a]);const y=bt(),k=y?2:4;if(e===void 0)e=t.length;else if(!e&&t.length<k)return null;const S=(e!=null?e:t.length)>=k,N=S&&y;return o.jsxs("div",{className:"relative",children:[o.jsx("div",{ref:u,className:A("flex flex-row gap-4 py-2",N&&"mx-[-1rem] px-[1rem]",S&&"no-scrollbar snap-x snap-proximity scroll-ps-4 overflow-x-scroll scroll-smooth"),children:t.map((M,$)=>o.jsx("div",{className:A(S||!i?"thread-lg:w-61 w-50 shrink-0 snap-start":"min-w-0 flex-1"),children:o.jsx(Gm,{cardClassName:l,onShown:()=>n(M,$),onClick:()=>r(M,$),onHover:P=>{v(),P?h({card:P,item:M,index:$}):_()},children:s(M,!y&&e===1)})},$))}),S&&!N&&o.jsx(Xm,{scrollableRef:u,units:t.length,showGradient:c,arrowClassName:d}),a&&o.jsx("div",{ref:w,className:A("absolute z-10",m?"pointer-events-auto opacity-100":"pointer-events-none opacity-0","transition-[transform,opacity] duration-200"),style:{willChange:"opacity, transform",left:j.left,top:j.top,transform:m?"translateY(0)":"translateY(".concat(-f,"px)")},onMouseEnter:v,onMouseLeave:_,children:o.jsx(Pe,{className:A(m?"pointer-events-auto":"pointer-events-none","border-light bg-clip-padding px-4 py-2 shadow-md"),size:"small",color:"secondary",onClick:()=>m&&a(m.item,m.index),children:o.jsxs("div",{className:"flex flex-row items-center gap-1",children:[o.jsx(qm,{className:"icon-sm text-token-text-secondary"}),o.jsx(H,{id:"9TG7OR",defaultMessage:"Ask about this"})]})})})]})}function Gm({onShown:t,onClick:e,onHover:s,children:n,cardClassName:r}){const a=p.useRef(null),i=p.useRef(t);return p.useEffect(()=>{i.current=t},[t]),p.useEffect(()=>{if(!a.current)return;const l=new IntersectionObserver(([c])=>c.isIntersecting&&i.current(),{threshold:.5});return l.observe(a.current),()=>l.disconnect()},[]),o.jsx("div",{ref:a,className:A("h-full w-full","bg-token-bg-primary cursor-pointer",r),onClick:e,onMouseEnter:()=>a.current&&s(a.current),onMouseLeave:()=>s(null),children:n})}function Xm({scrollableRef:t,units:e,showGradient:s,arrowClassName:n}){const[r,a]=p.useState({left:!1,right:!1}),[i,l]=p.useState(!1);p.useEffect(()=>{const d=t.current;if(!d)return;const u=()=>{const{scrollLeft:m,scrollWidth:h,clientWidth:x}=d,_=m/(h-x);a({left:_>0,right:_<1}),!i&&m>0&&l(!0)};return u(),d.addEventListener("scroll",u),()=>d.removeEventListener("scroll",u)},[t,e,i]);const c=d=>{if(!t.current)return;l(!0);const{clientWidth:u,scrollWidth:m}=t.current,h=m/e,x=Math.floor(u/h)*h;t.current.scrollBy({left:x*d,behavior:"smooth"})};return o.jsxs("div",{className:"pointer-events-none absolute start-0 top-0 flex h-full w-full flex-row",children:[o.jsx("div",{className:A("flex h-full w-9 items-center justify-start",i&&s&&"bg-linear-to-r from-(--bg-primary) to-transparent",r.left?"opacity-100":"opacity-0","transition-opacity duration-100"),children:o.jsx(Pe,{color:"secondary",size:"small",className:A("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[-50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",n),onClick:()=>c(-1),children:o.jsx(Um,{className:"icon"})})}),o.jsx("div",{className:A("ms-auto flex h-full w-9 items-center justify-end",i&&s&&"bg-linear-to-l from-(--bg-primary) to-transparent",r.right?"opacity-100":"opacity-0","transition-opacity duration-200"),children:o.jsx(Pe,{color:"secondary",size:"small",className:A("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-8 w-8 translate-x-[50%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",n),onClick:()=>c(1),children:o.jsx(Vm,{className:"icon"})})})]})}const Ys=Z(()=>X(()=>import("./duz09euqvesjqb1t.js"),__vite__mapDeps([3,1])),{loading:t=>Q(t)}),Zm=Z(()=>X(()=>import("./ffrotvb922yxp30i.js"),__vite__mapDeps([22,1])),{loading:t=>Q(t)});function Ym({contentReference:t,clientThreadId:e,messageId:s,turnIndex:n,analyticsMetadata:r}){const a=t.products,i=t.target_product_count;br({clientThreadId:e,messageId:s,products:a});const{showDebugConversationTurns:l}=ka(),c=Vt(e,N=>{var P,b;const $=(b=(P=Ye.getNode(N,s).message.metadata)==null?void 0:P.content_references)==null?void 0:b.find(F=>F.type==="products");return t.start_idx===($==null?void 0:$.start_idx)}),d=xe(),u=Se(d,"3144771298"),m=We(d),h=Ve(()=>Xt(d)),x=Gt(d),_=Se(d,"2212894775"),v=Bo(r),w=p.useCallback((N,M)=>v("Search Content Reference Shown","search_content_reference_shown","products",{content_reference_start_index:t.start_idx,product_index:M,product_id:N.id,product_url:N.url}),[v,t.start_idx]),j=p.useCallback((N,M)=>v("Search Content Reference Clicked","search_content_reference_clicked","products",{content_reference_start_index:t.start_idx,product_index:M,product_id:N.id}),[v,t.start_idx]),C=yi(d),{openThreadSidebar:f}=_t(),y=(N,M)=>{if(e)if(j(N,M),N.offers){const $=_i(),P=$?C.rooms$().get($):null,b={type:"product",messageId:s,turnIndex:n,contentReferenceStartIndex:t.start_idx,productIndex:M,productId:N.id,productUrl:N.url,interactionSource:"carousel"};P!=null?C.hasAccess&&C.openThreadSidebar$(P,b):f(b)}else window.open(N.url,"_blank")},{setTargetedContent:k}=bi(),S=(N,M)=>{Tt.logEventWithStatsig("Product Targeted Reply Clicked","product_targeted_reply_clicked",U(D({},Ca(r)),{content_reference_start_index:t.start_idx,product_index:(M+1).toString(),product_id:N.id})),k({type:"object",label:N.title,createNewCompletionParams:$=>{var b;const P=Sa(N.title);return U(D({},$),{promptMessage:vi($.promptMessage,{metadata:{targeted_reply:N.title,targeted_reply_label:N.title,targeted_reply_icon:"product_tag"}}),appendMessages:[...(b=$.appendMessages)!=null?b:[],P]})},onCreateCompletion:({serverThreadId:$,currentLeafId:P})=>{Tt.logEventWithStatsig("Targeted Reply Submitted","chatgpt_targeted_reply_submitted",{conversation_id:$,current_leaf_id:P,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(M+1).toString(),product_id:N.id})},onCleared:({serverThreadId:$,currentLeafId:P})=>{Tt.logEventWithStatsig("Targeted Reply Cleared","chatgpt_targeted_reply_cleared",{conversation_id:$,current_leaf_id:P,source_message_id:s,content_reference_start_index:t.start_idx,product_index:(M+1).toString(),product_id:N.id})}})};if(t.inline_carousel&&a.length===1){const N=a[0];return o.jsx("div",{className:"flex flex-col","data-testid":"shopping-widget",children:o.jsx(ef,{product:N,showDebug:l,onShown:()=>w(N,0),onClicked:()=>y(N,0)})})}return o.jsxs("div",{className:"flex flex-col","data-testid":"products-widget",children:[m&&!x?o.jsx("div",{className:A("relative mb-6",h?"-mx-[var(--thread-content-margin)]":"-mx-6"),children:o.jsx(Yt,{items:a,getItemKey:N=>N.id,onRenderItem:N=>o.jsx(Jn,{product:N,wide:!1,showDebug:l,isProductV2CardEnabled:_}),className:"min-h-36",itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)] thread-lg:w-61 w-50 shrink-0 border-none",arrowClassName:_?"translate-y-[-85%]!":"",onShown:w,onClick:y})}):o.jsx(_r,{items:a,targetItemCount:i,onCardRender:(N,M)=>o.jsx(Jn,{product:N,wide:M,showDebug:l,isProductV2CardEnabled:_}),onCardShown:w,onCardClicked:y,onReplyClicked:_?void 0:S,arrowClassName:_?"translate-y-[-85%]":"",allowFullWidth:!0,showGradient:!_,cardClassName:A(_?"group":"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden")}),c&&u&&!_&&o.jsxs("div",{className:"text-token-text-tertiary flex text-xs hover:cursor-pointer hover:underline",onClick:()=>window.open("https://help.openai.com/en/articles/11128490","_blank"),children:[o.jsx(H,{id:"4Y5Zn5",defaultMessage:"ChatGPT chooses products independently. Learn more"}),o.jsx(Zm,{className:"icon -ms-0.5"})]}),!1]})}function Jn(t){"use forget";const e=he.c(5),{product:s,wide:n,showDebug:r,isProductV2CardEnabled:a}=t,i=r===void 0?!1:r;let l;return e[0]!==a||e[1]!==s||e[2]!==i||e[3]!==n?(l=a?o.jsx(Jm,{product:s,wide:n,showDebug:i}):o.jsx(Km,{product:s,wide:n,showDebug:i}),e[0]=a,e[1]=s,e[2]=i,e[3]=n,e[4]=l):l=e[4],l}function Km({product:t,wide:e,showDebug:s=!1}){var l,c;const n=t.image_urls?t.image_urls[0]:void 0,[r,a]=p.useState("contain"),i=p.useRef(null);return o.jsxs("div",{className:A("flex",e?"flex-row":"flex-col"),children:[o.jsxs("div",{className:A("relative aspect-square",e?"w-1/3":"w-full","bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse"),children:[n?o.jsx("img",{ref:i,className:"absolute inset-0 m-0 h-full w-full mix-blend-darken object-".concat(r),src:n,alt:t.title,onLoad:()=>{if(!i.current)return;const{naturalWidth:d,naturalHeight:u}=i.current,m=d/u;a(Math.abs(m-1)<.25?"cover":"contain")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})}),t.featured_tag&&o.jsx("div",{className:"absolute start-3 end-3 bottom-3",children:o.jsxs("div",{className:"relative max-w-fit px-2 py-1",children:[o.jsx("div",{className:"absolute inset-0 rounded-full bg-white/60 backdrop-blur-xl"}),o.jsx("div",{className:"relative truncate text-xs font-semibold text-gray-950",children:t.featured_tag})]})})]}),o.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[o.jsx("div",{className:"line-clamp-2 leading-snug font-semibold text-ellipsis",children:t.title}),t.description&&o.jsx("div",{className:"line-clamp-3 pt-3 text-sm text-ellipsis",children:t.description}),o.jsx("div",{className:"flex-1"}),o.jsxs("div",{className:"flex flex-row items-end pt-3",children:[o.jsxs("div",{className:"flex flex-col overflow-hidden",children:[o.jsx("div",{className:"text-md leading-snug font-semibold",children:t.price}),o.jsx("div",{className:"text-token-text-secondary overflow-hidden pt-0.5 text-xs text-ellipsis whitespace-nowrap",children:t.merchants})]}),o.jsx("div",{className:"flex-1"}),t.num_reviews&&t.num_reviews>0&&o.jsxs("div",{className:"text-token-text-secondary flex w-fit flex-row gap-1 text-sm",children:[o.jsx(qa,{rating:(l=t.rating)!=null?l:0/5}),((c=t.rating)!=null?c:0).toFixed(1)]})]}),!1]})]})}function Jm({product:t,wide:e,showDebug:s=!1}){const n=t.image_urls?t.image_urls[0]:void 0,[r,a]=p.useState("contain"),[i,l]=p.useState("top"),c=p.useRef(null);return o.jsxs("div",{className:A("flex pb-2",e?"flex-row gap-3":"flex-col gap-2"),children:[o.jsx("div",{className:A("relative",e?"aspect-square w-1/4":"aspect-[13/16] w-full","overflow-clip rounded-xl bg-[#F3F3F3] dark:bg-[#F3F3F3]"),children:o.jsx(Go,{className:"mix-blend-darken",children:n?o.jsx("img",{ref:c,className:"absolute inset-0 m-0 h-full w-full object-".concat(r," object-").concat(i),src:n,alt:t.title,onLoad:()=>{if(!c.current)return;const{naturalWidth:d,naturalHeight:u}=c.current,m=d/u;a(Math.abs(m-1)<.4?"cover":"contain"),l(u>d?"top":"center")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})})})}),o.jsxs("div",{className:"flex flex-col gap-1 px-1",children:[o.jsx("div",{className:A("line-clamp-2 font-medium text-ellipsis",e?"text-base":"text-sm"),children:t.title}),o.jsxs("div",{className:"text-token-text-secondary flex flex-row gap-0.25 text-sm",children:[o.jsx("div",{children:t.price}),o.jsx("div",{className:"mx-0.5",children:"•"}),o.jsx("div",{className:"truncate",children:t.merchants})]}),!1]})]})}function Qm({className:t,imageUrl:e,productTitle:s,onClicked:n}){const[r,a]=p.useState("contain"),i=p.useRef(null);return o.jsx("div",{className:A(t,"hover:scale-[1.005]","dark:bg-token-text-inverted bg-token-bg-primary","cursor-pointer overflow-hidden rounded-xl shadow-inner transition-all duration-200","relative aspect-square max-h-60"),onClick:n,children:e?o.jsx("img",{ref:i,className:"m-0 h-full w-full overflow-hidden object-".concat(r," mix-blend-darken"),src:e,alt:s,onLoad:()=>{if(!i.current)return;const{naturalWidth:l,naturalHeight:c}=i.current,d=l/c;a(Math.abs(d-1)<.5?"cover":"contain")}}):o.jsx("div",{className:"flex aspect-square items-center justify-center",children:o.jsx(Ys,{className:"text-token-text-tertiary h-12 w-12"})})})}function ef({product:t,showDebug:e=!1,onShown:s,onClicked:n}){return p.useEffect(()=>{s()},[s]),o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex flex-row gap-2 py-2",children:t.image_urls&&t.image_urls.length>0&&t.image_urls.slice(0,3).map(r=>o.jsx(Qm,{imageUrl:r,productTitle:t.title,onClicked:n},r))}),!1]})}function tf({attribution:t,wordFadeType:e}){var a;const s=p.useContext(Ke),n=wi(s==null?void 0:s.message.id,t.attributable_index),r=ji();return o.jsx(of,{isHighlighted:n,isDebugMode:r&&!1,content:(a=t.alt)!=null?a:"",attributableIndex:t.attributable_index,attributions:void 0,attributionsDebug:void 0,wordFadeType:e})}const sf=p.memo(Us);function nf({content:t,isHighlighted:e,isDebugMode:s,attributableIndex:n,attributions:r,attributionsDebug:a,wordFadeType:i}){const l=i==="indexed",c=Vo(),d=p.useMemo(()=>l?{handlers:{text:(h,x,_)=>{const v=[];for(const w of c(x.value))v.push({type:"element",tagName:"span",properties:{className:Uo.fadeIn},children:[{type:"text",value:w}]});return v}}}:void 0,[l,c]),u=p.useMemo(()=>({p:({children:h})=>o.jsx(o.Fragment,{children:h})}),[]),m=o.jsx(sf,{rehypePlugins:vs,remarkPlugins:_s,urlTransform:bs,remarkRehypeOptions:d,components:u,children:t});return o.jsx(rf,{isHighlighted:e,children:m})}const of=yo.memo(nf);function rf({isHighlighted:t,className:e,children:s}){return o.jsx("span",{className:A("relative","-mx-px my-[-0.2rem] rounded px-px py-[0.2rem]",t&&"attribution-highlight-bg","transition-colors duration-100 ease-in-out",e),children:s})}function Qn(t,e){try{return BigInt(t).toLocaleString(e)}catch(s){const n=Number(t);return t.includes("e")||t.includes("E")?n.toExponential():n.toLocaleString(e,{maximumFractionDigits:6})}}function af({data:t,trackContentReferenceEvent:e}){p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=Na().locale;return t.expression&&t.result!=null?o.jsxs("div",{className:"no-scrollbar overflow-auto sm:overflow-hidden",children:[o.jsxs("div",{className:"pb-1 text-lg font-semibold",children:[t.prefix&&o.jsx("span",{children:t.prefix}),o.jsx("span",{children:Qn(t.result,s)}),t.suffix&&o.jsx("span",{children:t.suffix})]}),o.jsx("div",{className:"text-token-text-primary tracking-wide",children:"".concat(t.expression,"=").concat(Qn(t.result,s))})]}):null}const lf=Z(()=>X(()=>import("./naoaa24cgmdbcxxy.js"),__vite__mapDeps([34,1])),{loading:t=>Q(t)});function vr({ref:t,onClick:e,onMouseEnter:s,onMouseLeave:n}){const r=le();return o.jsx("button",{ref:t,"aria-label":r.formatMessage({id:"citation.icon.label",defaultMessage:"Coding Citation"}),onClick:e,onMouseEnter:s,onMouseLeave:n,className:A("rounded-xl px-1","bg-token-interactive-bg-tertiary-press text-token-text-secondary hover:text-token-text-inverted hover:bg-token-interactive-bg-primary-selected"),children:o.jsx(lf,{className:"icon-sm"})})}function cf({codeMessage:t,codeExecutionOutputMessage:e,onDismiss:s,FormattedText:n}){const r=le();return o.jsx(qe.Root,{isOpen:!0,onClose:s,testId:"modal-code-execution",children:o.jsx(qe.Overlay,{children:o.jsxs(qe.Content,{className:"flex max-h-[75vh] max-w-lg flex-col overflow-hidden",children:[o.jsx(qe.Header,{title:r.formatMessage(df.title),type:"success",closeButton:o.jsx(Ma,{onClick:s})}),o.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[o.jsx("div",{children:o.jsx(xl,{FormattedText:n,message:t,codeRendererClassName:"border-none rounded-none",removeTopBorderRadius:!0})}),o.jsx("div",{children:o.jsx(yl,{message:e})})]})]})})})}const df=Is({title:{id:"CodeExecutionOutputModal.title",defaultMessage:"Analysis"}});function uf({displayInfo:t,FormattedText:e,trackContentReferenceEvent:s}){const[n,r]=p.useState(!1),a=le();return p.useEffect(()=>{s("Search Content Reference Shown","search_content_reference_shown",t.type)},[s,t.type]),o.jsxs(o.Fragment,{children:[o.jsx(Ls,{label:a.formatMessage(mf.viewAnalysis),side:"top",delayDuration:150,className:"align-middle",children:o.jsx(vr,{onClick:()=>r(!0)})}),n&&o.jsx(cf,{FormattedText:e,codeMessage:t.codeMessage,codeExecutionOutputMessage:t.codeExecutionOutputMessage,onDismiss:()=>r(!1)})]})}const mf=Is({viewAnalysis:{id:"viewAnalysis",defaultMessage:"View analysis"}});function ff({contentReference:t,clientThreadId:e,turnIndex:s}){var x,_,v,w,j,C,f;const{toggleThreadSidebar:n}=_t(),r=ki("codingCitations"),[a,i]=p.useState(!1),l=p.useRef(null),c=()=>{l.current!=null&&window.clearTimeout(l.current),i(!0)},d=()=>{l.current=window.setTimeout(()=>i(!1),100)},u=p.useCallback(()=>{var y,k;e&&n({type:"codingCitations",turnIndex:s||1,messageId:(k=(y=t.cited_message)==null?void 0:y.id)!=null?k:"",matchedText:t.matched_text},r)},[n,e,r,t,s]);if(!t.cited_message||!t.highlighted_text)return null;let m;t.type==="python"?m=(v=(_=(x=t.cited_message)==null?void 0:x.metadata)==null?void 0:_.aggregate_result)==null?void 0:v.code:t.type==="container"&&(m=(C=(j=(w=t.cited_message)==null?void 0:w.metadata)==null?void 0:j.container_citation)==null?void 0:C.source_cmd);const h=(f=m==null?void 0:m.split("\n").length)!=null?f:0;return o.jsx("span",{className:"relative top-[0.1rem] inline-block align-middle",children:o.jsx("span",{className:"inline-flex items-center",children:o.jsxs(Fs,{open:a,onOpenChange:i,children:[o.jsx(Os,{asChild:!0,children:o.jsx(vr,{onClick:u,onMouseEnter:c,onMouseLeave:d})}),o.jsx(zs,{children:o.jsx(Ws,{align:"start",sideOffset:4,onMouseEnter:c,onMouseLeave:d,className:A("border-default bg-token-bg-primary rounded-2xl border p-3"),children:o.jsxs("aside",{className:"flex flex-col gap-3",children:[o.jsx("h2",{className:A("text-token-text-secondary text-xs font-medium"),children:t.type==="python"?o.jsx(H,{id:"citation.popover.label.python",defaultMessage:"Python script · {count, number} lines",values:{count:h}}):o.jsx(H,{id:"citation.popover.label.container",defaultMessage:"Bash script · {count, number} lines",values:{count:h}})}),o.jsx("hr",{}),o.jsx("h2",{className:A("text-sm font-medium","max-w-full break-words whitespace-pre-line sm:max-w-[300px]"),children:t.highlighted_text})]})})})]})})})}const hf="2758269539",pf=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zp),__vite__mapDeps([4,1,5,6,7])).then(t=>t.DILWidget));function gf({dil:t,dilUrl:e,trackContentReferenceEvent:s,widgetName:n}){p.useEffect(()=>{const a=n==null?void 0:{widget_name:n};s("Search Content Reference Shown","search_content_reference_shown","dil",a)},[s,n]);const r=xe();return Se(r,hf)?null:o.jsx(pf,{dil:t})}function xf({product:t,clientThreadId:e,messageId:s,contentReferenceStartIndex:n,trackContentReferenceEvent:r,showTitle:a=!1,showImageGallery:i=!1}){var f,y,k,S;const l=xe(),c=Se(l,"3375735072"),d=Se(l,"232003972"),u=p.useMemo(()=>({clientThreadId:e,messageId:s}),[e,s]),m=Hs.useStore(),[h,x]=p.useState(!1),[_,v]=p.useState(t),[w,j]=p.useState(!1),C=a||d||c;return p.useEffect(()=>{let N=!0;return(async $=>{j(!0);try{try{for(var P=ns(yf($)),b,F,L;b=!(F=await P.next()).done;b=!1){const T=F.value;N&&v(T)}}catch(F){L=[F]}finally{try{b&&(F=P.return)&&await F.call(P)}finally{if(L)throw L[0]}}}finally{N&&j(!1)}})(_),()=>{N=!1}},[(f=_.product_lookup_key)==null?void 0:f.variant_options_query]),_?o.jsxs("div",{className:"-mx-6",children:[i&&o.jsx(Ga,{imageUrls:(y=_.image_urls)!=null?y:[],title:_.title,onImageClick:N=>{m.setCurrentImage({image:{url:N,content_url:N,thumbnail_url:N,title:_.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:Je.ProductDetails,analyticsMetadata:u,contentReferenceStartIndex:n})}}),o.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col",children:[C&&o.jsxs("div",{className:"border-token-border-light flex flex-col border-b px-6 pb-3",children:[a&&o.jsx("div",{className:"text-token-text-primary text-xl font-medium capitalize",children:_.title}),d&&_.num_reviews&&_.rating&&o.jsx(Xa,{rating:_.rating,numReviews:_.num_reviews,ratingGroupedCitation:_.rating_grouped_citation,trackContentReferenceEvent:()=>{},analyticsMetadata:u}),c&&_.variants&&_.variants.length>0&&o.jsx("div",{className:"mt-5 mb-2",children:o.jsx(Za,{options:_.variants,showErrors:h,updateOption:(N,M,$)=>v(P=>bf({optionGroupId:N,selectedId:M,variant_index:$,product:P,trackContentReferenceEvent:r}))})})]}),o.jsx(Ya,{className:"border-token-border-light -pt-3 -mx-3 flex flex-col border-b px-6 pb-3",offers:(k=t.offers)!=null?k:[],contentReferenceStartIndex:n,productIndex:0,product:t,trackContentReferenceEvent:r,analyticsMetadata:u,imageUrls:(S=t.image_urls)!=null?S:[],isLoading:w,onOpenCheckout:()=>x(!0)})]})]}):null}function yf(t){return rn(this,null,function*(){const{product_lookup_key:e}=t;if(!!!(e!=null&&e.variant_options_query)){yield t;return}const n=Ci("".concat(Ea,"/search/product_info_variants"),{method:"POST",headers:D({},As({isAuthOptional:!0})),body:{product_lookup_key:t.product_lookup_key}});try{for(var r=ns(n),a,i,l;a=!(i=yield new kt(r.next())).done;a=!1){const c=i.value;"data"in c&&(yield c.data.product)}}catch(i){l=[i]}finally{try{a&&(i=r.return)&&(yield new kt(i.call(r)))}finally{if(l)throw l[0]}}})}function bf({optionGroupId:t,selectedId:e,variant_index:s,product:n,trackContentReferenceEvent:r}){var d,u,m,h,x,_;const a=(d=n.variants)==null?void 0:d.find(v=>v.id===t);r("product_detail","product_detail","product_entity",{product_id:n.id,action:"variant_selected",section:"product_detail",section_location:"sidebar",variant_name:(u=a==null?void 0:a.label)!=null?u:"",variant_value:(h=(m=a==null?void 0:a.options.find(v=>v.id===e))==null?void 0:m.label)!=null?h:"",variant_index:s});const i=(_=(x=n.variants)==null?void 0:x.map(v=>v.id===t?U(D({},v),{options:v.options.map(w=>U(D({},w),{selected:w.id===e})),selected_option_id:e}):v))!=null?_:n.variants,c=(i==null?void 0:i.every(v=>v.selected_option_id))?i==null?void 0:i.reduce((v,w)=>(w.selected_option_id&&(v[w.id]=w.selected_option_id),v),{}):null;return U(D({},n),{variants:i,product_lookup_key:U(D({},n.product_lookup_key),{variant_options_query:c})})}function _f({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:n}){var r,a,i;if(p.useEffect(()=>{var l,c;n("Entity Metadata Content Reference Shown","entity_metadata_content_reference_shown","entity_metadata",D({entity_type:t.entity_type},t.entity_type==="local_business"?{business_id:(l=t.entity_data)==null?void 0:l.id}:t.entity_type==="product"?{product_id:(c=t.entity_data)==null?void 0:c.id}:{}))},[n,t.entity_type,(r=t.entity_data)==null?void 0:r.id]),!(t!=null&&t.entity_data))return null;if(t.entity_type==="local_business"){const c=t.layout!=="one-line";return o.jsx(ym,{isLoading:(a=t.metadata)==null?void 0:a.is_loading,business:t.entity_data,mapUrl:(i=t.metadata)==null?void 0:i.map_url,showActionButtons:c,showExtendedDetails:c,showTitle:c,showHourDetail:c,showPrice:c,trackContentReferenceEvent:n,topOffset:c?0:-4})}else if(t.entity_type==="product")return o.jsx(xf,{product:t.entity_data,clientThreadId:e,messageId:s,contentReferenceStartIndex:t.start_idx,trackContentReferenceEvent:n});return null}function vf(t,e){return new Date(t).toLocaleDateString(e,{month:"long",day:"numeric",year:"numeric"})}function wf({metadata:t,trackContentReferenceEvent:e}){const s=t.items.filter(n=>n.cloud_doc_url||Si(n.id));return s.length===0?null:o.jsx("div",{className:"mt-6 flex flex-col gap-3",children:s.map((n,r)=>o.jsx(jf,{item:n,index:r,trackContentReferenceEvent:e},r))})}function jf({item:t,index:e,trackContentReferenceEvent:s}){const n=le(),r=xe(),a=Ni(),{fileName:i,fileTypeDisplayName:l,fileTypeIcon:c,snippet:d,url:u,fileLastModifiedTime:m}=bl(t,"icon object-contain",r,n,a),h={title:i,description:d!=null?d:"",index:e};return p.useEffect(()=>{s("Contextual Answers Content Reference Shown","contextual_answers_content_reference_shown","file_navlist",h)},[]),o.jsxs(Qe,{className:"group/nav-list relative flex items-center gap-6 py-1.5",href:u!=null?u:"/",onClick:()=>{s("Contextual Answers Content Reference Clicked","contextual_answers_content_reference_clicked","file_navlist",h)},children:[o.jsx("div",{className:"absolute start-0 top-0 bottom-0 w-[3px] rounded-t-lg rounded-b-lg bg-black/10"}),o.jsxs("div",{className:"ms-4 flex grow flex-col gap-1 overflow-hidden text-ellipsis",children:[o.jsxs("div",{className:"not-prose text-token-text-primary flex items-center gap-1.5 text-sm",children:[c,o.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm",children:l})]}),o.jsx("div",{className:"text-token-link decoration-token-link line-clamp-2 font-semibold group-hover/nav-list:underline",children:i}),o.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm leading-snug font-normal",children:d}),m&&o.jsx("div",{className:"text-token-text-secondary text-sm",children:vf(m,n.locale)})]})]})}var xs={line:{color:"#F66",width:1,dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(t,e){return!0},afterZoom:function(t,e){}}},kf={id:"crosshair",afterInit:function(t){if(t.config.options.scales.x){var e=t.config.options.scales.x.type;if(!(e!=="linear"&&e!=="time"&&e!=="category"&&e!=="logarithmic")){t.options.plugins.crosshair===void 0&&(t.options.plugins.crosshair=xs),t.crosshair={enabled:!1,suppressUpdate:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,ignoreNextEvents:0,reset:function(){this.resetZoom(t,!1,!1)}.bind(this)};var s=this.getOption(t,"sync","enabled");s&&(t.crosshair.syncEventHandler=function(n){this.handleSyncEvent(t,n)}.bind(this),t.crosshair.resetZoomEventHandler=function(n){var r=this.getOption(t,"sync","group");n.chartId!==t.id&&n.syncGroup===r&&this.resetZoom(t,!0)}.bind(this),window.addEventListener("sync-event",t.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler)),t.panZoom=this.panZoom.bind(this,t)}}},afterDestroy:function(t){var e=this.getOption(t,"sync","enabled");e&&(window.removeEventListener("sync-event",t.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler))},panZoom:function(t,e){if(t.crosshair.originalData.length!==0){var s=t.crosshair.end-t.crosshair.start,n=t.crosshair.min,r=t.crosshair.max;e<0?(t.crosshair.start=Math.max(t.crosshair.start+e,n),t.crosshair.end=t.crosshair.start===n?n+s:t.crosshair.end+e):(t.crosshair.end=Math.min(t.crosshair.end+e,t.crosshair.max),t.crosshair.start=t.crosshair.end===r?r-s:t.crosshair.start+e),this.doZoom(t,t.crosshair.start,t.crosshair.end)}},getOption:function(t,e,s){return fn(t.options.plugins.crosshair[e]?t.options.plugins.crosshair[e][s]:void 0,xs[e][s])},getXScale:function(t){return t.data.datasets.length?t.scales[t.getDatasetMeta(0).xAxisID]:null},getYScale:function(t){return t.scales[t.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(t,e){var s=this.getOption(t,"sync","group");if(e.chartId!==t.id&&e.syncGroup===s){var n=this.getXScale(t);if(n){var r=e.original.native.buttons===void 0?e.original.native.which:e.original.native.buttons;e.original.type==="mouseup"&&(r=0);var a={type:e.original.type=="click"?"mousemove":e.original.type,chart:t,x:n.getPixelForValue(e.xValue),y:e.original.y,native:{buttons:r},stop:!0};t._eventHandler(a)}}},afterEvent:function(t,e){if(t.config.options.scales.x.length==0)return;let s=e.event;var n=t.config.options.scales.x.type;if(!(n!=="linear"&&n!=="time"&&n!=="category"&&xscaleType!=="logarithmic")){var r=this.getXScale(t);if(r){if(t.crosshair.ignoreNextEvents>0){t.crosshair.ignoreNextEvents-=1;return}var a=s.native.buttons===void 0?s.native.which:s.native.buttons;s.native.type==="mouseup"&&(a=0);var i=this.getOption(t,"sync","enabled"),l=this.getOption(t,"sync","group");if(!s.stop&&i){var e=new CustomEvent("sync-event");e.chartId=t.id,e.syncGroup=l,e.original=s,e.xValue=r.getValueForPixel(s.x),window.dispatchEvent(e)}var c=this.getOption(t,"sync","suppressTooltips");if(t.crosshair.suppressTooltips=s.stop&&c,t.crosshair.enabled=s.type!=="mouseout"&&s.x>r.getPixelForValue(r.min)&&s.x<r.getPixelForValue(r.max),!t.crosshair.enabled&&!t.crosshair.suppressUpdate)return s.x>r.getPixelForValue(r.max)&&(t.crosshair.suppressUpdate=!0,t.update("none")),t.crosshair.dragStarted=!1,!1;t.crosshair.suppressUpdate=!1;var d=this.getOption(t,"zoom","enabled");if(a===1&&!t.crosshair.dragStarted&&d&&(t.crosshair.dragStartX=s.x,t.crosshair.dragStarted=!0),t.crosshair.dragStarted&&a===0){t.crosshair.dragStarted=!1;var u=r.getValueForPixel(t.crosshair.dragStartX),m=r.getValueForPixel(t.crosshair.x);Math.abs(t.crosshair.dragStartX-t.crosshair.x)>1&&this.doZoom(t,u,m),t.update("none")}t.crosshair.x=s.x,t.draw()}}},afterDraw:function(t){if(t.crosshair.enabled)return t.crosshair.dragStarted?this.drawZoombox(t):(this.drawTraceLine(t),this.interpolateValues(t),this.drawTracePoints(t)),!0},beforeTooltipDraw:function(t){return!t.crosshair.dragStarted&&!t.crosshair.suppressTooltips},resetZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(s){if(t.crosshair.originalData.length>0)for(var n=0;n<t.data.datasets.length;n++){var r=t.data.datasets[n];r.data=t.crosshair.originalData.shift(0)}t.crosshair.originalXRange.min?(t.options.scales.x.min=t.crosshair.originalXRange.min,t.crosshair.originalXRange.min=null):delete t.options.scales.x.min,t.crosshair.originalXRange.max?(t.options.scales.x.max=t.crosshair.originalXRange.max,t.crosshair.originalXRange.max=null):delete t.options.scales.x.max}t.crosshair.button&&t.crosshair.button.parentNode&&(t.crosshair.button.parentNode.removeChild(t.crosshair.button),t.crosshair.button=!1);var a=this.getOption(t,"sync","enabled");if(!e&&s&&a){var i=this.getOption(t,"sync","group"),l=new CustomEvent("reset-zoom-event");l.chartId=t.id,l.syncGroup=i,window.dispatchEvent(l)}s&&t.update("none")},doZoom:function(t,e,s){if(e>s){var n=e;e=s,s=n}var r=fn(t.options.plugins.crosshair.callbacks?t.options.plugins.crosshair.callbacks.beforeZoom:void 0,xs.callbacks.beforeZoom);if(!r(e,s))return!1;if(t.crosshair.dragStarted=!1,t.options.scales.x.min&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.min=t.options.scales.x.min),t.options.scales.x.max&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.max=t.options.scales.x.max),!t.crosshair.button){var a=document.createElement("button"),i=this.getOption(t,"zoom","zoomButtonText"),l=this.getOption(t,"zoom","zoomButtonClass"),c=document.createTextNode(i);a.appendChild(c),a.className=l,a.addEventListener("click",function(){this.resetZoom(t)}.bind(this)),t.canvas.parentNode.appendChild(a),t.crosshair.button=a}t.options.scales.x.min=e,t.options.scales.x.max=s;var d=t.crosshair.originalData.length===0,u=t.config.options.scales.x.type!=="category";if(u)for(var m=0;m<t.data.datasets.length;m++){var h=[],x=0,_=!1,v=!1;d&&(t.crosshair.originalData[m]=t.data.datasets[m].data);for(var w=t.crosshair.originalData[m],j=0;j<w.length;j++){var C=w[j],f=C.x!==void 0?C.x:NaN;f>=e&&!_&&x>0&&(h.push(w[x-1]),_=!0),f>=e&&f<=s&&h.push(C),f>s&&!v&&x<w.length&&(h.push(C),v=!0),x+=1}t.data.datasets[m].data=h}if(t.crosshair.start=e,t.crosshair.end=s,d){var y=this.getXScale(t);t.crosshair.min=y.min,t.crosshair.max=y.max}t.crosshair.ignoreNextEvents=2,t.update("none");var k=this.getOption(t,"callbacks","afterZoom");k(e,s)},drawZoombox:function(t){var e=this.getYScale(t),s=this.getOption(t,"zoom","zoomboxBorderColor"),n=this.getOption(t,"zoom","zoomboxBackgroundColor");t.ctx.beginPath(),t.ctx.rect(t.crosshair.dragStartX,e.getPixelForValue(e.max),t.crosshair.x-t.crosshair.dragStartX,e.getPixelForValue(e.min)-e.getPixelForValue(e.max)),t.ctx.lineWidth=1,t.ctx.strokeStyle=s,t.ctx.fillStyle=n,t.ctx.fill(),t.ctx.fillStyle="",t.ctx.stroke(),t.ctx.closePath()},drawTraceLine:function(t){var e=this.getYScale(t),s=this.getOption(t,"line","width"),n=this.getOption(t,"line","color"),r=this.getOption(t,"line","dashPattern"),a=this.getOption(t,"snap","enabled"),i=t.crosshair.x;a&&t._active.length&&(i=t._active[0].element.x),t.ctx.beginPath(),t.ctx.setLineDash(r),t.ctx.moveTo(i,e.getPixelForValue(e.max)),t.ctx.lineWidth=s,t.ctx.strokeStyle=n,t.ctx.lineTo(i,e.getPixelForValue(e.min)),t.ctx.stroke(),t.ctx.setLineDash([])},drawTracePoints:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],n=t.getDatasetMeta(e),r=t.scales[n.yAxisID];n.hidden||!s.interpolate||(t.ctx.beginPath(),t.ctx.arc(t.crosshair.x,r.getPixelForValue(s.interpolatedValue),3,0,2*Math.PI,!1),t.ctx.fillStyle="white",t.ctx.lineWidth=2,t.ctx.strokeStyle=s.borderColor,t.ctx.fill(),t.ctx.stroke())}},interpolateValues:function(t){for(var e=0;e<t.data.datasets.length;e++){var s=t.data.datasets[e],n=t.getDatasetMeta(e),r=t.scales[n.xAxisID],a=r.getValueForPixel(t.crosshair.x);if(!(n.hidden||!s.interpolate)){var i=s.data,l=i.findIndex(function(m){return m.x>=a}),c=i[l-1],d=i[l];if(t.data.datasets[e].steppedLine&&c)s.interpolatedValue=c.y;else if(c&&d){var u=(d.y-c.y)/(d.x-c.x);s.interpolatedValue=c.y+(a-c.x)*u}else s.interpolatedValue=NaN}}}};const Ft=(t=1)=>"rgba(48, 166, 51, ".concat(t,")"),Ot=(t=1)=>"rgba(241, 77, 66, ".concat(t,")"),eo="text-[#30a633]",to="text-[#f14d42]",Cf=["1d","5d","1m","6m","ytd","1y","5y","max"];function Sf({histories:t,selectedInterval:e,onSelectHistoryInterval:s}){var r;const n=Object.keys((r=t==null?void 0:t.quotes)!=null?r:{});return o.jsx("div",{className:"text-token-text-tertiary inline-flex items-start justify-between rounded-[10px] bg-[#f4f4f4] p-[3px] text-xs font-semibold sm:justify-start sm:gap-1 dark:bg-[#393939]",children:n.map(a=>o.jsx("button",{onClick:()=>{s==null||s(a)},className:A("border border-transparent px-3 py-1.5 text-xs font-semibold uppercase",e===a?"border-token-border-default! bg-token-main-surface-primary text-token-text-primary shadow-xxs dark:border-token-border-medium! rounded-lg":"hover:text-token-text-secondary"),children:wr[a].label},a))})}const wr={"1d":{label:"1D",formatTimestampLabel:so,formatTimestampTooltip:so,maxTicksLimit:6,lineTension:.1},"5d":{label:"5D",formatTimestampLabel:no,formatTimestampTooltip:Mf,maxTicksLimit:6,lineTension:.1},"1m":{label:"1M",formatTimestampLabel:no,formatTimestampTooltip:Ef,maxTicksLimit:6,lineTension:.1,useUtc:!0},"6m":{label:"6M",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.1,useUtc:!0},ytd:{label:"YTD",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.1,useUtc:!0},"1y":{label:"1Y",formatTimestampLabel:ys,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0},"5y":{label:"5Y",formatTimestampLabel:oo,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0},max:{label:"max",formatTimestampLabel:oo,formatTimestampTooltip:dt,maxTicksLimit:5,lineTension:.2,useUtc:!0}};function Nf(t){return t?Cf.filter(s=>s in t.quotes).find(s=>t.quotes[s].length>0):void 0}function tt(t,e){return ft(new Date(t*1e3),e!=null?e:"America/New_York")}function so(t,e,s){const n=tt(e,s);return t.formatTime(n,{hour:"numeric",minute:"numeric"})}function Mf(t,e,s){const n=tt(e,s);return t.formatDate(n,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}function dt(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",day:"numeric",year:"numeric"})}function ys(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",year:"numeric"})}function no(t,e,s){const n=tt(e,s);return t.formatDate(n,{month:"short",day:"numeric"})}function Ef(t,e,s){const n=tt(e,s);return t.formatDate(n,{weekday:"short",month:"short",day:"numeric"})}function oo(t,e,s){const n=tt(e,s);return t.formatDate(n,{year:"numeric"})}Cl.register(Sl,Nl,Ml,El,Tl,$l,Pl,Il,Al,kf,Ll);const Tf=100,ro={color:"#b4b4b4",font:{size:10,weight:"600",family:"Menlo"}};function $f({isUp:t,histories:e,selectedInterval:s,setHighlightedPrice:n,latestTradingPeriod:r,timezone:a}){return o.jsx(o.Fragment,{children:e&&s&&r?o.jsx(Pf,{isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:r,timezone:a,setHighlightedPrice:n}):o.jsx(ut,{className:"h-full",index:1,width:100})})}function Pf({isUp:t,histories:e,selectedInterval:s,latestTradingPeriod:n,timezone:r,setHighlightedPrice:a}){const[i,l]=p.useState(null),[c,d]=p.useState(!1),u=s==="1d",m=p.useMemo(()=>{let y=e.quotes[s].filter(k=>k.close>=0);if(u&&n){const k=n.regular.start_timestamp,S=n.regular.end_timestamp;if(y=y.filter(N=>N.timestamp>=k&&N.timestamp<=S),y.length===0||y[y.length-1].timestamp<S){let M=y.length>0?y[y.length-1].timestamp:k-600;for(;M<S;)M+=600,y.push({timestamp:M,close:null})}}return y},[e,s,u,n]),h=wr[s],{formatTimestampTooltip:x,maxTicksLimit:_,useUtc:v=!1}=h,w=le(),j=To(),C=Zt(),f=p.useMemo(()=>{const{formatTimestampLabel:y,lineTension:k}=h;return{labels:m.map(S=>y(w,S.timestamp,v?"UTC":r)),datasets:[{data:m.map(S=>S.close),borderColor:t?Ft():Ot(),pointRadius:0,pointHoverRadius:4,pointStyle:"circle",pointBackgroundColor:t?Ft():Ot(),pointHoverBorderWidth:2,pointHoverBorderColor:"rgba(255, 255, 255, 1)",backgroundColor:function(S){const{ctx:N,chartArea:M}=S.chart;if(M)return Af(N,M,t)},fill:!0,borderWidth:2,lineTension:k!=null?k:.4}]}},[h,m,t,v,r,w]);return o.jsx("div",{className:"flex h-full flex-col gap-6",children:o.jsxs("div",{className:"relative h-full",onMouseEnter:()=>d(!0),onMouseLeave:()=>{d(!1),a(null)},children:[o.jsx(Rl,{options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},hover:{mode:c?"index":"point"},animation:!1,scales:{x:{afterBuildTicks:y=>{if(y.ticks.length>_)if(u)y.ticks=y.ticks.filter((k,S)=>m[S].timestamp%(j?3600:7200)===0);else{const k=Math.ceil(y.ticks.length/(_-1));y.ticks=y.ticks.filter((S,N)=>N>0&&(N%k===0||N===y.ticks.length-1))}},grid:{display:!1},ticks:U(D({},ro),{align:"end"})},y:{ticks:U(D({},ro),{maxTicksLimit:7}),border:{display:!1},grid:{color:C?"rgba(255, 255, 255, 0.1)":"rgba(229, 229, 229, 0.5)"}}},plugins:{datalabels:{display:!1},legend:{display:!1},tooltip:{enabled:!1,animation:!1,displayColors:!1,callbacks:{title:function(y){var N;const k=y[0];if(!k)return"";const S=(N=m[k.dataIndex])==null?void 0:N.timestamp;return S?x(w,S,v?"UTC":r):""}},external:({tooltip:y})=>{var k,S,N,M;c&&y.opacity>0&&a(pt((M=(N=(S=(k=y.dataPoints)==null?void 0:k[0])==null?void 0:S.parsed)==null?void 0:N.y)!=null?M:0)),l($=>{var F,L,T,E,z;const P=y.chart.width,b=y.caretX>P-Tf;return!$||$.x!==y.caretX||$.y!==y.caretY||$.opacity!==y.opacity||$.flip!==b?U(D({},$),{x:y.caretX,y:y.caretY,dateLabel:(F=y.title)==null?void 0:F[0],value:pt((z=(E=(T=(L=y.dataPoints)==null?void 0:L[0])==null?void 0:T.parsed)==null?void 0:E.y)!=null?z:0),opacity:y.opacity,flip:b}):$})}},dropShadow:!1,crosshair:{line:{color:C?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)",width:.5},zoom:{enabled:!1}}}},data:f}),o.jsx(If,{tooltipData:i})]})})}function If({tooltipData:t}){return!t||!t.opacity?null:o.jsx("div",{style:{left:t.x-5,top:10,transform:"translate(-50%, -50%)"},className:A("text-token-main-surface-primary dark:bg-token-main-surface-secondary pointer-events-none absolute translate-y-[-100%] rounded-lg bg-black px-2 py-1 font-mono font-semibold whitespace-nowrap dark:text-white"),children:o.jsx("div",{className:"text-xs",children:t.dateLabel})})}function Af(t,e,s){const n=t.createLinearGradient(0,e.top,0,e.bottom);return n.addColorStop(0,s?Ft(.4):Ot(.4)),n.addColorStop(1,s?Ft(0):Ot(0)),n}function pt(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function Re({label:t,value:e,className:s}){return o.jsxs("div",{className:A("flex w-full flex-1 flex-row justify-between text-sm",s),children:[o.jsx("span",{className:"text-token-text-secondary font-normal whitespace-nowrap",children:t}),o.jsx("span",{className:"text-token-text-primary font-normal whitespace-nowrap",children:e})]})}function Lf({metrics:t}){const e=le(),s=!!(t.marketCap&&t.peRatio&&t.eps);return o.jsx("div",{className:"border-token-border-default flex flex-col gap-1 rounded-b-lg border-t bg-[#f4f4f4] px-4 py-3 dark:bg-[#393939]",children:o.jsxs("div",{className:A("grid grid-cols-2 gap-x-10 gap-y-3 lg:grid-cols-3 lg:gap-x-6"),children:[o.jsx(Re,{label:e.formatMessage({id:"MDHEj7",defaultMessage:"Open"}),value:e.formatNumber(t.openPrice,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-1"}),o.jsx(Re,{label:e.formatMessage({id:"PboNMC",defaultMessage:"Volume"}),value:e.formatNumber(t.intradayVolume,{notation:"compact",maximumFractionDigits:1}),className:A("order-2",!s&&"lg:order-last")}),o.jsxs("div",{className:"order-4 row-span-2 flex flex-col gap-3",children:[o.jsx(Re,{label:e.formatMessage({id:"bresUW",defaultMessage:"Day Low"}),value:e.formatNumber(t.intradayLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),o.jsx(Re,{label:e.formatMessage({id:"oWyv5V",defaultMessage:"Day High"}),value:e.formatNumber(t.intradayHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),o.jsxs("div",{className:"order-5 row-span-2 flex flex-col gap-3",children:[o.jsx(Re,{label:e.formatMessage({id:"DcEYIK",defaultMessage:"Year Low"}),value:e.formatNumber(t.fiftyTwoWeekLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),o.jsx(Re,{label:e.formatMessage({id:"ZfFtJ4",defaultMessage:"Year High"}),value:e.formatNumber(t.fiftyTwoWeekHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),t.marketCap&&o.jsx(Re,{label:e.formatMessage({id:"o7Vbua",defaultMessage:"Market Cap (TTM)"}),value:e.formatNumber(t.marketCap,{notation:"compact",maximumFractionDigits:2}),className:"order-last lg:order-3"}),t.peRatio&&t.eps&&o.jsxs(o.Fragment,{children:[o.jsx(Re,{label:e.formatMessage({id:"edGd+S",defaultMessage:"EPS (TTM)"}),value:e.formatNumber(t.eps,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"}),o.jsx(Re,{label:e.formatMessage({id:"uX5YWo",defaultMessage:"P/E Ratio (TTM)"}),value:e.formatNumber(t.peRatio,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"})]})]})})}function Rf({data:t,priceChange:e,highlightedPrice:s,extendedPriceChange:n,url:r}){var i;function a(l,c="intraday",d=null){const{isUp:u,changePercentage:m,changeLabel:h,changeAmount:x}=l,_=Math.abs(m).toFixed(2),v=pt(x);return o.jsxs("span",{className:"flex min-w-0 items-center gap-1",children:[c==="extended_hours"&&d!=null&&o.jsx("span",{className:"font-semibold",children:o.jsx(H,{id:"HWwWpW",defaultMessage:"{price}",values:{price:d}})}),o.jsx("span",{className:A("font-semibold",u?eo:to),children:o.jsx(H,{id:"3x4Lkl",defaultMessage:"{sign}{changeAmount}",values:{changeAmount:v,sign:u?"+":""}})}),o.jsx("span",{className:A("font-semibold",u?eo:to),children:o.jsx(H,{id:"MbfF1T",defaultMessage:"({sign}{changePercentage}%)",values:{changePercentage:_,sign:u?"+":"-"}})}),c==="extended_hours"?o.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h}):o.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:h})]})}return o.jsxs("div",{children:[o.jsx("div",{className:"mt-2 text-sm",children:t?o.jsx(H,{id:"+2WHuv",defaultMessage:"{name} ({ticker})",values:{name:t.asset.name,ticker:t.asset.ticker}}):o.jsx("div",{className:"w-32 font-medium",children:o.jsx(ut,{index:9,width:100})})}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:t?o.jsx(o.Fragment,{children:r!=null&&o.jsxs(o.Fragment,{children:[" · ",o.jsx(Qe,{href:r,className:"text-token-link hover:underline",children:Kt(r,"hostname")})]})}):o.jsx("div",{className:"mt-2 w-36",children:o.jsx(ut,{index:6,width:100})})}),o.jsx("div",{className:"mt-2 flex text-4xl font-semibold",children:t?o.jsx(H,{id:"s+1uly",defaultMessage:"{price}",values:{price:s!=null?s:pt(t.price.price)}}):o.jsx("div",{className:"w-32",children:o.jsx(ut,{index:0,width:100})})}),o.jsx("div",{className:"mt-2 flex items-center justify-start gap-1 text-sm",children:e?a(e):o.jsx("div",{className:"mt-2 w-40",children:o.jsx(ut,{index:3,width:100})})}),o.jsx("div",{className:"mt-0.5 flex items-center justify-start gap-1 text-sm",children:((i=t==null?void 0:t.price)==null?void 0:i.extended_price)!=null&&n!=null&&a(n,"extended_hours",pt(t.price.extended_price))})]})}function Df({contentReference:t,trackContentReferenceEvent:e}){var C,f,y,k,S,N,M,$,P,b,F,L,T,E,z;const s=le();p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown","stock")},[e]);const n=Nf((C=t==null?void 0:t.stock)==null?void 0:C.histories),r=t==null?void 0:t.stock,[a,i]=p.useState(n),[l,c]=p.useState(null),d=a==="1d",u=(k=(y=(f=r==null?void 0:r.histories)==null?void 0:f.quotes)==null?void 0:y[a!=null?a:""])==null?void 0:k[0],m=a&&a in At?a:void 0,h=r&&(u&&!d?{changePercentage:(r.price.price-u.close)/u.close*100,changeAmount:r.price.price-u.close,changeLabel:m?s.formatMessage(At[m]):"",isUp:r.price.price>u.close}:r.price.change_percent&&r.price.change?{changePercentage:r.price.change_percent*100,changeAmount:r.price.change,changeLabel:Of(r.price.latest_trade_timestamp,r.asset.timezone,s),isUp:r.price.change?r.price.change>0:!1}:null),x=r&&r.price.extended_price!=null&&r.price.extended_change_percent!=null&&r.price.extended_change!=null?{changePercentage:r.price.extended_change_percent*100,changeAmount:r.price.extended_change,changeLabel:s.formatMessage((S=Ff(r.price.market_status))!=null?S:At.extended),isUp:r.price.extended_change>0}:null,{fiftyTwoWeekHigh:_,fiftyTwoWeekLow:v}=p.useMemo(()=>{var te;const G=(te=r==null?void 0:r.histories)==null?void 0:te.quotes["1y"];if(!G)return{fiftyTwoWeekHigh:null,fiftyTwoWeekLow:null};const B=G.map(I=>I.high).filter(I=>I!=null),K=G.map(I=>I.low).filter(I=>I!=null);return{fiftyTwoWeekHigh:B.length>0?Math.max(...B):null,fiftyTwoWeekLow:K.length>0?Math.min(...K):null}},[(N=r==null?void 0:r.histories)==null?void 0:N.quotes]),w=r!=null&&r.price.open_price&&r.price.intraday_high&&r.price.intraday_low&&r.price.intraday_volume&&_&&v?{openPrice:r.price.open_price,intradayHigh:r.price.intraday_high,intradayLow:r.price.intraday_low,intradayVolume:r.price.intraday_volume,fiftyTwoWeekHigh:_,fiftyTwoWeekLow:v,marketCap:($=(M=r.metrics)==null?void 0:M.market_cap)!=null?$:void 0,peRatio:(b=(P=r.metrics)==null?void 0:P.pe_ratio)!=null?b:void 0,eps:(L=(F=r.metrics)==null?void 0:F.eps)!=null?L:void 0}:null,j=w!=null;return o.jsxs("div",{"data-testid":"finance-widget",className:A("border-token-border-default mb-2 flex min-h-[480px] flex-col gap-8 rounded-lg border"),children:[o.jsxs("div",{className:"mx-6 flex flex-wrap items-end justify-between",children:[o.jsx(Rf,{data:r!=null?r:null,highlightedPrice:l,priceChange:h!=null?h:null,extendedPriceChange:x!=null?x:null,url:(T=t==null?void 0:t.url)!=null?T:null}),o.jsx("div",{className:"mt-4",children:o.jsx(Sf,{selectedInterval:a,onSelectHistoryInterval:i,histories:r==null?void 0:r.histories})})]}),o.jsx("div",{className:"mx-6 h-[340px]",children:o.jsx($f,{isUp:(E=h==null?void 0:h.isUp)!=null?E:!1,selectedInterval:a,histories:r==null?void 0:r.histories,setHighlightedPrice:c,onSelectHistoryInterval:G=>i(G),latestTradingPeriod:r==null?void 0:r.asset.latest_trading_period,timezone:(z=r==null?void 0:r.asset.timezone)!=null?z:null})}),j&&o.jsx("div",{className:"-mt-4",children:o.jsx(Lf,{metrics:w})})]})}function Ff(t){if(t==null)return null;const e=t.toLowerCase();return e==="premarket"||e==="open"?mt({id:"By+pvF",defaultMessage:"Pre-Market"}):e==="afterhours"||e==="closed"?mt({id:"aLCg3c",defaultMessage:"After Hours"}):mt({id:"2p526c",defaultMessage:"Extended Hours"})}function Of(t,e,s){function n(r,a){const l=ft(new Date,a),c=s.formatDate(l,{year:"numeric",month:"2-digit",day:"2-digit"}),d=hn(r*1e3),u=ft(d,a),m=s.formatDate(u,{year:"numeric",month:"2-digit",day:"2-digit"});return c===m}if(!t||!e||n(t,e))return s.formatMessage(At["1d"]);{const r=hn(t*1e3),a=ft(r,e);return s.formatDate(a,{month:"long",day:"numeric"})}}const At=Is({"1d":{id:"SMdcuo",defaultMessage:"Today"},extended:{id:"2p526c",defaultMessage:"Extended Hours"},"5d":{id:"HCA6lr",defaultMessage:"Past 5 days"},"1m":{id:"DJpPMq",defaultMessage:"Past month"},"6m":{id:"1mUJ2L",defaultMessage:"Past 6 months"},ytd:{id:"b9KkhV",defaultMessage:"Year to date"},"1y":{id:"XnvD9A",defaultMessage:"Past year"},"5y":{id:"DfI1RB",defaultMessage:"Past 5 years"},max:{id:"WzOhuU",defaultMessage:"Max"}});function zf({metadata:t,trackContentReferenceEvent:e}){const s=p.useCallback(l=>{e("link_action",null,t.type,{url:t.url,title:t.title,pub_date:null,sub_pill_index:null,link_type:"link_title",action:l})},[t.title,t.type,t.url,e]);p.useEffect(()=>{s("show")},[s]);const[n,r]=p.useState(!1),a=()=>{n||(s("hover"),r(!0))},i=()=>{s("click")};return o.jsx(Qe,{href:t.url,onClick:i,onMouseEnter:a,onFocus:a,className:"underline",children:t.title})}const Wf={google_maps:{title:"Google Maps"}};function Hf({metadata:t,trackContentReferenceEvent:e}){var n,r;p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=(r=(n=Wf[t.provider])==null?void 0:n.title)!=null?r:"Maps";return o.jsx("span",{children:o.jsx(H,{id:"ZSUz1k",defaultMessage:" ({link}) ",values:{link:o.jsx(Qe,{href:t.url,children:s})}})})}const Bf=4,jr=3;function Vf(t){"use forget";var $,P,b,F;const e=he.c(34),{metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:a}=t,i=xe();let l;e[0]!==i?(l=()=>$o(i),e[0]=i,e[1]=l):l=e[1];const c=Ve(l);let d;e[2]!==n?(d=n?Mo(n):null,e[2]=n,e[3]=d):d=e[3];const u=d,m=(P=($=r==null?void 0:r.widgets)==null?void 0:$.query)!=null?P:"";let h;e[4]!==u||e[5]!==m?(h=((F=(b=m==null?void 0:m.trim())==null?void 0:b.length)!=null?F:0)>0?m:u,e[4]=u,e[5]=m,e[6]=h):h=e[6];const x=h;let _;e[7]!==i||e[8]!==c||e[9]!==x||e[10]!==s.items.length?(_=()=>{!c||s.items.length>=Bf||!x||Oo(i,x,"news")},e[7]=i,e[8]=c,e[9]=x,e[10]=s.items.length,e[11]=_):_=e[11];let v;e[12]!==i||e[13]!==c||e[14]!==n||e[15]!==x||e[16]!==s.items.length||e[17]!==r?(v=[i,c,n,x,s.items.length,r],e[12]=i,e[13]=c,e[14]=n,e[15]=x,e[16]=s.items.length,e[17]=r,e[18]=v):v=e[18],p.useEffect(_,v);let w;e[19]!==c||e[20]!==x?(w=L=>{var z,G;if(!c||!x)return[[],!1];const E=(z=L.entries[x])!=null?z:zo;return[(G=E.news)!=null?G:[],Wo(E,"news")]},e[19]=c,e[20]=x,e[21]=w):w=e[21];const[j,C]=Fo(w);let f;e[22]!==s.items?(f=new Set(s.items.map(qf)),e[22]=s.items,e[23]=f):f=e[23];const y=f;let k;if(e[24]!==a||e[25]!==s.items||e[26]!==y||e[27]!==j){let L;e[29]!==y?(L=E=>!y.has(qo(E.url)),e[29]=y,e[30]=L):L=e[30];const T=j.filter(L).slice(0,jr).map(Uf);k=a?[...s.items,...T]:s.items,e[24]=a,e[25]=s.items,e[26]=y,e[27]=j,e[28]=k}else k=e[28];const S=k,N=a&&C;let M;return e[31]!==S||e[32]!==N?(M={items:S,isLoading:N},e[31]=S,e[32]=N,e[33]=M):M=e[33],M}function Uf(t){const e=t.pub_date?new Date(t.pub_date).getTime()/1e3:null;return U(D({},t),{pub_date:e,attribution:t.domain})}function qf(t){return qo(t.url)}const Gf=/^navlist[\s\S]*$/;function Xf(t){"use forget";const e=he.c(31),{metadata:s,trackContentReferenceEvent:n,isFirstAssistantContent:r,superWidgetContent:a,lastUserMsgOfPrevTurn:i}=t,l=xe();let c;e[0]!==l?(c=We(l),e[0]=l,e[1]=c):c=e[1];const d=c;let u;e[2]!==l?(u=Gt(l),e[2]=l,e[3]=u):u=e[3];const m=u,h=s.items.length>0,x=p.useRef(n);let _,v;e[4]!==n?(_=()=>{x.current=n},v=[n],e[4]=n,e[5]=_,e[6]=v):(_=e[5],v=e[6]),p.useEffect(_,v);let w,j;e[7]!==h?(w=()=>{h&&x.current("Search Content Reference Shown","search_content_reference_shown","nav_list")},j=[h],e[7]=h,e[8]=w,e[9]=j):(w=e[8],j=e[9]),p.useEffect(w,j);let C;e[10]!==n?(C=(L,T)=>{n("link_action",null,"nav_list",U(D({},ao(L,T)),{action:"click"}))},e[10]=n,e[11]=C):C=e[11];const f=C;let y;e[12]!==n?(y=(L,T)=>{n("link_action",null,"nav_list",U(D({},ao(L,T)),{action:"show"}))},e[12]=n,e[13]=y):y=e[13];const k=y,S=d&&r,N=s.title&&!S;if(s.items.length===0)return null;const M=!S&&"mt-6";let $;e[14]!==M?($=A("mb-1",M),e[14]=M,e[15]=$):$=e[15];let P;e[16]!==s.title||e[17]!==N?(P=N&&o.jsx("div",{className:"text-token-text-primary -mb-1 pb-3 font-semibold",children:s.title}),e[16]=s.title,e[17]=N,e[18]=P):P=e[18];let b;e[19]!==f||e[20]!==k||e[21]!==d||e[22]!==m||e[23]!==i||e[24]!==s||e[25]!==a?(b=d&&!m?o.jsx(Yf,{metadata:s,lastUserMsgOfPrevTurn:i,superWidgetContent:a,onCardShown:k,onCardClicked:f}):o.jsx(_r,{items:s.items,onCardRender:Zf,onCardShown:k,onCardClicked:f,cardClassName:"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden"}),e[19]=f,e[20]=k,e[21]=d,e[22]=m,e[23]=i,e[24]=s,e[25]=a,e[26]=b):b=e[26];let F;return e[27]!==$||e[28]!==P||e[29]!==b?(F=o.jsxs("div",{className:$,"data-testid":"nav-list-widget",children:[P,b]}),e[27]=$,e[28]=P,e[29]=b,e[30]=F):F=e[30],F}function Zf(t){return o.jsx(kr,{item:t})}function Yf(t){"use forget";var k;const e=he.c(19),{metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,onCardShown:a,onCardClicked:i}=t,l=xe();let c;e[0]!==l?(c=()=>[$o(l),Xt(l)],e[0]=l,e[1]=c):c=e[1];const[d,u]=Ve(c);let m;e[2]!==s.matched_text?(m=Gf.test((k=s.matched_text)!=null?k:""),e[2]=s.matched_text,e[3]=m):m=e[3];const h=m;let x;e[4]!==h||e[5]!==n||e[6]!==s||e[7]!==r?(x={metadata:s,lastUserMsgOfPrevTurn:n,superWidgetContent:r,isContentReferenceComplete:h},e[4]=h,e[5]=n,e[6]=s,e[7]=r,e[8]=x):x=e[8];const{items:_,isLoading:v}=Vf(x),w=v&&d?jr:0,j=u?"-mx-[var(--thread-content-margin)]":"-mx-6";let C;e[9]!==j?(C=A("relative mb-6",j),e[9]=j,e[10]=C):C=e[10];let f;e[11]!==_||e[12]!==w||e[13]!==i||e[14]!==a?(f=o.jsx(Yt,{items:_,getItemKey:Jf,onRenderItem:Kf,className:"min-h-36",itemClassName:"max-w-[200px] min-w-[120px] sm:max-w-[calc((var(--thread-content-max-width)-2rem)/3)] thread-lg:w-61! w-50! shrink-0",onShown:a,onClick:i,numLoadingItems:w}),e[11]=_,e[12]=w,e[13]=i,e[14]=a,e[15]=f):f=e[15];let y;return e[16]!==C||e[17]!==f?(y=o.jsx("div",{className:C,children:f}),e[16]=C,e[17]=f,e[18]=y):y=e[18],y}function Kf(t){return o.jsx(kr,{item:t})}function Jf(t){return t.url}function kr({item:t}){var i,l;const{isSuccess:e}=ks((i=t.thumbnail_url)!=null?i:void 0,"NavListItem"),s=le(),n=xe(),r=We(n),a=Ta(s,t.pub_date);return o.jsxs(Qe,{className:"flex flex-col items-center gap-4 overflow-hidden pb-6",href:t.url,children:[e&&t.thumbnail_url?o.jsx("div",{className:"relative h-36 w-full overflow-hidden",children:o.jsx("img",{src:t.thumbnail_url,className:"m-0 h-full w-full",style:{objectFit:"cover"},alt:t.title})}):o.jsxs("div",{className:A("icon-bg relative flex h-36 w-full shrink-0 items-center justify-center overflow-hidden",r&&"bg-token-bg-secondary"),children:[o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-cover bg-center bg-no-repeat blur-3xl",children:o.jsx($t,{url:t.url,size:256,minSize:128,className:"mix-soft-light opacity-30 dark:opacity-20"})}),o.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:o.jsx($t,{url:t.url,size:128,minSize:80,className:"icon-xl rounded-full"})})]}),o.jsxs("div",{className:A("flex flex-col gap-2 overflow-hidden px-4 text-ellipsis",r&&"w-full items-start"),children:[o.jsxs("div",{className:"text-token-text-primary flex items-center gap-1.5 text-xs",children:[o.jsx($t,{url:t.url,size:32,minSize:16,className:"icon-xs my-0 rounded-full"}),(l=t.attribution)!=null?l:Kt(t.url)]}),o.jsx("div",{className:"text-token-text-primary decoration-token-link line-clamp-5 text-sm font-medium",children:t.title}),a&&o.jsx("div",{className:"text-token-text-secondary text-xs",children:a})]})]})}const ao=(t,e)=>({url:t.url,title:t.title,section_index:e,link_type:"text",section:"nav_list",section_location:"response"}),Qf="{{.assetPrefix}}/assets/missing-logo-h96s4tk9.webp",io={src:Qf};function Cr({team:t,className:e}){var a;const[s,n]=p.useState((a=t.logo)!=null?a:io.src),r=()=>{qt.addError("Unable to load sports widget logo",{name:t.name,logo:t.logo}),n(io.src)};return o.jsx("img",{src:s,alt:t.name,className:e,onError:r})}const xt=["ipl"],eh=Z(()=>X(()=>import("./glgf3sl2j4mvtn59.js"),__vite__mapDeps([35,1])),{loading:t=>Q(t)}),th=Z(()=>X(()=>import("./fyw02vlaiv2vq6cj.js").then(t=>t.zE),__vite__mapDeps([4,1,5,6,7])),{loading:t=>Q(t)}),lo=6,Ge="home",Xe="away";function sh({scheduleRef:t,trackContentReferenceEvent:e}){var _,v,w,j;const[s,n]=p.useState(!0),r=le(),a=t.games.length>0,i=t.league.id,l=$a(),c=bt();if(p.useEffect(()=>{a&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasSchedule:!0})},[a]),!a)return null;const u=((v=(_=r.formatDateToParts(new Date,{timeZoneName:"long"}).find(C=>C.type==="timeZoneName"))==null?void 0:_.value)!=null?v:Intl.DateTimeFormat().resolvedOptions().timeZone).replace(/Daylight|Standard/g,"");let m=t.games;const h=C=>Math.abs(new Date().getTime()-new Date(C.date).getTime());h(m[0])>h(m[m.length-1])&&(m=m.slice().reverse());const x=s?m.slice(0,lo):m;return o.jsxs("div",{className:"not-prose mb-3","data-testid":"sports-schedule-widget",children:[o.jsx("div",{className:"font-semibold",children:o.jsx(H,{id:"LA6z9q",defaultMessage:"{league} Schedule",values:{league:t.league.display_name}})}),o.jsx("div",{className:"text-token-text-secondary text-sm",children:u}),x.length===1?o.jsx("div",{children:o.jsx(js,{children:o.jsx(at.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},exit:{opacity:0,y:-15},transition:{duration:.2},children:o.jsx("div",{className:"border-token-border-medium mt-3 rounded-xl border py-3",children:o.jsx(oh,{game:x[0],useAlias:xt.includes(i),leagueId:i,activeTeam:(j=(w=x[0])==null?void 0:w.active_team)!=null?j:null,isMobile:c})})})})}):o.jsx("div",{className:"grid grid-cols-1 pt-3 lg:grid-cols-2",children:o.jsx(js,{children:x.map((C,f)=>{var y;return o.jsx(at.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0,transition:{delay:f*.04}},exit:{opacity:0,y:-15},transition:{duration:.2},children:o.jsx("div",{className:A("border-token-border-medium border-b py-3",f%2===0&&"lg:border-e lg:pe-4",f%2===1&&"lg:ps-4",Math.floor(f/2)===Math.ceil(m.length/2)-1&&"lg:border-b-0",f===m.length-1&&"border-b-0"),children:o.jsx(nh,{game:C,useAlias:(l||c)&&xt.includes(i),leagueId:i,activeTeam:(y=C.active_team)!=null?y:null})})},f)})})}),m.length>lo&&o.jsx("div",{className:"mt-2 flex items-center justify-between",children:o.jsx("button",{className:"flex items-center text-sm font-semibold",onClick:()=>n(!s),children:s?o.jsx(H,{id:"BH/Ee5",defaultMessage:"Show more {icon}",values:{icon:o.jsx(th,{className:"mb-[-2px]"})}}):o.jsx(H,{id:"Z9BlEu",defaultMessage:"Show less {icon}",values:{icon:o.jsx(eh,{className:"mb-[-2px]"})}})})})]})}function nh({game:t,useAlias:e=!1,leagueId:s,activeTeam:n}){var u,m;const r=Nr(t),a=[t.first_team_info,t.second_team_info],i=(u=a.find(h=>h.location===Ge))!=null?u:t.first_team_info,l=(m=a.find(h=>h.location===Xe))!=null?m:t.second_team_info,c=(r==null?void 0:r.team.name)===(i==null?void 0:i.team.name),d=(r==null?void 0:r.team.name)===(l==null?void 0:l.team.name);return o.jsxs("div",{className:"flex w-full gap-1.5 py-3 text-base",children:[o.jsxs("div",{className:"flex flex-auto flex-col items-start gap-1 pe-3",children:[o.jsx(Wt,{team:l.team,isWinner:d,isActive:n===Xe,logoSize:"small",useAlias:e}),o.jsx(Wt,{team:i.team,isWinner:c,isActive:n===Ge,logoSize:"small",useAlias:e})]}),o.jsxs("div",{className:A("flex flex-none flex-col items-start gap-1",xt.includes(s)&&"me-4"),children:[o.jsx(Ht,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"right"}:null,isWinner:d,negateScore:zt(s,Xe,n)}),o.jsx(Ht,{score:i.score,scoreSuffix:i.score_suffix,scoreParenthetical:i.score_parenthetical?{message:i.score_parenthetical,position:"right"}:null,isWinner:c,negateScore:zt(s,Ge,n)})]}),o.jsx("div",{className:"flex min-w-24 flex-none flex-col items-end justify-center gap-1 text-sm",children:o.jsx(Mr,{game:t})})]})}function oh({game:t,useAlias:e=!1,leagueId:s,activeTeam:n,isMobile:r}){var m,h;const a=Nr(t),i=[t.first_team_info,t.second_team_info],l=(m=i.find(x=>x.location===Ge))!=null?m:t.first_team_info,c=(h=i.find(x=>x.location===Xe))!=null?h:t.second_team_info,d=(a==null?void 0:a.team.name)===(l==null?void 0:l.team.name),u=(a==null?void 0:a.team.name)===(c==null?void 0:c.team.name);return o.jsxs("div",{className:"flex w-full py-3 text-base",children:[o.jsx("div",{className:"flex flex-1 items-center justify-center px-2",children:o.jsx(Wt,{team:c.team,isWinner:u,isActive:n===Xe,useAlias:e,layoutDirection:r?"column":"row"})}),o.jsx("div",{className:"ms-2 flex items-center justify-start sm:ms-8",children:o.jsx(Ht,{score:c.score,scoreSuffix:c.score_suffix,scoreParenthetical:c.score_parenthetical?{message:c.score_parenthetical,position:"bottom"}:null,isWinner:u,negateScore:zt(s,Xe,n),className:"text-sm font-semibold sm:text-lg"})}),o.jsx("div",{className:"mx-2 flex w-24 shrink flex-col items-center justify-center gap-1 align-middle text-sm",children:o.jsx(Mr,{game:t})}),o.jsx("div",{className:"me-2 flex items-center justify-end sm:me-8",children:o.jsx(Ht,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"bottom"}:null,isWinner:d,negateScore:zt(s,Ge,n),className:"text-sm font-semibold sm:text-lg"})}),o.jsx("div",{className:"flex flex-1 items-center justify-center md:px-2",children:o.jsx(Wt,{team:l.team,isWinner:d,isActive:n===Ge,useAlias:e,layoutDirection:r?"column":"row"})})]})}function Sr(t){return t.live?"live":new Date(t.date)<new Date?"complete":"scheduled"}function Nr(t){return Sr(t)!=="complete"||t.first_team_info.score==null||t.second_team_info.score==null?null:t.first_team_info.score>t.second_team_info.score?t.first_team_info:t.second_team_info}function zt(t,e,s){return xt.includes(t)&&e===Ge&&s===Xe}function Wt({team:t,isWinner:e,isActive:s,logoSize:n,useAlias:r=!1,layoutDirection:a="row"}){return o.jsxs("span",{className:A("flex items-center gap-1",e&&"font-semibold","max-w-64 lg:max-w-52 xl:max-w-64",a==="column"&&"flex-col"),children:[t.logo&&o.jsx(Cr,{team:{name:t.name,logo:t.logo},className:A(n==="small"?"w-6":"w-8")}),o.jsx("span",{className:"truncate",children:r?t.alias:t.name}),s&&o.jsx("span",{className:"bg-token-surface-error inline-block h-2 w-2 rounded-full"})]})}function Ht({score:t,scoreSuffix:e,scoreParenthetical:s,isWinner:n,negateScore:r=!1,className:a}){const i=le();return t==null?null:o.jsxs("span",{className:A(n&&"font-semibold",a),children:[r?i.formatMessage({id:"sports.dash",defaultMessage:"-"}):t,e&&!r&&o.jsx("span",{children:e}),s&&!r&&o.jsx("span",{className:A("text-token-text-secondary font-normal",s.position==="right"&&"ms-1",s.position==="bottom"&&"mx-auto block text-center"),children:"(".concat(s.message,")")})]})}function Mr({game:t}){const e=le();switch(Sr(t)){case"live":return o.jsxs(o.Fragment,{children:[o.jsx(rh,{}),o.jsx("div",{children:t.details})]});case"complete":return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-semibold",children:o.jsx(H,{id:"q/iMZL",defaultMessage:"Final"})}),o.jsx("div",{className:"text-token-text-secondary",children:Ss(e,new Date(t.date))})]});case"scheduled":{const s=new Date(t.date);return isNaN(s.getTime())?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{children:Ss(e,s)}),o.jsx("div",{className:"text-token-text-secondary",children:e.formatDate(s,{timeStyle:"short"})})]})}}}function rh(){return o.jsx("div",{className:"bg-token-surface-error rounded-[4px] px-1.5 py-1 text-xs font-semibold text-white",children:o.jsx(H,{id:"vObALn",defaultMessage:"Live"})})}function ah({standingsRef:t,trackContentReferenceEvent:e}){const[s,n]=p.useState(0),r=t.conferences.length>0,a=bt(),i=t.league.id;p.useEffect(()=>{r&&e("Search Content Reference Shown","search_content_reference_shown","sports",{hasStandings:!0})},[r]);const l=t.conferences[s],c=t.conferences.length>1?t.conferences.map((d,u)=>o.jsx("button",{className:A(s===u?"text-token-text-primary":"text-token-text-tertiary","text-sm font-semibold"),onClick:()=>n(u),children:d.name},d.name)):null;return o.jsxs("div",{"data-testid":"sports-standings-widget",children:[c&&o.jsx("div",{className:"flex gap-4",children:c}),o.jsx("div",{className:"mt-3",children:l.divisions.map(d=>d.name?o.jsx("div",{className:"mt-3",children:o.jsx(co,{division:d,teamsColumnHeader:d.name})},d.name):o.jsx(co,{division:d,useAlias:a&&xt.includes(i)}))})]})}function co({division:t,teamsColumnHeader:e,useAlias:s}){const n=t.headers.map(r=>r.key);return o.jsxs(Ee.Root,{size:"compact",className:"not-prose",children:[o.jsxs(Ee.Header,{children:[o.jsx(ih,{children:e!=null?e:o.jsx(H,{id:"kKSGje",defaultMessage:"Team"})}),t.headers.map(r=>o.jsx(Er,{textAlign:"center",className:"min-w-11 px-0!",children:o.jsx(uo,{data:r})},r.key))]}),o.jsx(Ee.Body,{children:t.teams.map(({team:r,data:a},i)=>{const l=a.reduce((c,d)=>(c[d.key]=d,c),{});return o.jsxs(Ee.Row,{children:[o.jsx(Ee.Cell,{className:"w-full border-0! py-0! ps-0!",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"text-token-text-tertiary me-2 w-4 whitespace-nowrap tabular-nums",children:i+1}),o.jsxs("div",{className:"flex items-center justify-start gap-2",children:[o.jsx(Cr,{team:r,className:"w-6"}),o.jsx("span",{className:"text-base whitespace-nowrap",children:s?r.alias:r.name})]})]})}),n.map(c=>o.jsx(Ee.Cell,{className:"min-w-11 border-0! px-0! py-0! text-start whitespace-nowrap tabular-nums",textAlign:"center",children:o.jsx(uo,{data:l[c]})},c))]},r.name)})})]})}function uo({data:t}){switch(t.type){case"text":return o.jsx(o.Fragment,{children:t.text});default:return o.jsx(o.Fragment,{children:t.alt})}}var po;const Er=Po(Ee.HeaderCell)(po||(po=jt(["text-token-text-secondary font-normal! text-sm static! bg-transparent! border-token-border-default! border-t-0! border-s-0! border-e-0!"])));var go;const ih=Po(Er)(go||(go=jt(["text-token-text-primary ps-0!"])));function lh({metadata:t,trackContentReferenceEvent:e}){p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]);const s=le(),n=ft(t.utc_time,t.utc_offset),r=s.formatDate(n,{hour:"numeric",minute:"numeric"});return o.jsx("span",{children:r})}function ch({metadata:t,trackContentReferenceEvent:e}){return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type)},[e,t.type]),o.jsx("div",{children:t.url?o.jsx(_l,{webpageItem:{url:t.url,title:t.description,pub_date:null,snippet:"",attributions:null},className:"inline-flex flex-col",children:o.jsx(Qe,{href:t.url,className:"font-semibold!",children:t.description})}):o.jsx("div",{className:"font-semibold!",children:t.description})})}function dh({videoId:t,title:e="YouTube video player",fallbackText:s,cookieLess:n=!0,timeoutMs:r=5e3,className:a=""}){const i=p.useRef(null),l=p.useRef(null),c=p.useRef(!1),[d,u]=p.useState("idle"),m=()=>{c.current=!0,l.current&&(clearTimeout(l.current),l.current=null)};if(p.useEffect(()=>{u("loading"),c.current=!1;let x=null;return uh().then(()=>{if(!i.current)return;i.current.textContent="",x=document.createElement("div"),x.style.width="200px",x.style.height="150px",i.current.appendChild(x),l.current=window.setTimeout(()=>{c.current||u("timeout")},r);const _=n?"https://www.youtube-nocookie.com":"https://www.youtube.com";new window.YT.Player(x,{width:200,height:150,videoId:t,host:_,playerVars:{rel:0,playsinline:1,origin:window.location.origin},events:{onReady:()=>{m(),u("ready")},onError:()=>{m(),u("error")}}})}).catch(()=>u("error")),()=>{m()}},[t,n,r]),d==="error"||d==="timeout")return o.jsx("a",{href:"https://www.youtube.com/watch?v=".concat(t),target:"_blank",rel:"noopener noreferrer",children:s});const h=n?"https://www.youtube-nocookie.com":"https://www.youtube.com";return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:i,"aria-hidden":!0,inert:!0,className:"hidden"}),o.jsx("iframe",{src:"".concat(h,"/embed/").concat(t),allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:a,title:e})]})}function uh(){return new Promise(t=>{var s;if((s=window.YT)!=null&&s.Player)return t();const e=window.onYouTubeIframeAPIReady;if(window.onYouTubeIframeAPIReady=()=>{e==null||e(),t(),window.onYouTubeIframeAPIReady=e||(()=>{})},!document.querySelector("script[src*='youtube.com/iframe_api']")){const n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.head.appendChild(n)}})}function mh({url:t,className:e,iframeClassName:s,iframeTitle:n}){let r;const a=A("aspect-video w-full",s),i=fh(t);i&&(r=o.jsx(dh,{className:a,videoId:i,title:n,fallbackText:n!=null?n:o.jsx(H,{id:"sonic.video.youtube.title",defaultMessage:"YouTube video link"}),cookieLess:!1}));const l=hh(t);return l&&(r=o.jsx(ph,{videoId:l,className:a,iframeTitle:n})),r?o.jsx("div",{className:e,children:r}):null}function fh(t){const e=/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|shorts\/|embed\/|v\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,s=t.match(e);return s?s[1]:null}function hh(t){const e=/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/[^/]+\/videos\/|video\/|)(\d+)/,s=t.match(e);return s?s[1]:null}function ph({videoId:t,className:e,iframeTitle:s}){return o.jsx(o.Fragment,{children:o.jsx("iframe",{className:e,src:"https://player.vimeo.com/video/".concat(t),frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:s})})}function gh({video:t,trackContentReferenceEvent:e}){const s={url:t.url,title:t.title};return p.useEffect(()=>{e("Search Content Reference Shown","search_content_reference_shown",t.type,s)},[]),t.url==null||t.url===""?null:o.jsx("div",{className:"not-prose mb-3 flex flex-col gap-4 text-base","data-testid":"video-widget",children:o.jsx(mh,{url:t.url,iframeClassName:"rounded-lg"})})}const xh="webp",yh=96,bh=96,_h="srgb",vh=4,wh="uchar",jh=288,kh=!1,Ch=!1,Sh=!0,Nh="{{.assetPrefix}}/assets/cloud-foggy-o4a3hmky.webp",Mh={format:xh,width:yh,height:bh,space:_h,channels:vh,depth:wh,density:jh,isProgressive:kh,hasProfile:Ch,hasAlpha:Sh,src:Nh},Eh="webp",Th=96,$h=96,Ph="srgb",Ih=4,Ah="uchar",Lh=288,Rh=!1,Dh=!1,Fh=!0,Oh="{{.assetPrefix}}/assets/cloudy-co8vwrk7.webp",zh={format:Eh,width:Th,height:$h,space:Ph,channels:Ih,depth:Ah,density:Lh,isProgressive:Rh,hasProfile:Dh,hasAlpha:Fh,src:Oh},Wh="webp",Hh=96,Bh=96,Vh="srgb",Uh=4,qh="uchar",Gh=288,Xh=!1,Zh=!1,Yh=!0,Kh="{{.assetPrefix}}/assets/heavy-snow-mke52kag.webp",Jh={format:Wh,width:Hh,height:Bh,space:Vh,channels:Uh,depth:qh,density:Gh,isProgressive:Xh,hasProfile:Zh,hasAlpha:Yh,src:Kh},Qh="webp",ep=96,tp=96,sp="srgb",np=4,op="uchar",rp=288,ap=!1,ip=!1,lp=!0,cp="{{.assetPrefix}}/assets/light-snow-mcy1l7t9.webp",dp={format:Qh,width:ep,height:tp,space:sp,channels:np,depth:op,density:rp,isProgressive:ap,hasProfile:ip,hasAlpha:lp,src:cp},up="webp",mp=96,fp=96,hp="srgb",pp=4,gp="uchar",xp=288,yp=!1,bp=!1,_p=!0,vp="{{.assetPrefix}}/assets/moon-drizzle-cplxr2ub.webp",wp={format:up,width:mp,height:fp,space:hp,channels:pp,depth:gp,density:xp,isProgressive:yp,hasProfile:bp,hasAlpha:_p,src:vp},jp="webp",kp=96,Cp=96,Sp="srgb",Np=4,Mp="uchar",Ep=288,Tp=!1,$p=!1,Pp=!0,Ip="{{.assetPrefix}}/assets/moon-hazy-jvgt25bp.webp",Ap={format:jp,width:kp,height:Cp,space:Sp,channels:Np,depth:Mp,density:Ep,isProgressive:Tp,hasProfile:$p,hasAlpha:Pp,src:Ip},Lp="webp",Rp=96,Dp=96,Fp="srgb",Op=4,zp="uchar",Wp=288,Hp=!1,Bp=!1,Vp=!0,Up="{{.assetPrefix}}/assets/moon-mostly-cloudy-cia3do0v.webp",qp={format:Lp,width:Rp,height:Dp,space:Fp,channels:Op,depth:zp,density:Wp,isProgressive:Hp,hasProfile:Bp,hasAlpha:Vp,src:Up},Gp="webp",Xp=96,Zp=96,Yp="srgb",Kp=4,Jp="uchar",Qp=288,eg=!1,tg=!1,sg=!0,ng="{{.assetPrefix}}/assets/moon-mostly-sunny-n3mh1b6a.webp",og={format:Gp,width:Xp,height:Zp,space:Yp,channels:Kp,depth:Jp,density:Qp,isProgressive:eg,hasProfile:tg,hasAlpha:sg,src:ng},rg="webp",ag=96,ig=96,lg="srgb",cg=4,dg="uchar",ug=288,mg=!1,fg=!1,hg=!0,pg="{{.assetPrefix}}/assets/moon-shower-ntzhti9o.webp",gg={format:rg,width:ag,height:ig,space:lg,channels:cg,depth:dg,density:ug,isProgressive:mg,hasProfile:fg,hasAlpha:hg,src:pg},xg="webp",yg=96,bg=96,_g="srgb",vg=4,wg="uchar",jg=288,kg=!1,Cg=!1,Sg=!0,Ng="{{.assetPrefix}}/assets/moon-sunny-eg2emh4d.webp",Mg={format:xg,width:yg,height:bg,space:_g,channels:vg,depth:wg,density:jg,isProgressive:kg,hasProfile:Cg,hasAlpha:Sg,src:Ng},Eg="webp",Tg=96,$g=96,Pg="srgb",Ig=4,Ag="uchar",Lg=288,Rg=!1,Dg=!1,Fg=!0,Og="{{.assetPrefix}}/assets/rain-thunder-bx7a0l5g.webp",zg={format:Eg,width:Tg,height:$g,space:Pg,channels:Ig,depth:Ag,density:Lg,isProgressive:Rg,hasProfile:Dg,hasAlpha:Fg,src:Og},Wg="webp",Hg=96,Bg=96,Vg="srgb",Ug=4,qg="uchar",Gg=288,Xg=!1,Zg=!1,Yg=!0,Kg="{{.assetPrefix}}/assets/rain-cxs76xuj.webp",Jg={format:Wg,width:Hg,height:Bg,space:Vg,channels:Ug,depth:qg,density:Gg,isProgressive:Xg,hasProfile:Zg,hasAlpha:Yg,src:Kg},Qg="webp",ex=96,tx=96,sx="srgb",nx=4,ox="uchar",rx=288,ax=!1,ix=!1,lx=!0,cx="{{.assetPrefix}}/assets/sleet-gc63vwmo.webp",dx={format:Qg,width:ex,height:tx,space:sx,channels:nx,depth:ox,density:rx,isProgressive:ax,hasProfile:ix,hasAlpha:lx,src:cx},ux="webp",mx=96,fx=96,hx="srgb",px=4,gx="uchar",xx=288,yx=!1,bx=!1,_x=!0,vx="{{.assetPrefix}}/assets/snow-d0k6tmmc.webp",wx={format:ux,width:mx,height:fx,space:hx,channels:px,depth:gx,density:xx,isProgressive:yx,hasProfile:bx,hasAlpha:_x,src:vx},jx="webp",kx=96,Cx=96,Sx="srgb",Nx=4,Mx="uchar",Ex=288,Tx=!1,$x=!1,Px=!0,Ix="{{.assetPrefix}}/assets/sun-drizzle-g94obr5e.webp",Ax={format:jx,width:kx,height:Cx,space:Sx,channels:Nx,depth:Mx,density:Ex,isProgressive:Tx,hasProfile:$x,hasAlpha:Px,src:Ix},Lx="webp",Rx=96,Dx=96,Fx="srgb",Ox=4,zx="uchar",Wx=288,Hx=!1,Bx=!1,Vx=!0,Ux="{{.assetPrefix}}/assets/sun-hazy-c3z1j0hy.webp",qx={format:Lx,width:Rx,height:Dx,space:Fx,channels:Ox,depth:zx,density:Wx,isProgressive:Hx,hasProfile:Bx,hasAlpha:Vx,src:Ux},Gx="webp",Xx=96,Zx=96,Yx="srgb",Kx=4,Jx="uchar",Qx=288,e1=!1,t1=!1,s1=!0,n1="{{.assetPrefix}}/assets/sun-mostly-cloudy-d4o4zkga.webp",o1={format:Gx,width:Xx,height:Zx,space:Yx,channels:Kx,depth:Jx,density:Qx,isProgressive:e1,hasProfile:t1,hasAlpha:s1,src:n1},r1="webp",a1=96,i1=96,l1="srgb",c1=4,d1="uchar",u1=288,m1=!1,f1=!1,h1=!0,p1="{{.assetPrefix}}/assets/sun-mostly-sunny-livrdkgu.webp",g1={format:r1,width:a1,height:i1,space:l1,channels:c1,depth:d1,density:u1,isProgressive:m1,hasProfile:f1,hasAlpha:h1,src:p1},x1="webp",y1=96,b1=96,_1="srgb",v1=4,w1="uchar",j1=288,k1=!1,C1=!1,S1=!0,N1="{{.assetPrefix}}/assets/sun-shower-lvtjthah.webp",M1={format:x1,width:y1,height:b1,space:_1,channels:v1,depth:w1,density:j1,isProgressive:k1,hasProfile:C1,hasAlpha:S1,src:N1},E1="webp",T1=96,$1=96,P1="srgb",I1=4,A1="uchar",L1=288,R1=!1,D1=!1,F1=!0,O1="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",z1={format:E1,width:T1,height:$1,space:P1,channels:I1,depth:A1,density:L1,isProgressive:R1,hasProfile:D1,hasAlpha:F1,src:O1},W1="webp",H1=96,B1=96,V1="srgb",U1=4,q1="uchar",G1=288,X1=!1,Z1=!1,Y1=!0,K1="{{.assetPrefix}}/assets/thunder-jgjqg9ai.webp",J1={format:W1,width:H1,height:B1,space:V1,channels:U1,depth:q1,density:G1,isProgressive:X1,hasProfile:Z1,hasAlpha:Y1,src:K1},Q1="webp",e0=96,t0=96,s0="srgb",n0=4,o0="uchar",r0=288,a0=!1,i0=!1,l0=!0,c0="{{.assetPrefix}}/assets/tornado-opa24tq3.webp",d0={format:Q1,width:e0,height:t0,space:s0,channels:n0,depth:o0,density:r0,isProgressive:a0,hasProfile:i0,hasAlpha:l0,src:c0},u0="webp",m0=96,f0=96,h0="srgb",p0=4,g0="uchar",x0=288,y0=!1,b0=!1,_0=!0,v0="{{.assetPrefix}}/assets/windy-mw0a3u21.webp",w0={format:u0,width:m0,height:f0,space:h0,channels:p0,depth:g0,density:x0,isProgressive:y0,hasProfile:b0,hasAlpha:_0,src:v0},j0="webp",k0=96,C0=96,S0="srgb",N0=4,M0="uchar",E0=288,T0=!1,$0=!1,P0=!0,I0="{{.assetPrefix}}/assets/cloud-foggy-fhg0jn0w.webp",A0={format:j0,width:k0,height:C0,space:S0,channels:N0,depth:M0,density:E0,isProgressive:T0,hasProfile:$0,hasAlpha:P0,src:I0},L0="webp",R0=96,D0=96,F0="srgb",O0=4,z0="uchar",W0=288,H0=!1,B0=!1,V0=!0,U0="{{.assetPrefix}}/assets/cloudy-disd26f3.webp",q0={format:L0,width:R0,height:D0,space:F0,channels:O0,depth:z0,density:W0,isProgressive:H0,hasProfile:B0,hasAlpha:V0,src:U0},G0="webp",X0=96,Z0=96,Y0="srgb",K0=4,J0="uchar",Q0=288,ey=!1,ty=!1,sy=!0,ny="{{.assetPrefix}}/assets/heavy-snow-g6jjwo2d.webp",oy={format:G0,width:X0,height:Z0,space:Y0,channels:K0,depth:J0,density:Q0,isProgressive:ey,hasProfile:ty,hasAlpha:sy,src:ny},ry="webp",ay=96,iy=96,ly="srgb",cy=4,dy="uchar",uy=288,my=!1,fy=!1,hy=!0,py="{{.assetPrefix}}/assets/light-snow-iz0efpkh.webp",gy={format:ry,width:ay,height:iy,space:ly,channels:cy,depth:dy,density:uy,isProgressive:my,hasProfile:fy,hasAlpha:hy,src:py},xy="webp",yy=96,by=96,_y="srgb",vy=4,wy="uchar",jy=288,ky=!1,Cy=!1,Sy=!0,Ny="{{.assetPrefix}}/assets/moon-drizzle-b1nfv39c.webp",My={format:xy,width:yy,height:by,space:_y,channels:vy,depth:wy,density:jy,isProgressive:ky,hasProfile:Cy,hasAlpha:Sy,src:Ny},Ey="webp",Ty=96,$y=96,Py="srgb",Iy=4,Ay="uchar",Ly=288,Ry=!1,Dy=!1,Fy=!0,Oy="{{.assetPrefix}}/assets/moon-hazy-nfnzea7a.webp",zy={format:Ey,width:Ty,height:$y,space:Py,channels:Iy,depth:Ay,density:Ly,isProgressive:Ry,hasProfile:Dy,hasAlpha:Fy,src:Oy},Wy="webp",Hy=96,By=96,Vy="srgb",Uy=4,qy="uchar",Gy=288,Xy=!1,Zy=!1,Yy=!0,Ky="{{.assetPrefix}}/assets/moon-mostly-cloudy-e56e3z55.webp",Jy={format:Wy,width:Hy,height:By,space:Vy,channels:Uy,depth:qy,density:Gy,isProgressive:Xy,hasProfile:Zy,hasAlpha:Yy,src:Ky},Qy="webp",eb=96,tb=96,sb="srgb",nb=4,ob="uchar",rb=288,ab=!1,ib=!1,lb=!0,cb="{{.assetPrefix}}/assets/moon-mostly-sunny-ffu4gzf4.webp",db={format:Qy,width:eb,height:tb,space:sb,channels:nb,depth:ob,density:rb,isProgressive:ab,hasProfile:ib,hasAlpha:lb,src:cb},ub="webp",mb=96,fb=96,hb="srgb",pb=4,gb="uchar",xb=288,yb=!1,bb=!1,_b=!0,vb="{{.assetPrefix}}/assets/moon-shower-e5dy9u48.webp",wb={format:ub,width:mb,height:fb,space:hb,channels:pb,depth:gb,density:xb,isProgressive:yb,hasProfile:bb,hasAlpha:_b,src:vb},jb="webp",kb=96,Cb=96,Sb="srgb",Nb=4,Mb="uchar",Eb=288,Tb=!1,$b=!1,Pb=!0,Ib="{{.assetPrefix}}/assets/moon-sunny-d9o08xiw.webp",Ab={format:jb,width:kb,height:Cb,space:Sb,channels:Nb,depth:Mb,density:Eb,isProgressive:Tb,hasProfile:$b,hasAlpha:Pb,src:Ib},Lb="webp",Rb=96,Db=96,Fb="srgb",Ob=4,zb="uchar",Wb=288,Hb=!1,Bb=!1,Vb=!0,Ub="{{.assetPrefix}}/assets/rain-thunder-eplemvu1.webp",qb={format:Lb,width:Rb,height:Db,space:Fb,channels:Ob,depth:zb,density:Wb,isProgressive:Hb,hasProfile:Bb,hasAlpha:Vb,src:Ub},Gb="webp",Xb=96,Zb=96,Yb="srgb",Kb=4,Jb="uchar",Qb=288,e_=!1,t_=!1,s_=!0,n_="{{.assetPrefix}}/assets/rain-ogayr6kt.webp",o_={format:Gb,width:Xb,height:Zb,space:Yb,channels:Kb,depth:Jb,density:Qb,isProgressive:e_,hasProfile:t_,hasAlpha:s_,src:n_},r_="webp",a_=96,i_=96,l_="srgb",c_=4,d_="uchar",u_=288,m_=!1,f_=!1,h_=!0,p_="{{.assetPrefix}}/assets/sleet-o8noil7l.webp",g_={format:r_,width:a_,height:i_,space:l_,channels:c_,depth:d_,density:u_,isProgressive:m_,hasProfile:f_,hasAlpha:h_,src:p_},x_="webp",y_=96,b_=96,__="srgb",v_=4,w_="uchar",j_=288,k_=!1,C_=!1,S_=!0,N_="{{.assetPrefix}}/assets/snow-lq4cl3uc.webp",M_={format:x_,width:y_,height:b_,space:__,channels:v_,depth:w_,density:j_,isProgressive:k_,hasProfile:C_,hasAlpha:S_,src:N_},E_="webp",T_=96,$_=96,P_="srgb",I_=4,A_="uchar",L_=288,R_=!1,D_=!1,F_=!0,O_="{{.assetPrefix}}/assets/sun-drizzle-htsohv65.webp",z_={format:E_,width:T_,height:$_,space:P_,channels:I_,depth:A_,density:L_,isProgressive:R_,hasProfile:D_,hasAlpha:F_,src:O_},W_="webp",H_=96,B_=96,V_="srgb",U_=4,q_="uchar",G_=288,X_=!1,Z_=!1,Y_=!0,K_="{{.assetPrefix}}/assets/sun-hazy-nfj7clcd.webp",J_={format:W_,width:H_,height:B_,space:V_,channels:U_,depth:q_,density:G_,isProgressive:X_,hasProfile:Z_,hasAlpha:Y_,src:K_},Q_="webp",ev=96,tv=96,sv="srgb",nv=4,ov="uchar",rv=288,av=!1,iv=!1,lv=!0,cv="{{.assetPrefix}}/assets/sun-mostly-cloudy-e3pqqgs7.webp",dv={format:Q_,width:ev,height:tv,space:sv,channels:nv,depth:ov,density:rv,isProgressive:av,hasProfile:iv,hasAlpha:lv,src:cv},uv="webp",mv=96,fv=96,hv="srgb",pv=4,gv="uchar",xv=288,yv=!1,bv=!1,_v=!0,vv="{{.assetPrefix}}/assets/sun-mostly-sunny-o99k1c7a.webp",wv={format:uv,width:mv,height:fv,space:hv,channels:pv,depth:gv,density:xv,isProgressive:yv,hasProfile:bv,hasAlpha:_v,src:vv},jv="webp",kv=96,Cv=96,Sv="srgb",Nv=4,Mv="uchar",Ev=288,Tv=!1,$v=!1,Pv=!0,Iv="{{.assetPrefix}}/assets/sun-shower-ldwl4jbp.webp",Av={format:jv,width:kv,height:Cv,space:Sv,channels:Nv,depth:Mv,density:Ev,isProgressive:Tv,hasProfile:$v,hasAlpha:Pv,src:Iv},Lv="webp",Rv=96,Dv=96,Fv="srgb",Ov=4,zv="uchar",Wv=288,Hv=!1,Bv=!1,Vv=!0,Uv="{{.assetPrefix}}/assets/sun-sunny-kqjpjzd8.webp",qv={format:Lv,width:Rv,height:Dv,space:Fv,channels:Ov,depth:zv,density:Wv,isProgressive:Hv,hasProfile:Bv,hasAlpha:Vv,src:Uv},Gv="webp",Xv=96,Zv=96,Yv="srgb",Kv=4,Jv="uchar",Qv=288,ew=!1,tw=!1,sw=!0,nw="{{.assetPrefix}}/assets/thunder-xzn1cku3.webp",ow={format:Gv,width:Xv,height:Zv,space:Yv,channels:Kv,depth:Jv,density:Qv,isProgressive:ew,hasProfile:tw,hasAlpha:sw,src:nw},rw="webp",aw=96,iw=96,lw="srgb",cw=4,dw="uchar",uw=288,mw=!1,fw=!1,hw=!0,pw="{{.assetPrefix}}/assets/tornado-diqu61wg.webp",gw={format:rw,width:aw,height:iw,space:lw,channels:cw,depth:dw,density:uw,isProgressive:mw,hasProfile:fw,hasAlpha:hw,src:pw},xw="webp",yw=96,bw=96,_w="srgb",vw=4,ww="uchar",jw=288,kw=!1,Cw=!1,Sw=!0,Nw="{{.assetPrefix}}/assets/windy-n2v8wtyp.webp",Mw={format:xw,width:yw,height:bw,space:_w,channels:vw,depth:ww,density:jw,isProgressive:kw,hasProfile:Cw,hasAlpha:Sw,src:Nw},Ew={foggy:{default:Mh},cloudy:{default:zh},"heavy-snow":{default:Jh},"light-snow":{default:dp},sleet:{default:dx},drizzle:{default:Ax,night:wp},hazy:{default:qx,night:Ap},"mostly-cloudy":{default:o1,night:qp},"mostly-sunny":{default:g1,night:og},shower:{default:M1,night:gg},sunny:{default:z1,night:Mg},"rain-thunder":{default:zg},rain:{default:Jg},snow:{default:wx},thunder:{default:J1},tornado:{default:d0},windy:{default:w0}},Tw={foggy:{default:A0},cloudy:{default:q0},"heavy-snow":{default:oy},"light-snow":{default:gy},sleet:{default:g_},drizzle:{default:z_,night:My},hazy:{default:J_,night:zy},"mostly-cloudy":{default:dv,night:Jy},"mostly-sunny":{default:wv,night:db},shower:{default:Av,night:wb},sunny:{default:qv,night:Ab},"rain-thunder":{default:qb},rain:{default:o_},snow:{default:M_},thunder:{default:ow},tornado:{default:gw},windy:{default:Mw}};function $w({weatherCode:t,isDarkMode:e,isNight:s}){const n=e?Tw:Ew,r=Pw(t),a=n[r];return a.night&&s?a.night:a.default}function Pw(t){switch(t){case 1:case 33:return"sunny";case 2:case 3:case 34:case 35:case 36:return"mostly-sunny";case 4:case 6:case 13:case 14:case 38:return"mostly-cloudy";case 5:case 37:return"hazy";case 7:case 8:return"cloudy";case 11:return"foggy";case 12:case 39:case 40:return"shower";case 15:case 16:case 17:case 41:case 42:return"thunder";case 18:return"rain";case 19:case 20:case 21:case 43:return"light-snow";case 22:case 23:case 44:return"snow";case 24:case 25:case 26:case 29:return"sleet";case 32:return"windy";default:return"cloudy"}}const Iw="C";function Aw(t,e){return Math.round(t==="F"?e*9/5+32:(e-32)*5/9)}function mo(t,e,s=Iw){return t===s?"".concat(Math.round(e),"°"):"".concat(Aw(t,e),"°")}const Lw=Z(()=>X(()=>import("./b1ysmkfbechoun0g.js"),__vite__mapDeps([36,1])),{loading:t=>Q(t)}),Rw=Z(()=>X(()=>import("./dpf52wv18uwxh9t9.js"),__vite__mapDeps([37,1])),{loading:t=>Q(t)}),Dw=Z(()=>X(()=>import("./ohnma74ezw59jlv8.js"),__vite__mapDeps([38,1])),{loading:t=>Q(t)}),Fw=7,fo=8,Ow=p.memo(function({weatherResults:e,dateRange:s,turnIndex:n,trackContentReferenceEvent:r}){const[a,i]=Yw(),l=Hw(e);p.useEffect(()=>{r("Search Content Reference Shown","search_content_reference_shown","forecast")},[r]);const{daily:c,hourly:d,historical:u}=e;let m="daily";if(s||d&&c.length<2)m="hourly";else if(c.length>0)m="daily";else if(u&&(u==null?void 0:u.length)>0)m="historical";else return null;return o.jsxs("div",{className:"relative","data-testid":"weather-widget",children:[l?o.jsxs(o.Fragment,{children:[o.jsx(Ww,{weatherResults:e}),o.jsx(Bw,{weatherResults:e,temperatureUnit:a,setTemperatureUnit:i})]}):o.jsx("div",{className:"bg-token-main-surface-primary absolute end-0 top-3 z-10 rounded-sm",children:o.jsx(Tr,{onTemperatureUnitChange:i,temperatureUnit:a})}),o.jsx(Gw,{turnIndex:n}),m==="hourly"&&o.jsx(Vw,{weatherResults:e,temperatureUnit:a,dateRange:s}),m==="daily"&&o.jsx(Uw,{dailyForecast:c.slice(0,Fw),temperatureUnit:a}),m==="historical"&&o.jsx(qw,{historical:u,temperatureUnit:a})]})});function zw({weatherAlert:t}){const[e,s]=p.useState(!1),n=le(),r=To(),a=ze(t.start_timestamp,t.utc_offset_sec),i=t.end_timestamp?ze(t.end_timestamp,t.utc_offset_sec):null,l=o.jsxs(o.Fragment,{children:[o.jsx("div",{children:o.jsx(H,{id:"JnuGPS",defaultMessage:"{start}{separator}{end}",values:{start:n.formatDate(a,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),separator:i?" - ":"",end:i?n.formatDate(i,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):""}})}),o.jsx("div",{children:t.summary})]});return o.jsxs("button",{className:"my-2 flex w-full flex-col gap-2 rounded-xl border border-red-200 bg-red-100 px-4 py-3 text-start text-sm text-red-800",onClick:()=>s(!e),children:[o.jsxs("div",{className:"flex w-full items-center gap-4",children:[o.jsx(Rw,{className:"h-9 w-9 shrink-0"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"font-bold",children:o.jsx(H,{id:"y+fy/l",defaultMessage:"Severe Weather: {name}",values:{name:t.name}})}),r&&l]}),o.jsx("div",{className:"grow"}),o.jsx("div",{className:"opacity-30",children:e?o.jsx(zl,{className:"icon-lg"}):o.jsx(Ol,{className:"icon-lg"})})]}),e&&t.details&&o.jsxs(o.Fragment,{children:[!r&&l,o.jsx("div",{className:"mt-1 whitespace-pre-wrap",children:t.details.trim()})]})]})}function Ww({weatherResults:t}){const{severe:e}=t;return e?o.jsx("div",{className:"my-2",children:e.map((s,n)=>o.jsx(zw,{weatherAlert:s},n))}):null}function Hw(t){const{historical:e,daily:s,hourly:n,current:r}=t;if(!r)return!1;let a=!1;const i=ze(r.timestamp,r.utc_offset_sec);for(const l of[e,s,n])l&&(a=a||(l==null?void 0:l.some(c=>Ia(i,ze(c.timestamp,c.utc_offset_sec)))));return a}function Bw({weatherResults:t,temperatureUnit:e,setTemperatureUnit:s}){const n=le(),{current:r}=t;if(!r)return null;const a=r.temperature.current,i=r.description,l=a!=null&&i&&" · ";return o.jsxs("div",{className:"not-prose flex items-center gap-4",children:[o.jsxs("div",{className:"grow",children:[o.jsxs("div",{className:"text-lg font-semibold",children:[a!=null&&o.jsx(H,{id:"FiwByI",defaultMessage:"Currently {temperature}",values:{temperature:Ze(n,a,e)}}),l,i.description]}),o.jsx("div",{className:"text-token-text-secondary",children:Zw(t.location)})]}),o.jsxs("div",{className:"flex",children:[o.jsx(Tr,{onTemperatureUnitChange:s,temperatureUnit:e}),o.jsx(Js,{weatherDescriptionData:i,isNight:r.night})]})]})}function Ks({children:t}){return o.jsx("div",{className:"no-scrollbar not-prose mt-1 overflow-auto sm:overflow-hidden",children:o.jsx(Ee.Root,{className:"min-w-0",children:o.jsx(Ee.Body,{className:"border-token-border-medium border-b-[0.5px] [&_tr:last-child]:border-b-0",children:t})})})}function Vw({weatherResults:t,temperatureUnit:e,dateRange:s}){const n=le(),{hourly:r,current:a}=t;let i=r!=null?r:[];s&&(i=i.filter(u=>u.timestamp>=s.start_timestamp&&u.timestamp<s.end_timestamp));const[l,c]=p.useState(!1),d=i.length>fo;if(!l&&d){const u=i[0],m=ze(u.timestamp,u.utc_offset_sec);let h=!1;if(a){const x=ze(a.timestamp,a.utc_offset_sec);m.getTime()-x.getTime()>480*60*1e3&&i.length>18&&(i=i.slice(7,18),h=!0)}h||(i=i.slice(0,fo))}return o.jsxs(Ks,{children:[i.map((u,m)=>o.jsxs(Ee.Row,{children:[o.jsxs(Ie,{className:"w-44",children:[o.jsx(Js,{weatherDescriptionData:u.description,isNight:u.night,size:"small"}),o.jsx("div",{className:"ms-3 whitespace-nowrap",children:o.jsx("span",{className:"lowercase",children:Xw(n,u)})})]}),o.jsx(Ie,{className:"w-[60px] tabular-nums",children:o.jsx("div",{children:Ze(n,u.temperature.current,e)})}),o.jsx(Ie,{children:u.description.description})]},m)),d&&o.jsx(Ee.Row,{children:o.jsx(Ie,{className:"w-44",children:o.jsx(Pe,{color:"secondary",onClick:()=>c(!l),size:"small",children:l?o.jsx(H,{id:"KoC8Ym",defaultMessage:"Show less"}):o.jsx(H,{id:"X8F8Y/",defaultMessage:"Show more"})})})})]})}function Uw({dailyForecast:t,temperatureUnit:e}){const s=le();return o.jsx(Ks,{children:t.map((n,r)=>o.jsxs(Ee.Row,{children:[o.jsxs(Ie,{className:"w-[7.5rem] min-w-[7.5rem]",children:[o.jsx(Js,{weatherDescriptionData:n.description,isNight:n.night,size:"small"}),o.jsx("div",{className:"ms-3 whitespace-nowrap",children:Ss(s,ze(n.timestamp,n.utc_offset_sec))})]}),o.jsxs(Ie,{className:"tabular-nums",children:[o.jsx("div",{children:Ze(s,n.temperature.max,e)}),o.jsx("div",{className:"text-token-text-secondary ms-1",children:Ze(s,n.temperature.min,e)})]}),o.jsx(Ie,{className:"min-w-80",children:n.description.description})]},r))})}function qw({historical:t,temperatureUnit:e}){const s=le();return t?o.jsx(Ks,{children:t.map((n,r)=>{const a=ze(n.timestamp,n.utc_offset_sec);return o.jsxs(Ee.Row,{children:[o.jsx(Ie,{className:"w-[250px]",children:o.jsx("div",{className:"ms-3 whitespace-nowrap",children:s.formatDate(a,{weekday:"long",month:"short",day:"numeric"})})}),o.jsx(Ie,{className:"tabular-nums",children:n.temperature.max&&n.temperature.min?o.jsxs(o.Fragment,{children:[o.jsx("div",{children:Ze(s,n.temperature.max,e)}),o.jsx("div",{className:"text-token-text-secondary ms-1",children:Ze(s,n.temperature.min,e)})]}):o.jsx("div",{children:Ze(s,n.temperature.current,e)})}),o.jsx(Ie,{})]},r)})}):null}function Ie({className:t,children:e}){return o.jsx(Ee.Cell,{className:A("border-token-border-xlight! border-s-0! border-e-0! py-2! ps-4! pe-3! first:ps-0! last:pe-0!",t),divClassName:"items-start leading-relaxed",children:e})}function Gw({turnIndex:t}){const e=Ki(n=>{var r,a;return(a=(r=n.thread)==null?void 0:r.turns[t])==null?void 0:a.use_location}),[s]=Ji();return!s.useLocation&&e?o.jsx("div",{className:"mt-3",children:o.jsx(Pe,{color:"secondary",icon:Lw,onClick:()=>{qi.setSettingsModalOpen(!0)},children:o.jsx(H,{id:"f47VEc",defaultMessage:"Share precise location"})})}):null}function Tr({temperatureUnit:t,onTemperatureUnitChange:e}){const s=n=>t===n?"font-bold":"font-light";return o.jsx(Aa,{size:"small",triggerButton:o.jsx("button",{className:"text-token-text-tertiary hover:text-token-text-primary flex items-center justify-center p-1.5",children:o.jsx(Dw,{className:"icon-sm"})}),children:o.jsxs(La.Item,{onClick:()=>{e(t==="C"?"F":"C")},className:"text-token-text-primary",children:[o.jsx(H,{id:"bQIoe/",defaultMessage:"Temperature"}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:s("F"),children:o.jsx(H,{id:"bvDeBB",defaultMessage:"°F"})}),o.jsx("div",{className:"mx-1 h-4 border-s border-gray-300"}),o.jsx("div",{className:s("C"),children:o.jsx(H,{id:"iNiz6O",defaultMessage:"°C"})})]})]})})}function Js({weatherDescriptionData:t,isNight:e=!1,size:s="normal"}){const n=Zt(),r=s==="small"?30:50;return o.jsx("img",{draggable:!1,alt:t.description,src:$w({weatherCode:t.id,isDarkMode:n,isNight:e}).src,width:r,height:r})}function Xw(t,e){const s=ze(e.timestamp,e.utc_offset_sec);return t.formatDate(s,{hour:"numeric"})}function Ze(t,e,s){return e==null?"-":mo(s?s!=null?s:"F":$r(t),e)}function $r(t){const e=["en-US","en-BZ","en-BS","en-KY","en-PW"],s=t.locale||"en-US";return e.includes(s)?"F":"C"}function Zw(t){const e=t.name.split(",").map(s=>s.trim());return t.country&&!e.includes(t.country)&&e.push(t.country),e.join(", ")}const Yw=()=>{const t=le(),[e,s]=Pa("USER_TEMPERATURE_UNIT",$r(t),n=>["F","C"].includes(n));return[e,s]};function Kw({contentReference:t,clientThreadId:e,messageId:s,trackContentReferenceEvent:n,contentReferenceIndex:r}){var _;const a=xe(),i=Se(a,"1950533395"),l=Vs(),c=l?"sidebar":"primary",d="metadata"in t&&((_=t.metadata)!=null&&_.location)?String(t.metadata.location):void 0,u=p.useMemo(()=>({content_reference_start_index:t.start_idx,entity_name:t.name,category:t.category,conversation_type:c,contentReferenceIndex:r,metadata_location:d}),[t.start_idx,t.name,t.category,c,r,d]);p.useEffect(()=>{n("Entity Anchor Content Reference Shown","entity_anchor_content_reference_shown","entity",u)},[n,u]);const{openThreadSidebar:m}=_t(),{resetSidebarHistory:h}=Ho(),x=p.useCallback(v=>{var w,j;v.preventDefault(),n("Entity Anchor Content Reference Clicked","entity_anchor_content_reference_clicked","entity",u),e&&(l||h(),m({type:"entity",debugThreadId:void 0,messageId:s,contentReferenceStartIndex:t.start_idx,query:t.name,category:(w=t.category)!=null?w:void 0,extraParams:(j=t.extra_params)!=null?j:void 0}))},[n,u,e,l,m,s,t.start_idx,t.name,t.category,t.extra_params,h]);return t.category==="product_link"?i?o.jsx(Pe,{size:"medium",color:"secondary",className:"my-2",onClick:x,children:o.jsx(H,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):o.jsx("span",{className:"text-token-text-primary font-semibold",children:o.jsx(H,{id:"entityAnchor.buyingOptions",defaultMessage:"Buying Options"})}):!i||t.status==="loading"?o.jsx("span",{className:"text-token-text-primary font-semibold",children:t.name}):o.jsx("span",{className:"hover:entity-accent entity-underline inline cursor-pointer align-baseline",onClick:x,children:o.jsx("span",{className:"whitespace-normal",children:t.name})})}const Jw=Z(()=>X(()=>import("./oiijv6l0h3xmsh54.js"),__vite__mapDeps([39,1,5,6,40,4,7,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,12,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118])).then(t=>t.BusinessesMap)),Qw=t=>!!t.dil,e2=t=>(t==null?void 0:t.type)==="element",t2=t=>t==="inline"||t==="block"||t==="container",s2=t=>{var s;if(!e2(t))return;const e=(s=t.properties)==null?void 0:s.displayLayout;return t2(e)?e:void 0};function n2(t){"use forget";var B,K,te,I;const e=he.c(176),{index:s,FormattedText:n,node:r,wordFadeType:a}=t;let i;e[0]!==r?(i=s2(r),e[0]=r,e[1]=i):i=e[1];const l=i,c=parseInt(s,10),d=p.useContext(Ke),u=xe(),h=Ra({id:(te=(K=(B=d==null?void 0:d.message)==null?void 0:B.metadata)==null?void 0:K.model_slug)!=null?te:""},u)||Se(u,"2137702454");let x;e[2]!==u?(x=We(u),e[2]=u,e[3]=x):x=e[3];const _=x;let v;e[4]!==d||e[5]!==_?(v=g=>{if(!_||(d==null?void 0:d.analyticsMetadata.turnIndex)===void 0)return[void 0,void 0];const O=Ye.getConversationTurns(g),R=d.analyticsMetadata.turnIndex,W=O.findIndex(a2)===R,V=R>0?Ye.getConversationTurnAtIndex(g,R-1):null,Y=Da(V==null?void 0:V.messages.filter(Fa));return[W,Y]},e[4]=d,e[5]=_,e[6]=v):v=e[6];const[w,j]=Vt(d==null?void 0:d.clientThreadId,v),C=w===!0&&c===0,f=Bo(d==null?void 0:d.analyticsMetadata),y=p.useRef(!1);if(d==null)return null;const{contentReferences:k,onShowSearchResults:S,numImageResults:N,analyticsMetadata:M,message:$,superWidgetContent:P}=d,b=k==null?void 0:k[c];if(!b||M.turnIndex===void 0||b.type===void 0)return null;let F;e[7]===Symbol.for("react.memo_cache_sentinel")?(F={img:r2},e[7]=F):F=e[7];let L;e[8]!==b.alt?(L=o.jsx(Us,{components:F,children:b.alt}),e[8]=b.alt,e[9]=L):L=e[9];const T=L;let E=null;e:switch(b.type){case"title_citation":{let g;e[10]!==b||e[11]!==f?(g=o.jsx(ch,{metadata:b,trackContentReferenceEvent:f}),e[10]=b,e[11]=f,e[12]=g):g=e[12],E=g;break e}case"link_title":{let g;e[13]!==b||e[14]!==f?(g=o.jsx(zf,{metadata:b,trackContentReferenceEvent:f}),e[13]=b,e[14]=f,e[15]=g):g=e[15],E=g;break e}case"location_search":{let g;e[16]!==b||e[17]!==f?(g=o.jsx(Hf,{metadata:b,trackContentReferenceEvent:f}),e[16]=b,e[17]=f,e[18]=g):g=e[18],E=g;break e}case"time":{let g;e[19]!==b||e[20]!==f?(g=o.jsx(lh,{metadata:b,trackContentReferenceEvent:f}),e[19]=b,e[20]=f,e[21]=g):g=e[21],E=g;break e}case"image_v2":{const g=N!=null?N:0;let O;e[22]!==M||e[23]!==b||e[24]!==f||e[25]!==C||e[26]!==P||e[27]!==g?(O=o.jsx(qs,{metadata:b,numImageResults:g,analyticsMetadata:M,trackContentReferenceEvent:f,superWidgetContent:P,isFirstAssistantContent:C}),e[22]=M,e[23]=b,e[24]=f,e[25]=C,e[26]=P,e[27]=g,e[28]=O):O=e[28],E=O;break e}case"nav_list":{const g=j!=null?j:null,O=P!=null?P:null;let R;e[29]!==b||e[30]!==f||e[31]!==C||e[32]!==g||e[33]!==O?(R=o.jsx(Xf,{metadata:b,trackContentReferenceEvent:f,isFirstAssistantContent:C,lastUserMsgOfPrevTurn:g,superWidgetContent:O}),e[29]=b,e[30]=f,e[31]=C,e[32]=g,e[33]=O,e[34]=R):R=e[34],E=R;break e}case"file_navlist":{let g;e[35]!==b||e[36]!==f?(g=o.jsx(wf,{metadata:b,trackContentReferenceEvent:f}),e[35]=b,e[36]=f,e[37]=g):g=e[37],E=g;break e}case"file":{if(h){let g;e[38]!==b||e[39]!==k||e[40]!==f||e[41]!==c?(g=o.jsx(jl,{contentReferences:k,fileRef:b,index:c,trackContentReferenceEvent:f}),e[38]=b,e[39]=k,e[40]=f,e[41]=c,e[42]=g):g=e[42],E=g}else{let g;e[43]!==b||e[44]!==f||e[45]!==c?(g=o.jsx(kl,{fileRef:b,index:c,trackContentReferenceEvent:f}),e[43]=b,e[44]=f,e[45]=c,e[46]=g):g=e[46],E=g}break e}case"grouped_webpages_model_predicted_fallback":{let g;e[47]!==b||e[48]!==d.message||e[49]!==f||e[50]!==c||e[51]!==r?(g=o.jsx(wl,{webpageRef:b,node:r,trackContentReferenceEvent:f,message:d.message,index:c}),e[47]=b,e[48]=d.message,e[49]=f,e[50]=c,e[51]=r,e[52]=g):g=e[52],E=g;break e}case"grouped_webpages":{let g;e[53]!==b||e[54]!==d.message||e[55]!==f||e[56]!==c||e[57]!==r?(g=o.jsx(vl,{webpageRef:b,node:r,trackContentReferenceEvent:f,message:d.message,index:c}),e[53]=b,e[54]=d.message,e[55]=f,e[56]=c,e[57]=r,e[58]=g):g=e[58],E=g;break e}case"tldr":break e;case"navigation":{let g;e[59]!==b||e[60]!==f||e[61]!==S?(g=o.jsx(Mi,{navigation:b,onShowSearchResults:S,trackContentReferenceEvent:f}),e[59]=b,e[60]=f,e[61]=S,e[62]=g):g=e[62],E=g;break e}case"stock":{let g;e[63]!==b||e[64]!==f?(g=o.jsx(Df,{contentReference:b,trackContentReferenceEvent:f}),e[63]=b,e[64]=f,e[65]=g):g=e[65],E=g;break e}case"calculator":{let g;e[66]!==b||e[67]!==f?(g=o.jsx(af,{data:b,trackContentReferenceEvent:f}),e[66]=b,e[67]=f,e[68]=g):g=e[68],E=g;break e}case"python":case"container":{let g;e[69]!==M.turnIndex||e[70]!==b||e[71]!==d.clientThreadId?(g=o.jsx(ff,{clientThreadId:d.clientThreadId,turnIndex:M.turnIndex,contentReference:b}),e[69]=M.turnIndex,e[70]=b,e[71]=d.clientThreadId,e[72]=g):g=e[72],E=g;break e}case"code_execution":{let g;e[73]!==n||e[74]!==b||e[75]!==f?(g=o.jsx(uf,{FormattedText:n,displayInfo:b,trackContentReferenceEvent:f}),e[73]=n,e[74]=b,e[75]=f,e[76]=g):g=e[76],E=g;break e}case"forecast":{let g;e[77]!==M||e[78]!==b.date_range||e[79]!==b.forecast||e[80]!==f?(g=(b==null?void 0:b.forecast)&&o.jsx(Ow,{weatherResults:b.forecast,dateRange:b.date_range,turnIndex:M.turnIndex,trackContentReferenceEvent:f}),e[77]=M,e[78]=b.date_range,e[79]=b.forecast,e[80]=f,e[81]=g):g=e[81],E=g;break e}case"businesses_map":{let g;e[82]!==b||e[83]!==f?(g=o.jsx(Jw,{contentReference:b,trackContentReferenceEvent:f}),e[82]=b,e[83]=f,e[84]=g):g=e[84],E=g;break e}case"map":{let g;e[85]!==b||e[86]!==d.clientThreadId||e[87]!==d.message.id||e[88]!==f?(g=o.jsx(Tm,{contentReference:b,trackContentReferenceEvent:f,clientThreadId:d.clientThreadId,messageId:d.message.id}),e[85]=b,e[86]=d.clientThreadId,e[87]=d.message.id,e[88]=f,e[89]=g):g=e[89],E=g;break e}case"video":{let g;e[90]!==b||e[91]!==f?(g=o.jsx(gh,{video:b,trackContentReferenceEvent:f}),e[90]=b,e[91]=f,e[92]=g):g=e[92],E=g;break e}case"sports_standings":{let g;e[93]!==b||e[94]!==f?(g=o.jsx(ah,{standingsRef:b,trackContentReferenceEvent:f}),e[93]=b,e[94]=f,e[95]=g):g=e[95],E=g;break e}case"sports_schedule":{let g;e[96]!==b||e[97]!==f?(g=o.jsx(sh,{scheduleRef:b,trackContentReferenceEvent:f}),e[96]=b,e[97]=f,e[98]=g):g=e[98],E=g;break e}case"attribution":{let g;e[99]!==b||e[100]!==a?(g=o.jsx(tf,{attribution:b,wordFadeType:a}),e[99]=b,e[100]=a,e[101]=g):g=e[101],E=g;break e}case"debug":{let g;e[102]!==b?(g=o.jsx(o.Fragment,{children:Object.entries(b).map(o2)}),e[102]=b,e[103]=g):g=e[103],E=g;break e}case"image_inline":{let g;e[104]!==b||e[105]!==d.clientThreadId||e[106]!==f||e[107]!==$?(g=(I=$.metadata)!=null&&I.b1de6e2_rm?o.jsx(tu,{reference:b,clientThreadId:d.clientThreadId,trackContentReferenceEvent:f,message:$}):o.jsx(nu,{reference:b,clientThreadId:d.clientThreadId,trackContentReferenceEvent:f,message:$}),e[104]=b,e[105]=d.clientThreadId,e[106]=f,e[107]=$,e[108]=g):g=e[108],E=g;break e}case"image_group":{const g=j!=null?j:null,O=P!=null?P:null;let R;e[109]!==M||e[110]!==b||e[111]!==f||e[112]!==w||e[113]!==g||e[114]!==O?(R=o.jsx(Sd,{contentReference:b,trackContentReferenceEvent:f,analyticsMetadata:M,isFirstAssistantTurn:w,lastUserMsgOfPrevTurn:g,superWidgetContent:O}),e[109]=M,e[110]=b,e[111]=f,e[112]=w,e[113]=g,e[114]=O,e[115]=R):R=e[115],E=R;break e}case"product_entity":{let g;e[116]!==M.turnIndex||e[117]!==b||e[118]!==d.clientThreadId||e[119]!==d.message.id||e[120]!==f?(g=o.jsx(Bm,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:M.turnIndex,trackContentReferenceEvent:f}),e[116]=M.turnIndex,e[117]=b,e[118]=d.clientThreadId,e[119]=d.message.id,e[120]=f,e[121]=g):g=e[121],E=g;break e}case"entity_metadata":{let g;e[122]!==b||e[123]!==d.clientThreadId||e[124]!==d.message.id||e[125]!==f?(g=o.jsx(_f,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,trackContentReferenceEvent:f}),e[122]=b,e[123]=d.clientThreadId,e[124]=d.message.id,e[125]=f,e[126]=g):g=e[126],E=g;break e}case"checkout_confirmation":{let g;e[127]!==b||e[128]!==f?(g=o.jsx(td,{metadata:b,trackContentReferenceEvent:f}),e[127]=b,e[128]=f,e[129]=g):g=e[129],E=g;break e}case"entity":{let g;e[130]!==M.turnIndex||e[131]!==b||e[132]!==d.clientThreadId||e[133]!==d.message.id||e[134]!==f||e[135]!==c?(g=o.jsx(Kw,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:M.turnIndex,trackContentReferenceEvent:f,contentReferenceIndex:c}),e[130]=M.turnIndex,e[131]=b,e[132]=d.clientThreadId,e[133]=d.message.id,e[134]=f,e[135]=c,e[136]=g):g=e[136],E=g;break e}case"product":{let g;e[137]!==M||e[138]!==b||e[139]!==d.clientThreadId||e[140]!==d.message||e[141]!==l||e[142]!==f||e[143]!==c?(g=null,e[137]=M,e[138]=b,e[139]=d.clientThreadId,e[140]=d.message,e[141]=l,e[142]=f,e[143]=c,e[144]=g):g=e[144],E=g;break e}case"products":{let g;e[145]!==M||e[146]!==b||e[147]!==d.clientThreadId||e[148]!==d.message.id?(g=o.jsx(Ym,{contentReference:b,clientThreadId:d.clientThreadId,messageId:d.message.id,turnIndex:M.turnIndex,analyticsMetadata:M}),e[145]=M,e[146]=b,e[147]=d.clientThreadId,e[148]=d.message.id,e[149]=g):g=e[149],E=g;break e}case"product_reviews":{let g;e[150]!==b||e[151]!==f?(g=o.jsx(Ja,{contentReference:b,disableAnimation:!0,trackContentReferenceEvent:f}),e[150]=b,e[151]=f,e[152]=g):g=e[152],E=g;break e}case"product_rationale":{let g;e[153]!==b||e[154]!==f?(g=o.jsx(Ka,{contentReference:b,trackContentReferenceEvent:f,disableAnimation:!0}),e[153]=b,e[154]=f,e[155]=g):g=e[155],E=g;break e}case"dil":{let g;e[156]!==b.dil||e[157]!==b.dil_url||e[158]!==b.name||e[159]!==f?(g=o.jsx(gf,{dil:b.dil,dilUrl:b.dil_url,trackContentReferenceEvent:f,widgetName:b.name}),e[156]=b.dil,e[157]=b.dil_url,e[158]=b.name,e[159]=f,e[160]=g):g=e[160],E=g;break e}case"strix":break e;case"sources_footnote":return null}Qw(b)&&"dil_url"in b;let z;e[169]!==T||e[170]!==b||e[171]!==f?(z=g=>(y.current||(f("Search Content Reference Failed","search_content_reference_failed",b.type),qt.addError("Error rendering content reference: ".concat(b.type),U(D({},g),{contentReference:b})),y.current=!0),b!=null&&b.alt?T:o.jsx("span",{className:"errored-object-".concat(b.type)})),e[169]=T,e[170]=b,e[171]=f,e[172]=z):z=e[172];let G;return e[173]!==E||e[174]!==z?(G=o.jsx(Io,{name:"content-reference-renderer",fallback:z,children:E}),e[173]=E,e[174]=z,e[175]=G):G=e[175],G}function o2(t){const[e,s]=t;return o.jsx("sub",{className:"ms-1 w-fit rounded-md border-2 border-solid border-orange-500 px-1 leading-none",children:s},e)}function r2(t){const{src:e,alt:s}=t;return o.jsx("img",{src:e,alt:s,className:"max-h-28"})}function a2(t){return t.role===Oa.Assistant}var xo;const i2=new RegExp(String.raw(xo||(xo=jt(["]((?!<)(","[^)\r\n]+?))"],["\\]\\((?!<)(","[^)\\r\\n]+?)\\)"])),ws),"g"),l2=/\s/;function ho(t){return t.replace(i2,(e,s)=>l2.test(s)?"](".concat("<".concat(s,">"),")"):e)}const Et=(t,e,s)=>{Wa(s,t,void 0,e),Ha.count(Ba.WRITING_BLOCKS,t)};function c2(t){const l=t,{src:e,conversation:s}=l,n=Te(l,["src","conversation"]),r=Ve(()=>s==null?void 0:s.serverId$()),a=p.useContext(Ke),i=Li(r,e,a==null?void 0:a.useSafeUrls);return i==null?o.jsx("div",{}):o.jsx("img",U(D({},n),{src:i}))}function d2(t){return o.jsx(n2,U(D({},t),{FormattedText:Pr}))}function Pr({size:t="medium",children:e,className:s,conversation:n,messageId:r,isActivelyStreaming:a=!1,componentOverrides:i,isDeepResearchResultMessage:l,forceDarkMode:c,disableWordFade:d}){const u=Zt()||c,{wordFadeType:m}=Ei(),h=Ti(),x=p.useRef(!1),_=p.useRef(!1);x.current=!1;const v=xe(),w=Co(So.DisableWritingBlockRendering),j=p.useMemo(()=>{var O;if(!i)return;const R=i,{[O=rs]:I}=R;return Te(R,[on(O)])},[i]),C=p.useMemo(()=>i==null?void 0:i[rs],[i]),f=p.useMemo(()=>D(D(U(D({pre:({children:I,"data-start":g,"data-end":O,"data-is-last-node":R})=>o.jsx("pre",{className:"overflow-visible!","data-start":g,"data-end":O,"data-is-last-node":R,children:I}),code:I=>o.jsx(Pi,D({},I)),[za]:I=>o.jsx(d2,D({wordFadeType:m},I)),[$i]:I=>n==null?null:o.jsx($c,U(D({},I),{conversation:n,messageId:r})),[Ui]:Vi,[sl]:Lc,[tl]:Zc,[el]:qc,[Qi]:Oc,a:I=>{var Y,J,de,oe;const V=I,{node:g,children:O}=V,R=Te(V,["node","children"]),W=(Y=g==null?void 0:g.properties)==null?void 0:Y.href;if(typeof W=="string"&&W.startsWith(ws))return n!=null&&r!=null?o.jsx(Br,U(D({},R),{conversation:n,messageId:r,href:W,children:O})):null;if(typeof W=="string"&&W===Vr){if(n==null||r==null)return O;const ie=(J=g==null?void 0:g.children)==null?void 0:J.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(Ur,U(D({},I),{text:ie,conversation:n,messageId:r,className:"cursor-pointer"}))}if(typeof W=="string"&&W===qr){if(n==null||r==null)return O;const ie=(de=g==null?void 0:g.children)==null?void 0:de.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(Gr,U(D({},I),{text:ie,conversation:n,messageId:r}))}if(typeof W=="string"&&W===Xr){if(n==null||r==null)return O;const ie=(oe=g==null?void 0:g.children)==null?void 0:oe.map(ee=>typeof ee.value=="string"?ee.value:"").join("").trim();return o.jsx(Zr,U(D({},I),{text:ie,conversation:n,messageId:r}))}return W&&typeof W=="string"&&Pc(W)?O:o.jsx(Vl,U(D({},I),{messageId:r}))},table:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);return o.jsx(Fl,U(D({},g),{onClickCopy:W=>{var Y;Tt.logEvent("ChatGPT Table Copy Clicked");const V=n!=null&&r!=null?Ye.getNode(ln(n.id),r).message:void 0;Ro(Hr(I.markdownSource,(Y=V==null?void 0:V.metadata)==null?void 0:Y.content_references),void 0,W)}}))},td:Dl},h?{h1:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);return o.jsx("h1",D({"data-section-id":Ct(I.markdownSource)},g))},h2:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);return o.jsx("h2",D({"data-section-id":Ct(I.markdownSource)},g))},h3:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);return o.jsx("h3",D({"data-section-id":Ct(I.markdownSource)},g))},li:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);return o.jsx("li",D({"data-section-id":Ct(I.markdownSource)},g))}}:{}),{img:O=>{var R=O,{node:I}=R,g=Te(R,["node"]);var V;const W=(V=I==null?void 0:I.properties)==null?void 0:V.src;return typeof W=="string"&&(W.startsWith(ws)||W.startsWith("attachment:"))?null:o.jsx(c2,U(D({},g),{conversation:n}))}}),m==="delay"?Ul:[]),j!=null?j:{}),[h,m,j,n,r]),y=p.useCallback((I,g)=>{var O,R,W,V;if(I==null||n==null||r==null)return g;try{const Y=ln(n.id),J=Ye.getNode(Y,r),de=(V=(W=(R=(O=J==null?void 0:J.message)==null?void 0:O.metadata)==null?void 0:R.writing_blocks)==null?void 0:W[I])==null?void 0:V.content;return de!=null?de:g}catch(Y){return g}},[n,r]),k=p.useCallback((I,g)=>I?o.jsx($s,{components:f,remarkPlugins:_s,rehypePlugins:vs,urlTransform:bs,children:ho(I)}):o.jsx(o.Fragment,{children:g}),[f]),S=p.useCallback(I=>{var O,R;if(x.current=!0,w){const W=(O=I.id)!=null?O:I.index!=null?String(I.index):void 0,V=y(W,I.content);return k(V,I.children)}if(typeof C=="function")return C(I);const g=fl(I.variant);return o.jsx(Qc,{conversation:n,messageId:r,title:I.title,originalContent:I.content,variant:g,recipient:I.recipient,isStreaming:a,index:I.index,id:(R=I.id)!=null?R:String(I.index),children:I.children})},[w,y,k,C,r,a,n]),N=p.useMemo(()=>U(D({},f),{[rs]:S}),[f,S]),M=Se(v,"1839283687"),[$,P]=p.useState(!1),b=p.useMemo(()=>{const I=e!=null?e:"",g=a&&e?ql(e):I;return ho(g)},[e,a]),F=p.useMemo(()=>Ii(b),[b]),L=p.useMemo(()=>$?Ai(b):b,[b,$]),T=Vo(),E=p.useMemo(()=>[...vs,[Yr,L]],[L]),z=p.useRef(!1);a&&(z.current=!0);const G=p.useMemo(()=>m==="indexed"&&!d?{handlers:{text:(I,g,O)=>{const R=[];for(const W of T(g.value))R.push({type:"element",tagName:"span",properties:{className:Uo.fadeIn},children:[{type:"text",value:W}]});return R}}}:void 0,[m,T,d]),B=p.useMemo(()=>a||!F?!1:b.includes(":::writing"),[a,F,b]),K=p.useMemo(()=>{var I;return{contains_writing_directive:F?"true":"false",uses_old_syntax:B?"true":"false",client_thread_id:(I=n==null?void 0:n.id)!=null?I:"",message_id:r!=null?r:""}},[F,B,r,n]),te=p.useRef(!1);return p.useEffect(()=>{!B||te.current||(Et("chatgpt_writing_block_uses_old_syntax",K,v),z.current&&Et("chatgpt_new_writing_block_uses_old_syntax",K,v),te.current=!0)},[K,B,v]),p.useEffect(()=>{F&&(a||x.current||_.current||(Et("chatgpt_writing_block_render_failed",K,v),z.current&&Et("chatgpt_writing_block_first_render_failed",K,v),_.current=!0,P(!0)))},[v,n,a,r,F,P,B,K]),M?!1:o.jsx(Io,{name:"formatted_text_error",fallback:()=>o.jsx(o.Fragment,{children:L}),children:o.jsx($s,{rehypePlugins:E,remarkPlugins:_s,remarkRehypeOptions:G,className:A(s,"markdown prose dark:prose-invert w-full break-words",u?"dark":"light",t==="small"&&"prose-xs",l&&"deep-research-result","markdown-new-styling"),urlTransform:bs,components:N,children:L})})}const $s=p.memo(Us),B2=Object.freeze(Object.defineProperty({__proto__:null,FormattedText:Pr,ReactMarkdownMemo:$s},Symbol.toStringTag,{value:"Module"}));export{B2 as F,cm as M,Dt as W,jm as a,dm as b,Au as c,$u as f,fr as p,He as r,Pu as t};
//# sourceMappingURL=l92l17q6p2b89xpa.js.map

var Z=Object.defineProperty;var b=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var V=(n,e,i)=>e in n?Z(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,K=(n,e)=>{for(var i in e||(e={}))G.call(e,i)&&V(n,i,e[i]);if(b)for(var i of b(e))H.call(e,i)&&V(n,i,e[i]);return n};var Q=(n,e)=>{var i={};for(var r in n)G.call(n,r)&&e.indexOf(r)<0&&(i[r]=n[r]);if(n!=null&&b)for(var r of b(n))e.indexOf(r)<0&&H.call(n,r)&&(i[r]=n[r]);return i};import{c as $,j as _,o as ee,y as te,a1 as ie,d as re,u as ne,r as q,ad as J}from"./kfrdmkli83ureki3.js";import{cr as oe,D as se,nC as ae,u as X,J as Y,i0 as ce,g as le,n as de,M as U,aa as me,T as z}from"./kw08ajijqinojrwh.js";import{h7 as ue,r as pe,a as ge,cL as fe,g as he}from"./fyw02vlaiv2vq6cj.js";import{R as ve}from"./e2qiox9wm3uaxg29.js";import{p as Ee,u as Ie,a as Ce,W as Be,E as ke,b as xe,c as Se}from"./ccwkzjxugf5q7bsx.js";import{u as Pe}from"./ipjj058rvhjq2uu2.js";import{r as We}from"./kbj1b07s2z6vxqkg.js";import"./bdqubk4ywd0en7sc.js";import"./ci7lhbgv3s1kfbx6.js";import"./i7t1qh3u8s8bvtb8.js";import"./gy1lpvuoewmzh42c.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";import"./mgt4kmm4im6a7le7.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./mer2el06ski1l09m.js";import"./m3joncw451cqbul2.js";import"./lep2wptoy14cfe2w.js";import"./bp7aioeryj7wbfac.js";import"./c80q12olrn2ogvv0.js";import"./glg11vispnpcyq1s.js";import"./hzx9fvhly6v2qmjm.js";import"./jnr2ibp3zs9z7xhs.js";import"./hytzro4etxb8j4b5.js";import"./e7j9ia0bu5w3396k.js";import"./fx4g5niv8hgtkxju.js";import"./jhvofh4m5uva5wy3.js";import"./nvbtsxz152qyrww5.js";import"./ce3hgmw4iyyhicud.js";import"./me479l0dlgxhtxr0.js";import"./edhlcmww46h398kf.js";import"./de3ceoxcpky3ng0s.js";import"./cjv4tm2buxt5byw3.js";import"./gf4c0f98pdaqc94a.js";import"./idxukd613qgy7urm.js";import"./ft1wtuo4ibr3do9l.js";import"./fxythiulbb2q3qno.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./h1em0bjkpkjv8ykw.js";function Te(n,e){var s;if(!n||!e)return null;const i=Pe().use(We).use(ve),r=i.parse(n);i.runSync(r);const t=r.children.filter(ue).find(c=>{var u,a;const d=(a=(u=c.data)==null?void 0:u.hProperties)==null?void 0:a.id;return c.name===oe&&d===e});return!t||!((s=t.data)!=null&&s.hProperties)?(se.addError(new Error("Writing block node not found"),{writingBlockId:e}),null):{id:String(t.data.hProperties.id),index:Number(t.data.hProperties.index),variant:Ee(String(t.data.hProperties.variant)),title:t.data.hProperties.title?String(t.data.hProperties.title):void 0,recipient:t.data.hProperties.recipient?String(t.data.hProperties.recipient):void 0,content:String(t.data.hProperties.content)}}function _e(n){"use forget";var c;const e=$.c(8);let i,r;e[0]!==n?(c=n,{conversation:i}=c,r=Q(c,["conversation"]),e[0]=n,e[1]=i,e[2]=r):(i=e[1],r=e[2]);let t;e[3]!==r?(t=_.jsx(we,K({},r)),e[3]=r,e[4]=t):t=e[4];let s;return e[5]!==i||e[6]!==t?(s=_.jsx(ae.Provider,{value:i,children:t}),e[5]=i,e[6]=t,e[7]=s):s=e[7],s}function we(n){"use forget";const e=$.c(45),{clientThreadId:i,serverThreadId:r,messageId:t,writingBlockId:s,originalContent:c,title:d,recipient:u,index:a,variant:l}=n,C=X();let E;e[0]!==C?(E=Y(C,"669593727"),e[0]=C,e[1]=E):E=e[1];const B=E;let I;e[2]!==a||e[3]!==t||e[4]!==c||e[5]!==u||e[6]!==d||e[7]!==l||e[8]!==s?(I={messageId:t,id:s,originalContent:c,index:a,variant:l,title:d,recipient:u},e[2]=a,e[3]=t,e[4]=c,e[5]=u,e[6]=d,e[7]=l,e[8]=s,e[9]=I):I=e[9];const{writingBlock:p,contentReferences:k,autosaveStatus:x,flushPendingChanges:g,handleOnChange:m,messageRef:f,editorViewRef:S,analyticsMetadata:o,hasBeenEdited:P,isWritingBlockEditingAllowed:h,setDirty:v}=Ie(I),W=d!=null?d:"",T=u!=null?u:"";let w;e[10]!==i||e[11]!==g||e[12]!==m||e[13]!==h||e[14]!==t||e[15]!==v||e[16]!==W||e[17]!==T||e[18]!==p?(w={writingBlock:p,clientThreadId:i,messageId:t,onChange:m,setDirty:v,flushPendingChanges:g,isStreaming:!1,streamingTitle:W,streamingRecipient:T,isInlineWritingBlockEditEnabled:h},e[10]=i,e[11]=g,e[12]=m,e[13]=h,e[14]=t,e[15]=v,e[16]=W,e[17]=T,e[18]=p,e[19]=w):w=e[19];const A=Ce(w),R=l===Be.EMAIL,[y]=ee();let L;e[20]!==y?(L=ce(y.get("header"),!0),e[20]=y,e[21]=L):L=e[21];const D=L,M=R?ke:void 0,j=R?A.headerLabel:void 0,F=R?A.emailSendButton:void 0,O=R?A.fullScreenEmailHeader:void 0;let N;return e[22]!==o||e[23]!==x||e[24]!==i||e[25]!==k||e[26]!==S||e[27]!==M||e[28]!==g||e[29]!==m||e[30]!==P||e[31]!==a||e[32]!==B||e[33]!==h||e[34]!==t||e[35]!==f||e[36]!==r||e[37]!==v||e[38]!==D||e[39]!==j||e[40]!==F||e[41]!==O||e[42]!==d||e[43]!==p?(N=_.jsx("div",{className:"bg-token-bg-primary h-full w-full",children:_.jsx("div",{className:xe,children:_.jsx(Se,{editorViewRef:S,analyticsMetadata:o,showHeader:D,primaryLabel:j,primaryAction:F,subHeader:O,hasBeenEdited:P,autosaveStatus:x,clientThreadId:i,messageId:t,isInlineWritingBlockExportEnabled:B,isWritingBlockFocusedModeEnabled:!0,serverThreadId:r,shouldShowWritingBlockCanvasEdit:!1,title:d,index:a,messageRef:f,isInlineWritingBlockEditEnabled:h,writingBlock:p,onChange:m,isStreaming:!1,setDirty:v,flushPendingChanges:g,contentReferences:k,permalink:!0,editorWrapperClassName:M})})}),e[22]=o,e[23]=x,e[24]=i,e[25]=k,e[26]=S,e[27]=M,e[28]=g,e[29]=m,e[30]=P,e[31]=a,e[32]=B,e[33]=h,e[34]=t,e[35]=f,e[36]=r,e[37]=v,e[38]=D,e[39]=j,e[40]=F,e[41]=O,e[42]=d,e[43]=p,e[44]=N):N=e[44],N}function Re(n){var t,s,c;const e=(t=n.conversationId)==null?void 0:t.trim();if(!e)throw J("/");const i=(s=n.messageId)==null?void 0:s.trim(),r=(c=n.writingBlockId)==null?void 0:c.trim();if(!i||!r)throw J("/c/".concat(e));return{conversationId:e,messageId:i,writingBlockId:r}}const Ct=n=>(pe(),Re(n.params)),Bt=te(function(){"use forget";const e=$.c(35),{conversationId:i,messageId:r,writingBlockId:t}=ie(),s=X(),c=re(),d=i;let u;e[0]!==s||e[1]!==d?(u=le(s,d),e[0]=s,e[1]=d,e[2]=u):u=e[2];const a=u,l=a.id;let C;e[3]===Symbol.for("react.memo_cache_sentinel")?(C={kind:de.PrimaryAssistant},e[3]=C):C=e[3],ge(a.id,C);const E=fe();let B;e[4]!==s?(B=Y(s,"1101084612"),e[4]=s,e[5]=B):B=e[5];const I=B,p=ne();let k,x;e[6]!==l||e[7]!==p?(k=()=>(z.retainThread(l),()=>{setTimeout(()=>{p.invalidateQueries(he({clientThreadId:l}))},0),z.releaseThread(l)}),x=[l,p],e[6]=l,e[7]=p,e[8]=k,e[9]=x):(k=e[8],x=e[9]),q.useEffect(k,x);let g;e[10]!==r?(g=W=>{var T;return r?(T=W==null?void 0:W.tree.getNodeIfExists(r))==null?void 0:T.message:void 0},e[10]=r,e[11]=g):g=e[11];const m=U(a==null?void 0:a.id,g),f=U(a==null?void 0:a.id,Le);let S;e[12]!==m||e[13]!==t?(S=m?Te(me(m),t):null,e[12]=m,e[13]=t,e[14]=S):S=e[14];const o=S;let P,h;if(e[15]!==l||e[16]!==E||e[17]!==I||e[18]!==m||e[19]!==c||e[20]!==f||e[21]!==o?(P=()=>{if(!(f!=null&&f.isLoading)){if(!l||!I){c("/",{replace:!0});return}if(f&&!m||E||m&&!o){c("/c/".concat(l),{replace:!0});return}}},h=[f,m,l,c,I,E,o],e[15]=l,e[16]=E,e[17]=I,e[18]=m,e[19]=c,e[20]=f,e[21]=o,e[22]=P,e[23]=h):(P=e[22],h=e[23]),q.useEffect(P,h),!m||!o)return null;let v;return e[24]!==l||e[25]!==a||e[26]!==r||e[27]!==d||e[28]!==o.content||e[29]!==o.index||e[30]!==o.recipient||e[31]!==o.title||e[32]!==o.variant||e[33]!==t?(v=_.jsx(_e,{conversation:a,clientThreadId:l,messageId:r,writingBlockId:t,serverThreadId:d,originalContent:o.content,index:o.index,variant:o.variant,title:o.title,recipient:o.recipient}),e[24]=l,e[25]=a,e[26]=r,e[27]=d,e[28]=o.content,e[29]=o.index,e[30]=o.recipient,e[31]=o.title,e[32]=o.variant,e[33]=t,e[34]=v):v=e[34],v});function Le(n){return n}export{Ct as clientLoader,Bt as default};
//# sourceMappingURL=ho1b9sfanpd6rn4j.js.map

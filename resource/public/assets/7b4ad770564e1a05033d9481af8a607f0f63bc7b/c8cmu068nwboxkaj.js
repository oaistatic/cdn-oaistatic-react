const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e6tgogoygs27l1ey.js","assets/kfrdmkli83ureki3.js","assets/fyw02vlaiv2vq6cj.js","assets/kw08ajijqinojrwh.js","assets/root-fi49nzd2.css","assets/conversation-small-lq38g8zw.css","assets/cmy7kibwy58a01ix.js"])))=>i.map(i=>d[i]);
var se=Object.defineProperty,ne=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var D=(s,r,o)=>r in s?se(s,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[r]=o,w=(s,r)=>{for(var o in r||(r={}))ae.call(r,o)&&D(s,o,r[o]);if(W)for(var o of W(r))re.call(r,o)&&D(s,o,r[o]);return s},C=(s,r)=>ne(s,te(r));import{j as e,M as m,_ as N,d as ie,o as oe,u as le,h as me,r as ce,t as de,i as ue,F as he,ag as pe,y as fe}from"./kfrdmkli83ureki3.js";import{x as xe,a$ as t,e5 as ge}from"./fyw02vlaiv2vq6cj.js";import{W as ve}from"./e1cxccp3u9us8gn7.js";import{az as M,p as je,u as we,al as Ce,aX as Ee,pK as Ne,i1 as Me,dZ as Le,aB as be,e6 as ye,qS as _e,cq as Se,cy as F,aA as L}from"./kw08ajijqinojrwh.js";import{I as Pe}from"./mo4f6niq6474ip4n.js";import{u as Ie}from"./fx0u8y75z4qg1qfs.js";import{E}from"./hzc9tt7ii8vra0by.js";import{W as U,n as ke,i as Te,o as Re,q as Ae}from"./oyvo09ze11a90qsd.js";import"./mxzgpx7wtm4zk5cj.js";import"./cn1z5fx9l5xxo8vy.js";import"./lg0oi3tmjv8kv2p4.js";import"./b3ungmqo5x8kj4fh.js";import"./i8h8r8n4rn16l2h5.js";import"./n6eim64jp78x17ti.js";import"./d24clsve229czwkp.js";import"./f1g778pkk2fhpy9x.js";import"./goxcf7vc701q04ob.js";import"./c326bjybavj646xd.js";import"./lwyag88acem9bm0o.js";import"./o5h7u1aikohecbkt.js";import"./w4rmhhxvug61xnae.js";import"./dd8hh2tmra1psngf.js";import"./e96bwg1s7x4og2fp.js";import"./fxythiulbb2q3qno.js";import"./fux1oumbpb3w9e7e.js";import"./lafhvalu919ojf7s.js";import"./jz5yvmwm8tdb0l95.js";import"./abvgi6h30lz61l9g.js";import"./mgt4kmm4im6a7le7.js";import"./ipjj058rvhjq2uu2.js";import"./h1em0bjkpkjv8ykw.js";import"./esgn9c4esm3mlqc4.js";import"./ab1440qk9vnud23e.js";import"./dm8z7bzkrzic0zmg.js";import"./hu1bt0oauegdhua6.js";function He(){return e.jsx("div",{className:"border-token-border-heavy flex items-center border-b",children:e.jsx("div",{className:"py-2 text-xl leading-7 font-medium",children:e.jsx(m,{id:"wham.environmentsHeader.message",defaultMessage:"Environments"})})})}const Oe=M(()=>N(()=>import("./e6tgogoygs27l1ey.js"),__vite__mapDeps([0,1])),{loading:s=>L(s)}),We=M(()=>N(()=>import("./fyw02vlaiv2vq6cj.js").then(s=>s.zy),__vite__mapDeps([2,1,3,4,5])),{loading:s=>L(s)}),De=M(()=>N(()=>import("./cmy7kibwy58a01ix.js"),__vite__mapDeps([6,1])),{loading:s=>L(s)}),V=25,Fe=100;function Ue({isPinned:s,onToggle:r,intl:o,isCreator:u}){return e.jsx(t.Cell,{className:"content-center pe-1!",children:e.jsx(Se,{side:"bottom",align:"center",className:"block w-full",alignOffset:0,label:u?s?e.jsx(m,{id:"wham.environmentsList.unpin",defaultMessage:"Unpin environment for everyone in your workspace"}):e.jsx(m,{id:"wham.environmentsList.pin",defaultMessage:"Pin environment to the top for everyone in your workspace"}):e.jsx(m,{id:"wham.environmentsList.pin.notCreator",defaultMessage:"You can only pin and unpin environments you created."}),children:e.jsxs("button",{disabled:!u,onClick:r,className:F("group/cell relative flex h-10 w-full items-center px-4 group-hover/row:opacity-100",!s&&"opacity-0",s&&!u&&"opacity-50"),"aria-label":s?o.formatMessage({id:"wham.environmentsList.unpinEnvironment",defaultMessage:"Unpin environment"}):o.formatMessage({id:"wham.environmentsList.pinEnvironment",defaultMessage:"Pin environment"}),children:[s&&e.jsx(Oe,{className:"icon absolute opacity-0 group-hover/cell:opacity-100"}),e.jsx(De,{className:F("icon absolute",s&&"opacity-100 group-hover/cell:opacity-0")})]})})})}function Ve(){var T,R;const s=ie(),[r,o]=oe(),u=le(),l=me(),z=je(),Q=we(),d=Ce(Q),b=!!(d!=null&&d.isWorkspaceAccount()),y=Ie(),[g,q]=ce.useState((T=r.get("search"))!=null?T:""),{data:v,isLoading:K,error:_,fetchNextPage:B,hasNextPage:x,isFetchingNextPage:G}=de({queryKey:ke({pageSize:V,enforceRepoAccess:!1}),initialPageParam:null,queryFn:({pageParam:n})=>U.getEnvironmentWithCreators(n?Fe:V,n),getNextPageParam:n=>{var a;return(a=n.cursor)!=null?a:null}}),{mutate:Y}=ue({mutationFn:({environmentId:n,isPinned:a})=>(u.setQueriesData({queryKey:Re},i=>i&&Ee(i,c=>{for(const p of c.pages)for(const h of p.items)if(h.id===n){h.is_pinned=!h.is_pinned;break}})),u.setQueryData(["wham","environments"],i=>i&&i.map(c=>c.id===n?C(w({},c),{is_pinned:a}):c)),u.setQueryData(Ae,i=>i==null?void 0:i.map(c=>c.id===n?C(w({},c),{is_pinned:a}):c)),U.updateEnvironment(n,{is_pinned:a})),onSettled:()=>{Te(u)},onError:()=>{z.danger(l.formatMessage({id:"wham.environmentsList.failedToPinEnvironment",defaultMessage:"Failed to pin environment"}))}}),{isConnected:S,isLoading:X}=Ne(Le.GITHUB_CONNECTOR,"github","/codex/settings/environments",Me.CODEX),P=(R=v==null?void 0:v.pages.flatMap(n=>n.items))!=null?R:[],j=g.trim().toLowerCase(),Z=P.filter(n=>n.label.toLowerCase().includes(j)),I=n=>{const a=n.toLowerCase();return a===j?0:a.startsWith(j)?1:2},k=Z.slice().sort((n,a)=>{if(n.is_pinned!==a.is_pinned)return n.is_pinned?-1:1;const i=I(n.label)-I(a.label);return i!==0?i:n.label.localeCompare(a.label)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row justify-between pb-4",children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx(xe,{name:"search-environments",color:"search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",value:g,disabled:X||!S||_!==null,onChange:n=>{const a=n.target.value;q(a),a?o({search:a},{replace:!0}):o({},{replace:!0})},placeholder:l.formatMessage({id:"wham.environmentsList.searchEnvironmentsPlaceholder",defaultMessage:"Search environments"}),ariaLabel:l.formatMessage({id:"wham.environmentsList.searchEnvironmentsAria",defaultMessage:"Search environments"})})}),e.jsx(be,{onClick:()=>s("/codex/settings/environment/create"),disabled:!S,color:"primary",icon:We,className:"h-8","aria-label":l.formatMessage({id:"wham.environmentsList.createEnvironmentAriaLabel",defaultMessage:"Link to create a new environment"}),children:e.jsx("span",{className:"hidden md:inline",children:e.jsx(m,{id:"wham.environmentsList.createEnvironment",defaultMessage:"Create environment"})})})]}),K?e.jsx("div",{className:"flex h-full items-center justify-center pt-5",children:e.jsx(ye,{})}):_?e.jsx(E,{title:l.formatMessage({id:"wham.environmentsList.error",defaultMessage:"Failed to load environments"}),description:l.formatMessage({id:"wham.environmentsList.errorDescription",defaultMessage:"Please try refreshing the page, if that does not work, please contact support."})}):P.length===0?e.jsx(E,{title:l.formatMessage({id:"wham.environmentsList.noEnvironments",defaultMessage:"No environments"}),description:l.formatMessage({id:"wham.environmentsList.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})}):e.jsxs(e.Fragment,{children:[e.jsxs(t.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[e.jsxs(t.Header,{children:[e.jsx(t.HeaderCell,{className:"ps-2 text-sm",children:e.jsx(m,{id:"wham.environmentsList.name",defaultMessage:"Name"})}),e.jsx(t.HeaderCell,{className:"text-sm",children:e.jsx(m,{id:"wham.environmentsList.repo",defaultMessage:"Repo"})}),e.jsx(t.HeaderCell,{className:"text-sm",children:e.jsx(m,{id:"wham.environmentsList.numberOfTasks",defaultMessage:"Number of tasks"})}),y&&e.jsx(t.HeaderCell,{className:"text-sm",children:e.jsx(m,{id:"wham.environmentsList.sharing",defaultMessage:"Sharing"})}),e.jsx(t.HeaderCell,{className:"text-sm",children:e.jsx(m,{id:"wham.environmentsList.creator",defaultMessage:"Creator"})}),e.jsx(t.HeaderCell,{className:"text-sm",children:e.jsx(m,{id:"wham.environmentsList.createdAt",defaultMessage:"Created at"})}),b&&e.jsx(t.HeaderCell,{}),e.jsx(t.HeaderCell,{})]}),e.jsx(t.Body,{children:k.length===0&&!x?e.jsx(t.Row,{children:e.jsx(t.Cell,{colSpan:100,children:e.jsx(E,{title:l.formatMessage({id:"wham.environmentsList.search.noEnvironments",defaultMessage:"No matches for {search}"},{search:g}),description:l.formatMessage({id:"wham.environmentsList.search.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})})})}):k.map(({id:n,label:a,is_pinned:i,repos:c,repo_map:p,creator:h,created_at:A,task_count:$,share_settings:J})=>{const ee=!!(d!=null&&d.authUserId)&&h.id.includes(d==null?void 0:d.authUserId);return e.jsxs(t.Row,{role:"row",className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm hover:cursor-pointer",onClick:()=>s("/codex/settings/environment/".concat(n)),tabIndex:0,"aria-label":l.formatMessage({id:"wham.environmentsList.environmentAriaLabel",defaultMessage:"View environment {label}"},{label:a}),children:[e.jsx(t.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:a}),e.jsx(t.Cell,{divClassName:"flex h-14 items-center",children:c.map(f=>{var H,O;return e.jsx("div",{children:(O=(H=p==null?void 0:p[f])==null?void 0:H.repository_full_name)!=null?O:f},f)})}),e.jsx(t.Cell,{divClassName:"flex h-14 items-center",children:$}),y&&e.jsx(t.Cell,{divClassName:"flex h-14 items-center",children:ze(l,J)}),e.jsx(t.Cell,{divClassName:"flex h-14 items-center",children:h.email}),e.jsx(t.Cell,{divClassName:"flex h-14 items-center",children:A?e.jsx(he,{value:new Date(A*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(m,{id:"wham.environmentsList.na",defaultMessage:"N/A"})}),b&&e.jsx(Ue,{isPinned:i,isCreator:ee,onToggle:f=>{f.stopPropagation(),Y({environmentId:n,isPinned:!i})},intl:l})]},n)})})]}),e.jsx(Pe,{isFetchingNextPage:G,hasNextPage:x!=null?x:!1,fetchNextPage:B})]})]})})}function ze(s,r){switch(r){case"public":return s.formatMessage({id:"wham.environmentsList.public",defaultMessage:"Public"});case"private":return s.formatMessage({id:"wham.environmentsList.private",defaultMessage:"Private"});case"workspace":return s.formatMessage({id:"wham.environmentsList.workspace",defaultMessage:"Workspace"});default:_e.assertNever(r)}}function Qe(){const{eligible:s}=ge();return s?e.jsx(pe,{to:"/codex"}):e.jsx(ve,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-4 ps-4 pe-4 md:pe-12",children:[e.jsx(He,{}),e.jsx(Ve,{})]})})}const ys=()=>[{title:"Codex"}],_s=fe(function(){return e.jsx(Qe,{})});export{_s as default,ys as meta};
//# sourceMappingURL=c8cmu068nwboxkaj.js.map

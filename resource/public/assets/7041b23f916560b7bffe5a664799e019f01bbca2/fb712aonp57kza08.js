import{eo as g,m as S,cZ as h,c_ as d,b as R}from"./n9zp7vm10xoipejo.js";import{C as E,d as b,r as n,j as C}from"./lip667d8t42poxum.js";import{a as O}from"./itdwpc2q0aiung3v.js";const f="chatgpt://oauth_complete";async function T(u,a,s,r){const e=await R.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:u},query:{code:a,redirect_uri:s,...r!=null?{state:r}:{}}}});return{...e,redirect_path:O(e.redirect_path).toString()}}const L=g(function(){const{pluginId:a,code:s,state:r,error:e,errorDesc:i}=E(),c=b(),l=n.useRef(!1);n.useEffect(()=>{if(l.current===!0)return;l.current=!0;async function _(){const m=`https://chat.openai.com/aip/${a}/oauth/callback`;try{const t=await T(a,s,m,r);if(t.success)if(t.redirect_path===f)window.location.href=f;else{const o=new URL(h(d.OAUTH_SUCCESS,t.redirect_path),location.origin);o.searchParams.set("oauth_success","true"),c(o.pathname+o.search+o.hash)}else c(h(d.CUSTOM_ERROR,t.redirect_path,t.error??t.message))}catch{c({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:a,loginSuccess:"false"}).toString()})}}_()},[a,s,r,c]);const p=S();return n.useEffect(()=>{e&&p.danger(`${e}${i?`: ${i}`:""}`,{duration:5})},[e,i,p]),C.jsx("div",{})});export{L as default};
//# sourceMappingURL=fb712aonp57kza08.js.map

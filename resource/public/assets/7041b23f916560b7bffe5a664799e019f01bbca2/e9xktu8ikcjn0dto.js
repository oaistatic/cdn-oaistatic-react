import{r as p,j as e,a6 as Q,M as b,g as ae,u as ie,f as S,a5 as N}from"./lip667d8t42poxum.js";import{af as re,aI as B,aO as _,aj as w,cX as le,dR as ce,k as de,b as ue,d as pe,m as me,ga as G,B as j,p as ge,ag as fe}from"./n9zp7vm10xoipejo.js";import{a as xe,C as he}from"./nmzcjggnos81a3wt.js";import{e as $,da as ye,db as U,U as z,dc as K,dd as be,de as _e,df as we,dg as je,dh as V,di as Me,dj as Se,dk as ke,f as ve,dl as Ne,I as Ce,dm as Ee}from"./l4oo5ijw01fyrjzs.js";import{b as Te,a as Pe,m as Ue}from"./g1wxldf6nb3zk37x.js";import{M as Oe}from"./k1r8zdqpavwsddzj.js";import{H as De}from"./g4tl5lt9yqf20m4s.js";import"./ezoyp421dng92ve4.js";import"./krf7zg7fy4qqowqq.js";import"./j385t288u9l3nf6j.js";import"./n4y4yo9zuw99bnsn.js";import"./cbaql59zac1mfnmh.js";import"./op1xowyjquc2dnq7.js";import"./oour34cwuwf9tyoh.js";import"./czpmep8a1gn2yxp9.js";import"./g1x7jf9g2b4osi6b.js";import"./kdkl0k5zipatley9.js";import"./m5nmfgkx7kb16kea.js";import"./frsgt7dup0f3mfs8.js";import"./jrbfupmnwi0b2in6.js";import"./n7emuv1efbtdnxb9.js";import"./ef49rx2y546x1g51.js";import"./h5ge3c3mruoe76ro.js";import"./flqsbet8wo14mte0.js";import"./dih8dferf1paqxo1.js";import"./d61ttkht2554hc14.js";import"./hdusgp6ndfp1vzue.js";import"./bir4gwnbq17hkvt3.js";import"./ju8q15l0hqy6ti9z.js";function Fe(t,s,n){const{data:i,isLoading:r,isSuccess:c,isError:u}=ie({queryKey:["onboardingSteps",s,n,t],queryFn:()=>ue.safePost("/onboarding/steps",{requestBody:{main_usage:void 0,main_usages:s,user_description:n,exclude_feature_steps:t},authOption:pe.SendIfAvailable})});return{steps:i?.steps??[],isLoading:r,isSuccess:c,isError:u}}function k({children:t,className:s}){return e.jsx(N.div,{className:s,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Ie({isFirstStep:t,userName:s}){return e.jsx(k,{className:"max-sm:px-5 max-sm:py-4",children:!t&&e.jsx("h1",{className:"text-token-text-primary mb-2 text-center text-3xl leading-9 font-medium",children:e.jsx(b,{...s?a.niceToMeetYouQuickTourWithName:a.niceToMeetYouQuickTour,values:{name:s,nextLine:n=>e.jsx("span",{className:"block",children:n})}})})})}function Le(){return e.jsxs(k,{className:"gapy-y-4 flex flex-col items-center justify-center",children:[e.jsx(ve,{className:"text-token-text-primary text-4xl"}),e.jsx("p",{className:"text-token-text-primary text-center text-3xl",children:e.jsx(b,{...a.allDone})})]})}function qe({setIsInWelcomePage:t}){const s=$();return p.useEffect(()=>{s&&setTimeout(()=>{t(!1)},2500)},[s,t]),s?e.jsx(k,{className:"max-sm:px-5 max-sm:py-4",children:e.jsx("h1",{className:"text-token-text-primary mb-2 text-3xl leading-9 font-medium max-sm:text-center",children:e.jsx(b,{...a.imChaggptNiceToMeetYou})})}):null}function Ae(t){const s=K(),n=S(),i=me(),r=be(t),c=_e(t),u=we(r,c),o=je(r,c);return p.useCallback(async d=>{const f="text/plain",l=new Blob([d],{type:f}),x=new File([l],"My_File.txt",{type:f});return V.uploadFile(s,Me(x),x,Se.Retrieval,o,n,i,void 0,u?.attachments)},[s,n,i,o,u?.attachments])}function We({step:t,steps:s,stepIndex:n,handleGoBack:i,endOnboarding:r}){const c=S();return e.jsxs("div",{className:"absolute start-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[s&&s.length>0&&e.jsx("div",{className:"absolute start-0 top-0 h-2 w-full",children:e.jsx(N.div,{className:"bg-token-main-surface-primary-inverse h-1.5",initial:{width:"0%",opacity:0},animate:{width:`${(n+1)/s.length*100}%`,opacity:1},transition:{duration:.3}})}),n>0?e.jsx(j,{onClick:i,color:"ghost",className:"border-none",icon:ke}):e.jsx("div",{}),t?.step_type!=="usage_question"&&t?.step_type!=="self_description"&&e.jsx(j,{onClick:()=>r(!0),color:"ghost",size:"large",children:c.formatMessage(a.skipTour)})]})}function He({step:t,steps:s,stepIndex:n,endOnboarding:i,gotoStep:r,isInWelcomePage:c,isLoading:u,clientThreadId:o}){const d=S(),f=G({clientThreadId:o}),l=X(t,n,s.length,i,r);return c||u||t?.step_type==="usage_question"||t?.step_type==="self_description"?null:e.jsx("div",{className:"absolute start-0 bottom-0 z-30 w-full px-4 pb-8",children:e.jsxs("div",{className:"bg-token-main-surface-primary shadow-token-border-default flex w-full flex-col gap-y-2 rounded-3xl px-6 py-5 text-center shadow-[0px_10px_30px_0px]",children:[t&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl leading-9 font-bold",children:t.title?t.title:T[t.step_type]?d.formatMessage(T[t.step_type]):null}),e.jsx("p",{className:"text-token-text-secondary text-base leading-normal font-normal",children:t.subtitle?t.subtitle:P[t.step_type]?d.formatMessage(P[t.step_type]):null})]}),e.jsx(j,{onClick:l,color:"primary",size:"giant",className:"mt-4",disabled:n!==s.length-1&&f,children:n===s.length-1?d.formatMessage(a.done):d.formatMessage(a.next)}),n!==s.length-1&&e.jsx(j,{onClick:()=>i(!0),color:"ghost",children:d.formatMessage(a.skipTour)})]})})}function _t({clientThreadId:t,setClientThreadId:s}){const[n,i]=p.useState(!1),{isOpen:r,setIsOpen:c,markAsViewed:u}=Te(),[o,d]=p.useState(0),[f,l]=p.useState(new Set(["usage_question"])),[x,O]=p.useState([]),[M,J]=p.useState(),[D,L]=p.useState(!1),[q,A]=p.useState(!1),{steps:y,isLoading:C,isError:F}=Fe(!D,D?x:[],D?M:void 0),Z=$(),W=Pe({clientThreadId:t}),H=Ae(t),{createNewThread:I}=ye({clientThreadId:t,setClientThreadId:s}),R=re(t,fe.hasUserMessage),{layer:Y}=B("109457",{shouldLogExposure:!1}),ee=Y.get("keep_onboarding_after_dismiss",!1),te=U();p.useEffect(()=>{r?(_.logEvent("chatgpt_onboarding_flow_shown"),w.logEvent("Onboarding Shown")):z.setOnboardingConvoState(null)},[r]),p.useEffect(()=>{F&&(u(),_.logEvent("chatgpt_onboarding_flow_error"),w.logEvent("Onboarding Error"))},[F,u]),p.useEffect(()=>{const m=y[o];if(!(C||!m)&&!f.has(m.step_type)){l(E=>new Set([...E,m.step_type]));const h=m.step_prompt;h&&(z.setOnboardingConvoState({onboardingConvoClientThreadId:t}),W({eventSource:"url",stepPrompt:h,messageMetadata:m.step_metadata,authorMetadata:{real_author:le.Onboarding}}),y[o].step_type==="file_upload"&&y[o].additional_info&&H(y[o].additional_info))}},[o,C,f,W,y,H,t]);const g=y[o];if(p.useEffect(()=>{const m=g?.step_type;(m==="usage_question"||m==="self_description")&&R&&r&&(I(),l(h=>new Set(Array.from(h).filter(E=>E==="usage_question"||E==="self_description"))))},[g?.step_type,I,R,r]),p.useEffect(()=>{g?.step_type&&(_.logEvent("chatgpt_onboarding_step_shown",null,{step_type:g?.step_type,step_index:o.toString()}),w.logEvent("Onboarding Step Shown",{step_type:g?.step_type,step_index:o.toString()}))},[o,g?.step_type]),F)return null;const v=(m,h=!0)=>{A(!0),Y.get("new_thread_after_onboarding",!1)&&I(),setTimeout(()=>{A(!1),o===y.length-1?(_.logEvent("chatgpt_onboarding_flow_finished"),w.logEvent("Onboarding Finished")):(_.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:g?.step_type,step_index:o.toString()}),w.logEvent("Onboarding Dismissed",{step_type:g?.step_type,step_index:o.toString()})),m&&!ee&&u(),c(!1)},h?2e3:0)},se=m=>{O(m),y.find(h=>h.step_type==="self_description")||L(!0),d(h=>h+1),_.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:m.join(", ")}),w.logEvent("Onboarding Usage Question Selected",{main_usages:m.join(", ")})},ne=m=>{J(m),L(!0),d(h=>h+1),_.logEvent("chatgpt_onboarding_self_description_entered",null,{main_usages:x.join(", ")}),w.logEvent("Onboarding Self Description Entered",{main_usages:x.join(", ")})},oe=()=>{_.logEvent("chatgpt_onboarding_go_back",null,{step_type:g?.step_type,step_index:o.toString()}),w.logEvent("Onboarding Go Back",{step_type:g?.step_type,step_index:o.toString()}),d(m=>m-1)};return e.jsx(ce,{fallback:()=>(v(!0,!1),e.jsx(e.Fragment,{})),name:"NewUserOnboardingFlowModal",children:e.jsx(de,{testId:"modal-new-user-onboarding-flow",isOpen:r,onClose:()=>v(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(xe,{clientThreadId:t,children:e.jsxs("div",{className:"bg-token-main-surface-primary flex h-full max-h-full flex-col",children:[!q&&(te?e.jsx(He,{step:g,steps:y,stepIndex:o,endOnboarding:v,gotoStep:d,isInWelcomePage:n,isLoading:C,clientThreadId:t}):e.jsx(We,{step:g,steps:y,stepIndex:o,handleGoBack:oe,endOnboarding:v})),e.jsx("div",{className:"flex min-h-0 flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx(Q,{mode:"wait",children:n?e.jsx(qe,{setIsInWelcomePage:i},"welcome"):C?e.jsx(Ie,{isFirstStep:o<1,userName:Z?.first_name??void 0},"loading"):q?e.jsx(Le,{},"wrapping-up"):g?.step_type==="usage_question"?e.jsx(Re,{mainUsagesProp:x,onSelectMainUsages:se},"usage-question"):g?.step_type==="self_description"?e.jsx(Ye,{mainUsages:x,selfDescriptionProp:M,onEnterSelfDescription:ne},"self-description"):["dalle","file_upload","canvas","voice","ask_any_question"].includes(g?.step_type)?e.jsx(ze,{step:g,gotoStep:d,stepIndex:o,totalSteps:y.length,endOnboarding:v,clientThreadId:t},"tools-onboarding"):null})})]})})})})}function Re({mainUsagesProp:t,onSelectMainUsages:s}){const[n,i]=p.useState(new Set(t)),[r,c]=p.useState(void 0),u=S(),o=U(),d=()=>{const l=new Set(n);l.has("other")&&r&&(l.add(r),l.delete("other")),s(Array.from(l))},f=["school","work","personalTasks","funAndEntertainment","other"];return e.jsxs(k,{className:"flex flex-col justify-between max-sm:h-full max-sm:overflow-y-auto max-sm:px-6 max-sm:pt-10 max-sm:pb-5 sm:w-[320px]",children:[e.jsxs("div",{className:"min-h-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-token-text-primary mb-4 text-center text-3xl leading-9 font-medium",children:e.jsx(b,{...a.whatDoYouUseChatGPTFor})}),e.jsx("p",{className:"text-token-text-secondary mb-7 text-center text-base",children:e.jsx(b,{...a.suggestUsefulIdeas})})]}),e.jsxs("div",{className:"flex flex-col items-start justify-start gap-7 ps-2.5",children:[f.map(l=>e.jsx(Ne,{id:`main-usage-${l}`,checked:n.has(l),onChange:x=>i(O=>{const M=new Set(O);return x.target.checked?M.add(l):M.delete(l),M}),label:e.jsx("span",{className:"cursor-pointer",children:u.formatMessage(Ue[l])}),className:"rounded-full!"},l)),n.has("other")&&e.jsx(Ce,{ariaLabel:u.formatMessage(a.tellMeWhyHere),name:"other",placeholder:u.formatMessage(a.tellMeWhyHere),onChange:l=>c(l.target.value),maxLength:100,className:"bg-token-main-surface-primary ms-6 min-w-64"})]})]}),e.jsx(j,{size:o?"large":"giant",color:"primary",onClick:d,className:"mt-10",fullWidth:!0,children:e.jsx(b,{...a.next})})]})}function Ye({mainUsages:t,selfDescriptionProp:s,onEnterSelfDescription:n}){const[i,r]=p.useState(s),c=S(),u=U(),o=p.useMemo(()=>t.includes("school")?a.exampleSchoolSelfDescription:t.includes("work")?a.exampleWorkSelfDescription:t.includes("funAndEntertainment")?a.exampleFunAndEntertainmentSelfDescription:a.examplePersonalTasksSelfDescription,[t]),{layer:d}=B("109457",{shouldLogExposure:!1}),f=d.get("write_custom_instructions_in_onboarding",!1),l=async()=>{n(i),f&&i&&ge.createOrUpdateUserSystemMessage({aboutUserMessage:i,aboutModelMessage:"",disabledTools:[],enabled:!0}).catch(()=>{})};return e.jsxs(k,{className:"flex w-[640px] flex-col items-start max-sm:w-full max-sm:overflow-y-auto max-sm:px-5 max-sm:py-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-token-text-primary mb-4 text-3xl leading-9 font-medium",children:e.jsx(b,{...a.anythingElseYouWantMeToKnow})}),e.jsx("p",{className:"text-token-text-secondary text-base",children:e.jsx(b,{...f?a.selfDescriptionReasonSaveToCustomInstructions:a.selfDescriptionReason,values:{customInstructions:x=>e.jsx("a",{href:De,className:"underline",target:"_blank",rel:"noreferrer",children:x})}})})]}),e.jsx(Ee,{className:"!dark:bg-white/5 border-token-border-default placeholder-token-text-tertiary mt-10 rounded-sm border bg-black/5! p-5 text-base!",placeholder:c.formatMessage(o),rows:4,value:i,onChange:x=>r(x.target.value),autoFocus:!0}),e.jsx(j,{size:u?"large":"medium",color:"primary",onClick:l,className:"mt-10",fullWidth:u,children:e.jsx(b,{...a.next})})]})}function X(t,s,n,i,r){const c=K();return p.useCallback(()=>{s<n-1?(_.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:s.toString()}),w.logEvent("Onboarding Next",{source_step_type:t?.step_type,source_step_index:s.toString()}),t?.step_type==="file_upload"&&V.reset(c),r(s+1)):i(!0),document.body.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},[t,s,n,c,i,r])}function ze({step:t,gotoStep:s,stepIndex:n,totalSteps:i,endOnboarding:r,clientThreadId:c}){const u=G({clientThreadId:c}),o=S(),d=n===i-1,f=U(),l=X(t,n,i,r,s);return e.jsxs(k,{className:"flex h-full w-full flex-row sm:px-8 md:px-12 lg:px-16 xl:px-24",children:[!f&&e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(N.div,{className:"flex w-[90%] flex-1 flex-col items-center justify-center gap-2 text-center sm:w-[320px]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(Q,{mode:"wait",children:[e.jsx(N.h1,{className:"text-token-text-primary mb-2 text-3xl font-medium",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:T[t.step_type]?o.formatMessage(T[t.step_type]):null},`title-${n}`),e.jsx(N.p,{className:"text-token-text-secondary mb-6 text-base",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:P[t.step_type]?o.formatMessage(P[t.step_type]):null},`subtitle-${n}`)]}),e.jsx(j,{size:"giant",color:"primary",onClick:l,fullWidth:!0,disabled:u&&!d,children:e.jsx(b,{...d?a.tryChatGPT:a.next})})]})}),e.jsx("div",{className:"relative flex h-full flex-1 flex-col sm:min-w-[360px] sm:pt-20 sm:pb-20",children:e.jsx("div",{className:"bg-token-main-surface-primary shadow-token-border-default h-full w-full overflow-auto shadow-[0_0_50px] max-sm:pb-[280px] sm:rounded-[30px]",children:e.jsx(he,{clientThreadId:c,ignoreParentComposerController:!0,children:e.jsx("div",{className:"pointer-events-none min-h-full w-full",children:e.jsx(Oe,{hideHeader:!0,hideDisclaimer:!0,clientThreadId:c})})})})})]})}const a=ae({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},done:{defaultMessage:"Done",id:"chatgpt.new-onboarding.done"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},tellMeWhyHere:{defaultMessage:"Tell me about why youâ€™re here.",id:"chatgpt.new-onboarding.tell-me-why-here"},whatDoYouUseChatGPTFor:{defaultMessage:"What do you want to use ChatGPT for?",id:"chatgpt.new-onboarding.what-do-you-use-chatgpt-for"},suggestUsefulIdeas:{defaultMessage:"Iâ€™ll use this information to suggest ideas you might find useful.",id:"chatgpt.new-onboarding.suggest-useful-ideas"},imChaggptNiceToMeetYou:{defaultMessage:"ðŸ‘‹ Hi, Iâ€™m ChatGPT. Itâ€™s nice to meet you!",id:"chatgpt.new-onboarding.im-chatgpt-nice-to-meet-you"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},niceToMeetYouQuickTourWithName:{defaultMessage:"Nice to meet you, {name}.<nextLine></nextLine>Hereâ€™s a quick tour...",id:"chatgpt.new-onboarding.nice-to-meet-you-quick-tour-with-name"},niceToMeetYouQuickTour:{defaultMessage:"Nice to meet you.<nextLine></nextLine>Hereâ€™s a quick tour...",id:"chatgpt.new-onboarding.nice-to-meet-you-quick-tour"},allDone:{defaultMessage:"You're all set!",id:"chatgpt.new-onboarding.all-done"},oneLastQuestion:{defaultMessage:"One last question:",id:"chatgpt.new-onboarding.one-last-question-2"},anythingElseYouWantMeToKnow:{defaultMessage:"Is there anything else youâ€™d like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know-2"},oneQuestionAnythingElse:{defaultMessage:"One last question: Is there anything else youâ€™d like me to know?",id:"chatgpt.new-onboarding.one-more-question"},selfDescriptionReason:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant.",id:"chatgpt.new-onboarding.self-description-reason"},allSetLetMeShowYouAroundWithoutName:{defaultMessage:"All set!<nextLine></nextLine>Now, let me show you around...",id:"chatgpt.new-onboarding.all-set-let-me-show-you-around-without-name"},selfDescriptionReasonSaveToCustomInstructions:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant. Iâ€™ll save this information as <customInstructions>Custom Instructions</customInstructions>, which you can update any time.",id:"chatgpt.new-onboarding.self-description-reason-save-to-custom-instructions"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"},tryChatGPT:{defaultMessage:"Try ChatGPT",id:"chatgpt.new-onboarding.try-chatgpt"},skipTour:{defaultMessage:"Skip Tour",id:"chatgpt.new-onboarding.skip-tour"}}),T={usage_question:a.tellMeWhyHere},P={usage_question:a.suggestUsefulIdeas};export{Ie as LoadingState,_t as default};
//# sourceMappingURL=e9xktu8ikcjn0dto.js.map

import{r as z,f as _,j as n,g as G}from"./lip667d8t42poxum.js";import{g as P,e3 as k,as as q,e4 as B,c as x,W as H,al as W,bY as $}from"./n9zp7vm10xoipejo.js";import{dO as V,fn as N,fo as D,fp as O,fq as Y,fr as J,fs as K,fk as Q,ft as X,fu as Z}from"./l4oo5ijw01fyrjzs.js";function ee({asset:s,contextConnectorSourceUrl:g,isSingle:t,isUserTurn:m,className:l}){const i=P(),o=k(i).flags,[r,u]=z.useState(!1),{isUnauthenticated:e}=q(),a=o?.includes(B.NoAuthEnableFileUploads),I=V(s.asset_pointer),d=N.useState(b=>N.selectFile(b,I)),h=D(d?.file??null,d?.file.name,d?.fileId??void 0,d?.gizmoId,d?.contextConnectorInfo,!0),M=e&&d&&a,{gizmoEditorData:F}=O(),p=Y(),C=J(m),j=_(),{data:U,isLoading:R,error:E}=K({asset:s,gizmoId:F?.id,getServerUrl:!M}),{url:v,width:f,height:w}=h&&a?{width:s.width,height:s.height,url:h}:U??{},A=R||!r,y=f&&w?{Landscape:f>w,Portrait:f<w}:void 0,c=["overflow-hidden rounded-lg"];if(t&&(c.push("w-full h-full"),y?.Landscape?c.push("max-w-96 max-h-64"):y?.Portrait?c.push("max-h-96 max-w-64"):c.push("max-w-64 max-h-64")),l&&c.unshift(l),C)return null;let L;return v!=null&&(L=n.jsx(Q,{alt:j.formatMessage(S.imageAltText),className:x("max-w-full",!t&&"aspect-square","object-cover object-center",c),src:v,width:f,height:w,onLoad:()=>u(!0)}),p||(L=n.jsx(X,{src:v,alt:j.formatMessage(S.imageAltText),contextConnectorSourceUrl:g,className:x(c),children:L}))),n.jsx("div",{className:x(c),children:n.jsx("div",{className:x("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!t&&"aspect-square"),children:v!=null?L:n.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${f} / ${w}`,width:f},title:A?j.formatMessage(S.loadingImage):j.formatMessage(S.errorLoadingImage),children:A?n.jsx(H,{}):E?n.jsx(W,{className:"icon-sm"}):null})})})}const S=G({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function T({assets:s,attachments:g,isUserTurn:t=!0,clientThreadId:m}){const l=s.length===1,{containerClassname:i,imageClassnames:o}=T.computeClassnames(s.length);return n.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[n.jsx("div",{className:x("flex flex-row items-center justify-end gap-1",i),children:s.map((r,u)=>{const e=g?.find(a=>a.id&&r.asset_pointer.includes(a.id));return n.jsx(ee,{asset:r,isSingle:l,isUserTurn:t,contextConnectorSourceUrl:e?.context_connector_info?.source_url,className:o[u]},u)})}),n.jsx(Z,{featureType:$.ATTACHMENT,isUserTurn:t,clientThreadId:m})]})}T.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let g=s>=4?"flex-wrap":"";const t=Array(s),m=e=>{t.fill(e)},l=e=>{g+=` ${e}`},i=(e,a)=>{t[e]=x(t[e],a)},o=s<=4&&s%2===0?2:3,r=Math.ceil(s/o),u=s%o!==0;o===2?(m("h-32 w-32"),l("max-w-72")):r<=2?(m("h-24 w-24 sm:h-32 sm:w-32"),l("max-w-80 sm:max-w-100")):(m("h-16 w-16"),l("max-w-52"));for(let e=0;e<s;e++){const a=Math.floor(e/o),I=e%o,d=Math.min(s-a*o,o),h=a===0,M=a===r-1,F=a===r-2,p=I===0,C=I===d-1;h&&p&&i(e,"rounded-ss-2xl"),h&&C&&i(e,"rounded-se-2xl"),M&&p&&i(e,"rounded-es-2xl"),M&&C&&i(e,"rounded-ee-sm"),u&&p&&F&&i(e,"rounded-es-2xl")}return{containerClassname:g,imageClassnames:t}};export{T as TextMessageImageGroup};
//# sourceMappingURL=efzhssuig7jyig18.js.map

import{r as d,k as De,j as e,f as ae,a5 as j,a6 as L}from"./lip667d8t42poxum.js";import{eO as oe,dj as ie,ag as ue,aX as ce,W as de,k as Re,c as Ne,B as Ie}from"./n9zp7vm10xoipejo.js";import{W as Oe}from"./b2byc8rvxtjtrqes.js";import{qe as Ae,qf as _e,f8 as Ue,eJ as qe,qg as Ve,j$ as h,qh as We,bI as Ee,ew as Le,qi as Pe,fK as W,fB as y,qj as Te,qk as Be,mf as ze,mg as Ze}from"./l4oo5ijw01fyrjzs.js";import{u as Fe,g as He}from"./oa31uqc3a0456s7u.js";import{D as k}from"./evgaiwpapseg0b65.js";import{u as $e}from"./osbah03byj97div2.js";import"./bir4gwnbq17hkvt3.js";import"./o779ihwdsjhwlelt.js";import"./lt5u077njj9ud9u7.js";import"./e59f7y6b0ew7ftb0.js";import"./kweqtgafphozzl00.js";import"./cbaql59zac1mfnmh.js";import"./op1xowyjquc2dnq7.js";import"./nmzcjggnos81a3wt.js";import"./ezoyp421dng92ve4.js";import"./krf7zg7fy4qqowqq.js";import"./j385t288u9l3nf6j.js";import"./g1k10sykivgpvvsx.js";import"./g4ge1x9hirzpsg9n.js";const Ge=r=>d.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},d.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 15.8333V17.1667C4 18.4553 5.04467 19.5 6.33333 19.5C6.70152 19.5 7 19.2015 7 18.8333V14.1667C7 13.7985 6.70152 13.5 6.33333 13.5C5.04467 13.5 4 14.5447 4 15.8333ZM2 12.5C2 6.97715 6.47715 2.5 12 2.5C17.5228 2.5 22 6.97715 22 12.5V17.1667C22 19.5599 20.0599 21.5 17.6667 21.5C16.1939 21.5 15 20.3061 15 18.8333V14.1667C15 12.6939 16.1939 11.5 17.6667 11.5C18.523 11.5 19.3214 11.7484 19.9936 12.1771C19.8242 7.90854 16.3101 4.5 12 4.5C7.68986 4.5 4.17583 7.90854 4.0064 12.1771C4.6786 11.7484 5.47696 11.5 6.33333 11.5C7.80609 11.5 9 12.6939 9 14.1667V18.8333C9 20.3061 7.80609 21.5 6.33333 21.5C3.9401 21.5 2 19.5599 2 17.1667V12.5ZM20 15.8333C20 14.5447 18.9553 13.5 17.6667 13.5C17.2985 13.5 17 13.7985 17 14.1667V18.8333C17 19.2015 17.2985 19.5 17.6667 19.5C18.9553 19.5 20 18.4553 20 17.1667V15.8333Z",fill:"currentColor"}));var D,J;function Je(){if(J)return D;J=1;function r(t,n,a,o){var s=-1,u=t==null?0:t.length;for(o&&u&&(a=t[++s]);++s<u;)a=n(a,t[s],s,t);return a}return D=r,D}var R,Q;function Qe(){if(Q)return R;Q=1;function r(t){return function(n){return t?.[n]}}return R=r,R}var N,Y;function Ye(){if(Y)return N;Y=1;var r=Qe(),t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},n=r(t);return N=n,N}var I,K;function Ke(){if(K)return I;K=1;var r=Ye(),t=oe(),n=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",s="\\u20d0-\\u20ff",u=a+o+s,c="["+u+"]",l=RegExp(c,"g");function i(x){return x=t(x),x&&x.replace(n,r).replace(l,"")}return I=i,I}var O,X;function Xe(){if(X)return O;X=1;var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function t(n){return n.match(r)||[]}return O=t,O}var A,ee;function et(){if(ee)return A;ee=1;var r=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function t(n){return r.test(n)}return A=t,A}var _,te;function tt(){if(te)return _;te=1;var r="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",o=t+n+a,s="\\u2700-\\u27bf",u="a-z\\xdf-\\xf6\\xf8-\\xff",c="\\xac\\xb1\\xd7\\xf7",l="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",i="\\u2000-\\u206f",x=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",p="A-Z\\xc0-\\xd6\\xd8-\\xde",S="\\ufe0e\\ufe0f",b=c+l+i+x,C="['’]",w="["+b+"]",M="["+o+"]",f="\\d+",fe="["+s+"]",P="["+u+"]",T="[^"+r+b+f+s+u+p+"]",me="\\ud83c[\\udffb-\\udfff]",pe="(?:"+M+"|"+me+")",ve="[^"+r+"]",B="(?:\\ud83c[\\udde6-\\uddff]){2}",z="[\\ud800-\\udbff][\\udc00-\\udfff]",g="["+p+"]",he="\\u200d",Z="(?:"+P+"|"+T+")",ge="(?:"+g+"|"+T+")",F="(?:"+C+"(?:d|ll|m|re|s|t|ve))?",H="(?:"+C+"(?:D|LL|M|RE|S|T|VE))?",$=pe+"?",G="["+S+"]?",je="(?:"+he+"(?:"+[ve,B,z].join("|")+")"+G+$+")*",be="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ce="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",we=G+$+je,ye="(?:"+[fe,B,z].join("|")+")"+we,Se=RegExp([g+"?"+P+"+"+F+"(?="+[w,g,"$"].join("|")+")",ge+"+"+H+"(?="+[w,g+Z,"$"].join("|")+")",g+"?"+Z+"+"+F,g+"+"+H,Ce,be,f,ye].join("|"),"g");function Me(ke){return ke.match(Se)||[]}return _=Me,_}var U,re;function rt(){if(re)return U;re=1;var r=Xe(),t=et(),n=oe(),a=tt();function o(s,u,c){return s=n(s),u=c?void 0:u,u===void 0?t(s)?a(s):r(s):s.match(u)||[]}return U=o,U}var q,ne;function nt(){if(ne)return q;ne=1;var r=Je(),t=Ke(),n=rt(),a="['’]",o=RegExp(a,"g");function s(u){return function(c){return r(n(t(c).replace(o,"")),u,"")}}return q=s,q}var V,se;function st(){if(se)return V;se=1;var r=nt(),t=Ae(),n=r(function(a,o,s){return a+(s?" ":"")+t(o)});return V=n,V}var at=st();const ot=De(at);function it({conversationId:r}){const t=ie(r),n=ue.getCurrentNode(ce(r))?.id,a=_e();return Ue()?e.jsx(v,{conversationId:t??r,parentMessageId:n,status:a}):null}function v(r){const t=r?.status?.modes,[n,a]=d.useState(!1),[o,s]=d.useState(),u=d.useCallback(i=>{s(i),a(!0)},[]),c=ae(),l=d.useCallback(()=>a(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(qe,{contentAlign:"center",triggerButton:e.jsx(v.Trigger,{}),children:t?t.map(i=>d.createElement(v.Item,{...r,key:i.display_name,voiceStatusMode:i,onShowModal:u})):e.jsx("div",{role:"progressbar","aria-valuetext":c.formatMessage({defaultMessage:"Loading voice modes",id:"voiceModeButton.loadingModes"}),"aria-busy":"true","aria-live":"assertive","aria-valuemin":0,"aria-valuemax":100,children:e.jsx(de,{"aria-hidden":"true",className:"my-4 min-w-full"})})}),e.jsx(v.Modal,{conversationId:r.conversationId,disabledModeMetadata:o,isOpen:n,onClose:l})]})}v.Modal=function(t){const n=t.disabledModeMetadata?.buttons??[],a=$e({buttons:n,conversationId:t.conversationId,onClick:t.onClose}),o=e.jsx(Ve,{children:t.disabledModeMetadata?.description_markdown});return e.jsx(Re,{testId:"modal-voice-mode",title:t.disabledModeMetadata?.title,description:o,isOpen:t.isOpen,onClose:t.onClose,type:"success",primaryButton:a.primary,secondaryButton:a.secondary})};v.Trigger=d.forwardRef(function(t,n){const a=h(o=>o.voiceMode);return e.jsxs(We,{ref:n,...t,children:[ot(a)??e.jsx(de,{}),e.jsx(Ee,{className:"icon-md text-token-text-tertiary"})]})});v.Item=function({conversationId:t,parentMessageId:n,voiceStatusMode:a,onShowModal:o}){const{disabled_mode_metadata:s,mode:u}=a,{startVoiceMode:c}=Fe(),l=ie(t),i=d.useCallback(async()=>{s?o(s.disabled_message):c(He({serverThreadId:l,parentMessageId:n,isAdvancedMode:u==="advanced"&&!s,eventSource:"voice_mode_picker",clientThreadId:t,gizmoId:ue.getGizmoId(ce(t))}))},[t,s,u,o,n,l,c]);return e.jsx(Le.Item,{onClick:i,children:e.jsxs("div",{children:[a.display_name,e.jsx("div",{className:"text-token-text-tertiary text-xs",children:a.description})]})})};function _t({conversationId:r}){const t=h(n=>n.voiceSessionId);return e.jsx("div",{className:"relative h-full",children:e.jsx(j.div,{className:"border-s-token-sidebar-surface-secondary bg-token-main-surface-secondary absolute hidden h-full max-w-[500px] overflow-y-hidden rounded-xl border-s pt-4 shadow-inner md:block",initial:{opacity:0,x:520,width:"0px"},animate:{opacity:1,x:0,width:"500px",left:"-520px"},exit:{opacity:0,x:520,width:"0px",left:"0px"},transition:{type:"tween"},children:e.jsx(L,{children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(it,{conversationId:r})}),e.jsx("div",{className:"p-4 py-2 text-sm",children:e.jsx(m,{name:"Voice Session ID",text:t??"n/a"})}),e.jsxs("div",{className:"flex h-full w-full flex-col flex-nowrap gap-4",children:[e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-col flex-nowrap gap-4",children:[e.jsx(ut,{}),e.jsx(dt,{})]})}),e.jsx(ct,{})]})]})})})})}function ut(){const[r,t]=d.useState("timestamp"),[n,a]=d.useState("asc"),o=h(i=>i.server.messages.filter(x=>x.type===Pe.Performance)),s=o[o.length-1],u=d.useCallback(i=>i>=1e3?`${(i/1e3).toFixed(2)}s`:`${i.toFixed(1)}ms`,[]),c=d.useMemo(()=>s?[...s.payload.metrics].sort((i,x)=>{const p=r==="name"?i.name.localeCompare(x.name):i.ms-x.ms;return n==="asc"?p:-p}):[],[s,r,n]);if(!s)return null;const l=i=>{i===r?a(n==="asc"?"desc":"asc"):(t(i),a("asc"))};return e.jsx(le,{title:"Performance",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(E,{text:"Metric"}),r==="name"?n==="asc"?e.jsx(W,{}):e.jsx(y,{}):null]}),e.jsxs("div",{className:"flex cursor-pointer flex-row items-center",onClick:()=>l("timestamp"),children:[e.jsx(E,{text:"Timestamp"}),r==="timestamp"?n==="asc"?e.jsx(W,{}):e.jsx(y,{}):null]}),c.map(i=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:i.name},i.name),e.jsx("span",{className:"bg-token-main-surface-tertiary line-clamp-1 rounded-lg p-0.5 px-1 font-mono text-xs",children:u(i.ms)},i.name+i.ms)]}))]})})}function ct(){const r=h(t=>t.server.messages);return e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-token-text-secondary px-4 py-2 text-lg font-semibold",children:"Messages"}),e.jsx("div",{className:"grow overflow-hidden",children:e.jsx(Oe,{children:e.jsx(j.ul,{className:"pointer-events-none flex w-full flex-col gap-4 pt-4 pb-24",initial:"initial",animate:"animate",exit:"exit",variants:xe,transition:{delayChildren:.25,staggerChildren:.05},children:r.map((t,n)=>e.jsx(xt,{index:n,message:t},n))})})})]})}function dt(){const r=h(c=>c.server.connectionState),t=h(c=>c.dev.room),[n,a]=d.useState("Unknown"),o=t?.localParticipant,s=t?.numParticipants??"Unknown",u=t?.activeSpeakers??[];return d.useEffect(()=>{if(o){const c=l=>{a(l)};return o.on("connectionQualityChanged",c),()=>{o.off("connectionQualityChanged",c)}}},[o]),e.jsxs(le,{title:"Room",open:!1,children:[e.jsx(m,{name:"Connection Quality",text:String(n)}),e.jsx(m,{name:"Connection State",text:String(r)}),e.jsx(m,{name:"Participants",text:s}),e.jsx(m,{name:"Speakers",text:u.length}),e.jsx(lt,{})]})}function lt(){const r=h(x=>x.dev.room),[t,n]=d.useState(null),[a,o]=d.useState(null),[s,u]=d.useState(null),c=r?.getActiveDevice("audioinput"),l=r?.getActiveDevice("audiooutput"),i=r?.getActiveDevice("videoinput");return d.useEffect(()=>{async function x(){const p=await k.getLocalDevices("audioinput"),S=await k.getLocalDevices("audiooutput"),b=await k.getLocalDevices("videoinput"),C=p.find(f=>f.deviceId===c),w=S.find(f=>f.deviceId===l),M=b.find(f=>f.deviceId===i);n(C?.label??"Unknown"),o(w?.label??"Unknown"),u(M?.label??null)}x()},[c,l,i]),e.jsxs(e.Fragment,{children:[e.jsx(E,{text:"Devices"}),s?e.jsx(m,{icon:Te,name:"Video Input",text:s}):null,e.jsx(m,{icon:Be,name:"Audio Input",text:t??"Unknown"}),e.jsx(m,{icon:Ge,name:"Audio Output",text:a??"Unknown"})]})}function le({title:r,titleClassName:t,children:n,open:a}){const[o,s]=d.useState(a??!0);return e.jsxs("div",{children:[e.jsxs("h3",{className:Ne("text-token-text-secondary flex cursor-pointer items-center py-2 text-lg font-semibold",t),onClick:()=>s(!o),children:[e.jsx("span",{children:r}),e.jsx("span",{className:"ms-2",children:o?e.jsx(y,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx(L,{initial:!1,children:o&&e.jsx(j.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{height:"auto",opacity:1},collapsed:{height:0,opacity:0}},transition:{duration:.3,ease:"easeInOut"},layout:!0,children:n},"content")})]})}function E({text:r}){return e.jsx("h4",{className:"py-2 text-sm font-semibold",children:r})}function m(r){return e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:[e.jsx("span",{className:"opacity-85",children:r.icon?e.jsx(r.icon,{className:"h-[0.75rem] w-[0.75rem]"}):e.jsxs("span",{className:"text-sm",children:[r.name,":"]})}),r.content??e.jsx("span",{className:"bg-token-main-surface-tertiary line-clamp-1 rounded-lg p-0.5 px-1 font-mono text-xs",children:r.text})]})}function xt({index:r,message:t}){const[n,a]=d.useState(!1),o=ae();let s=null;switch(t.source){case"remote":s=Ze;break;case"local":s=ze;break}return e.jsx(j.div,{className:"border-token-main-surface-tertiary w-full border-t p-4",variants:xe,children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex w-full flex-col gap-2 rounded-lg",children:[e.jsxs("div",{className:"text-token-text-secondary font-mono text-[0.65rem] font-semibold",children:[e.jsxs("div",{className:"flex w-full flex-row flex-nowrap items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-1",children:[e.jsx(s,{className:"text-token-text-secondary h-3 w-3"}),e.jsx("span",{children:` | ${r+1} | ${o.formatDate(t.timestamp,{hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:2})}`})]}),e.jsx("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:e.jsx(Ie,{className:"rounded-full p-0.5",color:"ghost",size:"small",onClick:()=>a(u=>!u),children:e.jsx(y,{className:`transform transition-transform ${n?"rotate-180":""}`})})})]}),e.jsx("div",{className:"mt-1 text-xs font-bold",children:t.type})]}),e.jsx(L,{children:n?e.jsx(j.pre,{initial:{opacity:0,transform:"blur(4px)"},animate:{opacity:1,transform:"blur(0px)"},exit:{opacity:0,transform:"blur(4px)"},className:"bg-token-main-surface-tertiary text-token-text-secondary overflow-x-auto rounded-md p-2 text-xs",children:JSON.stringify(t.payload,null,2)}):null})]})})}const xe={hidden:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100}};export{_t as VoiceModeDevPanel};
//# sourceMappingURL=e80g7nf9evrbnem6.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gfex7240qlmgxew5.js","assets/n3epq09dut36rmi2.js","assets/uox23aig6gp6se2y.js","assets/nqrmgk5te3uzwsyz.js","assets/root-nu0t8wee.css","assets/conversation-small-cqkvcue6.css","assets/jsnptf63edu6k32a.js","assets/dnyjnsewv99rujtf.js","assets/e4sjbad9hyqt73xe.js","assets/dkr8jkx9n88ez7ho.js","assets/nnldvg4yjd3ynnqu.js","assets/hk3emygtpn0flzgl.js","assets/nm5ivxaismwgb6gf.js","assets/jit20xrzecwhc2dk.js","assets/hi5bz78ars1jrvhf.js"])))=>i.map(i=>d[i]);
import{X as F,_ as B,g as $,ae as _,af as K,cT as Q,be as r,fX as Y,c2 as W,aj as k,bf as E,p as D,aO as Z,cc as J,as as ee,ag as te}from"./nqrmgk5te3uzwsyz.js";import{r as n,f as A,j as a}from"./n3epq09dut36rmi2.js";import{V as se,W as ae,X as oe,Y as ne,Z as re,$ as ie,a0 as le,a1 as ue,a2 as de,a3 as ce,a4 as w,a5 as fe,a6 as me,a7 as ge,a8 as pe,a9 as N,aa as ye,ab as he,ac as Se,ad as xe,ae as Ee,af as b,ag as Ce}from"./uox23aig6gp6se2y.js";import{G as Re}from"./hk3emygtpn0flzgl.js";const P=F(()=>B(()=>import("./gfex7240qlmgxew5.js").then(e=>e.l),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(e=>e.GizmoConversationOptionsDropdown)),Te=new Date(2024,9,11,0);function Ie(e){Z.checkGate("3922476776")||J.abortAllRequests(),k.logEvent("Load Thread",{threadId:e})}function ke({conversation:e,onOpenChange:l,testId:m,inMainScreen:t=!1,isActiveConversation:g}){const p=A(),{isUnauthenticated:y}=ee();return y?null:a.jsx(P,{conversation:e,onOpenChange:l,inMainScreen:t,isActiveConversation:g,children:a.jsx("button",{className:"text-token-text-secondary hover:text-token-text-primary radix-state-open:text-token-text-secondary flex items-center justify-center transition","data-testid":m,"aria-label":p.formatMessage({id:"idEcXk",defaultMessage:"Open conversation options"}),children:a.jsx(N,{className:"icon-md"})})})}const Ae=n.memo(je);function je({conversation:e,className:l,hideOverflowMenu:m=!1,isActive:t,elementRef:g,testId:p}){"use forget";const y=A(),z=$(),[i,h]=n.useState(!1),{value:C}=_("3922476776"),{value:u}=_("232791851"),M=se(e.id),{value:o=null,source:S=null}=M??{},L=K(e.id,te.getRequestId),d=Q(L),U=ae(new Date,new Date(e.update_time??0))<oe(ne.Standard),R=re(e.id),v=e.update_time&&ie(new Date(e.update_time),Te),T=(o===r.STREAMING||o===r.REALTIME)&&U,O=u&&!t&&!d&&v&&o===r.UNREAD,I=u&&!t&&(d||T),q=u&&!t,G=!I&&u&&!t&&(d||T),H=le(e.id)&&!t,x=n.useRef(!1);n.useEffect(()=>{x.current||C&&(async()=>(x.current=!0,t&&o===r.UNREAD&&(S===E.SERVER&&await D.setConversationStatus(e.id),b(e.id,null)),!t&&S===E.CLIENT&&o===r.UNREAD&&(await D.setConversationStatus(e.id,o),b(e.id,{value:r.UNREAD,source:E.SERVER})),x.current=!1))()},[C,t,e.id,o,S,d]),n.useEffect(()=>Y(Re,{editTitle:({serverThreadId:s})=>{(s?s===e.id:t)&&h(!0)}}),[e.id,t]);const X=W(()=>e.conversation_template_id==null?void 0:Ce(z)().data?.gizmos.find(c=>c.resource.gizmo.id===e.conversation_template_id)?.resource),j=n.useRef(null),V=n.useRef(null);return a.jsxs(ue,{draggable:!i&&w(e.gizmo_id),onDragStart:s=>{if(!w(e.gizmo_id))return;const c=s.currentTarget,f=j.current;f&&(f.style.display="none"),c.style.opacity="0.99",f&&requestAnimationFrame(()=>{f.style.display="",c.style.opacity="0"}),s.dataTransfer.effectAllowed="move",Ee({kind:"conversation",conversation:e,gizmoId:e.gizmo_id})},onDragEnd:s=>{s.currentTarget.style.opacity="",xe()},ref:ce(g,V),active:t,className:l,to:de(e.id,X),onClick:s=>{s.metaKey||s.ctrlKey||!t&&!s.defaultPrevented&&Ie(e.id)},onDoubleClick:()=>{h(!0)},trailing:!t&&!i&&(O?a.jsx("div",{className:"flex w-[18px] justify-center",children:a.jsx(ye,{color:"blue"})}):q&&R.length>0?a.jsx("div",{className:"flex w-[18px] justify-center",children:a.jsx(he,{task:R[0]})}):I?a.jsx("div",{className:"flex w-[18px] justify-center",children:a.jsx(Se,{size:16,className:"text-token-text-primary"})}):null),highlightTrailing:!m&&!i&&a.jsx(P,{conversation:e,isActiveConversation:t,onOpenChange:s=>{s&&k.logEvent("Conversation History Item Open Menu",{conversationId:e.id})},children:a.jsx(pe,{ref:j,"data-testid":`${p}-options`,"aria-label":y.formatMessage({id:"idEcXk",defaultMessage:"Open conversation options"}),icon:N})}),label:!i&&a.jsx(ge,{clientThreadId:e.id,historyConversationResponse:e,shouldShowLoadingShimmer:G}),children:[H&&a.jsx(fe,{threadId:e.id}),i&&a.jsx(me,{conversationId:e.id,historyConversationResponse:e,onClose:()=>{h(!1)}})]})}export{ke as G,Ae as H};
//# sourceMappingURL=h446s733avqwi4v2.js.map

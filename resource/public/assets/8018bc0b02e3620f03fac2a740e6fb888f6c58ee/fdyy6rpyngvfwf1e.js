import{r as f,j as p,f as T}from"./n3epq09dut36rmi2.js";import{bL as d,c4 as g,c5 as l,ae as M,cf as C}from"./nqrmgk5te3uzwsyz.js";import{CoTChunks as x}from"./bmuv64etdg91ex6w.js";import{C as u}from"./m60ckkzn7rurnxvk.js";import"./xdtirbwvvk4sqc30.js";import"./uox23aig6gp6se2y.js";import"./ml4w4c9lsfl3hdys.js";import"./iwi9e9tak1je4ys9.js";import"./e4sjbad9hyqt73xe.js";import"./dkr8jkx9n88ez7ho.js";import"./nnldvg4yjd3ynnqu.js";import"./732ktrbtyfqle46e.js";import"./dnyjnsewv99rujtf.js";import"./loybro28dk8o1rh8.js";import"./mwmzy5d3s65b6nqi.js";import"./eirgecln9yzcy5p4.js";import"./izzltcwrbklvvt51.js";import"./oshe56yhea4czc03.js";import"./azqvry2z7sssyjfm.js";import"./ipklaqcgu1ejshk6.js";import"./bns64zud9fwchaft.js";import"./lw3nae8q1eor1tu0.js";import"./kth8b95xbvmuu5bx.js";import"./iiunoc4k1n6g4a9l.js";import"./kvhuqs0v8em60vy1.js";import"./mmgogcu21wjwfuju.js";import"./oco3z5r1wfatkk2z.js";import"./i29w7batiy3i4iov.js";const _=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),s=t%60;return`${n}m ${s}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},k=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},y=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:_(e,n)}):d(t)?.metadata?.finished_text??"",E=(e,t,n=!1)=>{const s=[];let o={type:u.Thought,thought:{summary:"",content:""}};const i=()=>{o.thought.content.trim()&&(s.push(o),o={type:u.Thought,thought:{summary:o.thought.summary,content:""}})},a=e.split(/( {2}\n)|(\n\n)/).filter(m=>m!=null&&m.trim());if(!n&&a.length<2)return s;let c=!1;for(let m=0;m<a.length;m++){const r=a[m].trim();if(r.toLowerCase()==="none"){g.count(l.COT_SUMMARIZER,"num_none_chunks");continue}const h=r.match(/^\*\*(.*)\*\*$/);if(h)i(),o.thought.summary=h[1]??"";else if(r){if(r.startsWith("```")){if(c){o.thought.content+=o.thought.content?`
${r}`:r,i(),c=!1;continue}i(),c=!0}o.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!c&&i(),o.thought.content+=o.thought.content?`
${r}`:r}}return o?.thought.content.trim()&&s.push(o),n&&t&&s.push({type:u.Recap,content:t}),s},R=(e,t,n)=>{const s=!n,o=f.useMemo(()=>E(e,t,s),[e,t,s]);return f.useEffect(()=>{s&&g.hist(l.COT_SUMMARIZER,"num_cot_chunks",void 0,o.length)},[s]),o},I=({isStreaming:e,finishedText:t,summaryText:n})=>{const s=R(n,t,e);return p.jsx(x,{isStreaming:e,chunks:s})},N=8,O=`

`,nt=({messages:e,isStreaming:t})=>{const n=T(),{value:s}=M("1214379119"),o=k(e);let i="";return e.forEach(a=>{const c=C(a);i+=i?O+c:c}),s&&!t&&!i&&o<N?null:p.jsx(I,{finishedText:y(n,e,o),summaryText:i,isStreaming:t})};export{I as LegacyCoT,nt as LegacyCoTMessage};
//# sourceMappingURL=fdyy6rpyngvfwf1e.js.map

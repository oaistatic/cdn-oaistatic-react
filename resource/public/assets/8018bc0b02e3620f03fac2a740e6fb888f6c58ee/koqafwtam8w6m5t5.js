const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/f54oal9stfdagonu.js","assets/nqrmgk5te3uzwsyz.js","assets/n3epq09dut36rmi2.js","assets/root-nu0t8wee.css","assets/e4sjbad9hyqt73xe.js","assets/uox23aig6gp6se2y.js","assets/conversation-small-cqkvcue6.css","assets/dkr8jkx9n88ez7ho.js","assets/nnldvg4yjd3ynnqu.js","assets/dnyjnsewv99rujtf.js","assets/jvs80tn6co0ttzp0.js","assets/ga29rzv9pwswyv07.js","assets/d588ndwa76k83w2v.js","assets/jit20xrzecwhc2dk.js","assets/hi5bz78ars1jrvhf.js","assets/jsnptf63edu6k32a.js","assets/c1itczlqrzelhws9.js","assets/eirgecln9yzcy5p4.js","assets/izzltcwrbklvvt51.js","assets/i1gy5x3o7l2ezmdz.js","assets/m142gq95svb5klgv.js","assets/he8nwqvd8i1qrsxh.js","assets/hk3emygtpn0flzgl.js","assets/nm5ivxaismwgb6gf.js","assets/nonl1vc40q9bndh8.js","assets/oshe56yhea4czc03.js","assets/fqlc6cxqy4xl9ika.js","assets/hg9sd8r31mlqtsqh.js","assets/7h5hwpux622xuq2c.js","assets/bbcif2lk98lbzebt.js","assets/w7zwb8sma3e0efwq.js","assets/mmgogcu21wjwfuju.js","assets/fqvuwqhm1o3m6xxr.js","assets/dga4w4fj85z63yhg.js","assets/gfex7240qlmgxew5.js","assets/h446s733avqwi4v2.js","assets/mdvozkxry38nfk32.js","assets/izxna8u6mo9guqnq.js","assets/e3jbhlk6nvddhkdz.js","assets/kvhuqs0v8em60vy1.js","assets/iiunoc4k1n6g4a9l.js","assets/ljuezj190v37napq.js","assets/ex4mh6ngabphh37h.js","assets/gbfmb6n7vmtt0mld.js","assets/iwi9e9tak1je4ys9.js","assets/esr5i8s9ua5dxz6k.js","assets/hrpd314ew2hye39j.js","assets/g4tl5lt9yqf20m4s.js"])))=>i.map(i=>d[i]);
import{aO as V,aj as Y,dK as ae,dk as oe,X as N,_ as F,df as U,bc as O,m as X,as as ie,cs as A,W as re,fz as B,b as J,gP as ne,bE as le,gQ as de,gR as ce,cS as G,gS as ue,eC as me,e_ as H,g as fe,t as pe,fX as ge,aX as he,aL as xe,cn as ve}from"./nqrmgk5te3uzwsyz.js";import{r,j as e,a6 as $,d as D,a as Z,f as E,a5 as _,h as K,p as je}from"./n3epq09dut36rmi2.js";import{kr as ke,ks as ee,kt as be,ku as ye,kv as we,kw as Q,dd as Ce,dj as Ie,di as q,dk as Pe,eb as _e,gR as Ee,kx as Me,bW as Te,bX as Se,bY as Re,bp as z,ky as Ne,ey as Fe,P as Ae,kz as Oe,hP as ze,dr as L,ds as W,kA as Le,bc as Ve,bd as De,kB as Ue,kC as Be,kD as Ge,kE as He,kF as Ke,kG as Qe,bL as qe,kH as We,kI as Ye,kJ as Xe,fc as Je,kK as $e,F as Ze,kL as et,T as tt,kM as st,kN as at,kO as ot,kP as it,kQ as rt,kR as nt}from"./uox23aig6gp6se2y.js";import{c as lt,b as dt}from"./he8nwqvd8i1qrsxh.js";import{B as ct}from"./dga4w4fj85z63yhg.js";import{u as ut,d as mt}from"./gfex7240qlmgxew5.js";import{a as ft,b as pt,c as gt}from"./fqlc6cxqy4xl9ika.js";import{e as ht,C as xt,a as vt}from"./dnyjnsewv99rujtf.js";import{a as jt}from"./hi5bz78ars1jrvhf.js";import{C as kt}from"./mdvozkxry38nfk32.js";import{M as bt}from"./ljuezj190v37napq.js";import{K as yt}from"./esr5i8s9ua5dxz6k.js";function wt({clientThreadId:t}){const s=ke(i=>i.notifications),a=r.useRef(new Set);return r.useEffect(()=>{s.filter(o=>o.clientThreadId===void 0||t===o.clientThreadId).map(o=>o.id).filter(o=>o!==void 0).forEach(o=>ee(o)),s.forEach(o=>{o.id&&!a.current.has(o.id)&&(V.logEvent("chatgpt_notification_shown"),Y.logEvent("Notifications: Notification Shown to User"),a.current.add(o.id))})},[t,s]),s.length===0||ae?null:e.jsx("div",{className:"pointer-events-auto fixed end-4 top-8 z-100 my-2 flex max-h-[90vh] flex-col-reverse space-y-2 space-y-reverse overflow-y-auto px-2 py-4",children:e.jsx($,{children:s.map(i=>e.jsx(It,{...i},i.id))})})}function Ct({notification:t}){return t.icon?e.jsx(ye,{size:"medium",className:"border-token-secondary bg-token-main-surface-primary text-token-text-primary rounded-full border",IconComponent:t.icon}):e.jsx(we,{iconName:"openai",size:"medium",className:"border-token-secondary bg-token-main-surface-primary text-token-text-primary rounded-full border"})}function It({...t}){const s=D(),a=Z(),i=E(),o=oe(t.clientThreadId),c=()=>{V.logEvent("chatgpt_notification_clicked"),Y.logEvent("Notifications: User Clicked Notification"),t.onClick!=null?t.onClick():o&&be(s,a,o),t.id&&ee(t.id)};return e.jsxs(_.div,{onClick:c,className:"border-token-border-default bg-token-main-surface-primary z-100 inline-flex w-80 cursor-pointer items-center justify-start gap-2.5 rounded-2xl border px-3 py-3 align-middle shadow-lg",initial:{opacity:0,x:320},animate:{opacity:1,x:0},exit:{opacity:0,x:320},transition:{duration:.5},children:[e.jsx(Ct,{notification:t}),e.jsxs("div",{className:"inline-flex w-full shrink grow basis-0 flex-col items-start justify-start overflow-hidden",children:[e.jsx("div",{className:"text-token-text-primary w-full truncate text-sm font-medium",children:t.title??i.formatMessage({id:"mpXAeu",defaultMessage:"New chat"})}),t.subtitle&&e.jsx("div",{className:"text-token-text-tertiary w-full truncate text-sm",children:t.subtitle}),t.payload?.display_image_url&&e.jsx("img",{className:"mt-2 h-12 w-12 rounded-xs",src:t.payload.display_image_url,alt:t.payload.image_alt})]})]})}const Pt=N(async()=>F(()=>import("./f54oal9stfdagonu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28])).then(t=>t.ImageGenNewEditor));function _t({postWithProfile:t,clientThreadId:s,closeModal:a}){return t.post.attachments[0]?.kind==="media_generation"?e.jsx(Et,{postWithProfile:t,clientThreadId:s,closeModal:a}):t.post.attachments[0]?.kind==="message_slice"?e.jsx(Mt,{postWithProfile:t,closeModal:a}):null}function Et({postWithProfile:t,clientThreadId:s,closeModal:a}){const i=r.useRef(null),[o,c]=r.useState(!1),[h,x]=r.useState(!1),n=D(),{post:m}=t,p=m.attachments[m.attachments.length-1],M={url:p.url,content_type:U.ImageAssetPointer,asset_pointer:p.asset_pointer??Q(p.id),size_bytes:0,width:p.width,height:p.height},v=E(),g=Ce(),T=O(s),j=X(),b=r.useCallback(u=>g.getState().files.find(l=>l.tempId===u),[g]),y=p.url,w=r.useCallback(async u=>{if(i.current){const l=await i.current,f=l?b(l?.tempId):null;if(f)return f}return i.current=fetch(u).then(l=>l.blob()).then(l=>{const f=new File([l],"image.png",{type:"image/png"}),k=Ie(f);return q.uploadFile(g,k,f,Pe.Multimodal,[f.type],v,j).then(()=>{const d=b(k);return d&&d.status===_e.Ready&&d.fileId?d:null})}),i.current},[g,v,j,b]),{onRequestCompletion:C}=ht(),{isUnauthenticated:I}=ie(),S=r.useCallback(async u=>{if(!(!u.promptMessage||I)){x(!0);try{const l=await w(y);if(!l||!l.fileId||!l.fileSpec)return;const f=[{content_type:U.ImageAssetPointer,asset_pointer:Q(l.fileId),size_bytes:l.fileSpec.size,width:p.width,height:p.height},...u.promptMessage.content.content_type===A.MultimodalText||u.promptMessage.content.content_type===A.Text?u.promptMessage.content.parts:[]],k={...u,promptMessage:{...u.promptMessage,content:{content_type:A.MultimodalText,parts:f}},extraStreamParams:{...u.extraStreamParams??{},continueFromSharedPostId:m.id}};C(k),a(),q.reset(g)}catch{j.danger(v.formatMessage({id:"postReceiverModal.editImageError",defaultMessage:"Failed to edit the image"}))}finally{x(!1)}}},[p.height,p.width,w,C,g,y,a,I,v,j,m.id]),R=e.jsx(te,{post:m,setIsReportModalOpen:c,closeModal:a,additionalButtons:e.jsx(ft,{imageAsset:M,serverThreadId:T})});return e.jsxs("div",{className:"bg-token-main-surface-primary absolute start-0 end-0 top-0 bottom-0 h-full w-full",children:[e.jsx(Ee,{children:e.jsx(Pt,{image:M,isLoadingNewImage:!1,clientThreadId:s,onClose:()=>{a(),n("/",{replace:!0})},onRequestCompletion:S,editorControls:R,messageId:m.id,footer:h?e.jsx(Tt,{}):null})}),o&&e.jsx(se,{post:m,onClose:()=>c(!1)})]})}function Mt({postWithProfile:t,closeModal:s}){const[a,i]=r.useState(!1),{post:o}=t;return e.jsxs("div",{className:"bg-token-main-surface-primary absolute start-0 end-0 top-0 bottom-0 h-full w-full",children:[e.jsx(te,{post:o,setIsReportModalOpen:i,closeModal:s}),e.jsx(Me,{attachments:o.attachments,variant:"fullscreen"}),a&&e.jsx(se,{post:o,onClose:()=>i(!1)})]})}function te({post:t,setIsReportModalOpen:s,closeModal:a,additionalButtons:i}){const o=D(),c=E(),h=X(),x=r.useCallback(async()=>{if(window.confirm(c.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await J.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:t.id}}}),o("/",{replace:!0})}catch{h.danger(c.formatMessage({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post"}))}},[t.id,c,h,o]);return e.jsx(e.Fragment,{children:e.jsxs(_.div,{className:"flex h-16 w-full px-2 sm:px-4",...z,children:[e.jsx("div",{className:"flex items-center justify-self-start text-start",children:e.jsx(pt,{onClose:()=>{a(),o("/",{replace:!0})}})}),e.jsx("div",{className:"flex w-full flex-1 flex-col items-center justify-center justify-self-stretch",children:e.jsx(Ne,{areButtonsFullWidth:!0,post:t,setIsReportModalOpen:s})}),e.jsxs("div",{className:"flex items-center justify-self-end text-end",children:[t.permissions.can_delete&&e.jsx(gt,{tooltip:c.formatMessage({id:"postReceiverModal.deletePost",defaultMessage:"Delete"}),onClick:x,children:e.jsx(Fe,{})}),i]})]})})}function Tt(){const t=E();return e.jsxs(_.div,{className:"shadow-token-border-default pointer-events-none inline-flex items-center justify-center gap-1.5 self-center rounded-[16px] px-3.5 py-2 text-sm shadow-lg",transition:{duration:.3,ease:"easeInOut"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx(re,{}),e.jsx("span",{children:t.formatMessage({id:"postReceiverModal.preparingImage",defaultMessage:"Preparing image..."})})]})}function se({post:t,onClose:s}){const{data:a}=Te(B.Post),i=E(),o=Se(i,t.id,B.Post);if(a==null)return null;const c=`Report ${t.text??"Post"}`;return e.jsx(Re,{reasons:a.reasons,submitReport:o,title:c,onClose:s,header:a.header,subHeader:a.header_explanation})}function St({clientThreadId:t}){const s=ut();return e.jsxs(e.Fragment,{children:[s&&e.jsx(mt,{}),e.jsx(Rt,{clientThreadId:t})]})}function Rt({clientThreadId:t}){const s=r.useContext(jt),[a,i]=r.useState(!!s?.postWithProfile);return!s?.postWithProfile||!a?null:e.jsx(Ae,{clientThreadId:t,children:e.jsx(_t,{clientThreadId:t,postWithProfile:s.postWithProfile,closeModal:()=>i(!1)})})}const Nt=450;function Ft({children:t,clientThreadId:s,isOpen:a,onClose:i,type:o}){return e.jsx($,{children:a&&e.jsx(ne,{children:e.jsx(Oe.Provider,{value:{isEmbeddedInFocusedView:!0,type:o},children:e.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[e.jsx(_.div,{className:"bg-token-main-surface-secondary h-full w-full",...z}),e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"grow overflow-auto",children:t}),e.jsx(_.div,{className:"border-token-border-medium bg-token-main-surface-primary relative shrink-0 border-s",style:{width:Nt},...z,children:e.jsx("div",{className:"h-[100vh] pb-4",children:e.jsx(bt,{clientThreadId:s,hideHeader:!0,hideDisclaimer:!0,messagesVerticalAlign:"bottom"},s)})})]})]})})})})}const At=N(()=>F(()=>import("./bbcif2lk98lbzebt.js"),__vite__mapDeps([29,1,2,3,5,6,30,31]))),Ot=N(()=>F(()=>import("./fqvuwqhm1o3m6xxr.js"),__vite__mapDeps([32,1,2,3,5,6,21,4,7,8,33,18,13,9,14,34,15,35,22,23,26,27,28,36,37,38,39,40,41,10,11,12,16,17,19,20,24,25,42,43,44,45])).then(t=>t.ImageEditor));function zt({clientThreadId:t}){const s=ze();r.useEffect(()=>{L.close()},[t]);let a;return s?.type===W.ADAVisualization?a=e.jsx(At,{clientThreadId:t,visualization:s.visualization}):s?.type===W.Image&&(a=e.jsx(Ot,{clientThreadId:t,messageId:s.messageId,image:s.image,allImages:s.allImages},s.image.asset_pointer)),e.jsx(Ft,{clientThreadId:t,isOpen:s!=null,onClose:L.close,type:s?.type,children:a})}var Lt={};const Vt=({children:t})=>e.jsx(e.Fragment,{children:t}),Dt=N(()=>F(()=>import("./hrpd314ew2hye39j.js"),__vite__mapDeps([46,2,1,3,9,5,6,4,7,8,21,41,34,15,35,22,23,13,14,10,11,12,16,17,18,19,20,24,25,42,43,44,47])));function es(t){const{urlThreadId:s,clientThreadId:a,prefetchSearch:i}=t,o=le(),c=de(),h=K(),[x]=je(),[n,m]=r.useState(()=>{if(s!==void 0){const d=s;return ce(d)??d}return a!==void 0?a:G()});s!==void 0&&n!==s&&(O(n)===s||m(s));const p=Le(K());r.useEffect(()=>{s===void 0&&O(n)!==void 0&&m(G())},[s,n,p]);const M=Ve(De.workspaceId),{eligible:v,isLoading:g,markAsViewed:T}=Ue(),j=Be(),{eligible:b,isLoading:y,markAsViewed:w}=Ge(),C=He(),{eligible:I,isLoading:S,markAsViewed:R}=Ke(),u=Qe(),l=qe();r.useEffect(()=>{ue(!0).then(d=>{d.force_login&&l({authType:"login"}),We.initializeAndGatherData(d),me.initializeAndGatherData(d)})},[l]),r.useEffect(()=>{const d=x.get(Ye)==="true",P=x.get(Xe)==="true";P!==c&&H.setIsAnonModeEnabled(P),o!==d&&H.setIsTemporaryChatEnabled(d)},[o,c,x]),r.useEffect(()=>{h.state?.focusObject&&L.setFocusedObject(h.state.focusObject)},[h.state?.focusObject]),r.useEffect(()=>{!g&&v&&(T(),j())},[v,g,T,j]),r.useEffect(()=>{!y&&b&&(w(),C())},[b,y,w,C]),r.useEffect(()=>{!S&&I&&(R(),u())},[I,S,R,u]),lt(n);const f=Z(),k=fe();return r.useEffect(()=>{pe(k)&&V.checkGate("1661641186")&&f.fetchQuery({queryKey:["recent","images","bootstrap"],queryFn:()=>J.safeGet("/images/bootstrap",{})})},[f,k]),r.useEffect(()=>ge(ve,{completionFinished:d=>{if(d.serverThreadId!=null&&!o){const P=he(d.serverThreadId)?.mode;P?.kind===xe.GizmoInteraction&&Je.handleGizmoInteracted(f,P.gizmo_id)}}}),[o,f]),e.jsx($e.Provider,{value:null,children:e.jsxs(Ze,{children:[e.jsx(et,{clientThreadId:n,children:e.jsx(Vt,{clientThreadId:n,children:e.jsxs(tt,{clientThreadId:n,children:[e.jsxs(xt,{clientThreadId:n,children:[e.jsx(ct,{clientThreadId:n},M),e.jsx(Ut,{clientThreadId:n,setClientThreadId:m}),e.jsx(yt,{}),e.jsx(st,{}),e.jsx(at,{}),e.jsxs(vt,{clientThreadId:n,setClientThreadId:m,prefetchSearchPromises:i,children:[e.jsx(ot,{}),e.jsx(kt,{urlThreadId:s,clientThreadId:n,setClientThreadId:m}),e.jsx(St,{clientThreadId:n})]})]}),e.jsx(zt,{clientThreadId:n}),e.jsx(it,{clientThreadId:n}),e.jsx(rt,{}),e.jsx(wt,{clientThreadId:n}),e.jsx(nt,{})]})})}),!1]})})}function Ut({clientThreadId:t,setClientThreadId:s}){const{isOpen:a,isLoading:i}=dt();return!i&&a?e.jsx(Dt,{clientThreadId:t,setClientThreadId:s}):null}typeof window<"u"&&(window._g=Lt.GOKU_SERVICE);export{es as C,Nt as F};
//# sourceMappingURL=koqafwtam8w6m5t5.js.map

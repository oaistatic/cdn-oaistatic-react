import{m as I,k as O,ak as v,b3 as P,F as K,W as R,g as W,s as $,B as X,p as V,at as Q,c as Z,eq as J}from"./nqrmgk5te3uzwsyz.js";import{r as h,f as S,j as e,M as i,ad as E,g as k,u as ee,d as ae,p as se}from"./n3epq09dut36rmi2.js";import{lb as q,c7 as Y,c9 as N,lc as te,cg as G,ch as F,k7 as A,ld as ne,e as ie,dK as le,I as oe,le as re,lf as ce,ce as de,cf as ue,ci as me,bc as ge,jg as fe,bF as xe,ee as pe,l2 as he,fv as je,eF as ye,et as _,lg as Me,lh as be,bI as ve,cE as Se}from"./uox23aig6gp6se2y.js";import{a as Ne,b as we,S as Ce,c as Be}from"./i2ccgkaool247mgs.js";import{c as Te}from"./irpot9ogy9jy5tk1.js";import{T as Ie,a as _e}from"./j0l82fdum2u1g4ez.js";import{B as Le}from"./drbuyn4a08xz6e46.js";import{e as H,b as L,g as Pe,d as Ee,c as U,a as ke,A as Ae}from"./iudeu2zm1922chka.js";import"./izxna8u6mo9guqnq.js";import"./e3jbhlk6nvddhkdz.js";import"./h446s733avqwi4v2.js";import"./hk3emygtpn0flzgl.js";import"./nm5ivxaismwgb6gf.js";import"./dnyjnsewv99rujtf.js";import"./e4sjbad9hyqt73xe.js";import"./dkr8jkx9n88ez7ho.js";import"./nnldvg4yjd3ynnqu.js";import"./gfex7240qlmgxew5.js";import"./jsnptf63edu6k32a.js";import"./jit20xrzecwhc2dk.js";import"./hi5bz78ars1jrvhf.js";import"./kvhuqs0v8em60vy1.js";import"./iiunoc4k1n6g4a9l.js";import"./izzltcwrbklvvt51.js";import"./o45h287n9hcy4q5i.js";import"./nonl1vc40q9bndh8.js";import"./m5vm8n291yphqt2r.js";import"./oxqhot3r8r65famt.js";import"./dplssc7283prca44.js";import"./kxtb8uzibmzit7fz.js";import"./d588ndwa76k83w2v.js";var b=(a=>(a.FLEXIBLE="month",a.ANNUAL="year",a))(b||{});const De=Te(b);function ze({isOpen:a,onClose:t,initialTeamBillingType:s,renewalDate:l,accountId:n,billingDetails:o}){const[r,c]=h.useState(s),[d,u]=h.useState(!1),[x,g]=h.useState(!1),f=S(),p=I(),M=q(n),w=async()=>{g(!0);try{await M.mutateAsync({accountId:n,updatedPriceInterval:r==="month"?"month":"year",updatedSeats:void 0}),g(!1),p.success(f.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),u(!1),t()}catch{p.warning(f.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{g(!1)}},{flexibleBillingPlan:B,annualBillingPlan:C}=Y(o.currency),D=r==="month"?B:C,T=()=>{u(!1),c(s),t()};return e.jsx(O,{testId:"modal-teams-change-billing-schedule",type:"success",isOpen:a,onClose:T,size:"custom",className:"max-w-xl",noPadding:!0,title:d?f.formatMessage({id:"teamBilling.changeBillingScheduleConfirmTitle",defaultMessage:"Confirm changes"}):f.formatMessage({id:"teamBilling.changeBillingScheduleTitle",defaultMessage:"Change billing schedule"}),showCloseButton:!0,children:d?e.jsx(Fe,{selectedPlan:r,initialTeamBillingType:s,renewalDate:l,handleUpdate:w,isUpdating:x,selectedBillingPlan:D,onClose:T}):e.jsx(Ue,{setSelectedPlan:c,selectedPlan:r,initialTeamBillingType:s,setConfirmPage:u,renewalDate:l,flexibleBillingPlan:B,annualBillingPlan:C,onClose:T})})}function Ue({selectedPlan:a,setSelectedPlan:t,initialTeamBillingType:s,setConfirmPage:l,renewalDate:n,flexibleBillingPlan:o,annualBillingPlan:r,onClose:c}){const d=S();return e.jsxs("div",{className:"flex flex-col p-6",children:[e.jsx("div",{className:"grid grid-flow-row grid-cols-2",children:e.jsxs(G,{className:"col-span-2 grid gap-4 md:col-span-2 md:grid-cols-2",defaultValue:a,onValueChange:u=>{De(u)&&t(u)},children:[e.jsx(F,{billingType:"month",...o,selectedValue:a}),e.jsx(F,{billingType:"year",...r,selectedValue:a})]})}),e.jsx("span",{className:"text-token-text-secondary mt-5 text-sm",children:e.jsx(i,{...N.changeEffectDate,values:{date:e.jsx(E,{value:n,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[e.jsx(v,{title:d.formatMessage(N.cancel),color:"secondary",onClick:()=>c()}),e.jsx(v,{title:d.formatMessage(N.continueToPricePreview),disabled:a===s,color:"primary",onClick:()=>l(!0)})]})]})}function Fe({initialTeamBillingType:a,selectedPlan:t,renewalDate:s,handleUpdate:l,isUpdating:n,selectedBillingPlan:o,onClose:r}){const c=S();return e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:"text-sm",children:e.jsx(i,{...N.confirmPageChangeEffectDate,values:{current_plan:a==="month"?"Flexible (monthly)":"Annual",new_plan:t==="month"?"Flexible (monthly)":"Annual",date:e.jsx(E,{value:s,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 flex flex-col rounded-xl p-4",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...o.name})}),e.jsx("span",{className:"text-sm",children:e.jsx(i,{...o.cost,values:{monthlyCost:o.monthlyCost,discountedMonthlyCost:o.discountedMonthlyCost,currencyCode:c.formatMessage(o.currencyCode),currencySign:c.formatMessage(o.currencySign),s:(...d)=>e.jsx(te,{children:d})}})}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...o.costStructure})})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(v,{title:c.formatMessage(N.cancel),color:"secondary",onClick:r}),e.jsx(v,{title:c.formatMessage(N.confirmChange),color:"primary",onClick:l,loading:n})]})]})}const Oe="https://q.surveysapp.org/jfe/form/SV_9vIX2bUyeLKgCZo";function Re({isOpen:a,onClose:t}){const s=S(),l=I(),{data:n,isLoading:o}=A(),r=P(),c=ne(r?.id),d=ie(),[u,x]=h.useState(""),[g,f]=h.useState(!1),p=d?.email&&u.toLowerCase()==d.email.toLowerCase(),[M,w]=h.useState(n&&!n.will_renew);if(o||!r||!n)return null;const B=async()=>{f(!0);try{await c.mutateAsync(r.id),w(!0),window.open(`${Oe}?user_id=${d?.id}&account_id=${r.id}&plan_type=${n.plan_type}`,"_blank")}catch{l.warning(s.formatMessage(j.errorCancellingSubscription),{hasCloseButton:!0})}finally{f(!1)}};return e.jsx(O,{testId:"modal-cancel-team-plan",type:"success",onClose:t,showCloseButton:!0,isOpen:a,className:"",title:e.jsx("span",{className:"text-lg",children:e.jsx(i,{...j.cancelPlan})}),children:M?e.jsxs("div",{children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...j.successfullyCanceled})}),n.active_until!=null&&e.jsx("p",{className:"text-token-text-primary text-sm",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(n.active_until)}})}),e.jsx("div",{className:"mt-6 flex w-full flex-row justify-end",children:e.jsx(v,{title:s.formatMessage(j.doneButton),color:"primary",onClick:t,disabled:g})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(le,{src:r.data.profilePictureUrl,size:"large"}),e.jsxs("div",{className:"flex-col",children:[e.jsx("p",{className:"font-semibold",children:r.data.name}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...j.membersCount,values:{count:n.seats_entitled}})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...j.areYouSure})}),e.jsxs("ul",{className:"text-token-text-secondary list-disc ps-5 text-sm",children:[e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.dataUnavailable})}),n.active_until!=null&&e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(n.active_until)}})}),e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainEmailAccess})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...j.enterEmailToConfirm})}),e.jsx(oe,{ariaLabel:s.formatMessage(j.enterEmailToConfirm),type:"text",name:"user-email",placeholder:"abcd@acme.com",onChange:C=>{x(C.target.value)}})]})]}),e.jsxs("div",{className:"mt-6 flex w-full flex-row justify-end",children:[e.jsx(v,{title:s.formatMessage(j.keepSubscriptionButton),onClick:t,disabled:g}),e.jsx(v,{title:s.formatMessage(j.cancelSubscriptionButton),onClick:B,disabled:!p,loading:g,color:"danger",className:"ms-2"})]})]})})}const j=k({dataUnavailable:{id:"cancelTeamPlanModal.dataUnavailable",defaultMessage:"All workspace data including chat history and settings will not be available."},cancelPlan:{id:"cancelTeamPlanModal.cancelPlan",defaultMessage:"Cancel subscription"},retainUntil:{id:"cancelTeamPlanModal.retainUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},retainEmailAccess:{id:"cancelTeamPlanModal.retainEmailAccess",defaultMessage:"You will still be able to use ChatGPT with the other workspaces associated with this email address."},errorCancellingSubscription:{id:"cancelTeamPlanModal.errorCancellingSubscription",defaultMessage:"There was a problem cancelling your subscription."},areYouSure:{id:"cancelTeamPlanModal.areYouSure",defaultMessage:"Are you sure?"},enterEmailToConfirm:{id:"cancelTeamPlanModal.enterEmailToConfirm",defaultMessage:"Enter your Email address to confirm"},emailPlaceholder:{id:"cancelTeamPlanModal.emailPlaceholder",defaultMessage:"abcd@acme.com"},doneButton:{id:"cancelTeamPlanModal.doneButton",defaultMessage:"Done"},keepSubscriptionButton:{id:"cancelTeamPlanModal.keepSubscriptionButton",defaultMessage:"Keep subscription"},cancelSubscriptionButton:{id:"cancelTeamPlanModal.cancelSubscriptionButton",defaultMessage:"Cancel subscription"},successfullyCanceled:{id:"cancelTeamPlanModal.successfullyCanceled",defaultMessage:"You have successfully canceled your subscription."},membersCount:{id:"yourComponent.membersCount",defaultMessage:"{count, plural, one {# member} other {# members}}"}}),We=K.p`text-base font-semibold mb-3 mt-3`;function $e({isOpen:a,onClose:t,initialTeamBillingType:s,initialSeats:l,accountId:n,renewalDate:o,billingDetails:r}){const c=S(),d=I(),[u,x]=h.useState(l),[g,f]=h.useState(!1),[p,M]=h.useState(!1),{flexibleBillingPlan:w,annualBillingPlan:B}=Y(r.currency),C=s===re.FLEXIBLE?w:B,D=q(n),T=async()=>{M(!0);try{await D.mutateAsync({accountId:n,updatedPriceInterval:void 0,updatedSeats:u}),M(!1),d.success(c.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),f(!1),t()}catch{d.warning(c.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{M(!1)}},z=()=>{f(!1),x(l),t()};return e.jsx(O,{testId:"modal-teams-manage-seats",type:"success",isOpen:a,onClose:z,size:"custom",noPadding:!0,className:"max-w-2xl",showCloseButton:!0,title:g?c.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):c.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:g?e.jsx(He,{numSeats:u,initialSeats:l,handleUpdate:T,isUpdating:p,renewalDate:o,accountId:n,selectedPlanBillingInfo:C,onClose:z}):e.jsx(Ye,{selectedPlan:s,selectedPlanBillingInfo:C,numSeats:u,initialSeats:l,setNumSeats:x,renewalDate:o,setConfirmPage:f,billingDetails:r})})}function Ye({selectedPlan:a,selectedPlanBillingInfo:t,numSeats:s,initialSeats:l,setNumSeats:n,setConfirmPage:o,billingDetails:r,renewalDate:c}){const d=S(),u=de(isNaN(s)?0:s,l,ue);return e.jsxs("div",{className:"grid grid-flow-row grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-5",children:[e.jsx(me,{numSeats:s,minSeats:l,setNumSeats:n}),e.jsx(G,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:a,children:e.jsx(F,{billingType:a,...t,selectedValue:a})})]}),e.jsxs("div",{className:"border-token-main-surface-tertiary bg-token-main-surface-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(We,{children:e.jsx(i,{...N.summaryTitle})}),e.jsx(Le,{numSeats:u,selectedPlan:a,billingDetails:r,totalLabel:N.allPlansTotal,billDate:e.jsx(E,{value:c,year:"numeric",month:"long",day:"numeric"})}),e.jsx(v,{title:d.formatMessage(y.continue),disabled:u===l,onClick:()=>o(!0),className:"w-full rounded-xl",color:"primary"})]})]})}function He({numSeats:a,initialSeats:t,renewalDate:s,handleUpdate:l,isUpdating:n,accountId:o,selectedPlanBillingInfo:r,onClose:c}){const d=S(),{data:u,isError:x,isLoading:g}=ce(o,a);if(g)return e.jsx("div",{className:"flex items-center justify-center py-32",children:e.jsx(R,{})});if(!(x||!u))return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.additionalSeats,values:{additionalSeats:a-t}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.additionalSeatsTotal,values:{currencySign:d.formatMessage(r.currencySign),totalCost:(u.total_amount/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...y.proratedAmountMessage})}),e.jsx("span",{className:"bg-token-main-surface-secondary text-token-text-secondary mt-4 flex flex-col rounded-2xl p-4 text-sm",children:e.jsx(i,{...y.chargeMessage,values:{numSeats:a,date:e.jsx(E,{value:s,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.subtotal})}),e.jsx("span",{children:e.jsx(i,{...y.subtotalPrice,values:{currencySign:d.formatMessage(r.currencySign),totalCost:(u.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.tax})}),e.jsx("span",{children:e.jsx(i,{...y.taxAmount,values:{currencySign:d.formatMessage(r.currencySign),tax:(u.tax_amount/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.totalDueToday})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...y.totalDueTodayAmount,values:{currencySign:d.formatMessage(r.currencySign),totalCost:(u.total_amount/100).toFixed(2)}})})]}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(v,{title:d.formatMessage(N.cancel),color:"secondary",onClick:c,disabled:n}),e.jsx(v,{title:d.formatMessage(y.payNow),color:"primary",onClick:l,loading:n})]})]})}const y={continue:{id:"teamsManageSeatsModal.continue",defaultMessage:"Continue",description:"Continue button for manage seats modal"},payNow:{id:"teamsManageSeatsModal.payNow",defaultMessage:"Pay now",description:"Team manage seats modal pay now button"},tax:{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax",description:"Tax label"},subtotal:{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal",description:"Subtotal label"},proratedAmountMessage:{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle",description:"Informing user that they will be charged a prorated amount today"},chargeMessage:{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}",description:"Number of additional seats being purchased"},additionalSeats:{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional {additionalSeats, plural, one {seat} other {seats}}",description:"Number of additional seats being purchased"},additionalSeatsTotal:{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"{currencySign}{totalCost}",description:"Summary total of selected plan"},subtotalPrice:{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",description:"Subtotal price for selected plan"},taxAmount:{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"{currencySign}{tax}",description:"Tax amount"},totalDueToday:{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today",description:"Total due today label"},totalDueTodayAmount:{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",description:"Total due today"}};function Xe({numInUse:a,numAllocated:t,isTeam:s,subscriptionWillRenew:l,subscriptionBillingPeriod:n,accountId:o,subscriptionRenewalDate:r,billingDetails:c}){const d=W(),u=$(d,"3954884439"),[x,g]=h.useState(!1),f=function(){g(!x)},p=n==="monthly"?b.FLEXIBLE:b.ANNUAL;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-start text-base",children:e.jsx(i,{...Ve.description,values:{num:`${a}/${t}`,bold:M=>e.jsx("span",{className:"font-medium",children:M})}})}),s&&l&&u&&e.jsx(X,{color:"secondary",onClick:f,children:e.jsx(i,{id:"components.business.NumSeats.manageSeats",defaultMessage:"Manage seats"})})]}),x&&e.jsx($e,{isOpen:!0,onClose:f,initialTeamBillingType:p,initialSeats:t,accountId:o,renewalDate:r,billingDetails:c})]})}const Ve=k({description:{defaultMessage:"<bold>{num}</bold> seats in use",id:"components.business.NumSeats.description"}});function qe(a,t){const s=S(),l=I();return ee({queryKey:["organization-invoices",{...a,options:t}],queryFn:async()=>await V.getInvoices(a,t).catch(n=>{throw l.danger(s.formatMessage(Ke.invoicesLoadError,{error:n.message})),n}),enabled:"account_id"in a||"organization_id"in a})}function Ge(a){const t=P(),s=t?.id,l=t?.data.organizationId??void 0,n=t?.isEnterprisey();return qe(n?{organization_id:l}:{account_id:s},a)}const Ke=k({invoicesLoadError:{id:"organizationBillingInfo.invoicesLoadError.0",defaultMessage:"Failed to load invoices. Contact support@openai.com if error persists."}}),Qe="https://help.openai.com/en/articles/8792536-manage-billing-on-the-chatgpt-team-subscription-plan",Ze=(a,t)=>{const s=a?.isEdu(),l=a?.isTeam(),n=a?.isResellerHosted(),o=t?.non_profit_org_discount_applied,r=t.active_until!=null;if(s)return r?m.activeEduLicense:n?m.resellerHostedEduLicense:m.pendingEduLicense;if(o)return r?m.activeTeamLicenseNonProfitOrg:m.pendingTeamLicense;if(l)return r?m.activeTeamLicense:m.pendingTeamLicense;throw Q.addError("getWorkspaceLicenseSubtitle: No license found",{subscription:t,currentAccount:a}),new Error("No license for workspace account.")};function Je(){const{data:a,isLoading:t,isError:s}=A(),l=P(),n=W();if($(n,"2861925050"),t)return e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(R,{})});if(s||!a||!l)return null;const o=a.active_until!=null,r=a?.seats_in_use>a?.seats_entitled,c=a.active_until?new Date(a.active_until):null,d=l?.isTeam(),u=a?.billing_period==="monthly"?b.FLEXIBLE:b.ANNUAL,x=Y(a.billing_currency),{discountedMonthlyCost:g,currencySign:f}=u===b.FLEXIBLE?x.flexibleBillingPlan:x.annualBillingPlan;return e.jsxs(e.Fragment,{children:[!1,d&&e.jsxs(L,{className:"border-token-border-default gap-0 rounded-xl border",children:[e.jsxs("div",{className:"flex flex-col gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(i,{...Ze(l,a)}),e.jsx("div",{className:"rounded-sm bg-[#E0FFE7] px-1.5 py-1 text-sm font-medium text-[#24622B]",children:e.jsx(i,{...u===b.FLEXIBLE?m.monthly:m.annual})})]}),c&&e.jsx(Ee,{className:"text-token-text-secondary mt-1",children:a.will_renew?e.jsx(i,{...m.renewalDate,values:{expiryDate:c}}):e.jsx(i,{...m.deactivateDate,values:{expiryDate:c}})})]}),e.jsx(ea,{})]}),!a?.non_profit_org_discount_applied&&e.jsx("div",{className:"text-token-text-secondary h-[50px] text-sm",children:e.jsx(i,{...m.pricePerSeat,values:{symbol:e.jsx(i,{...f}),amount:g,currency:p=>e.jsx("span",{className:"align-top text-xl",children:p}),price:p=>e.jsx("span",{className:"text-token-text-primary ps-[1px] pe-1 align-bottom text-[42px] leading-none",children:p})}})})]}),e.jsx("hr",{}),o&&e.jsxs("div",{className:"p-6",children:[e.jsx(ta,{isTeam:d,accountId:l.id}),d&&r&&e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...m.teamsAutochargeMessage,values:{link:p=>e.jsx(xe,{className:"ps-1",openNewTab:!0,href:Qe,children:p})}})})]})]}),!1]})}function ea(){const[a,t]=h.useState(!1),s=S(),l=I(),n=P(),{data:o}=A(),[r,c]=h.useState(!1),d=function(){c(!r)},[u,x]=h.useState(!1),g=W(),f=$(g,"1318146997");if(!n||!n.isTeam()||!o)return;const p=async()=>{t(!0);try{const w=await V.fetchCustomerPortalUrl(n?.getWorkspaceId());location.href=w.url}catch{l.warning(s.formatMessage(m.stripeErrorWarning),{hasCloseButton:!0})}finally{t(!1)}},M=o?.billing_period==="monthly"?b.FLEXIBLE:b.ANNUAL;return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{size:"default",contentAlign:"end",sideOffset:4,triggerButton:e.jsx(X,{color:"secondary",icon:ve,children:e.jsx(i,{...m.manageLicenseBtn})}),children:[e.jsx(_.Item,{icon:Ce,onClick:p,children:e.jsx(i,{...m.managePaymentMethod})}),o.will_renew&&f&&e.jsx(_.Item,{icon:Me,onClick:()=>x(!0),children:e.jsx(i,{...m.manageBillingSchedule})}),o?.will_renew&&e.jsx(_.Separator,{}),o?.will_renew&&e.jsx(_.Item,{icon:be,color:"danger",onClick:()=>{d()},children:e.jsx(i,{...m.cancelSubscriptionBtn})})]}),o.active_until!=null&&e.jsx(ze,{isOpen:u,onClose:()=>x(!1),initialTeamBillingType:M,renewalDate:new Date(o.active_until),accountId:n.id,billingDetails:{currency:o.billing_currency}}),e.jsx(Re,{isOpen:r,onClose:d})]})}function aa({invoice:a}){const t=a?.status_transitions.paid_at!=null&&new Date(a.status_transitions.paid_at*1e3),s=a&&new Date(a.due_date*1e3),l=a&&new Date(a.created*1e3);return e.jsxs(Ae,{className:"items-center",children:[e.jsxs("div",{className:"flex grow flex-col gap-1",children:[e.jsx("span",{children:l?e.jsx(i,{...m.invoiceName,values:{createdDate:l}}):e.jsx(i,{...m.defaultInvoiceName})}),a?.paid&&t!=null?e.jsx("div",{className:"text-token-text-secondary text-xs",children:e.jsx(i,{...m.paidInvoice,values:{invoiceDate:t}})}):a&&e.jsx("div",{className:"text-xs text-green-600",children:e.jsx(i,{...m.upcomingInvoice,values:{invoiceDate:s}})})]}),e.jsx("a",{href:a?.hosted_invoice_url,className:Z("mx-auto",a?.hosted_invoice_url===void 0&&"cursor-not-allowed opacity-20"),target:"_blank",rel:"noreferrer",children:e.jsx(Se,{className:"icon-sm text-green-600"})})]})}function sa(){const[a,t]=h.useState({limit:5}),{data:s,isError:l,isLoading:n}=Ge(a),o=a.startingAfter!=null||a.endingBefore!=null&&s?.has_more,r=a.endingBefore!=null||s?.has_more&&a.endingBefore==null;return n?e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(i,{...m.invoicesTitle})}),e.jsx("div",{className:"flex h-40 items-center justify-center",children:e.jsx(R,{})})]}):l||s==null?e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(i,{...m.invoicesTitle})}),e.jsx(pe,{children:e.jsx(i,{...m.noInvoices})})]}):e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(i,{...m.invoicesTitle})}),e.jsx(ke,{children:s.data.map(c=>e.jsx(aa,{invoice:c},c.id))}),e.jsxs("div",{className:"flex",children:[o&&e.jsx("button",{onClick:()=>{s&&t(c=>({...c,endingBefore:s.data[0].id,startingAfter:void 0}))},children:e.jsx(he,{className:"icon-sm"})}),e.jsx("div",{className:"grow"}),r&&e.jsx("button",{onClick:()=>{s&&t(c=>({...c,startingAfter:s.data[s.data.length-1].id,endingBefore:void 0}))},children:e.jsx(je,{className:"icon-sm"})})]})]})}function ta({isTeam:a,accountId:t}){const{data:s,isLoading:l,isError:n}=A();return n||!s||l||!s.billing_period||!s.active_until?null:e.jsx(Xe,{numInUse:s.seats_in_use,numAllocated:s.seats_entitled,isTeam:a,subscriptionWillRenew:s.will_renew,subscriptionBillingPeriod:s.billing_period,subscriptionRenewalDate:new Date(s.active_until),accountId:t,billingDetails:{currency:s.billing_currency}})}const na=a=>a==="plan"||a==="invoices";function ia(){const a=ge(u=>u.currentWorkspace),t=S(),s=ae(),l=h.useMemo(()=>[{key:"plan",label:t.formatMessage(m.planTabName),children:e.jsx(H,{children:e.jsx(Je,{})})},{key:"invoices",label:t.formatMessage(m.invoicesTabName),children:e.jsx(H,{children:e.jsx(sa,{})})}],[t]),[n]=se(),o=n.get("tab"),[r,c]=h.useState(o&&na(o)?o:l[0].key),d=u=>{c(u),s({pathname:window.location.pathname,search:new URLSearchParams({tab:u}).toString()})};return a?.organizationId?e.jsxs(e.Fragment,{children:[e.jsx(fe,{children:e.jsx("title",{children:t.formatMessage(m.adminBrowserPageTitle)})}),e.jsx(Ne,{title:t.formatMessage(m.title),subtitle:t.formatMessage(m.subtitle),tabsHeader:e.jsx(Ie,{items:l,activeTab:r,onTabChange:d})}),e.jsx(we,{children:e.jsx(_e,{items:l,activeTab:r})})]}):null}const m=k({adminBrowserPageTitle:{id:"organizationBillingInfo.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Billing"},title:{id:"organizationBillingInfo.title.1",defaultMessage:"Billing"},subtitle:{id:"organizationBillingInfo.subtitle",defaultMessage:"Only workspace owners can view and change these settings"},activeEduLicense:{id:"organizationBillingInfo.activeEduLicense",defaultMessage:"Edu License"},pendingEduLicense:{id:"organizationBillingInfo.pendingEduLicense",defaultMessage:"Edu License (pending activation)"},resellerHostedEduLicense:{id:"organizationBillingInfo.resellerHostedEduLicense",defaultMessage:"Edu License"},activeTeamLicense:{id:"organizationBillingInfo.activeTeamLicense",defaultMessage:"Team Plan"},activeTeamLicenseNonProfitOrg:{id:"organizationBillingInfo.activeTeamLicenseNonProfitOrg",defaultMessage:"Team License (Non Profit Discount)"},pendingTeamLicense:{id:"organizationBillingInfo.pendingTeamLicense",defaultMessage:"Team Plan (pending activation)"},licenseExpiry:{id:"organizationBillingInfo.licenseExpiry",defaultMessage:"Active until {expiryDate, date, long}"},renewalDate:{id:"organizationBillingInfo.renewalDate",defaultMessage:"Renews on {expiryDate, date, long}"},deactivateDate:{id:"organizationBillingInfo.deactivateDate",defaultMessage:"Deactivates on {expiryDate, date, long}"},seatsInUse:{id:"organizationBillingInfo.seatsInUse",defaultMessage:"{numSeats} in use ({numSeatsPct})"},invoicesTitle:{id:"organizationBillingInfo.invoicesTitle",defaultMessage:"Invoices"},invoiceName:{id:"organizationBillingInfo.invoiceName",defaultMessage:"Invoice: {createdDate, date, long}"},defaultInvoiceName:{id:"organizationBillingInfo.defaultInvoiceName",defaultMessage:"Invoice"},paidInvoice:{id:"organizationBillingInfo.paidInvoice",defaultMessage:"Paid: {invoiceDate, date, long}"},upcomingInvoice:{id:"organizationBillingInfo.upcomingInvoice",defaultMessage:"Due: {invoiceDate, date, long}"},noInvoices:{id:"organizationBillingInfo.noInvoices",defaultMessage:"No invoices found"},manageSubscription:{id:"organizationBillingInfo.manageSubscription",defaultMessage:"Manage subscription"},cancelSubscriptionBtn:{id:"organizationBillingInfo.cancelSubscriptionBtn",defaultMessage:"Cancel subscription"},manageLicenseBtn:{id:"organizationBillingInfo.manageLicenseBtn",defaultMessage:"Manage plan"},managePaymentMethod:{id:"organizationBillingInfo.managePaymentMethod",defaultMessage:"Payment method"},manageBillingSchedule:{id:"organizationBillingInfo.manageSchedule",defaultMessage:"Billing schedule"},stripeErrorWarning:{id:"organizationBillingInfo.stripeErrorWarning",defaultMessage:"Error loading account information"},teamsAutochargeMessage:{id:"organizationBillingInfo.teamsAutochargeMessage",defaultMessage:"Your additional seats will be included on your next invoice. <link>Learn more</link>"},planTabName:{id:"organizationBillingInfo.planTabName",defaultMessage:"Plan"},invoicesTabName:{id:"organizationBillingInfo.invoicesTabName",defaultMessage:"Invoices"},pricePerSeat:{id:"organizationBillingInfo.pricePerSeat",defaultMessage:"<currency>{symbol}</currency><price>{amount}</price>/seat"},monthly:{id:"organizationBillingInfo.monthly",defaultMessage:"Monthly"},annual:{id:"organizationBillingInfo.annual",defaultMessage:"Annual"}}),Ua=J(function(){return Be(),e.jsx(ia,{})});export{Ua as default};
//# sourceMappingURL=iaz1nlh02fj80slz.js.map

import{B as _,c as F,k as ye,d5 as ke,b as z,gX as x,c3 as O,dd as he,W as ae,p as Ne,at as be,g as Oe,ap as _e,m as re,b3 as Ae,b5 as Ge,gY as K,dM as ee,gI as Re,eq as De}from"./nqrmgk5te3uzwsyz.js";import{r as p,f as A,j as e,M as i,g as Y,a as B,a6 as Ee,a5 as Le,o as Ie,d as Fe,b as le}from"./n3epq09dut36rmi2.js";import{hq as d,ey as ie,I as Se,as as We,lL as fe,et as C,dn as ne,f as ze,eT as we,lM as Be,lN as Ue,O as He,lK as Ve,bG as S,R as qe,bF as Ke,b_ as Ye,a9 as Qe,av as Ze,lO as Je,eY as $e,lP as Xe,el as Te,jg as es,aG as ve,aq as k}from"./uox23aig6gp6se2y.js";import{a as ss,b as ts,u as as,c as is}from"./i2ccgkaool247mgs.js";import{S as ns}from"./icne8mpyunk4lpgu.js";import{g as je}from"./m5vm8n291yphqt2r.js";import{S as rs}from"./dplssc7283prca44.js";import{G as ls}from"./jsnptf63edu6k32a.js";import{S as os}from"./mhabxokutmv1419t.js";import{b as se}from"./j0l82fdum2u1g4ez.js";import{A as cs}from"./c8luebb1ao3w0kvy.js";import{V as ds}from"./d3y72ugnrmac5z1v.js";import{e as ps,a as us,b as ms,c as gs,d as xs,A as hs}from"./iudeu2zm1922chka.js";import"./izxna8u6mo9guqnq.js";import"./e3jbhlk6nvddhkdz.js";import"./h446s733avqwi4v2.js";import"./hk3emygtpn0flzgl.js";import"./nm5ivxaismwgb6gf.js";import"./dnyjnsewv99rujtf.js";import"./e4sjbad9hyqt73xe.js";import"./dkr8jkx9n88ez7ho.js";import"./nnldvg4yjd3ynnqu.js";import"./gfex7240qlmgxew5.js";import"./jit20xrzecwhc2dk.js";import"./hi5bz78ars1jrvhf.js";import"./kvhuqs0v8em60vy1.js";import"./iiunoc4k1n6g4a9l.js";import"./izzltcwrbklvvt51.js";import"./o45h287n9hcy4q5i.js";import"./nonl1vc40q9bndh8.js";import"./oxqhot3r8r65famt.js";import"./eirgecln9yzcy5p4.js";import"./b2dwdp2zgpewduyl.js";import"./lth5uuz88qwgi4it.js";import"./fs6cavqigctjak4n.js";import"./gfoysyc34lqmw43c.js";import"./ofg6pv1c2un8jq6p.js";import"./kvu2figoephb8btv.js";import"./c28qyodqgdwibcia.js";import"./m20879eh9weiczmj.js";function fs({value:t,title:s,valueClassName:a,onChange:n,emptyMessage:r}){const[l,c]=p.useState(!1),[f,h]=p.useState(""),m=A(),y=p.useRef(null),u=()=>{if(f!==""){const g=f.trim();n([...t,g]),c(!1),h("")}};return e.jsxs(d.Root,{className:"w-auto",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:s}),e.jsx(d.HeaderCell,{})]}),e.jsxs(d.Body,{children:[t.map((g,T)=>e.jsxs(d.Row,{children:[e.jsx(d.Cell,{className:a,children:g}),e.jsx(d.Cell,{textAlign:"right",children:e.jsx(_,{type:"button",onClick:()=>{n(t.filter((b,v)=>v!==T))},children:e.jsx(ie,{className:"icon-sm"})})})]},T)),r&&t.length===0?e.jsx(d.Row,{children:e.jsx(d.Cell,{colSpan:2,className:"text-center text-sm italic",children:r})}):null,e.jsxs(d.Row,{children:[e.jsxs("div",{className:F("mt-2 flex flex-row gap-2 p-1",!l&&"hidden"),children:[e.jsx(Se,{ariaLabel:m.formatMessage({id:"CgP6Du",defaultMessage:"Add new domain"}),className:"w-80",name:"newDomain",value:f,onChange:g=>{h(g.target.value)},ref:y,onPressEnter:u,placeholder:"example.com"}),e.jsx(_,{className:"grow-0",onClick:u,children:e.jsx(i,{id:"svRVol",defaultMessage:"Add"})})]}),!l&&e.jsxs(_,{type:"button",onClick:()=>{c(!0),setTimeout(()=>{y.current?.focus()},0)},className:"mt-2",children:[e.jsx(We,{className:"icon-sm inline-block"}),e.jsx(i,{id:"J5y3+M",defaultMessage:"Add new domain"})]})]})]})]})}const ws=t=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 6C3 4.34315 4.34315 3 6 3H18C19.6569 3 21 4.34315 21 6V7.11526C21 7.96049 20.6434 8.76651 20.018 9.33508L15.8273 13.1448C15.6189 13.3343 15.5 13.603 15.5 13.8847V19.882C15.5 21.3687 13.9354 22.3357 12.6056 21.6708L9.60557 20.1708C8.92801 19.832 8.5 19.1395 8.5 18.382V13.8847C8.5 13.603 8.38115 13.3343 8.17267 13.1448L3.98198 9.33508C3.35656 8.76651 3 7.96049 3 7.11526V6ZM6 5C5.44772 5 5 5.44772 5 6V7.11526C5 7.397 5.11885 7.66568 5.32733 7.8552L9.51802 11.6649C10.1434 12.2335 10.5 13.0395 10.5 13.8847V18.382L13.5 19.882V13.8847C13.5 13.0395 13.8566 12.2335 14.482 11.6649L18.6727 7.8552C18.8811 7.66568 19 7.39701 19 7.11526V6C19 5.44772 18.5523 5 18 5H6Z",fill:"currentColor"})),Ts=t=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{d:"M9.99984 3.33366C8.61913 3.33366 7.49984 4.45295 7.49984 5.83366C7.49984 7.21437 8.61913 8.33366 9.99984 8.33366C11.3805 8.33366 12.4998 7.21437 12.4998 5.83366C12.4998 4.45295 11.3805 3.33366 9.99984 3.33366ZM5.83317 5.83366C5.83317 3.53247 7.69865 1.66699 9.99984 1.66699C12.301 1.66699 14.1665 3.53247 14.1665 5.83366C14.1665 8.13485 12.301 10.0003 9.99984 10.0003C7.69865 10.0003 5.83317 8.13485 5.83317 5.83366ZM14.5832 12.0837C15.0434 12.0837 15.4165 12.4568 15.4165 12.917V13.3337H13.7498V12.917C13.7498 12.4568 14.1229 12.0837 14.5832 12.0837ZM17.0832 13.507V12.917C17.0832 11.5363 15.9639 10.417 14.5832 10.417C13.2025 10.417 12.0832 11.5363 12.0832 12.917V13.507C11.3474 13.8285 10.8332 14.5627 10.8332 15.417V17.0837C10.8332 18.2343 11.7659 19.167 12.9165 19.167H16.2498C17.4004 19.167 18.3332 18.2343 18.3332 17.0837V15.417C18.3332 14.5627 17.819 13.8285 17.0832 13.507ZM12.9165 15.0003H16.2498C16.48 15.0003 16.6665 15.1869 16.6665 15.417V17.0837C16.6665 17.3138 16.48 17.5003 16.2498 17.5003H12.9165C12.6864 17.5003 12.4998 17.3138 12.4998 17.0837V15.417C12.4998 15.1869 12.6864 15.0003 12.9165 15.0003Z",fill:"currentColor"}),p.createElement("path",{d:"M9.99347 11.6156C10.0503 12.0723 9.72606 12.4886 9.26934 12.5454C6.57824 12.88 4.58317 15.0119 4.58317 17.5003C4.58317 17.9605 4.21007 18.3336 3.74984 18.3336C3.2896 18.3336 2.9165 17.9605 2.9165 17.5003C2.9165 14.0728 5.63921 11.3173 9.06367 10.8914C9.52039 10.8346 9.93667 11.1588 9.99347 11.6156Z",fill:"currentColor"}));function js({isOpen:t,onClose:s,account:a,gpt:n}){const r=A(),[l,c]=p.useState(!1),[f,h]=p.useState(""),[m,y]=p.useState(!0),u=n.gizmo.is_unassigned;return e.jsxs(ye,{testId:"modal-change-owner",size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:ke,type:"success",title:r.formatMessage(u?E.assignModalTitle:E.changeModalTitle),children:[e.jsx("p",{className:"text-token-text-primary mb-4",children:e.jsx(i,{...E.changeModalPrompt,values:{gptName:n.gizmo.display.name}})}),!m&&e.jsx("p",{className:"text-red-500",children:e.jsx(i,{...E.invalidEmail})}),e.jsx(Se,{ariaLabel:r.formatMessage({id:"x4A5l2",defaultMessage:"Email"}),className:F("px-3 py-2",m?"":"border-red-500"),name:"email",type:"email",value:f,placeholder:"Email",onChange:g=>{h(g.target.value)}}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(_,{color:"secondary",onClick:()=>{s(!1),c(!1),y(!0)},loading:l,children:e.jsx(i,{...E.cancelButtonText})}),e.jsx(_,{color:"primary",loading:l,onClick:()=>{c(!0),y(!0),f==""||!ds.test(f)?(y(!1),c(!1)):z.safePost("/accounts/{account_id}/gpts/{gizmo_id}/owner",{parameters:{path:{account_id:a.id,gizmo_id:n.gizmo.id}},requestBody:{email:f}}).then(()=>{s(!0),c(!1),y(!0)},()=>{y(!1),c(!1)})},children:e.jsx(i,{...u?E.assignButtonText:E.changeOwnerButtonText})})]})]})}const E=Y({changeModalTitle:{id:"changeOwnerModal.changeModalTitle",defaultMessage:"Change Owner"},assignModalTitle:{id:"changeOwnerModal.assignModalTitle",defaultMessage:"Assign Owner"},changeModalPrompt:{id:"changeOwnerModal.changeModalPrompt",defaultMessage:"New owner of {gptName}"},cancelButtonText:{id:"changeOwnerModal.cancelButtonText",defaultMessage:"Cancel"},changeOwnerButtonText:{id:"changeOwnerModal.changeOwnerButtonText",defaultMessage:"Change owner"},assignButtonText:{id:"changeOwnerModal.assignButtonText",defaultMessage:"Assign"},invalidEmail:{id:"changeOwnerModal.invalidEmail",defaultMessage:"Email is invalid or does not belong to a member in this workspace"}});function ys({isOpen:t,onClose:s,account:a,gpt:n}){const r=A(),[l,c]=p.useState(!1);return e.jsxs(ye,{testId:"modal-delete-gpt",size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:ke,type:"success",title:r.formatMessage(q.deleteModalTitle),children:[e.jsx("p",{className:"text-token-text-primary mb-4",children:e.jsx(i,{...q.deleteModalPrompt,values:{gptName:n.gizmo.display.name}})}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(_,{color:"secondary",onClick:()=>{s(!1)},loading:l,children:e.jsx(i,{...q.cancelButtonText})}),e.jsx(_,{color:"danger",loading:l,onClick:()=>{c(!0),z.safeDelete("/accounts/{account_id}/gpts/{gizmo_id}",{parameters:{path:{account_id:a.id,gizmo_id:n.gizmo.id}}}).finally(()=>{s(!0),c(!1)})},children:e.jsx(i,{...q.deleteButtonText})})]})]})}const q=Y({deleteModalTitle:{id:"deleteGPTModal.accessModalTitle",defaultMessage:"Delete GPT"},deleteModalPrompt:{id:"deleteGPTModal.accessModalPrompt",defaultMessage:"Are you sure you would like to delete {gptName}? This action can not be undone."},cancelButtonText:{id:"deleteGPTModal.cancelButtonText",defaultMessage:"Cancel"},deleteButtonText:{id:"deleteGPTModal.deleteButtonText",defaultMessage:"Delete"}}),W=10;function ks({account:t,gpt:s,thirdParty:a}){const n=B(),r=Oe(),[l,c]=p.useState(!1),[f,h]=p.useState(!1),[m,y]=p.useState(!1),[u,g]=p.useState(!1),T=Fe(),b=new Date(a?s.gizmo.workspace_approval_date??"":s.gizmo.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),v=new Date(s.gizmo.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),L=p.useMemo(()=>{const P=s.tools.filter(M=>M.type===O.JIT_PLUGIN).map(M=>M.type===O.JIT_PLUGIN?M.metadata.domain:"");return P.length===1?P[0]:P.length>1?`${P.length} domains`:""},[s.tools]),G=s.gizmo.is_unassigned;return e.jsxs(e.Fragment,{children:[e.jsxs(d.Row,{className:"relative",children:[e.jsx(d.Cell,{className:"max-w-[320px] min-w-[240px] py-2 pe-2 align-middle! whitespace-break-spaces",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 shrink-0",children:e.jsx(ls,{src:s.gizmo.display.profile_picture_url,isFirstParty:s.gizmo.tags?.includes(qe.FirstParty)??!1,alt:s.gizmo.display.name,className:"h-10 w-10"})}),e.jsx(Ke,{className:"ms-4",onClick:()=>T(Ye(r,s)),children:e.jsx("div",{className:"text-token-text-primary text-sm font-semibold",children:s.gizmo.display.name})})]})}),e.jsx(d.Cell,{className:"text-token-text-secondary w-full max-w-[160px] min-w-[100px] p-2 align-middle! text-sm",children:G?e.jsx("div",{className:"bg-token-bg-tertiary rounded-lg px-2 py-1",children:e.jsx(i,{...o.unassigned})}):e.jsx("span",{className:"block overflow-hidden text-ellipsis whitespace-nowrap",children:s.gizmo.author.display_name})}),e.jsx(d.Cell,{wrap:!0,className:"text-token-text-secondary max-w-[240px] min-w-[160px] p-2 align-middle! text-sm",children:L===""?"—":L}),!a&&e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:e.jsx(bs,{gizmo:s,account:t})}),!a&&e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:s.gizmo.vanity_metrics?.num_conversations_str??0}),e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:b}),e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:v}),e.jsx(d.Cell,{className:"border-token-border-heavy bg-token-bg-primary sticky end-0 border-s-[0.5px] p-1 align-middle!",textAlign:"center",children:e.jsxs(C.Root,{children:[e.jsx(C.Trigger,{children:e.jsx(Qe,{className:"icon-sm"})}),e.jsx(C.Portal,{children:a?e.jsx(C.Content,{children:e.jsx(C.Item,{onClick:()=>{g(!0)},color:"danger",icon:ie,children:e.jsx(i,{...o.removeFromWorkspace})})}):e.jsxs(C.Content,{children:[e.jsx(C.Item,{onClick:()=>{c(s)},icon:rs,children:e.jsx(i,{...o.changeAccess})}),e.jsx(C.Item,{onClick:()=>{y(!0)},icon:G?Ts:Ze,children:e.jsx(i,{...G?o.assignOwner:o.changeOwner})}),e.jsx(C.Item,{onClick:()=>{h(!0)},icon:ie,color:"danger",children:e.jsx(i,{...o.deleteGPT})})]})})]})})]}),l&&e.jsx(os,{publishedGizmo:l,gizmo:Je(l),onClose:()=>c(!1),appealGizmo:()=>T($e(l.gizmo.id)),shareOnly:!0,workspaceOwner:!0}),e.jsx(js,{isOpen:m,gpt:s,account:t,onClose:P=>{y(!1),P&&n.invalidateQueries({queryKey:["workspace",t.id,x.WORKSPACE]})}}),e.jsx(ys,{isOpen:f,gpt:s,account:t,onClose:P=>{h(!1),P&&n.invalidateQueries({queryKey:["workspace",t.id,x.WORKSPACE]})}}),e.jsx(Xe,{isOpen:u,gpt:s,account:t,onClose:P=>{g(!1),P&&n.invalidateQueries({queryKey:["workspace",t.id,x.THIRD_PARTY]})}})]})}function Ss(t,s,a){return t.sort((n,r)=>{let l,c;if(s==="created_at")l=new Date(n.gizmo.created_at).getTime(),c=new Date(r.gizmo.created_at).getTime();else if(s==="updated_at")l=new Date(n.gizmo.updated_at).getTime(),c=new Date(r.gizmo.updated_at).getTime();else if(s==="workspace_approval_date")l=new Date(n.gizmo.workspace_approval_date??"").getTime(),c=new Date(r.gizmo.workspace_approval_date??"").getTime();else if(s==="vanity_metrics.num_conversations_str")l=n.gizmo.vanity_metrics?.num_conversations??0,c=r.gizmo.vanity_metrics?.num_conversations??0;else throw new Error(`Invalid field: ${s}`);if(a==="asc")return l-c;if(a==="desc")return c-l;throw new Error(`Invalid direction: ${a}`)})}function vs(t){switch(t){case S.User:case S.Group:return S.Private;case S.WorkspaceLink:return S.Workspace;default:return t}}function Ps(t,s){return t.filter(a=>{const n=a.tools.some(c=>c.type===O.MEMORY?!1:s.tools[c.type]),r=vs(a.gizmo.share_recipient),l=s.share_recipient[r];return n||l})}function Cs(t,s){const a=s.toLowerCase();return t.filter(({gizmo:n})=>{const r=n.author.display_name,l=n.display.name.toLowerCase();return r?.toLowerCase().includes(a)??l.includes(a)})}const Ms=({account:t,showThirdParty:s})=>{const[a,n]=p.useState(x.WORKSPACE),{data:r,fetchNextPage:l,hasNextPage:c,isError:f,isFetchingNextPage:h}=Ns(t.id,a),m=A(),[y,u]=p.useState(!1),g=r?.pages.flatMap(j=>j.items)??[];p.useEffect(()=>{!f&&!h&&c&&l()},[h,c,f,l]);const T=c,b=p.useRef(null),[v,L]=p.useState(""),[G,P]=p.useState(!1),[M,Pe]=p.useState("updated_at"),[U,oe]=p.useState("desc"),Q=U==="asc"?Be:Ue,ce={tools:{[O.BROWSER]:!1,[O.PYTHON]:!1,[O.JIT_PLUGIN]:!1,[O.RETRIEVAL]:!1,[O.DALLE]:!1,[O.IMAGE_GEN]:!1,[O.CANVAS]:!1},share_recipient:{[S.Private]:!1,[S.Workspace]:!1,[S.Link]:!1,[S.Marketplace]:!1}},[I,de]=p.useState(ce),[Z,H]=p.useState(0),Ce=B();p.useEffect(()=>{G&&b.current&&b.current.focus()},[G]);function pe(j,R){const{id:D,checked:Me}=j.currentTarget,xe={...I};xe[R][D]=Me,de(xe),H(0)}function J(j){const R=M,D=U;M===j?oe(U==="asc"?"desc":"asc"):(Pe(j),oe("desc")),be.addAction("workspace_gpt_table_sorting",{column:j,previousSort:R,previousDirection:D,newDirection:R===M?D==="asc"?"desc":"asc":"desc"})}let ue=0,me=0;const $=Object.values(I.tools).filter(Boolean).length+Object.values(I.share_recipient).filter(Boolean).length;let N=[],ge=0;const V=r===void 0,X=!V&&g.length>0;return V||(ge=Math.min(g.length,W),me=Math.ceil(g.length/W),T?N=g:N=Ss(g,M,U),v!==""&&(N=Cs(N,v)),$>0&&(N=Ps(N,I)),ue=Math.ceil(N.length/W),N=N.slice(Z*W,(Z+1)*W)),e.jsxs("div",{children:[e.jsxs("div",{className:"border-token-border-default flex justify-between border-b",children:[e.jsxs("div",{className:"flex space-x-4 pt-2",children:[e.jsx(se,{isActive:a===x.WORKSPACE,onClick:()=>n(x.WORKSPACE),children:e.jsx(i,{...o.workspaceTab})}),s&&e.jsx(se,{isActive:a===x.THIRD_PARTY,onClick:()=>n(x.THIRD_PARTY),children:e.jsx(i,{...o.thirdPartyTab})}),e.jsx(se,{isActive:a===x.UNASSIGNED,onClick:()=>n(x.UNASSIGNED),children:e.jsx(i,{...o.unassigned})})]}),!V&&e.jsxs("div",{className:"flex items-center pb-2",children:[$>0&&e.jsxs(fe,{className:"flex items-center space-x-1",onClick:()=>de(ce),children:[e.jsx("span",{className:"font-medium",children:e.jsx(i,{id:"2HkRen",defaultMessage:"{filterCount, plural, one {# filter} other {# filters}} applied",values:{filterCount:$}})}),e.jsx(he,{className:"icon-md"})]}),e.jsxs(C.Root,{children:[e.jsx(C.Trigger,{children:e.jsx(ws,{className:"icon-md"})}),e.jsx(C.Portal,{children:e.jsx(C.Content,{className:"rounded-lg px-2 text-sm",children:e.jsxs("div",{className:"text-token-text-primary w-64 space-y-2 p-2 font-normal",children:[e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(i,{...o.capabilitiesTitle})}),Object.entries(I.tools).map(([j,R])=>e.jsx(ne,{id:j,checked:R,label:je(t,j),onChange:D=>{pe(D,"tools")}},j))]}),e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(i,{...o.whoHasAccessTitle})}),Object.entries(I.share_recipient).map(([j,R])=>e.jsx(ne,{id:j,checked:R,label:je(t,j),onChange:D=>{pe(D,"share_recipient")}},j))]})]})})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{onClick:()=>P(!0),children:e.jsx(ze,{className:"icon-md"})}),e.jsx(Ee,{children:G&&e.jsx(Le.input,{type:"text",ref:b,placeholder:m.formatMessage(o.filterByNameOrBuilderPlaceholder),className:"bg-token-bg-primary border-none px-0 focus:ring-0",initial:{width:0,opacity:0},animate:{width:"192px",opacity:1},exit:{width:0,opacity:0,visibility:"hidden"},value:v,onChange:()=>{H(0),L(b.current?.value??"")}})}),G&&e.jsx("div",{className:"cursor-pointer",onClick:()=>{P(!1),L(""),H(0)},children:e.jsx(he,{className:"icon-sm"})})]}),s&&e.jsx(_,{color:"secondary",onClick:()=>u(!0),icon:we,children:e.jsx(i,{...o.approveAGPTButton})})]})]}),V?e.jsx("div",{className:"mt-8 flex min-h-[320px] items-center justify-center",children:e.jsx(ae,{})}):e.jsxs("div",{style:{height:ge*85+75},className:"mb-8 min-h-[320px]",children:[N.length>0?e.jsxs(d.Root,{size:"normal",className:"bg-token-bg-primary w-full min-w-full overflow-hidden overflow-x-auto sm:rounded-lg",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"text-token-text-secondary py-2 pe-4 text-start text-xs",children:e.jsx(i,{...o.nameCellTitle})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(i,{...o.builderCellTitle})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(i,{...o.customActionsCellTitle})}),(a===x.WORKSPACE||a===x.UNASSIGNED)&&e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(i,{...o.whoHasAccessTitle})}),(a===x.WORKSPACE||a===x.UNASSIGNED)&&e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{T||J("vanity_metrics.num_conversations_str")},children:[e.jsx("span",{children:e.jsx(i,{...o.chatsCellTitle})}),M==="vanity_metrics.num_conversations_str"&&e.jsx(Q,{className:F("icon-sm",T&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{T||J("created_at")},children:[e.jsx("span",{children:a===x.WORKSPACE||a===x.UNASSIGNED?e.jsx(i,{...o.createdCellTitle}):e.jsx(i,{...o.approvedCellTitle})}),M==="created_at"&&e.jsx(Q,{className:F("icon-sm",T&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{T||J("updated_at")},children:[e.jsx("span",{children:e.jsx(i,{...o.updatedCellTitle})}),M==="updated_at"&&e.jsx(Q,{className:F("icon-sm",T&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"border-token-border-heavy absolute end-0 w-16 border-s-[0.5px]"})]}),e.jsx(d.Body,{children:N.map(j=>e.jsx(ks,{account:t,gpt:j,thirdParty:a===x.THIRD_PARTY},j.gizmo.id))})]}):e.jsxs("div",{className:"flex h-full w-full flex-col items-center gap-4 py-16",children:[e.jsx("div",{children:e.jsx(He,{className:"h-12 w-12 text-gray-400"})}),e.jsx("p",{className:"text-token-text-secondary",children:!T&&(a===x.THIRD_PARTY?e.jsx(i,{...X?o.noWorkspaceApprovedGPTsFound:o.noWorkspaceApprovedGPTs}):a===x.UNASSIGNED?e.jsx(i,{...X?o.noUnassignedGPTs:o.noUnassignedGPTsFound}):e.jsx(i,{...X?o.noWorkspaceGPTsFound:o.noWorkspaceGPTs}))}),a===x.THIRD_PARTY&&e.jsx(_,{color:"secondary",onClick:()=>u(!0),icon:we,children:e.jsx(i,{...o.approveAGPTButton})})]}),T&&e.jsxs("div",{className:"text-token-text-tertiary my-4 flex w-full items-center justify-center gap-4",children:[e.jsx(ae,{}),e.jsx(i,{...o.stillLoadingData})]}),me>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Ve,{currentPage:Z,onChangeIndex:H,length:Math.max(ue,1)})})]}),e.jsx(cs,{isOpen:y,onClose:()=>{u(!1),Ce.invalidateQueries({queryKey:["workspace",t.id,x.THIRD_PARTY]})},account:t})]})};function Ns(t,s){return Ie({queryKey:["workspace",t,"gizmos",s],queryFn:({pageParam:a})=>Ne.getWorkspaceGPTs(t,s,a),initialPageParam:"",getNextPageParam:a=>a.cursor})}function bs({gizmo:t,account:s}){const a=A(),n={[S.Private]:a.formatMessage(o.shareRecipientTitlePrivate),[S.User]:a.formatMessage(o.shareRecipientTitlePrivate),[S.Group]:a.formatMessage(o.shareRecipientTitlePrivate),[S.Link]:a.formatMessage(o.shareRecipientTitleLink),[S.Marketplace]:a.formatMessage(o.shareRecipientTitlePublic),[S.Workspace]:s.data.name,[S.WorkspaceLink]:s.data.name};if(["private","user","group"].includes(t.gizmo.sharing.recipient)){const{users:r,groups:l}=Os(t);return r===0&&l===0?e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(i,{...o.shareRecipientTitlePrivate})}):r>0&&l>0?e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{id:"fQ+tJG",defaultMessage:"Shared with {users} and {groups}",values:{users:a.formatMessage(o.userCount,{numUsers:r}),groups:a.formatMessage(o.groupCount,{numGroups:l})}})]}):r>0?e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{...o.userCount,values:{numUsers:r}})]}):e.jsxs("span",{className:"text-token-text-secondary",children:[n[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(i,{...o.groupCount,values:{numGroups:l}})]})}return e.jsx("span",{children:n[t.gizmo.share_recipient]})}function Os(t){if(t.gizmo.sharing.subjects){const s=t.gizmo.sharing.subjects.filter(n=>n.type===Te.USER).length,a=t.gizmo.sharing.subjects.filter(n=>n.type===Te.GROUP).length;return{users:s,groups:a}}return{users:0,groups:0}}const o=Y({stillLoadingData:{id:"workspaceSettings.stillLoadingData",defaultMessage:"Don't see what you're looking for? Some GPTs are still loading..."},noUnassignedGPTs:{id:"workspaceSettings.noUnassignedGPTs",defaultMessage:"No unassigned GPTs"},noUnassignedGPTsFound:{id:"workspaceSettings.noUnassignedGPTsFound",defaultMessage:"No unassigned GPTs found"},noWorkspaceGPTs:{id:"workspaceSettings.noWorkspaceGPTs",defaultMessage:"This workspace does not have any GPTs"},noWorkspaceGPTsFound:{id:"workspaceSettings.noWorkspaceGPTsFound",defaultMessage:"No workspace GPTs found"},noWorkspaceApprovedGPTs:{id:"workspaceSettings.noWorkspaceApprovedGPTs",defaultMessage:"You haven't approved any third-party GPTs"},noWorkspaceApprovedGPTsFound:{id:"workspaceSettings.noWorkspaceApprovedGPTsFound",defaultMessage:"No approved third-party GPTs found"},workspaceTab:{id:"workspaceSettings.workspaceTab",defaultMessage:"Workspace"},thirdPartyTab:{id:"workspaceSettings.thirdPartyTab",defaultMessage:"Third-party"},capabilitiesTitle:{id:"workspaceSettings.capabilitiesTitle",defaultMessage:"Capabilities"},whoHasAccessTitle:{id:"workspaceSettings.whoHasAccessTitle",defaultMessage:"Who has access"},filterByNameOrBuilderPlaceholder:{id:"workspaceSettings.filterByNameOrBuilderPlaceholder",defaultMessage:"Filter by name or builder..."},nameCellTitle:{id:"workspaceSettings.nameCellTitle",defaultMessage:"Name"},builderCellTitle:{id:"workspaceSettings.builderCellTitle",defaultMessage:"Builder"},customActionsCellTitle:{id:"workspaceSettings.customActionsCellTitle",defaultMessage:"Custom Actions"},chatsCellTitle:{id:"workspaceSettings.chatsCellTitle",defaultMessage:"Chats"},createdCellTitle:{id:"workspaceSettings.createdCellTitle",defaultMessage:"Created"},updatedCellTitle:{id:"workspaceSettings.updatedCellTitle",defaultMessage:"Updated"},approvedCellTitle:{id:"workspaceSettings.approvedCellTitle",defaultMessage:"Approved"},approveAGPTButton:{id:"workspaceSettings.approveAGPTButton",defaultMessage:"Approve a GPT"},shareRecipientTitlePrivate:{id:"vyjlzc",defaultMessage:"Invite only"},shareRecipientTitleLink:{id:"workspaceSettings.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettings.shareRecipientTitlePublic",defaultMessage:"Public"},changeAccess:{id:"workspaceSettings.changeAccess",defaultMessage:"Change who has access"},changeOwner:{id:"workspaceSettings.changeOwner",defaultMessage:"Change Owner"},assignOwner:{id:"workspaceSettings.assignOwner",defaultMessage:"Assign Owner"},deleteGPT:{id:"workspaceSettings.deleteGPT",defaultMessage:"Delete GPT"},removeFromWorkspace:{id:"workspaceSettings.removeFromWorkspace",defaultMessage:"Remove from workspace"},userCount:{id:"P1xo2B",defaultMessage:"{numUsers, plural, one {# user} other {# users}}"},groupCount:{id:"4zRUED",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},unassigned:{id:"workspaceSettings.unassignedGPTs",defaultMessage:"Unassigned"}});function te({title:t,description:s,children:a,upsellEnterprise:n=!1,isQuorum:r=!1,className:l=""}){return e.jsx(ve,{label:e.jsx(i,{...w.enterpriseRequiredMessage}),side:"top",disabled:!n,className:"max-w-5xl",triggerAs:null,children:e.jsxs(ms,{className:F(n&&"text-token-text-tertiary","max-w-4xl",l),children:[e.jsxs(gs,{className:"flex items-center gap-3",children:[e.jsx(i,{...t}),n&&e.jsx("span",{className:"bg-token-main-surface-tertiary rounded-xl px-2 pb-0.5 text-sm",children:e.jsx(i,{...w.enterpriseUpsellPill})}),!n&&r&&e.jsx("span",{className:"bg-token-main-surface-tertiary rounded-xl px-3 ps-3 pt-1 pb-1 text-sm font-normal",children:e.jsx(i,{...w.thisFeatureDisabledForOrg})})]}),s&&e.jsx(xs,{className:"text-token-text-secondary py-2",children:e.jsx(i,{...s})}),a]})})}function _s({workspaceId:t,label:s,setting:a,defaultValue:n,values:r,disabled:l=!1}){const c=A(),f=re(),h=B(),{variables:m,mutate:y}=le({mutationFn:({setting:u,value:g})=>z.safePost("/accounts/{account_id}/settings/share_settings",{parameters:{path:{account_id:t}},requestBody:{setting:u,value:g}}),onSettled:()=>{h.invalidateQueries({queryKey:["workspace-settings"]}),h.invalidateQueries({queryKey:["workspace"]})},onError:()=>{f.danger(c.formatMessage(w.featureSettingsUpdateFailed))}});return e.jsxs(hs,{children:[e.jsx("p",{className:"text-md inline-flex items-center",children:e.jsx(i,{...s})}),e.jsxs(k.Root,{defaultValue:m?.value??n,onValueChange:u=>{y({setting:a,value:u})},disabled:l,children:[e.jsxs(k.Trigger,{className:"text-md focus-visible:border-none",children:[e.jsx(k.Value,{}),e.jsx(k.Icon,{})]}),e.jsx(k.Portal,{children:e.jsx(k.Content,{children:r.map((u,g)=>e.jsx(k.Item,{className:"text-md",value:u.value,children:e.jsx(i,{...u.display})},g))})})]})]})}function As({workspaceId:t,value:s,upsellEnterprise:a=!1,isQuorum:n=!1}){const r=A(),l=re(),c=B(),{variables:f,mutate:h}=le({mutationFn:({value:m})=>z.safePost("/accounts/{account_id}/settings/third_party_gpts",{parameters:{path:{account_id:t}},requestBody:{value:m}}),onSettled:()=>{c.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{l.danger(r.formatMessage(w.featureSettingsUpdateFailed))}});return e.jsxs(k.Root,{defaultValue:f?.value??s,onValueChange:m=>{h({value:m})},children:[e.jsxs(k.Trigger,{className:"border-token-border-default focus-visible:border-token-border-default border text-base",children:[e.jsx(k.Value,{}),e.jsx(k.Icon,{})]}),e.jsx(k.Portal,{children:e.jsxs(k.Content,{children:[!n&&e.jsx(k.Item,{className:"text-base",value:K.ALLOW_ALL,children:e.jsx(i,{...w.allowAllOption})}),!a&&!n&&e.jsx(k.Item,{className:"text-base",value:K.ALLOW_SPECIFIC,children:e.jsx(i,{...w.ownerApprovedOnlyOption})}),e.jsx(k.Item,{className:"text-base",value:K.ALLOW_NONE,children:e.jsx(i,{...w.dontAllowOption})})]})})]})}function Gs({workspaceId:t,data:s}){const a=A(),n=re(),r=Ae(),l=B(),[c,f]=p.useState([]),h=le({mutationFn:({value:v})=>z.safePost("/accounts/{account_id}/settings/allowed_custom_actions_domains",{parameters:{path:{account_id:t}},requestBody:{domains:v}}),onSettled:()=>{l.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{n.danger(a.formatMessage(w.featureSettingsUpdateFailed))}});if(r==null)return null;const m=r.isTeam(),u=r?.data.subscriptionStatus.planType===Ge.QUORUM,g=e.jsx(te,{title:w.thirdPartyGPTsTitle,description:w.thirdPartyGPTsDescription,className:"border-token-border-default border-b pb-4",isQuorum:u,children:e.jsx("div",{children:e.jsx(As,{workspaceId:t,value:s.allow_third_party_gpts,upsellEnterprise:m,isQuorum:u})})}),T=e.jsx(te,{title:w.sidebarTitle,children:e.jsx(Ms,{account:r,showThirdParty:!m&&!u&&s.allow_third_party_gpts===K.ALLOW_SPECIFIC})}),b=s.allowed_custom_actions_domains!=null||s.beta_settings.workspace_gpt_custom_actions===!1;return e.jsxs(ps,{className:"max-w-5xl",children:[m&&g,m&&r.isOwnerOfAccount()&&T,e.jsx(te,{title:w.sharingSettingsTitle,upsellEnterprise:m,isQuorum:u,children:e.jsxs(us,{children:[e.jsx(_s,{workspaceId:t,label:w.gptSharingTitle,disabled:m||u,setting:Re.GPT_SHARE_SETTINGS,defaultValue:s.share_settings.gpt_share_setting,values:[{display:w.anyOneSelect,value:ee.ANYONE},{display:w.workspaceMembersOnlySelect,value:ee.WORKSPACE_ONLY},{display:w.inviteOnlySelect,value:ee.NO_ONE}]}),e.jsx(e.Fragment,{children:!u&&e.jsxs("div",{className:"flex flex-col gap-4 py-6",children:[e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(i,{id:"ugI3Yt",defaultMessage:"GPT actions"})}),e.jsx("div",{className:"text-token-text-secondary py-2 text-sm",children:e.jsx(i,{id:"HY2eof",defaultMessage:"GPT actions allow GPTs to call third-party APIs for tasks such as retrieving or modifying data. GPT actions are defined by GPT builders, and you can limit the domains that can be used for GPTs created in your workspace."})}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx(ne,{checked:!b,id:"allow-all-domains",onChange:v=>{v.currentTarget.checked?(f(s.allowed_custom_actions_domains),h.mutate({value:null})):h.mutate({value:c??[]})},label:e.jsxs("span",{className:"flex flex-row items-center",children:[e.jsx(i,{id:"WnWoqJ",defaultMessage:"Allow all domains for GPT actions"}),e.jsx(ve,{interactive:!0,label:e.jsx(i,{id:"KjJtEm",defaultMessage:"Limit the Internet domains that can be used by GPTs created in your workspace. This does not apply to third-party GPTs."}),side:"top",children:e.jsx(ns,{})})]})}),h.isPending&&e.jsx(ae,{})]}),b&&e.jsx(fs,{value:s.allowed_custom_actions_domains??[],title:a.formatMessage({id:"YetDcq",defaultMessage:"Domains"}),onChange:v=>{h.mutate({value:v})},emptyMessage:a.formatMessage({id:"rFH4IP",defaultMessage:"No domains added. No GPT actions will be allowed."})})]})})]})}),!m&&g,!m&&r.isOwnerOfAccount()&&T]})}function Rs({currentWorkspaceId:t}){const{data:s,isLoading:a}=_e(t),n=A();return e.jsxs(e.Fragment,{children:[e.jsx(es,{children:e.jsx("title",{children:n.formatMessage(w.sidebarTitle)})}),e.jsx(ss,{title:n.formatMessage(w.sidebarTitle)}),e.jsx(ts,{showSpinner:a,children:s===void 0?null:e.jsx(Gs,{workspaceId:t,data:s})})]})}const w=Y({sidebarTitle:{id:"workspaceSettingsOld.sidebarTitle",defaultMessage:"GPTs"},allowAllOption:{id:"workspaceSettingsOld.allowAllOption",defaultMessage:"Allow all"},ownerApprovedOnlyOption:{id:"workspaceSettingsOld.ownerApprovedOnlyOption",defaultMessage:"Owner-approved only"},dontAllowOption:{id:"workspaceSettingsOld.dontAllowOption",defaultMessage:"Don't allow"},retentionPolicyTitle:{id:"workspaceSettingsOld.retentionPolicyTitle",defaultMessage:"Retention policy"},thirdPartyGPTsTitle:{id:"workspaceSettingsOld.thirdPartyGPTsTitle",defaultMessage:"Third-party"},thirdPartyGPTsDescription:{id:"workspaceSettingsOld.thirdPartyGPTsDescription",defaultMessage:"Manage whether members can use GPTs created outside your workspace."},customActionsTooltip:{id:"workspaceSettingsOld.customActionsTooltip",defaultMessage:"Allow GPTs to use third-party services for tasks such as finding flights. Actions are defined by GPT builders."},searchTooltip:{id:"workspaceSettingsOld.searchTooltip",defaultMessage:"Web search allows ChatGPT and GPTs to answer questions on recent topics. When enabled, it may send search queries and general location information to Bing, but this data is not linked to or associated with user accounts."},customActionsOptionTitle:{id:"workspaceSettingsOld.pluginsOptionTitle.0",defaultMessage:"Custom actions"},appearanceTitle:{id:"workspaceSettingsOld.appearanceTitle",defaultMessage:"Appearance"},sharingSettingsTitle:{id:"workspaceSettingsOld.sharingSettingsTitle",defaultMessage:"Sharing"},gptSharingTitle:{id:"workspaceSettingsOld.gptSharingTitle",defaultMessage:"GPTs can be shared with..."},workspaceMembersOnlySelect:{id:"workspaceSettingsOld.workspaceMembersOnlySelect",defaultMessage:"Workspace members only"},anyOneSelect:{id:"workspaceSettingsOld.anyOneSelect",defaultMessage:"Anyone"},inviteOnlySelect:{id:"workspaceSettingsOld.inviteOnlySelect",defaultMessage:"Invite only"},featureSettingsUpdateFailed:{id:"workspaceSettingsOld.featureSettingsUpdateFailed",defaultMessage:"Failed to update feature setting"},conversationRetention:{id:"workspaceSettingsOld.conversationRetention",defaultMessage:"Chat retention"},retentionInfinite:{id:"workspaceSettingsOld.retentionInfinite",defaultMessage:"Infinite"},retentionNinetyDays:{id:"workspaceSettingsOld.retentionNinetyDays",defaultMessage:"90 days"},retentionOneYear:{id:"workspaceSettingsOld.retentionOneYear",defaultMessage:"1 year"},retentionCustomDays:{id:"workspaceSettingsOld.retentionCustomDays",defaultMessage:"{num} days"},retentionChange:{id:"workspaceSettingsOld.retentionChange",defaultMessage:"Contact your account manager to change this setting."},enterpriseUpsellPill:{id:"workspaceSettingsOld.enterpriseUpsellPill",defaultMessage:"Enterprise"},retentionSettingTooltip:{id:"workspaceSettingsOld.retentionSettingTooltip",defaultMessage:"Contact your account manager to change this setting"},enterpriseRequiredMessage:{id:"workspaceSettingsOld.enterpriseRequiredMessage",defaultMessage:"Only workspaces with the Enterprise plan can change these settings"},shareRecipientTitlePrivate:{id:"workspaceSettingsOld.shareRecipientTitlePrivate",defaultMessage:"Private"},shareRecipientTitleLink:{id:"workspaceSettingsOld.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettingsOld.shareRecipientTitlePublic",defaultMessage:"Public"},thisFeatureDisabledForOrg:{id:"workspaceSettings.thisFeatureDisabledForOrg",defaultMessage:"This feature is disabled in HIPAA compliant workspaces"}}),yt=De(function(){const s=as();return is(),e.jsx(Rs,{...s})});export{yt as default};
//# sourceMappingURL=cxaugc8j98wqt9j0.js.map

import{r as f,f as j,o as S,j as e,M as l}from"./n3epq09dut36rmi2.js";import{I as k,f as M,L as R,h as P}from"./uox23aig6gp6se2y.js";import{I as C}from"./bns64zud9fwchaft.js";import{W as E}from"./azqvry2z7sssyjfm.js";import{c as u}from"./nqrmgk5te3uzwsyz.js";function L({repository:a,isSelected:n,className:s,isDisabled:o,disablePill:i}){const r=j(),c=a.visibility==="private"?r.formatMessage({id:"wham.repositorySection.private",defaultMessage:"Private"}):r.formatMessage({id:"wham.repositorySection.public",defaultMessage:"Public"});return e.jsxs("div",{className:u("flex items-center justify-between gap-2",s),children:[e.jsx("div",{className:u("flex items-start gap-3",o&&"opacity-50"),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-token-text-primary text-start text-sm font-medium",children:a.name}),e.jsx("div",{className:"text-token-text-secondary text-start text-sm leading-tight font-normal",children:[a.language,c].filter(Boolean).map((x,m)=>e.jsx("span",{className:"after:mx-1 after:content-['\\u00b7'] last:after:content-[none]",children:x},m))})]})}),o&&i?i:n?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(P,{className:"icon-sm"})}):null]})}function F({repository:a,isSelected:n,onClick:s,shouldDisableRow:o,disablePill:i}){const r=o?.(a);return e.jsx("button",{className:u("group flex w-full items-center justify-between gap-2 rounded-md p-3",r?"cursor-default select-none":"hover:bg-token-bg-tertiary cursor-pointer"),disabled:r,onClick:s,type:"button",children:e.jsx(L,{repository:a,isSelected:n,className:"w-full",isDisabled:r,disablePill:i})})}function d(){return e.jsx("div",{className:"flex w-full items-center justify-between gap-2 rounded-md",children:e.jsx(R,{className:"h-14 w-full"})})}const g=100;function I({selectedRepository:a,onSelect:n,installationId:s,shouldDisableRow:o,disablePill:i}){const r=j(),[c,x]=f.useState(""),{data:m,isLoading:y,fetchNextPage:v,hasNextPage:p,isFetchingNextPage:N,error:b}=S({queryKey:["repositories",s],enabled:!!s,initialPageParam:1,queryFn:({pageParam:t})=>E.getRepositoriesByInstallationId(s??0,t,g),getNextPageParam:(t,w)=>{if(!((t?.repositories??[]).length<g))return w.length+1}}),h=f.useMemo(()=>m?.pages.flatMap(t=>t.repositories??[])??[],[m]).filter(t=>t.name.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(l,{id:"wham.createEnvironments.repository",defaultMessage:"Repository"})}),e.jsx("div",{className:"flex justify-between",children:e.jsx(k,{color:"search",iconPosition:"left",icon:M,className:"text-token-text-tertiary flex h-8 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:c,onChange:t=>x(t.target.value),placeholder:r.formatMessage({id:"wham.repositorySection.searchPlaceholder",defaultMessage:"Search"}),ariaLabel:r.formatMessage({id:"wham.repositorySection.searchAria",defaultMessage:"Search"})})}),e.jsxs("div",{className:"border-token-border-heavy bg-token-bg-primary flex flex-col gap-2 rounded-lg border p-3",children:[e.jsx("div",{className:"flex max-h-56 flex-col overflow-y-auto",children:!s||y?e.jsxs("div",{className:"flex h-full flex-col gap-2",children:[e.jsx(d,{}),e.jsx(d,{}),e.jsx(d,{}),e.jsx(d,{})]}):b?e.jsx("div",{className:"text-token-text-primary flex h-full items-center justify-center text-sm",children:e.jsx(l,{id:"wham.createEnvironments.repositorySection.error",defaultMessage:"Failed to load repositories. Please ensure you have connected your GitHub account."})}):e.jsxs(e.Fragment,{children:[h.length===0&&!p?e.jsx("div",{className:"text-token-text-secondary text-md flex h-24 w-full items-center justify-center",children:e.jsx(l,{id:"wham.createEnvironments.repositorySection.noRepositories.short",defaultMessage:"No repositories found"})}):h.map(t=>e.jsxs("div",{children:[e.jsx(F,{repository:t,isSelected:a===t.id,onClick:()=>n(t.id,t.repository_full_name,t.name),shouldDisableRow:o,disablePill:i}),e.jsx("div",{className:"border-token-border-light border-t"})]},t.id)),e.jsx(C,{isFetchingNextPage:N,hasNextPage:p??!1,fetchNextPage:v,bgColor:"dark:bg-token-bg-secondary"})]})}),s&&e.jsx("p",{className:"text-token-text-secondary px-3 pt-3 text-start text-xs leading-none",children:s?e.jsx(l,{id:"wham.createEnvironments.repositorySection.noRepositories",defaultMessage:"Missing a repo? <link>Configure repository access</link>.",values:{link:t=>e.jsx("a",{href:`https://github.com/apps/chatgpt-connector/installations/${s}`,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}):e.jsx(l,{id:"wham.createEnvironments.repositorySection.selectAccount",defaultMessage:"Select an account to connect to"})})]})]})}const z=f.memo(I);export{z as R,L as a};
//# sourceMappingURL=174fvluhmzu5w4r1.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/og00mol61ujocnrz.js","assets/n3epq09dut36rmi2.js","assets/uox23aig6gp6se2y.js","assets/nqrmgk5te3uzwsyz.js","assets/root-nu0t8wee.css","assets/conversation-small-cqkvcue6.css","assets/dmx052n3lc572ye8.js","assets/le820injjee03tii.js","assets/heu4jyunh2d29vgy.js","assets/oshe56yhea4czc03.js","assets/dnyjnsewv99rujtf.js","assets/e4sjbad9hyqt73xe.js","assets/dkr8jkx9n88ez7ho.js","assets/nnldvg4yjd3ynnqu.js","assets/hi5bz78ars1jrvhf.js"])))=>i.map(i=>d[i]);
import{r as f,d as yn,j as e,g as Ue,f as K,L as ul,M as P,a5 as J,o as dl,c as ml,ag as pl,a6 as ut,p as fl,D as gl}from"./n3epq09dut36rmi2.js";import{u as kt,d as hl}from"./dnyjnsewv99rujtf.js";import{oB as _t,ki as fe,bL as Oa,k9 as Cn,eR as Ha,gW as _s,nk as Ua,t8 as vn,u0 as Ga,c0 as it,hv as xl,dB as Sl,R as js,hu as bl,u1 as yl,bi as Cl,fb as vl,eT as wl,u2 as Ut,u3 as Ye,n3 as Gt,u4 as wn,u5 as ye,u6 as _l,u7 as jl,aG as zt,u8 as rt,u9 as kl,fD as _n,et as U,jL as ra,c6 as Wt,ua as za,ub as Rl,d9 as lt,d as ln,uc as jn,ud as Vt,ue as Wa,fw as Ml,eP as kn,eM as Va,eN as Rn,eO as Mn,ix as ks,uf as qa,fN as Ya,k_ as An,rI as Al,ug as El,uh as Ka,rQ as Pl,g2 as $a,ui as Tl,uj as Nl,uk as Qa,ul as En,bI as jt,um as Bl,hJ as Il,un as Ll,uo as Dl,up as Fl,k4 as Rs,df as Ms,N as Pn,uq as Ol,ur as gs,p2 as Hl,qX as Ul,b7 as Oe,aY as pe,aZ as Tn,aE as Gl,us as Xa,pc as zl,ut as Wl,uu as Vl,uv as ql,is as Fe,d8 as Nn,uw as Yl,ux as Kl,uy as $l,iv as hs,l2 as Ja,uz as Ql,uA as Xl,uB as Jl,fv as Zl,uC as Za,pb as As,iu as ec,uD as tc,mG as Ce,uE as sc,uF as nc,uG as oc,uH as ac,uI as yt,uJ as ei,uK as ic,uL as rc,uM as lc,G as cn,id as Z,fM as cc,de as uc,uN as dc,uO as mc,uP as pc,uQ as fc,uR as gc,ms as Js,uS as la,uT as hc,uU as xc,uV as Sc,uW as bc,uX as yc,uY as Cc,t0 as Zs,B as Bn,bA as ti,bB as si,pB as vc,jr as wc,ju as _c,uZ as jc,f1 as kc,u_ as Rc,qc as ve,u$ as Mc,rt as Ot,v0 as Ac,nj as Ec,v1 as Pc,v2 as B,v3 as ni,v4 as Tc,v5 as Nc,v6 as Bc,v7 as Ic,v8 as Lc,v9 as Dc,va as Fc,vb as Oc,vc as Hc,vd as Uc,ve as Gc,vf as zc,vg as Wc,vh as Vc,vi as qc,vj as Yc,vk as Kc,vl as $c,vm as Qc,vn as Xc,vo as Jc,hN as Zc,vp as eu,vq as tu,vr as su,vs as nu,vt as ou,vu as au,vv as iu,vw as ru,vx as lu,vy as cu,vz as uu,vA as du,vB as mu,vC as pu,vD as fu,vE as gu,vF as hu,vG as xu,i3 as oi,vH as Su,vI as bu,vJ as yu,l4 as Cu,l5 as ai,l3 as Ct,eF as vu,nL as ca,dd as In,oU as ii,di as fs,dj as wu,vK as Ln,vL as Dn,vM as _u,dk as ot,vN as xs,p5 as un,fl as Fn,dg as On,dh as Hn,e8 as Un,nK as Gn,e9 as zn,nM as ju,jR as ku,pg as ri,it as Ge,vO as Ru,vP as Mu,q5 as Au,h as Eu,fY as Wn,ig as Ht,vQ as Pu,vR as Tu,vS as Ss,hk as Nu,vT as li,vU as ci,vV as ui,vW as di,vX as Dt,l6 as Bu,vY as Iu,nw as bs,nv as mi,vZ as Lu,v_ as Du,v$ as Fu,w0 as Ou,w1 as Hu,w2 as Uu,dc as Vn,E as qn,jh as pi,w3 as dn,w4 as Gu,fA as zu,fB as Wu,w5 as ys,fC as fi,w6 as gi,fE as Vu,w7 as hi,fF as qu,iw as Yu,kf as Yn,kh as Kn,ke as Ku,qS as xi,w8 as mn,w9 as $u,eI as Si,a9 as Qu,wa as Xu,g1 as Ju,oN as $n,wb as bi,fL as Zu,kg as ed,wc as td,wd as sd,we as nd,wf as ua,wg as od,wh as yi,wi as ad,wj as id,wk as rd,gV as Ci,wl as vi,wm as wi,wn as ld,p4 as cd,wo as pn,wp as ud,jd as da,e as dd,fj as md,fm as pd,qd as fd,cX as gd,wq as hd,wr as xd,ra as Sd,ws as bd,wt as yd,wu as Cd,wv as vd,ww as wd,lo as _d,wx as ma,kH as jd,lj as kd,wy as en,wz as Rd,mL as Md,wA as Ad,wB as Ed,wC as Pd,lr as Td,wD as Nd,wE as Bd,cz as Id,wF as Ld,z as Dd,U as pa,fK as Fd,mX as Od,n0 as Hd,V as Ud,wG as Gd,wH as zd,wI as Wd,wJ as Vd,wK as qd,fz as Yd,wL as fa,wM as ga,wN as ha,mU as Kd,wO as $d,wP as Qd,wQ as Xd,wR as Jd,wS as Zd,wT as em,eb as tm,oS as sm,ko as xa,wU as nm,oC as _i,m8 as om,wV as am,wW as im,Q as ji,mf as rm,wX as lm,wY as cm,iJ as um,pe as dm,wZ as mm,w_ as pm,iX as fm,oR as gm,jT as hm,nS as tn,nT as sn,jS as xm}from"./uox23aig6gp6se2y.js";import{ao as Rt,hw as ki,af as re,g as Mt,s as ct,as as Pe,cR as vt,aI as He,aj as N,gV as ee,ag as se,aX as Ee,hb as Ri,cf as Mi,aJ as A,ae as oe,hx as Ai,gt as fn,W as qt,c as Y,F as Qn,fr as Yt,hy as Xn,dZ as Ei,m as Ke,b as Sa,q as Cs,aY as Sm,fs as Jn,c1 as Pi,aL as De,fh as bm,e4 as vs,cU as ym,dd as Ti,bQ as Kt,fX as Cm,aO as vm,B as wm,bV as _m,cT as Ni,hz as Bi,aV as at,hA as jm,cw as ba,b3 as km,fj as Ii,dh as Li,aC as Rm,aE as wt,bb as Mm,X as Zn,_ as eo,aH as nn,u as gn,aa as Di,ch as Am,hB as Es,e3 as Fi,dk as Oi,ca as Em,hC as Pm,b7 as Tm,n as ya,am as qe,hD as Ca,y as Nm,E as Bm,b5 as Im,ah as Hi,eJ as Lm,c2 as Dm,e as Fm,bE as Om,gF as to,bU as Hm,gS as Um,eC as Gm,bc as Ft,be as va,hE as zm,hF as Wm,hG as Vm,dK as qm,dL as Ym,at as Km,c4 as $m,c5 as Qm,cQ as wa,ga as Xm,gb as Jm,eU as Zm,hH as ep}from"./nqrmgk5te3uzwsyz.js";import{P as tp,u as sp}from"./ga29rzv9pwswyv07.js";import{u as np}from"./d588ndwa76k83w2v.js";import{C as Ps,c as op,A as ap,d as Ui}from"./jit20xrzecwhc2dk.js";import{G as Gi}from"./jsnptf63edu6k32a.js";import{P as ip,b as rp,c as zi,d as so}from"./c1itczlqrzelhws9.js";import{b as Wi}from"./izzltcwrbklvvt51.js";import{d as Vi,e as lp}from"./eirgecln9yzcy5p4.js";import{a as Ts,P as no,B as qi,C as oo,F as Yi,g as cp,V as up,b as dp,T as mp}from"./i1gy5x3o7l2ezmdz.js";import{G as pp}from"./hk3emygtpn0flzgl.js";import{e as fp,f as gp,h as ds,i as hp,P as xp,j as Sp}from"./e4sjbad9hyqt73xe.js";import{u as ao}from"./nonl1vc40q9bndh8.js";import{u as Ki,a as bp,I as yp,R as Cp,b as _a,C as vp,H as ja,B as wp,F as ka,c as _p,T as jp,S as kp,d as Ra,e as Rp}from"./oshe56yhea4czc03.js";import"./he8nwqvd8i1qrsxh.js";const Mp=({clientThreadId:t,rateLimitInfo:s,onDismiss:n,onInteract:o,onMount:i})=>{const{name:r,title:a,call_to_action:d,description:l}=s,u=Rt(),m=_t(!0),{updateSystemHint:c}=fe(),p=kt(),x=_t(!1),g=ki(),h=re(t,se.getIsNewConversation),b=u?.planType??"unknown",y=Mt(),w=ct(y,"3809605125"),k=g&&"block_reason"in g?g.block_reason:null,j="banner_description",R=f.useMemo(()=>({type:r||"unknown",location:j,plan_type:b,is_new_conversation:h,is_hard_block:!!g,hard_block_reason:k??"",call_to_action:d}),[r,j,b,h,g,k,d]),_=yn(),M=Oa(),{isUnauthenticated:v}=Pe(),E=Cn(),D=Ha(vt.signUpButtonText),F=_s(),z=Ua({clientThreadId:t}),{layer:S}=He("1368081792"),I=V=>{switch(V){case ee.AUTHENTICATE:return{text:E?vt.logInButtonText:D,onClick:()=>{M({authType:E?"login":"signup",callback:H=>{E?N.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:H}):N.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:H})}})}};case ee.AUTHENTICATE_SECONDARY:return{text:E?D:vt.logInButtonText,onClick:()=>{M({authType:E?"signup":"login",callback:H=>{E?N.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:H}):N.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:H})}})}};case ee.GET_PLUS:return{text:nt.getPlusButton,onClick:()=>{N.logRateLimitGetPlusButtonClicked(R),v?M({authType:E?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:H=>{E?N.logLogInButtonClicked({location:"Rate limit banner Get Plus upsell",provider:H}):N.logSignUpButtonClicked({location:"Rate limit banner Get Plus upsell",provider:H})}}):it(_,"Prompt textarea rate limit banner")}};case ee.NEW_CHAT:return{text:nt.newChatButton,onClick:()=>{m({modelId:"",location:j})}};case ee.PAID_USER_O3_MINI_HIGH:{const H=se.getCurrentLeafId(Ee(t)),Q=()=>{N.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:S.get("should_change_model_picker",!0)?"In-context upsell o3-mini-high for Plus banner - Try it button":"In-context upsell o3-mini-high for Plus (no model switch) banner - Try it button",eventProperties:R}),S.get("should_change_model_picker",!0)&&x(w?{modelId:"o4-mini-high",location:"In-context upsell o4-mini-high for Plus banner - Try it button"}:{modelId:"o3-mini-high",location:"In-context upsell o3-mini-high for Plus banner - Try it button"}),z(w?{sourceEvent:new Event("click"),nodeId:H,requestedModelId:"o4-mini-high"}:{sourceEvent:new Event("click"),nodeId:H,requestedModelId:"o3-mini-high"})};return{text:nt.tryItButton,onClick:Q}}case ee.FREE_USER_O3_MINI_HIGH:return{text:nt.getPlusButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Free banner - Get Plus button",eventProperties:R}),it(_,"Prompt textarea in-context upsell banner")}};case ee.DEEP_RESEARCH_IN_CONTEXT_UPSELL:{const H=se.findNode(Ee(t),ae=>Ri(ae.message)),Q=H?Mi(H.message):void 0;return{text:nt.tryItButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner Deep Research CTA Clicked","chatgpt_in_context_upsell_banner_deep_research_cta_clicked",{location:"In-context upsell deep research - Try it button",eventProperties:R}),c(A.Research,{clientThreadId:t}),p.focus(),p.setText(Q??"")}}}case"get_pro":return{text:nt.getProButton,onClick:()=>{N.logRateLimitUpgradePlanButtonClicked({...R,upgrade_plan_tye:"pro"}),v?M({authType:E?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:H=>{E?N.logLogInButtonClicked({location:"Rate limit banner Get Pro upsell",provider:H}):N.logSignUpButtonClicked({location:"Rate limit banner Get Pro upsell",provider:H})}}):it(_,"Prompt textarea rate limit banner")}};case ee.TRY_CODEX:return{text:nt.tryCodexButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner Codex CTA Clicked","chatgpt_in_context_upsell_banner_codex_cta_clicked",{location:"In-context upsell codex - Try Codex button",eventProperties:R}),_("/codex")}}}};vn(()=>{!S.get("should_change_model_picker",!0)&&R.type==="o3-mini-high-in-context-upsell-plus"&&(R.type="o3-mini-high-in-context-upsell-plus-no-model-switch"),N.logRateLimitBannerShown(R),i?.()});const[G,W]=d??[];let L=W;G===ee.AUTHENTICATE&&F&&(L=ee.AUTHENTICATE_SECONDARY);const T={primaryAction:I(G),secondaryAction:I(L)};return e.jsx(Ga,{onDismiss:n,title:a,description:l,actions:T,onInteract:o})},nt=Ue({getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"},getProButton:{id:"Pl8/Vk",defaultMessage:"Get Pro"},newChatButton:{id:"7OvnJ5",defaultMessage:"New chat"},tryItButton:{id:"zPDzun",defaultMessage:"Try it"},tryCodexButton:{id:"KcWniZ",defaultMessage:"Try Codex"}}),Ap=({clientThreadId:t,rateLimitInfo:s,onDismiss:n,onInteract:o,onMount:i})=>{const{name:r,title:a,call_to_action:d,description:l}=s,u=Rt(),m=_t(!0),{updateSystemHint:c}=fe(),p=kt(),x=_t(!1),g=ki(),h=re(t,se.getIsNewConversation),b=u?.planType??"unknown",y=_s(),w=Mt(),k=ct(w,"3809605125"),j=g&&"block_reason"in g?g.block_reason:null,R="banner_description",_=f.useMemo(()=>({type:r||"unknown",location:R,plan_type:b,is_new_conversation:h,is_hard_block:!!g,hard_block_reason:j??"",call_to_action:d}),[r,R,b,h,g,j,d]),M=yn(),v=Oa(),{isUnauthenticated:E}=Pe(),D=Cn(),F=Ha(vt.signUpButtonText),z=Ua({clientThreadId:t}),{layer:S}=He("1368081792"),I=V=>{switch(V){case ee.AUTHENTICATE:return{text:D?vt.logInButtonText:F,onClick:()=>{v({authType:D?"login":"signup",callback:H=>{D?N.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:H}):N.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:H})}})}};case ee.AUTHENTICATE_SECONDARY:return{text:D?F:vt.logInButtonText,onClick:()=>{v({authType:D?"signup":"login",callback:H=>{D?N.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:H}):N.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:H})}})}};case ee.GET_PLUS:return{text:bt.getPlusButton,onClick:()=>{N.logRateLimitGetPlusButtonClicked(_),E?v({authType:D?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:H=>{D?N.logLogInButtonClicked({location:"Rate limit banner Get Plus upsell",provider:H}):N.logSignUpButtonClicked({location:"Rate limit banner Get Plus upsell",provider:H})}}):it(M,"Prompt textarea rate limit banner")}};case ee.NEW_CHAT:return{text:bt.newChatButton,onClick:()=>{m({modelId:"",location:R})}};case ee.PAID_USER_O3_MINI_HIGH:{const H=se.getCurrentLeafId(Ee(t)),Q=()=>{N.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:S.get("should_change_model_picker",!0)?"In-context upsell o3-mini-high for Plus banner - Try it button":"In-context upsell o3-mini-high for Plus (no model switch) banner - Try it button",eventProperties:_}),S.get("should_change_model_picker",!0)&&x(k?{modelId:"o4-mini-high",location:"In-context upsell o4-mini-high for Plus banner - Try it button"}:{modelId:"o3-mini-high",location:"In-context upsell o3-mini-high for Plus banner - Try it button"}),z(k?{sourceEvent:new Event("click"),nodeId:H,requestedModelId:"o4-mini-high"}:{sourceEvent:new Event("click"),nodeId:H,requestedModelId:"o3-mini-high"})};return{text:bt.tryItButton,onClick:Q}}case ee.FREE_USER_O3_MINI_HIGH:return{text:bt.getPlusButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner O3 Mini High CTA Clicked","chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Free banner - Get Plus button",eventProperties:_}),it(M,"Prompt textarea in-context upsell banner")}};case ee.DEEP_RESEARCH_IN_CONTEXT_UPSELL:{const H=se.findNode(Ee(t),ae=>Ri(ae.message)),Q=H?Mi(H.message):void 0;return{text:bt.tryItButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner Deep Research CTA Clicked","chatgpt_in_context_upsell_banner_deep_research_cta_clicked",{location:"In-context upsell deep research - Try it button",eventProperties:_}),c(A.Research,{clientThreadId:t}),p.focus(),p.setText(Q??"")}}}case ee.TRY_CODEX:return{text:bt.tryCodexButton,onClick:()=>{N.logEventWithStatsig("In Context Upsell Banner Codex CTA Clicked","chatgpt_in_context_upsell_banner_codex_cta_clicked",{location:"In-context upsell codex - Try Codex button",eventProperties:_}),M("/codex")}}}};vn(()=>{!S.get("should_change_model_picker",!0)&&_.type==="o3-mini-high-in-context-upsell-plus"&&(_.type="o3-mini-high-in-context-upsell-plus-no-model-switch"),N.logRateLimitBannerShown(_),i?.()}),f.useEffect(()=>()=>{N.logEventWithStatsig("Rate Limit: Dismiss Banner","chatgpt_rate_limit_banner_dismissed",_)},[_]);const[G,W]=d??[];let L=W;G===ee.AUTHENTICATE&&y&&(L=ee.AUTHENTICATE_SECONDARY);const T={primaryAction:I(G),secondaryAction:I(L)};return e.jsx(Ga,{onDismiss:n,title:a,description:l,actions:T,onInteract:o})},bt=Ue({getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"},newChatButton:{id:"7OvnJ5",defaultMessage:"New chat"},tryItButton:{id:"zPDzun",defaultMessage:"Try it"},tryCodexButton:{id:"KcWniZ",defaultMessage:"Try Codex"}}),$i=t=>{const{value:s}=oe("1028682714");return s?e.jsx(Mp,{...t}):e.jsx(Ap,{...t})},Qi=Qn.div`group flex h-10 items-center gap-2 rounded-lg px-2 hover:bg-token-main-surface-secondary text-sm text-token-text-primary`;function Ep(){const{data:t,isLoading:s}=bl({cutId:"recent",limit:8}),{data:n,isLoading:o}=yl();return{isLoading:s||o,recent:t,pinned:n}}function Pp({query:t,onSelectGizmo:s,selectedIdx:n},o){const i=xl(),r=f.useRef([]),{isLoading:a,recent:d,pinned:l}=Ep();f.useImperativeHandle(o,()=>({handleEnterOnIndex:c=>{if(!m[c])return c<u.length?u[c].resource:"create"},getResultsLength:()=>u.length+1,scrollToItem:c=>{const p=r.current[c];p&&p.scrollIntoView({behavior:"instant",block:"nearest"})}}));let u=[];if(a)return e.jsx("div",{className:"absolute end-4 top-0 flex h-full items-center justify-center",children:e.jsx(qt,{})});d&&u.push(...d.pages.flatMap(c=>c.list.items).map(c=>({resource:c.resource,from:"recent"}))),l&&u.push(...l.items.map(c=>({resource:c,from:"pinned"}))),u=Sl(u,c=>c.resource.gizmo.id);const m=u.map(c=>c.resource.gizmo.tags?.includes(js.WorkspaceDisabled));return t&&t!==""&&(u=u.filter(c=>(c.resource.gizmo.display.name.toLowerCase()+c.resource.gizmo.display.description?.toLowerCase()+c.resource.gizmo.author.display_name?.toLowerCase()).includes(t?.toLowerCase()))),e.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[u.map((c,p)=>e.jsx("div",{ref:x=>{r.current[p]=x},tabIndex:p,onClick:()=>{m[p]||s(c.resource)},children:e.jsx(Ip,{gizmoResource:c.resource,from:c.from,showDescription:i,isSelected:n===p,grayedOut:m[p]})},c.resource.gizmo.id)),e.jsx("div",{ref:c=>{r.current[u.length]=c},tabIndex:u.length,onClick:()=>{s("create")},children:e.jsx(Np,{isSelected:n===u.length})},"create")]})}const Tp=f.forwardRef(Pp),Np=({isSelected:t})=>e.jsx(Qi,{className:t?"bg-token-main-surface-secondary":"",children:e.jsxs(ul,{to:"/gpts/editor",target:"_blank",className:"flex flex-row space-x-2 font-semibold",children:[e.jsx("span",{className:"self-center",children:e.jsx(wl,{className:"icon-sm"})}),e.jsx("span",{children:e.jsx(P,{...Xi.dropdownCreateLabel})})]})}),Bp=({onClick:t,onClose:s})=>{const[n,o]=f.useState(null),i=f.useRef(null),r=f.useRef(null),[a,d]=f.useState(0),l=K(),u=m=>{N.logEvent("Mentions Click Gizmo",{gizmo_id:m==="create"?"create":m.gizmo.id}),m!=="create"&&t(m)};return e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:l.formatMessage(Xi.searchPlaceholder),ref:i,onKeyDown:m=>{if(m.nativeEvent.isComposing)return;const c=r.current?.getResultsLength()??0;if((m.key==="Escape"||m.key==="Backspace"&&!n)&&(m.preventDefault(),s()),m.key==="Enter"||m.key==="Tab"){m.preventDefault();const p=r.current?.handleEnterOnIndex(a);if(!p)return;p==="create"?(window.open("/gpts/editor","_blank"),s()):u(p)}if(m.key==="ArrowDown"&&a<c-1){m.preventDefault();const p=a+1;r.current?.scrollToItem(p),d(p)}if(m.key==="ArrowUp"&&a>0){m.preventDefault();const p=a-1;r.current?.scrollToItem(p),d(p)}},onChange:m=>{o(m.target.value),d(0)},className:"bg-token-main-surface-primary w-full border-0 p-2 text-sm focus:outline-hidden"}),e.jsx(Tp,{ref:r,query:n,selectedIdx:a,onSelectGizmo:u})]})},Ma=({onClick:t,onClose:s})=>{const n=Ai(),o=!!n;return vn(()=>{N.logEvent("Mentions Opened",{gizmo_selector_disabled:o})}),o?e.jsx($i,{clientThreadId:fn,rateLimitInfo:n}):e.jsx("div",{onBlur:i=>{i.currentTarget.contains(i.relatedTarget)||s()},className:"popover border-token-border-default bg-token-main-surface-primary rounded-2xl border p-2 shadow-lg",children:e.jsx(Bp,{onClick:t,onClose:s})})};function Ip({gizmoResource:t,from:s,showDescription:n,isSelected:o,grayedOut:i}){const r=!!t.gizmo.tags?.includes(js.FirstParty);return e.jsxs(Qi,{className:Y(o?"bg-token-main-surface-secondary":"",i&&"opacity-50"),children:[e.jsx(Gi,{isFirstParty:r,src:t.gizmo.display.profile_picture_url,className:Y("icon-xl h-7 w-7 shrink-0",i&&"grayscale group-hover:grayscale-0")}),e.jsxs("div",{className:"flex h-fit grow flex-row justify-between space-x-2 overflow-hidden text-ellipsis whitespace-nowrap",children:[e.jsxs("div",{className:"flex flex-row space-x-2",children:[e.jsx("span",{className:"shrink-0 truncate font-semibold",children:t.gizmo.display.name}),n&&e.jsx("span",{className:"text-token-text-tertiary grow truncate text-sm sm:max-w-xs lg:max-w-md",children:t.gizmo.display.description})]}),e.jsx("span",{className:"shrink-0 self-center",children:s==="recent"?e.jsx(Cl,{className:"icon-sm"}):e.jsx(vl,{className:"icon-sm"})})]})]})}const Xi=Ue({talkingTo:{id:"TaggingDropdown.talkingTo",defaultMessage:"Talking to"},dropdownCreateLabel:{id:"TaggingDropdown.dropdownCreateLabel",defaultMessage:"Create a GPT"},searchPlaceholder:{id:"TaggingDropdown.searchPlaceholder",defaultMessage:"Search recent and pinned GPTs"}});function Lp({systemHint:t,label:s,logo:n,isDisabled:o=!1,composerController:i,analyticsMetadata:r,onClick:a,showLabel:d=!1,splitButtonDropdownContent:l,showSplitButton:u,dropdownContent:m,dataTestid:c,tooltip:p,as:x}){const{name:g,systemHint:h}=t,b=h,{setThreadSystemHintMode:y,clearAllSystemHintModeTriggers:w}=fe(),k=Ut(b),j=!!t.composerBarButtonInfo?.upsell,R=Ye.useStore(),{value:_}=oe("2454940646"),M=Gt(),v=[A.Search,A.Think].includes(b);f.useEffect(()=>{o&&M.has(b)&&y(b,!1,r)},[o,b,r,y,M,v]);const E=f.useCallback(z=>{z.stopPropagation(),z.preventDefault();let S=!0;_&&v&&(R.getState().persistedSystemHints.has(A.Search)||R.getState().persistedSystemHints.has(A.Think))&&(S=!1),S&&w(),y(b,!k,r),k||(i.removeSystemHints(),i.focus()),wn(b,k?ye.Disable:ye.Enable,r.clientThreadId),a?.(z)},[r,_,w,i,b,v,k,a,y,R]),D=j?e.jsx("div",{className:"py-2",children:e.jsx(_n,{location:b,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0})}):null;return e.jsx(Ps,{pressed:k,disabled:o,icon:n,label:s,ariaLabel:g,animatedLabel:!d,showLabel:d||k,onClick:E,dropdownContent:m??D,splitButtonDropdownContent:l,showSplitButton:u,dataTestid:c,tooltip:p,as:x})}function Dp({composerController:t,systemHint:s,composerBarButtonInfo:n,isDisabled:o,clientThreadId:i,showLabel:r,labelOverride:a,disabledReason:d,rateLimitProgress:l,dropdownContent:u,splitButtonDropdownContent:m,showSplitButton:c,logoOverride:p,dataTestid:x,tooltipPosition:g,disableNuxMarkdown:h,as:b}){const y={clientThreadId:i},w=k=>e.jsx(Fp,{composerBarButtonInfo:n,isDisabled:o,analyticsMetadata:y,systemHint:s.systemHint,disabledReason:d,rateLimitProgress:l,tooltipPosition:g,disableNuxMarkdown:h,children:k});return e.jsx(Lp,{isDisabled:o,systemHint:s,label:a??s.name,logo:p??e.jsx(Yt,{svgString:s.logo,className:"h-[18px] w-[18px]"}),composerController:t,analyticsMetadata:y,showLabel:r,dropdownContent:u,splitButtonDropdownContent:m,showSplitButton:c,dataTestid:x,tooltip:w,as:b})}function Fp({children:t,isDisabled:s,systemHint:n,composerBarButtonInfo:o,analyticsMetadata:i,disabledReason:r,rateLimitProgress:a,tooltipPosition:d="bottom",disableNuxMarkdown:l}){const u=_l(o.announcementKey,n),m=jl({composerBarButtonInfo:o,children:t,disableMarkDown:l}),c=K();let p=null;return a&&a.remaining?p=e.jsx(Ji,{remaining:a.remaining,reset_date:a.reset_after,text:o.tooltipText}):o.tooltipText&&(p=e.jsx(io,{text:o.tooltipText})),u?m:e.jsx("div",{children:e.jsx(zt,{label:s?r===rt.HasAttachedFiles?c.formatMessage({id:"hhxO6y",defaultMessage:"Reason disabled for attachments"}):r===rt.DeepResearchHighLoad?c.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):r===rt.RateLimitReached?o.rateLimitReachedText:o.disabledText:p,side:d,onOpenChange:x=>{x&&wn(n,ye.Hover,i.clientThreadId)},children:t})})}const io=({text:t})=>e.jsx("span",{children:t}),Ji=({remaining:t,reset_date:s,text:n})=>{const{locale:o}=K(),i=kl(s,o);return e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"text-token-text-tertiary block text-xs font-semibold",children:e.jsx(P,{id:"PromptTextarea.systemHintTooltip.remaining",defaultMessage:"{remaining} available until {resetDate}",values:{remaining:t,resetDate:i}})}),e.jsx(io,{text:n})]})};function Op({children:t,isDisabled:s,disabledReason:n,logEvent:o}){const i=K(),r=Xn(),a=Ei(m=>m.bySystemHint(A.Research)),d=i.formatMessage({id:"SpX/tG",defaultMessage:"Get a detailed report"});let l=null;a&&a.remaining?l=e.jsx(Ji,{remaining:a.remaining,reset_date:a.reset_after,text:d}):l=e.jsx(io,{text:d});const u=n===rt.DeepResearchHighLoad?i.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):n===rt.RateLimitReached&&r?i.formatMessage({id:"T3aUKM",defaultMessage:"More available {time}"},{time:r.resets_after_text}):void 0;return e.jsx(zt,{className:"inline-block",label:s?u:l,side:"bottom",onOpenChange:m=>{m&&o(ye.Hover)},children:t})}const Hp=({items:t,searchTerm:s,setSearchTerm:n,selectedItems:o,searchPlaceholder:i,handleSelectItem:r,showSelectAllRepos:a,loading:d,endReposRef:l})=>{const u=Rl(),m=a&&o?.includes("$all_accessible_repos");return e.jsx(J.div,{variants:u,initial:"initial",animate:"animate",exit:"exit",className:"relative",children:e.jsxs("div",{className:"border-token-border-default bg-token-main-surface-primary flex max-h-60 w-full flex-col gap-2 overflow-y-auto rounded-lg border p-4",children:[e.jsx("input",{type:"text",value:s,onChange:c=>n(c.target.value),placeholder:i,className:"text-token-text-primary bg-token-main-surface-primary border-token-border-default w-full rounded-sm border-1 px-2 py-1 text-sm focus:ring-0 focus:ring-offset-0 focus:outline-hidden"}),t?.map(c=>{const p=o?.includes(c.name);return e.jsx(lt,{onClick:()=>{r(c)},isSelected:p,label:c.name,subtitle:c.description??void 0,className:"mx-0! w-full",selectedIconClassName:"color:black dark:color-gray"},c.name)}),d&&e.jsxs("div",{className:"text-token-text-secondary flex items-center justify-center gap-2 text-xs",children:[e.jsx(qt,{}),e.jsx(P,{id:"M1WgQ2",defaultMessage:"Searching..."})]}),a&&e.jsx(lt,{onClick:()=>{r({name:"$all_accessible_repos"})},className:"mx-0! w-full",isSelected:m,label:e.jsx(P,{id:"pJnTxe",defaultMessage:"All Repositories"}),subtitle:e.jsx(P,{id:"EhTGqu",defaultMessage:"Select all repositories accessible to ChatGPT"}),selectedIconClassName:"color:black"},"select-all-repos"),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-primary border-token-border-default mt-2 mb-2 border-b"}),e.jsx(lt,{onClick:()=>{window.open(za,"_blank")},isSelected:!1,isActive:!1,label:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(P,{id:"ICVOEb",defaultMessage:"Configure Repositories"})}),subtitle:e.jsx(P,{id:"GXUcp/",defaultMessage:"Configure which repositories ChatGPT can access"}),className:"mx-0! w-full",infoIcon:e.jsx(Wt,{className:"icon-sm"}),infoLink:"https://help.openai.com/en/articles/11145903-chatgpt-connectors "},"configure-repos")]}),e.jsx("div",{className:"border-token-border-default my-2 border-t",ref:l}),e.jsx("div",{className:"text-token-text-secondary justify-center text-center text-xs",children:e.jsx(P,{id:"5A9QzP",defaultMessage:"Not seeing your repositories? {helpLink}.",values:{helpLink:e.jsx(e.Fragment,{children:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(P,{id:"sVuhcw",defaultMessage:"Learn more"})})})}})})]})})},Up=({items:t,searchTerm:s,setSearchTerm:n,selectedItems:o,searchPlaceholder:i,handleSelectItem:r,showSelectAllRepos:a,loading:d,endReposRef:l})=>{const u=f.useRef(null),m=a&&o?.includes("$all_accessible_repos");return f.useEffect(()=>{requestAnimationFrame(()=>{u.current?.focus(),u.current?.select()})},[]),e.jsxs(e.Fragment,{children:[e.jsx(U.Item,{className:"mx-1.5 mb-1 p-0!",onClick:c=>{c.preventDefault(),u.current?.focus()},onFocus:()=>u.current?.focus(),tabIndex:-1,children:e.jsx("input",{type:"text",value:s,onChange:c=>n(c.target.value),placeholder:i,className:"text-token-text-primary bg-token-bg-primary border-token-border-default m-[-1px] w-full rounded-[10px] border-1 px-2.5 py-2 text-sm focus:ring-0 focus:ring-offset-0 focus:outline-hidden",ref:u,onKeyDown:c=>{if(on(c,"ArrowDown"))c.preventDefault(),an(c.currentTarget);else{if((on(c,"ArrowLeft")||on(c,"ArrowRight"))&&c.currentTarget.selectionStart===0)return;c.stopPropagation()}}})}),t?.map(c=>{const p=o?.includes(c.name);return e.jsx(U.Item,{onClick:x=>{x.preventDefault(),r(c),p&&!s&&an(x.currentTarget)},secondary:c.description,trailing:p&&ra,children:c.name},c.name)}),d&&e.jsx("div",{className:"text-token-text-tertiary mx-1.5 px-2 py-2.5 text-sm",role:"alert","aria-busy":"true",children:e.jsx(P,{id:"M1WgQ2",defaultMessage:"Searching..."})}),a&&e.jsx(U.Item,{onClick:c=>{c.preventDefault(),r({name:"$all_accessible_repos"}),m&&!s&&an(c.currentTarget)},secondary:e.jsx(P,{id:"EhTGqu",defaultMessage:"Select all repositories accessible to ChatGPT"}),trailing:m&&ra,children:e.jsx(P,{id:"pJnTxe",defaultMessage:"All Repositories"})}),(a||t.length>0)&&e.jsx(U.Separator,{}),e.jsx(U.Item,{onClick:()=>{window.open(za,"_blank")},secondary:e.jsx(P,{id:"GXUcp/",defaultMessage:"Configure which repositories ChatGPT can access"}),trailing:e.jsx(Wt,{className:"icon-sm"}),children:e.jsx(P,{id:"ICVOEb",defaultMessage:"Configure Repositories"})}),e.jsx("div",{className:"text-token-text-tertiary mx-1.5 justify-center px-2.5 py-2 text-center text-xs",ref:l,children:e.jsx(P,{id:"4Z21ID",defaultMessage:"Not seeing a repository? {helpLink}",values:{helpLink:e.jsx(e.Fragment,{children:e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(P,{id:"sVuhcw",defaultMessage:"Learn more"})})})}})})]})};function on(t,s){return t.key===s&&!t.nativeEvent.isComposing&&!t.ctrlKey&&!t.altKey&&!t.shiftKey&&!t.metaKey}function an(t){const s=t.closest("[role=menuitem]");if(!s)return;let n=s.nextElementSibling;for(;n&&n.getAttribute("role")!=="menuitem";)n=n.nextElementSibling;if(!n)for(n=s.previousElementSibling;n&&n.getAttribute("role")!=="menuitem";)n=n.previousElementSibling;n instanceof HTMLElement&&n.focus()}function Gp(t,s){const[n,o]=f.useState(t),i=f.useRef(ln(r=>o(r),s));return f.useEffect(()=>(i.current=ln(r=>{o(r)},s),()=>{i.current?.cancel()}),[s]),f.useEffect(()=>{i.current?.(t)},[t]),n}const Aa=({searchTerm:t,setSearchTerm:s,selectedRepos:n,handleSelectRepo:o,linkId:i,asSubmenu:r})=>{const a=Ke(),d=K(),l=Mt(),u=Gp(t,300),{data:m,isFetching:c,isFetchingNextPage:p,isError:x,fetchNextPage:g,hasNextPage:h}=dl({queryKey:["github-repos",u,i],queryFn:async({pageParam:M=null})=>u.length===0?{repos:[],next_token:null}:ct(l,"1524828339")?await Sa.safePost("/aip/connectors/github/search_repos",{requestBody:{query:u,limit:20,next_token:M,link_id:i}}):await Sa.safePost("/aip/connectors/github/search_repos_v2",{requestBody:{query:u,limit:2,next_token:M,link_id:i}}),getNextPageParam:M=>M.next_token??void 0,initialPageParam:null,retry:1}),b=f.useRef(null),y=1,w=f.useRef(0);f.useEffect(()=>{if(!h||p)return;const M=b.current,v=new IntersectionObserver(E=>{E[0].isIntersecting&&w.current<y&&g()},{threshold:1});return M&&v.observe(M),()=>{M&&v.unobserve(M)}},[h,p,g]),f.useEffect(()=>{w.current=0},[u]),f.useEffect(()=>{x?(w.current+=1,w.current===1&&a.danger("Request error fetching Github repositories. Try disconnecting and connecting GitHub again.")):!p&&!x&&(w.current=0)},[x,p,a]);let k=m&&u?m.pages.flatMap(M=>M.repos).flatMap(M=>M.repository_full_name):[];k=Array.from(new Set([...k,...n.selectedRepos??[]]));const j=M=>{o(M.name)},R=r?Up:Hp,_=e.jsx(R,{items:k?.map(M=>({name:M}))??[],searchTerm:t,setSearchTerm:s,selectedItems:[...n.selectedRepos??[],...n.selectedAllRepos?["$all_accessible_repos"]:[]],searchPlaceholder:d.formatMessage({id:"lEa/MK",defaultMessage:"Add a repositoryâ€¦"}),handleSelectItem:j,showSelectAllRepos:!1,loading:c||p,endReposRef:b});return r?_:e.jsx("div",{children:_})};function zp({clientThreadId:t,repoSelectorOpen:s,linkId:n,triggerButton:o,setRepoSelectorOpen:i,asSubmenu:r}){const{selectedRepos:a,setSelectedRepos:d}=jn(t),{deleteSource:l,addSource:u}=Vt(t),[m,c]=f.useState(""),p=f.useRef(null),x=g=>{let h=[],b=!1;g==="$all_accessible_repos"?(b=!a?.selectedAllRepos,d({selectedRepos:[],selectedAllRepos:b})):a?.selectedRepos?.includes(g)?(h=a.selectedRepos?.filter(y=>y!==g),d({selectedRepos:h,selectedAllRepos:!1})):(h=[...a?.selectedRepos??[],g],d({selectedRepos:h,selectedAllRepos:!1})),b||h.length>0?u(Cs.GITHUB_CONNECTOR):r||l(Cs.GITHUB_CONNECTOR)};if(r){if(!n)return null;const g=Wa(a);return e.jsxs(U.Sub,{open:g?s:!0,onOpenChange:h=>{g&&i(h)},children:[e.jsx(U.SubMenuTrigger,{className:"ps-4",icon:Ml,children:o}),e.jsx(U.Portal,{children:e.jsx(U.SubContent,{children:e.jsx(Aa,{asSubmenu:r,searchTerm:m,setSearchTerm:c,selectedRepos:{selectedRepos:a.selectedRepos?[...a.selectedRepos]:[],selectedAllRepos:a.selectedAllRepos},handleSelectRepo:x,linkId:n})})})]})}return e.jsx(kn,{open:s,onOpenChange:g=>{i(g),g||c("")},children:e.jsxs(Va,{children:[o,n&&e.jsx(Rn,{children:e.jsx(Mn,{side:"bottom",align:"start",ref:p,children:e.jsx(Aa,{asSubmenu:r,searchTerm:m,setSearchTerm:c,selectedRepos:{selectedRepos:a.selectedRepos?[...a.selectedRepos]:[],selectedAllRepos:a.selectedAllRepos},handleSelectRepo:x,linkId:n})})})]})})}const Wp=30,Vp=25,rn=6,qp=t=>(t.sort((s,n)=>s.connected&&!n.connected?-1:!s.connected&&n.connected?1:s.type==="web"&&n.type!=="web"?-1:s.type!=="web"&&n.type==="web"?1:s.name.localeCompare(n.name)),t),Ns=({isLoading:t=!1,clientThreadId:s,enabledConnectors:n,includeWebSearch:o=!0,includeSyncConnectors:i=!1})=>{"use forget";const r=K(),{selectedSources:a,toggleSource:d}=Vt(s),{connectorLinks:l,isLoading:u}=Vi(),{connectionInstanceData:m,refetch:c,isLoading:p}=ks({skip:!i}),x=f.useMemo(()=>[...m?.connection_statuses??[]].sort(qa),[m]),{connectedRows:g,disconnectedRows:h}=f.useMemo(()=>{const y=[];o&&y.push({connected:!0,type:"web",name:"web",element:e.jsx(U.CheckboxItem,{icon:Ya,checked:a?.has("web"),onCheckedChange:()=>{d("web")},children:r.formatMessage(hn.webSearch)})}),i&&x.forEach(j=>{y.push({connected:j.user_connection_details.auth_status!=="not_connected"&&j.user_connection_details.activation_status!=="inactive",type:"sync",name:j.connection_display_info.display_name,element:e.jsx($p,{connection:j,location:"user_dropdown",refetch:c},j.user_connection_details.connection_instance_id)})}),a&&n.forEach(j=>{const _=!!l.get(j.id)?.[0];y.push({connected:_,type:"access",name:j.name,element:e.jsx(Kp,{connector:j,connectorLinks:l,selectedSources:a,toggleSource:d,clientThreadId:s})})}),qp(y);const[w,k]=y.reduce(([j,R],_)=>_.connected?[[...j,_],R]:[j,[...R,_]],[[],[]]);return{connectedRows:w,disconnectedRows:k}},[s,l,n,i,o,r,c,a,x,d]);if(!s||!a)return null;if(p||u||t)return e.jsx("div",{className:"w-50 px-4",children:e.jsx(Wi,{lines:5,size:"lg",widthVariance:0,width:100})});const b=rn-g.length;return e.jsxs("div",{className:"w-70",children:[e.jsx("div",{className:g.length>rn?"border-token-border-secondary border-b":"",style:{maxHeight:`calc(2.25rem * ${rn+.5})`,overflowY:"auto"},children:g.map(({element:y})=>e.jsx(e.Fragment,{children:y}))}),h.length>0&&b>0&&e.jsxs(e.Fragment,{children:[g.length>0&&e.jsx(U.Separator,{}),h.slice(0,b).map(({element:y})=>e.jsx(e.Fragment,{children:y}))]}),e.jsx(U.Item,{icon:An,onSelect:()=>{window.location.hash="#settings/ConnectorSettings"},children:r.formatMessage(hn.connectApps)})]})},Ea=({isLoading:t=!1,clientThreadId:s,enabledConnectors:n,trigger:o,includeWebSearch:i})=>{const{deleteSource:r}=Vt(s);return e.jsxs(U.Root,{"data-testid":"sources-pill",onOpenChange:a=>{a||(Wa(Nl(Ee(s)))||r(Cs.GITHUB_CONNECTOR),Ee(s)?.selectedSources?.size===0&&Sm(s,u=>{u.selectedSources=void 0}))},children:[o,e.jsx(U.Portal,{children:e.jsx(U.Content,{alignOffset:-8,size:"auto",children:e.jsx(Ns,{isLoading:t,clientThreadId:s,enabledConnectors:n,includeWebSearch:i})})})]})},ms=3,Yp=t=>{"use forget";const s=ml.c(30),{clientThreadId:n,includeSyncConnectors:o,includeWebSearch:i}=t,{selectedSources:r}=Vt(n),{availableConnectors:a}=rp(!0),d=!o;let l;s[0]!==d?(l={skip:d},s[0]=d,s[1]=l):l=s[1];const{connectionInstanceData:u}=ks(l);let m;s[2]!==r?(m=r??[],s[2]=r,s[3]=m):m=s[3];let c;s[4]!==m?(c=[...m],s[4]=m,s[5]=c):c=s[5];let p;s[6]!==i||s[7]!==c?(p=c.filter(E=>E!=="web"||i),s[6]=i,s[7]=c,s[8]=p):p=s[8];let x;s[9]!==a||s[10]!==p?(x=p.map((E,D)=>{if(E==="web")return e.jsx(Ya,{className:"icon-md"},D);const F=a.find(z=>z.type===E);return F?e.jsx(Qa,{connector:F,size:"small"},D):null}).filter(Boolean),s[9]=a,s[10]=p,s[11]=x):x=s[11];const g=x;let h;s[12]!==u?.connection_statuses||s[13]!==o?(h=o?u?.connection_statuses.map(Qp):[],s[12]=u?.connection_statuses,s[13]=o,s[14]=h):h=s[14];const b=h;let y;if(s[15]!==g||s[16]!==b){let E;s[18]!==b?(E=b??[],s[18]=b,s[19]=E):E=s[19],y=g.concat(E),s[15]=g,s[16]=b,s[17]=y}else y=s[17];const w=y;let k;s[20]!==w?(k=w.length>ms?[...w.slice(0,ms-1),e.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:w.length-ms+1},"more")]:w,s[20]=w,s[21]=k):k=s[21];const j=k;let R;s[22]!==j?(R=j.length>0?e.jsx("div",{className:"flex items-center gap-1",children:j.map(Xp)}):e.jsx(En,{className:"icon-md"}),s[22]=j,s[23]=R):R=s[23];let _;s[24]!==j.length?(_=j.length<ms&&e.jsx("span",{"data-label":!0,className:"ms-1.5",children:e.jsx(P,{id:"DhW8Wx",defaultMessage:"Sources"})}),s[24]=j.length,s[25]=_):_=s[25];let M;s[26]===Symbol.for("react.memo_cache_sentinel")?(M=e.jsx(jt,{className:"icon-sm ms-1.5 @max-[521px]/thread:ms-1"}),s[26]=M):M=s[26];let v;return s[27]!==R||s[28]!==_?(v=e.jsx(U.BasicTrigger,{asChild:!0,children:e.jsxs(Ts,{as:"button",spacing:"compact",children:[R,_,M]})}),s[27]=R,s[28]=_,s[29]=v):v=s[29],v},Kp=({connector:t,connectorLinks:s,selectedSources:n,clientThreadId:o,toggleSource:i})=>{const r=K(),{selectedRepos:a}=jn(o),[d,l]=f.useState(!1),u=s.get(t.id)?.[0],m=!!u,c=n.has(t.type)&&m,p=f.useMemo(()=>{if(a?.selectedRepos?.length&&a?.selectedRepos?.length>=1){const y=a.selectedRepos;let w=y[0];if(w.length>Wp){const j=(Vp-3)/2;w=w.slice(0,Math.floor(j))+"..."+w.slice(Math.floor(-11))}const k=y.length-1;return k>0?`${w} +${k}`:w}},[a.selectedRepos]),x=t.type===Cs.GITHUB_CONNECTOR&&m&&c,g=ip[t.type]?.title,h=g?r.formatMessage(g):t.name,b=e.jsx(Qa,{connector:t,size:"small"});return e.jsxs(e.Fragment,{children:[m?e.jsx(U.CheckboxItem,{icon:b,checked:c,onCheckedChange:()=>{i(t.type)},children:h}):e.jsx(U.Item,{onSelect:()=>{window.location.hash=`#settings/ConnectorSettings?connector=${t.id}&add-connector-link=true`},icon:b,trailing:e.jsx("div",{className:"text-token-text-tertiary",children:r.formatMessage(hn.connect)}),children:h}),x&&e.jsx(zp,{asSubmenu:!0,clientThreadId:o,setRepoSelectorOpen:l,repoSelectorOpen:d,linkId:u?.id,triggerButton:p??r.formatMessage({id:"sDCihQ",defaultMessage:"Repositories"})},t.type)]})},$p=({connection:t,refetch:s,location:n})=>{const o=K(),[i,r]=f.useState(!1),[a,d]=f.useState(),l=t.user_connection_details.connection_instance_id,u=Ke(),m=Al(),c=t.user_connection_details.knowledge_connector_type,p=c==="google_drive_oauth",x=f.useCallback(async()=>{try{r(!0),await El({connectorType:c,connectionId:l,location:n,intl:o})}catch(j){j instanceof Error?u.danger(j.message):u.danger(o.formatMessage({id:"FNXFnS",defaultMessage:"Encountered an error connecting your account. Please try again later."}))}finally{r(!1),s?.()}},[l,c,o,n,s,u]),[g,h]=f.useState(!1),b=()=>p?h(!0):x(),y=t.user_connection_details.activation_status==="inactive"&&t.user_connection_details.auth_status==="not_connected",w=["activating","partially_activated"].includes(t.user_connection_details.activation_status),k=y&&!m||w;return e.jsxs(e.Fragment,{children:[a&&e.jsx(Ka,{connection:a,onClose:()=>d(void 0)}),g&&e.jsx(Pl,{isAdminFlow:!1,onClose:()=>h(!1),connectionId:l,location:n,onSuccess:s}),e.jsx(U.Item,{style:{cursor:k?void 0:"default"},onSelect:j=>{if(j.stopPropagation(),j.preventDefault(),y){b();return}if(w){d(t);return}},icon:e.jsx("img",{src:t.connection_display_info.icon_url??"",alt:t.connection_display_info.display_name,className:"icon-md"}),trailing:i?e.jsx(qt,{className:"icon-md"}):e.jsx($a,{connection:t,location:"user_dropdown",inactiveButtonOverride:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(Tl,{connection:t,refetch:s,location:"user_dropdown"})})}),children:t.connection_display_info.display_name},t.connection_display_info.display_name)]})},hn=Ue({allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"}});function Qp(t){return e.jsx("img",{src:t.connection_display_info.icon_url??"",alt:t.connection_display_info.display_name,className:"icon-md"},t.connection_display_info.display_name)}function Xp(t,s){return e.jsx("div",{className:"flex h-[18px] w-[18px] shrink-0 items-center justify-center",children:t},s)}function Jp({clientThreadId:t,gizmoId:s,showLabel:n=!1,isDisabled:o}){const i=Bl(t,s),r=kt(),a=Ut(A.Research),{setThreadSystemHintMode:d,clearAllSystemHintModeTriggers:l}=fe(),u=!!Xn(),{value:m}=oe("1416952492"),c=m?rt.DeepResearchHighLoad:u?rt.RateLimitReached:void 0;return i?e.jsx("div",{"data-testid":"system-hint-research",style:{viewTransitionName:`var(--vt-composer-${A.Research}-action)`},children:e.jsx(Zp,{composerController:r,isThreadInSystemHintMode:a,setThreadSystemHintMode:d,clearAllSystemHintModeTriggers:l,clientThreadId:t,showLabel:n,isDisabled:o||!!c,disabledReason:c})},`system-hint-${A.Research}`):null}function Zp({composerController:t,isThreadInSystemHintMode:s,setThreadSystemHintMode:n,clearAllSystemHintModeTriggers:o,clientThreadId:i,showLabel:r=!1,isDisabled:a=!1,disabledReason:d}){const l=K(),u={clientThreadId:i},m=l.formatMessage({id:"ORxecl",defaultMessage:"Deep research"}),c=y=>{y===ye.Hover?N.logEventWithStatsig("Composer Research Button Hovered","composer_research_button_hovered",u):y===ye.Enable?N.logEventWithStatsig("Composer Research Button Enabled","composer_research_button_enabled",u):y===ye.Disable&&N.logEventWithStatsig("Composer Research Button Disabled","composer_research_button_disabled",u)},p=y=>{y.stopPropagation(),y.preventDefault(),o(),n(A.Research,!s,u),s||(t.removeSystemHints(),t.focus()),c(s?ye.Disable:ye.Enable)},x=oe("3544641259")?.value,{availableConnectors:g,isLoading:h}=zi(),b=y=>e.jsx(Op,{disabledReason:d,isDisabled:a,logEvent:c,children:y});return e.jsx(Ps,{pressed:s,disabled:a,icon:e.jsx(Il,{className:"h-[18px] w-[18px]"}),label:m,animatedLabel:!r,showLabel:r||s,onClick:p,ariaLabel:m,dataTestid:"composer-button-deep-research",splitButtonDropdownContent:x?e.jsx(Ns,{isLoading:h,clientThreadId:i,enabledConnectors:g,includeSyncConnectors:!1,includeWebSearch:!0}):void 0,showSplitButton:s&&x,tooltip:b,as:x?"dropdown":"popover"})}function ef({clientThreadId:t,gizmoId:s,composerController:n,isDisabled:o}){return Ll({clientThreadId:t,gizmoId:s})?e.jsx("div",{"data-testid":"system-hint-reason",style:{viewTransitionName:`var(--vt-composer-${A.Think}-action)`},children:e.jsx(tf,{clientThreadId:t,composerController:n,isDisabled:o})},`system-hint-${A.Think}`):null}function tf({clientThreadId:t,composerController:s,isDisabled:n}){const o=K(),i=!!Jn();n=n||i;const r=o.formatMessage({id:"T+qu+0",defaultMessage:"Reason"}),{setThreadSystemHintMode:a,clearAllSystemHintModeTriggers:d}=fe(),l=Ut(A.Think),u=Ye.useStore(),m=Gt(),{isUnauthenticated:c}=Pe();f.useEffect(()=>{n&&m.has(A.Think)&&a(A.Think,!1,{clientThreadId:t})},[n,m,a,t]);const p=h=>{if(h.stopPropagation(),h.preventDefault(),c)return;let b=!0;u.getState().persistedSystemHints.has(A.Search)&&(b=!1),b&&d(),a(A.Think,!l,{clientThreadId:t}),l||(s.removeSystemHints(),s.focus()),l?N.logEventWithStatsig("Composer Think Button Disabled","composer_think_button_disabled",{clientThreadId:t}):N.logEventWithStatsig("Composer Think Button Enabled","composer_think_button_enabled",{clientThreadId:t})},x=c?e.jsx(_n,{location:A.Think,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0}):void 0,g=e.jsx(Ps,{pressed:l,disabled:n,icon:e.jsx(Fl,{className:"h-[18px] w-[18px]"}),label:r,ariaLabel:r,animatedLabel:!0,showLabel:!0,onClick:p,dropdownContent:x,dataTestid:"composer-button-reason"});return e.jsx(Dl,{isDisabled:n,clientThreadId:t,children:g})}const sf=["o1","o1-pro","gpt-4"];function nf({account:t,clientBootstrapFlags:s,features:n,clientThreadId:o,currentModelConfig:i,composerController:r,isDisabled:a,gizmoId:d,hasFiles:l}){const{prospectiveModelId:u}=Rs(o),m=Ms(o),c=Pn(d),{userIsInSearchHoldoutWithWebDisabled:p}=Ol(),x=i?.enabledTools?.includes(Pi.Search),g=m==null||m?.kind===De.PrimaryAssistant||m?.kind===De.GizmoInteraction&&c,{isUnauthenticated:h}=Pe(),b=bm(A.Search);return x===!1||h&&s?.includes(vs.AnonSearchHoldout)||!h&&(t==null||t.isFree())&&(s?.includes(vs.FreeSearchHoldout)||p)||!b||!h&&(t==null||t.isEnterprisey())&&!n?.includes(ym.BrowsingAvailable)||!g?null:e.jsx("div",{"data-testid":"system-hint-search",style:{viewTransitionName:`var(--vt-composer-${A.Search}-action)`},children:e.jsx(of,{clientThreadId:o,composerController:r,modelSupportsSearch:x??(h||t?.isFree()||!!u&&!sf.includes(u)),isDisabled:a,disabledReason:x?l?gs.HasAttachedFiles:void 0:gs.ModelNotSupported,currentModelName:i?.title??""})},`system-hint-${A.Search}`)}function of({clientThreadId:t,composerController:s,isDisabled:n,disabledReason:o,currentModelName:i,modelSupportsSearch:r}){const a=K(),d=Hl(),l=a.formatMessage({id:"TbHx8d",defaultMessage:"Search"}),{setThreadSystemHintMode:u,clearAllSystemHintModeTriggers:m}=fe(),c=Ye.useStore(),p=Gt();n=n||!r,f.useEffect(()=>{n&&p.has(A.Search)&&u(A.Search,!1,{clientThreadId:t})},[n,p,u,t]);const x=g=>{g.stopPropagation(),g.preventDefault();let h=!0;c.getState().persistedSystemHints.has(A.Think)&&(h=!1),h&&m(),u(A.Search,!d,{clientThreadId:t}),d||(s.removeSystemHints(),s.focus()),N.logEventWithStatsig("Composer Search Button Clicked","composer_search_button_clicked",{clientThreadId:t}),d&&s.trimLeadingText(/^search\b/i)};return e.jsx(rf,{analyticsMetadata:{clientThreadId:t},isThreadUsingSearchMode:d,isDisabled:n,disabledReason:o,currentModelName:i,children:e.jsx(Ps,{pressed:d,disabled:n??!1,icon:e.jsx(Ul,{className:"h-[18px] w-[18px]"}),label:l,ariaLabel:l,animatedLabel:!0,showLabel:!0,onClick:x,dataTestid:"composer-button-search"})})}function af(){const t=Xa(),s=Oe(pe.hasSeenComposerSearchButtonTooltip);return!s.isLoading&&s.eligible&&!t}function rf({children:t,analyticsMetadata:s,isThreadUsingSearchMode:n,isDisabled:o,disabledReason:i,currentModelName:r}){const a=af()&&!n,d=Oe(pe.hasSeenComposerSearchButtonTooltip);return a?e.jsx(Tn,{announcementKey:pe.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(P,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:d.markAsViewed,sideOffset:0,className:"xs:max-w-sm! max-w-2xs!",description:e.jsx(P,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(Gl,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(P,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(zt,{className:"inline-block",label:o?i===gs.ModelNotSupported?e.jsx(P,{id:"GZemJe",defaultMessage:"Search disabled for {modelName}",values:{modelName:`${r}`}}):i===gs.HasAttachedFiles?e.jsx(P,{id:"ssHAbn",defaultMessage:"Remove attachments to search"}):e.jsx(P,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(P,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"bottom",onOpenChange:l=>{l&&N.logEventWithStatsig("Composer Search Button Hovered","composer_search_button_hovered",s)},children:t})})}const lf=1;function cf({value:t=lf,size:s,onStateChange:n}){return e.jsx("div",{className:"relative flex h-full w-full flex-col items-center justify-center",children:e.jsxs(J.div,{animate:{translateY:t>1&&s==="small"?-1:0},onAnimationStart:()=>n?.("animating"),onAnimationComplete:()=>n?.("idle"),className:Y("relative",s==="small"?"h-5 w-5":"h-8 w-8"),children:[e.jsx(J.div,{style:{transformOrigin:"50% 100%",translateY:s==="large"?3:0},animate:{scale:t>1&&s==="small"?.85:1},className:"absolute start-0 top-0",children:e.jsx(zl,{"aria-label":"",className:Y(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(J.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>1?1:.9,opacity:t>1?1:0},style:{translateY:s==="large"?-1:0},className:"absolute start-0 top-0",children:e.jsx(Wl,{"aria-label":"",className:Y(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(J.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>2?1:.9,opacity:t>2?1:0},style:{translateY:s==="large"?-1:0},className:"absolute start-0 top-0",children:e.jsx(Vl,{"aria-label":"",className:Y(s==="small"?"h-5 w-5":"h-8 w-8")})})]})})}function uf(t){const{reasoningLevelTypes:s,reasoningLevelType:n}=t,{ReasoningLevels:o}=s;let i=1;return n===o.medium.type?i=2:n===o.high.type&&(i=3),e.jsx("div",{className:Y("relative flex h-5 w-5 items-center justify-center"),children:e.jsx(cf,{size:"small",value:i})})}const df=({isManualModelSelection:t,animatedLabel:s,reasoningLevelTypes:n,reasoningLevelType:o,modelName:i,onResetReasoningLevel:r,onReasoningLevelChanged:a,type:d})=>{const[l,u]=f.useState(!1),m=pl(),{reasoningLevel:c}=ql({reasoningLevelTypes:n,reasoningLevelType:o}),p=o!=="low"||t||!1,x=Fe(h=>h.isVisuallyOverflowing),g=x;return e.jsxs("div",{className:Y("radix-state-open:bg-black/10 inline-flex h-9 rounded-full border text-[13px] font-medium",p?"text-token-interactive-label-accent-default can-hover:hover:bg-[#BDDCF4] dark:can-hover:hover:bg-[#1A416A] bg-token-composer-blue-bg border-transparent dark:bg-[#2A4A6D] dark:text-[#48AAFF]":"border-token-border-default text-token-text-secondary can-hover:hover:bg-token-main-surface-secondary focus-visible:outline-black dark:focus-visible:outline-white",l&&"duration-75 motion-safe:transition-all"),children:[e.jsxs("div",{className:"flex h-full min-w-8 items-center justify-center p-2","aria-pressed":p,onTransitionEnd:()=>u(!1),onClick:h=>{d==="think"&&!t&&!x&&(h.stopPropagation(),h.preventDefault(),a(o==="low"?"medium":"low"))},children:[e.jsx(uf,{reasoningLevelTypes:n,reasoningLevelType:o}),s&&e.jsx(ut,{initial:!1,children:e.jsx(J.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:m?0:.15},children:e.jsx("div",{className:Y("ps-1 pe-1 whitespace-nowrap",g&&!t&&"hidden"),children:t?i:c?.shortLabel})})}),!t&&d==="auto"&&!p&&!g&&e.jsx(jt,{"aria-label":"",className:"h-[18px] w-[18px] opacity-50"})]}),p&&!x&&(t||d!=="think")?e.jsx("div",{className:"border-token-border-default mt-[1px] border-s p-2",style:{borderColor:p?"#0285FF28":void 0},onClick:h=>{h.stopPropagation(),h.preventDefault(),r()},children:e.jsx(Ti,{"aria-label":"",className:"h-[16px] w-[16px]"})}):d==="think"?e.jsx("div",{className:Y("border-token-border-default border-s p-2",g&&"hidden"),style:{borderColor:p?"#0285FF28":void 0},children:e.jsx(jt,{className:"h-[18px] w-[18px]"})}):null]})},mf=({clientThreadId:t,currentModelId:s,onModelSelection:n,closePopover:o,setIsModelPickerOpen:i,ref:r})=>{const a=K(),{data:d}=Kt(),{mode:l}=Nn(),u=Yl({clientThreadId:t}),{hasInternalModels:m}=Kl(),x=$l(g=>g.query).toLowerCase().trim().length>0;return e.jsxs(J.div,{initial:{clipPath:"inset(0 100% 0 0)",opacity:0},animate:{clipPath:"inset(0 0% 0 0)",opacity:1},exit:{clipPath:"inset(0 100% 0 0)",opacity:0},transition:hs,className:"flex flex-col",ref:r,children:[l!=="model-picker-only"&&e.jsxs("div",{className:"border-token-border-xlight bg-token-main-surface-primary dark:bg-token-main-surface-secondary sticky start-0 top-0 z-10 flex w-full flex-row items-center justify-center overflow-clip border-b p-3",children:[e.jsx("button",{onClick:()=>{i(!1)},id:"reasoning-level-popover-model-list-back-button",className:"hover:bg-token-main-surface-tertiary flex items-center rounded-md p-1",children:e.jsx(Ja,{className:"text-token-text-secondary h-5 w-5"})}),e.jsx("div",{className:"flex-auto text-center text-sm font-medium",children:a.formatMessage({id:"j6WEI7",defaultMessage:"Choose a model"})}),e.jsx("div",{className:"w-5"})]}),e.jsx("div",{className:Y("flex w-full flex-col pb-2"),children:x?e.jsx(Ql,{currentModelId:s,onModelSelection:n,closePopover:o,rootRef:r}):e.jsxs(e.Fragment,{children:[d?.categories?.map(g=>{const h=g?.defaultModel;return e.jsx(Xl,{model:g,modelSwitcherDenialsBySlug:u,isSelected:h===s,onClick:()=>{n(h),o()}},h)}),m&&e.jsxs(e.Fragment,{children:[e.jsx(Jl,{modelsData:d,clientThreadId:t,triggerButton:e.jsx(lt,{className:"relative mt-1 border-transparent",children:e.jsxs("div",{className:"mb-1 flex items-center px-1",children:[e.jsx("div",{className:"text-sm",children:a.formatMessage({id:"ZDpo4I",defaultMessage:"Internal Models"})}),e.jsx(Zl,{className:"icon-md text-token-text-tertiary absolute end-1 w-7"})]})}),onModelItemClick:g=>{g&&(n(g),o())}}),e.jsx(Za,{})]})]})})]})},pf={modelPickerOpen:{maxHeight:375,width:320},modelPickerClosed:{maxHeight:245,width:320},vanguardModelPickerClosed:{maxHeight:320,width:264}},ff=({clientThreadId:t,reasoningLevelTypes:s,reasoningLevelType:n,onReasoningLevelChanged:o,isManualModelSelection:i,currentModelId:r,onModelSelection:a,resetReasoningLevel:d})=>{const{layoutMode:l,closePopover:u,mode:m}=Nn(),c=!As(),[p,x]=f.useState(!!(i||m==="model-picker-only")),g=f.useRef(null),h=f.useRef(null);return f.useEffect(()=>{p?(g.current?.scrollTo({top:-1e3,behavior:"instant"}),document.getElementById("reasoning-level-popover-model-list-back-button")?.focus()):document.getElementById("reasoning-level-popover-juice-list-model-picker-button")?.focus()},[i,p]),e.jsxs(J.div,{className:Y("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 245px)] flex flex-1 origin-center snap-y snap-proximity scroll-pt-[30px] overflow-y-auto overscroll-contain scroll-smooth [scrollbar-gutter:stable]",c&&!p&&"pt-4",l==="bottom"&&"flex-col-reverse"),animate:p?"modelPickerOpen":"modelPickerClosed",transition:ec,variants:pf,ref:g,children:[!p&&m!=="model-picker-only"&&e.jsx(tc,{clientThreadId:t,reasoningLevelTypes:s,reasoningLevelType:n,onReasoningLevelChanged:o,resetReasoningLevel:d,shouldShowModelPicker:c,setIsModelPickerOpen:x,isModelPickerOpen:p,showAccountPaymentModal:it}),e.jsx(ut,{children:p&&c&&e.jsx(mf,{clientThreadId:t,setIsModelPickerOpen:x,ref:h,currentModelId:r,onModelSelection:a,closePopover:u})})]})},gf=({clientThreadId:t,layoutMode:s,currentModel:n,category:o,type:i,...r})=>{const{data:a}=Kt(),l=Fe(v=>v.threads[t]?.modelSelection)?.type===Ce.SPECIFIC,u=Fe(v=>v.setThreadModelSelection),m=As(),c=yn(),p=f.useMemo(()=>{const v=n?.id??"";return sc(v)?"low":nc(v)?"medium":oc(v)?"high":"low"},[n?.id]),x=ac(),g=_t(),h=f.useCallback(v=>{yt(t,u,{type:Ce.EFFORT_MODE,effortMode:ei[v]}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const E=ic(v,a?.categories.map(D=>D.defaultModel)??[]);E&&(m&&v==="high"?it(c,"Model picker upsell"):g({location:"PromptTextarea",modelId:E}))})})},[t,g,c,m,a,u]),b=v=>{const E=n?.id??"";v&&(N.logEvent("Model Switcher Model Changed",{from:E,to:v,source:"popover"}),vm.logEvent("chatgpt_model_switcher_model_changed",v,{from:E,to:v,source:"popover"}),g({modelId:v,location:"Model switcher menu item"}),lc({type:Ce.SPECIFIC,modelSlug:v}),yt(t,u,{type:Ce.SPECIFIC,modelSlug:v}))},y=!rc(n?.id??""),w=l||y,j=(o?.label&&o?.label?.length<10?o?.label:o?.shortLabel)??n?.title??"",R=n?.id??"",_=()=>{h("low")},M=f.useCallback(()=>{const{reasoningLevelList:v}=x,D=(v.findIndex(F=>F.type===p)+1)%v.length;h(v[D].type)},[h,p,x]);return f.useEffect(()=>Cm(pp,{cycleReasoningLevel:M}),[M]),e.jsxs(no,{layoutMode:s,...r,children:[e.jsx(qi,{children:e.jsx(df,{isManualModelSelection:w,modelName:j,animatedLabel:!0,reasoningLevelTypes:x,reasoningLevelType:p,onResetReasoningLevel:_,onReasoningLevelChanged:h,type:i})}),e.jsx(oo,{align:"start",children:e.jsx(ff,{clientThreadId:t,reasoningLevelTypes:x,reasoningLevelType:p,onReasoningLevelChanged:h,modelName:j,isManualModelSelection:w,currentModelId:R,onModelSelection:b,resetReasoningLevel:_})})]})},hf=({className:t,children:s})=>e.jsx(J.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function xf({canContinue:t,onContinueGenerating:s}){const n=f.useCallback(i=>{s(i),cn()},[s]);let o=null;return t&&(o=e.jsx(bf,{onHandleContinueGenerating:n})),o&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:o})}function Sf({className:t}){return e.jsx(cc,{className:Y("-rotate-180",t)})}const bf=({onHandleContinueGenerating:t})=>e.jsx(hf,{children:e.jsx(wm,{as:"button",color:"secondary",onClick:t,className:"py-2 whitespace-nowrap",icon:Sf,size:"small",children:e.jsx(P,{...Z.continueGenerating})})}),yf=({clientThreadId:t,composerController:s})=>{const n=Bi(),o=at(s.store,g=>g.rateLimitBannerFeature),i=jm(),r=n??Cf(o,i),a=re(t,se.getRequestId),d=re(t,se.getCurrentLeafId),l=Ni(a),{layer:u}=He("1368081792"),m=r?.name?()=>{switch(r.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":Sc(d);break}}:void 0,{value:c}=oe("3612584454");f.useEffect(()=>{l&&!(r?.name==="gpt-4l"&&c)&&(ba.dismissBanner(),s.setRateLimitBannerFeature(null))},[l,r?.name,c,s]);const p=r?.is_dismissible?()=>{N.logEventWithStatsig("Rate Limit: Dismiss Banner","chatgpt_rate_limit_banner_dismissed",{type:!u.get("should_change_model_picker",!0)&&r?.name==="o3-mini-high-in-context-upsell-plus"?"o3-mini-high-in-context-upsell-plus-no-model-switch":r?.name}),ba.dismissBanner(),s.setRateLimitBannerFeature(null)}:void 0,x=()=>{switch(r?.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":bc({interactedInPeriod:!0});break}};return e.jsx(ut,{children:r&&e.jsx(J.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx($i,{clientThreadId:t,rateLimitInfo:r,onDismiss:p,onInteract:x,onMount:m})})})};function Cf(t,s){const n=s.find(o=>o.name===t);return n?{name:n.name,title:n.title,description:n.description,is_dismissible:!0,call_to_action:n.call_to_action,resets_after:n.resets_after}:null}function vf(t,s,n,o,i,r,a,d,l,u,m,c){if(l||(t.name==="o3-mini-high-in-context-upsell-free"||t.name==="o3-mini-high-in-context-upsell-plus")&&(s.some(k=>k.model_slug==="o3-mini-high")||n.id==="o3-mini-high")||d&&a&&Js(Date.now(),a)<la)return!1;const x=o==null||Js(Date.now(),o)>=hc,g=i===u,h=a==null||r==null||Js(Date.now(),a)>=la||r<xc;if(!(x&&h||g))return!1;switch(t.name){case"deep-research-in-context-upsell":return m("should_show_deep_research_upsell_banner",!1);case"deep-research-in-context-upsell-free":return m("should_show_deep_research_upsell_banner_free",!1);case"o3-mini-high-in-context-upsell-free":return m("should_show_o3_mini_high_upsell_banner_free_user_to_plus",!1);case"o3-mini-high-in-context-upsell-plus":return m("should_show_o3_mini_high_upsell_banner_plus_user",!1);case"codex-in-context-upsell":return c("should_show_codex_upsell_banner",!1);default:return!1}}function wf(t,s){const n=_m(),o=uc(t),i=re(t,se.getRequestId),r=re(t,se.getCurrentLeafId),a=Ni(i),d=Bi(),l=dc(y=>y.lastSeenInContextUpsellBannerAt),u=mc(y=>y.inContextUpsellBannerPeriodExposureCount),m=pc(y=>y.inContextUpsellBannerPeriodStartAt),c=fc(y=>y.inContextUpsellBannerLastSeenId),p=gc(y=>y.inContextUpsellBannerInteractedInPeriod),{layer:x}=He("1368081792"),{layer:g}=He("1738106734"),h=at(s.store,y=>y.rateLimitBannerFeature);let b=!1;switch(d?.name){case null:case void 0:b=h!=null;break;case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":case"deep-research-in-context-upsell":case"deep-research-in-context-upsell-free":case"codex-in-context-upsell":b=vf(d,n,o,l,c,u,m,p,a,r,x.get,g.get);break;default:b=!0}return!a&&b}const ws="month",Zi="year";function _f(){const t=km(),s=K(),n=Ke(),{markAsViewed:o}=Oe(yc),{initialBillingDetails:i}=np(t,!0),r=f.useMemo(()=>({...t?.subscriptionAnalyticsParams,referrer:document.referrer}),[t]);async function a(){try{await vc(t?.features??[],s,n,i,r)}catch{}}const{shouldShowBanner:d,discountValue:l,discountDuration:u}=Cc();if(f.useEffect(()=>{d&&l&&u&&Zs.logShowReferrerRedemptionBanner()},[d,l,u]),!d||!l||!u)return null;const m=jf(s,i,l,u),c=kf(s,i,l,u),p=e.jsxs("div",{className:"grow",children:[e.jsx("div",{className:"mb-0.5 font-semibold",children:m}),e.jsx("span",{className:"text-token-text-secondary",children:c})]});return e.jsx(Bn,{onPrimaryCtaClick:()=>{o(),Zs.logClickReferrerRedeemButton(),a()},primaryCtaText:e.jsx(P,{id:"referrerRedemptionBannerPrimaryCta",defaultMessage:"Get Plus"}),onDismiss:()=>{o(),Zs.logCloseReferrerRedemptionBanner()},content:p})}function jf(t,s,n,o){const{currencySymbol:i}=ti(si(),s.currency),r=o?o.period:ws,a=o?o.num_periods:1,d=i.code.defaultMessage?.toString()??Ii,l=t.formatNumber(n.value,{style:"currency",currency:d,minimumFractionDigits:0,maximumFractionDigits:2});let u;return r===ws?u=a===1?e.jsx(P,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}}):r===Zi&&(u=a===1?e.jsx(P,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:l}})),u}function kf(t,s,n,o){const{currencySymbol:i}=ti(si(),s.currency),r=o?o.period:ws,a=o?o.num_periods:1,d=i.code.defaultMessage?.toString()??Ii,l=t.formatNumber(n.value,{style:"currency",currency:d,minimumFractionDigits:0,maximumFractionDigits:2});let u;return r===ws?u=a===1?e.jsx(P,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used â€” claim your free month of Plus."}):e.jsx(P,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:l,num_months:a}}):r===Zi&&(u=a===1?e.jsx(P,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:l}}):e.jsx(P,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:l,num_years:a}})),u}const xn=window.sessionStorage,Sn=Rm(Mm(()=>({memoryFullBannerDismissed:!!xn?.getItem(wt.MemoryFullBannerDismissed)}))),er={dismissBanner(){Sn.setState(t=>{t.memoryFullBannerDismissed=!0}),xn?.setItem(wt.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){Sn.setState(t=>{t.memoryFullBannerDismissed=!1}),xn?.removeItem(wt.MemoryFullBannerDismissed)}};function Rf(t){const s=Li(t),n=wc(),{data:o}=_c(s,!1,n),i=o!=null,r=i&&o.memoryFullPct>=100,[a,d]=f.useState(!1);f.useEffect(()=>{!r&&i&&(d(!0),er.clearDismissedBanner())},[r,i]);const l=Sn(u=>u.memoryFullBannerDismissed);return r&&a&&!l}function Mf(){const t=K(),{openSettings:s}=jc();return e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Bn,{title:t.formatMessage(ps.memoryFullTitle),content:t.formatMessage(ps.memoryFullTooltip,ps.memoryFullTooltip.values),primaryCtaText:t.formatMessage(ps.memoryManageButton),onPrimaryCtaClick:()=>s(kc.Personalization),onDismiss:()=>er.dismissBanner()})})}const ps=Ue({memoryFullTitle:{id:"i1hV1R",defaultMessage:"ChatGPT's out of space for saved memories"},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"Rs+Att",defaultMessage:"New memories wonâ€™t be added until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:Rc,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),Af=Zn(()=>eo(()=>import("./og00mol61ujocnrz.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.JawboneNotificationsBanner)),tr=f.memo(function({className:s}){const{store:n}=ve(),o=n.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:Y(s??"absolute start-0 end-0 bottom-full",Ac.PromptTextareaHeader),children:e.jsx(Mc,{shouldRender:o,contentArea:Ot.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(Ef,{}),e.jsx(Pf,{})]})})})});function Ef(){const{store:t}=ve(),s=t.useSharedProps(d=>d?.clientThreadId),n=t.useContentAreaId(Ot.HeaderTop),o=Ec(),i=re(s,d=>d?.modelId),r=Pc.useStore();let a;switch(n){case B.ProjectConversationTaskNoFileAccess:a=e.jsx(If,{});break;case B.AdvancedVoiceOnMobileAnnouncement:a=e.jsx(Kc,{clientThreadId:s});break;case B.S09KM1:a=null;break;case B.TeamsCreditRequest:a=null;break;case B.BannerSignup:a=e.jsx(Bf,{});break;case B.BannerTermsDisclaimer:a=e.jsx(Lf,{});break;case B.PromptTextareaAction:a=e.jsx(Df,{});break;case B.BannersRateLimit:a=e.jsx(Ff,{});break;case B.BannerSidekickAnnouncement:a=e.jsx(Yc,{});break;case B.SearchBrowserExtensionAnnouncement:a=e.jsx(qc,{});break;case B.MoonshineAnnouncement:a=e.jsx(Vc,{});break;case B.CustomizeChatGPTAnnouncement:a=e.jsx(Wc,{});break;case B.SearchBrowserExtensionReactiveAnnouncement:a=e.jsx(zc,{});break;case B.BannerMemoryFull:a=e.jsx(Mf,{});break;case B.Box:a=e.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case B.JawboneAnnouncement:o?a=e.jsx(Af,{}):a=null;break;case B.JawboneMaxActiveAnnouncement:o?a=e.jsx(Gc,{}):a=null;break;case B.PromoRedemptionAnnouncement:a=e.jsx(tp,{});break;case B.OperatorAnnouncement:a=e.jsx(Uc,{});break;case B.BannerPlusUpsell:a=e.jsx(Hc,{});break;case B.ContextualAnswersAdminUpsell:a=e.jsx(Oc,{});break;case B.ContextualAnswersUserUpsell:a=e.jsx(Fc,{});break;case B.ReferrerRedemptionAvailableAnnouncement:a=e.jsx(_f,{});break;case B.RefereeRedemptionAvailableAnnouncement:a=e.jsx(Dc,{});break;case B.ReferralProgramUpsellAnnouncement:a=e.jsx(Lc,{});break;case B.StudentsUpsellAnnouncement:a=e.jsx(Ic,{});break;case B.ModelDeprecationBanner:a=Bc(i);break;case B.TeamsContextualAnswersUpsell:a=e.jsx(Nc,{});break;case B.KanziConfig:a=!1;break;case B.LanguageUpsellBanner:a=e.jsx(Tc,{onDismissSideEffect:()=>{N.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),r.closeBanner()},onPrimaryCtaClickSideEffect:()=>{N.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),r.closeBanner()}});break;default:a=null;break}return a}function Pf(){const{store:t}=ve(),s=t.useContentAreaId(Ot.HeaderBottom);let n;switch(s){case ni.DallePromptControls:n=e.jsx(Nf,{});break;default:n=null;break}return n}const Tf=Zn(()=>eo(()=>import("./le820injjee03tii.js"),__vite__mapDeps([7,1,2,3,4,5])).then(t=>t.default));function Nf(){const{store:t}=ve(),s=t.useSharedProps(n=>n?.composerController);return s?e.jsx(Tf,{composerController:s}):null}function Bf(){const{store:t}=ve(),s=t.useSharedProps(i=>i?.clientThreadId),n=Cn(),o=$c();return s?n?e.jsx(Qc,{threadId:s,showSignUp:o}):e.jsx(Xc,{threadId:s,showLogin:o}):null}function If(){return f.useEffect(()=>()=>{nn.getItem(wt.TasksHasSeenProjectDisclaimerBanner)||nn.setItem(wt.TasksHasSeenProjectDisclaimerBanner,!0)},[]),e.jsx(Bn,{icon:e.jsx(Wt,{}),title:e.jsx(P,{id:"ibX3g7",defaultMessage:"Tasks canâ€™t access project files"}),content:e.jsx(P,{id:"fm94Tm",defaultMessage:"Thereâ€™s a task in this conversation â€” just FYI, it wonâ€™t be able to access project files."}),onDismiss:()=>{nn.setItem(wt.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Lf(){const{store:t}=ve(),s=t.useSharedProps(n=>n?.clientThreadId);return s?e.jsx(Jc,{threadId:s}):null}function Df(){const{store:t}=ve(),s=t.useSharedProps();return s?e.jsx(xf,{...s}):null}function Ff(){const{store:t}=ve(),s=t.useSharedProps(o=>o?.clientThreadId),n=t.useSharedProps(o=>o?.composerController);return!s||!n?null:e.jsx(yf,{clientThreadId:s,composerController:n})}const Of=5,Hf=f.memo(function(s){return Uf(s),Gf(s),zf(),null});function Uf(t){const{store:s}=ve(),n=s.useSetSharedProps();gn(()=>{n(t)},[t,n])}function Gf(t){const{clientThreadId:s,canContinue:n}=t,{store:o}=ve(),i=f.useRef({top:o.useContentAreaApi(Ot.HeaderTop),bottom:o.useContentAreaApi(Ot.HeaderBottom)}).current,r=Zc(s),{shouldShowBannerSignup:a,shouldShowBannerTermsDisclaimer:d}=Wf(s),l=wf(s,t.composerController),u=eu(t),m=tu(t),c=Xa(),p=su(),x=nu(t),g=Rf(s),h=ou(t),b=au(s),y=iu(s),w=sp(),{eligible:k}=Oe(ru),j=lu(),R=cu(),_=uu(),M=du(),v=mu(s),E=pu(s),D=fu(),F=gu(s),z=hu(s),S=xu(s),I=re(s,L=>L?.modelId),G=Ms(s),W=oi();gn(()=>{I&&G?.kind===De.GizmoInteraction&&G.gizmo&&Su(I,G.gizmo)?i.top.set(B.ProjectConversationTaskNoFileAccess):h.eligible?i.top.set(B.AdvancedVoiceOnMobileAnnouncement):d?i.top.set(B.BannerTermsDisclaimer):l?i.top.set(B.BannersRateLimit):D?i.top.set(B.BannerPlusUpsell):F?i.top.set(B.ContextualAnswersAdminUpsell):z?i.top.set(B.ContextualAnswersUserUpsell):b?i.top.set(B.JawboneAnnouncement):y?i.top.set(B.JawboneMaxActiveAnnouncement):u.eligible?i.top.set(B.BannerSidekickAnnouncement):c?i.top.set(B.MoonshineAnnouncement):p?i.top.set(B.CustomizeChatGPTAnnouncement):m?i.top.set(B.SearchBrowserExtensionAnnouncement):x?i.top.set(B.SearchBrowserExtensionReactiveAnnouncement):w?i.top.set(B.PromoRedemptionAnnouncement):k?i.top.set(B.OperatorAnnouncement):_?i.top.set(B.ReferralProgramUpsellAnnouncement):n?i.top.set(B.PromptTextareaAction):a?i.top.set(B.BannerSignup):g?i.top.set(B.BannerMemoryFull):j?i.top.set(B.ReferrerRedemptionAvailableAnnouncement):R?i.top.set(B.RefereeRedemptionAvailableAnnouncement):M?i.top.set(B.StudentsUpsellAnnouncement):v?i.top.set(B.ModelDeprecationBanner):E?i.top.set(B.TeamsContextualAnswersUpsell):S?i.top.set(B.LanguageUpsellBanner):i.top.set(null)},[i,W,n,d,a,l,u,g,h]),gn(()=>{r&&i.bottom.set(ni.DallePromptControls)},[i,r])}function zf(){const{store:t}=ve();f.useEffect(()=>()=>{t.reset()},[t])}function Wf(t){const{isUnauthenticated:s}=Pe(),{layer:n}=He("3637408529",{shouldLogExposure:!1}),{layer:o}=He("3637408529"),i=o.get("no_auth_banner_signup_rate_limit",Of),r=n.get("should_show_no_auth_signup_banner",!0),a=bu(c=>c.bannerDisclaimerClientThreadId),d=yu(),l={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[u,m]=re(t,c=>[se.getConversationTurns(c).filter(p=>p.role===Di.User).length,Vf(se.getCurrentNode(c)?.message)]);return t&&(l.shouldShowBannerTermsDisclaimer=m&&s&&u===1&&!d&&(a==null||a===t),l.shouldShowBannerSignup=r&&m&&s&&u>0&&u%i===0),l}function Vf(t){return t?.author.role===Di.Assistant&&Am(t)}function sr({clientThreadId:t,getInputProps:s,openFileDialog:n,uploadType:o,icon:i,isDisabled:r=!1,isSmall:a=!1,showLabel:d=!1,showUpsell:l=!1,hideBorder:u=!1,highlightTooltip:m=!1,disabledReason:c,currentModelName:p,visualTreatment:x}){const g=K(),h=Es();r=(r||!!h)&&!l;const b=e.jsxs(Cu,{disabled:r,$showLabel:d,$hideBorder:u,$isSmall:a,$visualTreatment:x,onClick:k=>{if(k.preventDefault(),l){N.logNoAuthAttachButtonClicked({location:"No auth upsell"});return}N.logEvent("Open File Viewer",{intent:o.toString()}),n()},"aria-label":r?c===Ct.ModelNotSupported?g.formatMessage({id:"pEB4vw",defaultMessage:"Attachments disabled for {modelName}"},{modelName:`${p}`}):c===Ct.ThinkModeInUse?g.formatMessage({id:"NRk4QL",defaultMessage:"Attachments disabled for Reason mode"}):c===Ct.SearchModeInUse?g.formatMessage({id:"YlO80p",defaultMessage:"Attachments disabled for Search mode"}):g.formatMessage({id:"PromptFilePicker.attachFilesUnavailable",defaultMessage:"Attach files is unavailable"}):g.formatMessage({id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"}),children:[i,d&&e.jsx(ai,{})]}),y=e.jsx("input",{disabled:r,...s({className:"hidden"})}),w=e.jsxs("div",{className:"flex",children:[b,y]});return l?e.jsx(zt,{label:e.jsx(P,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:m||void 0,children:e.jsx(vu,{triggerButton:w,sideOffset:0,alignOffset:0,children:e.jsx(_n,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"})})}):e.jsx(Yi,{disabled:r,clientThreadId:t,rateLimitPopup:h,highlightTooltip:m,children:w})}function qf({code:t,message:s}){switch(t){case ca.FileTooLarge:return Pa.errorFileTooLarge;case ca.TooManyFiles:return N.logEvent("Uploaded Max Files Error"),Pa.errorTooManyFiles;default:return s}}const Pa=Ue({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."},getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"}}),Ta=Ue({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function Yf(t){if(!t.accept||Object.keys(t.accept).length===0)return[];const s=[];return Object.values(t.accept).forEach(n=>s.push(...n)),s.sort()}function nh(t){const{className:s,children:n,clientThreadId:o,currentModelConfig:i,noKeyboard:r}=t,a=K(),d=Ke(),l=Ms(o),u=Gt(),m=xs(i,l,u),c=m!==ot.None,p=un(_=>_.files),x=(m===ot.Multimodal?Ln:Dn)-p.length,g=x<=0,{getGizmoId:h}=Fn(),{handleFileAccepted:b}=lo(a,m,Hn(i,l),"drag",h,On(i,l)?.attachments),y=Es(),w=Un(Gn(i,l)),{getRootProps:k,isDragActive:j}=ao({maxFiles:x,disabled:!c||g||y!=null,noClick:!0,noKeyboard:r,onDropAccepted:b,onDropRejected:_=>ro(_,a,d,m),multiple:!0,maxSize:zn,...w}),R=Yf(w);return e.jsxs("div",{...k({className:s}),children:[n,j&&e.jsxs(Kf,{children:[e.jsx(ju,{}),e.jsx("h3",{children:e.jsx(P,{...Ta.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:R.length>0?R.join(", "):e.jsx(P,{...Ta.dragAllAccepted})})]})]})}function ro(t,s,n,o){const{errors:i}=t[0];i.forEach(r=>{const a=qf(r);typeof a=="string"?n.danger(a,{hasCloseButton:!0}):n.danger(s.formatMessage(a,{size:_u,maxNum:o===ot.Multimodal?Ln:Dn}),{hasCloseButton:!0})})}function lo(t,s,n,o,i,r){const a=Mt(),d=Fi(a).flags,l=Ke(),u=In(),m=ii(),{isUnauthenticated:c}=Pe(),p=d?.includes(vs.NoAuthEnableFileUploads);return{handleFileAccepted:f.useCallback(async(g,h)=>{N.logEvent("Upload File",{client:"web",eventSource:o,intent:s.toString()}),m.fileUploadAccepted();const b=i!=null?await i():void 0;g.length>0&&g.forEach(y=>{fs.uploadFile(u,wu(y),y,s,n,t,l,{gizmoId:b,...p&&{isUnauthenticated:c}},r)})},[o,s,i,u,m,n,t,l,r,p,c])}}const Kf=Qn.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`,nr=t=>{const s=[];s.push({category:null,systemHints:t.filter(n=>!n.category)});for(const n of Pm)s.push({category:n,systemHints:t.filter(o=>o.category===n)});return s};function or({composerController:t,clientThreadId:s,onHintSelected:n}){const o=Oi(s),[i]=re(s,I=>[I?.modelId]),{data:r}=Kt(),a=i??ku(void 0).id,d=ri(r?.models,a),{configurationMenuType:l}=Ge(),{setThreadSystemHintMode:u,clearAllSystemHintModeTriggers:m}=fe(),{viewableSystemHints:c,persistedSystemHints:p}=Ye.useState(({availableHints:I,persistedSystemHints:G})=>({viewableSystemHints:I,persistedSystemHints:G})),[x,g]=f.useState([]),[h,b]=f.useState(void 0),[y,w]=f.useState(0);f.useEffect(()=>{if(!h)g([]);else{const I=h.text.toLocaleLowerCase(),G=c.filter(L=>{const T=L.name.toLocaleLowerCase().startsWith(I),V=L.systemHint.toLocaleLowerCase().startsWith(I);let H=!1;return L.regexMatches&&L.regexMatches.length>0&&(H=L.regexMatches.some(Q=>Q.replace(/[\^\$\(\)]/g,"").toLocaleLowerCase().startsWith(I))),T||V||H}).filter(L=>L.requiredFeatures.every(T=>d?.enabledTools?.includes(T))),W=nr(G).map(L=>L.systemHints).flat();g(W)}},[h]),f.useEffect(()=>{t.view.dispatch(fp(t.view.state.tr,{onHintMatch(I){b(G=>Em(G,I)?G:I)}}))},[t]);const k=!c.length||!x.length||!h;f.useEffect(()=>{w(0)},[k]);const j=x.length,R=f.useCallback(I=>{w(G=>(I(G)%j+j)%j)},[j]),_=f.useCallback(()=>{w(-1)},[]),M=x[y],v=f.useCallback(()=>{h?.range&&t.delete(h.range.from,h.range.to)},[h,t]),E=({hintToSave:I=M,expectPerfectMatch:G})=>{if(!h||!M||G&&I.name.toLowerCase()!==h.text.toLowerCase())return!1;N.logEvent("System Hint Selected",{system_hint:I.systemHint,conversation_id:o??fn});const W=h.range.from===1?I.name:h.text+I.name.slice(h.text.length),L={clientThreadId:s};ds(t.view),p.size>0&&m();const T=!!I.composerBarButtonInfo,V=I.systemHint===A.Search;return T||V||l!=="none"?(u(I.systemHint,!0,L,V?Ru.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),v(),t.removeSystemHints(),!0):(t.addSystemHint(I.systemHint,W,h.range.from,h.range.to),!0)},D=f.useRef(E);D.current=E;const F=f.useRef(R);F.current=R;const z=f.useRef(h);z.current=h;const S=t.view;return f.useEffect(()=>(k||gp(S,I=>{if(I==="up")F.current(G=>G-1);else if(I==="down")F.current(G=>G+1);else if(I==="cancel")ds(S),hp(S);else if(I==="submit")if(n)v(),n(M.systemHint);else return ds(S),D.current({expectPerfectMatch:!1});else if(I==="checkMatch")return D.current({expectPerfectMatch:!0})}),()=>ds(S)),[k,S,M,n,v]),f.useEffect(()=>{k||N.logEvent("System Hint List Opened",{conversation_id:o??fn})},[k]),{suggestorClosed:k,systemHintSuggestions:x,hintMatch:h,selectedIndex:y,resetSelectedIndex:_,setSelectedIndex:w,saveHint:E}}function $f({composerController:t,clientThreadId:s}){const{selectedIndex:n,systemHintSuggestions:o,suggestorClosed:i,setSelectedIndex:r,saveHint:a}=or({composerController:t,clientThreadId:s});return i?null:e.jsx(Mu,{className:"max-w-60",onMouseDown:d=>{d.preventDefault()},children:o.map((d,l)=>e.jsx(Au,{as:"div",autoFocus:!1,className:"rounded-lg px-1 py-2",highlighted:l===n,onMouseOver:()=>r(l),onClick:()=>{a({hintToSave:d,expectPerfectMatch:!1}),t.focus()},children:e.jsx(ar,{title:d.name,description:d.description,logo:d.logo})},d.systemHint))})}function ar({title:t,description:s,logo:n,checked:o,badge:i}){const r=K();return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-2 ps-1.5 pe-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:e.jsx(Yt,{svgString:n,className:"icon-lg text-token-text-secondary"})}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsxs("p",{className:"text-token-text-primary text-sm leading-tight font-normal",children:[t,i&&e.jsx("span",{className:"ms-2 rounded-full bg-blue-400 px-2 py-0.5 text-xs text-white","aria-label":r.formatMessage({id:"I75WNJ",defaultMessage:"Create image updated"}),children:e.jsx(P,{id:"uUmZQi",defaultMessage:"Updated"})})]}),!!s&&e.jsx("p",{className:"text-token-text-secondary text-[13px] leading-[18px] font-normal",children:s})]}),o&&e.jsx(Eu,{className:Y("icon-md text-token-text-primary",{"group-hover:hidden":!o})})]})}function Na({composerController:t,clientThreadId:s}){return t instanceof xp?e.jsx($f,{composerController:t,clientThreadId:s}):null}function ir({children:t,className:s,showBackground:n,showGlowingBorder:o}){return e.jsxs("div",{className:Y("relative",o&&"overflow-clip rounded-full p-0.5"),children:[t,o&&e.jsx("div",{className:"border-glowing-gradient"}),n&&e.jsx(J.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:Y("pointer-events-none absolute inset-0 rounded-full",s)})]})}const Qf=({showUnconnectedInSubmenu:t,unconnectedConnectors:s,handleOauthRedirect:n,handleConnectorClick:o,showOneDriveInSubmenu:i,isConnectorConfigLoading:r,connectedConnectors:a,desktopConnectors:d,modelSupportedImageMimeTypes:l,showMenuForNoAuth:u,handleLocalFileUploadClick:m,unconnectedOneDriveConnectors:c})=>{const[p,x]=f.useState("main"),g=p!=="main",h=K(),b=f.useRef(null),y=Wn();return f.useEffect(()=>{g?document.getElementById("vanguard-file-picker-popover-submenu-back-button")?.focus():b.current&&b.current.focus()},[g]),e.jsx("div",{className:Y("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 215px)] flex flex-1 snap-y snap-proximity flex-col overflow-y-auto scroll-smooth py-2 [scrollbar-gutter:stable] focus-visible:rounded-[inherit] focus-visible:-outline-offset-1"),ref:b,tabIndex:0,children:e.jsxs(ut,{mode:"wait",children:[e.jsx(J.div,{className:"flex flex-col",transition:y?Ht:hs,children:p==="main"&&e.jsx(Xf,{showUnconnectedInSubmenu:t,unconnectedConnectors:s,setActiveMenu:x,handleConnectorClick:o,showOneDriveInSubmenu:i,isConnectorConfigLoading:r,connectedConnectors:a,desktopConnectors:d,modelSupportedImageMimeTypes:l,showMenuForNoAuth:u,handleLocalFileUploadClick:m})},"main"),g&&e.jsxs(J.div,{initial:{clipPath:"inset(0 100% 0 0)",opacity:0},animate:{clipPath:"inset(0 0% 0 0)",opacity:1},transition:y?Ht:hs,className:"flex flex-col",children:[e.jsxs("div",{className:"border-token-border-xlight bg-token-main-surface-primary dark:bg-token-main-surface-secondary sticky start-0 top-0 z-10 flex w-full flex-row items-center justify-center overflow-clip border-b px-3 py-3",children:[e.jsx("button",{onClick:()=>x("main"),id:"vanguard-file-picker-popover-submenu-back-button",className:"hover:bg-token-main-surface-tertiary flex items-center rounded-md p-1",children:e.jsx(Ja,{className:"text-token-text-secondary h-5 w-5","aria-label":""})}),e.jsx("div",{className:"flex-auto text-center text-sm font-medium",children:h.formatMessage({id:"LlLQYj",defaultMessage:"Back"})}),e.jsx("div",{className:"w-5"})]}),e.jsxs("div",{className:"flex w-full flex-col py-2",children:[p==="connect-apps"&&e.jsx(Pu,{connectorEntries:s,onOauthRedirect:n}),p==="one-drive"&&e.jsx(Tu,{connectorEntries:c,onOauthRedirect:n})]})]},p)]})})};function Xf({showUnconnectedInSubmenu:t,unconnectedConnectors:s,showOneDriveInSubmenu:n,setActiveMenu:o,handleConnectorClick:i,isConnectorConfigLoading:r,connectedConnectors:a,desktopConnectors:d,modelSupportedImageMimeTypes:l,showMenuForNoAuth:u,handleLocalFileUploadClick:m}){const c=K();return e.jsxs(e.Fragment,{children:[t&&s.length>0&&e.jsx(lt,{label:c.formatMessage(Ba.connectApps),icon:An,isSubMenuTrigger:!0,onClick:()=>o("connect-apps")},"connect-apps-submenu-trigger"),!t&&s.map(p=>e.jsx(Ss,{entry:p,onClick:()=>i(p),visualTreatment:"vanguard"},p.id)),n&&e.jsx(lt,{label:c.formatMessage(Ba.oneDriveSubmenuName),icon:Nu,isSubMenuTrigger:!0,onClick:()=>o("one-drive")},"one-drive-submenu-trigger"),r&&e.jsx(lt,{icon:e.jsx(qt,{className:"text-token-text-secondary"})}),(s.length>0||r)&&e.jsx(Za,{}),a.map(p=>e.jsx(Ss,{entry:p,onClick:()=>i(p),visualTreatment:"vanguard"},p.id)),d.map(p=>e.jsx(li,{entry:p,visualTreatment:"vanguard"},p.key)),e.jsx(ci,{modelSupportedImageMimeTypes:l}),e.jsx(ui,{handleLocalFileUploadClick:m,showMenuForNoAuth:u})]})}const Ba=Ue({connectApps:{id:"ContextConnectorPicker.connectApps",defaultMessage:"Connect apps"},oneDriveSubmenuName:{id:"ContextConnectorPickerOneDriveSubmenu.oneDriveSubmenuName",defaultMessage:"Connect to Microsoft OneDrive"}}),Jf=({layoutMode:t,triggerButton:s,restoreFocus:n,...o})=>e.jsxs(no,{layoutMode:t,restoreFocus:n,children:[s,e.jsx(oo,{align:"start",children:e.jsx(Qf,{...o})})]});function Zf(){const{connectorConfig:t}=di(),s=Vn(),n=qn(),[o,i]=bs(mi([...t.values()],m=>!!m.access_token),m=>!!m.access_token),[r,a]=bs(i,m=>m.type===qe.O365_PERSONAL||m.type===qe.O365_BUSINESS),d=!s&&!n&&o.length>0,l=!s&&!n&&!d&&r.length>1;return{unconnectedConnectors:n?[]:l?a:i,showUnconnectedInSubmenu:d,showOneDriveInSubmenu:l}}function rr({clientThreadId:t,icon:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:i,onOauthRedirect:r,uploadType:a,getInputProps:d,openFileDialog:l,isDisabled:u=!1,highlightTooltip:m=!1,showLabel:c,isSmall:p=!1,hideBorder:x=!1,disabledReason:g,currentModelName:h,visualTreatment:b="vanguard",showMenuForNoAuth:y=!1,showGlowingBorder:w=!1,layoutMode:k="centered",restoreFocus:j}){const R=Tm().locale,_=K(),M=Ke(),v=In(),E=Es(),{connectorConfig:D,isLoading:F}=di(),z=Oe(pe.ContextConnectors),{getGizmoId:S}=Fn(),{value:I}=oe("58345806"),{configurationMenuType:G}=Ge(),W=G!=="none",L=I&&b==="vanguard",[T,V]=f.useState();f.useEffect(()=>{S?S().then(O=>V(O)):V(void 0)},[S]);const H=f.useRef(null),[Q,ae]=f.useState(!1),we=f.useRef(!1),ze=f.useCallback(()=>{const O=H.current?.files;Array.from(O??[]).forEach(he=>Dt.uploadFile(v,he,o,_,M,i))},[v,o,_,M,i]),[dt,Te]=f.useState(null),$e=f.useCallback(()=>Te(null),[Te]),Qe=f.useCallback((O,he)=>Dt.uploadPickedFile(v,O,he,o,n,i,T,_,M),[v,o,n,i,T,_,M]),{openMenu:_e,confirmMenuOpened:je}=Bu();f.useEffect(()=>{_e&&(ae(!0),je())},[_e,je,ae]);const ke=f.useCallback(O=>{Dt.doContextConnectorOauthRedirect(location.pathname+location.search+location.hash,O,r,ya.Picker),r()},[r]),Xe=f.useCallback(O=>{Dt.uploadPickedFile(v,O,qe.GDRIVE,o,n,i,T,_,M)},[v,o,n,i,T,_,M]),ge=f.useCallback(async O=>{const{access_token:he}=O;if(!he){ke(O);return}switch(Dt.logAttemptIfAccessTokenIsExpired(O,ya.Picker),O.type){case qe.GDRIVE:Iu(R,O.type,he,Ie=>Ie.forEach(Xe));break;case qe.O365_PERSONAL:case qe.O365_BUSINESS:Te(O.type);break}},[Xe,ke,Te,R]),Ne=()=>{N.logEvent("Open File Viewer",{intent:a.toString()}),l()},ne=O=>{if(!O&&we.current&&!F)Ne();else if(O&&Be&&!F&&!y){Ne();return}ae(O),O&&(z.eligible&&z.markAsViewed(),N.logEventWithStatsig("Composer: Open Context Connector Picker","chatgpt_composer_open_context_connector_picker"),we.current=!0,setTimeout(()=>{we.current=!1},250))},[Re,mt]=bs(mi([...D.values()],O=>!!O.access_token),O=>!!O.access_token);eg(Re,ge);const[Je]=bs(mt,O=>O.type===qe.O365_PERSONAL||O.type===qe.O365_BUSINESS),{unconnectedConnectors:le,showUnconnectedInSubmenu:ce,showOneDriveInSubmenu:te}=Zf(),{desktopConnectors:Me}=Lu(o),Be=!Re.length&&!le.length&&!Me.length,At=e.jsxs(e.Fragment,{children:[ce&&le.length>0&&e.jsx(Du,{connectorEntries:le,onOauthRedirect:O=>ke(O)}),!ce&&le.map(O=>e.jsx(Ss,{entry:O,onClick:()=>ge(O)},O.id)),te&&e.jsx(Fu,{connectors:Je,onOauthRedirect:ke}),F&&e.jsx(U.Item,{icon:e.jsx(qt,{className:"text-token-text-secondary"})}),(le.length>0||F)&&e.jsx(U.Separator,{}),Re.map(O=>e.jsx(Ss,{entry:O,onClick:()=>ge(O)},O.id)),Me.map(O=>e.jsx(li,{entry:O},O.key)),e.jsx(ci,{modelSupportedImageMimeTypes:o}),e.jsx(ui,{handleLocalFileUploadClick:Ne,showMenuForNoAuth:y})]}),ue=u||E!=null,pt=f.useRef(!1);let de;W?de=e.jsx(Yi,{clientThreadId:t,rateLimitPopup:E,highlightTooltip:m,disabled:ue,disabledReason:g,currentModelName:h,children:e.jsxs(U.BasicTrigger,{className:"composer-btn",disabled:ue,id:"upload-file-btn","aria-label":cp(_,ue,g,h),children:[s,c&&e.jsx(ai,{})]})}):L?de=e.jsx(up,{clientThreadId:t,icon:s,isDisabled:ue,highlightTooltip:m,showLabel:c,hideBorder:x,isSmall:p,disabledReason:g,currentModelName:h,visualTreatment:b,isLoading:F,handleLocalFileUploadClick:Ne,noAvailableConnectors:Be,showMenuForNoAuth:y,announcement:z,rateLimit:E}):de=e.jsx(dp,{clientThreadId:t,icon:s,setOpen:ne,open:Q,isDisabled:ue,highlightTooltip:m,showLabel:c,hideBorder:x,isSmall:p,disabledReason:g,currentModelName:h,visualTreatment:b,showGlowingBorder:w,rateLimit:E});const Et=L?e.jsx(Jf,{layoutMode:k,triggerButton:de,showUnconnectedInSubmenu:ce,unconnectedConnectors:le,handleOauthRedirect:ke,handleConnectorClick:ge,showOneDriveInSubmenu:te,isConnectorConfigLoading:F,connectedConnectors:Re,desktopConnectors:Me,modelSupportedImageMimeTypes:o,showMenuForNoAuth:y,handleLocalFileUploadClick:Ne,unconnectedOneDriveConnectors:Je,restoreFocus:j}):e.jsxs(U.Root,{open:Q,onOpenChange:ne,children:[de,e.jsx(U.Portal,{children:e.jsx(U.Content,{alignOffset:-8,onEscapeKeyDown:()=>{pt.current=!0},side:W?"bottom":"top",size:"small",onCloseAutoFocus:O=>{pt.current||O.preventDefault()},className:"radix-side-bottom:flex-col-reverse flex flex-col",children:At})})]});return e.jsxs("div",{className:"flex flex-col",children:[e.jsx(Ou,{type:dt,onClose:$e,uploadPickedFile:Qe}),e.jsx("input",{onChange:ze,...d({className:"hidden"})}),Et,e.jsx(Hu,{hasConnectors:!F&&!Be})]})}function eg(t,s){const{connector:n,clearParam:o}=Uu(),i=t.find(r=>r.type===n&&!!r.access_token);f.useEffect(()=>{i&&(s(i),o())},[i,s,o])}function tg({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:i,getInputProps:r,openFileDialog:a,onOauthRedirect:d,historyDisabled:l,isDisabled:u,highlightTooltip:m,disabledReason:c,currentModelName:p,showLabel:x,showUpsell:g,hideBorder:h,isSmall:b,showMenuForNoAuth:y,visualTreatment:w,showGlowingBorder:k}){const j=qn(),{gdriveStatus:R,o365Status:_}=pi(),{isUnauthenticated:M}=Pe(),v=l?"text-white":m?"text-brand-blue-800":"",E=!g&&(y||R!=="false"||_!=="false"||j),D=M?dn:Gu,F=e.jsx(D,{"aria-label":"",className:Y("icon-md",v)}),z=E?e.jsx(rr,{showGlowingBorder:k,hideBorder:h,isSmall:b,clientThreadId:t,icon:F,showLabel:M&&x,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:i,onOauthRedirect:d,uploadType:s,openFileDialog:a,getInputProps:r,isDisabled:u,highlightTooltip:m,disabledReason:c,currentModelName:p,showMenuForNoAuth:y,visualTreatment:w}):e.jsx(sr,{isSmall:b,hideBorder:h,clientThreadId:t,uploadType:s,openFileDialog:a,getInputProps:r,showLabel:x,showUpsell:g,icon:F,isDisabled:u,highlightTooltip:m,disabledReason:c,currentModelName:p,visualTreatment:w});return e.jsx(ir,{showBackground:m,showGlowingBorder:k,className:"bg-brand-blue-800/20",children:z})}const sg=f.forwardRef(function({type:s,placeholder:n,replyRegions:o,state:i,renderFiles:r,leftSideActions:a,topRightAction:d,onSubmit:l,setIsComposerOverflowing:u,inputState:m,composerController:c,clientThreadId:p,gizmoId:x,disableReason:g,matchaData:h},b){const y=zu();let w=null;const{isLoading:k}=y;k||(w=y.modelId),f.useEffect(()=>{k||Wu()||c.focus()},[w,c,k]);const{value:j}=oe("3780975974"),{state:R,shouldShowResearchText:_}=ys(p),M=f.useCallback(()=>e.jsx(fi,{useStartButtonText:R==="clarify"||!1,inputState:m,state:i,onSubmit:l,composerController:c,clientThreadId:p,gizmoId:x,disableReason:g}),[m,i,l,c,p,x,g,h,R]),{whisperControls:v,waveContainerRef:E}=Ki({composerController:c,renderInComposer:M,composerType:"legacy"}),{controlsDisabled:D,waveformData:F,waveWidth:z}=at(c.store),{getShowUpsellReason:S}=gi(),I=j||S(),G=W=>{ng({target:W.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||c.focus()};return e.jsx(Vu,{id:"composer-background",ref:b,className:Y("border-token-border-default flex w-full cursor-text flex-col overflow-clip rounded-t-3xl border-t duration-150 ease-in-out contain-inline-size motion-safe:transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow,bottom] dark:border-none dark:shadow-none",s!=="temporary"&&"shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)] has-focus:shadow-[0_2px_12px_0px_rgba(0,0,0,0.04),0_9px_9px_0px_rgba(0,0,0,0.01),0_2px_5px_0px_rgba(0,0,0,0.06)]",s!=="temporary"&&"bg-token-main-surface-primary dark:bg-[#303030]",s==="temporary"&&"dark bg-[#303030]","rounded-b-3xl border-b"),onClick:G,style:{viewTransitionName:"var(--vt-composer)"},children:e.jsxs("div",{className:"px-3 py-1",children:[e.jsx(ut,{initial:!1,children:o.length>0&&e.jsx(J.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx("div",{className:"-mx-2",children:e.jsx(hi,{replyRegions:o})})})}),e.jsxs(e.Fragment,{children:[r,e.jsx(ut,{initial:!1,children:e.jsx(bp,{enabled:_,composerController:c,visualTreatment:"legacy",children:e.jsxs("div",{id:"composer-waveform-container",className:"flex min-h-[44px] items-start ps-1",ref:E,children:[e.jsx("div",{className:"max-w-full min-w-0 flex-1",children:D?F?e.jsx(qu,{waveform:F,containerWidth:z,scaleFactor:10,initialValue:yp}):null:e.jsx(Cp,{composerController:c,placeholder:n})}),e.jsx("div",{className:"w-[32px] pt-1",children:d})]})})}),e.jsxs("div",{className:"mt-1 mb-2 flex items-center justify-between sm:mt-5",ref:W=>{if(!I||!("ResizeObserver"in window))return;const L=new AbortController;let T=window.innerWidth;const V=Yu({axis:"width",debounce:!0,target:W,onChange:()=>{if(!W)return;W.scrollWidth>W.clientWidth?u?.(!0):Math.abs(T-window.innerWidth)>40&&(u?.(!1),T=window.innerWidth)}});return()=>{V?.(),L.abort()}},children:[e.jsx("div",{className:"text-token-text-primary flex gap-x-1.5",id:"composer-left-actions",children:a}),e.jsx("div",{className:"flex gap-x-1.5",id:"composer-voice-controls",children:v})]})]})]})})});function ng({target:t,rootId:s,additonalInteractiveIds:n}){let o=t;for(;o&&o!=null;){if(o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="TEXTAREA"||o.isContentEditable||n.includes(o.id))return!0;if(o.id===s)return!1;o=o.parentElement}return!1}const og=["o3-mini","o3-mini-high","o1-pro"],ag=[A.Search,A.Research],ig=5,rg=({composerController:t,clientThreadId:s,hideThinkButton:n,disableIfNoAccess:o,disabled:i,hasFiles:r})=>{const{prospectiveModelId:a}=Rs(s),{systemHints:d,activeSystemHints:l,isLoading:u}=Yn(s),m=oe("2868048419"),c=Ei(T=>T.bySystemHint(A.Research)),p=Jn(),x=Xn(),{value:g}=oe("1416952492"),h=Fe(T=>T.isVisuallyOverflowing),{showLegacyReasoningSlider:b,hideSearchInSystemHintOverflow:y,hideReasonInSystemHintOverflow:w,configurationMenuType:k}=Ge(),j=Rt()?.isFree(),R=k!=="none",_=l.filter(T=>R&&(j||T.systemHint!==A.Think)||y&&T.systemHint===A.Search||w&&T.systemHint===A.Think?!0:h&&b?T.systemHint!==A.Think&&!T.composerBarButtonInfo&&!ag.includes(T.systemHint):!T.composerBarButtonInfo&&T.systemHint!==A.Search&&(!m||T.systemHint!==A.PictureV2)&&(!n||T.systemHint!==A.Think));if(R&&j&&!_.find(T=>T.systemHint===A.Think)){const T=d.find(V=>V.systemHint===A.Think);T&&_.push(T)}const M=Kn(t),v=Ku(t,s),{clearAllSystemHintModeTriggers:E}=fe(),D=a&&og.includes(a),F=_.length===0&&!u||D;if(!o&&F)return null;const z={clientThreadId:s};function S(){N.logEventWithStatsig("Composer System Hint Button Hovered","composer_system_hint_button_hovered",z)}function I(){N.logEventWithStatsig("Composer System Hint Button Clicked","composer_system_hint_button_clicked",z)}const G=T=>{switch(T){case A.Research:return!!x;case A.Think:return!!p;default:return!1}},W=()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.focus()})})},L=R?ug:lg;return e.jsx(L,{systemHints:_,selectedHint:M??void 0,disabled:i,onHover:S,onOpen:I,onSelect:v,clientThreadId:s,isDeepResearchHighLoad:g,getFeatureRateLimitIndicator:T=>{switch(T){case A.Research:return dg(c);case A.Think:return p?e.jsx(Wt,{"aria-label":"",className:"icon-md text-token-text-secondary h-5 w-5"}):null;default:return null}},hasFeatureRateLimit:G,setRateLimitBannerFeature:T=>{switch(T){case A.Research:case A.Think:G(T)?(E(),t.setRateLimitBannerFeature(T===A.Research?Ca.DEEP_RESEARCH:Ca.REASON)):t.setRateLimitBannerFeature(null);break;default:t.setRateLimitBannerFeature(null);break}},restoreFocus:W,hasFiles:r})},lg=({systemHints:t,selectedHint:s,disabled:n,onHover:o,onOpen:i,onSelect:r,isDeepResearchHighLoad:a,hasFeatureRateLimit:d,restoreFocus:l})=>{const u=K(),[m,c]=f.useState(!1),p=t.find(b=>b.systemHint==="contextual_answers")?.name,x=f.useRef(!1);f.useEffect(()=>{if(!m)return()=>{requestAnimationFrame(()=>{x.current=!1})}},[m]);const g=f.useRef(!1),h=t.length===0?e.jsxs("div",{className:"mx-2 flex min-h-[40px] flex-col justify-center gap-2",children:[e.jsx("div",{className:"loading-results-shimmer bg-token-bg-tertiary h-9 w-[180px] rounded-md"}),e.jsx("div",{className:"loading-results-shimmer bg-token-bg-tertiary h-9 w-[180px] rounded-md"})]}):e.jsx(e.Fragment,{children:t.map(b=>e.jsx(U.Item,{className:"px-1 py-2",onClick:()=>{const y=b.systemHint!==s;d(b.systemHint)||(x.current=!0,r?.({hint:b,enable:y}))},disabled:b.systemHint===A.Research?a:void 0,children:e.jsx(ar,{title:b.name,description:b.description,logo:b.logo,checked:b.systemHint===s,badge:b.systemHint===A.PictureV2})},b.systemHint))});return e.jsxs(U.Root,{open:m,onOpenChange:b=>{c(b),b?i?.():requestAnimationFrame(()=>{requestAnimationFrame(()=>{x.current&&l()})})},children:[e.jsx(lr,{disabled:!!n,contextualAnswersHintNameIfPresent:p,children:e.jsx(xi,{className:"border-token-border-default text-token-text-secondary radix-state-open:bg-black/10 can-hover:hover:bg-tertiary flex h-9 min-w-9 items-center justify-center rounded-full border p-1 text-xs font-semibold focus-visible:outline-black disabled:opacity-30 dark:focus-visible:outline-white","data-opened":mn(m),"aria-label":u.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),id:"system-hint-button",disabled:n,onPointerOver:o,onClick:b=>{b.preventDefault()},onFocusCapture:b=>{b.stopPropagation()},children:e.jsx(Qu,{className:"pointer-events-none h-5 w-5"})})}),e.jsx(U.Portal,{children:e.jsx(U.Content,{size:"auto",alignOffset:-16,onEscapeKeyDown:()=>{g.current=!0},onCloseAutoFocus:b=>{if(!g.current||x.current){b.preventDefault();return}document.querySelector("#system-hint-button")?.focus()},children:h})})]})},cg=[A.Slurm],ug=({systemHints:t,selectedHint:s,disabled:n,onHover:o,onOpen:i,onSelect:r,clientThreadId:a,getFeatureRateLimitIndicator:d,isDeepResearchHighLoad:l,hasFeatureRateLimit:u,setRateLimitBannerFeature:m,restoreFocus:c,hasFiles:p})=>{const x=K(),[g,h]=f.useState(!1),b=t.find(v=>v.systemHint==="contextual_answers")?.name,{configurationMenuType:y}=Ge(),w=y==="config_icon"||y==="skills_icon",j=(y==="settings_icon"||y==="skills_icon")&&s==null,R=w?$u:Si,_=f.useRef(!1);f.useEffect(()=>{if(!g)return()=>{requestAnimationFrame(()=>{_.current=!1})}},[g]);const M=f.useRef(!1);return e.jsxs(U.Root,{open:g,onOpenChange:v=>{h(v),v?i?.():requestAnimationFrame(()=>{requestAnimationFrame(()=>{_.current&&c()})})},children:[e.jsx(lr,{disabled:!!n,contextualAnswersHintNameIfPresent:b,newToolsConfigMenu:y,skip:j,children:e.jsxs(xi,{className:"composer-btn","data-opened":mn(g),"data-pill":mn(j),"aria-label":w?x.formatMessage({id:"RiMXTh",defaultMessage:"Use a skill"}):x.formatMessage({id:"mJYhKI",defaultMessage:"Choose tool"}),id:"system-hint-button",disabled:n,onPointerOver:o,onClick:v=>{v.preventDefault()},onFocusCapture:v=>{v.stopPropagation()},children:[e.jsx(R,{"aria-label":"",className:"icon-md"}),j&&e.jsx("span",{className:"ms-1.5 me-0.5",children:w?e.jsx(P,{id:"5+Ls1e",defaultMessage:"Skills"}):e.jsx(P,{id:"mNL7WC",defaultMessage:"Tools"})})]})}),e.jsx(U.Portal,{children:e.jsx(U.Content,{size:"auto",alignOffset:-8,onEscapeKeyDown:()=>{M.current=!0},onCloseAutoFocus:v=>{if(!M.current||_.current){v.preventDefault();return}document.querySelector("#system-hint-button")?.focus()},children:e.jsxs(U.RadioGroup,{value:s,onValueChange:v=>{const E=t.find(D=>D.systemHint===v);E&&(wn(E.systemHint,E.systemHint===s?ye.Disable:ye.Enable,a),s===v?r?.({hint:E,enable:!1}):u(E.systemHint)||(_.current=!0,r?.({hint:E,enable:!0}),m(E.systemHint)))},children:[!j&&e.jsx(U.Label,{children:w?e.jsx(P,{id:"m/042P",defaultMessage:"Skills"}):e.jsx(P,{id:"KSn3Jr",defaultMessage:"Tools"})}),t.length===0?e.jsxs(e.Fragment,{children:[e.jsx(U.Shimmer,{}),e.jsx(U.Shimmer,{}),e.jsx(U.Shimmer,{})]}):e.jsx(e.Fragment,{children:t.map(v=>{const E=v.actionLabel??v.name,D=d(v.systemHint),F=v.systemHint===A.Research&&l,z=v.systemHint===A.Search&&p,S=F||z,I=F?e.jsx(P,{id:"composer.skills.unavailable",defaultMessage:"Temporarily unavailable"}):z?e.jsx(P,{id:"composer.search.skill.disabled.for.attachments",defaultMessage:"Remove attachments to search"}):void 0,G=cg.includes(v.systemHint),W=v.systemHint===s;return e.jsxs(U.RadioItem,{value:v.systemHint,disabled:S,color:W?"selected":"default",icon:e.jsx(Yt,{svgString:v.logo,"aria-label":"",className:"icon-md"}),trailing:!F&&!W&&D?e.jsx("span",{className:"text-token-text-secondary",children:D}):e.jsx(U.RadioItemCheck,{}),secondary:I,children:[E,G&&e.jsx("span",{className:"bg-token-interactive-bg-accent-default text-token-interactive-label-accent-default rounded-lg px-1 text-[0.625rem] leading-[1.6] font-semibold",children:e.jsx(P,{id:"composer.skills.new",defaultMessage:"New"})})]},v.systemHint)})})]})})})]})},lr=({disabled:t,children:s,contextualAnswersHintNameIfPresent:n,newToolsConfigMenu:o,skip:i})=>{const r=o!=null,a=o==="config_icon"||o==="skills_icon",d=Oe(pe.hasSeenComposerSystemHintButtonTooltip),l=Oe(pe.hasSeenCaSystemHint),u=!t&&!d.isLoading&&d.eligible,m=!t&&!d.isLoading&&n&&!l.isLoading&&l.eligible,c=u?{announcementKey:pe.hasSeenComposerSystemHintButtonTooltip,title:r&&a?e.jsx(P,{id:"H819Oo",defaultMessage:"ChatGPT skills, all in one place"}):e.jsx(P,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:d.markAsViewed,description:e.jsx(P,{id:"Kgb5fv",defaultMessage:"Create an image, research report, and more."})}:m?{announcementKey:pe.hasSeenCaSystemHint,title:e.jsx(P,{id:"uaC1JM",defaultMessage:"Not finding internal information?"}),onDismiss:l.markAsViewed,description:e.jsx(P,{id:"TL/S+W",defaultMessage:"If ChatGPT didn't search your files automatically, type {hintName} or select it from the menu.",values:{hintName:e.jsx("span",{className:"font-bold whitespace-nowrap",children:'"/'+n+'"'})}})}:void 0;if(i)return s;if(c)return e.jsx(Tn,{show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",sideOffset:0,className:"xs:max-w-sm! max-w-2xs!",...c,children:s});let p;return t?p=a?e.jsx(P,{id:"R3rcdg",defaultMessage:"Skills unavailable"}):e.jsx(P,{id:"uw9x80",defaultMessage:"Tools unavailable"}):r?p=a?e.jsx(P,{id:"SiU5Ib",defaultMessage:"Choose skill"}):e.jsx(P,{id:"Yr1zf1",defaultMessage:"Choose tool"}):p=e.jsx(P,{id:"mrYNGk",defaultMessage:"View tools"}),e.jsx(zt,{side:"bottom",label:p,children:s})};function dg(t){return!t||t.remaining>ig?null:t.remaining===0?e.jsx(Wt,{"aria-label":"",className:"icon-md text-token-text-secondary h-5 w-5"}):e.jsx(P,{id:"m6JsYD",defaultMessage:"{remaining} left",values:{remaining:t.remaining}})}const cr=({clientThreadId:t})=>{const s=Nm(),{setThreadSystemHintMode:n}=fe(),o=s?.location.search;f.useEffect(()=>{if(new URLSearchParams(window.location.search).get("enable-internal-knowledge")==="true"&&document){n(A.ContextualAnswers,!0,{clientThreadId:t});const r=new URLSearchParams(window.location.search);r.delete("enable-internal-knowledge");const a=r.toString();window.history.replaceState({},document.title,`${window.location.pathname}${a?`?${a}`:""}`)}},[o,t,n])},mg=({composerController:t,systemHint:s,clientThreadId:n,connectionStatuses:o})=>{const i=_s(),r=s.systemHint,a=Ut(r);cr({clientThreadId:n});const{enabled:d,availableConnectors:l,isLoading:u}=so();if(!s.composerBarButtonInfo)return null;const m=o.some(c=>c.user_connection_details.activation_status==="partially_activated"||c.user_connection_details.activation_status==="activated");return e.jsx(Dp,{composerController:t,systemHint:s,composerBarButtonInfo:s.composerBarButtonInfo,clientThreadId:n,isDisabled:!1,showLabel:i,dropdownContent:!m&&!d?e.jsx(bn,{}):void 0,splitButtonDropdownContent:d?e.jsx(Ns,{isLoading:u,clientThreadId:n,enabledConnectors:l,includeSyncConnectors:!0,includeWebSearch:!1}):m&&a?e.jsx(bn,{}):void 0,dataTestid:Xu,tooltipPosition:"top",disableNuxMarkdown:!0,as:d?"dropdown":"popover"})},bn=()=>{const[t,s]=f.useState(),{connectionInstanceData:n,isLoading:o}=ks(),i=f.useMemo(()=>[...n?.connection_statuses??[]].sort(qa),[n]),r=i.some(a=>a.user_connection_details.activation_status==="activating"||a.user_connection_details.activation_status==="partially_activated"||a.user_connection_details.activation_status==="inactive"&&a.user_connection_details.auth_status==="user_connected");return f.useEffect(()=>{N.logEventWithStatsig("Contextual Answers User Composer Dropdown Shown","chatgpt_contextual_answers_user_composer_dropdown_shown")},[]),o?e.jsx("div",{className:"w-full max-w-[calc(100vw-1.5rem)] min-w-[calc(100vw-1.5rem)] p-3 md:min-w-[22rem]",children:e.jsx(Wi,{lines:4,size:"lg"})}):e.jsxs(ut,{children:[t&&e.jsx(Ka,{connection:t,onClose:()=>s(void 0)}),e.jsxs("div",{className:"w-full max-w-[calc(100vw-1.5rem)] min-w-[calc(100vw-1.5rem)] px-1 py-3 md:min-w-[22rem]",children:[i.map(a=>{const d=a.user_connection_details.activation_status,l=d==="partially_activated"||d==="activating";return e.jsx("div",{className:Y("__menu-item",a.user_connection_details.activation_status==="activating"?"grayscale":void 0,l?"":"cursor-default"),onClick:u=>{l&&s(a),u.stopPropagation()},children:e.jsx(Ju,{title:a.connection_display_info.display_name,icon:e.jsx("img",{src:a.connection_display_info.icon_url??"",alt:a.connection_display_info.display_name,className:"icon-md"}),statusIndicator:e.jsx($a,{connection:a,location:"user_dropdown"})})},a.user_connection_details.connection_instance_id)}),e.jsx("div",{className:"__menu-item",onClick:a=>{window.location.hash="#settings/ConnectorSettings",a.stopPropagation()},children:e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-4 text-start",children:[e.jsx(An,{className:"icon-md"}),e.jsx("p",{className:"text-token-text-primary flex-1 text-sm font-medium",children:r?e.jsx(P,{id:"EqgQdy",defaultMessage:"See syncing state"}):e.jsx(P,{id:"05N3nu",defaultMessage:"Manage connectors"})})]})})]})]})};function pg({systemHints:t,composerController:s,clientThreadId:n}){const{configurationMenuType:o}=Ge(),i=o!=="none",r=Kn(s),a=t.find(({systemHint:u})=>u===r),{isUnauthenticated:d}=Pe(),{setThreadSystemHintMode:l}=fe();return f.useEffect(()=>{o!=="none"&&r&&!t.some(({systemHint:u})=>u===r)&&!d&&l(r,!1,{clientThreadId:n})},[n,l,r,t,d,o]),a?e.jsxs("div",{"data-testid":"active-system-hint-pill",className:$n("[view-transition-name:var(--vt-composer-active-system-hint-pill)",i&&"flex items-center gap-1.5 ps-0.5"),children:[e.jsx("div",{"data-separator":!0,className:"bg-token-border-default h-3 w-px"}),e.jsx(fg,{activeSystemHint:a,onClick:()=>{l(a.systemHint,!1,{clientThreadId:n})}})]},"active-hint-tag"):null}function fg({activeSystemHint:t,onClick:s}){const n=K(),{configurationMenuType:o}=Ge(),i=o!=="none";return e.jsxs(Ts,{as:i?"button":"div",role:i?void 0:"button",tabIndex:i?void 0:0,onClick:s,spacing:"compact",isSelected:!0,isLegacyStyle:!0,borderVisible:!0,children:[e.jsx(Yt,{svgString:t.logo,className:i?"icon-md":"icon-md text-token-interactive-label-accent-default flex-1","aria-label":""}),e.jsx("span",{"data-label":!0,className:"mx-1.5",children:t.shortLabel??t.name}),i&&e.jsx(Ti,{"aria-label":"",className:"icon-smaller -ms-0.5 mt-px @max-[521px]/thread:ms-1"}),!i&&e.jsx(bi,{"data-remove-think-button":!0,className:"-me-1","aria-label":n.formatMessage({id:"HW9RTL",defaultMessage:"Disable {systemHintName}"},{systemHintName:t.name})})]})}function gg({systemHints:t,composerController:s,clientThreadId:n,connectionStatuses:o}){cr({clientThreadId:n});const{configurationMenuType:i}=Ge(),r=i!=="none",a=Kn(s),d=t.find(({systemHint:h})=>h===a),{availableConnectors:l,isLoading:u}=zi(),{availableConnectors:m,enabled:c,isLoading:p}=so();return!r||!d?null:a===A.Research||!1?e.jsx(Ea,{isLoading:u,clientThreadId:n,enabledConnectors:l,trigger:e.jsx(U.BasicTrigger,{asChild:!0,children:e.jsxs(Ts,{as:"button",spacing:"compact",children:[e.jsx(En,{className:"icon-md","aria-label":""}),e.jsx("span",{"data-label":!0,className:"mx-1.5",children:e.jsx(P,{id:"DhW8Wx",defaultMessage:"Sources"})}),e.jsx(jt,{className:"icon-sm -ms-0.5 @max-[521px]/thread:ms-1"})]})})}):a===A.Slurm&&c?e.jsx(Ea,{clientThreadId:n,enabledConnectors:m,includeWebSearch:!1,trigger:e.jsx(Yp,{clientThreadId:n,includeSyncConnectors:!1,includeWebSearch:!1})}):a===A.ContextualAnswers&&(o&&o.length>0||c)?e.jsx("div",{"data-testid":"sources-pill",className:$n("[view-transition-name:var(--vt-composer-sources-pill)",r&&"flex items-center gap-1.5 ps-0.5"),children:e.jsx(hg,{dropdownContent:c?e.jsx(Ns,{isLoading:p,clientThreadId:n,enabledConnectors:m,includeSyncConnectors:!0,includeWebSearch:!1}):e.jsx(bn,{}),as:c?"dropdown":"popover"})},"sources-tag"):null}function hg({dropdownContent:t,as:s}){const n=e.jsxs(Ts,{as:"button",spacing:"compact",children:[e.jsx(En,{className:"icon-md mx-1","aria-label":""}),e.jsx("span",{"data-label":!0,children:e.jsx(P,{id:"DhW8Wx",defaultMessage:"Sources"})}),e.jsx("div",{className:"me-0.5 flex items-center",children:e.jsx(jt,{className:"pointer-events-auto! h-4 w-4"})})]}),o=s==="popover"?e.jsx(Rn,{children:e.jsx(ed,{className:"p-0",$as:Mn,side:"bottom",align:"start",collisionPadding:10,sideOffset:8,children:t})}):e.jsx(U.Portal,{children:e.jsx(U.Content,{children:t})});return s==="popover"?e.jsxs(kn,{children:[e.jsx(Zu,{asChild:!0,children:n}),o]}):e.jsxs(U.Root,{children:[e.jsx(U.Trigger,{asChild:!0,children:n}),o]})}function xg({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:i,getInputProps:r,openFileDialog:a,onOauthRedirect:d,historyDisabled:l,isDisabled:u,highlightTooltip:m,disabledReason:c,currentModelName:p,showLabel:x,showUpsell:g,hideBorder:h,isSmall:b,visualTreatment:y,layoutMode:w,restoreFocus:k}){const j=qn(),{gdriveStatus:R,o365Status:_}=pi(),M="h-[20px] w-[20px]",v=l?"text-white":m?"text-brand-blue-800":"",E=g?e.jsx(dn,{"aria-label":"",className:Y(M,v)}):e.jsx(dn,{"aria-label":"",className:Y(M,v)}),D=(R!=="false"||_!=="false"||j||y==="vanguard")&&!g,F=Bm(),z=y==="vanguard"&&!F,S=D?e.jsx(rr,{hideBorder:h,isSmall:b,clientThreadId:t,icon:E,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:o,attachmentsProductFeature:i,onOauthRedirect:d,uploadType:s,openFileDialog:a,getInputProps:r,isDisabled:z?!1:u,highlightTooltip:m,disabledReason:c,currentModelName:p,visualTreatment:y,layoutMode:w,restoreFocus:k}):e.jsx(sr,{isSmall:b,hideBorder:h,clientThreadId:t,uploadType:s,openFileDialog:a,getInputProps:r,showLabel:x,showUpsell:g,icon:E,isDisabled:u,highlightTooltip:m,disabledReason:c,currentModelName:p});return e.jsx("div",{className:"relative",children:e.jsx(ir,{showBackground:m,className:"bg-brand-blue-800/20",children:S})})}const Sg=({clientThreadId:t,currentModel:s,uploadType:n,modelSupportedImageMimeTypes:o,modelAcceptedMimeTypes:i,modelProductFeatures:r,getEditorGizmoId:a,onOauthRedirect:d,disabledReason:l,isTemporaryChat:u,isDisabled:m,highlightTooltip:c,showLabel:p,showUpsell:x,numRemainingFiles:g,visualTreatment:h,layoutMode:b,restoreFocus:y})=>{const w=K(),k=Ke(),{handleFileAccepted:j}=lo(w,n,o,"mouse",a,r?.attachments),{getInputProps:R,open:_}=ao({disabled:m,noClick:!0,onDropAccepted:j,onDropRejected:M=>ro(M,w,k,n),multiple:!0,maxSize:zn,maxFiles:g,...Un(i)});return e.jsx(xg,{isSmall:!0,hideBorder:!0,isDisabled:m,highlightTooltip:c,onOauthRedirect:d,visualTreatment:h,attachmentsProductFeature:r?.attachments,clientThreadId:t,uploadType:n,modelAcceptedMimeTypes:i,modelSupportedImageMimeTypes:o,getInputProps:R,openFileDialog:_,historyDisabled:u,showLabel:p,showUpsell:x,disabledReason:l,currentModelName:s?.title??"",layoutMode:b,restoreFocus:y})};function bg(){const s=oi().has(A.Research),n=!1,o=Mt(),i=ct(o,"3544641259");return(s||n)&&i}function yg(){const t=Wn(),o={initial:{opacity:0,y:"-28px",rotate:45},animate:{opacity:1,y:0,rotate:45,transition:t?Ht:{opacity:{delay:.4},default:_a}},exit:{opacity:0,y:"-28px",rotate:45,transition:t?Ht:{opacity:{delay:0},default:_a}}};return e.jsx(J.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",className:"border-token-border-xlight bg-token-main-surface-primary absolute start-1/2 top-full mt-[11px] h-2 w-2 -translate-x-1/2 transform rounded-se-[1px] rounded-es-[1px] border-s border-t dark:bg-[#303030]"})}const Cg=({activeSystemHint:t,showHints:s,showContextChevron:n,onRemoveHint:o,lockSystemHint:i})=>{const r=K(),{popoverTriggerRef:a}=Nn(),d=()=>{requestAnimationFrame(()=>{a.current?.focus()})};if(t){const{logo:l,name:u}=t;return e.jsxs("div",{className:Y("relative flex items-center justify-center",!i&&"-me-1"),children:[e.jsx(Yt,{className:"icon-md text-token-interactive-label-accent-default flex-1",svgString:l}),!i&&e.jsx(bi,{"data-remove-hint-button":!0,onClick:m=>{m.stopPropagation(),m.preventDefault(),o(),d()},"aria-label":r.formatMessage({id:"YQ7uOV",defaultMessage:"Remove {tool} from selection"},{tool:u})}),n&&e.jsx(yg,{})]})}return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-token-border-default ms-0.5 h-[16px] w-[1px]"}),e.jsx("div",{className:"text-token-text-tertiary hover:text-token-text-primary me-0.5 flex items-center",children:e.jsx(jt,{className:"text-token-text-tertiary hover:text-token-text-primary pointer-events-auto! h-4 w-4"})})]}):e.jsx(Si,{"aria-label":r.formatMessage({id:"xosz07",defaultMessage:"View all tools"}),className:"text-token-text-secondary h-5 w-5"})},vg={source:{id:"SystemHintCategory.Sources",defaultMessage:"Sources",description:"Label on system hint menu for hints that act as data sources"},tool:{id:"SystemHintCategory.Tools",defaultMessage:"Tools",description:"Label on system hint menu for hints that act as tools"}},wg=({children:t,clientThreadId:s,layoutMode:n,lockSystemHint:o,composerController:i,onChangeSystemHint:r,systemHints:a,activeSystemHintType:d,recentSystemHintTypes:l,showHints:u,reasonItem:m=!1,gizmoId:c,isInReasonMode:p,type:x,...g})=>{const h=bg(),b=Wn(),y=K(),w=a.find(({systemHint:L})=>d===L),k=Rt(),j=l.map(L=>L===A.PictureV2&&!a.find(({systemHint:T})=>L===T)?a.find(({systemHint:T})=>T===A.Picture):a.find(({systemHint:T})=>L===T)).filter(L=>!!L),[R,_]=f.useState(null),M=(L,T)=>{T?_(L):r(L)},{selectedIndex:v,systemHintSuggestions:E,suggestorClosed:D,resetSelectedIndex:F}=or({composerController:i,clientThreadId:s,onHintSelected:r}),z=D?a:E,S=[],I=nr(z);let G=0;for(const L of I){const T=L.systemHints;T.length!==0&&(S.push({...L.category?{message:vg[L.category]}:{},systemHints:T,indexOffset:G}),G=T.length)}const W=()=>{i.setReasonMode(!p),p?N.logEventWithStatsig("Composer Think Button Disabled","composer_think_button_disabled",{clientThreadId:s}):N.logEventWithStatsig("Composer Think Button Enabled","composer_think_button_enabled",{clientThreadId:s})};return e.jsxs("div",{className:Y("flex items-center rounded-full",u&&"me-1 border",d!==void 0?"border-transparent":x==="toolpile_icon"?"border-token-border-default":"border-token-border-xlight"),children:[!w&&u&&e.jsx(td,{onChangeSystemHint:M,systemHints:j}),e.jsxs(no,{layoutMode:n,forceOpen:!D,...g,children:[t?e.jsx(qi,{children:t}):e.jsx(mp,{transition:b?Ht:hs,shape:d?"rectangle":"round",spacing:"compact",isSelected:d!==void 0,"aria-label":y.formatMessage({id:"NLd5mV",defaultMessage:"Open tool menu"}),className:Y(u&&"-mx-0.5",o&&"cursor-default!",x==="config_icon"&&"min-w-9",x==="toolpile_icon"&&"min-h-9"),onClick:L=>{if(o){L.stopPropagation(),L.preventDefault();return}},tooltipLabel:!d&&y.formatMessage({id:"xgQfBi",defaultMessage:"View all tools"}),disableHover:u&&!w||o,isLegacyStyle:x==="config_icon"||x==="toolpile_icon"&&!!d,borderVisible:x==="config_icon"||x==="toolpile_icon"&&!!d,children:e.jsx(Cg,{activeSystemHint:w,showHints:u,showContextChevron:h||!1,onRemoveHint:()=>r(null),lockSystemHint:o})}),e.jsx(oo,{onMouseDown:L=>{L.preventDefault()},align:"end",children:e.jsx(sd,{onChangeSystemHint:M,systemHintCategories:S,activeSystemHint:d,activeIndex:v,resetActiveIndex:F,reasonItem:m,gizmoId:c,clientThreadId:s,handleToggleReasonItem:W,isInReasonMode:p})})]}),!k||k.planType===Im.FREE&&e.jsx(nd,{open:!!R,onOpenChange:()=>_(null),systemHint:R})]})},Ia="gpt-4o",_g=({clientThreadId:t,composerController:s,pendingFiles:n,isUploadDisabled:o,highlightUploadTooltip:i,hasFiles:r,conversationMode:a,placeholder:d,isTemporaryChat:l,layoutMode:u,state:m,inputState:c,disableReason:p,gizmoId:x,currentModel:g,replyRegions:h,uploadButtonDisabledReason:b,keepExpanded:y=!1,getEditorGizmoId:w,onOauthRedirect:k,onSubmit:j,visualTreatment:R,legacyFooterActions:_,legacySuggestionsPopoverContent:M,isNewThread:v=!1,isInReasonMode:E,modelSupportedSystemHints:D,contextualAnswerUserConnectionData:F})=>{const{data:z}=Kt(),[S,I]=ua(!1),{updateSystemHint:G}=fe(),{configurationMenuType:W}=Ge(),L=W!=="none";As();const T=Ye.useState(({persistedSystemHints:$})=>$);od(t,R==="vanguard");const V=Array.from(T)[0],H=Ye.useState(({recentHints:$})=>$),{state:Q}=ys(t),ae=_t(!1),we=Fe($=>$.threads[t]?.modelSelection),ze=we?.type===Ce.SPECIFIC,dt=Fe($=>$.setThreadModelSelection),Te=R==="vanguard"&&g?.id!==Ia&&!ze&&!S();yi(f.useCallback(()=>{Te&&(ae({location:"PromptTextarea",modelId:Ia}),yt(t,dt,{type:Ce.EFFORT_MODE,effortMode:ei.low}))},[Te,ae,t,dt]));const{setIsOpen:$e}=ad(),Qe=$=>{I(!0),G($,{clientThreadId:t}),$===A.Research?$e(!0):$e(!1),$&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.focus()})})},_e=!1,je=Q==="clarify"||_e,ke=f.useCallback(($,Ze)=>e.jsx(fi,{...Ze,isSmall:R==="vanguard",inputState:c,state:m,onSubmit:j,composerController:s,clientThreadId:t,gizmoId:x,disableReason:p,useStartButtonText:je,disableTooltip:$}),[c,m,j,s,t,x,p,je,R]),Xe=$=>{S()&&($.preventDefault(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.focus()})}))},ge=id({inputState:c,state:m,composerController:s,clientThreadId:t}),{whisperControls:Ne}=Ki({composerController:s,renderInComposer:ke,composerType:R,composerRightButtonType:ge,layoutMode:u}),[ne=null,Re,mt]=f.useMemo(()=>[On(g,a),Hn(g,a),Gn(g,a)],[g,a]);Yn(t);const Je=Ye.useState(({availableHints:$})=>$),le=Ye.useState(({locked:$})=>$),ce=f.useMemo(()=>we?.type===Ce.EFFORT_MODE?rd[we.effortMode]:"low",[we]),[te,Me]=ua(ce);f.useEffect(()=>{Me(ce)},[ce,Me]),Oe(pe.ModelPickerMoved);const Be=Pn(x);Q!=="disabled"||_e||(a?.kind,De.GizmoInteraction);const{pageType:At}=Ci(),ue=vi($=>$.selectedApps),pt=wi()&&ue.length>0,de=r||pt,Et=y||!!V||h&&h.length>0||de||Je.length<3;xs(g,a,T);const O=Ut(A.ContextualAnswers)&&!!v,{shouldShowResearchText:he}=ys(t),Ie=ld(),$t=cd({exposed:O})==="bigbox",Qt=Ie&&he||$t&&O;return e.jsxs(vp,{isBigBoxModeActive:Qt,isTemporaryChat:l,placeholder:d,visualTreatment:R,composerController:s,isExpandedByDefault:Et,onSubmit:j,children:[h&&h.length>0&&e.jsx(ja,{children:e.jsx(hi,{replyRegions:h})}),de&&e.jsx(ja,{children:e.jsx(pn,{files:n,fullBleed:!0,selectedApps:ue,className:$n("no-scrollbar -ms-1.5 flex flex-nowrap gap-2 overflow-x-auto",R==="composer-btn"?"horizontal-scroll-fade-mask py-1.5 ps-2 pe-4 [--edge-fade-distance:1rem]":"p-1.5")})}),[_?.map(($,Ze)=>e.jsx(wp,{children:$},`legacy-footer-action-${Ze}`))??[],(L&&e.jsx(ka,{children:e.jsx(pg,{clientThreadId:t,composerController:s,systemHints:D})},"active-hint-tag"))??[],e.jsx(ka,{children:e.jsx(gg,{clientThreadId:t,composerController:s,systemHints:D,connectionStatuses:F?.connection_statuses})},"sources-tag"),e.jsx(_p,{children:M},"legacy-suggestions-popover")],R==="vanguard"&&e.jsx(jp,{children:e.jsx(wg,{activeSystemHintType:V,lockSystemHint:At.type==="landing-page"||le,systemHints:Je,clientThreadId:t,composerController:s,onChangeSystemHint:Qe,layoutMode:u,recentSystemHintTypes:H,showHints:!v,isInReasonMode:E,restoreFocus:Xe})},"system-hint-popover"),e.jsx(kp,{children:Ne}),Ie&&he?e.jsx(Ra,{children:e.jsx(Rp,{composerController:s,visualTreatment:"vanguard"})}):$t&&O?e.jsx(Ra,{children:e.jsx(ud,{composerController:s,visualTreatment:"vanguard"})}):null]})},jg=Zn(()=>eo(()=>import("./heu4jyunh2d29vgy.js"),__vite__mapDeps([8,1,2,3,4,5,9,10,11,12,13,14])).then(t=>t.ImageGenComposer)),kg=1,Rg=3e3,Mg=()=>null;function Ag({onCreateNewCompletion:t,onContinueGenerating:s,account:n,currentModelId:o,currentModelConfig:i,disableDraftPersistence:r=!1,modelCategories:a,areModelsLoading:d,clientThreadId:l,isNewThread:u,isCompletionInProgress:m,className:c,disabled:p=!1,disabledReason:x,canPause:g=!1,canContinue:h=!1,isInteractableSharedThread:b,onComposerInput:y,onComposerChange:w,onAutocompleteSelect:k,headerClassName:j,hideHeader:R,onTaggingDropdownOpen:_,onTaggingDropdownClose:M,onlyAllowImageUploads:v}){da.markStart("PromptTextarea"),da.markRendered("PromptTextarea");const E=f.useContext(Hi),D=Lm(E),F=Mt(),z=f.useRef(null),S=kt(),I=ii(),G=Dm(I.showUploadSuggestion$),W=dd(),L=n?.isTeam(),{isUnauthenticated:T}=Pe(),V=K(),H=Ke(),Q=In(),ae=As(),we=md.useStore(),[ze,dt,Te]=re(l,C=>[se.getCurrentLeafId(C),se.getRequestId(C),se.findNode(C,q=>!!q.message.metadata?.b1de6e2_s)]),[$e]=fl(),{gizmoEditorData:Qe,mode:_e,getGizmoId:je}=Fn(),ke=Fm(),Xe=_s(),ge=Om(),Ne=pd(),ne=Oi(l),Re=!!Ai(),mt=!!Jn(),Je=fd.useIsEnabled(l),le=!!to(),{setThreadSystemHintMode:ce}=fe(),te=Gt(),{state:Me}=ys(l),Be=te.has(A.Search),At=te.has(A.Think),ue=Oe(pe.ModelPickerMoved),pt=te.has(A.Research),{activeSystemHints:de}=Yn(l),Et=de.length>0,O=de.find(C=>C.systemHint===A.ContextualAnswers),he=gd(),{connectionInstanceData:Ie,isLoading:$t}=ks({skip:!he}),{selectedSources:Qt}=Vt(l),$=hd(F);Vi({skip:!$}),lp({skip:!$});const Ze=f.useRef(0),Bs=f.useRef(!1),dr=a?.find(C=>C.defaultModel===o),mr=Mg();let X=Ms(l),Is=X&&"gizmo"in X?X.gizmo:void 0;const pr=Hm(),et=Is?.gizmo.id??pr,Pt=Pn(et),fr=xd(),co=Sd(),[xe,Xt]=f.useState(null);xe!==null&&(X={gizmo:xe,gizmo_id:xe.gizmo.id,kind:De.GizmoInteraction},Is=xe);const Tt=xs(i,X,te),gr=Es(),uo=Fi(F).flags,Jt=uo?.includes(vs.NoAuthEnableFileUploads),{showLegacyReasoningSlider:tt,showReasoningSliderNux:hr,reasoningSliderType:xr,hideReasonInSystemHintOverflow:Sr,hideSearchInSystemHintOverflow:br,configurationMenuType:mo}=Ge(),po=mo!=="none",Zt=Fe(C=>C.setThreadModelSelection),fo=Fe(C=>C.threads[l]?.modelSelection),go=fo?.type===Ce.EFFORT_MODE?fo.effortMode:null,ho=!!go&&go!=="default";yi(f.useCallback(()=>{ho&&yt(l,Zt,{type:Ce.EFFORT_MODE,effortMode:"default"})},[ho,l,Zt])),Sp({serverThreadId:ne,clientThreadId:l,composerController:S,currentModelId:o,account:n,getIsDisabled:f.useCallback(()=>!1,[]),onReset:()=>{yt(l,Zt,{type:Ce.EFFORT_MODE,effortMode:"default"})},onInfer:C=>{yt(l,Zt,{type:Ce.EFFORT_MODE,effortMode:C})},isInferEnabledForModel:i?.enableInfer});const xo=!p&&(Tt!==ot.None||d)&&(!T||Jt),We=Hn(i,X),Ls=Gn(i,X);let ie=un(C=>C.files);const[es]=f.useState(()=>bd());_e==="magic"?ie=ie.filter(C=>C.gizmoId!=null):ie=ie.filter(C=>C.gizmoId==null);const So=yd(),Se=ie.length>0||So,bo=un(Jd.hasUploadInProgress),Ds=vi(C=>C.selectedApps),yo=wi()&&Ds.length>0,yr=Se||yo,Cr=Cd(l),Fs=S.useState(C=>{const q=vd(C);return typeof i?.maxTokens=="number"&&q>i.maxTokens}),Co=S.useState(C=>!C.isEmpty()),ts=!Fs&&!bo&&(Co||Se),vo=(Tt===ot.Multimodal?Ln:Dn)-ie.length,wo=vo<=0,vr=wd(),wr=oe("3544641259")?.value,{selectedRepos:Os}=jn(l),_o=vr&&wr&&Qt?.size===0,ft=ts&&!p&&!le&&(!m||co)&&!_o,[jo,_r]=f.useState(!1),{value:jr}=oe("3780975974"),{targetedContent:ko,setTargetedContent:ss}=_d(),Ae=ko?.isFocusedViewContent&&!Ne?void 0:ko;f.useEffect(()=>{requestAnimationFrame(()=>requestAnimationFrame(()=>S.focus()))},[Ae]);const Ro=X==null||X?.kind===De.PrimaryAssistant||X?.kind===De.GizmoInteraction&&Pt,{getUpsellLabelType:kr,getUpsellShowsAttach:Rr,getShowUpsellReason:Mr}=gi(),Hs=Et&&Ro,[Ar,Er]=f.useState(!1),Pr=!T&&Ro&&(!L||!$t),gt=at(S.store,C=>C.controlsDisabled);f.useEffect(()=>{if(!W?.id)return;const C=ma.getAndReset(W.id,ne);C&&S.setText(C.inputText)},[W?.id,ne,S]),f.useEffect(()=>{const C=$e.get("prompt")??"";S.getCurrentText().length===0&&C.length>0&&S.setText(C)},[S,$e]),f.useEffect(()=>{jo!==ft&&(_r(ft),ft&&Um(!0).then(C=>{jd.startEnforcement(C),Gm.startEnforcement(C)}))},[ft,jo,X?.kind,ke]);const ns=On(i,X),{handleFileAccepted:Mo}=lo(V,xs(i,X,te),We,"mouse",je,ns?.attachments),Tr=f.useCallback((C,q)=>(requestAnimationFrame(()=>{requestAnimationFrame(()=>{S.focus()})}),Mo(C,q)),[S,Mo]),{getInputProps:Nr,open:Us,inputRef:Ao}=ao({disabled:p||!xo||wo,noClick:!0,onDropAccepted:Tr,onDropRejected:C=>ro(C,V,H,Tt),multiple:!0,maxSize:zn,maxFiles:vo,...Un(T||v?We:Ls)}),Eo=at(es),Po=f.useCallback(()=>{S.eraseContent(),Eo.clearMessages(),S.resize(kg),S.usedDictation=!1,S.dictationEdited=!1;for(const C of ie)fs.remove(Q,C.tempId,"none");kd.markAllAsSent()},[S,Eo,ie,Q]),Nt=at(S.store,C=>C.isInReasonMode),To=f.useMemo(()=>en(Nt,S,te)[0],[Nt,S,te]),No=async(C,q)=>{if(C.preventDefault(),p||!ts||!X)return;const me=S.getContentToSend(),be=Zd(me.content),st=en(Nt,S,te),{content:Qs,attachments:Xs}=em(Q,be,i,X,te);fr(),t({sourceEvent:C,attachments:Xs,content:Qs,contentToSend:me,conversationMode:X,hasSelectedApps:yo,isMessageFollowupsEnabled:Je,selectedApps:Ds,selectedGizmoTag:xe,selectedRepos:{selectedAllRepos:Os.selectedAllRepos,selectedRepos:Os.selectedRepos?[...Os.selectedRepos]:null},selectedSources:Qt,systemHints:st,usedDictation:S.usedDictation,dictationEdited:S.dictationEdited}),Ae?.onCreateCompletion?.({serverThreadId:ne,currentLeafId:ze}),Ae?.shouldPersistAcrossMessages!==!0&&ss(void 0),pa.hideThreadHeader();for(const ia of ie)ia.status===tm.Ready&&we.addFile(ia);Po()},Br=C=>{ss(C.targetedReply),C.targetedReply&&N.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:ne,sourceMessageId:C.messageId})},{maybeSetWaitingForRealtimeOnAbort:Bo,isWatingForRealtimeStatusChange:Ir}=Rd(l),Gs=f.useCallback(C=>{Bo(),Md(C)},[Bo]),Io=f.useCallback(()=>{Ae?.onCleared?.({serverThreadId:ne,currentLeafId:ze}),ss(void 0),S.focus()},[ze,ne,Ae,ss,S]),Lo={Enter:{validator:C=>{const q=C.isComposing||C.keyCode===229;return!(as&&Bs.current)&&(C.metaKey||(Xe||qm||Ym())&&!C.shiftKey&&!q)},handler:C=>{if(!ft){Fs&&H.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}C.preventDefault(),No(C)}},Escape:{validator:C=>!C.isComposing,handler:C=>{g&&m&&(Gs(l),N.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:Ft(l),currentLeafId:se.getCurrentNode(Ee(l)).message.id,eventSource:"keyboard"})),C.target.value===""&&Io()}}},Bt=f.useRef(Lo);Bt.current=Lo;const os=Ad(i?.tags,X?.kind),{showTaggingDropdown:zs,isFocused:Lr,autocompletions:Ve,matchaData:Dr}=at(S.store),as=Lr&&Ve.length>0,ht=os&&zs&&!Pt,Do=S.isReady();f.useEffect(()=>S.subscribe("keydown",C=>{S.acceptLegacyKeydown()&&Bt.current[C.key].validator(C)&&Bt.current[C.key].handler(C);const me=S.getCurrentText();if(C.key==="@"){const be=S.getSelectionStart(),st=me.substring(0,be);(!st||/\s$/.test(st)||be===0)&&setTimeout(()=>S.setShowTaggingDropdown(!0),10)}else zs&&S.setShowTaggingDropdown(!1);C.key==="Escape"&&(Xt(null),S.setAutocompletions([])),Be&&C.key==="Escape"&&ce(A.Search,!1,{clientThreadId:l})}),[S,Do,zs,te,Be,ce,l]),f.useEffect(()=>{const C=Object.fromEntries(Object.keys(Bt.current).map(q=>[q,be=>{const st=Bt.current[q];if(!st||S.acceptLegacyKeydown())return!1;const{validator:Qs,handler:Xs}=st;return Qs(be)?(Xs(be),!0):!1}]));S.registerKeyHandlers(C),S.registerFileInput({openFileDialog:Us,inputRef:Ao})},[S,Us,Ao,Do]),f.useEffect(()=>S.subscribe("paste",C=>{Ed({filePickerStore:Q,event:C,intl:V,toaster:H,clientThreadId:l,conversationMode:X,currentModelConfig:i,getEditorGizmoId:je,modelSupportedImageMimeTypes:We,persistedSystemHints:te})}),[V,l,X,i,je,We,S,H,Q,te]);const Fo=C=>{Re||Xt(C),S.trimLeadingText("@"),cn(),S.setShowTaggingDropdown(!1)},Fr=Pd(l,es,We,ns?.attachments),Or=f.useCallback(C=>{C.preventDefault(),Gs(l),N.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:Ft(l),currentLeafId:se.getCurrentNode(Ee(l)).message.id,eventSource:"mouse"}),cn()},[l,Gs]),is=f.useCallback(()=>{ma.set(W?.id,ne,S.getCurrentText())},[ne,W?.id,S]);f.useEffect(()=>{Qe||Td()||S.focus()},[S]),f.useEffect(()=>{if(We.length>0)for(const q of ie)Nd(q.fileSpec?.mimeType,Ls)||fs.remove(Q,q.tempId,"none");else fs.reset(Q)},[o,Q]),f.useEffect(()=>{(!os&&xe||Re)&&Xt(null)},[os,xe,Re]),f.useEffect(()=>{mt&&S.setReasonMode(!1)},[mt,S]),f.useEffect(()=>{Se&&te.has(A.Search)&&ce(A.Search,!1,{clientThreadId:l})},[Se,l,ce,te]);const{layer:Hr}=He("4031588851"),{layer:Oo}=He("3637408529"),Ur=Oo.get("is_in_composer_text_exp",!1),Gr=Oo.get("composer_text","MESSAGE_CHATGPT"),zr=Hr.get("composer_text","MESSAGE_CHATGPT"),Wr=Ur?Gr:zr,[rs,Vr]=(()=>{switch(x){case"workspaceDisallowsGizmo":return[Z.disallowedByWorkspacePlaceholder,!0];case"noModelsAvailable":return[Z.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Z.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Z.loading,!0];case"noTestGizmoId":return[Z.noTestGizmoId,!0];default:{if(b)return[Z.placeholderWithName,!1];if(Ae?.placeholderTextOverride!=null)return[Ae.placeholderTextOverride,!1];if(Me==="initial"||Me==="recurrent")return[Z.deepResearchPlaceholder,!1];if(Me==="clarify")return[Z.researchSuggestionInitial,!1];if(To)switch(To){case A.Search:return[Z.searchPlaceholder,!1];case A.Think:return[Z.thinkPlaceholder,!1];case A.Research:return[Z.researchPlaceholder,!1];case A.Canvas:return[Z.canvasPlaceholder,!1];case A.Picture:return[Z.picturePlaceholder,!1];case A.PictureV2:return[Z.pictureV2Placeholder,!1];case A.ContextualAnswers:return[Bd.caSuggestionInitial,!1]}switch(Wr){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Z.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Z.placeholderAskNameAnythingVariant,!1];default:return[Z.placeholderWithName,!1]}}}})(),Ws=Pt?u?V.formatMessage(Id.newChatInProject):rs?V.formatMessage(rs,{name:"ChatGPT"}):"â€‹":rs?V.formatMessage(rs,{name:Qe!=null?_e==="magic"?Ld:Qe.name||"GPT":Is?.gizmo.display.name??"ChatGPT"}):"â€‹";f.useEffect(()=>S.subscribe("input",()=>{Dd.getState().isThreadHeaderVisible&&pa.hideThreadHeader()}),[S]),f.useEffect(()=>S.subscribe("input",()=>{Ze.current=performance.now(),y?.()}),[S,y]),f.useEffect(()=>{if(w)return S.subscribe("change",()=>{w()})},[S,w]);const qr=jr||Mr(),Ho=Fd()&&!!Ve.find(C=>!!C.requires_file_upload),Yr={clientThreadId:l,uploadType:Tt,modelAcceptedMimeTypes:Ls,modelSupportedImageMimeTypes:We,attachmentsProductFeature:ns?.attachments,getInputProps:Nr,openFileDialog:Us,historyDisabled:ge,onOauthRedirect:is,highlightTooltip:Ho&&!Se},It=[],Uo=[],Go=!p&&!wo&&(xo||gr!=null),zo=Rr(),Kr=!T||zo||Jt,Wo=Tt===ot.None?Ct.ModelNotSupported:At?Ct.ThinkModeInUse:Be?Ct.SearchModeInUse:void 0;if(Kr){const C=e.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:e.jsx(tg,{...Yr,showGlowingBorder:G,showLabel:kr()==="all",showUpsell:zo&&!Jt,showMenuForNoAuth:Jt,isDisabled:!Go||gt,disabledReason:Wo,currentModelName:i?.title??"",visualTreatment:po?"composer-btn":"legacy"})},"file-upload-button");It.push(C),Uo.push(C)}const Le=[],Vo=Vn(),qo=Fe(C=>C.isVisuallyOverflowing)&&tt;let ls="bottom";Vo?ls="bottom":u&&(ls="centered"),tt&&(X?.kind!==De.GizmoInteraction||Pt)&&Le.push(e.jsx("div",{"data-testid":"composer-action-reasoning-level",className:"flex [--pill-color:var(--text-secondary)] [--pill-font-size:13px]",onPointerDown:C=>C.stopPropagation(),children:e.jsx(Tn,{announcementKey:pe.ModelPickerMoved,side:"bottom",show:ae&&hr&&!ue.isLoading&&ue.eligible,onDismiss:ue.markAsViewed,theme:"bright",badge:"none",dismissOnOutsideClick:!0,sideOffset:0,title:e.jsx(P,{id:"NGN4SW",defaultMessage:"Set how long ChatGPT should think or pick a different model"}),children:e.jsx(gf,{clientThreadId:l,layoutMode:ls,currentModel:i,category:dr,type:xr,mode:Pt?"model-picker-only":"default"})})},"reasoning-level")),br||Le.push(e.jsx(nf,{account:n,clientBootstrapFlags:uo,features:ke,currentModelConfig:i,hasFiles:Se,isDisabled:gt||Se,clientThreadId:l,composerController:S,gizmoId:et},"search"));const{value:$r}=oe("1830177352");!tt&&!Sr&&Le.push(e.jsx(ef,{clientThreadId:l,gizmoId:et,composerController:S,isDisabled:gt},"reason")),$r&&Le.push(e.jsx(Jp,{clientThreadId:l,gizmoId:et,showLabel:qr,isDisabled:gt},"deep-research")),qo||Le.push(e.jsx(op,{clientThreadId:l,composerController:S,isDisabled:gt,currentModelConfig:i,currentModelConfigLoading:d,disableIfNoAccess:tt},"shiba")),ct(F,"3240576626");const{enabled:Qr}=so();if(O&&!qo&&(Ie&&Ie.connection_statuses.length>0||Qr)&&Le.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-search-action)"},"data-testid":"composer-action-contextual-answers",children:e.jsx(mg,{composerController:S,systemHint:O,clientThreadId:l,connectionStatuses:Ie?.connection_statuses??[]})},"contextual-answers")),Pr&&Le.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-hint-action)"},"data-testid":"composer-action-system-hint-button",children:e.jsx(rg,{composerController:S,clientThreadId:l,disabled:gt,hideThinkButton:tt,disableIfNoAccess:tt,hasFiles:Se})},"system-hint-button")),mo==="none"){const C=Le.filter(q=>D?q.key==="search":!0);It.push(...C)}else{const C=Le.find(q=>q.key==="system-hint-button");C&&It.push(C)}const Vs=ct(F,"2007855518"),Yo=Te?.message.metadata?.async_task_id,qs=Od(C=>Yo?C.tasks[Yo]:null),[Xr,Ko]=f.useState(!1),Ys=qs?.status===Hd.RUNNING,Ks=Vr||Ir?"disabled":"default",$o=Ud(Ft(l)||l)?.value,Jr=$o===va.STREAMING,Zr=$o===va.REALTIME,Qo=m&&g||Jr||Zr||Ys&&Vs,el=zm(),tl=!ft||el,$s=$d(bo,Co,Fs,Cr,!_o,Ys,Vs),xt=Qo?"streaming":tl?"disabled":"idle",Lt=f.useRef(null),St=f.useRef(null),{value:sl}=oe("222560275"),nl=sl||o&&!o.startsWith("o1")&&!o.startsWith("o3");f.useEffect(()=>{const C=()=>{Lt.current!=null&&Km.addAction("composer_state_disabled",{threadId:Ft(l),disabledReason:Lt.current})};if(ts&&xt==="disabled"){let q="unknown";p?q=x??"component_disabled_unknown":m?q="completion_in_progress":le&&(q="thread_hard_blocked"),Lt.current!==q&&(St.current&&clearTimeout(St.current),St.current=setTimeout(C,Rg)),Lt.current=q}else Lt.current=null;return()=>{St.current&&(clearTimeout(St.current),St.current=null)}},[l,ts,xt,p,x,m,le]);const cs=[];if(Ae?.label&&cs.push({type:Ae.type,value:Ae.label,onRemoveRegion:Io}),xe!==null){const C=!!xe.gizmo.tags?.includes(js.FirstParty);cs.push({type:"mention",value:xe.gizmo.display.name,icon:e.jsx(Gi,{isFirstParty:C,src:xe.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{Xt(null),S.focus()}})}f.useEffect(()=>{(!Ve||Ve.length===0||!as)&&(Bs.current=!1)},[Ve,as]);const ol=f.useCallback((C,q,me)=>{Bs.current=C>=0,q&&S.setText(me?`${me.title}${me.body}`:"")},[S]),Xo=as&&Ve&&Ve.length>0&&!ht&&!pt&&!S.hasMultipleLines()&&S.canShowAutocompletion();f.useEffect(()=>{ht?_?.():M?.()},[ht,_,M]);const us=C=>{if(C.preventDefault(),C.stopPropagation(),Ze.current>0){const q=performance.now()-Ze.current;$m.hist(Qm.DEFAULT,"final_user_input_to_submit_ms",[],q)}xt==="streaming"&&(!co||S.isEmpty())?Ys&&Vs?Ko(!0):Or(C):No(C)},al=Gd(i,Pi.Canvas),{value:il}=oe("61299031"),rl=zd(),ll=al&&il&&!rl&&!So&&!Vo;f.useEffect(()=>{},[mr,S]),f.useEffect(()=>{const C=Ft(l),q=n?.normalizedAccountUserId;if(!q||r)return;const me=ln(()=>{const be=S.getContentToSend().content;be===""?Wm(C):Vm(C,be,q)},1e3);return S.subscribe("change",me)},[n,l,S,r,ne]);const Jo=e.jsx(Hf,{canUseInlineTagging:os,isDisabled:p,clientThreadId:l,currentLeafId:ze,currentRequestId:dt,canContinue:h,composerController:S,isNewThread:u,onContinueGenerating:C=>s({event:C,conversationMode:Ee(l)?.mode,systemHints:en(Nt,S,te)}),onResetState:Po,conversationMode:X,isShowingAutocomplete:!!Xo}),Zo=!Qo&&X!=null&&nl&&Wd.includes(X.kind)&&e.jsx(Vd,{clientThreadId:l,onTargetedReply:Br}),ea=Xo&&e.jsx("div",{className:"bg-token-main-surface-primary absolute start-0 z-[-1] box-border w-full ps-0 max-lg:bottom-full lg:top-full",children:e.jsx(ap,{suggestions:Ve,composerController:S,onSelect:k,onChange:ol})}),ta=e.jsx(Xd,{composerController:S,parsedDocumentHandler:Fr}),sa=!R&&e.jsx(tr,{className:j}),na=e.jsx(qd,{modelSupportedImageMimeTypes:We,uploadType:ot.Multimodal,attachmentsProductFeature:ns?.attachments}),cl=e.jsxs(e.Fragment,{children:[ht&&e.jsx(Ma,{onClick:C=>Fo(C),onClose:()=>{S.setShowTaggingDropdown(!1),S.focus()}}),Hs&&e.jsx(Na,{composerController:S,clientThreadId:l})]}),{isImageGenEditor:oa}=Yd(),aa=ct(F,"3760395675");return oa?e.jsxs(fa.Provider,{value:es,children:[e.jsx(ha,{onOauthRedirect:is,children:e.jsx(ga,{defaultOpen:aa,children:e.jsx("form",{id:"prompt",className:c,onSubmit:us,children:e.jsxs("div",{className:"relative z-1 flex h-full max-w-full flex-1 flex-col",children:[sa,e.jsxs("div",{className:"group relative z-1 flex w-full items-center",style:{"--force-hide-label":Ar?"none":"block"},children:[e.jsxs(kn,{open:ht||Hs,children:[e.jsx(Va,{className:"w-full",children:oa?e.jsx(jg,{type:ge?"temporary":"default",ref:z,placeholder:Ws,inputState:Ks,composerController:S,leftSideActions:Uo,state:xt,onSubmit:us,renderFiles:Se&&e.jsxs(e.Fragment,{children:[_e==="magic"&&e.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-secondary m-2 mb-0 rounded-lg p-2 text-xs",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(pn,{files:ie,className:"-ms-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:l,gizmoId:et,disableReason:$s,modelId:o}):e.jsx(sg,{type:ge?"temporary":"default",ref:z,replyRegions:cs,placeholder:Ws,inputState:Ks,setIsComposerOverflowing:Er,composerController:S,matchaData:Dr,leftSideActions:It,topRightAction:ll&&e.jsx(Qd,{composerRef:z,composerController:S,clientThreadId:l}),state:xt,onSubmit:us,renderFiles:yr&&e.jsxs(e.Fragment,{children:[_e==="magic"&&e.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-secondary m-2 mb-0 rounded-lg p-2 text-xs",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(pn,{files:ie,selectedApps:Ds,className:"-ms-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:l,gizmoId:et,disableReason:$s,modelId:o})}),e.jsx(Rn,{children:e.jsxs(Mn,{side:"bottom",align:"start",sideOffset:12,onOpenAutoFocus:C=>C.preventDefault(),children:[ht&&e.jsx(Ma,{onClick:C=>Fo(C),onClose:()=>{S.setShowTaggingDropdown(!1),S.focus()}}),Hs&&e.jsx(Na,{composerController:S,clientThreadId:l})]})})]}),ea]}),ta,na]})})})}),Jo,Zo]}):e.jsx(fa.Provider,{value:es,children:e.jsxs(ga,{defaultOpen:aa,children:[e.jsx(ha,{onOauthRedirect:is,children:e.jsxs("div",{className:Y("max-xs:[--force-hide-label:none] relative z-1 flex h-full max-w-full flex-1 flex-col",tt&&!ae&&"[--force-hide-label:none]"),children:[sa,qs&&Xr&&e.jsx(Kd,{taskId:qs.taskId,clientThreadId:l,onClose:()=>Ko(!1)}),e.jsx(_g,{visualTreatment:po?"composer-btn":"legacy",hasFiles:Se,pendingFiles:ie,isUploadDisabled:!Go,isNewThread:u,clientThreadId:l,getEditorGizmoId:je,highlightUploadTooltip:Ho&&!Se,disableReason:$s,uploadButtonDisabledReason:Wo,currentModel:i,layoutMode:ls,conversationMode:X,onOauthRedirect:is,state:xt,inputState:Ks,gizmoId:et,isTemporaryChat:ge,placeholder:Ws,composerController:S,onSubmit:us,replyRegions:cs,keepExpanded:!0,legacyFooterActions:It,legacySuggestionsPopoverContent:cl,isInReasonMode:Nt,modelSupportedSystemHints:de,contextualAnswerUserConnectionData:Ie}),ea]})}),ta,Jo,Zo,na]})})}function La({clientThreadId:t,onClick:s}){f.useEffect(()=>{am(t)},[t]);const n=K();return e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(_i,{onClick:()=>{im(t),s()},label:n.formatMessage(Bg.moreStarterPrompts)})})}function Eg({starterPrompt:t,starterPrompts:s,index:n,disabled:o,onSelectStarterPrompt:i}){const r=t.theme??t.title,a=hl(),{mutate:d}=nm(),l=t.category==="onboarding"?u=>{d({key:pe.hasUsedConversationalOnboardingStarterPrompt}),a(u,t,s,n)}:u=>i?.(u,t,s,n);return e.jsx(_i,{disabled:o,onClick:l,icon:e.jsx(om,{category:t.category,useV2Colors:!0}),label:r})}const Pg=5,Tg=3;function ur({starterPrompts:t,onSelectStarterPrompt:s,disabled:n,clientThreadId:o,onExpand:i,mobileLayout:r=!1}){const a=r?Tg:Pg,[d,l]=f.useState(a),[u,m]=f.useState(!1),c=f.useRef(null),p=t.length<=d;f.useEffect(()=>{xa(t.slice(0,a),o)},[o]),f.useEffect(()=>{if(!u&&!p&&c.current){const g=c.current,h=g.getBoundingClientRect(),b=h.width,y=Array.from(g.children);let w=0;for(let k=0;k<y.length&&y[k].getBoundingClientRect().right-h.left<=b;k++)w++;l(w),m(!0)}},[t,p,u]);const x=()=>{const g=t.slice(d,t.length).map(h=>({...h,isAdditional:!0}));g.length>0&&xa(g,o),l(t.length),i()};return e.jsxs("div",{"data-testid":"starter-prompt-chips",className:Y("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",u&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:Y("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",p||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:c,children:[t.slice(0,d).map((g,h)=>e.jsx(J.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(Eg,{starterPrompt:g,starterPrompts:t,index:h,disabled:n,onSelectStarterPrompt:s})},g.id??h)),r&&t.length>d&&e.jsx(La,{clientThreadId:o,onClick:x})]}),!r&&t.length>d&&e.jsx(La,{clientThreadId:o,onClick:x})]})}const oh=({clientThreadId:t,currentModelId:s,isModelLoaded:n})=>{const[o,i]=f.useState(!1),r=to(),{prospectiveModelId:a}=Rs(t),d=n?s:a??"auto",{promptStarters:l,shouldShowStarterPrompts:u,onSelectStarterPrompt:m}=Ui({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t,limit:8,modelSlug:d});return e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:Y(!o&&"h-[116px]"),children:u&&l&&e.jsx(ur,{starterPrompts:l,onSelectStarterPrompt:m,disabled:r,clientThreadId:t,onExpand:()=>i(!0),mobileLayout:!0})})},Ng=({currentModelId:t,clientThreadId:s,isModelLoaded:n})=>{const{isUnauthenticated:o}=Pe(),[i,r]=f.useState(!1),a=sm(),d=to(),{prospectiveModelId:l}=Rs(s),u=n?t:l??"auto",{promptStarters:m,shouldShowStarterPrompts:c,onSelectStarterPrompt:p}=Ui({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:u});return e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:Y("hidden min-h-[108px] max-w-full",a?"@lg/thread:block":"lg:block",o&&i?"":"h-[70px]"),children:c&&m&&e.jsx(ur,{starterPrompts:m,onSelectStarterPrompt:p,disabled:d,clientThreadId:s,onExpand:()=>r(!0)})})},Bg=Ue({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Da=Qn.div`m-8 flex flex-col items-center`;function Fa(t){return e.jsx(J.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function Ig({clientThreadId:t}){const n=re(t,i=>i?.promptGptRating)?.gizmoId,{data:o}=ji(n);return n==null||o==null||!rm(o)?null:e.jsx(Lg,{gizmoId:n})}function Lg({gizmoId:t}){const[s,n]=f.useState(!1),[o,i]=f.useState(!1),r=lm(t),a=async l=>{n(!0),setTimeout(()=>{i(!0)},5e3),N.logEvent("Submit Inline Rating",{gizmo_id:t,rating:l}),await r.mutateAsync({rating:l})},d=async()=>{i(!0),N.logEvent("Dismiss Inline Rating",{gizmo_id:t}),await r.mutateAsync({})};return f.useEffect(()=>{o||N.logEvent("Show Inline Rating",{gizmo_id:t})},[o,t]),o?null:s?e.jsx(Da,{children:e.jsxs(Fa,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"border-token-border-heavy rounded-lg border p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(wa,{onClick:()=>{i(!0)}})]})}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(P,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(Da,{children:e.jsxs(Fa,{className:"border-token-border-heavy flex flex-col items-center gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(wa,{onClick:d})]}),e.jsx(cm,{rating:void 0,onRating:a})]})})}const ah=({clientThreadId:t,isNewThread:s,isGizmoThread:n,isProjectThread:o,isModelLoaded:i,currentModelId:r,onRequestCompletion:a,shouldUseUnifiedComposer:d,onlyAllowImageUploads:l})=>{const u=kt(),{pageType:m}=Ci(),c=m?.type==="landing-page",p=f.useContext(Hi),x=Zm(p),g=Vn();Rt(),gm(u);const h=async k=>{if(Ee(t)?.isLoading!==!1)return;const j=await xm(k);a(j)},b=f.useCallback(k=>{N.logEvent("Continue Completion"),a(hm(k))},[a]),y=e.jsxs(e.Fragment,{children:[e.jsx(Ig,{clientThreadId:t}),e.jsx(tn,{verticalMargin:"none",verticalPadding:x?"last-standard":"none",horizontalPadding:"standard",children:e.jsx(sn,{children:e.jsx(Dg,{clientThreadId:t,currentModelId:r,isNewThread:s,hideHeader:s,onRequestCompletion:h,onContinueGenerating:b,onAutocompleteSelect:u.onAutocompleteSelect,onlyAllowImageUploads:l})})})]}),w=s&&e.jsx("div",{className:Y("[display:var(--display-hidden-until-loaded,block)] md:absolute md:start-0 md:bottom-6 md:w-full"),children:e.jsx(tn,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(sn,{children:e.jsx(tr,{className:"block flex-1"})})})});return d?e.jsxs(e.Fragment,{children:[g&&w,e.jsx("div",{id:"thread-bottom",children:y}),!g&&w,s&&!c&&!n&&!o&&e.jsx(tn,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(sn,{children:e.jsx(Ng,{clientThreadId:t,currentModelId:r,isModelLoaded:i})})})]}):y};function Dg({clientThreadId:t,currentModelId:s,disableDraftPersistence:n=!1,isNewThread:o,onRequestCompletion:i,onContinueGenerating:r,onComposerInput:a,onComposerChange:d,onAutocompleteSelect:l,headerClassName:u,hideHeader:m,onTaggingDropdownClose:c,onTaggingDropdownOpen:p,onlyAllowImageUploads:x}){const{data:g,isLoading:h}=Kt(),[b,y,w,k]=re(t,V=>{const H=se.getCurrentNode(V);return[H.message.clientMetadata?.errType!=null&&H.message.clientMetadata.errType!=="info",ep(se.getCurrentNode(V).message),V?.mode,V?.continuingFromSharedConversationId!=null]}),j=Rt(),R=kt(),_=Xm({clientThreadId:t}),{isOpen:M,onClose:v}=um({type:"just-hit-rate-limit"}),E=f.useMemo(()=>_?!1:!b&&y,[b,y,_]),D=_,F=Li(t),z=ji(F).data,S=Jm(),I=z?.gizmo.tags?.includes(js.WorkspaceDisabled)&&!S?"workspaceDisallowsGizmo":g?.models.size===0?"noModelsAvailable":w?.kind===De.GizmoTest&&w.gizmo_id==null?"noTestGizmoId":null,G=gl(),W=dm(),L=G.action==="moderate",{value:T}=oe("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx(mm,{composerController:R,clientThreadId:t,currentModelId:s,isCompletionInProgress:_}),e.jsx("div",{className:"flex justify-center empty:hidden",children:W&&L&&T?e.jsx(pm,{}):null}),M?e.jsx(fm,{onClose:v}):null,e.jsx(Ag,{clientThreadId:t,disableDraftPersistence:n,onCreateNewCompletion:i,onContinueGenerating:r,currentModelId:s,account:j,modelCategories:g?.categories,currentModelConfig:ri(g?.models,s),areModelsLoading:h,isNewThread:o,isCompletionInProgress:_,className:"w-full",canContinue:E,disabled:!!I,disabledReason:I??void 0,canPause:D,isInteractableSharedThread:k,onComposerInput:a,onComposerChange:d,onAutocompleteSelect:l,headerClassName:u,hideHeader:m,onTaggingDropdownClose:c,onTaggingDropdownOpen:p,onlyAllowImageUploads:x},t)]})}export{Kf as D,nh as F,jg as I,oh as M,Dg as P,ah as T,Yf as g,ro as h};
//# sourceMappingURL=jvs80tn6co0ttzp0.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gwffd9slpyauxarw.js","assets/j5zd9vs1l0bwsjqa.js","assets/j12so9ru57hpoz1y.js","assets/root-eh80jqkj.css","assets/jn7p98x7qxquz26a.js","assets/conversation-small-cmjjxogj.css","assets/b0v1yruiy44zd1p9.js","assets/msp412gwqdn605it.js","assets/ok8fnoyzbnoyk9qs.js","assets/nc07k7y06adedb9d.js","assets/d8hi8vzea1zd4sdu.js","assets/hxt8zt4ovcs39phn.js","assets/owhjnpwqw9ddu7v0.js","assets/i0f6lf35jgfv6z47.js","assets/egjzck8f21ldiiq8.js","assets/n5601invkykfg1ys.js","assets/01yrv2o49ye0ebr7.js","assets/f7sx4o03m10jq2cf.js","assets/ojd4yynl6f6f4h3l.js","assets/l12f3ah2dx3larti.js","assets/epsg05et2lobrl6v.js","assets/gh4kfg6qlx7b3ikk.js","assets/jgfehaz03xkmntxn.js","assets/ke2u5pwt169srvv9.js","assets/c7zwb9p0mkhdhxup.js","assets/hv2qnh4kmlq1qj5o.js","assets/fqps1a3pxo0q8nxi.js","assets/n0tk3xne532h7ges.js","assets/ik1mvke1rzg5h1fr.js","assets/c9pbgvcj05aso7rq.js","assets/nc2llj0k42mz5eom.js","assets/nvhcgkmtddp3tvzq.js","assets/dzsfr77h3zct1w18.js","assets/kipluhegsnyrr10h.js","assets/br4ryrak2kaynirg.js","assets/j2m3ef69iou998eo.js","assets/ijgsr1qtu4s7rq92.js","assets/ico83cg07nw4gm43.js","assets/b808i0mobwfw0uar.js","assets/b4wy8ndq94672kqa.js","assets/e2i9dno9lalz25o9.js","assets/ob1ryhq7reedd72f.js","assets/jqgeyuwq00z6gkku.js","assets/cx64odxk6g9mmfxk.js","assets/lqzkl9nshtyuq055.js","assets/e52jvl7uowvoaeca.js","assets/g4tl5lt9yqf20m4s.js"])))=>i.map(i=>d[i]);
import{aw as B,P as T,ec as st,Y as at,C as J,ds as ot,a as nt,B as U,aI as it,q as Be,dU as Fe,eN as rt,eM as lt,eK as dt,at as ct,e1 as ut,aT as mt,aO as gt,fJ as ft,h1 as we,fK as pt,cy as G,cz as q,a0 as je,v as Y,u as ht,O as H,R as We,cU as xt,fP as Ne,gX as Mt,aq as bt,h2 as Ct,dP as Ae,bX as St,bY as kt,eS as yt,r as vt,Z as wt,gc as jt,V as Nt,aP as At,bg as It}from"./j5zd9vs1l0bwsjqa.js";import{r as i,j as e,aa as Ue,f as ze,c as Ve,u as L,a9 as F,M as N,d as Ge,h as z,l as Pt}from"./j12so9ru57hpoz1y.js";import{ly as Ot,lz as qe,lA as Et,lB as _t,lC as Tt,aR as He,ax as Ke,cw as Dt,lD as Lt,lE as Rt,lF as Bt,lG as Ft,lH as Ie,lI as Wt,lJ as Ut,lK as zt,q as Qe,gG as Vt,dt as Gt,lL as qt,lM as Ht,dq as V,lN as Kt,lO as Qt,lP as Yt,fl as $t,lQ as Xt,lR as Jt,lS as Zt,lT as es,lU as ts,lV as ss,lW as as,lX as os,lY as ns,lZ as is,l_ as rs,l$ as ls,m0 as ds,m1 as cs,m2 as us,m3 as ms,m4 as gs,m5 as fs,m6 as ps,m7 as hs,m8 as xs,m9 as Ms,ma as bs,mb as Cs,mc as Ss,md as ks,me as ys,mf as vs,mg as ws,mh as js,mi as Ns,mj as As,mk as Is,P as Ye,ml as Ps,mm as Os,mn as Es,mo as _s,H as Ts,O as K,U as Pe,i2 as Oe,dr as Z,mp as Ds,mq as Ls,mr as Ee,cG as Rs,cM as Bs,cL as _e,cN as Fs,d$ as Ws,aF as $,ms as Us,eh as zs,gq as Vs,by as Gs,bz as qs,bA as Hs,mt as Ks,g$ as Qs,cV as X,cW as Te,mu as Ys,mv as $s,mw as Xs,mx as Js,my as Zs,mz as ea,mA as ta,mB as sa,mC as aa,mD as oa,mE as na,F as ia,mF as ra,mG as la,mH as da,T as De,mI as ca,mJ as ua,mK as ma,mL as ga,e$ as fa,cD as pa}from"./jn7p98x7qxquz26a.js";import{b as ha}from"./01yrv2o49ye0ebr7.js";import{u as xa,I as Ma}from"./hxt8zt4ovcs39phn.js";import{b as ba,P as Ca}from"./ojd4yynl6f6f4h3l.js";import{u as Sa,d as ka}from"./j2m3ef69iou998eo.js";import{a as ya,b as va,c as wa}from"./f7sx4o03m10jq2cf.js";import{u as ja,C as Na,a as Aa}from"./b0v1yruiy44zd1p9.js";import{C as Ia}from"./ijgsr1qtu4s7rq92.js";import{M as Pa}from"./ob1ryhq7reedd72f.js";import{K as Oa}from"./lqzkl9nshtyuq055.js";function Ea({clientThreadId:t}){const s=Ot(n=>n.notifications),a=i.useRef(new Set);return i.useEffect(()=>{s.filter(o=>o.clientThreadId===void 0||t===o.clientThreadId).map(o=>o.id).filter(o=>o!==void 0).forEach(o=>qe(o)),s.forEach(o=>{o.id&&!a.current.has(o.id)&&(B.logEvent("chatgpt_notification_shown"),T.logEvent("Notifications: Notification Shown to User"),a.current.add(o.id))})},[t,s]),s.length===0||st?null:e.jsx("div",{className:"pointer-events-auto fixed end-4 top-8 z-100 my-2 flex max-h-[90vh] flex-col-reverse space-y-2 space-y-reverse overflow-y-auto px-2 py-4",children:e.jsx(Ue,{children:s.map(n=>e.jsx(Ta,{...n},n.id))})})}function _a({notification:t}){return t.icon?e.jsx(Et,{size:"medium",className:"border-token-secondary bg-token-main-surface-primary text-token-text-primary rounded-full border",IconComponent:t.icon}):e.jsx(_t,{iconName:"openai",size:"medium",className:"border-token-secondary bg-token-main-surface-primary text-token-text-primary rounded-full border"})}function Ta({...t}){const s=ze(),a=Ve(),n=L(),o=at(t.clientThreadId),l=()=>{B.logEvent("chatgpt_notification_clicked"),T.logEvent("Notifications: User Clicked Notification"),t.onClick!=null?t.onClick():o&&Tt(s,a,o),t.id&&qe(t.id)};return e.jsxs(F.div,{onClick:l,className:"border-token-border-default bg-token-main-surface-primary z-100 inline-flex w-80 cursor-pointer items-center justify-start gap-2.5 rounded-2xl border px-3 py-3 align-middle shadow-lg",initial:{opacity:0,x:320},animate:{opacity:1,x:0},exit:{opacity:0,x:320},transition:{duration:.5},children:[e.jsx(_a,{notification:t}),e.jsxs("div",{className:"inline-flex w-full shrink grow basis-0 flex-col items-start justify-start overflow-hidden",children:[e.jsx("div",{className:"text-token-text-primary w-full truncate text-sm font-medium",children:t.title??n.formatMessage({id:"mpXAeu",defaultMessage:"New chat"})}),t.subtitle&&e.jsx("div",{className:"text-token-text-tertiary w-full truncate text-sm",children:t.subtitle}),t.payload?.display_image_url&&e.jsx("img",{className:"mt-2 h-12 w-12 rounded-xs",src:t.payload.display_image_url,alt:t.payload.image_alt})]})]})}const Da=()=>{const{isLoading:t,eligible:s}=He(Ke.hasSeenContextualAnswerGoogleSyncFinished),a=Dt(),{connectionInstanceData:n,isLoading:o}=Lt({skip:!a}),l=Rt(n?.connection_statuses??[]),p=Bt({exposed:s&&a&&l})==="modal";return t||o?"loading":s&&a&&l&&p?"show":"hide"},La=({onClose:t})=>{const s=L(),{markAsViewed:a}=He(Ke.hasSeenContextualAnswerGoogleSyncFinished);i.useEffect(()=>{T.logEvent("Contextual Answers User Fully Synced Modal")},[]);const n=()=>{a(),t(),Wt()},o=()=>{a(),t()},l=e.jsx(U,{color:"secondary",onClick:o,children:e.jsx(N,{id:"341zvt",defaultMessage:"Maybe later"})}),p=e.jsx(U,{color:"primary",onClick:()=>n(),children:e.jsx(N,{id:"N6nDT7",defaultMessage:"Try an example"})});return e.jsx(J,{isOpen:!0,noPadding:!0,onClose:t,shouldIgnoreClickOutside:!0,size:"xlarge",type:"success",testId:"modal-ca-synced-nux",children:e.jsxs("div",{className:"relative px-2 py-8",children:[e.jsx(ot,{onClick:t,className:"absolute end-0 top-0 z-10 me-2 mt-2 text-black"}),e.jsx("div",{className:"text-heading-3 text-center",children:e.jsx(N,{id:"cB19NT",defaultMessage:"Ask ChatGPT anything,{br}even about information in your Google Drive.",values:{br:e.jsx("br",{})}})}),e.jsx("div",{className:"border-token-border-light text-token-text-tertiary text-body-small-regular mx-auto mt-5 mb-5 w-max rounded-4xl border px-6 py-3 text-center italic",children:e.jsx(N,{id:"6cGGS5",defaultMessage:"What's the latest status on project widgets?"})}),e.jsxs("div",{className:"flex justify-center",children:[e.jsx(Q,{Logo:Ft,title:s.formatMessage({id:"E7Iqah",defaultMessage:"Project Widgets Budget"}),className:"z-10 translate-x-[2.5rem] translate-y-[2rem] rotate-[-4deg]"}),e.jsx(Q,{Logo:Ie,title:s.formatMessage({id:"cVbcSP",defaultMessage:"Project Widgets PRD"}),className:"z-20"}),e.jsx(Q,{Logo:Ie,title:s.formatMessage({id:"QbnI4s",defaultMessage:"Project Widgets Presentation"}),className:"z-10 translate-x-[-2.5rem] translate-y-[2rem] rotate-[4deg]"})]}),e.jsxs("div",{className:"mt-12 flex justify-center gap-3",children:[l,p]})]})})},Q=({Logo:t,title:s,className:a})=>e.jsxs("div",{className:nt("border-token-border-light bg-token-bg-primary w-[14rem] rounded-2xl border p-3 shadow-sm",a),children:[e.jsxs("div",{className:"mb-3 flex items-center",children:[e.jsx(t,{}),e.jsx("span",{className:"text-body-small-regular text-token-interactive-label-accent-default ms-2",children:s})]}),e.jsx("div",{children:e.jsx(ha,{lines:5,size:"sm"})})]}),Le="has-dismissed-welcome-back-modal",$e=()=>{const[t,s]=i.useState(()=>sessionStorage.getItem(Le)!=null),{layer:a}=it("3637408529"),n=a.get("is_no_auth_welcome_back_modal_enabled",!1),o=Ut(),{isUnauthenticated:l,isLoading:p}=Be(),r=zt(),g=ba(),m=()=>{s(!0),sessionStorage.setItem(Le,"true")};return p?{isLoading:!0,isOpen:null,onClose:null}:{isLoading:!1,isOpen:l&&n&&!t&&r&&!o&&!g,onClose:m}},Ra=({onClose:t})=>{const s=Qe(),a=Vt(),n=Gt(R.signUpCta),o=a?"center":"bottom",{isOpen:l,onClose:p}=$e();return i.useEffect(()=>{l&&(T.logEvent("No Auth Welcome Back Modal Shown"),B.logEvent("chatgpt_no_auth_welcome_back_modal_shown"))},[l]),l?e.jsx(J,{testId:"modal-no-auth-welcome-back",isOpen:!0,onClose:Fe,shouldIgnoreClickOutside:!0,showCloseButton:!1,type:"success",noPadding:!0,size:"custom",className:"max-w-[373px] sm:max-w-[400px]",position:o,children:e.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-8 sm:p-10",children:[e.jsx("p",{className:"mb-1 text-center text-2xl font-semibold",children:e.jsx(N,{...R.title})}),e.jsx("p",{className:"text-token-text-secondary mb-6 text-center text-lg",children:e.jsx(N,{...R.subtitle})}),e.jsx(U,{as:"button",size:"large",color:"primary",fullWidth:!0,className:"mb-2 sm:mb-3","data-testid":"welcome-login-button",onClick:()=>{s({authType:"login",callback:r=>{T.logLogInButtonClicked({provider:r,location:"No Auth Welcome Back Modal"})}})},children:e.jsx(N,{...R.logInCta})}),e.jsx(U,{as:"button",size:"large",color:"secondary",fullWidth:!0,className:"mb-5",onClick:()=>{s({authType:"signup",callback:r=>{T.logSignUpButtonClicked({provider:r,location:"No Auth Welcome Back Modal"})}})},children:e.jsx(N,{...n})}),e.jsx("a",{href:"#",className:"text-token-text-secondary cursor-pointer font-semibold underline sm:text-sm",onClick:r=>{r.preventDefault(),T.logEvent("No Auth Welcome Modal Stay Logged Out Link Clicked"),B.logEvent("chatgpt_no_auth_welcome_back_modal_stay_logged_out_link_clicked"),t(),p()},"data-testid":"dismiss-welcome",children:e.jsx(N,{...R.stayLoggedOutLink})})]})}):null},R=Ge({title:{id:"NoAuthWelcomeBackModal.title",defaultMessage:"Welcome back"},subtitle:{id:"7WQi5y",defaultMessage:"Log in or sign up to get smarter responses, upload files and images, and more."},signUpCta:{id:"NoAuthWelcomeBackModal.signUpCta",defaultMessage:"Sign up"},logInCta:{id:"NoAuthWelcomeBackModal.logInCta",defaultMessage:"Log in"},stayLoggedOutLink:{id:"NoAuthWelcomeBackModal.stayLoggedOut",defaultMessage:"Stay logged out"}}),Ba=({onClose:t})=>{const s=L(),a=V(Z.isBusinessWorkspace),n=V(l=>l.currentWorkspace),o=a?s.formatMessage(Re.workspaceWelcome,{workspaceName:n?.name}):"ChatGPT";return e.jsx(J,{testId:"modal-onboarding",isOpen:!0,onClose:Fe,type:"success",title:o,size:"custom",noPadding:!0,className:"max-w-3xl",description:s.formatMessage(Re.personalOnboardingSubheading),children:e.jsx(Ds,{onClose:t,scope:Ls.Personal})})},Fa=({onClose:t})=>{const s=pt.useStore();return i.useEffect(()=>(s.setOnCloseSideEffect(t),s.setManualVisibility(!0),()=>{s.setManualVisibility(!1)}),[t,s]),null},Wa=()=>"hide";function Ua({clientThreadId:t}){const[s,a]=i.useState(0),{hasSeenOnboardingDate:n}=qt(),{hasSeenTeamOwnerOnboardingDate:o}=Ht(),l=V(Z.isBusinessWorkspace),[p,r]=i.useState(!1),g=z(),m=Kt(g),{data:h,isPending:P,isEnabled:M}=Qt(),b=Yt(h,P&&M),O=rt(),C=lt(),v=dt(),[E,w]=ct(t,x=>[!x||x.isLoading,x?.conversationOrigin]),j=E&&!!t,{data:f,isError:k}=ut(),A=mt(f),S=f!=null,u=f&&f?.accountItems.length>1&&f.currentAccountId==null,c=f?.accountItems.some(x=>x.isPersonalAccount()),d=!!f?.accountItems&&f.accountItems.length>0&&f.accountItems.every(({canAccessWithCurrentSession:x})=>!x),{eligible:y,isLoading:_}=$t(),{value:ee}=gt("1542198993"),{punchOutRequireLoginInfo:te}=Xt(),{state:se}=Jt(),{isOpen:ae,isLoading:oe}=Zt(),{isOpen:ne,isLoading:ie}=es(),{isOpen:re,isLoading:le}=ts(),{isOpen:de,isLoading:ce}=$e(),{state:ue}=ss(),me=as(),ge=xa(),fe=os(),pe=ns(),he=is(),xe=Da(),Me=rs(),Xe=Wa(),be=ls(),{isOpen:Ce,isLoading:Se}=ds(),Je=cs(t),{shouldShowCookieBanner:ke,isCookieConsentBannerLoading:ye}=ft(),D=i.useMemo(()=>[{Component:us,getModalState:()=>te?"show":"hide",isDeferrable:!1},{Component:ms,getModalState:()=>se,isDeferrable:!1},{Component:gs,getModalState:()=>ue,isDeferrable:!1},{Component:fs,getModalState:()=>Se?"loading":Ce?"show":"hide",isDeferrable:!1},{Component:ps,getModalState:()=>fe,isDeferrable:!0},{Component:hs,getModalState:()=>oe||j?"loading":w===we.APPLE?"hide":ae?"show":"hide",isDeferrable:!0},{Component:Ra,getModalState:()=>ce||j?"loading":w===we.APPLE?"hide":de?"show":"hide",isDeferrable:!0},{Component:Fa,getModalState:()=>ye?"loading":ke?"show":"hide",isDeferrable:!1},{Component:Ba,getModalState:()=>l||m?"hide":n===null?"loading":n===!1?"show":"hide",isDeferrable:!0},{Component:xs,getModalState:()=>k?"hide":u?"show":S?"hide":"loading",isDeferrable:!1},{Component:Ms,getModalState:()=>O!==null?"show":k||S?"hide":"loading",isDeferrable:!1},{Component:bs,getModalState:()=>C!==null?"show":k||S?"hide":"loading",isDeferrable:!1},{Component:Cs,getModalState:()=>v!=null?"show":k||S?"hide":"loading",isDeferrable:!1},{Component:Ss,getModalState:()=>S?d?"show":"hide":"loading",isDeferrable:!1},{Component:ks,getModalState:()=>ie?"loading":ne?"show":"hide",isDeferrable:!1},{Component:ys,getModalState:()=>le?"loading":re?"show":"hide",isDeferrable:!1},{Component:vs,getModalState:()=>"hide",isDeferrable:!1},{Component:ws,getModalState:()=>!A?.isTeam()||!A?.isOwnerOfAccount()||!c?"hide":!S||o===null?"loading":o===!1?"show":"hide",isDeferrable:!1},{Component:js,getModalState:()=>l?n===null?"loading":n===!1?"show":"hide":"hide",isDeferrable:!0},{Component:Ns,getModalState:()=>_?"loading":y&&ee?"show":"hide",isDeferrable:!1},{Component:As,getModalState:()=>b,isDeferrable:!1},{Component:Is,getModalState:()=>me,isDeferrable:!1},{Component:x=>t&&e.jsx(Ye,{clientThreadId:t,children:e.jsx(Ma,{clientThreadId:t,...x})}),getModalState:()=>ge,isDeferrable:!1},{Component:La,getModalState:()=>xe,isDeferrable:!1},{Component:Ps,getModalState:()=>pe,isDeferrable:!1},{Component:Os,getModalState:()=>he,isDeferrable:!1},{Component:Es,getModalState:()=>Me,isDeferrable:!0},{Component:_s,getModalState:()=>be,isDeferrable:!1}],[te,se,ue,Se,Ce,fe,oe,j,w,ae,ce,de,ye,ke,l,m,n,k,u,S,O,C,v,d,ie,ne,le,re,A,c,o,_,y,ee,b,me,t,ge,xe,pe,he,Me,Xe,be])[s],Ze=p||Je;let I;D&&(D.isDeferrable&&Ze?I="hide":D.Component?I=D.getModalState():I="hide"),i.useEffect(()=>{I==="hide"&&a(s+1)},[s,I]);const{pathname:W}=z(),ve=i.useRef(W);if(i.useEffect(()=>{ve.current!==W&&(ve.current=W,a(0))},[W]),i.useEffect(()=>{const x=I==="show",tt=Ts.getState().activeModals.has(K.BlockingInitialComponent);x!==tt&&(x?Pe.openModal(K.BlockingInitialComponent):Pe.closeModal(K.BlockingInitialComponent))},[I]),D==null)return Oe.trackNamespace(Oe.NS_COMPOSER),e.jsx("span",{"data-testid":"blocking-initial-modals-done",className:"hidden"});if(I!=="show")return null;const et=D.Component;return e.jsx(et,{onClose:()=>{r(!0),a(x=>x+1)}})}const Re=Ge({workspaceWelcome:{id:"BlockingInitialModals.workspaceWelcome",defaultMessage:"Welcome to the {workspaceName} workspace"},personalOnboardingSubheading:{id:"BlockingInitialModals.personalOnboardingSubheading",defaultMessage:"Tips for getting started"}}),za=G(async()=>q(()=>import("./gwffd9slpyauxarw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])).then(t=>t.ImageGenNewEditor));function Va({postWithProfile:t,clientThreadId:s,closeModal:a}){const n=i.useRef(null),[o,l]=i.useState(!1),[p,r]=i.useState(!1),g=ze(),{post:m}=t,h=m.attachments[m.attachments.length-1],P={url:h.url,content_type:je.ImageAssetPointer,asset_pointer:h.asset_pointer??Ee(h.id),size_bytes:0,width:h.width,height:h.height},M=L(),b=Rs(),O=Y(s),C=ht(),v=i.useCallback(u=>b.getState().files.find(c=>c.tempId===u),[b]),E=h.url,w=i.useCallback(async u=>{if(n.current){const c=await n.current,d=c?v(c?.tempId):null;if(d)return d}return n.current=fetch(u).then(c=>c.blob()).then(c=>{const d=new File([c],"image.png",{type:"image/png"}),y=Bs(d);return _e.uploadFile(b,y,d,Fs.Multimodal,[d.type],M,C).then(()=>{const _=v(y);return _&&_.status===Ws.Ready&&_.fileId?_:null})}),n.current},[b,M,C,v]),{onRequestCompletion:j}=ja(),{isUnauthenticated:f}=Be(),k=i.useCallback(async u=>{if(!(!u.promptMessage||f)){r(!0);try{const c=await w(E);if(!c||!c.fileId||!c.fileSpec)return;const d=[{content_type:je.ImageAssetPointer,asset_pointer:Ee(c.fileId),size_bytes:c.fileSpec.size,width:h.width,height:h.height},...u.promptMessage.content.content_type===H.MultimodalText||u.promptMessage.content.content_type===H.Text?u.promptMessage.content.parts:[]],y={...u,promptMessage:{...u.promptMessage,content:{content_type:H.MultimodalText,parts:d}},extraStreamParams:{...u.extraStreamParams??{},continueFromSharedPostId:m.id}};j(y),a(),_e.reset(b)}catch{C.danger(M.formatMessage({id:"postReceiverModal.editImageError",defaultMessage:"Failed to edit the image"}))}finally{r(!1)}}},[h.height,h.width,w,j,b,E,a,f,M,C,m.id]),A=i.useCallback(async()=>{if(window.confirm(M.formatMessage({id:"postReceiverModal.deletePostConfirmation",defaultMessage:"Are you sure you want to delete this post?"})))try{await We.safeDelete("/share/post/{post_id}",{parameters:{path:{post_id:m.id}}}),g("/",{replace:!0})}catch{C.danger(M.formatMessage({id:"postReceiverModal.deletePostError",defaultMessage:"Failed to delete the post"}))}},[m.id,M,C,g]),S=e.jsx(e.Fragment,{children:e.jsxs(F.div,{className:"flex h-16 w-full px-2 sm:px-4",...$,children:[e.jsx("div",{className:"flex items-center justify-self-start text-start",children:e.jsx(ya,{onClose:()=>{a(),g("/",{replace:!0})}})}),e.jsx("div",{className:"flex w-full flex-1 flex-col items-center justify-center justify-self-stretch",children:e.jsx(Us,{areButtonsFullWidth:!0,post:m,setIsReportModalOpen:()=>{l(!0)}})}),e.jsxs("div",{className:"flex items-center justify-self-end text-end",children:[m.permissions.can_delete&&e.jsx(va,{tooltip:M.formatMessage({id:"postReceiverModal.deletePost",defaultMessage:"Delete"}),onClick:A,children:e.jsx(zs,{})}),e.jsx(wa,{imageAsset:P,serverThreadId:O})]})]})});return e.jsxs("div",{className:"bg-token-main-surface-primary absolute start-0 end-0 top-0 bottom-0 h-full w-full",children:[e.jsx(Vs,{children:e.jsx(za,{image:P,isLoadingNewImage:!1,clientThreadId:s,onClose:()=>{a(),g("/",{replace:!0})},onRequestCompletion:k,editorControls:S,messageId:m.id,footer:p?e.jsx(Ga,{}):null})}),o&&e.jsx(qa,{post:m,onClose:()=>l(!1)})]})}function Ga(){const t=L();return e.jsxs(F.div,{className:"shadow-token-border-default pointer-events-none inline-flex items-center justify-center gap-1.5 self-center rounded-[16px] px-3.5 py-2 text-sm shadow-lg",transition:{duration:.3,ease:"easeInOut"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx(xt,{}),e.jsx("span",{children:t.formatMessage({id:"postReceiverModal.preparingImage",defaultMessage:"Preparing image..."})})]})}function qa({post:t,onClose:s}){const{data:a}=Gs(Ne.Post),n=L(),o=qs(n,t.id,Ne.Post);if(a==null)return null;const l=`Report ${t.text??"Post"}`;return e.jsx(Hs,{reasons:a.reasons,submitReport:o,title:l,onClose:s,header:a.header,subHeader:a.header_explanation})}function Ha({clientThreadId:t}){const s=Sa();return e.jsxs(e.Fragment,{children:[s&&e.jsx(ka,{}),e.jsx(Ka,{clientThreadId:t})]})}function Ka({clientThreadId:t}){const s=i.useContext(Ca),[a,n]=i.useState(!!s?.postWithProfile);return!s?.postWithProfile||!a?null:e.jsx(Ye,{clientThreadId:t,children:e.jsx(Va,{clientThreadId:t,postWithProfile:s.postWithProfile,closeModal:()=>n(!1)})})}const Qa=450;function Ya({children:t,clientThreadId:s,isOpen:a,onClose:n,type:o}){return e.jsx(Ue,{children:a&&e.jsx(Mt,{children:e.jsx(Ks.Provider,{value:{isEmbeddedInFocusedView:!0,type:o},children:e.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[e.jsx(F.div,{className:"bg-token-main-surface-secondary h-full w-full",...$}),e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"grow overflow-auto",children:t}),e.jsx(F.div,{className:"border-token-border-medium bg-token-main-surface-primary relative shrink-0 border-s",style:{width:Qa},...$,children:e.jsx("div",{className:"h-[100vh] pb-4",children:e.jsx(Pa,{clientThreadId:s,hideHeader:!0,hideToolsOverlay:!0,hideDisclaimer:!0,messagesVerticalAlign:"bottom"},s)})})]})]})})})})}const $a=G(()=>q(()=>import("./nvhcgkmtddp3tvzq.js"),__vite__mapDeps([31,1,2,3,4,5,32,33]))),Xa=G(()=>q(()=>import("./br4ryrak2kaynirg.js"),__vite__mapDeps([34,1,2,3,4,5,16,11,6,7,8,10,18,19,20,21,22,23,24,25,26,27,28,35,14,15,12,17,29,30,36,37,38,39,40,41,9,13,42,43,44])).then(t=>t.ImageEditor));function Ja({clientThreadId:t}){const s=Qs();i.useEffect(()=>{X.close()},[t]);let a;return s?.type===Te.ADAVisualization?a=e.jsx($a,{clientThreadId:t,visualization:s.visualization}):s?.type===Te.Image&&(a=e.jsx(Xa,{clientThreadId:t,messageId:s.messageId,image:s.image,allImages:s.allImages},s.image.asset_pointer)),e.jsx(Ya,{clientThreadId:t,isOpen:s!=null,onClose:X.close,type:s?.type,children:a})}var Za={};const eo=G(()=>q(()=>import("./e52jvl7uowvoaeca.js"),__vite__mapDeps([45,2,1,3,6,4,5,7,8,41,35,14,15,12,10,11,18,19,20,21,22,23,24,25,26,27,28,9,13,16,42,43,46])));function ho(t){const{urlThreadId:s,clientThreadId:a,prefetchSearch:n}=t,o=bt(),l=z(),[p]=Pt(),[r,g]=i.useState(()=>{if(s!==void 0){const d=s;return Ct(d)??d}return a!==void 0?a:Ae()});s!==void 0&&r!==s&&(Y(r)===s||g(s));const m=Ys(z());i.useEffect(()=>{s===void 0&&Y(r)!==void 0&&g(Ae())},[s,r,m]);const h=V(Z.workspaceId),{eligible:P,isLoading:M,markAsViewed:b}=$s(),O=Xs(),{eligible:C,isLoading:v,markAsViewed:E}=Js(),w=Zs(),{eligible:j,isLoading:f,markAsViewed:k}=ea(),A=ta(),S=Qe();i.useEffect(()=>{St(!0).then(d=>{d.force_login&&S({authType:"login"}),sa.initializeAndGatherData(d),kt.initializeAndGatherData(d)})},[S]),i.useEffect(()=>{const d=p.get(aa)==="true";o!==d&&yt.setIsTemporaryChatEnabled(d)},[o,p]),i.useEffect(()=>{l.state?.focusObject&&X.setFocusedObject(l.state.focusObject)},[l.state?.focusObject]),i.useEffect(()=>{!M&&P&&(b(),O())},[P,M,b,O]),i.useEffect(()=>{!v&&C&&(E(),w())},[C,v,E,w]),i.useEffect(()=>{!f&&j&&(k(),A())},[j,f,k,A]),oa(r);const u=Ve(),c=vt();return i.useEffect(()=>{wt(c)&&B.checkGate("1661641186")&&u.fetchQuery({queryKey:["recent","images","bootstrap"],queryFn:()=>We.safeGet("/images/bootstrap",{})})},[u,c]),i.useEffect(()=>jt(It,{completionFinished:d=>{if(d.serverThreadId!=null&&!o){const y=Nt(d.serverThreadId)?.mode;y?.kind===At.GizmoInteraction&&fa.handleGizmoInteracted(u,y.gizmo_id)}}}),[o,u]),e.jsx(na.Provider,{value:null,children:e.jsx(ia,{children:e.jsxs(ra,{clientThreadId:r,children:[e.jsxs(Na,{clientThreadId:r,children:[e.jsx(Ua,{clientThreadId:r},h),e.jsx(to,{clientThreadId:r,setClientThreadId:g}),e.jsx(Oa,{}),e.jsx(la,{}),e.jsx(da,{}),e.jsx(Aa,{clientThreadId:r,setClientThreadId:g,prefetchSearchPromises:n,children:e.jsxs(De,{clientThreadId:r,children:[e.jsx(ca,{}),e.jsx(Ia,{urlThreadId:s,clientThreadId:r,setClientThreadId:g}),e.jsx(Ha,{clientThreadId:r})]})})]}),e.jsx(De,{clientThreadId:r,children:e.jsx(Ja,{clientThreadId:r})}),e.jsx(ua,{clientThreadId:r}),e.jsx(ma,{}),e.jsx(Ea,{clientThreadId:r}),e.jsx(ga,{})]})})})}function to({clientThreadId:t,setClientThreadId:s}){const{isOpen:a,isLoading:n}=pa();return!n&&a?e.jsx(eo,{clientThreadId:t,setClientThreadId:s}):null}typeof window<"u"&&(window._g=Za.GOKU_SERVICE);export{ho as C,Qa as F};
//# sourceMappingURL=nmf2fghlcyhqu1pn.js.map

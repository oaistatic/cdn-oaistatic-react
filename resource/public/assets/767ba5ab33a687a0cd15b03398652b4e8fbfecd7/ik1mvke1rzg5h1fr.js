const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/nhi89wl5ggzl7sjh.js","assets/j12so9ru57hpoz1y.js","assets/jn7p98x7qxquz26a.js","assets/j5zd9vs1l0bwsjqa.js","assets/root-eh80jqkj.css","assets/conversation-small-cmjjxogj.css","assets/n2u2gaip43up859y.js","assets/e0k3mp7n8rdpmdf2.js","assets/i3girl0vsphj18sl.js","assets/hu0wq97e3zxxqel7.js","assets/kbzw8y1dt8fdczfn.js","assets/y1bvaegllg40am8r.js","assets/dzjjaskt8fkdwgfs.js","assets/loq1ozxos4mki5zd.js","assets/c9pbgvcj05aso7rq.js","assets/nc2llj0k42mz5eom.js","assets/fxf8mtlkytsxgugh.js","assets/fpoe8uk54uqyf2ln.js","assets/ozyeh5lwz4ak6oa7.js","assets/kivunl5r08o17t2b.js","assets/gpzzsmfsxwwa6oqb.js","assets/dzsfr77h3zct1w18.js","assets/kipluhegsnyrr10h.js","assets/fw2zpvluaohmz34u.js","assets/fqfgq0eye3zh2pbq.js","assets/hpm70q586053933g.js","assets/esy9xppmoo49xb0b.js","assets/mx9tryggoikmqll4.js","assets/gcv37ii59mzsrd32.js","assets/b0v1yruiy44zd1p9.js","assets/msp412gwqdn605it.js","assets/ok8fnoyzbnoyk9qs.js","assets/lvpb6cwnqd8aihaw.js","assets/jfg5hcsrdvz6wljc.js","assets/gvjjanb6hwn8rg4p.js","assets/cg0toekqaiqcfbur.js","assets/e2i9dno9lalz25o9.js","assets/n0tk3xne532h7ges.js","assets/01yrv2o49ye0ebr7.js","assets/kep3qe1fe7a2vzu1.js","assets/FormattedText-kb0ehjj7.css","assets/cot-message-lf3q5fj1.css","assets/m08bu3s6w2e4o2ka.js","assets/db5e3b0k0mmwmv98.js","assets/f5xjfsp5ejhhchwi.js","assets/gqhbj1hjjsurx5m7.js","assets/4ew8v0dcz9pvrlu8.js"])))=>i.map(i=>d[i]);
import{bf as Ie,am as Pe,cA as H,a as y,r as ke,a_ as Fe,U as ze,at as G,gn as Ue,c3 as ee,aO as L,cv as Be,gZ as q,W as Ve,fS as He,fT as We,cG as Je,fN as ce,fM as Xe,D as $e,dj as Ke,cy as v,cz as N,e0 as Qe,dk as g,s as Ye,N as Ze,gm as de,$ as qe,J as Ge,O as es,aP as K,dT as ss,c7 as ts}from"./j5zd9vs1l0bwsjqa.js";import{u as se,r as f,j as e,M as A,aa as I,a9 as D,c as as}from"./j12so9ru57hpoz1y.js";import{jZ as ns,j_ as is,fJ as Ne,fb as rs,fc as os,j$ as ls,k0 as cs,aW as Q,k1 as ds,k2 as ms,k3 as us,k4 as gs,k5 as fs,iG as xs,k6 as ps,k7 as me,k8 as V,k9 as ue,cQ as Se,cR as Ee,af as Te,ak as W,ka as hs,kb as _s,kc as ys,kd as ge,ke as Ce,e0 as js,kf as bs,kg as vs,kh as ks,ki as Ns,bq as Ss,bp as Es,je as Ts,kj as Cs,kk as ws,kl as As,km as Ds,kn as Ms,aZ as Rs,ko as Os,ht as Ls,hw as fe,kp as Is,kq as Ps,kr as Fs,ks as zs,ii as Us,kt as Bs,ku as Vs,kv as xe,aU as Hs,kw as Ws,kx as Js,e2 as Xs,ky as $s}from"./jn7p98x7qxquz26a.js";const Y={div:s=>{const{node:n,children:t,...a}=s;return e.jsx("div",{...a,className:"text-red-500",children:t})},p:s=>{const{node:n,children:t,...a}=s;return e.jsx("p",{...a,className:"text-token-text-primary text-start leading-6",children:t})},a:s=>{const{node:n,children:t,...a}=s;return e.jsx("a",{...a,className:"font-sm text-token-text-primary! leading-6",children:t})}},Ks=1e3*60*2,Qs=30;function we({taskId:s,clientThreadId:n,onClick:t,statusMessage:a,showSources:i,includeMargin:o,sources:r,progressBar:d}){const l=Ne(),[m,x]=f.useState(!1),p=ke(),u=Fe(p,"2007855518");return e.jsxs(e.Fragment,{children:[s&&m&&e.jsx(ls,{taskId:s,clientThreadId:n,onClose:()=>x(!1)}),e.jsxs("div",{className:"relative flex w-4/5 max-w-[416px]",children:[s&&u&&e.jsx("button",{onClick:()=>x(!0),disabled:!s,className:"hover:bg-token-bg-elevated-secondary bg-token-bg-elevated-primary absolute end-4 bottom-4 flex items-center justify-center rounded-full border border-black/10 p-0.5 dark:border-white/10",children:e.jsx(cs,{className:"icon-lg"})}),e.jsx("button",{onClick:()=>l&&t(),className:y("bg-token-main-surface-primary mt-4 flex w-full items-start justify-start gap-[18px] rounded-2xl border border-black/10 px-5 py-4 shadow-sm dark:border-white/10",l?"hover:bg-token-main-surface-secondary cursor-pointer":"cursor-auto"),children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:y("flex flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between",i?"h-12":"h-6"),children:[e.jsx("div",{className:y("font-sm text-token-text-primary w-full flex-1 truncate text-start leading-7 md:w-0",o&&"me-[30px]"),children:a}),i&&r]}),e.jsx("div",{className:y("flex w-full items-center justify-start gap-4 self-stretch pb-2",s&&u&&"pe-10"),children:d})]})})]})]})}function te({taskId:s,clientThreadId:n,toggleSidebar:t,openSidebar:a,startTime:i}){const o=se(),[r,d]=f.useState(!1),l=ns();return f.useEffect(()=>{if(!i)return;const m=Date.now()-i,x=Ks-m;if(x>0){const p=setTimeout(()=>{d(!0),a()},x);return()=>clearTimeout(p)}else d(!0),a()},[i,a]),e.jsx(we,{taskId:s,clientThreadId:n,onClick:t,statusMessage:r?o.formatMessage({id:"T2SbxC",defaultMessage:"Waiting…"}):e.jsx("div",{className:"text-token-text-primary text-sm font-medium text-pretty",children:l.startingMessage}),progressBar:e.jsx(is,{className:"h-2 w-full"}),showSources:!1})}function Ys(s,n,t){const a=s.formatMessage({id:"Bs+OcV",defaultMessage:"Thinking…"});if(n.length<2)return t?.initial??a;const i=n[n.length-2];return i.type==="summary"?i.title:i.type==="search"?i.query:i?.type==="websiteOpen"?e.jsx(Q,{componentOverrides:Y,children:i.activeRowText}):i.type==="fileOpen"?e.jsx(Q,{componentOverrides:Y,children:i.activeRowText}):i.type==="pythonAnalysis"?e.jsx(Q,{componentOverrides:Y,children:i.analysisSummary}):a}function Zs({task:s,clientThreadId:n,caterpillarRows:t,messageWithTaskMetadata:a,totalSources:i,handleToggleCaterpillarSidebar:o}){const r=se(),d=Ne(),l=Ys(r,t,a.metadata?.async_task_status_messages),m=(s?.expectedDurationMinutes??Qs)*60*1e3,x=rs(t[1]?.created_at?t[1].created_at*1e3:Date.now(),m),p=t[1]&&t[1].created_at?x:0;f.useEffect(()=>{Ie(n,b=>{b.async_status=Pe.STREAMING})},[n]);const{openThreadSidebar:u}=H();f.useEffect(()=>{t.length===2&&d&&u({type:"caterpillar",caterpillarId:s.taskId,initialTab:"activity",clientThreadId:n})},[t.length,u,s.taskId,n,d]);const _=f.useCallback(()=>{u({type:"caterpillar",caterpillarId:s.taskId,initialTab:"activity",clientThreadId:n})},[u,s.taskId,n]);return t.length<=1?e.jsx(te,{taskId:s.taskId,clientThreadId:n,toggleSidebar:()=>o("activity"),openSidebar:_,startTime:new Date(s.createdAt).getTime()}):e.jsx(we,{taskId:s.taskId,clientThreadId:n,onClick:()=>o("activity"),statusMessage:l,showSources:!0,includeMargin:i>0,sources:i===0?e.jsx("div",{className:"text-token-text-tertiary text-sm text-pretty",children:e.jsx(A,{id:"zfwUjs",defaultMessage:"Looking for sources…"})}):e.jsxs("button",{onClick:b=>{b.stopPropagation(),o("sources")},className:y("flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff]",d?"cursor-pointer hover:text-[#0285ff]/80":"cursor-auto"),children:[e.jsx("div",{className:"relative",children:e.jsx(I,{initial:!1,children:e.jsx(D.span,{initial:{opacity:0,rotateX:-90,translateY:20},animate:{opacity:1,rotateX:0,translateY:0},exit:{opacity:0,rotateX:90,translateY:-20},transition:{duration:.35},className:"absolute start-0 md:end-0",children:i},i)})}),e.jsx("div",{className:y("md:pe-0",i>0&&"ps-2",i>9&&"ps-[14px]",i>99&&"ps-[22px]"),children:i>1?e.jsx(A,{id:"zN+MuO",defaultMessage:" sources"}):e.jsx(A,{id:"dMowmJ",defaultMessage:" source"})})]}),progressBar:e.jsx("div",{className:"bg-token-main-surface-tertiary flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px]",children:e.jsx(os,{percentage:p,barClassName:"bg-token-text-primary",backgroundClassName:"bg-token-main-surface-tertiary"})})})}function qs({messages:s,clientThreadId:n}){const t=s.find(m=>m.metadata?.b1de6e2_s&&m.metadata?.async_task_id),a=t?.metadata?.async_task_id,i=s.find(m=>m.recipient===ze.START_RESEARCH_TASK),o=G(n,m=>ds(m,i?.id)),r=Ue({clientThreadId:n}),[d,l]=f.useState(r);return f.useEffect(()=>{const m=setTimeout(()=>{l(o&&r)},3e3);return()=>clearTimeout(m)},[r,o]),!t||!a?d?e.jsx(te,{taskId:a,clientThreadId:n,toggleSidebar:()=>{},openSidebar:()=>{},startTime:new Date().getTime()}):null:e.jsx(Gs,{clientThreadId:n,payloadTaskId:a,messageWithTaskMetadata:t})}function Gs({payloadTaskId:s,messageWithTaskMetadata:n,clientThreadId:t}){ms(s,n,t);const a=us(u=>s?u.tasks[s]:null),i=se(),o=a?.status,r=f.useMemo(()=>a?.rows?a.rows:[],[a?.rows]),{toggleThreadSidebar:d}=H(),{totalSources:l,totalSearches:m}=f.useMemo(()=>{if(!r)return{uniqueSources:[],totalSources:0,totalSearches:0};const u=gs(r),_=u.reduce((k,S)=>k+S.count,0),b=fs(r);return{uniqueSources:u,totalSources:_,totalSearches:b}},[r]),x=xs("caterpillar"),p=f.useCallback(u=>{s&&d({type:"caterpillar",caterpillarId:s,initialTab:u,clientThreadId:t},x)},[d,s,x,t]);return ps(s),n.metadata?.async_task_status_messages?.completed_with_time?e.jsx(me,{task:a,clientThreadId:t,messageWithTaskMetadata:n,totalSources:l,totalSearches:m,handleToggleCaterpillarSidebar:p}):!a||!o||o===V.UNDETERMINED?e.jsx(te,{taskId:s,clientThreadId:t,toggleSidebar:()=>{},openSidebar:()=>{},startTime:new Date().getTime()}):a.status===V.COMPLETED?e.jsx(me,{task:a,clientThreadId:t,messageWithTaskMetadata:n,totalSources:l,totalSearches:m,handleToggleCaterpillarSidebar:p}):a.status===V.FAILED?e.jsx(ue,{message:n.metadata?.async_task_status_messages?.error??i.formatMessage({id:"at6zk8",defaultMessage:"Failed to think"}),handleToggleCaterpillarSidebar:()=>p("activity")}):a.status===V.CANCELLED?e.jsx(ue,{message:n.metadata?.async_task_status_messages?.cancelled??i.formatMessage({id:"u1rIr5",defaultMessage:"Task Cancelled"}),handleToggleCaterpillarSidebar:()=>p("activity")}):e.jsx(Zs,{task:a,clientThreadId:t,caterpillarRows:r,messageWithTaskMetadata:n,totalSources:l,handleToggleCaterpillarSidebar:p})}const pe=4;function et({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const{value:a}=L("3472722167"),i=s.domains.filter(l=>l.url);f.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",s.type,{urls:i.map(l=>l.url).join(",")})},[i]);let o=[],r=[],d=i[0].sub_domains.length>0&&a;return i.length>3||d?(o=[i[0]],r=i.slice(1,pe)):o=i,e.jsxs("div",{className:y("not-prose mb-3 flex gap-2",r.length>0?"flex-col":"flex-row"),children:[o.map((l,m)=>e.jsx(he,{isPrimaryDomain:m===0,isFistLineDomain:!0,navigationDomain:l,trackContentReferenceEvent:t,analyticsMetadata:{section_index:m}},l.url)),r.length>0&&e.jsxs("div",{className:"flex items-stretch gap-2",children:[r.map((l,m)=>e.jsx(he,{navigationDomain:l,trackContentReferenceEvent:t,analyticsMetadata:{section_index:o.length+m}},l.url)),s.domains.length>pe&&e.jsx(st,{onShowSearchResults:n,trackContentReferenceEvent:t})]})]})}const Ae=ee.div`border border-token-border-default shadow-xxs hover:bg-token-main-surface-secondary dark:border-token-border-xlight dark:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-tertiary`,st=({onShowSearchResults:s,trackContentReferenceEvent:n})=>e.jsx(Ae,{className:"flex w-8 cursor-pointer items-center justify-center rounded-xl",onClick:()=>{n("Search Content Reference Clicked","search_content_reference_clicked","navigation",{sidebar:"sidebar"}),s(Se.Sources,Ee.Links)},children:e.jsx(Be,{className:"opacity-50"})}),he=({isPrimaryDomain:s,isFistLineDomain:n,navigationDomain:t,trackContentReferenceEvent:a,analyticsMetadata:i})=>(f.useEffect(()=>{a("link_action","link_action","navigation",{url:t.url,title:t.title,link_type:"card",action:"show",section:"fast_nav",section_location:"response",section_index:i.section_index})},[]),e.jsx("div",{className:y("flex-1",s?"min-w-[40%]":"min-w-0"),children:e.jsx(tt,{isFistLineDomain:n,isPrimaryDomain:s,title:t.title,subtitle:t.subtitle??void 0,url:t.url,domain:t.domain,subDomains:t.sub_domains,trackContentReferenceEvent:a,analyticsMetadata:i})})),tt=({isFistLineDomain:s,isPrimaryDomain:n,title:t,subtitle:a,url:i,subDomains:o,trackContentReferenceEvent:r,analyticsMetadata:d})=>{const{value:l}=L("3472722167");f.useState(!1);const m={url:i,title:t,link_type:"card",section:"fast_nav",section_location:"response",section_index:d.section_index};return o.length>0,e.jsxs(Ae,{className:"group/navigation text-token-link flex flex-col rounded-2xl",children:[e.jsxs(Te,{href:i,target:"_blank",onClick:()=>r("link_action","link_action","navigation",{...m,action:"click"}),onMouseEnter:()=>{r("link_action","link_action","navigation",{...m,action:"hover"})},className:y("flex flex-row items-center gap-2",s?"px-4 py-3":"px-4 py-2.5"),children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[#1D53BF0D] group-hover/navigation:bg-[#1D53BF1A] dark:bg-[#7CA8FF33] dark:group-hover/navigation:bg-[#7CA8FF33]",children:e.jsx(W,{url:i,size:32,minSize:20,className:"icon-sm rounded-full"})}),e.jsxs("div",{className:"flex min-w-0 flex-col gap-0.5",children:[e.jsxs("div",{className:y("flex items-center gap-1 font-semibold",s?"text-sm":"text-xs"),children:[e.jsx("span",{className:"flex-1 truncate",children:t}),!1]}),e.jsx("div",{className:"truncate text-xs",children:a})]})]}),!1]})},Z=3,at=3;function nt({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const{value:a}=L("756982149"),i=f.useContext(hs)!=null,o=f.useContext(_s);return e.jsx("div",{className:y({hidden:o&&i}),children:a?e.jsx(it,{navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}):e.jsx(et,{navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t})})}function it({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const a=s.domains.filter(r=>r.url);f.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",s.type,{urls:a.map(r=>r.url).join(",")})},[a]);let i=a.slice(0,Z),o=a.slice(Z,Z+at);return e.jsxs("div",{className:"not-prose mb-3 flex gap-4",children:[i.map((r,d)=>e.jsx(ot,{isPrimaryDomain:d===0,isFistLineDomain:!0,navigationDomain:r,trackContentReferenceEvent:t,analyticsMetadata:{section_index:d}},r.url)),o.length>0&&e.jsx(rt,{onShowSearchResults:n,trackContentReferenceEvent:t,moreDomains:o})]})}const rt=({onShowSearchResults:s,trackContentReferenceEvent:n,moreDomains:t})=>e.jsx("div",{className:"group hover:bg-token-main-surface-secondary flex w-20 cursor-pointer rounded-xl p-2",onClick:()=>{n("Search Content Reference Clicked","search_content_reference_clicked","navigation",{sidebar:"sidebar"}),s(Se.Sources,Ee.Links)},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-token-text-primary flex items-center truncate text-sm font-semibold",children:e.jsx(A,{id:"gJPygN",defaultMessage:"More"})}),e.jsx("div",{className:"flex items-center",children:t.map((a,i)=>e.jsx("div",{style:{zIndex:t.length-i},className:"ms-[-6px] first:ms-0",children:e.jsx("div",{className:y("flex h-5 w-5 items-center overflow-hidden rounded-full","border-token-main-surface-primary bg-token-main-surface-primary border-2"),children:e.jsx(W,{url:a.url,size:32,minSize:20,className:"icon-sm rounded-full"})},a.url)},a.url))})]})}),ot=({isPrimaryDomain:s,isFistLineDomain:n,navigationDomain:t,trackContentReferenceEvent:a,analyticsMetadata:i})=>(f.useEffect(()=>{a("link_action","link_action","navigation",{url:t.url,title:t.title,link_type:"card",action:"show",section:"fast_nav",section_location:"response",section_index:i.section_index})},[]),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(lt,{isFistLineDomain:n,isPrimaryDomain:s,title:t.title,subtitle:t.subtitle??void 0,url:t.url,domain:t.domain,subDomains:t.sub_domains,trackContentReferenceEvent:a,analyticsMetadata:i})})),lt=({isFistLineDomain:s,isPrimaryDomain:n,title:t,subtitle:a,url:i,subDomains:o,trackContentReferenceEvent:r,analyticsMetadata:d})=>{const{value:l}=L("3472722167");f.useState(!1);const m={url:i,title:t,link_type:"card",section:"fast_nav",section_location:"response",section_index:d.section_index};return o.length>0,e.jsxs("div",{className:"group/navigation text-token-link hover:bg-token-main-surface-secondary -ms-2 flex flex-col rounded-xl p-2",children:[e.jsxs(Te,{href:i,target:"_blank",onClick:()=>r("link_action","link_action","navigation",{...m,action:"click"}),onMouseEnter:()=>{r("link_action","link_action","navigation",{...m,action:"hover"})},className:"flex flex-row items-center gap-2",children:[e.jsx(ct,{url:i}),e.jsxs("div",{className:"flex min-w-0 flex-col",children:[e.jsxs("div",{className:y("flex items-center gap-1 font-semibold",s?"text-sm":"text-xs"),children:[e.jsx("span",{className:"text-token-text-primary flex-1 truncate",children:t}),!1]}),e.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:a})]})]}),!1]})},ct=({url:s})=>{const n=ys(s,32);return e.jsxs("div",{className:"icon-bg relative flex h-10 w-10 shrink-0 items-center justify-center overflow-hidden rounded-[10px]",children:[e.jsx("div",{className:"h-10 w-10 bg-cover bg-center bg-no-repeat opacity-35 blur-xl",style:{backgroundImage:`url(${n})`,backgroundSize:"5rem 5rem"}}),e.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:e.jsx(W,{url:s,size:32,minSize:20,className:"icon-sm rounded-full"})})]})},dt=2e3,De=.4,mt=.45,ut=.2,gt=.1,ft=.25;var R=(s=>(s[s.Running=0]="Running",s[s.Finished=1]="Finished",s[s.Error=2]="Error",s[s.Stopped=3]="Stopped",s[s.Paused=4]="Paused",s))(R||{});function Xt({conversationMessages:s,icon:n,status:t,text:a,estimatedToolDurationMs:i,animationLoopDurationMs:o=dt,shouldPersistAfterFinished:r=!1}){const[d,l]=f.useState(t===0?0:t===1&&!r?7:1),[m,x]=f.useState(0);f.useEffect(()=>{t===2?l(8):t===3?l(9):t===4?l(10):t===1?l(d===2?3:7):t===0&&d===10&&(l(2),x(u=>u+1))},[t]);const p=ht(d);return f.useEffect(()=>{const u=s[0].id;if(p)return ge.addDelayedRenderingMessage(u),()=>{ge.removeDelayedRenderingMessage(u)}},[p]),Ce(()=>{O(d)&&x(u=>u+1)},o),d===7&&!r?null:e.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[e.jsx(xt,{icon:n,status:t,uiState:d,estimatedToolDurationMs:i,animationLoopCounter:m,shouldPersistAfterFinished:r,onFillProgressBarAnimationComplete:()=>l(4),onFinishAnimationComplete:()=>{l(5),setTimeout(()=>{l(r?7:6)},gt*1e3)},onHideAnimationComplete:()=>l(7)}),e.jsx(pt,{text:a,uiState:d,animationLoopCounter:m,onEnterAnimationComplete:()=>l(2)})]})}const _e=50;function xt({icon:s,status:n,uiState:t,estimatedToolDurationMs:a,animationLoopCounter:i,shouldPersistAfterFinished:o,onFillProgressBarAnimationComplete:r,onFinishAnimationComplete:d,onHideAnimationComplete:l}){const[m,x]=f.useState(0);Ce(()=>{O(t)?x(M=>M+_e):t===10&&x(0)},_e);let p,u,_;O(t)||t===10?(p="running",u=e.jsx(s,{animationLoopCounter:i}),_="bg-transparent"):t===4||t===5||t===7&&o?(p="finished",u=e.jsx(bs,{}),_="bg-brand-purple"):n===2?(p="error",u=e.jsx(vs,{}),_="bg-orange-500"):n===3&&(p="stopped",u=e.jsx(ks,{}),_="bg-gray-300");let b={opacity:0,scale:0,rotate:-180,x:0},k={type:"spring",bounce:.3,duration:mt},S={opacity:0,scale:.6,rotate:0,x:0};t===0?(b={opacity:0,scale:.5,rotate:-180,x:-8},k={type:"spring",bounce:.3,duration:De}):t===1?b=!1:t===5&&(S={opacity:0,scale:0,rotate:0,x:0},k={type:"spring",bounce:.3,duration:ft});const T=Ns(m,a);return e.jsx("div",{className:"relative h-5 w-5 shrink-0",children:e.jsx(I,{onExitComplete:()=>{t===6&&l()},children:p!=null&&e.jsxs(D.div,{className:y("absolute start-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",_),initial:b,animate:{opacity:1,scale:1,rotate:0,x:0},exit:S,transition:k,onAnimationComplete:()=>{t===4&&d()},children:[u,(O(t)||t===10)&&e.jsx(js,{percentage:t===3?100:T,thickness:1.5/23,className:"text-brand-purple absolute start-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:t===3?`${(100-T)/100*ut}s`:void 0,transitionTimingFunction:t===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{t===3&&r()}})]},p)})})}function pt({text:s,uiState:n,animationLoopCounter:t,onEnterAnimationComplete:a}){const[i,o]=f.useState(s);f.useEffect(()=>{n===2&&o(s)},[t]),f.useEffect(()=>{O(n)||o(s)},[n,s]);let r={opacity:0,x:0,y:15},d={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};n===0?(r={opacity:0,x:-8,y:0},d={type:"spring",bounce:.3,duration:De,delay:.15}):n===1&&(r=!1);const l=i??void 0;return e.jsx("div",{className:y("relative h-5 w-full leading-5",n===8||n===9?"text-token-text-tertiary":"text-token-text-secondary"),children:e.jsx(I,{children:l!=null&&e.jsx(D.div,{className:"absolute start-0 top-0 line-clamp-1 overflow-visible",initial:r,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:d,onAnimationComplete:()=>{n===0&&a()},children:l},l.toString())})})}function O(s){return s===0||s===2||s===3}function ht(s){return O(s)||s===4||s===5||s===6||s===10}const ye=ee.div`group start-0 top-0 me-1.5 overflow-hidden mt-1 text-start`,_t=({highlightedCommand:s,status:n,children:t,showWorkUserSetting:a=!1,hideOnlyIfNotInteractedWith:i=!1,defaultExpanded:o=!1,onOpenAnalytics:r,onClick:d,...l},m)=>{const x=t!=null||d!=null,[p]=f.useState(a),[u,_]=f.useState(a||o),[b,k]=f.useState(!1),S=n===R.Finished||n===R.Error,T=i?p?!1:!b:!1,M=n===R.Running&&"loading-shimmer";return S&&T?null:x?e.jsxs(e.Fragment,{children:[e.jsx(je,{ref:m,$canShowWork:!0,...l,children:e.jsx(I,{children:e.jsx(ye,{children:e.jsx(D.button,{onClick:J=>{u||r?.(),_(X=>!X),k(!0),d?.(J)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:y(M),children:e.jsxs("div",{className:"flex items-center justify-start gap-1",children:[e.jsx("span",{className:"text-start",children:s}),!d&&(u?e.jsx(Ss,{className:"icon-md"}):e.jsx(Es,{className:"icon-md"}))]})},s?.toString())})})}),e.jsx(I,{children:u&&t&&e.jsx(D.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t})})]}):e.jsx(je,{ref:m,$canShowWork:!1,...l,children:e.jsx(ye,{className:y(M),children:s})})},je=ee.span`block first:mt-0 relative
${({$canShowWork:s})=>s?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,yt=f.forwardRef(_t),jt=3,bt=.1,be=[0,.26,.4];function vt({nextMessage:s,isLastMessage:n,isRequestActive:t,isLastTurnInConversation:a,clientThreadId:i,turnIndex:o}){let r=n||!s||s&&!q(s);const d=f.useRef(!1),l=as(),m=G(i,Ve.getGizmoId);f.useEffect(()=>{s&&q(s)&&!d.current&&(d.current=!0,Ts(l,m))},[s,l,m]);const x=He(s),p=We(s);s?.id&&Cs(s?.id);const u=[];if(p?.[0]?.type==="navigation"&&s&&u.push(e.jsx(kt,{clientThreadId:i,turnIndex:o,nextMessage:s,isRequestActive:t,isLastTurnInConversation:a,navigationCitation:p[0]},"fast-nav")),r){const _=Je(x.slice(0,jt).map(k=>k.entries[0].url)),b=t?e.jsxs("div",{className:"flex items-center gap-1",children:[_.map((k,S)=>e.jsx(D.div,{className:y("-ms-1.5 first:ms-0 last:me-1.5","relative"),initial:{width:S===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:bt,delay:be[Math.min(S,be.length-1)]},children:e.jsx("div",{className:y("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-token-main-surface-primary bg-token-main-surface-primary border-2"),children:e.jsx(W,{url:k,size:32,minSize:16,className:"icon-md rounded-full"})})},k)),e.jsx(A,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):e.jsx(A,{id:"fssXGM",defaultMessage:"Error while searching"});u.push(e.jsx(yt,{highlightedCommand:b,status:t?R.Running:R.Error},"search-gpt-query"))}return u.length?e.jsx(e.Fragment,{children:u}):null}const kt=({clientThreadId:s,turnIndex:n,nextMessage:t,isRequestActive:a,isLastTurnInConversation:i,navigationCitation:o})=>{const{scrollToHeader:r}=ce("searchSources")??{},d=Xe(),l=ce("searchSources"),{openThreadSidebar:m}=H(),{value:x}=L("756982148");return f.useEffect(()=>{$e.addFirstTiming("render.fastNavigation")},[]),f.useEffect(()=>{d&&l&&m({type:"searchSources",scrollToHeader:r,clientThreadId:s,turnIndex:n,messageId:t?.id??""})},[]),f.useEffect(()=>{const p=t,u=p.metadata?.search_source,_=o.domains.map(b=>b.url);ws.logEvent("Search Tool Request Time To Fast Nav",s,p.id,{search_source:u,urls:_},()=>{u===Ke.InstantQuery&&As.logEvent("Search Tool Page Load Time To Fast Nav",{message_id:p.id,urls:_,search_source:u})})},[s,t,o]),a&&i&&x?e.jsx(D.div,{initial:{opacity:a?0:1,height:a?0:"auto"},animate:{opacity:1,height:"auto"},children:e.jsx(ve,{clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:o})}):e.jsx(ve,{clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:o})},ve=({clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:a})=>{const{toggleThreadSidebar:i}=H(),{value:o}=L("756982148"),r=f.useMemo(()=>({clientThreadId:s,turnIndex:n,messageId:t?.id}),[s,n,t?.id]),d=f.useCallback((m,x)=>{i({type:"searchSources",scrollToHeader:x,clientThreadId:s,turnIndex:n,messageId:t?.id??""})},[i,s,n,t?.id]),l=Ds(r);return o?e.jsx(nt,{navigation:a,onShowSearchResults:d,trackContentReferenceEvent:l}):e.jsx(Ms,{tldr:{type:"tldr",status:"done",display_title:a.domains[0].title,url:a.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[a.domains[0].domain],refs:[]},trackContentReferenceEvent:l})},Nt=v(()=>N(()=>import("./nhi89wl5ggzl7sjh.js"),__vite__mapDeps([0,1,2,3,4,5]))),St=v(()=>N(()=>import("./n2u2gaip43up859y.js"),__vite__mapDeps([6,1,3,4,7]))),Et=v(()=>N(()=>import("./i3girl0vsphj18sl.js"),__vite__mapDeps([8,1,3,4,2,5]))),Tt=v(()=>N(()=>import("./hu0wq97e3zxxqel7.js"),__vite__mapDeps([9,1,3,4,2,5,10]))),Ct=v(async()=>()=>null);v(async()=>()=>null);const wt=v(async()=>(await N(()=>import("./y1bvaegllg40am8r.js"),__vite__mapDeps([11,3,1,4,10,2,5,12,13,14,15]))).ImageGenMessage),At=v(()=>N(()=>import("./fxf8mtlkytsxgugh.js"),__vite__mapDeps([16,1,3,4,2,5]))),Dt=v(()=>N(()=>import("./loq1ozxos4mki5zd.js"),__vite__mapDeps([13,1,3,4,2,5])).then(s=>s.BrowsingMessage)),Mt=v(()=>N(()=>import("./fpoe8uk54uqyf2ln.js"),__vite__mapDeps([17,1,3,4,2,5])).then(s=>s.SearchResultMessage)),Rt=v(()=>N(()=>import("./ozyeh5lwz4ak6oa7.js"),__vite__mapDeps([18,1,3,4,2,5,19])).then(s=>s.JITPluginMessage)),Ot=v(()=>N(()=>import("./gpzzsmfsxwwa6oqb.js"),__vite__mapDeps([20,3,1,4,21,2,5,22])).then(s=>s.DataAnalysisMessage)),Lt=v(()=>N(()=>import("./fw2zpvluaohmz34u.js"),__vite__mapDeps([23,1,3,4,2,5,24]))),It=v(()=>N(()=>import("./hpm70q586053933g.js"),__vite__mapDeps([25,1,3,4,26,27,2,5,12,13,28,29,30,31,32,33,34,35,36,37,38,22,39,40,41])).then(s=>s.LegacyCoTMessage)),Pt=v(()=>N(()=>import("./esy9xppmoo49xb0b.js"),__vite__mapDeps([26,1,3,4,27,2,5,12,13,28,29,30,31,32,33,34,35,36,37,38,22,39,40,41])).then(s=>s.CoT)),Ft=v(()=>N(()=>import("./m08bu3s6w2e4o2ka.js"),__vite__mapDeps([42,1,2,3,4,5,43,44,45,46])).then(s=>s.JawboneMessage)),zt=v(async()=>()=>null);function $t({groupedMessagesToRender:s,allMessages:n,allGroupedMessages:t,clientThreadId:a,isUserTurn:i,isCompletionRequestInProgress:o,isFeedbackEnabled:r,isFinalTurn:d,isFinalUserTurn:l,turnIndex:m,hasActiveRequest:x,onRequestCompletion:p,shouldGrowContainer:u=!0,isParagen:_=!1,renderingView:b="chat"}){const{showDebugConversationTurns:k}=Rs(),[S]=G(a,c=>[c?.mode]),T=Qe(a),M=Os(),J=t.some(c=>c.type===g.Browsing||c.type===g.RetrievalBrowsing||c.type===g.SearchGPTQuery),X=Ls(()=>Ye.count(Ze.DEFAULT,"conversation_turn_grouped_messages.attempted_render_missing_type_f959b8c")),$=s.map((c,h)=>{const j=h===t.length-1;if(c.type===de)return e.jsx(Pt,{isStreaming:j&&o,messageGroups:c.groups},"cot-"+c.groups[0].messages[0].id);const C=h===0?void 0:s[h-1],re=C?.type!==de?C:void 0,oe=re?.type,le=re?.messages,Oe=c&&!q(c.messages[0]),Le=J&&Oe,U=[];switch(Le||U.push(e.jsx(fe,{className:"min-h-8",message:c.messages[0],isFeedbackEnabled:r,isFinalUserTurn:l,isCompletionInProgress:j&&o,hasActiveRequest:x,turnIndex:m,clientThreadId:a,isUserTurn:i,prevGroupedMessageType:oe,prevGroupedMessages:le},"text-message-"+c.messages[0].id)),k&&U.push(e.jsx(zt,{clientThreadId:a,message:c.messages[0]},"message-debug-"+c.messages[0].id)),c.type){case g.Text:case g.MultiText:return c.type===g.Text?e.jsxs(f.Fragment,{children:[U,e.jsx(Bs,{isUserTurn:i,message:c.messages[0]})]},"group-"+c.messages[0].id):c.type===g.MultiText?e.jsx(Et,{clientThreadId:a,messages:c.messages,isCompletionInProgress:j&&o,isFeedbackEnabled:r,hasActiveRequest:x,prevGroupedMessageType:oe,prevGroupedMessages:le},"multitext-"+(c.messages[0]?.id??h)):c.type;case g.Browsing:case g.RetrievalBrowsing:{const E=S!=null&&[K.GizmoInteraction,K.GizmoMagicCreate,K.GizmoTest].includes(S.kind),w=T?Us(T):!1;return e.jsx(Dt,{messages:c.messages,isRequestActive:x,isLastMessageInTurn:j,isUsingGizmo:E,isUsingSnorlax:w,isRetrieval:c.type===g.RetrievalBrowsing},"browsing-"+(c.messages[0]?.id??h))}case g.SearchGPTQuery:{const E=t.slice(h+1).find(({type:B})=>B===g.Text),w=E?.type===g.Text?E:void 0;return e.jsx(vt,{clientThreadId:a,turnIndex:m,isRequestActive:x,isLastMessage:j,isLastTurnInConversation:d,nextMessage:w?.messages[0]},"searchquery-"+(c.messages[0]?.id??h))}case g.StructuredThoughts:return null;case g.ReasoningRecap:return null;case g.CoTSearchTool:return null;case g.n7jupd:return null;case g.n7jupd_c:return null;case g.n7jupd_x:return null;case g.n7jupd_m:{if(!j)return null;const E={...c.messages[0],content:{content_type:es.Text,parts:[""]}};return e.jsx(fe,{className:"min-h-8",message:E,isFeedbackEnabled:r,isFinalUserTurn:l,isCompletionInProgress:j&&o,hasActiveRequest:x,clientThreadId:a,isUserTurn:i,turnIndex:m},"text-message-"+E.id)}case g.a8km123:{if(!c.messages.some(w=>w.metadata?.model_slug==="o1-pro")){const w=qe(n,B=>B.author.role===Ge.Assistant&&B.recipient==="all");return e.jsx(It,{clientThreadId:a,turnIndex:m,isStreaming:(j||w<h)&&o,messages:c.messages},"sum-"+(c.messages[0]?.id??h))}return e.jsx(Lt,{messages:c.messages,isStreaming:j&&o,isLastMessage:j,clientThreadId:a,currentGroupedMessageIndex:h,turnIndex:m},"sum-"+(c.messages[0]?.id??h))}case g.f959b8c:return X(),null;case g.is_loading_message:return j&&o?e.jsx(zs,{},"loading-message-"+h):null;case g.c12k321:return null;case g.l1p9k3u:return null;case g.b1de6e2_c:return e.jsx(Fs,{messages:c.messages,clientThreadId:a,isLastMessage:j},"b1de6e2-"+(c.messages[0]?.id??h));case g.b1de6e2_s:return e.jsx(qs,{messages:c.messages,clientThreadId:a},"b1de6e2_s-"+(c.messages[0]?.id??h));case g.b1de6e2_d:return null;case g.b1de6e2_rm:return e.jsx(Ps,{messages:c.messages,clientThreadId:a,renderingView:b,children:U},"b1de6e2_rm-"+(c.messages[0]?.id??h));case g.de1d73e:if(M){const E=h+1<t.length?t[h+1]:void 0;return e.jsx(Ft,{clientThreadId:a,currentGroupedMessage:c,nextMessage:E&&E.type===g.Text?E.messages[0]:void 0,isLastMessage:j,isRequestActive:x},"jawbone-"+(c.messages[0]?.id??h))}else return null;case g.ParallelBrowsing:return e.jsx(At,{messages:c.messages},"parallel-"+(c.messages[0]?.id??h));case g.CodeInterpreter:return e.jsx(Ot,{messages:c.messages,isRequestActive:x,clientThreadId:a},"ada-"+(c.messages[0]?.id??h));case g.JITPlugin:return e.jsx(Rt,{messages:c.messages,clientThreadId:a,isLastTurnInConversation:d,onRequestCompletion:p},"jit-"+(c.messages[0]?.id??h));case g.t2uay3k:return e.jsx(wt,{messages:c.messages,clientThreadId:a,disableClickThru:_,isLastTurnInConversation:d},"t2uay3k-"+(c.messages[0]?.id??h));case g.Dalle:return e.jsx(Tt,{messages:c.messages,clientThreadId:a,disableClickThru:_},"dalle-"+(c.messages[0]?.id??h));case g.GizmoEditor:return e.jsx(Nt,{messages:c.messages},"gizmo-editor-"+(c.messages[0]?.id??h));case g.oiw209h:return e.jsx(Ct,{messages:c.messages,clientThreadId:a},"oiw209h-"+(c.messages[0]?.id??h));case g.Canmore:return e.jsx(Is,{messages:c.messages,allTurnMessages:n,isFinalTurn:d,isRequestActive:x,clientThreadId:a,isUserTurn:i},"canmore-"+(c.messages[0]?.id??h));case g.Oboe:return null;case g.Debug:return k?e.jsx(St,{message:c.messages[0]},"debug-"+c.messages[0].id):null;case g.SearchResult:return e.jsx(Mt,{messages:c.messages},"search-result-"+(c.messages[0]?.id??h));case g.kanzi:return null}}),Me=$s(),Re=ke(),{wordFadeType:P}=Vs(),F=f.useRef([]),ae=f.useRef(void 0),ne=f.useRef(null),z=!i&&d&&o,ie=n[0]?.id;return ss(()=>{if(P!=="indexed"||!z)return;const c=ne.current;if(!c)return;ae.current!==ie&&(ae.current=ie,F.current=[]);const h=c.getAnimations({subtree:!0}).filter(j=>j.animationName===xe["fade-in"]);if(h.length!==0){const j=Vt({now:performance.now(),previousStartTimes:F.current,groupCount:h.length});F.current=j;for(let C=0;C<h.length;C++)h[C].startTime=j[C]}else F.current=[]},[$,P,z]),e.jsx("div",{className:y({"flex max-w-full flex-col":!0,[xe.root]:P==="indexed"&&z,grow:u}),ref:ne,children:e.jsx(ts,{name:"GroupedMessages",fallback:Ut,children:i?$:e.jsxs(Hs,{isDisabled:!z||P!=="delay",children:[Ws(Re)&&d&&e.jsx(Js,{isStreaming:o,debug:Me}),$]},n[0]?.id)})})}function Ut(){return e.jsx(Xs,{type:"danger",children:e.jsx(A,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."})})}function Bt(s,n,t){if(s.length<2||n<=0)return 0;const a=n/Math.log(2);s=[...s].sort((r,d)=>r-d);let i=0,o=0;for(let r=s.length-1;r>0;--r){const d=Math.exp(-(t-s[r])/a);if(i>0&&d/i<.01)break;const l=s[r]-s[r-1];i+=d,o+=d*l}return i===0?0:i/o}function Vt({now:s,previousStartTimes:n,groupCount:t,initialRate:a=50,halfLife:i=1}){const o=n.slice(0,n.findLastIndex(x=>x<=s)+1),r=o.length<2?a/1e3:Math.max(.01,Bt(o,i*1e3,s)),d=t-o.length;let l=o[o.length-1]??0,m=1;for(let x=0;x<d;x++){const p=r*1e3*m;d<p?m*=.8:d>p&&(m*=1.5);const u=1/(r*m),_=Math.max(s,l+u);o.push(_),l=_}return o}export{$t as C,ve as F,nt as N,R as T,yt as a,Xt as b};
//# sourceMappingURL=ik1mvke1rzg5h1fr.js.map

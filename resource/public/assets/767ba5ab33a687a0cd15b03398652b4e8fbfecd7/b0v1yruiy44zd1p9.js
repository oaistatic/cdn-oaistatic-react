import{r7 as ae,r8 as Me,gX as Ee,cE as be,hS as Te,fg as _e,L as De,g$ as Pe,hi as oe,f5 as Ie,mZ as Le,r9 as Ne,X as Re,cI as Oe,ra as He,rb as Ae,rc as Fe,rd as le,re as Ke,rf as je,ct as _,pj as Ue,rg as Be,pk as We,pl as Ge,pm as ze,rh as qe,ri as $e,rj as ce,rk as B,pi as ue,rl as Xe,rm as Ye,rn as Ve,m_ as Je,ag as Qe}from"./jn7p98x7qxquz26a.js";import{hd as Ze,aN as et,bD as tt,ec as nt,he as st,v as rt,n as it,b2 as at,at as ot,q as lt,bN as ct,P as x,C as ut,B as pt,M as dt,D as ft,r as ht,Y as mt,dl as gt,a as vt,dg as wt,s as yt,N as St,cX as xt,aP as Ct,aO as kt,dy as pe,hf as Mt}from"./j5zd9vs1l0bwsjqa.js";import{r as v,j as m,u as Et,M as X,R as de}from"./j12so9ru57hpoz1y.js";import{a as b,P as D,b as bt,D as Tt,T as K,p as _t,M as Dt,m as W,n as Y,o as Pt,E as It,q as Lt,u as Nt,v as Rt,x as Ot,y as Ht,z as V,r as At}from"./msp412gwqdn605it.js";const fe=new b("transactionEventPlugin"),G="prosemirrorDispatchTransaction";function J(n,e){const{eventTarget:t}=fe.getState(n.state);return t.addEventListener(G,e),()=>{t.removeEventListener(G,e)}}function Ft(n){return new D({key:fe,state:{init(){return{eventTarget:n}},apply(e,t){return t}}})}const L=new b("customKeymapPlugin");function Kt(n,e){n.dispatch(n.state.tr.setMeta(L,{handlers:e}))}function jt(n={handlers:{}}){return new D({key:L,state:{init(){return{...n}},apply(e,t){const r=e.getMeta(L);return r?{...t,...r}:t}},props:{handleKeyDown(e,t){const s=L.getState(e.state).handlers[t.key];return s?s(t):!1}}})}const M=new b("menuSelectorPlugin");function Q(n){n.dispatch(n.state.tr.setMeta(M,{active:!1,onMenuAction:void 0}))}function Nn(n,e){n.dispatch(n.state.tr.setMeta(M,{active:!0,onMenuAction:e}))}function Ut(n={submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}){return new D({key:M,state:{init(){return{...n,active:!1}},apply(e,t){const r=e.getMeta(M);return r?{...t,...r}:t}},props:{handleKeyDown(e,t){const r=M.getState(e.state);if(!r.active)return!1;if(!t.isComposing)return r.submitKeys.includes(t.key)?(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),Q(e),r.onMenuAction?.("submit")??!0):r.cancelKeys.includes(t.key)?(t.preventDefault(),r.onMenuAction?.("cancel"),Q(e),!0):t.key==="ArrowUp"?(t.preventDefault(),r.onMenuAction?.("up"),!0):t.key==="ArrowDown"?(t.preventDefault(),r.onMenuAction?.("down"),!0):r.checkStrictMatchKeys.includes(t.key)&&r.onMenuAction?.("checkMatch")?(t.preventDefault(),!0):!1},handleDOMEvents:{blur:e=>{M.getState(e.state).onMenuAction?.("cancel")}}}})}const P=new b("placeholderPlugin");function Bt(n){return new D({key:P,state:{init(){return{placeholder:n}},apply(e,t){return e.getMeta(P)?{placeholder:e.getMeta(P).placeholder}:t}},props:{decorations(e){const{doc:t}=e;if(t.childCount===1&&t.firstChild?.isTextblock&&t.firstChild.content.size===0){const s=[],{placeholder:i}=P.getState(e);return e.doc.descendants((a,o)=>{const l=bt.node(o,o+a.nodeSize,{class:"placeholder","data-placeholder":i});s.push(l)}),Tt.create(t,s)}}}})}const I="command_token",Wt={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:n=>["span",{"data-mention-id":n.attrs.id,"data-mention-hint":n.attrs.hint,class:"hint-pill"},n.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:n=>{const e=n.getAttribute("data-mention-id"),t=n.getAttribute("data-mention-hint");return{id:e,hint:t}}}]};function he(n,e){if(n.depth===0)return;const t=n.nodeBefore?.text?.match(/(?:^|\s)(\/(\w*))$/);if(t?.[1].length!==void 0){const r=n.pos-t[1].length,s=n.pos,i=r===e?.from;return{range:{from:r,to:s},queryText:t[2],isDismissed:i}}}const z=new b("systemHintPlugin");function me(n,e){return n.setMeta(z,e),n}function Rn(n){const t=n.state.selection.$from,r=he(t,void 0);n.dispatch(me(n.state.tr,{...R(),dismissedRange:r?.range}))}function R(){return{queryText:"",active:!1,range:void 0,dismissedRange:void 0}}function Gt(n,e,t,r,s){const i=n.state.tr;me(i,R());const a=t+" ",o=n.state.schema.nodes[I].create({id:e,hint:a},n.state.schema.text(a));if(s===r){const l=i.doc.resolve(r).nodeAfter;if(l?.isText){const c=l?.textContent.match(new RegExp(`^(?:${t}) ?`));c&&(s=r+c[0].length)}}i.replaceWith(r,s,o),i.doc.descendants((l,c)=>{l.type.name===I&&l!==o&&(r===1&&c===r+o.nodeSize||c===1&&r===c+l.nodeSize?i.delete(c,c+l.nodeSize):i.insertText(l.textContent,c,c+l.nodeSize))}),n.dispatch(i)}function zt(n){const e=n.state.tr;e.doc.descendants((t,r)=>{if(t.type.name===I){const s=r+t.nodeSize;r===1&&e.doc.resolve(s).nodeAfter==null?e.delete(r,s):e.insertText(t.textContent,r,r+t.nodeSize)}}),e.steps.length>0&&n.dispatch(e)}function Z(n){const{active:e,range:t,queryText:r,onHintMatch:s}=n;if(s)return s(!e||!t?void 0:{text:r,range:t})}function qt(n){const e=[];return n.descendants(t=>{t.type.name===I&&typeof t.attrs?.id=="string"&&e.push(t.attrs.id)}),e}function $t(){return new D({key:z,state:{init(){return R()},apply(n,e,t,r){const s=n.getMeta(z),i={...R(),...e,...s},a=n.selection;if(a.from!==a.to||r.doc.eq(t.doc))return Z(i),i;const o=a.$from,l=he(o,e.dismissedRange);return i.active=!!l&&!l.isDismissed,l&&(i.queryText=l.queryText,i.range=l.range,l.isDismissed&&(l.queryText===""&&e.queryText!==""?i.dismissedRange=void 0:i.dismissedRange=l.range)),Z(i),i}}})}class Xt extends Ze{constructor(e){super(),this.view=e,this.subscribe("focus",()=>this._store.setState({isFocused:!0})),this.subscribe("blur",()=>this._store.setState({isFocused:!1}))}fileInputHandle=null;_store=et(e=>({isFocused:!1,autocompletions:[],showTaggingDropdown:!1,waveWidth:300,isInReasonMode:!1,rateLimitBannerFeature:null,setShowTaggingDropdown:t=>e({showTaggingDropdown:t})}));get store(){return this._store}_usedDictation=!1;get usedDictation(){return this._usedDictation}set usedDictation(e){this._usedDictation=e}get element(){return this.view.dom}get document(){return this.view.dom.ownerDocument}isEmpty(){return this.view.state.doc.textContent.trim().length===0}isFocused(){return this.view.hasFocus()}trimLeadingText(e){const r=this.view.state.tr;let s=0;return r.doc.descendants((i,a)=>{if(i.isText&&i.text){if(typeof e=="string"&&i.text.startsWith(e))s=e.length;else if(e instanceof RegExp){const o=i.text.match(e);o?.index===0&&(s=o[0].length)}if(s){const o=i.text.substring(s).trimStart();s=i.text.length-o.length,r.delete(a,a+s)}}return!i.isLeaf}),s>0?(this.view.dispatch(r),!0):!1}replaceAll(e,t){const s=this.view.state.tr,i=[];s.doc.descendants((a,o)=>{!a.isText||a.text===void 0||i.push({node:a,pos:o})}),i.reverse(),i.forEach(({node:a,pos:o})=>{!a.isText||a.text===void 0||a.text.includes(e)&&s.insertText(a.text.replaceAll(e,t),o,o+a.text.length)}),this.view.dispatch(s)}appendText(e){this.view.dispatch(this.view.state.tr.insertText(e))}delete(e,t){this.view.dispatch(this.view.state.tr.delete(e,t))}focus(){this.view.hasFocus()||(this.view.focus(),this.view.dispatch(this.view.state.tr.setSelection(K.atEnd(this.view.state.doc)).scrollIntoView()))}setText(e){const{tr:t,schema:r}=this.view.state,s=e?r.nodes.paragraph.create(null,r.text(e)):r.nodes.paragraph.create();this.view.dispatch(t.replaceWith(0,this.view.state.doc.content.size,s)),this.view.hasFocus()&&this.view.dispatch(this.view.state.tr.setSelection(K.atEnd(this.view.state.doc)))}getContentLength(){return this.view.state.doc.content.size}getCurrentText(){return this.view.state.doc.textContent}hasMultipleLines(){let e=0;return this.view.state.doc.descendants(t=>{t.isBlock&&e++}),e>1}getContentToSend(){return _t(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(e){this.view.dispatch(this.view.state.tr.setMeta(P,{placeholder:e}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}setSelection(e,t){this.view.dispatch(this.view.state.tr.setSelection(K.create(this.view.state.doc,e,t))),this.view.focus()}isMenuSelectorActive(){return M.getState(this.view.state).active}registerKeyHandlers(e){Kt(this.view,e)}registerFileInput(e){this.fileInputHandle=e}openFileDialog(){this.fileInputHandle?.openFileDialog()}acceptLegacyKeydown(){return!1}subscribe(e,t){if(e==="change"){const r=()=>t(void 0);return J(this.view,r)}return this.view.dom?.addEventListener(e,t,{capture:!0}),()=>{this.view.dom?.removeEventListener(e,t,{capture:!0})}}useState(e){return v.useSyncExternalStore(t=>J(this.view,t),()=>e(this),()=>e(this))}getSystemHint(){return qt(this.view.state.tr.doc)[0]??null}addSystemHint(e,t,r=1,s=1){Gt(this.view,e,t,r,s)}removeSystemHints(){zt(this.view)}canShowAutocompletion(){return this.getSystemHint()===tt.PictureV2||!this.isMenuSelectorActive()&&!this.getSystemHint()}}const Yt=500;class y{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let a=e.tr,o,l,c=[],d=[];return this.items.forEach((u,p)=>{if(!u.step){s||(s=this.remapping(r,p+1),i=s.maps.length),i--,d.push(u);return}if(s){d.push(new S(u.map));let f=u.step.map(s.slice(i)),h;f&&a.maybeStep(f).doc&&(h=a.mapping.maps[a.mapping.maps.length-1],c.push(new S(h,void 0,void 0,c.length+d.length))),i--,h&&s.appendMap(h,i)}else a.maybeStep(u.step);if(u.selection)return o=s?u.selection.map(s.slice(i)):u.selection,l=new y(this.items.slice(0,r).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:a,selection:o}}addTransform(e,t,r,s){let i=[],a=this.eventCount,o=this.items,l=!s&&o.length?o.get(o.length-1):null;for(let d=0;d<e.steps.length;d++){let u=e.steps[d].invert(e.docs[d]),p=new S(e.mapping.maps[d],u,t),f;(f=l&&l.merge(p))&&(p=f,d?i.pop():o=o.slice(0,o.length-1)),i.push(p),t&&(a++,t=void 0),s||(l=p)}let c=a-r.depth;return c>Jt&&(o=Vt(o,c),a-=c),new y(o.append(i),a)}remapping(e,t){let r=new Dt;return this.items.forEach((s,i)=>{let a=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,a)},e,t),r}addMaps(e){return this.eventCount==0?this:new y(this.items.append(e.map(t=>new S(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,a=e.steps.length,o=this.eventCount;this.items.forEach(p=>{p.selection&&o--},s);let l=t;this.items.forEach(p=>{let f=i.getMirror(--l);if(f==null)return;a=Math.min(a,f);let h=i.maps[f];if(p.step){let C=e.steps[f].invert(e.docs[f]),g=p.selection&&p.selection.map(i.slice(l+1,f));g&&o++,r.push(new S(h,C,g))}else r.push(new S(h))},s);let c=[];for(let p=t;p<a;p++)c.push(new S(i.maps[p]));let d=this.items.slice(0,s).append(c).append(r),u=new y(d,o);return u.emptyItemCount()>Yt&&(u=u.compress(this.items.length-r.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((a,o)=>{if(o>=e)s.push(a),a.selection&&i++;else if(a.step){let l=a.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let d=a.selection&&a.selection.map(t.slice(r));d&&i++;let u=new S(c.invert(),l,d),p,f=s.length-1;(p=s.length&&s[f].merge(u))?s[f]=p:s.push(u)}}else a.map&&r--},this.items.length,0),new y(ae.from(s.reverse()),i)}}y.empty=new y(ae.empty,0);function Vt(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class S{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new S(t.getMap().invert(),t,this.selection)}}}class k{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const Jt=20;function Qt(n,e,t,r){let s=t.getMeta(E),i;if(s)return s.historyState;t.getMeta(tn)&&(n=new k(n.done,n.undone,null,0,-1));let a=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(a&&a.getMeta(E))return a.getMeta(E).redo?new k(n.done.addTransform(t,void 0,r,N(e)),n.undone,ee(t.mapping.maps),n.prevTime,n.prevComposition):new k(n.done,n.undone.addTransform(t,void 0,r,N(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let o=t.getMeta("composition"),l=n.prevTime==0||!a&&n.prevComposition!=o&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Zt(t,n.prevRanges)),c=a?j(n.prevRanges,t.mapping):ee(t.mapping.maps);return new k(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,N(e)),y.empty,c,t.time,o??n.prevComposition)}else return(i=t.getMeta("rebased"))?new k(n.done.rebased(t,i),n.undone.rebased(t,i),j(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new k(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),j(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Zt(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function ee(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,a)=>e.push(i,a));return e}function j(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function en(n,e,t){let r=N(e),s=E.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let a=i.selection.resolve(i.transform.doc),o=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new k(t?o:i.remaining,t?i.remaining:o,null,0,-1);return i.transform.setSelection(a).setMeta(E,{redo:t,historyState:l})}let U=!1,te=null;function N(n){let e=n.plugins;if(te!=e){U=!1,te=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){U=!0;break}}return U}const E=new b("history"),tn=new b("closeHistory");function nn(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new D({key:E,state:{init(){return new k(y.empty,y.empty,null,0,-1)},apply(e,t,r){return Qt(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?ve:r=="historyRedo"?q:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function ge(n,e){return(t,r)=>{let s=E.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=en(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const ve=ge(!1,!0),q=ge(!0,!0);function sn(){return W({"Shift-Enter":(n,e)=>Y(n,e),Enter:(n,e)=>window.innerWidth>Me[Ee.Medium]||nt?!1:Y(n,e)})}const rn=["p",0],an=["br"],on=new Pt({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM(){return rn}},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return an}},[I]:Wt,doc:{content:"block+"}},marks:{}});function ln(n=null){const e=new EventTarget,t=new It(null,{state:Lt.create({schema:on,plugins:[nn(),Ut(),Bt(""),$t(),sn(),W({"Mod-z":ve,"Mod-y":q,"Mod-Shift-z":q}),jt(),W(Ht),Ft(e),Nt()]}),dispatchTransaction(r){const s=t.state.apply(r);t.updateState(s),r.docChanged&&e.dispatchEvent(new Event(G))},handlePaste(r,s){const i=s.clipboardData?.getData("text/plain");return i===void 0?!1:(s.defaultPrevented||Rt(r,i),!0)},clipboardTextSerializer(r){return Ot(r.content).content}});return n!=null&&t.state.doc.textContent.trim().length===0&&t.dispatch(t.state.tr.insertText(n)),t}const $=v.createContext(null),cn=({children:n,clientThreadId:e,ignoreParentComposerController:t=!1})=>{const r=v.useContext($),s=v.useMemo(()=>r&&!t?r:new Xt(ln(st(rt(e))?.content??null)),[r,e]);return m.jsx($.Provider,{value:s,children:n})},On=()=>it(v.useContext($));function we(){return{clientThreadId:"",isLoggedInUser:!1,focusedObject:null,currentModelId:"",isModelLoaded:!1,isEmbeddedInFocusedView:!1,isInstalledApp:!1,onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const ye=v.createContext(we());function un(){try{return v.use(ye)}catch{return we()}}function Hn({children:n,clientThreadId:e,setClientThreadId:t,routeType:r,prefetchSearchPromises:s}){const{createNewThread:i,resetThread:a}=be({clientThreadId:e,setClientThreadId:t}),{data:o}=at(),l=Te(o),c=ot(e,O=>O?.modelId),d=_e(),u=l.id,p=c??u,f=De(),h=Pe(),{isUnauthenticated:C}=lt(),g=!C,w=oe(e),T=v.useMemo(()=>({clientThreadId:e,currentModelId:p,isModelLoaded:!!c,isEmbeddedInFocusedView:d,isInstalledApp:f,isLoggedInUser:g,focusedObject:h,onNewThread:i,onRequestCompletion:w,resetThread:a,prefetchSearchPromises:s,routeType:r}),[e,p,c,d,f,g,h,i,w,a,s,r]);return m.jsx(ye.Provider,{value:T,children:m.jsx(cn,{clientThreadId:e,children:n})})}function pn({closeModal:n,url:e,onAction:t,onActionAborted:r}){const s=v.useRef(!1),i=Et(),{clientThreadId:a}=un(),l={...ct({clientThreadId:a}),url:e,link_type:"text",section:"safe-link-modal"};v.useEffect(()=>{x.logEventWithStatsig("Safe Link Warning Modal Shown","chatgpt_safe_link_warning_modal_shown")},[]);const c=async()=>{s.current=!0;try{await navigator.clipboard.writeText(e),x.logEventWithStatsig("Safe Link Warning Modal Copy Clicked","chatgpt_safe_link_warning_modal_copy_clicked"),x.logEventWithStatsig("link_action","link_action",{...l,action:"copy"})}catch(g){ft.addError(g)}t?.("copy"),n()},d=()=>{s.current=!0,x.logEventWithStatsig("Safe Link Warning Modal Open Clicked","chatgpt_safe_link_warning_modal_open_clicked"),x.logEventWithStatsig("link_action","link_action",{...l,action:"click"}),t?.("open"),n()},u=()=>{s.current||(x.logEventWithStatsig("Safe Link Warning Modal Canceled","chatgpt_safe_link_warning_modal_canceled"),r?.()),s.current=!1,n()};let p="",f=e,h="";try{f=new URL(e).hostname;const w=e.indexOf(f);w!==-1&&(p=e.substring(0,w),h=e.substring(w+f.length))}catch{}return m.jsxs(ut,{testId:"modal-safe-link-warning",isOpen:!0,hideSeparator:!0,onClose:u,showCloseButton:!0,type:"warning",title:m.jsx("div",{className:"flex items-center gap-2",children:i.formatMessage({id:"6JdScx",defaultMessage:"This link isn’t verified"})}),primaryButton:m.jsx(pt,{as:"link",openNewTab:!1,rel:"noopener noreferer",color:"primary",onClick:d,to:e,children:i.formatMessage({id:"gMzmDW",defaultMessage:"Open link"})}),secondaryButton:m.jsx(dt.Button,{title:i.formatMessage({id:"YGLt71",defaultMessage:"Copy link"}),color:"secondary",onClick:c}),children:[m.jsxs("p",{className:"-mt-4 mb-6 text-sm text-pretty sm:-mt-7",children:[m.jsx(X,{id:"23OGbk",defaultMessage:"Make sure you trust this link before proceeding. If you don\\u2019t recognize the URL, don\\u2019t open the link to access the site."}),m.jsx("a",{className:"can-hover:hover:text-token-link-hover ps-1 underline underline-offset-1",href:"https://help.openai.com/en/articles/10984597-chatgpt-generated-links",target:"_blank",rel:"noopener noreferrer",children:m.jsx(X,{id:"xNvPsR",defaultMessage:"Learn more"})})]}),m.jsxs("div",{className:"mb-2 font-mono text-sm break-all",children:[m.jsx("span",{className:"text-token-text-secondary",children:p}),m.jsx("span",{className:"text-token-text-primary font-bold",children:f}),m.jsx("span",{className:"text-token-text-secondary",children:h})]})]})}const ne={},se={},re={};function ie(n,e){return`${n}::${e}`}function Se({node:n,onClick:e,children:t,clientThreadId:r,messageId:s,href:i,disableSafeURLs:a,...o}){let l=e;const c=n?.properties?.href,d=Ie(),u=v.useContext(Le),p=ht(),f=mt(r),h=Ne(f,i,u?.useSafeUrls&&!a),C=gt(p,"387775177"),g=!a&&h===void 0&&C.get("enable-copy-and-open",!1);s!=null&&typeof c=="string"&&c.includes("/bing/redirect")&&(ne[s]||(x.logEvent("Browsing Show Bing Link",{id:s,content:c}),ne[s]=!0),l=H=>{se[s]||(x.logEvent("Browsing Click Bing Link",{id:s,content:c}),se[s]=!0),e?.(H)}),l=H=>{const A=""+c;if(s&&!re[ie(s,A)]){const F=h||g?"URL Clicked Allowed":"URL Clicked Blocked";x.logEvent(F,{id:s,content:A}),re[ie(s,A)]=!0}e?.(H),g&&i&&wt(p,({closeModal:F})=>m.jsx(pn,{url:i,closeModal:F}))};const{target:w,...T}=o,O=w;return m.jsx(m.Fragment,{children:m.jsx("a",{onClick:l,...T,className:vt(o.className,g&&"cursor-pointer"),href:h,target:O,rel:d?"noopener noreferrer":"noopener",children:t})})}const dn="w";function fn({messageId:n,clientThreadId:e,text:t,children:r,...s}){const i=oe(e),a=Re(),o=Oe(e),c=`${window.location.origin}?q=${encodeURIComponent(t)}`,d=v.useCallback(async u=>{u.preventDefault(),yt.count(St.DEFAULT,"instant_follow_up_anchor_clicked"),x.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:e,messageId:n}),i({sourceEvent:u,promptMessage:xt(t),completionMetadata:{systemHints:[...a],conversationMode:o??{kind:Ct.PrimaryAssistant}}})},[e,o,n,a,i,t]);return m.jsx(Se,{...s,href:c,disableSafeURLs:!0,clientThreadId:e,messageId:n,className:"cursor-pointer",onClick:d,children:r})}const hn=de.memo(fn);function mn({messageId:n,clientThreadId:e,text:t,children:r,...s}){const{value:i}=kt("374768818");return i?m.jsx(hn,{messageId:n,clientThreadId:e,text:t,children:r,...s}):m.jsx(Se,{messageId:n,clientThreadId:e,children:r,...s})}const An=de.memo(mn),gn={},vn=[];function xe(n){const e=n||gn;return function(t,r){He(t,"element",function(s,i){const a=Array.isArray(s.properties.className)?s.properties.className:vn,o=a.includes("language-math"),l=a.includes("math-display"),c=a.includes("math-inline");let d=l;if(!o&&!l&&!c)return;let u=i[i.length-1],p=s;if(s.tagName==="code"&&o&&u&&u.type==="element"&&u.tagName==="pre"&&(p=u,u=i[i.length-2],d=!0),!u)return;const f=Ae(p,{whitespace:"pre"});let h;try{h=V.renderToString(f,{...e,displayMode:d,throwOnError:!0})}catch(g){const w=g,T=w.name.toLowerCase();r.message("Could not render math with KaTeX",{ancestors:[...i,s],cause:w,place:s.position,ruleId:T,source:"rehype-katex"}),T==="parseerror"?h=V.renderToString(f,{...e,displayMode:d,strict:"ignore",throwOnError:!1}):h=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(e.errorColor||"#cc0000"),title:String(g)},children:[{type:"text",value:f}]}]}typeof h=="string"&&(h=Fe(h).children);const C=u.children.indexOf(p);return u.children.splice(C,1,...h),le})}}const Fn=n=>n.startsWith(Ke)||n===dn?n:je(n);function wn(){return n=>{_(n,"list",e=>{for(const t of e.children)t.spread=!0})}}function Kn(n){return e=>{_(e,t=>{Object.defineProperties(t,{markdownSource:{get(){return n.slice(this.position.start.offset,this.position.end.offset)}}})})}}const Ce=[Ue,Be,wn,[We,{singleDollarTextMath:!1}],Ge,ze,At,yn,xn];function yn(){return n=>{_(n,"textDirective",e=>{e.name!==pe&&(e.type="text",e.value=`:${e.name}`)})}}const Sn=/\u200b/g;function xn(){return n=>{_(n,"text",e=>{e.value=e.value.replace(Sn,"")})}}function Cn(){return n=>{const e=n.position?.end.offset;_(n,"element",(t,r)=>{const{position:s}=t;if(!s)return;const{start:i,end:a}=s,o=i.offset,l=a.offset;t.properties??={},o!=null&&(t.properties["data-start"]=o),l!=null&&(t.properties["data-end"]=l,e===l&&(t.properties["data-is-last-node"]=""),r===n.children.length-1&&(t.properties["data-is-only-node"]=""))})}}const jn=[xe,Cn,qe,[$e,{target:"_new",rel:"noopener noreferrer"}],ce],kn=[[xe,{output:"mathml"}],ce];function Mn(n,e){const t=Mt(n,e);return ke(t,e)}function ke(n,e){const t=B().use(ue).use(Ce).use([[Tn,e??[]]]).use(Xe,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:En}}),r=B().use(Ye).use(kn).use(Ve),s=t.runSync(t.parse(n)),i=t.stringify(s),a=r.stringify(r.runSync(s));return{"text/plain":i,"text/html":a}}const En=(n,e,t,r)=>{const s=t.createTracker(r),i=t.enter("link"),a=t.enter("label");let o=s.move("[");return o+=s.move(t.containerPhrasing(n,{before:o,after:"](",...s.current()})),o+=s.move("]("),a(),o+=s.move(n.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,bn)),n.title&&(o+=s.move(" "+JSON.stringify(n.title))),o+=s.move(")"),i(),o};function bn(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function Tn(n){return e=>{const t={},r=(s,i)=>{switch(i.type){case"grouped_webpages":{const a=[];for(const o of i.items)if(o.url&&o.title){let l=t[o.url];l||(l=t[o.url]={type:"definition",identifier:String(Object.keys(t).length+1),url:o.url,title:o.title}),a.push({type:"linkReference",referenceType:"shortcut",identifier:l.identifier,children:[{type:"text",value:o.attribution??Qe(o.url)}]})}return a.length===0?[]:[{type:"text",value:"("},...a.flatMap((o,l,c)=>l<c.length-1?[o,{type:"text",value:", "}]:[o]),{type:"text",value:")"}]}case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[];default:{if(i.alt){const a=B().use(ue).use(Ce).parse(i.alt);if(s.type!=="textDirective")return a.children;const o=a.children[0];if(o.type==="paragraph")return o.children}return[]}}};_(e,Je,(s,i,a)=>{if(a==null||i==null)return;const o=_n(s,n),l=o?r(s,o)??[s]:[];return a.children.splice(i,1,...l),[le,i+l.length]}),e.children.push(...Object.values(t))}}function _n(n,e){if(n.name===pe){const t=n.attributes?.index;if(t)return e[parseInt(t,10)]}}const Un=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:ke,messageTextToClipboardContent:Mn},Symbol.toStringTag,{value:"Module"}));export{cn as C,dn as I,Se as M,Xt as P,jn as R,An as S,Hn as a,ln as b,$ as c,On as d,Nn as e,Q as f,Rn as g,Ce as h,Fn as i,ke as j,Un as k,Mn as m,Kn as r,me as s,un as u};
//# sourceMappingURL=b0v1yruiy44zd1p9.js.map

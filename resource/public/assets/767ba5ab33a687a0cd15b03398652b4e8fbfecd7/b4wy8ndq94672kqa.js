const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j2m3ef69iou998eo.js","assets/j5zd9vs1l0bwsjqa.js","assets/j12so9ru57hpoz1y.js","assets/root-eh80jqkj.css","assets/jn7p98x7qxquz26a.js","assets/conversation-small-cmjjxogj.css","assets/egjzck8f21ldiiq8.js","assets/n5601invkykfg1ys.js","assets/b0v1yruiy44zd1p9.js","assets/msp412gwqdn605it.js","assets/ok8fnoyzbnoyk9qs.js","assets/owhjnpwqw9ddu7v0.js","assets/d8hi8vzea1zd4sdu.js","assets/hxt8zt4ovcs39phn.js"])))=>i.map(i=>d[i]);
import{cy as $,cz as W,r as Y,aO as N,at as J,W as Z,au as ee,am as l,gc as te,f5 as se,n as ae,a as _,P as M,aw as oe,ax as re,q as ne,an as C,ao as z}from"./j5zd9vs1l0bwsjqa.js";import{r as o,j as t,L as P,u as ie}from"./j12so9ru57hpoz1y.js";import{b1 as le,b2 as de,b3 as ue,b4 as ce,b5 as me,b6 as fe,b7 as ge,b8 as A,b9 as pe,ba as he,bb as be,bc as xe,bd as ye,be as L,bf as Se,bg as Ce,bh as Ee,bi as Re,bj as Ie,bk as U,bl as Te}from"./jn7p98x7qxquz26a.js";import{G as ke}from"./egjzck8f21ldiiq8.js";const je=$(()=>W(()=>import("./j2m3ef69iou998eo.js").then(e=>e.k),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(e=>e.GizmoConversationOptionsDropdown)),De=new Date(2024,9,11,0);function q(e){oe.checkGate("3922476776")||re.abortAllRequests(),M.logEvent("Load Thread",{threadId:e})}function ve({conversation:e,onOpenChange:d,testId:f,inMainScreen:s=!1,isActiveConversation:g}){const p=ie(),{isUnauthenticated:h}=ne();return h?null:t.jsx(je,{conversation:e,onOpenChange:d,inMainScreen:s,isActiveConversation:g,children:t.jsx("button",{className:"text-token-text-secondary hover:text-token-text-primary radix-state-open:text-token-text-secondary flex items-center justify-center transition","data-testid":f,"aria-label":p.formatMessage({id:"idEcXk",defaultMessage:"Open conversation options"}),children:t.jsx(Ie,{className:"icon-md"})})})}function Pe({conversation:e,className:d,hideOverflowMenu:f=!1,isActive:s,elementRef:g,testId:p}){const h=Y(),[E,b]=o.useState(!1),[x,O]=o.useState(!1),[n,R]=o.useState(!1),{value:I}=N("3922476776"),{value:u}=N("232791851"),G=le(e.id),{value:r=null,source:y=null}=G??{},H=J(e.id,Z.getRequestId),c=ee(H),F=de(new Date,new Date(e.update_time??0))<ue(ce.Standard),T=me(e.id),K=e.update_time&&fe(new Date(e.update_time),De),k=r===l.STREAMING&&F,V=u&&!s&&!c&&K&&!n&&r===l.UNREAD,j=u&&(c||k)&&!n,B=!n&&u&&!s,Q=!j&&u&&!s&&(c||k),X=ge(e.id)&&!s,S=o.useRef(!1);o.useEffect(()=>{S.current||I&&(async()=>(S.current=!0,s&&r===l.UNREAD&&(y===C.SERVER&&await z.setConversationStatus(e.id),U(e.id,null)),!s&&y===C.CLIENT&&r===l.UNREAD&&(await z.setConversationStatus(e.id,r),U(e.id,{value:l.UNREAD,source:C.SERVER})),S.current=!1))()},[I,s,e.id,r,y,c]),o.useEffect(()=>te(ke,{editTitle:({serverThreadId:a})=>{(a?a===e.id:s)&&b(!0)}}),[e.id,s]);const D=se(()=>e.conversation_template_id==null?void 0:Te(h)().data?.gizmos.find(i=>i.resource.gizmo.id===e.conversation_template_id)?.resource),v=o.useRef(null),w=o.useRef(null);return t.jsxs("div",{draggable:!E&&A(e.gizmo_id),onDragStart:a=>{if(!A(e.gizmo_id))return;const i=ae(w.current),m=v.current;m&&(m.style.display="none"),a.dataTransfer.setDragImage(i,i.clientWidth/3,i.clientHeight/2),m&&requestAnimationFrame(()=>{m.style.display=""}),a.dataTransfer.effectAllowed="move",pe({kind:"conversation",conversation:e,gizmoId:e.gizmo_id})},onDragEnd:()=>{he()},ref:w,style:{"--item-background-color":be(n,s,x)},className:_(xe,"screen-arch:bg-transparent relative",d),onMouseEnter:()=>{R(!0)},onMouseLeave:()=>{R(!1)},children:[X&&t.jsx(ye,{threadId:e.id}),t.jsx(P,{to:L(e.id,D),onClick:a=>{a.metaKey||a.ctrlKey||s||q(e.id)},onDoubleClick:()=>{b(!0)},ref:g,className:"motion-safe:group-active:screen-arch:scale-[98%] motion-safe:group-active:screen-arch:transition-transform motion-safe:group-active:screen-arch:duration-100 flex items-center gap-2 p-2",style:{maskImage:"var(--sidebar-mask)"},"data-history-item-link":!0,children:t.jsx(Se,{clientThreadId:e.id,historyConversationResponse:e,shouldShowLoadingShimmer:Q})}),E?t.jsx("div",{className:"bg-token-sidebar-surface-secondary absolute start-[7px] end-2 top-0 bottom-0 flex items-center",children:t.jsx(Ce,{conversationId:e.id,historyConversationResponse:e,onClose:()=>{b(!1)}})}):V?t.jsx(P,{to:L(e.id,D),onClick:a=>{a.metaKey||a.ctrlKey||s||q(e.id)},children:t.jsx("div",{className:"absolute top-0 bottom-0 flex items-center gap-1.5 pe-2 ltr:end-0 rtl:start-0",children:t.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-400"})})}):B&&T.length>0?t.jsx("div",{className:"absolute top-0 bottom-0 flex items-center gap-1.5 pe-2 ltr:end-0 rtl:start-0",children:t.jsx(Ee,{task:T[0]})}):j?t.jsx("div",{className:"absolute top-0 bottom-0 flex items-center gap-1.5 pe-2 ltr:end-0 rtl:start-0",children:t.jsx(Re,{size:16,className:"text-token-text-primary"})}):!f&&(n||x)&&t.jsx("div",{className:_("absolute top-0 bottom-0 inline-flex items-center gap-1.5 pe-2 ltr:end-0 rtl:start-0",s||x?"flex":"can-hover:group-hover:visible invisible"),ref:v,children:t.jsx(ve,{isActiveConversation:s,conversation:e,onOpenChange:a=>{O(a),a&&M.logEvent("Conversation History Item Open Menu",{conversationId:e.id})},testId:`${p}-options`})})]})}export{ve as G,Pe as H};
//# sourceMappingURL=b4wy8ndq94672kqa.js.map

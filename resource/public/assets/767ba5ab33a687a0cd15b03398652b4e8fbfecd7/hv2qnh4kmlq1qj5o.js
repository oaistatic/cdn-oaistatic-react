import{w as F,T as L,S as G,d as J,e as Q,t as _,N as D,f as X,F as m,g as E,h as y,i as z,j as Y,l as Z,c as ee,r as re,k as te}from"./msp412gwqdn605it.js";import{w as $,I as H,t as ne,H as oe}from"./fqps1a3pxo0q8nxi.js";import{dO as g,dR as x,pf as se,pg as I,ph as C,dQ as K,mW as U,pi as ie,pj as ae,pk as ue,pl as le,pm as de,pn as pe,po as ce,pp as me,pq as fe,pr as Me,dP as Ne,ps as he,pt as ke,pu as xe,pv as ge,pw as we,px as ye,py as be,pz as Se}from"./jn7p98x7qxquz26a.js";import{g0 as Ee,ga as Ie,D as Ce,p as Te}from"./j5zd9vs1l0bwsjqa.js";class Ae extends g{unistNodeName(){return"blockquote"}static proseMirrorNodeName(){return"blockquote"}proseMirrorNodeSpec(){return{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}}}proseMirrorInputRules(e){return[$(/^\s{0,3}>\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Mod->":F(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return x(this.proseMirrorNodeName(),e,r,t)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r}]}}function v(o){return/^\s*/.exec(o)?.[0]?.length??0}function P(o){return/\s*$/.exec(o)?.[0]?.length??0}function _e(o,e,r){for(;e>0;){const t=e-1;if(!o.rangeHasMark(t,e,r))break;e=t}return e}function De(o,e,r){for(;e<o.content.size&&o.rangeHasMark(e,e+1,r);)e+=1;return e}function $e(o,e,r,t=null){const{selection:n}=o;if(!(n instanceof L))return!1;let{empty:s,$cursor:i,ranges:l}=n;if(s&&!i||!se(o.doc,l,r,!0))return!1;if(i)r.isInSet(o.storedMarks||i.marks())?e(o.tr.removeStoredMark(r)):e(o.tr.addStoredMark(r.create(t)));else{let u=o.tr;const d=!l.some(a=>o.doc.rangeHasMark(a.$from.pos,a.$to.pos,r));for(let a=0;a<l.length;a++){let{$from:c,$to:f}=l[a],p=c.pos,M=f.pos;const N=o.doc.textBetween(p,M,`
`);if(/^\s*$/.test(N))continue;const w=c.nodeBefore?.text??"",k=c.nodeAfter?.text??"",T=f.nodeBefore?.text??"",q=f.nodeAfter?.text??"";if(d){let b=v(k),A=P(T);p+b<M&&(p+=b,M-=A),p=_e(o.doc,p,r),M=De(o.doc,M,r),u.removeMark(p,M,o.schema.marks[I.proseMirrorMarkName()]),u.addMark(p,M,r.create(t))}else{const b=P(w),A=v(q);p-=b,M+=A,u.removeMark(p,M,r)}}e(u.scrollIntoView())}return!0}function R(o,e=null){return(r,t)=>t?$e(r,t,o,e):!0}class h extends H{markType;constructor(e,r){super(e,(t,n,s,i)=>this.markHandler(t,n,s,i)),this.markType=r}static markApplies(e,r,t){for(const n of r){const{$from:s,$to:i}=n;let l=s.depth===0?e.type.allowsMarkType(t):!1;if(e.nodesBetween(s.pos,i.pos,u=>l?!1:(l=u.inlineContent&&u.type.allowsMarkType(t),!0)),l)return!0}return!1}markHandler(e,r,t,n){if(!(e.selection instanceof L))return null;const s=e.doc.resolve(t),i=e.doc.resolve(n),l=[new G(s,i)];if(!h.markApplies(e.doc,l,this.markType))return null;const u=e.doc.nodeAt(t)?.marks.map(a=>a.type)??[];u.push(this.markType);const d=e.tr.replaceWith(t,n,this.markType.schema.text(r[1]));for(const a of u)d.addMark(d.mapping.map(t),d.mapping.map(n),a.create(null));for(const a of u)d.removeStoredMark(a);return d.insertText(r[2])}}class Oe extends C{unistNodeName(){return"strong"}static proseMirrorMarkName(){return"strong"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM(){return["strong"]}}}proseMirrorInputRules(e){return[new h(/\*\*([^\s](?:.*[^\s])?)\*\*([\s\S])$/,e.marks[this.proseMirrorMarkName()]),new h(/__([^\s](?:.*[^\s])?)__([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Mod-b":R(r),"Mod-B":R(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return r.map(n=>n.mark(n.marks.concat([e.marks[this.proseMirrorMarkName()].create(t)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const W=92,ve=10,S="backslashEscape";function Pe(o,e,r){function t(n){return n==null||n===ve?(o.exit(S),e(n)):r(n)}return n=>n!==W?r(n):(o.enter(S),o.consume(n),t)}function Re(){return{text:{[W]:{name:S,tokenize:Pe}}}}function Be(){const o=this.data();o.micromarkExtensions??=[],o.micromarkExtensions.push(Re()),o.fromMarkdownExtensions??=[],o.fromMarkdownExtensions.push({enter:{[S](e){this.enter({type:"break"},e),this.exit(e)}}})}class Le extends g{unistNodeName(){return"break"}static proseMirrorNodeName(){return"hard_break"}proseMirrorNodeSpec(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],marks:I.proseMirrorMarkName(),toDOM(){return["br"]}}}proseMirrorKeymap(e){const r=J(Q,(n,s)=>(s&&s(n.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)),t=Ee()||Ie();return{"Mod-Enter":r,"Shift-Enter":r,...t&&{"Ctrl-Enter":r}}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return x(this.proseMirrorNodeName(),e,r,t)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}unifiedInitializationHook(e){return e.use(Be)}}const ze="code_block",B="```\n";function He(o,e){const{start:r,end:t}=o;return r==null||t==null?null:{start:r+B.length+(e.lang??"").length,end:t-B.length}}class Ke extends g{dependencies(){return[new K]}unistNodeName(){return"code"}static proseMirrorNodeName(){return ze}proseMirrorNodeSpec(){return{content:"text*",group:"block",code:!0,defining:!0,marks:[I.proseMirrorMarkName()].join(" "),attrs:{lang:{default:null},isDarkMode:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}}}proseMirrorInputRules(e){return[ne(/^\s{0,3}```$/,e.nodes[this.proseMirrorNodeName()])]}unistNodeToProseMirrorNodes({node:e,attrs:r,schema:t}){const{lang:n}=e;return x(this.proseMirrorNodeName(),t,U(e,t,{...r,...He(r,e)??{}}),{lang:n,...r})}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),value:r.map(t=>t.type==="startend"?t.children.map(n=>n.value).join(""):t.value).join(""),lang:e.attrs.lang}]}}class Ue extends g{unistNodeName(){return"thematicBreak"}static proseMirrorNodeName(){return"horizontal_rule"}proseMirrorNodeSpec(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}}}proseMirrorInputRules(e){return[new H(/^\s{0,3}(?:\*\*\*|---|___)\n$/,(r,t,n,s)=>r.tr.replaceWith(n,s,x(this.proseMirrorNodeName(),e,[])??[]))]}proseMirrorKeymap(e){return{"Mod-_":(r,t)=>(t&&t(r.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return x(this.proseMirrorNodeName(),e,r,t)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}}class We extends C{unistNodeName(){return"inlineCode"}static proseMirrorMarkName(){return"code"}proseMirrorMarkSpec(){return{inclusive:!1,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}proseMirrorInputRules(e){return[new h(/`([^\s](?:.*[^\s])?)`([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Ctrl-`":_(r)}}unistNodeToProseMirrorNodes({node:e,schema:r,attrs:t}){const n=U(e,r,t,[r.marks[this.proseMirrorMarkName()].create(t)]);return n?[n]:[]}processConvertedUnistNode(e){return{type:this.unistNodeName(),value:e.value}}}class Ve extends C{unistNodeName(){return"emphasis"}static proseMirrorMarkName(){return"em"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"&&null}],toDOM(){return["em"]}}}proseMirrorInputRules(e){try{return[new h(new RegExp("(?<!\\*)\\*([^\\s*](?:.*[^\\s])?)\\*([^*])$"),e.marks[this.proseMirrorMarkName()]),new h(new RegExp("(?<!_)_([^\\s_](?:.*[^\\s])?)_([^_])$"),e.marks[this.proseMirrorMarkName()])]}catch(r){return Ce.addError(r),[]}}proseMirrorKeymap(e){const r=e.marks[this.proseMirrorMarkName()];return{"Mod-i":_(r),"Mod-I":_(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return r.map(n=>n.mark(n.marks.concat([e.marks[this.proseMirrorMarkName()].create(t)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function V(o,e=null){return function(r,t){let{$from:n,$to:s}=r.selection,i=n.blockRange(s),l=!1,u=i;if(!i)return!1;if(i.depth>=2&&n.node(i.depth-1).type.compatibleContent(o)&&i.startIndex==0){if(n.index(i.depth-1)==0)return!1;let a=r.doc.resolve(i.start-2);u=new D(a,a,i.depth),i.endIndex<i.parent.childCount&&(i=new D(n,r.doc.resolve(s.end(i.depth)),i.depth)),l=!0}let d=X(u,o,e,i);return d?(t&&t(je(r.tr,i,d,l,o).scrollIntoView()),!0):!1}}function je(o,e,r,t,n){let s=m.empty;for(let a=r.length-1;a>=0;a--)s=m.from(r[a].type.create(r[a].attrs,s));o.step(new E(e.start-(t?2:0),e.end,e.start,e.end,new y(s,0,0),r.length,!0));let i=0;for(let a=0;a<r.length;a++)r[a].type==n&&(i=a+1);let l=r.length-i,u=e.start+r.length-(t?2:0),d=e.parent;for(let a=e.startIndex,c=e.endIndex,f=!0;a<c;a++,f=!1)!f&&z(o.doc,u,l)&&(o.split(u,l),u+=2*l),u+=d.child(a).nodeSize;return o}function qe(o,e){return function(r,t){let{$from:n,$to:s,node:i}=r.selection;if(i&&i.isBlock||n.depth<2||!n.sameParent(s))return!1;let l=n.node(-1);if(l.type!=o)return!1;if(n.parent.content.size==0&&n.node(-1).childCount==n.indexAfter(-1)){if(n.depth==3||n.node(-3).type!=o||n.index(-2)!=n.node(-2).childCount-1)return!1;if(t){let c=m.empty,f=n.index(-1)?1:n.index(-2)?2:3;for(let k=n.depth-f;k>=n.depth-3;k--)c=m.from(n.node(k).copy(c));let p=n.indexAfter(-1)<n.node(-2).childCount?1:n.indexAfter(-2)<n.node(-3).childCount?2:3;c=c.append(m.from(o.createAndFill()));let M=n.before(n.depth-(f-1)),N=r.tr.replace(M,n.after(-p),new y(c,4-f,0)),w=-1;N.doc.nodesBetween(M,N.doc.content.size,(k,T)=>{if(w>-1)return!1;k.isTextblock&&k.content.size==0&&(w=T+1)}),w>-1&&N.setSelection(Y.near(N.doc.resolve(w))),t(N.scrollIntoView())}return!0}let u=s.pos==n.end()?l.contentMatchAt(0).defaultType:null,d=r.tr.delete(n.pos,s.pos),a=u?[null,{type:u}]:void 0;return z(d.doc,n.pos,2,a)?(t&&t(d.split(n.pos,2,a).scrollIntoView()),!0):!1}}function Fe(o){return function(e,r){let{$from:t,$to:n}=e.selection,s=t.blockRange(n,i=>i.childCount>0&&i.firstChild.type==o);return s?r?t.node(s.depth-1).type==o?Ge(e,r,o,s):Je(e,r,s):!0:!1}}function Ge(o,e,r,t){let n=o.tr,s=t.end,i=t.$to.end(t.depth);s<i&&(n.step(new E(s-1,i,s,i,new y(m.from(r.create(null,t.parent.copy())),1,0),1,!0)),t=new D(n.doc.resolve(t.$from.pos),n.doc.resolve(i),t.depth));const l=Z(t);if(l==null)return!1;n.lift(t,l);let u=n.mapping.map(s,-1)-1;return ee(n.doc,u)&&n.join(u),e(n.scrollIntoView()),!0}function Je(o,e,r){let t=o.tr,n=r.parent;for(let p=r.end,M=r.endIndex-1,N=r.startIndex;M>N;M--)p-=n.child(M).nodeSize,t.delete(p-1,p+1);let s=t.doc.resolve(r.start),i=s.nodeAfter;if(t.mapping.map(r.end)!=r.start+s.nodeAfter.nodeSize)return!1;let l=r.startIndex==0,u=r.endIndex==n.childCount,d=s.node(-1),a=s.index(-1);if(!d.canReplace(a+(l?0:1),a+1,i.content.append(u?m.empty:m.from(n))))return!1;let c=s.pos,f=c+i.nodeSize;return t.step(new E(c-(l?1:0),f+(u?1:0),c+1,f-1,new y((l?m.empty:m.from(n.copy(m.empty))).append(u?m.empty:m.from(n.copy(m.empty))),l?0:1,u?0:1),l?0:1)),e(t.scrollIntoView()),!0}function Qe(o){return function(e,r){let{$from:t,$to:n}=e.selection,s=t.blockRange(n,d=>d.childCount>0&&d.firstChild.type==o);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let l=s.parent,u=l.child(i-1);if(u.type!=o)return!1;if(r){let d=u.lastChild&&u.lastChild.type==l.type,a=m.from(d?o.create():null),c=new y(m.from(o.create(null,m.from(l.type.create(null,a)))),d?3:1,0),f=s.start,p=s.end;r(e.tr.step(new E(f-(d?3:1),p,f,p,c,1,!0)).scrollIntoView())}return!0}}class O extends g{unistNodeName(){return"listItem"}static proseMirrorNodeName(){return"regular_list_item"}proseMirrorNodeSpec(){return{content:"paragraph block*",defining:!0,group:"list_item",parseDOM:[{tag:"li"}],toDOM(){return["li",0]}}}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&(!("checked"in e)||typeof e.checked!="boolean")}proseMirrorKeymap(e){const r=e.nodes[this.proseMirrorNodeName()];return{Enter:qe(r),"Shift-Tab":Fe(r),Tab:Qe(r)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r,attrs:t}){return x(this.proseMirrorNodeName(),e,r,t)}proseMirrorNodeToUnistNodes(e,r){return[{type:this.unistNodeName(),children:r}]}}class Xe extends g{dependencies(){return[new O]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered===!0}static proseMirrorNodeName(){return"ordered_list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1},startingNumber:{default:1}},parseDOM:[{getAttrs(e){const r=e.getAttribute("start");return{spread:e.getAttribute("data-spread")==="true",startingNumber:r!=null?parseInt(r):1}},tag:"ol"}],toDOM(e){return["ol",{"data-spread":e.attrs.spread,start:e.attrs.startingNumber},0]}}}proseMirrorInputRules(e){return[$(/^\s{0,3}(\d+)\.\s$/,e.nodes[this.proseMirrorNodeName()],r=>({startingNumber:+r[1]}),(r,t)=>t.childCount+t.attrs.startingNumber===+r[1])]}proseMirrorKeymap(e){return{"Shift-Mod-9":V(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:t,attrs:n}){const{spread:s,start:i}=e;return x(this.proseMirrorNodeName(),r,t,{...n,spread:s,startingNumber:i??1})}proseMirrorNodeToUnistNodes(e,r){const t=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!0,spread:t,start:e.attrs.startingNumber,children:r.map(n=>(n.spread=t,n))}]}}class Ye extends C{unistNodeName(){return"delete"}static proseMirrorMarkName(){return"strikethrough"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"s"},{tag:"del"},{style:"text-decoration",getAttrs:e=>/(^|[\s])line-through([\s]|$)/.test(e)&&null}],toDOM(){return["s"]}}}proseMirrorInputRules(e){return[new h(/~([^\s](?:.*[^\s~])?)~([^~])$/,e.marks[this.proseMirrorMarkName()]),new h(/~~([^\s](?:.*[^\s])?)~~([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}unistNodeToProseMirrorNodes({schema:e,convertedChildren:r}){return r.map(t=>t.mark(t.marks.concat([e.marks[this.proseMirrorMarkName()].create()])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}class Ze extends g{dependencies(){return[new O]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered!==!0}static proseMirrorNodeName(){return"list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{getAttrs(e){return{spread:e.getAttribute("data-spread")==="true"}},tag:"ul"}],toDOM(e){return["ul",{"data-spread":e.attrs.spread},0]}}}proseMirrorInputRules(e){return[$(/^\s{0,3}([-+*])\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Shift-Mod-8":V(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:r,convertedChildren:t,attrs:n}){const{spread:s}=e;return x(this.proseMirrorNodeName(),r,t,{...n,spread:s})}proseMirrorNodeToUnistNodes(e,r){const t=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!1,spread:t,children:r.map(n=>(n.spread=t,n))}]}}const j=[ie,ae,[ue,{singleDollarTextMath:!1}],le,de,re,pe,ce,me];class er extends fe{shouldStripDirectives=!1;constructor(e){super(),this.shouldStripDirectives=e}dependencies(){const e=te(Te());return[new Me,new Ne,new Ae,new Oe,new Le,new Ke,new oe,new Ue,new We,new he,new ke,new Ve,new xe,new O,new Xe,new ge,new K,new Ze,new Ye,new I,new we,new ye,new be,...e?[new Se]:[]]}unifiedInitializationHook(e){return e.use(j)}}const sr=Object.freeze(Object.defineProperty({__proto__:null,CANVAS_REMARK_PLUGINS:j,MarkdownExtension:er},Symbol.toStringTag,{value:"Module"}));export{Oe as B,ze as C,Ve as I,er as M,Ke as a,sr as p,$e as t};
//# sourceMappingURL=hv2qnh4kmlq1qj5o.js.map

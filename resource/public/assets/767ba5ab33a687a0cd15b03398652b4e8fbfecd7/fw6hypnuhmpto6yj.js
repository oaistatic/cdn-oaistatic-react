import{j as a,a9 as M,g as X,r as j,u as W}from"./j12so9ru57hpoz1y.js";import{T as Y,m as T}from"./gh4kfg6qlx7b3ikk.js";import{h9 as F,gO as U,c as z,ha as P,hb as I,hc as O,s as tt,C as et}from"./jn7p98x7qxquz26a.js";import{T as at,a as u,gI as ot,Q as st}from"./j5zd9vs1l0bwsjqa.js";import{u as _,c as nt,D as rt,d as lt}from"./fmw3vtt8y90emgda.js";import{C as L,T as dt}from"./f25vds35u27mdgai.js";import{S as ct}from"./n0vxyhm009m6qrw7.js";import{S as it}from"./eptu25h8ckzkjzj0.js";import{b as H}from"./01yrv2o49ye0ebr7.js";import{g as mt}from"./btagl6w1gub4aw61.js";import"./cx64odxk6g9mmfxk.js";const S=({label:t,Icon:e,isCanvasHovered:o=!1,onClick:l,isDisabled:r})=>a.jsx(at,{label:t,children:a.jsx(M.button,{disabled:r,onClick:f=>{f.stopPropagation(),l?.(f)},animate:{opacity:o?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:u("text-token-text-secondary hover:bg-token-surface-hover focus-visible:bg-token-surface-hover rounded-lg p-1 transition-colors focus-visible:outline-0",{"cursor-not-allowed":r}),children:a.jsx(e,{className:"icon-md"})})});var ft=F,xt=U,R=ot,ht=parseFloat,ut=Math.min,bt=Math.random;function gt(t,e,o){if(o&&typeof o!="boolean"&&xt(t,e,o)&&(e=o=void 0),o===void 0&&(typeof e=="boolean"?(o=e,e=void 0):typeof t=="boolean"&&(o=t,t=void 0)),t===void 0&&e===void 0?(t=0,e=1):(t=R(t),e===void 0?(e=t,t=0):e=R(e)),t>e){var l=t;t=e,e=l}if(o||t%1||e%1){var r=bt();return ut(t+r*(e-t+ht("1e-"+((r+"").length-1))),e)}return ft(t,e)}var pt=gt;const yt=X(pt),jt=({isCanvasHovered:t=!1,onClick:e})=>{const o=W();return a.jsx(S,{label:o.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),Icon:ct,onClick:e,isCanvasHovered:t})},vt=({textdocVersion:t,clientThreadId:e})=>{const{handleCopy:o,Icon:l,copyLabel:r}=lt({textdocVersion:t,clientThreadId:e});return a.jsx(S,{label:r,Icon:l,onClick:o})},kt=({isCodePreviewable:t,onClick:e,isDisabled:o})=>{const l=W();return a.jsx(S,{label:l.formatMessage(t?T.previewCode:T.runCode),Icon:it,onClick:e,isDisabled:o})},Ct=({isCanvasOpen:t,isFocused:e,isCanvasHovered:o,isInlinePreview:l,size:r})=>t?e?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":l?o||e?`0px ${r==="large"?12:4}px ${r==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${r==="large"?6:4}px ${r==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",Mt=({textdocId:t,clientThreadId:e,name:o,tag:l,icon:r,iconSelected:f,marginBottom:g,size:m="large",height:v=m==="large"?"22rem":"10rem",minHeight:b,isCanvasOpen:s=!1,isDisabled:x=!1,isFocused:d=!1,isInferring:p=!1,isInlinePreview:n=!1,isStreaming:c=!1,isUserMessage:h=!1,onClick:y,children:k})=>{const C=j.useRef(null),[i,E]=j.useState(!1),[$]=j.useState(()=>yt(100,180,!1)),N=st(z(t)?.versions),w=_(),{isCodePreviewable:A,isCodeExecutable:V,hasCanvasCodeExecution:D}=nt(N),G=c||!D,K=A||V,B=d&&s?f??r:r,Q=B?a.jsx("span",{className:u("shrink-0 transition-[filter]",{grayscale:!d&&!i}),children:B}):a.jsx("div",{className:"flex h-5 w-[18px] shrink-0 items-center overflow-hidden",children:a.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}),Z=!o||p?a.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:$},children:a.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}):a.jsx("span",{className:"min-w-0 truncate",children:o}),q=()=>{!C.current||x||(P.logButtonClick(I.MESSAGE_ATTACHMENT,{type:l}),O(C.current),y?.())},J=()=>{t&&tt({type:et.Textdoc,textdocId:t,shouldRunCodeOnOpen:!0})};return a.jsxs(M.div,{role:"button",id:mt(t),initial:{opacity:c?0:1,scale:c?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:u("popover bg-token-main-surface-primary relative z-0 flex flex-col overflow-hidden border transition-shadow duration-500 select-none",x?"cursor-default":"cursor-pointer",{"border-token-text-tertiary font-medium dark:border-gray-600":d&&s,"font-regular":!d,"border-token-border-default":!i&&!d,"border-token-border-medium":i&&!d,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!n,"rounded-2xl":!s&&n,"max-w-full":!h&&(s||!n),"max-w-[var(--user-chat-width,70%)]":h&&(s||!n),"w-full":!h&&!s&&n,"w-[var(--user-chat-width,70%)]":h&&!s&&n}),onMouseEnter:()=>!x&&E(!0),onMouseLeave:()=>E(!1),onClick:q,ref:C,style:{marginBottom:g,height:n&&!s?v:void 0,minHeight:n&&!s?b:void 0,width:m==="small"?"300px":void 0,boxShadow:Ct({isCanvasOpen:s,isFocused:d,isCanvasHovered:i,isInlinePreview:n,size:m})},children:[a.jsxs("div",{className:u("border-token-border-default flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!i&&!d,"border-token-border-medium":i&&!d,"text-token-text-primary text-sm font-medium":!s&&i&&n,"py-2":s||!n,"py-3":!s&&n,"text-token-text-secondary text-sm font-medium":!s&&!i&&n}),children:[a.jsxs("div",{className:u("flex min-w-0 items-center",{"gap-2":s||!n,"gap-3.5":!s&&n}),children:[Q,Z]}),s?a.jsx(M.span,{animate:c?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:c&&a.jsx(Y,{gap:1,padding:0})}):n&&!x?a.jsxs("div",{className:"flex gap-2",children:[w&&e&&a.jsx(vt,{clientThreadId:e,textdocVersion:N??null}),w&&K&&a.jsx(kt,{isCodePreviewable:A,onClick:J,isDisabled:G}),a.jsx(jt,{isCanvasHovered:i,onClick:y})]}):null]}),a.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&k,n&&!s&&a.jsx(L,{size:m,position:"bottom"}),n&&m==="small"&&!s&&a.jsx(L,{size:m,position:"right"})]})]})},_t=({textdocId:t,clientThreadId:e,name:o,tag:l,icon:r,iconSelected:f,isCanvasOpen:g=!1,isFetching:m=!1,isFocused:v=!1,isInlinePreview:b=!1,isStreaming:s=!1,isUserMessage:x=!1,onClick:d})=>{const[p,n]=j.useState(!1),c=_(),h=k=>{n(k>0)},y=b&&!g?16:12;return a.jsx(Mt,{textdocId:t,name:o,tag:l,icon:r,height:c?"auto":void 0,minHeight:c?"22rem":void 0,iconSelected:f,marginBottom:y,isCanvasOpen:g,isFocused:v,isInlinePreview:b,isStreaming:s,isUserMessage:x,onClick:d,clientThreadId:e,children:b&&a.jsx("div",{className:u("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":p,"border-transparent":!p}),children:m?a.jsx(rt,{}):!!t&&a.jsx(dt,{disableScroll:c,onScroll:h,textdocId:t,clientThreadId:e})})})};export{_t as CanvasMessageAttachment,Mt as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=fw6hypnuhmpto6yj.js.map

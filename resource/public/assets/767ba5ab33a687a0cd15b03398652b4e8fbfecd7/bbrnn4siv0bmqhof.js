import{d as E,L as g,b as f,fG as L,u as A,ao as O,H as m,I as S}from"./j5zd9vs1l0bwsjqa.js";import{G as T,f as b,r as i,j as C}from"./j12so9ru57hpoz1y.js";const _=E()(u=>({redirectRoutePostInstall:g.getItem(f.PluginsAuthRedirect),setRedirectRoutePostInstall:t=>{g.setItem(f.PluginsAuthRedirect,t),u({redirectRoutePostInstall:t})}})),I="chatgpt://oauth_complete",w=L(function(){const{pluginId:t,code:l,state:h,error:o,errorDesc:c}=T(),s=b(),p=i.useRef(!1),d=_(({redirectRoutePostInstall:a})=>a),n=_(({setRedirectRoutePostInstall:a})=>a);i.useEffect(()=>{if(p.current===!0)return;p.current=!0;async function a(){const P=`https://chat.openai.com/aip/${t}/oauth/callback`;try{const e=await O.pluginOauthCallback(t,l,P,h);if(e.success)if(e.redirect_path===I)window.location.href=I;else{const r=new URL(m(S.OAUTH_SUCCESS,d??e.redirect_path),location.origin);n&&n(null),r.searchParams.set("oauth_success","true"),s(r.pathname+r.search+r.hash)}else s(m(S.CUSTOM_ERROR,e.redirect_path,e.error??e.message))}catch{s({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:t,loginSuccess:"false"}).toString()})}}a()},[t,l,h,s,d,n]);const R=A();return i.useEffect(()=>{o&&R.danger(`${o}${c?`: ${c}`:""}`,{duration:5})},[o,c,R]),C.jsx("div",{})});export{w as default};
//# sourceMappingURL=bbrnn4siv0bmqhof.js.map

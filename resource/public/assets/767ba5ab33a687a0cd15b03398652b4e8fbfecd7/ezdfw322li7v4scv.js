import{r as z,u as _,j as i,d as q}from"./j12so9ru57hpoz1y.js";import{r as B,dh as G,q as P,di as k,a as h,cU as H,gB as $,bJ as V}from"./j5zd9vs1l0bwsjqa.js";import{f7 as W,fd as y,fe as D,ff as J,fg as K,fh as O,fi as Q,f4 as X,fj as Y,fk as Z}from"./jn7p98x7qxquz26a.js";function ee({asset:s,contextConnectorSourceUrl:u,isSingle:t,isUserTurn:m,className:l}){const n=B(),o=G(n).flags,[r,f]=z.useState(!1),{isUnauthenticated:e}=P(),a=o?.includes(k.NoAuthEnableFileUploads),I=W(s.asset_pointer),d=y.useState(b=>y.selectFile(b,I)),p=D(d?.file??null,d?.file.name,d?.fileId??void 0,d?.gizmoId,d?.contextConnectorInfo,!0),M=e&&d&&a,{gizmoEditorData:F}=J(),w=K(),C=O(m),j=_(),{data:T,isLoading:R,error:E}=Q({asset:s,gizmoId:F?.id,getServerUrl:!M}),{url:v,width:g,height:x}=p&&a?{width:s.width,height:s.height,url:p}:T??{},A=R||!r,U=g&&x?{Landscape:g>x,Portrait:g<x,Square:g===x}:void 0,c=["overflow-hidden rounded-lg"];if(t&&(c.push("w-full h-full"),U?.Landscape?c.push("max-w-96 max-h-64"):U?.Portrait?c.push("max-h-96 max-w-64"):c.push("max-w-64 max-h-64")),l&&c.unshift(l),C)return null;let S;return v!=null&&(S=i.jsx(X,{alt:j.formatMessage(L.imageAltText),className:h("max-w-full",!t&&"aspect-square","object-cover object-center",c),src:v,width:g,height:x,onLoad:()=>f(!0)}),w||(S=i.jsx(Y,{src:v,alt:j.formatMessage(L.imageAltText),contextConnectorSourceUrl:u,className:h(c),children:S}))),i.jsx("div",{className:h(c),children:i.jsx("div",{className:h("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!t&&"aspect-square"),children:v!=null?S:i.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${g} / ${x}`,width:g},title:A?j.formatMessage(L.loadingImage):j.formatMessage(L.errorLoadingImage),children:A?i.jsx(H,{}):E?i.jsx($,{className:"icon-sm"}):null})})})}const L=q({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function N({assets:s,attachments:u,isUserTurn:t=!0,clientThreadId:m}){const l=s.length===1,{containerClassname:n,imageClassnames:o}=N.computeClassnames(s.length);return i.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[i.jsx("div",{className:h("flex flex-row items-center justify-end gap-1",n),children:s.map((r,f)=>{const e=u?.find(a=>a.id&&r.asset_pointer.includes(a.id));return i.jsx(ee,{asset:r,isSingle:l,isUserTurn:t,contextConnectorSourceUrl:e?.context_connector_info?.source_url,className:o[f]},f)})}),i.jsx(Z,{featureType:V.ATTACHMENT,isUserTurn:t,clientThreadId:m})]})}N.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let u=s>=4?"flex-wrap":"";const t=Array(s),m=e=>{t.fill(e)},l=e=>{u+=` ${e}`},n=(e,a)=>{t[e]=h(t[e],a)},o=s<=4&&s%2===0?2:3,r=Math.ceil(s/o),f=s%o!==0;o===2?(m("h-32 w-32"),l("max-w-72")):r<=2?(m("h-24 w-24 sm:h-32 sm:w-32"),l("max-w-80 sm:max-w-100")):(m("h-16 w-16"),l("max-w-52"));for(let e=0;e<s;e++){const a=Math.floor(e/o),I=e%o,d=Math.min(s-a*o,o),p=a===0,M=a===r-1,F=a===r-2,w=I===0,C=I===d-1;p&&w&&n(e,"rounded-ss-2xl"),p&&C&&n(e,"rounded-se-2xl"),M&&w&&n(e,"rounded-es-2xl"),M&&C&&n(e,"rounded-ee-sm"),f&&w&&F&&n(e,"rounded-es-2xl")}return{containerClassname:u,imageClassnames:t}};export{N as TextMessageImageGroup};
//# sourceMappingURL=ezdfw322li7v4scv.js.map

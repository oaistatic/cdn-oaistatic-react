import{a7 as xt,j as O,r as u,u as bt}from"./j12so9ru57hpoz1y.js";import{e as M,S as T,D as k,E as S,d as P,A as Ve,T as z,F as Et,V as ce,P as de,g as _e,h as U,R as Pe,G as Ue,W as fe,t as kt,w as At,a as Se,x as St,y as wt,z as Bt,k as Lt,B as Dt,H as _,I as we,J as Mt,K as yt,L as vt}from"./epsg05et2lobrl6v.js";import{a as je,n as re,bT as Tt,u as Nt}from"./j5zd9vs1l0bwsjqa.js";import{oX as Rt,ha as We,oY as Ke,oZ as Gt,o_ as Ot,m$ as Ft,o$ as Ht,p0 as It,p1 as Vt,p2 as _t,bp as Pt,bq as Ut,dD as jt,p3 as Wt,p4 as Kt,p5 as $t,p6 as qt,p7 as zt,p8 as Be,nA as Yt,hC as Jt}from"./jn7p98x7qxquz26a.js";import{u as Xt,v as Zt,w as Qt,x as en,y as tn,z as nn,A as on,B as rn,C as sn,E as an,F as ln,G as cn,H as dn,J as fn,K as un,M as gn,O as mn,Q as hn,R as te}from"./ke2u5pwt169srvv9.js";const se=M.define(),$e=T.define({create:()=>null,update:(e,t)=>{const n=t.effects.find(o=>o.is(se));return n?n.value:e}}),pn=e=>k.line({class:"bg-[Highlight]!"}).range(e),Cn=e=>k.line({class:"streaming-line-overlay before:content-['*'] before:bg-white/50 dark:before:bg-gray-750/50"}).range(e),xn=T.define({create:()=>k.none,update:(e,t)=>{e=e.map(t.changes);const n=t.state.field($e);if(n==null)return k.none;const o=t.state.doc,r=n+1;if(r>o.lines)return k.none;const s=o.line(r),i=pn(s.from),a=Array.from({length:o.lines-r},(d,c)=>Cn(o.line(r+1+c).from));return k.set([i,...a])},provide:e=>S.decorations.from(e)}),bn=e=>[$e.init(()=>e),xn],qe=M.define(),ze=M.define(),Ye=M.define(),Je=M.define(),ie=(e,t)=>e.doc.line(t).from,K=(e,t,n,o)=>{const r=ie(t,n),s=k.line({attributes:{class:je("transition-colors bg-transparent",o===1&&"bg-yellow-100 dark:bg-yellow-500/50")}}).range(ie(t,n));return e.update({add:o===3?[]:[s],filter:i=>i!==r})},En=T.define({create(){return k.none},update(e,t){for(let n of t.effects){const{value:o}=n;if(n.is(qe))return K(e,t.state,o,0);if(n.is(ze))return K(e,t.state,o,1);if(n.is(Ye))return K(e,t.state,o,2);if(n.is(Je))return K(e,t.state,o,3)}return e.map(t.changes)},provide:e=>S.decorations.from(e)}),kn=[En];function An(e,t,n=500){e.dispatch({effects:qe.of(t)});const o=ie(e.state,t);e.dispatch({selection:{anchor:o,head:o},scrollIntoView:!0}),requestAnimationFrame(()=>{e.dispatch({effects:ze.of(t)})}),setTimeout(()=>{e.dispatch({effects:Ye.of(t)}),setTimeout(()=>{e.dispatch({effects:Je.of(t)})},150)},n),e.focus()}function Sn(e){return e.toString().length}function wn(e,t,n){return o=>{if(!o.docChanged)return o;const r=Sn(o.state.doc);if(r<=e)return o;n&&t&&Rt(n,t);const s=o.state.doc.sliceString(0,e),i=o.startState.update({changes:{from:0,to:o.startState.doc.length,insert:s}});return We.logEvent("Canvas Codemirror Max Length",{maxLength:e,newLength:r}),[i]}}function Bn(e,t,n){return[P.transactionFilter.of(wn(n,e,t))]}const Xe=Ve.define();function Ln(){return S.updateListener.of(e=>{if(!e.docChanged||e.state.readOnly)return;const t=e.state.doc;t.length>0&&t.sliceString(t.length-1)!==`
`&&e.view.dispatch({changes:{from:t.length,to:t.length,insert:`
`},annotations:Xe.of(!0)})})}function Dn(e){const{start:t,end:n}=e.positionBefore,{start:o,end:r}=e.positionAfter;return new Gt(t,n,o,r)}class j{constructor(t,n,o,r,s){this.changes=t,this.fromA=n,this.toA=o,this.fromB=r,this.toB=s}offset(t,n){return t||n?new j(this.changes,this.fromA+t,this.toA+t,this.fromB+n,this.toB+n):this}get endA(){return Math.max(this.fromA,this.toA)}get endB(){return Math.max(this.fromB,this.toB)}static buildFromTextdocDiff(t){const o=t.edits.map(Dn);return o.sort((s,i)=>s.fromA-i.fromA),ae(o,z.of(t.contentBefore.split(`
`)),z.of(t.contentAfter.split(`
`)),0,0)}static build(t,n,o){const r=Ke(t.toString(),n.toString(),o);return ae(r,t,n,0,0)}static updateA(t,n,o,r,s){return ve(ye(t,r,!0,o.length),t,n,o,s)}static updateB(t,n,o,r,s){return ve(ye(t,r,!1,n.length),t,n,o,s)}}function Le(e,t,n,o){let r=n.lineAt(e),s=o.lineAt(t);return r.to==e&&s.to==t&&e<n.length&&t<o.length?[e+1,t+1]:[r.from,s.from]}function De(e,t,n,o){let r=n.lineAt(e),s=o.lineAt(t);return r.from==e&&s.from==t?[e,t]:[r.to+1,s.to+1]}function ae(e,t,n,o,r){let s=[];for(let i=0;i<e.length;i++){let a=e[i],[d,c]=Le(a.fromA+o,a.fromB+r,t,n),[l,f]=De(a.toA+o,a.toB+r,t,n),g=[a.offset(-d+o,-c+r)];for(;i<e.length-1;){let C=e[i+1],[p,E]=Le(C.fromA+o,C.fromB+r,t,n);if(p>l+1&&E>f+1)break;g.push(C.offset(-d+o,-c+r)),[l,f]=De(C.toA+o,C.toB+r,t,n),i++}s.push(new j(g,d,Math.max(d,l),c,Math.max(c,f)))}return s}const $=1e3;function Me(e,t,n,o){let r=0,s=e.length;for(;;){if(r==s){let l=0,f=0;r&&({toA:l,toB:f}=e[r-1]);let g=t-(n?l:f);return[l+g,f+g]}let i=r+s>>1,a=e[i],[d,c]=n?[a.fromA,a.toA]:[a.fromB,a.toB];if(d>t)s=i;else if(c<=t)r=i+1;else return o?[a.fromA,a.fromB]:[a.toA,a.toB]}}function ye(e,t,n,o){let r=[];return t.iterChangedRanges((s,i,a,d)=>{let c=0,l=n?t.length:o,f=0,g=n?o:t.length;s>$&&([c,f]=Me(e,s-$,n,!0)),i<t.length-$&&([l,g]=Me(e,i+$,n,!1));let C=d-a-(i-s),p,[E,h]=n?[C,0]:[0,C];r.length&&(p=r[r.length-1]).toA>=c?r[r.length-1]={fromA:p.fromA,fromB:p.fromB,toA:l,toB:g,diffA:p.diffA+E,diffB:p.diffB+h}:r.push({fromA:c,toA:l,fromB:f,toB:g,diffA:E,diffB:h})}),r}function ve(e,t,n,o,r){if(!e.length)return t;let s=[];for(let i=0,a=0,d=0,c=0;;i++){let l=i==e.length?null:e[i],f=l?l.fromA+a:n.length,g=l?l.fromB+d:o.length;for(;c<t.length;){let h=t[c];if(h.toA+a>f||h.toB+d>g)break;s.push(h.offset(a,d)),c++}if(!l)break;let C=l.toA+a+l.diffA,p=l.toB+d+l.diffB,E=Ke(n.sliceString(f,C),o.sliceString(g,p),r);for(let h of ae(E,n,o,f,g))s.push(h);for(a+=l.diffA,d+=l.diffB;c<t.length;){let h=t[c];if(h.fromA+a>C&&h.fromB+d>p)break;c++}}return s}const F=Et.define({combine:e=>e[0]}),Ze=M.define(),D=T.define({create(){return null},update(e,t){for(let n of t.effects)n.is(Ze)&&(e=n.value);return e}}),ue=ce.fromClass(class{deco;gutter;constructor(e){({deco:this.deco,gutter:this.gutter}=Re(e))}update(e){(e.docChanged||e.viewportChanged||Mn(e.startState,e.state)||yn(e.startState,e.state))&&({deco:this.deco,gutter:this.gutter}=Re(e.view))}},{decorations:e=>e.deco});de.low(_e({class:"cm-changeGutter",markers:e=>e.plugin(ue)?.gutter||Pe.empty}));function Mn(e,t){return e.field(D,!1)!=t.field(D,!1)}function yn(e,t){return e.facet(F)!=t.facet(F)}const Te=k.line({class:`cm-changedLine ${Ot}`}),vn=k.mark({class:"cm-changedText"}),Tn=k.mark({tagName:"ins",class:"cm-insertedLine"}),Nn=k.mark({tagName:"del",class:"cm-deletedLine"}),Ne=new class extends Ue{elementClass="cm-changedLineGutter"};function Rn(e,t,n,o,r,s){let i=n?e.fromA:e.fromB,a=n?e.toA:e.toB,d=0;if(i!=a){r.add(i,i,Te),r.add(i,a,n?Nn:Tn),s&&s.add(i,i,Ne);for(let c=t.iterRange(i,a-1),l=i;!c.next().done;){if(c.lineBreak){l++,r.add(l,l,Te),s&&s.add(l,l,Ne);continue}let f=l+c.value.length;if(o)for(;d<e.changes.length;){let g=e.changes[d],C=i+(n?g.fromA:g.fromB),p=i+(n?g.toA:g.toB),E=Math.max(l,C),h=Math.min(f,p);if(E<h&&r.add(E,h,vn),p<f)d++;else break}l=f}}}function Re(e){let t=e.state.field(D),{side:n,highlightChanges:o,markGutter:r}=e.state.facet(F),s=n=="a",i=new U,a=r?new U:null,{from:d,to:c}=e.viewport;for(let l of t){if((s?l.fromA:l.fromB)>=c)break;(s?l.toA:l.toB)>d&&Rn(l,e.state.doc,s,o,i,a)}return{deco:i.finish(),gutter:a&&a.finish()}}const Gn=M.define({map:(e,t)=>e.map(t)});T.define({create:()=>k.none,update:(e,t)=>{for(let n of t.effects)if(n.is(Gn))return n.value;return e.map(t.changes)},provide:e=>S.decorations.from(e)});const le=M.define({map:(e,t)=>t.mapPos(e)});class On extends fe{constructor(t){super(),this.lines=t}eq(t){return this.lines==t.lines}toDOM(t){let n=document.createElement("div");return n.className="cm-collapsedLines",n.textContent="⦚ "+t.state.phrase("$ unchanged lines",this.lines)+" ⦚",n.addEventListener("click",o=>{let r=t.posAtDOM(o.target);t.dispatch({effects:le.of(r)});let{side:s,sibling:i}=t.state.facet(F);i&&i().dispatch({effects:le.of(Fn(r,t.state.field(D),s=="a"))})}),n}ignoreEvent(t){return t instanceof MouseEvent}get estimatedHeight(){return 27}}function Fn(e,t,n){let o=0,r=0;for(let s=0;;s++){let i=s<t.length?t[s]:null;if(!i||(n?i.fromA:i.fromB)>=e)return r+(e-o);[o,r]=n?[i.toA,i.toB]:[i.toB,i.toA]}}const Hn=T.define({create(){return k.none},update(e,t){e=e.map(t.changes);for(let n of t.effects)n.is(le)&&(e=e.update({filter:o=>o!=n.value}));return e},provide:e=>S.decorations.from(e)});function In({margin:e=3,minSize:t=4}){return Hn.init(n=>Vn(n,e,t))}function Vn(e,t,n){let o=new U,r=e.facet(F).side=="a",s=e.field(D),i=1;for(let a=0;;a++){let d=a<s.length?s[a]:null,c=a?i+t:1,l=d?e.doc.lineAt(r?d.fromA:d.fromB).number-1-t:e.doc.lines,f=l-c+1;if(f>=n&&o.add(e.doc.line(c).from,e.doc.line(l).to,k.replace({widget:new On(f),block:!0})),!d)break;i=e.doc.lineAt(Math.min(e.doc.length,r?d.toA:d.toB)).number}return o.finish()}S.styleModule.of(new Ft({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}}));const _n=S.baseTheme({".cm-mergeView & .cm-scroller, .cm-mergeView &":{height:"auto !important",overflowY:"visible !important"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},".cm-insertedLine, .cm-deletedLine":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),ne="unknown",Pn=new class extends Ue{elementClass="cm-deletedLineGutter"},Un=de.low(_e({class:"cm-changeGutter",markers:e=>e.plugin(ue)?.gutter||Pe.empty,widgetMarker:(e,t)=>t instanceof et?Pn:null}));function jn(e){let t=z.of(e.textdocDiff.contentBefore.split(`
`));return[de.low(ue),qn(e.language),_n,S.editorAttributes.of({class:"cm-merge-b"}),F.of({highlightChanges:e.highlightChanges!==!1,markGutter:e.gutter!==!1,syntaxHighlightDeletions:e.syntaxHighlightDeletions!==!1,mergeControls:e.mergeControls!==!1,side:"b"}),Y.init(()=>t),e.gutter!==!1?Un:[],e.collapseUnchanged?In(e.collapseUnchanged):[],D.init(()=>j.buildFromTextdocDiff(e.textdocDiff))]}const Qe=M.define(),Y=T.define({create:()=>z.empty,update(e,t){for(let n of t.effects)n.is(Qe)&&(e=n.value.doc);return e}}),V=new WeakMap;class et extends fe{constructor(t){super(),this.buildDOM=t}dom=null;eq(t){return this.dom==t.dom}toDOM(t){return this.dom||(this.dom=this.buildDOM(t))}}function Wn(e,t,n){if(V.has(t.changes)){const s=re(V.get(t.changes)).get(n?.name??ne);if(s)return s}let o=s=>{let{highlightChanges:i,syntaxHighlightDeletions:a,mergeControls:d}=e.facet(F),c=s.state.field(Y).sliceString(t.fromA,t.endA),l=document.createElement("div");if(l.className=`cm-deletedChunk ${Ht}`,d){let h=l.appendChild(document.createElement("div"));h.className="cm-chunkButtons";let w=h.appendChild(document.createElement("button"));w.name="accept",w.textContent=e.phrase("Accept"),w.onmousedown=B=>{B.preventDefault(),Kn(s,s.posAtDOM(l))};let A=h.appendChild(document.createElement("button"));A.name="reject",A.textContent=e.phrase("Reject"),A.onmousedown=B=>{B.preventDefault(),$n(s,s.posAtDOM(l))}}let f=l.appendChild(document.createElement("del")),g=t.changes,C=0,p=!1;function E(h,w,A){for(let B=h;B<w;){let L=w,m=A+(p?" cm-deletedText":""),y=!1;if(i&&C<g.length){let N=Math.max(0,p?g[C].toA:g[C].fromA);N<=L&&(L=N,p&&C++,y=!0)}if(L>B){let N=document.createTextNode(c.slice(B,L));if(m){let H=f.appendChild(document.createElement("span"));H.className=m,H.appendChild(N)}else f.appendChild(N)}B=L,y&&(p=!p)}}if(a&&n){let h=n.parser.parse(c),w=0;Xt(h,{style:A=>Zt(e,A)},(A,B,L)=>{A>w&&E(w,A,""),E(A,B,L),w=B}),E(w,c.length,"")}else E(0,c.length,"");return l},r=k.widget({block:!0,side:-1,widget:new et(o)});return V.has(t.changes)?re(V.get(t.changes)).set(n?.name??ne,r):V.set(t.changes,new Map([[n?.name??ne,r]])),r}function Kn(e,t){let{state:n}=e,o=t??n.selection.main.head,r=e.state.field(D).find(d=>d.fromB<=o&&d.endB>=o);if(!r)return!1;let s=e.state.sliceDoc(r.fromB,Math.max(r.fromB,r.toB-1)),i=e.state.field(Y);r.fromB!=r.toB&&r.toA<=i.length&&(s+=e.state.lineBreak);let a=kt.of({from:r.fromA,to:Math.min(i.length,r.toA),insert:s},i.length);return e.dispatch({effects:Qe.of({doc:a.apply(i),changes:a}),userEvent:"accept"}),!0}function $n(e,t){let{state:n}=e,o=t??n.selection.main.head,r=n.field(D).find(a=>a.fromB<=o&&a.endB>=o);if(!r)return!1;let i=n.field(Y).sliceString(r.fromA,Math.max(r.fromA,r.toA-1));return r.fromA!=r.toA&&r.toB<=n.doc.length&&(i+=n.lineBreak),e.dispatch({changes:{from:r.fromB,to:Math.min(n.doc.length,r.toB),insert:i},userEvent:"revert"}),!0}function Ge(e,t){let n=new U;for(let o of e.field(D))n.add(o.fromB,o.fromB,Wn(e,o,t));return n.finish()}const qn=e=>T.define({create:t=>Ge(t,e),update(t,n){return n.state.field(D,!1)!=n.startState.field(D,!1)?Ge(n.state,e):t},provide:t=>S.decorations.from(t)}),tt=M.define(),q=T.define({create:()=>{},update(e,t){for(let n of t.effects)if(n.is(tt))return n.value;return e}});class zn extends fe{toDOM(){const t=document.createElement("span");return t.className=Vt.modelCursor,t}}const Yn=ce.fromClass(class{decorations;constructor(e){this.decorations=this.buildDecorations(e)}update(e){(e.docChanged||e.viewportChanged||e.state.field(q)!==e.startState.field(q))&&(this.decorations=this.buildDecorations(e.view))}buildDecorations(e){const t=new U,n=e.state.field(q);if(!n)return k.none;const{doc:o}=e.state,{modelCursorPosition:r,modelSelectionPositionRange:s}=n;if(r!=null)r>=0&&r<=o.length&&t.add(r,r,k.widget({widget:new zn,side:1}));else if(s!=null){const{start:i,end:a}=s;i>=0&&a<=o.length&&i<a&&t.add(i,a,k.mark({class:`${It} bg-[Highlight]!`}))}return t.finish()}},{decorations:e=>e.decorations}),Jn=e=>[q.init(()=>e),Yn],J=M.define(),ge=T.define({create(){return null},update(e,t){for(const n of t.effects)if(n.is(J))return n.value;return e}});function nt(e,t){const{selectionStart:n,selectionEnd:o}=t,[r,s]=n.from>o.from?[o.from,n.to]:[n.from,o.to];e.dispatch({selection:Se.create([Se.range(r,s)]),effects:J.of(t)})}function Xn(e,t){nt(e,{selectionStart:t,selectionEnd:t}),e.focus();const o=()=>{e.dispatch({effects:J.of(null)}),window.removeEventListener("mouseup",o)};return window.addEventListener("mouseup",o),!0}function Zn(e,t){const n=e.state.field(ge);if(n){const o={...n,selectionEnd:t};nt(e,o)}return!0}const Qn=ce.fromClass(class{constructor(e){this.view=e,this.updateCursor()}update(e){e.transactions.some(t=>t.effects.some(n=>n.is(J)))&&this.updateCursor()}updateCursor(){this.view.state.field(ge)?this.view.dom.classList.add("cm-line-number-dragging"):this.view.dom.classList.remove("cm-line-number-dragging")}}),eo=S.theme({".cm-gutters":{cursor:"default"},"&.cm-line-number-dragging .cm-gutters":{cursor:"text"}});function to(){return[ge,Qn,eo,At({domEventHandlers:{mousedown:Xn,mousemove:Zn}})]}const Oe=Ve.define();function ot(e,t){return e==null?[]:jn({highlightChanges:!1,gutter:!1,syntaxHighlightDeletions:!0,mergeControls:!1,language:t,textdocDiff:e})}function oe(e,t,n){const o=e.reconfigure(ot(t,n??null));if(t==null)return[o];const r=j.buildFromTextdocDiff(t);return[o,Ze.of(r)]}const no=({currentlyStreamingLineIndex:e,value:t,textdocDiff:n,placeholderContent:o,languageCompartment:r,languageCompartmentInit:s,editableCompartment:i,readOnlyCompartment:a,editableInit:d,handleChange:c,handleBlur:l,handleSave:f,extensionsProp:g,editorTheme:C,comments:p,maxLength:E=_t,intl:h,toaster:w,modelCursor:A,unifiedMergeViewCompartment:B})=>{const L=[St(o),Bn(h,w,E),Qt(),r.of(s??[]),i.of([S.editable.of(d)]),a.of([P.readOnly.of(!d)]),wt(),P.allowMultipleSelections.of(!0),en(),tn(nn,{fallback:!0}),on(),to(),Bt(),rn({markerDOM:m=>{const y=document.createElement("span"),N=xt.createRoot(y),H=m?O.jsx(Pt,{className:"icon-sm text-token-text-tertiary"}):O.jsx(Ut,{className:"icon-sm text-token-text-tertiary"});return N.render(H),y}}),Jn(A),B.of(ot(n,s?.language??null)),...g??[],...kn,Lt.of([...sn,...an,...ln,...cn,...dn,fn]),un(),C,Dt(p),Ln(),bn(e??null),S.updateListener.of(c),S.domEventHandlers({blur:l,keydown(m){(m.key==="s"||m.key==="S")&&m.metaKey&&f?.()},paste(m){const y=m.clipboardData?.getData("text/plain");y!=null&&We.logEvent("Canvas Codemirror Paste",{textLength:y.length})}})];return P.create({doc:t,extensions:L})};function oo({state:e,parent:t,onUpdateState:n}){const o=(r,s)=>{s.update(r);const i=s.state;n(i)};return new S({state:e,parent:t,dispatchTransactions:o})}const ro=gn({settings:{background:"var(--main-surface-primary)"}}),so=mn({theme:"light"}),Fe=S.theme({".cm-tooltip-autocomplete":{backgroundColor:"var(--main-surface-primary)",color:"var(--text-primary)",border:"1px solid var(--border-light)",borderRadius:"6px",padding:"4px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)"},".cm-tooltip-autocomplete > ul > li":{borderRadius:"5px",color:"var(--text-primary)"},".cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"var(--main-surface-secondary)",color:"var(--text-primary)"},".cm-tooltip-autocomplete > ul > li:hover":{backgroundColor:"var(--selection)",color:"#ffffff"},".cm-completionMatchedText":{textDecoration:"none",fontWeight:"700"}}),He=S.theme({".cm-scroller":{fontFamily:"ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace !important"}}),Ie=e=>e?[He,ro,Fe]:[He,so,Fe],io=e=>{const[t]=u.useState(()=>new _),n=Tt();u.useEffect(()=>{e.current?.dispatch({effects:t.reconfigure(Ie(n))})},[n,t,e]);const[o]=u.useState(()=>t.of(Ie(n)));return o},rt=({id:e,children:t,comments:n,commentingOn:o,currentlyStreamingLineIndex:r,hoveredCommentId:s,focusedCommentId:i,placeholder:a="",readonlyReason:d,language:c,value:l,textdocDiff:f,extensions:g,onBlur:C,onSave:p,onChange:E,editorRef:h,width:w,modelCursor:A,isPreview:B})=>{const L=u.useRef(null),m=u.useRef(null),y=bt(),N=Nt(),[H,me]=u.useState(null),X=u.useRef(null),[{width:at},lt]=jt(),[I]=u.useState(()=>new _),[Z]=u.useState(()=>new _),[Q]=u.useState(()=>new _),[R]=u.useState(()=>new _),he=u.useRef(E);he.current=E;const ct=u.useCallback(({docChanged:x,state:b,transactions:G})=>{for(const v of G)if(v.annotation(Oe)===!0||v.annotation(Xe)===!0)return;if(b.doc.sliceString(b.doc.length-1)===`
`&&x){const v=b.doc.toString();X.current=v,he.current?.(b)}},[]),pe=u.useRef(C);pe.current=C;const dt=u.useCallback(()=>pe.current?.(),[]),Ce=u.useRef(p);Ce.current=p;const ft=u.useCallback(()=>Ce.current?.(),[]),ut=async x=>x?await hn(x):null,xe=u.useCallback(async x=>{const b=await ut(x);b&&m.current?.dispatch({effects:[I.reconfigure(b),...oe(R,f,b?.language)]})},[I,R]),gt=io(m),mt=u.useCallback(x=>{if(x===X.current){X.current=null;return}const{current:b}=m;if(!b)return;const G=b.state.doc;let v;const ke=G.toString(),Ae=Wt(ke,0,ke.length,x,0,x.length),pt=x.slice(Ae);v={from:Ae,to:G.length,insert:pt};const ee=c!=null?te(c):null,Ct=b.state.update({changes:v,effects:[we.of(n??[]),se.of(r??null),...ee!=null?[I.reconfigure(ee)]:[],...oe(R,f,ee?.language)],annotations:Oe.of(!0)});b.update([Ct])},[n,r,c,I,f,R]);u.useImperativeHandle(h,()=>({UNSAFE_setValue:mt,codeViewRef:m,highlightLine:(x,b)=>An(re(m.current),x,b)})),u.useEffect(()=>{xe(c)},[c,xe]),u.useEffect(()=>{const x=c==null?null:te(c);m.current?.dispatch({effects:oe(R,f,x?.language)})},[R,f]);const W=d?.isReadonly===!0;u.useEffect(()=>{m.current?.dispatch({effects:[Z.reconfigure(S.editable.of(!W)),Q.reconfigure(P.readOnly.of(W))]})},[W,Z,Q]),u.useEffect(()=>{(o==null||Kt(o))&&m.current?.dispatch({effects:Mt.of(o??null)})},[o]),u.useEffect(()=>{m.current?.dispatch({effects:we.of(n??[])})},[n]),u.useEffect(()=>{m.current?.dispatch({effects:yt.of(s)})},[s]),u.useEffect(()=>{m.current?.dispatch({effects:vt.of(i)})},[i]),u.useEffect(()=>{m.current?.dispatch({effects:tt.of(A)})},[A]),u.useEffect(()=>{m.current?.dispatch({effects:se.of(r??null)})},[r]),u.useEffect(()=>{const x=L.current;if(x==null)return;const b=c==null?null:te(c),G=no({currentlyStreamingLineIndex:r,value:l,placeholderContent:a,editableCompartment:Z,readOnlyCompartment:Q,editableInit:!W,languageCompartment:I,languageCompartmentInit:b??null,handleChange:ct,handleBlur:dt,handleSave:ft,extensionsProp:g,editorTheme:gt,intl:y,toaster:N,comments:n??[],modelCursor:A,textdocDiff:f,unifiedMergeViewCompartment:R});me(G);const v=oo({state:G,parent:x,onUpdateState:me});return m.current=v,()=>{v.destroy()}},[e,g,a]);const ht=u.useCallback(()=>m.current,[m]),be=[],Ee=[];return u.Children.forEach(t,x=>{if(!u.isValidElement(x))return;const{type:b}=x;if(b===it)be.push(x);else if(b===st)Ee.push(x);else throw new Error("Invalid Codemirror child: "+JSON.stringify(b))}),O.jsx($t.Provider,{value:ht,children:O.jsx(qt.Provider,{value:H,children:O.jsxs(zt.Provider,{value:at,children:[O.jsxs("div",{className:"relative z-0 flex h-full max-w-full",children:[O.jsx("div",{id:e,className:je(Be.codemirror,B&&Be.preview,Yt.composer,"flex h-full w-full flex-col items-stretch"),ref:Jt(L,lt),style:{width:w}}),Ee]}),be]})})})},st=({children:e})=>e,it=({children:e})=>e;rt.EditorChildren=st;rt.ContextChildren=it;export{rt as C};
//# sourceMappingURL=jgfehaz03xkmntxn.js.map

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dxwj7d3qxjns67z0.js","assets/cg166fqqcxkeiosv.js","assets/j4xe1fdohr6xk09p.js","assets/dze2l9y9kn6nwat0.js","assets/root-fk1yg8gm.css","assets/conversation-small-ga20ijz2.css","assets/g37gu5xs2utemlog.js","assets/a18jwh9lzr2ddmbd.js","assets/kb3phtht4s5rhb60.js"])))=>i.map(i=>d[i]);
import{a as Ce,r as f,v as je,j as e,M as m,c as Re,R as _e}from"./cg166fqqcxkeiosv.js";import{fp as be,al as me,r as Ee,q,gg as Se,m as re,M as Pe,bl as fe,bm as xe,aC as S,aB as ke,Q as De,eF as we,ab as Fe,S as ie,c3 as le,bT as ce,h as he,T as Le,a as G,gu as Ae,d as z,bB as Ne,b8 as Oe,gv as He,gw as Ve,D as Ie,gx as Be,gy as Qe,gz as qe,ad as Ge,gA as Ue,n as We}from"./dze2l9y9kn6nwat0.js";import{h9 as Ye,h3 as ze,a5 as de,cn as Ke,ha as F,hb as Ze,hc as $e,hd as Je,he as Xe,hf as et,a6 as tt,hg as Z,eb as ge,hh as st,cz as K,dB as at,hi as nt,hj as ot,hk as rt,hl as it,hm as lt,hn as ct,ho as U,hp as W,hq as dt,hr as gt,hs as ut,c2 as mt,ht as ft,hu as xt,hv as ht,hw as pt,hx as yt,dK as Y,hy as Mt}from"./j4xe1fdohr6xk09p.js";import{a as vt,g as Tt}from"./gzm2pyuieq14d2cd.js";function Ct({clientThreadId:t,conversationMode:o}){const c=Ye(t),r=Ce(),a=be(),s=vt(),{data:d}=ze(),{data:g}=me(),n=f.useCallback(p=>{if(!p)return[];const u=de(g?.models,p),i=Tt({modelConfig:u,systemHints:d??[]}).map(y=>y.systemHint);return Array.from(s).filter(y=>i.includes(y))},[s,g?.models,d]);return({id:p,eventSource:u,requestedModelId:i,systemMessage:y,systemMessageMetadata:T,extraStreamParams:l})=>{const P=Ee.getTree(q(t)).getConversationTurns(p,!1),_=P?.[P?.length-1].variantIds?.length===1&&l?.forceUseSearch===void 0,A=Se(r,a),N=q(t),k=de(A?.models,N?.modelId),D=n(i),{systemHints:b,extraStreamParams:L}=Ke(D);c({id:p,requestedModelId:i,eventSource:u,variantPurpose:_?"comparison_implicit":"none",conversationMode:o??q(t)?.mode,appendMessages:y?[{id:je(),author:{role:k?.tags.includes("o1")?re.Developer:re.System},content:{content_type:Pe.Text,parts:[y]},metadata:{exclude_after_next_user_message:!0,...T}}]:void 0,extraStreamParams:L,systemHints:b})}}const jt=fe(()=>xe(()=>import("./dxwj7d3qxjns67z0.js").then(t=>t.F),__vite__mapDeps([0,1,2,3,4,5])));function Rt(t){return t.message.metadata?.safety_plugin_status_code===123}function _t(t){return t.message.metadata?.finish_details?.type==="content_filter"}function $(t){if(t===void 0)return{flagSeverity:void 0,shouldHideContent:!1,errCode:void 0,errMessage:void 0};const{errType:o,errCode:c,err:r,disclaimers:a}=t,s=_t(t),d=s&&Rt(t),g=a&&a.length>0;return d?{flagSeverity:"warning",shouldHideContent:!0,errCode:S.ContentRegurgitation,errMessage:r}:!g&&s?{flagSeverity:"warning",shouldHideContent:!0,errCode:S.ContentOrTos,errMessage:r}:{flagSeverity:o,shouldHideContent:o==="danger"&&(c===S.ContentPolicy||c===S.ModelIncompatibility),disclaimers:a,errCode:c,errMessage:r}}function bt({message:t,clientThreadId:o,id:c,isFeedbackEnabled:r,isUserTurn:a,className:s}){const{errCode:d,errMessage:g,flagSeverity:n}=$(t);switch(d){case S.ContentPolicy:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(kt,{isFeedbackEnabled:r})});case S.ModelIncompatibility:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(m,{...x.modelIncompatibilityMessage})});case S.ContentOrTos:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(St,{isFeedbackEnabled:r})});case S.ContentRegurgitation:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(Pt,{})});case $e:return e.jsx(Et,{className:s,id:c,flag:n,clientThreadId:o,isUserTurn:a});case ke:return e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(m,{...x.historyDisabledConversationMissing})});default:return g!==void 0?e.jsx(F,{flag:n,isUserTurn:a,className:s,children:e.jsx(jt,{rehypePlugins:[[Ze,{target:"_new",rel:"noopener noreferrer"}]],className:"markdown prose w-full break-words dark:prose-invert",children:g})}):null}}function Et({className:t,id:o,flag:c,clientThreadId:r,isUserTurn:a}){const s=Je(R=>R.isoDate),d=Xe(s),g=De(r??we,R=>R?.mode),n=g&&g.kind!==Fe.PrimaryAssistant,h=et(),{data:p}=me(),u=tt(p)?.id,i=Ct({clientThreadId:r}),y=f.useCallback(()=>{ie.logEvent("chatgpt_regenerate_due_to_rate_limit_button_clicked",void 0,{useDefaultModel:"false",...le({clientThreadId:r})}),i({id:o})},[o,i,r]),T=f.useCallback(()=>{ie.logEvent("chatgpt_regenerate_due_to_rate_limit_button_clicked",void 0,{useDefaultModel:"true",...le({clientThreadId:r})}),h({modelId:u,location:"Model switcher menu item"}),i({id:o,requestedModelId:u})},[i,o,u,h,r]);let l;return n?l=s!=null?e.jsx("span",{children:e.jsx(m,{...x.gptUsageCapExceededCustomFeature,values:{link:ue,formattedTime:d}})}):e.jsx(m,{...x.gptUsageCapExceededExpired}):l=s!=null?e.jsx("span",{children:e.jsx(m,{...x.gptUsageCapExceeded,values:{link:ue,formattedTime:d}})}):e.jsx(m,{...x.gptUsageCapExceededExpired}),e.jsx(F,{flag:s!=null?c:void 0,isUserTurn:a,className:t,children:e.jsxs("div",{className:"flex items-center gap-6",children:[l,s==null&&e.jsx(ce,{color:"secondary",className:"flex-shrink-0",onClick:y,children:e.jsx(m,{...x.buttonTryAgain})}),s!=null&&!n&&e.jsx(ce,{color:"secondary",className:"flex-shrink-0",onClick:T,children:e.jsx(m,{...x.buttonUseDefaultModel})})]})})}const ue=t=>e.jsx("a",{href:"https://share.hsforms.com/16d0ZZVM3QZirXnCD_q7u1Q4sk30",target:"_blank",rel:"noreferrer",className:"underline",children:t});function St({isFeedbackEnabled:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{...x.contentOrTosViolationNoFeedback,values:{contentPolicyLink:pe,termsLink:Dt}})}),e.jsx("div",{children:t&&e.jsx(m,{...x.contentPolicyFeedback})})]})}function Pt(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold",children:e.jsx(m,{...x.contentRegurgitationViolation})}),e.jsx("div",{children:e.jsx(m,{...x.readModelSpec,values:{modelSpecLink:wt}})})]})}function kt({isFeedbackEnabled:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{...x.contentPolicyViolationNoFeedback,values:{contentPolicyLink:pe}})}),e.jsx("div",{children:t&&e.jsx(m,{...x.contentPolicyFeedback})})]})}const pe=t=>e.jsx(Z,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:t}),Dt=t=>e.jsx(Z,{target:"_blank",href:"https://openai.com/policies/terms-of-use",rel:"noreferrer",children:t}),wt=t=>e.jsx(Z,{target:"_blank",href:"https://cdn.openai.com/spec/model-spec-2024-05-08.html",rel:"noreferrer",children:t}),x=he({contentPolicyFeedback:{id:"TextMessageDisplay.contentPolicyFeedback",defaultMessage:"Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolation:{id:"TextMessageDisplay.contentPolicyViolation.2",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolationNoFeedback:{id:"TextMessageDisplay.contentPolicyViolationNoFeedback",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>."},modelIncompatibilityMessage:{id:"cyOWhN",defaultMessage:"Your request was flagged as potentially violating our usage policy. Please try again with a different prompt."},contentOrTosViolation:{id:"TextMessageDisplay.contentOrTosViolation.2",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentOrTosViolationNoFeedback:{id:"TextMessageDisplay.contentOrTosViolationNoFeedback",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>."},contentRegurgitationViolation:{id:"kAMQnd",defaultMessage:"ChatGPT isn't designed to provide this type of content."},readModelSpec:{id:"fQ0JYv",defaultMessage:"Read the <modelSpecLink>Model Spec</modelSpecLink> for more on how ChatGPT handles creators' content."},historyDisabledConversationMissing:{id:"TextMessageDisplay.historyDisabledConversationMissing",defaultMessage:"Sorry, conversations created when Chat History is off expire after 6 hours of inactivity. Please start a new conversation to continue using ChatGPT."},somethingWentWrong:{id:"TextMessageDisplay.somethingWentWrong",defaultMessage:"Something went wrong."},gptUsageCapExceeded:{id:"TextMessageDisplay.gptUsageCapExceeded",defaultMessage:"You've reached the current usage cap for GPT-4. You can continue with the default model now, or try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededCustomFeature:{id:"TextMessageDisplay.gptUsageCapExceededCustomFeature",defaultMessage:"You've reached the current usage cap for GPT-4, please try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededExpired:{id:"TextMessageDisplay.gptUsageCapExceededExpired",defaultMessage:"You previously reached your usage cap for GPT-4, but you can now try sending your message again"},buttonUseDefaultModel:{id:"TextMessageDisplay.buttonUseDefaultModel",defaultMessage:"Use default model"},buttonTryAgain:{id:"TextMessageDisplay.buttonTryAgain",defaultMessage:"Try again"}}),Ft=fe(()=>xe(()=>import("./g37gu5xs2utemlog.js"),__vite__mapDeps([6,1,3,4,2,5,7,8])).then(t=>t.TextMessageImageGroup));function ye({attachments:t,citations:o,contentReferences:c,className:r,clientThreadId:a,displayParts:s,isCompletionInProgress:d,id:g,isActivelyStreaming:n,isUserTurn:h,turnIndex:p,isFeedbackEnabled:u,messages:i,parts:y,prevGroupedMessageType:T,prevGroupedMessages:l,showEditButton:R,onEnterEdit:P,size:I="medium"}){const _=i.length>1,{flagSeverity:A,shouldHideContent:N}=$(_?void 0:i[0]),k=y.some(j=>j!==""),D=!k&&i[0].message.metadata?.content_references?.length===0,b=i[0].message.metadata?.targeted_reply_label??i[0].message.metadata?.targeted_reply,L=i[0].message.metadata?.targeted_reply_image;return f.useEffect(()=>{const j=i[0].message;if(j.author.metadata?.real_author===`tool:${Le.SEARCHGPT}`&&k){const w=j.metadata?.search_source;ge.logEvent(G.searchToolRequestTimeToFirstTextToken,a,j.id,{search_source:w},()=>{w===Ae.InstantQuery&&st.logEvent(G.searchToolPageLoadTimeToFirstTextToken,{message_id:j.id,search_source:w})})}},[a,k,i]),f.useEffect(()=>{if(!D)switch(T){case K.Browsing:ge.logEvent(G.browsingTimeToFirstTextToken,a,i[0].message.id);break}},[D,i,a,T]),e.jsxs("div",{"data-message-author-role":i[0].message.author.role,"data-message-id":i[0].message.id,dir:"auto",className:z(r,"text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words text-start [.text-message+&]:mt-5"),"data-message-model-slug":i[0].message.metadata?.model_slug,children:[b&&e.jsxs("div",{className:"mb-1 ml-6 mt-1 flex items-center gap-1.5 text-sm font-normal text-token-text-tertiary sm:ml-7 lg:ml-8",children:[L?e.jsx("img",{className:"h-6 rounded border border-token-border-light object-contain",src:L,alt:b}):e.jsx(at,{className:"icon-md shrink-0"}),e.jsx("p",{className:"mr-2 line-clamp-3",children:b})]}),h&&e.jsx(nt,{messages:i}),!1,e.jsx(ot,{messages:i}),e.jsx(Lt,{parts:y,attachments:t,isUserTurn:h,isCompletionInProgress:d,turnIndex:p,displayParts:s,isActivelyStreaming:n,shouldHideContent:N&&!u,showEditButton:R,onEnterEdit:P,clientThreadId:a,id:g,isEmpty:D,prevGroupedMessageType:T,prevGroupedMessages:l,flagSeverity:A,messages:i,citations:o,contentReferences:c,size:I}),e.jsx(bt,{message:_?void 0:i[0],id:g,isFeedbackEnabled:u,clientThreadId:a,isUserTurn:h}),e.jsx(rt,{isUserTurn:h,message:_?void 0:i[0]}),!h&&!n&&l&&T===K.SearchResult&&e.jsx(it,{messages:l})]})}function Lt({clientThreadId:t,id:o,displayParts:c,turnIndex:r,isActivelyStreaming:a,shouldHideContent:s,showEditButton:d=!1,onEnterEdit:g,isEmpty:n,prevGroupedMessageType:h,prevGroupedMessages:p,messages:u,citations:i,contentReferences:y,size:T,isUserTurn:l,parts:R,attachments:P}){const I=Re(),_=f.useRef(!1),A=lt(c),N=u[0].message.metadata?.serialization_metadata,k=u[0].message.metadata?.image_results?.length??0,D=f.useMemo(()=>({clientThreadId:t,messageId:o,turnIndex:r}),[t,o,r]),{toggleThreadSidebar:b}=Ne(),L=f.useCallback((M,C)=>{b({type:"searchSources",scrollToHeader:C,clientThreadId:t,turnIndex:r,messageId:o})},[t,r,o,b]),j=e.jsx(dt,{parts:R,attachments:P,isUserTurn:l,clientThreadId:t},"files-and-tables"),w=!!(P?.length||c.some(M=>M.type==="images")),Me=ct();function J(M,C,v){const H=h===K.CodeInterpreter?p?.map(E=>E.message):void 0,{text:ee,contentReferences:te}=gt(C,i,y);let se=te;Me&&(se=te.filter(E=>E.type!=="attribution"));let{processedText:V,displayedContentReferences:ae}=He(ee,se,a?void 0:H,!1,a);V.includes(Ve)&&!_.current&&(_.current=!0,Ie.addError(new Error("Failed replaceTextWithDirectives"),{text:V,displayedContentReferences:ae}));const ne=u[0].message,oe=ne.metadata?.message_locale,ve=u.find(E=>E.message.id===o),Te=ut(ve?.message);let Q=e.jsx(mt,{clientThreadId:t,componentOverrides:Te?ft:null,messageId:o,size:T,className:z(a&&(V||!Be("630821311")?"result-streaming":"result-thinking")),children:V===""?"&#8203;":V});if(oe!=null){const E=Qe(oe);E!=null&&(Q=e.jsx(qe,{locale:E,children:Q}))}return e.jsx(xt.Provider,{value:{analyticsMetadata:D,message:ne,contentReferences:ae,onShowSearchResults:L,numImageResults:k,isActivelyStreaming:a,useSafeUrls:!0,clientThreadId:t},children:Q},M)}const O=c.map((M,C)=>{if(M.type==="transcription"){const v=s?null:M.text;let H=null;if(l&&s)H=e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})});else if(l&&v!=null)H=v.trim().length===0?e.jsx("span",{className:"italic opacity-30",children:e.jsx(U,{text:I.formatMessage(B.transcriptUnavailable),customSymbolOffsets:void 0})}):e.jsx("span",{className:"italic opacity-65",children:e.jsx(U,{text:`“${v.trim()}”`,customSymbolOffsets:void 0})});else if(!l&&v!=null)return J(C,v);return e.jsx(W,{containsImagesOrAttachments:w,isUserTurn:l,showEditButton:d,onEnterEdit:g,children:H},C)}else if(M.type==="text"){const v=s?null:M.text;return!n&&!s&&!l?J(C,A):n&&a&&!l?e.jsx("div",{className:"result-streaming",children:e.jsx("span",{children:e.jsx("pre",{})})},C):e.jsx(W,{containsImagesOrAttachments:w,isUserTurn:l,showEditButton:d,onEnterEdit:g,children:l&&s?e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})}):v?e.jsx(U,{text:v,customSymbolOffsets:N?.custom_symbol_offsets}):null},C)}else if(M.type==="images"){const v=u[0].message.metadata?.attachments??[];return e.jsx(Ft,{assets:M.imageAssets,attachments:v},C)}else return null}),X=c.findIndex(M=>M.type==="text");if(X!==-1?O.splice(X,0,j):O.push(j),s&&l)O.length=0,O.push(e.jsx(W,{containsImagesOrAttachments:w,isUserTurn:l,onEnterEdit:Oe,children:e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...B.contentRemoved})})}));else if(s&&!l)return null;return e.jsx("div",{className:z("flex w-full flex-col gap-1 empty:hidden",l&&"items-end rtl:items-start",!l&&"first:pt-[3px]"),children:O})}const B=he({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function At(t){const{isActivelyStreaming:o,...c}=t,r=Ge(),a=r?.includes("debug")??!1,s=t.messages[t.messages.length-1].message.id,[d,g]=f.useState(ht(t.parts)),n=f.useRef(void 0);return n.current===void 0&&(n.current=r?.includes(Ue)??!1?new pt(t.parts,g,o,void 0,{debug:a}):new yt(t.parts,g,o)),f.useEffect(()=>{n.current!=null&&(n.current.onMessagePartsUpdated(t.parts,o),n.current.isBuffering()&&Y.addDelayedRenderingMessage(s))},[t.parts,s,o]),f.useEffect(()=>{n.current!=null&&!n.current.isBuffering()&&Y.removeDelayedRenderingMessage(s)},[d,s]),f.useEffect(()=>()=>Y.removeDelayedRenderingMessage(s),[s]),f.useEffect(()=>()=>{n.current!=null&&(n.current.destroy(),n.current=void 0)},[]),e.jsx(ye,{...c,displayParts:d,isActivelyStreaming:o||n.current?.isBuffering()})}function Nt({message:t,isCompletionInProgress:o,clientThreadId:c,className:r,isUserTurn:a,turnIndex:s,isFeedbackEnabled:d,prevGroupedMessageType:g,prevGroupedMessages:n,showEditButton:h,onEnterEdit:p}){const u=f.useMemo(()=>"parts"in t.message.content?t.message.content.parts:[We(t.message)],[t]);return e.jsx(Ot,{parts:u,messages:[t],isCompletionInProgress:o,className:r,citations:t.message.metadata?.citations,contentReferences:t.message.metadata?.content_references,attachments:t.message.metadata?.attachments,isUserTurn:a,turnIndex:s,id:t.nodeId,isFeedbackEnabled:d,clientThreadId:c,showEditButton:h,onEnterEdit:p,prevGroupedMessageType:g,prevGroupedMessages:n})}const Qt=_e.memo(Nt);function Ot(t){const o=t.messages.length>1,{flagSeverity:c}=$(o?void 0:t.messages[0]),r=c!=="danger"&&t.isCompletionInProgress,a=!t.parts.some(d=>d!==""),[s]=f.useState(()=>!t.isUserTurn&&(t.isCompletionInProgress||a));return s?e.jsx(At,{...t,isActivelyStreaming:r}):e.jsx(ye,{...t,displayParts:Mt({isUserTurn:t.isUserTurn,parts:t.parts}),isActivelyStreaming:r})}export{Ot as T,Qt as a,$ as g,Ct as u};
//# sourceMappingURL=cfvh96gbcjdpth1v.js.map

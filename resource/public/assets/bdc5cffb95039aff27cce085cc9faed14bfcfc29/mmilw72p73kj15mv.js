import{g as Qe,r as F,j as Me}from"./cs7toih8jegb7teq.js";import{u as et}from"./juhpprtcv8tvp5w6.js";import{a0 as pe}from"./dmck639k4dv7claj.js";import{V as tt,A as Se,a as ae,C as Ie,b as x,B as nt,E as Ce,c as ot,S as Ee}from"./g874r21dl3vt5vkr.js";import{s4 as it,s5 as rt}from"./hnw079jsdm76umup.js";import{w as st,p as _e,c as q,s as $,a as C,h as Le,e as L,t as ue,b as K,m as Te,d as ke,f as I,g as He,i as lt,j as at,k as ut,l as ze,n as ce,o as ct,r as Fe,q as ft,u as ht,v as dt}from"./hp08qw6yu0x90xkd.js";function gt(e){return e.innerRadius}function yt(e){return e.outerRadius}function mt(e){return e.startAngle}function pt(e){return e.endAngle}function Et(e){return e&&e.padAngle}function Tt(e,t,o,n,i,u,c,r){var s=o-e,l=n-t,a=c-i,g=r-u,h=g*s-a*l;if(!(h*h<L))return h=(a*(t-u)-g*(e-i))/h,[e+h*s,t+h*l]}function re(e,t,o,n,i,u,c){var r=e-o,s=t-n,l=(c?u:-u)/K(r*r+s*s),a=l*s,g=-l*r,h=e+a,f=t+g,d=o+a,m=n+g,y=(h+d)/2,p=(f+m)/2,T=d-h,v=m-f,S=T*T+v*v,A=i-u,R=h*m-d*f,H=(v<0?-1:1)*K(lt(0,A*A*S-R*R)),P=(R*v-T*H)/S,k=(-R*T-v*H)/S,N=(R*v+T*H)/S,M=(-R*T+v*H)/S,_=P-y,E=k-p,w=N-y,D=M-p;return _*_+E*E>w*w+D*D&&(P=N,k=M),{cx:P,cy:k,x01:-a,y01:-g,x11:P*(i/A-1),y11:k*(i/A-1)}}function vt(){var e=gt,t=yt,o=C(0),n=null,i=mt,u=pt,c=Et,r=null,s=st(l);function l(){var a,g,h=+e.apply(this,arguments),f=+t.apply(this,arguments),d=i.apply(this,arguments)-Le,m=u.apply(this,arguments)-Le,y=ke(m-d),p=m>d;if(r||(r=a=s()),f<h&&(g=f,f=h,h=g),!(f>L))r.moveTo(0,0);else if(y>ue-L)r.moveTo(f*q(d),f*$(d)),r.arc(0,0,f,d,m,!p),h>L&&(r.moveTo(h*q(m),h*$(m)),r.arc(0,0,h,m,d,p));else{var T=d,v=m,S=d,A=m,R=y,H=y,P=c.apply(this,arguments)/2,k=P>L&&(n?+n.apply(this,arguments):K(h*h+f*f)),N=Te(ke(f-h)/2,+o.apply(this,arguments)),M=N,_=N,E,w;if(k>L){var D=He(k/h*$(P)),Y=He(k/f*$(P));(R-=D*2)>L?(D*=p?1:-1,S+=D,A-=D):(R=0,S=A=(d+m)/2),(H-=Y*2)>L?(Y*=p?1:-1,T+=Y,v-=Y):(H=0,T=v=(d+m)/2)}var O=f*q(T),B=f*$(T),W=h*q(A),X=h*$(A);if(N>L){var oe=f*q(v),ie=f*$(v),fe=h*q(S),he=h*$(S),z;if(y<_e)if(z=Tt(O,B,fe,he,oe,ie,W,X)){var de=O-z[0],ge=B-z[1],ye=oe-z[0],me=ie-z[1],xe=1/$(at((de*ye+ge*me)/(K(de*de+ge*ge)*K(ye*ye+me*me)))/2),Pe=K(z[0]*z[0]+z[1]*z[1]);M=Te(N,(h-Pe)/(xe-1)),_=Te(N,(f-Pe)/(xe+1))}else M=_=0}H>L?_>L?(E=re(fe,he,O,B,f,_,p),w=re(oe,ie,W,X,f,_,p),r.moveTo(E.cx+E.x01,E.cy+E.y01),_<N?r.arc(E.cx,E.cy,_,I(E.y01,E.x01),I(w.y01,w.x01),!p):(r.arc(E.cx,E.cy,_,I(E.y01,E.x01),I(E.y11,E.x11),!p),r.arc(0,0,f,I(E.cy+E.y11,E.cx+E.x11),I(w.cy+w.y11,w.cx+w.x11),!p),r.arc(w.cx,w.cy,_,I(w.y11,w.x11),I(w.y01,w.x01),!p))):(r.moveTo(O,B),r.arc(0,0,f,T,v,!p)):r.moveTo(O,B),!(h>L)||!(R>L)?r.lineTo(W,X):M>L?(E=re(W,X,oe,ie,h,-M,p),w=re(O,B,fe,he,h,-M,p),r.lineTo(E.cx+E.x01,E.cy+E.y01),M<N?r.arc(E.cx,E.cy,M,I(E.y01,E.x01),I(w.y01,w.x01),!p):(r.arc(E.cx,E.cy,M,I(E.y01,E.x01),I(E.y11,E.x11),!p),r.arc(0,0,h,I(E.cy+E.y11,E.cx+E.x11),I(w.cy+w.y11,w.cx+w.x11),p),r.arc(w.cx,w.cy,M,I(w.y11,w.x11),I(w.y01,w.x01),!p))):r.arc(0,0,h,A,S,p)}if(r.closePath(),a)return r=null,a+""||null}return l.centroid=function(){var a=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,g=(+i.apply(this,arguments)+ +u.apply(this,arguments))/2-_e/2;return[q(g)*a,$(g)*a]},l.innerRadius=function(a){return arguments.length?(e=typeof a=="function"?a:C(+a),l):e},l.outerRadius=function(a){return arguments.length?(t=typeof a=="function"?a:C(+a),l):t},l.cornerRadius=function(a){return arguments.length?(o=typeof a=="function"?a:C(+a),l):o},l.padRadius=function(a){return arguments.length?(n=a==null?null:typeof a=="function"?a:C(+a),l):n},l.startAngle=function(a){return arguments.length?(i=typeof a=="function"?a:C(+a),l):i},l.endAngle=function(a){return arguments.length?(u=typeof a=="function"?a:C(+a),l):u},l.padAngle=function(a){return arguments.length?(c=typeof a=="function"?a:C(+a),l):c},l.context=function(a){return arguments.length?(r=a??null,l):r},l}function wt(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function bt(e){return e}function St(){var e=bt,t=wt,o=null,n=C(0),i=C(ue),u=C(0);function c(r){var s,l=(r=ut(r)).length,a,g,h=0,f=new Array(l),d=new Array(l),m=+n.apply(this,arguments),y=Math.min(ue,Math.max(-ue,i.apply(this,arguments)-m)),p,T=Math.min(Math.abs(y)/l,u.apply(this,arguments)),v=T*(y<0?-1:1),S;for(s=0;s<l;++s)(S=d[f[s]=s]=+e(r[s],s,r))>0&&(h+=S);for(t!=null?f.sort(function(A,R){return t(d[A],d[R])}):o!=null&&f.sort(function(A,R){return o(r[A],r[R])}),s=0,g=h?(y-l*v)/h:0;s<l;++s,m=p)a=f[s],S=d[a],p=m+(S>0?S*g:0)+v,d[a]={data:r[a],index:s,value:S,startAngle:m,endAngle:p,padAngle:T};return d}return c.value=function(r){return arguments.length?(e=typeof r=="function"?r:C(+r),c):e},c.sortValues=function(r){return arguments.length?(t=r,o=null,c):t},c.sort=function(r){return arguments.length?(o=r,t=null,c):o},c.startAngle=function(r){return arguments.length?(n=typeof r=="function"?r:C(+r),c):n},c.endAngle=function(r){return arguments.length?(i=typeof r=="function"?r:C(+r),c):i},c.padAngle=function(r){return arguments.length?(u=typeof r=="function"?r:C(+r),c):u},c}function Ue(e,t){let o,n;for(const i of e)i!=null&&(o===void 0?i>=i&&(o=n=i):(o>i&&(o=i),n<i&&(n=i)));return[o,n]}function At(e,t){let o=0;for(let n of e)(n=+n)&&(o+=n);return o}var ve,Ne;function Rt(){if(Ne)return ve;Ne=1;var e=it(),t=rt(),o=t(function(n,i,u,c){e(n,i,u,c)});return ve=o,ve}var xt=Rt();const Pt=Qe(xt);function Mt(e){switch(e){case"title":case"ctrTitle":return"titleStyle";case"body":case void 0:case"obj":case"content":case"subTitle":case"":return"bodyStyle";default:return"otherStyle"}}const b=1/9525;function It(e){return e.xEmu!==0||e.yEmu!==0||e.widthEmu!==0||e.heightEmu!==0}const Ge=(e,...t)=>Pt({},e,...t,(o,n)=>o||n);function Ct(e,t,o){const i=Mt(e.placeholderType),u=o.useLayoutId,c=t.layouts.find(d=>d.id===u),r=e.placeholderIndex??0,s=e.textStyle??{anchor:ae.ANCHOR_TYPE_UNSPECIFIED,vertical:tt.VERTICAL_TYPE_UNSPECIFIED,bold:!1,italic:!1,color:void 0,fontSize:1350,fill:void 0,alignment:Se.ALIGNMENT_TYPE_UNSPECIFIED,underline:"none",bottomInset:0,leftInset:0,rightInset:0,topInset:0},l=e.levelsStyles[0]?.textStyle;let a,g,h;const f=c?.elements.find(d=>d.placeholderType===e.placeholderType&&(d.placeholderIndex??0)===r);if(f?.textStyle&&(a=f.textStyle),f?.levelsStyles){const m=f.levelsStyles[0];m&&(g=m.textStyle)}if(c?.parentLayoutId!==u){const d=t.layouts.find(m=>m.type==="master");if(i==="titleStyle"&&d?.titleLevelStyles){const y=d.titleLevelStyles[0];y&&(h=y.textStyle)}else if(i==="bodyStyle"&&d?.bodyLevelStyles){const y=d.bodyLevelStyles[0];y&&(h=y.textStyle)}else if(i==="otherStyle"&&d?.otherLevelStyles){const y=d.otherLevelStyles[0];y&&(h=y.textStyle)}}return Ge(s,l,a,g,h)}function V(e,t,o){return Math.min(Math.max(e,t),o)}function _t(e){const t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Lt(e){return e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055}function kt(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return{r:o,g:n,b:i}}function Ye(e,t,o){e/=255,t/=255,o/=255;const n=Math.max(e,t,o),i=Math.min(e,t,o);let u=0,c=0;const r=(n+i)/2;if(n!==i){const s=n-i;switch(c=r>.5?s/(2-n-i):s/(n+i),n){case e:u=(t-o)/s+(t<o?6:0);break;case t:u=(o-e)/s+2;break;case o:u=(e-t)/s+4;break}u/=6}return{h:u,s:c,l:r}}function Be(e,t,o){let n,i,u;if(t===0)n=i=u=o;else{const c=(l,a,g)=>(g<0&&(g+=1),g>1&&(g-=1),g<.16666666666666666?l+(a-l)*6*g:g<.5?a:g<.6666666666666666?l+(a-l)*(.6666666666666666-g)*6:l),r=o<.5?o*(1+t):o+t-o*t,s=2*o-r;n=c(s,r,e+1/3),i=c(s,r,e),u=c(s,r,e-1/3)}return[Math.round(n*255),Math.round(i*255),Math.round(u*255)]}function Ht(e,t){if(!e)return"rgba(0,0,0,1)";const o=e.type===Ie.COLOR_TYPE_RGB?`#${e.value}`:e.type===Ie.COLOR_TYPE_SCHEME&&t.colorMap[e.value]||"#000000";let{r:n,g:i,b:u}=kt(o),c=1;const r=e.transform;if(r){if(r.alpha&&(c=V(r.alpha/1e5,0,1)),r.satMod){const s=Ye(n,i,u);s.s=V(s.s*(r.satMod/1e5),0,1),[n,i,u]=Be(s.h,s.s,s.l)}if(r.lumMod||r.lumOff){const s=Ye(n,i,u);r.lumMod&&(s.l*=r.lumMod/1e5),r.lumOff&&(s.l+=r.lumOff/1e5),s.l=V(s.l,0,1),[n,i,u]=Be(s.h,s.s,s.l)}if(r.tint){const s=r.tint/1e5;[n,i,u]=[n,i,u].map(_t),n=n*s+1*(1-s),i=i*s+1*(1-s),u=u*s+1*(1-s),[n,i,u]=[n,i,u].map(l=>Math.round(Lt(l)*255))}r.shade&&(n*=1-r.shade/1e5,i*=1-r.shade/1e5,u*=1-r.shade/1e5)}return n=V(Math.round(n),0,255),i=V(Math.round(i),0,255),u=V(Math.round(u),0,255),`rgba(${n},${i},${u},${c})`}function Q(e,t,o){return e?Ht(e,t)??o??"transparent":o??"transparent"}function ne(e,t,o){const n=o.useLayoutId;if(e.bbox&&It(e.bbox)&&t){const{xEmu:i,yEmu:u,widthEmu:c,heightEmu:r}=e.bbox;return{x:(i??0)*b,y:(u??0)*b,width:(c??0)*b,height:(r??0)*b}}if(e.placeholderIndex!==void 0){const i=e.placeholderIndex??0,u=t.layouts.find(r=>r.id===n),c=u?.elements.find(r=>(r.placeholderIndex??0)===i);if(c?.bbox){const{xEmu:r,yEmu:s,widthEmu:l,heightEmu:a}=c.bbox;return{x:(r??0)*b,y:(s??0)*b,width:(l??0)*b,height:(a??0)*b}}if(u?.parentLayoutId!==n){const s=t.layouts.find(l=>l.type==="master")?.elements.find(l=>(l.placeholderIndex??0)===i);if(s?.bbox){const{xEmu:l,yEmu:a,widthEmu:g,heightEmu:h}=s.bbox;return{x:(l??0)*b,y:(a??0)*b,width:(g??0)*b,height:(h??0)*b}}}}return{x:0,y:0,width:0,height:0}}const se=18,we=1,De=.1*96,Oe=.05*96;function je(e){return e/100*(96/72)}function Xe(e,t,o,n,i,u){if(!e.paragraphs)return;let{x:c,y:r,width:s,height:l}=ne(e,o,i);c+=De,r+=Oe,s-=De*2,l-=Oe*2;const a=Ct(e,o,i);function g(y,p,T,v,S,A){p.length!==0&&(y.push({segments:p.slice(),widthPx:T,heightPx:v,align:S,maxPx:A}),p.length=0)}const h=[];for(const y of e.paragraphs){const p=y.textStyle,T=[];let v=0,S="left",A=0;for(const H of y.runs){const P=Ge({},H.textStyle,p,a),k=P?.fontSize?je(P.fontSize):se*(96/72),M=`${P?.bold?"bold ":""}${P?.italic?"italic ":""}${k}px Calibri, Carlito, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;t.font=M;const _=Q(P?.fill?.color,n);S=P?.alignment===Se.ALIGNMENT_TYPE_CENTER?"center":P?.alignment===Se.ALIGNMENT_TYPE_RIGHT?"right":"left",A=Math.max(A,k);const E=H.text.split(`
`);for(let w=0;w<E.length;w++){const D=E[w].split(/\s+/);for(let Y=0;Y<D.length;Y++){const O=D[Y];if(!O)continue;let B=O;t.font=M;let W=t.measureText(B).width;if(v+W>s&&T.length){const X=A||se*1.3333333333333333;g(h,T,v,X*we,S,X),v=0,A=0}else T.length&&(B=" "+O,W=t.measureText(B).width);T.push({text:B,widthPx:W,font:M,fill:_,px:k,run:H}),v+=W,A=Math.max(A,k)}if(w<E.length-1){const Y=A||se*1.3333333333333333;g(h,T,v,Y*we,S,Y),v=0,A=0}}}const R=A||se*(96/72);g(h,T,v,R*we,S,R)}if(!h.length)return;const f=a?.anchor??ae.ANCHOR_TYPE_TOP,d=h.reduce((y,p)=>y+p.heightPx,0);let m=f===ae.ANCHOR_TYPE_BOTTOM?r+(l-d):f===ae.ANCHOR_TYPE_MIDDLE?r+(l-d)/2:r;m=Math.max(m,r),t.textBaseline="top";for(const y of h){let p=y.align==="center"?c+(s-y.widthPx)/2:y.align==="right"?c+s-y.widthPx:c;for(const T of y.segments){t.font=T.font,t.fillStyle=T.fill;const v=y.maxPx-T.px;u&&T.run?.hyperlink?.uri&&u.push({x:p,y:m+(y.maxPx-T.px),width:T.widthPx,height:T.px,url:T.run.hyperlink.uri}),t.fillText(T.text,p,m+v),p+=T.widthPx}m+=y.heightPx}}function Nt(e){for(var t=e.length/6|0,o=new Array(t),n=0;n<t;)o[n]="#"+e.slice(n*6,++n*6);return o}const Yt=Nt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function qe(e,t,o){if(e.measureText(t).width<=o)return t;const n="â€¦";let i=0,u=t.length;for(;i<u;){const c=Math.ceil((i+u)/2);e.measureText(t.slice(0,c)+n).width<=o?i=c:u=c-1}return t.slice(0,i)+n}const G="Segoe UI, Helvetica, Arial, sans-serif",Ze=10,Bt=11,U=10,ee="#666",j=Yt,Ve=.6,Z={top:32,right:16,bottom:40,left:48},$e=16,Dt=ct({decimal:".",thousands:",",grouping:[3],currency:["","$"],percent:" %"});function Ot(e,t,o,n){const i=ne(e,o,n),u=qt(e.chartReference,o);u&&Ke(t,u,i)}function dn(e,t,o,n={}){Ke(e,t,o,n)}function $t(e){return{x:e.x+Z.left,y:e.y+Z.top,width:e.width-Z.left-Z.right,height:e.height-Z.top-Z.bottom}}function Ke(e,t,o,n={}){e.save(),t.title&&t.title.trim()&&(e.font=`bold ${$e}px ${G}`,e.fillStyle=ee,e.textAlign="center",e.textBaseline="top",e.fillText(t.title.trim(),o.x+o.width/2,o.y+(Z.top-$e)/2));let i=$t(o);if((t.type===x.CHART_TYPE_BAR||t.type===x.CHART_TYPE_BAR_3D)&&t.barDirection===nt.BAR_DIRECTION_BAR){const r=t.categories.length>0?t.categories:t.series[0]?.categories??[];i=Jt(e,i,r,t.yAxis);const s=Zt(t,i);Kt(e,t,s,i),n.skipLegend||We(e,t,o),Vt(e,t,s),e.restore();return}const c=Wt(t,i);switch(zt(t.type)||Ft(e,t,c,i),n.skipLegend||We(e,t,o),t.type){case x.CHART_TYPE_BAR:case x.CHART_TYPE_BAR_3D:Ut(e,t,c);break;case x.CHART_TYPE_LINE:case x.CHART_TYPE_LINE_3D:Gt(e,t,c);break;case x.CHART_TYPE_AREA:case x.CHART_TYPE_AREA_3D:jt(e,t,c);break;case x.CHART_TYPE_PIE:case x.CHART_TYPE_PIE_3D:case x.CHART_TYPE_DOUGHNUT:Xt(e,t,i);break}e.restore()}function Ae(e){return typeof e.bandwidth=="function"}function Wt(e,t){const o=e.categories.length>0?e.categories:e.series[0]?.categories??[],n=e.series.flatMap(l=>l.values),i=Ue(n),[u,c]=i[0]===void 0?[0,0]:i,r=e.type===x.CHART_TYPE_LINE||e.type===x.CHART_TYPE_LINE_3D?ft().domain(o).range([t.x,t.x+t.width]).padding(.5):ce().domain(o).range([t.x,t.x+t.width]).paddingInner(Ve),s=ze().domain([Math.min(0,u),c]).nice().range([t.y+t.height,t.y]);return{x:r,y:s}}function J(e,t){if(Ae(e)){const o=e(t);return o!==void 0?o+e.bandwidth()/2:void 0}return e(t)}function zt(e){return e===x.CHART_TYPE_PIE||e===x.CHART_TYPE_PIE_3D||e===x.CHART_TYPE_DOUGHNUT}function Ft(e,t,o,n){const{x:i,y:u}=o,c=t.categories.length>0?t.categories:t.series[0]?.categories??[];e.save(),e.font=`${Ze}px ${G}`,e.fillStyle=ee,e.strokeStyle=ee,e.lineWidth=1;const{color:r,fontSize:s}=te(t.xAxis),l=u(0);e.beginPath(),e.moveTo(n.x,l),e.lineTo(n.x+n.width,l),e.stroke(),e.strokeStyle=r,e.lineWidth=1,e.font=`${s}px ${G}`,e.textAlign="center",e.textBaseline="top",e.fillStyle=r,c.forEach(h=>{const f=J(i,h);if(f===void 0)return;e.beginPath(),e.moveTo(f,l),e.lineTo(f,l+4),e.stroke();const d=Ae(i)?i.step():n.width/Math.max(1,c.length);e.fillText(qe(e,h,d),f,l+6)});const{color:a,fontSize:g}=te(t.yAxis);e.textAlign="right",e.textBaseline="middle",e.fillStyle=a,u.ticks(5).forEach(h=>{const f=u(h);e.strokeStyle=a,e.beginPath(),e.moveTo(n.x,f),e.lineTo(n.x+n.width,f),e.stroke(),e.strokeStyle=a,e.beginPath(),e.moveTo(n.x-4,f),e.lineTo(n.x,f),e.stroke(),e.font=`${g}px ${G}`,e.fillText(ht("~s")(h),n.x-6,f)}),e.restore()}function We(e,t,o){if(t.series.length===0)return;e.save(),e.font=`${Bt}px ${G}`;const n=t.series.map(a=>a.name||"Series"),i=n.map(a=>e.measureText(a).width),u=Math.max(...i,0),c=U+6+u+16,r=n.length*(U+4)+16-4,s=o.x+o.width-c,l=o.y+8;e.fillStyle="transparent",e.strokeStyle="transparent",e.lineWidth=1,e.beginPath(),e.rect(s,l,c,r),e.fill(),e.stroke(),t.series.forEach((a,g)=>{const h=a.name||"Series",f=l+8+g*(U+4)+U/2;e.fillStyle=Re(a,g),e.beginPath(),e.rect(s+8,f-U/2,U,U),e.fill(),e.strokeStyle="#000",e.stroke(),e.fillStyle=ee,e.textAlign="left",e.textBaseline="middle",e.fillText(h,s+8+U+6,f)}),e.restore()}function Re(e,t){return e.fill?.color?.value?`#${e.fill.color.value}`:j[t%j.length]}function te(e){const t=e?.line?.fill?.color?.value?`#${e.line.fill.color.value}`:ee,o=e?.textStyle?.fontSize?je(e.textStyle.fontSize):Ze;return{color:t,fontSize:o}}function Ut(e,t,o){if(!Ae(o.x))return;const n=o.x,i=o.y,u=t.categories.length>0?t.categories:t.series[0]?.categories??[],c=t.series.length,r=ce().domain(Fe(c)).range([0,n.bandwidth()]).padding(.05);u.forEach((s,l)=>{const a=n(s);a!==void 0&&t.series.forEach((g,h)=>{const f=g.values[l]??0,d=a+(r(h)??0),m=i(Math.max(0,f)),y=Math.abs(i(f)-i(0)),p=Re(g,h);e.fillStyle=p,e.beginPath(),e.rect(d,m,r.bandwidth(),y),e.fill()})})}function Gt(e,t,o){const n=o.x,i=o.y,u=t.categories.length>0?t.categories:t.series[0]?.categories??[];t.series.forEach((c,r)=>{e.strokeStyle=j[r%j.length],e.lineWidth=2,e.beginPath(),c.values.forEach((s,l)=>{const a=J(n,u[l]),g=i(s);a!==void 0&&(l===0?e.moveTo(a,g):e.lineTo(a,g))}),e.stroke(),e.fillStyle=e.strokeStyle,c.values.forEach((s,l)=>{const a=J(n,u[l]),g=i(s);a!==void 0&&(e.beginPath(),e.arc(a,g,3,0,Math.PI*2),e.fill())})})}function jt(e,t,o){const n=o.x,i=o.y,u=t.categories.length>0?t.categories:t.series[0]?.categories??[];t.series.forEach((c,r)=>{const s=j[r%j.length],l=(()=>{const h=dt(s);return h?(h.opacity=.35,h.formatRgb()):s})();e.fillStyle=l,e.strokeStyle=s,e.lineWidth=1,e.beginPath(),c.values.forEach((h,f)=>{const d=J(n,u[f]),m=i(h);d!==void 0&&(f===0?e.moveTo(d,m):e.lineTo(d,m))});const a=J(n,u[u.length-1]),g=J(n,u[0]);a===void 0||g===void 0||(e.lineTo(a,i(0)),e.lineTo(g,i(0)),e.closePath(),e.fill(),e.stroke())})}function Xt(e,t,o){const n=t.series[0];if(!n)return;const i=n.values;if(At(i)===0)return;const c=o.x+o.width/2,r=o.y+o.height/2,s=Math.min(o.width,o.height)/2,l=vt().innerRadius(t.type===x.CHART_TYPE_DOUGHNUT?s*.55:0).outerRadius(s).context(e),a=St().sort(null);e.save(),e.translate(c,r),a(i).forEach((g,h)=>{e.fillStyle=j[h%j.length],e.beginPath(),l(g),e.fill(),e.strokeStyle="#fff",e.lineWidth=1,e.stroke()}),e.restore()}function qt(e,t){const o=e?.id;return o?t.charts.find(n=>n.id===o)??null:null}function Zt(e,t){const o=e.categories.length>0?e.categories:e.series[0]?.categories??[],[n,i]=Ue(e.series.flatMap(g=>g.values)),u=e.yAxis?.min,c=e.yAxis?.max,r=u!==void 0?u:Math.min(0,n),s=c!==void 0?c:i,l=ze().domain([r,s]).range([t.x,t.x+t.width]);(u===void 0||c===void 0)&&l.nice();const a=ce().domain([...o].reverse()).range([t.y,t.y+t.height]).paddingInner(Ve);return{x:l,y:a}}function Vt(e,t,o){const{x:n,y:i}=o,[u,c]=n.domain(),r=u>0?u:c<0?c:0,s=t.categories.length?t.categories:t.series[0]?.categories??[],l=t.series.length,a=ce().domain(Fe(l)).range([0,i.bandwidth()]).padding(.05);s.forEach((g,h)=>{const f=i(g);f!==void 0&&t.series.forEach((d,m)=>{const y=d.values[h]??0,p=f+(a(m)??0),T=n(Math.min(r,y)),v=n(Math.max(r,y)),S=Math.abs(v-T);e.fillStyle=Re(d,m),e.fillRect(T,p,S,a.bandwidth())})})}function Kt(e,t,o,n,i=!0){const{x:u,y:c}=o,r=t.categories.length>0?t.categories:t.series[0]?.categories??[];e.save(),e.lineWidth=1;const{color:s,fontSize:l}=te(t.yAxis);e.font=`${l}px ${G}`,e.fillStyle=s,e.strokeStyle=s,e.textAlign="right",e.textBaseline="middle";const a=Math.min(140,Math.max(0,n.x-10));r.forEach(m=>{const y=(c(m)??0)+c.bandwidth()/2;e.beginPath(),e.moveTo(n.x-4,y),e.lineTo(n.x,y),e.stroke();const p=qe(e,m,a);e.fillText(p,n.x-6,y)});const{color:g,fontSize:h}=te(t.xAxis);e.font=`${h}px ${G}`,e.fillStyle=g,e.strokeStyle=g,e.textAlign="center",e.textBaseline="top";const f=n.y+n.height;e.beginPath(),e.moveTo(n.x,f),e.lineTo(n.x+n.width,f),e.stroke();const d=Dt.format(".2~f");u.ticks(5).forEach(m=>{const y=u(m);e.beginPath(),e.moveTo(y,f),e.lineTo(y,f+4),e.stroke(),i&&(e.save(),e.beginPath(),e.moveTo(y,n.y),e.lineTo(y,f),e.stroke(),e.restore()),e.fillText(d(m),y,f+6)}),e.restore()}function Jt(e,t,o,n,i=180,u=100){const{fontSize:c}=te(n);e.save(),e.font=`${c}px ${G}`;const r=Math.max(...o.map(a=>e.measureText(a).width));e.restore();const s=Math.min(i,r+u);if(s<=t.x)return t;const l=s-t.x;return{x:t.x+l,y:t.y,width:Math.max(0,t.width-l),height:t.height}}function Qt(e,t,o,n,i){if(!e.table||!e.bbox)return;const u=e.table.columnWidths.reduce((f,d)=>f+d,0),c=e.table.rows.reduce((f,d)=>f+(d.heightEmu>0?d.heightEmu:0),0),r=e.table.rows.filter(f=>f.heightEmu===0).length,s=r>0?Math.max((e.bbox.heightEmu-c)/r,1):0,l=c+r*s;if(u===0||l===0)return;const a=e.bbox.widthEmu/u,g=e.bbox.heightEmu/l;let h=e.bbox.yEmu;for(const f of e.table.rows){const m=(f.heightEmu===0?s:f.heightEmu)*g;let y=e.bbox.xEmu;for(let p=0;p<f.cells.length;p++){const T=f.cells[p],v=e.table.columnWidths[p]*a,S={bbox:{xEmu:y,yEmu:h,widthEmu:v,heightEmu:m},paragraphs:T.paragraphs,textStyle:T.textStyle,levelsStyles:T.levelsStyles},A=T.fill,R=A?.color?.value?`#${A.color.value}`:"transparent";t.fillStyle=R,t.fillRect(y*b,h*b,v*b,m*b),Xe(S,t,o,n,i),t.strokeStyle="#cccccc",t.strokeRect(y*b,h*b,v*b,m*b),y+=v}h+=m}}const be=new Map;let le=null;function en(e,t,o,n){if(/\bwidth\s*=|\bheight\s*=/.test(e))return new Blob([e],{type:"image/svg+xml"});const i=e.replace(/<svg\b([^>]*)>/,`<svg$1 width="${o}" height="${n}">`);return new Blob([i],{type:"image/svg+xml"})}async function Je(e){if(!e.image)throw new Error("no image on element");const t=`${e.image.data.byteLength}_${e.image.contentType}`,o=be.get(t);if(!o)if(e.image.contentType==="image/svg+xml"){const n=Math.round((e.bbox?.widthEmu??1)*b),i=Math.round((e.bbox?.heightEmu??1)*b),u=window.devicePixelRatio||1,c=en(new TextDecoder().decode(e.image.data),e.image.contentType,n,i),r=URL.createObjectURL(c),s=new Image;s.src=r,await s.decode();const l=createImageBitmap(s,{resizeWidth:n*u,resizeHeight:i*u});return URL.revokeObjectURL(r),be.set(t,l),l}else{const n=new Blob([e.image.data],{type:e.image.contentType}),i=createImageBitmap(n);return be.set(t,i),i}return o}async function tn(e,t,o,n){if(!e.image)return;const{x:i,y:u,width:c,height:r}=ne(e,o,n),s=await Je(e);if(!s)return;let l=0,a=0,g=s.width,h=s.height;const f=e.image.mask;if(f){const d=p=>p/1e5,m=s.width,y=s.height;l+=d(f.cropLeft)*m,a+=d(f.cropTop)*y,g-=(d(f.cropLeft)+d(f.cropRight))*m,h-=(d(f.cropTop)+d(f.cropBottom))*y}t.drawImage(s,l,a,g,h,i,u,c,r)}function nn(e){if(le)return le;if(!e)return{colorMap:{},lineStyleMap:{},effectMap:{}};const t={};if(e.colorScheme){for(const i of e.colorScheme.colors)i.color&&(t[i.name]=i.color.lastColor?`#${i.color.lastColor}`:`#${i.color.value}`);t.bg1=t.lt1,t.bg2=t.lt2}const o={};for(const[i,u]of e.lineStyleList.entries())o[i+1]=u;const n={};for(const[i,u]of e.effectStyleList.entries())n[i+1]=u;return le={colorMap:t,lineStyleMap:o,effectMap:n},le}function on(e,t,o){let n=e.background;if(n?.fill?.color)return Q(n.fill.color,o);if(n||(n=t.layouts.find(i=>i.id===e.useLayoutId)?.background),n?.ref?.index){const i=n.ref.index-1001,c=t.theme?.backgroundFillStyleList[i]?.color;if(c){const r={...c,value:n.ref.schemeColor};return Q(r,o)}}return o.colorMap.bg1}async function rn(e,t,o,n){const i=nn(t.theme),u=e.widthEmu*b,c=e.heightEmu*b;o.save();const r=on(e,t,i);o.fillStyle=r??"transparent",o.fillRect(0,0,u,c);const s=[...e.elements].sort((l,a)=>l.zIndex-a.zIndex);await Promise.all(s.filter(l=>l.image).map(l=>Je(l)));for(const l of s)if(l.image&&await tn(l,o,t,e),l.type===Ce.ELEMENT_TYPE_CHART_REFERENCE&&Ot(l,o,t,e),l.type===Ce.ELEMENT_TYPE_TABLE&&Qt(l,o,t,i,e),l.shape&&sn(l,o,t,e,i),l.paragraphs&&l.paragraphs.length>0&&Xe(l,o,t,i,e,n),n&&l.hyperlink){const{x:a,y:g,width:h,height:f}=ne(l,t,e);n.push({x:a,y:g,width:h,height:f,url:l.hyperlink.uri,action:l.hyperlink.action})}o.restore()}function sn(e,t,o,n,i){if(!e.shape)return;const{fill:u,line:c,geometry:r}=e.shape,{x:s,y:l,width:a,height:g}=ne(e,o,n);let h=c?.widthEmu?c.widthEmu*b:0;if(t.save(),t.fillStyle=Q(u?.color,i)??"transparent",e.lineReference){const f=i.lineStyleMap[e.lineReference.index];t.strokeStyle="solid",h||=f?.widthEmu?f.widthEmu*b:h}switch(e.effectReference&&i.effectMap[e.effectReference.index].effects.forEach(d=>{if(d.type===ot.EFFECT_TYPE_OUTER_SHADOW){const m=d.shadow?.color?Q(d.shadow.color,i):"transparent";t.shadowColor=m??"transparent",t.shadowBlur=d.shadow?.blurRadius?d.shadow.blurRadius*b:0,t.shadowOffsetX=d.shadow?.distance?d.shadow.distance*b:0,t.shadowOffsetY=d.shadow?.distance?d.shadow.distance*b:0}}),t.beginPath(),r){case Ee.SHAPE_GEOMETRY_RECT:case Ee.SHAPE_GEOMETRY_ROUND_RECT:{g===0?(t.moveTo(s,l),t.lineTo(s+a,l)):a===0?(t.moveTo(s,l),t.lineTo(s,l+g)):t.rect(s,l,a,g);break}case Ee.SHAPE_GEOMETRY_ELLIPSE:{const f=a/2,d=g/2;t.ellipse(s+f,l+d,f,d,0,0,Math.PI*2);break}default:t.restore();return}t.fill(),t.restore(),t.strokeStyle=h&&c?.fill?.color?.value?`#${c.fill.color.value}`:"transparent",t.lineWidth=h,h&&t.stroke(),t.restore()}function gn({startIndex:e,walnutId:t,onExit:o}){const{presentationMap:n}=et(),i=n[t],{presentation:u}=i,[c,r]=F.useState(e),s=F.useRef(null),l=F.useRef(null);F.useEffect(()=>{const d=l.current;if(!d)return;d.requestFullscreen?.().catch(y=>{pe.addError(y)});const m=()=>{document.fullscreenElement||o()};return document.addEventListener("fullscreenchange",m),()=>{document.removeEventListener("fullscreenchange",m),document.fullscreenElement&&document.exitFullscreen().catch(y=>{pe.addError(y)})}},[o]);const a=u?u.slides[c]:void 0;F.useEffect(()=>{if(!u||!a||!s.current)return;const d=s.current.getContext("2d");if(!d)return;const m=a.widthEmu*b,y=a.heightEmu*b,p=window.devicePixelRatio||1;s.current.width=m*p,s.current.height=y*p,d.resetTransform(),d.scale(p,p),rn(a,u,d)},[a,u]);const g=F.useCallback(()=>{u&&r(d=>Math.min(d+1,u.slides.length-1))},[u]),h=F.useCallback(()=>r(d=>Math.max(d-1,0)),[]),f=F.useCallback(d=>{switch(d.key){case"ArrowRight":case"ArrowDown":case" ":case"Enter":g();break;case"ArrowLeft":case"ArrowUp":h();break;case"Escape":document.fullscreenElement?document.exitFullscreen().catch(m=>{pe.addError(m)}):o();break}},[g,h,o]);return F.useEffect(()=>(window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)),[f]),Me.jsx("div",{ref:l,className:"fixed inset-0 flex items-center justify-center p-6",onClick:g,children:Me.jsx("canvas",{ref:s,className:"max-h-full max-w-full bg-white"})})}export{b as E,gn as S,dn as a,Nt as c,rn as d,ne as g};
//# sourceMappingURL=mmilw72p73kj15mv.js.map

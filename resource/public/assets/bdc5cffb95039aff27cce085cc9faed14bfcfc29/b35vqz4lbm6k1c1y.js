import{oi as j,bV as w,S as y,lU as b}from"./dmck639k4dv7claj.js";import{O as M,j as n,ah as C,e as N,a as k,f as A,i as F,M as p}from"./cs7toih8jegb7teq.js";import{c_ as W}from"./hnw079jsdm76umup.js";import{R as P,I as r,S as l}from"./i1yyxhrxmz4t7iae.js";import{E as R,R as U,g as T}from"./ftpzze3ierb8gm9m.js";import{u as O}from"./fg1z1tv7372twqew.js";import{c as D,W as I,a as B,d as L}from"./crerkmhvihiw48az.js";import{W as $}from"./fba6r4282q3hco9o.js";import"./oru2fxqyndtwb7c5.js";import"./ceo93mq020icv1xq.js";import"./ig3euz6ql417cw29.js";import"./lo4bvml5ypzzx0bg.js";import"./dp7t1jmnbbend843.js";import"./bti9u69vji4jff3k.js";import"./lco7biunzadofjpa.js";import"./gu3kz9694iumz76j.js";import"./eq5mxjsfi2cjwfyk.js";import"./dr58d0qi3ke74zcr.js";import"./kwms1ugj73bjxgnk.js";import"./mntlin6h4lg868yr.js";import"./dupxx6qfa09nz1fw.js";import"./mahhuo4zclh446vl.js";import"./l1m3l5lbmhuctzw6.js";import"./g9gr3l5lwhb3z8y8.js";import"./yf0i1e6tgcrdg1ll.js";import"./mcuu3cegz8rmschr.js";import"./o12mkc4t9o2t0ta8.js";function q(){const{environmentId:s}=M(),{eligible:i}=W();return i?n.jsx(C,{to:"/codex"}):s?n.jsx(z,{environmentId:s}):n.jsx(j,{})}function z({environmentId:s}){const i=N(),o=w(),g=k(),m=A(),{data:e,isLoading:h,isError:v}=D(s),c=e?.secrets??{},x=O()?"workspace":"private",{mutate:E,isPending:_}=F({mutationFn:t=>I.updateEnvironment(s,t),onSuccess:async t=>{await B(m,s),L(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function f(t){const a=T(t.secrets,c),S=t.envVars.reduce((d,u)=>(d[u.key]=u.value,d),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:S,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return n.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(y,{})}):v?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?n.jsxs(n.Fragment,{children:[n.jsxs(P,{className:"sticky top-0 px-4",children:[n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),n.jsx(l,{}),n.jsx(r,{label:e.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),n.jsx(l,{}),n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),n.jsx(R,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e?.label,description:e?.description??"",share_settings:e?.share_settings??x,machine:e?.machine_id,repositoryId:e?.repos[0],workspaceDirectory:e?.workspace_dir??"",agentNetworkAccess:e?.agent_network_access,setupCommands:e?.setup?Array.isArray(e?.setup)?e.setup.join(`
`):e.setup:"",maintenanceSetupCommands:e?.maintenance_setup?Array.isArray(e?.maintenance_setup)?e.maintenance_setup.join(`
`):e.maintenance_setup:"",envVars:Object.entries(e?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(c).map(t=>({key:t,value:U,isEditing:!1})),autoSetupSettings:e?.auto_setup_settings,cacheSettings:e?.cache_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:f,isPending:_})]}):n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(p,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const _e=()=>[{title:"Codex"}],fe=b(function(){return n.jsx(q,{})});export{fe as default,_e as meta};
//# sourceMappingURL=b35vqz4lbm6k1c1y.js.map

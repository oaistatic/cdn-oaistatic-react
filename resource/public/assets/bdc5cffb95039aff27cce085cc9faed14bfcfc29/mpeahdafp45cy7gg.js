import{R as l,lZ as E,e as A,p as w,aw as S,ax as R,bV as x,bd as _,bc as q,C as P,B as g,S as k}from"./dmck639k4dv7claj.js";import{u as y,q as N,g as C,r as j,a as B,e as m,f as I,i as M,d as O,j as o,M as u,O as T,b as F}from"./cs7toih8jegb7teq.js";async function Q(){return await l.safeGet("/amphora")}const p=N({queryKey:["amphora"],queryFn:Q,staleTime:1/0});function U(){return y(p).data}var d,v;function K(){if(v)return d;v=1;var e=E(),s=/[\\^$.*+?()[\]{}|]/g,i=RegExp(s.source);function n(r){return r=e(r),r&&i.test(r)?r.replace(s,"\\$&"):r}return d=n,d}var z=K();const D=C(z);function H(e=!0){return y({queryKey:["amphoraStrings"],staleTime:1/0,retry:!1,enabled:e,queryFn:async()=>{try{return await l.safeGet("/amphora/strings")}catch{return null}}})}function L(){const e=A(),s=w(e,"3989934672"),{data:i}=H(s);return j.useCallback(n=>!s||!i?n:Object.entries(i).reduce((r,[a,t])=>r.replace(new RegExp(D(a),"g"),t),n),[i,s])}const G=S(()=>R(()=>Promise.resolve().then(()=>$),void 0).then(e=>e.AcceptModal));function h(e,s){const i=B(),n=x(),r=m(),a=I();return M({mutationFn:async()=>{if(!e)throw new Error("Invalid amphora ID");return await l.safePost("/amphora/{amphora_id}/invite",{parameters:{path:{amphora_id:e}},requestBody:{choice:"accept"}})},onSuccess:async()=>{s?.onBeforeNavigate?.(),await a.invalidateQueries({queryKey:p.queryKey}),await a.invalidateQueries({queryKey:["amphoraInvite"]}),await a.prefetchQuery(p);const t=_?.AmphoraControls??"AmphoraControls";i(q(t))},onError:t=>{const b=t instanceof Error?t.message:String(t);n.danger(r.formatMessage(c.failedToAccept,{error:b}),{toastId:"amphora_accept_invite_failed"})}})}function f(e,s){const i=x(),n=m(),r=I();return M({mutationFn:async()=>{if(!e)throw new Error("Invalid amphora ID");return await l.safePost("/amphora/{amphora_id}/invite",{parameters:{path:{amphora_id:e}},requestBody:{choice:"reject"}})},onSuccess:async()=>{i.success(n.formatMessage(c.rejectedInvite)),await r.invalidateQueries({queryKey:["amphoraInvite"]}),s?.onSuccess?.()},onError:a=>{const t=a instanceof Error?a.message:String(a);i.danger(n.formatMessage(c.failedToReject,{error:t}),{toastId:"amphora_reject_invite_failed"})}})}function Y({invite:e,onClose:s}){const i=m(),n=L(),r=h(e.id,{onBeforeNavigate:s}),a=f(e.id,{onSuccess:s});return o.jsx(P,{testId:"modal-accept-amphora-invite",isOpen:!0,type:"success",onClose:s,children:o.jsxs("div",{className:"flex flex-col items-center pt-4",children:[o.jsx("div",{className:"pt-3.5 text-4xl leading-[42px] font-medium",children:o.jsx(u,{...c.amphoraInviteHeader,children:t=>n(t.join(""))})}),o.jsx("div",{className:"text-token-text-secondary pt-2 text-sm",children:o.jsx(u,{...c.invitedYouLabel,values:{inviterName:e.inviter_name,inviterEmail:e.inviter_email,role:n(i.formatMessage(e.role==="owner"?c.roleOwner:c.roleMember))}})}),o.jsxs("div",{className:"mt-10 flex gap-3",children:[o.jsx(g,{className:"rounded-xl bg-black text-lg leading-[22px] font-medium text-white dark:bg-white dark:text-black",size:"large",disabled:r.isPending,onClick:()=>r.mutate(),children:o.jsx(u,{...c.joinAmphoraButton,children:t=>n(t.join(""))})}),o.jsx(g,{className:"rounded-xl bg-red-600 text-lg leading-[22px] font-medium text-white dark:bg-red-400 dark:text-black",size:"large",disabled:a.isPending,onClick:()=>a.mutate(),children:o.jsx(u,{...c.rejectAmphoraButton})})]}),o.jsx("button",{className:"text-token-text-primary hover:text-token-text-secondary mt-4 text-sm font-medium hover:opacity-80",onClick:s,children:o.jsx(u,{...c.ignoreForNow})})]})})}function V(){const{amphora_id:e}=T(),[s]=F(),i=s.get("accept"),n=i==="true",r=i==="false",a=h(e),t=f(e);return j.useEffect(()=>{if(n){!a.isPending&&!a.isSuccess&&!a.isError&&a.mutate();return}r&&!t.isPending&&!t.isSuccess&&!t.isError&&t.mutate()},[n,r,a,a.isPending,a.isSuccess,a.isError,t,t.isPending,t.isSuccess,t.isError]),n||r?o.jsx("div",{className:"flex h-full w-full items-center justify-center p-8",children:o.jsx(k,{})}):null}const c=O({amphoraInviteHeader:{id:"amphora.acceptInvite.amphoraInviteHeader",defaultMessage:"Amphora Invite"},invitedYouLabel:{id:"amphora.acceptInvite.invitedYouLabel",defaultMessage:"{inviterName} ({inviterEmail}) invited you as a {role}"},joinAmphoraButton:{id:"amphora.acceptInvite.joinButton",defaultMessage:"Join amphora"},rejectAmphoraButton:{id:"amphora.acceptInvite.rejectButton",defaultMessage:"Reject invite"},ignoreForNow:{id:"amphora.acceptInvite.ignore",defaultMessage:"Ignore for now"},invalidInvite:{id:"amphora.acceptInvite.invalid",defaultMessage:"Sorry, this invite is invalid or has expired."},failedToAccept:{id:"amphora.acceptInvite.error",defaultMessage:"Failed to accept invite: {error}"},rejectedInvite:{id:"amphora.rejectInvite.success",defaultMessage:"Invite rejected successfully."},failedToReject:{id:"amphora.rejectInvite.error",defaultMessage:"Failed to reject invite: {error}"},roleMember:{id:"amphora.members.roleMember",defaultMessage:"Member_role"},roleOwner:{id:"amphora.members.roleOwner",defaultMessage:"Owner"}}),$=Object.freeze(Object.defineProperty({__proto__:null,AcceptInviteRoute:V,AcceptModal:Y,AcceptModalAsync:G,useAcceptAmphoraInvite:h,useRejectAmphoraInvite:f},Symbol.toStringTag,{value:"Module"}));export{V as A,U as a,G as b,D as e,L as u};
//# sourceMappingURL=mpeahdafp45cy7gg.js.map

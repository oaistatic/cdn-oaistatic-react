const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/i705jkmii07damkr.js","assets/cs7toih8jegb7teq.js","assets/hnw079jsdm76umup.js","assets/dmck639k4dv7claj.js","assets/root-mdlgku96.css","assets/conversation-small-b5ztx8w5.css","assets/jmutpw3uuo5feurd.js","assets/kidqhx39cn0s1bkp.js","assets/gqxnaj28dwt74usv.js","assets/dfhgw8mxn1h3ecpw.js","assets/lvw0n83hk2rqh8hr.js","assets/lyxm37ljpwg11a5m.js","assets/dvi0n1hal1hb8zit.js","assets/h7uur6c6f7ejw385.js","assets/kftq93ifet8ii8nr.js","assets/dupxx6qfa09nz1fw.js","assets/ollu4gfmf523hfew.js","assets/mcuu3cegz8rmschr.js","assets/ijbbvzexsuset1g7.js","assets/j016trxwqzgsccq0.js","assets/l32pbw1kg88xu4to.js","assets/hpvy2w8lok6hzrzn.js","assets/eyl7ijx1wpmshrrd.js","assets/iysim1t7gvw0uzqo.js","assets/o3o12ow19hpu30mg.js","assets/n8303igkzlzv9639.js","assets/g61ghrdmm0y010eo.js","assets/ns51nblw8ziscsgd.js","assets/iwgdhhiwpdtcgntl.js","assets/obbtqvjhg25u2clv.js","assets/gfmmw3q76hcr29sv.js","assets/lablqthzph6rqii3.js","assets/cpzr3d21k40i0t3y.js","assets/102lf40gtygmryn9.js","assets/ljj1p3s92okaif60.js","assets/mgmoe87nocb640xb.js","assets/o12mkc4t9o2t0ta8.js","assets/lflgzlgfd348gvw6.js","assets/dtz2gnda2vx03dil.js","assets/pbl95wx6493wq92j.js","assets/nsa6r7grrfqk0ahy.js","assets/djjpj5f1idix1hxg.js","assets/cot-message-jnujn6j8.css","assets/ebf4wf8pzc5pbhny.js","assets/lrrqf1wrtr1tx2vp.js","assets/hlzwxj9o6a2p2agm.js"])))=>i.map(i=>d[i]);
import{hI as Cs,aF as as,e as ws,b5 as Ds,k8 as Ls,eo as As,h_ as e,dq as N,o as Ps,U as Rs,nW as D,aw as _,P as ks,iy as Ms,nX as ns,z as os,e8 as is,bt as Is,mk as rs,bi as z,dI as Os,c as Bs,ee as Vs,ax as p,v as zs,N as Ns,fD as Js,ep as Ws}from"./dmck639k4dv7claj.js";import{r as w,j as n,M as Ks}from"./cs7toih8jegb7teq.js";import{am as Qs,an as Fs,ao as Hs,ap as Us,aq as J,ar as $s,as as Xs,at as Ys,au as Zs,av as qs,aw as Gs,ax as se,ay as ee,az as te,aA as ae,aB as ne,aC as oe,aD as ie,aE as re,aF as me,aG as ge,aH as le,aI as ce,aJ as ue,aK as ms,aL as _e,aM as fe,aN as de}from"./hnw079jsdm76umup.js";import{T as xe}from"./gqxnaj28dwt74usv.js";import{g as pe}from"./dfhgw8mxn1h3ecpw.js";const he=_(()=>p(()=>import("./i705jkmii07damkr.js"),__vite__mapDeps([0,1,2,3,4,5]))),ye=_(()=>p(()=>import("./jmutpw3uuo5feurd.js"),__vite__mapDeps([6,1,3,4]))),be=_(()=>p(()=>import("./kidqhx39cn0s1bkp.js"),__vite__mapDeps([7,1,3,4,8,2,5,9]))),ve=_(()=>p(()=>import("./lvw0n83hk2rqh8hr.js"),__vite__mapDeps([10,1,3,4,11,12,2,5,13,14,15]))),je=_(async()=>()=>null),Se=_(async()=>()=>null),Ee=_(async()=>(await p(()=>import("./ollu4gfmf523hfew.js"),__vite__mapDeps([16,3,1,4,13,2,5,17,14,15,18,19,20]))).ImageGenMessage),Te=_(()=>p(()=>import("./hpvy2w8lok6hzrzn.js"),__vite__mapDeps([21,1,3,4,2,5]))),Ce=_(()=>p(()=>import("./hnw079jsdm76umup.js").then(a=>a.wi),__vite__mapDeps([2,3,1,4,5])).then(a=>a.BrowsingMessage)),we=_(()=>p(()=>import("./eyl7ijx1wpmshrrd.js"),__vite__mapDeps([22,1,3,4,2,5])).then(a=>a.BrowserToolMessage)),De=_(()=>p(()=>import("./iysim1t7gvw0uzqo.js"),__vite__mapDeps([23,1,3,4,2,5])).then(a=>a.SearchResultMessage)),Le=_(()=>p(()=>import("./o3o12ow19hpu30mg.js"),__vite__mapDeps([24,1,3,4,25,2,5,11,12,26,27])).then(a=>a.JITPluginMessage)),Ae=_(()=>p(()=>import("./iwgdhhiwpdtcgntl.js"),__vite__mapDeps([28,3,1,4,29,2,5])).then(a=>a.DataAnalysisMessage)),Pe=_(()=>p(()=>import("./gfmmw3q76hcr29sv.js"),__vite__mapDeps([30,1,3,4,2,5,31,9]))),Re=_(()=>p(()=>import("./cpzr3d21k40i0t3y.js"),__vite__mapDeps([32,1,3,4,33,18,19,2,5,15,20,9,34,35,36,37,38,39,17,14,40,41,42])).then(a=>a.LegacyCoTMessage)),ke=_(()=>p(()=>import("./102lf40gtygmryn9.js"),__vite__mapDeps([33,1,3,4,18,19,2,5,15,20,9,34,35,36,37,38,39,17,14,40,41,42])).then(a=>a.CoT)),Me=_(()=>p(()=>import("./ebf4wf8pzc5pbhny.js"),__vite__mapDeps([43,1,3,4,2,5,44,45])).then(a=>a.JawboneMessage)),Ie=_(async()=>()=>null);function Oe(a){if(a.some(l=>l.type===e.SearchGPTQuery)){const f=a.filter(g=>g.type===D).flatMap(g=>g.groups),o=f.flatMap(g=>g.messages.map(r=>r.metadata?.search_turns_count)).findLast(g=>g!=null);return o!=null?o>1:function(){const r=f.filter(y=>y.type===e.StructuredThoughts),d=f.filter(y=>y.type===e.CoTSearchTool),c=(()=>{function y(x){return x.type===e.StructuredThoughts&&x.messages.flatMap(u=>u.content).some(u=>u.content_type===Js.StructuredThoughts&&u.thoughts.length>0)}let v=!1;for(const x of f)if(x.type===e.CoTSearchTool)v=!0;else if(y(x)&&v)return!0;return!1})();return r.length>1||d.length>1||c}()}return!0}function Be(a,l){return a.type===D?N(a.groups)?.messages[0].metadata?.is_visually_hidden_reasoning_group&&l===0:!1}function He({groupedMessagesToRender:a,allMessages:l,allGroupedMessages:f,clientThreadId:o,isUserTurn:g,isCompletionRequestInProgress:r,isFeedbackEnabled:d,isFinalTurn:c,isFinalUserTurn:y,isFinalAssistantTurn:v,turnIndex:x,hasActiveRequest:u,onRequestCompletion:I,shouldGrowContainer:P=!0,isParagen:W=!1,renderingView:gs="chat",isAgentTurn:R=!1,isKAUR1BR5:ls=!1,query:cs=null,wasInterrupted:us=!1,lastAgentMetadataNode:K}){const{showDebugConversationTurns:Q}=Cs(),[L]=as(o,s=>[s?.mode]),F=ws(),H=Ds(o),U=Ls(o),_s=Qs(),fs=Fs(),$=As(()=>fe(Ws(F,o)).pinnedMessageId$()),ds=f.some(s=>s.type===e.Browsing||s.type===e.RetrievalBrowsing||s.type===e.SearchGPTQuery||s.type===e.n7jupd),xs=as(o,s=>{for(let t=l.length-1;t>=0;t--){const m=l[t],b=s?.tree.getNodeIfExists(m.id)?.message,S=b?de(b):void 0;if(S)return Object.assign({clientThreadId:o,messageId:l[t].id},S)}}),ps=Hs(()=>zs.count(Ns.DEFAULT,"conversation_turn_grouped_messages.attempted_render_missing_type_f959b8c")),O=N(l),hs=Ps(Rs.DeveloperMode),X=Us({clientThreadId:o,conversationMode:L}),ys=w.useCallback(({sourceEvent:s,requestedModelId:t,appendMessages:m,extraStreamParams:b,isReasoningSkipped:S,isAgentTurn:j})=>{O&&X({sourceEvent:s,nodeId:O.id,requestedModelId:t,appendMessages:m,extraStreamParams:b,isReasoningSkipped:S,isAgentTurn:j})},[O,X]),bs=J(a,s=>s.type!==e.Debug),B=a.map((s,t)=>{const m=R?t===bs:t===f.length-1,b=Oe(a),S=Be(s,t),j=t===f.length-1?void 0:f[t+1],js=j?.type===D?j.groups.at(-1):j,ss=t===0?void 0:a[t-1],V=ss?.type!==D?ss:void 0,es=V?.type,ts=V?.messages,Ss=l?.filter(i=>i.metadata?.python_citation||i.metadata?.container_citation);if(s.type===D){const i=s.groups[0].messages[0];return!b||S?null:n.jsx(ke,{isStreaming:c&&m&&r,latestError:xs,isFinalAssistantTurn:v,messageGroups:s.groups,nextMessageGroup:js,prevMessageGroup:V,isAutoswitchOptOutEnabled:!!i.metadata?.classifier_response,handleSkipClick:h=>{ks.logEventWithStatsig("chatgpt_web_autoswitch_reasoning_skip_clicked","chatgpt_web_autoswitch_reasoning_skip_clicked",{conversationId:o,messageId:s.groups[0].messages[0].id}),H&&ys({sourceEvent:h,requestedModelId:H.id,isReasoningSkipped:!0,isAgentTurn:R})},isAgentTurn:R,isKAUR1BR5:ls,wasInterrupted:us,lastAgentMetadataNode:K},"cot-"+i.id)}const Es=s&&!Ms(s.messages[0]),Ts=ds&&Es,E=[];if(Ts||E.push(n.jsx(xe,{className:"min-h-8",message:s.messages[0],isFeedbackEnabled:d,isFinalUserTurn:y,isCompletionInProgress:m&&r,hasActiveRequest:u,turnIndex:x,clientThreadId:o,isUserTurn:g,prevGroupedMessageType:es,prevGroupedMessages:ts,citableMessages:Ss},"text-message-"+s.messages[0].id)),Q&&E.push(n.jsx(Ie,{clientThreadId:o,message:s.messages[0]},"message-debug-"+s.messages[0].id)),s.type===e.Text&&s.messages[0].metadata?.[ns]){const i=s.messages[0].metadata[ns];return n.jsxs(w.Fragment,{children:[n.jsx($s,{browserContextMetadata:i,className:os(pe(!0),"mb-1","block")}),E]},"group-"+s.messages[0].id)}switch(s.type){case e.Text:case e.MultiText:return s.type===e.Text?n.jsxs(w.Fragment,{children:[E,R&&n.jsx(oe,{currentGroupedMessage:s,isLastMessage:m,isLastTurnInConversation:c,clientThreadId:o,turnIndex:x,lastAgentMetadataNode:K}),n.jsx(ie,{isUserTurn:g,message:s.messages[0]}),n.jsx(re,{isUserTurn:g,message:s.messages[0],clientThreadId:o})]},"group-"+s.messages[0].id):s.type===e.MultiText?n.jsx(be,{clientThreadId:o,messages:s.messages,isCompletionInProgress:m&&r,isFeedbackEnabled:d,hasActiveRequest:u,prevGroupedMessageType:es,prevGroupedMessages:ts},"multitext-"+(s.messages[0]?.id??t)):s.type;case e.PIMBlock:{const i=N(l);return L&&i?n.jsx(ne,{isFinalTurn:c,hasActiveRequest:u,conversationMode:L,clientThreadId:o,justification:i.metadata?.pim_justification,flaggedMessageId:i.metadata?.pim_message_id,children:E}):null}case e.n7jupd_n:return n.jsx(ae,{});case e.Browsing:case e.RetrievalBrowsing:{const i=L!=null&&[z.GizmoInteraction,z.GizmoMagicCreate,z.GizmoTest].includes(L.kind),h=U?Os(U):!1;return n.jsx(Ce,{messages:s.messages,isRequestActive:u,isLastMessageInTurn:m,isUsingGizmo:i,isUsingSnorlax:h,isRetrieval:s.type===e.RetrievalBrowsing},"browsing-"+(s.messages[0]?.id??t))}case e.kaur1br5:return n.jsx(we,{messages:s.messages,isRequestActive:u,isLastMessageInTurn:m,clientThreadId:o},"kaur1br5-tool-"+(s.messages[0]?.id??t));case e.SearchGPTQuery:{if(a.some(C=>C.type===D)&&b)return null;const h=a.slice(t+1).findLast(C=>C.type===e.Text||C.type===e.CoTSearchTool),T=l.findLast(C=>rs(C).length>0);return n.jsx(te,{clientThreadId:o,turnIndex:x,isRequestActive:u,isLastMessage:m,isLastTurnInConversation:c,nextMessage:h?.messages[0],searchResultGroups:rs(T),query:cs},"searchquery-"+(s.messages[0]?.id??t))}case e.StructuredThoughts:return null;case e.ReasoningRecap:return null;case e.n7jupd:return null;case e.n7jupd_native_api_tool:case e.n7jupd_i:case e.n7jupd_a:case e.n7jupd_x:return null;case e.a8km123:{if(!s.messages.every(h=>!h.metadata?.reasoning_status)){const h=J(l,T=>T.author.role===Is.Assistant&&T.recipient==="all");return n.jsx(Re,{clientThreadId:o,turnIndex:x,isStreaming:(m||h<t)&&r,isFinalAssistantTurn:v,messages:s.messages},"sum-"+(s.messages[0]?.id??t))}return n.jsx(Pe,{messages:s.messages,isStreaming:m&&r,isCompletionRequestInProgress:r,hasActiveRequest:u,isLastMessage:m,isFinalTurn:c,isFeedbackEnabled:d,clientThreadId:o,currentGroupedMessageIndex:t,turnIndex:x},"sum-"+(s.messages[0]?.id??t))}case e.f959b8c:return ps(),null;case e.is_loading_message:if(m&&r){const i=s.messages[0],h=is(i);return n.jsx(ee,{text:h},"loading-message-"+t)}else return null;case e.b47u8ra0_t:{const i=s.messages[0],h="Reference Browser Memories?",T=is(i);return n.jsx(se,{title:h,description:T,settingsTab:i.metadata?.b47u8ra0_t??"general",clientThreadId:o,parentMessageId:i.id},"b47u8ra0_t-"+t)}case e.c12k321:return null;case e.l1p9k3u:return null;case e.b1de6e2_c:return n.jsx(Gs,{messages:s.messages,clientThreadId:o,isLastMessage:m},"b1de6e2-"+(s.messages[0]?.id??t));case e.b1de6e2_s:return n.jsx(qs,{messages:s.messages,clientThreadId:o},"b1de6e2_s-"+(s.messages[0]?.id??t));case e.b1de6e2_d:return null;case e.b1de6e2_rm:return n.jsx(Zs,{messages:s.messages,clientThreadId:o,renderingView:gs,children:E},"b1de6e2_rm-"+(s.messages[0]?.id??t));case e.de1d73e:if(_s){const i=t+1<f.length?f[t+1]:void 0;return n.jsx(Me,{clientThreadId:o,currentGroupedMessage:s,nextMessage:i&&i.type===e.Text?i.messages[0]:void 0,isLastMessage:m,isRequestActive:u},"jawbone-"+(s.messages[0]?.id??t))}else return null;case e.ParallelBrowsing:return n.jsx(Te,{messages:s.messages},"parallel-"+(s.messages[0]?.id??t));case e.CodeInterpreter:return n.jsx(Ae,{messages:s.messages,isRequestActive:u,clientThreadId:o},"ada-"+(s.messages[0]?.id??t));case e.JITPlugin:return fs&&$&&s.messages.find(i=>i.id===$)?null:n.jsx(Le,{messages:s.messages,nextMessage:j?.type===e.JITPlugin?j.messages[0]:void 0,clientThreadId:o,isLastTurnInConversation:c,isLastMessageInTurn:m,allowInspectingArguments:hs.data===!0,onRequestCompletion:I},"jit-"+(s.messages[0]?.id??t));case e.t2uay3k:return n.jsx(Ee,{messages:s.messages,clientThreadId:o,isParagen:W,isLastTurnInConversation:c},"t2uay3k-"+(s.messages[0]?.id??t));case e.Dalle:return n.jsx(ve,{messages:s.messages,clientThreadId:o,disableClickThru:W},"dalle-"+(s.messages[0]?.id??t));case e.GizmoEditor:return n.jsx(he,{messages:s.messages},"gizmo-editor-"+(s.messages[0]?.id??t));case e.oiw209h:return n.jsx(je,{messages:s.messages,clientThreadId:o},"oiw209h-"+(s.messages[0]?.id??t));case e.n7jupd_p:return n.jsx(Ys,{});case e.Canmore:return n.jsx(Xs,{messages:s.messages,allTurnMessages:l,isFinalTurn:c,isRequestActive:u,clientThreadId:o,isUserTurn:g},"canmore-"+(s.messages[0]?.id??t));case e.Container:case e.Oboe:return null;case e.Croquette:return null;case e.Debug:return Q?n.jsx(ye,{message:s.messages[0]},"debug-"+s.messages[0].id):null;case e.SearchResult:return n.jsx(De,{messages:s.messages},"search-result-"+(s.messages[0]?.id??t));case e.Mochi:return null;case e.CoTSearchTool:return null;case e.SuperWidget:return null;case e.n7jupd_image_gen:return null;case e.e1ld0dvz:return null;case e.Glaux:return n.jsx(Se,{messages:s.messages,isLastMessage:m},"glaux-"+s.messages[0].id)}}),vs=ue(),{wordFadeType:A,animationDurationMs:Y}=me(),k=w.useRef([]),Z=w.useRef(void 0),q=w.useRef(null),M=!g&&c&&r,G=l[0]?.id;return Bs(()=>{if(A!=="indexed"||!M)return;const s=q.current;if(!s)return;Z.current!==G&&(Z.current=G,k.current=[]);const t=s.getAnimations({subtree:!0}).filter(m=>m.animationName===ms["fade-in"]);if(t.length!==0){const m=Ne({now:performance.now(),previousStartTimes:k.current,groupCount:t.length});k.current=m;for(let b=0;b<t.length;b++)t[b].startTime=m[b]}else k.current=[]},[B,A,M]),n.jsx("div",{className:os({"flex max-w-full flex-col":!0,[ms.root]:A==="indexed"&&M,grow:P}),style:A==="indexed"?{"--duration":`${Y}ms`}:void 0,ref:q,children:n.jsx(Vs,{name:"GroupedMessages",fallback:Ve,children:g?B:n.jsxs(ge,{isDisabled:!M||A!=="delay",defaultAnimationDurationPerSegmentMs:Y,children:[le(F)&&c&&n.jsx(ce,{isStreaming:r,debug:vs}),B]},l[0]?.id)})})}function Ve({error:a}){return n.jsxs(_e,{type:"danger",children:[n.jsx(Ks,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."}),!1]})}function ze(a,l,f){if(a.length<2||l<=0)return 0;const o=l/Math.log(2);a=[...a].sort((d,c)=>d-c);let g=0,r=0;for(let d=a.length-1;d>0;--d){const c=Math.exp(-(f-a[d])/o);if(g>0&&c/g<.01)break;const y=a[d]-a[d-1];g+=c,r+=c*y}return g===0?0:g/r}function Ne({now:a,previousStartTimes:l,groupCount:f,initialRate:o=50,halfLife:g=1}){const r=l.slice(0,J(l,x=>x<=a)+1),d=r.length<2?o/1e3:Math.max(.01,ze(r,g*1e3,a)),c=f-r.length;let y=r[r.length-1]??0,v=1;for(let x=0;x<c;x++){const u=d*1e3*v;c<u?v*=.8:c>u&&(v*=1.5);const I=1/(d*v),P=Math.max(a,y+I);r.push(P),y=P}return r}export{He as C};
//# sourceMappingURL=nlxagrvvx9r77jf7.js.map

import{j as e,e as w,M as L,g as ae,r as M,m as W}from"./cs7toih8jegb7teq.js";import{m as G,i as se,d as ne,b as oe,T as le}from"./zpmtm193hf9al87a.js";import{jG as de,d4 as re,cX as V,eP as ce,eE as _,ja as ie,l5 as me,c as xe,c$ as X,d3 as fe,l6 as ue,l7 as he,l8 as be,N as pe}from"./hnw079jsdm76umup.js";import{u as ge,c as je,D as ye}from"./de5hn4293vtnpm6c.js";import{aN as Z,z as j,d1 as y,de as k,B as z,q2 as ve,dq as ke,kV as J}from"./dmck639k4dv7claj.js";import{S as Ne}from"./2xaoxu5jomggldkq.js";import{t as Ce}from"./fna9z31n721lpf9f.js";import{C as $,T as Me}from"./eh7uqg5mp7upirpn.js";import{g as we}from"./btagl6w1gub4aw61.js";import"./ns51nblw8ziscsgd.js";import"./jy1u8exw8iz2slve.js";import"./kwms1ugj73bjxgnk.js";import"./g61ghrdmm0y010eo.js";import"./cm813h9bptrniota.js";import"./kl7c6054usfnqmd4.js";import"./mia7qmdupqoji40k.js";import"./dfaaf8463nahnfzk.js";function Se({textdocVersion:l,clientThreadId:o}){const{handleCopy:d,copyLabel:m}=ge({textdocVersion:l,clientThreadId:o}),r=!Z();return e.jsx(de,{onCopy:d,className:"px-1.5 py-1",iconClassName:j("icon-md",!r&&"hidden"),iconOnly:r,buttonText:r?void 0:m})}function Ee({textdocVersion:l,isDisabled:o=!1}){const d=w(),{handleFileDownload:m,handleBlobDownload:r,isLoading:h,downloadCopyLabel:f,isDocument:a}=je(l);return o||=h||!l||l.type===re.LOADING,a?e.jsxs(y.Root,{open:!h&&!o?void 0:!1,children:[e.jsx(y.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:f,children:e.jsx(V,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{align:"end",children:[e.jsx(y.Item,{onClick:t=>{t.preventDefault(),m("pdf")},children:d.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),m("docx")},children:d.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),m("md")},children:d.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:f,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,onClick:r,children:e.jsx(V,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,onClick:r,children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function Be({onClick:l}){const o=w();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:l,children:[e.jsx(k,{label:e.jsx(L,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(ce,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:o.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Te({onClick:l,disabled:o,isCodePreviewable:d}){const r=w().formatMessage(d?G.previewCode:G.runCode);return o?e.jsx(z,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(k,{label:e.jsx(L,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(_,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:r})]})}):e.jsxs(z,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:l,disabled:!1,children:[e.jsx(k,{label:e.jsx(L,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(_,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:r})]})}var D,K;function De(){if(K)return D;K=1;var l=me(),o=ie(),d=ve(),m=parseFloat,r=Math.min,h=Math.random;function f(a,t,c){if(c&&typeof c!="boolean"&&o(a,t,c)&&(t=c=void 0),c===void 0&&(typeof t=="boolean"?(c=t,t=void 0):typeof a=="boolean"&&(c=a,a=void 0)),a===void 0&&t===void 0?(a=0,t=1):(a=d(a),t===void 0?(t=a,a=0):t=d(t)),a>t){var s=a;a=t,t=s}if(c||a%1||t%1){var u=h();return r(a+u*(t-a+m("1e-"+((u+"").length-1))),t)}return l(a,t)}return D=f,D}var Le=De();const Ae=ae(Le),Re=({isCanvasHovered:l=!1,onClick:o})=>{const d=w();return e.jsx(k,{label:d.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(pe,{color:l?"primary":"secondary",icon:Ne,onClick:o})})},qe=({textdocId:l,clientThreadId:o,name:d,tag:m,icon:r,iconSelected:h,marginBottom:f,size:a="large",height:t=a==="large"?"22rem":"10rem",minHeight:c,isCanvasOpen:s=!1,isDisabled:u=!1,isFocused:b=!1,isInferring:S=!1,isInlinePreview:n=!1,isStreaming:p=!1,isUserMessage:g=!1,onClick:N,onPreview:E,children:B})=>{const T=M.useRef(null),[v,A]=M.useState(!1),[Q]=M.useState(()=>Ae(100,180,!1)),Y=xe(l),x=ke(Y?.versions),i=X(),C=!i,U=x==null||p,R=!!x&&se(x.type,x.content),P=!!x&&ne(x.type),I=R||P,q=b&&s?h??r:r,O=q?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!v}),children:q}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(J,{lines:1,size:"base",width:100,widthVariance:0})}),F=x?.type&&fe(x.type)?oe(x.type):void 0,H=!d||S?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:Q},children:e.jsx(J,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":i}),children:d}),i&&F&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",F]})]}),ee=()=>{!T.current||u||(ue.logButtonClick(he.MESSAGE_ATTACHMENT,{type:m}),be(T.current),N?.())},te=Z();return e.jsxs(W.div,{role:C?"button":void 0,id:we(l),initial:{opacity:p?0:1,scale:p?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:i?0:.72},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",i?"overflow-visible":"overflow-hidden",u?"cursor-default":C?"cursor-pointer":"cursor-text",{"select-none":C,"border-token-text-tertiary font-medium dark:border-gray-600":b&&s,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!n,"rounded-3xl":!s&&n,"max-w-full":!g&&(s||!n),"max-w-[var(--user-chat-width,70%)]":g&&(s||!n),[te?"w-full":`${Ce.tableContainer} rounded-none`]:!g&&!s&&n,"w-[var(--user-chat-width,70%)]":g&&!s&&n,"w-full pt-1 pb-3 sm:max-w-none":n&&i}),onMouseEnter:()=>!u&&A(!0),onMouseLeave:()=>A(!1),onClick:()=>C?ee():void 0,ref:T,style:{marginBottom:f,height:n&&!s?t:void 0,minHeight:n&&!s?c:void 0,width:a==="small"?"300px":void 0},children:[!(i&&n)&&e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!v&&!b,"border-token-border-heavy":v&&!b,"text-token-text-primary text-sm font-medium":!s&&v&&n,"py-2":s||!n,"py-3":!i&&!s&&n,"text-token-text-secondary text-sm font-medium":!s&&!v&&n,"pt-0 pb-2 sm:px-6":i}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":s||!n,"gap-3.5":!s&&n}),children:[!i&&O,H]}),s?e.jsx(W.span,{animate:p?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:p&&e.jsx(le,{gap:1,padding:0})}):e.jsx(Re,{isCanvasHovered:v,onClick:N})]}),i&&n&&!u?e.jsx("div",{className:"thread-xl:-top-[var(--header-height)] sticky top-0 z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:j("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:H}),e.jsx("div",{className:"flex items-center justify-end",children:i&&!s?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Se,{textdocVersion:x??null,clientThreadId:o})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Be,{onClick:N})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ee,{isDisabled:U,textdocVersion:x??null})}),I&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Te,{isCodePreviewable:R,disabled:p,onClick:E})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&B,n&&!s&&!i&&e.jsx($,{size:a,position:"bottom"}),n&&a==="small"&&!s&&!i&&e.jsx($,{size:a,position:"right"})]})]})},Oe=({textdocId:l,clientThreadId:o,name:d,tag:m,icon:r,iconSelected:h,isCanvasOpen:f=!1,isFetching:a=!1,isFocused:t=!1,isInlinePreview:c=!1,isStreaming:s=!1,isUserMessage:u=!1,onClick:b,onPreview:S})=>{const[n,p]=M.useState(!1),g=X(),N=B=>{p(B>0)},E=c&&!f?16:12;return e.jsx(qe,{textdocId:l,name:d,tag:m,icon:r,height:g?"auto":void 0,iconSelected:h,marginBottom:E,isCanvasOpen:f,isFocused:t,isInlinePreview:c,isStreaming:s,isUserMessage:u,onClick:b,onPreview:S,clientThreadId:o,children:c&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":n,"border-transparent":!n}),children:a&&!(g&&s)?e.jsx(ye,{numLines:20}):!!l&&e.jsx(Me,{disableScroll:g,onScroll:N,textdocId:l,clientThreadId:o})})})};export{Oe as CanvasMessageAttachment,qe as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=n287g6eluxwl70wn.js.map

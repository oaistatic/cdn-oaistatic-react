import{dy as qe,sF as Ge,sG as $e,sH as Ke,sI as q,sJ as We,sK as ze,sL as U,sM as j,sN as me,sO as Ve,sP as Ye,sQ as de,sR as G,sS as $,sT as K,sU as L,p_ as ge,eQ as Qe,dd as Xe,sV as he,sW as W,sX as Je,sY as Ze,i as et,k5 as tt}from"./hnw079jsdm76umup.js";import{e as nt,f6 as st,P as x,z as rt,aH as ot,v as E,N as A,b3 as ye,tI as S,tJ as z,tK as at,tL as it,tM as be,tN as ct,aI as lt,bV as ut,de as ft,S as pt,oq as mt,or as _e,R as dt,a1 as gt,hG as ht,ao as we,hH as B,bi as yt,bj as bt,b9 as _t,du as wt,tO as Nt,H as xt,bb as Ct,fR as kt,hR as _,tu as St,tv as Et,h4 as V,qW as Ne,m9 as O,ma as xe,nS as At,tP as Lt}from"./dmck639k4dv7claj.js";import{r as b,j as d,R as I,f as Dt,e as vt,d as Rt,u as Tt}from"./cs7toih8jegb7teq.js";import{r as Ot}from"./mntlin6h4lg868yr.js";import{r as Pt,a as Mt,b as Ft}from"./ci3idol558isr68b.js";import{k as Y}from"./pc2givv05uuq8g6l.js";const Q={},X={},J={};function Z(e,s){return`${e}::${s}`}function Ut({node:e,onClick:s,children:n,clientThreadId:t,messageId:r,href:i,disableSafeURLs:o,...a}){let c=s;const l=e?.properties?.href,u=b.useContext(qe),f=nt(),w=st(t),m=Ge(w,i,u?.useSafeUrls&&!o),g=$e(t,r)?.metadata?.__internal?.utm_tags??{},h=Ke(t),C=!o&&m===void 0;return r!=null&&typeof l=="string"&&l.includes("/bing/redirect")&&(Q[r]||(x.logEvent("Browsing Show Bing Link",{id:r,content:l}),Q[r]=!0),c=N=>{X[r]||(x.logEvent("Browsing Click Bing Link",{id:r,content:l}),X[r]=!0),s?.(N)}),c=N=>{const v=""+l;if(r&&!J[Z(r,v)]){const He=m||C?"URL Clicked Allowed":"URL Clicked Blocked";x.logEvent(He,{id:r,content:v}),J[Z(r,v)]=!0}s?.(N),C&&i&&(N.preventDefault(),ot(f,We,{urls:q(i,g,h)}))},d.jsx(d.Fragment,{children:d.jsx("a",{onClick:c,...a,className:rt(a.className,C&&"cursor-pointer"),href:m&&q(m,g,h),rel:"noopener",children:n})})}const jt="w";function Bt({messageId:e,clientThreadId:s,text:n,children:t,...r}){const o=`${window.location.origin}?q=${encodeURIComponent(n)}`,a=ze(),c=b.useCallback(async l=>{l.preventDefault(),E.count(A.DEFAULT,"instant_follow_up_anchor_clicked"),x.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:s,messageId:e}),a(l,{text:n,type:ye.Reply},[],0)},[s,e,n,a]);return d.jsx(Ut,{...r,href:o,disableSafeURLs:!0,clientThreadId:s,messageId:e,className:"cursor-pointer",onClick:c,children:t})}const Ps=I.memo(Bt),It=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],ee={}.hasOwnProperty;function Ht(e,s){const n=s||{};function t(r,...i){let o=t.invalid;const a=t.handlers;if(r&&ee.call(r,e)){const c=String(r[e]);o=ee.call(a,c)?a[c]:t.unknown}if(o)return o.call(this,r,...i)}return t.handlers=n.handlers||{},t.invalid=n.invalid,t.unknown=n.unknown,t}const qt=/^>|^->|<!--|-->|--!>|<!-$/g,Gt=[">"],$t=["<",">"];function Kt(e,s,n,t){return t.settings.bogusComments?"<?"+S(e.value,Object.assign({},t.settings.characterReferences,{subset:Gt}))+">":"<!--"+e.value.replace(qt,r)+"-->";function r(i){return S(i,Object.assign({},t.settings.characterReferences,{subset:$t}))}}function Wt(e,s,n,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}const p=ke(1),Ce=ke(-1),zt=[];function ke(e){return s;function s(n,t,r){const i=n?n.children:zt;let o=(t||0)+e,a=i[o];if(!r)for(;a&&U(a);)o+=e,a=i[o];return a}}const Vt={}.hasOwnProperty;function Se(e){return s;function s(n,t,r){return Vt.call(e,n.tagName)&&e[n.tagName](n,t,r)}}const H=Se({body:Qt,caption:R,colgroup:R,dd:en,dt:Zt,head:R,html:Yt,li:Jt,optgroup:tn,option:nn,p:Xt,rp:te,rt:te,tbody:rn,td:ne,tfoot:on,th:ne,thead:sn,tr:an});function R(e,s,n){const t=p(n,s,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&U(t.value.charAt(0)))}function Yt(e,s,n){const t=p(n,s);return!t||t.type!=="comment"}function Qt(e,s,n){const t=p(n,s);return!t||t.type!=="comment"}function Xt(e,s,n){const t=p(n,s);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function Jt(e,s,n){const t=p(n,s);return!t||t.type==="element"&&t.tagName==="li"}function Zt(e,s,n){const t=p(n,s);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function en(e,s,n){const t=p(n,s);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function te(e,s,n){const t=p(n,s);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function tn(e,s,n){const t=p(n,s);return!t||t.type==="element"&&t.tagName==="optgroup"}function nn(e,s,n){const t=p(n,s);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function sn(e,s,n){const t=p(n,s);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function rn(e,s,n){const t=p(n,s);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function on(e,s,n){return!p(n,s)}function an(e,s,n){const t=p(n,s);return!t||t.type==="element"&&t.tagName==="tr"}function ne(e,s,n){const t=p(n,s);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const cn=Se({body:fn,colgroup:pn,head:un,html:ln,tbody:mn});function ln(e){const s=p(e,-1);return!s||s.type!=="comment"}function un(e){const s=new Set;for(const t of e.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(s.has(t.tagName))return!1;s.add(t.tagName)}const n=e.children[0];return!n||n.type==="element"}function fn(e){const s=p(e,-1,!0);return!s||s.type!=="comment"&&!(s.type==="text"&&U(s.value.charAt(0)))&&!(s.type==="element"&&(s.tagName==="meta"||s.tagName==="link"||s.tagName==="script"||s.tagName==="style"||s.tagName==="template"))}function pn(e,s,n){const t=Ce(n,s),r=p(e,-1,!0);return n&&t&&t.type==="element"&&t.tagName==="colgroup"&&H(t,n.children.indexOf(t),n)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function mn(e,s,n){const t=Ce(n,s),r=p(e,-1);return n&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&H(t,n.children.indexOf(t),n)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}const D={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function dn(e,s,n,t){const r=t.schema,i=r.space==="svg"?!1:t.settings.omitOptionalTags;let o=r.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(e.tagName.toLowerCase());const a=[];let c;r.space==="html"&&e.tagName==="svg"&&(t.schema=j);const l=gn(t,e.properties),u=t.all(r.space==="html"&&e.tagName==="template"?e.content:e);return t.schema=r,u&&(o=!1),(l||!i||!cn(e,s,n))&&(a.push("<",e.tagName,l?" "+l:""),o&&(r.space==="svg"||t.settings.closeSelfClosing)&&(c=l.charAt(l.length-1),(!t.settings.tightSelfClosing||c==="/"||c&&c!=='"'&&c!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!H(e,s,n))&&a.push("</"+e.tagName+">"),a.join("")}function gn(e,s){const n=[];let t=-1,r;if(s){for(r in s)if(s[r]!==null&&s[r]!==void 0){const i=hn(e,r,s[r]);i&&n.push(i)}}for(;++t<n.length;){const i=e.settings.tightAttributes?n[t].charAt(n[t].length-1):void 0;t!==n.length-1&&i!=='"'&&i!=="'"&&(n[t]+=" ")}return n.join("")}function hn(e,s,n){const t=me(e.schema,s),r=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,i=e.settings.allowDangerousCharacters?0:1;let o=e.quote,a;if(t.overloadedBoolean&&(n===t.attribute||n==="")?n=!0:(t.boolean||t.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const c=S(t.attribute,Object.assign({},e.settings.characterReferences,{subset:D.name[r][i]}));return n===!0||(n=Array.isArray(n)?(t.commaSeparated?Ve:Ye)(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?c:(e.settings.preferUnquoted&&(a=S(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:D.unquoted[r][i]}))),a!==n&&(e.settings.quoteSmart&&z(n,o)>z(n,e.alternative)&&(o=e.alternative),a=o+S(n,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?D.single:D.double)[r][i],attribute:!0}))+o),c+(a&&"="+a))}const yn=["<","&"];function Ee(e,s,n,t){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?e.value:S(e.value,Object.assign({},t.settings.characterReferences,{subset:yn}))}function bn(e,s,n,t){return t.settings.allowDangerousHtml?e.value:Ee(e,s,n,t)}function _n(e,s,n,t){return t.all(e)}const wn=Ht("type",{invalid:Nn,unknown:xn,handlers:{comment:Kt,doctype:Wt,element:dn,raw:bn,root:_n,text:Ee}});function Nn(e){throw new Error("Expected node, not `"+e+"`")}function xn(e){const s=e;throw new Error("Cannot compile unknown node `"+s.type+"`")}const Cn={},kn={},Sn=[];function En(e,s){const n=s||Cn,t=n.quote||'"',r=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:An,all:Ln,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||It,characterReferences:n.characterReferences||kn,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?j:de,quote:t,alternative:r}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function An(e,s,n){return wn(e,s,n,this)}function Ln(e){const s=[],n=e&&e.children||Sn;let t=-1;for(;++t<n.length;)s[t]=this.one(n[t],t,e);return s.join("")}function Dn(e){const s=this,n={...s.data("settings"),...e};s.compiler=t;function t(r){return En(r,n)}}const se=/[#.]/g;function vn(e,s){const n=e||"",t={};let r=0,i,o;for(;r<n.length;){se.lastIndex=r;const a=se.exec(n),c=n.slice(r,a?a.index:n.length);c&&(i?i==="#"?t.id=c:Array.isArray(t.className)?t.className.push(c):t.className=[c]:o=c,r+=c.length),a&&(i=a[0],r++)}return{type:"element",tagName:o||s||"div",properties:t,children:[]}}const Rn=new Set(["button","menu","reset","submit"]),P={}.hasOwnProperty;function Ae(e,s,n){const t=n&&Mn(n);function r(i,o,...a){let c=-1,l;if(i==null){l={type:"root",children:[]};const u=o;a.unshift(u)}else if(l=vn(i,s),l.tagName=l.tagName.toLowerCase(),t&&P.call(t,l.tagName)&&(l.tagName=t[l.tagName]),Tn(o,l.tagName)){let u;for(u in o)P.call(o,u)&&On(e,l.properties,u,o[u])}else a.unshift(o);for(;++c<a.length;)M(l.children,a[c]);return l.type==="element"&&l.tagName==="template"&&(l.content={type:"root",children:l.children},l.children=[]),l}return r}function Tn(e,s){return e==null||typeof e!="object"||Array.isArray(e)?!1:s==="input"||!e.type||typeof e.type!="string"?!0:"children"in e&&Array.isArray(e.children)?!1:s==="button"?Rn.has(e.type.toLowerCase()):!("value"in e)}function On(e,s,n,t){const r=me(e,n);let i=-1,o;if(t!=null){if(typeof t=="number"){if(Number.isNaN(t))return;o=t}else typeof t=="boolean"?o=t:typeof t=="string"?r.spaceSeparated?o=G(t):r.commaSeparated?o=$(t):r.commaOrSpaceSeparated?o=G($(t).join(" ")):o=re(r,r.property,t):Array.isArray(t)?o=t.concat():o=r.property==="style"?Pn(t):String(t);if(Array.isArray(o)){const a=[];for(;++i<o.length;){const c=re(r,r.property,o[i]);a[i]=c}o=a}if(r.property==="className"&&Array.isArray(s.className)){const a=o;o=s.className.concat(a)}s[r.property]=o}}function M(e,s){let n=-1;if(s!=null)if(typeof s=="string"||typeof s=="number")e.push({type:"text",value:String(s)});else if(Array.isArray(s))for(;++n<s.length;)M(e,s[n]);else if(typeof s=="object"&&"type"in s)s.type==="root"?M(e,s.children):e.push(s);else throw new Error("Expected node, nodes, or string, got `"+s+"`")}function re(e,s,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||K(n)===K(s)))return!0}return n}function Pn(e){const s=[];let n;for(n in e)P.call(e,n)&&s.push([n,e[n]].join(": "));return s.join("; ")}function Mn(e){const s={};let n=-1;for(;++n<e.length;)s[e[n].toLowerCase()]=e[n];return s}const Fn=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Un=Ae(de,"div"),jn=Ae(j,"g",Fn),T={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"};function Bn(e,s){return Le(e,{})||{type:"root",children:[]}}function Le(e,s){const n=In(e,s);return n&&s.afterTransform&&s.afterTransform(e,n),n}function In(e,s){switch(e.nodeType){case 1:return $n(e,s);case 3:return qn(e);case 8:return Gn(e);case 9:return oe(e,s);case 10:return Hn();case 11:return oe(e,s);default:return}}function oe(e,s){return{type:"root",children:De(e,s)}}function Hn(){return{type:"doctype"}}function qn(e){return{type:"text",value:e.nodeValue||""}}function Gn(e){return{type:"comment",value:e.nodeValue||""}}function $n(e,s){const n=e.namespaceURI,t=n===T.svg?jn:Un,r=n===T.html?e.tagName.toLowerCase():e.tagName,i=n===T.html&&r==="template"?e.content:e,o=e.getAttributeNames(),a={};let c=-1;for(;++c<o.length;)a[o[c]]=e.getAttribute(o[c])||"";return t(r,a,De(i,s))}function De(e,s){const n=e.childNodes,t=[];let r=-1;for(;++r<n.length;){const i=Le(n[r],s);i!==void 0&&t.push(i)}return t}new DOMParser;function Kn(e,s){const n=Wn(e);return Bn(n)}function Wn(e){const s=document.createElement("template");return s.innerHTML=e,s.content}const ae=function(e,s,n){const t=at(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof s=="number"){if(s<0||s===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(s=e.children.indexOf(s),s<0)throw new Error("Expected child node or index");for(;++s<e.children.length;)if(t(e.children[s],s,e))return e.children[s]},ie=/\n/g,ce=/[\t ]+/g,F=L("br"),le=L(es),zn=L("p"),ue=L("tr"),Vn=L(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",Zn,ts]),ve=L(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function Yn(e,s){const n=s||{},t="children"in e?e.children:[],r=ve(e),i=Oe(e,{whitespace:n.whitespace||"normal"}),o=[];(e.type==="text"||e.type==="comment")&&o.push(...Te(e,{breakBefore:!0,breakAfter:!0}));let a=-1;for(;++a<t.length;)o.push(...Re(t[a],e,{whitespace:i,breakBefore:a?void 0:r,breakAfter:a<t.length-1?F(t[a+1]):r}));const c=[];let l;for(a=-1;++a<o.length;){const u=o[a];typeof u=="number"?l!==void 0&&u>l&&(l=u):u&&(l!==void 0&&l>-1&&c.push(`
`.repeat(l)||" "),l=-1,c.push(u))}return c.join("")}function Re(e,s,n){return e.type==="element"?Qn(e,s,n):e.type==="text"?n.whitespace==="normal"?Te(e,n):Xn(e):[]}function Qn(e,s,n){const t=Oe(e,n),r=e.children||[];let i=-1,o=[];if(Vn(e))return o;let a,c;for(F(e)||ue(e)&&ae(s,e,ue)?c=`
`:zn(e)?(a=2,c=2):ve(e)&&(a=1,c=1);++i<r.length;)o=o.concat(Re(r[i],e,{whitespace:t,breakBefore:i?void 0:a,breakAfter:i<r.length-1?F(r[i+1]):c}));return le(e)&&ae(s,e,le)&&o.push("	"),a&&o.unshift(a),c&&o.push(c),o}function Te(e,s){const n=String(e.value),t=[],r=[];let i=0;for(;i<=n.length;){ie.lastIndex=i;const c=ie.exec(n),l=c&&"index"in c?c.index:n.length;t.push(Jn(n.slice(i,l).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),i===0?s.breakBefore:!0,l===n.length?s.breakAfter:!0)),i=l+1}let o=-1,a;for(;++o<t.length;)t[o].charCodeAt(t[o].length-1)===8203||o<t.length-1&&t[o+1].charCodeAt(0)===8203?(r.push(t[o]),a=void 0):t[o]?(typeof a=="number"&&r.push(a),r.push(t[o]),a=0):(o===0||o===t.length-1)&&r.push(0);return r}function Xn(e){return[String(e.value)]}function Jn(e,s,n){const t=[];let r=0,i;for(;r<e.length;){ce.lastIndex=r;const o=ce.exec(e);i=o?o.index:e.length,!r&&!i&&o&&!s&&t.push(""),r!==i&&t.push(e.slice(r,i)),r=o?i+o[0].length:i}return r!==i&&!n&&t.push(""),t.join(" ")}function Oe(e,s){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":s.whitespace;case"textarea":return"pre-wrap"}}return s.whitespace}function Zn(e){return!!(e.properties||{}).hidden}function es(e){return e.tagName==="td"||e.tagName==="th"}function ts(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const ns={},ss=[];function Pe(e){const s=e||ns;return function(n,t){it(n,"element",function(r,i){const o=Array.isArray(r.properties.className)?r.properties.className:ss,a=o.includes("language-math"),c=o.includes("math-display"),l=o.includes("math-inline");let u=c;if(!a&&!c&&!l)return;let f=i[i.length-1],w=r;if(r.tagName==="code"&&a&&f&&f.type==="element"&&f.tagName==="pre"&&(w=f,f=i[i.length-2],u=!0),!f)return;const m=Yn(w,{whitespace:"pre"});let y;try{y=Y.renderToString(m,{...s,displayMode:u,throwOnError:!0})}catch(h){const C=h,N=C.name.toLowerCase();t.message("Could not render math with KaTeX",{ancestors:[...i,r],cause:C,place:r.position,ruleId:N,source:"rehype-katex"}),N==="parseerror"?y=Y.renderToString(m,{...s,displayMode:u,strict:"ignore",throwOnError:!1}):y=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(s.errorColor||"#cc0000"),title:String(h)},children:[{type:"text",value:m}]}]}typeof y=="string"&&(y=Kn(y).children);const g=f.children.indexOf(w);return f.children.splice(g,1,...y),be})}}function rs(e){ct(e,[/\r?\n|\r/g,os])}function os(){return{type:"break"}}function as(){return function(e){rs(e)}}const Me="sandbox:";function is(e){const s=new URL(e).searchParams.get("se");if(!s)return!1;const n=Date.parse(s);return Number.isNaN(n)?!1:Date.now()>n}function Ms({messageId:e,clientThreadId:s,href:n,...t}){const r=Dt(),[i,o]=b.useState(!1),a=n.substring(Me.length),c=lt(s),l=vt(),u=ut(),f=b.useCallback(g=>{const h=document.createElement("a");h.href=g,h.click(),o(!1)},[]),w=b.useCallback(g=>{o(!1),u.danger(g,{toastId:"file_download_failed"})},[u]),m=ls(i,e,c,a,w,f).data,y=b.useCallback(async g=>{if(s!==void 0){g.preventDefault();const h=m?.download_url&&is(m.download_url);(m===void 0||m?.status!=="success"||h)&&r.invalidateQueries({queryKey:Fe(e,a)}),m?.status==="success"&&m?.download_url&&!h?f(m.download_url):o(!0)}},[s,m,r,e,a,f]);return d.jsx(ft,{closeOnOutsideClick:!1,label:d.jsxs("span",{className:"flex items-center gap-1",children:[i?l.formatMessage(fe.startingDownload):l.formatMessage(fe.downloadFile),i&&d.jsx(pt,{})]}),side:"top",children:d.jsx("a",{...t,className:"cursor-pointer",onClick:g=>!i&&y(g)})})}async function cs(e,s,n){const t=await dt.safeGet("/conversation/{conversation_id}/interpreter/download",{parameters:{path:{conversation_id:s},query:{message_id:e,sandbox_path:n}}});if(t.status===gt.Success)return t;throw new _e("Could not download file from advanced data analysis","error_code"in t?t.error_code:"unknown_error")}function ls(e,s,n,t,r,i){const o=mt();return Tt({queryKey:Fe(s,t),queryFn:()=>cs(s,n,t).then(a=>(a?.status==="success"&&i(a.download_url),a)).catch(a=>{let c=o("default_download_link_error",{fileName:t});throw a instanceof _e&&a.code!=null&&(c=o(a.code)),r?.(c),a}),enabled:!!(e&&s&&n&&t)})}function Fe(e,s){return["downloadSandboxLink",e,s]}const fe=Rt({downloadFile:{id:"SandboxDownload.downloadFile",defaultMessage:"Download file"},startingDownload:{id:"SandboxDownload.startingDownload",defaultMessage:"Starting download"}}),us="f",Fs="dr",Ue=(e,s,n=!1)=>{const t=b.useRef(!1);b.useEffect(()=>{t.current||(t.current=!0,E.count(A.DEFAULT,"clickable_follow_up_text_shown"),n&&E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_shown"),x.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...B({clientThreadId:e,messageId:s})}))},[e,s,n])},je=({messageId:e,clientThreadId:s,text:n})=>{const t=ge(s),r=ht.useStore(),i=we(s);Ue(s,e,!1);const o=b.useCallback(a=>{a.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),x.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",B({clientThreadId:s,messageId:e}));const c=r.getActiveSystemHintType();t({sourceEvent:a,promptMessage:bt(n.toLowerCase(),{suggestion_type:ye.Reply}),completionMetadata:{systemHints:c?[c]:[],conversationMode:i??{kind:yt.PrimaryAssistant}}})},[s,i,e,r,t,n]);return d.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:n})},fs=({messageId:e,clientThreadId:s,text:n})=>d.jsx(je,{messageId:e,clientThreadId:s,text:n}),Us=I.memo(fs),ps=({messageId:e,clientThreadId:s,text:n})=>{const t=_t(),{setThreadSystemHintMode:r}=wt(),i=!!Nt(),o=ge(s),a=we(s);Ue(s,e,!0);const c=b.useCallback(l=>{l.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),x.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",B({clientThreadId:s,messageId:e}));const u={clientThreadId:s};r(xt.Research,!0,u);{const f=Ct(t);f.focus(),kt(f,n)}},[s,e,n,t,r,a,o]);return i?d.jsx(je,{messageId:e,clientThreadId:s,text:n}):d.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[d.jsx(Qe,{className:"icon me-1 inline-block"}),n]})},ms=({messageId:e,clientThreadId:s,text:n})=>d.jsx(ps,{messageId:e,clientThreadId:s,text:n}),js=I.memo(ms);function ds(){return e=>{_(e,{tagName:"table"},s=>{const n=s.children.find(r=>k(r,"thead"))?.children.find(r=>k(r,"tr"))?.children.filter(r=>k(r,"th"))??[],t=s.children.find(r=>k(r,"tbody"))?.children.filter(r=>k(r,"tr"))?.map(r=>r.children.filter(i=>k(i,"td")))??[];for(let r=0;r<n.length;r++){const i=n[r];let o=pe(i);for(let c=0;c<t.length;c++)o=Math.max(o,pe(t[c]?.[r]));const a=o>160?"xl":o>100?"lg":o>40?"md":"sm";i.properties["data-col-size"]=a;for(let c=0;c<t.length;c++)t[c]?.[r]&&(t[c][r].properties["data-col-size"]=a)}})}}function k(e,s){return e.type==="element"&&e.tagName===s}function pe(e){let s=0;return e&&_(e,"text",n=>{s+=n.value.length}),s}const gs=new Set([jt,us]),Bs=e=>e.startsWith(Me)||gs.has(e)?e:Je(e);function hs(){return e=>{_(e,"list",s=>{for(const n of s.children)n.spread=!0})}}function ys(){return(e,s)=>{let n=0;const t=String(s.value);_(e,"containerDirective",r=>{if(r.type==="containerDirective"&&r.name===V){const i=r.position?.start?.offset,o=r.position?.end?.offset;if(i==null||o==null)return;const c=t.slice(i,o).replace(/^:::[^\n]*\n?/,"").replace(/\n?:::\s*$/,""),l=r.data||(r.data={});l.hName=V;const u=n++,f=r.attributes||{};l.hProperties={...f,content:c,index:u}}})}}function Is(e){return s=>{_(s,n=>{Object.defineProperties(n,{markdownSource:{get(){try{return e.slice(this.position.start.offset,this.position.end.offset)}catch{return""}}}})})}}const Be=[[St,{singleTilde:!1}],as,hs,[Pt,{singleDollarTextMath:!1}],Et,ys,Mt,Ft,...W?[W]:[],Ot,bs,ws];function bs(){return e=>{_(e,"textDirective",s=>{s.name!==Ne&&(s.type="text",s.value=`:${s.name}`)})}}const _s=/\u200b/g;function ws(){return e=>{_(e,"text",s=>{s.value=s.value.replace(_s,"")})}}function Ns(){return e=>{const s=e.position?.end.offset;_(e,"element",(n,t)=>{const{position:r}=n;if(!r)return;const{start:i,end:o}=r,a=i.offset,c=o.offset;n.properties??={},a!=null&&(n.properties["data-start"]=a),c!=null&&(n.properties["data-end"]=c,s===c&&(n.properties["data-is-last-node"]=""),t===e.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const Hs=[Pe,Ns,ds,[Xe,{target:"_new",rel:"noopener noreferrer"}],he],xs=[[Pe,{output:"mathml"}],he];function Cs(e,s){const n=Lt(e,s);return Ie(n,s)}function Ie(e,s){const n=O().use(xe).use(Be).use([[Es,s??[]]]).use(At,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:ks}}),t=O().use(Ze).use(xs).use(Dn),r=n.runSync(n.parse(e)),i=n.stringify(r),o=t.stringify(t.runSync(r));return{"text/plain":i,"text/html":o}}const ks=(e,s,n,t)=>{const r=n.createTracker(t),i=n.enter("link"),o=n.enter("label");let a=r.move("[");return a+=r.move(n.containerPhrasing(e,{before:a,after:"](",...r.current()})),a+=r.move("]("),o(),a+=r.move(e.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Ss)),e.title&&(a+=r.move(" "+JSON.stringify(e.title))),a+=r.move(")"),i(),a};function Ss(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function Es(e){return s=>{const n={},t=(r,i)=>{switch(i.type){case"grouped_webpages":{const o=[];for(const a of i.items)if(a.url&&a.title){let c=n[a.url];c||(c=n[a.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:a.url,title:a.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:a.attribution??tt(a.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((a,c,l)=>c<l.length-1?[a,{type:"text",value:", "}]:[a]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"map":case"tldr":case"navigation":case"stock":case"calculator":case"python":case"container":case"code_execution":case"forecast":case"businesses_map":case"entity_metadata":case"video":case"entity":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"checkout_confirmation":case"image_inline":case"image_group":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(i.alt){const o=O().use(xe).use(Be).parse(i.alt);if(r.type!=="textDirective")return o.children;const a=o.children[0];if(a.type==="paragraph")return a.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};_(s,et,(r,i,o)=>{if(o==null||i==null)return;const a=As(r,e),c=a?t(r,a)??[r]:[];return o.children.splice(i,1,...c),[be,i+c.length]}),s.children.push(...Object.values(n))}}function As(e,s){if(e.name===Ne){const n=e.attributes?.index;if(n)return s[parseInt(n,10)]}}const qs=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:Ie,messageTextToClipboardContent:Cs},Symbol.toStringTag,{value:"Module"}));export{us as C,jt as I,Ut as M,Be as R,Me as S,Hs as a,Ms as b,Ps as c,Us as d,Fs as e,js as f,qs as g,Ie as m,Is as r,Bs as u};
//# sourceMappingURL=mzuzwb6vzvi4qfk0.js.map

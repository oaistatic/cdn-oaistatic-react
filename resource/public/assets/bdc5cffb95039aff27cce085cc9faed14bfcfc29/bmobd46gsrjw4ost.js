import{f as v,r as n,j as y,d as A,e as h}from"./cs7toih8jegb7teq.js";import{oK as C,oL as R,oM as M,oN as x,lb as V,e as S,i as E,f6 as I,aK as T,p as B,P as b,S as L}from"./dmck639k4dv7claj.js";import{S as _}from"./c55wpjvyurxdiegh.js";import{S as j}from"./eq5mxjsfi2cjwfyk.js";import{bM as O,aN as G,fq as U,fr as q}from"./hnw079jsdm76umup.js";import{u as K}from"./nxes2g8vblrs3vjj.js";import"./gy64pge8qevmvg7e.js";function N({audioAssetPointer:l,conversationId:e}){const a=v(),[i,o]=n.useState(!1),s=n.useRef(!0),[t,r]=n.useState(void 0),d=n.useRef(null),u=C(),g=R(c=>c.isPlaying&&c.sourceUrl===t),P=null,f=n.useCallback(()=>{const c=M();if(c)d.current?d.current.then(()=>{c.stop(),d.current=null}):c.stop();else return},[]);n.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),n.useEffect(()=>()=>{x().isPlaying&&f()},[f]);const m=n.useCallback(async()=>{if(!u||!s.current)return;o(!0);const{url:c}=await O.fetch(a,{asset:l,conversationId:e});o(!1),r(c),u.changeSource(c),d.current=u.play()},[l,e,u,a,P]);return{togglePlayback:n.useCallback(()=>{if(u)g?f():(V.messagePlayback.click(),m());else return},[g,m,u,f]),isPlaying:g,isLoading:i}}const Z=n.memo(function(e){const a=S(),i=E(a),o=I(e.conversationId),s=G(e.message);if(!i||!o||s)return null;const t=T.getAudioAssetPointers(e.message)[0];return t?y.jsx(W,{audioAssetPointer:t,conversationId:o,onPlaybackStateChange:e.onPlaybackStateChange}):y.jsx(w,{...e,conversationId:o,onPlaybackStateChange:e.onPlaybackStateChange})});function W({audioAssetPointer:l,conversationId:e,onPlaybackStateChange:a}){const{isLoading:i,isPlaying:o,togglePlayback:s}=N({audioAssetPointer:l,conversationId:e}),t=()=>{b.logEventWithStatsig("ChatGPT Turn Action Voice Replay Clicked","chatgpt_turn_action_voice_replay"),s()};return y.jsx(k,{onClick:t,isPlaying:o,isLoading:i,playText:p.replay,playIcon:U,onPlaybackStateChange:a})}function w({conversationId:l,message:e,onPlaybackStateChange:a}){const{isLoading:i,isPlaying:o,togglePlayback:s}=K({conversationId:l,messageId:e.id}),t=()=>{b.logEventWithStatsig("ChatGPT Turn Action Voice Read Aloud Clicked","chatgpt_turn_action_voice_read_aloud"),s()};return y.jsx(k,{onClick:t,isPlaying:o,isLoading:i,playText:p.play,playIcon:_,onPlaybackStateChange:a})}function k({onClick:l,isPlaying:e,isLoading:a,playText:i,playIcon:o,onPlaybackStateChange:s}){let t,r;const d=h(),u=S(),g=B(u,"1894790777");return a?(t=L,r=p.loading):e?(t=j,r=p.stop):(t=o,r=i),n.useEffect(()=>{s?.(e)},[e,s]),y.jsx(q,{icon:t,label:r?d.formatMessage(r):void 0,disabled:a,onClick:l,style:e||a?{visibility:"visible"}:void 0,testId:"voice-play-turn-action-button",asMenuItem:g,onSelect:P=>{P.preventDefault()}})}const p=A({replay:{id:"VoiceReadOutLoudButton.replay",defaultMessage:"Replay"},play:{id:"VoiceReadOutLoudButton.play",defaultMessage:"Read aloud"},stop:{id:"VoiceReadOutLoudButton.stop",defaultMessage:"Stop"},loading:{id:"VoiceReadOutLoudButton.loading",defaultMessage:"Loading"}});export{k as PlayButton,W as VoiceMessagePlaybackButton,Z as VoicePlayButton,w as VoiceReadAloudButton};
//# sourceMappingURL=bmobd46gsrjw4ost.js.map

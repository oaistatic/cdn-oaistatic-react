import{bV as D,C as P,be as p,z,oi as V,bh as U,bQ as $,e as q,p as h,S as Q,de as M,B as f,hZ as X,lU as Z}from"./dmck639k4dv7claj.js";import{e as w,f as G,a as N,i as _,j as e,M as n,O as H,ah as J,r as b,I as K}from"./cs7toih8jegb7teq.js";import{c_ as Y,x as ee}from"./hnw079jsdm76umup.js";import{R as ae,I as E,S as te}from"./i1yyxhrxmz4t7iae.js";import{u as se}from"./fg1z1tv7372twqew.js";import{W as y,r as ne,i as ie,h as oe,c as re}from"./crerkmhvihiw48az.js";import{E as le}from"./p80xz2nejchyk0n0.js";import{W as me}from"./g9gr3l5lwhb3z8y8.js";import{a as de,b as ce}from"./dp7t1jmnbbend843.js";import{W as ue}from"./fba6r4282q3hco9o.js";import"./lco7biunzadofjpa.js";import"./mntlin6h4lg868yr.js";import"./dupxx6qfa09nz1fw.js";import"./mahhuo4zclh446vl.js";import"./l1m3l5lbmhuctzw6.js";import"./yf0i1e6tgcrdg1ll.js";import"./mcuu3cegz8rmschr.js";import"./o12mkc4t9o2t0ta8.js";import"./dr58d0qi3ke74zcr.js";function ge({environmentId:s,onClose:a}){const i=w(),r=D(),l=G(),m=N(),{mutate:c,isPending:x}=_({mutationFn:()=>y.deleteEnvironment(s),onSuccess:async()=>{ne(l,s),await ie(l),r.success(i.formatMessage({id:"wham.deleteEnvironmentModal.environmentDeletedSuccessfully",defaultMessage:"Environment deleted successfully"})),a(),m("/codex/settings/environments")},onError:()=>{r.danger(i.formatMessage({id:"wham.deleteEnvironmentModal.failedToDeleteEnvironment",defaultMessage:"Failed to delete environment"}))}});return e.jsx(P,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(n,{id:"wham.deleteEnvironmentModal.title",defaultMessage:"Delete environment"}),onClose:a,primaryButton:e.jsx(p.Button,{title:i.formatMessage({id:"wham.deleteEnvironmentModal.delete",defaultMessage:"Delete"}),color:"danger",loading:x,onClick:()=>{c()}}),secondaryButton:e.jsx(p.Button,{title:i.formatMessage({id:"wham.deleteEnvironmentModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:a}),children:e.jsx("div",{className:"text-sm",children:e.jsx(n,{id:"wham.deleteEnvironmentModal.message",defaultMessage:"Tasks that use it will remain, but users wonâ€™t be able to create follow-up tasks."})})})}function o({label:s,children:a,className:i}){return e.jsxs("div",{className:z("flex flex-col gap-1",i),children:[e.jsx("dt",{className:"text-token-text-primary text-sm font-medium",children:s}),e.jsx("dd",{className:"text-token-text-primary text-sm font-normal",children:a})]})}function he({environmentId:s,onClose:a}){const i=w(),r=D(),{mutate:l,isPending:m}=_({mutationFn:()=>y.invalidateEnvironmentCache(s),onSuccess:()=>{r.success(i.formatMessage({id:"wham.resetCacheModal.cacheResetSuccessfully",defaultMessage:"Cache reset successfully"})),a()},onError:()=>{r.danger(i.formatMessage({id:"wham.resetCacheModal.failedToResetCache",defaultMessage:"Failed to reset cache"}))}});return e.jsx(P,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(n,{id:"wham.resetEnvironmentCacheModal.title",defaultMessage:"Reset cache"}),onClose:a,primaryButton:e.jsx(p.Button,{title:i.formatMessage({id:"wham.resetEnvironmentCacheModal.delete",defaultMessage:"Reset"}),color:"danger",loading:m,onClick:()=>{l()}}),secondaryButton:e.jsx(p.Button,{title:i.formatMessage({id:"wham.resetEnvironmentCacheModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:a}),children:e.jsx("div",{className:"text-sm",children:e.jsx(n,{id:"wham.resetEnvironmentCacheModal.message",defaultMessage:"All currently cached containers will be invalidated. The cache will be cleared for all users."})})})}function fe(){const{environmentId:s}=H(),{eligible:a}=Y();return a?e.jsx(J,{to:"/codex"}):s?e.jsx(xe,{environmentId:s}):e.jsx(V,{})}function pe(s){return s==null||s.setup==null?!1:Array.isArray(s.setup)?s.setup.length>0&&s.setup.every(a=>a!==""):s.setup!==""}function xe({environmentId:s}){const a=w(),i=N(),[r,l]=b.useState(!1),[m,c]=b.useState(!1),x=oe(d=>d.setEnvironmentId),{data:t,isLoading:C,isError:k}=re(s),j=U(),v=$(),u=q(),S=!!(j&&t&&t.creator.email===j.email),A=h(u,"3681557806"),O=!!v?.isOwnerOfAccount()||!!v?.isAdminOfAccount(),g=S||A&&O,R=se(),B=v?.name??a.formatMessage({id:"wham.environmentDetailsPage.workspace",defaultMessage:"Workspace"}),W=h(u,"2134057841"),T=h(u,"1535847699"),F=h(u,"3899518838"),I=!pe(t)&&t?.auto_setup_settings==null,L=t?.auto_setup_settings?.use_auto_setup??I;return e.jsxs(ue,{topPadding:!0,showSidebar:!1,children:[e.jsx("div",{className:"flex flex-col px-8 md:px-16",children:C?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Q,{})}):k?e.jsx(le,{title:a.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironment",defaultMessage:"Error loading environment"}),description:a.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironmentDescription",defaultMessage:"Error loading environment description"})}):t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-default flex flex-col justify-between gap-2 border-b pb-4",children:e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs(ae,{children:[e.jsx(E,{label:a.formatMessage({id:"wham.environmentDetailsPage.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(te,{}),e.jsx(E,{label:t.label,url:`/codex/settings/environment/${s}`,className:"text-token-text-primary font-medium"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(M,{label:g?void 0:a.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentTooltip",defaultMessage:"Only the creator of the environment or an admin can delete an environment"}),children:e.jsx(f,{color:"danger-outline",onClick:()=>l(!0),disabled:!g,"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentAriaLabel",defaultMessage:"Button to delete {environmentName}"},{environmentName:t.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.deleteEnvironment",defaultMessage:"Delete"})})}),e.jsx(M,{label:g?void 0:a.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentTooltip",defaultMessage:"Only the creator of the environment or an admin can edit an environment"}),children:e.jsx(f,{icon:ee,onClick:()=>{i(`/codex/settings/environment/${s}/edit`)},color:"secondary",disabled:!g,"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentAriaLabel",defaultMessage:"Button to edit {environmentName}"},{environmentName:t.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.editEnvironment",defaultMessage:"Edit"})})}),e.jsx(f,{size:"small",color:"secondary",onClick:()=>{x(s),me.recordClickEnv(),i("/codex")},"aria-label":a.formatMessage({id:"wham.environmentDetailsPage.useEnvironmentAriaLabel",defaultMessage:"Button to use environment {environmentName} in a codex task"},{environmentName:t.label}),children:e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(n,{id:"wham.turnInfoRow.useEnvironment",defaultMessage:"Use this"}),e.jsx(X,{className:"icon-sm"})]})})]})]})}),e.jsx("div",{className:"text-token-text-primary py-8 text-xl",children:t.label}),e.jsxs("div",{className:"grid gap-x-12 gap-y-6 md:grid-cols-2",children:[e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.creator",defaultMessage:"Creator"}),children:t.creator.email}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.image",defaultMessage:"Image"}),children:t.machine.label||e.jsx(n,{id:"wham.environmentDetailsPage.noImage",defaultMessage:"No image"})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.description",defaultMessage:"Description"}),children:t.description??e.jsx(n,{id:"wham.environmentDetailsPage.noDescription",defaultMessage:"N/A"})}),W&&e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.agentNetworkAccess",defaultMessage:"Agent internet access"}),children:t.agent_network_access?.mode==="on"?t.agent_network_access.preset_allowlist===de?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.unrestricted",defaultMessage:"On: unrestricted"}):t.agent_network_access.preset_allowlist===ce?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.codex",defaultMessage:"On: common dependencies"}):e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.custom",defaultMessage:"On: custom domains"}):t.agent_network_access==null||t.agent_network_access.mode==="off"?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.off",defaultMessage:"Off"}):null}),F&&e.jsxs(e.Fragment,{children:[e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.postSetupCaching",defaultMessage:"Post setup caching"}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.cache_settings?.post_setup_cache_enabled===!0?e.jsx(n,{id:"wham.environmentDetailsPage.postSetupCaching.on",defaultMessage:"On"}):e.jsx(n,{id:"wham.environmentDetailsPage.postSetupCaching.off",defaultMessage:"Off"}),t.cache_settings?.post_setup_cache_enabled&&e.jsx(M,{label:a.formatMessage({id:"wham.environmentDetailsPage.resetCacheTooltip",defaultMessage:"Invalidate any currently cached containers"}),children:e.jsx(f,{size:"small",onClick:()=>c(!0),color:"secondary","aria-label":a.formatMessage({id:"wham.environmentDetailsPage.resetCacheAriaLabel",defaultMessage:"Button to invalidate cache for {environmentName}"},{environmentName:t.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.resetCache",defaultMessage:"Reset cache"})})})]})}),t.cache_settings?.post_setup_cache_enabled&&e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.maintenanceSetupScript",defaultMessage:"Maintenance setup script"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(t.maintenance_setup)?t.maintenance_setup:[t.maintenance_setup]).filter(Boolean).join(`
`)})})]}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.environmentVariables",defaultMessage:"Environment variables"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys(t.env_vars??{}).filter(d=>!d.startsWith("CODEX_ENV_")).join(`
`)})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.secrets",defaultMessage:"Secrets"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys(t.secrets??{}).join(`
`)})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.createdAt",defaultMessage:"Created at"}),children:t.created_at?e.jsx(K,{value:new Date(t.created_at*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(n,{id:"wham.environmentDetailsPage.noCreationDate",defaultMessage:"No creation date"})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.setupScript",defaultMessage:"Setup script"}),children:T&&L?e.jsx(n,{id:"wham.environmentDetailsPage.autoSetup.automatic",defaultMessage:"Automatic"}):e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(t.setup)?t.setup:[t.setup]).filter(Boolean).join(`
`)})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.repository",defaultMessage:"Repository"}),children:t.repo_map?Object.values(t.repo_map).map(d=>d.repository_full_name):e.jsx(n,{id:"wham.environmentDetailsPage.noRepository",defaultMessage:"No repository"})}),e.jsx(o,{label:a.formatMessage({id:"wham.environmentDetailsPage.numTasks",defaultMessage:"No. of tasks"}),children:t.task_count??0}),R&&e.jsx(o,{label:a.formatMessage({id:"94ZVks",defaultMessage:"Share"}),children:t.share_settings==="workspace"?a.formatMessage({id:"wham.environmentDetailsPage.sharedWithWorkspace",defaultMessage:"Shared with {workspaceName}"},{workspaceName:B}):a.formatMessage({id:"wham.environmentDetailsPage.private",defaultMessage:"Private"})})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(n,{id:"wham.environmentDetailsPage.environmentNotFound",defaultMessage:"Environment not found"})})}),r&&e.jsx(ge,{environmentId:s,onClose:()=>l(!1)}),m&&e.jsx(he,{environmentId:s,onClose:()=>c(!1)})]})}const Fe=()=>[{title:"Codex"}],Ie=Z(function(){return e.jsx(fe,{})});export{Ie as default,Fe as meta};
//# sourceMappingURL=mteo8f83avuq5ocp.js.map

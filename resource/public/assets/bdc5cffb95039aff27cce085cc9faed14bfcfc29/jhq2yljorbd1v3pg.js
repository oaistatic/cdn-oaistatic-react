import{R as K,e as Z,B as G,da as H,bQ as F,P as I,bV as J,A as ee,a0 as C,lU as ae}from"./dmck639k4dv7claj.js";import{e as _,r as f,j as l,a as M,M as D,h as N,ar as te}from"./cs7toih8jegb7teq.js";import{c as i,S as v,F as A,a as B,C as L,L as se}from"./e59wple1sb2rce8v.js";import{u as re}from"./de0xekdnf43rd5ny.js";import{wa as oe,wb as ne,eg as le,wc as z,ef as ce,b8 as ie,d$ as me,el as ue,eq as pe,eb as P,wd as de,en as fe}from"./hnw079jsdm76umup.js";import{u as ge}from"./kyjth308quztvz31.js";import{a as ye,b as Se}from"./lox5zdwgg3gy3k4z.js";import{b as he,B as be}from"./c6yb6cmc50jj0xn1.js";import{S as we}from"./lo4bvml5ypzzx0bg.js";const O="country_code",T="step",k=r=>K.safePost("/accounts/pending_team_workspace",{requestBody:r}),_e=({formData:r,onNext:p})=>{const a=_(),[t,m]=f.useState({role:r.role??"",department:r.department??""}),[o,d]=f.useState({}),g=(e,s)=>{m(S=>({...S,[e]:s})),d(S=>({...S,[e]:""}))},y=f.useMemo(()=>{const e=oe.map(s=>({label:a.formatMessage(s.displayValue),value:s.id}));return e.sort((s,S)=>s.label.localeCompare(S.label)),e},[a]),n=f.useMemo(()=>{const e=ne.map(s=>({label:a.formatMessage(s.displayValue),value:s.id}));return e.sort((s,S)=>s.label.localeCompare(S.label)),e},[a]),c=f.useMemo(()=>[{formType:"select",label:a.formatMessage(i.roleLabel),name:"role",placeholder:a.formatMessage(i.rolePlaceholder),value:t.role,onChange:e=>g("role",e),error:o.role,required:!0,options:n},{formType:"select",label:a.formatMessage(i.workspaceDepartmentLabel),name:"department",placeholder:a.formatMessage(i.workspaceDepartmentPlaceholder),value:t.department,onChange:e=>g("department",e),error:o.department,required:!0,options:y}],[y,o.department,o.role,t.department,t.role,a,n]),u=()=>{const e={};return c.forEach(s=>{s.required&&!t[s.name]&&(e[s.name]=a.formatMessage(i.fieldRequired,{fieldName:s.label}))}),d(e),Object.values(e).every(s=>!s)};return l.jsx(v,{content:l.jsxs(A,{title:a.formatMessage(i.tellUsAboutWorkStepTitle),subTitle:a.formatMessage(i.tellUsAboutWorkStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:c.map(e=>f.createElement(B,{...e,key:e.name}))}),l.jsx(L,{onClick:async()=>{u()&&await p(t)}})]})})},Pe={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"},Te=({onNext:r,onPrevious:p,pendingWorkspace:a,initialBillingDetails:t,formData:m})=>{const o=_();Z();const d=me(),{annualBillingPlan:g}=le(t.currency),y=Math.floor(100-g.discountedMonthlyCost/g.monthlyCost*100),n=M(),c=new URLSearchParams(a?.query_params??"").get(z)??void 0,{selectedPlan:u,setSelectedPlan:e,numSeats:s,setNumSeats:S,promoData:E,TEAM1DOLLAR_COUPON_IsEligible:h,TEAM_FREE_TRIAL_COUPON_IsEligible:b}=he({initialSeats:m?.numSeats,initialPromoCoupon:c}),{eligible:x,campaignId:V}=ce(),j=E??(!c&&x?{coupon:V,state:"eligible"}:void 0),R={priceInterval:u,billingDetails:t,numSeats:s,promoData:j},W=h||b,$=h?i.oneDollarPromoTitle:b?i.freeTrialPromoTitle:i.purchaseStepTitle,U=h?i.oneDollarPromoSubtitle:b?i.freeTrialPromoSubtitle:void 0,X=ie(isNaN(s)?0:s,d,ue);return l.jsx(v,{onPrevious:p?()=>p({...R}):void 0,content:l.jsxs(A,{title:o.formatMessage($),subTitle:U&&o.formatMessage(U),children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsx(pe,{numSeats:s,minSeats:d,setNumSeats:S,classNames:Pe,label:l.jsx(D,{...i.seatsCountLabel})}),l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx(se,{required:!0,children:o.formatMessage(i.planSummaryTitle)}),l.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(W&&u===P.FLEXIBLE)&&l.jsx(we,{ariaLabel:o.formatMessage(i.planTypeLabel),leftItem:{label:l.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:o.formatMessage(i.annualPlanLabel,{percent:y,span:Y=>l.jsx("span",{className:"text-[#10A37F]",children:Y})})}),value:P.ANNUAL},rightItem:{label:o.formatMessage(i.monthlyPlanLabel),value:P.FLEXIBLE},value:u,onChange:e}),l.jsx(be,{numSeats:X,selectedPlan:u,billingDetails:t,totalLabel:i.allPlansTodayTotal,billDate:o.formatMessage(i.today),promoData:j})]})]})]}),l.jsx(L,{onClick:()=>r({...R})}),l.jsx(G,{color:"ghost",onClick:()=>n("/"),children:l.jsx(D,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},Ee=({formData:r,onNext:p,onPrevious:a})=>{const t=_(),[m,o]=f.useState({workspaceName:r.workspaceName??"",companySize:r.companySize??""}),[d,g]=f.useState({}),y=(e,s)=>{o(S=>({...S,[e]:s})),g(S=>({...S,[e]:""}))},n=de.map(e=>({label:typeof e.displayValue=="string"?e.displayValue:t.formatMessage(e.displayValue),value:e.id})),c=f.useMemo(()=>[{formType:"input",label:t.formatMessage(i.workspaceNameLabel),name:"workspaceName",placeholder:t.formatMessage(i.workspaceNamePlaceholder),value:m.workspaceName,onChange:e=>y("workspaceName",e),error:d.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:t.formatMessage(i.workspaceCompanySizeLabel),name:"companySize",placeholder:t.formatMessage(i.workspaceCompanySizePlaceholder),value:m.companySize,onChange:e=>y("companySize",e),error:d.companySize,required:!1,options:n}],[d.companySize,d.workspaceName,m.companySize,m.workspaceName,t,n]),u=()=>{const e={};return c.forEach(s=>{s.required&&!m[s.name]&&(e[s.name]=t.formatMessage(i.fieldRequired,{fieldName:s.label}))}),g(e),Object.values(e).every(s=>!s)};return l.jsx(v,{onPrevious:a?()=>a({...m}):void 0,content:l.jsxs(A,{title:t.formatMessage(i.workspaceNameStepTitle),subTitle:t.formatMessage(i.workspaceNameStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:c.map(e=>f.createElement(B,{...e,key:e.name}))}),l.jsx(L,{disabled:!m.workspaceName,onClick:async()=>{u()&&await p({...m})}})]})})};var Q=(r=>(r.AboutWork="about-work",r.WorkspaceInfo="workspace-info",r.ConfigurePlan="configure-plan",r))(Q||{});const xe=H(Object.values(Q),void 0),Ce=({pendingWorkspace:r})=>{const p=_(),[a,t]=f.useState({workspaceName:r?.workspace_name??void 0,role:r?.role??void 0,department:r?.department??void 0,companySize:r?.company_size??void 0,numSeats:r?.seat_quantity??void 0});ge(new URLSearchParams(r?.query_params??"").get(z)??"");const m=ke({data:a}),o=F(),d=N(),g=new URLSearchParams(d.search).get(O)??new URLSearchParams(r?.query_params??"").get(O)??void 0,y=te(),{country:n,userCountry:c}=ye({initialCountryCode:g}),u=Se({country:n,currentAccount:o,location:"TeamDirectSignUpFlow"}),e=xe(r?.step_name),{step:s,nextStep:S}=Me({initialStep:e&&w.includes(e)?e:void 0});f.useEffect(()=>{r||(()=>{k({step_name:r?.step_name??w[0],query_params:d.search,user_segment:"v1"})})()},[]),f.useEffect(()=>{const h=d.key,x=new URLSearchParams(window.location.search).get("referrer")||document.referrer;I.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",{...o?.subscriptionAnalyticsParams,referrer:x,initialTab:r?.step_name,currentTab:s,locationKey:h,navigationType:y,initialCountrySelectorCountry:g??n,selectedCountry:u.country??"",selectedCurrency:u.currency??"",userCountry:c??""})},[s]);const E=()=>{switch(s){case"about-work":return l.jsx(_e,{formData:a,onNext:async h=>{const b={...a,...h};t(b),await S(b)}});case"workspace-info":return l.jsx(Ee,{formData:a,onNext:async h=>{const b={...a,...h};t(b),await S(b)}});case"configure-plan":return l.jsx(Te,{formData:a,initialBillingDetails:u,onNext:async h=>{await m({...a,...h})},pendingWorkspace:r});default:return null}};return l.jsxs(l.Fragment,{children:[l.jsx("title",{children:p.formatMessage(i.teamSignUpPageTitle)}),E()]})},ke=({data:r})=>{const{prepareCheckoutSession:p,navigateToCheckout:a}=re(),t=J(),m=_(),o=F();return f.useCallback(async({priceInterval:g,billingDetails:y,numSeats:n,promoData:c})=>{try{I.logEvent("Account Pay: Payment Checkout Clicked",{planType:ee.SELF_SERVE_BUSINESS,...o?.subscriptionAnalyticsParams,referrer:document.referrer});const u=await p({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:r.workspaceName??"",price_interval:g,seat_quantity:n},billing_details:y,promo_campaign:g===P.FLEXIBLE?c?.coupon:null,cancel_url:window.location.href});await a(u)}catch(u){C.addError(u),t.warning(m.formatMessage(fe.paymentErrorWarning),{hasCloseButton:!0})}},[o?.subscriptionAnalyticsParams,r.workspaceName,m,a,p,t])},q=(r,p)=>{const a=new URLSearchParams(window.location.search);Object.entries(r).forEach(([m,o])=>{a.set(m,o)});const t=`${window.location.pathname}?${a.toString()}`;p?p(t,{replace:!1}):window.history.replaceState(null,"",t)},w=["configure-plan"],Me=({initialStep:r})=>{const p=M(),a=N(),[t,m]=f.useState(()=>{const n=r??w[0];return q({[T]:n}),n}),o=f.useCallback(n=>{m(n),q({[T]:n},p)},[p]),d=f.useRef(null);f.useEffect(()=>{const c=new URLSearchParams(a.search).get(T);c!==d.current&&c&&w.includes(c)&&c!==t&&o(c),d.current=c},[a.search,o,t]);const g=async n=>{let c=t;const u=w.indexOf(t);u>=0&&u<w.length-1&&(c=w[u+1],o(c));try{await k({workspace_name:n.workspaceName,company_size:n.companySize,department:n.department,role:n.role,step_name:c,query_params:a.search,user_segment:"v1"})}catch(e){C.addError(e)}},y=f.useCallback(async n=>{let c=t;const u=w.indexOf(t);u>0&&(c=w[u-1],o(c));try{await k({workspace_name:n.workspaceName,company_size:n.companySize,department:n.department,role:n.role,step_name:c,query_params:a.search,user_segment:"v1"})}catch(e){C.addError(e)}},[a.search,o,t]);return{step:t,nextStep:g,previousStep:y}},Fe="/create-workspace",Ie=ae(function({loaderData:p}){const a=N(),t=M();return f.useEffect(()=>{const m=p.pendingWorkspace?.query_params;if(!m)return;const o=new URLSearchParams(a.search),d=new URLSearchParams(m);let g=!1;for(const[y,n]of d)!o.get(y)&&y!==T&&(o.set(y,n),g=!0);g&&t(`${a.pathname}?${o.toString()}`,{replace:!0})},[p.pendingWorkspace?.query_params,a.pathname,a.search,t]),l.jsx(Ce,{pendingWorkspace:p.pendingWorkspace})});export{Fe as C,Ie as c};
//# sourceMappingURL=jhq2yljorbd1v3pg.js.map

import{g as br,r as Pn,j as Xn}from"./cs7toih8jegb7teq.js";import{dU as Fo}from"./hnw079jsdm76umup.js";import{a0 as Ht,c as qo}from"./dmck639k4dv7claj.js";import{c as Vo,a as Uo}from"./mmilw72p73kj15mv.js";import{u as $o}from"./juhpprtcv8tvp5w6.js";import{x as ko}from"./hp08qw6yu0x90xkd.js";const Go=Vo("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Yt=80,Bt=15,Qn=40,Jn=20;function Ho(n){return n==null||n===0?Yt:Math.round(n*7)}function at(n){const r=n==null||n===0?Bt:n;return Math.round(r*96/72)}function Ge(n){let r="";for(n+=1;n;){const t=(n-1)%26;r=String.fromCharCode(65+t)+r,n=Math.floor((n-t)/26)}return r}function He(n){const r=n.match(/[A-Z]+/);if(!r)return 0;let t=0;for(const e of r[0])t=t*26+(e.charCodeAt(0)-64);return t-1}function Yo(n){const r=n.match(/\d+/);return r?parseInt(r[0],10)-1:0}function Nr(n){const r=n.replace(/^0x/i,"");if(r.length===8){const e=parseInt(r.slice(2,4),16),i=parseInt(r.slice(4,6),16),c=parseInt(r.slice(6,8),16);return`rgba(${e}, ${i}, ${c}, ${1 .toFixed(3)})`}return r.length===6?`#${r}`:"#ffffff"}var Wr={exports:{}},Bo=Wr.exports,ht;function zo(){return ht||(ht=1,function(n,r){(function(t,e){n.exports=e()})(Bo,function(){var t=function(e,i){var c=Array.prototype.concat,a=Array.prototype.slice,g=Object.prototype.toString;function h(I,E){var N=I>E?I:E;return e.pow(10,17-~~(e.log(N>0?N:-N)*e.LOG10E))}var f=Array.isArray||function(E){return g.call(E)==="[object Array]"};function o(I){return g.call(I)==="[object Function]"}function u(I){return typeof I=="number"?I-I===0:!1}function s(I){return c.apply([],I)}function l(){return new l._init(arguments)}l.fn=l.prototype,l._init=function(E){if(f(E[0]))if(f(E[0][0])){o(E[1])&&(E[0]=l.map(E[0],E[1]));for(var N=0;N<E[0].length;N++)this[N]=E[0][N];this.length=E[0].length}else this[0]=o(E[1])?l.map(E[0],E[1]):E[0],this.length=1;else if(u(E[0]))this[0]=l.seq.apply(null,E),this.length=1;else{if(E[0]instanceof l)return l(E[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:h,isArray:f,isFunction:o,isNumber:u,toVector:s},l._random_fn=e.random,l.setRandom=function(E){if(typeof E!="function")throw new TypeError("fn is not a function");l._random_fn=E},l.extend=function(E){var N,R;if(arguments.length===1){for(R in E)l[R]=E[R];return this}for(N=1;N<arguments.length;N++)for(R in arguments[N])E[R]=arguments[N][R];return E},l.rows=function(E){return E.length||1},l.cols=function(E){return E[0].length||1},l.dimensions=function(E){return{rows:l.rows(E),cols:l.cols(E)}},l.row=function(E,N){return f(N)?N.map(function(R){return l.row(E,R)}):E[N]},l.rowa=function(E,N){return l.row(E,N)},l.col=function(E,N){if(f(N)){var R=l.arange(E.length).map(function(){return new Array(N.length)});return N.forEach(function(M,F){l.arange(E.length).forEach(function(Y){R[Y][F]=E[Y][M]})}),R}for(var C=new Array(E.length),D=0;D<E.length;D++)C[D]=[E[D][N]];return C},l.cola=function(E,N){return l.col(E,N).map(function(R){return R[0]})},l.diag=function(E){for(var N=l.rows(E),R=new Array(N),C=0;C<N;C++)R[C]=[E[C][C]];return R},l.antidiag=function(E){for(var N=l.rows(E)-1,R=new Array(N),C=0;N>=0;N--,C++)R[C]=[E[C][N]];return R},l.transpose=function(E){var N=[],R,C,D,M,F;for(f(E[0])||(E=[E]),C=E.length,D=E[0].length,F=0;F<D;F++){for(R=new Array(C),M=0;M<C;M++)R[M]=E[M][F];N.push(R)}return N.length===1?N[0]:N},l.map=function(E,N,R){var C,D,M,F,Y;for(f(E[0])||(E=[E]),D=E.length,M=E[0].length,F=R?E:new Array(D),C=0;C<D;C++)for(F[C]||(F[C]=new Array(M)),Y=0;Y<M;Y++)F[C][Y]=N(E[C][Y],C,Y);return F.length===1?F[0]:F},l.cumreduce=function(E,N,R){var C,D,M,F,Y;for(f(E[0])||(E=[E]),D=E.length,M=E[0].length,F=R?E:new Array(D),C=0;C<D;C++)for(F[C]||(F[C]=new Array(M)),M>0&&(F[C][0]=E[C][0]),Y=1;Y<M;Y++)F[C][Y]=N(F[C][Y-1],E[C][Y]);return F.length===1?F[0]:F},l.alter=function(E,N){return l.map(E,N,!0)},l.create=function(E,N,R){var C=new Array(E),D,M;for(o(N)&&(R=N,N=E),D=0;D<E;D++)for(C[D]=new Array(N),M=0;M<N;M++)C[D][M]=R(D,M);return C};function v(){return 0}l.zeros=function(E,N){return u(N)||(N=E),l.create(E,N,v)};function d(){return 1}l.ones=function(E,N){return u(N)||(N=E),l.create(E,N,d)},l.rand=function(E,N){return u(N)||(N=E),l.create(E,N,l._random_fn)};function p(I,E){return I===E?1:0}l.identity=function(E,N){return u(N)||(N=E),l.create(E,N,p)},l.symmetric=function(E){var N=E.length,R,C;if(E.length!==E[0].length)return!1;for(R=0;R<N;R++)for(C=0;C<N;C++)if(E[C][R]!==E[R][C])return!1;return!0},l.clear=function(E){return l.alter(E,v)},l.seq=function(E,N,R,C){o(C)||(C=!1);var D=[],M=h(E,N),F=(N*M-E*M)/((R-1)*M),Y=E,Q;for(Q=0;Y<=N&&Q<R;Q++,Y=(E*M+F*M*Q)/M)D.push(C?C(Y,Q):Y);return D},l.arange=function(E,N,R){var C=[],D;if(R=R||1,N===i&&(N=E,E=0),E===N||R===0)return[];if(E<N&&R<0)return[];if(E>N&&R>0)return[];if(R>0)for(D=E;D<N;D+=R)C.push(D);else for(D=E;D>N;D+=R)C.push(D);return C},l.slice=function(){function I(N,R,C,D){var M,F=[],Y=N.length;if(R===i&&C===i&&D===i)return l.copy(N);if(R=R||0,C=C||N.length,R=R>=0?R:Y+R,C=C>=0?C:Y+C,D=D||1,R===C||D===0)return[];if(R<C&&D<0)return[];if(R>C&&D>0)return[];if(D>0)for(M=R;M<C;M+=D)F.push(N[M]);else for(M=R;M>C;M+=D)F.push(N[M]);return F}function E(N,R){var C,D;if(R=R||{},u(R.row)){if(u(R.col))return N[R.row][R.col];var M=l.rowa(N,R.row);return C=R.col||{},I(M,C.start,C.end,C.step)}if(u(R.col)){var F=l.cola(N,R.col);return D=R.row||{},I(F,D.start,D.end,D.step)}D=R.row||{},C=R.col||{};var Y=I(N,D.start,D.end,D.step);return Y.map(function(Q){return I(Q,C.start,C.end,C.step)})}return E}(),l.sliceAssign=function(E,N,R){var C,D;if(u(N.row)){if(u(N.col))return E[N.row][N.col]=R;N.col=N.col||{},N.col.start=N.col.start||0,N.col.end=N.col.end||E[0].length,N.col.step=N.col.step||1,C=l.arange(N.col.start,e.min(E.length,N.col.end),N.col.step);var M=N.row;return C.forEach(function(Y,Q){E[M][Y]=R[Q]}),E}if(u(N.col)){N.row=N.row||{},N.row.start=N.row.start||0,N.row.end=N.row.end||E.length,N.row.step=N.row.step||1,D=l.arange(N.row.start,e.min(E[0].length,N.row.end),N.row.step);var F=N.col;return D.forEach(function(Y,Q){E[Y][F]=R[Q]}),E}return R[0].length===i&&(R=[R]),N.row.start=N.row.start||0,N.row.end=N.row.end||E.length,N.row.step=N.row.step||1,N.col.start=N.col.start||0,N.col.end=N.col.end||E[0].length,N.col.step=N.col.step||1,D=l.arange(N.row.start,e.min(E.length,N.row.end),N.row.step),C=l.arange(N.col.start,e.min(E[0].length,N.col.end),N.col.step),D.forEach(function(Y,Q){C.forEach(function(j,rn){E[Y][j]=R[Q][rn]})}),E},l.diagonal=function(E){var N=l.zeros(E.length,E.length);return E.forEach(function(R,C){N[C][C]=R}),N},l.copy=function(E){return E.map(function(N){return u(N)?N:N.map(function(R){return R})})};var A=l.prototype;return A.length=0,A.push=Array.prototype.push,A.sort=Array.prototype.sort,A.splice=Array.prototype.splice,A.slice=Array.prototype.slice,A.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},A.map=function(E,N){return l(l.map(this,E,N))},A.cumreduce=function(E,N){return l(l.cumreduce(this,E,N))},A.alter=function(E){return l.alter(this,E),this},function(I){for(var E=0;E<I.length;E++)(function(N){A[N]=function(R){var C=this,D;return R?(setTimeout(function(){R.call(C,A[N].call(C))}),this):(D=l[N](this),f(D)?l(D):D)}})(I[E])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(I){for(var E=0;E<I.length;E++)(function(N){A[N]=function(R,C){var D=this;return C?(setTimeout(function(){C.call(D,A[N].call(D,R))}),this):l(l[N](this,R))}})(I[E])}("row col".split(" ")),function(I){for(var E=0;E<I.length;E++)(function(N){A[N]=function(){return l(l[N].apply(null,arguments))}})(I[E])}("create zeros ones rand identity".split(" ")),l}(Math);return function(e,i){var c=e.utils.isFunction;function a(f,o){return f-o}function g(f,o,u){return i.max(o,i.min(f,u))}e.sum=function(o){for(var u=0,s=o.length;--s>=0;)u+=o[s];return u},e.sumsqrd=function(o){for(var u=0,s=o.length;--s>=0;)u+=o[s]*o[s];return u},e.sumsqerr=function(o){for(var u=e.mean(o),s=0,l=o.length,v;--l>=0;)v=o[l]-u,s+=v*v;return s},e.sumrow=function(o){for(var u=0,s=o.length;--s>=0;)u+=o[s];return u},e.product=function(o){for(var u=1,s=o.length;--s>=0;)u*=o[s];return u},e.min=function(o){for(var u=o[0],s=0;++s<o.length;)o[s]<u&&(u=o[s]);return u},e.max=function(o){for(var u=o[0],s=0;++s<o.length;)o[s]>u&&(u=o[s]);return u},e.unique=function(o){for(var u={},s=[],l=0;l<o.length;l++)u[o[l]]||(u[o[l]]=!0,s.push(o[l]));return s},e.mean=function(o){return e.sum(o)/o.length},e.meansqerr=function(o){return e.sumsqerr(o)/o.length},e.geomean=function(o){var u=o.map(i.log),s=e.mean(u);return i.exp(s)},e.median=function(o){var u=o.length,s=o.slice().sort(a);return u&1?s[u/2|0]:(s[u/2-1]+s[u/2])/2},e.cumsum=function(o){return e.cumreduce(o,function(u,s){return u+s})},e.cumprod=function(o){return e.cumreduce(o,function(u,s){return u*s})},e.diff=function(o){var u=[],s=o.length,l;for(l=1;l<s;l++)u.push(o[l]-o[l-1]);return u},e.rank=function(f){var o,u=[],s={};for(o=0;o<f.length;o++){var l=f[o];s[l]?s[l]++:(s[l]=1,u.push(l))}var v=u.sort(a),d={},p=1;for(o=0;o<v.length;o++){var l=v[o],A=s[l],I=p,E=p+A-1,N=(I+E)/2;d[l]=N,p+=A}return f.map(function(R){return d[R]})},e.mode=function(o){var u=o.length,s=o.slice().sort(a),l=1,v=0,d=0,p=[],A;for(A=0;A<u;A++)s[A]===s[A+1]?l++:(l>v?(p=[s[A]],v=l,d=0):l===v&&(p.push(s[A]),d++),l=1);return d===0?p[0]:p},e.range=function(o){return e.max(o)-e.min(o)},e.variance=function(o,u){return e.sumsqerr(o)/(o.length-(u?1:0))},e.pooledvariance=function(o){var u=o.reduce(function(l,v){return l+e.sumsqerr(v)},0),s=o.reduce(function(l,v){return l+v.length},0);return u/(s-o.length)},e.deviation=function(f){for(var o=e.mean(f),u=f.length,s=new Array(u),l=0;l<u;l++)s[l]=f[l]-o;return s},e.stdev=function(o,u){return i.sqrt(e.variance(o,u))},e.pooledstdev=function(o){return i.sqrt(e.pooledvariance(o))},e.meandev=function(o){for(var u=e.mean(o),s=[],l=o.length-1;l>=0;l--)s.push(i.abs(o[l]-u));return e.mean(s)},e.meddev=function(o){for(var u=e.median(o),s=[],l=o.length-1;l>=0;l--)s.push(i.abs(o[l]-u));return e.median(s)},e.coeffvar=function(o){return e.stdev(o)/e.mean(o)},e.quartiles=function(o){var u=o.length,s=o.slice().sort(a);return[s[i.round(u/4)-1],s[i.round(u/2)-1],s[i.round(u*3/4)-1]]},e.quantiles=function(o,u,s,l){var v=o.slice().sort(a),d=[u.length],p=o.length,A,I,E,N,R,C;for(typeof s>"u"&&(s=3/8),typeof l>"u"&&(l=3/8),A=0;A<u.length;A++)I=u[A],E=s+I*(1-s-l),N=p*I+E,R=i.floor(g(N,1,p-1)),C=g(N-R,0,1),d[A]=(1-C)*v[R-1]+C*v[R];return d},e.percentile=function(o,u,s){var l=o.slice().sort(a),v=u*(l.length+(s?1:-1))+(s?0:1),d=parseInt(v),p=v-d;return d+1<l.length?l[d-1]+p*(l[d]-l[d-1]):l[d-1]},e.percentileOfScore=function(o,u,s){var l=0,v=o.length,d=!1,p,A;for(s==="strict"&&(d=!0),A=0;A<v;A++)p=o[A],(d&&p<u||!d&&p<=u)&&l++;return l/v},e.histogram=function(o,u){u=u||4;var s=e.min(o),l=(e.max(o)-s)/u,v=o.length,d=[],p;for(p=0;p<u;p++)d[p]=0;for(p=0;p<v;p++)d[i.min(i.floor((o[p]-s)/l),u-1)]+=1;return d},e.covariance=function(o,u){var s=e.mean(o),l=e.mean(u),v=o.length,d=new Array(v),p;for(p=0;p<v;p++)d[p]=(o[p]-s)*(u[p]-l);return e.sum(d)/(v-1)},e.corrcoeff=function(o,u){return e.covariance(o,u)/e.stdev(o,1)/e.stdev(u,1)},e.spearmancoeff=function(f,o){return f=e.rank(f),o=e.rank(o),e.corrcoeff(f,o)},e.stanMoment=function(o,u){for(var s=e.mean(o),l=e.stdev(o),v=o.length,d=0,p=0;p<v;p++)d+=i.pow((o[p]-s)/l,u);return d/o.length},e.skewness=function(o){return e.stanMoment(o,3)},e.kurtosis=function(o){return e.stanMoment(o,4)-3};var h=e.prototype;(function(f){for(var o=0;o<f.length;o++)(function(u){h[u]=function(s,l){var v=[],d=0,p=this;if(c(s)&&(l=s,s=!1),l)return setTimeout(function(){l.call(p,h[u].call(p,s))}),this;if(this.length>1){for(p=s===!0?this:this.transpose();d<p.length;d++)v[d]=e[u](p[d]);return v}return e[u](this[0],s)}})(f[o])})("cumsum cumprod".split(" ")),function(f){for(var o=0;o<f.length;o++)(function(u){h[u]=function(s,l){var v=[],d=0,p=this;if(c(s)&&(l=s,s=!1),l)return setTimeout(function(){l.call(p,h[u].call(p,s))}),this;if(this.length>1){for(u!=="sumrow"&&(p=s===!0?this:this.transpose());d<p.length;d++)v[d]=e[u](p[d]);return s===!0?e[u](e.utils.toVector(v)):v}return e[u](this[0],s)}})(f[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(f){for(var o=0;o<f.length;o++)(function(u){h[u]=function(){var s=[],l=0,v=this,d=Array.prototype.slice.call(arguments),p;if(c(d[d.length-1])){p=d[d.length-1];var A=d.slice(0,d.length-1);return setTimeout(function(){p.call(v,h[u].apply(v,A))}),this}else{p=void 0;var I=function(N){return e[u].apply(v,[N].concat(d))}}if(this.length>1){for(v=v.transpose();l<v.length;l++)s[l]=I(v[l]);return s}return I(this[0])}})(f[o])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,i){e.gammaln=function(a){var g=0,h=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,o,u,s;for(s=(u=o=a)+5.5,s-=(o+.5)*i.log(s);g<6;g++)f+=h[g]/++u;return i.log(2.5066282746310007*f/o)-s},e.loggam=function(a){var g,h,f,o,u,s,l,v=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(g=a,l=0,a==1||a==2)return 0;for(a<=7&&(l=i.floor(7-a),g=a+l),h=1/(g*g),f=2*i.PI,u=v[9],s=8;s>=0;s--)u*=h,u+=v[s];if(o=u/g+.5*i.log(f)+(g-.5)*i.log(g)-g,a<=7)for(s=1;s<=l;s++)o-=i.log(g-1),g-=1;return o},e.gammafn=function(a){var g=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,o=0,u=0,s=0,l=a,v,d,p,A;if(a>171.6243769536076)return 1/0;if(l<=0)if(A=l%1+36e-17,A)f=(l&1?-1:1)*i.PI/i.sin(i.PI*A),l=1-l;else return 1/0;for(p=l,l<1?d=l++:d=(l-=o=(l|0)-1)-1,v=0;v<8;++v)s=(s+g[v])*d,u=u*d+h[v];if(A=s/u+1,p<l)A/=p;else if(p>l)for(v=0;v<o;++v)A*=l,l++;return f&&(A=f/A),A},e.gammap=function(a,g){return e.lowRegGamma(a,g)*e.gammafn(a)},e.lowRegGamma=function(a,g){var h=e.gammaln(a),f=a,o=1/a,u=o,s=g+1-a,l=1/1e-30,v=1/s,d=v,p=1,A=-~(i.log(a>=1?a:1/a)*8.5+a*.4+17),I;if(g<0||a<=0)return NaN;if(g<a+1){for(;p<=A;p++)o+=u*=g/++f;return o*i.exp(-g+a*i.log(g)-h)}for(;p<=A;p++)I=-p*(p-a),s+=2,v=I*v+s,l=s+I/l,v=1/v,d*=v*l;return 1-d*i.exp(-g+a*i.log(g)-h)},e.factorialln=function(a){return a<0?NaN:e.gammaln(a+1)},e.factorial=function(a){return a<0?NaN:e.gammafn(a+1)},e.combination=function(a,g){return a>170||g>170?i.exp(e.combinationln(a,g)):e.factorial(a)/e.factorial(g)/e.factorial(a-g)},e.combinationln=function(a,g){return e.factorialln(a)-e.factorialln(g)-e.factorialln(a-g)},e.permutation=function(a,g){return e.factorial(a)/e.factorial(a-g)},e.betafn=function(a,g){if(!(a<=0||g<=0))return a+g>170?i.exp(e.betaln(a,g)):e.gammafn(a)*e.gammafn(g)/e.gammafn(a+g)},e.betaln=function(a,g){return e.gammaln(a)+e.gammaln(g)-e.gammaln(a+g)},e.betacf=function(a,g,h){var f=1e-30,o=1,u=g+h,s=g+1,l=g-1,v=1,d=1-u*a/s,p,A,I,E;for(i.abs(d)<f&&(d=f),d=1/d,E=d;o<=100&&(p=2*o,A=o*(h-o)*a/((l+p)*(g+p)),d=1+A*d,i.abs(d)<f&&(d=f),v=1+A/v,i.abs(v)<f&&(v=f),d=1/d,E*=d*v,A=-(g+o)*(u+o)*a/((g+p)*(s+p)),d=1+A*d,i.abs(d)<f&&(d=f),v=1+A/v,i.abs(v)<f&&(v=f),d=1/d,I=d*v,E*=I,!(i.abs(I-1)<3e-7));o++);return E},e.gammapinv=function(a,g){var h=0,f=g-1,o=1e-8,u=e.gammaln(g),s,l,v,d,p,A,I;if(a>=1)return i.max(100,g+100*i.sqrt(g));if(a<=0)return 0;for(g>1?(A=i.log(f),I=i.exp(f*(A-1)-u),p=a<.5?a:1-a,v=i.sqrt(-2*i.log(p)),s=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,a<.5&&(s=-s),s=i.max(.001,g*i.pow(1-1/(9*g)-s/(3*i.sqrt(g)),3))):(v=1-g*(.253+g*.12),a<v?s=i.pow(a/v,1/g):s=1-i.log(1-(a-v)/(1-v)));h<12;h++){if(s<=0)return 0;if(l=e.lowRegGamma(g,s)-a,g>1?v=I*i.exp(-(s-f)+f*(i.log(s)-A)):v=i.exp(-s+f*i.log(s)-u),d=l/v,s-=v=d/(1-.5*i.min(1,d*((g-1)/s-1))),s<=0&&(s=.5*(s+v)),i.abs(v)<o*s)break}return s},e.erf=function(a){var g=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=g.length-1,f=!1,o=0,u=0,s,l,v,d;for(a<0&&(a=-a,f=!0),s=2/(2+a),l=4*s-2;h>0;h--)v=o,o=l*o-u+g[h],u=v;return d=s*i.exp(-a*a+.5*(g[0]+l*o)-u),f?d-1:1-d},e.erfc=function(a){return 1-e.erf(a)},e.erfcinv=function(a){var g=0,h,f,o,u;if(a>=2)return-100;if(a<=0)return 100;for(u=a<1?a:2-a,o=i.sqrt(-2*i.log(u/2)),h=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);g<2;g++)f=e.erfc(h)-u,h+=f/(1.1283791670955126*i.exp(-h*h)-h*f);return a<1?h:-h},e.ibetainv=function(a,g,h){var f=1e-8,o=g-1,u=h-1,s=0,l,v,d,p,A,I,E,N,R,C,D;if(a<=0)return 0;if(a>=1)return 1;for(g>=1&&h>=1?(d=a<.5?a:1-a,p=i.sqrt(-2*i.log(d)),E=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,a<.5&&(E=-E),N=(E*E-3)/6,R=2/(1/(2*g-1)+1/(2*h-1)),C=E*i.sqrt(N+R)/R-(1/(2*h-1)-1/(2*g-1))*(N+5/6-2/(3*R)),E=g/(g+h*i.exp(2*C))):(l=i.log(g/(g+h)),v=i.log(h/(g+h)),p=i.exp(g*l)/g,A=i.exp(h*v)/h,C=p+A,a<p/C?E=i.pow(g*C*a,1/g):E=1-i.pow(h*C*(1-a),1/h)),D=-e.gammaln(g)-e.gammaln(h)+e.gammaln(g+h);s<10;s++){if(E===0||E===1)return E;if(I=e.ibeta(E,g,h)-a,p=i.exp(o*i.log(E)+u*i.log(1-E)+D),A=I/p,E-=p=A/(1-.5*i.min(1,A*(o/E-u/(1-E)))),E<=0&&(E=.5*(E+p)),E>=1&&(E=.5*(E+p+1)),i.abs(p)<f*E&&s>0)break}return E},e.ibeta=function(a,g,h){var f=a===0||a===1?0:i.exp(e.gammaln(g+h)-e.gammaln(g)-e.gammaln(h)+g*i.log(a)+h*i.log(1-a));return a<0||a>1?!1:a<(g+1)/(g+h+2)?f*e.betacf(a,g,h)/g:1-f*e.betacf(1-a,h,g)/h},e.randn=function(a,g){var h,f,o,u,s;if(g||(g=a),a)return e.create(a,g,function(){return e.randn()});do h=e._random_fn(),f=1.7156*(e._random_fn()-.5),o=h-.449871,u=i.abs(f)+.386595,s=o*o+u*(.196*u-.25472*o);while(s>.27597&&(s>.27846||f*f>-4*i.log(h)*h*h));return f/h},e.randg=function(a,g,h){var f=a,o,u,s,l,v,d;if(h||(h=g),a||(a=1),g)return d=e.zeros(g,h),d.alter(function(){return e.randg(a)}),d;a<1&&(a+=1),o=a-1/3,u=1/i.sqrt(9*o);do{do v=e.randn(),l=1+u*v;while(l<=0);l=l*l*l,s=e._random_fn()}while(s>1-.331*i.pow(v,4)&&i.log(s)>.5*v*v+o*(1-l+i.log(l)));if(a==f)return o*l;do s=e._random_fn();while(s===0);return i.pow(s,1/f)*o*l},function(c){for(var a=0;a<c.length;a++)(function(g){e.fn[g]=function(){return e(e.map(this,function(h){return e[g](h)}))}})(c[a])}("gammaln gammafn factorial factorialln".split(" ")),function(c){for(var a=0;a<c.length;a++)(function(g){e.fn[g]=function(){return e(e[g].apply(null,arguments))}})(c[a])}("randn".split(" "))}(t,Math),function(e,i){(function(f){for(var o=0;o<f.length;o++)(function(u){e[u]=function s(l,v,d){return this instanceof s?(this._a=l,this._b=v,this._c=d,this):new s(l,v,d)},e.fn[u]=function(s,l,v){var d=e[u](s,l,v);return d.data=this,d},e[u].prototype.sample=function(s){var l=this._a,v=this._b,d=this._c;return s?e.alter(s,function(){return e[u].sample(l,v,d)}):e[u].sample(l,v,d)},function(s){for(var l=0;l<s.length;l++)(function(v){e[u].prototype[v]=function(d){var p=this._a,A=this._b,I=this._c;return!d&&d!==0&&(d=this.data),typeof d!="number"?e.fn.map.call(d,function(E){return e[u][v](E,p,A,I)}):e[u][v](d,p,A,I)}})(s[l])}("pdf cdf inv".split(" ")),function(s){for(var l=0;l<s.length;l++)(function(v){e[u].prototype[v]=function(){return e[u][v](this._a,this._b,this._c)}})(s[l])}("mean median mode variance".split(" "))})(f[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(o,u,s){return o>1||o<0?0:u==1&&s==1?1:u<512&&s<512?i.pow(o,u-1)*i.pow(1-o,s-1)/e.betafn(u,s):i.exp((u-1)*i.log(o)+(s-1)*i.log(1-o)-e.betaln(u,s))},cdf:function(o,u,s){return o>1||o<0?(o>1)*1:e.ibeta(o,u,s)},inv:function(o,u,s){return e.ibetainv(o,u,s)},mean:function(o,u){return o/(o+u)},median:function(o,u){return e.ibetainv(.5,o,u)},mode:function(o,u){return(o-1)/(o+u-2)},sample:function(o,u){var s=e.randg(o);return s/(s+e.randg(u))},variance:function(o,u){return o*u/(i.pow(o+u,2)*(o+u+1))}}),e.extend(e.centralF,{pdf:function(o,u,s){var l,v,d;return o<0?0:u<=2?o===0&&u<2?1/0:o===0&&u===2?1:1/e.betafn(u/2,s/2)*i.pow(u/s,u/2)*i.pow(o,u/2-1)*i.pow(1+u/s*o,-(u+s)/2):(l=u*o/(s+o*u),v=s/(s+o*u),d=u*v/2,d*e.binomial.pdf((u-2)/2,(u+s-2)/2,l))},cdf:function(o,u,s){return o<0?0:e.ibeta(u*o/(u*o+s),u/2,s/2)},inv:function(o,u,s){return s/(u*(1/e.ibetainv(o,u/2,s/2)-1))},mean:function(o,u){return u>2?u/(u-2):void 0},mode:function(o,u){return o>2?u*(o-2)/(o*(u+2)):void 0},sample:function(o,u){var s=e.randg(o/2)*2,l=e.randg(u/2)*2;return s/o/(l/u)},variance:function(o,u){if(!(u<=4))return 2*u*u*(o+u-2)/(o*(u-2)*(u-2)*(u-4))}}),e.extend(e.cauchy,{pdf:function(o,u,s){return s<0?0:s/(i.pow(o-u,2)+i.pow(s,2))/i.PI},cdf:function(o,u,s){return i.atan((o-u)/s)/i.PI+.5},inv:function(f,o,u){return o+u*i.tan(i.PI*(f-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,u){return e.randn()*i.sqrt(1/(2*e.randg(.5)))*u+o}}),e.extend(e.chisquare,{pdf:function(o,u){return o<0?0:o===0&&u===2?.5:i.exp((u/2-1)*i.log(o)-o/2-u/2*i.log(2)-e.gammaln(u/2))},cdf:function(o,u){return o<0?0:e.lowRegGamma(u/2,o/2)},inv:function(f,o){return 2*e.gammapinv(f,.5*o)},mean:function(f){return f},median:function(o){return o*i.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return e.randg(o/2)*2},variance:function(o){return 2*o}}),e.extend(e.exponential,{pdf:function(o,u){return o<0?0:u*i.exp(-u*o)},cdf:function(o,u){return o<0?0:1-i.exp(-u*o)},inv:function(f,o){return-i.log(1-f)/o},mean:function(f){return 1/f},median:function(f){return 1/f*i.log(2)},mode:function(){return 0},sample:function(o){return-1/o*i.log(e._random_fn())},variance:function(f){return i.pow(f,-2)}}),e.extend(e.gamma,{pdf:function(o,u,s){return o<0?0:o===0&&u===1?1/s:i.exp((u-1)*i.log(o)-o/s-e.gammaln(u)-u*i.log(s))},cdf:function(o,u,s){return o<0?0:e.lowRegGamma(u,o/s)},inv:function(f,o,u){return e.gammapinv(f,o)*u},mean:function(f,o){return f*o},mode:function(o,u){if(o>1)return(o-1)*u},sample:function(o,u){return e.randg(o)*u},variance:function(o,u){return o*u*u}}),e.extend(e.invgamma,{pdf:function(o,u,s){return o<=0?0:i.exp(-(u+1)*i.log(o)-s/o-e.gammaln(u)+u*i.log(s))},cdf:function(o,u,s){return o<=0?0:1-e.lowRegGamma(u,s/o)},inv:function(f,o,u){return u/e.gammapinv(1-f,o)},mean:function(f,o){return f>1?o/(f-1):void 0},mode:function(o,u){return u/(o+1)},sample:function(o,u){return u/e.randg(o)},variance:function(o,u){if(!(o<=2))return u*u/((o-1)*(o-1)*(o-2))}}),e.extend(e.kumaraswamy,{pdf:function(o,u,s){return o===0&&u===1?s:o===1&&s===1?u:i.exp(i.log(u)+i.log(s)+(u-1)*i.log(o)+(s-1)*i.log(1-i.pow(o,u)))},cdf:function(o,u,s){return o<0?0:o>1?1:1-i.pow(1-i.pow(o,u),s)},inv:function(o,u,s){return i.pow(1-i.pow(1-o,1/s),1/u)},mean:function(f,o){return o*e.gammafn(1+1/f)*e.gammafn(o)/e.gammafn(1+1/f+o)},median:function(o,u){return i.pow(1-i.pow(2,-1/u),1/o)},mode:function(o,u){if(o>=1&&u>=1&&o!==1&&u!==1)return i.pow((o-1)/(o*u-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(o,u,s){return o<=0?0:i.exp(-i.log(o)-.5*i.log(2*i.PI)-i.log(s)-i.pow(i.log(o)-u,2)/(2*s*s))},cdf:function(o,u,s){return o<0?0:.5+.5*e.erf((i.log(o)-u)/i.sqrt(2*s*s))},inv:function(f,o,u){return i.exp(-1.4142135623730951*u*e.erfcinv(2*f)+o)},mean:function(o,u){return i.exp(o+u*u/2)},median:function(o){return i.exp(o)},mode:function(o,u){return i.exp(o-u*u)},sample:function(o,u){return i.exp(e.randn()*u+o)},variance:function(o,u){return(i.exp(u*u)-1)*i.exp(2*o+u*u)}}),e.extend(e.noncentralt,{pdf:function(o,u,s){var l=1e-14;return i.abs(s)<l?e.studentt.pdf(o,u):i.abs(o)<l?i.exp(e.gammaln((u+1)/2)-s*s/2-.5*i.log(i.PI*u)-e.gammaln(u/2)):u/o*(e.noncentralt.cdf(o*i.sqrt(1+2/u),u+2,s)-e.noncentralt.cdf(o,u,s))},cdf:function(o,u,s){var l=1e-14,v=200;if(i.abs(s)<l)return e.studentt.cdf(o,u);var d=!1;o<0&&(d=!0,s=-s);for(var p=e.normal.cdf(-s,0,1),A=l+1,I=A,E=o*o/(o*o+u),N=0,R=i.exp(-s*s/2),C=i.exp(-s*s/2-.5*i.log(2)-e.gammaln(3/2))*s;N<v||I>l||A>l;)I=A,N>0&&(R*=s*s/(2*N),C*=s*s/(2*(N+1/2))),A=R*e.beta.cdf(E,N+.5,u/2)+C*e.beta.cdf(E,N+1,u/2),p+=.5*A,N++;return d?1-p:p}}),e.extend(e.normal,{pdf:function(o,u,s){return i.exp(-.5*i.log(2*i.PI)-i.log(s)-i.pow(o-u,2)/(2*s*s))},cdf:function(o,u,s){return .5*(1+e.erf((o-u)/i.sqrt(2*s*s)))},inv:function(f,o,u){return-1.4142135623730951*u*e.erfcinv(2*f)+o},mean:function(f){return f},median:function(o){return o},mode:function(f){return f},sample:function(o,u){return e.randn()*u+o},variance:function(f,o){return o*o}}),e.extend(e.pareto,{pdf:function(o,u,s){return o<u?0:s*i.pow(u,s)/i.pow(o,s+1)},cdf:function(o,u,s){return o<u?0:1-i.pow(u/o,s)},inv:function(o,u,s){return u/i.pow(1-o,1/s)},mean:function(o,u){if(!(u<=1))return u*i.pow(o,u)/(u-1)},median:function(o,u){return o*(u*i.SQRT2)},mode:function(o){return o},variance:function(f,o){if(!(o<=2))return f*f*o/(i.pow(o-1,2)*(o-2))}}),e.extend(e.studentt,{pdf:function(o,u){return u=u>1e100?1e100:u,1/(i.sqrt(u)*e.betafn(.5,u/2))*i.pow(1+o*o/u,-((u+1)/2))},cdf:function(o,u){var s=u/2;return e.ibeta((o+i.sqrt(o*o+u))/(2*i.sqrt(o*o+u)),s,s)},inv:function(f,o){var u=e.ibetainv(2*i.min(f,1-f),.5*o,.5);return u=i.sqrt(o*(1-u)/u),f>.5?u:-u},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return e.randn()*i.sqrt(o/(2*e.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(o,u,s){return o<0||u<0||s<0?0:s/u*i.pow(o/u,s-1)*i.exp(-i.pow(o/u,s))},cdf:function(o,u,s){return o<0?0:1-i.exp(-i.pow(o/u,s))},inv:function(f,o,u){return o*i.pow(-i.log(1-f),1/u)},mean:function(f,o){return f*e.gammafn(1+1/o)},median:function(o,u){return o*i.pow(i.log(2),1/u)},mode:function(o,u){return u<=1?0:o*i.pow((u-1)/u,1/u)},sample:function(o,u){return o*i.pow(-i.log(e._random_fn()),1/u)},variance:function(o,u){return o*o*e.gammafn(1+2/u)-i.pow(e.weibull.mean(o,u),2)}}),e.extend(e.uniform,{pdf:function(o,u,s){return o<u||o>s?0:1/(s-u)},cdf:function(o,u,s){return o<u?0:o<s?(o-u)/(s-u):1},inv:function(f,o,u){return o+f*(u-o)},mean:function(o,u){return .5*(o+u)},median:function(o,u){return e.mean(o,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,u){return o/2+u/2+(u/2-o/2)*(2*e._random_fn()-1)},variance:function(o,u){return i.pow(u-o,2)/12}});function c(f,o,u,s){for(var l=0,v=1,d=1,p=1,A=0,I=0,E;i.abs((d-I)/d)>s;)I=d,E=-(o+A)*(o+u+A)*f/(o+2*A)/(o+2*A+1),l=d+E*l,v=p+E*v,A=A+1,E=A*(u-A)*f/(o+2*A-1)/(o+2*A),d=l+E*d,p=v+E*p,l=l/p,v=v/p,d=d/p,p=1;return d/o}e.extend(e.binomial,{pdf:function(o,u,s){return s===0||s===1?u*s===o?1:0:e.combination(u,o)*i.pow(s,o)*i.pow(1-s,u-o)},cdf:function(o,u,s){var l,v=1e-10;if(o<0)return 0;if(o>=u)return 1;if(s<0||s>1||u<=0)return NaN;o=i.floor(o);var d=s,p=o+1,A=u-o,I=p+A,E=i.exp(e.gammaln(I)-e.gammaln(A)-e.gammaln(p)+p*i.log(d)+A*i.log(1-d));return d<(p+1)/(I+2)?l=E*c(d,p,A,v):l=1-E*c(1-d,A,p,v),i.round((1-l)*(1/v))/(1/v)}}),e.extend(e.negbin,{pdf:function(o,u,s){return o!==o>>>0?!1:o<0?0:e.combination(o+u-1,u-1)*i.pow(1-s,o)*i.pow(s,u)},cdf:function(o,u,s){var l=0,v=0;if(o<0)return 0;for(;v<=o;v++)l+=e.negbin.pdf(v,u,s);return l}}),e.extend(e.hypgeom,{pdf:function(o,u,s,l){if(o!==o|0)return!1;if(o<0||o<s-(u-l))return 0;if(o>l||o>s)return 0;if(s*2>u)return l*2>u?e.hypgeom.pdf(u-s-l+o,u,u-s,u-l):e.hypgeom.pdf(l-o,u,u-s,l);if(l*2>u)return e.hypgeom.pdf(s-o,u,s,u-l);if(s<l)return e.hypgeom.pdf(o,u,l,s);for(var v=1,d=0,p=0;p<o;p++){for(;v>1&&d<l;)v*=1-s/(u-d),d++;v*=(l-p)*(s-p)/((p+1)*(u-s-l+p+1))}for(;d<l;d++)v*=1-s/(u-d);return i.min(1,i.max(0,v))},cdf:function(o,u,s,l){if(o<0||o<s-(u-l))return 0;if(o>=l||o>=s)return 1;if(s*2>u)return l*2>u?e.hypgeom.cdf(u-s-l+o,u,u-s,u-l):1-e.hypgeom.cdf(l-o-1,u,u-s,l);if(l*2>u)return 1-e.hypgeom.cdf(s-o-1,u,s,u-l);if(s<l)return e.hypgeom.cdf(o,u,l,s);for(var v=1,d=1,p=0,A=0;A<o;A++){for(;v>1&&p<l;){var I=1-s/(u-p);d*=I,v*=I,p++}d*=(l-A)*(s-A)/((A+1)*(u-s-l+A+1)),v+=d}for(;p<l;p++)v*=1-s/(u-p);return i.min(1,i.max(0,v))}}),e.extend(e.poisson,{pdf:function(o,u){return u<0||o%1!==0||o<0?0:i.pow(u,o)*i.exp(-u)/e.factorial(o)},cdf:function(o,u){var s=[],l=0;if(o<0)return 0;for(;l<=o;l++)s.push(e.poisson.pdf(l,u));return e.sum(s)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(o){var u=1,s=0,l=i.exp(-o);do s++,u*=e._random_fn();while(u>l);return s-1},sampleLarge:function(o){var u=o,s,l,v,d,p,A,I,E,N,R;for(d=i.sqrt(u),p=i.log(u),I=.931+2.53*d,A=-.059+.02483*I,E=1.1239+1.1328/(I-3.4),N=.9277-3.6224/(I-2);;){if(l=i.random()-.5,v=i.random(),R=.5-i.abs(l),s=i.floor((2*A/R+I)*l+u+.43),R>=.07&&v<=N)return s;if(!(s<0||R<.013&&v>R)&&i.log(v)+i.log(E)-i.log(A/(R*R)+I)<=-u+s*p-e.loggam(s+1))return s}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),e.extend(e.triangular,{pdf:function(o,u,s,l){return s<=u||l<u||l>s?NaN:o<u||o>s?0:o<l?2*(o-u)/((s-u)*(l-u)):o===l?2/(s-u):2*(s-o)/((s-u)*(s-l))},cdf:function(o,u,s,l){return s<=u||l<u||l>s?NaN:o<=u?0:o>=s?1:o<=l?i.pow(o-u,2)/((s-u)*(l-u)):1-i.pow(s-o,2)/((s-u)*(s-l))},inv:function(o,u,s,l){return s<=u||l<u||l>s?NaN:o<=(l-u)/(s-u)?u+(s-u)*i.sqrt(o*((l-u)/(s-u))):u+(s-u)*(1-i.sqrt((1-o)*(1-(l-u)/(s-u))))},mean:function(o,u,s){return(o+u+s)/3},median:function(o,u,s){if(s<=(o+u)/2)return u-i.sqrt((u-o)*(u-s))/i.sqrt(2);if(s>(o+u)/2)return o+i.sqrt((u-o)*(s-o))/i.sqrt(2)},mode:function(o,u,s){return s},sample:function(o,u,s){var l=e._random_fn();return l<(s-o)/(u-o)?o+i.sqrt(l*(u-o)*(s-o)):u-i.sqrt((1-l)*(u-o)*(u-s))},variance:function(o,u,s){return(o*o+u*u+s*s-o*u-o*s-u*s)/18}}),e.extend(e.arcsine,{pdf:function(o,u,s){return s<=u?NaN:o<=u||o>=s?0:2/i.PI*i.pow(i.pow(s-u,2)-i.pow(2*o-u-s,2),-.5)},cdf:function(o,u,s){return o<u?0:o<s?2/i.PI*i.asin(i.sqrt((o-u)/(s-u))):1},inv:function(f,o,u){return o+(.5-.5*i.cos(i.PI*f))*(u-o)},mean:function(o,u){return u<=o?NaN:(o+u)/2},median:function(o,u){return u<=o?NaN:(o+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,u){return(o+u)/2+(u-o)/2*i.sin(2*i.PI*e.uniform.sample(0,1))},variance:function(o,u){return u<=o?NaN:i.pow(u-o,2)/8}});function a(f){return f/i.abs(f)}e.extend(e.laplace,{pdf:function(o,u,s){return s<=0?0:i.exp(-i.abs(o-u)/s)/(2*s)},cdf:function(o,u,s){return s<=0?0:o<u?.5*i.exp((o-u)/s):1-.5*i.exp(-(o-u)/s)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,o){return 2*o*o},sample:function(o,u){var s=e._random_fn()-.5;return o-u*a(s)*i.log(1-2*i.abs(s))}});function g(f,o,u){var s=12,l=6,v=-30,d=-50,p=60,A=8,I=3,E=2,N=3,R=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],C=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],D=f*.5;if(D>=A)return 1;var M=2*e.normal.cdf(D,0,1,1,0)-1;M>=i.exp(d/u)?M=i.pow(M,u):M=0;var F;f>I?F=E:F=N;for(var Y=D,Q=(A-D)/F,j=Y+Q,rn=0,hn=u-1,In=1;In<=F;In++){for(var Mn=0,cn=.5*(j+Y),un=.5*(j-Y),Fn=1;Fn<=s;Fn++){var qn,Vn;l<Fn?(qn=s-Fn+1,Vn=R[qn-1]):(qn=Fn,Vn=-R[qn-1]);var $n=un*Vn,J=cn+$n,en=J*J;if(en>p)break;var an=2*e.normal.cdf(J,0,1,1,0),En=2*e.normal.cdf(J,f,1,1,0),Tn=an*.5-En*.5;Tn>=i.exp(v/hn)&&(Tn=C[qn-1]*i.exp(-(.5*en))*i.pow(Tn,hn),Mn+=Tn)}Mn*=2*un*u/i.sqrt(2*i.PI),rn+=Mn,Y=j,j+=Q}return M+=rn,M<=i.exp(v/o)?0:(M=i.pow(M,o),M>=1?1:M)}function h(f,o,u){var s=.322232421088,l=.099348462606,v=-1,d=.588581570495,p=-.342242088547,A=.531103462366,I=-.204231210125,E=.10353775285,N=-453642210148e-16,R=.0038560700634,C=.8832,D=.2368,M=1.208,F=1.4142,Y=120,Q=.5-.5*f,j=i.sqrt(i.log(1/(Q*Q))),rn=j+((((j*N+I)*j+p)*j+v)*j+s)/((((j*R+E)*j+A)*j+d)*j+l);u<Y&&(rn+=(rn*rn*rn+rn)/u/4);var hn=C-D*rn;return u<Y&&(hn+=-1.214/u+M*rn/u),rn*(hn*i.log(o-1)+F)}e.extend(e.tukey,{cdf:function(o,u,s){var l=1,v=u,d=16,p=8,A=-30,I=1e-14,E=100,N=800,R=5e3,C=25e3,D=1,M=.5,F=.25,Y=.125,Q=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],j=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(s<2||l<1||v<2)return NaN;if(!Number.isFinite(o))return 1;if(s>C)return g(o,l,v);var rn=s*.5,hn=rn*i.log(s)-s*i.log(2)-e.gammaln(rn),In=rn-1,Mn=s*.25,cn;s<=E?cn=D:s<=N?cn=M:s<=R?cn=F:cn=Y,hn+=i.log(cn);for(var un=0,Fn=1;Fn<=50;Fn++){for(var qn=0,Vn=(2*Fn-1)*cn,$n=1;$n<=d;$n++){var J,en;p<$n?(J=$n-p-1,en=hn+In*i.log(Vn+Q[J]*cn)-(Q[J]*cn+Vn)*Mn):(J=$n-1,en=hn+In*i.log(Vn-Q[J]*cn)+(Q[J]*cn-Vn)*Mn);var an;if(en>=A){p<$n?an=o*i.sqrt((Q[J]*cn+Vn)*.5):an=o*i.sqrt((-(Q[J]*cn)+Vn)*.5);var En=g(an,l,v),Tn=En*j[J]*i.exp(en);qn+=Tn}}if(Fn*cn>=1&&qn<=I)break;un+=qn}if(qn>I)throw new Error("tukey.cdf failed to converge");return un>1&&(un=1),un},inv:function(f,o,u){var s=1,l=o,v=1e-4,d=50;if(u<2||s<1||l<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var p=h(f,l,u),A=e.tukey.cdf(p,o,u)-f,I;A>0?I=i.max(0,p-1):I=p+1;for(var E=e.tukey.cdf(I,o,u)-f,N,R=1;R<d;R++){N=I-E*(I-p)/(E-A),A=E,p=I,N<0&&(N=0,E=-f),E=e.tukey.cdf(N,o,u)-f,I=N;var C=i.abs(I-p);if(C<v)return N}throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,i){var c=Array.prototype.push,a=e.utils.isArray;function g(h){return a(h)||h instanceof e}e.extend({add:function(f,o){return g(o)?(g(o[0])||(o=[o]),e.map(f,function(u,s,l){return u+o[s][l]})):e.map(f,function(u){return u+o})},subtract:function(f,o){return g(o)?(g(o[0])||(o=[o]),e.map(f,function(u,s,l){return u-o[s][l]||0})):e.map(f,function(u){return u-o})},divide:function(f,o){return g(o)?(g(o[0])||(o=[o]),e.multiply(f,e.inv(o))):e.map(f,function(u){return u/o})},multiply:function(f,o){var u,s,l,v,d,p,A,I;if(f.length===void 0&&o.length===void 0)return f*o;if(d=f.length,p=f[0].length,A=e.zeros(d,l=g(o)?o[0].length:p),I=0,g(o)){for(;I<l;I++)for(u=0;u<d;u++){for(v=0,s=0;s<p;s++)v+=f[u][s]*o[s][I];A[u][I]=v}return d===1&&I===1?A[0][0]:A}return e.map(f,function(E){return E*o})},outer:function(f,o){return e.multiply(f.map(function(u){return[u]}),[o])},dot:function(f,o){g(f[0])||(f=[f]),g(o[0])||(o=[o]);for(var u=f[0].length===1&&f.length!==1?e.transpose(f):f,s=o[0].length===1&&o.length!==1?e.transpose(o):o,l=[],v=0,d=u.length,p=u[0].length,A,I;v<d;v++){for(l[v]=[],A=0,I=0;I<p;I++)A+=u[v][I]*s[v][I];l[v]=A}return l.length===1?l[0]:l},pow:function(f,o){return e.map(f,function(u){return i.pow(u,o)})},exp:function(f){return e.map(f,function(o){return i.exp(o)})},log:function(f){return e.map(f,function(o){return i.log(o)})},abs:function(f){return e.map(f,function(o){return i.abs(o)})},norm:function(f,o){var u=0,s=0;for(isNaN(o)&&(o=2),g(f[0])&&(f=f[0]);s<f.length;s++)u+=i.pow(i.abs(f[s]),o);return i.pow(u,1/o)},angle:function(f,o){return i.acos(e.dot(f,o)/(e.norm(f)*e.norm(o)))},aug:function(f,o){var u=[],s;for(s=0;s<f.length;s++)u.push(f[s].slice());for(s=0;s<u.length;s++)c.apply(u[s],o[s]);return u},inv:function(f){for(var o=f.length,u=f[0].length,s=e.identity(o,u),l=e.gauss_jordan(f,s),v=[],d=0,p;d<o;d++)for(v[d]=[],p=u;p<l[0].length;p++)v[d][p-u]=l[d][p];return v},det:function h(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var o=0,u=0;u<f.length;u++){for(var s=[],l=1;l<f.length;l++){s[l-1]=[];for(var v=0;v<f.length;v++)v<u?s[l-1][v]=f[l][v]:v>u&&(s[l-1][v-1]=f[l][v])}var d=u%2?-1:1;o+=h(s)*f[0][u]*d}return o},gauss_elimination:function(f,o){var u=0,s=0,l=f.length,v=f[0].length,d=1,p=0,A=[],I,E,N,R;for(f=e.aug(f,o),I=f[0].length,u=0;u<l;u++){for(E=f[u][u],s=u,R=u+1;R<v;R++)E<i.abs(f[R][u])&&(E=f[R][u],s=R);if(s!=u)for(R=0;R<I;R++)N=f[u][R],f[u][R]=f[s][R],f[s][R]=N;for(s=u+1;s<l;s++)for(d=f[s][u]/f[u][u],R=u;R<I;R++)f[s][R]=f[s][R]-d*f[u][R]}for(u=l-1;u>=0;u--){for(p=0,s=u+1;s<=l-1;s++)p=p+A[s]*f[u][s];A[u]=(f[u][I-1]-p)/f[u][u]}return A},gauss_jordan:function(f,o){var u=e.aug(f,o),s=u.length,l=u[0].length,v=0,d,p,A;for(p=0;p<s;p++){var I=p;for(A=p+1;A<s;A++)i.abs(u[A][p])>i.abs(u[I][p])&&(I=A);var E=u[p];for(u[p]=u[I],u[I]=E,A=p+1;A<s;A++)for(v=u[A][p]/u[p][p],d=p;d<l;d++)u[A][d]-=u[p][d]*v}for(p=s-1;p>=0;p--){for(v=u[p][p],A=0;A<p;A++)for(d=l-1;d>p-1;d--)u[A][d]-=u[p][d]*u[A][p]/v;for(u[p][p]/=v,d=s;d<l;d++)u[p][d]/=v}return u},triaUpSolve:function(f,o){var u=f[0].length,s=e.zeros(1,u)[0],l,v=!1;return o[0].length!=null&&(o=o.map(function(d){return d[0]}),v=!0),e.arange(u-1,-1,-1).forEach(function(d){l=e.arange(d+1,u).map(function(p){return s[p]*f[d][p]}),s[d]=(o[d]-e.sum(l))/f[d][d]}),v?s.map(function(d){return[d]}):s},triaLowSolve:function(f,o){var u=f[0].length,s=e.zeros(1,u)[0],l,v=!1;return o[0].length!=null&&(o=o.map(function(d){return d[0]}),v=!0),e.arange(u).forEach(function(d){l=e.arange(d).map(function(p){return f[d][p]*s[p]}),s[d]=(o[d]-e.sum(l))/f[d][d]}),v?s.map(function(d){return[d]}):s},lu:function(f){var o=f.length,u=e.identity(o),s=e.zeros(f.length,f[0].length),l;return e.arange(o).forEach(function(v){s[0][v]=f[0][v]}),e.arange(1,o).forEach(function(v){e.arange(v).forEach(function(d){l=e.arange(d).map(function(p){return u[v][p]*s[p][d]}),u[v][d]=(f[v][d]-e.sum(l))/s[d][d]}),e.arange(v,o).forEach(function(d){l=e.arange(v).map(function(p){return u[v][p]*s[p][d]}),s[v][d]=f[l.length][d]-e.sum(l)})}),[u,s]},cholesky:function(f){var o=f.length,u=e.zeros(f.length,f[0].length),s;return e.arange(o).forEach(function(l){s=e.arange(l).map(function(v){return i.pow(u[l][v],2)}),u[l][l]=i.sqrt(f[l][l]-e.sum(s)),e.arange(l+1,o).forEach(function(v){s=e.arange(l).map(function(d){return u[l][d]*u[v][d]}),u[v][l]=(f[l][v]-e.sum(s))/u[l][l]})}),u},gauss_jacobi:function(f,o,u,s){for(var l=0,v=0,d=f.length,p=[],A=[],I=[],E,N,R,C;l<d;l++)for(p[l]=[],A[l]=[],I[l]=[],v=0;v<d;v++)l>v?(p[l][v]=f[l][v],A[l][v]=I[l][v]=0):l<v?(A[l][v]=f[l][v],p[l][v]=I[l][v]=0):(I[l][v]=f[l][v],p[l][v]=A[l][v]=0);for(R=e.multiply(e.multiply(e.inv(I),e.add(p,A)),-1),N=e.multiply(e.inv(I),o),E=u,C=e.add(e.multiply(R,u),N),l=2;i.abs(e.norm(e.subtract(C,E)))>s;)E=C,C=e.add(e.multiply(R,E),N),l++;return C},gauss_seidel:function(f,o,u,s){for(var l=0,v=f.length,d=[],p=[],A=[],I,E,N,R,C;l<v;l++)for(d[l]=[],p[l]=[],A[l]=[],I=0;I<v;I++)l>I?(d[l][I]=f[l][I],p[l][I]=A[l][I]=0):l<I?(p[l][I]=f[l][I],d[l][I]=A[l][I]=0):(A[l][I]=f[l][I],d[l][I]=p[l][I]=0);for(R=e.multiply(e.multiply(e.inv(e.add(A,d)),p),-1),N=e.multiply(e.inv(e.add(A,d)),o),E=u,C=e.add(e.multiply(R,u),N),l=2;i.abs(e.norm(e.subtract(C,E)))>s;)E=C,C=e.add(e.multiply(R,E),N),l=l+1;return C},SOR:function(f,o,u,s,l){for(var v=0,d=f.length,p=[],A=[],I=[],E,N,R,C,D;v<d;v++)for(p[v]=[],A[v]=[],I[v]=[],E=0;E<d;E++)v>E?(p[v][E]=f[v][E],A[v][E]=I[v][E]=0):v<E?(A[v][E]=f[v][E],p[v][E]=I[v][E]=0):(I[v][E]=f[v][E],p[v][E]=A[v][E]=0);for(C=e.multiply(e.inv(e.add(I,e.multiply(p,l))),e.subtract(e.multiply(I,1-l),e.multiply(A,l))),R=e.multiply(e.multiply(e.inv(e.add(I,e.multiply(p,l))),o),l),N=u,D=e.add(e.multiply(C,u),R),v=2;i.abs(e.norm(e.subtract(D,N)))>s;)N=D,D=e.add(e.multiply(C,N),R),v++;return D},householder:function(f){for(var o=f.length,u=f[0].length,s=0,l=[],v=[],d,p,A,I,E;s<o-1;s++){for(d=0,I=s+1;I<u;I++)d+=f[I][s]*f[I][s];for(E=f[s+1][s]>0?-1:1,d=E*i.sqrt(d),p=i.sqrt((d*d-f[s+1][s]*d)/2),l=e.zeros(o,1),l[s+1][0]=(f[s+1][s]-d)/(2*p),A=s+2;A<o;A++)l[A][0]=f[A][s]/(2*p);v=e.subtract(e.identity(o,u),e.multiply(e.multiply(l,e.transpose(l)),2)),f=e.multiply(v,e.multiply(f,v))}return f},QR:function(){var h=e.sum,f=e.arange;function o(u){var s=u.length,l=u[0].length,v=e.zeros(l,l);u=e.copy(u);var d,p,A;for(p=0;p<l;p++){for(v[p][p]=i.sqrt(h(f(s).map(function(I){return u[I][p]*u[I][p]}))),d=0;d<s;d++)u[d][p]=u[d][p]/v[p][p];for(A=p+1;A<l;A++)for(v[p][A]=h(f(s).map(function(I){return u[I][p]*u[I][A]})),d=0;d<s;d++)u[d][A]=u[d][A]-u[d][p]*v[p][A]}return[u,v]}return o}(),lstsq:function(){function h(o){o=e.copy(o);var u=o.length,s=e.identity(u);return e.arange(u-1,-1,-1).forEach(function(l){e.sliceAssign(s,{row:l},e.divide(e.slice(s,{row:l}),o[l][l])),e.sliceAssign(o,{row:l},e.divide(e.slice(o,{row:l}),o[l][l])),e.arange(l).forEach(function(v){var d=e.multiply(o[v][l],-1),p=e.slice(o,{row:v}),A=e.multiply(e.slice(o,{row:l}),d);e.sliceAssign(o,{row:v},e.add(p,A));var I=e.slice(s,{row:v}),E=e.multiply(e.slice(s,{row:l}),d);e.sliceAssign(s,{row:v},e.add(I,E))})}),s}function f(o,u){var s=!1;u[0].length===void 0&&(u=u.map(function(C){return[C]}),s=!0);var l=e.QR(o),v=l[0],d=l[1],p=o[0].length,A=e.slice(v,{col:{end:p}}),I=e.slice(d,{row:{end:p}}),E=h(I),N=e.transpose(A);N[0].length===void 0&&(N=[N]);var R=e.multiply(e.multiply(E,N),u);return R.length===void 0&&(R=[[R]]),s?R.map(function(C){return C[0]}):R}return f}(),jacobi:function(f){for(var o=1,u=f.length,s=e.identity(u,u),l=[],v,d,p,A,I,E,N,R;o===1;){for(E=f[0][1],A=0,I=1,d=0;d<u;d++)for(p=0;p<u;p++)d!=p&&E<i.abs(f[d][p])&&(E=i.abs(f[d][p]),A=d,I=p);for(f[A][A]===f[I][I]?N=f[A][I]>0?i.PI/4:-i.PI/4:N=i.atan(2*f[A][I]/(f[A][A]-f[I][I]))/2,R=e.identity(u,u),R[A][A]=i.cos(N),R[A][I]=-i.sin(N),R[I][A]=i.sin(N),R[I][I]=i.cos(N),s=e.multiply(s,R),v=e.multiply(e.multiply(e.inv(R),f),R),f=v,o=0,d=1;d<u;d++)for(p=1;p<u;p++)d!=p&&i.abs(f[d][p])>.001&&(o=1)}for(d=0;d<u;d++)l.push(f[d][d]);return[s,l]},rungekutta:function(f,o,u,s,l,v){var d,p,A,I,E;if(v===2)for(;s<=u;)d=o*f(s,l),p=o*f(s+o,l+d),A=l+(d+p)/2,l=A,s=s+o;if(v===4)for(;s<=u;)d=o*f(s,l),p=o*f(s+o/2,l+d/2),I=o*f(s+o/2,l+p/2),E=o*f(s+o,l+I),A=l+(d+2*p+2*I+E)/6,l=A,s=s+o;return l},romberg:function(f,o,u,s){for(var l=0,v=(u-o)/2,d=[],p=[],A=[],I,E,N,R,C;l<s/2;){for(C=f(o),N=o,R=0;N<=u;N=N+v,R++)d[R]=N;for(I=d.length,N=1;N<I-1;N++)C+=(N%2!==0?4:2)*f(d[N]);C=v/3*(C+f(u)),A[l]=C,v/=2,l++}for(E=A.length,I=1;E!==1;){for(N=0;N<E-1;N++)p[N]=(i.pow(4,I)*A[N+1]-A[N])/(i.pow(4,I)-1);E=p.length,A=p,p=[],I++}return A},richardson:function(f,o,u,s){function l(D,M){for(var F=0,Y=D.length,Q;F<Y;F++)D[F]===M&&(Q=F);return Q}for(var v=i.abs(u-f[l(f,u)+1]),d=0,p=[],A=[],I,E,N,R,C;s>=v;)I=l(f,u+s),E=l(f,u),p[d]=(o[I]-2*o[E]+o[2*E-I])/(s*s),s/=2,d++;for(R=p.length,N=1;R!=1;){for(C=0;C<R-1;C++)A[C]=(i.pow(4,N)*p[C+1]-p[C])/(i.pow(4,N)-1);R=A.length,p=A,A=[],N++}return p},simpson:function(f,o,u,s){for(var l=(u-o)/s,v=f(o),d=[],p=o,A=0,I=1,E;p<=u;p=p+l,A++)d[A]=p;for(E=d.length;I<E-1;I++)v+=(I%2!==0?4:2)*f(d[I]);return l/3*(v+f(u))},hermite:function(f,o,u,s){for(var l=f.length,v=0,d=0,p=[],A=[],I=[],E=[],N;d<l;d++){for(p[d]=1,N=0;N<l;N++)d!=N&&(p[d]*=(s-f[N])/(f[d]-f[N]));for(A[d]=0,N=0;N<l;N++)d!=N&&(A[d]+=1/(f[d]-f[N]));I[d]=(1-2*(s-f[d])*A[d])*(p[d]*p[d]),E[d]=(s-f[d])*(p[d]*p[d]),v+=I[d]*o[d]+E[d]*u[d]}return v},lagrange:function(f,o,u){for(var s=0,l=0,v,d,p=f.length;l<p;l++){for(d=o[l],v=0;v<p;v++)l!=v&&(d*=(u-f[v])/(f[l]-f[v]));s+=d}return s},cubic_spline:function(f,o,u){for(var s=f.length,l=0,v,d=[],p=[],A=[],I=[],E=[],N=[],R=[];l<s-1;l++)E[l]=f[l+1]-f[l];for(A[0]=0,l=1;l<s-1;l++)A[l]=3/E[l]*(o[l+1]-o[l])-3/E[l-1]*(o[l]-o[l-1]);for(l=1;l<s-1;l++)d[l]=[],p[l]=[],d[l][l-1]=E[l-1],d[l][l]=2*(E[l-1]+E[l]),d[l][l+1]=E[l],p[l][0]=A[l];for(I=e.multiply(e.inv(d),p),v=0;v<s-1;v++)N[v]=(o[v+1]-o[v])/E[v]-E[v]*(I[v+1][0]+2*I[v][0])/3,R[v]=(I[v+1][0]-I[v][0])/(3*E[v]);for(v=0;v<s&&!(f[v]>u);v++);return v-=1,o[v]+(u-f[v])*N[v]+e.sq(u-f[v])*I[v]+(u-f[v])*e.sq(u-f[v])*R[v]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var o=f.length,u=f[0].length,s=0,l,v,d=[],p=[],A=[],I=[],E=[],N=[],R=[],C=[],D=[],M=[];for(s=0;s<o;s++)d[s]=e.sum(f[s])/u;for(s=0;s<u;s++)for(R[s]=[],l=0;l<o;l++)R[s][l]=f[l][s]-d[l];for(R=e.transpose(R),s=0;s<o;s++)for(C[s]=[],l=0;l<o;l++)C[s][l]=e.dot([R[s]],[R[l]])/(u-1);for(A=e.jacobi(C),D=A[0],p=A[1],M=e.transpose(D),s=0;s<p.length;s++)for(l=s;l<p.length;l++)p[s]<p[l]&&(v=p[s],p[s]=p[l],p[l]=v,I=M[s],M[s]=M[l],M[l]=I);for(N=e.transpose(R),s=0;s<o;s++)for(E[s]=[],l=0;l<N.length;l++)E[s][l]=e.dot([M[s]],[N[l]]);return[f,p,M,E]}}),function(h){for(var f=0;f<h.length;f++)(function(o){e.fn[o]=function(u,s){var l=this;return s?(setTimeout(function(){s.call(l,e.fn[o].call(l,u))},15),this):typeof e[o](this,u)=="number"?e[o](this,u):e(e[o](this,u))}})(h[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,i){var c=[].slice,a=e.utils.isNumber,g=e.utils.isArray;e.extend({zscore:function(){var o=c.call(arguments);return a(o[1])?(o[0]-o[1])/o[2]:(o[0]-e.mean(o[1]))/e.stdev(o[1],o[2])},ztest:function(){var o=c.call(arguments),u;return g(o[1])?(u=e.zscore(o[0],o[1],o[3]),o[2]===1?e.normal.cdf(-i.abs(u),0,1):e.normal.cdf(-i.abs(u),0,1)*2):o.length>2?(u=e.zscore(o[0],o[1],o[2]),o[3]===1?e.normal.cdf(-i.abs(u),0,1):e.normal.cdf(-i.abs(u),0,1)*2):(u=o[0],o[1]===1?e.normal.cdf(-i.abs(u),0,1):e.normal.cdf(-i.abs(u),0,1)*2)}}),e.extend(e.fn,{zscore:function(o,u){return(o-this.mean())/this.stdev(u)},ztest:function(o,u,s){var l=i.abs(this.zscore(o,s));return u===1?e.normal.cdf(-l,0,1):e.normal.cdf(-l,0,1)*2}}),e.extend({tscore:function(){var o=c.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/i.sqrt(o[3])):(o[0]-e.mean(o[1]))/(e.stdev(o[1],!0)/i.sqrt(o[1].length))},ttest:function(){var o=c.call(arguments),u;return o.length===5?(u=i.abs(e.tscore(o[0],o[1],o[2],o[3])),o[4]===1?e.studentt.cdf(-u,o[3]-1):e.studentt.cdf(-u,o[3]-1)*2):a(o[1])?(u=i.abs(o[0]),o[2]==1?e.studentt.cdf(-u,o[1]-1):e.studentt.cdf(-u,o[1]-1)*2):(u=i.abs(e.tscore(o[0],o[1])),o[2]==1?e.studentt.cdf(-u,o[1].length-1):e.studentt.cdf(-u,o[1].length-1)*2)}}),e.extend(e.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(o,u){return u===1?1-e.studentt.cdf(i.abs(this.tscore(o)),this.cols()-1):e.studentt.cdf(-i.abs(this.tscore(o)),this.cols()-1)*2}}),e.extend({anovafscore:function(){var o=c.call(arguments),u,s,l,v,d,p,A,I;if(o.length===1){for(d=new Array(o[0].length),A=0;A<o[0].length;A++)d[A]=o[0][A];o=d}for(s=new Array,A=0;A<o.length;A++)s=s.concat(o[A]);for(l=e.mean(s),u=0,A=0;A<o.length;A++)u=u+o[A].length*i.pow(e.mean(o[A])-l,2);for(u/=o.length-1,p=0,A=0;A<o.length;A++)for(v=e.mean(o[A]),I=0;I<o[A].length;I++)p+=i.pow(o[A][I]-v,2);return p/=s.length-o.length,u/p},anovaftest:function(){var o=c.call(arguments),u,s,l,v;if(a(o[0]))return 1-e.centralF.cdf(o[0],o[1],o[2]);var d=e.anovafscore(o);for(u=o.length-1,l=0,v=0;v<o.length;v++)l=l+o[v].length;return s=l-u-1,1-e.centralF.cdf(d,u,s)},ftest:function(o,u,s){return 1-e.centralF.cdf(o,u,s)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var o=0,u;for(u=0;u<this.length;u++)o=o+this[u].length;return e.ftest(this.anovafscore(),this.length-1,o-this.length)}}),e.extend({qscore:function(){var o=c.call(arguments),u,s,l,v,d;return a(o[0])?(u=o[0],s=o[1],l=o[2],v=o[3],d=o[4]):(u=e.mean(o[0]),s=e.mean(o[1]),l=o[0].length,v=o[1].length,d=o[2]),i.abs(u-s)/(d*i.sqrt((1/l+1/v)/2))},qtest:function(){var o=c.call(arguments),u;o.length===3?(u=o[0],o=o.slice(1)):o.length===7?(u=e.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(u=e.qscore(o[0],o[1],o[2]),o=o.slice(3));var s=o[0],l=o[1];return 1-e.tukey.cdf(u,l,s-l)},tukeyhsd:function(o){for(var u=e.pooledstdev(o),s=o.map(function(I){return e.mean(I)}),l=o.reduce(function(I,E){return I+E.length},0),v=[],d=0;d<o.length;++d)for(var p=d+1;p<o.length;++p){var A=e.qtest(s[d],s[p],o[d].length,o[p].length,u,l,o.length);v.push([[d,p],A])}return v}}),e.extend({normalci:function(){var o=c.call(arguments),u=new Array(2),s;return o.length===4?s=i.abs(e.normal.inv(o[1]/2,0,1)*o[2]/i.sqrt(o[3])):s=i.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/i.sqrt(o[2].length)),u[0]=o[0]-s,u[1]=o[0]+s,u},tci:function(){var o=c.call(arguments),u=new Array(2),s;return o.length===4?s=i.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/i.sqrt(o[3])):s=i.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/i.sqrt(o[2].length)),u[0]=o[0]-s,u[1]=o[0]+s,u},significant:function(o,u){return o<u}}),e.extend(e.fn,{normalci:function(o,u){return e.normalci(o,u,this.toArray())},tci:function(o,u){return e.tci(o,u,this.toArray())}});function h(f,o,u,s){if(f>1||u>1||f<=0||u<=0)throw new Error("Proportions should be greater than 0 and less than 1");var l=(f*o+u*s)/(o+s),v=i.sqrt(l*(1-l)*(1/o+1/s));return(f-u)/v}e.extend(e.fn,{oneSidedDifferenceOfProportions:function(o,u,s,l){var v=h(o,u,s,l);return e.ztest(v,1)},twoSidedDifferenceOfProportions:function(o,u,s,l){var v=h(o,u,s,l);return e.ztest(v,2)}})}(t,Math),t.models=function(){function e(h){var f=h[0].length,o=t.arange(f).map(function(u){var s=t.arange(f).filter(function(l){return l!==u});return i(t.col(h,u).map(function(l){return l[0]}),t.col(h,s))});return o}function i(h,f){var o=h.length,u=f[0].length-1,s=o-u-1,l=t.lstsq(f,h),v=t.multiply(f,l.map(function(R){return[R]})).map(function(R){return R[0]}),d=t.subtract(h,v),p=t.mean(h),A=t.sum(v.map(function(R){return Math.pow(R-p,2)})),I=t.sum(h.map(function(R,C){return Math.pow(R-v[C],2)})),E=A+I,N=A/E;return{exog:f,endog:h,nobs:o,df_model:u,df_resid:s,coef:l,predict:v,resid:d,ybar:p,SST:E,SSE:A,SSR:I,R2:N}}function c(h){var f=e(h.exog),o=Math.sqrt(h.SSR/h.df_resid),u=f.map(function(p){var A=p.SST,I=p.R2;return o/Math.sqrt(A*(1-I))}),s=h.coef.map(function(p,A){return(p-0)/u[A]}),l=s.map(function(p){var A=t.studentt.cdf(p,h.df_resid);return(A>.5?1-A:A)*2}),v=t.studentt.inv(.975,h.df_resid),d=h.coef.map(function(p,A){var I=v*u[A];return[p-I,p+I]});return{se:u,t:s,p:l,sigmaHat:o,interval95:d}}function a(h){var f=h.R2/h.df_model/((1-h.R2)/h.df_resid),o=function(s,l,v){return t.beta.cdf(s/(v/l+s),l/2,v/2)},u=1-o(f,h.df_model,h.df_resid);return{F_statistic:f,pvalue:u}}function g(h,f){var o=i(h,f),u=c(o),s=a(o),l=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=u,o.f=s,o.adjust_R2=l,o}return{ols:g}}(),t.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),c=0;c<arguments.length;c++){var a=[1];i[c]=a.concat(arguments[c])}return t(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),c=0;c<arguments[0].length;c++){var a=[1];i[c]=a.concat(arguments[0][c])}return t(i)},buildjxmatrix:function(i){for(var c=new Array(i.length),a=0;a<i.length;a++)c[a]=i[a];return t.builddxmatrix(c)},buildymatrix:function(i){return t(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,c){var a,g,h,f,o;if(i.cols()==c.rows()){if(c.rows()>1){for(f=[],a=0;a<i.rows();a++)for(f[a]=[],g=0;g<c.cols();g++){for(o=0,h=0;h<i.cols();h++)o+=i.toArray()[a][h]*c.toArray()[h][g];f[a][g]=o}return t(f)}for(f=[],a=0;a<i.rows();a++)for(f[a]=[],g=0;g<c.cols();g++){for(o=0,h=0;h<i.cols();h++)o+=i.toArray()[a][h]*c.toArray()[g];f[a][g]=o}return t(f)}},regress:function(i,c){var a=t.xtranspxinv(i),g=i.transpose(),h=t.matrixmult(t(a),g);return t.matrixmult(h,c)},regresst:function(i,c,a){var g=t.regress(i,c),h={};h.anova={};var f=t.jMatYBar(i,g);h.yBar=f;var o=c.mean();h.anova.residuals=t.residuals(c,f),h.anova.ssr=t.ssr(f,o),h.anova.msr=h.anova.ssr/(i[0].length-1),h.anova.sse=t.sse(c,f),h.anova.mse=h.anova.sse/(c.length-(i[0].length-1)-1),h.anova.sst=t.sst(c,o),h.anova.mst=h.anova.sst/(c.length-1),h.anova.r2=1-h.anova.sse/h.anova.sst,h.anova.r2<0&&(h.anova.r2=0),h.anova.fratio=h.anova.msr/h.anova.mse,h.anova.pvalue=t.anovaftest(h.anova.fratio,i[0].length-1,c.length-(i[0].length-1)-1),h.anova.rmse=Math.sqrt(h.anova.mse),h.anova.r2adj=1-h.anova.mse/h.anova.mst,h.anova.r2adj<0&&(h.anova.r2adj=0),h.stats=new Array(i[0].length);for(var u=t.xtranspxinv(i),s,l,v,d=0;d<g.length;d++)s=Math.sqrt(h.anova.mse*Math.abs(u[d][d])),l=Math.abs(g[d]/s),v=t.ttest(l,c.length-i[0].length-1,a),h.stats[d]=[g[d],s,l,v];return h.regress=g,h},xtranspx:function(i){return t.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var c=t.matrixmult(i.transpose(),i),a=t.inv(c);return a},jMatYBar:function(i,c){var a=t.matrixmult(i,c);return new t(a)},residuals:function(i,c){return t.matrixsubtract(i,c)},ssr:function(i,c){for(var a=0,g=0;g<i.length;g++)a+=Math.pow(i[g]-c,2);return a},sse:function(i,c){for(var a=0,g=0;g<i.length;g++)a+=Math.pow(i[g]-c[g],2);return a},sst:function(i,c){for(var a=0,g=0;g<i.length;g++)a+=Math.pow(i[g]-c,2);return a},matrixsubtract:function(i,c){for(var a=new Array(i.length),g=0;g<i.length;g++){a[g]=new Array(i[g].length);for(var h=0;h<i[g].length;h++)a[g][h]=i[g][h]-c[g][h]}return t(a)}}),t.jStat=t,t})}(Wr)),Wr.exports}var Wo=zo();const S=br(Wo);var he={},gt;function Xo(){return gt||(gt=1,function(n){(function(r){r(typeof DO_NOT_EXPORT_BESSEL>"u"?n:{})})(function(r){r.version="1.0.2";var t=Math;function e(o,u){for(var s=0,l=0;s<o.length;++s)l=u*l+o[s];return l}function i(o,u,s,l,v){if(u===0)return s;if(u===1)return l;for(var d=2/o,p=l,A=1;A<u;++A)p=l*A*d+v*s,s=l,l=p;return p}function c(o,u,s,l,v){return function(p,A){if(l){if(p===0)return l==1?-1/0:1/0;if(p<0)return NaN}if(A===0)return o(p);if(A===1)return u(p);if(A<0)return NaN;A|=0;var I=o(p),E=u(p);return i(p,A,I,E,v)}}var a=function(){var o=.636619772,u=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function d(R){var C=0,D=0,M=0,F=R*R;if(R<8)D=e(u,F),M=e(s,F),C=D/M;else{var Y=R-.785398164;F=64/F,D=e(l,F),M=e(v,F),C=t.sqrt(o/R)*(t.cos(Y)*D-t.sin(Y)*M*8/R)}return C}var p=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),A=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),I=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(R){var C=0,D=0,M=0,F=R*R,Y=t.abs(R)-2.356194491;return Math.abs(R)<8?(D=R*e(p,F),M=e(A,F),C=D/M):(F=64/F,D=e(I,F),M=e(E,F),C=t.sqrt(o/t.abs(R))*(t.cos(Y)*D-t.sin(Y)*M*8/t.abs(R)),R<0&&(C=-C)),C}return function R(C,D){if(D=Math.round(D),!isFinite(C))return isNaN(C)?C:0;if(D<0)return(D%2?-1:1)*R(C,-D);if(C<0)return(D%2?-1:1)*R(-C,D);if(D===0)return d(C);if(D===1)return N(C);if(C===0)return 0;var M=0;if(C>D)M=i(C,D,d(C),N(C),-1);else{for(var F=2*t.floor((D+t.floor(t.sqrt(40*D)))/2),Y=!1,Q=0,j=0,rn=1,hn=0,In=2/C,Mn=F;Mn>0;Mn--)hn=Mn*In*rn-Q,Q=rn,rn=hn,t.abs(rn)>1e10&&(rn*=1e-10,Q*=1e-10,M*=1e-10,j*=1e-10),Y&&(j+=rn),Y=!Y,Mn==D&&(M=Q);j=2*j-rn,M/=j}return M}}(),g=function(){var o=.636619772,u=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),s=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function d(R){var C=0,D=0,M=0,F=R*R,Y=R-.785398164;return R<8?(D=e(u,F),M=e(s,F),C=D/M+o*a(R,0)*t.log(R)):(F=64/F,D=e(l,F),M=e(v,F),C=t.sqrt(o/R)*(t.sin(Y)*D+t.cos(Y)*M*8/R)),C}var p=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),A=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),I=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(R){var C=0,D=0,M=0,F=R*R,Y=R-2.356194491;return R<8?(D=R*e(p,F),M=e(A,F),C=D/M+o*(a(R,1)*t.log(R)-1/R)):(F=64/F,D=e(I,F),M=e(E,F),C=t.sqrt(o/R)*(t.sin(Y)*D+t.cos(Y)*M*8/R)),C}return c(d,N,"BESSELY",1,-1)}(),h=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),u=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function s(p){return p<=3.75?e(o,p*p/(3.75*3.75)):t.exp(t.abs(p))/t.sqrt(t.abs(p))*e(u,3.75/t.abs(p))}var l=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function d(p){return p<3.75?p*e(l,p*p/(3.75*3.75)):(p<0?-1:1)*t.exp(t.abs(p))/t.sqrt(t.abs(p))*e(v,3.75/t.abs(p))}return function p(A,I){if(I=Math.round(I),I===0)return s(A);if(I===1)return d(A);if(I<0)return NaN;if(t.abs(A)===0)return 0;if(A==1/0)return 1/0;var E=0,N,R=2/t.abs(A),C=0,D=1,M=0,F=2*t.round((I+t.round(t.sqrt(40*I)))/2);for(N=F;N>0;N--)M=N*R*D+C,C=D,D=M,t.abs(D)>1e10&&(D*=1e-10,C*=1e-10,E*=1e-10),N==I&&(E=C);return E*=p(A,0)/D,A<0&&I%2?-E:E}}(),f=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),u=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function s(p){return p<=2?-t.log(p/2)*h(p,0)+e(o,p*p/4):t.exp(-p)/t.sqrt(p)*e(u,2/p)}var l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),v=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function d(p){return p<=2?t.log(p/2)*h(p,1)+1/p*e(l,p*p/4):t.exp(-p)/t.sqrt(p)*e(v,2/p)}return c(s,d,"BESSELK",2,1)}();r.besselj=a,r.bessely=g,r.besseli=h,r.besselk=f})}(he)),he}var Ko=Xo();const _r=br(Ko),We=new Error("#NULL!"),kn=new Error("#DIV/0!"),O=new Error("#VALUE!"),Tr=new Error("#REF!"),jr=new Error("#NAME?"),G=new Error("#NUM!"),nn=new Error("#N/A"),Xe=new Error("#ERROR!"),zt=new Error("#GETTING_DATA");var Zo=Object.freeze({__proto__:null,data:zt,div0:kn,error:Xe,na:nn,name:jr,nil:We,num:G,ref:Tr,value:O});let ur=!1;function Qo(){ur=!0}function Jo(){ur=!1}function Wt(n){n<60&&(n+=1);const t=Math.floor(n-25569)*86400,e=new Date(t*1e3),i=n-Math.floor(n)+1e-7;let c=Math.floor(86400*i);const a=c%60;c-=a;const g=Math.floor(c/(60*60)),h=Math.floor(c/60)%60;let f=e.getUTCDate(),o=e.getUTCMonth();return n>=60&&n<61&&(f=29,o=1),new Date(e.getUTCFullYear(),o,f,g,h,a)}function or(n){const r=new Date(1900,0,1),t=n>-22038912e5?2:1;return Math.ceil((n-r)/864e5)+t}var So=Object.freeze({__proto__:null,dateToSerial:or,get returnSerial(){return ur},serialToDate:Wt,useDate:Jo,useSerial:Qo});const xo="=",bo=[">",">=","<","<=","=","<>"],Xt="operator",Kt="literal",_o=[Xt,Kt],Xr=Xt,ar=Kt;function er(n,r){if(_o.indexOf(r)===-1)throw new Error("Unsupported token type: "+r);return{value:n,type:r}}function jo(n){return typeof n!="string"||/^\d+(\.\d+)?$/.test(n)&&(n=n.indexOf(".")===-1?parseInt(n,10):parseFloat(n)),n}function ni(n){const r=n.length,t=[];let e=0,i="",c="";for(;e<r;){const a=n.charAt(e);switch(a){case">":case"<":case"=":c=c+a,i.length>0&&(t.push(i),i="");break;default:c.length>0&&(t.push(c),c=""),i=i+a;break}e++}return i.length>0&&t.push(i),c.length>0&&t.push(c),t}function ri(n){let r="";const t=[];for(let e=0;e<n.length;e++){const i=n[e];e===0&&bo.indexOf(i)>=0?t.push(er(i,Xr)):r+=i}return r.length>0&&t.push(er(jo(r),ar)),t.length>0&&t[0].type!==Xr&&t.unshift(er(xo,Xr)),t}function ei(n){const r=[];let t;for(let e=0;e<n.length;e++){const i=n[e];switch(i.type){case Xr:t=i.value;break;case ar:r.push(i.value);break}}return ti(r,t)}function ti(n,r){let t=!1;switch(r){case">":t=n[0]>n[1];break;case">=":t=n[0]>=n[1];break;case"<":t=n[0]<n[1];break;case"<=":t=n[0]<=n[1];break;case"=":t=n[0]==n[1];break;case"<>":t=n[0]!=n[1];break}return t}function Rr(n){return ri(ni(n))}const Mr=ei;function ne(n){const r=[];return Gn(n,t=>{r.push(t)}),r}function Gn(n,r){let t=-1;const e=n.length;for(;++t<e&&r(n[t],t,n)!==!1;);return n}function Ke(n){let r=n.length,t;for(;r--;)if(t=n[r],typeof t!="number"){if(t===!0){n[r]=1;continue}if(t===!1){n[r]=0;continue}if(typeof t=="string"){const e=T(t);n[r]=e instanceof Error?0:e}}return n}function Zt(n,r){if(!n)return O;(!n.every(i=>Array.isArray(i))||n.length===0)&&(n=[[...n]]),n.map((i,c)=>{i.map((a,g)=>{a||(n[c][g]=0)})});const t=n.reduce((i,c,a)=>c.length>n[i].length?a:i,0),e=n[t].length;return n.map(i=>[...i,...Array(e-i.length).fill(0)])}function W(){let n;if(arguments.length===1){const r=arguments[0];n=ii(r)?ne.apply(null,arguments):[r]}else n=Array.from(arguments);for(;!ui(n);)n=Ye(n);return n}function Ye(n){return!n||!n.reduce?[n]:n.reduce((r,t)=>{const e=Array.isArray(r),i=Array.isArray(t);return e&&i?r.concat(t):e?(r.push(t),r):i?[r].concat(t):[r,t]})}function oi(n,r){return r=r||1,!n||typeof n.slice!="function"?n:n.slice(0,n.length-r)}function ii(n){return n!=null&&typeof n.length=="number"&&typeof n!="string"}function ui(n){if(!n)return!1;for(let r=0;r<n.length;++r)if(Array.isArray(n[r]))return!1;return!0}function Rn(n,r){return r=r||1,!n||typeof n.slice!="function"?n:n.slice(r)}function Kr(n){return n?n[0].map((r,t)=>n.map(e=>e[t])):O}function Sn(n,r){let t=null;return Gn(n,(e,i)=>{if(e[0]===r)return t=i,!1}),t??O}function ln(){for(let n=0;n<arguments.length;n++)if(arguments[n]instanceof Error)return arguments[n]}function z(){let n=arguments.length;for(;n--;)if(arguments[n]instanceof Error)return!0;return!1}function Qt(n){return Math.round(n*1e14)/1e14}function fr(){return W.apply(null,arguments).filter(r=>typeof r=="number")}function Ze(n){if(typeof n=="boolean"||n instanceof Error)return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){const r=n.toUpperCase();if(r==="TRUE")return!0;if(r==="FALSE")return!1}return n instanceof Date&&!isNaN(n)?!0:O}function gn(n){if(!isNaN(n)){if(n instanceof Date)return new Date(n);const r=parseFloat(n);return r<0||r>=2958466?G:Wt(r)}return typeof n=="string"&&(n=/(\d{4})-(\d\d?)-(\d\d?)$/.test(n)?new Date(n+"T00:00:00.000"):new Date(n),!isNaN(n))?n:O}function Jt(n){let r=n.length,t;for(;r--;){if(t=gn(n[r]),t===O)return t;n[r]=t}return n}function T(n){return n instanceof Error?n:n==null?0:(typeof n=="boolean"&&(n=+n),!isNaN(n)&&n!==""?parseFloat(n):O)}function x(n){let r;if(!n||(r=n.length)===0)return O;let t;for(;r--;){if(n[r]instanceof Error)return n[r];if(t=T(n[r]),t instanceof Error)return t;n[r]=t}return n}function On(n){return n instanceof Error?n:n==null?"":n.toString()}function re(){let n=arguments.length;for(;n--;)if(typeof arguments[n]=="string")return!0;return!1}function ee(){const n=ne(arguments),r=x(W(n.shift()));if(r instanceof Error)return r;const t=n,e=t.length/2;for(let c=0;c<e;c++)t[c*2]=W(t[c*2]);let i=[];for(let c=0;c<r.length;c++){let a=!1;for(let g=0;g<e;g++){const h=t[g*2][c],f=t[g*2+1],o=f===void 0||f==="*";let u=!1;if(o)u=!0;else{const s=Rr(f+""),l=[er(h,ar)].concat(s);u=Mr(l)}if(!u){a=!1;break}a=!0}a&&i.push(r[c])}return i}function wr(n){return n!=null}const St={};St.TYPE=n=>{switch(n){case We:return 1;case kn:return 2;case O:return 3;case Tr:return 4;case jr:return 5;case G:return 6;case nn:return 7;case zt:return 8}return nn};function fi(n){return n===null}function xt(n){return[O,Tr,kn,G,jr,We].indexOf(n)>=0||typeof n=="number"&&(isNaN(n)||!isFinite(n))}function te(n){return xt(n)||n===nn}function si(n){return!(Math.floor(Math.abs(n))&1)}function bt(n){return n===!0||n===!1}function li(n){return n===nn}function ci(n){return typeof n!="string"}function oe(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function ai(n){return!!(Math.floor(Math.abs(n))&1)}function _t(n){return typeof n=="string"}function hi(n){return oe(n)?n:n instanceof Date?n.getTime():n===!0?1:n===!1?0:te(n)?n:0}function gi(){return nn}function vi(n){if(oe(n))return 1;if(_t(n))return 2;if(bt(n))return 4;if(te(n))return 16;if(Array.isArray(n))return 64}function di(){if(arguments.length<2)return nn;const n=arguments[0];return n<1||n>254||arguments.length<n+1?O:arguments[n]}function pi(n,r){if(arguments.length!==2)return nn;if(r<0)return G;if(!(n instanceof Array)||typeof r!="number")return O;if(n.length!==0)return S.col(n,r)}function Ei(n){return arguments.length!==1?nn:n instanceof Array?n.length===0?0:S.cols(n):O}function wi(n,r,t,e){return jt(n,Kr(r),t,e)}function Ai(n,r,t){const e=ln(n,r,t);if(e)return e;if(!Array.isArray(n))return O;const i=n.length>0&&!Array.isArray(n[0]);return i&&!t?(t=r,r=1):(t=t||1,r=r||1),t<0||r<0?O:i&&r===1&&t<=n.length?n[t-1]:r<=n.length&&t<=n[r-1].length?n[r-1][t-1]:Tr}function Ni(n,r,t){r=W(r),t=t?W(t):r;const e=typeof n=="number";let i=nn;for(let c=0;c<r.length;c++){if(r[c]===n)return t[c];if(e&&r[c]<=n||typeof r[c]=="string"&&r[c].localeCompare(n)<0)i=t[c];else if(e&&r[c]>n)return i}return i}function Ii(n,r,t){if(!n&&n!==0||!r||(arguments.length===2&&(t=1),r=W(r),!(r instanceof Array))||t!==-1&&t!==0&&t!==1)return nn;let e,i;for(let c=0;c<r.length;c++)if(t===1){if(r[c]===n)return c+1;r[c]<n&&(i?r[c]>i&&(e=c+1,i=r[c]):(e=c+1,i=r[c]))}else if(t===0){if(typeof n=="string"&&typeof r[c]=="string"){const a=n.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]");if(new RegExp("^"+a+"$").test(r[c].toLowerCase()))return c+1}else if(r[c]===n)return c+1}else if(t===-1){if(r[c]===n)return c+1;r[c]>n&&(i?r[c]<i&&(e=c+1,i=r[c]):(e=c+1,i=r[c]))}return e||nn}function Ti(n){return arguments.length!==1?nn:n instanceof Array?n.length===0?0:S.rows(n):O}function Ri(n,r=1,t=1,e=!1){if(!n||!Array.isArray(n))return nn;if(n.length===0)return 0;if(r=T(r),!r||r<1||(t=T(t),t!==1&&t!==-1))return O;if(e=Ze(e),typeof e!="boolean")return jr;const i=g=>g.sort((h,f)=>(h=On(h[r-1]),f=On(f[r-1]),t===1?h<f?t*-1:t:h>f?t:t*-1)),c=Zt(n),a=e?Kr(c):c;return r>=1&&r<=a[0].length?e?Kr(i(a)):i(a):O}function Mi(n){if(!n)return nn;const r=Zt(n);return Kr(r)}function Qe(){const n=[];for(let r=0;r<arguments.length;++r){let t=!1;const e=arguments[r];for(let i=0;i<n.length&&(t=n[i]===e,!t);++i);t||n.push(e)}return n}function jt(n,r,t,e){if(!r||!t)return nn;e=!(e===0||e===!1);let i=nn,c=!1;const a=typeof n=="number",g=typeof n=="string"?n.toLowerCase():n;for(let h=0;h<r.length;h++){const f=r[h],o=typeof f[0]=="string"?f[0].toLowerCase():f[0];if(o===g){i=t<f.length+1?f[t-1]:Tr;break}else!c&&(a&&e&&o<=n||e&&typeof o=="string"&&o.localeCompare(n)<0)&&(i=t<f.length+1?f[t-1]:Tr);a&&o>n&&(c=!0)}return i}function no(n){return n=T(n),n===0?O:n instanceof Error?n:String.fromCharCode(n)}function mi(n){if(z(n))return n;n=n||"";const r=/[\0-\x1F]/g;return n.replace(r,"")}function ro(n){if(z(n))return n;n=n||"";let r=n.charCodeAt(0);return isNaN(r)&&(r=O),r}function eo(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;let t=0;for(;(t=n.indexOf(!0))>-1;)n[t]="TRUE";let e=0;for(;(e=n.indexOf(!1))>-1;)n[e]="FALSE";return n.join("")}const Ci=eo;function Oi(n,r=2){if(n=T(n),isNaN(n))return O;n=vo(n,r);const t={style:"currency",currency:"USD",minimumFractionDigits:r>=0?r:0,maximumFractionDigits:r>=0?r:0},e=n.toLocaleString("en-US",t);return n<0?"$("+e.slice(2)+")":e}function Di(n,r){if(arguments.length!==2)return nn;const t=ln(n,r);return t||(n=On(n),r=On(r),n===r)}function yi(n,r,t){if(arguments.length<2)return nn;n=On(n),r=On(r),t=t===void 0?0:t;const e=r.indexOf(n,t-1);return e===-1?O:e+1}function to(n,r=2,t=!1){if(n=T(n),isNaN(n)||(r=T(r),isNaN(r)))return O;if(r<0){const e=Math.pow(10,-r);n=Math.round(n/e)*e}else n=n.toFixed(r);if(t)n=n.toString().replace(/,/g,"");else{const e=n.toString().split(".");e[0]=e[0].replace(/\B(?=(\d{3})+$)/g,","),n=e.join(".")}return n}function Li(n,r){const t=ln(n,r);return t||(n=On(n),r=r===void 0?1:r,r=T(r),r instanceof Error||typeof n!="string"?O:n.substring(0,r))}function Pi(n){return arguments.length===0?Xe:n instanceof Error?n:Array.isArray(n)?O:On(n).length}function Fi(n){return arguments.length!==1?O:(n=On(n),z(n)?n:n.toLowerCase())}function qi(n,r,t){if(r==null)return O;if(r=T(r),t=T(t),z(r,t)||typeof n!="string")return t;const e=r-1,i=e+t;return n.substring(e,i)}function Vi(n,r,t){return n=wr(n)?n:"",typeof n=="number"?n:typeof n!="string"?nn:(r=typeof r>"u"?".":r,t=typeof t>"u"?",":t,Number(n.replace(r,".").replace(t,"")))}function Ui(n){return z(n)?n:isNaN(n)&&typeof n=="number"?O:(n=On(n),n.replace(/\w\S*/g,r=>r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()))}function $i(n,r,t,e){return r=T(r),t=T(t),z(r,t)||typeof n!="string"||typeof e!="string"?O:n.substr(0,r-1)+e+n.substr(r-1+t)}function Zn(n,r){const t=ln(n,r);return t||(n=On(n),r=T(r),r instanceof Error?r:new Array(r+1).join(n))}function ki(n,r){const t=ln(n,r);return t||(n=On(n),r=r===void 0?1:r,r=T(r),r instanceof Error?r:n.substring(n.length-r))}function Gi(n,r,t){let e;return typeof n!="string"||typeof r!="string"?O:(t=t===void 0?0:t,e=r.toLowerCase().indexOf(n.toLowerCase(),t-1)+1,e===0?O:e)}function Hi(n,r,t,e){if(arguments.length<3)return nn;if(!n||!r)return n;if(e===void 0)return n.split(r).join(t);{if(e=Math.floor(Number(e)),Number.isNaN(e)||e<=0)return O;let i=0,c=0;for(;i>-1&&n.indexOf(r,i)>-1;)if(i=n.indexOf(r,i+1),c++,i>-1&&c===e)return n.substring(0,i)+t+n.substring(i+r.length);return n}}function zn(n){return n instanceof Error||typeof n=="string"?n:""}function Yi(n,r){if(n===void 0||n instanceof Error||r instanceof Error)return nn;if(n instanceof Date)return n.toISOString().slice(0,10);if(r==null)return"";if(typeof r=="number")return String(r);if(typeof r!="string")return O;const t=r.startsWith("$")?"$":"",e=r.endsWith("%");r=r.replace(/%/g,"").replace(/\$/g,"");const i=r.includes(".")?r.split(".")[1].match(/0/g).length:0,c=!r.includes(",");return e&&(n=n*100),n=to(n,i,c),n.startsWith("-")?(n=n.replace("-",""),n="-"+t+n):n=t+n,e&&(n=n+"%"),n}function Bi(n,r,...t){if(typeof r!="boolean"&&(r=Ze(r)),arguments.length<3)return nn;n=n??"";let e=W(t),i=r?e.filter(c=>c):e;if(Array.isArray(n)){n=W(n);let c=i.map(g=>[g]),a=0;for(let g=0;g<c.length-1;g++)c[g].push(n[a]),a++,a===n.length&&(a=0);return i=W(c),i.join("")}return i.join(n)}function zi(n){return n=On(n),n instanceof Error?n:n.replace(/\s+/g," ").trim()}const Wi=no,Xi=ro;function Ki(n){return n=On(n),n instanceof Error?n:n.toUpperCase()}function Zi(n){const r=ln(n);if(r)return r;if(typeof n=="number")return n;if(wr(n)||(n=""),typeof n!="string")return O;const t=/(%)$/.test(n)||/^(%)/.test(n);if(n=n.replace(/^[^0-9-]{0,3}/,""),n=n.replace(/[^0-9]{0,3}$/,""),n=n.replace(/[ ,]/g,""),n==="")return 0;let e=Number(n);return isNaN(e)?O:(e=e||0,t&&(e=e*.01),e)}const Qi=2.5066282746310002;function Ji(){const r=W(arguments).filter(wr);if(r.length===0)return G;const t=x(r);return t instanceof Error?t:S.sum(S(t).subtract(S.mean(t)).abs()[0])/t.length}function gr(){const r=W(arguments).filter(wr);if(r.length===0)return kn;const t=ln.apply(void 0,r);if(t)return t;const e=fr(r),i=e.length;let c=0,a=0,g;for(let h=0;h<i;h++)c+=e[h],a+=1;return g=c/a,isNaN(g)&&(g=G),g}function Je(){const r=W(arguments).filter(wr);if(r.length===0)return kn;const t=ln.apply(void 0,r);if(t)return t;const e=r,i=e.length;let c=0,a=0,g;for(let h=0;h<i;h++){const f=e[h];typeof f=="number"&&(c+=f),f===!0&&c++,f!==null&&a++}return g=c/a,isNaN(g)&&(g=G),g}function Si(n,r,t){if(arguments.length<=1)return nn;t=t||n;const i=W(t).filter(wr);if(t=x(i),n=W(n),t instanceof Error)return t;let c=0,a=0;const g=r===void 0||r==="*",h=g?null:Rr(r+"");for(let f=0;f<n.length;f++){const o=n[f];if(g)a+=t[f],c++;else{const u=[er(o,ar)].concat(h);Mr(u)&&(a+=t[f],c++)}}return a/c}function xi(){const n=ee(...arguments),t=n.reduce((e,i)=>e+i,0)/n.length;return isNaN(t)?0:t}const qr={};qr.DIST=function(n,r,t,e,i,c){return arguments.length<4||(i=i===void 0?0:i,c=c===void 0?1:c,n=T(n),r=T(r),t=T(t),i=T(i),c=T(c),z(n,r,t,i,c))?O:(n=(n-i)/(c-i),e?S.beta.cdf(n,r,t):S.beta.pdf(n,r,t))};qr.INV=(n,r,t,e,i)=>(e=e===void 0?0:e,i=i===void 0?1:i,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i)?O:S.beta.inv(n,r,t)*(i-e)+e);const mr={};mr.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),e=T(e),z(n,r,t,e)?O:e?S.binomial.cdf(n,r,t):S.binomial.pdf(n,r,t));mr.DIST.RANGE=(n,r,t,e)=>{if(e=e===void 0?t:e,n=T(n),r=T(r),t=T(t),e=T(e),z(n,r,t,e))return O;let i=0;for(let c=t;c<=e;c++)i+=Ir(n,c)*Math.pow(r,c)*Math.pow(1-r,n-c);return i};mr.INV=(n,r,t)=>{if(n=T(n),r=T(r),t=T(t),z(n,r,t))return O;let e=0;for(;e<=n;){if(S.binomial.cdf(e,n,r)>=t)return e;e++}};const _n={};_n.DIST=(n,r,t)=>(n=T(n),r=T(r),z(n,r)?O:t?S.chisquare.cdf(n,r):S.chisquare.pdf(n,r));_n.DIST.RT=(n,r)=>!n|!r?nn:n<1||r>Math.pow(10,10)?G:typeof n!="number"||typeof r!="number"?O:1-S.chisquare.cdf(n,r);_n.INV=(n,r)=>(n=T(n),r=T(r),z(n,r)?O:S.chisquare.inv(n,r));_n.INV.RT=(n,r)=>!n|!r?nn:n<0||n>1||r<1||r>Math.pow(10,10)?G:typeof n!="number"||typeof r!="number"?O:S.chisquare.inv(1-n,r);_n.TEST=function(n,r){if(arguments.length!==2)return nn;if(!(n instanceof Array)||!(r instanceof Array)||n.length!==r.length||n[0]&&r[0]&&n[0].length!==r[0].length)return O;const t=n.length;let e,i,c;for(i=0;i<t;i++)n[i]instanceof Array||(e=n[i],n[i]=[],n[i].push(e)),r[i]instanceof Array||(e=r[i],r[i]=[],r[i].push(e));const a=n[0].length,g=a===1?t-1:(t-1)*(a-1);let h=0;const f=Math.PI;for(i=0;i<t;i++)for(c=0;c<a;c++)h+=Math.pow(n[i][c]-r[i][c],2)/r[i][c];function o(u,s){let l=Math.exp(-.5*u);s%2===1&&(l=l*Math.sqrt(2*u/f));let v=s;for(;v>=2;)l=l*u/v,v=v-2;let d=l,p=s;for(;d>1e-10*l;)p=p+2,d=d*u/p,l=l+d;return 1-l}return Math.round(o(h,g)*1e6)/1e6};const Se={};Se.NORM=(n,r,t)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:S.normalci(1,n,r,t)[1]-1);Se.T=(n,r,t)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:S.tci(1,n,r,t)[1]-1);function bi(n,r){return n=x(W(n)),r=x(W(r)),z(n,r)?O:S.corrcoeff(n,r)}function Pr(){const n=W(arguments);return fr(n).length}function Fr(){const n=W(arguments);return n.length-oo(n)}function oo(){const n=W(arguments);let r=0,t;for(let e=0;e<n.length;e++)t=n[e],(t==null||t==="")&&r++;return r}function _i(n,r){if(n=W(n),r===void 0||r==="*")return n.length;let e=0;const i=Rr(r+"");for(let c=0;c<n.length;c++){const a=n[c],g=[er(a,ar)].concat(i);Mr(g)&&e++}return e}function ji(){const n=ne(arguments),r=new Array(W(n[0]).length);for(let e=0;e<r.length;e++)r[e]=!0;for(let e=0;e<n.length;e+=2){const i=W(n[e]),c=n[e+1];if(!(c===void 0||c==="*")){const g=Rr(c+"");for(let h=0;h<i.length;h++){const f=i[h],o=[er(f,ar)].concat(g);r[h]=r[h]&&Mr(o)}}}let t=0;for(let e=0;e<r.length;e++)r[e]&&t++;return t}const Cr={};Cr.P=(n,r)=>{if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=S.mean(n),e=S.mean(r);let i=0;const c=n.length;for(let a=0;a<c;a++)i+=(n[a]-t)*(r[a]-e);return i/c};Cr.S=(n,r)=>(n=x(W(n)),r=x(W(r)),z(n,r)?O:S.covariance(n,r));function nu(){const n=x(W(arguments));if(n instanceof Error)return n;const r=S.mean(n);let t=0;for(let e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t}const xe={};xe.DIST=(n,r,t)=>(n=T(n),r=T(r),z(n,r)?O:t?S.exponential.cdf(n,r):S.exponential.pdf(n,r));const jn={};jn.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:e?S.centralF.cdf(n,r,t):S.centralF.pdf(n,r,t));jn.DIST.RT=function(n,r,t){return arguments.length!==3?nn:n<0||r<1||t<1?G:typeof n!="number"||typeof r!="number"||typeof t!="number"?O:1-S.centralF.cdf(n,r,t)};jn.INV=(n,r,t)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:n<=0||n>1?G:S.centralF.inv(n,r,t));jn.INV.RT=function(n,r,t){return arguments.length!==3?nn:n<0||n>1||r<1||r>Math.pow(10,10)||t<1||t>Math.pow(10,10)?G:typeof n!="number"||typeof r!="number"||typeof t!="number"?O:S.centralF.inv(1-n,r,t)};jn.TEST=(n,r)=>{if(!n||!r||!(n instanceof Array)||!(r instanceof Array))return nn;if(n.length<2||r.length<2)return kn;const t=(g,h)=>{let f=0;for(let o=0;o<g.length;o++)f+=Math.pow(g[o]-h,2);return f},e=ir(n)/n.length,i=ir(r)/r.length,c=t(n,e)/(n.length-1),a=t(r,i)/(r.length-1);return c/a};function ru(n){return n=T(n),n instanceof Error?n:Math.log((1+n)/(1-n))/2}function eu(n){if(n=T(n),n instanceof Error)return n;const r=Math.exp(2*n);return(r-1)/(r+1)}function io(n,r,t){if(n=T(n),r=x(W(r)),t=x(W(t)),z(n,r,t))return O;const e=S.mean(t),i=S.mean(r),c=t.length;let a=0,g=0;for(let o=0;o<c;o++)a+=(t[o]-e)*(r[o]-i),g+=Math.pow(t[o]-e,2);const h=a/g;return i-h*e+h*n}function tu(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=n.length,e=r.length,i=[];for(let c=0;c<=e;c++){i[c]=0;for(let a=0;a<t;a++)c===0?n[a]<=r[0]&&(i[0]+=1):c<e?n[a]>r[c-1]&&n[a]<=r[c]&&(i[c]+=1):c===e&&n[a]>r[e-1]&&(i[e]+=1)}return i}function Vr(n){return n=T(n),n instanceof Error?n:n===0||parseInt(n,10)===n&&n<0?G:S.gammafn(n)}Vr.DIST=function(n,r,t,e){return arguments.length!==4?nn:n<0||r<=0||t<=0||typeof n!="number"||typeof r!="number"||typeof t!="number"?O:e?S.gamma.cdf(n,r,t,!0):S.gamma.pdf(n,r,t,!1)};Vr.INV=function(n,r,t){return arguments.length!==3?nn:n<0||n>1||r<=0||t<=0?G:typeof n!="number"||typeof r!="number"||typeof t!="number"?O:S.gamma.inv(n,r,t)};function be(n){return n=T(n),n instanceof Error?n:S.gammaln(n)}be.PRECISE=function(n){return arguments.length!==1?nn:n<=0?G:typeof n!="number"?O:S.gammaln(n)};function ou(n){return n=T(n),n instanceof Error?n:S.normal.cdf(n,0,1)-.5}function iu(){const n=x(W(arguments));return n instanceof Error?n:S.geomean(n)}function uu(n,r,t,e){if(n=x(W(n)),n instanceof Error)return n;let i;if(r===void 0)for(r=[],i=1;i<=n.length;i++)r.push(i);if(t===void 0&&(t=r),r=x(W(r)),t=x(W(t)),z(r,t))return O;e===void 0&&(e=!0);const c=n.length;let a=0,g=0,h=0,f=0;for(i=0;i<c;i++){const l=r[i],v=Math.log(n[i]);a+=l,g+=v,h+=l*v,f+=l*l}a/=c,g/=c,h/=c,f/=c;let o,u;e?(o=(h-a*g)/(f-a*a),u=g-o*a):(o=h/f,u=0);const s=[];for(i=0;i<t.length;i++)s.push(Math.exp(u+o*t[i]));return s}function fu(){const n=x(W(arguments));if(n instanceof Error)return n;const r=n.length;let t=0;for(let e=0;e<r;e++)t+=1/n[e];return r/t}const _e={};_e.DIST=(n,r,t,e,i)=>{if(n=T(n),r=T(r),t=T(t),e=T(e),z(n,r,t,e))return O;function c(g,h,f,o){return Ir(f,g)*Ir(o-f,h-g)/Ir(o,h)}function a(g,h,f,o){let u=0;for(let s=0;s<=g;s++)u+=c(s,h,f,o);return u}return i?a(n,r,t,e):c(n,r,t,e)};function su(n,r){return n=x(n),r=x(r),z(n,r)?O:n.length!==r.length?nn:io(0,n,r)}function lu(){const n=x(W(arguments));if(n instanceof Error)return n;const r=S.mean(n),t=n.length;let e=0;for(let i=0;i<t;i++)e+=Math.pow(n[i]-r,4);return e=e/Math.pow(S.stdev(n,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*e-3*(t-1)*(t-1)/((t-2)*(t-3))}function uo(n,r){const t=ln.apply(void 0,n);return t||(z(r)?r:(n=fr(W(n)),r=T(r),r<0||n.length<r?O:n.sort((e,i)=>i-e)[r-1]))}function je(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=S.mean(n),e=S.mean(r),i=r.length;let c=0,a=0;for(let f=0;f<i;f++)c+=(r[f]-e)*(n[f]-t),a+=Math.pow(r[f]-e,2);const g=c/a,h=t-g*e;return[g,h]}function cu(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r)||n.length!==r.length)return O;for(let e=0;e<n.length;e++)n[e]=Math.log(n[e]);const t=je(n,r);return t[0]=Math.round(Math.exp(t[0])*1e6)/1e6,t[1]=Math.round(Math.exp(t[1])*1e6)/1e6,t}const Or={};Or.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:e?S.lognormal.cdf(n,r,t):S.lognormal.pdf(n,r,t));Or.INV=(n,r,t)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:S.lognormal.inv(n,r,t));function Zr(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;const t=fr(n);return t.length===0?0:Math.max.apply(Math,t)}function au(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;let t=Ke(n);return t=t.map(e=>e??0),t.length===0?0:Math.max.apply(Math,t)}function hu(){const n=ee(...arguments);return n.length===0?0:Math.max.apply(Math,n)}function fo(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;const t=Ke(n);let e=S.median(t);return isNaN(e)&&(e=G),e}function Qr(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;const t=fr(n);return t.length===0?0:Math.min.apply(Math,t)}function gu(){const n=W(arguments),r=ln.apply(void 0,n);if(r)return r;let t=Ke(n);return t=t.map(e=>e??0),t.length===0?0:Math.min.apply(Math,t)}function vu(){const n=ee(...arguments);return n.length===0?0:Math.min.apply(Math,n)}const vr={};vr.MULT=function(){const n=x(W(arguments));if(n instanceof Error)return n;const r=n.length,t={};let e=[],i=0,c;for(let a=0;a<r;a++)c=n[a],t[c]=t[c]?t[c]+1:1,t[c]>i&&(i=t[c],e=[]),t[c]===i&&(e[e.length]=c);return e};vr.SNGL=function(){const n=x(W(arguments));return n instanceof Error?n:vr.MULT(n).sort((r,t)=>r-t)[0]};const nt={};nt.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:e?S.negbin.cdf(n,r,t):S.negbin.pdf(n,r,t));const nr={};nr.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:t<=0?G:e?S.normal.cdf(n,r,t):S.normal.pdf(n,r,t));nr.INV=(n,r,t)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:S.normal.inv(n,r,t));nr.S={};nr.S.DIST=(n,r)=>(n=T(n),n instanceof Error?O:r?S.normal.cdf(n,0,1):S.normal.pdf(n,0,1));nr.S.INV=n=>(n=T(n),n instanceof Error?O:S.normal.inv(n,0,1));function so(n,r){if(r=x(W(r)),n=x(W(n)),z(r,n))return O;const t=S.mean(n),e=S.mean(r),i=n.length;let c=0,a=0,g=0;for(let h=0;h<i;h++)c+=(n[h]-t)*(r[h]-e),a+=Math.pow(n[h]-t,2),g+=Math.pow(r[h]-e,2);return c/Math.sqrt(a*g)}const Kn={};Kn.EXC=(n,r)=>{if(n=x(W(n)),r=T(r),z(n,r))return O;n=n.sort((c,a)=>c-a);const t=n.length;if(r<1/(t+1)||r>1-1/(t+1))return G;const e=r*(t+1)-1,i=Math.floor(e);return Qt(e===i?n[e]:n[i]+(e-i)*(n[i+1]-n[i]))};Kn.INC=(n,r)=>{if(n=x(W(n)),r=T(r),z(n,r))return O;n=n.sort((c,a)=>c-a);const t=n.length,e=r*(t-1),i=Math.floor(e);return Qt(e===i?n[e]:n[i]+(e-i)*(n[i+1]-n[i]))};const Ur={};Ur.EXC=(n,r,t)=>{if(t=t===void 0?3:t,n=x(W(n)),r=T(r),t=T(t),z(n,r,t))return O;n=n.sort((o,u)=>o-u);const e=Qe.apply(null,n),i=n.length,c=e.length,a=Math.pow(10,t);let g=0,h=!1,f=0;for(;!h&&f<c;)r===e[f]?(g=(n.indexOf(e[f])+1)/(i+1),h=!0):r>=e[f]&&(r<e[f+1]||f===c-1)&&(g=(n.indexOf(e[f])+1+(r-e[f])/(e[f+1]-e[f]))/(i+1),h=!0),f++;return Math.floor(g*a)/a};Ur.INC=(n,r,t)=>{if(t=t===void 0?3:t,n=x(W(n)),r=T(r),t=T(t),z(n,r,t))return O;n=n.sort((o,u)=>o-u);const e=Qe.apply(null,n),i=n.length,c=e.length,a=Math.pow(10,t);let g=0,h=!1,f=0;for(;!h&&f<c;)r===e[f]?(g=n.indexOf(e[f])/(i-1),h=!0):r>=e[f]&&(r<e[f+1]||f===c-1)&&(g=(n.indexOf(e[f])+(r-e[f])/(e[f+1]-e[f]))/(i-1),h=!0),f++;return Math.floor(g*a)/a};function du(n,r){return n=T(n),r=T(r),z(n,r)?O:tr(n)/tr(n-r)}function pu(n,r){return n=T(n),r=T(r),z(n,r)?O:Math.pow(n,r)}function Eu(n){return n=T(n),n instanceof Error?O:Math.exp(-.5*n*n)/Qi}const rt={};rt.DIST=(n,r,t)=>(n=T(n),r=T(r),z(n,r)?O:t?S.poisson.cdf(n,r):S.poisson.pdf(n,r));function wu(n,r,t,e){if(t===void 0)return 0;if(e=e===void 0?t:e,n=x(W(n)),r=x(W(r)),t=T(t),e=T(e),z(n,r,t,e))return O;if(t===e)return n.indexOf(t)>=0?r[n.indexOf(t)]:0;const i=n.sort((g,h)=>g-h),c=i.length;let a=0;for(let g=0;g<c;g++)i[g]>=t&&i[g]<=e&&(a+=r[n.indexOf(i[g])]);return a}const dr={};dr.EXC=(n,r)=>{if(n=x(fr(W(n))),r=T(r),z(n,r))return O;switch(r){case 1:return Kn.EXC(n,.25);case 2:return Kn.EXC(n,.5);case 3:return Kn.EXC(n,.75);default:return G}};dr.INC=(n,r)=>{if(n=x(fr(W(n))),r=T(r),z(n,r))return O;switch(r){case 1:return Kn.INC(n,.25);case 2:return Kn.INC(n,.5);case 3:return Kn.INC(n,.75);default:return G}};const $r={};$r.AVG=(n,r,t)=>{if(n=T(n),r=x(W(r)),z(n,r))return O;r=W(r),t=t||!1;const e=t?(a,g)=>a-g:(a,g)=>g-a;r=r.sort(e);const i=r.length;let c=0;for(let a=0;a<i;a++)r[a]===n&&c++;return c>1?(2*r.indexOf(n)+c+1)/2:r.indexOf(n)+1};$r.EQ=(n,r,t)=>{if(n=T(n),r=x(W(r)),z(n,r))return O;t=t||!1;const e=t?(i,c)=>i-c:(i,c)=>c-i;return r=r.sort(e),r.indexOf(n)+1};function Au(n,r){if(arguments.length!==2)return nn;if(r<0)return G;if(!(n instanceof Array)||typeof r!="number")return O;if(n.length!==0)return S.row(n,r)}function Nu(n,r){return n=x(W(n)),r=x(W(r)),z(n,r)?O:Math.pow(so(n,r),2)}function et(){const n=x(W(arguments));if(n instanceof Error)return n;const r=S.mean(n),t=n.length;let e=0;for(let i=0;i<t;i++)e+=Math.pow(n[i]-r,3);return t*e/((t-1)*(t-2)*Math.pow(S.stdev(n,!0),3))}et.P=function(){const n=x(W(arguments));if(n instanceof Error)return n;const r=S.mean(n),t=n.length;let e=0,i=0;for(let c=0;c<t;c++)i+=Math.pow(n[c]-r,3),e+=Math.pow(n[c]-r,2);return i=i/t,e=e/t,i/Math.pow(e,3/2)};function Iu(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=S.mean(r),e=S.mean(n),i=r.length;let c=0,a=0;for(let g=0;g<i;g++)c+=(r[g]-t)*(n[g]-e),a+=Math.pow(r[g]-t,2);return c/a}function lo(n,r){return n=x(W(n)),r=T(r),z(n,r)?n:n.sort((t,e)=>t-e)[r-1]}function Tu(n,r,t){return n=T(n),r=T(r),t=T(t),z(n,r,t)?O:(n-r)/t}const Bn={};Bn.P=function(){const n=Yn.P.apply(this,arguments);let r=Math.sqrt(n);return isNaN(r)&&(r=G),r};Bn.S=function(){const n=Yn.S.apply(this,arguments);return Math.sqrt(n)};function Ru(){const n=co.apply(this,arguments);return Math.sqrt(n)}function Mu(){const n=ao.apply(this,arguments);let r=Math.sqrt(n);return isNaN(r)&&(r=G),r}function mu(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=S.mean(r),e=S.mean(n),i=r.length;let c=0,a=0,g=0;for(let h=0;h<i;h++)c+=Math.pow(n[h]-e,2),a+=(r[h]-t)*(n[h]-e),g+=Math.pow(r[h]-t,2);return Math.sqrt((c-a*a/g)/(i-2))}zn.DIST=(n,r,t)=>t!==1&&t!==2?G:t===1?zn.DIST.RT(n,r):zn.DIST["2T"](n,r);zn.DIST["2T"]=function(n,r){return arguments.length!==2?nn:n<0||r<1?G:typeof n!="number"||typeof r!="number"?O:(1-S.studentt.cdf(n,r))*2};zn.DIST.RT=function(n,r){return arguments.length!==2?nn:n<0||r<1?G:typeof n!="number"||typeof r!="number"?O:1-S.studentt.cdf(n,r)};zn.INV=(n,r)=>(n=T(n),r=T(r),z(n,r)?O:S.studentt.inv(n,r));zn.INV["2T"]=(n,r)=>(n=T(n),r=T(r),n<=0||n>1||r<1?G:z(n,r)?O:Math.abs(S.studentt.inv(n/2,r)));zn.TEST=(n,r)=>{if(n=x(W(n)),r=x(W(r)),z(n,r))return O;const t=S.mean(n),e=S.mean(r);let i=0,c=0,a;for(a=0;a<n.length;a++)i+=Math.pow(n[a]-t,2);for(a=0;a<r.length;a++)c+=Math.pow(r[a]-e,2);i=i/(n.length-1),c=c/(r.length-1);const g=Math.abs(t-e)/Math.sqrt(i/n.length+c/r.length);return zn.DIST["2T"](g,n.length+r.length-2)};function Cu(n,r,t){if(n=x(W(n)),r=x(W(r)),t=x(W(t)),z(n,r,t))return O;const e=je(n,r),i=e[0],c=e[1],a=[];return t.forEach(g=>{a.push(i*g+c)}),a}function Ou(n,r){if(n=x(W(n)),r=T(r),z(n,r))return O;const t=pr(n.length*r,2)/2;return S.mean(oi(Rn(n.sort((e,i)=>e-i),t),t))}const Yn={};Yn.P=function(){const n=fr(W(arguments)),r=n.length;let t=0;const e=gr(n);let i;for(let c=0;c<r;c++)t+=Math.pow(n[c]-e,2);return i=t/r,isNaN(i)&&(i=G),i};Yn.S=function(){const n=fr(W(arguments)),r=n.length;let t=0;const e=gr(n);for(let i=0;i<r;i++)t+=Math.pow(n[i]-e,2);return t/(r-1)};function co(){const n=W(arguments),r=n.length;let t=0,e=0;const i=Je(n);for(let c=0;c<r;c++){const a=n[c];typeof a=="number"?t+=Math.pow(a-i,2):a===!0?t+=Math.pow(1-i,2):t+=Math.pow(0-i,2),a!==null&&e++}return t/(e-1)}function ao(){const n=W(arguments),r=n.length;let t=0,e=0;const i=Je(n);let c;for(let a=0;a<r;a++){const g=n[a];typeof g=="number"?t+=Math.pow(g-i,2):g===!0?t+=Math.pow(1-i,2):t+=Math.pow(0-i,2),g!==null&&e++}return c=t/e,isNaN(c)&&(c=G),c}const tt={};tt.DIST=(n,r,t,e)=>(n=T(n),r=T(r),t=T(t),z(n,r,t)?O:e?1-Math.exp(-Math.pow(n/t,r)):Math.pow(n,r-1)*Math.exp(-Math.pow(n/t,r))*r/Math.pow(t,r));const ot={};ot.TEST=(n,r,t)=>{if(n=x(W(n)),r=T(r),z(n,r))return O;t=t||Bn.S(n);const e=n.length;return 1-nr.S.DIST((gr(n)-r)/(t/Math.sqrt(e)),!0)};function Du(n){return n=T(n),n instanceof Error?n:Math.abs(n)}function yu(n){if(n=T(n),n instanceof Error)return n;let r=Math.acos(n);return isNaN(r)&&(r=G),r}function Lu(n){if(n=T(n),n instanceof Error)return n;let r=Math.log(n+Math.sqrt(n*n-1));return isNaN(r)&&(r=G),r}function Pu(n){return n=T(n),n instanceof Error?n:Math.atan(1/n)}function Fu(n){if(n=T(n),n instanceof Error)return n;let r=.5*Math.log((n+1)/(n-1));return isNaN(r)&&(r=G),r}function qu(n,r,t,e){if(n=T(n),r=T(n),z(n,r))return O;switch(n){case 1:return gr(t);case 2:return Pr(t);case 3:return Fr(t);case 4:return Zr(t);case 5:return Qr(t);case 6:return Jr(t);case 7:return Bn.S(t);case 8:return Bn.P(t);case 9:return ir(t);case 10:return Yn.S(t);case 11:return Yn.P(t);case 12:return fo(t);case 13:return vr.SNGL(t);case 14:return uo(t,e);case 15:return lo(t,e);case 16:return Kn.INC(t,e);case 17:return dr.INC(t,e);case 18:return Kn.EXC(t,e);case 19:return dr.EXC(t,e)}}function Vu(n){if(n==null)return 0;if(n instanceof Error)return n;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return O;let r=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,t=>{r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),r}function Uu(n){if(n=T(n),n instanceof Error)return n;let r=Math.asin(n);return isNaN(r)&&(r=G),r}function $u(n){return n=T(n),n instanceof Error?n:Math.log(n+Math.sqrt(n*n+1))}function ku(n){return n=T(n),n instanceof Error?n:Math.atan(n)}function Gu(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||Math.atan2(n,r)}function Hu(n){if(n=T(n),n instanceof Error)return n;let r=Math.log((1+n)/(1-n))/2;return isNaN(r)&&(r=G),r}function Yu(n,r,t){n=T(n),r=T(r),t=T(t);const e=ln(n,r,t);if(e)return e;if(r===0)return G;const i=n.toString(r);return new Array(Math.max(t+1-i.length,0)).join("0")+i}function lr(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(r===0?0:n>0&&r<0?G:Math.ceil(n/r)*r)}lr.MATH=(n,r,t=0)=>{r===void 0&&(r=n>0?1:-1),n=T(n),r=T(r),t=T(t);const e=ln(n,r,t);return e||(r===0?0:(r=Math.abs(r),t===0||n>0?Math.ceil(n/r)*r:Math.floor(n/r)*r))};lr.PRECISE=(n,r)=>lr.MATH(n,r);function Ir(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n<r?G:tr(n)/(tr(r)*tr(n-r)))}function Bu(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n<r?G:n===0&&r===0?1:Ir(n+r-1,n-1))}function zu(n){return n=T(n),n instanceof Error?n:Math.cos(n)}function Wu(n){return n=T(n),n instanceof Error?n:(Math.exp(n)+Math.exp(-n))/2}function Xu(n){return n=T(n),n instanceof Error?n:n===0?kn:1/Math.tan(n)}function Ku(n){if(n=T(n),n instanceof Error)return n;if(n===0)return kn;const r=Math.exp(2*n);return(r+1)/(r-1)}function Zu(n){return n=T(n),n instanceof Error?n:n===0?kn:1/Math.sin(n)}function Qu(n){return n=T(n),n instanceof Error?n:n===0?kn:2/(Math.exp(n)-Math.exp(-n))}function Ju(n,r){if(arguments.length<2)return nn;n=n||"0",r=T(r);const t=ln(n,r);if(t)return t;if(r===0)return G;const e=parseInt(n,r);return isNaN(e)?G:e}function Su(n){return n=T(n),n instanceof Error?n:n*180/Math.PI}function xu(n){return n=T(n),n instanceof Error?n:lr.MATH(n,-2,-1)}function bu(n){return arguments.length<1?nn:arguments.length>1?Xe:(n=T(n),n instanceof Error||(n=Math.exp(n)),n)}const Yr=[];function tr(n){if(n=T(n),n instanceof Error)return n;const r=Math.floor(n);return r===0||r===1?1:(Yr[r]>0||(Yr[r]=tr(r-1)*r),Yr[r])}function ho(n){if(n=T(n),n instanceof Error)return n;const r=Math.floor(n);return r<=0?1:r*ho(r-2)}function pr(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(r?n>0&&r<0?G:Math.floor(n/r)*r:kn)}pr.MATH=(n,r=1,t=0)=>{n=T(n),r=T(r),t=T(t);const e=ln(n,r,t);return e||(r===0?0:(r=Math.abs(r),t===0||n>0?Math.floor(n/r)*r:Math.ceil(n/r)*r))};pr.PRECISE=(n,r)=>pr.MATH(n,r);function _u(){const n=x(W(arguments));if(n instanceof Error)return n;const r=n.length,t=n[0];let e=t<0?-t:t;for(let i=1;i<r;i++){const c=n[i];let a=c<0?-c:c;for(;e&&a;)e>a?e%=a:a%=e;e+=a}return e}function ju(n){return n=T(n),n instanceof Error?n:Math.floor(n)}const nf={CEILING:lr};function rf(){const n=x(W(arguments));if(n instanceof Error)return n;for(var r,t,e,i,c=1;(e=n.pop())!==void 0;){if(e===0)return 0;for(;e>1;){if(e%2){for(r=3,t=Math.floor(Math.sqrt(e));r<=t&&e%r;r+=2);i=r<=t?r:e}else i=2;for(e/=i,c*=i,r=n.length;r;n[--r]%i===0&&(n[r]/=i)===1&&n.splice(r,1));}}return c}function ef(n){return n=T(n),n instanceof Error?n:n===0?G:Math.log(n)}function tf(n,r){n=T(n),r=r?T(r):10;const t=ln(n,r);return t||(n===0||r===0?G:Math.log(n)/Math.log(r))}function of(n){return n=T(n),n instanceof Error?n:n===0?G:Math.log(n)/Math.log(10)}function uf(n,r){return!Array.isArray(n)||!Array.isArray(r)||n.some(e=>!e.length)||r.some(e=>!e.length)||Ye(n).some(e=>typeof e!="number")||Ye(r).some(e=>typeof e!="number")||n[0].length!==r.length?O:Array(n.length).fill(0).map(()=>Array(r[0].length).fill(0)).map((e,i)=>e.map((c,a)=>n[i].reduce((g,h,f)=>g+h*r[f][a],0)))}function ff(n,r){n=T(n),r=T(r);const t=ln(n,r);if(t)return t;if(r===0)return kn;let e=Math.abs(n%r);return e=n<0?r-e:e,r>0?e:-e}function sf(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n*r===0?0:n*r<0?G:Math.round(n/r)*r)}function lf(){const n=x(W(arguments));if(n instanceof Error)return n;let r=0,t=1;for(let e=0;e<n.length;e++)r+=n[e],t*=tr(n[e]);return tr(r)/t}function cf(n){return arguments.length>1?nn:(n=parseInt(n),!n||n<=0?O:Array(n).fill(0).map(()=>Array(n).fill(0)).map((r,t)=>(r[t]=1,r)))}function af(n){if(n=T(n),n instanceof Error)return n;let r=Math.ceil(Math.abs(n));return r=r&1?r:r+1,n>=0?r:-r}function hf(){return Math.PI}function go(n,r){n=T(n),r=T(r);const t=ln(n,r);if(t)return t;if(n===0&&r===0)return G;const e=Math.pow(n,r);return isNaN(e)?G:e}function Jr(){const r=W(arguments).filter(i=>i!=null);if(r.length===0)return 0;const t=x(r);if(t instanceof Error)return t;let e=1;for(let i=0;i<t.length;i++)e*=t[i];return e}function gf(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||parseInt(n/r,10)}function vf(n){return n=T(n),n instanceof Error?n:n*Math.PI/180}function df(){return Math.random()}function pf(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||n+Math.ceil((r-n+1)*Math.random())-1}function Ef(n){if(n=T(n),n instanceof Error)return n;const r=String(n).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let e="",i=3;for(;i--;)e=(t[+r.pop()+i*10]||"")+e;return new Array(+r.join("")+1).join("M")+e}function vo(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||+(Math.round(+(n+"e"+r))+"e"+r*-1)}function wf(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)}function Af(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n>0?1:-1)*Math.ceil(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)}function Nf(n){return n=T(n),n instanceof Error?n:1/Math.cos(n)}function If(n){return n=T(n),n instanceof Error?n:2/(Math.exp(n)+Math.exp(-n))}function Tf(n,r,t,e){if(n=T(n),r=T(r),t=T(t),e=x(e),z(n,r,t,e))return O;let i=e[0]*Math.pow(n,r);for(let c=1;c<e.length;c++)i+=e[c]*Math.pow(n,r+c*t);return i}function Rf(n){return n=T(n),n instanceof Error?n:n<0?-1:n===0?0:1}function Mf(n){return n=T(n),n instanceof Error?n:Math.sin(n)}function mf(n){return n=T(n),n instanceof Error?n:(Math.exp(n)-Math.exp(-n))/2}function Cf(n){return n=T(n),n instanceof Error?n:n<0?G:Math.sqrt(n)}function Of(n){return n=T(n),n instanceof Error?n:Math.sqrt(n*Math.PI)}function Df(n,r){if(n=T(n),n instanceof Error)return n;switch(n){case 1:return gr(r);case 2:return Pr(r);case 3:return Fr(r);case 4:return Zr(r);case 5:return Qr(r);case 6:return Jr(r);case 7:return Bn.S(r);case 8:return Bn.P(r);case 9:return ir(r);case 10:return Yn.S(r);case 11:return Yn.P(r);case 101:return gr(r);case 102:return Pr(r);case 103:return Fr(r);case 104:return Zr(r);case 105:return Qr(r);case 106:return Jr(r);case 107:return Bn.S(r);case 108:return Bn.P(r);case 109:return ir(r);case 110:return Yn.S(r);case 111:return Yn.P(r)}}function ir(){let n=0;return Gn(ne(arguments),r=>{if(n instanceof Error)return!1;if(r instanceof Error)n=r;else if(typeof r=="number")n+=r;else if(typeof r=="string"){const t=parseFloat(r);!isNaN(t)&&(n+=t)}else if(Array.isArray(r)){const t=ir.apply(null,r);t instanceof Error?n=t:n+=t}}),n}function yf(n,r,t){if(n=W(n),t=t?W(t):n,n instanceof Error)return n;if(r==null||r instanceof Error)return 0;let e=0;const i=r==="*",c=i?null:Rr(r+"");for(let a=0;a<n.length;a++){const g=n[a],h=t[a];if(i)e+=g;else{const f=[er(g,ar)].concat(c);e+=Mr(f)?h:0}}return e}function Lf(){const n=ee(...arguments);return ir(n)}function Pf(){if(!arguments||arguments.length===0)return O;const n=arguments.length+1;let r=0,t,e,i,c;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let g=0;g<arguments[0][a].length;g++){for(t=1,e=1;e<n;e++){const h=arguments[e-1][a][g];if(h instanceof Error)return h;if(c=T(h),c instanceof Error)return c;t*=c}r+=t}else{for(t=1,e=1;e<n;e++){const g=arguments[e-1][a];if(g instanceof Error)return g;if(i=T(g),i instanceof Error)return i;t*=i}r+=t}return r}function Ff(){const n=x(W(arguments));if(n instanceof Error)return n;let r=0;const t=n.length;for(let e=0;e<t;e++)r+=oe(n[e])?n[e]*n[e]:0;return r}function qf(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;let t=0;for(let e=0;e<n.length;e++)t+=n[e]*n[e]-r[e]*r[e];return t}function Vf(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;let t=0;n=x(W(n)),r=x(W(r));for(let e=0;e<n.length;e++)t+=n[e]*n[e]+r[e]*r[e];return t}function Uf(n,r){if(n=x(W(n)),r=x(W(r)),z(n,r))return O;let t=0;n=W(n),r=W(r);for(let e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t}function $f(n){return n=T(n),n instanceof Error?n:Math.tan(n)}function kf(n){if(n=T(n),n instanceof Error)return n;const r=Math.exp(2*n);return(r-1)/(r+1)}function Gf(n,r){n=T(n),r=T(r);const t=ln(n,r);return t||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)}function Hf(n,r){if(arguments.length!==2)return nn;n=T(n),r=T(r);const t=ln(n,r);return t||n+r}function Yf(n,r){if(arguments.length!==2)return nn;n=T(n),r=T(r);const t=ln(n,r);return t||(r===0?kn:n/r)}function Bf(n,r){return arguments.length!==2?nn:n instanceof Error?n:r instanceof Error?r:(n===null&&(n=void 0),r===null&&(r=void 0),n===r)}function zf(n,r){if(arguments.length!==2)return nn;if(n instanceof Error)return n;if(r instanceof Error)return r;re(n,r)?(n=On(n),r=On(r)):(n=T(n),r=T(r));const t=ln(n,r);return t||n>r}function Wf(n,r){if(arguments.length!==2)return nn;re(n,r)?(n=On(n),r=On(r)):(n=T(n),r=T(r));const t=ln(n,r);return t||n>=r}function Xf(n,r){if(arguments.length!==2)return nn;re(n,r)?(n=On(n),r=On(r)):(n=T(n),r=T(r));const t=ln(n,r);return t||n<r}function Kf(n,r){if(arguments.length!==2)return nn;re(n,r)?(n=On(n),r=On(r)):(n=T(n),r=T(r));const t=ln(n,r);return t||n<=r}function Zf(n,r){if(arguments.length!==2)return nn;n=T(n),r=T(r);const t=ln(n,r);return t||n-r}function Qf(n,r){if(arguments.length!==2)return nn;n=T(n),r=T(r);const t=ln(n,r);return t||n*r}function Jf(n,r){return arguments.length!==2?nn:n instanceof Error?n:r instanceof Error?r:(n===null&&(n=void 0),r===null&&(r=void 0),n!==r)}function Sf(n,r){return arguments.length!==2?nn:go(n,r)}var xf=Object.freeze({__proto__:null,ADD:Hf,DIVIDE:Yf,EQ:Bf,GT:zf,GTE:Wf,LT:Xf,LTE:Kf,MINUS:Zf,MULTIPLY:Qf,NE:Jf,POW:Sf});const bf=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],_f=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Sr=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function jf(n,r,t){let e;return n=T(n),r=T(r),t=T(t),z(n,r,t)?e=O:(e=new Date(n,r-1,t),e.getFullYear()<0&&(e=G)),ur?or(e):e}function sr(n,r,t){t=t.toUpperCase(),n=gn(n),r=gn(r);const e=n.getFullYear(),i=n.getMonth(),c=n.getDate(),a=r.getFullYear(),g=r.getMonth(),h=r.getDate();let f;switch(t){case"Y":f=Math.floor(it(n,r));break;case"D":f=hr(r,n);break;case"M":f=g-i+12*(a-e),h<c&&f--;break;case"MD":c<=h?f=h-c:(g===0?(n.setFullYear(a-1),n.setMonth(12)):(n.setFullYear(a),n.setMonth(g-1)),f=hr(r,n));break;case"YM":f=g-i+12*(a-e),h<c&&f--,f=f%12;break;case"YD":g>i||g===i&&h<c?n.setFullYear(a):n.setFullYear(a-1),f=hr(r,n);break}return f}function ns(n){if(typeof n!="string")return O;const r=Date.parse(n);if(isNaN(r))return O;const t=new Date(n);return ur?or(t):t}function rs(n){const r=gn(n);return r instanceof Error?r:r.getDate()}function xr(n){const r=new Date(n);return r.setHours(0,0,0,0),r}function hr(n,r){return n=gn(n),r=gn(r),n instanceof Error?n:r instanceof Error?r:or(xr(n))-or(xr(r))}function cr(n,r,t){if(t=Ze(t||"false"),n=gn(n),r=gn(r),n instanceof Error)return n;if(r instanceof Error)return r;if(t instanceof Error)return t;const e=n.getMonth();let i=r.getMonth(),c,a;if(t)c=n.getDate()===31?30:n.getDate(),a=r.getDate()===31?30:r.getDate();else{const g=new Date(n.getFullYear(),e+1,0).getDate(),h=new Date(r.getFullYear(),i+1,0).getDate();c=n.getDate()===g?30:n.getDate(),r.getDate()===h?c<30?(i++,a=1):a=30:a=r.getDate()}return 360*(r.getFullYear()-n.getFullYear())+30*(i-e)+(a-c)}function es(n,r){if(n=gn(n),n instanceof Error)return n;if(isNaN(r))return O;let t=n.getDate();n.setDate(1),r=parseInt(r,10),n.setMonth(n.getMonth()+r);let e=n.getMonth();if(t>28){let i=[31,28,31,30,31,30,31,31,30,31,30,31][e],c=n.getFullYear();e===1&&(c%4===0&&c%100!==0||c%400===0)&&(i=29),t=Math.min(t,i)}return n.setDate(t),ur?or(n):n}function ts(n,r){if(n=gn(n),n instanceof Error)return n;if(isNaN(r))return O;r=parseInt(r,10);const t=new Date(n.getFullYear(),n.getMonth()+r+1,0);return ur?or(t):t}function os(n){return n=gn(n),n instanceof Error?n:n.getHours()}function po(n){if(n=gn(n),n instanceof Error)return n;n=xr(n),n.setDate(n.getDate()+4-(n.getDay()||7));const r=new Date(n.getFullYear(),0,1);return Math.ceil(((n-r)/864e5+1)/7)}function is(n){return n=gn(n),n instanceof Error?n:n.getMinutes()}function us(n){return n=gn(n),n instanceof Error?n:n.getMonth()+1}function ie(n,r,t){return ie.INTL(n,r,1,t)}ie.INTL=(n,r,t,e)=>{if(n=gn(n),n instanceof Error)return n;if(r=gn(r),r instanceof Error)return r;let i=!1;const c=[],a=[1,2,3,4,5,6,0],g=new RegExp("^[0|1]{7}$");if(t===void 0)t=Sr[1];else if(typeof t=="string"&&g.test(t)){i=!0,t=t.split("");for(let u=0;u<t.length;u++)t[u]==="1"&&c.push(a[u])}else t=Sr[t];if(!(t instanceof Array))return O;e===void 0?e=[]:e instanceof Array||(e=[e]);for(let u=0;u<e.length;u++){const s=gn(e[u]);if(s instanceof Error)return s;e[u]=s}const h=Math.round((r-n)/(1e3*60*60*24))+1;let f=h;const o=n;for(let u=0;u<h;u++){const s=new Date().getTimezoneOffset()>0?o.getUTCDay():o.getDay();let l=i?c.includes(s):s===t[0]||s===t[1];for(let v=0;v<e.length;v++){const d=e[v];if(d.getDate()===o.getDate()&&d.getMonth()===o.getMonth()&&d.getFullYear()===o.getFullYear()){l=!0;break}}l&&f--,o.setDate(o.getDate()+1)}return f};function fs(){return ur?or(new Date):new Date}function ss(n){return n=gn(n),n instanceof Error?n:n.getSeconds()}function ls(n,r,t){return n=T(n),r=T(r),t=T(t),z(n,r,t)?O:n<0||r<0||t<0?G:(3600*n+60*r+t)/86400}function cs(n){return n=gn(n),n instanceof Error?n:(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400}function as(){const n=xr(new Date);return ur?or(n):n}function hs(n,r){if(n=gn(n),n instanceof Error)return n;r===void 0&&(r=1);const t=n.getDay();return _f[r][t]}function gs(n,r){if(n=gn(n),n instanceof Error)return n;if(r===void 0&&(r=1),r===21)return po(n);const t=bf[r];let e=new Date(n.getFullYear(),0,1);const i=e.getDay()<t?1:0;return e-=Math.abs(e.getDay()-t)*24*60*60*1e3,Math.floor((n-e)/(1e3*60*60*24)/7+1)+i}function ue(n,r,t){return ue.INTL(n,r,1,t)}ue.INTL=(n,r,t,e)=>{if(n=gn(n),n instanceof Error)return n;if(r=T(r),r instanceof Error)return r;if(t===void 0?t=Sr[1]:t=Sr[t],!(t instanceof Array))return O;e===void 0?e=[]:e instanceof Array||(e=[e]);for(let a=0;a<e.length;a++){const g=gn(e[a]);if(g instanceof Error)return g;e[a]=g}let i=0;const c=Math.sign(r);for(;i<r*c;){n.setDate(n.getDate()+c);const a=n.getDay();if(!(a===t[0]||a===t[1])){for(let g=0;g<e.length;g++){const h=e[g];if(h.getDate()===n.getDate()&&h.getMonth()===n.getMonth()&&h.getFullYear()===n.getFullYear()){i--;break}}i++}}return n.getFullYear()<1900?O:n};function vs(n){return n=gn(n),n instanceof Error?n:n.getFullYear()}function ge(n){return new Date(n,1,29).getMonth()===1}function Br(n,r){return Math.ceil((r-n)/1e3/60/60/24)}function it(n,r,t){if(n=gn(n),n instanceof Error)return n;if(r=gn(r),r instanceof Error)return r;t=t||0;let e=n.getDate();const i=n.getMonth()+1,c=n.getFullYear();let a=r.getDate();const g=r.getMonth()+1,h=r.getFullYear();switch(t){case 0:return e===31&&a===31?(e=30,a=30):e===31?e=30:e===30&&a===31&&(a=30),(a+g*30+h*360-(e+i*30+c*360))/360;case 1:{const f=(v,d)=>{const p=v.getFullYear(),A=new Date(p,2,1);if(ge(p)&&v<A&&d>=A)return!0;const I=d.getFullYear(),E=new Date(I,2,1);return ge(I)&&d>=E&&v<E};let o=365;if(c===h||c+1===h&&(i>g||i===g&&e>=a))return(c===h&&ge(c)||f(n,r)||g===1&&a===29)&&(o=366),Br(n,r)/o;const u=h-c+1,l=(new Date(h+1,0,1)-new Date(c,0,1))/1e3/60/60/24/u;return Br(n,r)/l}case 2:return Br(n,r)/360;case 3:return Br(n,r)/365;case 4:return(a+g*30+h*360-(e+i*30+c*360))/360}}function ut(n){return/^[01]{1,10}$/.test(n)}function ds(n,r){return n=T(n),r=T(r),z(n,r)?O:_r.besseli(n,r)}function ps(n,r){return n=T(n),r=T(r),z(n,r)?O:_r.besselj(n,r)}function Es(n,r){return n=T(n),r=T(r),z(n,r)?O:_r.besselk(n,r)}function ws(n,r){return n=T(n),r=T(r),z(n,r)?O:_r.bessely(n,r)}function As(n){if(!ut(n))return G;const r=parseInt(n,2),t=n.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:r}function Ns(n,r){if(!ut(n))return G;const t=n.toString();if(t.length===10&&t.substring(0,1)==="1")return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);const e=parseInt(n,2).toString(16);return r===void 0?e:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=e.length?Zn("0",r-e.length)+e:G)}function Is(n,r){if(!ut(n))return G;const t=n.toString();if(t.length===10&&t.substring(0,1)==="1")return(1073741312+parseInt(t.substring(1),2)).toString(8);const e=parseInt(n,2).toString(8);return r===void 0?e:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=e.length?Zn("0",r-e.length)+e:G)}function Ts(n,r){return n=T(n),r=T(r),z(n,r)?O:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?G:n&r}function Rs(n,r){return n=T(n),r=T(r),z(n,r)?O:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(r)>53?G:r>=0?n<<r:n>>-r}function Ms(n,r){return n=T(n),r=T(r),z(n,r)?O:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?G:n|r}function ms(n,r){return n=T(n),r=T(r),z(n,r)?O:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(r)>53?G:r>=0?n>>r:n<<-r}function Cs(n,r){return n=T(n),r=T(r),z(n,r)?O:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?G:n^r}function Hn(n,r,t){if(n=T(n),r=T(r),z(n,r))return n;if(t=t===void 0?"i":t,t!=="i"&&t!=="j")return O;if(n===0&&r===0)return 0;if(n===0)return r===1?t:r.toString()+t;if(r===0)return n.toString();{const e=r>0?"+":"";return n.toString()+e+(r===1?t:r.toString()+t)}}function Os(n,r,t){if(n=T(n),n instanceof Error)return n;const e=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m3",["m^3"],"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},c={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,g=null,h=r,f=t,o=1,u=1,s;for(let l=0;l<e.length;l++)s=e[l][2]===null?[]:e[l][2],(e[l][1]===h||s.indexOf(h)>=0)&&(a=e[l]),(e[l][1]===f||s.indexOf(f)>=0)&&(g=e[l]);if(a===null){const l=i[r.substring(0,2)];let v=c[r.substring(0,1)];r.substring(0,2)==="da"&&(v=["dekao",10,"da"]),l?(o=l[2],h=r.substring(2)):v&&(o=v[1],h=r.substring(v[2].length));for(let d=0;d<e.length;d++)s=e[d][2]===null?[]:e[d][2],(e[d][1]===h||s.indexOf(h)>=0)&&(a=e[d])}if(g===null){const l=i[t.substring(0,2)];let v=c[t.substring(0,1)];t.substring(0,2)==="da"&&(v=["dekao",10,"da"]),l?(u=l[2],f=t.substring(2)):v&&(u=v[1],f=t.substring(v[2].length));for(let d=0;d<e.length;d++)s=e[d][2]===null?[]:e[d][2],(e[d][1]===f||s.indexOf(f)>=0)&&(g=e[d])}return a===null||g===null||a[3]!==g[3]?nn:n*a[6]*o/(g[6]*u)}function Ds(n,r){if(n=T(n),n instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return G;if(n<0)return"1"+Zn("0",9-(512+n).toString(2).length)+(512+n).toString(2);const t=parseInt(n,10).toString(2);return typeof r>"u"?t:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=t.length?Zn("0",r-t.length)+t:G)}function ys(n,r){if(n=T(n),n instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return G;if(n<0)return(1099511627776+n).toString(16);const t=parseInt(n,10).toString(16);return typeof r>"u"?t:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=t.length?Zn("0",r-t.length)+t:G)}function Ls(n,r){if(n=T(n),n instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return G;if(n<0)return(1073741824+n).toString(8);const t=parseInt(n,10).toString(8);return typeof r>"u"?t:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=t.length?Zn("0",r-t.length)+t:G)}function Ps(n,r){return r=r===void 0?0:r,n=T(n),r=T(r),z(n,r)?O:n===r?1:0}function Eo(n,r){return r=r===void 0?0:r,n=T(n),r=T(r),z(n,r)?O:S.erf(n)}function wo(n){return isNaN(n)?O:S.erfc(n)}function Fs(n,r){return r=r||0,n=T(n),z(r,n)?n:n>=r?1:0}function qs(n,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return G;const t=n.length===10&&n.substring(0,1).toLowerCase()==="f",e=t?parseInt(n,16)-1099511627776:parseInt(n,16);if(e<-512||e>511)return G;if(t)return"1"+Zn("0",9-(512+e).toString(2).length)+(512+e).toString(2);const i=e.toString(2);return r===void 0?i:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=i.length?Zn("0",r-i.length)+i:G)}function Vs(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return G;const r=parseInt(n,16);return r>=549755813888?r-1099511627776:r}function Us(n,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return G;const t=parseInt(n,16);if(t>536870911&&t<0xffe0000000)return G;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);const e=t.toString(8);return r===void 0?e:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=e.length?Zn("0",r-e.length)+e:G)}function ft(n){const r=Nn(n),t=An(n);return z(r,t)?O:Math.sqrt(Math.pow(r,2)+Math.pow(t,2))}function An(n){if(n===void 0||n===!0||n===!1)return O;if(n===0||n==="0")return 0;if(["i","j"].indexOf(n)>=0)return 1;n=n+"",n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let r=n.indexOf("+"),t=n.indexOf("-");r===0&&(r=n.indexOf("+",1)),t===0&&(t=n.indexOf("-",1));const e=n.substring(n.length-1,n.length),i=e==="i"||e==="j";return r>=0||t>=0?i?r>=0?isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?G:Number(n.substring(r+1,n.length-1)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?G:-Number(n.substring(t+1,n.length-1)):G:i?isNaN(n.substring(0,n.length-1))?G:n.substring(0,n.length-1):isNaN(n)?G:0}function st(n){const r=Nn(n),t=An(n);return z(r,t)?O:r===0&&t===0?kn:r===0&&t>0?Math.PI/2:r===0&&t<0?-Math.PI/2:t===0&&r>0?0:t===0&&r<0?-Math.PI:r>0?Math.atan(t/r):r<0&&t>=0?Math.atan(t/r)+Math.PI:Math.atan(t/r)-Math.PI}function $s(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",t!==0?Hn(r,-t,e):n}function fe(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,e)}function Ao(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,e)}function ks(n){const r=Nn(n),t=An(n);return z(r,t)?O:Ar(fe(n),se(n))}function Ar(n,r){const t=Nn(n),e=An(n),i=Nn(r),c=An(r);if(z(t,e,i,c))return O;const a=n.substring(n.length-1),g=r.substring(r.length-1);let h="i";if((a==="j"||g==="j")&&(h="j"),i===0&&c===0)return G;const f=i*i+c*c;return Hn((t*i+e*c)/f,(e*i-t*c)/f,h)}function Gs(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);e=e==="i"||e==="j"?e:"i";const i=Math.exp(r);return Hn(i*Math.cos(t),i*Math.sin(t),e)}function Hs(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.log(Math.sqrt(r*r+t*t)),Math.atan(t/r),e)}function Ys(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.log(Math.sqrt(r*r+t*t))/Math.log(10),Math.atan(t/r)/Math.log(10),e)}function Bs(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.log(Math.sqrt(r*r+t*t))/Math.log(2),Math.atan(t/r)/Math.log(2),e)}function zs(n,r){r=T(r);const t=Nn(n),e=An(n);if(z(r,t,e))return O;let i=n.substring(n.length-1);i=i==="i"||i==="j"?i:"i";const c=Math.pow(ft(n),r),a=st(n);return Hn(c*Math.cos(r*a),c*Math.sin(r*a),i)}function Ws(){let n=arguments[0];if(!arguments.length)return O;for(let r=1;r<arguments.length;r++){const t=Nn(n),e=An(n),i=Nn(arguments[r]),c=An(arguments[r]);if(z(t,e,i,c))return O;n=Hn(t*i-e*c,t*c+e*i)}return n}function Nn(n){if(n===void 0||n===!0||n===!1)return O;if(n===0||n==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0)return 0;n=n+"";let r=n.indexOf("+"),t=n.indexOf("-");r===0&&(r=n.indexOf("+",1)),t===0&&(t=n.indexOf("-",1));const e=n.substring(n.length-1,n.length),i=e==="i"||e==="j";return r>=0||t>=0?i?r>=0?isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?G:Number(n.substring(0,r)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?G:Number(n.substring(0,t)):G:i?isNaN(n.substring(0,n.length-1))?G:0:isNaN(n)?G:n}function Xs(n){if(n===!0||n===!1)return O;const r=Nn(n),t=An(n);return z(r,t)?O:Ar("1",fe(n))}function Ks(n){const r=Nn(n),t=An(n);return z(r,t)?O:Ar("1",Ao(n))}function se(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,e)}function No(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);return e=e==="i"||e==="j"?e:"i",Hn(Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,e)}function Zs(n){const r=Nn(n),t=An(n);if(z(r,t))return O;let e=n.substring(n.length-1);e=e==="i"||e==="j"?e:"i";const i=Math.sqrt(ft(n)),c=st(n);return Hn(i*Math.cos(c/2),i*Math.sin(c/2),e)}function Qs(n){if(n===!0||n===!1)return O;const r=Nn(n),t=An(n);return z(r,t)?G:Ar("1",se(n))}function Js(n){if(n===!0||n===!1)return O;const r=Nn(n),t=An(n);return z(r,t)?G:Ar("1",No(n))}function Ss(n,r){const t=Nn(n),e=An(n),i=Nn(r),c=An(r);if(z(t,e,i,c))return O;const a=n.substring(n.length-1),g=r.substring(r.length-1);let h="i";return(a==="j"||g==="j")&&(h="j"),Hn(t-i,e-c,h)}function xs(){if(!arguments.length)return O;const n=W(arguments);let r=0,t=0;for(const e of n){const i=+Nn(e),c=+An(e);if(z(i,c))return O;r+=i,t+=c}return Hn(r,t,"i")}function bs(n){if(n===!0||n===!1)return O;const r=Nn(n),t=An(n);return z(r,t)?O:Ar(se(n),fe(n))}function _s(n,r){if(!/^[0-7]{1,10}$/.test(n))return G;const t=n.length===10&&n.substring(0,1)==="7",e=t?parseInt(n,8)-1073741824:parseInt(n,8);if(e<-512||e>511)return G;if(t)return"1"+Zn("0",9-(512+e).toString(2).length)+(512+e).toString(2);const i=e.toString(2);return typeof r>"u"?i:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=i.length?Zn("0",r-i.length)+i:G)}function js(n){if(!/^[0-7]{1,10}$/.test(n))return G;const r=parseInt(n,8);return r>=536870912?r-1073741824:r}function nl(n,r){if(!/^[0-7]{1,10}$/.test(n))return G;const t=parseInt(n,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);const e=t.toString(16);return r===void 0?e:isNaN(r)?O:r<0?G:(r=Math.floor(r),r>=e.length?Zn("0",r-e.length)+e:G)}const rl=qr.DIST,el=qr.INV,tl=mr.DIST,ol=lr.MATH,il=lr.PRECISE,ul=_n.DIST,fl=_n.DIST.RT,sl=_n.INV,ll=_n.INV.RT,cl=_n.TEST,al=Cr.P,hl=Cr.P,gl=Cr.S,vl=mr.INV,dl=wo.PRECISE,pl=Eo.PRECISE,El=xe.DIST,wl=jn.DIST,Al=jn.DIST.RT,Nl=jn.INV,Il=jn.INV.RT,Tl=pr.MATH,Rl=pr.PRECISE,Ml=jn.TEST,ml=Vr.DIST,Cl=Vr.INV,Ol=be.PRECISE,Dl=_e.DIST,yl=Or.INV,Ll=Or.DIST,Pl=Or.INV,Fl=vr.MULT,ql=vr.SNGL,Vl=nt.DIST,Ul=ie.INTL,$l=nr.DIST,kl=nr.INV,Gl=nr.S.DIST,Hl=nr.S.INV,Yl=Kn.EXC,Bl=Kn.INC,zl=Ur.EXC,Wl=Ur.INC,Xl=rt.DIST,Kl=dr.EXC,Zl=dr.INC,Ql=$r.AVG,Jl=$r.EQ,Sl=et.P,xl=Bn.P,bl=Bn.S,_l=zn.DIST,jl=zn.DIST.RT,n0=zn.INV,r0=zn.TEST,e0=Yn.P,t0=Yn.S,o0=tt.DIST,i0=ue.INTL,u0=ot.TEST;function lt(n){const r=[];return Gn(n,t=>{t&&r.push(t)}),r}function xn(n,r){const t={};for(let c=1;c<n[0].length;++c)t[c]=!0;let e=r[0].length;for(let c=1;c<r.length;++c)r[c].length>e&&(e=r[c].length);for(let c=1;c<n.length;++c)for(let a=1;a<n[c].length;++a){let g=!1,h=!1;for(let f=0;f<r.length;++f){const o=r[f];if(o.length<e)continue;const u=o[0];if(n[c][0]===u){h=!0;for(let s=1;s<o.length;++s)if(!g)if(o[s]===void 0||o[s]==="*")g=!0;else{const v=Rr(o[s]+""),d=[er(n[c][a],ar)].concat(v);g=Mr(d)}}}h&&(t[a]=t[a]&&g)}const i=[];for(let c=0;c<n[0].length;++c)t[c]&&i.push(c-1);return i}function f0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);let c=0;return Gn(e,a=>{c+=i[a]}),e.length===0?kn:c/e.length}function s0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);const c=[];return Gn(e,a=>{c.push(i[a])}),Pr(c)}function l0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);const c=[];return Gn(e,a=>{c.push(i[a])}),Fr(c)}function c0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const c=Sn(n,r);i=Rn(n[c])}else i=Rn(n[r]);return e.length===0?O:e.length>1?G:i[e[0]]}function a0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);let c=i[e[0]];return Gn(e,a=>{c<i[a]&&(c=i[a])}),c}function h0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);let c=i[e[0]];return Gn(e,a=>{c>i[a]&&(c=i[a])}),c}function g0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const g=Sn(n,r);i=Rn(n[g])}else i=Rn(n[r]);let c=[];Gn(e,g=>{c.push(i[g])}),c=lt(c);let a=1;return Gn(c,g=>{a*=g}),a}function v0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);let c=[];return Gn(e,a=>{c.push(i[a])}),c=lt(c),Bn.S(c)}function d0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);let c=[];return Gn(e,a=>{c.push(i[a])}),c=lt(c),Bn.P(c)}function p0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);const c=[];return Gn(e,a=>{c.push(i[a])}),ir(c)}function E0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);const c=[];return Gn(e,a=>{c.push(i[a])}),Yn.S(c)}function w0(n,r,t){if(isNaN(r)&&typeof r!="string")return O;const e=xn(n,t);let i=[];if(typeof r=="string"){const a=Sn(n,r);i=Rn(n[a])}else i=Rn(n[r]);const c=[];return Gn(e,a=>{c.push(i[a])}),Yn.P(c)}function ve(n){return n&&n.getTime&&!isNaN(n.getTime())}function de(n){return n instanceof Date?n:new Date(n)}function A0(n,r,t){let e=gn(r);for(e.setFullYear(n.getFullYear()),e<n&&e.setFullYear(e.getFullYear()+1);e>n;)e.setMonth(e.getMonth()+-12/t);return e}function Io(n){return n=T(n),[1,2,4].indexOf(n)===-1?G:n}function To(n){return n=T(n),[0,1,2,3,4].indexOf(n)===-1?G:n}function N0(n,r,t,e,i,c,a){return n=de(n),r=de(r),t=de(t),c=Io(c),a=To(a),ln(c,a)?G:!ve(n)||!ve(r)||!ve(t)?O:e<=0||i<=0||t<=n?G:(i=i||0,a=a||0,i*e*it(n,t,a))}function I0(n,r,t,e){if(e=To(e),t=Io(t),n=gn(n),r=gn(r),ln(n,r))return O;if(ln(t,e)||n>=r)return G;if(e===1){let c=A0(n,r,t),a=gn(c);return a.setMonth(a.getMonth()+12/t),sr(c,a,"D")}let i;switch(e){case 0:case 2:case 4:i=360;break;case 3:i=365;break;default:return G}return i/t}function T0(n,r,t,e,i,c){if(n=T(n),r=T(r),t=T(t),z(n,r,t))return O;if(n<=0||r<=0||t<=0||e<1||i<1||e>i||c!==0&&c!==1)return G;const a=kr(n,r,t,0,c);let g=0;e===1&&(c===0&&(g=-t),e++);for(let h=e;h<=i;h++)g+=c===1?Er(n,h-2,a,t,1)-a:Er(n,h-1,a,t,0);return g*=n,g}function R0(n,r,t,e,i,c){if(n=T(n),r=T(r),t=T(t),z(n,r,t))return O;if(n<=0||r<=0||t<=0||e<1||i<1||e>i||c!==0&&c!==1)return G;const a=kr(n,r,t,0,c);let g=0;e===1&&(g=c===0?a+t*n:a,e++);for(let h=e;h<=i;h++)g+=c>0?a-(Er(n,h-2,a,t,1)-a)*n:a-Er(n,h-1,a,t,0)*n;return g}function M0(n,r,t,e,i){if(i=i===void 0?12:i,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i))return O;if(n<0||r<0||t<0||e<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i)===-1||e>t)return G;if(r>=n)return 0;const c=(1-Math.pow(r/n,1/t)).toFixed(3),a=n*c*i/12;let g=a,h=0;const f=e===t?t-1:e;for(let o=2;o<=f;o++)h=(n-g)*c,g+=h;return e===1?a:e===t?(n-g)*c:h}function m0(n,r,t,e,i){if(i=i===void 0?2:i,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i))return O;if(n<0||r<0||t<0||e<0||i<=0||e>t)return G;if(r>=n)return 0;let c=0,a=0;for(let g=1;g<=e;g++)a=Math.min((n-c)*(i/t),n-r-c),c+=a;return a}function C0(n,r,t,e,i){if(n=gn(n),r=gn(r),t=T(t),e=T(e),i=T(i),i=i||0,z(n,r,t,e,i))return O;if(t<=0||e<=0)return G;if(n>=r)return O;let c,a;switch(i){case 0:c=360,a=cr(n,r,!1);break;case 1:c=365,a=sr(n,r,"D");break;case 2:c=360,a=sr(n,r,"D");break;case 3:c=365,a=sr(n,r,"D");break;case 4:c=360,a=cr(n,r,!0);break;default:return G}return(e-t)/e*c/a}function O0(n,r){if(n=T(n),r=T(r),z(n,r))return O;if(r<0)return G;if(r>=0&&r<1)return kn;r=parseInt(r,10);let t=parseInt(n,10);t+=n%1*Math.pow(10,Math.ceil(Math.log(r)/Math.LN10))/r;const e=Math.pow(10,Math.ceil(Math.log(r)/Math.LN2)+1);return t=Math.round(t*e)/e,t}function D0(n,r){if(n=T(n),r=T(r),z(n,r))return O;if(r<0)return G;if(r>=0&&r<1)return kn;r=parseInt(r,10);let t=parseInt(n,10);return t+=n%1*Math.pow(10,-Math.ceil(Math.log(r)/Math.LN10))*r,t}function y0(n,r){return n=T(n),r=T(r),z(n,r)?O:n<=0||r<1?G:(r=parseInt(r,10),Math.pow(1+n/r,r)-1)}function Er(n,r,t,e,i){if(e=e||0,i=i||0,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i))return O;let c;if(n===0)c=e+t*r;else{const a=Math.pow(1+n,r);c=i===1?e*a+t*(1+n)*(a-1)/n:e*a+t*(a-1)/n}return-c}function L0(n,r){if(n=T(n),r=x(W(r)),z(n,r))return O;const t=r.length;let e=n;for(let i=0;i<t;i++)e*=1+r[i];return e}function Ro(n,r,t,e,i,c){if(i=i||0,c=c||0,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),c=T(c),z(n,r,t,e,i,c))return O;const a=kr(n,t,e,i,c);return(r===1?c===1?0:-e:c===1?Er(n,r-2,a,e,1)-a:Er(n,r-1,a,e,0))*n}function P0(n,r){if(r=typeof r=="number"?r:typeof r>"u"?.1:T(r),n=W(n).filter(wr),n=x(n),z(n,r))return O;const t=new Float64Array(n.length);let e=!1,i=!1;for(let f=0;f<n.length;f++)t[f]=n[f],t[f]>0&&(e=!0),t[f]<0&&(i=!0);if(!e||!i)return G;const c=f=>{f<=-1&&(f=-.999999999);let o=t[0];const u=1+f;let s=1;for(let l=1;l<t.length;l++)s*=u,o+=t[l]/s;return o},a=new Map,g=function(f){const o=Math.round(f*1e10)/1e10;if(a.has(o))return a.get(o);const u=c(o);return a.set(o,u),u};return function(){let u=r,s=u,l=0;for(;l<1e3;){const I=g(u);if(Math.abs(I)<1e-10)return u;if(l>0&&Math.abs(u-s)<1e-10*10)break;const E=Math.max(1e-4,Math.abs(u*1e-4)),N=(g(u+E)-I)/E;if(Math.abs(N)<1e-10)break;s=u;const R=I/N,C=Math.max(.1,Math.abs(u)*.5);Math.abs(R)>C?u-=Math.sign(R)*C:u-=R,u<=-1&&(u=-.99999999),u>1e3&&(u=1e3),l++}let v=g(u);if(Math.abs(v)<1e-10)return u;let d,p;if(v>0){for(d=u,p=u+.1;g(p)>0&&p<1e3;)p=p*2+.1;if(p>=1e3)return u}else{for(p=u,d=Math.max(-.99999999,u-.1);g(d)<0&&d>-.99999999;)d=Math.max(-.99999999,d-.1);if(d<=-.99999999)return u}let A;for(let I=0;I<1e3;I++){A=(d+p)/2;const E=g(A);if(Math.abs(E)<1e-10||Math.abs(p-d)<1e-10)return A;E*g(d)<0?p=A:d=A}return A}()}function F0(n,r,t,e){return n=T(n),r=T(r),t=T(t),e=T(e),z(n,r,t,e)?O:e*n*(r/t-1)}function q0(n,r,t){if(n=x(W(n)),r=T(r),t=T(t),z(n,r,t))return O;const e=n.length,i=[],c=[];for(let h=0;h<e;h++)n[h]<0?i.push(n[h]):c.push(n[h]);const a=-Be(t,c)*Math.pow(1+t,e-1),g=Be(r,i)*(1+r);return Math.pow(a/g,1/(e-1))-1}function V0(n,r){return n=T(n),r=T(r),z(n,r)?O:n<=0||r<1?G:(r=parseInt(r,10),(Math.pow(n+1,1/r)-1)*r)}function U0(n,r,t,e,i){if(i=i===void 0?0:i,e=e===void 0?0:e,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i))return O;if(n===0)return-(t+e)/r;{const c=r*(1+n*i)-e*n,a=t*n+r*(1+n*i);return Math.log(c/a)/Math.log(1+n)}}function Be(){const n=x(W(arguments));if(n instanceof Error)return n;const r=n[0];let t=0;for(let e=1;e<n.length;e++)t+=n[e]/Math.pow(1+r,e);return t}function $0(n,r,t){return n=T(n),r=T(r),t=T(t),z(n,r,t)?O:n<=0?G:(Math.log(t)-Math.log(r))/Math.log(1+n)}function kr(n,r,t,e,i){if(e=e||0,i=i||0,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i))return O;let c;if(n===0)c=(t+e)/r;else{const a=Math.pow(1+n,r);c=i===1?(e*n/(a-1)+t*n/(1-1/a))/(1+n):e*n/(a-1)+t*n/(1-1/a)}return-c}function k0(n,r,t,e,i,c){return i=i||0,c=c||0,n=T(n),t=T(t),e=T(e),i=T(i),c=T(c),z(n,t,e,i,c)?O:kr(n,t,e,i,c)-Ro(n,r,t,e,i,c)}function G0(n,r,t,e,i){if(n=gn(n),r=gn(r),t=T(t),e=T(e),i=T(i),i=i||0,z(n,r,t,e,i))return O;if(t<=0||e<=0)return G;if(n>=r)return O;let c,a;switch(i){case 0:c=360,a=cr(n,r,!1);break;case 1:c=365,a=sr(n,r,"D");break;case 2:c=360,a=sr(n,r,"D");break;case 3:c=365,a=sr(n,r,"D");break;case 4:c=360,a=cr(n,r,!0);break;default:return G}return e-t*e*a/c}function H0(n,r,t,e,i){return e=e||0,i=i||0,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),z(n,r,t,e,i)?O:n===0?-t*r-e:((1-Math.pow(1+n,r))/n*t*(1+n*i)-e)/Math.pow(1+n,r)}function Y0(n,r,t,e,i,c){if(c=c===void 0?.1:c,e=e===void 0?0:e,i=i===void 0?0:i,n=T(n),r=T(r),t=T(t),e=T(e),i=T(i),c=T(c),z(n,r,t,e,i,c))return O;const a=1e-10,g=100;let h=c;i=i?1:0;for(let f=0;f<g;f++){if(h<=-1)return G;let o,u;if(Math.abs(h)<a?o=t*(1+n*h)+r*(1+h*i)*n+e:(u=Math.pow(1+h,n),o=t*u+r*(1/h+i)*(u-1)+e),Math.abs(o)<a)return h;let s;if(Math.abs(h)<a)s=t*n+r*i*n;else{u=Math.pow(1+h,n);const l=n*Math.pow(1+h,n-1);s=t*l+r*(1/h+i)*l+r*(-1/(h*h))*(u-1)}h-=o/s}return h}function B0(n,r,t){return n=T(n),r=T(r),t=T(t),z(n,r,t)?O:n===0||r===0?G:Math.pow(t/r,1/n)-1}function z0(n,r,t){return n=T(n),r=T(r),t=T(t),z(n,r,t)?O:t===0?G:(n-r)/t}function W0(n,r,t,e){return n=T(n),r=T(r),t=T(t),e=T(e),z(n,r,t,e)?O:t===0||e<1||e>t?G:(e=parseInt(e,10),(n-r)*(t-e+1)*2/(t*(t+1)))}function X0(n,r,t){return n=gn(n),r=gn(r),t=T(t),z(n,r,t)?O:t<=0||n>r||r-n>365*24*60*60*1e3?G:365*t/(360-t*cr(n,r,!1))}function K0(n,r,t){return n=gn(n),r=gn(r),t=T(t),z(n,r,t)?O:t<=0||n>r||r-n>365*24*60*60*1e3?G:100*(1-t*cr(n,r,!1)/360)}function Z0(n,r,t){return n=gn(n),r=gn(r),t=T(t),z(n,r,t)?O:t<=0||n>r||r-n>365*24*60*60*1e3?G:(100-t)*360/(t*cr(n,r,!1))}function Q0(n,r,t){if(n=x(W(n)),r=Jt(W(r)),t=T(t),z(n,r,t))return O;const e=(l,v,d)=>{const p=d+1;let A=l[0];for(let I=1;I<l.length;I++)A+=l[I]/Math.pow(p,hr(v[I],v[0])/365);return A},i=(l,v,d)=>{const p=d+1;let A=0;for(let I=1;I<l.length;I++){const E=hr(v[I],v[0])/365;A-=E*l[I]/Math.pow(p,E+1)}return A};let c=!1,a=!1;for(let l=0;l<n.length;l++)n[l]>0&&(c=!0),n[l]<0&&(a=!0);if(!c||!a)return G;t=t||.1;let g=t;const h=1e-10;let f,o,u,s=!0;do u=e(n,r,g),f=g-u/i(n,r,g),o=Math.abs(f-g),g=f,s=o>h&&Math.abs(u)>h;while(s);return g}function J0(n,r,t){if(n=T(n),r=x(W(r)),t=Jt(W(t)),z(n,r,t))return O;let e=0;for(let i=0;i<r.length;i++)e+=r[i]/Math.pow(1+n,hr(t[i],t[0])/365);return e}function S0(){const n=W(arguments);let r=O;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(r===O&&(r=!0),n[t]||(r=!1))}return r}function x0(){return!1}function b0(n,r,t){return n instanceof Error?n:(r=arguments.length>=2?r:!0,r==null&&(r=0),t=arguments.length===3?t:!1,t==null&&(t=0),n?r:t)}function _0(){for(let n=0;n<arguments.length/2;n++)if(arguments[n*2])return arguments[n*2+1];return nn}function j0(n,r){return te(n)?r:n}function nc(n,r){return n===nn?r:n}function rc(n){return typeof n=="string"?O:n instanceof Error?n:!n}function ec(){const n=W(arguments);let r=O;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(r===O&&(r=!1),n[t]&&(r=!0))}return r}function tc(){return!0}function oc(){const n=W(arguments);let r=O;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(r===O&&(r=0),n[t]&&r++)}return r===O?r:!!(Math.floor(Math.abs(r))&1)}function ic(){let n;if(arguments.length>0){const r=arguments[0],t=arguments.length-1,e=Math.floor(t/2);let i=!1;const c=t%2!==0,a=t%2===0?null:arguments[arguments.length-1];if(e){for(let g=0;g<e;g++)if(r===arguments[g*2+1]){n=arguments[g*2+2],i=!0;break}}i||(n=c?a:nn)}else n=O;return n}const uc={errors:Zo,symbols:xf,date:So},fc=Object.freeze(Object.defineProperty({__proto__:null,ABS:Du,ACCRINT:N0,ACOS:yu,ACOSH:Lu,ACOT:Pu,ACOTH:Fu,AGGREGATE:qu,AND:S0,ARABIC:Vu,ASIN:Uu,ASINH:$u,ATAN:ku,ATAN2:Gu,ATANH:Hu,AVEDEV:Ji,AVERAGE:gr,AVERAGEA:Je,AVERAGEIF:Si,AVERAGEIFS:xi,BASE:Yu,BESSELI:ds,BESSELJ:ps,BESSELK:Es,BESSELY:ws,BETA:qr,BETADIST:rl,BETAINV:el,BIN2DEC:As,BIN2HEX:Ns,BIN2OCT:Is,BINOM:mr,BINOMDIST:tl,BITAND:Ts,BITLSHIFT:Rs,BITOR:Ms,BITRSHIFT:ms,BITXOR:Cs,CEILING:lr,CEILINGMATH:ol,CEILINGPRECISE:il,CHAR:no,CHIDIST:ul,CHIDISTRT:fl,CHIINV:sl,CHIINVRT:ll,CHISQ:_n,CHITEST:cl,CHOOSE:di,CLEAN:mi,CODE:ro,COLUMN:pi,COLUMNS:Ei,COMBIN:Ir,COMBINA:Bu,COMPLEX:Hn,CONCAT:Ci,CONCATENATE:eo,CONFIDENCE:Se,CONVERT:Os,CORREL:bi,COS:zu,COSH:Wu,COT:Xu,COTH:Ku,COUNT:Pr,COUNTA:Fr,COUNTBLANK:oo,COUNTIF:_i,COUNTIFS:ji,COUPDAYS:I0,COVAR:al,COVARIANCE:Cr,COVARIANCEP:hl,COVARIANCES:gl,CRITBINOM:vl,CSC:Zu,CSCH:Qu,CUMIPMT:T0,CUMPRINC:R0,DATE:jf,DATEDIF:sr,DATEVALUE:ns,DAVERAGE:f0,DAY:rs,DAYS:hr,DAYS360:cr,DB:M0,DCOUNT:s0,DCOUNTA:l0,DDB:m0,DEC2BIN:Ds,DEC2HEX:ys,DEC2OCT:Ls,DECIMAL:Ju,DEGREES:Su,DELTA:Ps,DEVSQ:nu,DGET:c0,DISC:C0,DMAX:a0,DMIN:h0,DOLLAR:Oi,DOLLARDE:O0,DOLLARFR:D0,DPRODUCT:g0,DSTDEV:v0,DSTDEVP:d0,DSUM:p0,DVAR:E0,DVARP:w0,EDATE:es,EFFECT:y0,EOMONTH:ts,ERF:Eo,ERFC:wo,ERFCPRECISE:dl,ERFPRECISE:pl,ERROR:St,EVEN:xu,EXACT:Di,EXP:bu,EXPON:xe,EXPONDIST:El,F:jn,FACT:tr,FACTDOUBLE:ho,FALSE:x0,FDIST:wl,FDISTRT:Al,FIND:yi,FINV:Nl,FINVRT:Il,FISHER:ru,FISHERINV:eu,FIXED:to,FLOOR:pr,FLOORMATH:Tl,FLOORPRECISE:Rl,FORECAST:io,FREQUENCY:tu,FTEST:Ml,FV:Er,FVSCHEDULE:L0,GAMMA:Vr,GAMMADIST:ml,GAMMAINV:Cl,GAMMALN:be,GAMMALNPRECISE:Ol,GAUSS:ou,GCD:_u,GEOMEAN:iu,GESTEP:Fs,GROWTH:uu,HARMEAN:fu,HEX2BIN:qs,HEX2DEC:Vs,HEX2OCT:Us,HLOOKUP:wi,HOUR:os,HYPGEOM:_e,HYPGEOMDIST:Dl,IF:b0,IFERROR:j0,IFNA:nc,IFS:_0,IMABS:ft,IMAGINARY:An,IMARGUMENT:st,IMCONJUGATE:$s,IMCOS:fe,IMCOSH:Ao,IMCOT:ks,IMCSC:Qs,IMCSCH:Js,IMDIV:Ar,IMEXP:Gs,IMLN:Hs,IMLOG10:Ys,IMLOG2:Bs,IMPOWER:zs,IMPRODUCT:Ws,IMREAL:Nn,IMSEC:Xs,IMSECH:Ks,IMSIN:se,IMSINH:No,IMSQRT:Zs,IMSUB:Ss,IMSUM:xs,IMTAN:bs,INDEX:Ai,INT:ju,INTERCEPT:su,IPMT:Ro,IRR:P0,ISBLANK:fi,ISERR:xt,ISERROR:te,ISEVEN:si,ISLOGICAL:bt,ISNA:li,ISNONTEXT:ci,ISNUMBER:oe,ISO:nf,ISODD:ai,ISOWEEKNUM:po,ISPMT:F0,ISTEXT:_t,KURT:lu,LARGE:uo,LCM:rf,LEFT:Li,LEN:Pi,LINEST:je,LN:ef,LOG:tf,LOG10:of,LOGEST:cu,LOGINV:yl,LOGNORM:Or,LOGNORMDIST:Ll,LOGNORMINV:Pl,LOOKUP:Ni,LOWER:Fi,MATCH:Ii,MAX:Zr,MAXA:au,MAXIFS:hu,MEDIAN:fo,MID:qi,MIN:Qr,MINA:gu,MINIFS:vu,MINUTE:is,MIRR:q0,MMULT:uf,MOD:ff,MODE:vr,MODEMULT:Fl,MODESNGL:ql,MONTH:us,MROUND:sf,MULTINOMIAL:lf,MUNIT:cf,N:hi,NA:gi,NEGBINOM:nt,NEGBINOMDIST:Vl,NETWORKDAYS:ie,NETWORKDAYSINTL:Ul,NOMINAL:V0,NORM:nr,NORMDIST:$l,NORMINV:kl,NORMSDIST:Gl,NORMSINV:Hl,NOT:rc,NOW:fs,NPER:U0,NPV:Be,NUMBERVALUE:Vi,OCT2BIN:_s,OCT2DEC:js,OCT2HEX:nl,ODD:af,OR:ec,PDURATION:$0,PEARSON:so,PERCENTILE:Kn,PERCENTILEEXC:Yl,PERCENTILEINC:Bl,PERCENTRANK:Ur,PERCENTRANKEXC:zl,PERCENTRANKINC:Wl,PERMUT:du,PERMUTATIONA:pu,PHI:Eu,PI:hf,PMT:kr,POISSON:rt,POISSONDIST:Xl,POWER:go,PPMT:k0,PRICEDISC:G0,PROB:wu,PRODUCT:Jr,PROPER:Ui,PV:H0,QUARTILE:dr,QUARTILEEXC:Kl,QUARTILEINC:Zl,QUOTIENT:gf,RADIANS:vf,RAND:df,RANDBETWEEN:pf,RANK:$r,RANKAVG:Ql,RANKEQ:Jl,RATE:Y0,REPLACE:$i,REPT:Zn,RIGHT:ki,ROMAN:Ef,ROUND:vo,ROUNDDOWN:wf,ROUNDUP:Af,ROW:Au,ROWS:Ti,RRI:B0,RSQ:Nu,SEARCH:Gi,SEC:Nf,SECH:If,SECOND:ss,SERIESSUM:Tf,SIGN:Rf,SIN:Mf,SINH:mf,SKEW:et,SKEWP:Sl,SLN:z0,SLOPE:Iu,SMALL:lo,SORT:Ri,SQRT:Cf,SQRTPI:Of,STANDARDIZE:Tu,STDEV:Bn,STDEVA:Ru,STDEVP:xl,STDEVPA:Mu,STDEVS:bl,STEYX:mu,SUBSTITUTE:Hi,SUBTOTAL:Df,SUM:ir,SUMIF:yf,SUMIFS:Lf,SUMPRODUCT:Pf,SUMSQ:Ff,SUMX2MY2:qf,SUMX2PY2:Vf,SUMXMY2:Uf,SWITCH:ic,SYD:W0,T:zn,TAN:$f,TANH:kf,TBILLEQ:X0,TBILLPRICE:K0,TBILLYIELD:Z0,TDIST:_l,TDISTRT:jl,TEXT:Yi,TEXTJOIN:Bi,TIME:ls,TIMEVALUE:cs,TINV:n0,TODAY:as,TRANSPOSE:Mi,TREND:Cu,TRIM:zi,TRIMMEAN:Ou,TRUE:tc,TRUNC:Gf,TTEST:r0,TYPE:vi,UNICHAR:Wi,UNICODE:Xi,UNIQUE:Qe,UPPER:Ki,VALUE:Zi,VAR:Yn,VARA:co,VARP:e0,VARPA:ao,VARS:t0,VLOOKUP:jt,WEEKDAY:hs,WEEKNUM:gs,WEIBULL:tt,WEIBULLDIST:o0,WORKDAY:ue,WORKDAYINTL:i0,XIRR:Q0,XNPV:J0,XOR:oc,YEAR:vs,YEARFRAC:it,Z:ot,ZTEST:u0,utils:uc},Symbol.toStringTag,{value:"Module"}));var pe,vt;function le(){return vt||(vt=1,pe=function(r){for(var t=r+1,e="",i,c=10;t>0&&c--;)i=(t-1)%26,e=String.fromCharCode(i+65)+e,t=(t-i-1)/26;return e}),pe}var Ee,dt;function ce(){return dt||(dt=1,Ee=function(r){for(var t=0,e=r.replace(/[0-9]+$/,""),i=e.length;i--;)t+=Math.pow(26,e.length-i-1)*(e.charCodeAt(i)-64);return t-1}),Ee}var we,pt;function Gr(){return pt||(pt=1,we=function(r){this.setValue=function(t){r=t},this.calc=function(){return r}}),we}var Ae,Et;function Mo(){return Et||(Et=1,Ae=function(r){var t=r.match(/^'(.*)'$/);return t?t[1]:r}),Ae}var Ne,wt;function ct(){if(wt)return Ne;wt=1;const n=ce(),r=le(),t=Mo();return Ne=function(i,c){this.parse=function(){var a,g,h;if(i.indexOf("!")!=-1){var f=i.split("!");g=t(f[0]),a=f[1]}else g=c.sheet_name,a=i;h=c.wb.Sheets[g];var o=a.split(":"),u=parseInt(o[0].replace(/^[A-Z]+/,""),10)||0,s=o[1].replace(/^[A-Z]+/,""),l;s===""&&h["!ref"]&&(s=(h["!ref"].includes(":")?h["!ref"].split(":")[1]:h["!ref"]).replace(/^[A-Z]+/,"")),l=parseInt(s==""?"500000":s,10);var v=n(o[0]),d=n(o[1]);return{sheet_name:g,sheet:h,min_row:u,min_col:v,max_row:l,max_col:d}},this.calc=function(){for(var a=this.parse(),g=a.sheet_name,h=a.sheet,f=a.min_row,o=a.min_col,u=a.max_row,s=a.max_col,l=[],v=f;v<=u;v++){var d=[];l.push(d);for(var p=o;p<=s;p++){var A=r(p)+v,I=g+"!"+A,E=c.formula_ref[I];if(E){if(E.status==="new")c.exec_formula(E);else if(E.status==="working"){if(E.cell.f.includes(c.name))throw new Error("Circular ref");c.exec_formula(E)}h[A].t==="e"?d.push(new Error(h[A].w)):d.push(h[A].v)}else h[A]?h[A].t==="e"?d.push(new Error(h[A].w)):d.push(h[A].v):d.push(null)}}return l}},Ne}var Ie,At;function mo(){if(At)return Ie;At=1;const n=Mo();return Ie=function(t,e){var i=this;this.name="RefValue",this.str_expression=t,this.formula=e,i.parseRef=function(){var c,a,g,h;if(t.indexOf("!")!=-1){var f=t.split("!");a=n(f[0]),c=e.wb.Sheets[a],g=f[1]}else c=e.sheet,a=e.sheet_name,g=t;if(!c)throw Error("Sheet "+a+" not found.");return h=a+"!"+g,{sheet:c,sheet_name:a,cell_name:g,cell_full_name:h}},this.calc=function(){var c=i.parseRef(),a=c.sheet,g=c.cell_name,h=c.cell_full_name,f=a[g];if(!f)return null;var o=e.formula_ref[h];if(o){if(o.status==="new"){if(e.exec_formula(o),f.t==="e")throw console.log("ref is an error with new formula",h,f.w),new Error(f.w);return f.v}else if(o.status==="working"){if(f.f.includes(e.name))throw new Error("Circular ref");return e.exec_formula(o),this.calc()}else if(o.status==="done"){if(f.t==="e")throw console.log("ref is an error after formula eval",h,f.w),new Error(f.w);return f.v}}else{if(f.t==="e")throw console.log("ref is an error with no formula",g),new Error(f.w);return f.v}}},Ie}var Te,Nt;function sc(){return Nt||(Nt=1,Te=function(r){this.calc=function(){return r()}}),Te}var Re,It;function Co(){if(It)return Re;It=1;const n=Gr(),r=mo(),t=sc(),e=ct();let i,c;function a(g,h){if(!(h.wb.Workbook&&h.wb.Workbook.Names))return null;if(c!==h.wb)return c=h.wb,i=null,a(g,h);if(i)return i[g];const f=Object.values(h.wb.Workbook.Names);if(f.length!==0)return i={},f.forEach(({Name:o,Ref:u})=>{o.includes(".")||(i[o]=u)}),a(g,h)}return Re=function g(h,f){if(!isNaN(h))return new n(+h);if(h==="TRUE")return new n(1);if(h==="FALSE")return new n(0);if(typeof h!="string")return h;if(h=h.trim().replace(/\$/g,""),h.match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new e(h,f);if(h.match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new e(h,f);if(h.match(/^[A-Z]+:[A-Z]+$/))return new e(h,f);if(h.match(/^[^!]+![A-Z]+:[A-Z]+$/))return new e(h,f);if(h.match(/^[A-Z]+[0-9]+$/))return new r(h,f);if(h.match(/^[^!]+![A-Z]+[0-9]+$/))return new r(h,f);if(h.match(/%$/)){var o=g(h.substr(0,h.length-1),f);return new t(()=>o.calc()/100)}return a(h,f)?g(a(h,f),f):h},Re}var Me,Tt;function Hr(){if(Tt)return Me;Tt=1;const n=new Error("#NULL!"),r=new Error("#DIV/0!"),t=new Error("#VALUE!"),e=new Error("#REF!"),i=new Error("#NAME?"),c=new Error("#NUM!"),a=new Error("#N/A"),g=new Error("#ERROR!"),h=new Error("#GETTING_DATA"),f=new Error("#CALC!"),o={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#CALC!":0};function u(s){return o[s]}return Me={nil:n,div0:r,value:t,ref:e,name:i,num:c,na:a,error:g,data:h,calc:f,getErrorValueByMessage:u},Me}var me,Rt;function Oo(){if(Rt)return me;Rt=1;const n=Hr();return me=function(t){return function(){for(var e=!1,i=[],c=[],a=[],g=0,h=arguments.length;g<h;g++){var f=arguments[g],o=Array.isArray(f);o&&(e=!0);var u=o?f.map(C=>Array.isArray(C)?C:[C]):[[f]];i[g]=u,c[g]=u.length,a[g]=u[0].length}for(var s=Math.max.apply(null,c),l=Math.max.apply(null,a),v=[],d=0;d<s;d++){v[d]=[];for(var p=0;p<l;p++){for(var A=!1,I=[],g=0,h=i.length;g<h;g++){var E=i[g],N=c[g]===1?0:d,R=a[g]===1?0:p;if(N in E)if(E=E[N],R in E)E=E[R];else{A=!0;break}else{A=!0;break}I[g]=E}v[d][p]=A?n.na:t.apply(null,I)}}return e?v:v[0][0]}},me}var Ce,Mt;function lc(){if(Mt)return Ce;Mt=1;const n=Gr();ct();const r=Co(),t=24*60*60*1e3,e=ce(),i=le(),c=Oo(),{getErrorValueByMessage:a}=Hr();var g=0;function h(f){return Array.isArray(f)&&(f.length===0||Array.isArray(f[0]))}return Ce=function(o){var u=this;u.id=++g,u.args=[],u.name="Expression",u.update_cell_value=s,u.formula=o;function s(){try{if(o.cell.v=u.calc(),o.cell.t=d(o.cell.v),h(o.cell.v)){const D=o.cell.v;o.cell.v=void 0;let F=o.name.match(/([A-Z]+)([0-9]+)/),Y=e(F[1]),Q=+F[2];for(let j=0;j<D.length;j++){const rn=Q+j;for(let hn=0;hn<D[j].length;hn++){const In=D[j][hn],Mn=hn+Y,cn=i(Mn)+rn;let un=o.sheet[cn];un||(un={},o.sheet[cn]=un),v(un,In)}}}}catch(D){if(!l(o.cell,D))throw D}finally{o.status="done"}}function l(D,M){const F=M||{};D.t="e";const Y=a(F.message);return Y!==void 0?(D.w=F.message,D.v=Y,!0):!1}function v(D,M){if(M instanceof Error)l(D,M);else{const F=d(M);D.v=M,F&&(D.t=F)}}function d(D){if(typeof D=="string")return"s";if(typeof D=="number")return"n";if(D instanceof Error)return"e"}function p(D){return D==null||D===""}function A(D){if(typeof D.calc!="function")throw new Error("Undefined "+D)}function I(D,M,F){for(var Y=0;Y<M.length;Y++)if(M[Y]===D)try{if(Y===0&&D==="+"){A(M[Y+1]);let Q=M[Y+1].calc();M.splice(Y,2,new n(Q))}else{A(M[Y-1]),A(M[Y+1]);let Q=M[Y-1].calc(),j=M[Y+1].calc();if(Q instanceof Error)throw Q;if(j instanceof Error)throw j;let rn=F(Q,j);M.splice(Y-1,3,new n(rn)),Y--}}catch(Q){throw Q}}function E(D){return Array.isArray(D)?D.map(E):-D}function N(D){for(var M=D.length;M--;)if(D[M]==="-"){A(D[M+1]);var F=D[M+1].calc();if(M>0&&typeof D[M-1]!="string"){if(D.splice(M,1,"+"),F instanceof Date){F=Date.parse(F),A(D[M-1]);var Y=D[M-1].calc();Y instanceof Date&&(Y=Date.parse(Y)/t,F=F/t,D.splice(M-1,1,new n(Y)))}D.splice(M+1,1,new n(E(F)))}else{if(typeof F=="string")throw new Error("#VALUE!");D.splice(M,2,new n(E(F)))}}}function R(D,M){for(var F=0;F<D.length-2;F++)if(D[F]==="^"&&D[F+1]==="-")try{A(D[F-1]),A(D[F+2]);let Y=D[F-1].calc(),Q=D[F+2].calc();Array.isArray(Y)&&(Y=Y[getCurrentCellIndex()-1][0]),Array.isArray(Q)&&(Q=Q[getCurrentCellIndex()-1][0]);let j=M(Y,Q);D.splice(F-1,4,new n(j)),F--}catch(Y){throw Y}}u.calc=function(){let D=u.args.concat();if(R(D,function(M,F){return Math.pow(+M,0-F)}),I("^",D,c(function(M,F){return Math.pow(+M,+F)})),N(D),I("/",D,c(function(M,F){if(F==0)throw Error("#DIV/0!");return+M/+F})),I("*",D,c(function(M,F){return+M*+F})),I("+",D,c(function(M,F){return M instanceof Date&&typeof F=="number"&&(F=F*t),+M+ +F})),I("&",D,c(function(M,F){var Y="";return M!==null&&(Y+=M),F!==null&&(Y+=F),Y})),I("<",D,c(function(M,F){return M<F})),I(">",D,c(function(M,F){return M>F})),I(">=",D,c(function(M,F){return M>=F})),I("<=",D,c(function(M,F){return M<=F})),I("<>",D,c(function(M,F){return M instanceof Date&&F instanceof Date?M.getTime()!==F.getTime():p(M)&&p(F)?!1:M!==F})),I("=",D,c(function(M,F){return M instanceof Date&&F instanceof Date?M.getTime()===F.getTime():p(M)&&p(F)||M==null&&F===0||M===0&&F==null||typeof M=="string"&&typeof F=="string"&&M.toLowerCase()===F.toLowerCase()?!0:M===F})),D.length==1)return typeof D[0].calc!="function"?D[0]:D[0].calc()};var C;u.push=function(D){if(D){var M=r(D,o);M==="="&&(C==">"||C=="<")||C=="<"&&M===">"?u.args[u.args.length-1]+=M:u.args.push(M),C=M}}},Ce}var Oe,mt;function cc(){if(mt)return Oe;mt=1;const{getErrorValueByMessage:n}=Hr();return Oe=function(t){var e=this;e.name="UserFn",e.args=[],e.calc=function(){var i;try{if(i=t.apply(e,e.args.map(c=>c.calc())),i instanceof Error)throw i}catch(c){const a=n(c.message);if(t.name==="is_blank"&&a!==void 0)i=0;else if(t.name==="iserror"&&a!==void 0)i=!0;else throw c}return i},e.push=function(i){e.args.push(i)}},Oe}var De,Ct;function ac(){return Ct||(Ct=1,De=function(r,t){var e=this;e.name="UserRawFn",e.args=[],e.calc=function(){try{return r.apply(e,e.args)}catch(i){throw i}},e.push=function(i){e.args.push(i)}}),De}var ye,Ot;function hc(){if(Ot)return ye;Ot=1;const n=lc(),r=Gr(),t=cc(),e=ac(),i={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};return ye=function(a,g){a.status="working";var h=g.xlsx_Fx||{},f=g.xlsx_raw_Fx||{},o,u=a.cell.f;u[0]=="="&&(u=u.substr(1));var s=o=new n(a),l="",v=!1,d=[{exp:s}];function p(M){M==='"'?(s.push(new r(l)),v=!0,l="",C=R):l+=M}function A(M){M==="'"&&(C=R),l+=M}function I(){var M,F=l.trim(),Y=h[F],Q=f[F];if(Q)Y=new e(Q,a);else if(Y)Y=new t(Y,a);else if(F)throw new Error('"'+a.sheet_name+'"!'+a.name+": Function "+l+" not found");M=new n(a),d.push({exp:M,special:Y}),s=M,l=""}function E(){var M,F=d.pop();s=F.exp,s.push(l),M=s,l="",s=d[d.length-1].exp,F.special?(F.special.push(M),s.push(F.special)):s.push(M)}function N(M){v||s.push(l),v=!1,s.push(M),l=""}function R(M){M==='"'?(C=p,l=""):M==="'"?(C=A,l="'"):M==="("?I():M===")"?E():i[M]?N(M):M===","&&d[d.length-1].special?(v=!1,d[d.length-1].exp.push(l),d[d.length-1].special.push(d[d.length-1].exp),d[d.length-1].exp=s=new n(a),l=""):M!==" "&&(l+=M)}for(var C=R,D=0;D<u.length;D++)C(u[D]);return o.push(l),o},ye}var Le,Dt;function gc(){if(Dt)return Le;Dt=1;const n=Hr();function r(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const i=e.toUpperCase();if(i==="TRUE")return!0;if(i==="FALSE")return!1}return e instanceof Date&&!isNaN(e)?!0:n.value}function t(e,i,c){if(!e||!i||!c||i<0||c<0||!Array.isArray(e)||!e.length)return e;for(let a=0;a<e.length;a++)if(!(e[a]instanceof Array))return e;for(let a=0;a<e.length;a++)if(e[a].length<i)for(let g=e[a].length;g<i;g++)e[a].push("");if(e.length<c)for(let a=e.length;a<c;a++){e.push([]);for(let g=0;g<i;g++)e[a].push("")}return e}return Le={addEmptyValuesToArray:t,parseBool:r},Le}var Pe,yt;function vc(){if(yt)return Pe;yt=1;const n=gc(),r=Hr();let t={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,"FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:un,MAX:Mn,SUM:In,MIN:cn,CONCATENATE:hn,PMT:rn,COUNTA:j,IRR:Q,"NORM.INV":Y,"_xlfn.NORM.INV":Y,STDEV:F,AVERAGE:M,EXP:D,LN:Math.log,"_xlfn.VAR.P":C,"VAR.P":C,"_xlfn.COVARIANCE.P":N,"COVARIANCE.P":N,TRIM:I,LEN:A,ISBLANK:E,HLOOKUP:p,INDEX:d,MATCH:v,SUMPRODUCT:f,ISNUMBER:h,TODAY:g,ISERROR:Fn,TIME:qn,DAY:Vn,MONTH:$n,YEAR:J,RIGHT:En,LEFT:Tn,IFS:Un,ROUND:a,CORREL:c,SUMIF:i,CHOOSE:e,SUBSTITUTE:P,CEILING:V,FILTER:tn(b),DATEDIF:en,EOMONTH:an};function e(w){return arguments[w]}function i(){let w=arguments[1],m=0;return[].slice.call(arguments)[0][0].forEach((q,$)=>{q!==null&&(q=q.toString(),q.replace(/\'/g,"")===w&&(isNaN([].slice.call(arguments)[2][0][$])||(m+=[].slice.call(arguments)[2][0][$])))}),m}function c(w,m){if(w=R(w),m=R(m),w.length!==m.length)return"N/D";for(var q=1/(w.length-1),$=In.apply(this,w)/w.length,y=In.apply(this,m)/m.length,B=0,_=0,wn=0,dn=0;dn<w.length;dn++)B+=(w[dn]-$)*(m[dn]-y),_+=Math.pow(w[dn],2),wn+=Math.pow(m[dn],2);return _=Math.sqrt(_/q),wn=Math.sqrt(wn/q),B/(q*_*wn)}function a(w,m){if(arguments.length===0)throw new Error("Err:511");if(arguments.length===1)return Math.round(w);let q=Math.pow(10,m);return Math.round(q*w)/q}function g(){var w=new Date;return w.setHours(0,0,0,0),w}function h(w){return!isNaN(w)}function f(){var w=function(Dn){return Dn===void 0||Dn===""||Dn===null||isNaN(Dn)?0:parseFloat(Dn)},m=function(Dn){for(var fn=function(X=[]){return X.length},Z=function(X=[]){return X[0]&&X[0].length},k=fn(Dn[0]),H=Z(Dn[0]),on=1;on<Dn.length;on++)if(fn(Dn[on])!==k||Z(Dn[on])!==H)return!1;return!0};if(!arguments||arguments.length===0||!arguments[0]||!m(arguments))throw Error("#VALUE!");for(var q=0;q<arguments.length;q++){var $=arguments[q];if(Array.isArray($))for(var y=0;y<$.length;y++){var B=$[y];if(Array.isArray(B))for(var sn=0;sn<B.length;sn++){var _=B[sn];if(_ instanceof Error)throw _}else{var _=B;if(_ instanceof Error)throw _}}else{var _=$;if(_ instanceof Error)throw _}}for(var wn=arguments.length+1,dn=0,Cn,sn,rr,bn,q=0;q<arguments[0].length;q++)if(arguments[0][q]instanceof Array)for(var y=0;y<arguments[0][q].length;y++){for(Cn=1,sn=1;sn<wn;sn++)bn=w(arguments[sn-1][q][y]),Cn*=bn;dn+=Cn}else{for(Cn=1,sn=1;sn<wn;sn++)rr=w(arguments[sn-1][q]),Cn*=rr;dn+=Cn}return dn}function o(w,m){for(var q,$,y=0;y<w.length;y++){if(w[y]===m)return y+1;w[y]<m&&($?w[y]>$&&(q=y+1,$=w[y]):(q=y+1,$=w[y]))}if(!q)throw Error("#N/A");return q}function u(w,m){for(var q=0;q<w.length;q++)if(m=m.replace(/\?/g,"."),Array.isArray(w[q])){if(w[q].length===1&&typeof w[q][0]=="string"&&w[q][0].toLowerCase()===m.toLowerCase())return q+1}else if(typeof w[q]=="string"&&w[q].toLowerCase()===m.toLowerCase())return q+1;throw Error("#N/A")}function s(w,m){for(var q=0;q<w.length;q++)if(Array.isArray(w[q])){if(w[q].length===1&&w[q][0]===m)return q+1}else if(w[q]===m)return q+1;throw Error("#N/A")}function l(w,m){for(var q,$,y=0;y<w.length;y++)if(Array.isArray(w[y])&&w[y].length>0){if(w[y][0]===m)return y+1;w[y][0]>m&&($?w[y][0]<$&&(q=y+1,$=w[y][0]):(q=y+1,$=w[y][0]))}else{if(w[y]===m)return y+1;w[y]>m&&($?w[y]<$&&(q=y+1,$=w[y]):(q=y+1,$=w[y]))}if(!q)throw Error("#N/A");return q}function v(w,m,q){if(Array.isArray(m)&&m.length===1&&Array.isArray(m[0])&&(m=m[0]),!w&&!m||(arguments.length===2&&(q=1),!(m instanceof Array)))throw Error("#N/A");if(q===0)return typeof w=="string"?u(m,w):s(m,w);if(q===1)return o(m,w);if(q===-1)return l(m,w);throw Error("#N/A")}function d(w,m,q){if(m<=w.length){var $=w[m-1];if(Array.isArray($))if(q){if(q<=$.length)return $[q-1]}else return $;else return w[m]}throw Error("#REF!")}function p(w,m,q,$){if(typeof w>"u"||E(w))throw Error("#N/A");q=q||0;let y=m[0],B,_;if(typeof w=="string"){for(_=w.toLowerCase(),B=0;B<y.length;B++)if($&&y[B]===_||y[B].toLowerCase().indexOf(_)!==-1)return q<m.length+1?m[q-1][B]:m[0][B]}else for(_=w,B=0;B<y.length;B++)if($&&y[B]===_||y[B]===_)return q<m.length+1?m[q-1][B]:m[0][B];throw Error("#N/A")}function A(w){return(""+w).length}function I(w){return(""+w).trim()}function E(w){return!w}function N(w,m){if(w=R(w),m=R(m),w.length!=m.length)return"N/D";for(var q=1/w.length,$=In.apply(this,w)/w.length,y=In.apply(this,m)/m.length,B=0,_=0;_<w.length;_++)B+=(w[_]-$)*(m[_]-y);return B*q}function R(w){for(var m=[],q=0;q<w.length;q++){var $=w[q];if(Array.isArray($)){for(var y=$,B=y.length;B--;)if(typeof y[B]=="number")m.push(y[B]);else if(Array.isArray(y[B]))for(var _=y[B].length;_--;)typeof y[B][_]=="number"&&m.push(y[B][_])}else typeof $=="number"&&m.push($)}return m}function C(){for(var w=M.apply(this,arguments),m=0,q=0,$=0;$<arguments.length;$++){var y=arguments[$];if(Array.isArray(y))for(var B=y,_=B.length;_--;)for(var wn=B[_].length;wn--;)B[_][wn]!==null&&B[_][wn]!==void 0&&(m+=Math.pow(B[_][wn]-w,2),q++);else m+=Math.pow(y-w,2),q++}return m/q}function D(w){return Math.pow(Math.E,w)}function M(){var w=j.apply(this,arguments);if(w==0)throw Error("#DIV/0!");return In.apply(this,arguments)/w}function F(){var w=R(arguments);function m(y){return y.reduce(function(B,_){return B+_})/y.length}var q=m(w),$=w.map(function(y){return(y-q)*(y-q)});return Math.sqrt($.reduce(function(y,B){return y+B})/(w.length-1))}function Y(w,m,q){if(w<0||w>1)throw"The probality p must be bigger than 0 and smaller than 1";if(q<0)throw"The standard deviation sigma must be positive";if(w==0)return-1/0;if(w==1)return 1/0;if(q==0)return m;var $,y,B;return $=w-.5,Math.abs($)<=.425?(y=.180625-$*$,B=$*(((((((y*2509.0809287301227+33430.57558358813)*y+67265.7709270087)*y+45921.95393154987)*y+13731.69376550946)*y+1971.5909503065513)*y+133.14166789178438)*y+3.3871328727963665)/(((((((y*5226.495278852854+28729.085735721943)*y+39307.89580009271)*y+21213.794301586597)*y+5394.196021424751)*y+687.1870074920579)*y+42.31333070160091)*y+1)):($>0?y=1-w:y=w,y=Math.sqrt(-Math.log(y)),y<=5?(y+=-1.6,B=(((((((y*.0007745450142783414+.022723844989269184)*y+.2417807251774506)*y+1.2704582524523684)*y+3.6478483247632045)*y+5.769497221460691)*y+4.630337846156546)*y+1.4234371107496835)/(((((((y*10507500716444169e-25+.0005475938084995345)*y+.015198666563616457)*y+.14810397642748008)*y+.6897673349851)*y+1.6763848301838038)*y+2.053191626637759)*y+1)):(y+=-5,B=(((((((y*20103343992922881e-23+27115555687434876e-21)*y+.0012426609473880784)*y+.026532189526576124)*y+.29656057182850487)*y+1.7848265399172913)*y+5.463784911164114)*y+6.657904643501103)/(((((((y*20442631033899397e-31+1421511758316446e-22)*y+18463183175100548e-21)*y+.0007868691311456133)*y+.014875361290850615)*y+.1369298809227358)*y+.599832206555888)*y+1)),$<0&&(B=-B)),m+q*B}function Q(w,m){var q=-2,$=1,y=0;do{for(var B=(q+$)/2,_=0,wn=0;wn<w.length;wn++){var dn=w[wn];_+=dn[0]/Math.pow(1+B,wn)}_>0?(q===$&&($+=Math.abs(B)),q=B):$=B,y++}while(Math.abs(_)>1e-6&&y<1e5);return B}function j(){for(var w=0,m=arguments.length;m--;){var q=arguments[m];if(Array.isArray(q))for(var $=q,y=$.length;y--;)for(var B=$[y].length;B--;)$[y][B]!==null&&$[y][B]!==void 0&&w++;else q!=null&&w++}return w}function rn(w,m,q,$,y){if(y=y||0,$=$||0,w!=0){var B=Math.pow(1+w,m);return-(w*($+B*q))/((-1+B)*(1+w*y))}else if(m!=0)return-($+q)/m;return 0}function hn(){for(var w="",m=0;m<arguments.length;m++){var q=arguments[m];q!=null&&(w+=q)}return w}function In(){for(var w=0,m=arguments.length;m--;){var q=arguments[m];if(Array.isArray(q))for(var $=q,y=$.length;y--;)for(var B=$[y].length;B--;)isNaN($[y][B])||(w+=+$[y][B]);else w+=+q}return w}function Mn(){for(var w=null,m=arguments.length;m--;){var q=arguments[m];if(Array.isArray(q))for(var $=q,y=$.length;y--;){var B=$[y];if(Array.isArray(B))for(var _=B.length;_--;)(w==null||B[_]!=null&&w<B[_])&&(w=B[_]);else(w==null||B!=null&&w<B)&&(w=B)}else!isNaN(q)&&(w==null||q!=null&&w<q)&&(w=q)}return w}function cn(){for(var w=null,m=arguments.length;m--;){var q=arguments[m];if(Array.isArray(q))for(var $=q,y=$.length;y--;){var B=$[y];if(Array.isArray(B))for(var _=B.length;_--;)(w==null||B[_]!=null&&w>B[_])&&(w=B[_]);else(w==null||B!=null&&w>B)&&(w=B)}else!isNaN(q)&&(w==null||q!=null&&w>q)&&(w=q)}return w}function un(w,m,q,$=!0){for(var y=null,B=0;B<m.length;B++)if(m[B][0]<w)y=m[B][q-1];else if(m[B][0]==w)return m[B][q-1];if($&&y)return y;throw Error("#N/A")}function Fn(){return!1}function qn(w,m,q){return((w*60+m)*60+q)*1e3/864e5}function Vn(w){if(!w.getDate)throw Error("#VALUE!");var m=w.getUTCDate();if(isNaN(m))throw Error("#VALUE!");return m}function $n(w){if(!w.getMonth)throw Error("#VALUE!");var m=w.getUTCMonth();if(isNaN(m))throw Error("#VALUE!");return m+1}function J(w){if(!w.getFullYear)throw Error("#VALUE!");var m=w.getUTCFullYear();if(isNaN(m))throw Error("#VALUE!");return m}function en(w,m,q){if(w=new Date(w),m=new Date(m),!w||!m||w=="Invalid Date"||m=="Invalid Date")throw Error("#VALUE!");switch(q=q.replace(/[^DMY]/ig,""),q){case"M":return m.getMonth()-w.getMonth()+12*(m.getFullYear()-w.getFullYear());case"Y":return Math.abs(m.getUTCFullYear()-w.getUTCFullYear());case"D":default:var $=Math.abs(m-w);return Math.ceil($/(1e3*3600*24))}}function an(w,m){if(w=new Date(w),!w||w=="Invalid Date")throw Error("#VALUE!");m=m||0;var q=new Date(w.getUTCFullYear(),w.getUTCMonth()+m+1,0);return q.setUTCHours(0),q.setUTCMinutes(0),q.setUTCSeconds(0),q}function En(w,m){if(m=m===void 0?1:parseFloat(m),isNaN(m))throw Error("#VALUE!");return w==null?w="":w=""+w,w.substring(w.length-m)}function Tn(w,m){if(m=m===void 0?1:parseFloat(m),isNaN(m))throw Error("#VALUE!");return w==null?w="":w=""+w,w.substring(0,m)}function Un(){for(var w=0;w+1<arguments.length;w+=2){var m=arguments[w],q=arguments[w+1];if(m)return q}throw Error("#N/A")}function L(w){return w.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function P(w,m,q,$){if($<=0)throw Error("#VALUE!");if(!w||!m||!q&&q!=="")return w;if($===void 0)return w.replace(new RegExp(L(m),"g"),q);for(var y=0,B=0;w.indexOf(m,y)>0;)if(y=w.indexOf(m,y+1),B++,B===$)return w.substring(0,y)+q+w.substring(y+m.length)}function V(w,m){return Math.ceil(w/m)*m}function b(w,m,q){if(!w||!m||!(w instanceof Array)||!(m instanceof Array)||w.length===0||m.length===0)return r.na;for(let dn=0;dn<w.length;dn++)if(!(w[dn]instanceof Array)||w[dn].length===0||w[dn].length!==w[0].length)return r.na;for(let dn=0;dn<m.length;dn++)if(!(m[dn]instanceof Array)||m[dn].length===0||m[dn].length!==m[0].length)return r.na;const $=w[0].length,y=w.length,B=m[0].length,_=m.length;if($!==B&&y!==_||y>1&&$>1&&($===B&&_!==1||y===_&&B!==1)||y>1&&$===1&&(B!==1||_!==1&&_!==y))return r.na;const wn=[];for(let dn=0;dn<y;dn++){const Cn=[];for(let sn=0;sn<$;sn++){const rr=U(m,dn,sn)||U(m,0,sn)||U(m,dn,0),bn=n.parseBool(rr);if(bn===!0)Cn.push(w[dn][sn]);else if(bn instanceof Error)return n.addEmptyValuesToArray([[bn]],$,y)}Cn.length>0&&wn.push(Cn)}return wn.length===0?q!=null?n.addEmptyValuesToArray([[q]],$,y):n.addEmptyValuesToArray([[r.calc]],$,y):n.addEmptyValuesToArray(wn,$,y)}function U(w,m,q){if(w[m])return w[m][q]===!1?"FALSE":w[m][q]}function tn(w){return function(){const m=w.apply(this,arguments);if(m instanceof Error)throw m;return m}}return Pe=t,Pe}var Fe,Lt;function dc(){if(Lt)return Fe;Lt=1;const n=le(),r=ce(),t=Oo(),e=Gr(),i=ct(),c=mo();function a(v,d,p,A,I){if(A=(A||new e(1)).calc(),I=(I||new e(1)).calc(),v.args.length===1&&v.args[0].name==="RefValue"){var E=v.args[0],N=E.parseRef(),R=r(N.cell_name)+p.calc(),C=n(R),D=+N.cell_name.replace(/^[A-Z]+/g,"")+d.calc(),M=N.sheet_name+"!"+C+D;if(A===1&&I===1)return new c(M,E.formula).calc();var F=n(R+I-1),Y=D+A-1,Q=F+Y,j=M+":"+Q;return new i(j,E.formula).calc()}}function g(v){if(v.args.length===0){var d=+v.formula.name.replace(/^[A-Z]+/g,"");return d}else if(v.args.length===1&&v.args[0].name==="RefValue"){var p=v.args[0],A=p.parseRef(),d=+A.cell_name.replace(/^[A-Z]+/g,"");return d}else if(v.args.length===1&&v.args[0]instanceof i){for(var I=v.args[0].parse(),E=I.min_row,N=I.max_row,R=[],C=E;C<=N;C++)R.push(C);return R}}function h(v){if(v.args.length===0){var d=r(v.formula.name);return d+1}else if(v.args.length===1&&v.args[0].name==="RefValue"){var p=v.args[0],A=p.parseRef(),d=r(A.cell_name);return d+1}else if(v.args.length===1&&v.args[0]instanceof i){for(var I=v.args[0].parse(),E=I.min_col,N=I.max_col,R=[],C=E;C<=N;C++)R.push(C+1);return R}}function f(v,d){try{var p=v.calc();return typeof p=="number"&&(isNaN(p)||p===1/0||p===-1/0)?d.calc():p}catch{return d.calc()}}function o(v,d,p){var A,I,E;try{A=v.calc()}catch(N){A=N}try{I=d.calc()}catch(N){I=N}try{E=typeof p>"u"?!1:p.calc()}catch(N){E=N}return t(function(N,R,C){return N instanceof Error?N:N?R:C})(A,I,E)}function u(){for(var v=0;v<arguments.length;v++)if(!arguments[v].calc())return!1;return!0}function s(){for(var v=0;v<arguments.length;v++)if(arguments[v].calc())return!0;return!1}function l(v){let p=v.args[0].calc(),I=v.formula.name.match(/([A-Z]+)([0-9]+)/),E=v.formula.sheet,N=r(I[1]),R=+I[2];for(let C=0;C<p.length;C++){let D=p[C];for(let M=0;M<D.length;M++){let F=N+C,Y=R+M,Q=D[M];E[n(F)+Y].v=Q}}return p[0][0]}return Fe={OFFSET:a,ROW:g,COLUMN:h,IFERROR:f,IF:o,AND:u,OR:s,TRANSPOSE:l},Fe}var qe,Pt;function pc(){if(Pt)return qe;Pt=1;const n=hc();let r={},t={};i(vc()),e(dc());function e(h,f){for(var o in h)t[o]=h[o]}function i(h,f){f=f||{};var o=f.prefix||"";for(var u in h){var s=h[u];typeof s=="function"?(f.override||!r[o+u])&&(r[o+u]=s):typeof s=="object"&&i(s,c(f,{prefix:u+"."}))}}function c(h,f){var o=JSON.parse(JSON.stringify(h));for(var u in f)o[u]=f[u];return o}function a(h){return n(h,{xlsx_Fx:r,xlsx_raw_Fx:t})}function g(h){a(h).update_cell_value()}return g.set_fx=function(f,o){r[f]=o},g.exec_fx=function(f,o){return r[f].apply(this,o)},g.localizeFunctions=function(h){for(let f in h){let o=h[f];r[o]&&(r[f]=r[o]),t[o]&&(t[f]=t[o])}},g.import_functions=i,g.import_raw_functions=e,g.build_expression=a,g.xlsx_Fx=r,qe=g,qe}var Ve,Ft;function Do(){return Ft||(Ft=1,Ve=function(r,t){let e={},i=[];for(let c in r.Sheets){let a=r.Sheets[c];for(let g in a)if(a[g]&&a[g].f){let h=e[c+"!"+g]={formula_ref:e,wb:r,sheet:a,sheet_name:c,cell:a[g],name:g,status:"new",exec_formula:t};i.push(h)}}return i}),Ve}var Ue,qt;function Ec(){if(qt)return Ue;qt=1;const n=Gr(),r=Co(),t=Do();class e{constructor(c,a){this.workbook=c,this.expressions=[],this.exec_formula=a,this.variables={},this.formulas=t(c,a);for(let g=this.formulas.length-1;g>=0;g--){let h=a.build_expression(this.formulas[g]);this.expressions.push(h)}this.calcNames()}setVar(c,a){let g=this.variables[c];g?g.setValue(a):this.expressions.forEach(h=>{this.setVarOfExpression(h,c,a)})}getVars(){let c={};for(let a in this.variables)c[a]=this.variables[a].calc();return c}calcNames(){!this.workbook||!this.workbook.Workbook||!this.workbook.Workbook.Names||this.workbook.Workbook.Names.forEach(c=>{let a=this.getRef(c.Ref);this.variables[c.Name]=a,this.expressions.forEach(g=>{this.setVarOfExpression(g,c.Name)})})}getRef(c){if(!this.formulas.length)throw new Error("No formula found.");let h={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return r(c,h)}setVarOfExpression(c,a,g){for(let h=0;h<c.args.length;h++){let f=c.args[h];f===a?c.args[h]=this.variables[a]||(this.variables[a]=new n(g)):typeof f=="object"&&(f.name==="Expression"||f.name==="UserFn")&&this.setVarOfExpression(f,a,g)}}execute(){this.expressions.forEach(c=>{c.update_cell_value()})}}return Ue=e,Ue}var $e,Vt;function wc(){if(Vt)return $e;Vt=1;const n=le(),r=ce(),t=pc(),e=Do(),i=Ec();var c=function(a,g){for(var h=e(a,t),f=h.length-1;f>=0;f--)try{if(h[f].status==="done")continue;t(h[f])}catch(o){if(!g||!g.continue_after_error)throw o;g.log_error&&console.log("error executing formula","sheet",h[f].sheet_name,"cell",h[f].name,o)}};return c.calculator=function(g){return new i(g,t)},c.set_fx=t.set_fx,c.exec_fx=t.exec_fx,c.col_str_2_int=r,c.int_2_col_str=n,c.import_functions=t.import_functions,c.import_raw_functions=t.import_raw_functions,c.xlsx_Fx=t.xlsx_Fx,c.localizeFunctions=t.localizeFunctions,c.XLSX_CALC=c,$e=c,$e}var Ac=wc();const Ut=br(Ac);var ke={exports:{}},$t;function Nc(){return $t||($t=1,function(n){var r={},t=function(i){i.version="0.11.2";function c(L){for(var P="",V=L.length-1;V>=0;)P+=L.charAt(V--);return P}function a(L,P){for(var V="";V.length<P;)V+=L;return V}function g(L,P){var V=""+L;return V.length>=P?V:a("0",P-V.length)+V}function h(L,P){var V=""+L;return V.length>=P?V:a(" ",P-V.length)+V}function f(L,P){var V=""+L;return V.length>=P?V:V+a(" ",P-V.length)}function o(L,P){var V=""+Math.round(L);return V.length>=P?V:a("0",P-V.length)+V}function u(L,P){var V=""+L;return V.length>=P?V:a("0",P-V.length)+V}var s=Math.pow(2,32);function l(L,P){if(L>s||L<-s)return o(L,P);var V=Math.round(L);return u(V,P)}function v(L,P){return P=P||0,L.length>=7+P&&(L.charCodeAt(P)|32)===103&&(L.charCodeAt(P+1)|32)===101&&(L.charCodeAt(P+2)|32)===110&&(L.charCodeAt(P+3)|32)===101&&(L.charCodeAt(P+4)|32)===114&&(L.charCodeAt(P+5)|32)===97&&(L.charCodeAt(P+6)|32)===108}var d=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function A(L){L[0]="General",L[1]="0",L[2]="0.00",L[3]="#,##0",L[4]="#,##0.00",L[9]="0%",L[10]="0.00%",L[11]="0.00E+00",L[12]="# ?/?",L[13]="# ??/??",L[14]="m/d/yy",L[15]="d-mmm-yy",L[16]="d-mmm",L[17]="mmm-yy",L[18]="h:mm AM/PM",L[19]="h:mm:ss AM/PM",L[20]="h:mm",L[21]="h:mm:ss",L[22]="m/d/yy h:mm",L[37]="#,##0 ;(#,##0)",L[38]="#,##0 ;[Red](#,##0)",L[39]="#,##0.00;(#,##0.00)",L[40]="#,##0.00;[Red](#,##0.00)",L[45]="mm:ss",L[46]="[h]:mm:ss",L[47]="mmss.0",L[48]="##0.0E+0",L[49]="@",L[56]='"/ "hh""mm""ss" "'}var I={};A(I);var E=[],N=0;for(N=5;N<=8;++N)E[N]=32+N;for(N=23;N<=26;++N)E[N]=0;for(N=27;N<=31;++N)E[N]=14;for(N=50;N<=58;++N)E[N]=14;for(N=59;N<=62;++N)E[N]=N-58;for(N=67;N<=68;++N)E[N]=N-58;for(N=72;N<=75;++N)E[N]=N-58;for(N=67;N<=68;++N)E[N]=N-57;for(N=76;N<=78;++N)E[N]=N-56;for(N=79;N<=81;++N)E[N]=N-34;var R=[];R[5]=R[63]='"$"#,##0_);\\("$"#,##0\\)',R[6]=R[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',R[7]=R[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',R[8]=R[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',R[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',R[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',R[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',R[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function C(L,P,V){for(var b=L<0?-1:1,U=L*b,tn=0,w=1,m=0,q=1,$=0,y=0,B=Math.floor(U);$<P&&(B=Math.floor(U),m=B*w+tn,y=B*$+q,!(U-B<5e-8));)U=1/(U-B),tn=w,w=m,q=$,$=y;if(y>P&&($>P?(y=q,m=tn):(y=$,m=w)),!V)return[0,b*m,y];var _=Math.floor(b*m/y);return[_,b*m-_*y,y]}function D(L,P,V){if(L>2958465||L<0)return null;var b=L|0,U=Math.floor(86400*(L-b)),tn=0,w=[],m={D:b,T:U,u:86400*(L-b)-U,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(m.u)<1e-6&&(m.u=0),P&&P.date1904&&(b+=1462),m.u>.9999&&(m.u=0,++U==86400&&(m.T=U=0,++b,++m.D)),b===60)w=V?[1317,10,29]:[1900,2,29],tn=3;else if(b===0)w=V?[1317,8,29]:[1900,1,0],tn=6;else{b>60&&--b;var q=new Date(1900,0,1);q.setDate(q.getDate()+b-1),w=[q.getFullYear(),q.getMonth()+1,q.getDate()],tn=q.getDay(),b<60&&(tn=(tn+6)%7),V&&(tn=In(q,w))}return m.y=w[0],m.m=w[1],m.d=w[2],m.S=U%60,U=Math.floor(U/60),m.M=U%60,U=Math.floor(U/60),m.H=U,m.q=tn,m}i.parse_date_code=D;var M=new Date(1899,11,31,0,0,0),F=M.getTime(),Y=new Date(1900,2,1,0,0,0);function Q(L,P){var V=L.getTime();return P?V-=1262304e5:L>=Y&&(V+=864e5),(V-(F+(L.getTimezoneOffset()-M.getTimezoneOffset())*6e4))/864e5}function j(L){return L.toString(10)}i._general_int=j;var rn=function(){var P=/(?:\.0*|(\.\d*[1-9])0+)$/;function V($){return $.indexOf(".")==-1?$:$.replace(P,"$1")}var b=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,U=/(E[+-])(\d)$/;function tn($){return $.indexOf("E")==-1?$:$.replace(b,"$1E").replace(U,"$10$2")}function w($){var y=$<0?12:11,B=V($.toFixed(12));return B.length<=y||(B=$.toPrecision(10),B.length<=y)?B:$.toExponential(5)}function m($){var y=V($.toFixed(11));return y.length>($<0?12:11)||y==="0"||y==="-0"?$.toPrecision(6):y}function q($){var y=Math.floor(Math.log(Math.abs($))*Math.LOG10E),B;return y>=-4&&y<=-1?B=$.toPrecision(10+y):Math.abs(y)<=9?B=w($):y===10?B=$.toFixed(10).substr(0,12):B=m($),V(tn(B.toUpperCase()))}return q}();i._general_num=rn;function hn(L,P){switch(typeof L){case"string":return L;case"boolean":return L?"TRUE":"FALSE";case"number":return(L|0)===L?L.toString(10):rn(L);case"undefined":return"";case"object":if(L==null)return"";if(L instanceof Date)return Tn(14,Q(L,P&&P.date1904),P)}throw new Error("unsupported value in General format: "+L)}i._general=hn;function In(L,P){P[0]-=581;var V=L.getDay();return L<60&&(V=(V+6)%7),V}function Mn(L,P,V,b){var U="",tn=0,w=0,m=V.y,q,$=0;switch(L){case 98:m=V.y+543;case 121:switch(P.length){case 1:case 2:q=m%100,$=2;break;default:q=m%1e4,$=4;break}break;case 109:switch(P.length){case 1:case 2:q=V.m,$=P.length;break;case 3:return p[V.m-1][1];case 5:return p[V.m-1][0];default:return p[V.m-1][2]}break;case 100:switch(P.length){case 1:case 2:q=V.d,$=P.length;break;case 3:return d[V.q][0];default:return d[V.q][1]}break;case 104:switch(P.length){case 1:case 2:q=1+(V.H+11)%12,$=P.length;break;default:throw"bad hour format: "+P}break;case 72:switch(P.length){case 1:case 2:q=V.H,$=P.length;break;default:throw"bad hour format: "+P}break;case 77:switch(P.length){case 1:case 2:q=V.M,$=P.length;break;default:throw"bad minute format: "+P}break;case 115:if(P!="s"&&P!="ss"&&P!=".0"&&P!=".00"&&P!=".000")throw"bad second format: "+P;return V.u===0&&(P=="s"||P=="ss")?g(V.S,P.length):(b>=2?w=b===3?1e3:100:w=b===1?10:1,tn=Math.round(w*(V.S+V.u)),tn>=60*w&&(tn=0),P==="s"?tn===0?"0":""+tn/w:(U=g(tn,2+b),P==="ss"?U.substr(0,2):"."+U.substr(2,P.length-1)));case 90:switch(P){case"[h]":case"[hh]":q=V.D*24+V.H;break;case"[m]":case"[mm]":q=(V.D*24+V.H)*60+V.M;break;case"[s]":case"[ss]":q=((V.D*24+V.H)*60+V.M)*60+Math.round(V.S+V.u);break;default:throw"bad abstime format: "+P}$=P.length===3?1:2;break;case 101:q=m,$=1;break}var y=$>0?g(q,$):"";return y}function cn(L){var P=3;if(L.length<=P)return L;for(var V=L.length%P,b=L.substr(0,V);V!=L.length;V+=P)b+=(b.length>0?",":"")+L.substr(V,P);return b}var un=function(){var P=/%/g;function V(Z,k,H){var on=k.replace(P,""),X=k.length-on.length;return un(Z,on,H*Math.pow(10,2*X))+a("%",X)}function b(Z,k,H){for(var on=k.length-1;k.charCodeAt(on-1)===44;)--on;return un(Z,k.substr(0,on),H/Math.pow(10,3*(k.length-on)))}function U(Z,k){var H,on=Z.indexOf("E")-Z.indexOf(".")-1;if(Z.match(/^#+0.0E\+0$/)){if(k==0)return"0.0E+0";if(k<0)return"-"+U(Z,-k);var X=Z.indexOf(".");X===-1&&(X=Z.indexOf("E"));var K=Math.floor(Math.log(k)*Math.LOG10E)%X;if(K<0&&(K+=X),H=(k/Math.pow(10,K)).toPrecision(on+1+(X+K)%X),H.indexOf("e")===-1){var vn=Math.floor(Math.log(k)*Math.LOG10E);for(H.indexOf(".")===-1?H=H.charAt(0)+"."+H.substr(1)+"E+"+(vn-H.length+K):H+="E+"+(vn-K);H.substr(0,2)==="0.";)H=H.charAt(0)+H.substr(2,X)+"."+H.substr(2+X),H=H.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");H=H.replace(/\+-/,"-")}H=H.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(mn,yn,Ln,pn){return yn+Ln+pn.substr(0,(X+K)%X)+"."+pn.substr(K)+"E"})}else H=k.toExponential(on);return Z.match(/E\+00$/)&&H.match(/e[+-]\d$/)&&(H=H.substr(0,H.length-1)+"0"+H.charAt(H.length-1)),Z.match(/E\-/)&&H.match(/e\+/)&&(H=H.replace(/e\+/,"e")),H.replace("e","E")}var tn=/# (\?+)( ?)\/( ?)(\d+)/;function w(Z,k,H){var on=parseInt(Z[4],10),X=Math.round(k*on),K=Math.floor(X/on),vn=X-K*on,mn=on;return H+(K===0?"":""+K)+" "+(vn===0?a(" ",Z[1].length+1+Z[4].length):h(vn,Z[1].length)+Z[2]+"/"+Z[3]+g(mn,Z[4].length))}function m(Z,k,H){return H+(k===0?"":""+k)+a(" ",Z[1].length+2+Z[4].length)}var q=/^#*0*\.([0#]+)/,$=/\).*[0#]/,y=/\(###\) ###\\?-####/;function B(Z){for(var k="",H,on=0;on!=Z.length;++on)switch(H=Z.charCodeAt(on)){case 35:break;case 63:k+=" ";break;case 48:k+="0";break;default:k+=String.fromCharCode(H)}return k}function _(Z,k){var H=Math.pow(10,k);return""+Math.round(Z*H)/H}function wn(Z,k){var H=Z-Math.floor(Z),on=Math.pow(10,k);return k<(""+Math.round(H*on)).length?0:Math.round(H*on)}function dn(Z,k){return k<(""+Math.round((Z-Math.floor(Z))*Math.pow(10,k))).length?1:0}function Cn(Z){return Z<2147483647&&Z>-2147483648?""+(Z>=0?Z|0:Z-1|0):""+Math.floor(Z)}function sn(Z,k,H){if(Z.charCodeAt(0)===40&&!k.match($)){var on=k.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return H>=0?sn("n",on,H):"("+sn("n",on,-H)+")"}if(k.charCodeAt(k.length-1)===44)return b(Z,k,H);if(k.indexOf("%")!==-1)return V(Z,k,H);if(k.indexOf("E")!==-1)return U(k,H);if(k.charCodeAt(0)===36)return"$"+sn(Z,k.substr(k.charAt(1)==" "?2:1),H);var X,K,vn,mn,yn=Math.abs(H),Ln=H<0?"-":"";if(k.match(/^00+$/))return Ln+l(yn,k.length);if(k.match(/^[#?]+$/))return X=l(H,0),X==="0"&&(X=""),X.length>k.length?X:B(k.substr(0,k.length-X.length))+X;if(K=k.match(tn))return w(K,yn,Ln);if(k.match(/^#+0+$/))return Ln+l(yn,k.length-k.indexOf("0"));if(K=k.match(q))return X=_(H,K[1].length).replace(/^([^\.]+)$/,"$1."+B(K[1])).replace(/\.$/,"."+B(K[1])).replace(/\.(\d*)$/,function(Wn,Lr){return"."+Lr+a("0",B(K[1]).length-Lr.length)}),k.indexOf("0.")!==-1?X:X.replace(/^0\./,".");if(k=k.replace(/^#+([0.])/,"$1"),K=k.match(/^(0*)\.(#*)$/))return Ln+_(yn,K[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=k.match(/^#{1,3},##0(\.?)$/))return Ln+cn(l(yn,0));if(K=k.match(/^#,##0\.([#0]*0)$/))return H<0?"-"+sn(Z,k,-H):cn(""+(Math.floor(H)+dn(H,K[1].length)))+"."+g(wn(H,K[1].length),K[1].length);if(K=k.match(/^#,#*,#0/))return sn(Z,k.replace(/^#,#*,/,""),H);if(K=k.match(/^([0#]+)(\\?-([0#]+))+$/))return X=c(sn(Z,k.replace(/[\\-]/g,""),H)),vn=0,c(c(k.replace(/\\/g,"")).replace(/[0#]/g,function(Wn){return vn<X.length?X.charAt(vn++):Wn==="0"?"0":""}));if(k.match(y))return X=sn(Z,"##########",H),"("+X.substr(0,3)+") "+X.substr(3,3)+"-"+X.substr(6);var pn="";if(K=k.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return vn=Math.min(K[4].length,7),mn=C(yn,Math.pow(10,vn)-1,!1),X=""+Ln,pn=un("n",K[1],mn[1]),pn.charAt(pn.length-1)==" "&&(pn=pn.substr(0,pn.length-1)+"0"),X+=pn+K[2]+"/"+K[3],pn=f(mn[2],vn),pn.length<K[4].length&&(pn=B(K[4].substr(K[4].length-pn.length))+pn),X+=pn,X;if(K=k.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return vn=Math.min(Math.max(K[1].length,K[4].length),7),mn=C(yn,Math.pow(10,vn)-1,!0),Ln+(mn[0]||(mn[1]?"":"0"))+" "+(mn[1]?h(mn[1],vn)+K[2]+"/"+K[3]+f(mn[2],vn):a(" ",2*vn+1+K[2].length+K[3].length));if(K=k.match(/^[#0?]+$/))return X=l(H,0),k.length<=X.length?X:B(k.substr(0,k.length-X.length))+X;if(K=k.match(/^([#0?]+)\.([#0]+)$/)){X=""+H.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),vn=X.indexOf(".");var Dr=k.indexOf(".")-vn,ae=k.length-X.length-Dr;return B(k.substr(0,Dr)+X+k.substr(k.length-ae))}if(K=k.match(/^00,000\.([#0]*0)$/))return vn=wn(H,K[1].length),H<0?"-"+sn(Z,k,-H):cn(Cn(H)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Wn){return"00,"+(Wn.length<3?g(0,3-Wn.length):"")+Wn})+"."+g(vn,K[1].length);switch(k){case"###,##0.00":return sn(Z,"#,##0.00",H);case"###,###":case"##,###":case"#,###":var yr=cn(l(yn,0));return yr!=="0"?Ln+yr:"";case"###,###.00":return sn(Z,"###,##0.00",H).replace(/^0\./,".");case"#,###.00":return sn(Z,"#,##0.00",H).replace(/^0\./,".")}throw new Error("unsupported format |"+k+"|")}function rr(Z,k,H){for(var on=k.length-1;k.charCodeAt(on-1)===44;)--on;return un(Z,k.substr(0,on),H/Math.pow(10,3*(k.length-on)))}function bn(Z,k,H){var on=k.replace(P,""),X=k.length-on.length;return un(Z,on,H*Math.pow(10,2*X))+a("%",X)}function Dn(Z,k){var H,on=Z.indexOf("E")-Z.indexOf(".")-1;if(Z.match(/^#+0.0E\+0$/)){if(k==0)return"0.0E+0";if(k<0)return"-"+Dn(Z,-k);var X=Z.indexOf(".");X===-1&&(X=Z.indexOf("E"));var K=Math.floor(Math.log(k)*Math.LOG10E)%X;if(K<0&&(K+=X),H=(k/Math.pow(10,K)).toPrecision(on+1+(X+K)%X),!H.match(/[Ee]/)){var vn=Math.floor(Math.log(k)*Math.LOG10E);H.indexOf(".")===-1?H=H.charAt(0)+"."+H.substr(1)+"E+"+(vn-H.length+K):H+="E+"+(vn-K),H=H.replace(/\+-/,"-")}H=H.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(mn,yn,Ln,pn){return yn+Ln+pn.substr(0,(X+K)%X)+"."+pn.substr(K)+"E"})}else H=k.toExponential(on);return Z.match(/E\+00$/)&&H.match(/e[+-]\d$/)&&(H=H.substr(0,H.length-1)+"0"+H.charAt(H.length-1)),Z.match(/E\-/)&&H.match(/e\+/)&&(H=H.replace(/e\+/,"e")),H.replace("e","E")}function fn(Z,k,H){if(Z.charCodeAt(0)===40&&!k.match($)){var on=k.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return H>=0?fn("n",on,H):"("+fn("n",on,-H)+")"}if(k.charCodeAt(k.length-1)===44)return rr(Z,k,H);if(k.indexOf("%")!==-1)return bn(Z,k,H);if(k.indexOf("E")!==-1)return Dn(k,H);if(k.charCodeAt(0)===36)return"$"+fn(Z,k.substr(k.charAt(1)==" "?2:1),H);var X,K,vn,mn,yn=Math.abs(H),Ln=H<0?"-":"";if(k.match(/^00+$/))return Ln+g(yn,k.length);if(k.match(/^[#?]+$/))return X=""+H,H===0&&(X=""),X.length>k.length?X:B(k.substr(0,k.length-X.length))+X;if(K=k.match(tn))return m(K,yn,Ln);if(k.match(/^#+0+$/))return Ln+g(yn,k.length-k.indexOf("0"));if(K=k.match(q))return X=(""+H).replace(/^([^\.]+)$/,"$1."+B(K[1])).replace(/\.$/,"."+B(K[1])),X=X.replace(/\.(\d*)$/,function(Wn,Lr){return"."+Lr+a("0",B(K[1]).length-Lr.length)}),k.indexOf("0.")!==-1?X:X.replace(/^0\./,".");if(k=k.replace(/^#+([0.])/,"$1"),K=k.match(/^(0*)\.(#*)$/))return Ln+(""+yn).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=k.match(/^#{1,3},##0(\.?)$/))return Ln+cn(""+yn);if(K=k.match(/^#,##0\.([#0]*0)$/))return H<0?"-"+fn(Z,k,-H):cn(""+H)+"."+a("0",K[1].length);if(K=k.match(/^#,#*,#0/))return fn(Z,k.replace(/^#,#*,/,""),H);if(K=k.match(/^([0#]+)(\\?-([0#]+))+$/))return X=c(fn(Z,k.replace(/[\\-]/g,""),H)),vn=0,c(c(k.replace(/\\/g,"")).replace(/[0#]/g,function(Wn){return vn<X.length?X.charAt(vn++):Wn==="0"?"0":""}));if(k.match(y))return X=fn(Z,"##########",H),"("+X.substr(0,3)+") "+X.substr(3,3)+"-"+X.substr(6);var pn="";if(K=k.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return vn=Math.min(K[4].length,7),mn=C(yn,Math.pow(10,vn)-1,!1),X=""+Ln,pn=un("n",K[1],mn[1]),pn.charAt(pn.length-1)==" "&&(pn=pn.substr(0,pn.length-1)+"0"),X+=pn+K[2]+"/"+K[3],pn=f(mn[2],vn),pn.length<K[4].length&&(pn=B(K[4].substr(K[4].length-pn.length))+pn),X+=pn,X;if(K=k.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return vn=Math.min(Math.max(K[1].length,K[4].length),7),mn=C(yn,Math.pow(10,vn)-1,!0),Ln+(mn[0]||(mn[1]?"":"0"))+" "+(mn[1]?h(mn[1],vn)+K[2]+"/"+K[3]+f(mn[2],vn):a(" ",2*vn+1+K[2].length+K[3].length));if(K=k.match(/^[#0?]+$/))return X=""+H,k.length<=X.length?X:B(k.substr(0,k.length-X.length))+X;if(K=k.match(/^([#0]+)\.([#0]+)$/)){X=""+H.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),vn=X.indexOf(".");var Dr=k.indexOf(".")-vn,ae=k.length-X.length-Dr;return B(k.substr(0,Dr)+X+k.substr(k.length-ae))}if(K=k.match(/^00,000\.([#0]*0)$/))return H<0?"-"+fn(Z,k,-H):cn(""+H).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Wn){return"00,"+(Wn.length<3?g(0,3-Wn.length):"")+Wn})+"."+g(0,K[1].length);switch(k){case"###,###":case"##,###":case"#,###":var yr=cn(""+yn);return yr!=="0"?Ln+yr:"";default:if(k.match(/\.[0#?]*$/))return fn(Z,k.slice(0,k.lastIndexOf(".")),H)+B(k.slice(k.lastIndexOf(".")))}throw new Error("unsupported format |"+k+"|")}return function(k,H,on){return(on|0)===on?fn(k,H,on):sn(k,H,on)}}();function Fn(L){for(var P=[],V=!1,b=0,U=0;b<L.length;++b)switch(L.charCodeAt(b)){case 34:V=!V;break;case 95:case 42:case 92:++b;break;case 59:P[P.length]=L.substr(U,b-U),U=b+1}if(P[P.length]=L.substr(U),V===!0)throw new Error("Format |"+L+"| unterminated string ");return P}i._split=Fn;var qn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Vn(L){for(var P=0,V="",b="";P<L.length;)switch(V=L.charAt(P)){case"G":v(L,P)&&(P+=6),P++;break;case'"':for(;L.charCodeAt(++P)!==34&&P<L.length;);++P;break;case"\\":P+=2;break;case"_":P+=2;break;case"@":++P;break;case"B":case"b":if(L.charAt(P+1)==="1"||L.charAt(P+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(L.substr(P,3).toUpperCase()==="A/P"||L.substr(P,5).toUpperCase()==="AM/PM"||L.substr(P,5).toUpperCase()==="/")return!0;++P;break;case"[":for(b=V;L.charAt(P++)!=="]"&&P<L.length;)b+=L.charAt(P);if(b.match(qn))return!0;break;case".":case"0":case"#":for(;P<L.length&&("0#?.,E+-%".indexOf(V=L.charAt(++P))>-1||V=="\\"&&L.charAt(P+1)=="-"&&"0#".indexOf(L.charAt(P+2))>-1););break;case"?":for(;L.charAt(++P)===V;);break;case"*":++P,(L.charAt(P)==" "||L.charAt(P)=="*")&&++P;break;case"(":case")":++P;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;P<L.length&&"0123456789".indexOf(L.charAt(++P))>-1;);break;case" ":++P;break;default:++P;break}return!1}i.is_date=Vn;function $n(L,P,V,b){for(var U=[],tn="",w=0,m="",q="t",$,y,B,_="H";w<L.length;)switch(m=L.charAt(w)){case"G":if(!v(L,w))throw new Error("unrecognized character "+m+" in "+L);U[U.length]={t:"G",v:"General"},w+=7;break;case'"':for(tn="";(B=L.charCodeAt(++w))!==34&&w<L.length;)tn+=String.fromCharCode(B);U[U.length]={t:"t",v:tn},++w;break;case"\\":var wn=L.charAt(++w),dn=wn==="("||wn===")"?wn:"t";U[U.length]={t:dn,v:wn},++w;break;case"_":U[U.length]={t:"t",v:" "},w+=2;break;case"@":U[U.length]={t:"T",v:P},++w;break;case"B":case"b":if(L.charAt(w+1)==="1"||L.charAt(w+1)==="2"){if($==null&&($=D(P,V,L.charAt(w+1)==="2"),$==null))return"";U[U.length]={t:"X",v:L.substr(w,2)},q=m,w+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":m=m.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(P<0||$==null&&($=D(P,V),$==null))return"";for(tn=m;++w<L.length&&L.charAt(w).toLowerCase()===m;)tn+=m;m==="m"&&q.toLowerCase()==="h"&&(m="M"),m==="h"&&(m=_),U[U.length]={t:m,v:tn},q=m;break;case"A":case"a":case"":var Cn={t:m,v:m};if($==null&&($=D(P,V)),L.substr(w,3).toUpperCase()==="A/P"?($!=null&&(Cn.v=$.H>=12?"P":"A"),Cn.t="T",_="h",w+=3):L.substr(w,5).toUpperCase()==="AM/PM"?($!=null&&(Cn.v=$.H>=12?"PM":"AM"),Cn.t="T",w+=5,_="h"):L.substr(w,5).toUpperCase()==="/"?($!=null&&(Cn.v=$.H>=12?"":""),Cn.t="T",w+=5,_="h"):(Cn.t="t",++w),$==null&&Cn.t==="T")return"";U[U.length]=Cn,q=m;break;case"[":for(tn=m;L.charAt(w++)!=="]"&&w<L.length;)tn+=L.charAt(w);if(tn.slice(-1)!=="]")throw'unterminated "[" block: |'+tn+"|";if(tn.match(qn)){if($==null&&($=D(P,V),$==null))return"";U[U.length]={t:"Z",v:tn.toLowerCase()},q=tn.charAt(1)}else tn.indexOf("$")>-1&&(tn=(tn.match(/\$([^-\[\]]*)/)||[])[1]||"$",Vn(L)||(U[U.length]={t:"t",v:tn}));break;case".":if($!=null){for(tn=m;++w<L.length&&(m=L.charAt(w))==="0";)tn+=m;U[U.length]={t:"s",v:tn};break}case"0":case"#":for(tn=m;++w<L.length&&"0#?.,E+-%".indexOf(m=L.charAt(w))>-1;)tn+=m;U[U.length]={t:"n",v:tn};break;case"?":for(tn=m;L.charAt(++w)===m;)tn+=m;U[U.length]={t:m,v:tn},q=m;break;case"*":++w,(L.charAt(w)==" "||L.charAt(w)=="*")&&++w;break;case"(":case")":U[U.length]={t:b===1?"t":m,v:m},++w;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(tn=m;w<L.length&&"0123456789".indexOf(L.charAt(++w))>-1;)tn+=L.charAt(w);U[U.length]={t:"D",v:tn};break;case" ":U[U.length]={t:m,v:m},++w;break;case"$":U[U.length]={t:"t",v:"$"},++w;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(m)===-1)throw new Error("unrecognized character "+m+" in "+L);U[U.length]={t:"t",v:m},++w;break}var sn=0,rr=0,bn;for(w=U.length-1,q="t";w>=0;--w)switch(U[w].t){case"h":case"H":U[w].t=_,q="h",sn<1&&(sn=1);break;case"s":(bn=U[w].v.match(/\.0+$/))&&(rr=Math.max(rr,bn[0].length-1)),sn<3&&(sn=3);case"d":case"y":case"M":case"e":q=U[w].t;break;case"m":q==="s"&&(U[w].t="M",sn<2&&(sn=2));break;case"X":break;case"Z":sn<1&&U[w].v.match(/[Hh]/)&&(sn=1),sn<2&&U[w].v.match(/[Mm]/)&&(sn=2),sn<3&&U[w].v.match(/[Ss]/)&&(sn=3)}switch(sn){case 0:break;case 1:$.u>=.5&&($.u=0,++$.S),$.S>=60&&($.S=0,++$.M),$.M>=60&&($.M=0,++$.H);break;case 2:$.u>=.5&&($.u=0,++$.S),$.S>=60&&($.S=0,++$.M);break}var Dn="",fn;for(w=0;w<U.length;++w)switch(U[w].t){case"t":case"T":case" ":case"D":break;case"X":U[w].v="",U[w].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":U[w].v=Mn(U[w].t.charCodeAt(0),U[w].v,$,rr),U[w].t="t";break;case"n":case"?":for(fn=w+1;U[fn]!=null&&((m=U[fn].t)==="?"||m==="D"||(m===" "||m==="t")&&U[fn+1]!=null&&(U[fn+1].t==="?"||U[fn+1].t==="t"&&U[fn+1].v==="/")||U[w].t==="("&&(m===" "||m==="n"||m===")")||m==="t"&&(U[fn].v==="/"||U[fn].v===" "&&U[fn+1]!=null&&U[fn+1].t=="?"));)U[w].v+=U[fn].v,U[fn]={v:"",t:";"},++fn;Dn+=U[w].v,w=fn-1;break;case"G":U[w].t="t",U[w].v=hn(P,V);break}var Z="",k,H;if(Dn.length>0){Dn.charCodeAt(0)==40?(k=P<0&&Dn.charCodeAt(0)===45?-P:P,H=un("n",Dn,k)):(k=P<0&&b>1?-P:P,H=un("n",Dn,k),k<0&&U[0]&&U[0].t=="t"&&(H=H.substr(1),U[0].v="-"+U[0].v)),fn=H.length-1;var on=U.length;for(w=0;w<U.length;++w)if(U[w]!=null&&U[w].t!="t"&&U[w].v.indexOf(".")>-1){on=w;break}var X=U.length;if(on===U.length&&H.indexOf("E")===-1){for(w=U.length-1;w>=0;--w)U[w]==null||"n?".indexOf(U[w].t)===-1||(fn>=U[w].v.length-1?(fn-=U[w].v.length,U[w].v=H.substr(fn+1,U[w].v.length)):fn<0?U[w].v="":(U[w].v=H.substr(0,fn+1),fn=-1),U[w].t="t",X=w);fn>=0&&X<U.length&&(U[X].v=H.substr(0,fn+1)+U[X].v)}else if(on!==U.length&&H.indexOf("E")===-1){for(fn=H.indexOf(".")-1,w=on;w>=0;--w)if(!(U[w]==null||"n?".indexOf(U[w].t)===-1)){for(y=U[w].v.indexOf(".")>-1&&w===on?U[w].v.indexOf(".")-1:U[w].v.length-1,Z=U[w].v.substr(y+1);y>=0;--y)fn>=0&&(U[w].v.charAt(y)==="0"||U[w].v.charAt(y)==="#")&&(Z=H.charAt(fn--)+Z);U[w].v=Z,U[w].t="t",X=w}for(fn>=0&&X<U.length&&(U[X].v=H.substr(0,fn+1)+U[X].v),fn=H.indexOf(".")+1,w=on;w<U.length;++w)if(!(U[w]==null||"n?(".indexOf(U[w].t)===-1&&w!==on)){for(y=U[w].v.indexOf(".")>-1&&w===on?U[w].v.indexOf(".")+1:0,Z=U[w].v.substr(0,y);y<U[w].v.length;++y)fn<H.length&&(Z+=H.charAt(fn++));U[w].v=Z,U[w].t="t",X=w}}}for(w=0;w<U.length;++w)U[w]!=null&&"n?".indexOf(U[w].t)>-1&&(k=b>1&&P<0&&w>0&&U[w-1].v==="-"?-P:P,U[w].v=un(U[w].t,U[w].v,k),U[w].t="t");var K="";for(w=0;w!==U.length;++w)U[w]!=null&&(K+=U[w].v);return K}i._eval=$n;var J=/\[[=<>]/,en=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function an(L,P){if(P==null)return!1;var V=parseFloat(P[2]);switch(P[1]){case"=":if(L==V)return!0;break;case">":if(L>V)return!0;break;case"<":if(L<V)return!0;break;case"<>":if(L!=V)return!0;break;case">=":if(L>=V)return!0;break;case"<=":if(L<=V)return!0;break}return!1}function En(L,P){var V=Fn(L),b=V.length,U=V[b-1].indexOf("@");if(b<4&&U>-1&&--b,V.length>4)throw new Error("cannot find right format for |"+V.join("|")+"|");if(typeof P!="number")return[4,V.length===4||U>-1?V[V.length-1]:"@"];switch(V.length){case 1:V=U>-1?["General","General","General",V[0]]:[V[0],V[0],V[0],"@"];break;case 2:V=U>-1?[V[0],V[0],V[0],V[1]]:[V[0],V[1],V[0],"@"];break;case 3:V=U>-1?[V[0],V[1],V[0],V[2]]:[V[0],V[1],V[2],"@"];break}var tn=P>0?V[0]:P<0?V[1]:V[2];if(V[0].indexOf("[")===-1&&V[1].indexOf("[")===-1)return[b,tn];if(V[0].match(J)!=null||V[1].match(J)!=null){var w=V[0].match(en),m=V[1].match(en);return an(P,w)?[b,V[0]]:an(P,m)?[b,V[1]]:[b,V[w!=null&&m!=null?2:1]]}return[b,tn]}function Tn(L,P,V){V==null&&(V={});var b="";switch(typeof L){case"string":L=="m/d/yy"&&V.dateNF?b=V.dateNF:b=L;break;case"number":L==14&&V.dateNF?b=V.dateNF:b=(V.table!=null?V.table:I)[L],b==null&&(b=V.table&&V.table[E[L]]||I[E[L]]),b==null&&(b=R[L]||"General");break}if(v(b,0))return hn(P,V);P instanceof Date&&(P=Q(P,V.date1904));var U=En(b,P);if(v(U[1]))return hn(P,V);if(P===!0)P="TRUE";else if(P===!1)P="FALSE";else if(P===""||P==null)return"";return $n(U[1],P,V,U[0])}function Un(L,P){if(typeof P!="number"){P=+P||-1;for(var V=0;V<392;++V){if(I[V]==null){P<0&&(P=V);continue}if(I[V]==L){P=V;break}}P<0&&(P=391)}return I[P]=L,P}i.load=Un,i._table=I,i.get_table=function(){return I},i.load_table=function(P){for(var V=0;V!=392;++V)P[V]!==void 0&&Un(P[V],V)},i.init_table=A,i.format=Tn};t(r),typeof DO_NOT_EXPORT_SSF>"u"&&(n.exports=r)}(ke)),ke.exports}var Ic=Nc();const yo=br(Ic),zr=n=>n/9525;function Tc(n,r,t,e,i,c,a,g){if(!(!r.charts||r.charts.length===0))for(const h of r.charts){if(!h.chart||!h.fromAnchor||!h.toAnchor)continue;const f=Number(h.fromAnchor.colId),o=Number(h.fromAnchor.rowId),u=Number(h.toAnchor.colId),s=Number(h.toAnchor.rowId)-1,l=Qn+t[f]+zr(Number(h.fromAnchor.colOffset))-i,v=Jn+e[o]+zr(Number(h.fromAnchor.rowOffset))-c,d=Qn+t[u]+zr(Number(h.toAnchor.colOffset))-i,p=Jn+e[s]+zr(Number(h.toAnchor.rowOffset))-c;if(d<0||p<0||l>a||v>g)continue;const A={x:l,y:v,width:d-l,height:p-v};n.save(),n.fillStyle="#ffffff",n.strokeStyle="#000000",n.lineWidth=1,n.beginPath(),n.rect(A.x,A.y,A.width,A.height),n.fill(),n.stroke(),n.restore(),Uo(n,h.chart,A)}}function Rc(n){const r=n?.size??11,t=n?.bold?"bold ":"",e=n?.italic?"italic ":"",i=n?.family?`"${n.family}", sans-serif`:"sans-serif";return`${t}${e}${r}px ${i}`}const kt=yo.get_table();function Gt(n,r,t,e){if(!(!n||!r)){if(n.numFmtId!=null){t.numberFormatId=n.numFmtId;const i=r.numberFormats?.find(c=>c.id===n.numFmtId);i?.formatCode?t.numberFormatCode=i.formatCode:kt[n.numFmtId]&&(t.numberFormatCode=kt[n.numFmtId])}if(n.fillId!=null&&(!e||n.applyFill||n.applyFill===void 0)){const i=r.fills[n.fillId],c=i?.fgColor||i?.bgColor;c&&(t.fill=Nr(c))}if(n.fontId!=null&&((!e||n.applyFont)??!0)){const i=r.fonts[n.fontId]??{},c=t.font??={};c.size=i.size?i.size:c.size,c.bold=i.bold?i.bold:c.bold,c.italic=i.italic?i.italic:c.italic,c.family=i.name?i.name:c.family,i.color&&(c.color=Nr(i.color),t.textColor=c.color)}if(n.horizontalAlignment&&(!e||n.applyAlignment||n.applyAlignment===void 0))switch(n.horizontalAlignment){case"left":case"center":case"right":t.align=n.horizontalAlignment;break}if(n.borderId!=null&&(!e||n.applyBorder||n.applyBorder===void 0)){const i=r.borders[n.borderId];i&&(t.borders??={},i.left&&(t.borders.left=i.left.color?Nr(i.left.color):"transparent"),i.right&&(t.borders.right=i.right.color?Nr(i.right.color):"transparent"),i.top&&(t.borders.top=i.top.color?Nr(i.top.color):"transparent"),i.bottom&&(t.borders.bottom=i.bottom.color?Nr(i.bottom.color):"transparent"))}}}function Mc(n){const{styles:r}=n,t={};return r&&r.cellXfs.forEach((e,i)=>{const c={};if(e.xfId!=null&&r.cellStyleXfs&&r.cellStyleXfs[e.xfId]){const a=r.cellStyleXfs[e.xfId].format;Gt(a,r,c,!1)}Gt(e,r,c,!0),t[i]=c}),t}function mc(n){let r="";for(n+=1;n;){const t=(n-1)%26;r=String.fromCharCode(65+t)+r,n=Math.floor((n-t)/26)}return r}function Cc(n){const r=n.match(/[A-Z]+/);if(!r)return 0;let t=0;for(const e of r[0])t=t*26+(e.charCodeAt(0)-64);return t-1}function Oc(n){const r=n.match(/\d+/);return r?parseInt(r[0],10)-1:0}function Dc(n,r){return`${mc(n)}${r+1}`}function yc({cols:n,rows:r,selected:t,setSelected:e,enabled:i=!0}){Pn.useEffect(()=>{if(!i)return;function c(a){let g=Cc(t.address),h=Oc(t.address);const{key:f,shiftKey:o}=a;let u=!1;switch(f){case"ArrowLeft":g>0&&(g-=1,u=!0);break;case"ArrowRight":g<n-1&&(g+=1,u=!0);break;case"ArrowUp":h>0&&(h-=1,u=!0);break;case"ArrowDown":h<r-1&&(h+=1,u=!0);break;case"Tab":a.preventDefault(),(o?g>0:g<n-1)&&(g+=o?-1:1,u=!0);break;case"Enter":a.preventDefault(),(o?h>0:h<r-1)&&(h+=o?-1:1,u=!0);break;default:return}if(u){const s=Dc(g,h);e(h,s)}}return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[n,r,t.address,e,i])}const Lo=/([$]?[A-Z]+[$]?\d+)/g;function Lc(n){return Array.from(new Set(n.match(Lo)??[]))}const Pc=ko().domain(Array.from({length:12},(n,r)=>r.toString())).range(Go);function ze(n,r){if(n.value===""||n.value==null)return"";const t=r[n.styleIndex??0]??{};if(t.numberFormatCode){const e=Number(n.value);if(!Number.isNaN(e))try{return yo.format(t.numberFormatCode,e)}catch(i){return Ht.addError(i),n.value}}return n.value}function Po(n,r,t,e,i,c,a,g,h,f,o,u,s,l,v,d){function p(M,F,Y){let Q=t[F];if(!M)return Q;let j=F+1;for(;Y>Q&&j<t.length;){const rn=j;if(M.cells.find(In=>He(In.address)===rn)?.value)break;Q+=t[j],j++}return Q}n.save(),n.scale(o,o);const A=[0];for(let M=0;M<t.length;M++)A[M+1]=A[M]+t[M];const I=[0];for(let M=0;M<e.length;M++)I[M+1]=I[M]+e[M];const E=Math.max(0,A.findIndex(M=>M>=i)-1),N=Math.min(t.length-1,A.findIndex(M=>M>=i+a/o)+1),R=Math.max(0,I.findIndex(M=>M>=c)-1),C=Math.min(e.length-1,I.findIndex(M=>M>=c+g/o)+1);n.clearRect(0,0,a/o,g/o),n.fillStyle="white",n.fillRect(0,0,a/o,g/o);const D=new Map;for(const M of r.rows)D.set(M.index-1,M);for(let M=R;M<=C;M++){const F=D.get(M),Y=Jn+I[M]-c,Q=e[M];for(let j=E;j<=N;j++){const rn=Qn+A[j]-i,hn=t[j],In=F?.cells.find(un=>He(un.address)===j),Mn=`${Ge(j)}${M+1}`,cn=u[In?.styleIndex??0]??{};if(cn.fill&&(n.fillStyle=cn.fill,n.fillRect(rn,Y,hn,Q)),v.has(`${r.name}:${Mn}`)&&(n.fillStyle="#eeeeee",n.fillRect(rn,Y,hn,Q)),d&&h===M&&f===j&&(n.fillStyle="rgba(255,255,0,0.2)",n.fillRect(rn,Y,hn,Q)),r.showGridLines!==!1&&(n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(rn,Y,hn,Q)),cn.borders){const un=cn.borders;un.top&&(n.strokeStyle=un.top,n.beginPath(),n.moveTo(rn,Y),n.lineTo(rn+hn,Y),n.stroke()),un.bottom&&(n.strokeStyle=un.bottom,n.beginPath(),n.moveTo(rn,Y+Q),n.lineTo(rn+hn,Y+Q),n.stroke()),un.left&&(n.strokeStyle=un.left,n.beginPath(),n.moveTo(rn,Y),n.lineTo(rn,Y+Q),n.stroke()),un.right&&(n.strokeStyle=un.right,n.beginPath(),n.moveTo(rn+hn,Y),n.lineTo(rn+hn,Y+Q),n.stroke())}if(l.has(Mn)){const un=s[Mn];un&&(n.save(),n.fillStyle=un+"22",n.fillRect(rn,Y,hn,Q),n.restore(),n.strokeStyle=un,n.lineWidth=2,n.strokeRect(rn,Y,hn,Q))}if(In){n.save(),n.fillStyle=cn.textColor??"black",n.font=Rc(cn.font);const un=cn.align??"left";n.textAlign=un,n.textBaseline="middle";const Fn=ze(In,u),qn=n.measureText(Fn).width,Vn=rn;let $n=hn;un==="left"&&($n=p(F,j,qn)),n.beginPath(),n.rect(Vn,Y,$n,Q),n.clip();let J=rn+4;un==="center"?J=rn+hn/2:un==="right"&&(J=rn+hn-4),n.fillText(Fn,J,Y+Q/2),n.restore()}}}Tc(n,r,A,I,i,c,a/o,g/o),n.textAlign="center",n.textBaseline="middle",n.font="12px sans-serif";for(let M=E;M<=N;M++){const F=Qn+A[M]-i,Y=t[M];n.fillStyle=f===M?"#e0e0e0":"#f5f5f5",n.fillRect(F,0,Y,Jn),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(F,0,Y,Jn),n.fillStyle="#333",n.fillText(Ge(M),F+Y/2,Jn/2)}for(let M=R;M<=C;M++){const F=Jn+I[M]-c,Y=e[M];n.fillStyle=h===M?"#e0e0e0":"#f5f5f5",n.fillRect(0,F,Qn,Y),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(0,F,Qn,Y),n.fillStyle="#333",n.fillText((M+1).toString(),Qn/2,F+Y/2)}if(n.fillStyle="#f5f5f5",n.fillRect(0,0,Qn,Jn),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(0,0,Qn,Jn),h!=null&&f!=null){const M=Qn+A[f]-i,F=Jn+I[h]-c;n.strokeStyle="dodgerblue",n.lineWidth=2,n.strokeRect(M,F,t[f],e[h])}n.restore()}function Fc({workbook:n,selectedSheetIdx:r}){const{focusedWalnutId:t,setSelectedSheetIdx:e}=$o(),[i,c]=Pn.useState(r),[a,g]=Pn.useState({}),[h,f]=Pn.useState(!1),[o,u]=Pn.useState([]),s=Pn.useRef(new Set),[l,v]=Pn.useState({}),d=n.sheets[i],p=Pn.useMemo(()=>Mc(n),[n]),A=Pn.useMemo(()=>{const en=Array(500).fill(Yt);for(const an of d.columns){const En=Ho(an.width);for(let Tn=an.min-1;Tn<an.max;Tn++)en[Tn]=En}return en},[d.columns]),I=Pn.useMemo(()=>{const en=d.defaultRowHeight&&d.defaultRowHeight!==0?d.defaultRowHeight:Bt,an=Array(500).fill(at(en));for(const En of d.rows)(En.customHeight||En.height!==0)&&En.height!=null&&(an[En.index-1]=at(En.height));return an},[d]),[E,N]=Pn.useState(0),[R,C]=Pn.useState(""),D=Pn.useRef(null),M=Pn.useRef(null),[F,Y]=Pn.useState(1),[Q,j]=Pn.useState("A1"),rn=He(Q),hn=Yo(Q);function In(){if(f(!0),!R.startsWith("="))return;const J=Lc(R);u(J),v(Object.fromEntries(J.map((en,an)=>[en,Pc(an.toString())])))}function Mn(){f(!1),u([]),v({})}Pn.useEffect(()=>{f(!1),u([])},[Q,d]);const cn=Pn.useCallback(()=>{const J=M.current,en=D.current;if(!J||!en)return;const an=J.getContext("2d");if(!an)return;const En=en.clientWidth,Tn=en.clientHeight;J.width=En*window.devicePixelRatio,J.height=Tn*window.devicePixelRatio,J.style.width=`${En}px`,J.style.height=`${Tn}px`,an.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),Po(an,d,A,I,en.scrollLeft,en.scrollTop,En,Tn,hn,rn,F,p,l,new Set(o),s.current,h)},[d,A,I,hn,rn,F,p,l,o,h]);qo(()=>{cn()}),Pn.useEffect(()=>{const J=D.current;if(!J)return;const en=()=>cn(),an=()=>cn();return J.addEventListener("scroll",en),window.addEventListener("resize",an),()=>{J.removeEventListener("scroll",en),window.removeEventListener("resize",an)}},[cn]);function un(J){const en=D.current,an=M.current;if(!an||!en)return;const En=an.getBoundingClientRect(),Tn=J.clientX-En.left,Un=J.clientY-En.top,L=en.scrollLeft+Tn/F-Qn,P=en.scrollTop+Un/F-Jn;if(L<0||P<0)return;let V=0,b=0;for(;b<A.length&&V+A[b]<=L;)V+=A[b],b++;V=0;let U=0;for(;U<I.length&&V+I[U]<=P;)V+=I[U],U++;j(`${Ge(b)}${U+1}`),N(U)}Pn.useEffect(()=>{const J=d.rows[E]?.cells.find(en=>en.address===Q);C(J?J.formula?`= ${J.formula}`:ze(J,p):"")},[E,Q,d.rows,p]);function Fn(J){J.ctrlKey&&(J.preventDefault(),Y(en=>Math.min(4,Math.max(.5,en-J.deltaY*.001))))}yc({cols:A.length,rows:I.length,selected:{address:Q},setSelected:(J,en)=>{N(J),j(en)},enabled:!0}),Pn.useEffect(()=>{const J={SheetNames:[],Sheets:{}};for(const an of n.sheets){J.SheetNames.push(an.name);const En={};for(const Tn of an.rows)for(const Un of Tn.cells){const L={};if(Un.value!==""){const P=Number(Un.value);L.v=Number.isNaN(P)?Un.value:P}Un.formula&&(L.f=Un.formula),En[Un.address]=L}J.Sheets[an.name]=En}Ut.import_functions(fc);try{Ut(J,{continue_after_error:!0})}catch(an){Ht.addError(an)}for(const an of n.sheets){const En=J.Sheets[an.name];for(const Tn of an.rows)for(const Un of Tn.cells)if(Un.formula&&Un.value===""){const L=En[Un.address]?.v;L!=null?Un.value=String(L):Un.value="This formula is not supported in web preview. Please download the original file to view it fully."}}const en=d.rows[E]?.cells.find(an=>an.address===Q);en&&C(en.formula?`= ${en.formula}`:ze(en,p)),cn()},[n,E,Q,cn,d,p]);function qn(J){const en=D.current;if(en){g(En=>({...En,[i]:{left:en.scrollLeft,top:en.scrollTop}}));const an=a[i];en.scrollLeft=an?.left??0,en.scrollTop=an?.top??0}c(J),t&&e(t,J)}const Vn=A.reduce((J,en)=>J+en,0)+Qn,$n=I.reduce((J,en)=>J+en,0)+Jn;return Xn.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[Xn.jsxs("div",{ref:D,className:"relative flex-1 overflow-auto",onWheel:Fn,children:[Xn.jsx("canvas",{ref:M,className:"sticky start-0 top-0",onMouseDown:un}),Xn.jsx("div",{style:{width:Vn*F,height:$n*F}})]}),Xn.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-2 p-2 text-sm",children:[Xn.jsx("div",{className:"text-token-text-secondary w-14 px-2 text-center text-xs font-medium",children:Q}),Xn.jsxs("div",{className:"relative w-full",children:[h&&Xn.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center px-3 py-1 text-xs whitespace-pre",children:R.split(Lo).map((J,en)=>l[J]?Xn.jsx("span",{style:{color:l[J]},children:J},en):J)}),Xn.jsx("input",{type:"text",readOnly:!0,value:R,className:"bg-token-bg-secondary w-full rounded-md border-none px-3 py-1 text-xs",onFocus:In,onBlur:Mn})]}),Xn.jsx(Fo,{options:[.25,.5,.75,1,1.5,2,3,4].map(J=>({label:`${J*100}%`,value:J.toString()})),value:void 0,placeholder:`${Math.round(F*100)}%`,onValueChange:J=>Y(Number(J)),triggerClassName:"text-xs w-16 h-6"})]}),Xn.jsx("div",{className:"flex flex-row overflow-x-auto p-2 pt-0",children:n.sheets.map((J,en)=>Xn.jsx("button",{onClick:()=>qn(en),className:["rounded-b-md px-3 py-3 text-xs font-medium whitespace-nowrap",en===i?"text-token-text-primary bg-token-bg-tertiary":"text-token-text-secondary hover:text-token-text-primary"].join(" "),children:J.name},J.name))}),!1]})}const Hc=Object.freeze(Object.defineProperty({__proto__:null,SpreadsheetRenderer:Fc,drawViewport:Po},Symbol.toStringTag,{value:"Module"}));export{Yt as F,Ut as X,Bt as a,Mc as b,Ho as c,Po as d,fc as f,at as p,Hc as s};
//# sourceMappingURL=kzn4ha0q32870lv3.js.map

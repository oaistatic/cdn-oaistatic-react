const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dv2swzuufxyoljql.js","assets/cs7toih8jegb7teq.js","assets/hnw079jsdm76umup.js","assets/dmck639k4dv7claj.js","assets/root-mdlgku96.css","assets/conversation-small-b5ztx8w5.css","assets/hlzwxj9o6a2p2agm.js","assets/bclisdz93nm8yb3z.js","assets/i9evuzkcqd5jowdj.js","assets/jwhncdo48voofvub.js"])))=>i.map(i=>d[i]);
import{bQ as pl,e as ft,u as qs,ji as Cc,k4 as tr,aw as hl,ax as gl,z as Qs,aF as Ut,l2 as Ac,q as Xs,F as Zs,P as Oe,Q as Mc,V as qi,L as Ji,eg as Tc,c as ll,ao as sr,eq as Sl,d as rl,bi as _a,q$ as wc,c2 as nr,aM as or,aG as Ds,b8 as Ks,T as dt,bt as ar,pp as vc,fF as ir,bV as bl,d1 as le,fA as $s,et as Pc,bh as lr,ot as kc,o as rr,U as cr,fM as Ys,H as N,dE as ut,bc as jc,bd as dr,kJ as ur,pX as Rc,d2 as Ic,r0 as Ec,r1 as Dc,p as Mt,f2 as mr,bb as xe,j_ as Nc,lx as Bc,r2 as cl,eB as Ns,hS as Lc,hU as Hc,hV as Fc,ja as Oc,hW as Uc,r3 as Gc,f6 as fr,du as zc,eo as qe,r4 as Wc,r5 as $c,r6 as fa,b7 as Nl,gk as Vc,ba as mt,r7 as Kc,bZ as pr,de as yl,dO as hr,r8 as Yc,e6 as qc,r9 as Jc,em as gr,g as dl,cM as De,t as Sr,hr as ul,l3 as br,cC as _l,es as yr,eA as Qc,eu as xl,cK as Bl,ex as _r,ra as Xc,rb as Zc,kV as ed,aH as ml,cA as td,rc as sd,cE as nd,rd as xr,cL as Cr,re as od,k_ as ad,S as id,rf as ld,rg as rd,rh as cd,mO as dd,cH as ud,aT as Ar,jf as md,jk as Mr,ri as Tr,rj as fd,rk as pd,aN as wr,lk as vr,lo as Pr,b9 as hd,i as kr,lj as Qi,fW as gd,k as Sd,b6 as bd,rl as yd,fZ as _d,a$ as xd,bl as Cd,bS as Ad,hG as Md,cz as Td,ps as wd,rm as vd,hq as Pd,rn as kd,fj as jd,f0 as Rd,fy as Ll,kH as Id,bR as Ed,id as Dd,a_ as Nd,f3 as Bd,fz as Ld,p0 as Hd,fx as Fd,ro as Od,oY as Ud,oZ as Gd,iU as zd,aI as pa,gG as Hl,ez as Fl,j$ as Wd,o$ as $d,p1 as Vd,h$ as Kd,l4 as Yd,rp as Ol,v as Xi,N as Zi,fd as Ul,br as Gl,lm as qd,rq as Jd,rr as Qd,ll as Xd,b1 as Pe,jr as Zd,rs as eu,hC as tu,rt as su,f7 as nu,fJ as zl,fR as ha,ru as Wl,np as ou,p$ as au,rv as iu,jj as zs,G as lu,rw as ru,rx as cu,ry as du,qK as uu,fT as mu,e7 as fu,rz as pu,jB as $l,jv as Vl,e5 as hu,rA as gu,gT as Su,rB as bu,rC as yu,rD as _u,r as xu,fu as Cu,q0 as Au,la as Mu,a0 as Tu,fk as wu,rE as vu,bm as Pu}from"./dmck639k4dv7claj.js";import{e as ot,r as k,j as s,M as ke,c as Tt,a as jr,d as ku,b as ju}from"./cs7toih8jegb7teq.js";import{lM as Ru,lN as Iu,lO as el,b1 as Rr,dK as Ir,ae as Er,lP as Eu,lQ as Ue,lR as Bs,lS as C,lT as Du,lU as Nu,am as Bu,lV as Lu,lW as Dr,lX as Hu,lY as Fu,lZ as Ou,l_ as Uu,l$ as Gu,m0 as zu,m1 as Wu,m2 as $u,m3 as Vu,m4 as Ku,m5 as Yu,m6 as Kl,m7 as qu,m8 as Ju,m9 as Qu,ma as Xu,mb as Zu,mc as em,md as tm,me as sm,mf as nm,mg as om,mh as am,mi as im,mj as lm,mk as rm,i2 as cm,ml as dm,mm as um,mn as mm,mo as fm,mp as pm,mq as hm,mr as gm,ms as Sm,mt as bm,mu as ym,mv as _m,mw as xm,mx as Cm,my as Am,mz as Mm,mA as Tm,mB as wm,mC as vm,mD as Pm,mE as km,mF as jm,mG as Nr,mH as Rm,mI as Im,mJ as Em,cn as Dm,dC as Br,mK as Lr,be as Nm,mL as Bm,mM as Yl,mN as Lm,k8 as Hr,bz as Fr,mO as Hm,mP as Fm,mQ as ql,fy as ya,mR as Om,mS as Or,mT as Um,V as Gm,mU as zm,mV as Wm,mW as $m,mX as Vm,hW as Ur,mY as Km,eM as Js,ey as Gr,J as Ym,mZ as qm,m_ as Jm,m$ as Qm,n0 as Xm,n1 as Zm,n2 as ef,n3 as Jl,dW as tf,by as zr,n4 as sf,bs as nf,n5 as of,n6 as Wr,n7 as $r,n8 as af,n9 as lf,hE as rf,lu as cf,hC as df,hD as uf,na as Vr,nb as Kr,nc as tl,nd as mf,ne as ff,nf as sl,ng as pf,nh as hf,ni as fl,nj as gf,nk as Yr,nl as Sf,nm as bf,nn as yf,no as _f,np as xf,nq as Cf,nr as Af,ns as Mf,nt as Tf,nu as wf,nv as vf,P as Ql,nw as Pf,nx as kf,f3 as jf,f5 as Rf,ny as If,nz as Ef,nA as Df,nB as Nf,nC as Bf,nD as Lf,nE as Hf,nF as Ff,nG as Of,jy as Uf,nH as Gf,nI as zf,jC as nl,nJ as Wf,nK as Xl,nL as Zl,nM as $f,nN as Vf,hZ as Kf,nO as Yf,nP as qf,dG as Jf,nQ as ol,nR as Qf,nS as al,nT as Xf,nU as Zf,nV as ep,nW as tp,nX as sp,nY as np,nZ as op,fc as Ws,l9 as ap,n_ as ip,n$ as lp,o0 as rp,o1 as cp,o2 as dp,hQ as up,o3 as er,o4 as mp,o5 as fp,o6 as pp,dF as hp,o7 as gp,o8 as Sp,o9 as bp,oa as yp,ob as _p,oc as xp,od as Cp,dE as Ap,oe as Mp,of as Tp,og as wp,oh as vp,oi as Pp,oj as kp,ok as jp,ol as Rp,om as Ip,on as Ep,oo as Dp}from"./hnw079jsdm76umup.js";import{P as Np,u as Bp,C as Lp}from"./k4ghje9xipg90eb2.js";import{u as Hp}from"./lox5zdwgg3gy3k4z.js";import{getTabScreenshot as Fp}from"./itn5frgf3bcgdkwm.js";import{u as Op}from"./nfubiloo9rdxk3kj.js";import{P as Up,u as Gp,h as zp}from"./kizn5m1hr7kdjf9n.js";const xa="month",qr="year";function Wp(){const t=pl(),e=ft(),a=ot(),{markAsViewed:r}=qs(Ru),{initialBillingDetails:c}=Hp(t,!0),o=k.useMemo(()=>({...t?.subscriptionAnalyticsParams,referrer:document.referrer}),[t]);async function i(){try{await Eu(c,o)}catch{}}const{shouldShowBanner:f,discountValue:d,discountDuration:n}=Iu();if(k.useEffect(()=>{f&&d&&n&&el.logShowReferrerRedemptionBanner()},[f,d,n]),!f||!d||!n)return null;const x=$p(a,c,d,n),g=Vp(a,c,d,n),v=s.jsxs("div",{className:"grow",children:[s.jsx("div",{className:"mb-0.5 font-semibold",children:x}),s.jsx("span",{className:"text-token-text-secondary",children:g})]});return s.jsx(Rr,{onPrimaryCtaClick:()=>{r(),el.logClickReferrerRedeemButton(),i()},primaryCtaText:s.jsx(ke,{...Cc(e)}),onDismiss:()=>{r(),el.logCloseReferrerRedemptionBanner()},content:v})}function $p(t,e,a,r){const{currencySymbol:c}=Ir(Er(),e.currency),o=r?r.period:xa,i=r?r.num_periods:1,f=c.code.defaultMessage?.toString()??tr,d=t.formatNumber(a.value,{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:2});let n;return o===xa?n=i===1?s.jsx(ke,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:d}}):s.jsx(ke,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):o===qr&&(n=i===1?s.jsx(ke,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):s.jsx(ke,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}})),n}function Vp(t,e,a,r){const{currencySymbol:c}=Ir(Er(),e.currency),o=r?r.period:xa,i=r?r.num_periods:1,f=c.code.defaultMessage?.toString()??tr,d=t.formatNumber(a.value,{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:2});let n;return o===xa?n=i===1?s.jsx(ke,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used — claim your free month of Plus."}):s.jsx(ke,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:d,num_months:i}}):o===qr&&(n=i===1?s.jsx(ke,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:d}}):s.jsx(ke,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:d,num_years:i}})),n}const Kp=hl(()=>gl(()=>import("./dv2swzuufxyoljql.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.JawboneNotificationsBanner)),Yp=k.memo(function({className:e}){const{store:a}=Ue(),r=a.useIsHeaderContentAreaPopulated(),o=a.useContentAreaId(Bs.HeaderTop)===C.AgentModeAnnouncementBanner?"z-0":Du.PromptTextareaHeader;return s.jsx("div",{className:Qs(e??"absolute start-0 end-0 bottom-full",o),children:s.jsx(Nu,{shouldRender:r,contentArea:Bs.Header,children:s.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[s.jsx(qp,{}),s.jsx(Jp,{})]})})})});function qp(){const{store:t}=Ue(),e=t.useSharedProps(n=>n?.clientThreadId),a=t.useContentAreaId(Bs.HeaderTop),r=Bu(),c=Ut(e,n=>n?.modelId),o=Lu.useStore(),i=Ac(),f=Xs(Zs);let d;switch(a){case C.ProjectConversationTaskNoFileAccess:d=s.jsx(eh,{});break;case C.AdvancedVoiceOnMobileAnnouncement:d=s.jsx(Zu,{clientThreadId:e});break;case C.S09KM1:d=null;break;case C.BannerSignup:d=s.jsx(Zp,{});break;case C.BannerTermsDisclaimer:d=s.jsx(th,{});break;case C.NewUserBannerTermsDisclaimer:d=s.jsx(sh,{});break;case C.PromptTextareaAction:d=s.jsx(nh,{});break;case C.BannersRateLimit:d=s.jsx(oh,{});break;case C.BannersBeaconUI:d=s.jsx(ah,{});break;case C.BannerSidekickAnnouncement:d=s.jsx(Xu,{});break;case C.SearchBrowserExtensionAnnouncement:d=s.jsx(Qu,{});break;case C.MoonshineAnnouncement:d=s.jsx(Ju,{});break;case C.SearchBrowserExtensionReactiveAnnouncement:d=s.jsx(qu,{});break;case C.BannerMemoryAlmostFull:d=s.jsx(Kl,{memoryAlmostFullVariant:!0});break;case C.BannerMemoryFull:d=s.jsx(Kl,{});break;case C.Box:d=s.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",s.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",s.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case C.JawboneAnnouncement:r?d=s.jsx(Kp,{}):d=null;break;case C.JawboneMaxActiveAnnouncement:r?d=s.jsx(Yu,{}):d=null;break;case C.PromoRedemptionAnnouncement:d=s.jsx(Np,{});break;case C.OperatorAnnouncement:d=s.jsx(Ku,{});break;case C.BannerPlusUpsell:d=s.jsx(Vu,{});break;case C.BannerNoAuthTrials:d=s.jsx($u,{});break;case C.ReferrerRedemptionAvailableAnnouncement:d=s.jsx(Wp,{});break;case C.RefereeRedemptionAvailableAnnouncement:d=s.jsx(Wu,{});break;case C.ReferralProgramUpsellAnnouncement:d=s.jsx(zu,{});break;case C.TatertotIntakeFormAnnouncement:d=!1;break;case C.StudentsUpsellAnnouncement:d=s.jsx(Gu,{});break;case C.ModelDeprecationBanner:d=Uu(c);break;case C.TeamsContextualAnswersUpsell:d=s.jsx(Ou,{});break;case C.AgentModeAnnouncementBanner:d=i&&!f&&s.jsx(Fu,{});break;case C.LanguageUpsellBanner:d=s.jsx(Hu,{onDismissSideEffect:()=>{Oe.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),o.closeBanner()},onPrimaryCtaClickSideEffect:()=>{Oe.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),o.closeBanner()}});break;default:d=null;break}return d}function Jp(){const{store:t}=Ue(),e=t.useContentAreaId(Bs.HeaderBottom);let a;switch(e){case Dr.DallePromptControls:a=s.jsx(Xp,{});break;default:a=null;break}return a}const Qp=hl(()=>gl(()=>import("./bclisdz93nm8yb3z.js"),__vite__mapDeps([7,1,3,4,2,5])).then(t=>t.default));function Xp(){const{store:t}=Ue(),e=t.useSharedProps(a=>a?.composerController);return e?s.jsx(Qp,{composerController:e}):null}function Zp(){const{store:t}=Ue(),e=t.useSharedProps(c=>c?.clientThreadId),a=Mc(),r=am();return e?a?s.jsx(im,{threadId:e,showSignUp:r}):s.jsx(lm,{threadId:e,showLogin:r}):null}function eh(){return k.useEffect(()=>()=>{qi.getItem(Ji.TasksHasSeenProjectDisclaimerBanner)||qi.setItem(Ji.TasksHasSeenProjectDisclaimerBanner,!0)},[]),s.jsx(Rr,{icon:s.jsx(Tc,{}),title:s.jsx(ke,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:s.jsx(ke,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{qi.setItem(Ji.TasksHasSeenProjectDisclaimerBanner,!0)}})}function th(){const{store:t}=Ue(),e=t.useSharedProps(a=>a?.clientThreadId);return e?s.jsx(om,{threadId:e}):null}function sh(){const{store:t}=Ue(),e=t.useSharedProps(a=>a?.clientThreadId);return e?s.jsx(nm,{threadId:e}):null}function nh(){const{store:t}=Ue(),e=t.useSharedProps();return e?s.jsx(sm,{...e}):null}function oh(){const{store:t}=Ue(),e=t.useSharedProps(r=>r?.clientThreadId),a=t.useSharedProps(r=>r?.composerController);return!e||!a?null:s.jsx(tm,{clientThreadId:e,composerController:a})}function ah(){const{store:t}=Ue(),e=t.useSharedProps(c=>c?.openFileDialog),a=t.useSharedProps(c=>c?.clientThreadId),r=t.useSharedProps(c=>c?.composerController);return!a||!r||!e?null:s.jsx(em,{clientThreadId:a,openFileDialog:e})}const ih=5,lh=k.memo(function(e){return rh(e),ch(e),rm({clientThreadId:e.clientThreadId,composerController:e.composerController,openFileDialog:e.openFileDialog}),dh(),null});function rh(t){const{store:e}=Ue(),a=e.useSetSharedProps();ll(()=>{a(t)},[t,a])}function ch(t){const{clientThreadId:e,canContinue:a}=t,{store:r}=Ue(),c=ft(),o=k.useRef({top:r.useContentAreaApi(Bs.HeaderTop),bottom:r.useContentAreaApi(Bs.HeaderBottom)}).current,i=cm(e),{shouldShowBannerSignup:f,shouldShowBannerTermsDisclaimer:d}=uh(e),{isOpen:n}=dm(),x=um(e),g=mm(e),v=fm(t);pm(t);const y=hm(),E=gm(t),{shouldShowMemoryFull:I,shouldShowMemoryAlmostFull:H}=Sm(e),B=bm(t),w=ym(e),O=_m(e),S=Bp(),{eligible:L}=qs(xm),b=Cm(),A=Am(),K=Mm(),W=Tm(),u=wm(e),_=vm(e),R=Pm(),l=km(),J=jm(e),te=Ut(e,D=>D?.modelId),ne=sr(e),ie=Sl(),oe=Nr(),{eligible:ce}=qs(rl.hasSeenAgentModeAnnouncementBanner),T=ce&&oe&&ie!==Ks;ll(()=>{d?o.top.set(C.BannerTermsDisclaimer):n?o.top.set(C.NewUserBannerTermsDisclaimer):te&&ne?.kind===_a.GizmoInteraction&&ne.gizmo&&wc(te,ne.gizmo)?o.top.set(C.ProjectConversationTaskNoFileAccess):B.eligible?o.top.set(C.AdvancedVoiceOnMobileAnnouncement):x?o.top.set(C.BannersRateLimit):g?o.top.set(C.BannersBeaconUI):R?o.top.set(C.BannerPlusUpsell):l?o.top.set(C.BannerNoAuthTrials):w?o.top.set(C.JawboneAnnouncement):O?o.top.set(C.JawboneMaxActiveAnnouncement):v.eligible?o.top.set(C.BannerSidekickAnnouncement):y?o.top.set(C.MoonshineAnnouncement):E?o.top.set(C.SearchBrowserExtensionReactiveAnnouncement):S?o.top.set(C.PromoRedemptionAnnouncement):L?o.top.set(C.OperatorAnnouncement):K?o.top.set(C.ReferralProgramUpsellAnnouncement):a?o.top.set(C.PromptTextareaAction):f?o.top.set(C.BannerSignup):H&&nr(c,"1206459705").get("upsell_variant","control")!=="control"?o.top.set(C.BannerMemoryAlmostFull):I?o.top.set(C.BannerMemoryFull):b?o.top.set(C.ReferrerRedemptionAvailableAnnouncement):A?o.top.set(C.RefereeRedemptionAvailableAnnouncement):W?o.top.set(C.StudentsUpsellAnnouncement):u?o.top.set(C.ModelDeprecationBanner):_?o.top.set(C.TeamsContextualAnswersUpsell):J?o.top.set(C.LanguageUpsellBanner):T?o.top.set(C.AgentModeAnnouncementBanner):o.top.set(null)},[o,ie,a,d,n,f,x,v,I,B,T]),ll(()=>{i&&o.bottom.set(Dr.DallePromptControls)},[o,i])}function dh(){const{store:t}=Ue();k.useEffect(()=>()=>{t.reset()},[t])}function uh(t){const e=ft(),{isUnauthenticated:a}=or(),r=Ds(e,"3637408529",{disableExposureLog:!0}),o=Ds(e,"3637408529").get("no_auth_banner_signup_rate_limit",ih),i=r.get("should_show_no_auth_signup_banner",!0),f=Rm(v=>v.bannerDisclaimerClientThreadId),d=Im(),n={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[x,g]=Ut(t,v=>[dt.getConversationTurns(v).filter(y=>y.role===ar.User).length,mh(dt.getCurrentNode(v)?.message)]);return t&&(n.shouldShowBannerTermsDisclaimer=g&&a&&x===1&&!d&&(f==null||f===t),n.shouldShowBannerSignup=i&&g&&a&&x>0&&x%o===0),n}function mh(t){return t?.author.role===ar.Assistant&&vc(t)}function fh({modelSupportedImageMimeTypes:t}){const e=Xs(Zs),a=ir(),r=bl(),c=ot();return e?s.jsx(le.Item,{icon:Em,onClick:async()=>{const o=await Fp();if(o)try{const i=atob(o.base64image),f=i.length,d=new Uint8Array(f);for(let x=0;x<f;x++)d[x]=i.charCodeAt(x);const n=new File([d],o.filename,{type:o.mimetype});Dm.uploadFile(a,n,t,c,r,void 0,void 0,$s.Multimodal)}catch{}},children:s.jsx(ke,{id:"HiFPUD",defaultMessage:"Attach screenshot"})},"attach_screenshot"):null}const ph="manage-prompts",hh=()=>({data:null,isLoading:!1});function Vs(t){return typeof t=="object"&&t!=null&&"command"in t}function gh(t){"use forget";const e=Tt.c(11),{command:a,isHighlighted:r,onHighlight:c,onClick:o}=t;let i;e[0]!==a.title?(i=s.jsx("span",{className:"break-all",children:a.title}),e[0]=a.title,e[1]=i):i=e[1];let f;return e[2]!==a.disabled||e[3]!==a.icon||e[4]!==a.secondary||e[5]!==a.trailing||e[6]!==r||e[7]!==o||e[8]!==c||e[9]!==i?(f=s.jsx(pr,{as:"div",hasManagedFocus:!0,disabled:a.disabled,highlighted:r,icon:a.icon,secondary:a.secondary,trailing:a.trailing,onPointerMove:c,onClick:o,children:i}),e[2]=a.disabled,e[3]=a.icon,e[4]=a.secondary,e[5]=a.trailing,e[6]=r,e[7]=o,e[8]=c,e[9]=i,e[10]=f):f=e[10],f}function Sh({hint:t,isHighlighted:e,onHighlight:a,onClick:r}){"use no forget";const c=Or(t.systemHint),o=s.jsx(pr,{as:"div",hasManagedFocus:!0,disabled:c.isBlocked,highlighted:e,icon:s.jsx(Um,{hint:t,isNextToLabel:!0}),secondary:c.blockedLabel,onPointerMove:a,onClick:r,children:s.jsx("span",{className:"break-all",children:t.name})});return c.remainingLabel?s.jsx(yl,{side:"right",labelTextAlign:c.isBlocked?"left":"center",label:c.remainingLabel,secondaryLabel:c.remainingLabelSecondary,contentClassName:"cant-hover:hidden",triggerAs:null,children:o}):o}const bh=Kc(t=>Vs(t)?{targets:[t.command,...t.aliases??[],...t.regexMatches??[],t.secondary?`${t.title} ${t.secondary}`:t.title],weight:t.matchWeight}:{targets:[t.systemHint,...t.aliases??[],...t.regexMatches??[],t.name]});function yh({gptsSlashCommands$:t,modelSlashCommands$:e,libraryPromptSlashCommands:a,slashCommands:r,systemHints:c,composerController:o,clientThreadId:i,layoutMode:f}){"use forget";const d=ft(),n=jr(),x=ot(),{refs:g,floatingStyles:v}=Lc({placement:f==="center"?"bottom-start":"top-start",middleware:[Hc({mainAxis:10,alignmentAxis:-18}),Fc({padding:6}),Oc({apply:({elements:P,availableWidth:z,availableHeight:p})=>{P.floating.style.setProperty("--radix-popper-available-width",`${z}px`),P.floating.style.setProperty("--radix-popper-available-height",`${p}px`)}})],whileElementsMounted:Uc}),[y,E]=k.useState(void 0);k.useEffect(()=>{const P=xe(o);P.dispatch(Gc(P.state.tr,{setReferencePosition:g.setReference,onHintMatch(z){E(p=>hr(p,z)?p:z)}}))},[o,g]);const I=Hm(),H=fr(i),{setThreadSystemHintMode:B,clearAllSystemHintModeTriggers:w}=zc(),O=Xs(Zs),S=qe(()=>y&&t?.()),L=qe(()=>e?.()??[]),b=y?.triggerSymbol==="@",A=!1,K=k.useCallback(()=>{},[d]),W=k.useMemo(()=>b?O?[]:[S??[]]:[r,c,L],[b,a,S,r,c,L,A,x,n,K,O]),{displayGroups:u,suggestions:_}=k.useMemo(()=>{if(!y)return{displayGroups:[],suggestions:[]};const P=y.text?[Fm(ql(W),y.text,bh,{locale:x.locale})]:W.map(p=>p.filter(j=>!Vs(j)||!j.noMatchEmpty)),z=f==="bottom"?P.reverse().map(p=>p.reverse()):P;return{displayGroups:z,suggestions:ql(z)}},[W,y,f,x]),[R,l]=k.useState(f==="bottom"?-1:0),J=R==null?null:(R+_.length)%_.length,te=k.useCallback(P=>{l(z=>{if(z==null)return null;const p=_.length;for(let j=0;j<p;j++){const Q=(z+p+(j+1)*P)%p,F=_[Q];if(!("systemHint"in F?I.includes(F.systemHint):F.disabled))return Q}return null})},[_,I]),ne=ya(te),ie=_.length,oe=ie===0;k.useEffect(()=>{f==="bottom"?(l(0),ne.current(-1)):(l(-1),ne.current(1))},[ie,f,ne]);const ce=J==null?null:_[J],T=k.useCallback(()=>{if(y?.range){const P=xe(o);Wc(P,y.range.from,y.range.to)}},[y,o]),D=({hintToSave:P=ce,expectPerfectMatch:z})=>{if(!y||!P)return!1;const p=y.text.toLocaleLowerCase(),Q=(Vs(P)?P.command:P.name).toLocaleLowerCase()===p||P.aliases?.some(pe=>pe.toLocaleLowerCase()===p);if(z&&!Q)return!1;if(T(),fa(xe(o)),Vs(P))return P.onSelect(),!0;Oe.logEvent("System Hint Selected",{system_hint:P.systemHint,conversation_id:H??Nl});const F={clientThreadId:i};w();const he=P.systemHint===N.Search;return B(P.systemHint,!0,F,he?Om.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),!0},U=ya(D);k.useEffect(()=>{const P=xe(o);return oe||$c(P,z=>{if(z==="up")ne.current(-1);else if(z==="down")ne.current(1);else if(z==="cancel")fa(P),Yc(P);else{if(z==="submit")return fa(P),U.current({expectPerfectMatch:!1});if(z==="checkMatch")return U.current({expectPerfectMatch:!0})}}),()=>fa(P)},[o,oe,ce,T,ne,U]);const G=ya(H);return k.useEffect(()=>{oe||Oe.logEvent("System Hint List Opened",{conversation_id:G.current??Nl})},[G,oe]),oe?null:s.jsx(Vc,{ref:P=>{g.setFloating(P)},style:v,className:Qs("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",_.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]"),onPointerDown:P=>{P.preventDefault()},children:u.map((P,z)=>{let p=0;for(let j=0;j<z;j++)p+=u[j].length;return s.jsx(le.Group,{children:P.map((j,Q)=>{const F=p+Q;return Vs(j)?s.jsx(gh,{command:j,isHighlighted:F===J,onHighlight:()=>l(F),onClick:()=>{D({hintToSave:j,expectPerfectMatch:!1}),mt(xe(o))}},j.command):s.jsx(Sh,{hint:j,isHighlighted:F===J,onHighlight:()=>l(F),onClick:()=>{D({hintToSave:j,expectPerfectMatch:!1}),mt(xe(o))}},j.systemHint)})},z)})})}function _h(t){"use forget";const e=Tt.c(82),{systemHints:a,availableSystemHints:r,composerController:c,clientThreadId:o,layoutMode:i,composerLayer:f,canUseInlineTagging:d,isFileUploadEnabled:n,fileUploadDisabledReason:x,currentModelConfig:g,openFileDialog:v,connectionInstanceData:y,setActiveSystemHintType:E,defaultModelId:I,selectModelId:H,gizmoId:B,hasGizmoFeatureRateLimit:w,setSelectedGizmoTag:O}=t,S=ft(),L=ot(),b=jr(),{connectedTypes:A}=Pc(),K=lr();let W;e[0]!==K?(W=K!=null&&kc(K),e[0]=K,e[1]=W):W=e[1];const u=W,{data:_}=rr(cr.DeveloperMode),{isSingleLine:R,showModelSlashCommands:l}=f;y?.connection_statuses;let J,te;if(e[2]!==o||e[3]!==A||e[4]!==y?.connection_statuses||e[5]!==S||e[6]!==g?.title||e[7]!==x||e[8]!==L||e[9]!==_||e[10]!==n||e[11]!==u||e[12]!==R||e[13]!==b||e[14]!==v||e[15]!==E||e[16]!==a){if(te=[],R){let $;e[18]===Symbol.for("react.memo_cache_sentinel")?($=["file","attach","photo"],e[18]=$):$=e[18];const de=!n,Y=g?.title;let me;e[19]!==S||e[20]!==x||e[21]!==L||e[22]!==de||e[23]!==Y?(me=Br(S,L,de,x,Y),e[19]=S,e[20]=x,e[21]=L,e[22]=de,e[23]=Y,e[24]=me):me=e[24];let se;e[25]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(Lr,{"aria-label":"",className:"icon"}),e[25]=se):se=e[25];const re=!n;let Ne;e[26]!==v||e[27]!==me||e[28]!==re?(Ne={command:"upload",aliases:$,title:me,icon:se,onSelect:v,disabled:re},e[26]=v,e[27]=me,e[28]=re,e[29]=Ne):Ne=e[29],te.push(Ne)}let ue;e[30]!==y?.connection_statuses?(ue=y?.connection_statuses.filter(kh).map(Ph)??[],e[30]=y?.connection_statuses,e[31]=ue):ue=e[31];const ae=ue,be=a?.some(vh);if(u&&(A.size>0||ae.length>0)&&be){let $;e[32]!==L?($=L.formatMessage({id:"6YT2cp",defaultMessage:"Use all connectors"}),e[32]=L,e[33]=$):$=e[33];let de;e[34]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(Nm,{}),e[34]=de):de=e[34];let Y;e[35]!==o||e[36]!==ae||e[37]!==A||e[38]!==E?(Y=()=>{E(N.Slurm,{analyticsMetadata:{clientThreadId:o}}),ut(o,se=>{const re=se.selectedSources?.get(N.Slurm)??new Set;se.selectedSources==null&&(se.selectedSources=new Map),se.selectedSources.set(N.Slurm,new Set([...re,...A,...ae]))})},e[35]=o,e[36]=ae,e[37]=A,e[38]=E,e[39]=Y):Y=e[39];let me;e[40]!==$||e[41]!==Y?(me={command:"all-connectors",title:$,icon:de,noMatchEmpty:!0,onSelect:Y},e[40]=$,e[41]=Y,e[42]=me):me=e[42],te.push(me)}if(_){let $;e[43]===Symbol.for("react.memo_cache_sentinel")?($=["mcp"],e[43]=$):$=e[43];let de;e[44]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(Bm,{}),e[44]=de):de=e[44];let Y;e[45]!==b?(Y={command:"add-mcp",aliases:$,title:"Add MCP",icon:de,noMatchEmpty:!0,onSelect:()=>{b(jc(dr.Connectors))}},e[45]=b,e[46]=Y):Y=e[46],te.push(Y)}e[2]=o,e[3]=A,e[4]=y?.connection_statuses,e[5]=S,e[6]=g?.title,e[7]=x,e[8]=L,e[9]=_,e[10]=n,e[11]=u,e[12]=R,e[13]=b,e[14]=v,e[15]=E,e[16]=a,e[17]=te}else te=e[17];J=te;const ne=J;let ie,oe;e[47]!==S||e[48]!==I||e[49]!==H||e[50]!==l?(oe=Ys(()=>{if(!l)return[];const ue=ur(S),{data:ae}=ue();if(!ae)return[];const be=[];for(const $ of ae.categories)$.defaultModel!==I&&be.push({command:$.defaultModel,title:$.label,disabled:!1,icon:s.jsx(Yl,{className:"icon"}),onSelect:()=>{H($.defaultModel,"slash menu")}});for(const $ of ae.groups)for(const de of $.modelIds){const Y=ae.models.get(de);if(Y&&!Y.tags.includes(Rc.HIDDEN)){let me=Y.title;be.push({command:Y.id,title:me,secondary:void 0,trailing:s.jsx(Ic,{children:$.label}),noMatchEmpty:!0,matchWeight:.1,disabled:!1,icon:s.jsx(Yl,{className:"icon"}),onSelect:()=>{H(Y.id,"slash menu")}})}}return be}),e[47]=S,e[48]=I,e[49]=H,e[50]=l,e[51]=oe):oe=e[51],ie=oe;const ce=ie;let T,D;e[52]!==d||e[53]!==S||e[54]!==B||e[55]!==w||e[56]!==O?(D=Ys(()=>{if(!d)return[];const ue=Ec(S),ae=Dc(S),be=Lm(S),{data:$}=ue(),{data:de}=ae(),{data:Y}=be(),me=Hr([...$?.items??[],...de?.list.items?.map(wh)??[],...Mt(S,"773249106")?Y?.items?.map(Th)??[]:[]],Mh);return(B?me.filter(re=>re.gizmo.id!==B):me).map(re=>({command:re.gizmo.display.name,title:re.gizmo.display.name,disabled:w,icon:s.jsx(Fr,{simple:!0,isFirstParty:re.gizmo.tags?.includes(mr.FirstParty)===!0,src:re.gizmo.display.profile_picture_url,className:"icon",alt:""}),onSelect:()=>{Oe.logEventWithStatsig("Composer GPT Selected","chatgpt_web_composer_gpt_selected",{gizmo:re.gizmo.id}),O(re)}}))}),e[52]=d,e[53]=S,e[54]=B,e[55]=w,e[56]=O,e[57]=D):D=e[57],T=D;const U=T;let G;e[58]!==S?(G=!1,e[58]=S,e[59]=G):G=e[59];const P=G;let z;e[60]!==P?(z={enabled:P},e[60]=P,e[61]=z):z=e[61];const{data:p}=hh();let j;e[62]!==o||e[63]!==c||e[64]!==b||e[65]!==E?(j=ue=>{const ae=xe(c);if(Nc(ae,"@"),ue===ph){b("/library?tab=prompts");return}if(ut(o,Ah),Oe.logEventWithStatsig("chatgpt_web_prompt_used","chatgpt_web_prompt_used",{referer:"at_cmd",hint:ue.system_hint??"none",sources:(ue.sources??[]).join(",")}),Bc(ae,ue.prompt),ue.system_hint&&(E(ue.system_hint),ue.sources?.length)){const be=ue.sources.map(Ch).filter(cl),$=ue.system_hint,de=new Set(be.filter(xh)),Y=new Set(be.filter(Ns));ut(o,me=>{me.selectedSources=new Map([[$,de]]),me.selectedMCPSources=new Map([[$,Y]]),me.hasModifiedSources=!0})}},e[62]=o,e[63]=c,e[64]=b,e[65]=E,e[66]=j):j=e[66];const Q=j;let F;e:{if(!P){let ae;e[67]===Symbol.for("react.memo_cache_sentinel")?(ae=[],e[67]=ae):ae=e[67],F=ae;break e}let ue;e[68]!==Q||e[69]!==p?.prompts?(ue=p?.prompts.map(ae=>({command:ae.name,title:ae.name,icon:void 0,onSelect:()=>{Q(ae)}})),e[68]=Q,e[69]=p?.prompts,e[70]=ue):ue=e[70],F=ue}const he=F;let pe;e[71]!==r?(pe=r??[],e[71]=r,e[72]=pe):pe=e[72];let je;return e[73]!==o||e[74]!==c||e[75]!==U||e[76]!==i||e[77]!==he||e[78]!==ce||e[79]!==ne||e[80]!==pe?(je=s.jsx(yh,{gptsSlashCommands$:U,modelSlashCommands$:ce,libraryPromptSlashCommands:he,slashCommands:ne,systemHints:pe,composerController:c,clientThreadId:o,layoutMode:i}),e[73]=o,e[74]=c,e[75]=U,e[76]=i,e[77]=he,e[78]=ce,e[79]=ne,e[80]=pe,e[81]=je):je=e[81],je}function xh(t){return!Ns(t)}function Ch(t){return t.trim()}function Ah(t){t.isUsingPromptTemplate=!0}function Mh(t){return t.gizmo.id}function Th(t){return t.gizmo}function wh(t){return t.resource}function vh(t){return t.systemHint===N.Slurm}function Ph(t){return t.user_connection_details.connection_type}function kh(t){return t.user_connection_details.activation_status==="activated"&&["google_drive_oauth","google_drive_dwd"].includes(t.user_connection_details.knowledge_connector_type)}function jh(t){"use forget";const e=Tt.c(30),{clientThreadId:a,modelSupportedImageMimeTypes:r,openFileDialog:c,historyDisabled:o,isDisabled:i,highlightTooltip:f,disabledReason:d,currentModelName:n,isLoadingConnectors:x,connectorConfig:g,onSelectConnector:v,onConnectorOauthRedirect:y,showLabel:E,showUpsell:I,hideBorder:H,isSmall:B,showMenuForNoAuth:w,visualTreatment:O}=t,S=qc(),{gdriveStatus:L,o365Status:b}=Jc(),{isUnauthenticated:A}=or(),K=o?"text-white":f?"text-brand-blue-800":"",W=!I&&(L!=="false"||b!=="false"||S),u=A?Lr:Gm;let _;e[0]!==K?(_=Qs("icon",K),e[0]=K,e[1]=_):_=e[1];let R;e[2]!==u||e[3]!==_?(R=s.jsx(u,{"aria-label":"",className:_}),e[2]=u,e[3]=_,e[4]=R):R=e[4];const l=R,J=r.length>0;let te;e[5]!==a||e[6]!==g||e[7]!==n||e[8]!==d||e[9]!==H||e[10]!==f||e[11]!==l||e[12]!==i||e[13]!==x||e[14]!==B||e[15]!==A||e[16]!==r||e[17]!==J||e[18]!==y||e[19]!==v||e[20]!==c||e[21]!==W||e[22]!==E||e[23]!==w||e[24]!==I||e[25]!==O?(te=W?s.jsx(zm,{clientThreadId:a,icon:l,showLabel:A&&E,modelSupportedImageMimeTypes:r,isLoadingConnectors:x,connectorConfig:g,onSelectConnector:v,onConnectorOauthRedirect:y,openFileDialog:c,isDisabled:i,highlightTooltip:f,disabledReason:d,currentModelName:n}):s.jsx(Up,{isSmall:B,hideBorder:H,clientThreadId:a,openFileDialog:c,showLabel:E,showUpsell:I,icon:l,isDisabled:i,highlightTooltip:f,disabledReason:d,currentModelName:n,visualTreatment:O,showMenuForNoAuth:w,modelSupportsImages:J}),e[5]=a,e[6]=g,e[7]=n,e[8]=d,e[9]=H,e[10]=f,e[11]=l,e[12]=i,e[13]=x,e[14]=B,e[15]=A,e[16]=r,e[17]=J,e[18]=y,e[19]=v,e[20]=c,e[21]=W,e[22]=E,e[23]=w,e[24]=I,e[25]=O,e[26]=te):te=e[26];const ne=te;let ie;return e[27]!==ne||e[28]!==f?(ie=s.jsx(Wm,{showBackground:f,className:"bg-brand-blue-800/20",children:ne}),e[27]=ne,e[28]=f,e[29]=ie):ie=e[29],ie}const il=6,Rh=(t,e=!1)=>{const a=t.some(c=>!c.disabled),r=e?[...t]:a?t.filter(c=>!c.disabled):[...t];return r.sort((c,o)=>c.connected&&!o.connected?-1:!c.connected&&o.connected?1:c?.isAutoConnected&&!o?.isAutoConnected||c.type==="web"&&o.type!=="web"?-1:c.type!=="web"&&o.type==="web"?1:c.name.localeCompare(o.name)),r};function Ot(t){switch(t.user_connection_details.activation_status){case"activated":case"partially_activated":return!0;case"activating":case"inactive":return!1}}const Ca=t=>Dh[t.user_connection_details.connection_type]??t.connection_display_info.display_name,Ih=new Set(["sharepoint_sync_connector"]),Eh=({isLoading:t=!1,clientThreadId:e,enabledConnectors:a,includeWebSearch:r=!0,includeCloudBrowser:c=!1,includeSyncConnectors:o=!1,connectorConfigMap:i,fetchValidLinksOnly:f,systemHintType:d,selectedSources:n,selectedMCPSources:x,showConnectMore:g=!0,toggleSource:v,contentRef:y})=>{"use forget";const E=ot(),I=yr(),B=!!(pl()?.isPersonalAccount()&&I),{openSettings:w}=Ym(),O=ft(),S=Ut(e,U=>U?.startedWithMcp),L=S===!1,b=S===!0,{connectorLinks:A,isLoading:K}=Qc({fetchValidLinksOnly:f}),{allAutoConnectors:W}=xl({getDisabledAutoConnectors:!1}),{connectionInstanceData:u,refetch:_,isLoading:R}=_l({skip:!o}),l=k.useMemo(()=>u?.connection_statuses??[],[u]),J=k.useMemo(()=>new Set(l.map(U=>U.user_connection_details.connection_type).filter((U,G,P)=>P.indexOf(U)!==G)),[l]),{enabledConnectors:te,connectorConfigMap:ne,connectorLinks:ie}=k.useMemo(()=>{if(!o)return{enabledConnectors:a,connectorConfigMap:i,connectorLinks:A};const U=Bl[De.GDRIVE_ACTION_CONNECTOR],G=A.has(U),P=l.some(F=>F.user_connection_details.connection_type==="gdrive_sync_connector"),z=l.some(F=>F.user_connection_details.connection_type==="gdrive_sync_connector"&&Ot(F));let p=[...a];const j=new Map(i),Q=new Map(A);return G&&!p.some(F=>F.type===De.GDRIVE_ACTION_CONNECTOR)&&!P?(p.push({id:Bl[De.GDRIVE_ACTION_CONNECTOR],type:De.GDRIVE_ACTION_CONNECTOR,name:"Google Drive",description:"",logo_url:qm,connector_type:"SERVICE",service:"",base_url:null,actions:[],supported_auth:[],owners:[],access_list:[],conformance:{implements_retrievable:!0}}),j.set(De.GDRIVE_ACTION_CONNECTOR,{disabled:!0,disabledText:E.formatMessage(nt.contactAdmin),hasBetaTag:!1}),Q.delete(U)):B&&z&&(p=p.filter(F=>{if(F.type===De.GDRIVE_ACTION_CONNECTOR){const he=Q.get(F.id)?.[0];if(l.some(pe=>pe.user_connection_details.backing_link_id===he?.id))return!1}return!0})),l.forEach(F=>{Ot(F)&&F.user_connection_details.backing_link_id&&Q.forEach((he,pe)=>{he.some(je=>je.id===F.user_connection_details.backing_link_id)&&(p=p.filter(je=>je.id!==pe))})}),{enabledConnectors:p,connectorConfigMap:j,connectorLinks:Q}},[o,A,l,a,i,B,E]),{connectedRows:oe,disconnectedRows:ce}=k.useMemo(()=>{const U=[];r&&U.push({connected:!0,type:"web",name:"web",element:s.jsx(le.CheckboxItem,{icon:Ur,disabled:b,checked:n?.has("web"),onCheckedChange:()=>{v("web")},children:E.formatMessage(nt.webSearch)})}),c&&U.push({connected:!0,type:"cloud",name:"cloud",element:s.jsx(le.CheckboxItem,{icon:Jm,disabled:b,checked:n?.has("cloud"),onCheckedChange:()=>{v("cloud")},children:E.formatMessage(nt.cloudBrowser)})}),o&&l.forEach(p=>{if(!(B&&p.user_connection_details.connection_type==="gdrive_sync_connector"&&!Ot(p))){{if(!Ot(p)&&p.user_connection_details.backing_link_id)return;if(p.user_connection_details.connection_type==="github_sync_connector")return;if(!Ot(p)&&Ih.has(p.user_connection_details.connection_type))return}U.push({connected:p.user_connection_details.auth_status!=="not_connected"&&p.user_connection_details.activation_status!=="inactive",type:"sync",name:Ca(p),element:s.jsx(Qr,{connection:p,disabled:ne?.get("sync_connector")?.disabled,disabledText:ne?.get("sync_connector")?.disabledText,isSelectedInSource:n?.has(p.user_connection_details.connection_type)??!1,location:"user_dropdown",refetch:_,showDetails:J.has(p.user_connection_details.connection_type),toggleSource:v},p.user_connection_details.connection_instance_id)})}}),n&&te.forEach(p=>{const Q=!!ie.get(p.id)?.[0];if(p.type===_r.MCP_CONNECTOR)U.push({connected:Q,type:"access",name:p.name,element:s.jsx(Nh,{connector:p,connectorLinks:ie,selectedMCPSources:x,toggleSource:v,systemHintType:d,disabled:L})});else{let F=b||(ne?.get(p.type)?.disabled??!1),he=ne?.get(p.type)?.disabledText;if(p.status==="DISABLED_BY_ADMIN"&&(F=!0,he=E.formatMessage(Xc.disabledByAdmin)),p.type===De.GITHUB_CONNECTOR)return;const pe=W.includes(p.type)&&d===N.Slurm;U.push({connected:Q,disabled:F,type:"access",name:p.name,isAutoConnected:pe,element:s.jsx(Jr,{connector:p,connectorLink:ie.get(p.id)?.[0],disabled:F,disabledText:he,hasBetaTag:ne?.get(p.type)?.hasBetaTag,isSelectedInSource:n.has(p.type)??!1,systemHintType:d,toggleSource:v})})}});{const p=n&&a.find(Q=>Q.type===De.GITHUB_CONNECTOR),j=o?l.find(Q=>Q.user_connection_details.connection_type==="github_sync_connector"):void 0;if(p||j){const Q=j&&j.user_connection_details.auth_status!=="not_connected"&&j.user_connection_details.activation_status!=="inactive",F=A.get(Zc)?.[0],he=p&&!!F;U.push({connected:!!Q||!!he,type:Q?"sync":"access",name:"GitHub",element:s.jsx(Bh,{clientThreadId:e,githubSyncConnection:j,githubAccessConnector:p,connectorLink:F,selectedSources:n,toggleSource:v,systemHintType:d,refetch:_,contentRef:y})})}}const G=Rh(U,b||L),[P,z]=G.reduce(([p,j],Q)=>Q.connected?[[...p,Q],j]:[p,[...j,Q]],[[],[]]);return{connectedRows:P,disconnectedRows:z}},[r,c,o,n,b,L,E,v,l,B,ne,_,J,te,ie,x,d,a,W,A,e,y]);if(!e||!n)return null;if(R||K||t)return s.jsx("div",{className:"w-50 px-4",children:s.jsx(ed,{lines:5,size:"lg",widthVariance:0,width:100})});const T=il-oe.length,D=oe.length>il;return s.jsxs("div",{className:"w-70",children:[s.jsx("div",{className:Qs(D&&"border-token-border-secondary mb-1.5 border-b","overflow-y-auto"),style:D?{maxHeight:`calc(2.25rem * ${il+.5})`}:void 0,children:oe.map(({element:U,name:G})=>s.jsx(k.Fragment,{children:U},G))}),ce.length>0&&T>0&&s.jsx(s.Fragment,{children:ce.slice(0,T).map(({element:U})=>s.jsx(s.Fragment,{children:U}))}),g&&s.jsx(le.Item,{icon:Qm,onSelect:()=>{Oe.logEventWithStatsig("chatgpt_connectors_dropdown_connect_more_clicked","chatgpt_connectors_dropdown_connect_more_clicked"),d===N.ApiTool?ml(O,Lp):w(dr.Connectors)},children:E.formatMessage(nt.connectApps)})]})},ga=({isLoading:t=!1,clientThreadId:e,enabledConnectors:a,trigger:r,includeWebSearch:c,includeCloudBrowser:o,selectedSources:i,selectedMCPSources:f,addSource:d,deleteSource:n,toggleSource:x,includeSyncConnectors:g=!1,connectorConfigMap:v,fetchValidLinksOnly:y,systemHintType:E,showConnectMore:I=!0})=>{const H=gr(),w=Ut(e,L=>L?.startedWithMcp)===!0,O=k.useRef(null),S=k.useRef(!1);return k.useEffect(()=>{const L=(i?.size??0)+(f?.size??0);!S.current&&L===0&&!w&&(d("web"),S.current=!0)},[i,f,d,w]),s.jsxs(le.Root,{"data-testid":"sources-pill",onOpenChange:L=>{L||($m(Vm(dl(e),E))||(n(De.GITHUB_CONNECTOR),H&&n("github_sync_connector")),(i?.size??0)+(f?.size??0)===0&&!w&&d("web"))},children:[r,s.jsx(le.Portal,{children:s.jsx(le.Content,{alignOffset:-7,size:"auto",ref:O,children:s.jsx(Eh,{isLoading:t,clientThreadId:e,enabledConnectors:a,includeWebSearch:c,includeCloudBrowser:o,includeSyncConnectors:g,connectorConfigMap:v,fetchValidLinksOnly:y,systemHintType:E,selectedSources:i,selectedMCPSources:f,showConnectMore:I,toggleSource:x,contentRef:O})})})]})},Sa=3,ba=t=>{"use forget";const e=Tt.c(36),{includeSyncConnectors:a,includeWebSearch:r,selectedSources:c,selectedMCPSources:o,isDeveloperMode:i}=t,f=Sr();let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d={productSku:ul.PROMPT_TEXT_AREA},e[0]=d):d=e[0];const{availableConnectors:n,isLoading:x}=br(d),g=!a;let v;e[1]!==g?(v={skip:g},e[1]=g,e[2]=v):v=e[2];const{connectionInstanceData:y,isLoading:E}=_l(v),I=x||E;let H;e[3]!==r||e[4]!==c?(H=r?c?.has("web")?s.jsx(Ur,{className:"icon"}):s.jsx(Km,{className:"icon"}):void 0,e[3]=r,e[4]=c,e[5]=H):H=e[5];const B=H;let w;e[6]!==c?(w=c??[],e[6]=c,e[7]=w):w=e[7];let O;if(e[8]!==n||e[9]!==y?.connection_statuses||e[10]!==a||e[11]!==f||e[12]!==o||e[13]!==c||e[14]!==w||e[15]!==B){const l=[...w].filter(Lh).map(oe=>{const ce=n.find(T=>T.type===oe);return ce?{name:ce.name,icon:s.jsx(Js,{connector:ce,size:"xsmall"})}:null}).filter(Hh),J=a?Array.from(new Map((y?.connection_statuses??[]).filter(oe=>Ot(oe)&&c?.has(oe.user_connection_details.connection_type)).map(oe=>[oe.user_connection_details.connection_type,{name:Ca(oe),icon:s.jsx("img",{src:f&&oe.connection_display_info.icon_dark_url?oe.connection_display_info.icon_dark_url:oe.connection_display_info.icon_url??"",alt:oe.connection_display_info.display_name,className:"icon"})}])).values()):[],te=Array.from(o??[]).map(oe=>{const ce=n.find(T=>T.id===oe);return ce?{name:ce.name,icon:s.jsx(Js,{connector:ce,size:"xsmall"})}:null}).filter(Fh),ne=Hr([...te,...l,...J].reverse(),Oh).reverse();ne.sort(Uh);let ie;e[17]!==B?(ie=B?[{name:"web",icon:B}]:[],e[17]=B,e[18]=ie):ie=e[18],O=[...ie,...ne],e[8]=n,e[9]=y?.connection_statuses,e[10]=a,e[11]=f,e[12]=o,e[13]=c,e[14]=w,e[15]=B,e[16]=O}else O=e[16];const S=O;let L;e[19]!==S?(L=S.length>Sa?[...S.slice(0,Sa-1),{name:"__plus_overflow",icon:s.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:S.length-Sa+1},"more")}]:S,e[19]=S,e[20]=L):L=e[20];const b=L,A=i&&b.length>0&&"rounded-full bg-orange-400/10 hover:bg-orange-400/20";let K;e[21]!==A?(K=Qs("composer-btn px-2",A),e[21]=A,e[22]=K):K=e[22];let W;e[23]!==I||e[24]!==b?(W=b.length>0&&!I?s.jsx("div",{className:"flex items-center gap-1",children:b.map(Gh)}):s.jsx(Gr,{className:"icon"}),e[23]=I,e[24]=b,e[25]=W):W=e[25];let u;e[26]!==i||e[27]!==I||e[28]!==b[0]||e[29]!==b.length?(u=i&&b.length>0?s.jsx("span",{className:"ms-1.5 text-orange-400 [[data-collapse-labels]_&]:sr-only",children:b.length===1?b[0].name:s.jsx(ke,{id:"+Fsfxz",defaultMessage:"Multiple Connectors"})}):(b.length<Sa||I)&&s.jsx("span",{className:"ms-1.5 [[data-collapse-labels]_&]:sr-only",children:b.length===0&&!I?s.jsx(ke,{id:"UjEzZf",defaultMessage:"Add sources"}):s.jsx(ke,{id:"DhW8Wx",defaultMessage:"Sources"})}),e[26]=i,e[27]=I,e[28]=b[0],e[29]=b.length,e[30]=u):u=e[30];let _;e[31]===Symbol.for("react.memo_cache_sentinel")?(_=s.jsx(zr,{className:"icon-sm xs:ms-1.5 ms-1"}),e[31]=_):_=e[31];let R;return e[32]!==W||e[33]!==u||e[34]!==K?(R=s.jsx(le.BasicTrigger,{asChild:!0,children:s.jsxs("button",{type:"button",className:K,children:[W,u,_]})}),e[32]=W,e[33]=u,e[34]=K,e[35]=R):R=e[35],R},Jr=({connector:t,connectorLink:e,disabled:a=!1,disabledText:r="",hasBetaTag:c=!1,isSelectedInSource:o,systemHintType:i,toggleSource:f})=>{const d=ot(),n=xr(),{allAutoConnectors:x}=xl({getDisabledAutoConnectors:!1}),g=!!e,v=o&&g,y=x.includes(t.type)&&i===N.Slurm||!1;if(t.type===_r.MCP_CONNECTOR)return null;const E=od[t.type]?.title,I=E?d.formatMessage(E):t.name,H=s.jsx(Js,{connector:t,size:"xsmall"}),B=s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"truncate",children:I}),c&&s.jsx(tf,{})]}),w=y&&g?s.jsx(le.Item,{disabled:a,label:B,onSelect:()=>{window.location.href=Zm(t.type)},icon:H,trailing:s.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:d.formatMessage(nt.auto)})}):g?s.jsx(le.CheckboxItem,{disabled:a,label:B,icon:H,checked:v,onCheckedChange:()=>{f(t.type)}}):s.jsx(le.Item,{disabled:a,onSelect:()=>{n({connectorId:t.id,redirectAfter:i?`/?system_hints=${i}`:void 0,systemHintType:i,referrer:Cr.SourcesDropdown})},label:B,icon:H,trailing:a?void 0:s.jsx("div",{className:"text-token-text-tertiary",children:d.formatMessage(nt.connect)})});return r=y?a?d.formatMessage(nt.autoConnectorDisabled):d.formatMessage(nt.autoConnected):r,s.jsx(s.Fragment,{children:(a||y&&g)&&r?s.jsx(yl,{label:r,side:"right",align:"center",contentClassName:"w-50",children:w}):w})},Dh={github_sync_connector:"GitHub",gdrive_sync_connector:"Google Drive",notion_sync_connector:"Notion",slack_sync_connector:"Slack",sharepoint_sync_connector:"SharePoint",sharepoint_admin_sync_connector:"SharePoint (Admin)",linear_sync_connector:"Linear",confluence_sync_connector:"Confluence"},Nh=({connector:t,connectorLinks:e,selectedMCPSources:a,toggleSource:r,systemHintType:c,disabled:o=!1})=>{const i=ot(),f=xr();if(!t.conformance.implements_retrievable&&c===N.Research)return null;const n=!!e.get(t.id)?.[0],x=a.has(t.id)&&n,g=t.name,v=s.jsx(Js,{connector:t,size:"xsmall"});return s.jsx(s.Fragment,{children:n?s.jsx(le.CheckboxItem,{icon:v,checked:x,label:g,disabled:o,onCheckedChange:()=>{r(t.id)}}):s.jsx(le.Item,{onSelect:()=>{o||f({connectorId:t.id,redirectAfter:c?`/?system_hints=${c}`:void 0,systemHintType:c,referrer:Cr.SourcesDropdown})},icon:v,label:g,trailing:s.jsx("div",{className:"text-token-text-tertiary",children:i.formatMessage(nt.connect)}),disabled:o})})},Qr=({connection:t,refetch:e,location:a,isSelectedInSource:r,toggleSource:c,showDetails:o,disabled:i=!1,disabledText:f=""})=>{const d=ot(),n=Sr(),[x,g]=k.useState(!1),[v,y]=k.useState(),E=()=>{c(t.user_connection_details.connection_type)},I=t.user_connection_details.connection_instance_id,H=bl(),B=td(),w=t.user_connection_details.knowledge_connector_type,O=w==="google_drive_oauth",S=k.useCallback(async()=>{try{g(!0),await sd({connectorType:w,connectionId:I,location:a,intl:d})}catch(te){te instanceof Error?H.danger(te.message,{toastId:"sources_dropdown_oauth_error"}):H.danger({defaultMessage:"Encountered an error connecting your account. Please try again later.",description:"Error message shown when a user tries to link their account but it fails."},{toastId:"sources_dropdown_oauth_error"})}finally{g(!1),e?.()}},[I,w,d,a,e,H]),[L,b]=k.useState(!1),A=()=>O?b(!0):S(),K=t.user_connection_details.activation_status==="inactive"&&t.user_connection_details.auth_status==="not_connected",W=["activating","partially_activated"].includes(t.user_connection_details.activation_status),u=K&&!B||W,_=s.jsx("img",{src:n&&t.connection_display_info.icon_dark_url?t.connection_display_info.icon_dark_url:t.connection_display_info.icon_url??"",alt:t.connection_display_info.display_name,className:"icon"}),R=te=>{if(te.stopPropagation(),te.preventDefault(),K){A();return}if(W){y(t);return}},l={key:t.connection_display_info.display_name,disabled:i,icon:_,contentClassName:"flex-1 overflow-hidden",label:Ca(t),secondary:o?s.jsx("div",{className:"truncate",children:t.connection_display_info.display_name}):void 0};let J=null;switch(t.user_connection_details.activation_status){case"activated":J=s.jsx(le.CheckboxItem,{...l,checked:r,onCheckedChange:E});break;case"partially_activated":J=s.jsx(le.CheckboxItem,{...l,checked:r,onCheckedChange:E,secondary:s.jsx("div",{className:"group-radix-disabled:opacity-50 flex items-center gap-1.5",children:s.jsx(cd,{className:"flex-row-reverse",connection:t})})});break;case"activating":J=s.jsx(le.Item,{...l,style:{cursor:u?void 0:"default"},onSelect:R,trailing:s.jsx("div",{className:"group-radix-disabled:opacity-50",children:s.jsx(rd,{connection:t})})});break;case"inactive":J=s.jsx(le.Item,{...l,style:{cursor:u?void 0:"default"},onSelect:R,trailing:s.jsx("div",{className:"group-radix-disabled:opacity-50",children:x?s.jsx(id,{className:"icon"}):s.jsx(ld,{connection:t,refetch:e,location:"user_dropdown"})})});break}return s.jsxs(s.Fragment,{children:[v&&s.jsx(Xm,{connection:v,onClose:()=>y(void 0)}),L&&s.jsx(nd,{isAdminFlow:!1,onClose:()=>b(!1),connectionId:I,location:a,onSuccess:e}),i&&f?s.jsx(yl,{label:f,side:"right",align:"center",contentClassName:"w-50",children:J}):J]})},Bh=({clientThreadId:t,githubSyncConnection:e,githubAccessConnector:a,connectorLink:r,selectedSources:c,toggleSource:o,systemHintType:i,refetch:f,contentRef:d})=>{const n=ot(),x=ad("installations/select_target"),g=gr(),y=Ut(t,b=>b?.startedWithMcp)===!0,{data:E,isLoading:I}=ef({linkId:r?.id??""}),H=!!E,B=r?.id,w=!!B&&!H;if(!a&&!e)return null;const O=b=>{const A=b==="github_sync_connector",K=b===De.GITHUB_CONNECTOR;if((A||K)&&a&&e){const W=c?.has("github_sync_connector"),u=c?.has(De.GITHUB_CONNECTOR);W===u&&o(A?De.GITHUB_CONNECTOR:"github_sync_connector")}o(b)},S=a?s.jsx(Js,{connector:a,size:"xsmall"}):e?s.jsx("img",{src:e.connection_display_info.icon_url??"",alt:e.connection_display_info.display_name,className:"icon"}):null,L=a?a.name:e?Ca(e):"";if(w&&!I)return s.jsx(le.Item,{label:L,icon:S,onSelect:()=>{window.open(x,"_blank")},trailing:s.jsx("div",{className:"text-token-text-tertiary",children:n.formatMessage(nt.finishSetup)})});if(e&&(Ot(e)||!a)){const b=c.has("github_sync_connector");return s.jsxs(s.Fragment,{children:[s.jsx(Qr,{connection:e,refetch:f,location:"user_dropdown",isSelectedInSource:b,toggleSource:O,showDetails:!1,disabled:I,disabledText:""},e.user_connection_details.connection_instance_id),b&&g&&s.jsx(Jl,{clientThreadId:t,allowSelectAllRepos:!1,githubSyncEnabled:!0,linkId:B,syncConnectionId:e.user_connection_details.connection_instance_id,contentRef:d})]})}else if(a){const b=c.has(De.GITHUB_CONNECTOR);return s.jsxs(s.Fragment,{children:[s.jsx(Jr,{connector:a,connectorLink:r,disabled:y,disabledText:"",hasBetaTag:!1,isSelectedInSource:b,systemHintType:i,toggleSource:O}),b&&!0&&s.jsx(Jl,{clientThreadId:t,linkId:r?.id,allowSelectAllRepos:!1,githubSyncEnabled:!1,contentRef:d})]})}return null},nt=ku({contactAdmin:{id:"JGCH/x",defaultMessage:"Contact your admin to enable Google Drive for chat"},allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},finishSetup:{id:"j12ad3",defaultMessage:"Finish Setup"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},cloudBrowser:{id:"RA2J7e",defaultMessage:"Use cloud browser"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"},autoConnected:{id:"7IJBNd",defaultMessage:"This connector is searched automatically"},autoConnectorDisabled:{id:"KJQcAS",defaultMessage:"To enable this connector, toggle off all custom connectors"},auto:{id:"uW03xX",defaultMessage:"Auto"}});function Lh(t){return t!=="web"&&t!=="cloud"}function Hh(t){return!!t}function Fh(t){return!!t}function Oh(t){return t.name}function Uh(t,e){return t.name.localeCompare(e.name)}function Gh(t){return s.jsx("div",{className:"icon flex items-center justify-center",children:t.icon},t.name)}function zh({activeSystemHint:t,clientThreadId:e,connectionStatuses:a,currentModelConfig:r}){const c=yr(),o=pl();sf({clientThreadId:e});const{availableConnectors:i,isLoading:f,enabled:d}=dd(),{availableConnectors:n,enabled:x,isLoading:g}=ud({includeDisabledByAdmin:!0,includeAutoConnectors:t?.systemHint===N.Slurm,filterDisabledAutoConnectors:t?.systemHint===N.Slurm}),{availableConnectors:v,enabled:y,isLoading:E}=nf({includeDisabledByAdmin:!0}),{connectorConfigMap:I}=of({clientThreadId:e}),H=br(),B=t?.systemHint===N.ApiTool,w=t?.systemHint===N.Slurm&&(a&&a.length>0||x&&n.length>0),{selectedSources:O=new Set,selectedMCPSources:S=new Set,addSource:L,deleteSource:b,toggleSource:A}=Wr(e,w&&t?.systemHint===N.Slurm),K=t?.systemHint===N.Research,W=$r(r?.id,t?.systemHint);if(d&&K)return s.jsx(ga,{clientThreadId:e,selectedSources:O,selectedMCPSources:S,addSource:L,deleteSource:b,toggleSource:A,isLoading:f,enabledConnectors:i,fetchValidLinksOnly:!0,systemHintType:t?.systemHint,trigger:s.jsx(ba,{selectedSources:O,selectedMCPSources:S,includeSyncConnectors:!1,includeWebSearch:!0})});if(w){const u=o?.isPersonalAccount()?c:!0;return s.jsx(ga,{clientThreadId:e,selectedSources:O,selectedMCPSources:S,addSource:L,deleteSource:b,toggleSource:A,isLoading:g,enabledConnectors:n,includeWebSearch:!1,includeSyncConnectors:u,connectorConfigMap:I,systemHintType:t?.systemHint,trigger:s.jsx(ba,{selectedSources:O,selectedMCPSources:S,includeSyncConnectors:u,includeWebSearch:!1})})}if(B){const u=H.availableConnectors.filter(_=>_.connector_type==="MCP");return s.jsx(ga,{clientThreadId:e,selectedSources:O,selectedMCPSources:S,addSource:L,deleteSource:b,toggleSource:A,isLoading:H.isLoading,enabledConnectors:u,includeWebSearch:!1,includeSyncConnectors:!1,connectorConfigMap:I,systemHintType:t?.systemHint,trigger:s.jsx(ba,{selectedSources:O,selectedMCPSources:S,includeSyncConnectors:!1,includeWebSearch:!1,isDeveloperMode:!0})})}if(y&&W){const u=Ar();return s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ga,{clientThreadId:e,selectedSources:O,selectedMCPSources:S,addSource:L,deleteSource:b,toggleSource:A,isLoading:E,enabledConnectors:v,fetchValidLinksOnly:!0,systemHintType:t?.systemHint,includeCloudBrowser:u,trigger:s.jsx(ba,{selectedSources:O,selectedMCPSources:S,includeSyncConnectors:!1,includeWebSearch:!0})}),s.jsx(af,{clientThreadId:e,activeSystemHintType:Ks})]})}return t?.systemHint===N.ContextualAnswers?s.jsx("div",{"data-testid":"sources-pill",className:"flex items-center gap-1.5 ps-0.5 [view-transition-name:var(--vt-composer-sources-pill)]",children:s.jsx(Wh,{dropdownContent:s.jsx(lf,{}),as:"popover"})},"sources-tag"):null}function Wh({dropdownContent:t,as:e}){const a=s.jsxs("button",{type:"button",className:"composer-btn px-2",children:[s.jsx(Gr,{className:"icon mx-1","aria-label":""}),s.jsx("span",{className:"[[data-collapse-labels]_&]:sr-only",children:s.jsx(ke,{id:"DhW8Wx",defaultMessage:"Sources"})}),s.jsx("div",{className:"me-0.5 flex items-center",children:s.jsx(zr,{className:"icon-sm pointer-events-auto!"})})]}),r=e==="popover"?s.jsx(df,{children:s.jsx(md,{className:"p-0",$as:uf,side:"bottom",align:"start",collisionPadding:10,sideOffset:8,children:t})}):s.jsx(le.Portal,{children:s.jsx(le.Content,{children:t})});return e==="popover"?s.jsxs(rf,{children:[s.jsx(cf,{asChild:!0,children:a}),r]}):s.jsxs(le.Root,{children:[s.jsx(le.Trigger,{asChild:!0,children:a}),r]})}const $h=t=>{"use forget";const e=Tt.c(97),{clientThreadId:a,composerController:r,pendingFiles:c,hasFiles:o,placeholder:i,isTemporaryChat:f,state:d,inputState:n,disableReason:x,currentModelConfig:g,gizmoId:v,replyRegions:y,includeSidebarContextTray:E,onSubmit:I,leadingAction:H,legacyFooterActions:B,activeSystemHint:w,hideSystemHint:O,isSystemHintLocked:S,onRemoveSystemHint:L,onRemoveModel:b,contextualAnswerUserConnectionData:A,fileInput:K,expanded:W,expandOnMultilineInput:u}=t,_=O===void 0?!1:O,R=ft(),l=Xs(Zs),J=rr(cr.DeveloperMode).data,te=Sl(),ne=J&&te===N.ApiTool,{showSelectedModelInComposer:ie,showThinkingEffortPicker:oe,fontSize:ce}=Mr(),T=Tr();let D;e[0]!==r?(D=fd(r),e[0]=r,e[1]=D):D=e[1];const{composerThinkingEffort$:U,setThinkingEffort:G}=D,P=qe(U),z=g?.id===pd&&P&&oe;let p;e[2]!==R||e[3]!==g||e[4]!==z||e[5]!==ie?(p=()=>{if(!g||!ie&&!z)return[null];const gt=ur(R),{data:Ze}=gt();if(Ze?.defaultModelSlug===g.id)return[null];const wt=Ze?.categories.find(Ve=>Ve.defaultModel===g.id||Ve.supportedModels?.includes(g.id));if(wt)return[wt.actionPillShortName??wt.label];const vt=Ze?.groups.find(Ve=>Ve.modelIds.includes(g.id));return vt?[vt.label,g.title]:[g.title]},e[2]=R,e[3]=g,e[4]=z,e[5]=ie,e[6]=p):p=e[6];const[j,Q]=qe(p);let F;e[7]!==r?(F=Vr(r),e[7]=r,e[8]=F):F=e[8];const he=qe(F.isWhisperActive$),pe=Kr(Vh);let je;e[9]!==pe?(je=Yr(),e[9]=pe,e[10]=je):je=e[10];const ae=o||je,be=!wr();let $;e[11]!==r?($=vr(r),e[11]=r,e[12]=$):$=e[12];const de=$;let Y;e[13]!==l||e[14]!==de||e[15]!==be?(Y=()=>(be||l)&&!de(),e[13]=l,e[14]=de,e[15]=be,e[16]=Y):Y=e[16];const me=qe(Y),se=l?"text-sm shadow-none! dark:border-token-border-heavy border-t border-gray-100 rounded-none":void 0;let re;e[17]!==r||e[18]!==ce||e[19]!==he||e[20]!==i?(re=s.jsx(Sf,{children:he?s.jsx("div",{className:"max-w-full min-w-0 flex-1",children:s.jsx(bf,{composerController:r,className:"h-14"})}):s.jsx(yf,{composerController:r,placeholder:i,fontSize:ce})}),e[17]=r,e[18]=ce,e[19]=he,e[20]=i,e[21]=re):re=e[21];let Ne;e[22]!==K?(Ne=K&&s.jsx(_f,{children:K}),e[22]=K,e[23]=Ne):Ne=e[23];let Me;e[24]!==y?(Me=y&&y.length>0&&s.jsx(tl,{children:s.jsx(mf,{replyRegions:y})}),e[24]=y,e[25]=Me):Me=e[25];let h;e[26]!==w?.systemHint||e[27]!==ae||e[28]!==c||e[29]!==pe?(h=ae&&s.jsx(tl,{children:s.jsx(ff,{files:c,selectedApps:pe,activeSystemHintType:w?.systemHint,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),e[26]=w?.systemHint,e[27]=ae,e[28]=c,e[29]=pe,e[30]=h):h=e[30];let q;e[31]!==E?(q=E&&s.jsx(tl,{children:s.jsx(xf,{})}),e[31]=E,e[32]=q):q=e[32];let pt;e[33]!==H?(pt=H&&s.jsx(Cf,{children:H}),e[33]=H,e[34]=pt):pt=e[34];let ht;e[35]!==B?(ht=B?.map(Kh),e[35]=B,e[36]=ht):ht=e[36];let Ge;e[37]!==r||e[38]!==R||e[39]!==g||e[40]!==z||e[41]!==T||e[42]!==P||e[43]!==j||e[44]!==Q||e[45]!==b||e[46]!==G||e[47]!==ie?(Ge=z&&j?s.jsx(sl,{children:s.jsx(pf,{thinkingEffort:P,onChangeThinkingEffort:gt=>{G(gt),T.mutate({model_slug:g.id,thinking_effort:gt})},modelLabel:j,modelSlug:g.id,onRemoveModel:b,onCloseAutoFocus:gt=>{Pr(R).composer.autofocusDisabled$()||(gt.preventDefault(),mt(xe(r)))}})},"effort-selector"):ie&&j?s.jsx(sl,{children:s.jsx(hf,{label:j,tooltipLabel:Q,onRemoveModel:b})},"active-model-pill"):null,e[37]=r,e[38]=R,e[39]=g,e[40]=z,e[41]=T,e[42]=P,e[43]=j,e[44]=Q,e[45]=b,e[46]=G,e[47]=ie,e[48]=Ge):Ge=e[48];let ze;e[49]!==w||e[50]!==_||e[51]!==S||e[52]!==L?(ze=w&&!_&&s.jsx(sl,{children:s.jsx(Af,{activeSystemHint:w,locked:S,onRemoveSystemHint:L})},"active-hint-tag"),e[49]=w,e[50]=_,e[51]=S,e[52]=L,e[53]=ze):ze=e[53];let We;e[54]!==w||e[55]!==a||e[56]!==A?.connection_statuses||e[57]!==g?(We=w&&g&&s.jsx(fl,{children:s.jsx(zh,{activeSystemHint:w??void 0,clientThreadId:a,connectionStatuses:A?.connection_statuses,currentModelConfig:g})},"sources-tag"),e[54]=w,e[55]=a,e[56]=A?.connection_statuses,e[57]=g,e[58]=We):We=e[58];let Je;e[59]!==w?.systemHint||e[60]!==r?(Je=w?.systemHint===N.PictureV2&&s.jsx(fl,{children:s.jsx(gf,{composerController:r})},"image-style-picker"),e[59]=w?.systemHint,e[60]=r,e[61]=Je):Je=e[61];let Qe;e[62]!==r||e[63]!==me?(Qe=!me&&s.jsx(Mf,{composerController:r,composerType:"composer-btn"}),e[62]=r,e[63]=me,e[64]=Qe):Qe=e[64];let $e;e[65]!==a||e[66]!==r||e[67]!==x||e[68]!==v||e[69]!==n||e[70]!==he||e[71]!==I||e[72]!==d?($e=!he&&s.jsx(Tf,{inputState:n,state:d,onSubmit:I,composerController:r,clientThreadId:a,gizmoId:v,disableReason:x}),e[65]=a,e[66]=r,e[67]=x,e[68]=v,e[69]=n,e[70]=he,e[71]=I,e[72]=d,e[73]=$e):$e=e[73];let ye;e[74]!==Qe||e[75]!==$e?(ye=s.jsxs(wf,{children:[Qe,$e]}),e[74]=Qe,e[75]=$e,e[76]=ye):ye=e[76];let Xe;return e[77]!==r||e[78]!==u||e[79]!==W||e[80]!==f||e[81]!==I||e[82]!==ne||e[83]!==Ne||e[84]!==Me||e[85]!==h||e[86]!==q||e[87]!==pt||e[88]!==ht||e[89]!==Ge||e[90]!==ze||e[91]!==We||e[92]!==Je||e[93]!==ye||e[94]!==se||e[95]!==re?(Xe=s.jsxs(vf,{isTemporaryChat:f,isDeveloperMode:ne,composerController:r,expanded:W,expandOnMultilineInput:u,onSubmit:I,backgroundClassName:se,children:[re,Ne,Me,h,q,pt,ht,Ge,ze,We,Je,ye]}),e[77]=r,e[78]=u,e[79]=W,e[80]=f,e[81]=I,e[82]=ne,e[83]=Ne,e[84]=Me,e[85]=h,e[86]=q,e[87]=pt,e[88]=ht,e[89]=Ge,e[90]=ze,e[91]=We,e[92]=Je,e[93]=ye,e[94]=se,e[95]=re,e[96]=Xe):Xe=e[96],Xe};function Vh(t){return t.selectedApps}function Kh(t,e){return s.jsx(fl,{children:t},`legacy-footer-action-${e}`)}const Yh=hl(()=>gl(()=>import("./i9evuzkcqd5jowdj.js"),__vite__mapDeps([8,1,3,4,2,5,9])).then(t=>t.GithubOnboardingModal)),qh=()=>null,Jh=3e3;function zg(t){"use forget";const e=Tt.c(673),{onCreateNewCompletion:a,onContinueGenerating:r,account:c,currentModelId:o,currentModelConfig:i,disableDraftPersistence:f,areModelsLoading:d,clientThreadId:n,isNewThread:x,isCompletionInProgress:g,disabled:v,disabledReason:y,canPause:E,canContinue:I,isInteractableSharedThread:H,headerClassName:B,hideHeader:w,onlyAllowImageUploads:O,layoutMode:S,modelsData:L}=t,b=f===void 0?!1:f,A=v===void 0?!1:v,K=E===void 0?!1:E,W=I===void 0?!1:I;Ql.markStart("PromptTextarea"),Ql.markRendered("PromptTextarea");const u=ft(),[_,R]=ju(),l=hd();Pf(l),kf();const J=lr(),te=c?.isTeam(),ne=c?.isEnterprisey(),ie=c?.isBusiness(),oe=c?.isEdu();let ce;e[0]!==u?(ce=kr(u),e[0]=u,e[1]=ce):ce=e[1];const T=ce,D=ot(),U=bl(),G=ir(),P=jf.useStore(),z=Qi(Tg),p=!!(te||ne||ie||oe),[j,Q,F,he,pe,je,ue]=Ut(n,Ag),{gizmoEditorData:ae,mode:be,getGizmoId:$}=gd(),de=Sd(),Y=bd(),me=Rf(),se=fr(n),re=!!yd(),Ne=If.useIsEnabled(n),Me=!!_d(),h=Sl(),q=xd(),pt=Nr(),ht=qs(rl.hasSeenAgentModeAnnouncementBanner),[Ge,ze]=Xs(Cg);let We;e[2]!==u?(We=Cd(u),e[2]=u,e[3]=We):We=e[3];const Je=We,Qe=wr();let $e;e[4]!==u||e[5]!==Ge||e[6]!==Je||e[7]!==Qe?($e=!Je&&!Ge&&!Qe&&Ad(u).getLayer("3081064739").get("composer-plus-menu",!1),e[4]=u,e[5]=Ge,e[6]=Je,e[7]=Qe,e[8]=$e):$e=e[8];const ye=$e,Xe=Md.useState(xg),gt=Td(),Ze=wd(),wt=!gt;let vt;e[9]!==wt?(vt={skip:wt},e[9]=wt,e[10]=vt):vt=e[10];const{connectionInstanceData:Ve,isLoading:Aa}=_l(vt),{selectedSources:en,selectedMCPSources:Pt,addSource:kt}=Wr(n);let tn,sn;e[11]!==h||e[12]!==kt||e[13]!==_||e[14]!==R?(tn=()=>{const m=_.get("add_source");m&&h&&(kt(m),_.delete("add_source"),R(_))},sn=[h,kt,_,R],e[11]=h,e[12]=kt,e[13]=_,e[14]=R,e[15]=tn,e[16]=sn):(tn=e[15],sn=e[16]),k.useEffect(tn,sn);const{eligible:nn,isLoading:on}=qs(rl.hasSeenTatertotNux);let an,ln;e[17]!==h||e[18]!==u||e[19]!==nn||e[20]!==on?(an=()=>{h===N.Tatertot&&Mt(u,"1586944302")&&nn&&!on&&ml(u,op)},ln=[h,nn,on,u],e[17]=h,e[18]=u,e[19]=nn,e[20]=on,e[21]=an,e[22]=ln):(an=e[21],ln=e[22]),k.useEffect(an,ln);let rn;e[23]!==u?(rn=Ef(u),e[23]=u,e[24]=rn):rn=e[24];const Cl=rn,Ma=!Cl;let cn;e[25]!==Ma?(cn={skip:Ma,productSku:ul.PROMPT_TEXT_AREA},e[25]=Ma,e[26]=cn):cn=e[26],vd(cn);const{platformConnectors:Gt}=Pd(Cl&&(Pt?.size??0)>0,ul.PROMPT_TEXT_AREA);let dn;e[27]===Symbol.for("react.memo_cache_sentinel")?(dn={getDisabledAutoConnectors:!1},e[27]=dn):dn=e[27];const{allAutoConnectors:Xr}=xl(dn),Ta=Xr.length>0&&p;let un;e[28]!==Gt||e[29]!==Ta?(un={platformConnectors:Gt,enabled:Ta},e[28]=Gt,e[29]=Ta,e[30]=un):un=e[30],kd(un);let Al,mn;e[31]!==Gt||e[32]!==Pt?(mn=Array.from(Pt??[]).map(m=>Gt.get(m)).filter(_g),e[31]=Gt,e[32]=Pt,e[33]=mn):mn=e[33],Al=mn;const Ml=Al,wa=k.useRef(0);let fn;e[34]!==u?(fn=Ds(u,"3396794266").get("restore_prompt_on_stop",!1),e[34]=u,e[35]=fn):fn=e[35];const pn=fn,hn=k.useRef(null),[X,jt,Re,Be]=kg(n),Zr=jd(),St=jt?.gizmo.id??Zr,gn=Rd(St),ec=Df(),Sn=Nf(n);let bn;e[36]!==h||e[37]!==X||e[38]!==i?(bn=Ll(i,X,h),e[36]=h,e[37]=X,e[38]=i,e[39]=bn):bn=e[39];const at=bn,Rt=Id(),va=Rt!=null;let It,yn;e[40]!==u?(It=Ed(u).flags,yn=It?.includes(Dd.NoAuthEnableFileUploads),e[40]=u,e[41]=It,e[42]=yn):(It=e[41],yn=e[42]);const zt=yn,{systemHints:tc}=Nd(),sc=!Mt(u,"3084799213"),nc=he||(pe??!1)||sc,oc=!Xe&&(X==null||X?.kind===_a.PrimaryAssistant||X?.kind===_a.GizmoInteraction&&gn),V=jg(oc,tc,i,X,Y,nc),Le=V==null||V.length>0;let Tl,_n;e[43]!==h||e[44]!==V?(_n=(h&&V?.find(m=>m.systemHint===h))??null,e[43]=h,e[44]=V,e[45]=_n):_n=e[45],Tl=_n;const Se=Tl;let xn;e[46]!==n||e[47]!==q?(xn=()=>{q(null,{analyticsMetadata:{clientThreadId:n}})},e[46]=n,e[47]=q,e[48]=xn):xn=e[48];const it=xn,Pa=Bd(),lt=Rg(L),ka=Tr();let Cn;e[49]!==u||e[50]!==o||e[51]!==ka||e[52]!==Pa?(Cn=(m,M)=>{Oe.logEventWithStatsig("Model Switcher Model Changed","chatgpt_model_switcher_model_changed",{from:o,to:m}),Mt(u,"1333611684")?ka.mutate({model_slug:m}):nu(u,m),Pa({modelId:m,location:M})},e[49]=u,e[50]=o,e[51]=ka,e[52]=Pa,e[53]=Cn):Cn=e[53];const rt=Cn;let An;e[54]!==lt||e[55]!==rt?(An=m=>{zl()&&m?.preventDefault(),rt(lt??"","remove non-default model")},e[54]=lt,e[55]=rt,e[56]=An):An=e[56];const Wt=An,ja=Se?.systemHint??null;let Mn;e[57]!==o||e[58]!==ja?(Mn=$r(o,ja),e[57]=o,e[58]=ja,e[59]=Mn):Mn=e[59];const Ls=Mn,ac=!A&&(at!==$s.None||d)&&(T||zt);let Tn;e[60]!==X||e[61]!==i?(Tn=Ld(i,X),e[60]=X,e[61]=i,e[62]=Tn):Tn=e[62];const fe=Tn;let wn;e[63]!==X||e[64]!==i?(wn=Hd(i,X),e[63]=X,e[64]=i,e[65]=wn):wn=e[65];const et=wn;let vn;e[66]!==be?(vn=m=>be==="magic"?m.files.filter(yg):m.files.filter(bg),e[66]=be,e[67]=vn):vn=e[67];const Ke=Qi(vn,hr),[Hs]=k.useState(Sg),ic=Bf(),Et=Ke.length>0||ic,Pn=Qi(Fd.hasUploadInProgress),Ra=Kr(gg);let kn;e[68]!==Ra?(kn=Yr(),e[68]=Ra,e[69]=kn):kn=e[69];const lc=kn,Ia=Lf(n);let wl,jn;if(e[70]!==l||e[71]!==i){const m=Od(l);jn=Ys(()=>vu(i,m())),e[70]=l,e[71]=i,e[72]=jn}else jn=e[72];wl=jn;const Dt=qe(wl);let Rn;e[73]!==l?(Rn=vr(l),e[73]=l,e[74]=Rn):Rn=e[74];const Fs=Rn,bt=qe(Fs),In=!bt,yt=!Dt&&!Pn&&(In||Et),En=(at===$s.Multimodal?Ud:Gd)-Ke.length,vl=En<=0,rc=Se?.systemHint===N.Research,cc=Mt(u,"3544641259"),{selectedRepos:Ea}=Hf(n),Pl=(rc||Ls)&&cc&&en?.size===0&&Pt?.size===0,Dn=F?.message.metadata?.async_task_id;let Nn;e[75]!==Dn?(Nn=m=>Dn?m.tasks[Dn]:null,e[75]=Dn,e[76]=Nn):Nn=e[76];const Os=Ff(Nn),Nt=Os?.status===Of.RUNNING,kl=zd(pa(n)??n)?.value,dc=kl===Hl.STREAMING,uc=kl===Hl.REALTIME,_t=g&&K||dc||uc||Nt,xt=yt&&!A&&!Me&&(!_t||Sn)&&!Pl,{targetedContent:jl,setTargetedContent:Bt}=Uf(),_e=jl?.isFocusedViewContent&&!me?void 0:jl;let Bn;e[77]!==u?(Bn=Pr(u),e[77]=u,e[78]=Bn):Bn=e[78];const Ye=Bn;let Ln,Hn;e[79]!==l||e[80]!==_e||e[81]!==Ye?(Ln=()=>{!_e||Ye.composer.autofocusDisabled$()||requestAnimationFrame(()=>requestAnimationFrame(()=>{mt(xe(l))}))},Hn=[_e,Ye,l],e[79]=l,e[80]=_e,e[81]=Ye,e[82]=Ln,e[83]=Hn):(Ln=e[82],Hn=e[83]),k.useEffect(Ln,Hn);const{getUpsellLabelType:mc,getUpsellShowsAttach:Da}=Gf(),Fn=Mr(),{isSingleLine:Te,fullyCollapsedToolMenu:fc,showSlashHint:Na,showSelectedModelInComposer:Ba,showModelsInPlusMenu:pc}=Fn,Lt=fc&&!ye,La=pc&&!ye;let On;e[84]!==h||e[85]!==Le||e[86]!==Aa||e[87]!==T||e[88]!==Te||e[89]!==te?(On=Le&&T&&(!te||!Aa)&&!Fl(h)&&!Te,e[84]=h,e[85]=Le,e[86]=Aa,e[87]=T,e[88]=Te,e[89]=te,e[90]=On):On=e[90];const Ha=On;let Un;e[91]!==l?(Un=Vr(l),e[91]=l,e[92]=Un):Un=e[92];const Ct=qe(Un.isWhisperActive$);let Fa;e[93]!==R?(Fa=()=>{R(hg)},e[93]=R,e[94]=Fa):Fa=e[94];let Oa;e[95]!==n||e[96]!==l||e[97]!==q?(Oa=m=>{if(ut(n,pg),ha(xe(l),m.prompt),m.system_hint){const M=m.system_hint;if(q(M),m.sources){const Z=m.sources.map(fg).filter(cl),ee=new Set(Z.filter(mg)),ve=new Set(Z.filter(Ns));ut(n,Ie=>{Ie.selectedSources=new Map([[M,ee]]),Ie.selectedMCPSources=new Map([[M,ve]]),Ie.hasModifiedSources=!0})}}},e[95]=n,e[96]=l,e[97]=q,e[98]=Oa):Oa=e[98];let Ua;e[99]!==_?(Ua=_.get("share_prompt"),e[99]=_,e[100]=Ua):Ua=e[100];let Gn;e[101]!==l||e[102]!==se||e[103]!==J?(Gn=()=>{if(!J?.id)return;const m=Wl.getAndReset(J.id,se);m&&ha(xe(l),m.inputText)},e[101]=l,e[102]=se,e[103]=J,e[104]=Gn):Gn=e[104];const Ga=J?.id;let zn;e[105]!==l||e[106]!==se||e[107]!==Ga?(zn=[Ga,se,l],e[105]=l,e[106]=se,e[107]=Ga,e[108]=zn):zn=e[108],k.useEffect(Gn,zn);let Wn,$n;e[109]!==l||e[110]!==Fs||e[111]!==_?(Wn=()=>{const m=_.get("prompt")??"";Fs()&&m.length>0&&ha(xe(l),m)},$n=[Fs,l,_],e[109]=l,e[110]=Fs,e[111]=_,e[112]=Wn,e[113]=$n):(Wn=e[112],$n=e[113]),k.useEffect(Wn,$n);let Vn;e[114]!==Se||e[115]!==h||e[116]!==V||e[117]!==n||e[118]!==q?(Vn=()=>{h!==N.Slurm&&h!=null&&!V?.some(ug)||(Se==null&&q(N.Slurm),ut(n,dg))},e[114]=Se,e[115]=h,e[116]=V,e[117]=n,e[118]=q,e[119]=Vn):Vn=e[119];const Ht=Vn;let Kn;e[120]!==u||e[121]!==Ze||e[122]!==_||e[123]!==Ht||e[124]!==R?(Kn=()=>{if(_.has("github_onboarding")){const m=_.get("github_onboarding");let M=Ws.ConfigureRepos;m&&[Ws.ConfigureRepos,Ws.SyncRepos,Ws.IndexRepos].includes(m)&&(M=m),Ze&&M!==Ws.ConfigureRepos?Ht():ml(u,Yh,{initialState:M,onFinishFlow:Ht}),R(cg)}},e[120]=u,e[121]=Ze,e[122]=_,e[123]=Ht,e[124]=R,e[125]=Kn):Kn=e[125];let Yn;e[126]!==Se||e[127]!==h||e[128]!==V||e[129]!==n||e[130]!==u||e[131]!==Ze||e[132]!==_||e[133]!==Ht||e[134]!==q||e[135]!==R?(Yn=[_,R,u,h,Se,n,q,V,Ht,Ze],e[126]=Se,e[127]=h,e[128]=V,e[129]=n,e[130]=u,e[131]=Ze,e[132]=_,e[133]=Ht,e[134]=q,e[135]=R,e[136]=Yn):Yn=e[136],k.useEffect(Kn,Yn);let qn;e[137]!==h||e[138]!==n||e[139]!==_||e[140]!==R?(qn=()=>{const m=ou(_),M=h??m[0],Z=M===N.Slurm,ee=M===N.Research;if(!Z&&!ee)return;const ve=_.getAll("sources");if(!ve.length)return;const Ie=_.get("redirect_source"),ct=ve.map(rg).filter(cl),Ee=new Set(ct.filter(lg)),xs=new Set(ct.filter(Ns));ut(n,Ft=>{Ft.selectedSources=new Map([[M,Ee]]),Ft.selectedMCPSources=new Map([[M,xs]]),Ft.hasModifiedSources=!0}),R(ig),Ie==="suggested_ca_prompts"&&Oe.logEventWithStatsig("chatgpt_contextual_answers_connector_activated","chatgpt_contextual_answers_connector_activated",{source:"suggested_ca_prompts"})},e[137]=h,e[138]=n,e[139]=_,e[140]=R,e[141]=qn):qn=e[141];let Jn;e[142]!==h||e[143]!==kt||e[144]!==n||e[145]!==_||e[146]!==q||e[147]!==R?(Jn=[n,kt,_,q,R,h],e[142]=h,e[143]=kt,e[144]=n,e[145]=_,e[146]=q,e[147]=R,e[148]=Jn):Jn=e[148],k.useEffect(qn,Jn);let Qn,Xn;e[149]!==xt?(Qn=()=>{xt&&au(!0).then(ag)},Xn=[xt],e[149]=xt,e[150]=Qn,e[151]=Xn):(Qn=e[150],Xn=e[151]),k.useEffect(Qn,Xn);let Zn;e[152]!==X||e[153]!==i?(Zn=Wd(i,X),e[152]=X,e[153]=i,e[154]=Zn):Zn=e[154];const eo=Zn;let to;e[155]!==h||e[156]!==X||e[157]!==i?(to=Ll(i,X,h),e[155]=h,e[156]=X,e[157]=i,e[158]=to):to=e[158];const{handleFileAccepted:za}=Gp(D,to,fe,"mouse",$,eo?.attachments);let so;e[159]!==l||e[160]!==za?(so=(m,M)=>(requestAnimationFrame(()=>{requestAnimationFrame(()=>{mt(xe(l))})}),za(m,M)),e[159]=l,e[160]=za,e[161]=so):so=e[161];const Wa=so,ge=!A&&!vl&&ac&&Rt==null,$a=!ge;let $t;e[162]!==D||e[163]!==U||e[164]!==at?($t=m=>zp(m,D,U,at),e[162]=D,e[163]=U,e[164]=at,e[165]=$t):$t=e[165];const Va=$d(!T||O?fe:et);let no;e[166]!==En||e[167]!==Wa||e[168]!==$a||e[169]!==$t||e[170]!==Va?(no={disabled:$a,noClick:!0,onDropAccepted:Wa,onDropRejected:$t,multiple:!0,maxSize:Vd,maxFiles:En,...Va},e[166]=En,e[167]=Wa,e[168]=$a,e[169]=$t,e[170]=Va,e[171]=no):no=e[171];const{getInputProps:Ka,open:Ya}=Op(no);let oo;e[172]!==ge||e[173]!==Ya||e[174]!==at?(oo=()=>{ge&&(Oe.logEventWithStatsig("Open File Viewer","chatgpt_web_file_viewer_opened",{intent:at.toString()}),Ya())},e[172]=ge,e[173]=Ya,e[174]=at,e[175]=oo):oo=e[175];const Ce=oo,qa=Kd(Hs);let ao;e[176]!==h||e[177]!==l||e[178]!==qa||e[179]!==u||e[180]!==G||e[181]!==Ke||e[182]!==q?(ao=()=>{iu(xe(l)),qa.clearMessages(),Zl(l).resetData();for(const M of Ke)zs.remove(G,M.tempId,"none");if(ap.markAllAsSent(),lu(u)){const M=nr(u,"269676899"),Z=M.get("skip_search",!1);if(M.get("clear_all",!1)){const ve=[N.Slurm,N.Tatertot,N.Think,N.ApiTool,Z?N.Search:null,Ks].filter(og);h&&!ve.includes(h)&&q(null)}}},e[176]=h,e[177]=l,e[178]=qa,e[179]=u,e[180]=G,e[181]=Ke,e[182]=q,e[183]=ao):ao=e[183];const io=ao;let Us;e:{if(ze){Us=ru;break e}else if(Ge){Us=cu;break e}else if(Ar()){Us=du;break e}Us=void 0}const hc=Us;let lo;e[184]!==ze?(lo=()=>ze&&Ul.sidebarUrlTrayOpen$(),e[184]=ze,e[185]=lo):lo=e[185];const ro=qe(lo);zf();const gc=Yd(),Vt=nl((m,M)=>{if(m.preventDefault(),A||!yt&&!M||!X||je)return;const Z=Ol(xe(l).state.doc),ee=Z.content;He==="streaming"&&(Oe.logEventWithStatsig("chatgpt_web_conversation_stream_interrupted","chatgpt_web_conversation_stream_interrupted",{interrupted_message_length:ee.length}),Xi.count(Zi.DEFAULT,"chatgpt_web_conversation_stream_interrupted",[])),Xi.count(Zi.DEFAULT,"chatgpt_web_conversation_completion_sent",[]);const{content:ve,attachments:Ie}=Wf(G,ee,i,X,h);ut(n,Ee=>{Ee.hasModifiedSources=!1,Ee.hasModifiedGithubRepos=!1,Ee.startedWithMcp===void 0&&(Ee.startedWithMcp=Ml.length>0)}),ec();const ct=Xl.getState().attachedTempTextdocs;pn?hn.current={content:Z.content,files:Ke.map(ng),attachedTempTextdocs:Object.fromEntries(Object.entries(ct).map(sg)),systemHintType:h??null,selectedSources:en?[...en]:void 0,selectedMCPSources:Pt?[...Pt]:void 0}:hn.current=null,a({sourceEvent:m,attachments:Ie,content:ve,contentToSend:Z,clientThreadId:n,conversationMode:X,hasSelectedApps:lc,isMessageFollowupsEnabled:Ne,selectedApps:Ra,desktopOrigin:hc,shouldCollectSidebarContext:ro,desktopSidebarContext:Ul.context$(),selectedGizmoTag:Re,selectedRepos:{selectedAllRepos:Ea.selectedAllRepos,selectedRepos:Ea.selectedRepos?[...Ea.selectedRepos]:null},selectedSources:en,selectedMCPConnectors:Ml,startedWithMcp:ue===!0,systemHints:h?[h]:[],isN7jupdActive:Ls,isForceAllowCustomMcpModeEnabled:gc,...Zl(l).getData(Z.content)}),_e?.onCreateCompletion?.({serverThreadId:se,currentLeafId:j}),_e?.shouldPersistAcrossMessages!==!0&&Bt(void 0),Gl.hideThreadHeader();for(const Ee of Ke)Ee.status===qd.Ready&&P.addFile(Ee);io(),pt&&h===Ks&&ht.markAsViewed()});let co;e[186]!==se||e[187]!==Bt?(co=m=>{Bt(m.targetedReply),m.targetedReply&&Oe.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:se,sourceMessageId:m.messageId})},e[186]=se,e[187]=Bt,e[188]=co):co=e[188];const Ja=co,{maybeSetWaitingForRealtimeOnAbort:Qa,isWatingForRealtimeStatusChange:Sc}=$f(n);let uo;e[189]!==h||e[190]!==pe||e[191]!==Qa?(uo=(m,M)=>{const Z=M===void 0?"other":M;Qa(),uu(m,void 0,{clientInitiated:!0,reason:Z,isLastTurnAgent:pe,hasAgentSystemHint:h===Ks})},e[189]=h,e[190]=pe,e[191]=Qa,e[192]=uo):uo=e[192];const Kt=uo;let mo;e[193]!==l||e[194]!==j||e[195]!==se||e[196]!==Bt||e[197]!==_e?(mo=()=>{_e?.onCleared?.({serverThreadId:se,currentLeafId:j}),Bt(void 0),mt(xe(l))},e[193]=l,e[194]=j,e[195]=se,e[196]=Bt,e[197]=_e,e[198]=mo):mo=e[198];const Yt=mo,tt=Jd(i?.tags,X?.kind);let fo;e[199]!==l?(fo=Vf(l),e[199]=l,e[200]=fo):fo=e[200];const{autocompletions$:qt,shouldShowAutocomplete$:Jt}=fo;let po;e[201]!==x||e[202]!==Jt?(po=()=>Jt()&&x,e[201]=x,e[202]=Jt,e[203]=po):po=e[203];const Xa=po;let ho;e[204]!==xt||e[205]!==Vt||e[206]!==Dt||e[207]!==U?(ho=m=>ip(m,{toaster:U,canSubmit:xt,isTextContentTooLong:Dt,requestCompletion:Vt}),e[204]=xt,e[205]=Vt,e[206]=Dt,e[207]=U,e[208]=ho):ho=e[208];const go=nl(ho);let So;e[209]!==Kt||e[210]!==Se||e[211]!==qt||e[212]!==K||e[213]!==n||e[214]!==o||e[215]!==lt||e[216]!==Yt||e[217]!==Xa||e[218]!==g||e[219]!==bt||e[220]!==Wt||e[221]!==it||e[222]!==Re||e[223]!==Be||e[224]!==Ba||e[225]!==_e?(So=m=>lp(m,{canAbortCompletion:K&&g,clientThreadId:n,isAutocompletionActive:Xa,clearAutocompletions:()=>qt.set([]),abortCompletion:()=>Kt(n,"escape_key"),isEmpty:bt,hasTargetedContent:_e!=null,clearTargetedContent:Yt,hasSystemHint:Se!=null,removeSystemHint:it,hasSelectedTarget:Re!=null,removeSelectedTarget:()=>Be(null),hasNonDefaultModel:Ba&&o!==lt,removeNonDefaultModel:Wt}),e[209]=Kt,e[210]=Se,e[211]=qt,e[212]=K,e[213]=n,e[214]=o,e[215]=lt,e[216]=Yt,e[217]=Xa,e[218]=g,e[219]=bt,e[220]=Wt,e[221]=it,e[222]=Re,e[223]=Be,e[224]=Ba,e[225]=_e,e[226]=So):So=e[226];const bo=nl(So);let yo,_o;e[227]!==l||e[228]!==go||e[229]!==bo?(yo=()=>mu(xe(l),{Enter:go,Escape:bo}),_o=[l,go,bo],e[227]=l,e[228]=go,e[229]=bo,e[230]=yo,e[231]=_o):(yo=e[230],_o=e[231]),k.useEffect(yo,_o);let xo;e[232]!==h||e[233]!==n||e[234]!==X||e[235]!==u||e[236]!==i||e[237]!==G||e[238]!==$||e[239]!==D||e[240]!==fe||e[241]!==U?(xo=m=>{rp({filePickerStore:G,event:m.nativeEvent,intl:D,toaster:U,clientThreadId:n,conversationMode:X,currentModelConfig:i,getEditorGizmoId:$,modelSupportedImageMimeTypes:fe,activeSystemHintType:h,ctx:u})},e[232]=h,e[233]=n,e[234]=X,e[235]=u,e[236]=i,e[237]=G,e[238]=$,e[239]=D,e[240]=fe,e[241]=U,e[242]=xo):xo=e[242];const Za=xo,ei=Qd(n,Hs,fe,eo?.attachments);let Co;e[243]!==Kt||e[244]!==n||e[245]!==l||e[246]!==G||e[247]!==q||e[248]!==pn?(Co=(m,M)=>{m.preventDefault(),Kt(n,M),Oe.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:pa(n),currentLeafId:dt.getCurrentNode(dl(n)).message.id,eventSource:"mouse"});const Z=hn.current;pn&&Z&&(ha(xe(l),Z.content),zs.restoreFiles(G,Z.files),Xl.setState({attachedTempTextdocs:Z.attachedTempTextdocs}),Z.systemHintType&&(q(Z.systemHintType),ut(n,ee=>{Z.selectedSources&&(ee.selectedSources=ee.selectedSources??new Map,ee.selectedSources.set(Z.systemHintType,new Set(Z.selectedSources))),Z.selectedMCPSources&&(ee.selectedMCPSources=ee.selectedMCPSources??new Map,ee.selectedMCPSources.set(Z.systemHintType,new Set(Z.selectedMCPSources)))})),hn.current=null),fu()},e[243]=Kt,e[244]=n,e[245]=l,e[246]=G,e[247]=q,e[248]=pn,e[249]=Co):Co=e[249];const ti=Co;let Ao;e[250]!==l||e[251]!==se||e[252]!==J?.id?(Ao=()=>{Wl.set(J?.id,se,cp(l))},e[250]=l,e[251]=se,e[252]=J?.id,e[253]=Ao):Ao=e[253],J?.id;const Qt=Ao,Mo=ae!=null;let To,wo;e[254]!==l||e[255]!==Mo||e[256]!==Ye?(To=()=>{Mo||Ye.composer.autofocusDisabled$()||mt(xe(l))},wo=[l,Mo,Ye],e[254]=l,e[255]=Mo,e[256]=Ye,e[257]=To,e[258]=wo):(To=e[257],wo=e[258]),k.useEffect(To,wo);const Xt=ya(Ke);let vo;e[259]!==G||e[260]!==et||e[261]!==fe.length||e[262]!==Xt?(vo=()=>{if(fe.length>0)for(const M of Xt.current)pu(M.fileSpec?.mimeType,et)||zs.remove(G,M.tempId,"none");else zs.reset(G)},e[259]=G,e[260]=et,e[261]=fe.length,e[262]=Xt,e[263]=vo):vo=e[263];let Po;e[264]!==o||e[265]!==G||e[266]!==et||e[267]!==fe.length||e[268]!==Xt?(Po=[o,G,et,fe.length,Xt],e[264]=o,e[265]=G,e[266]=et,e[267]=fe.length,e[268]=Xt,e[269]=Po):Po=e[269],k.useEffect(vo,Po);let ko,jo;e[270]!==tt||e[271]!==re||e[272]!==Re||e[273]!==Be?(ko=()=>{(!tt&&Re||re)&&Be(null)},jo=[tt,Re,re,Be],e[270]=tt,e[271]=re,e[272]=Re,e[273]=Be,e[274]=ko,e[275]=jo):(ko=e[274],jo=e[275]),k.useEffect(ko,jo);let Ro,Io,Eo;if(e[276]!==u){const m=Ds(u,"4031588851"),M=Ds(u,"3637408529");Ro=M.get("is_in_composer_text_exp",!1),Io=M.get("composer_text","MESSAGE_CHATGPT"),Eo=m.get("composer_text","MESSAGE_CHATGPT"),e[276]=u,e[277]=Ro,e[278]=Io,e[279]=Eo}else Ro=e[277],Io=e[278],Eo=e[279];const si=Ro?Io:Eo;let Do,At;if(e[280]!==Se||e[281]!==y||e[282]!==si||e[283]!==i?.id||e[284]!==jt?.gizmo||e[285]!==be||e[286]!==ae||e[287]!==D||e[288]!==H||e[289]!==x||e[290]!==gn||e[291]!==_t||e[292]!==_e){let m;e:{const ee=y?Xd(y):void 0;if(ee){m=[ee.placeholder,ee.isLastingDisabledStyle];break e}if(H){m=[Pe.placeholderWithName,!1];break e}if(_e?.placeholderTextOverride!=null){m=[_e.placeholderTextOverride,!1];break e}if(i?.id===Zd){m=[Pe.n7jupdSystemHintPlaceholder,!1];break e}if(Se){if(Fl(Se.systemHint))if(_t){m=[Pe.n7jupdActivePlaceholder,!1];break e}else{m=[Pe.n7jupdSystemHintPlaceholder,!1];break e}switch(Se.systemHint){case N.Search:{m=[Pe.searchPlaceholder,!1];break e}case N.Think:{m=[Pe.thinkPlaceholder,!1];break e}case N.Slurm:{m=[Pe.connectorPlaceholder,!1];break e}case N.ApiTool:{m=[Pe.apiToolPlaceholder,!1];break e}case N.Research:{m=[Pe.researchPlaceholder,!1];break e}case N.Canvas:{m=[Pe.canvasPlaceholder,!1];break e}case N.Picture:{m=[Pe.picturePlaceholder,!1];break e}case N.PictureV2:{m=[Pe.pictureV2Placeholder,!1];break e}case N.ContextualAnswers:{m=[Pe.contextualAnswersPlaceholder,!1];break e}case N.Tatertot:{m=[Pe.tatertotPlaceholder,!1];break e}}}switch(si){case"BLANK":{m=[null,!1];break e}case"ASK_ANYTHING":{m=[Pe.placeholderAskAnythingVariant,!1];break e}case"ASK_CHATGPT_ANYTHING":{m=[Pe.placeholderAskNameAnythingVariant,!1];break e}default:m=[Pe.placeholderWithName,!1]}}const[M,Z]=m;Do=Z;e:{if(gn)if(x){let ee;e[295]!==jt?.gizmo.display.name||e[296]!==D?(ee=D.formatMessage(Kf.newChatInProject,{projectName:jt?.gizmo.display.name??"this project"}),e[295]=jt?.gizmo.display.name,e[296]=D,e[297]=ee):ee=e[297],At=ee;break e}else{if(!M){At="​";break e}At=D.formatMessage(M,{name:"ChatGPT"});break e}if(!M){At="​";break e}At=D.formatMessage(M,{name:ae!=null?be==="magic"?eu:ae.name||"GPT":jt?.gizmo.display.name??"ChatGPT"})}e[280]=Se,e[281]=y,e[282]=si,e[283]=i?.id,e[284]=jt?.gizmo,e[285]=be,e[286]=ae,e[287]=D,e[288]=H,e[289]=x,e[290]=gn,e[291]=_t,e[292]=_e,e[293]=Do,e[294]=At}else Do=e[293],At=e[294];const ni=At;let No;e[298]!==n||e[299]!==l?(No=()=>$l(Vl(l),()=>{wa.current=performance.now(),Pu.getState().isThreadHeaderVisible&&Gl.hideThreadHeader(),Ep(n)&&Dp(n)}),e[298]=n,e[299]=l,e[300]=No):No=e[300],k.useEffect(No);const oi=tu();let Rl,Bo;e[301]!==qt||e[302]!==oi?(Bo=Ys(()=>oi&&qt().some(tg)),e[301]=qt,e[302]=oi,e[303]=Bo):Bo=e[303],Rl=Bo;const ai=qe(Rl),{connectorConfig:we,isLoading:ii}=su(),li=eo?.attachments;let Lo;e[304]!==we||e[305]!==et||e[306]!==fe||e[307]!==Qt||e[308]!==li?(Lo={connectorConfig:we,modelSupportedImageMimeTypes:fe,modelAcceptedMimeTypes:et,attachmentsProductFeature:li,onOauthRedirect:Qt},e[304]=we,e[305]=et,e[306]=fe,e[307]=Qt,e[308]=li,e[309]=Lo):Lo=e[309];const{onSelectConnector:st,onConnectorOauthRedirect:Zt}=Yf(Lo);qf(we,st);let Ho=null,Fo;e[310]!==Da?(Fo=Da(),e[310]=Da,e[311]=Fo):Fo=e[311];const Il=Fo,bc=T||Il||zt;let Oo;e[312]!==u?(Oo=Jf(u,!1),e[312]=u,e[313]=Oo):Oo=e[313];const{showRecentFilesDropdown:ri}=Oo,Ae=at===$s.None&&!d?ol.ModelNotSupported:vl?ol.HasReachedMaxFiles:Rt!=null?ol.RateLimitReached:void 0;let Uo;e[314]===Symbol.for("react.memo_cache_sentinel")?(Uo={viewTransitionName:"var(--vt-composer-attach-file-action)"},e[314]=Uo):Uo=e[314];const ci=ai&&!Et,di=mc()==="all",ui=Il&&!zt,mi=!ge||Ct,fi=i?.title??"",pi=T?"composer-btn":"legacy";let Go;e[315]!==n||e[316]!==we||e[317]!==Ae||e[318]!==ii||e[319]!==Y||e[320]!==fe||e[321]!==Zt||e[322]!==st||e[323]!==Ce||e[324]!==zt||e[325]!==di||e[326]!==ui||e[327]!==mi||e[328]!==fi||e[329]!==pi||e[330]!==ci?(Go=s.jsx("div",{"data-testid":"composer-action-file-upload",style:Uo,children:s.jsx(jh,{clientThreadId:n,modelSupportedImageMimeTypes:fe,openFileDialog:Ce,historyDisabled:Y,highlightTooltip:ci,isLoadingConnectors:ii,connectorConfig:we,onSelectConnector:st,onConnectorOauthRedirect:Zt,showLabel:di,showUpsell:ui,showMenuForNoAuth:zt,isDisabled:mi,disabledReason:Ae,currentModelName:fi,visualTreatment:pi})},"file-upload-button"),e[315]=n,e[316]=we,e[317]=Ae,e[318]=ii,e[319]=Y,e[320]=fe,e[321]=Zt,e[322]=st,e[323]=Ce,e[324]=zt,e[325]=di,e[326]=ui,e[327]=mi,e[328]=fi,e[329]=pi,e[330]=ci,e[331]=Go):Go=e[331];const yc=Go;let zo;e[332]!==u||e[333]!==i?.title||e[334]!==Ae||e[335]!==D||e[336]!==ge||e[337]!==Ce?(zo=()=>hu(u).addAction({key:"uploadFile",action:Ce,actionMessageDescriptor:Br(u,D,!ge,Ae,i?.title),group:up.Chat,keyboardBinding:dp}),e[332]=u,e[333]=i?.title,e[334]=Ae,e[335]=D,e[336]=ge,e[337]=Ce,e[338]=zo):zo=e[338];let Wo;e[339]!==u||e[340]!==i||e[341]!==Ae||e[342]!==D||e[343]!==ge||e[344]!==Ce?(Wo=[u,i,Ae,D,ge,Ce],e[339]=u,e[340]=i,e[341]=Ae,e[342]=D,e[343]=ge,e[344]=Ce,e[345]=Wo):Wo=e[345],k.useEffect(zo,Wo);let $o;if(e[346]!==u||e[347]!==T){const m=Ds(u,"853191128");$o=!T&&Mt(u,"3259514411")&&m.get("is_tatertot_enabled",!1),e[346]=u,e[347]=T,e[348]=$o}else $o=e[348];const hi=$o,es=fe.length>0;if(Te){let m;e[349]!==V||e[350]!==we||e[351]!==Le||e[352]!==ye?(m=!ye&&Le&&(Qf(we)||V&&V.length>5),e[349]=V,e[350]=we,e[351]=Le,e[352]=ye,e[353]=m):m=e[353];const M=m;let Z;e[354]!==we||e[355]!==ge||e[356]!==T||e[357]!==Zt||e[358]!==st||e[359]!==ye?(Z=T&&ge&&s.jsxs(le.Group,{children:[ye&&s.jsx(er,{includeAction:!0,shortName:!0,connectorConfig:we,onConnectorClick:st}),s.jsx(mp,{includeSeparator:!1,includeAction:!0,shortName:!0,connectorConfig:we,onConnectorClick:Zt})]},"connect-apps"),e[354]=we,e[355]=ge,e[356]=T,e[357]=Zt,e[358]=st,e[359]=ye,e[360]=Z):Z=e[360];const ee=Z;let ve;e[361]!==h||e[362]!==V||e[363]!==n||e[364]!==ee||e[365]!==Lt||e[366]!==Le||e[367]!==T||e[368]!==S||e[369]!==q?(ve=Lt&&T&&(Le||ee)?s.jsxs(fp,{layoutMode:S,children:[s.jsx(le.Group,{children:s.jsx(al,{systemHints:V,selectedHintType:h,onSelectHintType:Fe=>{q(Fe,{analyticsMetadata:{clientThreadId:n}})}})}),ee]},"tools-menu"):null,e[361]=h,e[362]=V,e[363]=n,e[364]=ee,e[365]=Lt,e[366]=Le,e[367]=T,e[368]=S,e[369]=q,e[370]=ve):ve=e[370];let Ie;e[371]!==o||e[372]!==S||e[373]!==rt||e[374]!==La?(Ie=La?s.jsx(pp,{layoutMode:S,selectedModelId:o??"",onSelectModelId:Fe=>{rt(Fe,"plus menu")}},"models-menu"):null,e[371]=o,e[372]=S,e[373]=rt,e[374]=La,e[375]=Ie):Ie=e[375];let ct;e[376]!==ve||e[377]!==Ie?(ct=[ve,Ie].filter(eg),e[376]=ve,e[377]=Ie,e[378]=ct):ct=e[378];const Ee=ct;let xs;e[379]!==V||e[380]!==M?(xs=V&&(M?V.slice(0,4):V),e[379]=V,e[380]=M,e[381]=xs):xs=e[381];const Ft=xs,Oi=ye?"sheet":void 0,Ui=!ge,Gi=i?.title;let Cs;e[382]!==Ae||e[383]!==es||e[384]!==Ce||e[385]!==Rt||e[386]!==Oi||e[387]!==Ui||e[388]!==Gi?(Cs=s.jsx(hp,{openFileDialog:Ce,modelSupportsImages:es,mode:Oi,showMenuForNoAuth:!1,isDisabled:Ui,disabledReason:Ae,currentModelName:Gi,rateLimitInfo:Rt}),e[382]=Ae,e[383]=es,e[384]=Ce,e[385]=Rt,e[386]=Oi,e[387]=Ui,e[388]=Gi,e[389]=Cs):Cs=e[389];let As;e[390]!==z||e[391]!==we||e[392]!==G||e[393]!==ge||e[394]!==T||e[395]!==fe||e[396]!==es||e[397]!==st||e[398]!==ye||e[399]!==ri?(As=T&&s.jsxs(s.Fragment,{children:[ge&&es&&s.jsx(gp,{modelSupportedImageMimeTypes:fe}),!ye&&ge&&s.jsx(er,{includeAction:!0,shortName:!0,connectorConfig:we,onConnectorClick:st}),ri&&s.jsx(Sp,{attachedFileIds:z,onAttachLibraryFile:Fe=>zs.attachLibraryFile(G,Fe)}),s.jsx(bp,{}),s.jsx(fh,{modelSupportedImageMimeTypes:fe})]}),e[390]=z,e[391]=we,e[392]=G,e[393]=ge,e[394]=T,e[395]=fe,e[396]=es,e[397]=st,e[398]=ye,e[399]=ri,e[400]=As):As=e[400];let Ms;e[401]!==Cs||e[402]!==As?(Ms=s.jsxs(le.Group,{className:"content-sheet:content-sheet-inset-section",children:[Cs,As]},"add-files"),e[401]=Cs,e[402]=As,e[403]=Ms):Ms=e[403];let Ts;e[404]!==h||e[405]!==V||e[406]!==Ft||e[407]!==n||e[408]!==ee||e[409]!==Lt||e[410]!==Le||e[411]!==T||e[412]!==S||e[413]!==q||e[414]!==M?(Ts=(!Lt||!T)&&Le?s.jsxs(le.Group,{children:[s.jsx(al,{systemHints:Ft,selectedHintType:h,onSelectHintType:Fe=>{q(Fe,{analyticsMetadata:{clientThreadId:n}})}}),M&&s.jsxs(Xf,{layoutMode:S,children:[s.jsx(le.Group,{children:s.jsx(al,{systemHints:V?.slice(4),selectedHintType:h,onSelectHintType:Fe=>{q(Fe,{analyticsMetadata:{clientThreadId:n}})}})}),ee]})]},"system-hints"):null,e[404]=h,e[405]=V,e[406]=Ft,e[407]=n,e[408]=ee,e[409]=Lt,e[410]=Le,e[411]=T,e[412]=S,e[413]=q,e[414]=M,e[415]=Ts):Ts=e[415];const zi=(!Lt||!T)&&ee&&(!M||!Le||ye)?ee:null;let ws;e[416]!==Ee?(ws=Ee.length>0?s.jsx(le.Group,{children:Ee},"submenus"):null,e[416]=Ee,e[417]=ws):ws=e[417];let vs;e[418]!==T?(vs=T?null:s.jsx(yp,{},"upsell"),e[418]=T,e[419]=vs):vs=e[419];let Ps;e[420]!==D||e[421]!==Na?(Ps=Na?s.jsx(le.Group,{children:s.jsx("div",{className:"text-token-text-tertiary p-2 text-center text-sm",children:D.formatMessage({id:"composer.plusMenu.typeSlashForQuickAccess",defaultMessage:"Type '/' for quick access"})})},"slash-hint"):null,e[420]=D,e[421]=Na,e[422]=Ps):Ps=e[422];let da;e[423]!==Ms||e[424]!==Ts||e[425]!==zi||e[426]!==ws||e[427]!==vs||e[428]!==Ps?(da=[Ms,Ts,zi,ws,vs,Ps].filter(Zh),e[423]=Ms,e[424]=Ts,e[425]=zi,e[426]=ws,e[427]=vs,e[428]=Ps,e[429]=da):da=e[429];const Wi=da,$i=ye?"sheet":"dropdown";let ks;e[430]!==l||e[431]!==Ye.composer?(ks=Fe=>{Ye.composer.autofocusDisabled$()||(Fe.preventDefault(),mt(xe(l)))},e[430]=l,e[431]=Ye.composer,e[432]=ks):ks=e[432];const Vi=Te?null:Rt,Ki=ai&&!Et;let js;e[433]!==D||e[434]!==T?(js=T?D.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):D.formatMessage({id:"composer.plusMenu.label.loggedOut",defaultMessage:"Add photos and more"}),e[433]=D,e[434]=T,e[435]=js):js=e[435];let ua;e[436]===Symbol.for("react.memo_cache_sentinel")?(ua=s.jsx("kbd",{className:"bg-token-bg-tertiary -me-1 inline-grid aspect-square w-4 items-center justify-center rounded-sm text-[11px]",children:s.jsx("span",{children:"/"})}),e[436]=ua):ua=e[436];const Yi=ge?Ce:void 0;let Rs;e[437]!==u?(Rs=Fe=>{if(!zl())return;const Dl=_p(u);Dl.isKeyboardOpen()&&(Fe.preventDefault(),Dl.closeKeyboard(()=>{xp(u).open$.set(!0)}))},e[437]=u,e[438]=Rs):Rs=e[438];let Is;e[439]!==Ct||e[440]!==Yi||e[441]!==Rs?(Is=s.jsx(Cp,{onDoubleClick:Yi,onPointerDown:Rs,disabled:Ct}),e[439]=Ct,e[440]=Yi,e[441]=Rs,e[442]=Is):Is=e[442];let Es;e[443]!==n||e[444]!==A||e[445]!==Vi||e[446]!==Ki||e[447]!==js||e[448]!==Is?(Es=s.jsx(Ap,{disabled:A,clientThreadId:n,rateLimitPopup:Vi,highlightTooltip:Ki,label:js,secondaryLabel:ua,children:Is}),e[443]=n,e[444]=A,e[445]=Vi,e[446]=Ki,e[447]=js,e[448]=Is,e[449]=Es):Es=e[449];let ma;e[450]!==va||e[451]!==Wi||e[452]!==$i||e[453]!==ks||e[454]!==Es?(ma=s.jsx(Mp,{mode:$i,onCloseAutoFocus:ks,items:Wi,fileUploadRateLimited:va,children:Es}),e[450]=va,e[451]=Wi,e[452]=$i,e[453]=ks,e[454]=Es,e[455]=ma):ma=e[455],Ho=ma}const[gi,ts]=k.useState(!1),Si=Do||Sc?"disabled":"default",_c=!xt,bi=!Pl;let Vo;e[456]!==y||e[457]!==Ia||e[458]!==Pn||e[459]!==In||e[460]!==Nt||e[461]!==Dt||e[462]!==Me||e[463]!==bi?(Vo=gu({promptDisabledReason:y,hasPendingFiles:Pn,hasTextContent:In,isTextContentTooLong:Dt,hasAsyncTaskPending:Ia,noSourceSelectedDr:bi,isDeepResearchTaskStreaming:Nt,isThreadHardBlocked:Me}),e[456]=y,e[457]=Ia,e[458]=Pn,e[459]=In,e[460]=Nt,e[461]=Dt,e[462]=Me,e[463]=bi,e[464]=Vo):Vo=e[464];const yi=Vo,He=_t?"streaming":_c?"disabled":"idle",Gs=k.useRef(null),ss=k.useRef(null);let Ko;e[465]!==u?(Ko=Mt(u,"222560275"),e[465]=u,e[466]=Ko):Ko=e[466];const _i=Ko;let Yo;e[467]!==o||e[468]!==_i?(Yo=_i||o&&!o.startsWith("o1")&&!o.startsWith("o3"),e[467]=o,e[468]=_i,e[469]=Yo):Yo=e[469];const xi=Yo;let qo;e[470]!==n||e[471]!==A||e[472]!==y||e[473]!==He||e[474]!==g||e[475]!==yt||e[476]!==Me?(qo=()=>{const m=()=>{Gs.current!=null&&Tu.addAction("composer_state_disabled",{threadId:pa(n),disabledReason:Gs.current})};if(yt&&He==="disabled"){let M="unknown";A?M=y??"component_disabled_unknown":g?M="completion_in_progress":Me&&(M="thread_hard_blocked"),Gs.current!==M&&(ss.current&&clearTimeout(ss.current),ss.current=setTimeout(m,Jh)),Gs.current=M}else Gs.current=null;return()=>{ss.current&&(clearTimeout(ss.current),ss.current=null)}},e[470]=n,e[471]=A,e[472]=y,e[473]=He,e[474]=g,e[475]=yt,e[476]=Me,e[477]=qo):qo=e[477];let Jo;e[478]!==n||e[479]!==A||e[480]!==y||e[481]!==He||e[482]!==g||e[483]!==yt||e[484]!==Me?(Jo=[n,yt,He,A,y,g,Me],e[478]=n,e[479]=A,e[480]=y,e[481]=He,e[482]=g,e[483]=yt,e[484]=Me,e[485]=Jo):Jo=e[485],k.useEffect(qo,Jo);let ns;e[486]!==Yt||e[487]!==_e?(ns=_e?.label?{type:_e.type,value:_e.label,onRemoveRegion:Yt}:null,e[486]=Yt,e[487]=_e,e[488]=ns):ns=e[488];let os;e[489]!==l||e[490]!==Re||e[491]!==Be?(os=Re!=null?{type:"mention",value:Re.gizmo.display.name,icon:s.jsx(Fr,{isFirstParty:!!Re.gizmo.tags?.includes(mr.FirstParty),src:Re.gizmo.display.profile_picture_url,className:"icon"}),onRemoveRegion:()=>{Be(null),mt(xe(l))}}:null,e[489]=l,e[490]=Re,e[491]=Be,e[492]=os):os=e[492];let Qo;e[493]!==ns||e[494]!==os?(Qo=[ns,os].filter(Xh),e[493]=ns,e[494]=os,e[495]=Qo):Qo=e[495];const Ci=Qo;let El,Xo;e[496]!==Se?.systemHint||e[497]!==x||e[498]!==Ls||e[499]!==Jt?(Xo=Ys(()=>x&&Se?.systemHint!==N.Research&&Se?.systemHint!==N.ApiTool&&!Ls&&Jt()),e[496]=Se?.systemHint,e[497]=x,e[498]=Ls,e[499]=Jt,e[500]=Xo):Xo=e[500],El=Xo;const Ai=El;let Zo;e[501]!==He||e[502]!==Vt||e[503]!==Nt||e[504]!==bt||e[505]!==Sn||e[506]!==ti||e[507]!==ts?(Zo=m=>{if(m.preventDefault(),m.stopPropagation(),wa.current>0){const M=performance.now()-wa.current;Xi.hist(Zi.DEFAULT,"final_user_input_to_submit_ms",[],M)}He==="streaming"&&(!Sn||bt)?Nt?ts(!0):ti(m,bt?"stop_button":"stop_button_with_prompt"):Vt(m)},e[501]=He,e[502]=Vt,e[503]=Nt,e[504]=bt,e[505]=Sn,e[506]=ti,e[507]=ts,e[508]=Zo):Zo=e[508];const Mi=Zo;let ea;e[509]!==c?.normalizedAccountUserId||e[510]!==n||e[511]!==l||e[512]!==b?(ea=()=>{const m=pa(n),M=c?.normalizedAccountUserId;if(!M||b)return;const Z=Su(ee=>{if(bu(ee.doc))yu(m);else{const ve=Ol(ee.doc).content;_u(m,ve,M)}},1e3);return $l(Vl(l),Z)},e[509]=c?.normalizedAccountUserId,e[510]=n,e[511]=l,e[512]=b,e[513]=ea):ea=e[513];let ta;e[514]!==c||e[515]!==n||e[516]!==l||e[517]!==b||e[518]!==se?(ta=[c,n,l,b,se],e[514]=c,e[515]=n,e[516]=l,e[517]=b,e[518]=se,e[519]=ta):ta=e[519],k.useEffect(ea,ta);let as;e[520]!==h||e[521]!==n||e[522]!==r?(as=m=>r({event:m,conversationMode:dl(n)?.mode,systemHints:h?[h]:[]}),e[520]=h,e[521]=n,e[522]=r,e[523]=as):as=e[523];let sa;e[524]!==W||e[525]!==tt||e[526]!==n||e[527]!==A||e[528]!==l||e[529]!==X||e[530]!==j||e[531]!==Q||e[532]!==io||e[533]!==x||e[534]!==Ce||e[535]!==as?(sa=s.jsx(lh,{canUseInlineTagging:tt,isDisabled:A,clientThreadId:n,currentLeafId:j,currentRequestId:Q,canContinue:W,composerController:l,isNewThread:x,onContinueGenerating:as,onResetState:io,openFileDialog:Ce,conversationMode:X}),e[524]=W,e[525]=tt,e[526]=n,e[527]=A,e[528]=l,e[529]=X,e[530]=j,e[531]=Q,e[532]=io,e[533]=x,e[534]=Ce,e[535]=as,e[536]=sa):sa=e[536];const Ti=sa;let na;e[537]!==n||e[538]!==X||e[539]!==Ja||e[540]!==_t||e[541]!==xi?(na=!_t&&X!=null&&xi&&Zf.includes(X.kind)&&s.jsx(ep,{clientThreadId:n,onTargetedReply:Ja}),e[537]=n,e[538]=X,e[539]=Ja,e[540]=_t,e[541]=xi,e[542]=na):na=e[542];const wi=na;let oa;e[543]!==l||e[544]!==ei?(oa=s.jsx(Tp,{composerController:l,parsedDocumentHandler:ei}),e[543]=l,e[544]=ei,e[545]=oa):oa=e[545];const vi=oa;let aa;e[546]!==B||e[547]!==w?(aa=!w&&s.jsx(Yp,{className:B}),e[546]=B,e[547]=w,e[548]=aa):aa=e[548];const Pi=aa,ki=eo?.attachments;let ia;e[549]!==fe||e[550]!==ki?(ia=s.jsx(tp,{modelSupportedImageMimeTypes:fe,uploadType:$s.Multimodal,attachmentsProductFeature:ki}),e[549]=fe,e[550]=ki,e[551]=ia):ia=e[551];const ji=ia;let la;e[552]!==u?(la=Mt(u,"3127600850"),e[552]=u,e[553]=la):la=e[553];const Ri=la,Ii=!Te&&bc?yc:null;let is;e[554]!==c||e[555]!==h||e[556]!==V||e[557]!==It||e[558]!==n||e[559]!==l||e[560]!==i||e[561]!==de||e[562]!==St||e[563]!==T||e[564]!==Te||e[565]!==Ct||e[566]!==Ha?(is=!T&&!Te?s.jsx(wp,{account:c,clientBootstrapFlags:It,features:de,currentModelConfig:i,isDisabled:Ct,clientThreadId:n,composerController:l,gizmoId:St}):Ha?s.jsx(vp,{activeSystemHintType:h,systemHints:V,composerController:l,clientThreadId:n,disabled:Ct}):null,e[554]=c,e[555]=h,e[556]=V,e[557]=It,e[558]=n,e[559]=l,e[560]=i,e[561]=de,e[562]=St,e[563]=T,e[564]=Te,e[565]=Ct,e[566]=Ha,e[567]=is):is=e[567];let ls;e[568]!==n||e[569]!==l||e[570]!==hi||e[571]!==T||e[572]!==Te?(ls=!T&&!Te&&hi?s.jsx(Pp,{composerController:l,clientThreadId:n}):null,e[568]=n,e[569]=l,e[570]=hi,e[571]=T,e[572]=Te,e[573]=ls):ls=e[573];let ra;e[574]!==Ii||e[575]!==is||e[576]!==ls?(ra=[Ii,is,ls].filter(Qh),e[574]=Ii,e[575]=is,e[576]=ls,e[577]=ra):ra=e[577];const Ei=ra;let rs;e[578]!==Qt?(rs=s.jsx(kp,{onOauthRedirect:Qt}),e[578]=Qt,e[579]=rs):rs=e[579];let cs;e[580]!==Ri?(cs=Ri&&s.jsx(qh,{}),e[580]=Ri,e[581]=cs):cs=e[581];let ds;e[582]!==gi||e[583]!==n||e[584]!==ts||e[585]!==Os?(ds=Os&&gi&&s.jsx(sp,{taskId:Os.taskId,clientThreadId:n,onClose:()=>ts(!1)}),e[582]=gi,e[583]=n,e[584]=ts,e[585]=Os,e[586]=ds):ds=e[586];const Di=!ge,Ni=ai&&!Et,xc=Ho,Bi=Xe||!T&&!Te;let us;e[587]!==Ka?(us=Ka(),e[587]=Ka,e[588]=us):us=e[588];let ms;e[589]!==us?(ms=s.jsx("input",{...us}),e[589]=us,e[590]=ms):ms=e[590];const Li=Te?void 0:!0;let fs;e[591]!==Se||e[592]!==n||e[593]!==l||e[594]!==Ho||e[595]!==Ei||e[596]!==He||e[597]!==Ve||e[598]!==X||e[599]!==i||e[600]!==yi||e[601]!==Ae||e[602]!==St||e[603]!==Et||e[604]!==Si||e[605]!==Te||e[606]!==Y||e[607]!==Mi||e[608]!==Ke||e[609]!==ni||e[610]!==Wt||e[611]!==it||e[612]!==Ci||e[613]!==ro||e[614]!==Xe||e[615]!==Di||e[616]!==Ni||e[617]!==Bi||e[618]!==ms||e[619]!==Li?(fs=s.jsx($h,{hasFiles:Et,pendingFiles:Ke,isUploadDisabled:Di,clientThreadId:n,highlightUploadTooltip:Ni,disableReason:yi,uploadButtonDisabledReason:Ae,currentModelConfig:i,conversationMode:X,state:He,inputState:Si,gizmoId:St,includeSidebarContextTray:ro,isTemporaryChat:Y,placeholder:ni,composerController:l,onSubmit:Mi,replyRegions:Ci,leadingAction:xc,legacyFooterActions:Ei,activeSystemHint:Se,hideSystemHint:Bi,isSystemHintLocked:Xe,onRemoveSystemHint:it,onRemoveModel:Wt,contextualAnswerUserConnectionData:Ve,fileInput:ms,expanded:Li,expandOnMultilineInput:Te}),e[591]=Se,e[592]=n,e[593]=l,e[594]=Ho,e[595]=Ei,e[596]=He,e[597]=Ve,e[598]=X,e[599]=i,e[600]=yi,e[601]=Ae,e[602]=St,e[603]=Et,e[604]=Si,e[605]=Te,e[606]=Y,e[607]=Mi,e[608]=Ke,e[609]=ni,e[610]=Wt,e[611]=it,e[612]=Ci,e[613]=ro,e[614]=Xe,e[615]=Di,e[616]=Ni,e[617]=Bi,e[618]=ms,e[619]=Li,e[620]=fs):fs=e[620];let ps;e[621]!==V?(ps=V??[],e[621]=V,e[622]=ps):ps=e[622];let hs;e[623]!==V?(hs=V??[],e[623]=V,e[624]=hs):hs=e[624];const Hi=i??null,Fi=St??null;let gs;e[625]!==tt||e[626]!==n||e[627]!==l||e[628]!==Fn||e[629]!==Ve||e[630]!==lt||e[631]!==Ae||e[632]!==re||e[633]!==ge||e[634]!==S||e[635]!==Ce||e[636]!==rt||e[637]!==q||e[638]!==Be||e[639]!==ps||e[640]!==hs||e[641]!==Hi||e[642]!==Fi?(gs=s.jsx(_h,{systemHints:ps,availableSystemHints:hs,composerController:l,clientThreadId:n,layoutMode:S,composerLayer:Fn,canUseInlineTagging:tt,isFileUploadEnabled:ge,fileUploadDisabledReason:Ae,currentModelConfig:Hi,openFileDialog:Ce,connectionInstanceData:Ve,setActiveSystemHintType:q,defaultModelId:lt,selectModelId:rt,gizmoId:Fi,hasGizmoFeatureRateLimit:re,setSelectedGizmoTag:Be}),e[625]=tt,e[626]=n,e[627]=l,e[628]=Fn,e[629]=Ve,e[630]=lt,e[631]=Ae,e[632]=re,e[633]=ge,e[634]=S,e[635]=Ce,e[636]=rt,e[637]=q,e[638]=Be,e[639]=ps,e[640]=hs,e[641]=Hi,e[642]=Fi,e[643]=gs):gs=e[643];let Ss;e[644]!==n?(Ss=!1,e[644]=n,e[645]=Ss):Ss=e[645];let bs;e[646]!==Ai||e[647]!==n||e[648]!==l||e[649]!==S?(bs=s.jsx(jp,{canShowAutocomplete$:Ai,layoutMode:S,composerController:l,clientThreadId:n}),e[646]=Ai,e[647]=n,e[648]=l,e[649]=S,e[650]=bs):bs=e[650];let ys;e[651]!==Za||e[652]!==Pi||e[653]!==rs||e[654]!==cs||e[655]!==ds||e[656]!==fs||e[657]!==gs||e[658]!==Ss||e[659]!==bs?(ys=s.jsxs("div",{className:"relative z-1 flex h-full max-w-full flex-1 flex-col",onPaste:Za,children:[rs,cs,Pi,ds,fs,gs,Ss,bs]}),e[651]=Za,e[652]=Pi,e[653]=rs,e[654]=cs,e[655]=ds,e[656]=fs,e[657]=gs,e[658]=Ss,e[659]=bs,e[660]=ys):ys=e[660];let _s;e[661]!==h||e[662]!==V||e[663]!==it?(_s=h&&V&&s.jsx(Pg,{availableSystemHints:V,systemHintType:h,onRemoveSystemHint:it}),e[661]=h,e[662]=V,e[663]=it,e[664]=_s):_s=e[664];let ca;return e[665]!==Hs||e[666]!==vi||e[667]!==ji||e[668]!==Ti||e[669]!==ys||e[670]!==_s||e[671]!==wi?(ca=s.jsxs(np.Provider,{value:Hs,children:[ys,vi,Ti,wi,ji,_s]}),e[665]=Hs,e[666]=vi,e[667]=ji,e[668]=Ti,e[669]=ys,e[670]=_s,e[671]=wi,e[672]=ca):ca=e[672],ca}function Qh(t){return t!=null}function Xh(t){return t!=null}function Zh(t){return t!=null}function eg(t){return t!=null}function tg(t){return t.requires_file_upload}function sg(t){const[e,a]=t;return[e,{...a}]}function ng(t){return{...t}}function og(t){return t!=null}function ag(t){Au.startEnforcement(t),Mu.startEnforcement(t)}function ig(t){return t.delete("sources"),t}function lg(t){return!Ns(t)}function rg(t){return t.trim()}function cg(t){return t.delete("github_onboarding"),t}function dg(t){const e=t.selectedSources?.get(N.Slurm)??new Set;t.selectedSources==null&&(t.selectedSources=new Map),t.selectedSources.set(N.Slurm,new Set([...e,De.GITHUB_CONNECTOR]))}function ug(t){return t.systemHint===N.Slurm}function mg(t){return!Ns(t)}function fg(t){return t.trim()}function pg(t){t.isUsingPromptTemplate=!0}function hg(t){return t.delete("share_prompt"),t}function gg(t){return t.selectedApps}function Sg(){return Ip()}function bg(t){return t.gizmoId==null}function yg(t){return t.gizmoId!=null}function _g(t){return t!==void 0}function xg(t){const{locked:e}=t;return e}function Cg(t){return[xu(t),Zs(t)]}function Ag(t){return[dt.getCurrentLeafId(t),dt.getRequestId(t),dt.findNode(t,Mg),dt.getIsNewConversation(t),dt.lastUserMessage(t)?.metadata?.system_hints?.includes(N.Agent),!!t?.interruptionInProgress&&!!dt.getCurrentNode(t)?.message.metadata?.n7jupd_message,t?.startedWithMcp]}function Mg(t){return!!t.message.metadata?.b1de6e2_s}function Tg(t){return t.files.map(vg).filter(wg)}function wg(t){return t!=null}function vg(t){return t.fileId}const Pg=({availableSystemHints:t,systemHintType:e,onRemoveSystemHint:a})=>{const r=t!=null&&t.every(n=>n.systemHint!==e),{externalModelsLoading:c,fullModelsLoading:o}=wu(),{isBlocked:i}=Or(e),f=ft(),d=!kr(f);return k.useEffect(()=>{c||o||(r||i)&&!d&&a()},[r,i,d,a,e,c,o]),null};function kg(t){"use forget";const e=Tt.c(7),[a,r]=k.useState(null),c=sr(t);let o,i;e[0]!==c||e[1]!==a?(i=a!=null?{gizmo:a,gizmo_id:a.gizmo.id,kind:_a.GizmoInteraction}:c,e[0]=c,e[1]=a,e[2]=i):i=e[2],o=i;const f=o,d=f&&"gizmo"in f&&f.gizmo!=null?f?.gizmo:void 0;let n;return e[3]!==f||e[4]!==d||e[5]!==a?(n=[f,d,a,r],e[3]=f,e[4]=d,e[5]=a,e[6]=n):n=e[6],n}function jg(t,e,a,r,c,o){"use forget";const i=Tt.c(7);let f;e:{if(!t){let n;i[0]===Symbol.for("react.memo_cache_sentinel")?(n=[],i[0]=n):n=i[0],f=n;break e}let d;i[1]!==o||i[2]!==r||i[3]!==a||i[4]!==c||i[5]!==e?(d=e?.filter(n=>Rp({systemHint:n,modelConfig:a,conversationMode:r,isTemporaryChat:c}))?.filter(n=>n.systemHint!==N.Agent?!0:o),i[1]=o,i[2]=r,i[3]=a,i[4]=c,i[5]=e,i[6]=d):d=i[6],f=d}return f}function Rg(t){"use forget";return Cu(t)?.id??null}export{zg as P,Yp as a};
//# sourceMappingURL=lxgn8k46ba24438b.js.map

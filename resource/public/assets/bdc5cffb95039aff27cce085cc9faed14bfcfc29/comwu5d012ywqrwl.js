import{k_ as U,e as L,p as O,eg as C,B as F,hz as G,hE as H,z as x,gA as W,de as P,S as q,lU as z,oi as D}from"./dmck639k4dv7claj.js";import{j as e,e as A,r as h,M as a,I as M}from"./cs7toih8jegb7teq.js";import{W as $,u as V}from"./fba6r4282q3hco9o.js";import{u as N}from"./lco7biunzadofjpa.js";import{aj as p,b1 as Q,fu as J,bC as K,ai as j}from"./hnw079jsdm76umup.js";import{z as _,A as X,u as Y}from"./crerkmhvihiw48az.js";import{T as n}from"./jowyjrirlo5h1pme.js";import Z from"./bb0fpf9yqlou2d9e.js";import{I as ee}from"./ig3euz6ql417cw29.js";import{u as se}from"./jyhehpfhizgr7mgi.js";import{u as te}from"./fthj90769o63ez5l.js";import"./dupxx6qfa09nz1fw.js";import"./mahhuo4zclh446vl.js";import"./l1m3l5lbmhuctzw6.js";import"./g9gr3l5lwhb3z8y8.js";import"./yf0i1e6tgcrdg1ll.js";import"./mcuu3cegz8rmschr.js";import"./o12mkc4t9o2t0ta8.js";import"./dr58d0qi3ke74zcr.js";import"./mntlin6h4lg868yr.js";function ae({value:i,options:o,disabled:r,onChange:s}){const c=o.find(t=>t.value===i);return e.jsxs(p.Root,{value:i,onValueChange:t=>s(t),disabled:r,children:[e.jsxs(p.Trigger,{className:"w-fit",children:[e.jsx("div",{className:"text-sm font-normal",children:c?.title}),e.jsx(p.Icon,{})]}),e.jsx(p.Portal,{children:e.jsx(p.Content,{children:o.map(t=>e.jsx(p.Item,{value:t.value,children:e.jsxs("div",{className:"flex min-w-[360px] flex-col",children:[e.jsx("span",{className:"text-sm font-normal",children:t.title}),e.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.description})]})},t.value))})})]})}function ie({isSaving:i,initialScope:o,onChange:r}){const s=A(),c=N(),[t,g]=h.useState(o);return e.jsx("section",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-sm font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.autoReviewMyPRs",defaultMessage:"Review my pull requests"})}),e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.autoReviewMyPRs.description",defaultMessage:"Codex automatically suggests improvements (or reacts with 👍)"})})]}),e.jsx(ae,{value:t,options:[{value:"never",title:s.formatMessage({id:"wham.codeReviewPage.autoReview.optionOff",defaultMessage:"Off"}),description:s.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll",defaultMessage:"Across all repos"})},{value:"always",title:s.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll",defaultMessage:"Across all repos"}),description:s.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll.description",defaultMessage:"Run code reviews on my PRs in every repo"})},{value:"repo_default",title:c?s.formatMessage({id:"wham.codeReviewPage.autoReview.optionTeam",defaultMessage:"Only in team-enabled repos"}):s.formatMessage({id:"wham.codeReviewPage.autoReview.optionPersonal",defaultMessage:"Only in specific repos"}),description:c?s.formatMessage({id:"wham.codeReviewPage.autoReview.optionTeam.description",defaultMessage:"Run only in repos where my team has enabled them"}):s.formatMessage({id:"wham.codeReviewPage.autoReview.optionPersonal.description",defaultMessage:"Run only in selected repos"})}],disabled:i,onChange:d=>{g(d),r(d)}})]})})}function ne(){return e.jsx(Q,{type:"info",className:"bg-token-bg-tertiary! rounded-2xl!",icon:e.jsx(J,{className:"icon-md text-token-text-tertiary"}),isElevated:!1,content:e.jsx("p",{className:"text-token-text-secondary text-sm leading-tight font-normal",children:e.jsx(a,{id:"wham.codeReviewPage.infoBanner.title",defaultMessage:"Mention @<b>codex</b> in your pull request to ask questions or start a task.",values:{b:i=>e.jsx("span",{className:"font-medium",children:i})}})})})}function le(i,o){const r=U("installations/select_target");if(i.length>1)return r;const s=i[0];return o?s.account_type==="user"?`https://github.com/settings/installations/${s.id}/permissions/update`:`https://github.com/organizations/${s.account_login}/settings/installations/${s.id}/permissions/update`:`https://github.com/settings/installations/${s.id}`}function oe(){const i=L(),o=O(i,"2782825951"),{data:r}=_(),s=h.useMemo(()=>r?.installations_without_events??[],[r]);if(s.length===0)return null;const c=le(s,o);return e.jsx("div",{className:"pt-2",children:e.jsxs("div",{className:"bg-token-bg-status-warning outline-token-border-status-warning flex items-start justify-start gap-3 self-stretch rounded-2xl p-4 outline outline-offset-[-1px]",children:[e.jsx("div",{className:"text-token-text-status-warning relative h-5 w-5",children:e.jsx(C,{className:"icon-md"})}),e.jsxs("div",{className:"inline-flex flex-1 flex-col items-start justify-start gap-1",children:[e.jsx("div",{className:"text-token-text-status-warning text-sm leading-tight font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.title",defaultMessage:"Action required"})}),e.jsx("div",{className:"justify-start self-stretch",children:e.jsx("p",{className:"text-token-text-status-warning text-sm leading-tight font-normal",children:s.length>1?e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.multiple",defaultMessage:"Some repos require updated GitHub permissions for code reviews to work"}):e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.single",defaultMessage:"Update your GitHub permissions to enable code reviews for <u>{installationName}</u>",values:{u:t=>e.jsx("span",{className:"underline",children:t}),installationName:s[0].account_login}})})})]}),e.jsx("div",{className:"inline-flex flex-col items-start justify-center gap-2 self-stretch",children:e.jsx(F,{color:"secondary",icon:G,onClick:()=>{window.open(c,"_blank")},children:e.jsx("div",{className:"text-token-interactive-label-secondary-default justify-start text-sm leading-tight",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.updateButton",defaultMessage:"Update"})})})})]})})}function re({disabledInstallations:i=[]}){const o=A(),[r,s]=h.useState(""),c=K(r,300),[t,g]=h.useState("all"),d=N(),{data:f,isLoading:v,isFetching:w,fetchNextPage:k,hasNextPage:S,isFetchingNextPage:T}=X(c.trim()),{mutate:B}=se(),b=h.useMemo(()=>{const l=(f?.pages??[]).flatMap(u=>u.repo_review_settings).filter(Boolean);return t==="enabled"?l.filter(u=>u.review_preference==="team"):l},[f,t]),m=d?["w-[65%] sm:w-[40%]","w-[25%] sm:w-[20%]","w-[10%] sm:w-[40%]"]:["w-[85%] sm:w-[80%]","w-[15%] sm:w-[20%]"];return e.jsxs("section",{className:"flex flex-col gap-4",children:[d&&e.jsxs("div",{className:"hidden flex-col gap-2 sm:flex",children:[e.jsx("p",{className:"text-sm font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations",defaultMessage:"Team automations"})}),e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.description",defaultMessage:"Automations that run for everyone with a linked ChatGPT account on the repo"})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"max-w-72",children:e.jsx(H,{name:"team-automations-search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",ariaLabel:o.formatMessage({id:"wham.codeReviewPage.teamAutomations.searchRepoAria",defaultMessage:"Search repo"}),placeholder:o.formatMessage({id:"wham.codeReviewPage.teamAutomations.searchRepoPlaceholder",defaultMessage:"Search repo"}),type:"search",color:"search",value:r,onChange:l=>s(l.target.value)})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("button",{type:"button",className:x("text-token-text-secondary bg-transparent p-0",{underline:t==="all"}),onClick:()=>g("all"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.filter.all",defaultMessage:"All"})}),e.jsx("span",{className:"text-token-text-tertiary",children:"•"}),e.jsx("button",{type:"button",className:x("text-token-text-secondary bg-transparent p-0",{underline:t==="enabled"}),onClick:()=>g("enabled"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.filter.enabledOnly",defaultMessage:"Enabled only"})})]})]}),e.jsx("div",{children:e.jsxs(n.Root,{size:"compact",disableScroll:!0,fixed:!0,children:[e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{textAlign:"left",className:m[0],children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.repository",defaultMessage:"Repository"})}),e.jsx(n.HeaderCell,{textAlign:"left",className:m[1],children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.codeReview",defaultMessage:"Code review"})}),d&&e.jsx(n.HeaderCell,{textAlign:"left",className:x(m[2],"hidden sm:table-cell"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.lastUpdated",defaultMessage:"Last updated"})})]}),e.jsxs(n.Body,{children:[v?Array.from({length:6}).map((l,u)=>e.jsxs(n.Row,{children:[e.jsx(n.Cell,{className:x(m[0],"min-w-0"),children:e.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 rounded"}),e.jsx(j,{className:"h-4 w-48"})]})}),e.jsx(n.Cell,{textAlign:"left",className:x(m[1],"min-w-0"),children:e.jsx(j,{className:"h-6 w-10 rounded-full"})}),d&&e.jsx(n.Cell,{textAlign:"left",className:x(m[2],"min-w-0"),children:e.jsx(j,{className:"h-4 w-32"})})]},`skeleton-${u}`)):b.length===0&&!w?e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:d?3:2,className:"text-token-text-tertiary",textAlign:"left",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.noRepositories",defaultMessage:"No repositories"})})}):b.map(l=>{const u=l.repository.owner?.login,R=u?i.includes(u):!1,y=e.jsx(W,{"aria-label":o.formatMessage({id:"wham.codeReviewPage.teamAutomations.toggleRepoCodeReviewAria",defaultMessage:"Toggle code review for repository"}),checked:l.review_preference==="team",disabled:R,onCheckedChange:E=>{const I=E?"team":"never";B({repo_review_settings:[{repository:l.repository.id,review_preference:I}]})}});return e.jsxs(n.Row,{children:[e.jsx(n.Cell,{className:x(m[0],"min-w-0"),children:e.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[e.jsx(Z,{className:"icon-md shrink-0"}),e.jsx("p",{className:"truncate text-sm",children:l.repository.repository_full_name})]})}),e.jsx(n.Cell,{textAlign:"left",className:x(m[1],"min-w-0"),children:R?e.jsx(P,{label:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.repoDisabledTooltip",defaultMessage:"Update the {installation} GitHub installation to enable code review",values:{installation:u}}),children:y}):y}),d&&e.jsx(n.Cell,{textAlign:"left",className:x(m[2],"min-w-0"),children:l.updated_at&&l.last_updated_user_email&&e.jsxs("div",{className:"flex min-w-0 items-center text-xs sm:text-sm",children:[e.jsxs("div",{className:"hidden min-w-0 sm:flex sm:items-center sm:gap-2",children:[e.jsx("span",{className:"whitespace-nowrap",children:e.jsx(M,{value:new Date(l.updated_at),year:"numeric",month:"short",day:"2-digit"})}),e.jsx("p",{className:"text-token-text-secondary truncate",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedBy",defaultMessage:"by {email}",values:{email:l.last_updated_user_email}})})]}),e.jsx(P,{className:"sm:hidden",label:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs",children:e.jsx(M,{value:new Date(l.updated_at),year:"numeric",month:"short",day:"2-digit"})}),e.jsx("span",{className:"text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedBy",defaultMessage:"by {email}",values:{email:l.last_updated_user_email}})})]}),labelTextAlign:"left",labelClassName:"text-xs",align:"start",children:e.jsx(C,{className:"icon-sm text-token-text-secondary shrink-0"})})]})})]},l.repository.id)}),!v&&e.jsx(n.Row,{children:e.jsx(n.Cell,{colSpan:d?3:2,className:"!border-b-0!",textAlign:"left",children:e.jsx(ee,{isFetchingNextPage:!!T,hasNextPage:!!S,fetchNextPage:()=>k(),bgColor:"bg-transparent"})})})]})]})})]})}function de(){const{data:i,isLoading:o,isError:r}=Y(),{mutate:s,isPending:c}=te(),t=N(),g=i?.code_review_preference==="repo_default"||t,d=o||r||!i,{data:f}=_(),v=h.useMemo(()=>f?.installations_without_events??[],[f]);return e.jsx($,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-2 ps-4 pe-12",children:[e.jsx("div",{className:"border-token-border-heavy flex items-center justify-between border-b pb-2",children:e.jsx("p",{className:"flex items-center gap-2 align-middle text-xl leading-7 font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.header",defaultMessage:"Code review"})})}),e.jsx(oe,{}),e.jsx(ne,{}),d?e.jsx("div",{className:"flex items-center justify-center pt-2",children:e.jsx(q,{className:"icon me-1.5"})}):e.jsxs("div",{className:"flex flex-col gap-4 pt-2 pb-4",children:[e.jsx(ie,{isSaving:c,initialScope:i.code_review_preference,onChange:w=>{s({codeReviewPreference:w})}}),e.jsx("div",{className:"bg-token-border-default h-px"}),g&&e.jsx(re,{disabledInstallations:v.map(w=>w.account_login)})]})]})})}const ke=()=>[{title:"Codex"}],Se=z(function(){return V()?e.jsx(de,{}):e.jsx(D,{})});export{Se as default,ke as meta};
//# sourceMappingURL=comwu5d012ywqrwl.js.map

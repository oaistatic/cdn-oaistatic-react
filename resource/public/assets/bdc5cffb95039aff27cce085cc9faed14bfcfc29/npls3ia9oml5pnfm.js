import{X as b,f as _,F as P,c as S,p as g,a as T,b as A,d as R}from"./kzn4ha0q32870lv3.js";import{E as v,d as y}from"./mmilw72p73kj15mv.js";import{a0 as E}from"./dmck639k4dv7claj.js";function M(t,m=50,d=50){const i={SheetNames:[],Sheets:{}};for(const o of t.sheets){i.SheetNames.push(o.name);const s={};for(const n of o.rows)if(!(n.index>m))for(const e of n.cells){const a=/^[A-Z]+/.exec(e.address);if(!a)continue;const f=a[0];let u=0;for(let c=0;c<f.length;c++)u=u*26+(f.charCodeAt(c)-64);if(u>d)continue;const r={};if(e.value!==""){const c=Number(e.value);r.v=Number.isNaN(c)?e.value:c}e.formula&&(r.f=e.formula),s[e.address]=r}i.Sheets[o.name]=s}b.import_functions(_);try{b(i,{continue_after_error:!0})}catch(o){E.addError(o)}for(const o of t.sheets){const s=i.Sheets[o.name];for(const n of o.rows)if(!(n.index>m)){for(const e of n.cells)if(e.formula&&e.value===""){const a=s[e.address]?.v;e.value=a!=null?String(a):"This formula is not supported in web preview. Please download to open in your preferred software for the best results."}}}}function C(t=0){return t>0?t:self.devicePixelRatio||1}async function W(t,m,d=404,i=0){const o=C(i),s=t.widthEmu*v,n=t.heightEmu*v,e=Math.min(1,d/Math.max(s,n)),a=Math.round(s*e*o),f=Math.round(n*e*o),u=new OffscreenCanvas(a,f),r=u.getContext("2d");if(!r)throw new Error("Failed to create 2D context");r.scale(o*e,o*e),await y(t,m,r,[]);const c=await u.convertToBlob({type:"image/png"});return new Promise(x=>{const h=new FileReader;h.onload=()=>x(h.result),h.readAsDataURL(c)})}async function H(t,m=20,d=10,i=0,o){const s=C(i),n=80,e=20;M(o,50,50);const a=new OffscreenCanvas(d*n*s,m*e*s),f=a.getContext("2d");if(!f)return Promise.resolve("");f.scale(s,s);const r=Array(50).fill(P);for(const l of t.columns){const w=S(l.width);for(let p=l.min-1;p<l.max;p++)r[p]=w}const x=Array(50).fill(g(t.defaultRowHeight||T));for(const l of t.rows)l.customHeight&&(x[l.index-1]=g(l.height));const h=A(o);R(f,t,r,x,0,0,800,400,null,null,1,h,{},new Set,new Set,!1);const L=await a.convertToBlob({type:"image/png"});return new Promise(l=>{const w=new FileReader;w.onload=()=>l(w.result),w.readAsDataURL(L)})}export{H as a,W as s};
//# sourceMappingURL=npls3ia9oml5pnfm.js.map

import{e as A,r as a,j as e,d as G}from"./cs7toih8jegb7teq.js";import{cJ as L,cK as y,cL as _,cM as B,cN as H,cO as O,cP as f,N as l,cQ as Q,cR as V,cS as W,cT as Y,cU as Z,cV as z,cW as J,cX as K,cY as X,cZ as $}from"./hnw079jsdm76umup.js";import{I as ee}from"./k8zvpcbe8ny3hcd9.js";import"./dmck639k4dv7claj.js";import"./hsurwbv79wrpc9dg.js";import"./lxgn8k46ba24438b.js";import"./k4ghje9xipg90eb2.js";import"./lox5zdwgg3gy3k4z.js";import"./nfubiloo9rdxk3kj.js";import"./itn5frgf3bcgdkwm.js";import"./kizn5m1hr7kdjf9n.js";const D=G({thumbsUp:{id:"Qz8Wa6",defaultMessage:"Like this image"},thumbsDown:{id:"sUGtRy",defaultMessage:"Dislike this image"}}),ae=t=>H({pointer:{url:t.url,asset_pointer:t.assetPointer??"",metadata:{dalle:{gen_id:t.transformationId??void 0},generation:{gen_id:t.transformationId??void 0}},width:t.width,height:t.height},conversationId:t.conversationId,messageId:t.messageId??"",source:"chat"}),me=({images:t,initialIndex:p,onClose:I,onRequestCompletion:j,clientThreadId:k,currentModelId:S})=>{const n=A(),M=L(),[o,b]=a.useState(null),[d,g]=a.useState(null),[N,R]=a.useState(p),[x,u]=a.useState("default"),r=y(),w=a.useRef(null),m=a.useRef(r);a.useEffect(()=>{m.current=r},[r]);const T=a.useCallback(i=>{g(null),b(null),R(i),u("default"),m.current.clearAllDrawings()},[]),v=a.useCallback(()=>_(n),[n]),c=a.useCallback((i,h)=>{!h||o!=null||(B.imageRated({liked:i,analyticsContext:ae(h)}),b(i),i||g(h))},[o]),s=t[N],C=a.useCallback(()=>{u("default"),m.current.clearAllDrawings()},[]),U=a.useCallback(()=>{c(!0,s)},[c,s]),F=a.useCallback(()=>{!s||o!=null||c(!1,s)},[c,s,o]),E=a.useCallback(()=>{s&&u("inpaint")},[s]),P=a.useCallback(()=>{s&&O({url:s.url,fileName:v()})},[s,v]),q=a.useCallback(()=>w.current?.getImageData(),[]);return e.jsxs(e.Fragment,{children:[e.jsxs(f.Root,{images:t,initialIndex:p,onClose:I,onIndexChange:T,inpaintingProps:{mode:x,drawingState:r,drawingCanvasRef:w},children:[e.jsx(f.LightboxHeaderActions,{children:x==="inpaint"?e.jsxs("div",{className:"grid grow grid-cols-[1fr_auto] items-center gap-2",children:[e.jsx("div",{className:"text-center font-semibold",children:n.formatMessage({id:"TjVqYb",defaultMessage:"Edit Selection"})}),e.jsxs("div",{className:"flex gap-1 justify-self-end md:gap-2",children:[e.jsx(l,{className:"aspect-square",icon:Q,onClick:r.undoDrawing,disabled:!r.canUndoDrawing,"aria-label":n.formatMessage({id:"OmaTPx",defaultMessage:"Undo"})}),e.jsx(l,{className:"aspect-square",icon:V,onClick:r.redoDrawing,disabled:!r.canRedoDrawing,"aria-label":n.formatMessage({id:"ZUr4oh",defaultMessage:"Redo"})}),e.jsx(l,{className:"w-auto px-3",onClick:C,children:n.formatMessage({id:"D9xvar",defaultMessage:"Cancel"})})]})]}):e.jsxs("div",{className:"flex gap-1 md:gap-2",children:[o!==!1&&e.jsx(l,{className:"aspect-square",icon:o===!0?W:Y,onClick:U,"aria-label":n.formatMessage(D.thumbsUp)}),o!==!0&&e.jsx(l,{className:"aspect-square",icon:o===!1?Z:z,onClick:F,"aria-label":n.formatMessage(D.thumbsDown)}),e.jsx(l,{className:"aspect-square",icon:J,onClick:E,"aria-label":n.formatMessage({id:"pRGwlp",defaultMessage:"Edit image"})}),e.jsx(l,{className:"aspect-square",icon:K,onClick:P,"aria-label":n.formatMessage({id:"9DNHka",defaultMessage:"Download image"})}),M()&&s?.messageId&&e.jsx(X,{assetPointer:s.assetPointer,serverThreadId:s.conversationId,messageId:s.messageId})]})}),e.jsx(f.Footer,{children:e.jsx(ee,{clientThreadId:k,currentModelId:S,onRequestCompletion:j,onClose:I,activeImage:s,currentDrawnShape:r.currentDrawnShape,getImageData:q,onCancelInpaint:C})})]}),d&&e.jsx($,{messageId:d.messageId??"",serverThreadId:d.conversationId,rating:o,onClose:()=>g(null)})]})};export{me as ImageGenConversationLightboxNew};
//# sourceMappingURL=gufdzvt4gunvrto7.js.map

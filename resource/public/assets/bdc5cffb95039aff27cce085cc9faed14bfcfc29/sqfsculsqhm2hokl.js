import{bV as q,e as G,G as Q,d6 as V,pv as z,hr as K,cM as X,hE as Y,B as $,S as J,q4 as ee,de as ne,z as P,lU as se}from"./dmck639k4dv7claj.js";import{j as e,M as o,r as u,a as te,b as ae,f as re,e as ie,n as oe,i as le,I as me,ah as ce}from"./cs7toih8jegb7teq.js";import{V as de,c_ as ue}from"./hnw079jsdm76umup.js";import{S as he}from"./n4583mr0plrji70e.js";import{T as s}from"./jowyjrirlo5h1pme.js";import{I as fe}from"./ig3euz6ql417cw29.js";import{u as pe}from"./fg1z1tv7372twqew.js";import{E as C}from"./p80xz2nejchyk0n0.js";import{W as k,i as xe}from"./crerkmhvihiw48az.js";import{W as ge}from"./fba6r4282q3hco9o.js";import"./lco7biunzadofjpa.js";import"./mntlin6h4lg868yr.js";import"./dupxx6qfa09nz1fw.js";import"./mahhuo4zclh446vl.js";import"./l1m3l5lbmhuctzw6.js";import"./g9gr3l5lwhb3z8y8.js";import"./yf0i1e6tgcrdg1ll.js";import"./mcuu3cegz8rmschr.js";import"./o12mkc4t9o2t0ta8.js";import"./dr58d0qi3ke74zcr.js";function ve(){return e.jsx("div",{className:"border-token-border-heavy flex items-center border-b",children:e.jsx("div",{className:"py-2 text-xl leading-7 font-medium",children:e.jsx(o,{id:"wham.environmentsHeader.message",defaultMessage:"Environments"})})})}const Ce=t=>u.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{d:"M5.14518 8.20723C4.81869 8.30403 4.52965 8.56906 4.36686 8.94649C4.16207 9.42187 4.22381 9.91162 4.53873 10.2268L9.77311 15.4611L9.89908 15.5676C10.2102 15.7875 10.6375 15.8122 11.0534 15.633C11.4312 15.4701 11.6961 15.1806 11.7926 14.8537L12.7868 15.8488C12.4904 16.305 12.0507 16.6517 11.5797 16.8547C10.7869 17.1963 9.76213 17.1946 8.98502 16.5412L8.83268 16.4016L6.68521 14.2541L2.97037 17.9709C2.7107 18.2302 2.28855 18.2303 2.02896 17.9709C1.76958 17.7113 1.7697 17.2892 2.02896 17.0295L5.74479 13.3137L3.5983 11.1672C2.80696 10.3756 2.78071 9.26596 3.14518 8.42012C3.34827 7.94906 3.6947 7.50849 4.15104 7.21211L5.14518 8.20723Z"}),u.createElement("path",{d:"M17.1364 16.1965C17.3959 16.4562 17.396 16.8773 17.1364 17.1369C16.8767 17.3964 16.4556 17.3964 16.196 17.1369L17.1364 16.1965Z"}),u.createElement("path",{d:"M2.86197 2.8625C3.08913 2.63535 3.44079 2.60732 3.69889 2.77754L3.80338 2.8625L17.1364 16.1965L16.6657 16.6662L16.196 17.1369L2.86197 3.80391L2.77701 3.69942C2.60677 3.44138 2.63494 3.08969 2.86197 2.8625Z"}),u.createElement("path",{d:"M10.9372 2.70723C11.8014 1.63068 13.4235 1.53079 14.4137 2.52071L17.4792 5.58614L17.5719 5.68379C18.4618 6.68016 18.3344 8.22636 17.2926 9.0627L17.1852 9.14375L14.2799 11.218L13.3268 10.2648L16.4118 8.06172L16.5016 7.98946C16.8967 7.63429 16.9467 7.02804 16.6159 6.6125L16.5387 6.52657L13.4733 3.46114C13.0597 3.04787 12.391 3.07483 12.0104 3.49825L11.9381 3.58809L9.73502 6.67208L8.78092 5.71895L10.8561 2.81465L10.9372 2.70723Z"})),we=25,Le=100;function je({isPinned:t,onToggle:c,intl:h,isCreator:l}){return e.jsx(s.Cell,{className:"content-center pe-1!",children:e.jsx(ne,{side:"bottom",align:"center",className:"block w-full",alignOffset:0,label:l?t?e.jsx(o,{id:"wham.environmentsList.unpin",defaultMessage:"Unpin environment for everyone in your workspace"}):e.jsx(o,{id:"wham.environmentsList.pin",defaultMessage:"Pin environment to the top for everyone in your workspace"}):e.jsx(o,{id:"wham.environmentsList.pin.notCreator",defaultMessage:"You can only pin and unpin environments you created."}),children:e.jsxs("button",{disabled:!l,onClick:c,className:P("group/cell relative flex h-10 w-full items-center px-4 group-hover/row:opacity-100",!t&&"opacity-0",t&&!l&&"opacity-50"),"aria-label":t?h.formatMessage({id:"wham.environmentsList.unpinEnvironment",defaultMessage:"Unpin environment"}):h.formatMessage({id:"wham.environmentsList.pinEnvironment",defaultMessage:"Pin environment"}),children:[t&&e.jsx(Ce,{className:"icon absolute opacity-0 group-hover/cell:opacity-100"}),e.jsx(he,{className:P("icon absolute",t&&"opacity-100 group-hover/cell:opacity-0")})]})})})}function Me(){const t=te(),[c,h]=ae(),l=re(),r=ie(),_=q(),I=G(),p=Q(I),w=!!p?.isWorkspaceAccount(),L=pe(),[x,T]=u.useState(c.get("search")??""),{data:H,isLoading:D,error:j,fetchNextPage:A,hasNextPage:M,isFetchingNextPage:F}=oe({queryKey:["wham","environments","with-creators"],initialPageParam:null,queryFn:({pageParam:n})=>k.getEnvironmentWithCreators(n?Le:we,n),getNextPageParam:n=>n.cursor??null}),{mutate:U}=le({mutationFn:({environmentId:n,isPinned:a})=>(l.setQueryData(["wham","environments","with-creators"],i=>i&&V(i,m=>{for(const v of m.pages)for(const d of v.items)if(d.id===n){d.is_pinned=!d.is_pinned;break}})),l.setQueryData(["wham","environments"],i=>i&&i.map(m=>m.id===n?{...m,is_pinned:a}:m)),k.updateEnvironment(n,{is_pinned:a})),onSettled:()=>{xe(l)},onError:()=>{_.danger(r.formatMessage({id:"wham.environmentsList.failedToPinEnvironment",defaultMessage:"Failed to pin environment"}))}}),{isConnected:N,isLoading:W}=z(X.GITHUB_CONNECTOR,"github","/codex/settings/environments",K.CODEX),b=H?.pages.flatMap(n=>n.items)??[],g=x.trim().toLowerCase(),R=b.filter(n=>n.label.toLowerCase().includes(g)),E=n=>{const a=n.toLowerCase();return a===g?0:a.startsWith(g)?1:2},y=R.slice().sort((n,a)=>{if(n.is_pinned!==a.is_pinned)return n.is_pinned?-1:1;const i=E(n.label)-E(a.label);return i!==0?i:n.label.localeCompare(a.label)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row justify-between pb-4",children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx(Y,{name:"search-environments",color:"search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",value:x,disabled:W||!N||j!==null,onChange:n=>{const a=n.target.value;T(a),a?h({search:a},{replace:!0}):h({},{replace:!0})},placeholder:r.formatMessage({id:"wham.environmentsList.searchEnvironmentsPlaceholder",defaultMessage:"Search environments"}),ariaLabel:r.formatMessage({id:"wham.environmentsList.searchEnvironmentsAria",defaultMessage:"Search environments"})})}),e.jsx($,{onClick:()=>t("/codex/settings/environment/create"),disabled:!N,color:"primary",icon:de,className:"h-8","aria-label":r.formatMessage({id:"wham.environmentsList.createEnvironmentAriaLabel",defaultMessage:"Link to create a new environment"}),children:e.jsx("span",{className:"hidden md:inline",children:e.jsx(o,{id:"wham.environmentsList.createEnvironment",defaultMessage:"Create environment"})})})]}),D?e.jsx("div",{className:"flex h-full items-center justify-center pt-5",children:e.jsx(J,{})}):j?e.jsx(C,{title:r.formatMessage({id:"wham.environmentsList.error",defaultMessage:"Failed to load environments"}),description:r.formatMessage({id:"wham.environmentsList.errorDescription",defaultMessage:"Please try refreshing the page, if that does not work, please contact support."})}):b.length===0?e.jsx(C,{title:r.formatMessage({id:"wham.environmentsList.noEnvironments",defaultMessage:"No environments"}),description:r.formatMessage({id:"wham.environmentsList.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})}):e.jsxs(e.Fragment,{children:[e.jsxs(s.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[e.jsxs(s.Header,{children:[e.jsx(s.HeaderCell,{className:"ps-2 text-sm",children:e.jsx(o,{id:"wham.environmentsList.name",defaultMessage:"Name"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.repo",defaultMessage:"Repo"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.numberOfTasks",defaultMessage:"Number of tasks"})}),L&&e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.sharing",defaultMessage:"Sharing"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.creator",defaultMessage:"Creator"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.createdAt",defaultMessage:"Created at"})}),w&&e.jsx(s.HeaderCell,{}),e.jsx(s.HeaderCell,{})]}),e.jsx(s.Body,{children:y.length===0&&!M?e.jsx(s.Row,{children:e.jsx(s.Cell,{colSpan:100,children:e.jsx(C,{title:r.formatMessage({id:"wham.environmentsList.search.noEnvironments",defaultMessage:"No matches for {search}"},{search:x}),description:r.formatMessage({id:"wham.environmentsList.search.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})})})}):y.map(({id:n,label:a,is_pinned:i,repos:m,repo_map:v,creator:d,created_at:S,task_count:O,share_settings:B})=>{const Z=!!p?.authUserId&&d.id.includes(p?.authUserId);return e.jsxs(s.Row,{role:"row",className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm hover:cursor-pointer",onClick:()=>t(`/codex/settings/environment/${n}`),tabIndex:0,"aria-label":r.formatMessage({id:"wham.environmentsList.environmentAriaLabel",defaultMessage:"View environment {label}"},{label:a}),children:[e.jsx(s.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:a}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:m.map(f=>e.jsx("div",{children:v?.[f]?.repository_full_name??f},f))}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:O}),L&&e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:Ne(r,B)}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:d.email}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:S?e.jsx(me,{value:new Date(S*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(o,{id:"wham.environmentsList.na",defaultMessage:"N/A"})}),w&&e.jsx(je,{isPinned:i,isCreator:Z,onToggle:f=>{f.stopPropagation(),U({environmentId:n,isPinned:!i})},intl:r})]},n)})})]}),e.jsx(fe,{isFetchingNextPage:F,hasNextPage:M??!1,fetchNextPage:A})]})]})})}function Ne(t,c){switch(c){case"public":return t.formatMessage({id:"wham.environmentsList.public",defaultMessage:"Public"});case"private":return t.formatMessage({id:"wham.environmentsList.private",defaultMessage:"Private"});case"workspace":return t.formatMessage({id:"wham.environmentsList.workspace",defaultMessage:"Workspace"});default:ee.assertNever(c)}}function be(){const{eligible:t}=ue();return t?e.jsx(ce,{to:"/codex"}):e.jsx(ge,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-4 ps-4 pe-4 md:pe-12",children:[e.jsx(ve,{}),e.jsx(Me,{})]})})}const Qe=()=>[{title:"Codex"}],Ve=se(function(){return e.jsx(be,{})});export{Ve as default,Qe as meta};
//# sourceMappingURL=sqfsculsqhm2hokl.js.map

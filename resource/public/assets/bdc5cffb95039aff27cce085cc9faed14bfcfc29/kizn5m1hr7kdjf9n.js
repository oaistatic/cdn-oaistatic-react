import{d as R,e as O,j as e,M as U,r as q}from"./cs7toih8jegb7teq.js";import{dA as D,dB as W,dC as K,dD as Q,dE as C,dF as V,dG as J,dH as ee}from"./hnw079jsdm76umup.js";import{P as k,kH as S,e as L,d1 as b,de as te,oX as se,cx as oe,bR as $,bV as H,fF as ae,aM as ie,id as X,au as I,fA as v,jj as y,oY as G,oZ as Y,o_ as le,i as re,ao as ne,eq as ce,fy as de,lj as ue,fW as ge,j$ as pe,fz as B,o$ as fe,p0 as me,p1 as Fe}from"./dmck639k4dv7claj.js";import{u as he}from"./nfubiloo9rdxk3kj.js";function Ue({clientThreadId:s,openFileDialog:t,icon:r,isDisabled:i=!1,isSmall:l=!1,showLabel:n=!1,showUpsell:o=!1,hideBorder:x=!1,highlightTooltip:c=!1,disabledReason:p,currentModelName:M,visualTreatment:m,showMenuForNoAuth:a,modelSupportsImages:P}){const d=O(),F=S(),A=L();i=(i||!!F)&&!o;const u=e.jsxs(W,{disabled:i,$showLabel:n,$hideBorder:x,$isSmall:l,$visualTreatment:m,onClick:g=>{if(g.preventDefault(),a||o){k.logNoAuthAttachButtonClicked({location:a?"No auth file upload":"No auth upsell"});return}t()},"aria-label":K(A,d,i,p,M),children:[r,n&&e.jsx(Q,{})]}),f=e.jsx("div",{className:"flex",children:u});if(a||o){const g=a?e.jsx(V,{openFileDialog:t,showMenuForNoAuth:!0,modelSupportsImages:P}):e.jsx(se,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"}),h=e.jsx(b.BasicTrigger,{asChild:!0,children:f});return e.jsxs(b.Root,{children:[a?e.jsx(C,{clientThreadId:s,rateLimitPopup:F,highlightTooltip:c,disabled:i,children:h}):e.jsx(te,{label:e.jsx(U,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:c||void 0,children:h}),e.jsx(b.Portal,{children:e.jsx(b.Content,{alignOffset:-8,side:"bottom",size:"small",className:"radix-side-bottom:flex-col-reverse flex flex-col",children:g})})]})}return e.jsx(C,{disabled:i,clientThreadId:s,rateLimitPopup:F,highlightTooltip:c,children:f})}function xe({code:s,message:t}){switch(s){case D.FileTooLarge:return z.errorFileTooLarge;case D.TooManyFiles:return k.logEvent("Uploaded Max Files Error"),z.errorTooManyFiles;default:return t}}const z=R({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."}}),N=R({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function Me(s){if(!s.accept||Object.keys(s.accept).length===0)return[];const t=[];return Object.values(s.accept).forEach(r=>t.push(...r)),t.sort()}function ke(s){const{className:t,children:r,clientThreadId:i,currentModelConfig:l,noKeyboard:n}=s,o=O(),x=H(),c=L(),p=re(c),m=$(c).flags?.includes(X.NoAuthEnableFileUploads),a=ne(i),P=ce(),d=de(l,a,P),F=d!==v.None,A=ue(_=>_.files),u=(d===v.Multimodal?G:Y)-A.length,f=u<=0,{getGizmoId:g}=ge(),{handleFileAccepted:h}=Pe(o,d,B(l,a),"drag",g,pe(l,a)?.attachments),j=S(),T=fe(!p&&m?B(l,a):me(l,a)),{getRootProps:Z,isDragActive:w}=he({maxFiles:u,disabled:!F||f||j!=null,noClick:!0,noKeyboard:n,onDropAccepted:h,onDropRejected:_=>Ae(_,o,x,d),multiple:!0,maxSize:Fe,...T}),E=Me(T);return e.jsxs("div",{...Z({className:t}),children:[r,w&&e.jsxs(je,{children:[e.jsx(ee,{}),e.jsx("h3",{children:e.jsx(U,{...N.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:E.length>0?E.join(", "):e.jsx(U,{...N.dragAllAccepted})})]})]})}function Ae(s,t,r,i){const{errors:l}=s[0];l.forEach(n=>{const o=xe(n);typeof o=="string"?r.danger(o,{hasCloseButton:!0,loggingTitle:"File upload error",loggingDescription:o,toastId:"file_upload_error"}):r.danger(t.formatMessage(o,{size:le,maxNum:i===v.Multimodal?G:Y}),{hasCloseButton:!0,loggingTitle:o.defaultMessage||"File upload error",loggingDescription:o.defaultMessage||"File upload error",toastId:"file_upload_error"})})}function Pe(s,t,r,i,l,n){const o=L(),x=$(o).flags,c=H(),p=ae(),{isUnauthenticated:M}=ie(),m=x?.includes(X.NoAuthEnableFileUploads),{persistFilesToLibrary:a}=J(o,!0);return{handleFileAccepted:q.useCallback(async(d,F)=>{k.logEvent("Upload File",{client:"web",eventSource:i,intent:t.toString()});const A=l!=null?await l():void 0;d.length>0&&d.forEach(u=>{const f={gizmoId:A,...m&&{isUnauthenticated:M}},g=[p,I(u),u,t,r,s,c,f,n];if(t===v.Retrieval){const h=y.uploadFile(...g,void 0,!1,a);let j=Promise.resolve();a&&(j=y.uploadFile(p,`${I(u)}:lib`,u,t,r,s,c,f,n,void 0,!0,!0)),Promise.all([h,j])}else y.uploadFile(...g)})},[i,t,l,p,r,s,c,n,m,M,a])}}const je=oe.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`;export{je as D,ke as F,Ue as P,Me as g,Ae as h,Pe as u};
//# sourceMappingURL=kizn5m1hr7kdjf9n.js.map

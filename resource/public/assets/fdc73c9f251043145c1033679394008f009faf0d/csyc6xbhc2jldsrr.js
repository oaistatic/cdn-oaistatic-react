import{ke as S,ag as w,aG as y,j4 as b}from"./or7jf62i5kvok6pm.js";import{P as M,j as e,ah as k,h as N,e as C,u as F,a as A,M as u}from"./juy90og0wtbp77qa.js";import{bT as P,bU as W,W as R,i as T,bV as U}from"./kax7wcp9i7f7jtvz.js";import{R as D,I as r,S as l}from"./k1fxfonlm0g5dgxq.js";import{E as I,R as O,g as B}from"./i6x22ca8jzh9ienl.js";import{u as L}from"./drm1kuaj57rg9y1m.js";import{W as $}from"./lbbexno5kh833hk3.js";import"./e5u6tio7u74tdefk.js";import"./f2pihflubtq4oi7k.js";import"./oj99toeqeyuznl2r.js";import"./lptwpbjabrvjmhsj.js";import"./ik1xtb1uvd6iabtb.js";import"./mia7txooqhkpbw7w.js";import"./gtarz7mxj2xze66f.js";import"./jbze7lwlszm657iq.js";import"./k3j7nk2mqimsnpi6.js";import"./f5uxfkqdhg7743lt.js";import"./iwjufulrjpcfvtww.js";import"./dn063lnxb0kec6my.js";import"./g0j29k77kzjbz76f.js";import"./g1mzshmp15rgsy0r.js";import"./mj9z9iuqobsziv2h.js";import"./ocpfit0g1gfti5z4.js";import"./kwrsfo4prmlqgo0w.js";import"./6l5wykugon65myc6.js";import"./fgnsrp7wj3i83g7e.js";import"./klzyif2r6c67lyfu.js";import"./osl7p7pfd29pg5qh.js";import"./khey9wv8trxtr5w5.js";import"./gbryk52yvym6pvzs.js";import"./beq9ghaom4x8xa0j.js";import"./on0kcnmks7o53xta.js";import"./ndqdq30cq8lae3qb.js";import"./mevzpwnt01gt592f.js";import"./n74iabl73l4zjty8.js";function q(){const{environmentId:s}=M(),{eligible:i}=P();return i?e.jsx(k,{to:"/codex/onboarding"}):s?e.jsx(z,{environmentId:s}):e.jsx(S,{})}function z({environmentId:s}){const i=N(),o=w(),g=C(),m=F(),{data:n,isLoading:h,isError:v}=W(s),d=n?.secrets??{},x=L()?"workspace":"private",{mutate:E,isPending:f}=A({mutationFn:t=>R.updateEnvironment(s,t),onSuccess:async t=>{await T(m,s),U(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function _(t){const a=B(t.secrets,d),j=t.envVars.reduce((c,p)=>(c[p.key]=p.value,c),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:j,image_snapshot_settings:t.imageSnapshotSettings})}return e.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(y,{})}):v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(u,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):n?e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"sticky top-0 px-4",children:[e.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(l,{}),e.jsx(r,{label:n.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),e.jsx(l,{}),e.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),e.jsx(I,{initialEnvironmentId:s,existingEnvironment:n,initialValues:{label:n?.label,description:n?.description??"",share_settings:n?.share_settings??x,machine:n?.machine_id,repositoryId:n?.repos[0],workspaceDirectory:n?.workspace_dir??"",agentNetworkAccess:n?.agent_network_access,setupCommands:n?.setup?Array.isArray(n?.setup)?n.setup.join(`
`):n.setup:"",envVars:Object.entries(n?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(d).map(t=>({key:t,value:O,isEditing:!1})),imageSnapshotSettings:n?.image_snapshot_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:_,isPending:f})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(u,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const ke=()=>[{title:"Codex"}],Ne=b(function(){return e.jsx(q,{})});export{Ne as default,ke as meta};
//# sourceMappingURL=csyc6xbhc2jldsrr.js.map

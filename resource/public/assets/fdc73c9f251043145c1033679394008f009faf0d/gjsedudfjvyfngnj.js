import{u as v,r as n,j as g,f as A,h}from"./juy90og0wtbp77qa.js";import{kA as R,kB as C,kC as x,kD as M,hp as V,e as m,ae as B,dW as I,b4 as T,f as E,P as k,aG as _}from"./or7jf62i5kvok6pm.js";import{S as L}from"./l3n51a2tb9b2qxpl.js";import{S as j}from"./mia7txooqhkpbw7w.js";import{f6 as G,bs as O,f7 as U,f8 as W}from"./kax7wcp9i7f7jtvz.js";import{u as D}from"./m4hnvgp7gphpktn6.js";import"./gy64pge8qevmvg7e.js";function q({audioAssetPointer:l,conversationId:e}){const s=v(),[i,a]=n.useState(!1),t=n.useRef(!0),[o,p]=n.useState(void 0),r=n.useRef(null),c=R(),d=C(u=>u.isPlaying&&u.sourceUrl===o),b=null,y=n.useCallback(()=>{const u=x();if(u)r.current?r.current.then(()=>{u.stop(),r.current=null}):u.stop();else return},[]);n.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),n.useEffect(()=>()=>{M().isPlaying&&y()},[y]);const P=n.useCallback(async()=>{if(!c||!t.current)return;a(!0);const{url:u}=await G.fetch(s,{asset:l,conversationId:e});a(!1),p(u),c.changeSource(u),r.current=c.play()},[l,e,c,s,b]);return{togglePlayback:n.useCallback(()=>{if(c)d?y():(V.messagePlayback.click(),P());else return},[d,P,c,y]),isPlaying:d,isLoading:i}}const Z=n.memo(function(e){const s=m(),i=B(s),a=I(e.conversationId),t=O(e.message);if(!i||!a||t)return null;const o=T.getAudioAssetPointers(e.message)[0];return o?g.jsx(w,{audioAssetPointer:o,conversationId:a}):g.jsx(F,{...e,conversationId:a})});function w({audioAssetPointer:l,conversationId:e}){const{isLoading:s,isPlaying:i,togglePlayback:a}=q({audioAssetPointer:l,conversationId:e}),t=()=>{k.logEventWithStatsig("ChatGPT Turn Action Voice Replay Clicked","chatgpt_turn_action_voice_replay"),a()};return g.jsx(S,{onClick:t,isPlaying:i,isLoading:s,playText:f.replay,playIcon:U})}function F({conversationId:l,message:e}){const{isLoading:s,isPlaying:i,togglePlayback:a}=D({conversationId:l,messageId:e.id}),t=()=>{k.logEventWithStatsig("ChatGPT Turn Action Voice Read Aloud Clicked","chatgpt_turn_action_voice_read_aloud"),a()};return g.jsx(S,{onClick:t,isPlaying:i,isLoading:s,playText:f.play,playIcon:L})}function S({onClick:l,isPlaying:e,isLoading:s,playText:i,playIcon:a}){let t,o;const p=h(),r=m(),c=E(r,"1894790777");return s?(t=_,o=f.loading):e?(t=j,o=f.stop):(t=a,o=i),g.jsx(W,{icon:t,label:o?p.formatMessage(o):void 0,disabled:s,onClick:l,style:e||s?{visibility:"visible"}:void 0,testId:"voice-play-turn-action-button",asMenuItem:c,onSelect:d=>{d.preventDefault()}})}const f=A({replay:{id:"VoiceReadOutLoudButton.replay",defaultMessage:"Replay"},play:{id:"VoiceReadOutLoudButton.play",defaultMessage:"Read aloud"},stop:{id:"VoiceReadOutLoudButton.stop",defaultMessage:"Stop"},loading:{id:"VoiceReadOutLoudButton.loading",defaultMessage:"Loading"}});export{S as PlayButton,w as VoiceMessagePlaybackButton,Z as VoicePlayButton,F as VoiceReadAloudButton};
//# sourceMappingURL=gjsedudfjvyfngnj.js.map
